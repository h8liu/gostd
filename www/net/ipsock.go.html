<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1440180">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1440236">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1440290">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1440341">//&nbsp;Internet&nbsp;protocol&nbsp;family&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1440378">package</span>&nbsp;<span class="ident" id="1440386">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1440391">import</span>&nbsp;<span class="op" id="1440398">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1440401">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1440411">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="1440418">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1440421">var</span>&nbsp;<span class="op" id="1440425">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440428">//&nbsp;supportsIPv4&nbsp;reports&nbsp;whether&nbsp;the&nbsp;platform&nbsp;supports&nbsp;IPv4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440488">//&nbsp;networking&nbsp;functionality.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440518">supportsIPv4</span>&nbsp;<span class="builtintype" id="1440531">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440538">//&nbsp;supportsIPv6&nbsp;reports&nbsp;whether&nbsp;the&nbsp;platform&nbsp;supports&nbsp;IPv6</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440598">//&nbsp;networking&nbsp;functionality.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440628">supportsIPv6</span>&nbsp;<span class="builtintype" id="1440641">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440648">//&nbsp;supportsIPv4map&nbsp;reports&nbsp;whether&nbsp;the&nbsp;platform&nbsp;supports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440706">//&nbsp;mapping&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;inside&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;at&nbsp;transport</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1440770">//&nbsp;layer&nbsp;protocols.&nbsp;&nbsp;See&nbsp;RFC&nbsp;4291,&nbsp;RFC&nbsp;4038&nbsp;and&nbsp;RFC&nbsp;3493.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440829">supportsIPv4map</span>&nbsp;<span class="builtintype" id="1440845">bool</span><br>
<span class="lineno"></span><span class="op" id="1440850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1440853">func</span>&nbsp;<span class="ident" id="1440858">init</span><span class="op" id="1440862">(</span><span class="op" id="1440863">)</span>&nbsp;<span class="op" id="1440865">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440868"><a href="/net/fd_unix.go.html#1388573">sysInit</a></span><span class="op" id="1440875">(</span><span class="op" id="1440876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440879"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="1440892">=</span>&nbsp;<span class="ident" id="1440894"><a href="/net/ipsock_posix.go.html#1448745">probeIPv4Stack</a></span><span class="op" id="1440908">(</span><span class="op" id="1440909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1440912"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span><span class="op" id="1440924">,</span>&nbsp;<span class="ident" id="1440926"><a href="/net/ipsock.go.html#1440829">supportsIPv4map</a></span>&nbsp;<span class="op" id="1440942">=</span>&nbsp;<span class="ident" id="1440944"><a href="/net/ipsock_posix.go.html#1449735">probeIPv6Stack</a></span><span class="op" id="1440958">(</span><span class="op" id="1440959">)</span><br>
<span class="lineno"></span><span class="op" id="1440961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="1440964">//&nbsp;A&nbsp;netaddr&nbsp;represents&nbsp;a&nbsp;network&nbsp;endpoint&nbsp;address&nbsp;or&nbsp;a&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1441028">//&nbsp;network&nbsp;endpoint&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="1441059">type</span>&nbsp;<span class="ident" id="1441064">netaddr</span>&nbsp;<span class="keyword" id="1441072">interface</span>&nbsp;<span class="op" id="1441082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441085">//&nbsp;toAddr&nbsp;returns&nbsp;the&nbsp;address&nbsp;represented&nbsp;in&nbsp;Addr&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441147">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;nil&nbsp;interface&nbsp;when&nbsp;the&nbsp;address&nbsp;is&nbsp;nil.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1441203">toAddr</span><span class="op" id="1441209">(</span><span class="op" id="1441210">)</span>&nbsp;<span class="ident" id="1441212"><a href="/net/net.go.html#1465097">Addr</a></span><br>
<span class="lineno"></span><span class="op" id="1441217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1441220">//&nbsp;An&nbsp;addrList&nbsp;represents&nbsp;a&nbsp;list&nbsp;of&nbsp;network&nbsp;endpoint&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="1441284">type</span>&nbsp;<span class="ident" id="1441289">addrList</span>&nbsp;<span class="op" id="1441298">[</span><span class="op" id="1441299">]</span><span class="ident" id="1441300"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="1441309">func</span>&nbsp;<span class="op" id="1441314">(</span><span class="ident" id="1441315">al</span>&nbsp;<span class="ident" id="1441318"><a href="/net/ipsock.go.html#1441289">addrList</a></span><span class="op" id="1441326">)</span>&nbsp;<span class="ident" id="1441328">toAddr</span><span class="op" id="1441334">(</span><span class="op" id="1441335">)</span>&nbsp;<span class="ident" id="1441337"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1441342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441345">switch</span>&nbsp;<span class="builtinfunc" id="1441352">len</span><span class="op" id="1441355">(</span><span class="ident" id="1441356"><a href="/net/ipsock.go.html#1441315">al</a></span><span class="op" id="1441358">)</span>&nbsp;<span class="op" id="1441360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441363">case</span>&nbsp;<span class="num" id="1441368">0</span><span class="op" id="1441369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441373">return</span>&nbsp;<span class="ident" id="1441380">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441385">case</span>&nbsp;<span class="num" id="1441390">1</span><span class="op" id="1441391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441395">return</span>&nbsp;<span class="ident" id="1441402"><a href="/net/ipsock.go.html#1441315">al</a></span><span class="op" id="1441404">[</span><span class="num" id="1441405">0</span><span class="op" id="1441406">]</span><span class="op" id="1441407">.</span><span class="ident" id="1441408">toAddr</span><span class="op" id="1441414">(</span><span class="op" id="1441415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441418">default</span><span class="op" id="1441425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441429">//&nbsp;For&nbsp;now,&nbsp;we&#39;ll&nbsp;roughly&nbsp;pick&nbsp;first&nbsp;one&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441480">//&nbsp;considering&nbsp;dealing&nbsp;with&nbsp;any&nbsp;preferences&nbsp;such&nbsp;as</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441534">//&nbsp;DNS&nbsp;TTL,&nbsp;transport&nbsp;path&nbsp;quality,&nbsp;network&nbsp;routing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1441588">//&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1441606">return</span>&nbsp;<span class="ident" id="1441613"><a href="/net/ipsock.go.html#1441315">al</a></span><span class="op" id="1441615">[</span><span class="num" id="1441616">0</span><span class="op" id="1441617">]</span><span class="op" id="1441618">.</span><span class="ident" id="1441619">toAddr</span><span class="op" id="1441625">(</span><span class="op" id="1441626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1441629">}</span><br>
<span class="lineno"></span><span class="op" id="1441631">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="1441634">var</span>&nbsp;<span class="ident" id="1441638">errNoSuitableAddress</span>&nbsp;<span class="op" id="1441659">=</span>&nbsp;<span class="ident" id="1441661"><a href="/net/ipsock.go.html#1440401">errors</a></span><span class="op" id="1441667">.</span><span class="ident" id="1441668">New</span><span class="op" id="1441671">(</span><span class="string" id="1441672">&#34;no&nbsp;suitable&nbsp;address&nbsp;found&#34;</span><span class="op" id="1441699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1441702">//&nbsp;firstFavoriteAddr&nbsp;returns&nbsp;an&nbsp;address&nbsp;or&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1441770">//&nbsp;implement&nbsp;the&nbsp;netaddr&nbsp;interface.&nbsp;Known&nbsp;filters&nbsp;are&nbsp;nil,&nbsp;ipv4only</span><br>
<span class="lineno">65</span><span class="comment" id="1441838">//&nbsp;and&nbsp;ipv6only.&nbsp;It&nbsp;returns&nbsp;any&nbsp;address&nbsp;when&nbsp;filter&nbsp;is&nbsp;nil.&nbsp;The&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="1441909">//&nbsp;contains&nbsp;at&nbsp;least&nbsp;one&nbsp;address&nbsp;when&nbsp;error&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1441961">func</span>&nbsp;<span class="ident" id="1441966">firstFavoriteAddr</span><span class="op" id="1441983">(</span><span class="ident" id="1441984">filter</span>&nbsp;<span class="keyword" id="1441991">func</span><span class="op" id="1441995">(</span><span class="ident" id="1441996"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1441998">)</span>&nbsp;<span class="ident" id="1442000"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1442002">,</span>&nbsp;<span class="ident" id="1442004">ips</span>&nbsp;<span class="op" id="1442008">[</span><span class="op" id="1442009">]</span><span class="ident" id="1442010"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1442012">,</span>&nbsp;<span class="ident" id="1442014">inetaddr</span>&nbsp;<span class="keyword" id="1442023">func</span><span class="op" id="1442027">(</span><span class="ident" id="1442028"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1442030">)</span>&nbsp;<span class="ident" id="1442032"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><span class="op" id="1442039">)</span>&nbsp;<span class="op" id="1442041">(</span><span class="ident" id="1442042"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><span class="op" id="1442049">,</span>&nbsp;<span class="builtintype" id="1442051">error</span><span class="op" id="1442056">)</span>&nbsp;<span class="op" id="1442058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442061">if</span>&nbsp;<span class="ident" id="1442064"><a href="/net/ipsock.go.html#1441984">filter</a></span>&nbsp;<span class="op" id="1442071">!=</span>&nbsp;<span class="ident" id="1442074">nil</span>&nbsp;<span class="op" id="1442078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442082">return</span>&nbsp;<span class="ident" id="1442089"><a href="/net/ipsock.go.html#1443012">firstSupportedAddr</a></span><span class="op" id="1442107">(</span><span class="ident" id="1442108"><a href="/net/ipsock.go.html#1441984">filter</a></span><span class="op" id="1442114">,</span>&nbsp;<span class="ident" id="1442116"><a href="/net/ipsock.go.html#1442004">ips</a></span><span class="op" id="1442119">,</span>&nbsp;<span class="ident" id="1442121"><a href="/net/ipsock.go.html#1442014">inetaddr</a></span><span class="op" id="1442129">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442135">var</span>&nbsp;<span class="op" id="1442139">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442143">ipv4</span><span class="op" id="1442147">,</span>&nbsp;<span class="ident" id="1442149">ipv6</span><span class="op" id="1442153">,</span>&nbsp;<span class="ident" id="1442155">swap</span>&nbsp;<span class="builtintype" id="1442160">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442167">list</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1442184"><a href="/net/ipsock.go.html#1441289">addrList</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442194">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442197">for</span>&nbsp;<span class="ident" id="1442201">_</span><span class="op" id="1442202">,</span>&nbsp;<span class="ident" id="1442204">ip</span>&nbsp;<span class="op" id="1442207">:=</span>&nbsp;<span class="keyword" id="1442210">range</span>&nbsp;<span class="ident" id="1442216"><a href="/net/ipsock.go.html#1442004">ips</a></span>&nbsp;<span class="op" id="1442220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442224">//&nbsp;We&#39;ll&nbsp;take&nbsp;any&nbsp;IP&nbsp;address,&nbsp;but&nbsp;since&nbsp;the&nbsp;dialing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442278">//&nbsp;code&nbsp;does&nbsp;not&nbsp;yet&nbsp;try&nbsp;multiple&nbsp;addresses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442324">//&nbsp;effectively,&nbsp;prefer&nbsp;to&nbsp;use&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442375">//&nbsp;possible.&nbsp;This&nbsp;is&nbsp;especially&nbsp;relevant&nbsp;if&nbsp;localhost</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442431">//&nbsp;resolves&nbsp;to&nbsp;[ipv6-localhost,&nbsp;ipv4-localhost].&nbsp;Too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1442486">//&nbsp;much&nbsp;code&nbsp;assumes&nbsp;localhost&nbsp;==&nbsp;ipv4-localhost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442538">if</span>&nbsp;<span class="ident" id="1442541">ip4</span>&nbsp;<span class="op" id="1442545">:=</span>&nbsp;<span class="ident" id="1442548"><a href="/net/ipsock.go.html#1443416">ipv4only</a></span><span class="op" id="1442556">(</span><span class="ident" id="1442557"><a href="/net/ipsock.go.html#1442204">ip</a></span><span class="op" id="1442559">)</span><span class="op" id="1442560">;</span>&nbsp;<span class="ident" id="1442562"><a href="/net/ipsock.go.html#1442541">ip4</a></span>&nbsp;<span class="op" id="1442566">!=</span>&nbsp;<span class="ident" id="1442569">nil</span>&nbsp;<span class="op" id="1442573">&amp;&amp;</span>&nbsp;<span class="op" id="1442576">!</span><span class="ident" id="1442577"><a href="/net/ipsock.go.html#1442143">ipv4</a></span>&nbsp;<span class="op" id="1442582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442587"><a href="/net/ipsock.go.html#1442167">list</a></span>&nbsp;<span class="op" id="1442592">=</span>&nbsp;<span class="builtinfunc" id="1442594">append</span><span class="op" id="1442600">(</span><span class="ident" id="1442601"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442605">,</span>&nbsp;<span class="ident" id="1442607"><a href="/net/ipsock.go.html#1442014">inetaddr</a></span><span class="op" id="1442615">(</span><span class="ident" id="1442616"><a href="/net/ipsock.go.html#1442541">ip4</a></span><span class="op" id="1442619">)</span><span class="op" id="1442620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442625"><a href="/net/ipsock.go.html#1442143">ipv4</a></span>&nbsp;<span class="op" id="1442630">=</span>&nbsp;<span class="builtintype" id="1442632">true</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442640">if</span>&nbsp;<span class="ident" id="1442643"><a href="/net/ipsock.go.html#1442149">ipv6</a></span>&nbsp;<span class="op" id="1442648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442654"><a href="/net/ipsock.go.html#1442155">swap</a></span>&nbsp;<span class="op" id="1442659">=</span>&nbsp;<span class="builtintype" id="1442661">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442673">}</span>&nbsp;<span class="keyword" id="1442675">else</span>&nbsp;<span class="keyword" id="1442680">if</span>&nbsp;<span class="ident" id="1442683">ip6</span>&nbsp;<span class="op" id="1442687">:=</span>&nbsp;<span class="ident" id="1442690"><a href="/net/ipsock.go.html#1443711">ipv6only</a></span><span class="op" id="1442698">(</span><span class="ident" id="1442699"><a href="/net/ipsock.go.html#1442204">ip</a></span><span class="op" id="1442701">)</span><span class="op" id="1442702">;</span>&nbsp;<span class="ident" id="1442704"><a href="/net/ipsock.go.html#1442683">ip6</a></span>&nbsp;<span class="op" id="1442708">!=</span>&nbsp;<span class="ident" id="1442711">nil</span>&nbsp;<span class="op" id="1442715">&amp;&amp;</span>&nbsp;<span class="op" id="1442718">!</span><span class="ident" id="1442719"><a href="/net/ipsock.go.html#1442149">ipv6</a></span>&nbsp;<span class="op" id="1442724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442729"><a href="/net/ipsock.go.html#1442167">list</a></span>&nbsp;<span class="op" id="1442734">=</span>&nbsp;<span class="builtinfunc" id="1442736">append</span><span class="op" id="1442742">(</span><span class="ident" id="1442743"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442747">,</span>&nbsp;<span class="ident" id="1442749"><a href="/net/ipsock.go.html#1442014">inetaddr</a></span><span class="op" id="1442757">(</span><span class="ident" id="1442758"><a href="/net/ipsock.go.html#1442683">ip6</a></span><span class="op" id="1442761">)</span><span class="op" id="1442762">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442767"><a href="/net/ipsock.go.html#1442149">ipv6</a></span>&nbsp;<span class="op" id="1442772">=</span>&nbsp;<span class="builtintype" id="1442774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442785">if</span>&nbsp;<span class="ident" id="1442788"><a href="/net/ipsock.go.html#1442143">ipv4</a></span>&nbsp;<span class="op" id="1442793">&amp;&amp;</span>&nbsp;<span class="ident" id="1442796"><a href="/net/ipsock.go.html#1442149">ipv6</a></span>&nbsp;<span class="op" id="1442801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442806">if</span>&nbsp;<span class="ident" id="1442809"><a href="/net/ipsock.go.html#1442155">swap</a></span>&nbsp;<span class="op" id="1442814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1442820"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442824">[</span><span class="num" id="1442825">0</span><span class="op" id="1442826">]</span><span class="op" id="1442827">,</span>&nbsp;<span class="ident" id="1442829"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442833">[</span><span class="num" id="1442834">1</span><span class="op" id="1442835">]</span>&nbsp;<span class="op" id="1442837">=</span>&nbsp;<span class="ident" id="1442839"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442843">[</span><span class="num" id="1442844">1</span><span class="op" id="1442845">]</span><span class="op" id="1442846">,</span>&nbsp;<span class="ident" id="1442848"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442852">[</span><span class="num" id="1442853">0</span><span class="op" id="1442854">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442864">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1442875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442878">switch</span>&nbsp;<span class="builtinfunc" id="1442885">len</span><span class="op" id="1442888">(</span><span class="ident" id="1442889"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442893">)</span>&nbsp;<span class="op" id="1442895">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442898">case</span>&nbsp;<span class="num" id="1442903">0</span><span class="op" id="1442904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442908">return</span>&nbsp;<span class="ident" id="1442915">nil</span><span class="op" id="1442918">,</span>&nbsp;<span class="ident" id="1442920"><a href="/net/ipsock.go.html#1441638">errNoSuitableAddress</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442942">case</span>&nbsp;<span class="num" id="1442947">1</span><span class="op" id="1442948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442952">return</span>&nbsp;<span class="ident" id="1442959"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442963">[</span><span class="num" id="1442964">0</span><span class="op" id="1442965">]</span><span class="op" id="1442966">,</span>&nbsp;<span class="ident" id="1442968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442973">default</span><span class="op" id="1442980">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1442984">return</span>&nbsp;<span class="ident" id="1442991"><a href="/net/ipsock.go.html#1442167">list</a></span><span class="op" id="1442995">,</span>&nbsp;<span class="ident" id="1442997">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443002">}</span><br>
<span class="lineno"></span><span class="op" id="1443004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1443007">func</span>&nbsp;<span class="ident" id="1443012">firstSupportedAddr</span><span class="op" id="1443030">(</span><span class="ident" id="1443031">filter</span>&nbsp;<span class="keyword" id="1443038">func</span><span class="op" id="1443042">(</span><span class="ident" id="1443043"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443045">)</span>&nbsp;<span class="ident" id="1443047"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443049">,</span>&nbsp;<span class="ident" id="1443051">ips</span>&nbsp;<span class="op" id="1443055">[</span><span class="op" id="1443056">]</span><span class="ident" id="1443057"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443059">,</span>&nbsp;<span class="ident" id="1443061">inetaddr</span>&nbsp;<span class="keyword" id="1443070">func</span><span class="op" id="1443074">(</span><span class="ident" id="1443075"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443077">)</span>&nbsp;<span class="ident" id="1443079"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><span class="op" id="1443086">)</span>&nbsp;<span class="op" id="1443088">(</span><span class="ident" id="1443089"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><span class="op" id="1443096">,</span>&nbsp;<span class="builtintype" id="1443098">error</span><span class="op" id="1443103">)</span>&nbsp;<span class="op" id="1443105">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443108">for</span>&nbsp;<span class="ident" id="1443112">_</span><span class="op" id="1443113">,</span>&nbsp;<span class="ident" id="1443115">ip</span>&nbsp;<span class="op" id="1443118">:=</span>&nbsp;<span class="keyword" id="1443121">range</span>&nbsp;<span class="ident" id="1443127"><a href="/net/ipsock.go.html#1443051">ips</a></span>&nbsp;<span class="op" id="1443131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443135">if</span>&nbsp;<span class="ident" id="1443138">ip</span>&nbsp;<span class="op" id="1443141">:=</span>&nbsp;<span class="ident" id="1443144"><a href="/net/ipsock.go.html#1443031">filter</a></span><span class="op" id="1443150">(</span><span class="ident" id="1443151"><a href="/net/ipsock.go.html#1443115">ip</a></span><span class="op" id="1443153">)</span><span class="op" id="1443154">;</span>&nbsp;<span class="ident" id="1443156"><a href="/net/ipsock.go.html#1443138">ip</a></span>&nbsp;<span class="op" id="1443159">!=</span>&nbsp;<span class="ident" id="1443162">nil</span>&nbsp;<span class="op" id="1443166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443171">return</span>&nbsp;<span class="ident" id="1443178"><a href="/net/ipsock.go.html#1443061">inetaddr</a></span><span class="op" id="1443186">(</span><span class="ident" id="1443187"><a href="/net/ipsock.go.html#1443138">ip</a></span><span class="op" id="1443189">)</span><span class="op" id="1443190">,</span>&nbsp;<span class="ident" id="1443192">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443201">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443204">return</span>&nbsp;<span class="ident" id="1443211">nil</span><span class="op" id="1443214">,</span>&nbsp;<span class="ident" id="1443216"><a href="/net/ipsock.go.html#1441638">errNoSuitableAddress</a></span><br>
<span class="lineno"></span><span class="op" id="1443237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1443240">//&nbsp;ipv4only&nbsp;returns&nbsp;IPv4&nbsp;addresses&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;with&nbsp;the&nbsp;kernel&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="1443309">//&nbsp;IPv4&nbsp;addressing&nbsp;modes.&nbsp;If&nbsp;ip&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;ipv4only&nbsp;returns&nbsp;ip.</span><br>
<span class="lineno">120</span><span class="comment" id="1443382">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1443411">func</span>&nbsp;<span class="ident" id="1443416">ipv4only</span><span class="op" id="1443424">(</span><span class="ident" id="1443425">ip</span>&nbsp;<span class="ident" id="1443428"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443430">)</span>&nbsp;<span class="ident" id="1443432"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1443435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443438">if</span>&nbsp;<span class="ident" id="1443441"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="1443454">&amp;&amp;</span>&nbsp;<span class="ident" id="1443457"><a href="/net/ipsock.go.html#1443425">ip</a></span><span class="op" id="1443459">.</span><span class="ident" id="1443460">To4</span><span class="op" id="1443463">(</span><span class="op" id="1443464">)</span>&nbsp;<span class="op" id="1443466">!=</span>&nbsp;<span class="ident" id="1443469">nil</span>&nbsp;<span class="op" id="1443473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443477">return</span>&nbsp;<span class="ident" id="1443484"><a href="/net/ipsock.go.html#1443425">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443488">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443491">return</span>&nbsp;<span class="ident" id="1443498">nil</span><br>
<span class="lineno"></span><span class="op" id="1443502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1443505">//&nbsp;ipv6only&nbsp;returns&nbsp;IPv6&nbsp;addresses&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;with&nbsp;the&nbsp;kernel&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="1443574">//&nbsp;IPv6&nbsp;addressing&nbsp;modes.&nbsp;&nbsp;It&nbsp;returns&nbsp;IPv4-mapped&nbsp;IPv6&nbsp;addresses&nbsp;as</span><br>
<span class="lineno">130</span><span class="comment" id="1443642">//&nbsp;nils&nbsp;and&nbsp;returns&nbsp;other&nbsp;IPv6&nbsp;address&nbsp;types&nbsp;as&nbsp;IPv6&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="1443706">func</span>&nbsp;<span class="ident" id="1443711">ipv6only</span><span class="op" id="1443719">(</span><span class="ident" id="1443720">ip</span>&nbsp;<span class="ident" id="1443723"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1443725">)</span>&nbsp;<span class="ident" id="1443727"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1443730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443733">if</span>&nbsp;<span class="ident" id="1443736"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="1443749">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1443752">len</span><span class="op" id="1443755">(</span><span class="ident" id="1443756"><a href="/net/ipsock.go.html#1443720">ip</a></span><span class="op" id="1443758">)</span>&nbsp;<span class="op" id="1443760">==</span>&nbsp;<span class="ident" id="1443763"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1443771">&amp;&amp;</span>&nbsp;<span class="ident" id="1443774"><a href="/net/ipsock.go.html#1443720">ip</a></span><span class="op" id="1443776">.</span><span class="ident" id="1443777">To4</span><span class="op" id="1443780">(</span><span class="op" id="1443781">)</span>&nbsp;<span class="op" id="1443783">==</span>&nbsp;<span class="ident" id="1443786">nil</span>&nbsp;<span class="op" id="1443790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443794">return</span>&nbsp;<span class="ident" id="1443801"><a href="/net/ipsock.go.html#1443720">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1443805">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1443808">return</span>&nbsp;<span class="ident" id="1443815">nil</span><br>
<span class="lineno"></span><span class="op" id="1443819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1443822">//&nbsp;SplitHostPort&nbsp;splits&nbsp;a&nbsp;network&nbsp;address&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host:port&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="1443889">//&nbsp;&#34;[host]:port&#34;&nbsp;or&nbsp;&#34;[ipv6-host%zone]:port&#34;&nbsp;into&nbsp;host&nbsp;or</span><br>
<span class="lineno">140</span><span class="comment" id="1443946">//&nbsp;ipv6-host%zone&nbsp;and&nbsp;port.&nbsp;&nbsp;A&nbsp;literal&nbsp;address&nbsp;or&nbsp;host&nbsp;name&nbsp;for&nbsp;IPv6</span><br>
<span class="lineno"></span><span class="comment" id="1444015">//&nbsp;must&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;square&nbsp;brackets,&nbsp;as&nbsp;in&nbsp;&#34;[::1]:80&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="1444073">//&nbsp;&#34;[ipv6-host]:http&#34;&nbsp;or&nbsp;&#34;[ipv6-host%zone]:80&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="1444121">func</span>&nbsp;<span class="ident" id="1444126">SplitHostPort</span><span class="op" id="1444139">(</span><span class="ident" id="1444140">hostport</span>&nbsp;<span class="builtintype" id="1444149">string</span><span class="op" id="1444155">)</span>&nbsp;<span class="op" id="1444157">(</span><span class="ident" id="1444158">host</span><span class="op" id="1444162">,</span>&nbsp;<span class="ident" id="1444164">port</span>&nbsp;<span class="builtintype" id="1444169">string</span><span class="op" id="1444175">,</span>&nbsp;<span class="ident" id="1444177">err</span>&nbsp;<span class="builtintype" id="1444181">error</span><span class="op" id="1444186">)</span>&nbsp;<span class="op" id="1444188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444191">j</span><span class="op" id="1444192">,</span>&nbsp;<span class="ident" id="1444194">k</span>&nbsp;<span class="op" id="1444196">:=</span>&nbsp;<span class="num" id="1444199">0</span><span class="op" id="1444200">,</span>&nbsp;<span class="num" id="1444202">0</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444206">//&nbsp;The&nbsp;port&nbsp;starts&nbsp;after&nbsp;the&nbsp;last&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444248">i</span>&nbsp;<span class="op" id="1444250">:=</span>&nbsp;<span class="ident" id="1444253"><a href="/net/parse.go.html#1480058">last</a></span><span class="op" id="1444257">(</span><span class="ident" id="1444258"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444266">,</span>&nbsp;<span class="string" id="1444268">&#39;:&#39;</span><span class="op" id="1444271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444274">if</span>&nbsp;<span class="ident" id="1444277"><a href="/net/ipsock.go.html#1444248">i</a></span>&nbsp;<span class="op" id="1444279">&lt;</span>&nbsp;<span class="num" id="1444281">0</span>&nbsp;<span class="op" id="1444283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444287">goto</span>&nbsp;<span class="ident" id="1444292">missingPort</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444309">if</span>&nbsp;<span class="ident" id="1444312"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444320">[</span><span class="num" id="1444321">0</span><span class="op" id="1444322">]</span>&nbsp;<span class="op" id="1444324">==</span>&nbsp;<span class="string" id="1444327">&#39;[&#39;</span>&nbsp;<span class="op" id="1444331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444335">//&nbsp;Expect&nbsp;the&nbsp;first&nbsp;&#39;]&#39;&nbsp;just&nbsp;before&nbsp;the&nbsp;last&nbsp;&#39;:&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444387">end</span>&nbsp;<span class="op" id="1444391">:=</span>&nbsp;<span class="ident" id="1444394"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1444403">(</span><span class="ident" id="1444404"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444412">,</span>&nbsp;<span class="string" id="1444414">&#39;]&#39;</span><span class="op" id="1444417">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444421">if</span>&nbsp;<span class="ident" id="1444424"><a href="/net/ipsock.go.html#1444387">end</a></span>&nbsp;<span class="op" id="1444428">&lt;</span>&nbsp;<span class="num" id="1444430">0</span>&nbsp;<span class="op" id="1444432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444437"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1444441">=</span>&nbsp;<span class="op" id="1444443">&amp;</span><span class="ident" id="1444444"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1444453">{</span><span class="string" id="1444454">&#34;missing&nbsp;&#39;]&#39;&nbsp;in&nbsp;address&#34;</span><span class="op" id="1444478">,</span>&nbsp;<span class="ident" id="1444480"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444506">switch</span>&nbsp;<span class="ident" id="1444513"><a href="/net/ipsock.go.html#1444387">end</a></span>&nbsp;<span class="op" id="1444517">+</span>&nbsp;<span class="num" id="1444519">1</span>&nbsp;<span class="op" id="1444521">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444525">case</span>&nbsp;<span class="builtinfunc" id="1444530">len</span><span class="op" id="1444533">(</span><span class="ident" id="1444534"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444542">)</span><span class="op" id="1444543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444548">//&nbsp;There&nbsp;can&#39;t&nbsp;be&nbsp;a&nbsp;&#39;:&#39;&nbsp;behind&nbsp;the&nbsp;&#39;]&#39;&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444595">goto</span>&nbsp;<span class="ident" id="1444600">missingPort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444614">case</span>&nbsp;<span class="ident" id="1444619"><a href="/net/ipsock.go.html#1444248">i</a></span><span class="op" id="1444620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444625">//&nbsp;The&nbsp;expected&nbsp;result.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444651">default</span><span class="op" id="1444658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444663">//&nbsp;Either&nbsp;&#39;]&#39;&nbsp;isn&#39;t&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon,&nbsp;or&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1444716">//&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon&nbsp;that&nbsp;is&nbsp;not&nbsp;the&nbsp;last&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444768">if</span>&nbsp;<span class="ident" id="1444771"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444779">[</span><span class="ident" id="1444780"><a href="/net/ipsock.go.html#1444387">end</a></span><span class="op" id="1444783">+</span><span class="num" id="1444784">1</span><span class="op" id="1444785">]</span>&nbsp;<span class="op" id="1444787">==</span>&nbsp;<span class="string" id="1444790">&#39;:&#39;</span>&nbsp;<span class="op" id="1444794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444800">goto</span>&nbsp;<span class="ident" id="1444805">tooManyColons</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444827">goto</span>&nbsp;<span class="ident" id="1444832">missingPort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444850"><a href="/net/ipsock.go.html#1444158">host</a></span>&nbsp;<span class="op" id="1444855">=</span>&nbsp;<span class="ident" id="1444857"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444865">[</span><span class="num" id="1444866">1</span><span class="op" id="1444867">:</span><span class="ident" id="1444868"><a href="/net/ipsock.go.html#1444387">end</a></span><span class="op" id="1444871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444875"><a href="/net/ipsock.go.html#1444191">j</a></span><span class="op" id="1444876">,</span>&nbsp;<span class="ident" id="1444878"><a href="/net/ipsock.go.html#1444194">k</a></span>&nbsp;<span class="op" id="1444880">=</span>&nbsp;<span class="num" id="1444882">1</span><span class="op" id="1444883">,</span>&nbsp;<span class="ident" id="1444885"><a href="/net/ipsock.go.html#1444387">end</a></span><span class="op" id="1444888">+</span><span class="num" id="1444889">1</span>&nbsp;<span class="comment" id="1444891">//&nbsp;there&nbsp;can&#39;t&nbsp;be&nbsp;a&nbsp;&#39;[&#39;&nbsp;resp.&nbsp;&#39;]&#39;&nbsp;before&nbsp;these&nbsp;positions</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1444949">}</span>&nbsp;<span class="keyword" id="1444951">else</span>&nbsp;<span class="op" id="1444956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1444960"><a href="/net/ipsock.go.html#1444158">host</a></span>&nbsp;<span class="op" id="1444965">=</span>&nbsp;<span class="ident" id="1444967"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1444975">[</span><span class="op" id="1444976">:</span><span class="ident" id="1444977"><a href="/net/ipsock.go.html#1444248">i</a></span><span class="op" id="1444978">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1444982">if</span>&nbsp;<span class="ident" id="1444985"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1444994">(</span><span class="ident" id="1444995"><a href="/net/ipsock.go.html#1444158">host</a></span><span class="op" id="1444999">,</span>&nbsp;<span class="string" id="1445001">&#39;:&#39;</span><span class="op" id="1445004">)</span>&nbsp;<span class="op" id="1445006">&gt;=</span>&nbsp;<span class="num" id="1445009">0</span>&nbsp;<span class="op" id="1445011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445016">goto</span>&nbsp;<span class="ident" id="1445021">tooManyColons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445037">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445041">if</span>&nbsp;<span class="ident" id="1445044"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1445053">(</span><span class="ident" id="1445054"><a href="/net/ipsock.go.html#1444158">host</a></span><span class="op" id="1445058">,</span>&nbsp;<span class="string" id="1445060">&#39;%&#39;</span><span class="op" id="1445063">)</span>&nbsp;<span class="op" id="1445065">&gt;=</span>&nbsp;<span class="num" id="1445068">0</span>&nbsp;<span class="op" id="1445070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445075">goto</span>&nbsp;<span class="ident" id="1445080">missingBrackets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445104">if</span>&nbsp;<span class="ident" id="1445107"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1445116">(</span><span class="ident" id="1445117"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445125">[</span><span class="ident" id="1445126"><a href="/net/ipsock.go.html#1444191">j</a></span><span class="op" id="1445127">:</span><span class="op" id="1445128">]</span><span class="op" id="1445129">,</span>&nbsp;<span class="string" id="1445131">&#39;[&#39;</span><span class="op" id="1445134">)</span>&nbsp;<span class="op" id="1445136">&gt;=</span>&nbsp;<span class="num" id="1445139">0</span>&nbsp;<span class="op" id="1445141">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445145"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1445149">=</span>&nbsp;<span class="op" id="1445151">&amp;</span><span class="ident" id="1445152"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1445161">{</span><span class="string" id="1445162">&#34;unexpected&nbsp;&#39;[&#39;&nbsp;in&nbsp;address&#34;</span><span class="op" id="1445189">,</span>&nbsp;<span class="ident" id="1445191"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445203">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445214">if</span>&nbsp;<span class="ident" id="1445217"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1445226">(</span><span class="ident" id="1445227"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445235">[</span><span class="ident" id="1445236"><a href="/net/ipsock.go.html#1444194">k</a></span><span class="op" id="1445237">:</span><span class="op" id="1445238">]</span><span class="op" id="1445239">,</span>&nbsp;<span class="string" id="1445241">&#39;]&#39;</span><span class="op" id="1445244">)</span>&nbsp;<span class="op" id="1445246">&gt;=</span>&nbsp;<span class="num" id="1445249">0</span>&nbsp;<span class="op" id="1445251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445255"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1445259">=</span>&nbsp;<span class="op" id="1445261">&amp;</span><span class="ident" id="1445262"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1445271">{</span><span class="string" id="1445272">&#34;unexpected&nbsp;&#39;]&#39;&nbsp;in&nbsp;address&#34;</span><span class="op" id="1445299">,</span>&nbsp;<span class="ident" id="1445301"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445309">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445313">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445325"><a href="/net/ipsock.go.html#1444164">port</a></span>&nbsp;<span class="op" id="1445330">=</span>&nbsp;<span class="ident" id="1445332"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445340">[</span><span class="ident" id="1445341"><a href="/net/ipsock.go.html#1444248">i</a></span><span class="op" id="1445342">+</span><span class="num" id="1445343">1</span><span class="op" id="1445344">:</span><span class="op" id="1445345">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445348">return</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="ident" id="1445356">missingPort</span><span class="op" id="1445367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445370"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1445374">=</span>&nbsp;<span class="op" id="1445376">&amp;</span><span class="ident" id="1445377"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1445386">{</span><span class="string" id="1445387">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op" id="1445412">,</span>&nbsp;<span class="ident" id="1445414"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445425">return</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="ident" id="1445433">tooManyColons</span><span class="op" id="1445446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445449"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1445453">=</span>&nbsp;<span class="op" id="1445455">&amp;</span><span class="ident" id="1445456"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1445465">{</span><span class="string" id="1445466">&#34;too&nbsp;many&nbsp;colons&nbsp;in&nbsp;address&#34;</span><span class="op" id="1445494">,</span>&nbsp;<span class="ident" id="1445496"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445507">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1445515">missingBrackets</span><span class="op" id="1445530">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445533"><a href="/net/ipsock.go.html#1444177">err</a></span>&nbsp;<span class="op" id="1445537">=</span>&nbsp;<span class="op" id="1445539">&amp;</span><span class="ident" id="1445540"><a href="/net/net.go.html#1473565">AddrError</a></span><span class="op" id="1445549">{</span><span class="string" id="1445550">&#34;missing&nbsp;brackets&nbsp;in&nbsp;address&#34;</span><span class="op" id="1445579">,</span>&nbsp;<span class="ident" id="1445581"><a href="/net/ipsock.go.html#1444140">hostport</a></span><span class="op" id="1445589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445592">return</span><br>
<span class="lineno"></span><span class="op" id="1445599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1445602">func</span>&nbsp;<span class="ident" id="1445607">splitHostZone</span><span class="op" id="1445620">(</span><span class="ident" id="1445621">s</span>&nbsp;<span class="builtintype" id="1445623">string</span><span class="op" id="1445629">)</span>&nbsp;<span class="op" id="1445631">(</span><span class="ident" id="1445632">host</span><span class="op" id="1445636">,</span>&nbsp;<span class="ident" id="1445638">zone</span>&nbsp;<span class="builtintype" id="1445643">string</span><span class="op" id="1445649">)</span>&nbsp;<span class="op" id="1445651">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445654">//&nbsp;The&nbsp;IPv6&nbsp;scoped&nbsp;addressing&nbsp;zone&nbsp;identifier&nbsp;starts&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1445718">//&nbsp;last&nbsp;percent&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445741">if</span>&nbsp;<span class="ident" id="1445744">i</span>&nbsp;<span class="op" id="1445746">:=</span>&nbsp;<span class="ident" id="1445749"><a href="/net/parse.go.html#1480058">last</a></span><span class="op" id="1445753">(</span><span class="ident" id="1445754"><a href="/net/ipsock.go.html#1445621">s</a></span><span class="op" id="1445755">,</span>&nbsp;<span class="string" id="1445757">&#39;%&#39;</span><span class="op" id="1445760">)</span><span class="op" id="1445761">;</span>&nbsp;<span class="ident" id="1445763"><a href="/net/ipsock.go.html#1445744">i</a></span>&nbsp;<span class="op" id="1445765">&gt;</span>&nbsp;<span class="num" id="1445767">0</span>&nbsp;<span class="op" id="1445769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445773"><a href="/net/ipsock.go.html#1445632">host</a></span><span class="op" id="1445777">,</span>&nbsp;<span class="ident" id="1445779"><a href="/net/ipsock.go.html#1445638">zone</a></span>&nbsp;<span class="op" id="1445784">=</span>&nbsp;<span class="ident" id="1445786"><a href="/net/ipsock.go.html#1445621">s</a></span><span class="op" id="1445787">[</span><span class="op" id="1445788">:</span><span class="ident" id="1445789"><a href="/net/ipsock.go.html#1445744">i</a></span><span class="op" id="1445790">]</span><span class="op" id="1445791">,</span>&nbsp;<span class="ident" id="1445793"><a href="/net/ipsock.go.html#1445621">s</a></span><span class="op" id="1445794">[</span><span class="ident" id="1445795"><a href="/net/ipsock.go.html#1445744">i</a></span><span class="op" id="1445796">+</span><span class="num" id="1445797">1</span><span class="op" id="1445798">:</span><span class="op" id="1445799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445802">}</span>&nbsp;<span class="keyword" id="1445804">else</span>&nbsp;<span class="op" id="1445809">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1445813"><a href="/net/ipsock.go.html#1445632">host</a></span>&nbsp;<span class="op" id="1445818">=</span>&nbsp;<span class="ident" id="1445820"><a href="/net/ipsock.go.html#1445621">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1445823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1445826">return</span><br>
<span class="lineno"></span><span class="op" id="1445833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="1445836">//&nbsp;JoinHostPort&nbsp;combines&nbsp;host&nbsp;and&nbsp;port&nbsp;into&nbsp;a&nbsp;network&nbsp;address&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1445905">//&nbsp;form&nbsp;&#34;host:port&#34;&nbsp;or,&nbsp;if&nbsp;host&nbsp;contains&nbsp;a&nbsp;colon&nbsp;or&nbsp;a&nbsp;percent&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="1445973">//&nbsp;&#34;[host]:port&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="1445991">func</span>&nbsp;<span class="ident" id="1445996">JoinHostPort</span><span class="op" id="1446008">(</span><span class="ident" id="1446009">host</span><span class="op" id="1446013">,</span>&nbsp;<span class="ident" id="1446015">port</span>&nbsp;<span class="builtintype" id="1446020">string</span><span class="op" id="1446026">)</span>&nbsp;<span class="builtintype" id="1446028">string</span>&nbsp;<span class="op" id="1446035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1446038">//&nbsp;If&nbsp;host&nbsp;has&nbsp;colons&nbsp;or&nbsp;a&nbsp;percent&nbsp;sign,&nbsp;have&nbsp;to&nbsp;bracket&nbsp;it.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446100">if</span>&nbsp;<span class="ident" id="1446103"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1446112">(</span><span class="ident" id="1446113"><a href="/net/ipsock.go.html#1446009">host</a></span><span class="op" id="1446117">,</span>&nbsp;<span class="string" id="1446119">&#39;:&#39;</span><span class="op" id="1446122">)</span>&nbsp;<span class="op" id="1446124">&gt;=</span>&nbsp;<span class="num" id="1446127">0</span>&nbsp;<span class="op" id="1446129">||</span>&nbsp;<span class="ident" id="1446132"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1446141">(</span><span class="ident" id="1446142"><a href="/net/ipsock.go.html#1446009">host</a></span><span class="op" id="1446146">,</span>&nbsp;<span class="string" id="1446148">&#39;%&#39;</span><span class="op" id="1446151">)</span>&nbsp;<span class="op" id="1446153">&gt;=</span>&nbsp;<span class="num" id="1446156">0</span>&nbsp;<span class="op" id="1446158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446162">return</span>&nbsp;<span class="string" id="1446169">&#34;[&#34;</span>&nbsp;<span class="op" id="1446173">+</span>&nbsp;<span class="ident" id="1446175"><a href="/net/ipsock.go.html#1446009">host</a></span>&nbsp;<span class="op" id="1446180">+</span>&nbsp;<span class="string" id="1446182">&#34;]:&#34;</span>&nbsp;<span class="op" id="1446187">+</span>&nbsp;<span class="ident" id="1446189"><a href="/net/ipsock.go.html#1446015">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446198">return</span>&nbsp;<span class="ident" id="1446205"><a href="/net/ipsock.go.html#1446009">host</a></span>&nbsp;<span class="op" id="1446210">+</span>&nbsp;<span class="string" id="1446212">&#34;:&#34;</span>&nbsp;<span class="op" id="1446216">+</span>&nbsp;<span class="ident" id="1446218"><a href="/net/ipsock.go.html#1446015">port</a></span><br>
<span class="lineno"></span><span class="op" id="1446223">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="1446226">//&nbsp;resolveInternetAddr&nbsp;resolves&nbsp;addr&nbsp;that&nbsp;is&nbsp;either&nbsp;a&nbsp;literal&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="1446291">//&nbsp;address&nbsp;or&nbsp;a&nbsp;DNS&nbsp;name&nbsp;and&nbsp;returns&nbsp;an&nbsp;internet&nbsp;protocol&nbsp;family</span><br>
<span class="lineno"></span><span class="comment" id="1446356">//&nbsp;address.&nbsp;It&nbsp;returns&nbsp;a&nbsp;list&nbsp;that&nbsp;contains&nbsp;a&nbsp;pair&nbsp;of&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="1446420">//&nbsp;address&nbsp;family&nbsp;addresses&nbsp;when&nbsp;addr&nbsp;is&nbsp;a&nbsp;DNS&nbsp;name&nbsp;and&nbsp;the&nbsp;name&nbsp;has</span><br>
<span class="lineno">235</span><span class="comment" id="1446489">//&nbsp;multiple&nbsp;address&nbsp;family&nbsp;records.&nbsp;The&nbsp;result&nbsp;contains&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="1446558">//&nbsp;address&nbsp;when&nbsp;error&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1446588">func</span>&nbsp;<span class="ident" id="1446593">resolveInternetAddr</span><span class="op" id="1446612">(</span><span class="ident" id="1446613">net</span><span class="op" id="1446616">,</span>&nbsp;<span class="ident" id="1446618">addr</span>&nbsp;<span class="builtintype" id="1446623">string</span><span class="op" id="1446629">,</span>&nbsp;<span class="ident" id="1446631">deadline</span>&nbsp;<span class="ident" id="1446640"><a href="/net/ipsock.go.html#1440411">time</a></span><span class="op" id="1446644">.</span><span class="ident" id="1446645">Time</span><span class="op" id="1446649">)</span>&nbsp;<span class="op" id="1446651">(</span><span class="ident" id="1446652"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><span class="op" id="1446659">,</span>&nbsp;<span class="builtintype" id="1446661">error</span><span class="op" id="1446666">)</span>&nbsp;<span class="op" id="1446668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446671">var</span>&nbsp;<span class="op" id="1446675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446679">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1446696">error</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446704">host</span><span class="op" id="1446708">,</span>&nbsp;<span class="ident" id="1446710">port</span><span class="op" id="1446714">,</span>&nbsp;<span class="ident" id="1446716">zone</span>&nbsp;<span class="builtintype" id="1446721">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1446730">portnum</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1446747">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446755">switch</span>&nbsp;<span class="ident" id="1446762"><a href="/net/ipsock.go.html#1446613">net</a></span>&nbsp;<span class="op" id="1446766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446769">case</span>&nbsp;<span class="string" id="1446774">&#34;tcp&#34;</span><span class="op" id="1446779">,</span>&nbsp;<span class="string" id="1446781">&#34;tcp4&#34;</span><span class="op" id="1446787">,</span>&nbsp;<span class="string" id="1446789">&#34;tcp6&#34;</span><span class="op" id="1446795">,</span>&nbsp;<span class="string" id="1446797">&#34;udp&#34;</span><span class="op" id="1446802">,</span>&nbsp;<span class="string" id="1446804">&#34;udp4&#34;</span><span class="op" id="1446810">,</span>&nbsp;<span class="string" id="1446812">&#34;udp6&#34;</span><span class="op" id="1446818">:</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446822">if</span>&nbsp;<span class="ident" id="1446825"><a href="/net/ipsock.go.html#1446618">addr</a></span>&nbsp;<span class="op" id="1446830">!=</span>&nbsp;<span class="string" id="1446833">&#34;&#34;</span>&nbsp;<span class="op" id="1446836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446841">if</span>&nbsp;<span class="ident" id="1446844"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1446848">,</span>&nbsp;<span class="ident" id="1446850"><a href="/net/ipsock.go.html#1446710">port</a></span><span class="op" id="1446854">,</span>&nbsp;<span class="ident" id="1446856"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1446860">=</span>&nbsp;<span class="ident" id="1446862"><a href="/net/ipsock.go.html#1444126">SplitHostPort</a></span><span class="op" id="1446875">(</span><span class="ident" id="1446876"><a href="/net/ipsock.go.html#1446618">addr</a></span><span class="op" id="1446880">)</span><span class="op" id="1446881">;</span>&nbsp;<span class="ident" id="1446883"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1446887">!=</span>&nbsp;<span class="ident" id="1446890">nil</span>&nbsp;<span class="op" id="1446894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446900">return</span>&nbsp;<span class="ident" id="1446907">nil</span><span class="op" id="1446910">,</span>&nbsp;<span class="ident" id="1446912"><a href="/net/ipsock.go.html#1446679">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1446919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446924">if</span>&nbsp;<span class="ident" id="1446927"><a href="/net/ipsock.go.html#1446730">portnum</a></span><span class="op" id="1446934">,</span>&nbsp;<span class="ident" id="1446936"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1446940">=</span>&nbsp;<span class="ident" id="1446942"><a href="/net/port.go.html#1481810">parsePort</a></span><span class="op" id="1446951">(</span><span class="ident" id="1446952"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1446955">,</span>&nbsp;<span class="ident" id="1446957"><a href="/net/ipsock.go.html#1446710">port</a></span><span class="op" id="1446961">)</span><span class="op" id="1446962">;</span>&nbsp;<span class="ident" id="1446964"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1446968">!=</span>&nbsp;<span class="ident" id="1446971">nil</span>&nbsp;<span class="op" id="1446975">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1446981">return</span>&nbsp;<span class="ident" id="1446988">nil</span><span class="op" id="1446991">,</span>&nbsp;<span class="ident" id="1446993"><a href="/net/ipsock.go.html#1446679">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447007">case</span>&nbsp;<span class="string" id="1447012">&#34;ip&#34;</span><span class="op" id="1447016">,</span>&nbsp;<span class="string" id="1447018">&#34;ip4&#34;</span><span class="op" id="1447023">,</span>&nbsp;<span class="string" id="1447025">&#34;ip6&#34;</span><span class="op" id="1447030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447034">if</span>&nbsp;<span class="ident" id="1447037"><a href="/net/ipsock.go.html#1446618">addr</a></span>&nbsp;<span class="op" id="1447042">!=</span>&nbsp;<span class="string" id="1447045">&#34;&#34;</span>&nbsp;<span class="op" id="1447048">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447053"><a href="/net/ipsock.go.html#1446704">host</a></span>&nbsp;<span class="op" id="1447058">=</span>&nbsp;<span class="ident" id="1447060"><a href="/net/ipsock.go.html#1446618">addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447070">default</span><span class="op" id="1447077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447081">return</span>&nbsp;<span class="ident" id="1447088">nil</span><span class="op" id="1447091">,</span>&nbsp;<span class="ident" id="1447093"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1447112">(</span><span class="ident" id="1447113"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447119">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447122">inetaddr</span>&nbsp;<span class="op" id="1447131">:=</span>&nbsp;<span class="keyword" id="1447134">func</span><span class="op" id="1447138">(</span><span class="ident" id="1447139">ip</span>&nbsp;<span class="ident" id="1447142"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1447144">)</span>&nbsp;<span class="ident" id="1447146"><a href="/net/ipsock.go.html#1441064">netaddr</a></span>&nbsp;<span class="op" id="1447154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447158">switch</span>&nbsp;<span class="ident" id="1447165"><a href="/net/ipsock.go.html#1446613">net</a></span>&nbsp;<span class="op" id="1447169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447173">case</span>&nbsp;<span class="string" id="1447178">&#34;tcp&#34;</span><span class="op" id="1447183">,</span>&nbsp;<span class="string" id="1447185">&#34;tcp4&#34;</span><span class="op" id="1447191">,</span>&nbsp;<span class="string" id="1447193">&#34;tcp6&#34;</span><span class="op" id="1447199">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447204">return</span>&nbsp;<span class="op" id="1447211">&amp;</span><span class="ident" id="1447212"><a href="/net/tcpsock.go.html#1504387">TCPAddr</a></span><span class="op" id="1447219">{</span><span class="ident" id="1447220">IP</span><span class="op" id="1447222">:</span>&nbsp;<span class="ident" id="1447224"><a href="/net/ipsock.go.html#1447139">ip</a></span><span class="op" id="1447226">,</span>&nbsp;<span class="ident" id="1447228">Port</span><span class="op" id="1447232">:</span>&nbsp;<span class="ident" id="1447234"><a href="/net/ipsock.go.html#1446730">portnum</a></span><span class="op" id="1447241">,</span>&nbsp;<span class="ident" id="1447243">Zone</span><span class="op" id="1447247">:</span>&nbsp;<span class="ident" id="1447249"><a href="/net/ipsock.go.html#1446716">zone</a></span><span class="op" id="1447253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447257">case</span>&nbsp;<span class="string" id="1447262">&#34;udp&#34;</span><span class="op" id="1447267">,</span>&nbsp;<span class="string" id="1447269">&#34;udp4&#34;</span><span class="op" id="1447275">,</span>&nbsp;<span class="string" id="1447277">&#34;udp6&#34;</span><span class="op" id="1447283">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447288">return</span>&nbsp;<span class="op" id="1447295">&amp;</span><span class="ident" id="1447296"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="1447303">{</span><span class="ident" id="1447304">IP</span><span class="op" id="1447306">:</span>&nbsp;<span class="ident" id="1447308"><a href="/net/ipsock.go.html#1447139">ip</a></span><span class="op" id="1447310">,</span>&nbsp;<span class="ident" id="1447312">Port</span><span class="op" id="1447316">:</span>&nbsp;<span class="ident" id="1447318"><a href="/net/ipsock.go.html#1446730">portnum</a></span><span class="op" id="1447325">,</span>&nbsp;<span class="ident" id="1447327">Zone</span><span class="op" id="1447331">:</span>&nbsp;<span class="ident" id="1447333"><a href="/net/ipsock.go.html#1446716">zone</a></span><span class="op" id="1447337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447341">case</span>&nbsp;<span class="string" id="1447346">&#34;ip&#34;</span><span class="op" id="1447350">,</span>&nbsp;<span class="string" id="1447352">&#34;ip4&#34;</span><span class="op" id="1447357">,</span>&nbsp;<span class="string" id="1447359">&#34;ip6&#34;</span><span class="op" id="1447364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447369">return</span>&nbsp;<span class="op" id="1447376">&amp;</span><span class="ident" id="1447377"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1447383">{</span><span class="ident" id="1447384">IP</span><span class="op" id="1447386">:</span>&nbsp;<span class="ident" id="1447388"><a href="/net/ipsock.go.html#1447139">ip</a></span><span class="op" id="1447390">,</span>&nbsp;<span class="ident" id="1447392">Zone</span><span class="op" id="1447396">:</span>&nbsp;<span class="ident" id="1447398"><a href="/net/ipsock.go.html#1446716">zone</a></span><span class="op" id="1447402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447406">default</span><span class="op" id="1447413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1447418">panic</span><span class="op" id="1447423">(</span><span class="string" id="1447424">&#34;unexpected&nbsp;network:&nbsp;&#34;</span>&nbsp;<span class="op" id="1447447">+</span>&nbsp;<span class="ident" id="1447449"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447452">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447462">if</span>&nbsp;<span class="ident" id="1447465"><a href="/net/ipsock.go.html#1446704">host</a></span>&nbsp;<span class="op" id="1447470">==</span>&nbsp;<span class="string" id="1447473">&#34;&#34;</span>&nbsp;<span class="op" id="1447476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447480">return</span>&nbsp;<span class="ident" id="1447487"><a href="/net/ipsock.go.html#1447122">inetaddr</a></span><span class="op" id="1447495">(</span><span class="ident" id="1447496">nil</span><span class="op" id="1447499">)</span><span class="op" id="1447500">,</span>&nbsp;<span class="ident" id="1447502">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447507">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1447510">//&nbsp;Try&nbsp;as&nbsp;a&nbsp;literal&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447543">var</span>&nbsp;<span class="ident" id="1447547">ip</span>&nbsp;<span class="ident" id="1447550"><a href="/net/ip.go.html#1417189">IP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447554">if</span>&nbsp;<span class="ident" id="1447557"><a href="/net/ipsock.go.html#1447547">ip</a></span>&nbsp;<span class="op" id="1447560">=</span>&nbsp;<span class="ident" id="1447562"><a href="/net/ip.go.html#1427725">parseIPv4</a></span><span class="op" id="1447571">(</span><span class="ident" id="1447572"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1447576">)</span><span class="op" id="1447577">;</span>&nbsp;<span class="ident" id="1447579"><a href="/net/ipsock.go.html#1447547">ip</a></span>&nbsp;<span class="op" id="1447582">!=</span>&nbsp;<span class="ident" id="1447585">nil</span>&nbsp;<span class="op" id="1447589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447593">return</span>&nbsp;<span class="ident" id="1447600"><a href="/net/ipsock.go.html#1447122">inetaddr</a></span><span class="op" id="1447608">(</span><span class="ident" id="1447609"><a href="/net/ipsock.go.html#1447547">ip</a></span><span class="op" id="1447611">)</span><span class="op" id="1447612">,</span>&nbsp;<span class="ident" id="1447614">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447619">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447622">if</span>&nbsp;<span class="ident" id="1447625"><a href="/net/ipsock.go.html#1447547">ip</a></span><span class="op" id="1447627">,</span>&nbsp;<span class="ident" id="1447629"><a href="/net/ipsock.go.html#1446716">zone</a></span>&nbsp;<span class="op" id="1447634">=</span>&nbsp;<span class="ident" id="1447636"><a href="/net/ip.go.html#1428351">parseIPv6</a></span><span class="op" id="1447645">(</span><span class="ident" id="1447646"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1447650">,</span>&nbsp;<span class="builtintype" id="1447652">true</span><span class="op" id="1447656">)</span><span class="op" id="1447657">;</span>&nbsp;<span class="ident" id="1447659"><a href="/net/ipsock.go.html#1447547">ip</a></span>&nbsp;<span class="op" id="1447662">!=</span>&nbsp;<span class="ident" id="1447665">nil</span>&nbsp;<span class="op" id="1447669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447673">return</span>&nbsp;<span class="ident" id="1447680"><a href="/net/ipsock.go.html#1447122">inetaddr</a></span><span class="op" id="1447688">(</span><span class="ident" id="1447689"><a href="/net/ipsock.go.html#1447547">ip</a></span><span class="op" id="1447691">)</span><span class="op" id="1447692">,</span>&nbsp;<span class="ident" id="1447694">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1447702">//&nbsp;Try&nbsp;as&nbsp;a&nbsp;DNS&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447725"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1447729">,</span>&nbsp;<span class="ident" id="1447731"><a href="/net/ipsock.go.html#1446716">zone</a></span>&nbsp;<span class="op" id="1447736">=</span>&nbsp;<span class="ident" id="1447738"><a href="/net/ipsock.go.html#1445607">splitHostZone</a></span><span class="op" id="1447751">(</span><span class="ident" id="1447752"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1447756">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447759">ips</span><span class="op" id="1447762">,</span>&nbsp;<span class="ident" id="1447764"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1447768">:=</span>&nbsp;<span class="ident" id="1447771"><a href="/net/lookup.go.html#1455863">lookupIPDeadline</a></span><span class="op" id="1447787">(</span><span class="ident" id="1447788"><a href="/net/ipsock.go.html#1446704">host</a></span><span class="op" id="1447792">,</span>&nbsp;<span class="ident" id="1447794"><a href="/net/ipsock.go.html#1446631">deadline</a></span><span class="op" id="1447802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447805">if</span>&nbsp;<span class="ident" id="1447808"><a href="/net/ipsock.go.html#1446679">err</a></span>&nbsp;<span class="op" id="1447812">!=</span>&nbsp;<span class="ident" id="1447815">nil</span>&nbsp;<span class="op" id="1447819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447823">return</span>&nbsp;<span class="ident" id="1447830">nil</span><span class="op" id="1447833">,</span>&nbsp;<span class="ident" id="1447835"><a href="/net/ipsock.go.html#1446679">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447843">var</span>&nbsp;<span class="ident" id="1447847">filter</span>&nbsp;<span class="keyword" id="1447854">func</span><span class="op" id="1447858">(</span><span class="ident" id="1447859"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1447861">)</span>&nbsp;<span class="ident" id="1447863"><a href="/net/ip.go.html#1417189">IP</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447867">if</span>&nbsp;<span class="ident" id="1447870"><a href="/net/ipsock.go.html#1446613">net</a></span>&nbsp;<span class="op" id="1447874">!=</span>&nbsp;<span class="string" id="1447877">&#34;&#34;</span>&nbsp;<span class="op" id="1447880">&amp;&amp;</span>&nbsp;<span class="ident" id="1447883"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447886">[</span><span class="builtinfunc" id="1447887">len</span><span class="op" id="1447890">(</span><span class="ident" id="1447891"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447894">)</span><span class="op" id="1447895">-</span><span class="num" id="1447896">1</span><span class="op" id="1447897">]</span>&nbsp;<span class="op" id="1447899">==</span>&nbsp;<span class="string" id="1447902">&#39;4&#39;</span>&nbsp;<span class="op" id="1447906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447910"><a href="/net/ipsock.go.html#1447847">filter</a></span>&nbsp;<span class="op" id="1447917">=</span>&nbsp;<span class="ident" id="1447919"><a href="/net/ipsock.go.html#1443416">ipv4only</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1447929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1447932">if</span>&nbsp;<span class="ident" id="1447935"><a href="/net/ipsock.go.html#1446613">net</a></span>&nbsp;<span class="op" id="1447939">!=</span>&nbsp;<span class="string" id="1447942">&#34;&#34;</span>&nbsp;<span class="op" id="1447945">&amp;&amp;</span>&nbsp;<span class="ident" id="1447948"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447951">[</span><span class="builtinfunc" id="1447952">len</span><span class="op" id="1447955">(</span><span class="ident" id="1447956"><a href="/net/ipsock.go.html#1446613">net</a></span><span class="op" id="1447959">)</span><span class="op" id="1447960">-</span><span class="num" id="1447961">1</span><span class="op" id="1447962">]</span>&nbsp;<span class="op" id="1447964">==</span>&nbsp;<span class="string" id="1447967">&#39;6&#39;</span>&nbsp;<span class="op" id="1447971">||</span>&nbsp;<span class="ident" id="1447974"><a href="/net/ipsock.go.html#1446716">zone</a></span>&nbsp;<span class="op" id="1447979">!=</span>&nbsp;<span class="string" id="1447982">&#34;&#34;</span>&nbsp;<span class="op" id="1447985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1447989"><a href="/net/ipsock.go.html#1447847">filter</a></span>&nbsp;<span class="op" id="1447996">=</span>&nbsp;<span class="ident" id="1447998"><a href="/net/ipsock.go.html#1443711">ipv6only</a></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448011">return</span>&nbsp;<span class="ident" id="1448018"><a href="/net/ipsock.go.html#1441966">firstFavoriteAddr</a></span><span class="op" id="1448035">(</span><span class="ident" id="1448036"><a href="/net/ipsock.go.html#1447847">filter</a></span><span class="op" id="1448042">,</span>&nbsp;<span class="ident" id="1448044"><a href="/net/ipsock.go.html#1447759">ips</a></span><span class="op" id="1448047">,</span>&nbsp;<span class="ident" id="1448049"><a href="/net/ipsock.go.html#1447122">inetaddr</a></span><span class="op" id="1448057">)</span><br>
<span class="lineno"></span><span class="op" id="1448059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1448062">func</span>&nbsp;<span class="ident" id="1448067">zoneToString</span><span class="op" id="1448079">(</span><span class="ident" id="1448080">zone</span>&nbsp;<span class="builtintype" id="1448085">int</span><span class="op" id="1448088">)</span>&nbsp;<span class="builtintype" id="1448090">string</span>&nbsp;<span class="op" id="1448097">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448100">if</span>&nbsp;<span class="ident" id="1448103"><a href="/net/ipsock.go.html#1448080">zone</a></span>&nbsp;<span class="op" id="1448108">==</span>&nbsp;<span class="num" id="1448111">0</span>&nbsp;<span class="op" id="1448113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448117">return</span>&nbsp;<span class="string" id="1448124">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448131">if</span>&nbsp;<span class="ident" id="1448134">ifi</span><span class="op" id="1448137">,</span>&nbsp;<span class="ident" id="1448139">err</span>&nbsp;<span class="op" id="1448143">:=</span>&nbsp;<span class="ident" id="1448146"><a href="/net/interface.go.html#1408249">InterfaceByIndex</a></span><span class="op" id="1448162">(</span><span class="ident" id="1448163"><a href="/net/ipsock.go.html#1448080">zone</a></span><span class="op" id="1448167">)</span><span class="op" id="1448168">;</span>&nbsp;<span class="ident" id="1448170"><a href="/net/ipsock.go.html#1448139">err</a></span>&nbsp;<span class="op" id="1448174">==</span>&nbsp;<span class="ident" id="1448177">nil</span>&nbsp;<span class="op" id="1448181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448185">return</span>&nbsp;<span class="ident" id="1448192"><a href="/net/ipsock.go.html#1448134">ifi</a></span><span class="op" id="1448195">.</span><span class="ident" id="1448196">Name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448205">return</span>&nbsp;<span class="ident" id="1448212"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1448216">(</span><span class="builtintype" id="1448217">uint</span><span class="op" id="1448221">(</span><span class="ident" id="1448222"><a href="/net/ipsock.go.html#1448080">zone</a></span><span class="op" id="1448226">)</span><span class="op" id="1448227">)</span><br>
<span class="lineno"></span><span class="op" id="1448229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1448232">func</span>&nbsp;<span class="ident" id="1448237">zoneToInt</span><span class="op" id="1448246">(</span><span class="ident" id="1448247">zone</span>&nbsp;<span class="builtintype" id="1448252">string</span><span class="op" id="1448258">)</span>&nbsp;<span class="builtintype" id="1448260">int</span>&nbsp;<span class="op" id="1448264">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448267">if</span>&nbsp;<span class="ident" id="1448270"><a href="/net/ipsock.go.html#1448247">zone</a></span>&nbsp;<span class="op" id="1448275">==</span>&nbsp;<span class="string" id="1448278">&#34;&#34;</span>&nbsp;<span class="op" id="1448281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448285">return</span>&nbsp;<span class="num" id="1448292">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448298">if</span>&nbsp;<span class="ident" id="1448301">ifi</span><span class="op" id="1448304">,</span>&nbsp;<span class="ident" id="1448306">err</span>&nbsp;<span class="op" id="1448310">:=</span>&nbsp;<span class="ident" id="1448313"><a href="/net/interface.go.html#1408723">InterfaceByName</a></span><span class="op" id="1448328">(</span><span class="ident" id="1448329"><a href="/net/ipsock.go.html#1448247">zone</a></span><span class="op" id="1448333">)</span><span class="op" id="1448334">;</span>&nbsp;<span class="ident" id="1448336"><a href="/net/ipsock.go.html#1448306">err</a></span>&nbsp;<span class="op" id="1448340">==</span>&nbsp;<span class="ident" id="1448343">nil</span>&nbsp;<span class="op" id="1448347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448351">return</span>&nbsp;<span class="ident" id="1448358"><a href="/net/ipsock.go.html#1448301">ifi</a></span><span class="op" id="1448361">.</span><span class="ident" id="1448362">Index</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1448369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1448372">n</span><span class="op" id="1448373">,</span>&nbsp;<span class="ident" id="1448375">_</span><span class="op" id="1448376">,</span>&nbsp;<span class="ident" id="1448378">_</span>&nbsp;<span class="op" id="1448380">:=</span>&nbsp;<span class="ident" id="1448383"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1448387">(</span><span class="ident" id="1448388"><a href="/net/ipsock.go.html#1448247">zone</a></span><span class="op" id="1448392">,</span>&nbsp;<span class="num" id="1448394">0</span><span class="op" id="1448395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1448398">return</span>&nbsp;<span class="ident" id="1448405"><a href="/net/ipsock.go.html#1448372">n</a></span><br>
<span class="lineno"></span><span class="op" id="1448407">}</span>
</div>
</body>
</html>
