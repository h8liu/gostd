<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6581595">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6581651">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6581705">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6581756">package</span>&nbsp;<span class="ident" id="6581764">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6581769">import</span>&nbsp;<span class="op" id="6581776">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581779">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581790">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581801">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581812">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6581823">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6581830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6581833">func</span>&nbsp;<span class="ident" id="6581838">TestResolveUDPAddr</span><span class="op" id="6581856">(</span><span class="ident" id="6581857">t</span>&nbsp;<span class="op" id="6581859">*</span><span class="ident" id="6581860">testing</span><span class="op" id="6581867">.</span><span class="ident" id="6581868">T</span><span class="op" id="6581869">)</span>&nbsp;<span class="op" id="6581871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6581874">for</span>&nbsp;<span class="ident" id="6581878">_</span><span class="op" id="6581879">,</span>&nbsp;<span class="ident" id="6581881">tt</span>&nbsp;<span class="op" id="6581884">:=</span>&nbsp;<span class="keyword" id="6581887">range</span>&nbsp;<span class="ident" id="6581893">resolveTCPAddrTests</span>&nbsp;<span class="op" id="6581913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581917">net</span>&nbsp;<span class="op" id="6581921">:=</span>&nbsp;<span class="ident" id="6581924">strings</span><span class="op" id="6581931">.</span><span class="ident" id="6581932">Replace</span><span class="op" id="6581939">(</span><span class="ident" id="6581940">tt</span><span class="op" id="6581942">.</span><span class="ident" id="6581943">net</span><span class="op" id="6581946">,</span>&nbsp;<span class="string" id="6581948">&#34;tcp&#34;</span><span class="op" id="6581953">,</span>&nbsp;<span class="string" id="6581955">&#34;udp&#34;</span><span class="op" id="6581960">,</span>&nbsp;<span class="op" id="6581962">-</span><span class="num" id="6581963">1</span><span class="op" id="6581964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6581968">addr</span><span class="op" id="6581972">,</span>&nbsp;<span class="ident" id="6581974">err</span>&nbsp;<span class="op" id="6581978">:=</span>&nbsp;<span class="ident" id="6581981">ResolveUDPAddr</span><span class="op" id="6581995">(</span><span class="ident" id="6581996">net</span><span class="op" id="6581999">,</span>&nbsp;<span class="ident" id="6582001">tt</span><span class="op" id="6582003">.</span><span class="ident" id="6582004">litAddrOrName</span><span class="op" id="6582017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582021">if</span>&nbsp;<span class="ident" id="6582024">err</span>&nbsp;<span class="op" id="6582028">!=</span>&nbsp;<span class="ident" id="6582031">tt</span><span class="op" id="6582033">.</span><span class="ident" id="6582034">err</span>&nbsp;<span class="op" id="6582038">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582043">t</span><span class="op" id="6582044">.</span><span class="ident" id="6582045">Fatalf</span><span class="op" id="6582051">(</span><span class="string" id="6582052">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6582087">,</span>&nbsp;<span class="ident" id="6582089">net</span><span class="op" id="6582092">,</span>&nbsp;<span class="ident" id="6582094">tt</span><span class="op" id="6582096">.</span><span class="ident" id="6582097">litAddrOrName</span><span class="op" id="6582110">,</span>&nbsp;<span class="ident" id="6582112">err</span><span class="op" id="6582115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582123">if</span>&nbsp;<span class="op" id="6582126">!</span><span class="ident" id="6582127">reflect</span><span class="op" id="6582134">.</span><span class="ident" id="6582135">DeepEqual</span><span class="op" id="6582144">(</span><span class="ident" id="6582145">addr</span><span class="op" id="6582149">,</span>&nbsp;<span class="op" id="6582151">(</span><span class="op" id="6582152">*</span><span class="ident" id="6582153">UDPAddr</span><span class="op" id="6582160">)</span><span class="op" id="6582161">(</span><span class="ident" id="6582162">tt</span><span class="op" id="6582164">.</span><span class="ident" id="6582165">addr</span><span class="op" id="6582169">)</span><span class="op" id="6582170">)</span>&nbsp;<span class="op" id="6582172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582177">t</span><span class="op" id="6582178">.</span><span class="ident" id="6582179">Fatalf</span><span class="op" id="6582185">(</span><span class="string" id="6582186">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6582226">,</span>&nbsp;<span class="ident" id="6582228">net</span><span class="op" id="6582231">,</span>&nbsp;<span class="ident" id="6582233">tt</span><span class="op" id="6582235">.</span><span class="ident" id="6582236">litAddrOrName</span><span class="op" id="6582249">,</span>&nbsp;<span class="ident" id="6582251">addr</span><span class="op" id="6582255">,</span>&nbsp;<span class="ident" id="6582257">tt</span><span class="op" id="6582259">.</span><span class="ident" id="6582260">addr</span><span class="op" id="6582264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582268">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582272">if</span>&nbsp;<span class="ident" id="6582275">err</span>&nbsp;<span class="op" id="6582279">==</span>&nbsp;<span class="builtintype" id="6582282">nil</span>&nbsp;<span class="op" id="6582286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582291">str</span>&nbsp;<span class="op" id="6582295">:=</span>&nbsp;<span class="ident" id="6582298">addr</span><span class="op" id="6582302">.</span><span class="ident" id="6582303">String</span><span class="op" id="6582309">(</span><span class="op" id="6582310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582315">addr1</span><span class="op" id="6582320">,</span>&nbsp;<span class="ident" id="6582322">err</span>&nbsp;<span class="op" id="6582326">:=</span>&nbsp;<span class="ident" id="6582329">ResolveUDPAddr</span><span class="op" id="6582343">(</span><span class="ident" id="6582344">net</span><span class="op" id="6582347">,</span>&nbsp;<span class="ident" id="6582349">str</span><span class="op" id="6582352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582357">if</span>&nbsp;<span class="ident" id="6582360">err</span>&nbsp;<span class="op" id="6582364">!=</span>&nbsp;<span class="builtintype" id="6582367">nil</span>&nbsp;<span class="op" id="6582371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582377">t</span><span class="op" id="6582378">.</span><span class="ident" id="6582379">Fatalf</span><span class="op" id="6582385">(</span><span class="string" id="6582386">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="6582424">,</span>&nbsp;<span class="ident" id="6582426">net</span><span class="op" id="6582429">,</span>&nbsp;<span class="ident" id="6582431">str</span><span class="op" id="6582434">,</span>&nbsp;<span class="ident" id="6582436">tt</span><span class="op" id="6582438">.</span><span class="ident" id="6582439">litAddrOrName</span><span class="op" id="6582452">,</span>&nbsp;<span class="ident" id="6582454">err</span><span class="op" id="6582457">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582467">if</span>&nbsp;<span class="op" id="6582470">!</span><span class="ident" id="6582471">reflect</span><span class="op" id="6582478">.</span><span class="ident" id="6582479">DeepEqual</span><span class="op" id="6582488">(</span><span class="ident" id="6582489">addr1</span><span class="op" id="6582494">,</span>&nbsp;<span class="ident" id="6582496">addr</span><span class="op" id="6582500">)</span>&nbsp;<span class="op" id="6582502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582508">t</span><span class="op" id="6582509">.</span><span class="ident" id="6582510">Fatalf</span><span class="op" id="6582516">(</span><span class="string" id="6582517">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6582567">,</span>&nbsp;<span class="ident" id="6582569">net</span><span class="op" id="6582572">,</span>&nbsp;<span class="ident" id="6582574">str</span><span class="op" id="6582577">,</span>&nbsp;<span class="ident" id="6582579">tt</span><span class="op" id="6582581">.</span><span class="ident" id="6582582">litAddrOrName</span><span class="op" id="6582595">,</span>&nbsp;<span class="ident" id="6582597">addr1</span><span class="op" id="6582602">,</span>&nbsp;<span class="ident" id="6582604">addr</span><span class="op" id="6582608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582617">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582620">}</span><br>
<span class="lineno"></span><span class="op" id="6582622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6582625">func</span>&nbsp;<span class="ident" id="6582630">TestReadFromUDP</span><span class="op" id="6582645">(</span><span class="ident" id="6582646">t</span>&nbsp;<span class="op" id="6582648">*</span><span class="ident" id="6582649">testing</span><span class="op" id="6582656">.</span><span class="ident" id="6582657">T</span><span class="op" id="6582658">)</span>&nbsp;<span class="op" id="6582660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582663">switch</span>&nbsp;<span class="ident" id="6582670">runtime</span><span class="op" id="6582677">.</span><span class="ident" id="6582678">GOOS</span>&nbsp;<span class="op" id="6582683">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582686">case</span>&nbsp;<span class="string" id="6582691">&#34;nacl&#34;</span><span class="op" id="6582697">,</span>&nbsp;<span class="string" id="6582699">&#34;plan9&#34;</span><span class="op" id="6582706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582710">t</span><span class="op" id="6582711">.</span><span class="ident" id="6582712">Skipf</span><span class="op" id="6582717">(</span><span class="string" id="6582718">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="6582755">,</span>&nbsp;<span class="ident" id="6582757">runtime</span><span class="op" id="6582764">.</span><span class="ident" id="6582765">GOOS</span><span class="op" id="6582769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582776">ra</span><span class="op" id="6582778">,</span>&nbsp;<span class="ident" id="6582780">err</span>&nbsp;<span class="op" id="6582784">:=</span>&nbsp;<span class="ident" id="6582787">ResolveUDPAddr</span><span class="op" id="6582801">(</span><span class="string" id="6582802">&#34;udp&#34;</span><span class="op" id="6582807">,</span>&nbsp;<span class="string" id="6582809">&#34;127.0.0.1:7&#34;</span><span class="op" id="6582822">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582825">if</span>&nbsp;<span class="ident" id="6582828">err</span>&nbsp;<span class="op" id="6582832">!=</span>&nbsp;<span class="builtintype" id="6582835">nil</span>&nbsp;<span class="op" id="6582839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582843">t</span><span class="op" id="6582844">.</span><span class="ident" id="6582845">Fatal</span><span class="op" id="6582850">(</span><span class="ident" id="6582851">err</span><span class="op" id="6582854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582861">la</span><span class="op" id="6582863">,</span>&nbsp;<span class="ident" id="6582865">err</span>&nbsp;<span class="op" id="6582869">:=</span>&nbsp;<span class="ident" id="6582872">ResolveUDPAddr</span><span class="op" id="6582886">(</span><span class="string" id="6582887">&#34;udp&#34;</span><span class="op" id="6582892">,</span>&nbsp;<span class="string" id="6582894">&#34;127.0.0.1:0&#34;</span><span class="op" id="6582907">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582910">if</span>&nbsp;<span class="ident" id="6582913">err</span>&nbsp;<span class="op" id="6582917">!=</span>&nbsp;<span class="builtintype" id="6582920">nil</span>&nbsp;<span class="op" id="6582924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582928">t</span><span class="op" id="6582929">.</span><span class="ident" id="6582930">Fatal</span><span class="op" id="6582935">(</span><span class="ident" id="6582936">err</span><span class="op" id="6582939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6582942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582946">c</span><span class="op" id="6582947">,</span>&nbsp;<span class="ident" id="6582949">err</span>&nbsp;<span class="op" id="6582953">:=</span>&nbsp;<span class="ident" id="6582956">ListenUDP</span><span class="op" id="6582965">(</span><span class="string" id="6582966">&#34;udp&#34;</span><span class="op" id="6582971">,</span>&nbsp;<span class="ident" id="6582973">la</span><span class="op" id="6582975">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6582978">if</span>&nbsp;<span class="ident" id="6582981">err</span>&nbsp;<span class="op" id="6582985">!=</span>&nbsp;<span class="builtintype" id="6582988">nil</span>&nbsp;<span class="op" id="6582992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6582996">t</span><span class="op" id="6582997">.</span><span class="ident" id="6582998">Fatal</span><span class="op" id="6583003">(</span><span class="ident" id="6583004">err</span><span class="op" id="6583007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583013">defer</span>&nbsp;<span class="ident" id="6583019">c</span><span class="op" id="6583020">.</span><span class="ident" id="6583021">Close</span><span class="op" id="6583026">(</span><span class="op" id="6583027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583031">_</span><span class="op" id="6583032">,</span>&nbsp;<span class="ident" id="6583034">err</span>&nbsp;<span class="op" id="6583038">=</span>&nbsp;<span class="ident" id="6583040">c</span><span class="op" id="6583041">.</span><span class="ident" id="6583042">WriteToUDP</span><span class="op" id="6583052">(</span><span class="op" id="6583053">[</span><span class="op" id="6583054">]</span><span class="builtintype" id="6583055">byte</span><span class="op" id="6583059">(</span><span class="string" id="6583060">&#34;a&#34;</span><span class="op" id="6583063">)</span><span class="op" id="6583064">,</span>&nbsp;<span class="ident" id="6583066">ra</span><span class="op" id="6583068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583071">if</span>&nbsp;<span class="ident" id="6583074">err</span>&nbsp;<span class="op" id="6583078">!=</span>&nbsp;<span class="builtintype" id="6583081">nil</span>&nbsp;<span class="op" id="6583085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583089">t</span><span class="op" id="6583090">.</span><span class="ident" id="6583091">Fatal</span><span class="op" id="6583096">(</span><span class="ident" id="6583097">err</span><span class="op" id="6583100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583107">err</span>&nbsp;<span class="op" id="6583111">=</span>&nbsp;<span class="ident" id="6583113">c</span><span class="op" id="6583114">.</span><span class="ident" id="6583115">SetDeadline</span><span class="op" id="6583126">(</span><span class="ident" id="6583127">time</span><span class="op" id="6583131">.</span><span class="ident" id="6583132">Now</span><span class="op" id="6583135">(</span><span class="op" id="6583136">)</span><span class="op" id="6583137">.</span><span class="ident" id="6583138">Add</span><span class="op" id="6583141">(</span><span class="num" id="6583142">100</span>&nbsp;<span class="op" id="6583146">*</span>&nbsp;<span class="ident" id="6583148">time</span><span class="op" id="6583152">.</span><span class="ident" id="6583153">Millisecond</span><span class="op" id="6583164">)</span><span class="op" id="6583165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583168">if</span>&nbsp;<span class="ident" id="6583171">err</span>&nbsp;<span class="op" id="6583175">!=</span>&nbsp;<span class="builtintype" id="6583178">nil</span>&nbsp;<span class="op" id="6583182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583186">t</span><span class="op" id="6583187">.</span><span class="ident" id="6583188">Fatal</span><span class="op" id="6583193">(</span><span class="ident" id="6583194">err</span><span class="op" id="6583197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583203">b</span>&nbsp;<span class="op" id="6583205">:=</span>&nbsp;<span class="builtinfunc" id="6583208">make</span><span class="op" id="6583212">(</span><span class="op" id="6583213">[</span><span class="op" id="6583214">]</span><span class="builtintype" id="6583215">byte</span><span class="op" id="6583219">,</span>&nbsp;<span class="num" id="6583221">1</span><span class="op" id="6583222">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583225">_</span><span class="op" id="6583226">,</span>&nbsp;<span class="ident" id="6583228">_</span><span class="op" id="6583229">,</span>&nbsp;<span class="ident" id="6583231">err</span>&nbsp;<span class="op" id="6583235">=</span>&nbsp;<span class="ident" id="6583237">c</span><span class="op" id="6583238">.</span><span class="ident" id="6583239">ReadFromUDP</span><span class="op" id="6583250">(</span><span class="ident" id="6583251">b</span><span class="op" id="6583252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583255">if</span>&nbsp;<span class="ident" id="6583258">err</span>&nbsp;<span class="op" id="6583262">==</span>&nbsp;<span class="builtintype" id="6583265">nil</span>&nbsp;<span class="op" id="6583269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583273">t</span><span class="op" id="6583274">.</span><span class="ident" id="6583275">Fatal</span><span class="op" id="6583280">(</span><span class="string" id="6583281">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6583306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583309">}</span>&nbsp;<span class="keyword" id="6583311">else</span>&nbsp;<span class="keyword" id="6583316">if</span>&nbsp;<span class="op" id="6583319">!</span><span class="ident" id="6583320">isTimeout</span><span class="op" id="6583329">(</span><span class="ident" id="6583330">err</span><span class="op" id="6583333">)</span>&nbsp;<span class="op" id="6583335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583339">t</span><span class="op" id="6583340">.</span><span class="ident" id="6583341">Fatal</span><span class="op" id="6583346">(</span><span class="ident" id="6583347">err</span><span class="op" id="6583350">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583353">}</span><br>
<span class="lineno"></span><span class="op" id="6583355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6583358">func</span>&nbsp;<span class="ident" id="6583363">TestWriteToUDP</span><span class="op" id="6583377">(</span><span class="ident" id="6583378">t</span>&nbsp;<span class="op" id="6583380">*</span><span class="ident" id="6583381">testing</span><span class="op" id="6583388">.</span><span class="ident" id="6583389">T</span><span class="op" id="6583390">)</span>&nbsp;<span class="op" id="6583392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583395">switch</span>&nbsp;<span class="ident" id="6583402">runtime</span><span class="op" id="6583409">.</span><span class="ident" id="6583410">GOOS</span>&nbsp;<span class="op" id="6583415">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583418">case</span>&nbsp;<span class="string" id="6583423">&#34;plan9&#34;</span><span class="op" id="6583430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583434">t</span><span class="op" id="6583435">.</span><span class="ident" id="6583436">Skipf</span><span class="op" id="6583441">(</span><span class="string" id="6583442">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6583463">,</span>&nbsp;<span class="ident" id="6583465">runtime</span><span class="op" id="6583472">.</span><span class="ident" id="6583473">GOOS</span><span class="op" id="6583477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583484">l</span><span class="op" id="6583485">,</span>&nbsp;<span class="ident" id="6583487">err</span>&nbsp;<span class="op" id="6583491">:=</span>&nbsp;<span class="ident" id="6583494">ListenPacket</span><span class="op" id="6583506">(</span><span class="string" id="6583507">&#34;udp&#34;</span><span class="op" id="6583512">,</span>&nbsp;<span class="string" id="6583514">&#34;127.0.0.1:0&#34;</span><span class="op" id="6583527">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583530">if</span>&nbsp;<span class="ident" id="6583533">err</span>&nbsp;<span class="op" id="6583537">!=</span>&nbsp;<span class="builtintype" id="6583540">nil</span>&nbsp;<span class="op" id="6583544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583548">t</span><span class="op" id="6583549">.</span><span class="ident" id="6583550">Fatalf</span><span class="op" id="6583556">(</span><span class="string" id="6583557">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6583576">,</span>&nbsp;<span class="ident" id="6583578">err</span><span class="op" id="6583581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583587">defer</span>&nbsp;<span class="ident" id="6583593">l</span><span class="op" id="6583594">.</span><span class="ident" id="6583595">Close</span><span class="op" id="6583600">(</span><span class="op" id="6583601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583605">testWriteToConn</span><span class="op" id="6583620">(</span><span class="ident" id="6583621">t</span><span class="op" id="6583622">,</span>&nbsp;<span class="ident" id="6583624">l</span><span class="op" id="6583625">.</span><span class="ident" id="6583626">LocalAddr</span><span class="op" id="6583635">(</span><span class="op" id="6583636">)</span><span class="op" id="6583637">.</span><span class="ident" id="6583638">String</span><span class="op" id="6583644">(</span><span class="op" id="6583645">)</span><span class="op" id="6583646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583649">testWriteToPacketConn</span><span class="op" id="6583670">(</span><span class="ident" id="6583671">t</span><span class="op" id="6583672">,</span>&nbsp;<span class="ident" id="6583674">l</span><span class="op" id="6583675">.</span><span class="ident" id="6583676">LocalAddr</span><span class="op" id="6583685">(</span><span class="op" id="6583686">)</span><span class="op" id="6583687">.</span><span class="ident" id="6583688">String</span><span class="op" id="6583694">(</span><span class="op" id="6583695">)</span><span class="op" id="6583696">)</span><br>
<span class="lineno"></span><span class="op" id="6583698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6583701">func</span>&nbsp;<span class="ident" id="6583706">testWriteToConn</span><span class="op" id="6583721">(</span><span class="ident" id="6583722">t</span>&nbsp;<span class="op" id="6583724">*</span><span class="ident" id="6583725">testing</span><span class="op" id="6583732">.</span><span class="ident" id="6583733">T</span><span class="op" id="6583734">,</span>&nbsp;<span class="ident" id="6583736">raddr</span>&nbsp;<span class="builtintype" id="6583742">string</span><span class="op" id="6583748">)</span>&nbsp;<span class="op" id="6583750">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583753">c</span><span class="op" id="6583754">,</span>&nbsp;<span class="ident" id="6583756">err</span>&nbsp;<span class="op" id="6583760">:=</span>&nbsp;<span class="ident" id="6583763">Dial</span><span class="op" id="6583767">(</span><span class="string" id="6583768">&#34;udp&#34;</span><span class="op" id="6583773">,</span>&nbsp;<span class="ident" id="6583775">raddr</span><span class="op" id="6583780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583783">if</span>&nbsp;<span class="ident" id="6583786">err</span>&nbsp;<span class="op" id="6583790">!=</span>&nbsp;<span class="builtintype" id="6583793">nil</span>&nbsp;<span class="op" id="6583797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583801">t</span><span class="op" id="6583802">.</span><span class="ident" id="6583803">Fatalf</span><span class="op" id="6583809">(</span><span class="string" id="6583810">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6583827">,</span>&nbsp;<span class="ident" id="6583829">err</span><span class="op" id="6583832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583838">defer</span>&nbsp;<span class="ident" id="6583844">c</span><span class="op" id="6583845">.</span><span class="ident" id="6583846">Close</span><span class="op" id="6583851">(</span><span class="op" id="6583852">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583856">ra</span><span class="op" id="6583858">,</span>&nbsp;<span class="ident" id="6583860">err</span>&nbsp;<span class="op" id="6583864">:=</span>&nbsp;<span class="ident" id="6583867">ResolveUDPAddr</span><span class="op" id="6583881">(</span><span class="string" id="6583882">&#34;udp&#34;</span><span class="op" id="6583887">,</span>&nbsp;<span class="ident" id="6583889">raddr</span><span class="op" id="6583894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6583897">if</span>&nbsp;<span class="ident" id="6583900">err</span>&nbsp;<span class="op" id="6583904">!=</span>&nbsp;<span class="builtintype" id="6583907">nil</span>&nbsp;<span class="op" id="6583911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583915">t</span><span class="op" id="6583916">.</span><span class="ident" id="6583917">Fatalf</span><span class="op" id="6583923">(</span><span class="string" id="6583924">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6583951">,</span>&nbsp;<span class="ident" id="6583953">err</span><span class="op" id="6583956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6583959">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6583963">_</span><span class="op" id="6583964">,</span>&nbsp;<span class="ident" id="6583966">err</span>&nbsp;<span class="op" id="6583970">=</span>&nbsp;<span class="ident" id="6583972">c</span><span class="op" id="6583973">.</span><span class="op" id="6583974">(</span><span class="op" id="6583975">*</span><span class="ident" id="6583976">UDPConn</span><span class="op" id="6583983">)</span><span class="op" id="6583984">.</span><span class="ident" id="6583985">WriteToUDP</span><span class="op" id="6583995">(</span><span class="op" id="6583996">[</span><span class="op" id="6583997">]</span><span class="builtintype" id="6583998">byte</span><span class="op" id="6584002">(</span><span class="string" id="6584003">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6584036">)</span><span class="op" id="6584037">,</span>&nbsp;<span class="ident" id="6584039">ra</span><span class="op" id="6584041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584044">if</span>&nbsp;<span class="ident" id="6584047">err</span>&nbsp;<span class="op" id="6584051">==</span>&nbsp;<span class="builtintype" id="6584054">nil</span>&nbsp;<span class="op" id="6584058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584062">t</span><span class="op" id="6584063">.</span><span class="ident" id="6584064">Fatal</span><span class="op" id="6584069">(</span><span class="string" id="6584070">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6584094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584097">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584100">if</span>&nbsp;<span class="ident" id="6584103">err</span>&nbsp;<span class="op" id="6584107">!=</span>&nbsp;<span class="builtintype" id="6584110">nil</span>&nbsp;<span class="op" id="6584114">&amp;&amp;</span>&nbsp;<span class="ident" id="6584117">err</span><span class="op" id="6584120">.</span><span class="op" id="6584121">(</span><span class="op" id="6584122">*</span><span class="ident" id="6584123">OpError</span><span class="op" id="6584130">)</span><span class="op" id="6584131">.</span><span class="ident" id="6584132">Err</span>&nbsp;<span class="op" id="6584136">!=</span>&nbsp;<span class="ident" id="6584139">ErrWriteToConnected</span>&nbsp;<span class="op" id="6584159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584163">t</span><span class="op" id="6584164">.</span><span class="ident" id="6584165">Fatalf</span><span class="op" id="6584171">(</span><span class="string" id="6584172">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6584223">,</span>&nbsp;<span class="ident" id="6584225">err</span><span class="op" id="6584228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584235">_</span><span class="op" id="6584236">,</span>&nbsp;<span class="ident" id="6584238">err</span>&nbsp;<span class="op" id="6584242">=</span>&nbsp;<span class="ident" id="6584244">c</span><span class="op" id="6584245">.</span><span class="op" id="6584246">(</span><span class="op" id="6584247">*</span><span class="ident" id="6584248">UDPConn</span><span class="op" id="6584255">)</span><span class="op" id="6584256">.</span><span class="ident" id="6584257">WriteTo</span><span class="op" id="6584264">(</span><span class="op" id="6584265">[</span><span class="op" id="6584266">]</span><span class="builtintype" id="6584267">byte</span><span class="op" id="6584271">(</span><span class="string" id="6584272">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6584305">)</span><span class="op" id="6584306">,</span>&nbsp;<span class="ident" id="6584308">ra</span><span class="op" id="6584310">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584313">if</span>&nbsp;<span class="ident" id="6584316">err</span>&nbsp;<span class="op" id="6584320">==</span>&nbsp;<span class="builtintype" id="6584323">nil</span>&nbsp;<span class="op" id="6584327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584331">t</span><span class="op" id="6584332">.</span><span class="ident" id="6584333">Fatal</span><span class="op" id="6584338">(</span><span class="string" id="6584339">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6584360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584366">if</span>&nbsp;<span class="ident" id="6584369">err</span>&nbsp;<span class="op" id="6584373">!=</span>&nbsp;<span class="builtintype" id="6584376">nil</span>&nbsp;<span class="op" id="6584380">&amp;&amp;</span>&nbsp;<span class="ident" id="6584383">err</span><span class="op" id="6584386">.</span><span class="op" id="6584387">(</span><span class="op" id="6584388">*</span><span class="ident" id="6584389">OpError</span><span class="op" id="6584396">)</span><span class="op" id="6584397">.</span><span class="ident" id="6584398">Err</span>&nbsp;<span class="op" id="6584402">!=</span>&nbsp;<span class="ident" id="6584405">ErrWriteToConnected</span>&nbsp;<span class="op" id="6584425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584429">t</span><span class="op" id="6584430">.</span><span class="ident" id="6584431">Fatalf</span><span class="op" id="6584437">(</span><span class="string" id="6584438">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6584486">,</span>&nbsp;<span class="ident" id="6584488">err</span><span class="op" id="6584491">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584498">_</span><span class="op" id="6584499">,</span>&nbsp;<span class="ident" id="6584501">err</span>&nbsp;<span class="op" id="6584505">=</span>&nbsp;<span class="ident" id="6584507">c</span><span class="op" id="6584508">.</span><span class="ident" id="6584509">Write</span><span class="op" id="6584514">(</span><span class="op" id="6584515">[</span><span class="op" id="6584516">]</span><span class="builtintype" id="6584517">byte</span><span class="op" id="6584521">(</span><span class="string" id="6584522">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6584555">)</span><span class="op" id="6584556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584559">if</span>&nbsp;<span class="ident" id="6584562">err</span>&nbsp;<span class="op" id="6584566">!=</span>&nbsp;<span class="builtintype" id="6584569">nil</span>&nbsp;<span class="op" id="6584573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584577">t</span><span class="op" id="6584578">.</span><span class="ident" id="6584579">Fatalf</span><span class="op" id="6584585">(</span><span class="string" id="6584586">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6584604">,</span>&nbsp;<span class="ident" id="6584606">err</span><span class="op" id="6584609">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584612">}</span><br>
<span class="lineno"></span><span class="op" id="6584614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6584617">func</span>&nbsp;<span class="ident" id="6584622">testWriteToPacketConn</span><span class="op" id="6584643">(</span><span class="ident" id="6584644">t</span>&nbsp;<span class="op" id="6584646">*</span><span class="ident" id="6584647">testing</span><span class="op" id="6584654">.</span><span class="ident" id="6584655">T</span><span class="op" id="6584656">,</span>&nbsp;<span class="ident" id="6584658">raddr</span>&nbsp;<span class="builtintype" id="6584664">string</span><span class="op" id="6584670">)</span>&nbsp;<span class="op" id="6584672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584675">c</span><span class="op" id="6584676">,</span>&nbsp;<span class="ident" id="6584678">err</span>&nbsp;<span class="op" id="6584682">:=</span>&nbsp;<span class="ident" id="6584685">ListenPacket</span><span class="op" id="6584697">(</span><span class="string" id="6584698">&#34;udp&#34;</span><span class="op" id="6584703">,</span>&nbsp;<span class="string" id="6584705">&#34;127.0.0.1:0&#34;</span><span class="op" id="6584718">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584721">if</span>&nbsp;<span class="ident" id="6584724">err</span>&nbsp;<span class="op" id="6584728">!=</span>&nbsp;<span class="builtintype" id="6584731">nil</span>&nbsp;<span class="op" id="6584735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584739">t</span><span class="op" id="6584740">.</span><span class="ident" id="6584741">Fatalf</span><span class="op" id="6584747">(</span><span class="string" id="6584748">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6584773">,</span>&nbsp;<span class="ident" id="6584775">err</span><span class="op" id="6584778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584784">defer</span>&nbsp;<span class="ident" id="6584790">c</span><span class="op" id="6584791">.</span><span class="ident" id="6584792">Close</span><span class="op" id="6584797">(</span><span class="op" id="6584798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584802">ra</span><span class="op" id="6584804">,</span>&nbsp;<span class="ident" id="6584806">err</span>&nbsp;<span class="op" id="6584810">:=</span>&nbsp;<span class="ident" id="6584813">ResolveUDPAddr</span><span class="op" id="6584827">(</span><span class="string" id="6584828">&#34;udp&#34;</span><span class="op" id="6584833">,</span>&nbsp;<span class="ident" id="6584835">raddr</span><span class="op" id="6584840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584843">if</span>&nbsp;<span class="ident" id="6584846">err</span>&nbsp;<span class="op" id="6584850">!=</span>&nbsp;<span class="builtintype" id="6584853">nil</span>&nbsp;<span class="op" id="6584857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584861">t</span><span class="op" id="6584862">.</span><span class="ident" id="6584863">Fatalf</span><span class="op" id="6584869">(</span><span class="string" id="6584870">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6584897">,</span>&nbsp;<span class="ident" id="6584899">err</span><span class="op" id="6584902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6584905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6584909">_</span><span class="op" id="6584910">,</span>&nbsp;<span class="ident" id="6584912">err</span>&nbsp;<span class="op" id="6584916">=</span>&nbsp;<span class="ident" id="6584918">c</span><span class="op" id="6584919">.</span><span class="op" id="6584920">(</span><span class="op" id="6584921">*</span><span class="ident" id="6584922">UDPConn</span><span class="op" id="6584929">)</span><span class="op" id="6584930">.</span><span class="ident" id="6584931">WriteToUDP</span><span class="op" id="6584941">(</span><span class="op" id="6584942">[</span><span class="op" id="6584943">]</span><span class="builtintype" id="6584944">byte</span><span class="op" id="6584948">(</span><span class="string" id="6584949">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6584978">)</span><span class="op" id="6584979">,</span>&nbsp;<span class="ident" id="6584981">ra</span><span class="op" id="6584983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6584986">if</span>&nbsp;<span class="ident" id="6584989">err</span>&nbsp;<span class="op" id="6584993">!=</span>&nbsp;<span class="builtintype" id="6584996">nil</span>&nbsp;<span class="op" id="6585000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585004">t</span><span class="op" id="6585005">.</span><span class="ident" id="6585006">Fatalf</span><span class="op" id="6585012">(</span><span class="string" id="6585013">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6585036">,</span>&nbsp;<span class="ident" id="6585038">err</span><span class="op" id="6585041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585048">_</span><span class="op" id="6585049">,</span>&nbsp;<span class="ident" id="6585051">err</span>&nbsp;<span class="op" id="6585055">=</span>&nbsp;<span class="ident" id="6585057">c</span><span class="op" id="6585058">.</span><span class="ident" id="6585059">WriteTo</span><span class="op" id="6585066">(</span><span class="op" id="6585067">[</span><span class="op" id="6585068">]</span><span class="builtintype" id="6585069">byte</span><span class="op" id="6585073">(</span><span class="string" id="6585074">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6585103">)</span><span class="op" id="6585104">,</span>&nbsp;<span class="ident" id="6585106">ra</span><span class="op" id="6585108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585111">if</span>&nbsp;<span class="ident" id="6585114">err</span>&nbsp;<span class="op" id="6585118">!=</span>&nbsp;<span class="builtintype" id="6585121">nil</span>&nbsp;<span class="op" id="6585125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585129">t</span><span class="op" id="6585130">.</span><span class="ident" id="6585131">Fatalf</span><span class="op" id="6585137">(</span><span class="string" id="6585138">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6585158">,</span>&nbsp;<span class="ident" id="6585160">err</span><span class="op" id="6585163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585170">_</span><span class="op" id="6585171">,</span>&nbsp;<span class="ident" id="6585173">err</span>&nbsp;<span class="op" id="6585177">=</span>&nbsp;<span class="ident" id="6585179">c</span><span class="op" id="6585180">.</span><span class="op" id="6585181">(</span><span class="op" id="6585182">*</span><span class="ident" id="6585183">UDPConn</span><span class="op" id="6585190">)</span><span class="op" id="6585191">.</span><span class="ident" id="6585192">Write</span><span class="op" id="6585197">(</span><span class="op" id="6585198">[</span><span class="op" id="6585199">]</span><span class="builtintype" id="6585200">byte</span><span class="op" id="6585204">(</span><span class="string" id="6585205">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6585234">)</span><span class="op" id="6585235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585238">if</span>&nbsp;<span class="ident" id="6585241">err</span>&nbsp;<span class="op" id="6585245">==</span>&nbsp;<span class="builtintype" id="6585248">nil</span>&nbsp;<span class="op" id="6585252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585256">t</span><span class="op" id="6585257">.</span><span class="ident" id="6585258">Fatal</span><span class="op" id="6585263">(</span><span class="string" id="6585264">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6585283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585286">}</span><br>
<span class="lineno"></span><span class="op" id="6585288">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6585291">var</span>&nbsp;<span class="ident" id="6585295">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6585317">=</span>&nbsp;<span class="op" id="6585319">[</span><span class="op" id="6585320">]</span><span class="keyword" id="6585321">struct</span>&nbsp;<span class="op" id="6585328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585331">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6585337">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585345">laddr</span>&nbsp;<span class="op" id="6585351">*</span><span class="ident" id="6585352">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="6585360">}</span><span class="op" id="6585361">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585364">{</span><span class="string" id="6585365">&#34;udp4&#34;</span><span class="op" id="6585371">,</span>&nbsp;<span class="op" id="6585373">&amp;</span><span class="ident" id="6585374">UDPAddr</span><span class="op" id="6585381">{</span><span class="ident" id="6585382">IP</span><span class="op" id="6585384">:</span>&nbsp;<span class="ident" id="6585386">IPv4</span><span class="op" id="6585390">(</span><span class="num" id="6585391">127</span><span class="op" id="6585394">,</span>&nbsp;<span class="num" id="6585396">0</span><span class="op" id="6585397">,</span>&nbsp;<span class="num" id="6585399">0</span><span class="op" id="6585400">,</span>&nbsp;<span class="num" id="6585402">1</span><span class="op" id="6585403">)</span><span class="op" id="6585404">}</span><span class="op" id="6585405">}</span><span class="op" id="6585406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585409">{</span><span class="string" id="6585410">&#34;udp4&#34;</span><span class="op" id="6585416">,</span>&nbsp;<span class="op" id="6585418">&amp;</span><span class="ident" id="6585419">UDPAddr</span><span class="op" id="6585426">{</span><span class="op" id="6585427">}</span><span class="op" id="6585428">}</span><span class="op" id="6585429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585432">{</span><span class="string" id="6585433">&#34;udp4&#34;</span><span class="op" id="6585439">,</span>&nbsp;<span class="builtintype" id="6585441">nil</span><span class="op" id="6585444">}</span><span class="op" id="6585445">,</span><br>
<span class="lineno"></span><span class="op" id="6585447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6585450">func</span>&nbsp;<span class="ident" id="6585455">TestUDPConnLocalName</span><span class="op" id="6585475">(</span><span class="ident" id="6585476">t</span>&nbsp;<span class="op" id="6585478">*</span><span class="ident" id="6585479">testing</span><span class="op" id="6585486">.</span><span class="ident" id="6585487">T</span><span class="op" id="6585488">)</span>&nbsp;<span class="op" id="6585490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585493">if</span>&nbsp;<span class="ident" id="6585496">testing</span><span class="op" id="6585503">.</span><span class="ident" id="6585504">Short</span><span class="op" id="6585509">(</span><span class="op" id="6585510">)</span>&nbsp;<span class="op" id="6585512">||</span>&nbsp;<span class="op" id="6585515">!</span><span class="op" id="6585516">*</span><span class="ident" id="6585517">testExternal</span>&nbsp;<span class="op" id="6585530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585534">t</span><span class="op" id="6585535">.</span><span class="ident" id="6585536">Skip</span><span class="op" id="6585540">(</span><span class="string" id="6585541">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6585582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585589">for</span>&nbsp;<span class="ident" id="6585593">_</span><span class="op" id="6585594">,</span>&nbsp;<span class="ident" id="6585596">tt</span>&nbsp;<span class="op" id="6585599">:=</span>&nbsp;<span class="keyword" id="6585602">range</span>&nbsp;<span class="ident" id="6585608">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6585630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585634">c</span><span class="op" id="6585635">,</span>&nbsp;<span class="ident" id="6585637">err</span>&nbsp;<span class="op" id="6585641">:=</span>&nbsp;<span class="ident" id="6585644">ListenUDP</span><span class="op" id="6585653">(</span><span class="ident" id="6585654">tt</span><span class="op" id="6585656">.</span><span class="ident" id="6585657">net</span><span class="op" id="6585660">,</span>&nbsp;<span class="ident" id="6585662">tt</span><span class="op" id="6585664">.</span><span class="ident" id="6585665">laddr</span><span class="op" id="6585670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585674">if</span>&nbsp;<span class="ident" id="6585677">err</span>&nbsp;<span class="op" id="6585681">!=</span>&nbsp;<span class="builtintype" id="6585684">nil</span>&nbsp;<span class="op" id="6585688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585693">t</span><span class="op" id="6585694">.</span><span class="ident" id="6585695">Fatalf</span><span class="op" id="6585701">(</span><span class="string" id="6585702">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6585724">,</span>&nbsp;<span class="ident" id="6585726">err</span><span class="op" id="6585729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585733">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585737">defer</span>&nbsp;<span class="ident" id="6585743">c</span><span class="op" id="6585744">.</span><span class="ident" id="6585745">Close</span><span class="op" id="6585750">(</span><span class="op" id="6585751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585755">la</span>&nbsp;<span class="op" id="6585758">:=</span>&nbsp;<span class="ident" id="6585761">c</span><span class="op" id="6585762">.</span><span class="ident" id="6585763">LocalAddr</span><span class="op" id="6585772">(</span><span class="op" id="6585773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585777">if</span>&nbsp;<span class="ident" id="6585780">a</span><span class="op" id="6585781">,</span>&nbsp;<span class="ident" id="6585783">ok</span>&nbsp;<span class="op" id="6585786">:=</span>&nbsp;<span class="ident" id="6585789">la</span><span class="op" id="6585791">.</span><span class="op" id="6585792">(</span><span class="op" id="6585793">*</span><span class="ident" id="6585794">UDPAddr</span><span class="op" id="6585801">)</span><span class="op" id="6585802">;</span>&nbsp;<span class="op" id="6585804">!</span><span class="ident" id="6585805">ok</span>&nbsp;<span class="op" id="6585808">||</span>&nbsp;<span class="ident" id="6585811">a</span><span class="op" id="6585812">.</span><span class="ident" id="6585813">Port</span>&nbsp;<span class="op" id="6585818">==</span>&nbsp;<span class="num" id="6585821">0</span>&nbsp;<span class="op" id="6585823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6585828">t</span><span class="op" id="6585829">.</span><span class="ident" id="6585830">Fatalf</span><span class="op" id="6585836">(</span><span class="string" id="6585837">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6585898">,</span>&nbsp;<span class="ident" id="6585900">la</span><span class="op" id="6585902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585906">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6585909">}</span><br>
<span class="lineno"></span><span class="op" id="6585911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6585914">func</span>&nbsp;<span class="ident" id="6585919">TestUDPConnLocalAndRemoteNames</span><span class="op" id="6585949">(</span><span class="ident" id="6585950">t</span>&nbsp;<span class="op" id="6585952">*</span><span class="ident" id="6585953">testing</span><span class="op" id="6585960">.</span><span class="ident" id="6585961">T</span><span class="op" id="6585962">)</span>&nbsp;<span class="op" id="6585964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6585967">for</span>&nbsp;<span class="ident" id="6585971">_</span><span class="op" id="6585972">,</span>&nbsp;<span class="ident" id="6585974">laddr</span>&nbsp;<span class="op" id="6585980">:=</span>&nbsp;<span class="keyword" id="6585983">range</span>&nbsp;<span class="op" id="6585989">[</span><span class="op" id="6585990">]</span><span class="builtintype" id="6585991">string</span><span class="op" id="6585997">{</span><span class="string" id="6585998">&#34;&#34;</span><span class="op" id="6586000">,</span>&nbsp;<span class="string" id="6586002">&#34;127.0.0.1:0&#34;</span><span class="op" id="6586015">}</span>&nbsp;<span class="op" id="6586017">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586021">c1</span><span class="op" id="6586023">,</span>&nbsp;<span class="ident" id="6586025">err</span>&nbsp;<span class="op" id="6586029">:=</span>&nbsp;<span class="ident" id="6586032">ListenPacket</span><span class="op" id="6586044">(</span><span class="string" id="6586045">&#34;udp&#34;</span><span class="op" id="6586050">,</span>&nbsp;<span class="string" id="6586052">&#34;127.0.0.1:0&#34;</span><span class="op" id="6586065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586069">if</span>&nbsp;<span class="ident" id="6586072">err</span>&nbsp;<span class="op" id="6586076">!=</span>&nbsp;<span class="builtintype" id="6586079">nil</span>&nbsp;<span class="op" id="6586083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586088">t</span><span class="op" id="6586089">.</span><span class="ident" id="6586090">Fatalf</span><span class="op" id="6586096">(</span><span class="string" id="6586097">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6586119">,</span>&nbsp;<span class="ident" id="6586121">err</span><span class="op" id="6586124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586132">defer</span>&nbsp;<span class="ident" id="6586138">c1</span><span class="op" id="6586140">.</span><span class="ident" id="6586141">Close</span><span class="op" id="6586146">(</span><span class="op" id="6586147">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586152">var</span>&nbsp;<span class="ident" id="6586156">la</span>&nbsp;<span class="op" id="6586159">*</span><span class="ident" id="6586160">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586170">if</span>&nbsp;<span class="ident" id="6586173">laddr</span>&nbsp;<span class="op" id="6586179">!=</span>&nbsp;<span class="string" id="6586182">&#34;&#34;</span>&nbsp;<span class="op" id="6586185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586190">var</span>&nbsp;<span class="ident" id="6586194">err</span>&nbsp;<span class="builtintype" id="6586198">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586207">if</span>&nbsp;<span class="ident" id="6586210">la</span><span class="op" id="6586212">,</span>&nbsp;<span class="ident" id="6586214">err</span>&nbsp;<span class="op" id="6586218">=</span>&nbsp;<span class="ident" id="6586220">ResolveUDPAddr</span><span class="op" id="6586234">(</span><span class="string" id="6586235">&#34;udp&#34;</span><span class="op" id="6586240">,</span>&nbsp;<span class="ident" id="6586242">laddr</span><span class="op" id="6586247">)</span><span class="op" id="6586248">;</span>&nbsp;<span class="ident" id="6586250">err</span>&nbsp;<span class="op" id="6586254">!=</span>&nbsp;<span class="builtintype" id="6586257">nil</span>&nbsp;<span class="op" id="6586261">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586267">t</span><span class="op" id="6586268">.</span><span class="ident" id="6586269">Fatalf</span><span class="op" id="6586275">(</span><span class="string" id="6586276">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6586303">,</span>&nbsp;<span class="ident" id="6586305">err</span><span class="op" id="6586308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586321">c2</span><span class="op" id="6586323">,</span>&nbsp;<span class="ident" id="6586325">err</span>&nbsp;<span class="op" id="6586329">:=</span>&nbsp;<span class="ident" id="6586332">DialUDP</span><span class="op" id="6586339">(</span><span class="string" id="6586340">&#34;udp&#34;</span><span class="op" id="6586345">,</span>&nbsp;<span class="ident" id="6586347">la</span><span class="op" id="6586349">,</span>&nbsp;<span class="ident" id="6586351">c1</span><span class="op" id="6586353">.</span><span class="ident" id="6586354">LocalAddr</span><span class="op" id="6586363">(</span><span class="op" id="6586364">)</span><span class="op" id="6586365">.</span><span class="op" id="6586366">(</span><span class="op" id="6586367">*</span><span class="ident" id="6586368">UDPAddr</span><span class="op" id="6586375">)</span><span class="op" id="6586376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586380">if</span>&nbsp;<span class="ident" id="6586383">err</span>&nbsp;<span class="op" id="6586387">!=</span>&nbsp;<span class="builtintype" id="6586390">nil</span>&nbsp;<span class="op" id="6586394">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586399">t</span><span class="op" id="6586400">.</span><span class="ident" id="6586401">Fatalf</span><span class="op" id="6586407">(</span><span class="string" id="6586408">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6586428">,</span>&nbsp;<span class="ident" id="6586430">err</span><span class="op" id="6586433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586441">defer</span>&nbsp;<span class="ident" id="6586447">c2</span><span class="op" id="6586449">.</span><span class="ident" id="6586450">Close</span><span class="op" id="6586455">(</span><span class="op" id="6586456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586461">var</span>&nbsp;<span class="ident" id="6586465">connAddrs</span>&nbsp;<span class="op" id="6586475">=</span>&nbsp;<span class="op" id="6586477">[</span><span class="num" id="6586478">4</span><span class="op" id="6586479">]</span><span class="keyword" id="6586480">struct</span>&nbsp;<span class="op" id="6586487">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586492">got</span>&nbsp;<span class="ident" id="6586496">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586504">ok</span>&nbsp;&nbsp;<span class="builtintype" id="6586508">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586515">}</span><span class="op" id="6586516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586521">{</span><span class="ident" id="6586522">c1</span><span class="op" id="6586524">.</span><span class="ident" id="6586525">LocalAddr</span><span class="op" id="6586534">(</span><span class="op" id="6586535">)</span><span class="op" id="6586536">,</span>&nbsp;<span class="builtintype" id="6586538">true</span><span class="op" id="6586542">}</span><span class="op" id="6586543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586548">{</span><span class="ident" id="6586549">c1</span><span class="op" id="6586551">.</span><span class="op" id="6586552">(</span><span class="op" id="6586553">*</span><span class="ident" id="6586554">UDPConn</span><span class="op" id="6586561">)</span><span class="op" id="6586562">.</span><span class="ident" id="6586563">RemoteAddr</span><span class="op" id="6586573">(</span><span class="op" id="6586574">)</span><span class="op" id="6586575">,</span>&nbsp;<span class="builtintype" id="6586577">false</span><span class="op" id="6586582">}</span><span class="op" id="6586583">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586588">{</span><span class="ident" id="6586589">c2</span><span class="op" id="6586591">.</span><span class="ident" id="6586592">LocalAddr</span><span class="op" id="6586601">(</span><span class="op" id="6586602">)</span><span class="op" id="6586603">,</span>&nbsp;<span class="builtintype" id="6586605">true</span><span class="op" id="6586609">}</span><span class="op" id="6586610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586615">{</span><span class="ident" id="6586616">c2</span><span class="op" id="6586618">.</span><span class="ident" id="6586619">RemoteAddr</span><span class="op" id="6586629">(</span><span class="op" id="6586630">)</span><span class="op" id="6586631">,</span>&nbsp;<span class="builtintype" id="6586633">true</span><span class="op" id="6586637">}</span><span class="op" id="6586638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586646">for</span>&nbsp;<span class="ident" id="6586650">_</span><span class="op" id="6586651">,</span>&nbsp;<span class="ident" id="6586653">ca</span>&nbsp;<span class="op" id="6586656">:=</span>&nbsp;<span class="keyword" id="6586659">range</span>&nbsp;<span class="ident" id="6586665">connAddrs</span>&nbsp;<span class="op" id="6586675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586680">if</span>&nbsp;<span class="ident" id="6586683">a</span><span class="op" id="6586684">,</span>&nbsp;<span class="ident" id="6586686">ok</span>&nbsp;<span class="op" id="6586689">:=</span>&nbsp;<span class="ident" id="6586692">ca</span><span class="op" id="6586694">.</span><span class="ident" id="6586695">got</span><span class="op" id="6586698">.</span><span class="op" id="6586699">(</span><span class="op" id="6586700">*</span><span class="ident" id="6586701">UDPAddr</span><span class="op" id="6586708">)</span><span class="op" id="6586709">;</span>&nbsp;<span class="ident" id="6586711">ok</span>&nbsp;<span class="op" id="6586714">!=</span>&nbsp;<span class="ident" id="6586717">ca</span><span class="op" id="6586719">.</span><span class="ident" id="6586720">ok</span>&nbsp;<span class="op" id="6586723">||</span>&nbsp;<span class="ident" id="6586726">ok</span>&nbsp;<span class="op" id="6586729">&amp;&amp;</span>&nbsp;<span class="ident" id="6586732">a</span><span class="op" id="6586733">.</span><span class="ident" id="6586734">Port</span>&nbsp;<span class="op" id="6586739">==</span>&nbsp;<span class="num" id="6586742">0</span>&nbsp;<span class="op" id="6586744">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586750">t</span><span class="op" id="6586751">.</span><span class="ident" id="6586752">Fatalf</span><span class="op" id="6586758">(</span><span class="string" id="6586759">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6586820">,</span>&nbsp;<span class="ident" id="6586822">ca</span><span class="op" id="6586824">.</span><span class="ident" id="6586825">got</span><span class="op" id="6586828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586840">}</span><br>
<span class="lineno"></span><span class="op" id="6586842">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6586845">func</span>&nbsp;<span class="ident" id="6586850">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="6586877">(</span><span class="ident" id="6586878">t</span>&nbsp;<span class="op" id="6586880">*</span><span class="ident" id="6586881">testing</span><span class="op" id="6586888">.</span><span class="ident" id="6586889">T</span><span class="op" id="6586890">)</span>&nbsp;<span class="op" id="6586892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586895">if</span>&nbsp;<span class="ident" id="6586898">testing</span><span class="op" id="6586905">.</span><span class="ident" id="6586906">Short</span><span class="op" id="6586911">(</span><span class="op" id="6586912">)</span>&nbsp;<span class="op" id="6586914">||</span>&nbsp;<span class="op" id="6586917">!</span><span class="op" id="6586918">*</span><span class="ident" id="6586919">testExternal</span>&nbsp;<span class="op" id="6586932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6586936">t</span><span class="op" id="6586937">.</span><span class="ident" id="6586938">Skip</span><span class="op" id="6586942">(</span><span class="string" id="6586943">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6586984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6586987">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6586990">if</span>&nbsp;<span class="op" id="6586993">!</span><span class="ident" id="6586994">supportsIPv6</span>&nbsp;<span class="op" id="6587007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587011">t</span><span class="op" id="6587012">.</span><span class="ident" id="6587013">Skip</span><span class="op" id="6587017">(</span><span class="string" id="6587018">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6587041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587047">ifi</span>&nbsp;<span class="op" id="6587051">:=</span>&nbsp;<span class="ident" id="6587054">loopbackInterface</span><span class="op" id="6587071">(</span><span class="op" id="6587072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587075">if</span>&nbsp;<span class="ident" id="6587078">ifi</span>&nbsp;<span class="op" id="6587082">==</span>&nbsp;<span class="builtintype" id="6587085">nil</span>&nbsp;<span class="op" id="6587089">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587093">t</span><span class="op" id="6587094">.</span><span class="ident" id="6587095">Skip</span><span class="op" id="6587099">(</span><span class="string" id="6587100">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="6587130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587136">laddr</span>&nbsp;<span class="op" id="6587142">:=</span>&nbsp;<span class="ident" id="6587145">ipv6LinkLocalUnicastAddr</span><span class="op" id="6587169">(</span><span class="ident" id="6587170">ifi</span><span class="op" id="6587173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587176">if</span>&nbsp;<span class="ident" id="6587179">laddr</span>&nbsp;<span class="op" id="6587185">==</span>&nbsp;<span class="string" id="6587188">&#34;&#34;</span>&nbsp;<span class="op" id="6587191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587195">t</span><span class="op" id="6587196">.</span><span class="ident" id="6587197">Skip</span><span class="op" id="6587201">(</span><span class="string" id="6587202">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="6587246">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587253">type</span>&nbsp;<span class="ident" id="6587258">test</span>&nbsp;<span class="keyword" id="6587263">struct</span>&nbsp;<span class="op" id="6587270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587274">net</span><span class="op" id="6587277">,</span>&nbsp;<span class="ident" id="6587279">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6587285">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587294">nameLookup</span>&nbsp;<span class="builtintype" id="6587305">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587314">var</span>&nbsp;<span class="ident" id="6587318">tests</span>&nbsp;<span class="op" id="6587324">=</span>&nbsp;<span class="op" id="6587326">[</span><span class="op" id="6587327">]</span><span class="ident" id="6587328">test</span><span class="op" id="6587332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587336">{</span><span class="string" id="6587337">&#34;udp&#34;</span><span class="op" id="6587342">,</span>&nbsp;<span class="string" id="6587344">&#34;[&#34;</span>&nbsp;<span class="op" id="6587348">+</span>&nbsp;<span class="ident" id="6587350">laddr</span>&nbsp;<span class="op" id="6587356">+</span>&nbsp;<span class="string" id="6587358">&#34;%&#34;</span>&nbsp;<span class="op" id="6587362">+</span>&nbsp;<span class="ident" id="6587364">ifi</span><span class="op" id="6587367">.</span><span class="ident" id="6587368">Name</span>&nbsp;<span class="op" id="6587373">+</span>&nbsp;<span class="string" id="6587375">&#34;]:0&#34;</span><span class="op" id="6587380">,</span>&nbsp;<span class="builtintype" id="6587382">false</span><span class="op" id="6587387">}</span><span class="op" id="6587388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587392">{</span><span class="string" id="6587393">&#34;udp6&#34;</span><span class="op" id="6587399">,</span>&nbsp;<span class="string" id="6587401">&#34;[&#34;</span>&nbsp;<span class="op" id="6587405">+</span>&nbsp;<span class="ident" id="6587407">laddr</span>&nbsp;<span class="op" id="6587413">+</span>&nbsp;<span class="string" id="6587415">&#34;%&#34;</span>&nbsp;<span class="op" id="6587419">+</span>&nbsp;<span class="ident" id="6587421">ifi</span><span class="op" id="6587424">.</span><span class="ident" id="6587425">Name</span>&nbsp;<span class="op" id="6587430">+</span>&nbsp;<span class="string" id="6587432">&#34;]:0&#34;</span><span class="op" id="6587437">,</span>&nbsp;<span class="builtintype" id="6587439">false</span><span class="op" id="6587444">}</span><span class="op" id="6587445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587448">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6587451">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587511">if</span>&nbsp;<span class="ident" id="6587514">runtime</span><span class="op" id="6587521">.</span><span class="ident" id="6587522">GOOS</span>&nbsp;<span class="op" id="6587527">==</span>&nbsp;<span class="string" id="6587530">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="6587542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587546">tests</span>&nbsp;<span class="op" id="6587552">=</span>&nbsp;<span class="ident" id="6587554">tests</span><span class="op" id="6587559">[</span><span class="num" id="6587560">1</span><span class="op" id="6587561">:</span><span class="op" id="6587562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587568">switch</span>&nbsp;<span class="ident" id="6587575">runtime</span><span class="op" id="6587582">.</span><span class="ident" id="6587583">GOOS</span>&nbsp;<span class="op" id="6587588">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587591">case</span>&nbsp;<span class="string" id="6587596">&#34;darwin&#34;</span><span class="op" id="6587604">,</span>&nbsp;<span class="string" id="6587606">&#34;dragonfly&#34;</span><span class="op" id="6587617">,</span>&nbsp;<span class="string" id="6587619">&#34;freebsd&#34;</span><span class="op" id="6587628">,</span>&nbsp;<span class="string" id="6587630">&#34;openbsd&#34;</span><span class="op" id="6587639">,</span>&nbsp;<span class="string" id="6587641">&#34;netbsd&#34;</span><span class="op" id="6587649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587653">tests</span>&nbsp;<span class="op" id="6587659">=</span>&nbsp;<span class="builtinfunc" id="6587661">append</span><span class="op" id="6587667">(</span><span class="ident" id="6587668">tests</span><span class="op" id="6587673">,</span>&nbsp;<span class="op" id="6587675">[</span><span class="op" id="6587676">]</span><span class="ident" id="6587677">test</span><span class="op" id="6587681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587686">{</span><span class="string" id="6587687">&#34;udp&#34;</span><span class="op" id="6587692">,</span>&nbsp;<span class="string" id="6587694">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6587708">+</span>&nbsp;<span class="ident" id="6587710">ifi</span><span class="op" id="6587713">.</span><span class="ident" id="6587714">Name</span>&nbsp;<span class="op" id="6587719">+</span>&nbsp;<span class="string" id="6587721">&#34;]:0&#34;</span><span class="op" id="6587726">,</span>&nbsp;<span class="builtintype" id="6587728">true</span><span class="op" id="6587732">}</span><span class="op" id="6587733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587738">{</span><span class="string" id="6587739">&#34;udp6&#34;</span><span class="op" id="6587745">,</span>&nbsp;<span class="string" id="6587747">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6587761">+</span>&nbsp;<span class="ident" id="6587763">ifi</span><span class="op" id="6587766">.</span><span class="ident" id="6587767">Name</span>&nbsp;<span class="op" id="6587772">+</span>&nbsp;<span class="string" id="6587774">&#34;]:0&#34;</span><span class="op" id="6587779">,</span>&nbsp;<span class="builtintype" id="6587781">true</span><span class="op" id="6587785">}</span><span class="op" id="6587786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587790">}</span><span class="op" id="6587791">...</span><span class="op" id="6587794">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587797">case</span>&nbsp;<span class="string" id="6587802">&#34;linux&#34;</span><span class="op" id="6587809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587813">tests</span>&nbsp;<span class="op" id="6587819">=</span>&nbsp;<span class="builtinfunc" id="6587821">append</span><span class="op" id="6587827">(</span><span class="ident" id="6587828">tests</span><span class="op" id="6587833">,</span>&nbsp;<span class="op" id="6587835">[</span><span class="op" id="6587836">]</span><span class="ident" id="6587837">test</span><span class="op" id="6587841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587846">{</span><span class="string" id="6587847">&#34;udp&#34;</span><span class="op" id="6587852">,</span>&nbsp;<span class="string" id="6587854">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6587872">+</span>&nbsp;<span class="ident" id="6587874">ifi</span><span class="op" id="6587877">.</span><span class="ident" id="6587878">Name</span>&nbsp;<span class="op" id="6587883">+</span>&nbsp;<span class="string" id="6587885">&#34;]:0&#34;</span><span class="op" id="6587890">,</span>&nbsp;<span class="builtintype" id="6587892">true</span><span class="op" id="6587896">}</span><span class="op" id="6587897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587902">{</span><span class="string" id="6587903">&#34;udp6&#34;</span><span class="op" id="6587909">,</span>&nbsp;<span class="string" id="6587911">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6587929">+</span>&nbsp;<span class="ident" id="6587931">ifi</span><span class="op" id="6587934">.</span><span class="ident" id="6587935">Name</span>&nbsp;<span class="op" id="6587940">+</span>&nbsp;<span class="string" id="6587942">&#34;]:0&#34;</span><span class="op" id="6587947">,</span>&nbsp;<span class="builtintype" id="6587949">true</span><span class="op" id="6587953">}</span><span class="op" id="6587954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587958">}</span><span class="op" id="6587959">...</span><span class="op" id="6587962">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6587965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6587968">for</span>&nbsp;<span class="ident" id="6587972">_</span><span class="op" id="6587973">,</span>&nbsp;<span class="ident" id="6587975">tt</span>&nbsp;<span class="op" id="6587978">:=</span>&nbsp;<span class="keyword" id="6587981">range</span>&nbsp;<span class="ident" id="6587987">tests</span>&nbsp;<span class="op" id="6587993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6587997">c1</span><span class="op" id="6587999">,</span>&nbsp;<span class="ident" id="6588001">err</span>&nbsp;<span class="op" id="6588005">:=</span>&nbsp;<span class="ident" id="6588008">ListenPacket</span><span class="op" id="6588020">(</span><span class="ident" id="6588021">tt</span><span class="op" id="6588023">.</span><span class="ident" id="6588024">net</span><span class="op" id="6588027">,</span>&nbsp;<span class="ident" id="6588029">tt</span><span class="op" id="6588031">.</span><span class="ident" id="6588032">addr</span><span class="op" id="6588036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588040">if</span>&nbsp;<span class="ident" id="6588043">err</span>&nbsp;<span class="op" id="6588047">!=</span>&nbsp;<span class="builtintype" id="6588050">nil</span>&nbsp;<span class="op" id="6588054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6588059">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6588105">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588154">t</span><span class="op" id="6588155">.</span><span class="ident" id="6588156">Logf</span><span class="op" id="6588160">(</span><span class="string" id="6588161">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6588186">,</span>&nbsp;<span class="ident" id="6588188">err</span><span class="op" id="6588191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588196">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588211">defer</span>&nbsp;<span class="ident" id="6588217">c1</span><span class="op" id="6588219">.</span><span class="ident" id="6588220">Close</span><span class="op" id="6588225">(</span><span class="op" id="6588226">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588230">if</span>&nbsp;<span class="ident" id="6588233">la</span><span class="op" id="6588235">,</span>&nbsp;<span class="ident" id="6588237">ok</span>&nbsp;<span class="op" id="6588240">:=</span>&nbsp;<span class="ident" id="6588243">c1</span><span class="op" id="6588245">.</span><span class="ident" id="6588246">LocalAddr</span><span class="op" id="6588255">(</span><span class="op" id="6588256">)</span><span class="op" id="6588257">.</span><span class="op" id="6588258">(</span><span class="op" id="6588259">*</span><span class="ident" id="6588260">UDPAddr</span><span class="op" id="6588267">)</span><span class="op" id="6588268">;</span>&nbsp;<span class="op" id="6588270">!</span><span class="ident" id="6588271">ok</span>&nbsp;<span class="op" id="6588274">||</span>&nbsp;<span class="op" id="6588277">!</span><span class="ident" id="6588278">tt</span><span class="op" id="6588280">.</span><span class="ident" id="6588281">nameLookup</span>&nbsp;<span class="op" id="6588292">&amp;&amp;</span>&nbsp;<span class="ident" id="6588295">la</span><span class="op" id="6588297">.</span><span class="ident" id="6588298">Zone</span>&nbsp;<span class="op" id="6588303">==</span>&nbsp;<span class="string" id="6588306">&#34;&#34;</span>&nbsp;<span class="op" id="6588309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588314">t</span><span class="op" id="6588315">.</span><span class="ident" id="6588316">Fatalf</span><span class="op" id="6588322">(</span><span class="string" id="6588323">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6588379">,</span>&nbsp;<span class="ident" id="6588381">la</span><span class="op" id="6588383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588392">c2</span><span class="op" id="6588394">,</span>&nbsp;<span class="ident" id="6588396">err</span>&nbsp;<span class="op" id="6588400">:=</span>&nbsp;<span class="ident" id="6588403">Dial</span><span class="op" id="6588407">(</span><span class="ident" id="6588408">tt</span><span class="op" id="6588410">.</span><span class="ident" id="6588411">net</span><span class="op" id="6588414">,</span>&nbsp;<span class="ident" id="6588416">c1</span><span class="op" id="6588418">.</span><span class="ident" id="6588419">LocalAddr</span><span class="op" id="6588428">(</span><span class="op" id="6588429">)</span><span class="op" id="6588430">.</span><span class="ident" id="6588431">String</span><span class="op" id="6588437">(</span><span class="op" id="6588438">)</span><span class="op" id="6588439">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588443">if</span>&nbsp;<span class="ident" id="6588446">err</span>&nbsp;<span class="op" id="6588450">!=</span>&nbsp;<span class="builtintype" id="6588453">nil</span>&nbsp;<span class="op" id="6588457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588462">t</span><span class="op" id="6588463">.</span><span class="ident" id="6588464">Fatalf</span><span class="op" id="6588470">(</span><span class="string" id="6588471">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6588488">,</span>&nbsp;<span class="ident" id="6588490">err</span><span class="op" id="6588493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588501">defer</span>&nbsp;<span class="ident" id="6588507">c2</span><span class="op" id="6588509">.</span><span class="ident" id="6588510">Close</span><span class="op" id="6588515">(</span><span class="op" id="6588516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588520">if</span>&nbsp;<span class="ident" id="6588523">la</span><span class="op" id="6588525">,</span>&nbsp;<span class="ident" id="6588527">ok</span>&nbsp;<span class="op" id="6588530">:=</span>&nbsp;<span class="ident" id="6588533">c2</span><span class="op" id="6588535">.</span><span class="ident" id="6588536">LocalAddr</span><span class="op" id="6588545">(</span><span class="op" id="6588546">)</span><span class="op" id="6588547">.</span><span class="op" id="6588548">(</span><span class="op" id="6588549">*</span><span class="ident" id="6588550">UDPAddr</span><span class="op" id="6588557">)</span><span class="op" id="6588558">;</span>&nbsp;<span class="op" id="6588560">!</span><span class="ident" id="6588561">ok</span>&nbsp;<span class="op" id="6588564">||</span>&nbsp;<span class="op" id="6588567">!</span><span class="ident" id="6588568">tt</span><span class="op" id="6588570">.</span><span class="ident" id="6588571">nameLookup</span>&nbsp;<span class="op" id="6588582">&amp;&amp;</span>&nbsp;<span class="ident" id="6588585">la</span><span class="op" id="6588587">.</span><span class="ident" id="6588588">Zone</span>&nbsp;<span class="op" id="6588593">==</span>&nbsp;<span class="string" id="6588596">&#34;&#34;</span>&nbsp;<span class="op" id="6588599">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588604">t</span><span class="op" id="6588605">.</span><span class="ident" id="6588606">Fatalf</span><span class="op" id="6588612">(</span><span class="string" id="6588613">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6588669">,</span>&nbsp;<span class="ident" id="6588671">la</span><span class="op" id="6588673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588681">if</span>&nbsp;<span class="ident" id="6588684">ra</span><span class="op" id="6588686">,</span>&nbsp;<span class="ident" id="6588688">ok</span>&nbsp;<span class="op" id="6588691">:=</span>&nbsp;<span class="ident" id="6588694">c2</span><span class="op" id="6588696">.</span><span class="ident" id="6588697">RemoteAddr</span><span class="op" id="6588707">(</span><span class="op" id="6588708">)</span><span class="op" id="6588709">.</span><span class="op" id="6588710">(</span><span class="op" id="6588711">*</span><span class="ident" id="6588712">UDPAddr</span><span class="op" id="6588719">)</span><span class="op" id="6588720">;</span>&nbsp;<span class="op" id="6588722">!</span><span class="ident" id="6588723">ok</span>&nbsp;<span class="op" id="6588726">||</span>&nbsp;<span class="op" id="6588729">!</span><span class="ident" id="6588730">tt</span><span class="op" id="6588732">.</span><span class="ident" id="6588733">nameLookup</span>&nbsp;<span class="op" id="6588744">&amp;&amp;</span>&nbsp;<span class="ident" id="6588747">ra</span><span class="op" id="6588749">.</span><span class="ident" id="6588750">Zone</span>&nbsp;<span class="op" id="6588755">==</span>&nbsp;<span class="string" id="6588758">&#34;&#34;</span>&nbsp;<span class="op" id="6588761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588766">t</span><span class="op" id="6588767">.</span><span class="ident" id="6588768">Fatalf</span><span class="op" id="6588774">(</span><span class="string" id="6588775">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6588831">,</span>&nbsp;<span class="ident" id="6588833">ra</span><span class="op" id="6588835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588839">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588844">if</span>&nbsp;<span class="ident" id="6588847">_</span><span class="op" id="6588848">,</span>&nbsp;<span class="ident" id="6588850">err</span>&nbsp;<span class="op" id="6588854">:=</span>&nbsp;<span class="ident" id="6588857">c2</span><span class="op" id="6588859">.</span><span class="ident" id="6588860">Write</span><span class="op" id="6588865">(</span><span class="op" id="6588866">[</span><span class="op" id="6588867">]</span><span class="builtintype" id="6588868">byte</span><span class="op" id="6588872">(</span><span class="string" id="6588873">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="6588903">)</span><span class="op" id="6588904">)</span><span class="op" id="6588905">;</span>&nbsp;<span class="ident" id="6588907">err</span>&nbsp;<span class="op" id="6588911">!=</span>&nbsp;<span class="builtintype" id="6588914">nil</span>&nbsp;<span class="op" id="6588918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588923">t</span><span class="op" id="6588924">.</span><span class="ident" id="6588925">Fatalf</span><span class="op" id="6588931">(</span><span class="string" id="6588932">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6588955">,</span>&nbsp;<span class="ident" id="6588957">err</span><span class="op" id="6588960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6588964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6588968">b</span>&nbsp;<span class="op" id="6588970">:=</span>&nbsp;<span class="builtinfunc" id="6588973">make</span><span class="op" id="6588977">(</span><span class="op" id="6588978">[</span><span class="op" id="6588979">]</span><span class="builtintype" id="6588980">byte</span><span class="op" id="6588984">,</span>&nbsp;<span class="num" id="6588986">32</span><span class="op" id="6588988">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6588992">if</span>&nbsp;<span class="ident" id="6588995">_</span><span class="op" id="6588996">,</span>&nbsp;<span class="ident" id="6588998">from</span><span class="op" id="6589002">,</span>&nbsp;<span class="ident" id="6589004">err</span>&nbsp;<span class="op" id="6589008">:=</span>&nbsp;<span class="ident" id="6589011">c1</span><span class="op" id="6589013">.</span><span class="ident" id="6589014">ReadFrom</span><span class="op" id="6589022">(</span><span class="ident" id="6589023">b</span><span class="op" id="6589024">)</span><span class="op" id="6589025">;</span>&nbsp;<span class="ident" id="6589027">err</span>&nbsp;<span class="op" id="6589031">!=</span>&nbsp;<span class="builtintype" id="6589034">nil</span>&nbsp;<span class="op" id="6589038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6589043">t</span><span class="op" id="6589044">.</span><span class="ident" id="6589045">Fatalf</span><span class="op" id="6589051">(</span><span class="string" id="6589052">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6589084">,</span>&nbsp;<span class="ident" id="6589086">err</span><span class="op" id="6589089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6589093">}</span>&nbsp;<span class="keyword" id="6589095">else</span>&nbsp;<span class="op" id="6589100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6589105">if</span>&nbsp;<span class="ident" id="6589108">ra</span><span class="op" id="6589110">,</span>&nbsp;<span class="ident" id="6589112">ok</span>&nbsp;<span class="op" id="6589115">:=</span>&nbsp;<span class="ident" id="6589118">from</span><span class="op" id="6589122">.</span><span class="op" id="6589123">(</span><span class="op" id="6589124">*</span><span class="ident" id="6589125">UDPAddr</span><span class="op" id="6589132">)</span><span class="op" id="6589133">;</span>&nbsp;<span class="op" id="6589135">!</span><span class="ident" id="6589136">ok</span>&nbsp;<span class="op" id="6589139">||</span>&nbsp;<span class="op" id="6589142">!</span><span class="ident" id="6589143">tt</span><span class="op" id="6589145">.</span><span class="ident" id="6589146">nameLookup</span>&nbsp;<span class="op" id="6589157">&amp;&amp;</span>&nbsp;<span class="ident" id="6589160">ra</span><span class="op" id="6589162">.</span><span class="ident" id="6589163">Zone</span>&nbsp;<span class="op" id="6589168">==</span>&nbsp;<span class="string" id="6589171">&#34;&#34;</span>&nbsp;<span class="op" id="6589174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6589180">t</span><span class="op" id="6589181">.</span><span class="ident" id="6589182">Fatalf</span><span class="op" id="6589188">(</span><span class="string" id="6589189">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6589245">,</span>&nbsp;<span class="ident" id="6589247">ra</span><span class="op" id="6589249">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6589254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6589258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6589261">}</span><br>
<span class="lineno"></span><span class="op" id="6589263">}</span>
</div>
</body>
</html>
