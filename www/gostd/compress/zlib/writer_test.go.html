<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6885587">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6885642">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6885696">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6885747">package</span>&nbsp;<span class="ident" id="6885755">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6885761">import</span>&nbsp;<span class="op" id="6885768">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885771">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885780">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885787">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885793">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885806">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885812">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6885822">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6885825">var</span>&nbsp;<span class="ident" id="6885829">filenames</span>&nbsp;<span class="op" id="6885839">=</span>&nbsp;<span class="op" id="6885841">[</span><span class="op" id="6885842">]</span><span class="builtintype" id="6885843">string</span><span class="op" id="6885849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885852">&#34;../testdata/e.txt&#34;</span><span class="op" id="6885871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885874">&#34;../testdata/pi.txt&#34;</span><span class="op" id="6885894">,</span><br>
<span class="lineno"></span><span class="op" id="6885896">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6885899">var</span>&nbsp;<span class="ident" id="6885903">data</span>&nbsp;<span class="op" id="6885908">=</span>&nbsp;<span class="op" id="6885910">[</span><span class="op" id="6885911">]</span><span class="builtintype" id="6885912">string</span><span class="op" id="6885918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6885921">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="6885976">,</span><br>
<span class="lineno"></span><span class="op" id="6885978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6885981">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="6886091">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6886140">func</span>&nbsp;<span class="ident" id="6886145">testFileLevelDict</span><span class="op" id="6886162">(</span><span class="ident" id="6886163">t</span>&nbsp;<span class="op" id="6886165">*</span><span class="ident" id="6886166">testing</span><span class="op" id="6886173">.</span><span class="ident" id="6886174">T</span><span class="op" id="6886175">,</span>&nbsp;<span class="ident" id="6886177">fn</span>&nbsp;<span class="builtintype" id="6886180">string</span><span class="op" id="6886186">,</span>&nbsp;<span class="ident" id="6886188">level</span>&nbsp;<span class="builtintype" id="6886194">int</span><span class="op" id="6886197">,</span>&nbsp;<span class="ident" id="6886199">d</span>&nbsp;<span class="builtintype" id="6886201">string</span><span class="op" id="6886207">)</span>&nbsp;<span class="op" id="6886209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6886212">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886249">golden</span><span class="op" id="6886255">,</span>&nbsp;<span class="ident" id="6886257">err</span>&nbsp;<span class="op" id="6886261">:=</span>&nbsp;<span class="ident" id="6886264">os</span><span class="op" id="6886266">.</span><span class="ident" id="6886267">Open</span><span class="op" id="6886271">(</span><span class="ident" id="6886272">fn</span><span class="op" id="6886274">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886277">if</span>&nbsp;<span class="ident" id="6886280">err</span>&nbsp;<span class="op" id="6886284">!=</span>&nbsp;<span class="builtintype" id="6886287">nil</span>&nbsp;<span class="op" id="6886291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886295">t</span><span class="op" id="6886296">.</span><span class="ident" id="6886297">Errorf</span><span class="op" id="6886303">(</span><span class="string" id="6886304">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6886332">,</span>&nbsp;<span class="ident" id="6886334">fn</span><span class="op" id="6886336">,</span>&nbsp;<span class="ident" id="6886338">level</span><span class="op" id="6886343">,</span>&nbsp;<span class="ident" id="6886345">d</span><span class="op" id="6886346">,</span>&nbsp;<span class="ident" id="6886348">err</span><span class="op" id="6886351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886355">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886366">defer</span>&nbsp;<span class="ident" id="6886372">golden</span><span class="op" id="6886378">.</span><span class="ident" id="6886379">Close</span><span class="op" id="6886384">(</span><span class="op" id="6886385">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886388">b0</span><span class="op" id="6886390">,</span>&nbsp;<span class="ident" id="6886392">err0</span>&nbsp;<span class="op" id="6886397">:=</span>&nbsp;<span class="ident" id="6886400">ioutil</span><span class="op" id="6886406">.</span><span class="ident" id="6886407">ReadAll</span><span class="op" id="6886414">(</span><span class="ident" id="6886415">golden</span><span class="op" id="6886421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886424">if</span>&nbsp;<span class="ident" id="6886427">err0</span>&nbsp;<span class="op" id="6886432">!=</span>&nbsp;<span class="builtintype" id="6886435">nil</span>&nbsp;<span class="op" id="6886439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886443">t</span><span class="op" id="6886444">.</span><span class="ident" id="6886445">Errorf</span><span class="op" id="6886451">(</span><span class="string" id="6886452">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6886480">,</span>&nbsp;<span class="ident" id="6886482">fn</span><span class="op" id="6886484">,</span>&nbsp;<span class="ident" id="6886486">level</span><span class="op" id="6886491">,</span>&nbsp;<span class="ident" id="6886493">d</span><span class="op" id="6886494">,</span>&nbsp;<span class="ident" id="6886496">err0</span><span class="op" id="6886500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886504">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886512">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886515">testLevelDict</span><span class="op" id="6886528">(</span><span class="ident" id="6886529">t</span><span class="op" id="6886530">,</span>&nbsp;<span class="ident" id="6886532">fn</span><span class="op" id="6886534">,</span>&nbsp;<span class="ident" id="6886536">b0</span><span class="op" id="6886538">,</span>&nbsp;<span class="ident" id="6886540">level</span><span class="op" id="6886545">,</span>&nbsp;<span class="ident" id="6886547">d</span><span class="op" id="6886548">)</span><br>
<span class="lineno"></span><span class="op" id="6886550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6886553">func</span>&nbsp;<span class="ident" id="6886558">testLevelDict</span><span class="op" id="6886571">(</span><span class="ident" id="6886572">t</span>&nbsp;<span class="op" id="6886574">*</span><span class="ident" id="6886575">testing</span><span class="op" id="6886582">.</span><span class="ident" id="6886583">T</span><span class="op" id="6886584">,</span>&nbsp;<span class="ident" id="6886586">fn</span>&nbsp;<span class="builtintype" id="6886589">string</span><span class="op" id="6886595">,</span>&nbsp;<span class="ident" id="6886597">b0</span>&nbsp;<span class="op" id="6886600">[</span><span class="op" id="6886601">]</span><span class="builtintype" id="6886602">byte</span><span class="op" id="6886606">,</span>&nbsp;<span class="ident" id="6886608">level</span>&nbsp;<span class="builtintype" id="6886614">int</span><span class="op" id="6886617">,</span>&nbsp;<span class="ident" id="6886619">d</span>&nbsp;<span class="builtintype" id="6886621">string</span><span class="op" id="6886627">)</span>&nbsp;<span class="op" id="6886629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6886632">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886663">var</span>&nbsp;<span class="ident" id="6886667">dict</span>&nbsp;<span class="op" id="6886672">[</span><span class="op" id="6886673">]</span><span class="builtintype" id="6886674">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886680">if</span>&nbsp;<span class="ident" id="6886683">d</span>&nbsp;<span class="op" id="6886685">!=</span>&nbsp;<span class="string" id="6886688">&#34;&#34;</span>&nbsp;<span class="op" id="6886691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886695">dict</span>&nbsp;<span class="op" id="6886700">=</span>&nbsp;<span class="op" id="6886702">[</span><span class="op" id="6886703">]</span><span class="builtintype" id="6886704">byte</span><span class="op" id="6886708">(</span><span class="ident" id="6886709">d</span><span class="op" id="6886710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6886717">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886814">piper</span><span class="op" id="6886819">,</span>&nbsp;<span class="ident" id="6886821">pipew</span>&nbsp;<span class="op" id="6886827">:=</span>&nbsp;<span class="ident" id="6886830">io</span><span class="op" id="6886832">.</span><span class="ident" id="6886833">Pipe</span><span class="op" id="6886837">(</span><span class="op" id="6886838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886841">defer</span>&nbsp;<span class="ident" id="6886847">piper</span><span class="op" id="6886852">.</span><span class="ident" id="6886853">Close</span><span class="op" id="6886858">(</span><span class="op" id="6886859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886862">go</span>&nbsp;<span class="keyword" id="6886865">func</span><span class="op" id="6886869">(</span><span class="op" id="6886870">)</span>&nbsp;<span class="op" id="6886872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886876">defer</span>&nbsp;<span class="ident" id="6886882">pipew</span><span class="op" id="6886887">.</span><span class="ident" id="6886888">Close</span><span class="op" id="6886893">(</span><span class="op" id="6886894">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886898">zlibw</span><span class="op" id="6886903">,</span>&nbsp;<span class="ident" id="6886905">err</span>&nbsp;<span class="op" id="6886909">:=</span>&nbsp;<span class="ident" id="6886912">NewWriterLevelDict</span><span class="op" id="6886930">(</span><span class="ident" id="6886931">pipew</span><span class="op" id="6886936">,</span>&nbsp;<span class="ident" id="6886938">level</span><span class="op" id="6886943">,</span>&nbsp;<span class="ident" id="6886945">dict</span><span class="op" id="6886949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886953">if</span>&nbsp;<span class="ident" id="6886956">err</span>&nbsp;<span class="op" id="6886960">!=</span>&nbsp;<span class="builtintype" id="6886963">nil</span>&nbsp;<span class="op" id="6886967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886972">t</span><span class="op" id="6886973">.</span><span class="ident" id="6886974">Errorf</span><span class="op" id="6886980">(</span><span class="string" id="6886981">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6887009">,</span>&nbsp;<span class="ident" id="6887011">fn</span><span class="op" id="6887013">,</span>&nbsp;<span class="ident" id="6887015">level</span><span class="op" id="6887020">,</span>&nbsp;<span class="ident" id="6887022">d</span><span class="op" id="6887023">,</span>&nbsp;<span class="ident" id="6887025">err</span><span class="op" id="6887028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887033">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887042">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887046">defer</span>&nbsp;<span class="ident" id="6887052">zlibw</span><span class="op" id="6887057">.</span><span class="ident" id="6887058">Close</span><span class="op" id="6887063">(</span><span class="op" id="6887064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887068">_</span><span class="op" id="6887069">,</span>&nbsp;<span class="ident" id="6887071">err</span>&nbsp;<span class="op" id="6887075">=</span>&nbsp;<span class="ident" id="6887077">zlibw</span><span class="op" id="6887082">.</span><span class="ident" id="6887083">Write</span><span class="op" id="6887088">(</span><span class="ident" id="6887089">b0</span><span class="op" id="6887091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887095">if</span>&nbsp;<span class="ident" id="6887098">err</span>&nbsp;<span class="op" id="6887102">!=</span>&nbsp;<span class="builtintype" id="6887105">nil</span>&nbsp;<span class="op" id="6887109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887114">t</span><span class="op" id="6887115">.</span><span class="ident" id="6887116">Errorf</span><span class="op" id="6887122">(</span><span class="string" id="6887123">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6887151">,</span>&nbsp;<span class="ident" id="6887153">fn</span><span class="op" id="6887155">,</span>&nbsp;<span class="ident" id="6887157">level</span><span class="op" id="6887162">,</span>&nbsp;<span class="ident" id="6887164">d</span><span class="op" id="6887165">,</span>&nbsp;<span class="ident" id="6887167">err</span><span class="op" id="6887170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887175">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887187">}</span><span class="op" id="6887188">(</span><span class="op" id="6887189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887192">zlibr</span><span class="op" id="6887197">,</span>&nbsp;<span class="ident" id="6887199">err</span>&nbsp;<span class="op" id="6887203">:=</span>&nbsp;<span class="ident" id="6887206">NewReaderDict</span><span class="op" id="6887219">(</span><span class="ident" id="6887220">piper</span><span class="op" id="6887225">,</span>&nbsp;<span class="ident" id="6887227">dict</span><span class="op" id="6887231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887234">if</span>&nbsp;<span class="ident" id="6887237">err</span>&nbsp;<span class="op" id="6887241">!=</span>&nbsp;<span class="builtintype" id="6887244">nil</span>&nbsp;<span class="op" id="6887248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887252">t</span><span class="op" id="6887253">.</span><span class="ident" id="6887254">Errorf</span><span class="op" id="6887260">(</span><span class="string" id="6887261">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6887289">,</span>&nbsp;<span class="ident" id="6887291">fn</span><span class="op" id="6887293">,</span>&nbsp;<span class="ident" id="6887295">level</span><span class="op" id="6887300">,</span>&nbsp;<span class="ident" id="6887302">d</span><span class="op" id="6887303">,</span>&nbsp;<span class="ident" id="6887305">err</span><span class="op" id="6887308">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887312">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887323">defer</span>&nbsp;<span class="ident" id="6887329">zlibr</span><span class="op" id="6887334">.</span><span class="ident" id="6887335">Close</span><span class="op" id="6887340">(</span><span class="op" id="6887341">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6887345">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887380">b1</span><span class="op" id="6887382">,</span>&nbsp;<span class="ident" id="6887384">err1</span>&nbsp;<span class="op" id="6887389">:=</span>&nbsp;<span class="ident" id="6887392">ioutil</span><span class="op" id="6887398">.</span><span class="ident" id="6887399">ReadAll</span><span class="op" id="6887406">(</span><span class="ident" id="6887407">zlibr</span><span class="op" id="6887412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887415">if</span>&nbsp;<span class="ident" id="6887418">err1</span>&nbsp;<span class="op" id="6887423">!=</span>&nbsp;<span class="builtintype" id="6887426">nil</span>&nbsp;<span class="op" id="6887430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887434">t</span><span class="op" id="6887435">.</span><span class="ident" id="6887436">Errorf</span><span class="op" id="6887442">(</span><span class="string" id="6887443">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="6887471">,</span>&nbsp;<span class="ident" id="6887473">fn</span><span class="op" id="6887475">,</span>&nbsp;<span class="ident" id="6887477">level</span><span class="op" id="6887482">,</span>&nbsp;<span class="ident" id="6887484">d</span><span class="op" id="6887485">,</span>&nbsp;<span class="ident" id="6887487">err1</span><span class="op" id="6887491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887495">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887503">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887506">if</span>&nbsp;<span class="builtinfunc" id="6887509">len</span><span class="op" id="6887512">(</span><span class="ident" id="6887513">b0</span><span class="op" id="6887515">)</span>&nbsp;<span class="op" id="6887517">!=</span>&nbsp;<span class="builtinfunc" id="6887520">len</span><span class="op" id="6887523">(</span><span class="ident" id="6887524">b1</span><span class="op" id="6887526">)</span>&nbsp;<span class="op" id="6887528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887532">t</span><span class="op" id="6887533">.</span><span class="ident" id="6887534">Errorf</span><span class="op" id="6887540">(</span><span class="string" id="6887541">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="6887595">,</span>&nbsp;<span class="ident" id="6887597">fn</span><span class="op" id="6887599">,</span>&nbsp;<span class="ident" id="6887601">level</span><span class="op" id="6887606">,</span>&nbsp;<span class="ident" id="6887608">d</span><span class="op" id="6887609">,</span>&nbsp;<span class="builtinfunc" id="6887611">len</span><span class="op" id="6887614">(</span><span class="ident" id="6887615">b0</span><span class="op" id="6887617">)</span><span class="op" id="6887618">,</span>&nbsp;<span class="builtinfunc" id="6887620">len</span><span class="op" id="6887623">(</span><span class="ident" id="6887624">b1</span><span class="op" id="6887626">)</span><span class="op" id="6887627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887631">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887642">for</span>&nbsp;<span class="ident" id="6887646">i</span>&nbsp;<span class="op" id="6887648">:=</span>&nbsp;<span class="num" id="6887651">0</span><span class="op" id="6887652">;</span>&nbsp;<span class="ident" id="6887654">i</span>&nbsp;<span class="op" id="6887656">&lt;</span>&nbsp;<span class="builtinfunc" id="6887658">len</span><span class="op" id="6887661">(</span><span class="ident" id="6887662">b0</span><span class="op" id="6887664">)</span><span class="op" id="6887665">;</span>&nbsp;<span class="ident" id="6887667">i</span><span class="op" id="6887668">++</span>&nbsp;<span class="op" id="6887671">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887675">if</span>&nbsp;<span class="ident" id="6887678">b0</span><span class="op" id="6887680">[</span><span class="ident" id="6887681">i</span><span class="op" id="6887682">]</span>&nbsp;<span class="op" id="6887684">!=</span>&nbsp;<span class="ident" id="6887687">b1</span><span class="op" id="6887689">[</span><span class="ident" id="6887690">i</span><span class="op" id="6887691">]</span>&nbsp;<span class="op" id="6887693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887698">t</span><span class="op" id="6887699">.</span><span class="ident" id="6887700">Errorf</span><span class="op" id="6887706">(</span><span class="string" id="6887707">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="6887771">,</span>&nbsp;<span class="ident" id="6887773">fn</span><span class="op" id="6887775">,</span>&nbsp;<span class="ident" id="6887777">level</span><span class="op" id="6887782">,</span>&nbsp;<span class="ident" id="6887784">d</span><span class="op" id="6887785">,</span>&nbsp;<span class="ident" id="6887787">i</span><span class="op" id="6887788">,</span>&nbsp;<span class="ident" id="6887790">b0</span><span class="op" id="6887792">[</span><span class="ident" id="6887793">i</span><span class="op" id="6887794">]</span><span class="op" id="6887795">,</span>&nbsp;<span class="ident" id="6887797">b1</span><span class="op" id="6887799">[</span><span class="ident" id="6887800">i</span><span class="op" id="6887801">]</span><span class="op" id="6887802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887819">}</span><br>
<span class="lineno">90</span><span class="op" id="6887821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6887824">func</span>&nbsp;<span class="ident" id="6887829">testFileLevelDictReset</span><span class="op" id="6887851">(</span><span class="ident" id="6887852">t</span>&nbsp;<span class="op" id="6887854">*</span><span class="ident" id="6887855">testing</span><span class="op" id="6887862">.</span><span class="ident" id="6887863">T</span><span class="op" id="6887864">,</span>&nbsp;<span class="ident" id="6887866">fn</span>&nbsp;<span class="builtintype" id="6887869">string</span><span class="op" id="6887875">,</span>&nbsp;<span class="ident" id="6887877">level</span>&nbsp;<span class="builtintype" id="6887883">int</span><span class="op" id="6887886">,</span>&nbsp;<span class="ident" id="6887888">dict</span>&nbsp;<span class="op" id="6887893">[</span><span class="op" id="6887894">]</span><span class="builtintype" id="6887895">byte</span><span class="op" id="6887899">)</span>&nbsp;<span class="op" id="6887901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887904">var</span>&nbsp;<span class="ident" id="6887908">b0</span>&nbsp;<span class="op" id="6887911">[</span><span class="op" id="6887912">]</span><span class="builtintype" id="6887913">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887919">var</span>&nbsp;<span class="ident" id="6887923">err</span>&nbsp;<span class="builtintype" id="6887927">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887934">if</span>&nbsp;<span class="ident" id="6887937">fn</span>&nbsp;<span class="op" id="6887940">!=</span>&nbsp;<span class="string" id="6887943">&#34;&#34;</span>&nbsp;<span class="op" id="6887946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887950">b0</span><span class="op" id="6887952">,</span>&nbsp;<span class="ident" id="6887954">err</span>&nbsp;<span class="op" id="6887958">=</span>&nbsp;<span class="ident" id="6887960">ioutil</span><span class="op" id="6887966">.</span><span class="ident" id="6887967">ReadFile</span><span class="op" id="6887975">(</span><span class="ident" id="6887976">fn</span><span class="op" id="6887978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887982">if</span>&nbsp;<span class="ident" id="6887985">err</span>&nbsp;<span class="op" id="6887989">!=</span>&nbsp;<span class="builtintype" id="6887992">nil</span>&nbsp;<span class="op" id="6887996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888001">t</span><span class="op" id="6888002">.</span><span class="ident" id="6888003">Errorf</span><span class="op" id="6888009">(</span><span class="string" id="6888010">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6888029">,</span>&nbsp;<span class="ident" id="6888031">fn</span><span class="op" id="6888033">,</span>&nbsp;<span class="ident" id="6888035">level</span><span class="op" id="6888040">,</span>&nbsp;<span class="ident" id="6888042">err</span><span class="op" id="6888045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888050">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6888066">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888085">buf</span>&nbsp;<span class="op" id="6888089">:=</span>&nbsp;<span class="builtinfunc" id="6888092">new</span><span class="op" id="6888095">(</span><span class="ident" id="6888096">bytes</span><span class="op" id="6888101">.</span><span class="ident" id="6888102">Buffer</span><span class="op" id="6888108">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888111">var</span>&nbsp;<span class="ident" id="6888115">zlibw</span>&nbsp;<span class="op" id="6888121">*</span><span class="ident" id="6888122">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888130">if</span>&nbsp;<span class="ident" id="6888133">dict</span>&nbsp;<span class="op" id="6888138">==</span>&nbsp;<span class="builtintype" id="6888141">nil</span>&nbsp;<span class="op" id="6888145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888149">zlibw</span><span class="op" id="6888154">,</span>&nbsp;<span class="ident" id="6888156">err</span>&nbsp;<span class="op" id="6888160">=</span>&nbsp;<span class="ident" id="6888162">NewWriterLevel</span><span class="op" id="6888176">(</span><span class="ident" id="6888177">buf</span><span class="op" id="6888180">,</span>&nbsp;<span class="ident" id="6888182">level</span><span class="op" id="6888187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888190">}</span>&nbsp;<span class="keyword" id="6888192">else</span>&nbsp;<span class="op" id="6888197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888201">zlibw</span><span class="op" id="6888206">,</span>&nbsp;<span class="ident" id="6888208">err</span>&nbsp;<span class="op" id="6888212">=</span>&nbsp;<span class="ident" id="6888214">NewWriterLevelDict</span><span class="op" id="6888232">(</span><span class="ident" id="6888233">buf</span><span class="op" id="6888236">,</span>&nbsp;<span class="ident" id="6888238">level</span><span class="op" id="6888243">,</span>&nbsp;<span class="ident" id="6888245">dict</span><span class="op" id="6888249">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888255">if</span>&nbsp;<span class="ident" id="6888258">err</span>&nbsp;<span class="op" id="6888262">==</span>&nbsp;<span class="builtintype" id="6888265">nil</span>&nbsp;<span class="op" id="6888269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888273">_</span><span class="op" id="6888274">,</span>&nbsp;<span class="ident" id="6888276">err</span>&nbsp;<span class="op" id="6888280">=</span>&nbsp;<span class="ident" id="6888282">zlibw</span><span class="op" id="6888287">.</span><span class="ident" id="6888288">Write</span><span class="op" id="6888293">(</span><span class="ident" id="6888294">b0</span><span class="op" id="6888296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888302">if</span>&nbsp;<span class="ident" id="6888305">err</span>&nbsp;<span class="op" id="6888309">==</span>&nbsp;<span class="builtintype" id="6888312">nil</span>&nbsp;<span class="op" id="6888316">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888320">err</span>&nbsp;<span class="op" id="6888324">=</span>&nbsp;<span class="ident" id="6888326">zlibw</span><span class="op" id="6888331">.</span><span class="ident" id="6888332">Close</span><span class="op" id="6888337">(</span><span class="op" id="6888338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888344">if</span>&nbsp;<span class="ident" id="6888347">err</span>&nbsp;<span class="op" id="6888351">!=</span>&nbsp;<span class="builtintype" id="6888354">nil</span>&nbsp;<span class="op" id="6888358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888362">t</span><span class="op" id="6888363">.</span><span class="ident" id="6888364">Errorf</span><span class="op" id="6888370">(</span><span class="string" id="6888371">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6888390">,</span>&nbsp;<span class="ident" id="6888392">fn</span><span class="op" id="6888394">,</span>&nbsp;<span class="ident" id="6888396">level</span><span class="op" id="6888401">,</span>&nbsp;<span class="ident" id="6888403">err</span><span class="op" id="6888406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888410">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888421">out</span>&nbsp;<span class="op" id="6888425">:=</span>&nbsp;<span class="ident" id="6888428">buf</span><span class="op" id="6888431">.</span><span class="ident" id="6888432">String</span><span class="op" id="6888438">(</span><span class="op" id="6888439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6888443">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888473">buf2</span>&nbsp;<span class="op" id="6888478">:=</span>&nbsp;<span class="builtinfunc" id="6888481">new</span><span class="op" id="6888484">(</span><span class="ident" id="6888485">bytes</span><span class="op" id="6888490">.</span><span class="ident" id="6888491">Buffer</span><span class="op" id="6888497">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888500">zlibw</span><span class="op" id="6888505">.</span><span class="ident" id="6888506">Reset</span><span class="op" id="6888511">(</span><span class="ident" id="6888512">buf2</span><span class="op" id="6888516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888519">_</span><span class="op" id="6888520">,</span>&nbsp;<span class="ident" id="6888522">err</span>&nbsp;<span class="op" id="6888526">=</span>&nbsp;<span class="ident" id="6888528">zlibw</span><span class="op" id="6888533">.</span><span class="ident" id="6888534">Write</span><span class="op" id="6888539">(</span><span class="ident" id="6888540">b0</span><span class="op" id="6888542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888545">if</span>&nbsp;<span class="ident" id="6888548">err</span>&nbsp;<span class="op" id="6888552">==</span>&nbsp;<span class="builtintype" id="6888555">nil</span>&nbsp;<span class="op" id="6888559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888563">err</span>&nbsp;<span class="op" id="6888567">=</span>&nbsp;<span class="ident" id="6888569">zlibw</span><span class="op" id="6888574">.</span><span class="ident" id="6888575">Close</span><span class="op" id="6888580">(</span><span class="op" id="6888581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888584">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888587">if</span>&nbsp;<span class="ident" id="6888590">err</span>&nbsp;<span class="op" id="6888594">!=</span>&nbsp;<span class="builtintype" id="6888597">nil</span>&nbsp;<span class="op" id="6888601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888605">t</span><span class="op" id="6888606">.</span><span class="ident" id="6888607">Errorf</span><span class="op" id="6888613">(</span><span class="string" id="6888614">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="6888633">,</span>&nbsp;<span class="ident" id="6888635">fn</span><span class="op" id="6888637">,</span>&nbsp;<span class="ident" id="6888639">level</span><span class="op" id="6888644">,</span>&nbsp;<span class="ident" id="6888646">err</span><span class="op" id="6888649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888653">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888664">out2</span>&nbsp;<span class="op" id="6888669">:=</span>&nbsp;<span class="ident" id="6888672">buf2</span><span class="op" id="6888676">.</span><span class="ident" id="6888677">String</span><span class="op" id="6888683">(</span><span class="op" id="6888684">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888688">if</span>&nbsp;<span class="ident" id="6888691">out2</span>&nbsp;<span class="op" id="6888696">!=</span>&nbsp;<span class="ident" id="6888699">out</span>&nbsp;<span class="op" id="6888703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888707">t</span><span class="op" id="6888708">.</span><span class="ident" id="6888709">Errorf</span><span class="op" id="6888715">(</span><span class="string" id="6888716">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6888788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888793">fn</span><span class="op" id="6888795">,</span>&nbsp;<span class="ident" id="6888797">level</span><span class="op" id="6888802">,</span>&nbsp;<span class="builtinfunc" id="6888804">len</span><span class="op" id="6888807">(</span><span class="ident" id="6888808">out2</span><span class="op" id="6888812">)</span><span class="op" id="6888813">,</span>&nbsp;<span class="builtinfunc" id="6888815">len</span><span class="op" id="6888818">(</span><span class="ident" id="6888819">out</span><span class="op" id="6888822">)</span><span class="op" id="6888823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888826">}</span><br>
<span class="lineno">140</span><span class="op" id="6888828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6888831">func</span>&nbsp;<span class="ident" id="6888836">TestWriter</span><span class="op" id="6888846">(</span><span class="ident" id="6888847">t</span>&nbsp;<span class="op" id="6888849">*</span><span class="ident" id="6888850">testing</span><span class="op" id="6888857">.</span><span class="ident" id="6888858">T</span><span class="op" id="6888859">)</span>&nbsp;<span class="op" id="6888861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888864">for</span>&nbsp;<span class="ident" id="6888868">i</span><span class="op" id="6888869">,</span>&nbsp;<span class="ident" id="6888871">s</span>&nbsp;<span class="op" id="6888873">:=</span>&nbsp;<span class="keyword" id="6888876">range</span>&nbsp;<span class="ident" id="6888882">data</span>&nbsp;<span class="op" id="6888887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888891">b</span>&nbsp;<span class="op" id="6888893">:=</span>&nbsp;<span class="op" id="6888896">[</span><span class="op" id="6888897">]</span><span class="builtintype" id="6888898">byte</span><span class="op" id="6888902">(</span><span class="ident" id="6888903">s</span><span class="op" id="6888904">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888908">tag</span>&nbsp;<span class="op" id="6888912">:=</span>&nbsp;<span class="ident" id="6888915">fmt</span><span class="op" id="6888918">.</span><span class="ident" id="6888919">Sprintf</span><span class="op" id="6888926">(</span><span class="string" id="6888927">&#34;#%d&#34;</span><span class="op" id="6888932">,</span>&nbsp;<span class="ident" id="6888934">i</span><span class="op" id="6888935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888939">testLevelDict</span><span class="op" id="6888952">(</span><span class="ident" id="6888953">t</span><span class="op" id="6888954">,</span>&nbsp;<span class="ident" id="6888956">tag</span><span class="op" id="6888959">,</span>&nbsp;<span class="ident" id="6888961">b</span><span class="op" id="6888962">,</span>&nbsp;<span class="ident" id="6888964">DefaultCompression</span><span class="op" id="6888982">,</span>&nbsp;<span class="string" id="6888984">&#34;&#34;</span><span class="op" id="6888986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888990">testLevelDict</span><span class="op" id="6889003">(</span><span class="ident" id="6889004">t</span><span class="op" id="6889005">,</span>&nbsp;<span class="ident" id="6889007">tag</span><span class="op" id="6889010">,</span>&nbsp;<span class="ident" id="6889012">b</span><span class="op" id="6889013">,</span>&nbsp;<span class="ident" id="6889015">NoCompression</span><span class="op" id="6889028">,</span>&nbsp;<span class="string" id="6889030">&#34;&#34;</span><span class="op" id="6889032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889036">for</span>&nbsp;<span class="ident" id="6889040">level</span>&nbsp;<span class="op" id="6889046">:=</span>&nbsp;<span class="ident" id="6889049">BestSpeed</span><span class="op" id="6889058">;</span>&nbsp;<span class="ident" id="6889060">level</span>&nbsp;<span class="op" id="6889066">&lt;=</span>&nbsp;<span class="ident" id="6889069">BestCompression</span><span class="op" id="6889084">;</span>&nbsp;<span class="ident" id="6889086">level</span><span class="op" id="6889091">++</span>&nbsp;<span class="op" id="6889094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889099">testLevelDict</span><span class="op" id="6889112">(</span><span class="ident" id="6889113">t</span><span class="op" id="6889114">,</span>&nbsp;<span class="ident" id="6889116">tag</span><span class="op" id="6889119">,</span>&nbsp;<span class="ident" id="6889121">b</span><span class="op" id="6889122">,</span>&nbsp;<span class="ident" id="6889124">level</span><span class="op" id="6889129">,</span>&nbsp;<span class="string" id="6889131">&#34;&#34;</span><span class="op" id="6889133">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889140">}</span><br>
<span class="lineno"></span><span class="op" id="6889142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6889145">func</span>&nbsp;<span class="ident" id="6889150">TestWriterBig</span><span class="op" id="6889163">(</span><span class="ident" id="6889164">t</span>&nbsp;<span class="op" id="6889166">*</span><span class="ident" id="6889167">testing</span><span class="op" id="6889174">.</span><span class="ident" id="6889175">T</span><span class="op" id="6889176">)</span>&nbsp;<span class="op" id="6889178">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889181">for</span>&nbsp;<span class="ident" id="6889185">_</span><span class="op" id="6889186">,</span>&nbsp;<span class="ident" id="6889188">fn</span>&nbsp;<span class="op" id="6889191">:=</span>&nbsp;<span class="keyword" id="6889194">range</span>&nbsp;<span class="ident" id="6889200">filenames</span>&nbsp;<span class="op" id="6889210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889214">testFileLevelDict</span><span class="op" id="6889231">(</span><span class="ident" id="6889232">t</span><span class="op" id="6889233">,</span>&nbsp;<span class="ident" id="6889235">fn</span><span class="op" id="6889237">,</span>&nbsp;<span class="ident" id="6889239">DefaultCompression</span><span class="op" id="6889257">,</span>&nbsp;<span class="string" id="6889259">&#34;&#34;</span><span class="op" id="6889261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889265">testFileLevelDict</span><span class="op" id="6889282">(</span><span class="ident" id="6889283">t</span><span class="op" id="6889284">,</span>&nbsp;<span class="ident" id="6889286">fn</span><span class="op" id="6889288">,</span>&nbsp;<span class="ident" id="6889290">NoCompression</span><span class="op" id="6889303">,</span>&nbsp;<span class="string" id="6889305">&#34;&#34;</span><span class="op" id="6889307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889311">for</span>&nbsp;<span class="ident" id="6889315">level</span>&nbsp;<span class="op" id="6889321">:=</span>&nbsp;<span class="ident" id="6889324">BestSpeed</span><span class="op" id="6889333">;</span>&nbsp;<span class="ident" id="6889335">level</span>&nbsp;<span class="op" id="6889341">&lt;=</span>&nbsp;<span class="ident" id="6889344">BestCompression</span><span class="op" id="6889359">;</span>&nbsp;<span class="ident" id="6889361">level</span><span class="op" id="6889366">++</span>&nbsp;<span class="op" id="6889369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889374">testFileLevelDict</span><span class="op" id="6889391">(</span><span class="ident" id="6889392">t</span><span class="op" id="6889393">,</span>&nbsp;<span class="ident" id="6889395">fn</span><span class="op" id="6889397">,</span>&nbsp;<span class="ident" id="6889399">level</span><span class="op" id="6889404">,</span>&nbsp;<span class="string" id="6889406">&#34;&#34;</span><span class="op" id="6889408">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889415">}</span><br>
<span class="lineno"></span><span class="op" id="6889417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6889420">func</span>&nbsp;<span class="ident" id="6889425">TestWriterDict</span><span class="op" id="6889439">(</span><span class="ident" id="6889440">t</span>&nbsp;<span class="op" id="6889442">*</span><span class="ident" id="6889443">testing</span><span class="op" id="6889450">.</span><span class="ident" id="6889451">T</span><span class="op" id="6889452">)</span>&nbsp;<span class="op" id="6889454">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889457">const</span>&nbsp;<span class="ident" id="6889463">dictionary</span>&nbsp;<span class="op" id="6889474">=</span>&nbsp;<span class="string" id="6889476">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889491">for</span>&nbsp;<span class="ident" id="6889495">_</span><span class="op" id="6889496">,</span>&nbsp;<span class="ident" id="6889498">fn</span>&nbsp;<span class="op" id="6889501">:=</span>&nbsp;<span class="keyword" id="6889504">range</span>&nbsp;<span class="ident" id="6889510">filenames</span>&nbsp;<span class="op" id="6889520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889524">testFileLevelDict</span><span class="op" id="6889541">(</span><span class="ident" id="6889542">t</span><span class="op" id="6889543">,</span>&nbsp;<span class="ident" id="6889545">fn</span><span class="op" id="6889547">,</span>&nbsp;<span class="ident" id="6889549">DefaultCompression</span><span class="op" id="6889567">,</span>&nbsp;<span class="ident" id="6889569">dictionary</span><span class="op" id="6889579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889583">testFileLevelDict</span><span class="op" id="6889600">(</span><span class="ident" id="6889601">t</span><span class="op" id="6889602">,</span>&nbsp;<span class="ident" id="6889604">fn</span><span class="op" id="6889606">,</span>&nbsp;<span class="ident" id="6889608">NoCompression</span><span class="op" id="6889621">,</span>&nbsp;<span class="ident" id="6889623">dictionary</span><span class="op" id="6889633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889637">for</span>&nbsp;<span class="ident" id="6889641">level</span>&nbsp;<span class="op" id="6889647">:=</span>&nbsp;<span class="ident" id="6889650">BestSpeed</span><span class="op" id="6889659">;</span>&nbsp;<span class="ident" id="6889661">level</span>&nbsp;<span class="op" id="6889667">&lt;=</span>&nbsp;<span class="ident" id="6889670">BestCompression</span><span class="op" id="6889685">;</span>&nbsp;<span class="ident" id="6889687">level</span><span class="op" id="6889692">++</span>&nbsp;<span class="op" id="6889695">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889700">testFileLevelDict</span><span class="op" id="6889717">(</span><span class="ident" id="6889718">t</span><span class="op" id="6889719">,</span>&nbsp;<span class="ident" id="6889721">fn</span><span class="op" id="6889723">,</span>&nbsp;<span class="ident" id="6889725">level</span><span class="op" id="6889730">,</span>&nbsp;<span class="ident" id="6889732">dictionary</span><span class="op" id="6889742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6889749">}</span><br>
<span class="lineno"></span><span class="op" id="6889751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6889754">func</span>&nbsp;<span class="ident" id="6889759">TestWriterReset</span><span class="op" id="6889774">(</span><span class="ident" id="6889775">t</span>&nbsp;<span class="op" id="6889777">*</span><span class="ident" id="6889778">testing</span><span class="op" id="6889785">.</span><span class="ident" id="6889786">T</span><span class="op" id="6889787">)</span>&nbsp;<span class="op" id="6889789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889792">const</span>&nbsp;<span class="ident" id="6889798">dictionary</span>&nbsp;<span class="op" id="6889809">=</span>&nbsp;<span class="string" id="6889811">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6889826">for</span>&nbsp;<span class="ident" id="6889830">_</span><span class="op" id="6889831">,</span>&nbsp;<span class="ident" id="6889833">fn</span>&nbsp;<span class="op" id="6889836">:=</span>&nbsp;<span class="keyword" id="6889839">range</span>&nbsp;<span class="ident" id="6889845">filenames</span>&nbsp;<span class="op" id="6889855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889859">testFileLevelDictReset</span><span class="op" id="6889881">(</span><span class="ident" id="6889882">t</span><span class="op" id="6889883">,</span>&nbsp;<span class="ident" id="6889885">fn</span><span class="op" id="6889887">,</span>&nbsp;<span class="ident" id="6889889">NoCompression</span><span class="op" id="6889902">,</span>&nbsp;<span class="builtintype" id="6889904">nil</span><span class="op" id="6889907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889911">testFileLevelDictReset</span><span class="op" id="6889933">(</span><span class="ident" id="6889934">t</span><span class="op" id="6889935">,</span>&nbsp;<span class="ident" id="6889937">fn</span><span class="op" id="6889939">,</span>&nbsp;<span class="ident" id="6889941">DefaultCompression</span><span class="op" id="6889959">,</span>&nbsp;<span class="builtintype" id="6889961">nil</span><span class="op" id="6889964">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6889968">testFileLevelDictReset</span><span class="op" id="6889990">(</span><span class="ident" id="6889991">t</span><span class="op" id="6889992">,</span>&nbsp;<span class="ident" id="6889994">fn</span><span class="op" id="6889996">,</span>&nbsp;<span class="ident" id="6889998">NoCompression</span><span class="op" id="6890011">,</span>&nbsp;<span class="op" id="6890013">[</span><span class="op" id="6890014">]</span><span class="builtintype" id="6890015">byte</span><span class="op" id="6890019">(</span><span class="ident" id="6890020">dictionary</span><span class="op" id="6890030">)</span><span class="op" id="6890031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890035">testFileLevelDictReset</span><span class="op" id="6890057">(</span><span class="ident" id="6890058">t</span><span class="op" id="6890059">,</span>&nbsp;<span class="ident" id="6890061">fn</span><span class="op" id="6890063">,</span>&nbsp;<span class="ident" id="6890065">DefaultCompression</span><span class="op" id="6890083">,</span>&nbsp;<span class="op" id="6890085">[</span><span class="op" id="6890086">]</span><span class="builtintype" id="6890087">byte</span><span class="op" id="6890091">(</span><span class="ident" id="6890092">dictionary</span><span class="op" id="6890102">)</span><span class="op" id="6890103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890107">if</span>&nbsp;<span class="op" id="6890110">!</span><span class="ident" id="6890111">testing</span><span class="op" id="6890118">.</span><span class="ident" id="6890119">Short</span><span class="op" id="6890124">(</span><span class="op" id="6890125">)</span>&nbsp;<span class="op" id="6890127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890132">for</span>&nbsp;<span class="ident" id="6890136">level</span>&nbsp;<span class="op" id="6890142">:=</span>&nbsp;<span class="ident" id="6890145">BestSpeed</span><span class="op" id="6890154">;</span>&nbsp;<span class="ident" id="6890156">level</span>&nbsp;<span class="op" id="6890162">&lt;=</span>&nbsp;<span class="ident" id="6890165">BestCompression</span><span class="op" id="6890180">;</span>&nbsp;<span class="ident" id="6890182">level</span><span class="op" id="6890187">++</span>&nbsp;<span class="op" id="6890190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890196">testFileLevelDictReset</span><span class="op" id="6890218">(</span><span class="ident" id="6890219">t</span><span class="op" id="6890220">,</span>&nbsp;<span class="ident" id="6890222">fn</span><span class="op" id="6890224">,</span>&nbsp;<span class="ident" id="6890226">level</span><span class="op" id="6890231">,</span>&nbsp;<span class="builtintype" id="6890233">nil</span><span class="op" id="6890236">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6890241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6890245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6890248">}</span><br>
<span class="lineno"></span><span class="op" id="6890250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="6890253">func</span>&nbsp;<span class="ident" id="6890258">TestWriterDictIsUsed</span><span class="op" id="6890278">(</span><span class="ident" id="6890279">t</span>&nbsp;<span class="op" id="6890281">*</span><span class="ident" id="6890282">testing</span><span class="op" id="6890289">.</span><span class="ident" id="6890290">T</span><span class="op" id="6890291">)</span>&nbsp;<span class="op" id="6890293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890296">var</span>&nbsp;<span class="ident" id="6890300">input</span>&nbsp;<span class="op" id="6890306">=</span>&nbsp;<span class="op" id="6890308">[</span><span class="op" id="6890309">]</span><span class="builtintype" id="6890310">byte</span><span class="op" id="6890314">(</span><span class="string" id="6890315">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="6890441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890444">var</span>&nbsp;<span class="ident" id="6890448">buf</span>&nbsp;<span class="ident" id="6890452">bytes</span><span class="op" id="6890457">.</span><span class="ident" id="6890458">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890466">compressor</span><span class="op" id="6890476">,</span>&nbsp;<span class="ident" id="6890478">err</span>&nbsp;<span class="op" id="6890482">:=</span>&nbsp;<span class="ident" id="6890485">NewWriterLevelDict</span><span class="op" id="6890503">(</span><span class="op" id="6890504">&amp;</span><span class="ident" id="6890505">buf</span><span class="op" id="6890508">,</span>&nbsp;<span class="ident" id="6890510">BestCompression</span><span class="op" id="6890525">,</span>&nbsp;<span class="ident" id="6890527">input</span><span class="op" id="6890532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890535">if</span>&nbsp;<span class="ident" id="6890538">err</span>&nbsp;<span class="op" id="6890542">!=</span>&nbsp;<span class="builtintype" id="6890545">nil</span>&nbsp;<span class="op" id="6890549">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890553">t</span><span class="op" id="6890554">.</span><span class="ident" id="6890555">Errorf</span><span class="op" id="6890561">(</span><span class="string" id="6890562">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="6890595">,</span>&nbsp;<span class="ident" id="6890597">err</span><span class="op" id="6890600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890604">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6890612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890615">compressor</span><span class="op" id="6890625">.</span><span class="ident" id="6890626">Write</span><span class="op" id="6890631">(</span><span class="ident" id="6890632">input</span><span class="op" id="6890637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890640">compressor</span><span class="op" id="6890650">.</span><span class="ident" id="6890651">Close</span><span class="op" id="6890656">(</span><span class="op" id="6890657">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890660">const</span>&nbsp;<span class="ident" id="6890666">expectedMaxSize</span>&nbsp;<span class="op" id="6890682">=</span>&nbsp;<span class="num" id="6890684">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890688">output</span>&nbsp;<span class="op" id="6890695">:=</span>&nbsp;<span class="ident" id="6890698">buf</span><span class="op" id="6890701">.</span><span class="ident" id="6890702">Bytes</span><span class="op" id="6890707">(</span><span class="op" id="6890708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6890711">if</span>&nbsp;<span class="builtinfunc" id="6890714">len</span><span class="op" id="6890717">(</span><span class="ident" id="6890718">output</span><span class="op" id="6890724">)</span>&nbsp;<span class="op" id="6890726">&gt;</span>&nbsp;<span class="ident" id="6890728">expectedMaxSize</span>&nbsp;<span class="op" id="6890744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6890748">t</span><span class="op" id="6890749">.</span><span class="ident" id="6890750">Errorf</span><span class="op" id="6890756">(</span><span class="string" id="6890757">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="6890833">,</span>&nbsp;<span class="builtinfunc" id="6890835">len</span><span class="op" id="6890838">(</span><span class="ident" id="6890839">output</span><span class="op" id="6890845">)</span><span class="op" id="6890846">,</span>&nbsp;<span class="ident" id="6890848">expectedMaxSize</span><span class="op" id="6890863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6890866">}</span><br>
<span class="lineno">205</span><span class="op" id="6890868">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
