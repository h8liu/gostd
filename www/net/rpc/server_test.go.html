<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7197531">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7197586">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7197640">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7197691">package</span>&nbsp;<span class="ident" id="7197699">rpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7197704">import</span>&nbsp;<span class="op" id="7197711">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197714">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197724">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197731">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197737">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197744">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197751">&#34;net/http/httptest&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197772">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197783">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197794">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197802">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197817">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7197828">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7197835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7197838">var</span>&nbsp;<span class="op" id="7197842">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7197845">newServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7197871">*</span><span class="ident" id="7197872"><a href="/net/rpc/server.go.html#5008452">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7197880">serverAddr</span><span class="op" id="7197890">,</span>&nbsp;<span class="ident" id="7197892">newServerAddr</span>&nbsp;<span class="builtintype" id="7197906">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7197914">httpServerAddr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7197940">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7197948">once</span><span class="op" id="7197952">,</span>&nbsp;<span class="ident" id="7197954">newOnce</span><span class="op" id="7197961">,</span>&nbsp;<span class="ident" id="7197963">httpOnce</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7197974"><a href="/net/rpc/server_test.go.html#7197794">sync</a></span><span class="op" id="7197978">.</span><span class="ident" id="7197979">Once</span><br>
<span class="lineno"></span><span class="op" id="7197984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7197987">const</span>&nbsp;<span class="op" id="7197993">(</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7197996">newHttpPath</span>&nbsp;<span class="op" id="7198008">=</span>&nbsp;<span class="string" id="7198010">&#34;/foo&#34;</span><br>
<span class="lineno"></span><span class="op" id="7198017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198020">type</span>&nbsp;<span class="ident" id="7198025">Args</span>&nbsp;<span class="keyword" id="7198030">struct</span>&nbsp;<span class="op" id="7198037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198040">A</span><span class="op" id="7198041">,</span>&nbsp;<span class="ident" id="7198043">B</span>&nbsp;<span class="builtintype" id="7198045">int</span><br>
<span class="lineno">35</span><span class="op" id="7198049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198052">type</span>&nbsp;<span class="ident" id="7198057">Reply</span>&nbsp;<span class="keyword" id="7198063">struct</span>&nbsp;<span class="op" id="7198070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198073">C</span>&nbsp;<span class="builtintype" id="7198075">int</span><br>
<span class="lineno"></span><span class="op" id="7198079">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7198082">type</span>&nbsp;<span class="ident" id="7198087">Arith</span>&nbsp;<span class="builtintype" id="7198093">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7198098">//&nbsp;Some&nbsp;of&nbsp;Arith&#39;s&nbsp;methods&nbsp;have&nbsp;value&nbsp;args,&nbsp;some&nbsp;have&nbsp;pointer&nbsp;args.&nbsp;That&#39;s&nbsp;deliberate.</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7198186">func</span>&nbsp;<span class="op" id="7198191">(</span><span class="ident" id="7198192">t</span>&nbsp;<span class="op" id="7198194">*</span><span class="ident" id="7198195"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198200">)</span>&nbsp;<span class="ident" id="7198202">Add</span><span class="op" id="7198205">(</span><span class="ident" id="7198206">args</span>&nbsp;<span class="ident" id="7198211"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7198215">,</span>&nbsp;<span class="ident" id="7198217">reply</span>&nbsp;<span class="op" id="7198223">*</span><span class="ident" id="7198224"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7198229">)</span>&nbsp;<span class="builtintype" id="7198231">error</span>&nbsp;<span class="op" id="7198237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198240"><a href="/net/rpc/server_test.go.html#7198217">reply</a></span><span class="op" id="7198245">.</span><span class="ident" id="7198246">C</span>&nbsp;<span class="op" id="7198248">=</span>&nbsp;<span class="ident" id="7198250"><a href="/net/rpc/server_test.go.html#7198206">args</a></span><span class="op" id="7198254">.</span><span class="ident" id="7198255">A</span>&nbsp;<span class="op" id="7198257">+</span>&nbsp;<span class="ident" id="7198259"><a href="/net/rpc/server_test.go.html#7198206">args</a></span><span class="op" id="7198263">.</span><span class="ident" id="7198264">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198267">return</span>&nbsp;<span class="ident" id="7198274">nil</span><br>
<span class="lineno"></span><span class="op" id="7198278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="7198281">func</span>&nbsp;<span class="op" id="7198286">(</span><span class="ident" id="7198287">t</span>&nbsp;<span class="op" id="7198289">*</span><span class="ident" id="7198290"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198295">)</span>&nbsp;<span class="ident" id="7198297">Mul</span><span class="op" id="7198300">(</span><span class="ident" id="7198301">args</span>&nbsp;<span class="op" id="7198306">*</span><span class="ident" id="7198307"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7198311">,</span>&nbsp;<span class="ident" id="7198313">reply</span>&nbsp;<span class="op" id="7198319">*</span><span class="ident" id="7198320"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7198325">)</span>&nbsp;<span class="builtintype" id="7198327">error</span>&nbsp;<span class="op" id="7198333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198336"><a href="/net/rpc/server_test.go.html#7198313">reply</a></span><span class="op" id="7198341">.</span><span class="ident" id="7198342">C</span>&nbsp;<span class="op" id="7198344">=</span>&nbsp;<span class="ident" id="7198346"><a href="/net/rpc/server_test.go.html#7198301">args</a></span><span class="op" id="7198350">.</span><span class="ident" id="7198351">A</span>&nbsp;<span class="op" id="7198353">*</span>&nbsp;<span class="ident" id="7198355"><a href="/net/rpc/server_test.go.html#7198301">args</a></span><span class="op" id="7198359">.</span><span class="ident" id="7198360">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198363">return</span>&nbsp;<span class="ident" id="7198370">nil</span><br>
<span class="lineno"></span><span class="op" id="7198374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7198377">func</span>&nbsp;<span class="op" id="7198382">(</span><span class="ident" id="7198383">t</span>&nbsp;<span class="op" id="7198385">*</span><span class="ident" id="7198386"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198391">)</span>&nbsp;<span class="ident" id="7198393">Div</span><span class="op" id="7198396">(</span><span class="ident" id="7198397">args</span>&nbsp;<span class="ident" id="7198402"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7198406">,</span>&nbsp;<span class="ident" id="7198408">reply</span>&nbsp;<span class="op" id="7198414">*</span><span class="ident" id="7198415"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7198420">)</span>&nbsp;<span class="builtintype" id="7198422">error</span>&nbsp;<span class="op" id="7198428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198431">if</span>&nbsp;<span class="ident" id="7198434"><a href="/net/rpc/server_test.go.html#7198397">args</a></span><span class="op" id="7198438">.</span><span class="ident" id="7198439">B</span>&nbsp;<span class="op" id="7198441">==</span>&nbsp;<span class="num" id="7198444">0</span>&nbsp;<span class="op" id="7198446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198450">return</span>&nbsp;<span class="ident" id="7198457"><a href="/net/rpc/server_test.go.html#7197714">errors</a></span><span class="op" id="7198463">.</span><span class="ident" id="7198464">New</span><span class="op" id="7198467">(</span><span class="string" id="7198468">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="7198484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7198487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198490"><a href="/net/rpc/server_test.go.html#7198408">reply</a></span><span class="op" id="7198495">.</span><span class="ident" id="7198496">C</span>&nbsp;<span class="op" id="7198498">=</span>&nbsp;<span class="ident" id="7198500"><a href="/net/rpc/server_test.go.html#7198397">args</a></span><span class="op" id="7198504">.</span><span class="ident" id="7198505">A</span>&nbsp;<span class="op" id="7198507">/</span>&nbsp;<span class="ident" id="7198509"><a href="/net/rpc/server_test.go.html#7198397">args</a></span><span class="op" id="7198513">.</span><span class="ident" id="7198514">B</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198517">return</span>&nbsp;<span class="ident" id="7198524">nil</span><br>
<span class="lineno"></span><span class="op" id="7198528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198531">func</span>&nbsp;<span class="op" id="7198536">(</span><span class="ident" id="7198537">t</span>&nbsp;<span class="op" id="7198539">*</span><span class="ident" id="7198540"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198545">)</span>&nbsp;<span class="ident" id="7198547">String</span><span class="op" id="7198553">(</span><span class="ident" id="7198554">args</span>&nbsp;<span class="op" id="7198559">*</span><span class="ident" id="7198560"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7198564">,</span>&nbsp;<span class="ident" id="7198566">reply</span>&nbsp;<span class="op" id="7198572">*</span><span class="builtintype" id="7198573">string</span><span class="op" id="7198579">)</span>&nbsp;<span class="builtintype" id="7198581">error</span>&nbsp;<span class="op" id="7198587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7198590">*</span><span class="ident" id="7198591"><a href="/net/rpc/server_test.go.html#7198566">reply</a></span>&nbsp;<span class="op" id="7198597">=</span>&nbsp;<span class="ident" id="7198599"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7198602">.</span><span class="ident" id="7198603">Sprintf</span><span class="op" id="7198610">(</span><span class="string" id="7198611">&#34;%d+%d=%d&#34;</span><span class="op" id="7198621">,</span>&nbsp;<span class="ident" id="7198623"><a href="/net/rpc/server_test.go.html#7198554">args</a></span><span class="op" id="7198627">.</span><span class="ident" id="7198628">A</span><span class="op" id="7198629">,</span>&nbsp;<span class="ident" id="7198631"><a href="/net/rpc/server_test.go.html#7198554">args</a></span><span class="op" id="7198635">.</span><span class="ident" id="7198636">B</span><span class="op" id="7198637">,</span>&nbsp;<span class="ident" id="7198639"><a href="/net/rpc/server_test.go.html#7198554">args</a></span><span class="op" id="7198643">.</span><span class="ident" id="7198644">A</span><span class="op" id="7198645">+</span><span class="ident" id="7198646"><a href="/net/rpc/server_test.go.html#7198554">args</a></span><span class="op" id="7198650">.</span><span class="ident" id="7198651">B</span><span class="op" id="7198652">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198655">return</span>&nbsp;<span class="ident" id="7198662">nil</span><br>
<span class="lineno"></span><span class="op" id="7198666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198669">func</span>&nbsp;<span class="op" id="7198674">(</span><span class="ident" id="7198675">t</span>&nbsp;<span class="op" id="7198677">*</span><span class="ident" id="7198678"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198683">)</span>&nbsp;<span class="ident" id="7198685">Scan</span><span class="op" id="7198689">(</span><span class="ident" id="7198690">args</span>&nbsp;<span class="builtintype" id="7198695">string</span><span class="op" id="7198701">,</span>&nbsp;<span class="ident" id="7198703">reply</span>&nbsp;<span class="op" id="7198709">*</span><span class="ident" id="7198710"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7198715">)</span>&nbsp;<span class="op" id="7198717">(</span><span class="ident" id="7198718">err</span>&nbsp;<span class="builtintype" id="7198722">error</span><span class="op" id="7198727">)</span>&nbsp;<span class="op" id="7198729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198732">_</span><span class="op" id="7198733">,</span>&nbsp;<span class="ident" id="7198735"><a href="/net/rpc/server_test.go.html#7198718">err</a></span>&nbsp;<span class="op" id="7198739">=</span>&nbsp;<span class="ident" id="7198741"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7198744">.</span><span class="ident" id="7198745">Sscan</span><span class="op" id="7198750">(</span><span class="ident" id="7198751"><a href="/net/rpc/server_test.go.html#7198690">args</a></span><span class="op" id="7198755">,</span>&nbsp;<span class="op" id="7198757">&amp;</span><span class="ident" id="7198758"><a href="/net/rpc/server_test.go.html#7198703">reply</a></span><span class="op" id="7198763">.</span><span class="ident" id="7198764">C</span><span class="op" id="7198765">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198768">return</span><br>
<span class="lineno"></span><span class="op" id="7198775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198778">func</span>&nbsp;<span class="op" id="7198783">(</span><span class="ident" id="7198784">t</span>&nbsp;<span class="op" id="7198786">*</span><span class="ident" id="7198787"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7198792">)</span>&nbsp;<span class="ident" id="7198794">Error</span><span class="op" id="7198799">(</span><span class="ident" id="7198800">args</span>&nbsp;<span class="op" id="7198805">*</span><span class="ident" id="7198806"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7198810">,</span>&nbsp;<span class="ident" id="7198812">reply</span>&nbsp;<span class="op" id="7198818">*</span><span class="ident" id="7198819"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7198824">)</span>&nbsp;<span class="builtintype" id="7198826">error</span>&nbsp;<span class="op" id="7198832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7198835">panic</span><span class="op" id="7198840">(</span><span class="string" id="7198841">&#34;ERROR&#34;</span><span class="op" id="7198848">)</span><br>
<span class="lineno">75</span><span class="op" id="7198850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7198853">func</span>&nbsp;<span class="ident" id="7198858">listenTCP</span><span class="op" id="7198867">(</span><span class="op" id="7198868">)</span>&nbsp;<span class="op" id="7198870">(</span><span class="ident" id="7198871"><a href="/net/rpc/server_test.go.html#7197744">net</a></span><span class="op" id="7198874">.</span><span class="ident" id="7198875">Listener</span><span class="op" id="7198883">,</span>&nbsp;<span class="builtintype" id="7198885">string</span><span class="op" id="7198891">)</span>&nbsp;<span class="op" id="7198893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198896">l</span><span class="op" id="7198897">,</span>&nbsp;<span class="ident" id="7198899">e</span>&nbsp;<span class="op" id="7198901">:=</span>&nbsp;<span class="ident" id="7198904"><a href="/net/rpc/server_test.go.html#7197744">net</a></span><span class="op" id="7198907">.</span><span class="ident" id="7198908">Listen</span><span class="op" id="7198914">(</span><span class="string" id="7198915">&#34;tcp&#34;</span><span class="op" id="7198920">,</span>&nbsp;<span class="string" id="7198922">&#34;127.0.0.1:0&#34;</span><span class="op" id="7198935">)</span>&nbsp;<span class="comment" id="7198937">//&nbsp;any&nbsp;available&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7198963">if</span>&nbsp;<span class="ident" id="7198966"><a href="/net/rpc/server_test.go.html#7198899">e</a></span>&nbsp;<span class="op" id="7198968">!=</span>&nbsp;<span class="ident" id="7198971">nil</span>&nbsp;<span class="op" id="7198975">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7198979"><a href="/net/rpc/server_test.go.html#7197737">log</a></span><span class="op" id="7198982">.</span><span class="ident" id="7198983">Fatalf</span><span class="op" id="7198989">(</span><span class="string" id="7198990">&#34;net.Listen&nbsp;tcp&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7199013">,</span>&nbsp;<span class="ident" id="7199015"><a href="/net/rpc/server_test.go.html#7198899">e</a></span><span class="op" id="7199016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7199019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7199022">return</span>&nbsp;<span class="ident" id="7199029"><a href="/net/rpc/server_test.go.html#7198896">l</a></span><span class="op" id="7199030">,</span>&nbsp;<span class="ident" id="7199032"><a href="/net/rpc/server_test.go.html#7198896">l</a></span><span class="op" id="7199033">.</span><span class="ident" id="7199034">Addr</span><span class="op" id="7199038">(</span><span class="op" id="7199039">)</span><span class="op" id="7199040">.</span><span class="ident" id="7199041">String</span><span class="op" id="7199047">(</span><span class="op" id="7199048">)</span><br>
<span class="lineno"></span><span class="op" id="7199050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7199053">func</span>&nbsp;<span class="ident" id="7199058">startServer</span><span class="op" id="7199069">(</span><span class="op" id="7199070">)</span>&nbsp;<span class="op" id="7199072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199075"><a href="/net/rpc/server.go.html#5020981">Register</a></span><span class="op" id="7199083">(</span><span class="builtinfunc" id="7199084">new</span><span class="op" id="7199087">(</span><span class="ident" id="7199088"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7199093">)</span><span class="op" id="7199094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199097"><a href="/net/rpc/server.go.html#5021177">RegisterName</a></span><span class="op" id="7199109">(</span><span class="string" id="7199110">&#34;net.rpc.Arith&#34;</span><span class="op" id="7199125">,</span>&nbsp;<span class="builtinfunc" id="7199127">new</span><span class="op" id="7199130">(</span><span class="ident" id="7199131"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7199136">)</span><span class="op" id="7199137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7199141">var</span>&nbsp;<span class="ident" id="7199145">l</span>&nbsp;<span class="ident" id="7199147"><a href="/net/rpc/server_test.go.html#7197744">net</a></span><span class="op" id="7199150">.</span><span class="ident" id="7199151">Listener</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199161"><a href="/net/rpc/server_test.go.html#7199145">l</a></span><span class="op" id="7199162">,</span>&nbsp;<span class="ident" id="7199164"><a href="/net/rpc/server_test.go.html#7197880">serverAddr</a></span>&nbsp;<span class="op" id="7199175">=</span>&nbsp;<span class="ident" id="7199177"><a href="/net/rpc/server_test.go.html#7198858">listenTCP</a></span><span class="op" id="7199186">(</span><span class="op" id="7199187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199190"><a href="/net/rpc/server_test.go.html#7197737">log</a></span><span class="op" id="7199193">.</span><span class="ident" id="7199194">Println</span><span class="op" id="7199201">(</span><span class="string" id="7199202">&#34;Test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7199232">,</span>&nbsp;<span class="ident" id="7199234"><a href="/net/rpc/server_test.go.html#7197880">serverAddr</a></span><span class="op" id="7199244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7199247">go</span>&nbsp;<span class="ident" id="7199250"><a href="/net/rpc/server.go.html#5022952">Accept</a></span><span class="op" id="7199256">(</span><span class="ident" id="7199257"><a href="/net/rpc/server_test.go.html#7199145">l</a></span><span class="op" id="7199258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199262"><a href="/net/rpc/server.go.html#5024212">HandleHTTP</a></span><span class="op" id="7199272">(</span><span class="op" id="7199273">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199276"><a href="/net/rpc/server_test.go.html#7197963">httpOnce</a></span><span class="op" id="7199284">.</span><span class="ident" id="7199285">Do</span><span class="op" id="7199287">(</span><span class="ident" id="7199288"><a href="/net/rpc/server_test.go.html#7199726">startHttpServer</a></span><span class="op" id="7199303">)</span><br>
<span class="lineno"></span><span class="op" id="7199305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7199308">func</span>&nbsp;<span class="ident" id="7199313">startNewServer</span><span class="op" id="7199327">(</span><span class="op" id="7199328">)</span>&nbsp;<span class="op" id="7199330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199333"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span>&nbsp;<span class="op" id="7199343">=</span>&nbsp;<span class="ident" id="7199345"><a href="/net/rpc/server.go.html#5008725">NewServer</a></span><span class="op" id="7199354">(</span><span class="op" id="7199355">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199358"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7199367">.</span><span class="ident" id="7199368">Register</span><span class="op" id="7199376">(</span><span class="builtinfunc" id="7199377">new</span><span class="op" id="7199380">(</span><span class="ident" id="7199381"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7199386">)</span><span class="op" id="7199387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199390"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7199399">.</span><span class="ident" id="7199400">RegisterName</span><span class="op" id="7199412">(</span><span class="string" id="7199413">&#34;net.rpc.Arith&#34;</span><span class="op" id="7199428">,</span>&nbsp;<span class="builtinfunc" id="7199430">new</span><span class="op" id="7199433">(</span><span class="ident" id="7199434"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7199439">)</span><span class="op" id="7199440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199443"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7199452">.</span><span class="ident" id="7199453">RegisterName</span><span class="op" id="7199465">(</span><span class="string" id="7199466">&#34;newServer.Arith&#34;</span><span class="op" id="7199483">,</span>&nbsp;<span class="builtinfunc" id="7199485">new</span><span class="op" id="7199488">(</span><span class="ident" id="7199489"><a href="/net/rpc/server_test.go.html#7198087">Arith</a></span><span class="op" id="7199494">)</span><span class="op" id="7199495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7199499">var</span>&nbsp;<span class="ident" id="7199503">l</span>&nbsp;<span class="ident" id="7199505"><a href="/net/rpc/server_test.go.html#7197744">net</a></span><span class="op" id="7199508">.</span><span class="ident" id="7199509">Listener</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199519"><a href="/net/rpc/server_test.go.html#7199503">l</a></span><span class="op" id="7199520">,</span>&nbsp;<span class="ident" id="7199522"><a href="/net/rpc/server_test.go.html#7197892">newServerAddr</a></span>&nbsp;<span class="op" id="7199536">=</span>&nbsp;<span class="ident" id="7199538"><a href="/net/rpc/server_test.go.html#7198858">listenTCP</a></span><span class="op" id="7199547">(</span><span class="op" id="7199548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199551"><a href="/net/rpc/server_test.go.html#7197737">log</a></span><span class="op" id="7199554">.</span><span class="ident" id="7199555">Println</span><span class="op" id="7199562">(</span><span class="string" id="7199563">&#34;NewServer&nbsp;test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7199603">,</span>&nbsp;<span class="ident" id="7199605"><a href="/net/rpc/server_test.go.html#7197892">newServerAddr</a></span><span class="op" id="7199618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7199621">go</span>&nbsp;<span class="ident" id="7199624"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7199633">.</span><span class="ident" id="7199634">Accept</span><span class="op" id="7199640">(</span><span class="ident" id="7199641"><a href="/net/rpc/server_test.go.html#7199503">l</a></span><span class="op" id="7199642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199646"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7199655">.</span><span class="ident" id="7199656">HandleHTTP</span><span class="op" id="7199666">(</span><span class="ident" id="7199667"><a href="/net/rpc/server_test.go.html#7197996">newHttpPath</a></span><span class="op" id="7199678">,</span>&nbsp;<span class="string" id="7199680">&#34;/bar&#34;</span><span class="op" id="7199686">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199689"><a href="/net/rpc/server_test.go.html#7197963">httpOnce</a></span><span class="op" id="7199697">.</span><span class="ident" id="7199698">Do</span><span class="op" id="7199700">(</span><span class="ident" id="7199701"><a href="/net/rpc/server_test.go.html#7199726">startHttpServer</a></span><span class="op" id="7199716">)</span><br>
<span class="lineno"></span><span class="op" id="7199718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7199721">func</span>&nbsp;<span class="ident" id="7199726">startHttpServer</span><span class="op" id="7199741">(</span><span class="op" id="7199742">)</span>&nbsp;<span class="op" id="7199744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199747">server</span>&nbsp;<span class="op" id="7199754">:=</span>&nbsp;<span class="ident" id="7199757"><a href="/net/rpc/server_test.go.html#7197751">httptest</a></span><span class="op" id="7199765">.</span><span class="ident" id="7199766">NewServer</span><span class="op" id="7199775">(</span><span class="ident" id="7199776">nil</span><span class="op" id="7199779">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199782"><a href="/net/rpc/server_test.go.html#7197914">httpServerAddr</a></span>&nbsp;<span class="op" id="7199797">=</span>&nbsp;<span class="ident" id="7199799"><a href="/net/rpc/server_test.go.html#7199747">server</a></span><span class="op" id="7199805">.</span><span class="ident" id="7199806">Listener</span><span class="op" id="7199814">.</span><span class="ident" id="7199815">Addr</span><span class="op" id="7199819">(</span><span class="op" id="7199820">)</span><span class="op" id="7199821">.</span><span class="ident" id="7199822">String</span><span class="op" id="7199828">(</span><span class="op" id="7199829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199832"><a href="/net/rpc/server_test.go.html#7197737">log</a></span><span class="op" id="7199835">.</span><span class="ident" id="7199836">Println</span><span class="op" id="7199843">(</span><span class="string" id="7199844">&#34;Test&nbsp;HTTP&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7199879">,</span>&nbsp;<span class="ident" id="7199881"><a href="/net/rpc/server_test.go.html#7197914">httpServerAddr</a></span><span class="op" id="7199895">)</span><br>
<span class="lineno"></span><span class="op" id="7199897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7199900">func</span>&nbsp;<span class="ident" id="7199905">TestRPC</span><span class="op" id="7199912">(</span><span class="ident" id="7199913">t</span>&nbsp;<span class="op" id="7199915">*</span><span class="ident" id="7199916"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7199923">.</span><span class="ident" id="7199924">T</span><span class="op" id="7199925">)</span>&nbsp;<span class="op" id="7199927">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199930"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7199934">.</span><span class="ident" id="7199935">Do</span><span class="op" id="7199937">(</span><span class="ident" id="7199938"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7199949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199952"><a href="/net/rpc/server_test.go.html#7200074">testRPC</a></span><span class="op" id="7199959">(</span><span class="ident" id="7199960"><a href="/net/rpc/server_test.go.html#7199913">t</a></span><span class="op" id="7199961">,</span>&nbsp;<span class="ident" id="7199963"><a href="/net/rpc/server_test.go.html#7197880">serverAddr</a></span><span class="op" id="7199973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7199976"><a href="/net/rpc/server_test.go.html#7197954">newOnce</a></span><span class="op" id="7199983">.</span><span class="ident" id="7199984">Do</span><span class="op" id="7199986">(</span><span class="ident" id="7199987"><a href="/net/rpc/server_test.go.html#7199313">startNewServer</a></span><span class="op" id="7200001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200004"><a href="/net/rpc/server_test.go.html#7200074">testRPC</a></span><span class="op" id="7200011">(</span><span class="ident" id="7200012"><a href="/net/rpc/server_test.go.html#7199913">t</a></span><span class="op" id="7200013">,</span>&nbsp;<span class="ident" id="7200015"><a href="/net/rpc/server_test.go.html#7197892">newServerAddr</a></span><span class="op" id="7200028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200031"><a href="/net/rpc/server_test.go.html#7203653">testNewServerRPC</a></span><span class="op" id="7200047">(</span><span class="ident" id="7200048"><a href="/net/rpc/server_test.go.html#7199913">t</a></span><span class="op" id="7200049">,</span>&nbsp;<span class="ident" id="7200051"><a href="/net/rpc/server_test.go.html#7197892">newServerAddr</a></span><span class="op" id="7200064">)</span><br>
<span class="lineno">125</span><span class="op" id="7200066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7200069">func</span>&nbsp;<span class="ident" id="7200074">testRPC</span><span class="op" id="7200081">(</span><span class="ident" id="7200082">t</span>&nbsp;<span class="op" id="7200084">*</span><span class="ident" id="7200085"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7200092">.</span><span class="ident" id="7200093">T</span><span class="op" id="7200094">,</span>&nbsp;<span class="ident" id="7200096">addr</span>&nbsp;<span class="builtintype" id="7200101">string</span><span class="op" id="7200107">)</span>&nbsp;<span class="op" id="7200109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200112">client</span><span class="op" id="7200118">,</span>&nbsp;<span class="ident" id="7200120">err</span>&nbsp;<span class="op" id="7200124">:=</span>&nbsp;<span class="ident" id="7200127"><a href="/net/rpc/client.go.html#4998961">Dial</a></span><span class="op" id="7200131">(</span><span class="string" id="7200132">&#34;tcp&#34;</span><span class="op" id="7200137">,</span>&nbsp;<span class="ident" id="7200139"><a href="/net/rpc/server_test.go.html#7200096">addr</a></span><span class="op" id="7200143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200146">if</span>&nbsp;<span class="ident" id="7200149"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200153">!=</span>&nbsp;<span class="ident" id="7200156">nil</span>&nbsp;<span class="op" id="7200160">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200164"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200165">.</span><span class="ident" id="7200166">Fatal</span><span class="op" id="7200171">(</span><span class="string" id="7200172">&#34;dialing&#34;</span><span class="op" id="7200181">,</span>&nbsp;<span class="ident" id="7200183"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7200186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7200189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200192">defer</span>&nbsp;<span class="ident" id="7200198"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7200204">.</span><span class="ident" id="7200205">Close</span><span class="op" id="7200210">(</span><span class="op" id="7200211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7200215">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200237">args</span>&nbsp;<span class="op" id="7200242">:=</span>&nbsp;<span class="op" id="7200245">&amp;</span><span class="ident" id="7200246"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7200250">{</span><span class="num" id="7200251">7</span><span class="op" id="7200252">,</span>&nbsp;<span class="num" id="7200254">8</span><span class="op" id="7200255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200258">reply</span>&nbsp;<span class="op" id="7200264">:=</span>&nbsp;<span class="builtinfunc" id="7200267">new</span><span class="op" id="7200270">(</span><span class="ident" id="7200271"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7200276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200279"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200283">=</span>&nbsp;<span class="ident" id="7200285"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7200291">.</span><span class="ident" id="7200292">Call</span><span class="op" id="7200296">(</span><span class="string" id="7200297">&#34;Arith.Add&#34;</span><span class="op" id="7200308">,</span>&nbsp;<span class="ident" id="7200310"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200314">,</span>&nbsp;<span class="ident" id="7200316"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7200321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200324">if</span>&nbsp;<span class="ident" id="7200327"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200331">!=</span>&nbsp;<span class="ident" id="7200334">nil</span>&nbsp;<span class="op" id="7200338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200342"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200343">.</span><span class="ident" id="7200344">Errorf</span><span class="op" id="7200350">(</span><span class="string" id="7200351">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7200393">,</span>&nbsp;<span class="ident" id="7200395"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7200398">.</span><span class="ident" id="7200399">Error</span><span class="op" id="7200404">(</span><span class="op" id="7200405">)</span><span class="op" id="7200406">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7200409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200412">if</span>&nbsp;<span class="ident" id="7200415"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7200420">.</span><span class="ident" id="7200421">C</span>&nbsp;<span class="op" id="7200423">!=</span>&nbsp;<span class="ident" id="7200426"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200430">.</span><span class="ident" id="7200431">A</span><span class="op" id="7200432">+</span><span class="ident" id="7200433"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200437">.</span><span class="ident" id="7200438">B</span>&nbsp;<span class="op" id="7200440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200444"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200445">.</span><span class="ident" id="7200446">Errorf</span><span class="op" id="7200452">(</span><span class="string" id="7200453">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7200478">,</span>&nbsp;<span class="ident" id="7200480"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7200485">.</span><span class="ident" id="7200486">C</span><span class="op" id="7200487">,</span>&nbsp;<span class="ident" id="7200489"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200493">.</span><span class="ident" id="7200494">A</span><span class="op" id="7200495">+</span><span class="ident" id="7200496"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200500">.</span><span class="ident" id="7200501">B</span><span class="op" id="7200502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7200505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7200509">//&nbsp;Nonexistent&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200532"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7200537">=</span>&nbsp;<span class="op" id="7200539">&amp;</span><span class="ident" id="7200540"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7200544">{</span><span class="num" id="7200545">7</span><span class="op" id="7200546">,</span>&nbsp;<span class="num" id="7200548">0</span><span class="op" id="7200549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200552"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7200558">=</span>&nbsp;<span class="builtinfunc" id="7200560">new</span><span class="op" id="7200563">(</span><span class="ident" id="7200564"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7200569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200572"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200576">=</span>&nbsp;<span class="ident" id="7200578"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7200584">.</span><span class="ident" id="7200585">Call</span><span class="op" id="7200589">(</span><span class="string" id="7200590">&#34;Arith.BadOperation&#34;</span><span class="op" id="7200610">,</span>&nbsp;<span class="ident" id="7200612"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200616">,</span>&nbsp;<span class="ident" id="7200618"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7200623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7200626">//&nbsp;expect&nbsp;an&nbsp;error</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200646">if</span>&nbsp;<span class="ident" id="7200649"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200653">==</span>&nbsp;<span class="ident" id="7200656">nil</span>&nbsp;<span class="op" id="7200660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200664"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200665">.</span><span class="ident" id="7200666">Error</span><span class="op" id="7200671">(</span><span class="string" id="7200672">&#34;BadOperation:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7200702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7200705">}</span>&nbsp;<span class="keyword" id="7200707">else</span>&nbsp;<span class="keyword" id="7200712">if</span>&nbsp;<span class="op" id="7200715">!</span><span class="ident" id="7200716"><a href="/net/rpc/server_test.go.html#7197783">strings</a></span><span class="op" id="7200723">.</span><span class="ident" id="7200724">HasPrefix</span><span class="op" id="7200733">(</span><span class="ident" id="7200734"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7200737">.</span><span class="ident" id="7200738">Error</span><span class="op" id="7200743">(</span><span class="op" id="7200744">)</span><span class="op" id="7200745">,</span>&nbsp;<span class="string" id="7200747">&#34;rpc:&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;&#34;</span><span class="op" id="7200772">)</span>&nbsp;<span class="op" id="7200774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200778"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200779">.</span><span class="ident" id="7200780">Errorf</span><span class="op" id="7200786">(</span><span class="string" id="7200787">&#34;BadOperation:&nbsp;expected&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;error;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7200843">,</span>&nbsp;<span class="ident" id="7200845"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7200848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7200851">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7200855">//&nbsp;Unknown&nbsp;service</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200875"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7200880">=</span>&nbsp;<span class="op" id="7200882">&amp;</span><span class="ident" id="7200883"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7200887">{</span><span class="num" id="7200888">7</span><span class="op" id="7200889">,</span>&nbsp;<span class="num" id="7200891">8</span><span class="op" id="7200892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200895"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7200901">=</span>&nbsp;<span class="builtinfunc" id="7200903">new</span><span class="op" id="7200906">(</span><span class="ident" id="7200907"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7200912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200915"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200919">=</span>&nbsp;<span class="ident" id="7200921"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7200927">.</span><span class="ident" id="7200928">Call</span><span class="op" id="7200932">(</span><span class="string" id="7200933">&#34;Arith.Unknown&#34;</span><span class="op" id="7200948">,</span>&nbsp;<span class="ident" id="7200950"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7200954">,</span>&nbsp;<span class="ident" id="7200956"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7200961">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7200964">if</span>&nbsp;<span class="ident" id="7200967"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7200971">==</span>&nbsp;<span class="ident" id="7200974">nil</span>&nbsp;<span class="op" id="7200978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7200982"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7200983">.</span><span class="ident" id="7200984">Error</span><span class="op" id="7200989">(</span><span class="string" id="7200990">&#34;expected&nbsp;error&nbsp;calling&nbsp;unknown&nbsp;service&#34;</span><span class="op" id="7201030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201033">}</span>&nbsp;<span class="keyword" id="7201035">else</span>&nbsp;<span class="keyword" id="7201040">if</span>&nbsp;<span class="ident" id="7201043"><a href="/net/rpc/server_test.go.html#7197783">strings</a></span><span class="op" id="7201050">.</span><span class="ident" id="7201051">Index</span><span class="op" id="7201056">(</span><span class="ident" id="7201057"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7201060">.</span><span class="ident" id="7201061">Error</span><span class="op" id="7201066">(</span><span class="op" id="7201067">)</span><span class="op" id="7201068">,</span>&nbsp;<span class="string" id="7201070">&#34;method&#34;</span><span class="op" id="7201078">)</span>&nbsp;<span class="op" id="7201080">&lt;</span>&nbsp;<span class="num" id="7201082">0</span>&nbsp;<span class="op" id="7201084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201088"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201089">.</span><span class="ident" id="7201090">Error</span><span class="op" id="7201095">(</span><span class="string" id="7201096">&#34;expected&nbsp;error&nbsp;about&nbsp;method;&nbsp;got&#34;</span><span class="op" id="7201130">,</span>&nbsp;<span class="ident" id="7201132"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7201135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201138">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7201142">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201160"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7201165">=</span>&nbsp;<span class="op" id="7201167">&amp;</span><span class="ident" id="7201168"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7201172">{</span><span class="num" id="7201173">7</span><span class="op" id="7201174">,</span>&nbsp;<span class="num" id="7201176">8</span><span class="op" id="7201177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201180">mulReply</span>&nbsp;<span class="op" id="7201189">:=</span>&nbsp;<span class="builtinfunc" id="7201192">new</span><span class="op" id="7201195">(</span><span class="ident" id="7201196"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7201201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201204">mulCall</span>&nbsp;<span class="op" id="7201212">:=</span>&nbsp;<span class="ident" id="7201215"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7201221">.</span><span class="ident" id="7201222">Go</span><span class="op" id="7201224">(</span><span class="string" id="7201225">&#34;Arith.Mul&#34;</span><span class="op" id="7201236">,</span>&nbsp;<span class="ident" id="7201238"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201242">,</span>&nbsp;<span class="ident" id="7201244"><a href="/net/rpc/server_test.go.html#7201180">mulReply</a></span><span class="op" id="7201252">,</span>&nbsp;<span class="ident" id="7201254">nil</span><span class="op" id="7201257">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201260">addReply</span>&nbsp;<span class="op" id="7201269">:=</span>&nbsp;<span class="builtinfunc" id="7201272">new</span><span class="op" id="7201275">(</span><span class="ident" id="7201276"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7201281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201284">addCall</span>&nbsp;<span class="op" id="7201292">:=</span>&nbsp;<span class="ident" id="7201295"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7201301">.</span><span class="ident" id="7201302">Go</span><span class="op" id="7201304">(</span><span class="string" id="7201305">&#34;Arith.Add&#34;</span><span class="op" id="7201316">,</span>&nbsp;<span class="ident" id="7201318"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201322">,</span>&nbsp;<span class="ident" id="7201324"><a href="/net/rpc/server_test.go.html#7201260">addReply</a></span><span class="op" id="7201332">,</span>&nbsp;<span class="ident" id="7201334">nil</span><span class="op" id="7201337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201341"><a href="/net/rpc/server_test.go.html#7201284">addCall</a></span>&nbsp;<span class="op" id="7201349">=</span>&nbsp;<span class="op" id="7201351">&lt;-</span><span class="ident" id="7201353"><a href="/net/rpc/server_test.go.html#7201284">addCall</a></span><span class="op" id="7201360">.</span><span class="ident" id="7201361">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7201367">if</span>&nbsp;<span class="ident" id="7201370"><a href="/net/rpc/server_test.go.html#7201284">addCall</a></span><span class="op" id="7201377">.</span><span class="ident" id="7201378">Error</span>&nbsp;<span class="op" id="7201384">!=</span>&nbsp;<span class="ident" id="7201387">nil</span>&nbsp;<span class="op" id="7201391">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201395"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201396">.</span><span class="ident" id="7201397">Errorf</span><span class="op" id="7201403">(</span><span class="string" id="7201404">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7201446">,</span>&nbsp;<span class="ident" id="7201448"><a href="/net/rpc/server_test.go.html#7201284">addCall</a></span><span class="op" id="7201455">.</span><span class="ident" id="7201456">Error</span><span class="op" id="7201461">.</span><span class="ident" id="7201462">Error</span><span class="op" id="7201467">(</span><span class="op" id="7201468">)</span><span class="op" id="7201469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7201475">if</span>&nbsp;<span class="ident" id="7201478"><a href="/net/rpc/server_test.go.html#7201260">addReply</a></span><span class="op" id="7201486">.</span><span class="ident" id="7201487">C</span>&nbsp;<span class="op" id="7201489">!=</span>&nbsp;<span class="ident" id="7201492"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201496">.</span><span class="ident" id="7201497">A</span><span class="op" id="7201498">+</span><span class="ident" id="7201499"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201503">.</span><span class="ident" id="7201504">B</span>&nbsp;<span class="op" id="7201506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201510"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201511">.</span><span class="ident" id="7201512">Errorf</span><span class="op" id="7201518">(</span><span class="string" id="7201519">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7201544">,</span>&nbsp;<span class="ident" id="7201546"><a href="/net/rpc/server_test.go.html#7201260">addReply</a></span><span class="op" id="7201554">.</span><span class="ident" id="7201555">C</span><span class="op" id="7201556">,</span>&nbsp;<span class="ident" id="7201558"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201562">.</span><span class="ident" id="7201563">A</span><span class="op" id="7201564">+</span><span class="ident" id="7201565"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201569">.</span><span class="ident" id="7201570">B</span><span class="op" id="7201571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201574">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201578"><a href="/net/rpc/server_test.go.html#7201204">mulCall</a></span>&nbsp;<span class="op" id="7201586">=</span>&nbsp;<span class="op" id="7201588">&lt;-</span><span class="ident" id="7201590"><a href="/net/rpc/server_test.go.html#7201204">mulCall</a></span><span class="op" id="7201597">.</span><span class="ident" id="7201598">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7201604">if</span>&nbsp;<span class="ident" id="7201607"><a href="/net/rpc/server_test.go.html#7201204">mulCall</a></span><span class="op" id="7201614">.</span><span class="ident" id="7201615">Error</span>&nbsp;<span class="op" id="7201621">!=</span>&nbsp;<span class="ident" id="7201624">nil</span>&nbsp;<span class="op" id="7201628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201632"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201633">.</span><span class="ident" id="7201634">Errorf</span><span class="op" id="7201640">(</span><span class="string" id="7201641">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7201683">,</span>&nbsp;<span class="ident" id="7201685"><a href="/net/rpc/server_test.go.html#7201204">mulCall</a></span><span class="op" id="7201692">.</span><span class="ident" id="7201693">Error</span><span class="op" id="7201698">.</span><span class="ident" id="7201699">Error</span><span class="op" id="7201704">(</span><span class="op" id="7201705">)</span><span class="op" id="7201706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201709">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7201712">if</span>&nbsp;<span class="ident" id="7201715"><a href="/net/rpc/server_test.go.html#7201180">mulReply</a></span><span class="op" id="7201723">.</span><span class="ident" id="7201724">C</span>&nbsp;<span class="op" id="7201726">!=</span>&nbsp;<span class="ident" id="7201729"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201733">.</span><span class="ident" id="7201734">A</span><span class="op" id="7201735">*</span><span class="ident" id="7201736"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201740">.</span><span class="ident" id="7201741">B</span>&nbsp;<span class="op" id="7201743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201747"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201748">.</span><span class="ident" id="7201749">Errorf</span><span class="op" id="7201755">(</span><span class="string" id="7201756">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7201781">,</span>&nbsp;<span class="ident" id="7201783"><a href="/net/rpc/server_test.go.html#7201180">mulReply</a></span><span class="op" id="7201791">.</span><span class="ident" id="7201792">C</span><span class="op" id="7201793">,</span>&nbsp;<span class="ident" id="7201795"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201799">.</span><span class="ident" id="7201800">A</span><span class="op" id="7201801">*</span><span class="ident" id="7201802"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201806">.</span><span class="ident" id="7201807">B</span><span class="op" id="7201808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7201815">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201830"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7201835">=</span>&nbsp;<span class="op" id="7201837">&amp;</span><span class="ident" id="7201838"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7201842">{</span><span class="num" id="7201843">7</span><span class="op" id="7201844">,</span>&nbsp;<span class="num" id="7201846">0</span><span class="op" id="7201847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201850"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7201856">=</span>&nbsp;<span class="builtinfunc" id="7201858">new</span><span class="op" id="7201861">(</span><span class="ident" id="7201862"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7201867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201870"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7201874">=</span>&nbsp;<span class="ident" id="7201876"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7201882">.</span><span class="ident" id="7201883">Call</span><span class="op" id="7201887">(</span><span class="string" id="7201888">&#34;Arith.Div&#34;</span><span class="op" id="7201899">,</span>&nbsp;<span class="ident" id="7201901"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7201905">,</span>&nbsp;<span class="ident" id="7201907"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7201912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7201915">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7201948">if</span>&nbsp;<span class="ident" id="7201951"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7201955">==</span>&nbsp;<span class="ident" id="7201958">nil</span>&nbsp;<span class="op" id="7201962">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7201966"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7201967">.</span><span class="ident" id="7201968">Error</span><span class="op" id="7201973">(</span><span class="string" id="7201974">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7201995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7201998">}</span>&nbsp;<span class="keyword" id="7202000">else</span>&nbsp;<span class="keyword" id="7202005">if</span>&nbsp;<span class="ident" id="7202008"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202011">.</span><span class="ident" id="7202012">Error</span><span class="op" id="7202017">(</span><span class="op" id="7202018">)</span>&nbsp;<span class="op" id="7202020">!=</span>&nbsp;<span class="string" id="7202023">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="7202040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202044"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202045">.</span><span class="ident" id="7202046">Error</span><span class="op" id="7202051">(</span><span class="string" id="7202052">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7202093">,</span>&nbsp;<span class="ident" id="7202095"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7202105">//&nbsp;Bad&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202119"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7202125">=</span>&nbsp;<span class="builtinfunc" id="7202127">new</span><span class="op" id="7202130">(</span><span class="ident" id="7202131"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7202136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202139"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202143">=</span>&nbsp;<span class="ident" id="7202145"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7202151">.</span><span class="ident" id="7202152">Call</span><span class="op" id="7202156">(</span><span class="string" id="7202157">&#34;Arith.Add&#34;</span><span class="op" id="7202168">,</span>&nbsp;<span class="ident" id="7202170"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7202175">,</span>&nbsp;<span class="ident" id="7202177"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7202182">)</span>&nbsp;<span class="comment" id="7202184">//&nbsp;args,&nbsp;reply&nbsp;would&nbsp;be&nbsp;the&nbsp;correct&nbsp;thing&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7202234">if</span>&nbsp;<span class="ident" id="7202237"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202241">==</span>&nbsp;<span class="ident" id="7202244">nil</span>&nbsp;<span class="op" id="7202248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202252"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202253">.</span><span class="ident" id="7202254">Error</span><span class="op" id="7202259">(</span><span class="string" id="7202260">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;wrong&nbsp;arg&nbsp;type&#34;</span><span class="op" id="7202314">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202317">}</span>&nbsp;<span class="keyword" id="7202319">else</span>&nbsp;<span class="keyword" id="7202324">if</span>&nbsp;<span class="ident" id="7202327"><a href="/net/rpc/server_test.go.html#7197783">strings</a></span><span class="op" id="7202334">.</span><span class="ident" id="7202335">Index</span><span class="op" id="7202340">(</span><span class="ident" id="7202341"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202344">.</span><span class="ident" id="7202345">Error</span><span class="op" id="7202350">(</span><span class="op" id="7202351">)</span><span class="op" id="7202352">,</span>&nbsp;<span class="string" id="7202354">&#34;type&#34;</span><span class="op" id="7202360">)</span>&nbsp;<span class="op" id="7202362">&lt;</span>&nbsp;<span class="num" id="7202364">0</span>&nbsp;<span class="op" id="7202366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202370"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202371">.</span><span class="ident" id="7202372">Error</span><span class="op" id="7202377">(</span><span class="string" id="7202378">&#34;expected&nbsp;error&nbsp;about&nbsp;type;&nbsp;got&#34;</span><span class="op" id="7202410">,</span>&nbsp;<span class="ident" id="7202412"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7202422">//&nbsp;Non-struct&nbsp;argument</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7202446">const</span>&nbsp;<span class="ident" id="7202452">Val</span>&nbsp;<span class="op" id="7202456">=</span>&nbsp;<span class="num" id="7202458">12345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202465">str</span>&nbsp;<span class="op" id="7202469">:=</span>&nbsp;<span class="ident" id="7202472"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7202475">.</span><span class="ident" id="7202476">Sprint</span><span class="op" id="7202482">(</span><span class="ident" id="7202483"><a href="/net/rpc/server_test.go.html#7202452">Val</a></span><span class="op" id="7202486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202489"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7202495">=</span>&nbsp;<span class="builtinfunc" id="7202497">new</span><span class="op" id="7202500">(</span><span class="ident" id="7202501"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7202506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202509"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202513">=</span>&nbsp;<span class="ident" id="7202515"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7202521">.</span><span class="ident" id="7202522">Call</span><span class="op" id="7202526">(</span><span class="string" id="7202527">&#34;Arith.Scan&#34;</span><span class="op" id="7202539">,</span>&nbsp;<span class="op" id="7202541">&amp;</span><span class="ident" id="7202542"><a href="/net/rpc/server_test.go.html#7202465">str</a></span><span class="op" id="7202545">,</span>&nbsp;<span class="ident" id="7202547"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7202552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7202555">if</span>&nbsp;<span class="ident" id="7202558"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202562">!=</span>&nbsp;<span class="ident" id="7202565">nil</span>&nbsp;<span class="op" id="7202569">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202573"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202574">.</span><span class="ident" id="7202575">Errorf</span><span class="op" id="7202581">(</span><span class="string" id="7202582">&#34;Scan:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7202625">,</span>&nbsp;<span class="ident" id="7202627"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202630">.</span><span class="ident" id="7202631">Error</span><span class="op" id="7202636">(</span><span class="op" id="7202637">)</span><span class="op" id="7202638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202641">}</span>&nbsp;<span class="keyword" id="7202643">else</span>&nbsp;<span class="keyword" id="7202648">if</span>&nbsp;<span class="ident" id="7202651"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7202656">.</span><span class="ident" id="7202657">C</span>&nbsp;<span class="op" id="7202659">!=</span>&nbsp;<span class="ident" id="7202662"><a href="/net/rpc/server_test.go.html#7202452">Val</a></span>&nbsp;<span class="op" id="7202666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202670"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202671">.</span><span class="ident" id="7202672">Errorf</span><span class="op" id="7202678">(</span><span class="string" id="7202679">&#34;Scan:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7202705">,</span>&nbsp;<span class="ident" id="7202707"><a href="/net/rpc/server_test.go.html#7202452">Val</a></span><span class="op" id="7202710">,</span>&nbsp;<span class="ident" id="7202712"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7202717">.</span><span class="ident" id="7202718">C</span><span class="op" id="7202719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7202726">//&nbsp;Non-struct&nbsp;reply</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202747"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7202752">=</span>&nbsp;<span class="op" id="7202754">&amp;</span><span class="ident" id="7202755"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7202759">{</span><span class="num" id="7202760">27</span><span class="op" id="7202762">,</span>&nbsp;<span class="num" id="7202764">35</span><span class="op" id="7202766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202769"><a href="/net/rpc/server_test.go.html#7202465">str</a></span>&nbsp;<span class="op" id="7202773">=</span>&nbsp;<span class="string" id="7202775">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202779"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202783">=</span>&nbsp;<span class="ident" id="7202785"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7202791">.</span><span class="ident" id="7202792">Call</span><span class="op" id="7202796">(</span><span class="string" id="7202797">&#34;Arith.String&#34;</span><span class="op" id="7202811">,</span>&nbsp;<span class="ident" id="7202813"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7202817">,</span>&nbsp;<span class="op" id="7202819">&amp;</span><span class="ident" id="7202820"><a href="/net/rpc/server_test.go.html#7202465">str</a></span><span class="op" id="7202823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7202826">if</span>&nbsp;<span class="ident" id="7202829"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7202833">!=</span>&nbsp;<span class="ident" id="7202836">nil</span>&nbsp;<span class="op" id="7202840">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202844"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7202845">.</span><span class="ident" id="7202846">Errorf</span><span class="op" id="7202852">(</span><span class="string" id="7202853">&#34;String:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7202898">,</span>&nbsp;<span class="ident" id="7202900"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7202903">.</span><span class="ident" id="7202904">Error</span><span class="op" id="7202909">(</span><span class="op" id="7202910">)</span><span class="op" id="7202911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7202914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7202917">expect</span>&nbsp;<span class="op" id="7202924">:=</span>&nbsp;<span class="ident" id="7202927"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7202930">.</span><span class="ident" id="7202931">Sprintf</span><span class="op" id="7202938">(</span><span class="string" id="7202939">&#34;%d+%d=%d&#34;</span><span class="op" id="7202949">,</span>&nbsp;<span class="ident" id="7202951"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7202955">.</span><span class="ident" id="7202956">A</span><span class="op" id="7202957">,</span>&nbsp;<span class="ident" id="7202959"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7202963">.</span><span class="ident" id="7202964">B</span><span class="op" id="7202965">,</span>&nbsp;<span class="ident" id="7202967"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7202971">.</span><span class="ident" id="7202972">A</span><span class="op" id="7202973">+</span><span class="ident" id="7202974"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7202978">.</span><span class="ident" id="7202979">B</span><span class="op" id="7202980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7202983">if</span>&nbsp;<span class="ident" id="7202986"><a href="/net/rpc/server_test.go.html#7202465">str</a></span>&nbsp;<span class="op" id="7202990">!=</span>&nbsp;<span class="ident" id="7202993"><a href="/net/rpc/server_test.go.html#7202917">expect</a></span>&nbsp;<span class="op" id="7203000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203004"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7203005">.</span><span class="ident" id="7203006">Errorf</span><span class="op" id="7203012">(</span><span class="string" id="7203013">&#34;String:&nbsp;expected&nbsp;%s&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7203041">,</span>&nbsp;<span class="ident" id="7203043"><a href="/net/rpc/server_test.go.html#7202917">expect</a></span><span class="op" id="7203049">,</span>&nbsp;<span class="ident" id="7203051"><a href="/net/rpc/server_test.go.html#7202465">str</a></span><span class="op" id="7203054">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203061"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7203066">=</span>&nbsp;<span class="op" id="7203068">&amp;</span><span class="ident" id="7203069"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7203073">{</span><span class="num" id="7203074">7</span><span class="op" id="7203075">,</span>&nbsp;<span class="num" id="7203077">8</span><span class="op" id="7203078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203081"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7203087">=</span>&nbsp;<span class="builtinfunc" id="7203089">new</span><span class="op" id="7203092">(</span><span class="ident" id="7203093"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7203098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203101"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7203105">=</span>&nbsp;<span class="ident" id="7203107"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7203113">.</span><span class="ident" id="7203114">Call</span><span class="op" id="7203118">(</span><span class="string" id="7203119">&#34;Arith.Mul&#34;</span><span class="op" id="7203130">,</span>&nbsp;<span class="ident" id="7203132"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203136">,</span>&nbsp;<span class="ident" id="7203138"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203143">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203146">if</span>&nbsp;<span class="ident" id="7203149"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7203153">!=</span>&nbsp;<span class="ident" id="7203156">nil</span>&nbsp;<span class="op" id="7203160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203164"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7203165">.</span><span class="ident" id="7203166">Errorf</span><span class="op" id="7203172">(</span><span class="string" id="7203173">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7203215">,</span>&nbsp;<span class="ident" id="7203217"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7203220">.</span><span class="ident" id="7203221">Error</span><span class="op" id="7203226">(</span><span class="op" id="7203227">)</span><span class="op" id="7203228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203234">if</span>&nbsp;<span class="ident" id="7203237"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203242">.</span><span class="ident" id="7203243">C</span>&nbsp;<span class="op" id="7203245">!=</span>&nbsp;<span class="ident" id="7203248"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203252">.</span><span class="ident" id="7203253">A</span><span class="op" id="7203254">*</span><span class="ident" id="7203255"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203259">.</span><span class="ident" id="7203260">B</span>&nbsp;<span class="op" id="7203262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203266"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7203267">.</span><span class="ident" id="7203268">Errorf</span><span class="op" id="7203274">(</span><span class="string" id="7203275">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7203300">,</span>&nbsp;<span class="ident" id="7203302"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203307">.</span><span class="ident" id="7203308">C</span><span class="op" id="7203309">,</span>&nbsp;<span class="ident" id="7203311"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203315">.</span><span class="ident" id="7203316">A</span><span class="op" id="7203317">*</span><span class="ident" id="7203318"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203322">.</span><span class="ident" id="7203323">B</span><span class="op" id="7203324">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7203331">//&nbsp;ServiceName&nbsp;contain&nbsp;&#34;.&#34;&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203369"><a href="/net/rpc/server_test.go.html#7200237">args</a></span>&nbsp;<span class="op" id="7203374">=</span>&nbsp;<span class="op" id="7203376">&amp;</span><span class="ident" id="7203377"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7203381">{</span><span class="num" id="7203382">7</span><span class="op" id="7203383">,</span>&nbsp;<span class="num" id="7203385">8</span><span class="op" id="7203386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203389"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span>&nbsp;<span class="op" id="7203395">=</span>&nbsp;<span class="builtinfunc" id="7203397">new</span><span class="op" id="7203400">(</span><span class="ident" id="7203401"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7203406">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203409"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7203413">=</span>&nbsp;<span class="ident" id="7203415"><a href="/net/rpc/server_test.go.html#7200112">client</a></span><span class="op" id="7203421">.</span><span class="ident" id="7203422">Call</span><span class="op" id="7203426">(</span><span class="string" id="7203427">&#34;net.rpc.Arith.Add&#34;</span><span class="op" id="7203446">,</span>&nbsp;<span class="ident" id="7203448"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203452">,</span>&nbsp;<span class="ident" id="7203454"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203462">if</span>&nbsp;<span class="ident" id="7203465"><a href="/net/rpc/server_test.go.html#7200120">err</a></span>&nbsp;<span class="op" id="7203469">!=</span>&nbsp;<span class="ident" id="7203472">nil</span>&nbsp;<span class="op" id="7203476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203480"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7203481">.</span><span class="ident" id="7203482">Errorf</span><span class="op" id="7203488">(</span><span class="string" id="7203489">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7203531">,</span>&nbsp;<span class="ident" id="7203533"><a href="/net/rpc/server_test.go.html#7200120">err</a></span><span class="op" id="7203536">.</span><span class="ident" id="7203537">Error</span><span class="op" id="7203542">(</span><span class="op" id="7203543">)</span><span class="op" id="7203544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203550">if</span>&nbsp;<span class="ident" id="7203553"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203558">.</span><span class="ident" id="7203559">C</span>&nbsp;<span class="op" id="7203561">!=</span>&nbsp;<span class="ident" id="7203564"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203568">.</span><span class="ident" id="7203569">A</span><span class="op" id="7203570">+</span><span class="ident" id="7203571"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203575">.</span><span class="ident" id="7203576">B</span>&nbsp;<span class="op" id="7203578">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203582"><a href="/net/rpc/server_test.go.html#7200082">t</a></span><span class="op" id="7203583">.</span><span class="ident" id="7203584">Errorf</span><span class="op" id="7203590">(</span><span class="string" id="7203591">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7203616">,</span>&nbsp;<span class="ident" id="7203618"><a href="/net/rpc/server_test.go.html#7200258">reply</a></span><span class="op" id="7203623">.</span><span class="ident" id="7203624">C</span><span class="op" id="7203625">,</span>&nbsp;<span class="ident" id="7203627"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203631">.</span><span class="ident" id="7203632">A</span><span class="op" id="7203633">+</span><span class="ident" id="7203634"><a href="/net/rpc/server_test.go.html#7200237">args</a></span><span class="op" id="7203638">.</span><span class="ident" id="7203639">B</span><span class="op" id="7203640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203643">}</span><br>
<span class="lineno"></span><span class="op" id="7203645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7203648">func</span>&nbsp;<span class="ident" id="7203653">testNewServerRPC</span><span class="op" id="7203669">(</span><span class="ident" id="7203670">t</span>&nbsp;<span class="op" id="7203672">*</span><span class="ident" id="7203673"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7203680">.</span><span class="ident" id="7203681">T</span><span class="op" id="7203682">,</span>&nbsp;<span class="ident" id="7203684">addr</span>&nbsp;<span class="builtintype" id="7203689">string</span><span class="op" id="7203695">)</span>&nbsp;<span class="op" id="7203697">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203700">client</span><span class="op" id="7203706">,</span>&nbsp;<span class="ident" id="7203708">err</span>&nbsp;<span class="op" id="7203712">:=</span>&nbsp;<span class="ident" id="7203715"><a href="/net/rpc/client.go.html#4998961">Dial</a></span><span class="op" id="7203719">(</span><span class="string" id="7203720">&#34;tcp&#34;</span><span class="op" id="7203725">,</span>&nbsp;<span class="ident" id="7203727"><a href="/net/rpc/server_test.go.html#7203684">addr</a></span><span class="op" id="7203731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203734">if</span>&nbsp;<span class="ident" id="7203737"><a href="/net/rpc/server_test.go.html#7203708">err</a></span>&nbsp;<span class="op" id="7203741">!=</span>&nbsp;<span class="ident" id="7203744">nil</span>&nbsp;<span class="op" id="7203748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203752"><a href="/net/rpc/server_test.go.html#7203670">t</a></span><span class="op" id="7203753">.</span><span class="ident" id="7203754">Fatal</span><span class="op" id="7203759">(</span><span class="string" id="7203760">&#34;dialing&#34;</span><span class="op" id="7203769">,</span>&nbsp;<span class="ident" id="7203771"><a href="/net/rpc/server_test.go.html#7203708">err</a></span><span class="op" id="7203774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7203777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203780">defer</span>&nbsp;<span class="ident" id="7203786"><a href="/net/rpc/server_test.go.html#7203700">client</a></span><span class="op" id="7203792">.</span><span class="ident" id="7203793">Close</span><span class="op" id="7203798">(</span><span class="op" id="7203799">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7203803">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203825">args</span>&nbsp;<span class="op" id="7203830">:=</span>&nbsp;<span class="op" id="7203833">&amp;</span><span class="ident" id="7203834"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7203838">{</span><span class="num" id="7203839">7</span><span class="op" id="7203840">,</span>&nbsp;<span class="num" id="7203842">8</span><span class="op" id="7203843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203846">reply</span>&nbsp;<span class="op" id="7203852">:=</span>&nbsp;<span class="builtinfunc" id="7203855">new</span><span class="op" id="7203858">(</span><span class="ident" id="7203859"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7203864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203867"><a href="/net/rpc/server_test.go.html#7203708">err</a></span>&nbsp;<span class="op" id="7203871">=</span>&nbsp;<span class="ident" id="7203873"><a href="/net/rpc/server_test.go.html#7203700">client</a></span><span class="op" id="7203879">.</span><span class="ident" id="7203880">Call</span><span class="op" id="7203884">(</span><span class="string" id="7203885">&#34;newServer.Arith.Add&#34;</span><span class="op" id="7203906">,</span>&nbsp;<span class="ident" id="7203908"><a href="/net/rpc/server_test.go.html#7203825">args</a></span><span class="op" id="7203912">,</span>&nbsp;<span class="ident" id="7203914"><a href="/net/rpc/server_test.go.html#7203846">reply</a></span><span class="op" id="7203919">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7203922">if</span>&nbsp;<span class="ident" id="7203925"><a href="/net/rpc/server_test.go.html#7203708">err</a></span>&nbsp;<span class="op" id="7203929">!=</span>&nbsp;<span class="ident" id="7203932">nil</span>&nbsp;<span class="op" id="7203936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7203940"><a href="/net/rpc/server_test.go.html#7203670">t</a></span><span class="op" id="7203941">.</span><span class="ident" id="7203942">Errorf</span><span class="op" id="7203948">(</span><span class="string" id="7203949">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7203991">,</span>&nbsp;<span class="ident" id="7203993"><a href="/net/rpc/server_test.go.html#7203708">err</a></span><span class="op" id="7203996">.</span><span class="ident" id="7203997">Error</span><span class="op" id="7204002">(</span><span class="op" id="7204003">)</span><span class="op" id="7204004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204010">if</span>&nbsp;<span class="ident" id="7204013"><a href="/net/rpc/server_test.go.html#7203846">reply</a></span><span class="op" id="7204018">.</span><span class="ident" id="7204019">C</span>&nbsp;<span class="op" id="7204021">!=</span>&nbsp;<span class="ident" id="7204024"><a href="/net/rpc/server_test.go.html#7203825">args</a></span><span class="op" id="7204028">.</span><span class="ident" id="7204029">A</span><span class="op" id="7204030">+</span><span class="ident" id="7204031"><a href="/net/rpc/server_test.go.html#7203825">args</a></span><span class="op" id="7204035">.</span><span class="ident" id="7204036">B</span>&nbsp;<span class="op" id="7204038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204042"><a href="/net/rpc/server_test.go.html#7203670">t</a></span><span class="op" id="7204043">.</span><span class="ident" id="7204044">Errorf</span><span class="op" id="7204050">(</span><span class="string" id="7204051">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7204076">,</span>&nbsp;<span class="ident" id="7204078"><a href="/net/rpc/server_test.go.html#7203846">reply</a></span><span class="op" id="7204083">.</span><span class="ident" id="7204084">C</span><span class="op" id="7204085">,</span>&nbsp;<span class="ident" id="7204087"><a href="/net/rpc/server_test.go.html#7203825">args</a></span><span class="op" id="7204091">.</span><span class="ident" id="7204092">A</span><span class="op" id="7204093">+</span><span class="ident" id="7204094"><a href="/net/rpc/server_test.go.html#7203825">args</a></span><span class="op" id="7204098">.</span><span class="ident" id="7204099">B</span><span class="op" id="7204100">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204103">}</span><br>
<span class="lineno"></span><span class="op" id="7204105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7204108">func</span>&nbsp;<span class="ident" id="7204113">TestHTTP</span><span class="op" id="7204121">(</span><span class="ident" id="7204122">t</span>&nbsp;<span class="op" id="7204124">*</span><span class="ident" id="7204125"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7204132">.</span><span class="ident" id="7204133">T</span><span class="op" id="7204134">)</span>&nbsp;<span class="op" id="7204136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204139"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7204143">.</span><span class="ident" id="7204144">Do</span><span class="op" id="7204146">(</span><span class="ident" id="7204147"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7204158">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204161"><a href="/net/rpc/server_test.go.html#7204245">testHTTPRPC</a></span><span class="op" id="7204172">(</span><span class="ident" id="7204173"><a href="/net/rpc/server_test.go.html#7204122">t</a></span><span class="op" id="7204174">,</span>&nbsp;<span class="string" id="7204176">&#34;&#34;</span><span class="op" id="7204178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204181"><a href="/net/rpc/server_test.go.html#7197954">newOnce</a></span><span class="op" id="7204188">.</span><span class="ident" id="7204189">Do</span><span class="op" id="7204191">(</span><span class="ident" id="7204192"><a href="/net/rpc/server_test.go.html#7199313">startNewServer</a></span><span class="op" id="7204206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204209"><a href="/net/rpc/server_test.go.html#7204245">testHTTPRPC</a></span><span class="op" id="7204220">(</span><span class="ident" id="7204221"><a href="/net/rpc/server_test.go.html#7204122">t</a></span><span class="op" id="7204222">,</span>&nbsp;<span class="ident" id="7204224"><a href="/net/rpc/server_test.go.html#7197996">newHttpPath</a></span><span class="op" id="7204235">)</span><br>
<span class="lineno"></span><span class="op" id="7204237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7204240">func</span>&nbsp;<span class="ident" id="7204245">testHTTPRPC</span><span class="op" id="7204256">(</span><span class="ident" id="7204257">t</span>&nbsp;<span class="op" id="7204259">*</span><span class="ident" id="7204260"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7204267">.</span><span class="ident" id="7204268">T</span><span class="op" id="7204269">,</span>&nbsp;<span class="ident" id="7204271">path</span>&nbsp;<span class="builtintype" id="7204276">string</span><span class="op" id="7204282">)</span>&nbsp;<span class="op" id="7204284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204287">var</span>&nbsp;<span class="ident" id="7204291">client</span>&nbsp;<span class="op" id="7204298">*</span><span class="ident" id="7204299"><a href="/net/rpc/client.go.html#4992823">Client</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204307">var</span>&nbsp;<span class="ident" id="7204311">err</span>&nbsp;<span class="builtintype" id="7204315">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204322">if</span>&nbsp;<span class="ident" id="7204325"><a href="/net/rpc/server_test.go.html#7204271">path</a></span>&nbsp;<span class="op" id="7204330">==</span>&nbsp;<span class="string" id="7204333">&#34;&#34;</span>&nbsp;<span class="op" id="7204336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204340"><a href="/net/rpc/server_test.go.html#7204291">client</a></span><span class="op" id="7204346">,</span>&nbsp;<span class="ident" id="7204348"><a href="/net/rpc/server_test.go.html#7204311">err</a></span>&nbsp;<span class="op" id="7204352">=</span>&nbsp;<span class="ident" id="7204354"><a href="/net/rpc/client.go.html#4998014">DialHTTP</a></span><span class="op" id="7204362">(</span><span class="string" id="7204363">&#34;tcp&#34;</span><span class="op" id="7204368">,</span>&nbsp;<span class="ident" id="7204370"><a href="/net/rpc/server_test.go.html#7197914">httpServerAddr</a></span><span class="op" id="7204384">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204387">}</span>&nbsp;<span class="keyword" id="7204389">else</span>&nbsp;<span class="op" id="7204394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204398"><a href="/net/rpc/server_test.go.html#7204291">client</a></span><span class="op" id="7204404">,</span>&nbsp;<span class="ident" id="7204406"><a href="/net/rpc/server_test.go.html#7204311">err</a></span>&nbsp;<span class="op" id="7204410">=</span>&nbsp;<span class="ident" id="7204412"><a href="/net/rpc/client.go.html#4998223">DialHTTPPath</a></span><span class="op" id="7204424">(</span><span class="string" id="7204425">&#34;tcp&#34;</span><span class="op" id="7204430">,</span>&nbsp;<span class="ident" id="7204432"><a href="/net/rpc/server_test.go.html#7197914">httpServerAddr</a></span><span class="op" id="7204446">,</span>&nbsp;<span class="ident" id="7204448"><a href="/net/rpc/server_test.go.html#7204271">path</a></span><span class="op" id="7204452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204458">if</span>&nbsp;<span class="ident" id="7204461"><a href="/net/rpc/server_test.go.html#7204311">err</a></span>&nbsp;<span class="op" id="7204465">!=</span>&nbsp;<span class="ident" id="7204468">nil</span>&nbsp;<span class="op" id="7204472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204476"><a href="/net/rpc/server_test.go.html#7204257">t</a></span><span class="op" id="7204477">.</span><span class="ident" id="7204478">Fatal</span><span class="op" id="7204483">(</span><span class="string" id="7204484">&#34;dialing&#34;</span><span class="op" id="7204493">,</span>&nbsp;<span class="ident" id="7204495"><a href="/net/rpc/server_test.go.html#7204311">err</a></span><span class="op" id="7204498">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204504">defer</span>&nbsp;<span class="ident" id="7204510"><a href="/net/rpc/server_test.go.html#7204291">client</a></span><span class="op" id="7204516">.</span><span class="ident" id="7204517">Close</span><span class="op" id="7204522">(</span><span class="op" id="7204523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7204527">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204549">args</span>&nbsp;<span class="op" id="7204554">:=</span>&nbsp;<span class="op" id="7204557">&amp;</span><span class="ident" id="7204558"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7204562">{</span><span class="num" id="7204563">7</span><span class="op" id="7204564">,</span>&nbsp;<span class="num" id="7204566">8</span><span class="op" id="7204567">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204570">reply</span>&nbsp;<span class="op" id="7204576">:=</span>&nbsp;<span class="builtinfunc" id="7204579">new</span><span class="op" id="7204582">(</span><span class="ident" id="7204583"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7204588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204591"><a href="/net/rpc/server_test.go.html#7204311">err</a></span>&nbsp;<span class="op" id="7204595">=</span>&nbsp;<span class="ident" id="7204597"><a href="/net/rpc/server_test.go.html#7204291">client</a></span><span class="op" id="7204603">.</span><span class="ident" id="7204604">Call</span><span class="op" id="7204608">(</span><span class="string" id="7204609">&#34;Arith.Add&#34;</span><span class="op" id="7204620">,</span>&nbsp;<span class="ident" id="7204622"><a href="/net/rpc/server_test.go.html#7204549">args</a></span><span class="op" id="7204626">,</span>&nbsp;<span class="ident" id="7204628"><a href="/net/rpc/server_test.go.html#7204570">reply</a></span><span class="op" id="7204633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204636">if</span>&nbsp;<span class="ident" id="7204639"><a href="/net/rpc/server_test.go.html#7204311">err</a></span>&nbsp;<span class="op" id="7204643">!=</span>&nbsp;<span class="ident" id="7204646">nil</span>&nbsp;<span class="op" id="7204650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204654"><a href="/net/rpc/server_test.go.html#7204257">t</a></span><span class="op" id="7204655">.</span><span class="ident" id="7204656">Errorf</span><span class="op" id="7204662">(</span><span class="string" id="7204663">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7204705">,</span>&nbsp;<span class="ident" id="7204707"><a href="/net/rpc/server_test.go.html#7204311">err</a></span><span class="op" id="7204710">.</span><span class="ident" id="7204711">Error</span><span class="op" id="7204716">(</span><span class="op" id="7204717">)</span><span class="op" id="7204718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204721">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7204724">if</span>&nbsp;<span class="ident" id="7204727"><a href="/net/rpc/server_test.go.html#7204570">reply</a></span><span class="op" id="7204732">.</span><span class="ident" id="7204733">C</span>&nbsp;<span class="op" id="7204735">!=</span>&nbsp;<span class="ident" id="7204738"><a href="/net/rpc/server_test.go.html#7204549">args</a></span><span class="op" id="7204742">.</span><span class="ident" id="7204743">A</span><span class="op" id="7204744">+</span><span class="ident" id="7204745"><a href="/net/rpc/server_test.go.html#7204549">args</a></span><span class="op" id="7204749">.</span><span class="ident" id="7204750">B</span>&nbsp;<span class="op" id="7204752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204756"><a href="/net/rpc/server_test.go.html#7204257">t</a></span><span class="op" id="7204757">.</span><span class="ident" id="7204758">Errorf</span><span class="op" id="7204764">(</span><span class="string" id="7204765">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7204790">,</span>&nbsp;<span class="ident" id="7204792"><a href="/net/rpc/server_test.go.html#7204570">reply</a></span><span class="op" id="7204797">.</span><span class="ident" id="7204798">C</span><span class="op" id="7204799">,</span>&nbsp;<span class="ident" id="7204801"><a href="/net/rpc/server_test.go.html#7204549">args</a></span><span class="op" id="7204805">.</span><span class="ident" id="7204806">A</span><span class="op" id="7204807">+</span><span class="ident" id="7204808"><a href="/net/rpc/server_test.go.html#7204549">args</a></span><span class="op" id="7204812">.</span><span class="ident" id="7204813">B</span><span class="op" id="7204814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7204817">}</span><br>
<span class="lineno"></span><span class="op" id="7204819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span><span class="comment" id="7204822">//&nbsp;CodecEmulator&nbsp;provides&nbsp;a&nbsp;client-like&nbsp;api&nbsp;and&nbsp;a&nbsp;ServerCodec&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="7204895">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;to&nbsp;test&nbsp;ServeRequest.</span><br>
<span class="lineno"></span><span class="keyword" id="7204932">type</span>&nbsp;<span class="ident" id="7204937">CodecEmulator</span>&nbsp;<span class="keyword" id="7204951">struct</span>&nbsp;<span class="op" id="7204958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204961">server</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7204975">*</span><span class="ident" id="7204976"><a href="/net/rpc/server.go.html#5008452">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7204984">serviceMethod</span>&nbsp;<span class="builtintype" id="7204998">string</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205006">args</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7205020">*</span><span class="ident" id="7205021"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205027">reply</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7205041">*</span><span class="ident" id="7205042"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205049">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7205063">error</span><br>
<span class="lineno"></span><span class="op" id="7205069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="keyword" id="7205072">func</span>&nbsp;<span class="op" id="7205077">(</span><span class="ident" id="7205078">codec</span>&nbsp;<span class="op" id="7205084">*</span><span class="ident" id="7205085"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7205098">)</span>&nbsp;<span class="ident" id="7205100">Call</span><span class="op" id="7205104">(</span><span class="ident" id="7205105">serviceMethod</span>&nbsp;<span class="builtintype" id="7205119">string</span><span class="op" id="7205125">,</span>&nbsp;<span class="ident" id="7205127">args</span>&nbsp;<span class="op" id="7205132">*</span><span class="ident" id="7205133"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7205137">,</span>&nbsp;<span class="ident" id="7205139">reply</span>&nbsp;<span class="op" id="7205145">*</span><span class="ident" id="7205146"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7205151">)</span>&nbsp;<span class="builtintype" id="7205153">error</span>&nbsp;<span class="op" id="7205159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205162"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205167">.</span><span class="ident" id="7205168">serviceMethod</span>&nbsp;<span class="op" id="7205182">=</span>&nbsp;<span class="ident" id="7205184"><a href="/net/rpc/server_test.go.html#7205105">serviceMethod</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205199"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205204">.</span><span class="ident" id="7205205">args</span>&nbsp;<span class="op" id="7205210">=</span>&nbsp;<span class="ident" id="7205212"><a href="/net/rpc/server_test.go.html#7205127">args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205218"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205223">.</span><span class="ident" id="7205224">reply</span>&nbsp;<span class="op" id="7205230">=</span>&nbsp;<span class="ident" id="7205232"><a href="/net/rpc/server_test.go.html#7205139">reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205239"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205244">.</span><span class="ident" id="7205245">err</span>&nbsp;<span class="op" id="7205249">=</span>&nbsp;<span class="ident" id="7205251">nil</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205256">var</span>&nbsp;<span class="ident" id="7205260">serverError</span>&nbsp;<span class="builtintype" id="7205272">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205279">if</span>&nbsp;<span class="ident" id="7205282"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205287">.</span><span class="ident" id="7205288">server</span>&nbsp;<span class="op" id="7205295">==</span>&nbsp;<span class="ident" id="7205298">nil</span>&nbsp;<span class="op" id="7205302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205306"><a href="/net/rpc/server_test.go.html#7205260">serverError</a></span>&nbsp;<span class="op" id="7205318">=</span>&nbsp;<span class="ident" id="7205320"><a href="/net/rpc/server.go.html#5022677">ServeRequest</a></span><span class="op" id="7205332">(</span><span class="ident" id="7205333"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205341">}</span>&nbsp;<span class="keyword" id="7205343">else</span>&nbsp;<span class="op" id="7205348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205352"><a href="/net/rpc/server_test.go.html#7205260">serverError</a></span>&nbsp;<span class="op" id="7205364">=</span>&nbsp;<span class="ident" id="7205366"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205371">.</span><span class="ident" id="7205372">server</span><span class="op" id="7205378">.</span><span class="ident" id="7205379">ServeRequest</span><span class="op" id="7205391">(</span><span class="ident" id="7205392"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205397">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205403">if</span>&nbsp;<span class="ident" id="7205406"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205411">.</span><span class="ident" id="7205412">err</span>&nbsp;<span class="op" id="7205416">==</span>&nbsp;<span class="ident" id="7205419">nil</span>&nbsp;<span class="op" id="7205423">&amp;&amp;</span>&nbsp;<span class="ident" id="7205426"><a href="/net/rpc/server_test.go.html#7205260">serverError</a></span>&nbsp;<span class="op" id="7205438">!=</span>&nbsp;<span class="ident" id="7205441">nil</span>&nbsp;<span class="op" id="7205445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205449"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205454">.</span><span class="ident" id="7205455">err</span>&nbsp;<span class="op" id="7205459">=</span>&nbsp;<span class="ident" id="7205461"><a href="/net/rpc/server_test.go.html#7205260">serverError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205477">return</span>&nbsp;<span class="ident" id="7205484"><a href="/net/rpc/server_test.go.html#7205078">codec</a></span><span class="op" id="7205489">.</span><span class="ident" id="7205490">err</span><br>
<span class="lineno">330</span><span class="op" id="7205494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7205497">func</span>&nbsp;<span class="op" id="7205502">(</span><span class="ident" id="7205503">codec</span>&nbsp;<span class="op" id="7205509">*</span><span class="ident" id="7205510"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7205523">)</span>&nbsp;<span class="ident" id="7205525">ReadRequestHeader</span><span class="op" id="7205542">(</span><span class="ident" id="7205543">req</span>&nbsp;<span class="op" id="7205547">*</span><span class="ident" id="7205548"><a href="/net/rpc/server.go.html#5007827">Request</a></span><span class="op" id="7205555">)</span>&nbsp;<span class="builtintype" id="7205557">error</span>&nbsp;<span class="op" id="7205563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205566"><a href="/net/rpc/server_test.go.html#7205543">req</a></span><span class="op" id="7205569">.</span><span class="ident" id="7205570">ServiceMethod</span>&nbsp;<span class="op" id="7205584">=</span>&nbsp;<span class="ident" id="7205586"><a href="/net/rpc/server_test.go.html#7205503">codec</a></span><span class="op" id="7205591">.</span><span class="ident" id="7205592">serviceMethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205607"><a href="/net/rpc/server_test.go.html#7205543">req</a></span><span class="op" id="7205610">.</span><span class="ident" id="7205611">Seq</span>&nbsp;<span class="op" id="7205615">=</span>&nbsp;<span class="num" id="7205617">0</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205620">return</span>&nbsp;<span class="ident" id="7205627">nil</span><br>
<span class="lineno"></span><span class="op" id="7205631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7205634">func</span>&nbsp;<span class="op" id="7205639">(</span><span class="ident" id="7205640">codec</span>&nbsp;<span class="op" id="7205646">*</span><span class="ident" id="7205647"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7205660">)</span>&nbsp;<span class="ident" id="7205662">ReadRequestBody</span><span class="op" id="7205677">(</span><span class="ident" id="7205678">argv</span>&nbsp;<span class="keyword" id="7205683">interface</span><span class="op" id="7205692">{</span><span class="op" id="7205693">}</span><span class="op" id="7205694">)</span>&nbsp;<span class="builtintype" id="7205696">error</span>&nbsp;<span class="op" id="7205702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205705">if</span>&nbsp;<span class="ident" id="7205708"><a href="/net/rpc/server_test.go.html#7205640">codec</a></span><span class="op" id="7205713">.</span><span class="ident" id="7205714">args</span>&nbsp;<span class="op" id="7205719">==</span>&nbsp;<span class="ident" id="7205722">nil</span>&nbsp;<span class="op" id="7205726">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205730">return</span>&nbsp;<span class="ident" id="7205737"><a href="/net/rpc/server_test.go.html#7197731">io</a></span><span class="op" id="7205739">.</span><span class="ident" id="7205740">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205761">*</span><span class="op" id="7205762">(</span><span class="ident" id="7205763"><a href="/net/rpc/server_test.go.html#7205678">argv</a></span><span class="op" id="7205767">.</span><span class="op" id="7205768">(</span><span class="op" id="7205769">*</span><span class="ident" id="7205770"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7205774">)</span><span class="op" id="7205775">)</span>&nbsp;<span class="op" id="7205777">=</span>&nbsp;<span class="op" id="7205779">*</span><span class="ident" id="7205780"><a href="/net/rpc/server_test.go.html#7205640">codec</a></span><span class="op" id="7205785">.</span><span class="ident" id="7205786">args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205792">return</span>&nbsp;<span class="ident" id="7205799">nil</span><br>
<span class="lineno"></span><span class="op" id="7205803">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7205806">func</span>&nbsp;<span class="op" id="7205811">(</span><span class="ident" id="7205812">codec</span>&nbsp;<span class="op" id="7205818">*</span><span class="ident" id="7205819"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7205832">)</span>&nbsp;<span class="ident" id="7205834">WriteResponse</span><span class="op" id="7205847">(</span><span class="ident" id="7205848">resp</span>&nbsp;<span class="op" id="7205853">*</span><span class="ident" id="7205854"><a href="/net/rpc/server.go.html#5008185">Response</a></span><span class="op" id="7205862">,</span>&nbsp;<span class="ident" id="7205864">reply</span>&nbsp;<span class="keyword" id="7205870">interface</span><span class="op" id="7205879">{</span><span class="op" id="7205880">}</span><span class="op" id="7205881">)</span>&nbsp;<span class="builtintype" id="7205883">error</span>&nbsp;<span class="op" id="7205889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7205892">if</span>&nbsp;<span class="ident" id="7205895"><a href="/net/rpc/server_test.go.html#7205848">resp</a></span><span class="op" id="7205899">.</span><span class="ident" id="7205900">Error</span>&nbsp;<span class="op" id="7205906">!=</span>&nbsp;<span class="string" id="7205909">&#34;&#34;</span>&nbsp;<span class="op" id="7205912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7205916"><a href="/net/rpc/server_test.go.html#7205812">codec</a></span><span class="op" id="7205921">.</span><span class="ident" id="7205922">err</span>&nbsp;<span class="op" id="7205926">=</span>&nbsp;<span class="ident" id="7205928"><a href="/net/rpc/server_test.go.html#7197714">errors</a></span><span class="op" id="7205934">.</span><span class="ident" id="7205935">New</span><span class="op" id="7205938">(</span><span class="ident" id="7205939"><a href="/net/rpc/server_test.go.html#7205848">resp</a></span><span class="op" id="7205943">.</span><span class="ident" id="7205944">Error</span><span class="op" id="7205949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205952">}</span>&nbsp;<span class="keyword" id="7205954">else</span>&nbsp;<span class="op" id="7205959">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205963">*</span><span class="ident" id="7205964"><a href="/net/rpc/server_test.go.html#7205812">codec</a></span><span class="op" id="7205969">.</span><span class="ident" id="7205970">reply</span>&nbsp;<span class="op" id="7205976">=</span>&nbsp;<span class="op" id="7205978">*</span><span class="op" id="7205979">(</span><span class="ident" id="7205980"><a href="/net/rpc/server_test.go.html#7205864">reply</a></span><span class="op" id="7205985">.</span><span class="op" id="7205986">(</span><span class="op" id="7205987">*</span><span class="ident" id="7205988"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7205993">)</span><span class="op" id="7205994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7205997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206000">return</span>&nbsp;<span class="ident" id="7206007">nil</span><br>
<span class="lineno"></span><span class="op" id="7206011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="7206014">func</span>&nbsp;<span class="op" id="7206019">(</span><span class="ident" id="7206020">codec</span>&nbsp;<span class="op" id="7206026">*</span><span class="ident" id="7206027"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7206040">)</span>&nbsp;<span class="ident" id="7206042">Close</span><span class="op" id="7206047">(</span><span class="op" id="7206048">)</span>&nbsp;<span class="builtintype" id="7206050">error</span>&nbsp;<span class="op" id="7206056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206059">return</span>&nbsp;<span class="ident" id="7206066">nil</span><br>
<span class="lineno"></span><span class="op" id="7206070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7206073">func</span>&nbsp;<span class="ident" id="7206078">TestServeRequest</span><span class="op" id="7206094">(</span><span class="ident" id="7206095">t</span>&nbsp;<span class="op" id="7206097">*</span><span class="ident" id="7206098"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7206105">.</span><span class="ident" id="7206106">T</span><span class="op" id="7206107">)</span>&nbsp;<span class="op" id="7206109">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206112"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7206116">.</span><span class="ident" id="7206117">Do</span><span class="op" id="7206119">(</span><span class="ident" id="7206120"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7206131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206134"><a href="/net/rpc/server_test.go.html#7206227">testServeRequest</a></span><span class="op" id="7206150">(</span><span class="ident" id="7206151"><a href="/net/rpc/server_test.go.html#7206095">t</a></span><span class="op" id="7206152">,</span>&nbsp;<span class="ident" id="7206154">nil</span><span class="op" id="7206157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206160"><a href="/net/rpc/server_test.go.html#7197954">newOnce</a></span><span class="op" id="7206167">.</span><span class="ident" id="7206168">Do</span><span class="op" id="7206170">(</span><span class="ident" id="7206171"><a href="/net/rpc/server_test.go.html#7199313">startNewServer</a></span><span class="op" id="7206185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206188"><a href="/net/rpc/server_test.go.html#7206227">testServeRequest</a></span><span class="op" id="7206204">(</span><span class="ident" id="7206205"><a href="/net/rpc/server_test.go.html#7206095">t</a></span><span class="op" id="7206206">,</span>&nbsp;<span class="ident" id="7206208"><a href="/net/rpc/server_test.go.html#7197845">newServer</a></span><span class="op" id="7206217">)</span><br>
<span class="lineno"></span><span class="op" id="7206219">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="7206222">func</span>&nbsp;<span class="ident" id="7206227">testServeRequest</span><span class="op" id="7206243">(</span><span class="ident" id="7206244">t</span>&nbsp;<span class="op" id="7206246">*</span><span class="ident" id="7206247"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7206254">.</span><span class="ident" id="7206255">T</span><span class="op" id="7206256">,</span>&nbsp;<span class="ident" id="7206258">server</span>&nbsp;<span class="op" id="7206265">*</span><span class="ident" id="7206266"><a href="/net/rpc/server.go.html#5008452">Server</a></span><span class="op" id="7206272">)</span>&nbsp;<span class="op" id="7206274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206277">client</span>&nbsp;<span class="op" id="7206284">:=</span>&nbsp;<span class="ident" id="7206287"><a href="/net/rpc/server_test.go.html#7204937">CodecEmulator</a></span><span class="op" id="7206300">{</span><span class="ident" id="7206301">server</span><span class="op" id="7206307">:</span>&nbsp;<span class="ident" id="7206309"><a href="/net/rpc/server_test.go.html#7206258">server</a></span><span class="op" id="7206315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206318">defer</span>&nbsp;<span class="ident" id="7206324"><a href="/net/rpc/server_test.go.html#7206277">client</a></span><span class="op" id="7206330">.</span><span class="ident" id="7206331">Close</span><span class="op" id="7206336">(</span><span class="op" id="7206337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206341">args</span>&nbsp;<span class="op" id="7206346">:=</span>&nbsp;<span class="op" id="7206349">&amp;</span><span class="ident" id="7206350"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7206354">{</span><span class="num" id="7206355">7</span><span class="op" id="7206356">,</span>&nbsp;<span class="num" id="7206358">8</span><span class="op" id="7206359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206362">reply</span>&nbsp;<span class="op" id="7206368">:=</span>&nbsp;<span class="builtinfunc" id="7206371">new</span><span class="op" id="7206374">(</span><span class="ident" id="7206375"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7206380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206383">err</span>&nbsp;<span class="op" id="7206387">:=</span>&nbsp;<span class="ident" id="7206390"><a href="/net/rpc/server_test.go.html#7206277">client</a></span><span class="op" id="7206396">.</span><span class="ident" id="7206397">Call</span><span class="op" id="7206401">(</span><span class="string" id="7206402">&#34;Arith.Add&#34;</span><span class="op" id="7206413">,</span>&nbsp;<span class="ident" id="7206415"><a href="/net/rpc/server_test.go.html#7206341">args</a></span><span class="op" id="7206419">,</span>&nbsp;<span class="ident" id="7206421"><a href="/net/rpc/server_test.go.html#7206362">reply</a></span><span class="op" id="7206426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206429">if</span>&nbsp;<span class="ident" id="7206432"><a href="/net/rpc/server_test.go.html#7206383">err</a></span>&nbsp;<span class="op" id="7206436">!=</span>&nbsp;<span class="ident" id="7206439">nil</span>&nbsp;<span class="op" id="7206443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206447"><a href="/net/rpc/server_test.go.html#7206244">t</a></span><span class="op" id="7206448">.</span><span class="ident" id="7206449">Errorf</span><span class="op" id="7206455">(</span><span class="string" id="7206456">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7206498">,</span>&nbsp;<span class="ident" id="7206500"><a href="/net/rpc/server_test.go.html#7206383">err</a></span><span class="op" id="7206503">.</span><span class="ident" id="7206504">Error</span><span class="op" id="7206509">(</span><span class="op" id="7206510">)</span><span class="op" id="7206511">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7206514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206517">if</span>&nbsp;<span class="ident" id="7206520"><a href="/net/rpc/server_test.go.html#7206362">reply</a></span><span class="op" id="7206525">.</span><span class="ident" id="7206526">C</span>&nbsp;<span class="op" id="7206528">!=</span>&nbsp;<span class="ident" id="7206531"><a href="/net/rpc/server_test.go.html#7206341">args</a></span><span class="op" id="7206535">.</span><span class="ident" id="7206536">A</span><span class="op" id="7206537">+</span><span class="ident" id="7206538"><a href="/net/rpc/server_test.go.html#7206341">args</a></span><span class="op" id="7206542">.</span><span class="ident" id="7206543">B</span>&nbsp;<span class="op" id="7206545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206549"><a href="/net/rpc/server_test.go.html#7206244">t</a></span><span class="op" id="7206550">.</span><span class="ident" id="7206551">Errorf</span><span class="op" id="7206557">(</span><span class="string" id="7206558">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7206583">,</span>&nbsp;<span class="ident" id="7206585"><a href="/net/rpc/server_test.go.html#7206362">reply</a></span><span class="op" id="7206590">.</span><span class="ident" id="7206591">C</span><span class="op" id="7206592">,</span>&nbsp;<span class="ident" id="7206594"><a href="/net/rpc/server_test.go.html#7206341">args</a></span><span class="op" id="7206598">.</span><span class="ident" id="7206599">A</span><span class="op" id="7206600">+</span><span class="ident" id="7206601"><a href="/net/rpc/server_test.go.html#7206341">args</a></span><span class="op" id="7206605">.</span><span class="ident" id="7206606">B</span><span class="op" id="7206607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7206610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206614"><a href="/net/rpc/server_test.go.html#7206383">err</a></span>&nbsp;<span class="op" id="7206618">=</span>&nbsp;<span class="ident" id="7206620"><a href="/net/rpc/server_test.go.html#7206277">client</a></span><span class="op" id="7206626">.</span><span class="ident" id="7206627">Call</span><span class="op" id="7206631">(</span><span class="string" id="7206632">&#34;Arith.Add&#34;</span><span class="op" id="7206643">,</span>&nbsp;<span class="ident" id="7206645">nil</span><span class="op" id="7206648">,</span>&nbsp;<span class="ident" id="7206650"><a href="/net/rpc/server_test.go.html#7206362">reply</a></span><span class="op" id="7206655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206658">if</span>&nbsp;<span class="ident" id="7206661"><a href="/net/rpc/server_test.go.html#7206383">err</a></span>&nbsp;<span class="op" id="7206665">==</span>&nbsp;<span class="ident" id="7206668">nil</span>&nbsp;<span class="op" id="7206672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7206676"><a href="/net/rpc/server_test.go.html#7206244">t</a></span><span class="op" id="7206677">.</span><span class="ident" id="7206678">Errorf</span><span class="op" id="7206684">(</span><span class="string" id="7206685">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;nil&nbsp;arg&#34;</span><span class="op" id="7206732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7206735">}</span><br>
<span class="lineno"></span><span class="op" id="7206737">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="keyword" id="7206740">type</span>&nbsp;<span class="ident" id="7206745">ReplyNotPointer</span>&nbsp;<span class="builtintype" id="7206761">int</span><br>
<span class="lineno"></span><span class="keyword" id="7206765">type</span>&nbsp;<span class="ident" id="7206770">ArgNotPublic</span>&nbsp;<span class="builtintype" id="7206783">int</span><br>
<span class="lineno"></span><span class="keyword" id="7206787">type</span>&nbsp;<span class="ident" id="7206792">ReplyNotPublic</span>&nbsp;<span class="builtintype" id="7206807">int</span><br>
<span class="lineno"></span><span class="keyword" id="7206811">type</span>&nbsp;<span class="ident" id="7206816">NeedsPtrType</span>&nbsp;<span class="builtintype" id="7206829">int</span><br>
<span class="lineno">390</span><span class="keyword" id="7206833">type</span>&nbsp;<span class="ident" id="7206838">local</span>&nbsp;<span class="keyword" id="7206844">struct</span><span class="op" id="7206850">{</span><span class="op" id="7206851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7206854">func</span>&nbsp;<span class="op" id="7206859">(</span><span class="ident" id="7206860">t</span>&nbsp;<span class="op" id="7206862">*</span><span class="ident" id="7206863"><a href="/net/rpc/server_test.go.html#7206745">ReplyNotPointer</a></span><span class="op" id="7206878">)</span>&nbsp;<span class="ident" id="7206880">ReplyNotPointer</span><span class="op" id="7206895">(</span><span class="ident" id="7206896">args</span>&nbsp;<span class="op" id="7206901">*</span><span class="ident" id="7206902"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7206906">,</span>&nbsp;<span class="ident" id="7206908">reply</span>&nbsp;<span class="ident" id="7206914"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7206919">)</span>&nbsp;<span class="builtintype" id="7206921">error</span>&nbsp;<span class="op" id="7206927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7206930">return</span>&nbsp;<span class="ident" id="7206937">nil</span><br>
<span class="lineno"></span><span class="op" id="7206941">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="7206944">func</span>&nbsp;<span class="op" id="7206949">(</span><span class="ident" id="7206950">t</span>&nbsp;<span class="op" id="7206952">*</span><span class="ident" id="7206953"><a href="/net/rpc/server_test.go.html#7206770">ArgNotPublic</a></span><span class="op" id="7206965">)</span>&nbsp;<span class="ident" id="7206967">ArgNotPublic</span><span class="op" id="7206979">(</span><span class="ident" id="7206980">args</span>&nbsp;<span class="op" id="7206985">*</span><span class="ident" id="7206986"><a href="/net/rpc/server_test.go.html#7206838">local</a></span><span class="op" id="7206991">,</span>&nbsp;<span class="ident" id="7206993">reply</span>&nbsp;<span class="op" id="7206999">*</span><span class="ident" id="7207000"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7207005">)</span>&nbsp;<span class="builtintype" id="7207007">error</span>&nbsp;<span class="op" id="7207013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207016">return</span>&nbsp;<span class="ident" id="7207023">nil</span><br>
<span class="lineno"></span><span class="op" id="7207027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="7207030">func</span>&nbsp;<span class="op" id="7207035">(</span><span class="ident" id="7207036">t</span>&nbsp;<span class="op" id="7207038">*</span><span class="ident" id="7207039"><a href="/net/rpc/server_test.go.html#7206792">ReplyNotPublic</a></span><span class="op" id="7207053">)</span>&nbsp;<span class="ident" id="7207055">ReplyNotPublic</span><span class="op" id="7207069">(</span><span class="ident" id="7207070">args</span>&nbsp;<span class="op" id="7207075">*</span><span class="ident" id="7207076"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7207080">,</span>&nbsp;<span class="ident" id="7207082">reply</span>&nbsp;<span class="op" id="7207088">*</span><span class="ident" id="7207089"><a href="/net/rpc/server_test.go.html#7206838">local</a></span><span class="op" id="7207094">)</span>&nbsp;<span class="builtintype" id="7207096">error</span>&nbsp;<span class="op" id="7207102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207105">return</span>&nbsp;<span class="ident" id="7207112">nil</span><br>
<span class="lineno"></span><span class="op" id="7207116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7207119">func</span>&nbsp;<span class="op" id="7207124">(</span><span class="ident" id="7207125">t</span>&nbsp;<span class="op" id="7207127">*</span><span class="ident" id="7207128"><a href="/net/rpc/server_test.go.html#7206816">NeedsPtrType</a></span><span class="op" id="7207140">)</span>&nbsp;<span class="ident" id="7207142">NeedsPtrType</span><span class="op" id="7207154">(</span><span class="ident" id="7207155">args</span>&nbsp;<span class="op" id="7207160">*</span><span class="ident" id="7207161"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7207165">,</span>&nbsp;<span class="ident" id="7207167">reply</span>&nbsp;<span class="op" id="7207173">*</span><span class="ident" id="7207174"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7207179">)</span>&nbsp;<span class="builtintype" id="7207181">error</span>&nbsp;<span class="op" id="7207187">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207190">return</span>&nbsp;<span class="ident" id="7207197">nil</span><br>
<span class="lineno"></span><span class="op" id="7207201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7207204">//&nbsp;Check&nbsp;that&nbsp;registration&nbsp;handles&nbsp;lots&nbsp;of&nbsp;bad&nbsp;methods&nbsp;and&nbsp;a&nbsp;type&nbsp;with&nbsp;no&nbsp;suitable&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="7207296">func</span>&nbsp;<span class="ident" id="7207301">TestRegistrationError</span><span class="op" id="7207322">(</span><span class="ident" id="7207323">t</span>&nbsp;<span class="op" id="7207325">*</span><span class="ident" id="7207326"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7207333">.</span><span class="ident" id="7207334">T</span><span class="op" id="7207335">)</span>&nbsp;<span class="op" id="7207337">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207340">err</span>&nbsp;<span class="op" id="7207344">:=</span>&nbsp;<span class="ident" id="7207347"><a href="/net/rpc/server.go.html#5020981">Register</a></span><span class="op" id="7207355">(</span><span class="builtinfunc" id="7207356">new</span><span class="op" id="7207359">(</span><span class="ident" id="7207360"><a href="/net/rpc/server_test.go.html#7206745">ReplyNotPointer</a></span><span class="op" id="7207375">)</span><span class="op" id="7207376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207379">if</span>&nbsp;<span class="ident" id="7207382"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207386">==</span>&nbsp;<span class="ident" id="7207389">nil</span>&nbsp;<span class="op" id="7207393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207397"><a href="/net/rpc/server_test.go.html#7207323">t</a></span><span class="op" id="7207398">.</span><span class="ident" id="7207399">Error</span><span class="op" id="7207404">(</span><span class="string" id="7207405">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPointer&#34;</span><span class="op" id="7207449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7207452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207455"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207459">=</span>&nbsp;<span class="ident" id="7207461"><a href="/net/rpc/server.go.html#5020981">Register</a></span><span class="op" id="7207469">(</span><span class="builtinfunc" id="7207470">new</span><span class="op" id="7207473">(</span><span class="ident" id="7207474"><a href="/net/rpc/server_test.go.html#7206770">ArgNotPublic</a></span><span class="op" id="7207486">)</span><span class="op" id="7207487">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207490">if</span>&nbsp;<span class="ident" id="7207493"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207497">==</span>&nbsp;<span class="ident" id="7207500">nil</span>&nbsp;<span class="op" id="7207504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207508"><a href="/net/rpc/server_test.go.html#7207323">t</a></span><span class="op" id="7207509">.</span><span class="ident" id="7207510">Error</span><span class="op" id="7207515">(</span><span class="string" id="7207516">&#34;expected&nbsp;error&nbsp;registering&nbsp;ArgNotPublic&#34;</span><span class="op" id="7207557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7207560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207563"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207567">=</span>&nbsp;<span class="ident" id="7207569"><a href="/net/rpc/server.go.html#5020981">Register</a></span><span class="op" id="7207577">(</span><span class="builtinfunc" id="7207578">new</span><span class="op" id="7207581">(</span><span class="ident" id="7207582"><a href="/net/rpc/server_test.go.html#7206792">ReplyNotPublic</a></span><span class="op" id="7207596">)</span><span class="op" id="7207597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207600">if</span>&nbsp;<span class="ident" id="7207603"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207607">==</span>&nbsp;<span class="ident" id="7207610">nil</span>&nbsp;<span class="op" id="7207614">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207618"><a href="/net/rpc/server_test.go.html#7207323">t</a></span><span class="op" id="7207619">.</span><span class="ident" id="7207620">Error</span><span class="op" id="7207625">(</span><span class="string" id="7207626">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPublic&#34;</span><span class="op" id="7207669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7207672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207675"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207679">=</span>&nbsp;<span class="ident" id="7207681"><a href="/net/rpc/server.go.html#5020981">Register</a></span><span class="op" id="7207689">(</span><span class="ident" id="7207690"><a href="/net/rpc/server_test.go.html#7206816">NeedsPtrType</a></span><span class="op" id="7207702">(</span><span class="num" id="7207703">0</span><span class="op" id="7207704">)</span><span class="op" id="7207705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7207708">if</span>&nbsp;<span class="ident" id="7207711"><a href="/net/rpc/server_test.go.html#7207340">err</a></span>&nbsp;<span class="op" id="7207715">==</span>&nbsp;<span class="ident" id="7207718">nil</span>&nbsp;<span class="op" id="7207722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207726"><a href="/net/rpc/server_test.go.html#7207323">t</a></span><span class="op" id="7207727">.</span><span class="ident" id="7207728">Error</span><span class="op" id="7207733">(</span><span class="string" id="7207734">&#34;expected&nbsp;error&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7207775">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7207778">}</span>&nbsp;<span class="keyword" id="7207780">else</span>&nbsp;<span class="keyword" id="7207785">if</span>&nbsp;<span class="op" id="7207788">!</span><span class="ident" id="7207789"><a href="/net/rpc/server_test.go.html#7197783">strings</a></span><span class="op" id="7207796">.</span><span class="ident" id="7207797">Contains</span><span class="op" id="7207805">(</span><span class="ident" id="7207806"><a href="/net/rpc/server_test.go.html#7207340">err</a></span><span class="op" id="7207809">.</span><span class="ident" id="7207810">Error</span><span class="op" id="7207815">(</span><span class="op" id="7207816">)</span><span class="op" id="7207817">,</span>&nbsp;<span class="string" id="7207819">&#34;pointer&#34;</span><span class="op" id="7207828">)</span>&nbsp;<span class="op" id="7207830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7207834"><a href="/net/rpc/server_test.go.html#7207323">t</a></span><span class="op" id="7207835">.</span><span class="ident" id="7207836">Error</span><span class="op" id="7207841">(</span><span class="string" id="7207842">&#34;expected&nbsp;hint&nbsp;when&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7207887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7207890">}</span><br>
<span class="lineno"></span><span class="op" id="7207892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="keyword" id="7207895">type</span>&nbsp;<span class="ident" id="7207900">WriteFailCodec</span>&nbsp;<span class="builtintype" id="7207915">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7207920">func</span>&nbsp;<span class="op" id="7207925">(</span><span class="ident" id="7207926"><a href="/net/rpc/server_test.go.html#7207900">WriteFailCodec</a></span><span class="op" id="7207940">)</span>&nbsp;<span class="ident" id="7207942">WriteRequest</span><span class="op" id="7207954">(</span><span class="op" id="7207955">*</span><span class="ident" id="7207956"><a href="/net/rpc/server.go.html#5007827">Request</a></span><span class="op" id="7207963">,</span>&nbsp;<span class="keyword" id="7207965">interface</span><span class="op" id="7207974">{</span><span class="op" id="7207975">}</span><span class="op" id="7207976">)</span>&nbsp;<span class="builtintype" id="7207978">error</span>&nbsp;<span class="op" id="7207984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7207987">//&nbsp;the&nbsp;panic&nbsp;caused&nbsp;by&nbsp;this&nbsp;error&nbsp;used&nbsp;to&nbsp;not&nbsp;unlock&nbsp;a&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208049">return</span>&nbsp;<span class="ident" id="7208056"><a href="/net/rpc/server_test.go.html#7197714">errors</a></span><span class="op" id="7208062">.</span><span class="ident" id="7208063">New</span><span class="op" id="7208066">(</span><span class="string" id="7208067">&#34;fail&#34;</span><span class="op" id="7208073">)</span><br>
<span class="lineno">435</span><span class="op" id="7208075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7208078">func</span>&nbsp;<span class="op" id="7208083">(</span><span class="ident" id="7208084"><a href="/net/rpc/server_test.go.html#7207900">WriteFailCodec</a></span><span class="op" id="7208098">)</span>&nbsp;<span class="ident" id="7208100">ReadResponseHeader</span><span class="op" id="7208118">(</span><span class="op" id="7208119">*</span><span class="ident" id="7208120"><a href="/net/rpc/server.go.html#5008185">Response</a></span><span class="op" id="7208128">)</span>&nbsp;<span class="builtintype" id="7208130">error</span>&nbsp;<span class="op" id="7208136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208139">select</span>&nbsp;<span class="op" id="7208146">{</span><span class="op" id="7208147">}</span><br>
<span class="lineno"></span><span class="op" id="7208149">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="keyword" id="7208152">func</span>&nbsp;<span class="op" id="7208157">(</span><span class="ident" id="7208158"><a href="/net/rpc/server_test.go.html#7207900">WriteFailCodec</a></span><span class="op" id="7208172">)</span>&nbsp;<span class="ident" id="7208174">ReadResponseBody</span><span class="op" id="7208190">(</span><span class="keyword" id="7208191">interface</span><span class="op" id="7208200">{</span><span class="op" id="7208201">}</span><span class="op" id="7208202">)</span>&nbsp;<span class="builtintype" id="7208204">error</span>&nbsp;<span class="op" id="7208210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208213">select</span>&nbsp;<span class="op" id="7208220">{</span><span class="op" id="7208221">}</span><br>
<span class="lineno"></span><span class="op" id="7208223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="7208226">func</span>&nbsp;<span class="op" id="7208231">(</span><span class="ident" id="7208232"><a href="/net/rpc/server_test.go.html#7207900">WriteFailCodec</a></span><span class="op" id="7208246">)</span>&nbsp;<span class="ident" id="7208248">Close</span><span class="op" id="7208253">(</span><span class="op" id="7208254">)</span>&nbsp;<span class="builtintype" id="7208256">error</span>&nbsp;<span class="op" id="7208262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208265">return</span>&nbsp;<span class="ident" id="7208272">nil</span><br>
<span class="lineno"></span><span class="op" id="7208276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7208279">func</span>&nbsp;<span class="ident" id="7208284">TestSendDeadlock</span><span class="op" id="7208300">(</span><span class="ident" id="7208301">t</span>&nbsp;<span class="op" id="7208303">*</span><span class="ident" id="7208304"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7208311">.</span><span class="ident" id="7208312">T</span><span class="op" id="7208313">)</span>&nbsp;<span class="op" id="7208315">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208318">client</span>&nbsp;<span class="op" id="7208325">:=</span>&nbsp;<span class="ident" id="7208328"><a href="/net/rpc/client.go.html#4997133">NewClientWithCodec</a></span><span class="op" id="7208346">(</span><span class="ident" id="7208347"><a href="/net/rpc/server_test.go.html#7207900">WriteFailCodec</a></span><span class="op" id="7208361">(</span><span class="num" id="7208362">0</span><span class="op" id="7208363">)</span><span class="op" id="7208364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208367">defer</span>&nbsp;<span class="ident" id="7208373"><a href="/net/rpc/server_test.go.html#7208318">client</a></span><span class="op" id="7208379">.</span><span class="ident" id="7208380">Close</span><span class="op" id="7208385">(</span><span class="op" id="7208386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208390">done</span>&nbsp;<span class="op" id="7208395">:=</span>&nbsp;<span class="builtinfunc" id="7208398">make</span><span class="op" id="7208402">(</span><span class="keyword" id="7208403">chan</span>&nbsp;<span class="builtintype" id="7208408">bool</span><span class="op" id="7208412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208415">go</span>&nbsp;<span class="keyword" id="7208418">func</span><span class="op" id="7208422">(</span><span class="op" id="7208423">)</span>&nbsp;<span class="op" id="7208425">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208429"><a href="/net/rpc/server_test.go.html#7208604">testSendDeadlock</a></span><span class="op" id="7208445">(</span><span class="ident" id="7208446"><a href="/net/rpc/server_test.go.html#7208318">client</a></span><span class="op" id="7208452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208456"><a href="/net/rpc/server_test.go.html#7208604">testSendDeadlock</a></span><span class="op" id="7208472">(</span><span class="ident" id="7208473"><a href="/net/rpc/server_test.go.html#7208318">client</a></span><span class="op" id="7208479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208483"><a href="/net/rpc/server_test.go.html#7208390">done</a></span>&nbsp;<span class="op" id="7208488">&lt;-</span>&nbsp;<span class="ident" id="7208491">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7208497">}</span><span class="op" id="7208498">(</span><span class="op" id="7208499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208502">select</span>&nbsp;<span class="op" id="7208509">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208512">case</span>&nbsp;<span class="op" id="7208517">&lt;-</span><span class="ident" id="7208519"><a href="/net/rpc/server_test.go.html#7208390">done</a></span><span class="op" id="7208523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208535">case</span>&nbsp;<span class="op" id="7208540">&lt;-</span><span class="ident" id="7208542"><a href="/net/rpc/server_test.go.html#7197828">time</a></span><span class="op" id="7208546">.</span><span class="ident" id="7208547">After</span><span class="op" id="7208552">(</span><span class="num" id="7208553">5</span>&nbsp;<span class="op" id="7208555">*</span>&nbsp;<span class="ident" id="7208557"><a href="/net/rpc/server_test.go.html#7197828">time</a></span><span class="op" id="7208561">.</span><span class="ident" id="7208562">Second</span><span class="op" id="7208568">)</span><span class="op" id="7208569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208573"><a href="/net/rpc/server_test.go.html#7208301">t</a></span><span class="op" id="7208574">.</span><span class="ident" id="7208575">Fatal</span><span class="op" id="7208580">(</span><span class="string" id="7208581">&#34;deadlock&#34;</span><span class="op" id="7208591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7208594">}</span><br>
<span class="lineno">465</span><span class="op" id="7208596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7208599">func</span>&nbsp;<span class="ident" id="7208604">testSendDeadlock</span><span class="op" id="7208620">(</span><span class="ident" id="7208621">client</span>&nbsp;<span class="op" id="7208628">*</span><span class="ident" id="7208629"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7208635">)</span>&nbsp;<span class="op" id="7208637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208640">defer</span>&nbsp;<span class="keyword" id="7208646">func</span><span class="op" id="7208650">(</span><span class="op" id="7208651">)</span>&nbsp;<span class="op" id="7208653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7208657">recover</span><span class="op" id="7208664">(</span><span class="op" id="7208665">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7208668">}</span><span class="op" id="7208669">(</span><span class="op" id="7208670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208673">args</span>&nbsp;<span class="op" id="7208678">:=</span>&nbsp;<span class="op" id="7208681">&amp;</span><span class="ident" id="7208682"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7208686">{</span><span class="num" id="7208687">7</span><span class="op" id="7208688">,</span>&nbsp;<span class="num" id="7208690">8</span><span class="op" id="7208691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208694">reply</span>&nbsp;<span class="op" id="7208700">:=</span>&nbsp;<span class="builtinfunc" id="7208703">new</span><span class="op" id="7208706">(</span><span class="ident" id="7208707"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7208712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208715"><a href="/net/rpc/server_test.go.html#7208621">client</a></span><span class="op" id="7208721">.</span><span class="ident" id="7208722">Call</span><span class="op" id="7208726">(</span><span class="string" id="7208727">&#34;Arith.Add&#34;</span><span class="op" id="7208738">,</span>&nbsp;<span class="ident" id="7208740"><a href="/net/rpc/server_test.go.html#7208673">args</a></span><span class="op" id="7208744">,</span>&nbsp;<span class="ident" id="7208746"><a href="/net/rpc/server_test.go.html#7208694">reply</a></span><span class="op" id="7208751">)</span><br>
<span class="lineno"></span><span class="op" id="7208753">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="keyword" id="7208756">func</span>&nbsp;<span class="ident" id="7208761">dialDirect</span><span class="op" id="7208771">(</span><span class="op" id="7208772">)</span>&nbsp;<span class="op" id="7208774">(</span><span class="op" id="7208775">*</span><span class="ident" id="7208776"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7208782">,</span>&nbsp;<span class="builtintype" id="7208784">error</span><span class="op" id="7208789">)</span>&nbsp;<span class="op" id="7208791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208794">return</span>&nbsp;<span class="ident" id="7208801"><a href="/net/rpc/client.go.html#4998961">Dial</a></span><span class="op" id="7208805">(</span><span class="string" id="7208806">&#34;tcp&#34;</span><span class="op" id="7208811">,</span>&nbsp;<span class="ident" id="7208813"><a href="/net/rpc/server_test.go.html#7197880">serverAddr</a></span><span class="op" id="7208823">)</span><br>
<span class="lineno"></span><span class="op" id="7208825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="7208828">func</span>&nbsp;<span class="ident" id="7208833">dialHTTP</span><span class="op" id="7208841">(</span><span class="op" id="7208842">)</span>&nbsp;<span class="op" id="7208844">(</span><span class="op" id="7208845">*</span><span class="ident" id="7208846"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7208852">,</span>&nbsp;<span class="builtintype" id="7208854">error</span><span class="op" id="7208859">)</span>&nbsp;<span class="op" id="7208861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7208864">return</span>&nbsp;<span class="ident" id="7208871"><a href="/net/rpc/client.go.html#4998014">DialHTTP</a></span><span class="op" id="7208879">(</span><span class="string" id="7208880">&#34;tcp&#34;</span><span class="op" id="7208885">,</span>&nbsp;<span class="ident" id="7208887"><a href="/net/rpc/server_test.go.html#7197914">httpServerAddr</a></span><span class="op" id="7208901">)</span><br>
<span class="lineno"></span><span class="op" id="7208903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7208906">func</span>&nbsp;<span class="ident" id="7208911">countMallocs</span><span class="op" id="7208923">(</span><span class="ident" id="7208924">dial</span>&nbsp;<span class="keyword" id="7208929">func</span><span class="op" id="7208933">(</span><span class="op" id="7208934">)</span>&nbsp;<span class="op" id="7208936">(</span><span class="op" id="7208937">*</span><span class="ident" id="7208938"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7208944">,</span>&nbsp;<span class="builtintype" id="7208946">error</span><span class="op" id="7208951">)</span><span class="op" id="7208952">,</span>&nbsp;<span class="ident" id="7208954">t</span>&nbsp;<span class="op" id="7208956">*</span><span class="ident" id="7208957"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7208964">.</span><span class="ident" id="7208965">T</span><span class="op" id="7208966">)</span>&nbsp;<span class="builtintype" id="7208968">float64</span>&nbsp;<span class="op" id="7208976">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7208979"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7208983">.</span><span class="ident" id="7208984">Do</span><span class="op" id="7208986">(</span><span class="ident" id="7208987"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7208998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209001">client</span><span class="op" id="7209007">,</span>&nbsp;<span class="ident" id="7209009">err</span>&nbsp;<span class="op" id="7209013">:=</span>&nbsp;<span class="ident" id="7209016"><a href="/net/rpc/server_test.go.html#7208924">dial</a></span><span class="op" id="7209020">(</span><span class="op" id="7209021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209024">if</span>&nbsp;<span class="ident" id="7209027"><a href="/net/rpc/server_test.go.html#7209009">err</a></span>&nbsp;<span class="op" id="7209031">!=</span>&nbsp;<span class="ident" id="7209034">nil</span>&nbsp;<span class="op" id="7209038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209042"><a href="/net/rpc/server_test.go.html#7208954">t</a></span><span class="op" id="7209043">.</span><span class="ident" id="7209044">Fatal</span><span class="op" id="7209049">(</span><span class="string" id="7209050">&#34;error&nbsp;dialing&#34;</span><span class="op" id="7209065">,</span>&nbsp;<span class="ident" id="7209067"><a href="/net/rpc/server_test.go.html#7209009">err</a></span><span class="op" id="7209070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209073">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209076">defer</span>&nbsp;<span class="ident" id="7209082"><a href="/net/rpc/server_test.go.html#7209001">client</a></span><span class="op" id="7209088">.</span><span class="ident" id="7209089">Close</span><span class="op" id="7209094">(</span><span class="op" id="7209095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209099">args</span>&nbsp;<span class="op" id="7209104">:=</span>&nbsp;<span class="op" id="7209107">&amp;</span><span class="ident" id="7209108"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7209112">{</span><span class="num" id="7209113">7</span><span class="op" id="7209114">,</span>&nbsp;<span class="num" id="7209116">8</span><span class="op" id="7209117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209120">reply</span>&nbsp;<span class="op" id="7209126">:=</span>&nbsp;<span class="builtinfunc" id="7209129">new</span><span class="op" id="7209132">(</span><span class="ident" id="7209133"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7209138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209141">return</span>&nbsp;<span class="ident" id="7209148"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7209155">.</span><span class="ident" id="7209156">AllocsPerRun</span><span class="op" id="7209168">(</span><span class="num" id="7209169">100</span><span class="op" id="7209172">,</span>&nbsp;<span class="keyword" id="7209174">func</span><span class="op" id="7209178">(</span><span class="op" id="7209179">)</span>&nbsp;<span class="op" id="7209181">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209185">err</span>&nbsp;<span class="op" id="7209189">:=</span>&nbsp;<span class="ident" id="7209192"><a href="/net/rpc/server_test.go.html#7209001">client</a></span><span class="op" id="7209198">.</span><span class="ident" id="7209199">Call</span><span class="op" id="7209203">(</span><span class="string" id="7209204">&#34;Arith.Add&#34;</span><span class="op" id="7209215">,</span>&nbsp;<span class="ident" id="7209217"><a href="/net/rpc/server_test.go.html#7209099">args</a></span><span class="op" id="7209221">,</span>&nbsp;<span class="ident" id="7209223"><a href="/net/rpc/server_test.go.html#7209120">reply</a></span><span class="op" id="7209228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209232">if</span>&nbsp;<span class="ident" id="7209235"><a href="/net/rpc/server_test.go.html#7209185">err</a></span>&nbsp;<span class="op" id="7209239">!=</span>&nbsp;<span class="ident" id="7209242">nil</span>&nbsp;<span class="op" id="7209246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209251"><a href="/net/rpc/server_test.go.html#7208954">t</a></span><span class="op" id="7209252">.</span><span class="ident" id="7209253">Errorf</span><span class="op" id="7209259">(</span><span class="string" id="7209260">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7209302">,</span>&nbsp;<span class="ident" id="7209304"><a href="/net/rpc/server_test.go.html#7209185">err</a></span><span class="op" id="7209307">.</span><span class="ident" id="7209308">Error</span><span class="op" id="7209313">(</span><span class="op" id="7209314">)</span><span class="op" id="7209315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209323">if</span>&nbsp;<span class="ident" id="7209326"><a href="/net/rpc/server_test.go.html#7209120">reply</a></span><span class="op" id="7209331">.</span><span class="ident" id="7209332">C</span>&nbsp;<span class="op" id="7209334">!=</span>&nbsp;<span class="ident" id="7209337"><a href="/net/rpc/server_test.go.html#7209099">args</a></span><span class="op" id="7209341">.</span><span class="ident" id="7209342">A</span><span class="op" id="7209343">+</span><span class="ident" id="7209344"><a href="/net/rpc/server_test.go.html#7209099">args</a></span><span class="op" id="7209348">.</span><span class="ident" id="7209349">B</span>&nbsp;<span class="op" id="7209351">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209356"><a href="/net/rpc/server_test.go.html#7208954">t</a></span><span class="op" id="7209357">.</span><span class="ident" id="7209358">Errorf</span><span class="op" id="7209364">(</span><span class="string" id="7209365">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7209390">,</span>&nbsp;<span class="ident" id="7209392"><a href="/net/rpc/server_test.go.html#7209120">reply</a></span><span class="op" id="7209397">.</span><span class="ident" id="7209398">C</span><span class="op" id="7209399">,</span>&nbsp;<span class="ident" id="7209401"><a href="/net/rpc/server_test.go.html#7209099">args</a></span><span class="op" id="7209405">.</span><span class="ident" id="7209406">A</span><span class="op" id="7209407">+</span><span class="ident" id="7209408"><a href="/net/rpc/server_test.go.html#7209099">args</a></span><span class="op" id="7209412">.</span><span class="ident" id="7209413">B</span><span class="op" id="7209414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209421">}</span><span class="op" id="7209422">)</span><br>
<span class="lineno"></span><span class="op" id="7209424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="7209427">func</span>&nbsp;<span class="ident" id="7209432">TestCountMallocs</span><span class="op" id="7209448">(</span><span class="ident" id="7209449">t</span>&nbsp;<span class="op" id="7209451">*</span><span class="ident" id="7209452"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7209459">.</span><span class="ident" id="7209460">T</span><span class="op" id="7209461">)</span>&nbsp;<span class="op" id="7209463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209466">if</span>&nbsp;<span class="ident" id="7209469"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7209476">.</span><span class="ident" id="7209477">Short</span><span class="op" id="7209482">(</span><span class="op" id="7209483">)</span>&nbsp;<span class="op" id="7209485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209489"><a href="/net/rpc/server_test.go.html#7209449">t</a></span><span class="op" id="7209490">.</span><span class="ident" id="7209491">Skip</span><span class="op" id="7209495">(</span><span class="string" id="7209496">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7209533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209539">if</span>&nbsp;<span class="ident" id="7209542"><a href="/net/rpc/server_test.go.html#7197772">runtime</a></span><span class="op" id="7209549">.</span><span class="ident" id="7209550">GOMAXPROCS</span><span class="op" id="7209560">(</span><span class="num" id="7209561">0</span><span class="op" id="7209562">)</span>&nbsp;<span class="op" id="7209564">&gt;</span>&nbsp;<span class="num" id="7209566">1</span>&nbsp;<span class="op" id="7209568">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209572"><a href="/net/rpc/server_test.go.html#7209449">t</a></span><span class="op" id="7209573">.</span><span class="ident" id="7209574">Skip</span><span class="op" id="7209578">(</span><span class="string" id="7209579">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7209603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209609"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7209612">.</span><span class="ident" id="7209613">Printf</span><span class="op" id="7209619">(</span><span class="string" id="7209620">&#34;mallocs&nbsp;per&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7209654">,</span>&nbsp;<span class="ident" id="7209656"><a href="/net/rpc/server_test.go.html#7208911">countMallocs</a></span><span class="op" id="7209668">(</span><span class="ident" id="7209669"><a href="/net/rpc/server_test.go.html#7208761">dialDirect</a></span><span class="op" id="7209679">,</span>&nbsp;<span class="ident" id="7209681"><a href="/net/rpc/server_test.go.html#7209449">t</a></span><span class="op" id="7209682">)</span><span class="op" id="7209683">)</span><br>
<span class="lineno"></span><span class="op" id="7209685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7209688">func</span>&nbsp;<span class="ident" id="7209693">TestCountMallocsOverHTTP</span><span class="op" id="7209717">(</span><span class="ident" id="7209718">t</span>&nbsp;<span class="op" id="7209720">*</span><span class="ident" id="7209721"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7209728">.</span><span class="ident" id="7209729">T</span><span class="op" id="7209730">)</span>&nbsp;<span class="op" id="7209732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209735">if</span>&nbsp;<span class="ident" id="7209738"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7209745">.</span><span class="ident" id="7209746">Short</span><span class="op" id="7209751">(</span><span class="op" id="7209752">)</span>&nbsp;<span class="op" id="7209754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209758"><a href="/net/rpc/server_test.go.html#7209718">t</a></span><span class="op" id="7209759">.</span><span class="ident" id="7209760">Skip</span><span class="op" id="7209764">(</span><span class="string" id="7209765">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7209802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7209808">if</span>&nbsp;<span class="ident" id="7209811"><a href="/net/rpc/server_test.go.html#7197772">runtime</a></span><span class="op" id="7209818">.</span><span class="ident" id="7209819">GOMAXPROCS</span><span class="op" id="7209829">(</span><span class="num" id="7209830">0</span><span class="op" id="7209831">)</span>&nbsp;<span class="op" id="7209833">&gt;</span>&nbsp;<span class="num" id="7209835">1</span>&nbsp;<span class="op" id="7209837">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209841"><a href="/net/rpc/server_test.go.html#7209718">t</a></span><span class="op" id="7209842">.</span><span class="ident" id="7209843">Skip</span><span class="op" id="7209847">(</span><span class="string" id="7209848">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7209872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7209875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209878"><a href="/net/rpc/server_test.go.html#7197724">fmt</a></span><span class="op" id="7209881">.</span><span class="ident" id="7209882">Printf</span><span class="op" id="7209888">(</span><span class="string" id="7209889">&#34;mallocs&nbsp;per&nbsp;HTTP&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7209928">,</span>&nbsp;<span class="ident" id="7209930"><a href="/net/rpc/server_test.go.html#7208911">countMallocs</a></span><span class="op" id="7209942">(</span><span class="ident" id="7209943"><a href="/net/rpc/server_test.go.html#7208833">dialHTTP</a></span><span class="op" id="7209951">,</span>&nbsp;<span class="ident" id="7209953"><a href="/net/rpc/server_test.go.html#7209718">t</a></span><span class="op" id="7209954">)</span><span class="op" id="7209955">)</span><br>
<span class="lineno"></span><span class="op" id="7209957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="7209960">type</span>&nbsp;<span class="ident" id="7209965">writeCrasher</span>&nbsp;<span class="keyword" id="7209978">struct</span>&nbsp;<span class="op" id="7209985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7209988">done</span>&nbsp;<span class="keyword" id="7209993">chan</span>&nbsp;<span class="builtintype" id="7209998">bool</span><br>
<span class="lineno"></span><span class="op" id="7210003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7210006">func</span>&nbsp;<span class="op" id="7210011">(</span><span class="ident" id="7210012"><a href="/net/rpc/server_test.go.html#7209965">writeCrasher</a></span><span class="op" id="7210024">)</span>&nbsp;<span class="ident" id="7210026">Close</span><span class="op" id="7210031">(</span><span class="op" id="7210032">)</span>&nbsp;<span class="builtintype" id="7210034">error</span>&nbsp;<span class="op" id="7210040">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210043">return</span>&nbsp;<span class="ident" id="7210050">nil</span><br>
<span class="lineno"></span><span class="op" id="7210054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7210057">func</span>&nbsp;<span class="op" id="7210062">(</span><span class="ident" id="7210063">w</span>&nbsp;<span class="op" id="7210065">*</span><span class="ident" id="7210066"><a href="/net/rpc/server_test.go.html#7209965">writeCrasher</a></span><span class="op" id="7210078">)</span>&nbsp;<span class="ident" id="7210080">Read</span><span class="op" id="7210084">(</span><span class="ident" id="7210085">p</span>&nbsp;<span class="op" id="7210087">[</span><span class="op" id="7210088">]</span><span class="builtintype" id="7210089">byte</span><span class="op" id="7210093">)</span>&nbsp;<span class="op" id="7210095">(</span><span class="builtintype" id="7210096">int</span><span class="op" id="7210099">,</span>&nbsp;<span class="builtintype" id="7210101">error</span><span class="op" id="7210106">)</span>&nbsp;<span class="op" id="7210108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7210111">&lt;-</span><span class="ident" id="7210113"><a href="/net/rpc/server_test.go.html#7210063">w</a></span><span class="op" id="7210114">.</span><span class="ident" id="7210115">done</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210121">return</span>&nbsp;<span class="num" id="7210128">0</span><span class="op" id="7210129">,</span>&nbsp;<span class="ident" id="7210131"><a href="/net/rpc/server_test.go.html#7197731">io</a></span><span class="op" id="7210133">.</span><span class="ident" id="7210134">EOF</span><br>
<span class="lineno"></span><span class="op" id="7210138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7210141">func</span>&nbsp;<span class="op" id="7210146">(</span><span class="ident" id="7210147"><a href="/net/rpc/server_test.go.html#7209965">writeCrasher</a></span><span class="op" id="7210159">)</span>&nbsp;<span class="ident" id="7210161">Write</span><span class="op" id="7210166">(</span><span class="ident" id="7210167">p</span>&nbsp;<span class="op" id="7210169">[</span><span class="op" id="7210170">]</span><span class="builtintype" id="7210171">byte</span><span class="op" id="7210175">)</span>&nbsp;<span class="op" id="7210177">(</span><span class="builtintype" id="7210178">int</span><span class="op" id="7210181">,</span>&nbsp;<span class="builtintype" id="7210183">error</span><span class="op" id="7210188">)</span>&nbsp;<span class="op" id="7210190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210193">return</span>&nbsp;<span class="num" id="7210200">0</span><span class="op" id="7210201">,</span>&nbsp;<span class="ident" id="7210203"><a href="/net/rpc/server_test.go.html#7197714">errors</a></span><span class="op" id="7210209">.</span><span class="ident" id="7210210">New</span><span class="op" id="7210213">(</span><span class="string" id="7210214">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7210234">)</span><br>
<span class="lineno">540</span><span class="op" id="7210236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7210239">func</span>&nbsp;<span class="ident" id="7210244">TestClientWriteError</span><span class="op" id="7210264">(</span><span class="ident" id="7210265">t</span>&nbsp;<span class="op" id="7210267">*</span><span class="ident" id="7210268"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7210275">.</span><span class="ident" id="7210276">T</span><span class="op" id="7210277">)</span>&nbsp;<span class="op" id="7210279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210282">w</span>&nbsp;<span class="op" id="7210284">:=</span>&nbsp;<span class="op" id="7210287">&amp;</span><span class="ident" id="7210288"><a href="/net/rpc/server_test.go.html#7209965">writeCrasher</a></span><span class="op" id="7210300">{</span><span class="ident" id="7210301">done</span><span class="op" id="7210305">:</span>&nbsp;<span class="builtinfunc" id="7210307">make</span><span class="op" id="7210311">(</span><span class="keyword" id="7210312">chan</span>&nbsp;<span class="builtintype" id="7210317">bool</span><span class="op" id="7210321">)</span><span class="op" id="7210322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210325">c</span>&nbsp;<span class="op" id="7210327">:=</span>&nbsp;<span class="ident" id="7210330"><a href="/net/rpc/client.go.html#4996812">NewClient</a></span><span class="op" id="7210339">(</span><span class="ident" id="7210340"><a href="/net/rpc/server_test.go.html#7210282">w</a></span><span class="op" id="7210341">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210344">defer</span>&nbsp;<span class="ident" id="7210350"><a href="/net/rpc/server_test.go.html#7210325">c</a></span><span class="op" id="7210351">.</span><span class="ident" id="7210352">Close</span><span class="op" id="7210357">(</span><span class="op" id="7210358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210362">res</span>&nbsp;<span class="op" id="7210366">:=</span>&nbsp;<span class="ident" id="7210369">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210376">err</span>&nbsp;<span class="op" id="7210380">:=</span>&nbsp;<span class="ident" id="7210383"><a href="/net/rpc/server_test.go.html#7210325">c</a></span><span class="op" id="7210384">.</span><span class="ident" id="7210385">Call</span><span class="op" id="7210389">(</span><span class="string" id="7210390">&#34;foo&#34;</span><span class="op" id="7210395">,</span>&nbsp;<span class="num" id="7210397">1</span><span class="op" id="7210398">,</span>&nbsp;<span class="op" id="7210400">&amp;</span><span class="ident" id="7210401"><a href="/net/rpc/server_test.go.html#7210362">res</a></span><span class="op" id="7210404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210407">if</span>&nbsp;<span class="ident" id="7210410"><a href="/net/rpc/server_test.go.html#7210376">err</a></span>&nbsp;<span class="op" id="7210414">==</span>&nbsp;<span class="ident" id="7210417">nil</span>&nbsp;<span class="op" id="7210421">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210425"><a href="/net/rpc/server_test.go.html#7210265">t</a></span><span class="op" id="7210426">.</span><span class="ident" id="7210427">Fatal</span><span class="op" id="7210432">(</span><span class="string" id="7210433">&#34;expected&nbsp;error&#34;</span><span class="op" id="7210449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7210452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210455">if</span>&nbsp;<span class="ident" id="7210458"><a href="/net/rpc/server_test.go.html#7210376">err</a></span><span class="op" id="7210461">.</span><span class="ident" id="7210462">Error</span><span class="op" id="7210467">(</span><span class="op" id="7210468">)</span>&nbsp;<span class="op" id="7210470">!=</span>&nbsp;<span class="string" id="7210473">&#34;fake&nbsp;write&nbsp;failure&#34;</span>&nbsp;<span class="op" id="7210494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210498"><a href="/net/rpc/server_test.go.html#7210265">t</a></span><span class="op" id="7210499">.</span><span class="ident" id="7210500">Error</span><span class="op" id="7210505">(</span><span class="string" id="7210506">&#34;unexpected&nbsp;value&nbsp;of&nbsp;error:&#34;</span><span class="op" id="7210534">,</span>&nbsp;<span class="ident" id="7210536"><a href="/net/rpc/server_test.go.html#7210376">err</a></span><span class="op" id="7210539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7210542">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210545"><a href="/net/rpc/server_test.go.html#7210282">w</a></span><span class="op" id="7210546">.</span><span class="ident" id="7210547">done</span>&nbsp;<span class="op" id="7210552">&lt;-</span>&nbsp;<span class="ident" id="7210555">true</span><br>
<span class="lineno"></span><span class="op" id="7210560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7210563">func</span>&nbsp;<span class="ident" id="7210568">TestTCPClose</span><span class="op" id="7210580">(</span><span class="ident" id="7210581">t</span>&nbsp;<span class="op" id="7210583">*</span><span class="ident" id="7210584"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7210591">.</span><span class="ident" id="7210592">T</span><span class="op" id="7210593">)</span>&nbsp;<span class="op" id="7210595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210598"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7210602">.</span><span class="ident" id="7210603">Do</span><span class="op" id="7210605">(</span><span class="ident" id="7210606"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7210617">)</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210621">client</span><span class="op" id="7210627">,</span>&nbsp;<span class="ident" id="7210629">err</span>&nbsp;<span class="op" id="7210633">:=</span>&nbsp;<span class="ident" id="7210636"><a href="/net/rpc/server_test.go.html#7208833">dialHTTP</a></span><span class="op" id="7210644">(</span><span class="op" id="7210645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210648">if</span>&nbsp;<span class="ident" id="7210651"><a href="/net/rpc/server_test.go.html#7210629">err</a></span>&nbsp;<span class="op" id="7210655">!=</span>&nbsp;<span class="ident" id="7210658">nil</span>&nbsp;<span class="op" id="7210662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210666"><a href="/net/rpc/server_test.go.html#7210581">t</a></span><span class="op" id="7210667">.</span><span class="ident" id="7210668">Fatalf</span><span class="op" id="7210674">(</span><span class="string" id="7210675">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7210688">,</span>&nbsp;<span class="ident" id="7210690"><a href="/net/rpc/server_test.go.html#7210629">err</a></span><span class="op" id="7210693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7210696">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210699">defer</span>&nbsp;<span class="ident" id="7210705"><a href="/net/rpc/server_test.go.html#7210621">client</a></span><span class="op" id="7210711">.</span><span class="ident" id="7210712">Close</span><span class="op" id="7210717">(</span><span class="op" id="7210718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210722">args</span>&nbsp;<span class="op" id="7210727">:=</span>&nbsp;<span class="ident" id="7210730"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7210734">{</span><span class="num" id="7210735">17</span><span class="op" id="7210737">,</span>&nbsp;<span class="num" id="7210739">8</span><span class="op" id="7210740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210743">var</span>&nbsp;<span class="ident" id="7210747">reply</span>&nbsp;<span class="ident" id="7210753"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210760"><a href="/net/rpc/server_test.go.html#7210629">err</a></span>&nbsp;<span class="op" id="7210764">=</span>&nbsp;<span class="ident" id="7210766"><a href="/net/rpc/server_test.go.html#7210621">client</a></span><span class="op" id="7210772">.</span><span class="ident" id="7210773">Call</span><span class="op" id="7210777">(</span><span class="string" id="7210778">&#34;Arith.Mul&#34;</span><span class="op" id="7210789">,</span>&nbsp;<span class="ident" id="7210791"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210795">,</span>&nbsp;<span class="op" id="7210797">&amp;</span><span class="ident" id="7210798"><a href="/net/rpc/server_test.go.html#7210747">reply</a></span><span class="op" id="7210803">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210806">if</span>&nbsp;<span class="ident" id="7210809"><a href="/net/rpc/server_test.go.html#7210629">err</a></span>&nbsp;<span class="op" id="7210813">!=</span>&nbsp;<span class="ident" id="7210816">nil</span>&nbsp;<span class="op" id="7210820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210824"><a href="/net/rpc/server_test.go.html#7210581">t</a></span><span class="op" id="7210825">.</span><span class="ident" id="7210826">Fatal</span><span class="op" id="7210831">(</span><span class="string" id="7210832">&#34;arith&nbsp;error:&#34;</span><span class="op" id="7210846">,</span>&nbsp;<span class="ident" id="7210848"><a href="/net/rpc/server_test.go.html#7210629">err</a></span><span class="op" id="7210851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7210854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210857"><a href="/net/rpc/server_test.go.html#7210581">t</a></span><span class="op" id="7210858">.</span><span class="ident" id="7210859">Logf</span><span class="op" id="7210863">(</span><span class="string" id="7210864">&#34;Arith:&nbsp;%d*%d=%d\n&#34;</span><span class="op" id="7210883">,</span>&nbsp;<span class="ident" id="7210885"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210889">.</span><span class="ident" id="7210890">A</span><span class="op" id="7210891">,</span>&nbsp;<span class="ident" id="7210893"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210897">.</span><span class="ident" id="7210898">B</span><span class="op" id="7210899">,</span>&nbsp;<span class="ident" id="7210901"><a href="/net/rpc/server_test.go.html#7210747">reply</a></span><span class="op" id="7210906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7210909">if</span>&nbsp;<span class="ident" id="7210912"><a href="/net/rpc/server_test.go.html#7210747">reply</a></span><span class="op" id="7210917">.</span><span class="ident" id="7210918">C</span>&nbsp;<span class="op" id="7210920">!=</span>&nbsp;<span class="ident" id="7210923"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210927">.</span><span class="ident" id="7210928">A</span><span class="op" id="7210929">*</span><span class="ident" id="7210930"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210934">.</span><span class="ident" id="7210935">B</span>&nbsp;<span class="op" id="7210937">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7210941"><a href="/net/rpc/server_test.go.html#7210581">t</a></span><span class="op" id="7210942">.</span><span class="ident" id="7210943">Errorf</span><span class="op" id="7210949">(</span><span class="string" id="7210950">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7210975">,</span>&nbsp;<span class="ident" id="7210977"><a href="/net/rpc/server_test.go.html#7210747">reply</a></span><span class="op" id="7210982">.</span><span class="ident" id="7210983">C</span><span class="op" id="7210984">,</span>&nbsp;<span class="ident" id="7210986"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210990">.</span><span class="ident" id="7210991">A</span><span class="op" id="7210992">*</span><span class="ident" id="7210993"><a href="/net/rpc/server_test.go.html#7210722">args</a></span><span class="op" id="7210997">.</span><span class="ident" id="7210998">B</span><span class="op" id="7210999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211002">}</span><br>
<span class="lineno"></span><span class="op" id="7211004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7211007">func</span>&nbsp;<span class="ident" id="7211012">TestErrorAfterClientClose</span><span class="op" id="7211037">(</span><span class="ident" id="7211038">t</span>&nbsp;<span class="op" id="7211040">*</span><span class="ident" id="7211041"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7211048">.</span><span class="ident" id="7211049">T</span><span class="op" id="7211050">)</span>&nbsp;<span class="op" id="7211052">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211055"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7211059">.</span><span class="ident" id="7211060">Do</span><span class="op" id="7211062">(</span><span class="ident" id="7211063"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7211074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211078">client</span><span class="op" id="7211084">,</span>&nbsp;<span class="ident" id="7211086">err</span>&nbsp;<span class="op" id="7211090">:=</span>&nbsp;<span class="ident" id="7211093"><a href="/net/rpc/server_test.go.html#7208833">dialHTTP</a></span><span class="op" id="7211101">(</span><span class="op" id="7211102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211105">if</span>&nbsp;<span class="ident" id="7211108"><a href="/net/rpc/server_test.go.html#7211086">err</a></span>&nbsp;<span class="op" id="7211112">!=</span>&nbsp;<span class="ident" id="7211115">nil</span>&nbsp;<span class="op" id="7211119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211123"><a href="/net/rpc/server_test.go.html#7211038">t</a></span><span class="op" id="7211124">.</span><span class="ident" id="7211125">Fatalf</span><span class="op" id="7211131">(</span><span class="string" id="7211132">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7211145">,</span>&nbsp;<span class="ident" id="7211147"><a href="/net/rpc/server_test.go.html#7211086">err</a></span><span class="op" id="7211150">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211156"><a href="/net/rpc/server_test.go.html#7211086">err</a></span>&nbsp;<span class="op" id="7211160">=</span>&nbsp;<span class="ident" id="7211162"><a href="/net/rpc/server_test.go.html#7211078">client</a></span><span class="op" id="7211168">.</span><span class="ident" id="7211169">Close</span><span class="op" id="7211174">(</span><span class="op" id="7211175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211178">if</span>&nbsp;<span class="ident" id="7211181"><a href="/net/rpc/server_test.go.html#7211086">err</a></span>&nbsp;<span class="op" id="7211185">!=</span>&nbsp;<span class="ident" id="7211188">nil</span>&nbsp;<span class="op" id="7211192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211196"><a href="/net/rpc/server_test.go.html#7211038">t</a></span><span class="op" id="7211197">.</span><span class="ident" id="7211198">Fatal</span><span class="op" id="7211203">(</span><span class="string" id="7211204">&#34;close&nbsp;error:&#34;</span><span class="op" id="7211218">,</span>&nbsp;<span class="ident" id="7211220"><a href="/net/rpc/server_test.go.html#7211086">err</a></span><span class="op" id="7211223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211226">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211229"><a href="/net/rpc/server_test.go.html#7211086">err</a></span>&nbsp;<span class="op" id="7211233">=</span>&nbsp;<span class="ident" id="7211235"><a href="/net/rpc/server_test.go.html#7211078">client</a></span><span class="op" id="7211241">.</span><span class="ident" id="7211242">Call</span><span class="op" id="7211246">(</span><span class="string" id="7211247">&#34;Arith.Add&#34;</span><span class="op" id="7211258">,</span>&nbsp;<span class="op" id="7211260">&amp;</span><span class="ident" id="7211261"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7211265">{</span><span class="num" id="7211266">7</span><span class="op" id="7211267">,</span>&nbsp;<span class="num" id="7211269">9</span><span class="op" id="7211270">}</span><span class="op" id="7211271">,</span>&nbsp;<span class="builtinfunc" id="7211273">new</span><span class="op" id="7211276">(</span><span class="ident" id="7211277"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7211282">)</span><span class="op" id="7211283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211286">if</span>&nbsp;<span class="ident" id="7211289"><a href="/net/rpc/server_test.go.html#7211086">err</a></span>&nbsp;<span class="op" id="7211293">!=</span>&nbsp;<span class="ident" id="7211296"><a href="/net/rpc/client.go.html#4992187">ErrShutdown</a></span>&nbsp;<span class="op" id="7211308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211312"><a href="/net/rpc/server_test.go.html#7211038">t</a></span><span class="op" id="7211313">.</span><span class="ident" id="7211314">Errorf</span><span class="op" id="7211320">(</span><span class="string" id="7211321">&#34;Forever:&nbsp;expected&nbsp;ErrShutdown&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7211359">,</span>&nbsp;<span class="ident" id="7211361"><a href="/net/rpc/server_test.go.html#7211086">err</a></span><span class="op" id="7211364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211367">}</span><br>
<span class="lineno"></span><span class="op" id="7211369">}</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="keyword" id="7211372">func</span>&nbsp;<span class="ident" id="7211377">benchmarkEndToEnd</span><span class="op" id="7211394">(</span><span class="ident" id="7211395">dial</span>&nbsp;<span class="keyword" id="7211400">func</span><span class="op" id="7211404">(</span><span class="op" id="7211405">)</span>&nbsp;<span class="op" id="7211407">(</span><span class="op" id="7211408">*</span><span class="ident" id="7211409"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7211415">,</span>&nbsp;<span class="builtintype" id="7211417">error</span><span class="op" id="7211422">)</span><span class="op" id="7211423">,</span>&nbsp;<span class="ident" id="7211425">b</span>&nbsp;<span class="op" id="7211427">*</span><span class="ident" id="7211428"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7211435">.</span><span class="ident" id="7211436">B</span><span class="op" id="7211437">)</span>&nbsp;<span class="op" id="7211439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211442"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7211446">.</span><span class="ident" id="7211447">Do</span><span class="op" id="7211449">(</span><span class="ident" id="7211450"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7211461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211464">client</span><span class="op" id="7211470">,</span>&nbsp;<span class="ident" id="7211472">err</span>&nbsp;<span class="op" id="7211476">:=</span>&nbsp;<span class="ident" id="7211479"><a href="/net/rpc/server_test.go.html#7211395">dial</a></span><span class="op" id="7211483">(</span><span class="op" id="7211484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211487">if</span>&nbsp;<span class="ident" id="7211490"><a href="/net/rpc/server_test.go.html#7211472">err</a></span>&nbsp;<span class="op" id="7211494">!=</span>&nbsp;<span class="ident" id="7211497">nil</span>&nbsp;<span class="op" id="7211501">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211505"><a href="/net/rpc/server_test.go.html#7211425">b</a></span><span class="op" id="7211506">.</span><span class="ident" id="7211507">Fatal</span><span class="op" id="7211512">(</span><span class="string" id="7211513">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7211529">,</span>&nbsp;<span class="ident" id="7211531"><a href="/net/rpc/server_test.go.html#7211472">err</a></span><span class="op" id="7211534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211540">defer</span>&nbsp;<span class="ident" id="7211546"><a href="/net/rpc/server_test.go.html#7211464">client</a></span><span class="op" id="7211552">.</span><span class="ident" id="7211553">Close</span><span class="op" id="7211558">(</span><span class="op" id="7211559">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7211563">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211585">args</span>&nbsp;<span class="op" id="7211590">:=</span>&nbsp;<span class="op" id="7211593">&amp;</span><span class="ident" id="7211594"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7211598">{</span><span class="num" id="7211599">7</span><span class="op" id="7211600">,</span>&nbsp;<span class="num" id="7211602">8</span><span class="op" id="7211603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211606"><a href="/net/rpc/server_test.go.html#7211425">b</a></span><span class="op" id="7211607">.</span><span class="ident" id="7211608">ResetTimer</span><span class="op" id="7211618">(</span><span class="op" id="7211619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211623"><a href="/net/rpc/server_test.go.html#7211425">b</a></span><span class="op" id="7211624">.</span><span class="ident" id="7211625">RunParallel</span><span class="op" id="7211636">(</span><span class="keyword" id="7211637">func</span><span class="op" id="7211641">(</span><span class="ident" id="7211642">pb</span>&nbsp;<span class="op" id="7211645">*</span><span class="ident" id="7211646"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7211653">.</span><span class="ident" id="7211654">PB</span><span class="op" id="7211656">)</span>&nbsp;<span class="op" id="7211658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211662">reply</span>&nbsp;<span class="op" id="7211668">:=</span>&nbsp;<span class="builtinfunc" id="7211671">new</span><span class="op" id="7211674">(</span><span class="ident" id="7211675"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7211680">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211684">for</span>&nbsp;<span class="ident" id="7211688"><a href="/net/rpc/server_test.go.html#7211642">pb</a></span><span class="op" id="7211690">.</span><span class="ident" id="7211691">Next</span><span class="op" id="7211695">(</span><span class="op" id="7211696">)</span>&nbsp;<span class="op" id="7211698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211703">err</span>&nbsp;<span class="op" id="7211707">:=</span>&nbsp;<span class="ident" id="7211710"><a href="/net/rpc/server_test.go.html#7211464">client</a></span><span class="op" id="7211716">.</span><span class="ident" id="7211717">Call</span><span class="op" id="7211721">(</span><span class="string" id="7211722">&#34;Arith.Add&#34;</span><span class="op" id="7211733">,</span>&nbsp;<span class="ident" id="7211735"><a href="/net/rpc/server_test.go.html#7211585">args</a></span><span class="op" id="7211739">,</span>&nbsp;<span class="ident" id="7211741"><a href="/net/rpc/server_test.go.html#7211662">reply</a></span><span class="op" id="7211746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211751">if</span>&nbsp;<span class="ident" id="7211754"><a href="/net/rpc/server_test.go.html#7211703">err</a></span>&nbsp;<span class="op" id="7211758">!=</span>&nbsp;<span class="ident" id="7211761">nil</span>&nbsp;<span class="op" id="7211765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211771"><a href="/net/rpc/server_test.go.html#7211425">b</a></span><span class="op" id="7211772">.</span><span class="ident" id="7211773">Fatalf</span><span class="op" id="7211779">(</span><span class="string" id="7211780">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7211833">,</span>&nbsp;<span class="ident" id="7211835"><a href="/net/rpc/server_test.go.html#7211703">err</a></span><span class="op" id="7211838">.</span><span class="ident" id="7211839">Error</span><span class="op" id="7211844">(</span><span class="op" id="7211845">)</span><span class="op" id="7211846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211851">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7211856">if</span>&nbsp;<span class="ident" id="7211859"><a href="/net/rpc/server_test.go.html#7211662">reply</a></span><span class="op" id="7211864">.</span><span class="ident" id="7211865">C</span>&nbsp;<span class="op" id="7211867">!=</span>&nbsp;<span class="ident" id="7211870"><a href="/net/rpc/server_test.go.html#7211585">args</a></span><span class="op" id="7211874">.</span><span class="ident" id="7211875">A</span><span class="op" id="7211876">+</span><span class="ident" id="7211877"><a href="/net/rpc/server_test.go.html#7211585">args</a></span><span class="op" id="7211881">.</span><span class="ident" id="7211882">B</span>&nbsp;<span class="op" id="7211884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7211890"><a href="/net/rpc/server_test.go.html#7211425">b</a></span><span class="op" id="7211891">.</span><span class="ident" id="7211892">Fatalf</span><span class="op" id="7211898">(</span><span class="string" id="7211899">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7211935">,</span>&nbsp;<span class="ident" id="7211937"><a href="/net/rpc/server_test.go.html#7211662">reply</a></span><span class="op" id="7211942">.</span><span class="ident" id="7211943">C</span><span class="op" id="7211944">,</span>&nbsp;<span class="ident" id="7211946"><a href="/net/rpc/server_test.go.html#7211585">args</a></span><span class="op" id="7211950">.</span><span class="ident" id="7211951">A</span><span class="op" id="7211952">+</span><span class="ident" id="7211953"><a href="/net/rpc/server_test.go.html#7211585">args</a></span><span class="op" id="7211957">.</span><span class="ident" id="7211958">B</span><span class="op" id="7211959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7211971">}</span><span class="op" id="7211972">)</span><br>
<span class="lineno">620</span><span class="op" id="7211974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7211977">func</span>&nbsp;<span class="ident" id="7211982">benchmarkEndToEndAsync</span><span class="op" id="7212004">(</span><span class="ident" id="7212005">dial</span>&nbsp;<span class="keyword" id="7212010">func</span><span class="op" id="7212014">(</span><span class="op" id="7212015">)</span>&nbsp;<span class="op" id="7212017">(</span><span class="op" id="7212018">*</span><span class="ident" id="7212019"><a href="/net/rpc/client.go.html#4992823">Client</a></span><span class="op" id="7212025">,</span>&nbsp;<span class="builtintype" id="7212027">error</span><span class="op" id="7212032">)</span><span class="op" id="7212033">,</span>&nbsp;<span class="ident" id="7212035">b</span>&nbsp;<span class="op" id="7212037">*</span><span class="ident" id="7212038"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7212045">.</span><span class="ident" id="7212046">B</span><span class="op" id="7212047">)</span>&nbsp;<span class="op" id="7212049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212052">const</span>&nbsp;<span class="ident" id="7212058">MaxConcurrentCalls</span>&nbsp;<span class="op" id="7212077">=</span>&nbsp;<span class="num" id="7212079">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212084"><a href="/net/rpc/server_test.go.html#7197948">once</a></span><span class="op" id="7212088">.</span><span class="ident" id="7212089">Do</span><span class="op" id="7212091">(</span><span class="ident" id="7212092"><a href="/net/rpc/server_test.go.html#7199058">startServer</a></span><span class="op" id="7212103">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212106">client</span><span class="op" id="7212112">,</span>&nbsp;<span class="ident" id="7212114">err</span>&nbsp;<span class="op" id="7212118">:=</span>&nbsp;<span class="ident" id="7212121"><a href="/net/rpc/server_test.go.html#7212005">dial</a></span><span class="op" id="7212125">(</span><span class="op" id="7212126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212129">if</span>&nbsp;<span class="ident" id="7212132"><a href="/net/rpc/server_test.go.html#7212114">err</a></span>&nbsp;<span class="op" id="7212136">!=</span>&nbsp;<span class="ident" id="7212139">nil</span>&nbsp;<span class="op" id="7212143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212147"><a href="/net/rpc/server_test.go.html#7212035">b</a></span><span class="op" id="7212148">.</span><span class="ident" id="7212149">Fatal</span><span class="op" id="7212154">(</span><span class="string" id="7212155">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7212171">,</span>&nbsp;<span class="ident" id="7212173"><a href="/net/rpc/server_test.go.html#7212114">err</a></span><span class="op" id="7212176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212182">defer</span>&nbsp;<span class="ident" id="7212188"><a href="/net/rpc/server_test.go.html#7212106">client</a></span><span class="op" id="7212194">.</span><span class="ident" id="7212195">Close</span><span class="op" id="7212200">(</span><span class="op" id="7212201">)</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7212205">//&nbsp;Asynchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212228">args</span>&nbsp;<span class="op" id="7212233">:=</span>&nbsp;<span class="op" id="7212236">&amp;</span><span class="ident" id="7212237"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7212241">{</span><span class="num" id="7212242">7</span><span class="op" id="7212243">,</span>&nbsp;<span class="num" id="7212245">8</span><span class="op" id="7212246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212249">procs</span>&nbsp;<span class="op" id="7212255">:=</span>&nbsp;<span class="num" id="7212258">4</span>&nbsp;<span class="op" id="7212260">*</span>&nbsp;<span class="ident" id="7212262"><a href="/net/rpc/server_test.go.html#7197772">runtime</a></span><span class="op" id="7212269">.</span><span class="ident" id="7212270">GOMAXPROCS</span><span class="op" id="7212280">(</span><span class="op" id="7212281">-</span><span class="num" id="7212282">1</span><span class="op" id="7212283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212286">send</span>&nbsp;<span class="op" id="7212291">:=</span>&nbsp;<span class="builtintype" id="7212294">int32</span><span class="op" id="7212299">(</span><span class="ident" id="7212300"><a href="/net/rpc/server_test.go.html#7212035">b</a></span><span class="op" id="7212301">.</span><span class="ident" id="7212302">N</span><span class="op" id="7212303">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212306">recv</span>&nbsp;<span class="op" id="7212311">:=</span>&nbsp;<span class="builtintype" id="7212314">int32</span><span class="op" id="7212319">(</span><span class="ident" id="7212320"><a href="/net/rpc/server_test.go.html#7212035">b</a></span><span class="op" id="7212321">.</span><span class="ident" id="7212322">N</span><span class="op" id="7212323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212326">var</span>&nbsp;<span class="ident" id="7212330">wg</span>&nbsp;<span class="ident" id="7212333"><a href="/net/rpc/server_test.go.html#7197794">sync</a></span><span class="op" id="7212337">.</span><span class="ident" id="7212338">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212349"><a href="/net/rpc/server_test.go.html#7212330">wg</a></span><span class="op" id="7212351">.</span><span class="ident" id="7212352">Add</span><span class="op" id="7212355">(</span><span class="ident" id="7212356"><a href="/net/rpc/server_test.go.html#7212249">procs</a></span><span class="op" id="7212361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212364">gate</span>&nbsp;<span class="op" id="7212369">:=</span>&nbsp;<span class="builtinfunc" id="7212372">make</span><span class="op" id="7212376">(</span><span class="keyword" id="7212377">chan</span>&nbsp;<span class="builtintype" id="7212382">bool</span><span class="op" id="7212386">,</span>&nbsp;<span class="ident" id="7212388"><a href="/net/rpc/server_test.go.html#7212058">MaxConcurrentCalls</a></span><span class="op" id="7212406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212409">res</span>&nbsp;<span class="op" id="7212413">:=</span>&nbsp;<span class="builtinfunc" id="7212416">make</span><span class="op" id="7212420">(</span><span class="keyword" id="7212421">chan</span>&nbsp;<span class="op" id="7212426">*</span><span class="ident" id="7212427"><a href="/net/rpc/client.go.html#4992279">Call</a></span><span class="op" id="7212431">,</span>&nbsp;<span class="ident" id="7212433"><a href="/net/rpc/server_test.go.html#7212058">MaxConcurrentCalls</a></span><span class="op" id="7212451">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212454"><a href="/net/rpc/server_test.go.html#7212035">b</a></span><span class="op" id="7212455">.</span><span class="ident" id="7212456">ResetTimer</span><span class="op" id="7212466">(</span><span class="op" id="7212467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212471">for</span>&nbsp;<span class="ident" id="7212475">p</span>&nbsp;<span class="op" id="7212477">:=</span>&nbsp;<span class="num" id="7212480">0</span><span class="op" id="7212481">;</span>&nbsp;<span class="ident" id="7212483"><a href="/net/rpc/server_test.go.html#7212475">p</a></span>&nbsp;<span class="op" id="7212485">&lt;</span>&nbsp;<span class="ident" id="7212487"><a href="/net/rpc/server_test.go.html#7212249">procs</a></span><span class="op" id="7212492">;</span>&nbsp;<span class="ident" id="7212494"><a href="/net/rpc/server_test.go.html#7212475">p</a></span><span class="op" id="7212495">++</span>&nbsp;<span class="op" id="7212498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212502">go</span>&nbsp;<span class="keyword" id="7212505">func</span><span class="op" id="7212509">(</span><span class="op" id="7212510">)</span>&nbsp;<span class="op" id="7212512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212517">for</span>&nbsp;<span class="ident" id="7212521"><a href="/net/rpc/server_test.go.html#7197802">atomic</a></span><span class="op" id="7212527">.</span><span class="ident" id="7212528">AddInt32</span><span class="op" id="7212536">(</span><span class="op" id="7212537">&amp;</span><span class="ident" id="7212538"><a href="/net/rpc/server_test.go.html#7212286">send</a></span><span class="op" id="7212542">,</span>&nbsp;<span class="op" id="7212544">-</span><span class="num" id="7212545">1</span><span class="op" id="7212546">)</span>&nbsp;<span class="op" id="7212548">&gt;=</span>&nbsp;<span class="num" id="7212551">0</span>&nbsp;<span class="op" id="7212553">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212559"><a href="/net/rpc/server_test.go.html#7212364">gate</a></span>&nbsp;<span class="op" id="7212564">&lt;-</span>&nbsp;<span class="ident" id="7212567">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212576">reply</span>&nbsp;<span class="op" id="7212582">:=</span>&nbsp;<span class="builtinfunc" id="7212585">new</span><span class="op" id="7212588">(</span><span class="ident" id="7212589"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7212594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212600"><a href="/net/rpc/server_test.go.html#7212106">client</a></span><span class="op" id="7212606">.</span><span class="ident" id="7212607">Go</span><span class="op" id="7212609">(</span><span class="string" id="7212610">&#34;Arith.Add&#34;</span><span class="op" id="7212621">,</span>&nbsp;<span class="ident" id="7212623"><a href="/net/rpc/server_test.go.html#7212228">args</a></span><span class="op" id="7212627">,</span>&nbsp;<span class="ident" id="7212629"><a href="/net/rpc/server_test.go.html#7212576">reply</a></span><span class="op" id="7212634">,</span>&nbsp;<span class="ident" id="7212636"><a href="/net/rpc/server_test.go.html#7212409">res</a></span><span class="op" id="7212639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212648">}</span><span class="op" id="7212649">(</span><span class="op" id="7212650">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212654">go</span>&nbsp;<span class="keyword" id="7212657">func</span><span class="op" id="7212661">(</span><span class="op" id="7212662">)</span>&nbsp;<span class="op" id="7212664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212669">for</span>&nbsp;<span class="ident" id="7212673">call</span>&nbsp;<span class="op" id="7212678">:=</span>&nbsp;<span class="keyword" id="7212681">range</span>&nbsp;<span class="ident" id="7212687"><a href="/net/rpc/server_test.go.html#7212409">res</a></span>&nbsp;<span class="op" id="7212691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212697">A</span>&nbsp;<span class="op" id="7212699">:=</span>&nbsp;<span class="ident" id="7212702"><a href="/net/rpc/server_test.go.html#7212673">call</a></span><span class="op" id="7212706">.</span><span class="ident" id="7212707">Args</span><span class="op" id="7212711">.</span><span class="op" id="7212712">(</span><span class="op" id="7212713">*</span><span class="ident" id="7212714"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7212718">)</span><span class="op" id="7212719">.</span><span class="ident" id="7212720">A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212726">B</span>&nbsp;<span class="op" id="7212728">:=</span>&nbsp;<span class="ident" id="7212731"><a href="/net/rpc/server_test.go.html#7212673">call</a></span><span class="op" id="7212735">.</span><span class="ident" id="7212736">Args</span><span class="op" id="7212740">.</span><span class="op" id="7212741">(</span><span class="op" id="7212742">*</span><span class="ident" id="7212743"><a href="/net/rpc/server_test.go.html#7198025">Args</a></span><span class="op" id="7212747">)</span><span class="op" id="7212748">.</span><span class="ident" id="7212749">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212755">C</span>&nbsp;<span class="op" id="7212757">:=</span>&nbsp;<span class="ident" id="7212760"><a href="/net/rpc/server_test.go.html#7212673">call</a></span><span class="op" id="7212764">.</span><span class="ident" id="7212765">Reply</span><span class="op" id="7212770">.</span><span class="op" id="7212771">(</span><span class="op" id="7212772">*</span><span class="ident" id="7212773"><a href="/net/rpc/server_test.go.html#7198057">Reply</a></span><span class="op" id="7212778">)</span><span class="op" id="7212779">.</span><span class="ident" id="7212780">C</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212786">if</span>&nbsp;<span class="ident" id="7212789"><a href="/net/rpc/server_test.go.html#7212697">A</a></span><span class="op" id="7212790">+</span><span class="ident" id="7212791"><a href="/net/rpc/server_test.go.html#7212726">B</a></span>&nbsp;<span class="op" id="7212793">!=</span>&nbsp;<span class="ident" id="7212796"><a href="/net/rpc/server_test.go.html#7212755">C</a></span>&nbsp;<span class="op" id="7212798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212805"><a href="/net/rpc/server_test.go.html#7212035">b</a></span><span class="op" id="7212806">.</span><span class="ident" id="7212807">Fatalf</span><span class="op" id="7212813">(</span><span class="string" id="7212814">&#34;incorrect&nbsp;reply:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7212856">,</span>&nbsp;<span class="ident" id="7212858"><a href="/net/rpc/server_test.go.html#7212697">A</a></span><span class="op" id="7212859">+</span><span class="ident" id="7212860"><a href="/net/rpc/server_test.go.html#7212726">B</a></span><span class="op" id="7212861">,</span>&nbsp;<span class="ident" id="7212863"><a href="/net/rpc/server_test.go.html#7212755">C</a></span><span class="op" id="7212864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212876">&lt;-</span><span class="ident" id="7212878"><a href="/net/rpc/server_test.go.html#7212364">gate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212887">if</span>&nbsp;<span class="ident" id="7212890"><a href="/net/rpc/server_test.go.html#7197802">atomic</a></span><span class="op" id="7212896">.</span><span class="ident" id="7212897">AddInt32</span><span class="op" id="7212905">(</span><span class="op" id="7212906">&amp;</span><span class="ident" id="7212907"><a href="/net/rpc/server_test.go.html#7212306">recv</a></span><span class="op" id="7212911">,</span>&nbsp;<span class="op" id="7212913">-</span><span class="num" id="7212914">1</span><span class="op" id="7212915">)</span>&nbsp;<span class="op" id="7212917">==</span>&nbsp;<span class="num" id="7212920">0</span>&nbsp;<span class="op" id="7212922">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7212929">close</span><span class="op" id="7212934">(</span><span class="ident" id="7212935"><a href="/net/rpc/server_test.go.html#7212409">res</a></span><span class="op" id="7212938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212954"><a href="/net/rpc/server_test.go.html#7212330">wg</a></span><span class="op" id="7212956">.</span><span class="ident" id="7212957">Done</span><span class="op" id="7212961">(</span><span class="op" id="7212962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212966">}</span><span class="op" id="7212967">(</span><span class="op" id="7212968">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212974"><a href="/net/rpc/server_test.go.html#7212330">wg</a></span><span class="op" id="7212976">.</span><span class="ident" id="7212977">Wait</span><span class="op" id="7212981">(</span><span class="op" id="7212982">)</span><br>
<span class="lineno"></span><span class="op" id="7212984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7212987">func</span>&nbsp;<span class="ident" id="7212992">BenchmarkEndToEnd</span><span class="op" id="7213009">(</span><span class="ident" id="7213010">b</span>&nbsp;<span class="op" id="7213012">*</span><span class="ident" id="7213013"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7213020">.</span><span class="ident" id="7213021">B</span><span class="op" id="7213022">)</span>&nbsp;<span class="op" id="7213024">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213027"><a href="/net/rpc/server_test.go.html#7211377">benchmarkEndToEnd</a></span><span class="op" id="7213044">(</span><span class="ident" id="7213045"><a href="/net/rpc/server_test.go.html#7208761">dialDirect</a></span><span class="op" id="7213055">,</span>&nbsp;<span class="ident" id="7213057"><a href="/net/rpc/server_test.go.html#7213010">b</a></span><span class="op" id="7213058">)</span><br>
<span class="lineno"></span><span class="op" id="7213060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7213063">func</span>&nbsp;<span class="ident" id="7213068">BenchmarkEndToEndHTTP</span><span class="op" id="7213089">(</span><span class="ident" id="7213090">b</span>&nbsp;<span class="op" id="7213092">*</span><span class="ident" id="7213093"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7213100">.</span><span class="ident" id="7213101">B</span><span class="op" id="7213102">)</span>&nbsp;<span class="op" id="7213104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213107"><a href="/net/rpc/server_test.go.html#7211377">benchmarkEndToEnd</a></span><span class="op" id="7213124">(</span><span class="ident" id="7213125"><a href="/net/rpc/server_test.go.html#7208833">dialHTTP</a></span><span class="op" id="7213133">,</span>&nbsp;<span class="ident" id="7213135"><a href="/net/rpc/server_test.go.html#7213090">b</a></span><span class="op" id="7213136">)</span><br>
<span class="lineno">675</span><span class="op" id="7213138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7213141">func</span>&nbsp;<span class="ident" id="7213146">BenchmarkEndToEndAsync</span><span class="op" id="7213168">(</span><span class="ident" id="7213169">b</span>&nbsp;<span class="op" id="7213171">*</span><span class="ident" id="7213172"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7213179">.</span><span class="ident" id="7213180">B</span><span class="op" id="7213181">)</span>&nbsp;<span class="op" id="7213183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213186"><a href="/net/rpc/server_test.go.html#7211982">benchmarkEndToEndAsync</a></span><span class="op" id="7213208">(</span><span class="ident" id="7213209"><a href="/net/rpc/server_test.go.html#7208761">dialDirect</a></span><span class="op" id="7213219">,</span>&nbsp;<span class="ident" id="7213221"><a href="/net/rpc/server_test.go.html#7213169">b</a></span><span class="op" id="7213222">)</span><br>
<span class="lineno"></span><span class="op" id="7213224">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7213227">func</span>&nbsp;<span class="ident" id="7213232">BenchmarkEndToEndAsyncHTTP</span><span class="op" id="7213258">(</span><span class="ident" id="7213259">b</span>&nbsp;<span class="op" id="7213261">*</span><span class="ident" id="7213262"><a href="/net/rpc/server_test.go.html#7197817">testing</a></span><span class="op" id="7213269">.</span><span class="ident" id="7213270">B</span><span class="op" id="7213271">)</span>&nbsp;<span class="op" id="7213273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213276"><a href="/net/rpc/server_test.go.html#7211982">benchmarkEndToEndAsync</a></span><span class="op" id="7213298">(</span><span class="ident" id="7213299"><a href="/net/rpc/server_test.go.html#7208833">dialHTTP</a></span><span class="op" id="7213307">,</span>&nbsp;<span class="ident" id="7213309"><a href="/net/rpc/server_test.go.html#7213259">b</a></span><span class="op" id="7213310">)</span><br>
<span class="lineno"></span><span class="op" id="7213312">}</span>
</div>
</body>
</html>
