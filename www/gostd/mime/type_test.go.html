<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8430171">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8430226">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8430280">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8430331">package</span>&nbsp;<span class="ident" id="8430339">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8430345">import</span>&nbsp;<span class="op" id="8430352">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8430355">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8430365">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8430368">var</span>&nbsp;<span class="ident" id="8430372">typeTests</span>&nbsp;<span class="op" id="8430382">=</span>&nbsp;<span class="ident" id="8430384">initMimeForTests</span><span class="op" id="8430400">(</span><span class="op" id="8430401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8430404">func</span>&nbsp;<span class="ident" id="8430409">TestTypeByExtension</span><span class="op" id="8430428">(</span><span class="ident" id="8430429">t</span>&nbsp;<span class="op" id="8430431">*</span><span class="ident" id="8430432">testing</span><span class="op" id="8430439">.</span><span class="ident" id="8430440">T</span><span class="op" id="8430441">)</span>&nbsp;<span class="op" id="8430443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430446">for</span>&nbsp;<span class="ident" id="8430450">ext</span><span class="op" id="8430453">,</span>&nbsp;<span class="ident" id="8430455">want</span>&nbsp;<span class="op" id="8430460">:=</span>&nbsp;<span class="keyword" id="8430463">range</span>&nbsp;<span class="ident" id="8430469">typeTests</span>&nbsp;<span class="op" id="8430479">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430483">val</span>&nbsp;<span class="op" id="8430487">:=</span>&nbsp;<span class="ident" id="8430490">TypeByExtension</span><span class="op" id="8430505">(</span><span class="ident" id="8430506">ext</span><span class="op" id="8430509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430513">if</span>&nbsp;<span class="ident" id="8430516">val</span>&nbsp;<span class="op" id="8430520">!=</span>&nbsp;<span class="ident" id="8430523">want</span>&nbsp;<span class="op" id="8430528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430533">t</span><span class="op" id="8430534">.</span><span class="ident" id="8430535">Errorf</span><span class="op" id="8430541">(</span><span class="string" id="8430542">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8430577">,</span>&nbsp;<span class="ident" id="8430579">ext</span><span class="op" id="8430582">,</span>&nbsp;<span class="ident" id="8430584">val</span><span class="op" id="8430587">,</span>&nbsp;<span class="ident" id="8430589">want</span><span class="op" id="8430593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430600">}</span><br>
<span class="lineno">20</span><span class="op" id="8430602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8430605">func</span>&nbsp;<span class="ident" id="8430610">TestTypeByExtensionCase</span><span class="op" id="8430633">(</span><span class="ident" id="8430634">t</span>&nbsp;<span class="op" id="8430636">*</span><span class="ident" id="8430637">testing</span><span class="op" id="8430644">.</span><span class="ident" id="8430645">T</span><span class="op" id="8430646">)</span>&nbsp;<span class="op" id="8430648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430651">const</span>&nbsp;<span class="ident" id="8430657">custom</span>&nbsp;<span class="op" id="8430664">=</span>&nbsp;<span class="string" id="8430666">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430699">const</span>&nbsp;<span class="ident" id="8430705">caps</span>&nbsp;<span class="op" id="8430710">=</span>&nbsp;<span class="string" id="8430712">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430738">if</span>&nbsp;<span class="ident" id="8430741">err</span>&nbsp;<span class="op" id="8430745">:=</span>&nbsp;<span class="ident" id="8430748">AddExtensionType</span><span class="op" id="8430764">(</span><span class="string" id="8430765">&#34;.TEST&#34;</span><span class="op" id="8430772">,</span>&nbsp;<span class="ident" id="8430774">caps</span><span class="op" id="8430778">)</span><span class="op" id="8430779">;</span>&nbsp;<span class="ident" id="8430781">err</span>&nbsp;<span class="op" id="8430785">!=</span>&nbsp;<span class="builtintype" id="8430788">nil</span>&nbsp;<span class="op" id="8430792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430796">t</span><span class="op" id="8430797">.</span><span class="ident" id="8430798">Fatalf</span><span class="op" id="8430804">(</span><span class="string" id="8430805">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8430836">,</span>&nbsp;<span class="ident" id="8430838">err</span><span class="op" id="8430841">,</span>&nbsp;<span class="ident" id="8430843">custom</span><span class="op" id="8430849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8430855">if</span>&nbsp;<span class="ident" id="8430858">err</span>&nbsp;<span class="op" id="8430862">:=</span>&nbsp;<span class="ident" id="8430865">AddExtensionType</span><span class="op" id="8430881">(</span><span class="string" id="8430882">&#34;.tesT&#34;</span><span class="op" id="8430889">,</span>&nbsp;<span class="ident" id="8430891">custom</span><span class="op" id="8430897">)</span><span class="op" id="8430898">;</span>&nbsp;<span class="ident" id="8430900">err</span>&nbsp;<span class="op" id="8430904">!=</span>&nbsp;<span class="builtintype" id="8430907">nil</span>&nbsp;<span class="op" id="8430911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8430915">t</span><span class="op" id="8430916">.</span><span class="ident" id="8430917">Fatalf</span><span class="op" id="8430923">(</span><span class="string" id="8430924">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8430955">,</span>&nbsp;<span class="ident" id="8430957">err</span><span class="op" id="8430960">,</span>&nbsp;<span class="ident" id="8430962">custom</span><span class="op" id="8430968">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8430971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8430975">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8431001">if</span>&nbsp;<span class="ident" id="8431004">got</span>&nbsp;<span class="op" id="8431008">:=</span>&nbsp;<span class="ident" id="8431011">TypeByExtension</span><span class="op" id="8431026">(</span><span class="string" id="8431027">&#34;.tesT&#34;</span><span class="op" id="8431034">)</span><span class="op" id="8431035">;</span>&nbsp;<span class="ident" id="8431037">got</span>&nbsp;<span class="op" id="8431041">!=</span>&nbsp;<span class="ident" id="8431044">custom</span>&nbsp;<span class="op" id="8431051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431055">t</span><span class="op" id="8431056">.</span><span class="ident" id="8431057">Fatalf</span><span class="op" id="8431063">(</span><span class="string" id="8431064">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8431092">,</span>&nbsp;<span class="ident" id="8431094">got</span><span class="op" id="8431097">,</span>&nbsp;<span class="ident" id="8431099">custom</span><span class="op" id="8431105">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8431108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8431111">if</span>&nbsp;<span class="ident" id="8431114">got</span>&nbsp;<span class="op" id="8431118">:=</span>&nbsp;<span class="ident" id="8431121">TypeByExtension</span><span class="op" id="8431136">(</span><span class="string" id="8431137">&#34;.TEST&#34;</span><span class="op" id="8431144">)</span><span class="op" id="8431145">;</span>&nbsp;<span class="ident" id="8431147">got</span>&nbsp;<span class="op" id="8431151">!=</span>&nbsp;<span class="ident" id="8431154">caps</span>&nbsp;<span class="op" id="8431159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431163">t</span><span class="op" id="8431164">.</span><span class="ident" id="8431165">Fatalf</span><span class="op" id="8431171">(</span><span class="string" id="8431172">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8431200">,</span>&nbsp;<span class="ident" id="8431202">got</span><span class="op" id="8431205">,</span>&nbsp;<span class="ident" id="8431207">caps</span><span class="op" id="8431211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8431214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8431218">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8431239">if</span>&nbsp;<span class="ident" id="8431242">got</span>&nbsp;<span class="op" id="8431246">:=</span>&nbsp;<span class="ident" id="8431249">TypeByExtension</span><span class="op" id="8431264">(</span><span class="string" id="8431265">&#34;.TesT&#34;</span><span class="op" id="8431272">)</span><span class="op" id="8431273">;</span>&nbsp;<span class="ident" id="8431275">got</span>&nbsp;<span class="op" id="8431279">!=</span>&nbsp;<span class="ident" id="8431282">custom</span>&nbsp;<span class="op" id="8431289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431293">t</span><span class="op" id="8431294">.</span><span class="ident" id="8431295">Fatalf</span><span class="op" id="8431301">(</span><span class="string" id="8431302">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8431330">,</span>&nbsp;<span class="ident" id="8431332">got</span><span class="op" id="8431335">,</span>&nbsp;<span class="ident" id="8431337">custom</span><span class="op" id="8431343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8431346">}</span><br>
<span class="lineno"></span><span class="op" id="8431348">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8431351">func</span>&nbsp;<span class="ident" id="8431356">TestLookupMallocs</span><span class="op" id="8431373">(</span><span class="ident" id="8431374">t</span>&nbsp;<span class="op" id="8431376">*</span><span class="ident" id="8431377">testing</span><span class="op" id="8431384">.</span><span class="ident" id="8431385">T</span><span class="op" id="8431386">)</span>&nbsp;<span class="op" id="8431388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431391">n</span>&nbsp;<span class="op" id="8431393">:=</span>&nbsp;<span class="ident" id="8431396">testing</span><span class="op" id="8431403">.</span><span class="ident" id="8431404">AllocsPerRun</span><span class="op" id="8431416">(</span><span class="num" id="8431417">10000</span><span class="op" id="8431422">,</span>&nbsp;<span class="keyword" id="8431424">func</span><span class="op" id="8431428">(</span><span class="op" id="8431429">)</span>&nbsp;<span class="op" id="8431431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431435">TypeByExtension</span><span class="op" id="8431450">(</span><span class="string" id="8431451">&#34;.html&#34;</span><span class="op" id="8431458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431462">TypeByExtension</span><span class="op" id="8431477">(</span><span class="string" id="8431478">&#34;.HtML&#34;</span><span class="op" id="8431485">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8431488">}</span><span class="op" id="8431489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8431492">if</span>&nbsp;<span class="ident" id="8431495">n</span>&nbsp;<span class="op" id="8431497">&gt;</span>&nbsp;<span class="num" id="8431499">0</span>&nbsp;<span class="op" id="8431501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8431505">t</span><span class="op" id="8431506">.</span><span class="ident" id="8431507">Errorf</span><span class="op" id="8431513">(</span><span class="string" id="8431514">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="8431535">,</span>&nbsp;<span class="ident" id="8431537">n</span><span class="op" id="8431538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8431541">}</span><br>
<span class="lineno"></span><span class="op" id="8431543">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
