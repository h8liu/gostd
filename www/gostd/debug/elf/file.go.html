<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6156585">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6156641">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6156695">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6156746">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6156800">package</span>&nbsp;<span class="ident" id="6156808">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6156813">import</span>&nbsp;<span class="op" id="6156820">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156823">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156832">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156847">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156866">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156876">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156883">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6156889">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6156894">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6156897">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="6156930">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6156969">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="6157016">type</span>&nbsp;<span class="ident" id="6157021">FileHeader</span>&nbsp;<span class="keyword" id="6157032">struct</span>&nbsp;<span class="op" id="6157039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157042">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157053">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157060">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157071">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157077">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157088">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157097">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157108">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157115">ABIVersion</span>&nbsp;<span class="builtintype" id="6157126">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157133">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="6157144">binary</span><span class="op" id="6157150">.</span><span class="ident" id="6157151">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157162">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157173">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157179">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157190">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157199">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157210">uint64</span><br>
<span class="lineno">35</span><span class="op" id="6157217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6157220">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6157259">type</span>&nbsp;<span class="ident" id="6157264">File</span>&nbsp;<span class="keyword" id="6157269">struct</span>&nbsp;<span class="op" id="6157276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157279">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157291">Sections</span>&nbsp;&nbsp;<span class="op" id="6157301">[</span><span class="op" id="6157302">]</span><span class="op" id="6157303">*</span><span class="ident" id="6157304">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157313">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6157323">[</span><span class="op" id="6157324">]</span><span class="op" id="6157325">*</span><span class="ident" id="6157326">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157332">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157342">io</span><span class="op" id="6157344">.</span><span class="ident" id="6157345">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157353">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6157363">[</span><span class="op" id="6157364">]</span><span class="ident" id="6157365">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157374">gnuVersym</span>&nbsp;<span class="op" id="6157384">[</span><span class="op" id="6157385">]</span><span class="builtintype" id="6157386">byte</span><br>
<span class="lineno">45</span><span class="op" id="6157391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6157394">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6157453">type</span>&nbsp;<span class="ident" id="6157458">SectionHeader</span>&nbsp;<span class="keyword" id="6157472">struct</span>&nbsp;<span class="op" id="6157479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157482">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6157492">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157500">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157510">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157523">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157533">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157546">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157556">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157564">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157574">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157582">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157592">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157600">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6157610">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157618">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6157628">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157636">Addralign</span>&nbsp;<span class="ident" id="6157646">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157654">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6157664">uint64</span><br>
<span class="lineno"></span><span class="op" id="6157671">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6157674">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6157731">type</span>&nbsp;<span class="ident" id="6157736">Section</span>&nbsp;<span class="keyword" id="6157744">struct</span>&nbsp;<span class="op" id="6157751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6157754">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157770">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157808">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157848">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157883">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157931">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6157981">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158005">io</span><span class="op" id="6158007">.</span><span class="ident" id="6158008">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158018">sr</span>&nbsp;<span class="op" id="6158021">*</span><span class="ident" id="6158022">io</span><span class="op" id="6158024">.</span><span class="ident" id="6158025">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6158039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6158042">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6158101">func</span>&nbsp;<span class="op" id="6158106">(</span><span class="ident" id="6158107">s</span>&nbsp;<span class="op" id="6158109">*</span><span class="ident" id="6158110">Section</span><span class="op" id="6158117">)</span>&nbsp;<span class="ident" id="6158119">Data</span><span class="op" id="6158123">(</span><span class="op" id="6158124">)</span>&nbsp;<span class="op" id="6158126">(</span><span class="op" id="6158127">[</span><span class="op" id="6158128">]</span><span class="builtintype" id="6158129">byte</span><span class="op" id="6158133">,</span>&nbsp;<span class="builtintype" id="6158135">error</span><span class="op" id="6158140">)</span>&nbsp;<span class="op" id="6158142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158145">dat</span>&nbsp;<span class="op" id="6158149">:=</span>&nbsp;<span class="builtinfunc" id="6158152">make</span><span class="op" id="6158156">(</span><span class="op" id="6158157">[</span><span class="op" id="6158158">]</span><span class="builtintype" id="6158159">byte</span><span class="op" id="6158163">,</span>&nbsp;<span class="ident" id="6158165">s</span><span class="op" id="6158166">.</span><span class="ident" id="6158167">sr</span><span class="op" id="6158169">.</span><span class="ident" id="6158170">Size</span><span class="op" id="6158174">(</span><span class="op" id="6158175">)</span><span class="op" id="6158176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158179">n</span><span class="op" id="6158180">,</span>&nbsp;<span class="ident" id="6158182">err</span>&nbsp;<span class="op" id="6158186">:=</span>&nbsp;<span class="ident" id="6158189">s</span><span class="op" id="6158190">.</span><span class="ident" id="6158191">sr</span><span class="op" id="6158193">.</span><span class="ident" id="6158194">ReadAt</span><span class="op" id="6158200">(</span><span class="ident" id="6158201">dat</span><span class="op" id="6158204">,</span>&nbsp;<span class="num" id="6158206">0</span><span class="op" id="6158207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158210">if</span>&nbsp;<span class="ident" id="6158213">n</span>&nbsp;<span class="op" id="6158215">==</span>&nbsp;<span class="builtinfunc" id="6158218">len</span><span class="op" id="6158221">(</span><span class="ident" id="6158222">dat</span><span class="op" id="6158225">)</span>&nbsp;<span class="op" id="6158227">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158231">err</span>&nbsp;<span class="op" id="6158235">=</span>&nbsp;<span class="ident" id="6158237">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158245">return</span>&nbsp;<span class="ident" id="6158252">dat</span><span class="op" id="6158255">[</span><span class="num" id="6158256">0</span><span class="op" id="6158257">:</span><span class="ident" id="6158258">n</span><span class="op" id="6158259">]</span><span class="op" id="6158260">,</span>&nbsp;<span class="ident" id="6158262">err</span><br>
<span class="lineno"></span><span class="op" id="6158266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="6158269">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6158332">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6158357">func</span>&nbsp;<span class="op" id="6158362">(</span><span class="ident" id="6158363">f</span>&nbsp;<span class="op" id="6158365">*</span><span class="ident" id="6158366">File</span><span class="op" id="6158370">)</span>&nbsp;<span class="ident" id="6158372">stringTable</span><span class="op" id="6158383">(</span><span class="ident" id="6158384">link</span>&nbsp;<span class="builtintype" id="6158389">uint32</span><span class="op" id="6158395">)</span>&nbsp;<span class="op" id="6158397">(</span><span class="op" id="6158398">[</span><span class="op" id="6158399">]</span><span class="builtintype" id="6158400">byte</span><span class="op" id="6158404">,</span>&nbsp;<span class="builtintype" id="6158406">error</span><span class="op" id="6158411">)</span>&nbsp;<span class="op" id="6158413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158416">if</span>&nbsp;<span class="ident" id="6158419">link</span>&nbsp;<span class="op" id="6158424">&lt;=</span>&nbsp;<span class="num" id="6158427">0</span>&nbsp;<span class="op" id="6158429">||</span>&nbsp;<span class="ident" id="6158432">link</span>&nbsp;<span class="op" id="6158437">&gt;=</span>&nbsp;<span class="builtintype" id="6158440">uint32</span><span class="op" id="6158446">(</span><span class="builtinfunc" id="6158447">len</span><span class="op" id="6158450">(</span><span class="ident" id="6158451">f</span><span class="op" id="6158452">.</span><span class="ident" id="6158453">Sections</span><span class="op" id="6158461">)</span><span class="op" id="6158462">)</span>&nbsp;<span class="op" id="6158464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158468">return</span>&nbsp;<span class="ident" id="6158475">nil</span><span class="op" id="6158478">,</span>&nbsp;<span class="ident" id="6158480">errors</span><span class="op" id="6158486">.</span><span class="ident" id="6158487">New</span><span class="op" id="6158490">(</span><span class="string" id="6158491">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="6158530">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6158533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6158536">return</span>&nbsp;<span class="ident" id="6158543">f</span><span class="op" id="6158544">.</span><span class="ident" id="6158545">Sections</span><span class="op" id="6158553">[</span><span class="ident" id="6158554">link</span><span class="op" id="6158558">]</span><span class="op" id="6158559">.</span><span class="ident" id="6158560">Data</span><span class="op" id="6158564">(</span><span class="op" id="6158565">)</span><br>
<span class="lineno"></span><span class="op" id="6158567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6158570">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="6158628">func</span>&nbsp;<span class="op" id="6158633">(</span><span class="ident" id="6158634">s</span>&nbsp;<span class="op" id="6158636">*</span><span class="ident" id="6158637">Section</span><span class="op" id="6158644">)</span>&nbsp;<span class="ident" id="6158646">Open</span><span class="op" id="6158650">(</span><span class="op" id="6158651">)</span>&nbsp;<span class="ident" id="6158653">io</span><span class="op" id="6158655">.</span><span class="ident" id="6158656">ReadSeeker</span>&nbsp;<span class="op" id="6158667">{</span>&nbsp;<span class="keyword" id="6158669">return</span>&nbsp;<span class="ident" id="6158676">io</span><span class="op" id="6158678">.</span><span class="ident" id="6158679">NewSectionReader</span><span class="op" id="6158695">(</span><span class="ident" id="6158696">s</span><span class="op" id="6158697">.</span><span class="ident" id="6158698">sr</span><span class="op" id="6158700">,</span>&nbsp;<span class="num" id="6158702">0</span><span class="op" id="6158703">,</span>&nbsp;<span class="num" id="6158705">1</span><span class="op" id="6158706">&lt;&lt;</span><span class="num" id="6158708">63</span><span class="op" id="6158710">-</span><span class="num" id="6158711">1</span><span class="op" id="6158712">)</span>&nbsp;<span class="op" id="6158714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6158717">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6158773">type</span>&nbsp;<span class="ident" id="6158778">ProgHeader</span>&nbsp;<span class="keyword" id="6158789">struct</span>&nbsp;<span class="op" id="6158796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158799">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6158806">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158816">Flags</span>&nbsp;&nbsp;<span class="ident" id="6158823">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158833">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158840">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158848">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="6158855">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158863">Paddr</span>&nbsp;&nbsp;<span class="ident" id="6158870">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158878">Filesz</span>&nbsp;<span class="ident" id="6158885">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158893">Memsz</span>&nbsp;&nbsp;<span class="ident" id="6158900">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158908">Align</span>&nbsp;&nbsp;<span class="ident" id="6158915">uint64</span><br>
<span class="lineno"></span><span class="op" id="6158922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6158925">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="6158992">type</span>&nbsp;<span class="ident" id="6158997">Prog</span>&nbsp;<span class="keyword" id="6159002">struct</span>&nbsp;<span class="op" id="6159009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159012">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159025">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159063">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159103">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159138">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159186">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159236">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159260">io</span><span class="op" id="6159262">.</span><span class="ident" id="6159263">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159273">sr</span>&nbsp;<span class="op" id="6159276">*</span><span class="ident" id="6159277">io</span><span class="op" id="6159279">.</span><span class="ident" id="6159280">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6159294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6159297">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6159360">func</span>&nbsp;<span class="op" id="6159365">(</span><span class="ident" id="6159366">p</span>&nbsp;<span class="op" id="6159368">*</span><span class="ident" id="6159369">Prog</span><span class="op" id="6159373">)</span>&nbsp;<span class="ident" id="6159375">Open</span><span class="op" id="6159379">(</span><span class="op" id="6159380">)</span>&nbsp;<span class="ident" id="6159382">io</span><span class="op" id="6159384">.</span><span class="ident" id="6159385">ReadSeeker</span>&nbsp;<span class="op" id="6159396">{</span>&nbsp;<span class="keyword" id="6159398">return</span>&nbsp;<span class="ident" id="6159405">io</span><span class="op" id="6159407">.</span><span class="ident" id="6159408">NewSectionReader</span><span class="op" id="6159424">(</span><span class="ident" id="6159425">p</span><span class="op" id="6159426">.</span><span class="ident" id="6159427">sr</span><span class="op" id="6159429">,</span>&nbsp;<span class="num" id="6159431">0</span><span class="op" id="6159432">,</span>&nbsp;<span class="num" id="6159434">1</span><span class="op" id="6159435">&lt;&lt;</span><span class="num" id="6159437">63</span><span class="op" id="6159439">-</span><span class="num" id="6159440">1</span><span class="op" id="6159441">)</span>&nbsp;<span class="op" id="6159443">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6159446">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6159510">type</span>&nbsp;<span class="ident" id="6159515">Symbol</span>&nbsp;<span class="keyword" id="6159522">struct</span>&nbsp;<span class="op" id="6159529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159532">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159544">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159552">Info</span><span class="op" id="6159556">,</span>&nbsp;<span class="ident" id="6159558">Other</span>&nbsp;<span class="builtintype" id="6159564">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159570">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6159582">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159596">Value</span><span class="op" id="6159601">,</span>&nbsp;<span class="ident" id="6159603">Size</span>&nbsp;<span class="ident" id="6159608">uint64</span><br>
<span class="lineno"></span><span class="op" id="6159615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6159618">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6159640">type</span>&nbsp;<span class="ident" id="6159645">FormatError</span>&nbsp;<span class="keyword" id="6159657">struct</span>&nbsp;<span class="op" id="6159664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159667">off</span>&nbsp;<span class="ident" id="6159671">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159678">msg</span>&nbsp;<span class="builtintype" id="6159682">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159690">val</span>&nbsp;<span class="keyword" id="6159694">interface</span><span class="op" id="6159703">{</span><span class="op" id="6159704">}</span><br>
<span class="lineno"></span><span class="op" id="6159706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6159709">func</span>&nbsp;<span class="op" id="6159714">(</span><span class="ident" id="6159715">e</span>&nbsp;<span class="op" id="6159717">*</span><span class="ident" id="6159718">FormatError</span><span class="op" id="6159729">)</span>&nbsp;<span class="ident" id="6159731">Error</span><span class="op" id="6159736">(</span><span class="op" id="6159737">)</span>&nbsp;<span class="builtintype" id="6159739">string</span>&nbsp;<span class="op" id="6159746">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159749">msg</span>&nbsp;<span class="op" id="6159753">:=</span>&nbsp;<span class="ident" id="6159756">e</span><span class="op" id="6159757">.</span><span class="ident" id="6159758">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159763">if</span>&nbsp;<span class="ident" id="6159766">e</span><span class="op" id="6159767">.</span><span class="ident" id="6159768">val</span>&nbsp;<span class="op" id="6159772">!=</span>&nbsp;<span class="ident" id="6159775">nil</span>&nbsp;<span class="op" id="6159779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159783">msg</span>&nbsp;<span class="op" id="6159787">+=</span>&nbsp;<span class="ident" id="6159790">fmt</span><span class="op" id="6159793">.</span><span class="ident" id="6159794">Sprintf</span><span class="op" id="6159801">(</span><span class="string" id="6159802">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="6159810">,</span>&nbsp;<span class="ident" id="6159812">e</span><span class="op" id="6159813">.</span><span class="ident" id="6159814">val</span><span class="op" id="6159817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6159820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159823">msg</span>&nbsp;<span class="op" id="6159827">+=</span>&nbsp;<span class="ident" id="6159830">fmt</span><span class="op" id="6159833">.</span><span class="ident" id="6159834">Sprintf</span><span class="op" id="6159841">(</span><span class="string" id="6159842">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6159865">,</span>&nbsp;<span class="ident" id="6159867">e</span><span class="op" id="6159868">.</span><span class="ident" id="6159869">off</span><span class="op" id="6159872">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159875">return</span>&nbsp;<span class="ident" id="6159882">msg</span><br>
<span class="lineno"></span><span class="op" id="6159886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6159889">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6159974">func</span>&nbsp;<span class="ident" id="6159979">Open</span><span class="op" id="6159983">(</span><span class="ident" id="6159984">name</span>&nbsp;<span class="builtintype" id="6159989">string</span><span class="op" id="6159995">)</span>&nbsp;<span class="op" id="6159997">(</span><span class="op" id="6159998">*</span><span class="ident" id="6159999">File</span><span class="op" id="6160003">,</span>&nbsp;<span class="builtintype" id="6160005">error</span><span class="op" id="6160010">)</span>&nbsp;<span class="op" id="6160012">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160015">f</span><span class="op" id="6160016">,</span>&nbsp;<span class="ident" id="6160018">err</span>&nbsp;<span class="op" id="6160022">:=</span>&nbsp;<span class="ident" id="6160025">os</span><span class="op" id="6160027">.</span><span class="ident" id="6160028">Open</span><span class="op" id="6160032">(</span><span class="ident" id="6160033">name</span><span class="op" id="6160037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160040">if</span>&nbsp;<span class="ident" id="6160043">err</span>&nbsp;<span class="op" id="6160047">!=</span>&nbsp;<span class="ident" id="6160050">nil</span>&nbsp;<span class="op" id="6160054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160058">return</span>&nbsp;<span class="ident" id="6160065">nil</span><span class="op" id="6160068">,</span>&nbsp;<span class="ident" id="6160070">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160078">ff</span><span class="op" id="6160080">,</span>&nbsp;<span class="ident" id="6160082">err</span>&nbsp;<span class="op" id="6160086">:=</span>&nbsp;<span class="ident" id="6160089">NewFile</span><span class="op" id="6160096">(</span><span class="ident" id="6160097">f</span><span class="op" id="6160098">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160101">if</span>&nbsp;<span class="ident" id="6160104">err</span>&nbsp;<span class="op" id="6160108">!=</span>&nbsp;<span class="ident" id="6160111">nil</span>&nbsp;<span class="op" id="6160115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160119">f</span><span class="op" id="6160120">.</span><span class="ident" id="6160121">Close</span><span class="op" id="6160126">(</span><span class="op" id="6160127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160131">return</span>&nbsp;<span class="ident" id="6160138">nil</span><span class="op" id="6160141">,</span>&nbsp;<span class="ident" id="6160143">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160151">ff</span><span class="op" id="6160153">.</span><span class="ident" id="6160154">closer</span>&nbsp;<span class="op" id="6160161">=</span>&nbsp;<span class="ident" id="6160163">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160166">return</span>&nbsp;<span class="ident" id="6160173">ff</span><span class="op" id="6160175">,</span>&nbsp;<span class="ident" id="6160177">nil</span><br>
<span class="lineno"></span><span class="op" id="6160181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6160184">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6160210">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="6160277">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6160301">func</span>&nbsp;<span class="op" id="6160306">(</span><span class="ident" id="6160307">f</span>&nbsp;<span class="op" id="6160309">*</span><span class="ident" id="6160310">File</span><span class="op" id="6160314">)</span>&nbsp;<span class="ident" id="6160316">Close</span><span class="op" id="6160321">(</span><span class="op" id="6160322">)</span>&nbsp;<span class="builtintype" id="6160324">error</span>&nbsp;<span class="op" id="6160330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160333">var</span>&nbsp;<span class="ident" id="6160337">err</span>&nbsp;<span class="builtintype" id="6160341">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160348">if</span>&nbsp;<span class="ident" id="6160351">f</span><span class="op" id="6160352">.</span><span class="ident" id="6160353">closer</span>&nbsp;<span class="op" id="6160360">!=</span>&nbsp;<span class="ident" id="6160363">nil</span>&nbsp;<span class="op" id="6160367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160371">err</span>&nbsp;<span class="op" id="6160375">=</span>&nbsp;<span class="ident" id="6160377">f</span><span class="op" id="6160378">.</span><span class="ident" id="6160379">closer</span><span class="op" id="6160385">.</span><span class="ident" id="6160386">Close</span><span class="op" id="6160391">(</span><span class="op" id="6160392">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160396">f</span><span class="op" id="6160397">.</span><span class="ident" id="6160398">closer</span>&nbsp;<span class="op" id="6160405">=</span>&nbsp;<span class="ident" id="6160407">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160415">return</span>&nbsp;<span class="ident" id="6160422">err</span><br>
<span class="lineno"></span><span class="op" id="6160426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="6160429">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6160486">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6160537">func</span>&nbsp;<span class="op" id="6160542">(</span><span class="ident" id="6160543">f</span>&nbsp;<span class="op" id="6160545">*</span><span class="ident" id="6160546">File</span><span class="op" id="6160550">)</span>&nbsp;<span class="ident" id="6160552">SectionByType</span><span class="op" id="6160565">(</span><span class="ident" id="6160566">typ</span>&nbsp;<span class="ident" id="6160570">SectionType</span><span class="op" id="6160581">)</span>&nbsp;<span class="op" id="6160583">*</span><span class="ident" id="6160584">Section</span>&nbsp;<span class="op" id="6160592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160595">for</span>&nbsp;<span class="ident" id="6160599">_</span><span class="op" id="6160600">,</span>&nbsp;<span class="ident" id="6160602">s</span>&nbsp;<span class="op" id="6160604">:=</span>&nbsp;<span class="keyword" id="6160607">range</span>&nbsp;<span class="ident" id="6160613">f</span><span class="op" id="6160614">.</span><span class="ident" id="6160615">Sections</span>&nbsp;<span class="op" id="6160624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160628">if</span>&nbsp;<span class="ident" id="6160631">s</span><span class="op" id="6160632">.</span><span class="ident" id="6160633">Type</span>&nbsp;<span class="op" id="6160638">==</span>&nbsp;<span class="ident" id="6160641">typ</span>&nbsp;<span class="op" id="6160645">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160650">return</span>&nbsp;<span class="ident" id="6160657">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160667">return</span>&nbsp;<span class="ident" id="6160674">nil</span><br>
<span class="lineno"></span><span class="op" id="6160678">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6160681">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6160764">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="6160834">func</span>&nbsp;<span class="ident" id="6160839">NewFile</span><span class="op" id="6160846">(</span><span class="ident" id="6160847">r</span>&nbsp;<span class="ident" id="6160849">io</span><span class="op" id="6160851">.</span><span class="ident" id="6160852">ReaderAt</span><span class="op" id="6160860">)</span>&nbsp;<span class="op" id="6160862">(</span><span class="op" id="6160863">*</span><span class="ident" id="6160864">File</span><span class="op" id="6160868">,</span>&nbsp;<span class="builtintype" id="6160870">error</span><span class="op" id="6160875">)</span>&nbsp;<span class="op" id="6160877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160880">sr</span>&nbsp;<span class="op" id="6160883">:=</span>&nbsp;<span class="ident" id="6160886">io</span><span class="op" id="6160888">.</span><span class="ident" id="6160889">NewSectionReader</span><span class="op" id="6160905">(</span><span class="ident" id="6160906">r</span><span class="op" id="6160907">,</span>&nbsp;<span class="num" id="6160909">0</span><span class="op" id="6160910">,</span>&nbsp;<span class="num" id="6160912">1</span><span class="op" id="6160913">&lt;&lt;</span><span class="num" id="6160915">63</span><span class="op" id="6160917">-</span><span class="num" id="6160918">1</span><span class="op" id="6160919">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160922">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160957">var</span>&nbsp;<span class="ident" id="6160961">ident</span>&nbsp;<span class="op" id="6160967">[</span><span class="num" id="6160968">16</span><span class="op" id="6160970">]</span><span class="builtintype" id="6160971">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160978">if</span>&nbsp;<span class="ident" id="6160981">_</span><span class="op" id="6160982">,</span>&nbsp;<span class="ident" id="6160984">err</span>&nbsp;<span class="op" id="6160988">:=</span>&nbsp;<span class="ident" id="6160991">r</span><span class="op" id="6160992">.</span><span class="ident" id="6160993">ReadAt</span><span class="op" id="6160999">(</span><span class="ident" id="6161000">ident</span><span class="op" id="6161005">[</span><span class="num" id="6161006">0</span><span class="op" id="6161007">:</span><span class="op" id="6161008">]</span><span class="op" id="6161009">,</span>&nbsp;<span class="num" id="6161011">0</span><span class="op" id="6161012">)</span><span class="op" id="6161013">;</span>&nbsp;<span class="ident" id="6161015">err</span>&nbsp;<span class="op" id="6161019">!=</span>&nbsp;<span class="ident" id="6161022">nil</span>&nbsp;<span class="op" id="6161026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161030">return</span>&nbsp;<span class="ident" id="6161037">nil</span><span class="op" id="6161040">,</span>&nbsp;<span class="ident" id="6161042">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161047">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161050">if</span>&nbsp;<span class="ident" id="6161053">ident</span><span class="op" id="6161058">[</span><span class="num" id="6161059">0</span><span class="op" id="6161060">]</span>&nbsp;<span class="op" id="6161062">!=</span>&nbsp;<span class="string" id="6161065">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="6161072">||</span>&nbsp;<span class="ident" id="6161075">ident</span><span class="op" id="6161080">[</span><span class="num" id="6161081">1</span><span class="op" id="6161082">]</span>&nbsp;<span class="op" id="6161084">!=</span>&nbsp;<span class="string" id="6161087">&#39;E&#39;</span>&nbsp;<span class="op" id="6161091">||</span>&nbsp;<span class="ident" id="6161094">ident</span><span class="op" id="6161099">[</span><span class="num" id="6161100">2</span><span class="op" id="6161101">]</span>&nbsp;<span class="op" id="6161103">!=</span>&nbsp;<span class="string" id="6161106">&#39;L&#39;</span>&nbsp;<span class="op" id="6161110">||</span>&nbsp;<span class="ident" id="6161113">ident</span><span class="op" id="6161118">[</span><span class="num" id="6161119">3</span><span class="op" id="6161120">]</span>&nbsp;<span class="op" id="6161122">!=</span>&nbsp;<span class="string" id="6161125">&#39;F&#39;</span>&nbsp;<span class="op" id="6161129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161133">return</span>&nbsp;<span class="ident" id="6161140">nil</span><span class="op" id="6161143">,</span>&nbsp;<span class="op" id="6161145">&amp;</span><span class="ident" id="6161146">FormatError</span><span class="op" id="6161157">{</span><span class="num" id="6161158">0</span><span class="op" id="6161159">,</span>&nbsp;<span class="string" id="6161161">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6161179">,</span>&nbsp;<span class="ident" id="6161181">ident</span><span class="op" id="6161186">[</span><span class="num" id="6161187">0</span><span class="op" id="6161188">:</span><span class="num" id="6161189">4</span><span class="op" id="6161190">]</span><span class="op" id="6161191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161198">f</span>&nbsp;<span class="op" id="6161200">:=</span>&nbsp;<span class="builtinfunc" id="6161203">new</span><span class="op" id="6161206">(</span><span class="ident" id="6161207">File</span><span class="op" id="6161211">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161214">f</span><span class="op" id="6161215">.</span><span class="ident" id="6161216">Class</span>&nbsp;<span class="op" id="6161222">=</span>&nbsp;<span class="ident" id="6161224">Class</span><span class="op" id="6161229">(</span><span class="ident" id="6161230">ident</span><span class="op" id="6161235">[</span><span class="ident" id="6161236">EI_CLASS</span><span class="op" id="6161244">]</span><span class="op" id="6161245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161248">switch</span>&nbsp;<span class="ident" id="6161255">f</span><span class="op" id="6161256">.</span><span class="ident" id="6161257">Class</span>&nbsp;<span class="op" id="6161263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161266">case</span>&nbsp;<span class="ident" id="6161271">ELFCLASS32</span><span class="op" id="6161281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161284">case</span>&nbsp;<span class="ident" id="6161289">ELFCLASS64</span><span class="op" id="6161299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161303">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161310">default</span><span class="op" id="6161317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161321">return</span>&nbsp;<span class="ident" id="6161328">nil</span><span class="op" id="6161331">,</span>&nbsp;<span class="op" id="6161333">&amp;</span><span class="ident" id="6161334">FormatError</span><span class="op" id="6161345">{</span><span class="num" id="6161346">0</span><span class="op" id="6161347">,</span>&nbsp;<span class="string" id="6161349">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="6161368">,</span>&nbsp;<span class="ident" id="6161370">f</span><span class="op" id="6161371">.</span><span class="ident" id="6161372">Class</span><span class="op" id="6161377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161384">f</span><span class="op" id="6161385">.</span><span class="ident" id="6161386">Data</span>&nbsp;<span class="op" id="6161391">=</span>&nbsp;<span class="ident" id="6161393">Data</span><span class="op" id="6161397">(</span><span class="ident" id="6161398">ident</span><span class="op" id="6161403">[</span><span class="ident" id="6161404">EI_DATA</span><span class="op" id="6161411">]</span><span class="op" id="6161412">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161415">switch</span>&nbsp;<span class="ident" id="6161422">f</span><span class="op" id="6161423">.</span><span class="ident" id="6161424">Data</span>&nbsp;<span class="op" id="6161429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161432">case</span>&nbsp;<span class="ident" id="6161437">ELFDATA2LSB</span><span class="op" id="6161448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161452">f</span><span class="op" id="6161453">.</span><span class="ident" id="6161454">ByteOrder</span>&nbsp;<span class="op" id="6161464">=</span>&nbsp;<span class="ident" id="6161466">binary</span><span class="op" id="6161472">.</span><span class="ident" id="6161473">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161487">case</span>&nbsp;<span class="ident" id="6161492">ELFDATA2MSB</span><span class="op" id="6161503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161507">f</span><span class="op" id="6161508">.</span><span class="ident" id="6161509">ByteOrder</span>&nbsp;<span class="op" id="6161519">=</span>&nbsp;<span class="ident" id="6161521">binary</span><span class="op" id="6161527">.</span><span class="ident" id="6161528">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161539">default</span><span class="op" id="6161546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161550">return</span>&nbsp;<span class="ident" id="6161557">nil</span><span class="op" id="6161560">,</span>&nbsp;<span class="op" id="6161562">&amp;</span><span class="ident" id="6161563">FormatError</span><span class="op" id="6161574">{</span><span class="num" id="6161575">0</span><span class="op" id="6161576">,</span>&nbsp;<span class="string" id="6161578">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="6161605">,</span>&nbsp;<span class="ident" id="6161607">f</span><span class="op" id="6161608">.</span><span class="ident" id="6161609">Data</span><span class="op" id="6161613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161620">f</span><span class="op" id="6161621">.</span><span class="ident" id="6161622">Version</span>&nbsp;<span class="op" id="6161630">=</span>&nbsp;<span class="ident" id="6161632">Version</span><span class="op" id="6161639">(</span><span class="ident" id="6161640">ident</span><span class="op" id="6161645">[</span><span class="ident" id="6161646">EI_VERSION</span><span class="op" id="6161656">]</span><span class="op" id="6161657">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161660">if</span>&nbsp;<span class="ident" id="6161663">f</span><span class="op" id="6161664">.</span><span class="ident" id="6161665">Version</span>&nbsp;<span class="op" id="6161673">!=</span>&nbsp;<span class="ident" id="6161676">EV_CURRENT</span>&nbsp;<span class="op" id="6161687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161691">return</span>&nbsp;<span class="ident" id="6161698">nil</span><span class="op" id="6161701">,</span>&nbsp;<span class="op" id="6161703">&amp;</span><span class="ident" id="6161704">FormatError</span><span class="op" id="6161715">{</span><span class="num" id="6161716">0</span><span class="op" id="6161717">,</span>&nbsp;<span class="string" id="6161719">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6161740">,</span>&nbsp;<span class="ident" id="6161742">f</span><span class="op" id="6161743">.</span><span class="ident" id="6161744">Version</span><span class="op" id="6161751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161758">f</span><span class="op" id="6161759">.</span><span class="ident" id="6161760">OSABI</span>&nbsp;<span class="op" id="6161766">=</span>&nbsp;<span class="ident" id="6161768">OSABI</span><span class="op" id="6161773">(</span><span class="ident" id="6161774">ident</span><span class="op" id="6161779">[</span><span class="ident" id="6161780">EI_OSABI</span><span class="op" id="6161788">]</span><span class="op" id="6161789">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161792">f</span><span class="op" id="6161793">.</span><span class="ident" id="6161794">ABIVersion</span>&nbsp;<span class="op" id="6161805">=</span>&nbsp;<span class="ident" id="6161807">ident</span><span class="op" id="6161812">[</span><span class="ident" id="6161813">EI_ABIVERSION</span><span class="op" id="6161826">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161830">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161855">var</span>&nbsp;<span class="ident" id="6161859">phoff</span>&nbsp;<span class="ident" id="6161865">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161872">var</span>&nbsp;<span class="ident" id="6161876">phentsize</span><span class="op" id="6161885">,</span>&nbsp;<span class="ident" id="6161887">phnum</span>&nbsp;<span class="builtintype" id="6161893">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161898">var</span>&nbsp;<span class="ident" id="6161902">shoff</span>&nbsp;<span class="ident" id="6161908">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161915">var</span>&nbsp;<span class="ident" id="6161919">shentsize</span><span class="op" id="6161928">,</span>&nbsp;<span class="ident" id="6161930">shnum</span><span class="op" id="6161935">,</span>&nbsp;<span class="ident" id="6161937">shstrndx</span>&nbsp;<span class="builtintype" id="6161946">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161951">shstrndx</span>&nbsp;<span class="op" id="6161960">=</span>&nbsp;<span class="op" id="6161962">-</span><span class="num" id="6161963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161966">switch</span>&nbsp;<span class="ident" id="6161973">f</span><span class="op" id="6161974">.</span><span class="ident" id="6161975">Class</span>&nbsp;<span class="op" id="6161981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161984">case</span>&nbsp;<span class="ident" id="6161989">ELFCLASS32</span><span class="op" id="6161999">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162003">hdr</span>&nbsp;<span class="op" id="6162007">:=</span>&nbsp;<span class="builtinfunc" id="6162010">new</span><span class="op" id="6162013">(</span><span class="ident" id="6162014">Header32</span><span class="op" id="6162022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162026">sr</span><span class="op" id="6162028">.</span><span class="ident" id="6162029">Seek</span><span class="op" id="6162033">(</span><span class="num" id="6162034">0</span><span class="op" id="6162035">,</span>&nbsp;<span class="ident" id="6162037">os</span><span class="op" id="6162039">.</span><span class="ident" id="6162040">SEEK_SET</span><span class="op" id="6162048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162052">if</span>&nbsp;<span class="ident" id="6162055">err</span>&nbsp;<span class="op" id="6162059">:=</span>&nbsp;<span class="ident" id="6162062">binary</span><span class="op" id="6162068">.</span><span class="ident" id="6162069">Read</span><span class="op" id="6162073">(</span><span class="ident" id="6162074">sr</span><span class="op" id="6162076">,</span>&nbsp;<span class="ident" id="6162078">f</span><span class="op" id="6162079">.</span><span class="ident" id="6162080">ByteOrder</span><span class="op" id="6162089">,</span>&nbsp;<span class="ident" id="6162091">hdr</span><span class="op" id="6162094">)</span><span class="op" id="6162095">;</span>&nbsp;<span class="ident" id="6162097">err</span>&nbsp;<span class="op" id="6162101">!=</span>&nbsp;<span class="ident" id="6162104">nil</span>&nbsp;<span class="op" id="6162108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162113">return</span>&nbsp;<span class="ident" id="6162120">nil</span><span class="op" id="6162123">,</span>&nbsp;<span class="ident" id="6162125">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162131">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162135">f</span><span class="op" id="6162136">.</span><span class="ident" id="6162137">Type</span>&nbsp;<span class="op" id="6162142">=</span>&nbsp;<span class="ident" id="6162144">Type</span><span class="op" id="6162148">(</span><span class="ident" id="6162149">hdr</span><span class="op" id="6162152">.</span><span class="ident" id="6162153">Type</span><span class="op" id="6162157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162161">f</span><span class="op" id="6162162">.</span><span class="ident" id="6162163">Machine</span>&nbsp;<span class="op" id="6162171">=</span>&nbsp;<span class="ident" id="6162173">Machine</span><span class="op" id="6162180">(</span><span class="ident" id="6162181">hdr</span><span class="op" id="6162184">.</span><span class="ident" id="6162185">Machine</span><span class="op" id="6162192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162196">f</span><span class="op" id="6162197">.</span><span class="ident" id="6162198">Entry</span>&nbsp;<span class="op" id="6162204">=</span>&nbsp;<span class="ident" id="6162206">uint64</span><span class="op" id="6162212">(</span><span class="ident" id="6162213">hdr</span><span class="op" id="6162216">.</span><span class="ident" id="6162217">Entry</span><span class="op" id="6162222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162226">if</span>&nbsp;<span class="ident" id="6162229">v</span>&nbsp;<span class="op" id="6162231">:=</span>&nbsp;<span class="ident" id="6162234">Version</span><span class="op" id="6162241">(</span><span class="ident" id="6162242">hdr</span><span class="op" id="6162245">.</span><span class="ident" id="6162246">Version</span><span class="op" id="6162253">)</span><span class="op" id="6162254">;</span>&nbsp;<span class="ident" id="6162256">v</span>&nbsp;<span class="op" id="6162258">!=</span>&nbsp;<span class="ident" id="6162261">f</span><span class="op" id="6162262">.</span><span class="ident" id="6162263">Version</span>&nbsp;<span class="op" id="6162271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162276">return</span>&nbsp;<span class="ident" id="6162283">nil</span><span class="op" id="6162286">,</span>&nbsp;<span class="op" id="6162288">&amp;</span><span class="ident" id="6162289">FormatError</span><span class="op" id="6162300">{</span><span class="num" id="6162301">0</span><span class="op" id="6162302">,</span>&nbsp;<span class="string" id="6162304">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6162328">,</span>&nbsp;<span class="ident" id="6162330">v</span><span class="op" id="6162331">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162339">phoff</span>&nbsp;<span class="op" id="6162345">=</span>&nbsp;<span class="ident" id="6162347">int64</span><span class="op" id="6162352">(</span><span class="ident" id="6162353">hdr</span><span class="op" id="6162356">.</span><span class="ident" id="6162357">Phoff</span><span class="op" id="6162362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162366">phentsize</span>&nbsp;<span class="op" id="6162376">=</span>&nbsp;<span class="builtintype" id="6162378">int</span><span class="op" id="6162381">(</span><span class="ident" id="6162382">hdr</span><span class="op" id="6162385">.</span><span class="ident" id="6162386">Phentsize</span><span class="op" id="6162395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162399">phnum</span>&nbsp;<span class="op" id="6162405">=</span>&nbsp;<span class="builtintype" id="6162407">int</span><span class="op" id="6162410">(</span><span class="ident" id="6162411">hdr</span><span class="op" id="6162414">.</span><span class="ident" id="6162415">Phnum</span><span class="op" id="6162420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162424">shoff</span>&nbsp;<span class="op" id="6162430">=</span>&nbsp;<span class="ident" id="6162432">int64</span><span class="op" id="6162437">(</span><span class="ident" id="6162438">hdr</span><span class="op" id="6162441">.</span><span class="ident" id="6162442">Shoff</span><span class="op" id="6162447">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162451">shentsize</span>&nbsp;<span class="op" id="6162461">=</span>&nbsp;<span class="builtintype" id="6162463">int</span><span class="op" id="6162466">(</span><span class="ident" id="6162467">hdr</span><span class="op" id="6162470">.</span><span class="ident" id="6162471">Shentsize</span><span class="op" id="6162480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162484">shnum</span>&nbsp;<span class="op" id="6162490">=</span>&nbsp;<span class="builtintype" id="6162492">int</span><span class="op" id="6162495">(</span><span class="ident" id="6162496">hdr</span><span class="op" id="6162499">.</span><span class="ident" id="6162500">Shnum</span><span class="op" id="6162505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162509">shstrndx</span>&nbsp;<span class="op" id="6162518">=</span>&nbsp;<span class="builtintype" id="6162520">int</span><span class="op" id="6162523">(</span><span class="ident" id="6162524">hdr</span><span class="op" id="6162527">.</span><span class="ident" id="6162528">Shstrndx</span><span class="op" id="6162536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162539">case</span>&nbsp;<span class="ident" id="6162544">ELFCLASS64</span><span class="op" id="6162554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162558">hdr</span>&nbsp;<span class="op" id="6162562">:=</span>&nbsp;<span class="builtinfunc" id="6162565">new</span><span class="op" id="6162568">(</span><span class="ident" id="6162569">Header64</span><span class="op" id="6162577">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162581">sr</span><span class="op" id="6162583">.</span><span class="ident" id="6162584">Seek</span><span class="op" id="6162588">(</span><span class="num" id="6162589">0</span><span class="op" id="6162590">,</span>&nbsp;<span class="ident" id="6162592">os</span><span class="op" id="6162594">.</span><span class="ident" id="6162595">SEEK_SET</span><span class="op" id="6162603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162607">if</span>&nbsp;<span class="ident" id="6162610">err</span>&nbsp;<span class="op" id="6162614">:=</span>&nbsp;<span class="ident" id="6162617">binary</span><span class="op" id="6162623">.</span><span class="ident" id="6162624">Read</span><span class="op" id="6162628">(</span><span class="ident" id="6162629">sr</span><span class="op" id="6162631">,</span>&nbsp;<span class="ident" id="6162633">f</span><span class="op" id="6162634">.</span><span class="ident" id="6162635">ByteOrder</span><span class="op" id="6162644">,</span>&nbsp;<span class="ident" id="6162646">hdr</span><span class="op" id="6162649">)</span><span class="op" id="6162650">;</span>&nbsp;<span class="ident" id="6162652">err</span>&nbsp;<span class="op" id="6162656">!=</span>&nbsp;<span class="ident" id="6162659">nil</span>&nbsp;<span class="op" id="6162663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162668">return</span>&nbsp;<span class="ident" id="6162675">nil</span><span class="op" id="6162678">,</span>&nbsp;<span class="ident" id="6162680">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162690">f</span><span class="op" id="6162691">.</span><span class="ident" id="6162692">Type</span>&nbsp;<span class="op" id="6162697">=</span>&nbsp;<span class="ident" id="6162699">Type</span><span class="op" id="6162703">(</span><span class="ident" id="6162704">hdr</span><span class="op" id="6162707">.</span><span class="ident" id="6162708">Type</span><span class="op" id="6162712">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162716">f</span><span class="op" id="6162717">.</span><span class="ident" id="6162718">Machine</span>&nbsp;<span class="op" id="6162726">=</span>&nbsp;<span class="ident" id="6162728">Machine</span><span class="op" id="6162735">(</span><span class="ident" id="6162736">hdr</span><span class="op" id="6162739">.</span><span class="ident" id="6162740">Machine</span><span class="op" id="6162747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162751">f</span><span class="op" id="6162752">.</span><span class="ident" id="6162753">Entry</span>&nbsp;<span class="op" id="6162759">=</span>&nbsp;<span class="ident" id="6162761">uint64</span><span class="op" id="6162767">(</span><span class="ident" id="6162768">hdr</span><span class="op" id="6162771">.</span><span class="ident" id="6162772">Entry</span><span class="op" id="6162777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162781">if</span>&nbsp;<span class="ident" id="6162784">v</span>&nbsp;<span class="op" id="6162786">:=</span>&nbsp;<span class="ident" id="6162789">Version</span><span class="op" id="6162796">(</span><span class="ident" id="6162797">hdr</span><span class="op" id="6162800">.</span><span class="ident" id="6162801">Version</span><span class="op" id="6162808">)</span><span class="op" id="6162809">;</span>&nbsp;<span class="ident" id="6162811">v</span>&nbsp;<span class="op" id="6162813">!=</span>&nbsp;<span class="ident" id="6162816">f</span><span class="op" id="6162817">.</span><span class="ident" id="6162818">Version</span>&nbsp;<span class="op" id="6162826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162831">return</span>&nbsp;<span class="ident" id="6162838">nil</span><span class="op" id="6162841">,</span>&nbsp;<span class="op" id="6162843">&amp;</span><span class="ident" id="6162844">FormatError</span><span class="op" id="6162855">{</span><span class="num" id="6162856">0</span><span class="op" id="6162857">,</span>&nbsp;<span class="string" id="6162859">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="6162883">,</span>&nbsp;<span class="ident" id="6162885">v</span><span class="op" id="6162886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162890">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162894">phoff</span>&nbsp;<span class="op" id="6162900">=</span>&nbsp;<span class="ident" id="6162902">int64</span><span class="op" id="6162907">(</span><span class="ident" id="6162908">hdr</span><span class="op" id="6162911">.</span><span class="ident" id="6162912">Phoff</span><span class="op" id="6162917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162921">phentsize</span>&nbsp;<span class="op" id="6162931">=</span>&nbsp;<span class="builtintype" id="6162933">int</span><span class="op" id="6162936">(</span><span class="ident" id="6162937">hdr</span><span class="op" id="6162940">.</span><span class="ident" id="6162941">Phentsize</span><span class="op" id="6162950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162954">phnum</span>&nbsp;<span class="op" id="6162960">=</span>&nbsp;<span class="builtintype" id="6162962">int</span><span class="op" id="6162965">(</span><span class="ident" id="6162966">hdr</span><span class="op" id="6162969">.</span><span class="ident" id="6162970">Phnum</span><span class="op" id="6162975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162979">shoff</span>&nbsp;<span class="op" id="6162985">=</span>&nbsp;<span class="ident" id="6162987">int64</span><span class="op" id="6162992">(</span><span class="ident" id="6162993">hdr</span><span class="op" id="6162996">.</span><span class="ident" id="6162997">Shoff</span><span class="op" id="6163002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163006">shentsize</span>&nbsp;<span class="op" id="6163016">=</span>&nbsp;<span class="builtintype" id="6163018">int</span><span class="op" id="6163021">(</span><span class="ident" id="6163022">hdr</span><span class="op" id="6163025">.</span><span class="ident" id="6163026">Shentsize</span><span class="op" id="6163035">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163039">shnum</span>&nbsp;<span class="op" id="6163045">=</span>&nbsp;<span class="builtintype" id="6163047">int</span><span class="op" id="6163050">(</span><span class="ident" id="6163051">hdr</span><span class="op" id="6163054">.</span><span class="ident" id="6163055">Shnum</span><span class="op" id="6163060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163064">shstrndx</span>&nbsp;<span class="op" id="6163073">=</span>&nbsp;<span class="builtintype" id="6163075">int</span><span class="op" id="6163078">(</span><span class="ident" id="6163079">hdr</span><span class="op" id="6163082">.</span><span class="ident" id="6163083">Shstrndx</span><span class="op" id="6163091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163098">if</span>&nbsp;<span class="ident" id="6163101">shnum</span>&nbsp;<span class="op" id="6163107">&gt;</span>&nbsp;<span class="num" id="6163109">0</span>&nbsp;<span class="op" id="6163111">&amp;&amp;</span>&nbsp;<span class="ident" id="6163114">shoff</span>&nbsp;<span class="op" id="6163120">&gt;</span>&nbsp;<span class="num" id="6163122">0</span>&nbsp;<span class="op" id="6163124">&amp;&amp;</span>&nbsp;<span class="op" id="6163127">(</span><span class="ident" id="6163128">shstrndx</span>&nbsp;<span class="op" id="6163137">&lt;</span>&nbsp;<span class="num" id="6163139">0</span>&nbsp;<span class="op" id="6163141">||</span>&nbsp;<span class="ident" id="6163144">shstrndx</span>&nbsp;<span class="op" id="6163153">&gt;=</span>&nbsp;<span class="ident" id="6163156">shnum</span><span class="op" id="6163161">)</span>&nbsp;<span class="op" id="6163163">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163167">return</span>&nbsp;<span class="ident" id="6163174">nil</span><span class="op" id="6163177">,</span>&nbsp;<span class="op" id="6163179">&amp;</span><span class="ident" id="6163180">FormatError</span><span class="op" id="6163191">{</span><span class="num" id="6163192">0</span><span class="op" id="6163193">,</span>&nbsp;<span class="string" id="6163195">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="6163217">,</span>&nbsp;<span class="ident" id="6163219">shstrndx</span><span class="op" id="6163227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163234">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163259">f</span><span class="op" id="6163260">.</span><span class="ident" id="6163261">Progs</span>&nbsp;<span class="op" id="6163267">=</span>&nbsp;<span class="builtinfunc" id="6163269">make</span><span class="op" id="6163273">(</span><span class="op" id="6163274">[</span><span class="op" id="6163275">]</span><span class="op" id="6163276">*</span><span class="ident" id="6163277">Prog</span><span class="op" id="6163281">,</span>&nbsp;<span class="ident" id="6163283">phnum</span><span class="op" id="6163288">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163291">for</span>&nbsp;<span class="ident" id="6163295">i</span>&nbsp;<span class="op" id="6163297">:=</span>&nbsp;<span class="num" id="6163300">0</span><span class="op" id="6163301">;</span>&nbsp;<span class="ident" id="6163303">i</span>&nbsp;<span class="op" id="6163305">&lt;</span>&nbsp;<span class="ident" id="6163307">phnum</span><span class="op" id="6163312">;</span>&nbsp;<span class="ident" id="6163314">i</span><span class="op" id="6163315">++</span>&nbsp;<span class="op" id="6163318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163322">off</span>&nbsp;<span class="op" id="6163326">:=</span>&nbsp;<span class="ident" id="6163329">phoff</span>&nbsp;<span class="op" id="6163335">+</span>&nbsp;<span class="ident" id="6163337">int64</span><span class="op" id="6163342">(</span><span class="ident" id="6163343">i</span><span class="op" id="6163344">)</span><span class="op" id="6163345">*</span><span class="ident" id="6163346">int64</span><span class="op" id="6163351">(</span><span class="ident" id="6163352">phentsize</span><span class="op" id="6163361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163365">sr</span><span class="op" id="6163367">.</span><span class="ident" id="6163368">Seek</span><span class="op" id="6163372">(</span><span class="ident" id="6163373">off</span><span class="op" id="6163376">,</span>&nbsp;<span class="ident" id="6163378">os</span><span class="op" id="6163380">.</span><span class="ident" id="6163381">SEEK_SET</span><span class="op" id="6163389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163393">p</span>&nbsp;<span class="op" id="6163395">:=</span>&nbsp;<span class="builtinfunc" id="6163398">new</span><span class="op" id="6163401">(</span><span class="ident" id="6163402">Prog</span><span class="op" id="6163406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163410">switch</span>&nbsp;<span class="ident" id="6163417">f</span><span class="op" id="6163418">.</span><span class="ident" id="6163419">Class</span>&nbsp;<span class="op" id="6163425">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163429">case</span>&nbsp;<span class="ident" id="6163434">ELFCLASS32</span><span class="op" id="6163444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163449">ph</span>&nbsp;<span class="op" id="6163452">:=</span>&nbsp;<span class="builtinfunc" id="6163455">new</span><span class="op" id="6163458">(</span><span class="ident" id="6163459">Prog32</span><span class="op" id="6163465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163470">if</span>&nbsp;<span class="ident" id="6163473">err</span>&nbsp;<span class="op" id="6163477">:=</span>&nbsp;<span class="ident" id="6163480">binary</span><span class="op" id="6163486">.</span><span class="ident" id="6163487">Read</span><span class="op" id="6163491">(</span><span class="ident" id="6163492">sr</span><span class="op" id="6163494">,</span>&nbsp;<span class="ident" id="6163496">f</span><span class="op" id="6163497">.</span><span class="ident" id="6163498">ByteOrder</span><span class="op" id="6163507">,</span>&nbsp;<span class="ident" id="6163509">ph</span><span class="op" id="6163511">)</span><span class="op" id="6163512">;</span>&nbsp;<span class="ident" id="6163514">err</span>&nbsp;<span class="op" id="6163518">!=</span>&nbsp;<span class="ident" id="6163521">nil</span>&nbsp;<span class="op" id="6163525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163531">return</span>&nbsp;<span class="ident" id="6163538">nil</span><span class="op" id="6163541">,</span>&nbsp;<span class="ident" id="6163543">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163550">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163555">p</span><span class="op" id="6163556">.</span><span class="ident" id="6163557">ProgHeader</span>&nbsp;<span class="op" id="6163568">=</span>&nbsp;<span class="ident" id="6163570">ProgHeader</span><span class="op" id="6163580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163586">Type</span><span class="op" id="6163590">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6163594">ProgType</span><span class="op" id="6163602">(</span><span class="ident" id="6163603">ph</span><span class="op" id="6163605">.</span><span class="ident" id="6163606">Type</span><span class="op" id="6163610">)</span><span class="op" id="6163611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163617">Flags</span><span class="op" id="6163622">:</span>&nbsp;&nbsp;<span class="ident" id="6163625">ProgFlag</span><span class="op" id="6163633">(</span><span class="ident" id="6163634">ph</span><span class="op" id="6163636">.</span><span class="ident" id="6163637">Flags</span><span class="op" id="6163642">)</span><span class="op" id="6163643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163649">Off</span><span class="op" id="6163652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6163657">uint64</span><span class="op" id="6163663">(</span><span class="ident" id="6163664">ph</span><span class="op" id="6163666">.</span><span class="ident" id="6163667">Off</span><span class="op" id="6163670">)</span><span class="op" id="6163671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163677">Vaddr</span><span class="op" id="6163682">:</span>&nbsp;&nbsp;<span class="ident" id="6163685">uint64</span><span class="op" id="6163691">(</span><span class="ident" id="6163692">ph</span><span class="op" id="6163694">.</span><span class="ident" id="6163695">Vaddr</span><span class="op" id="6163700">)</span><span class="op" id="6163701">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163707">Paddr</span><span class="op" id="6163712">:</span>&nbsp;&nbsp;<span class="ident" id="6163715">uint64</span><span class="op" id="6163721">(</span><span class="ident" id="6163722">ph</span><span class="op" id="6163724">.</span><span class="ident" id="6163725">Paddr</span><span class="op" id="6163730">)</span><span class="op" id="6163731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163737">Filesz</span><span class="op" id="6163743">:</span>&nbsp;<span class="ident" id="6163745">uint64</span><span class="op" id="6163751">(</span><span class="ident" id="6163752">ph</span><span class="op" id="6163754">.</span><span class="ident" id="6163755">Filesz</span><span class="op" id="6163761">)</span><span class="op" id="6163762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163768">Memsz</span><span class="op" id="6163773">:</span>&nbsp;&nbsp;<span class="ident" id="6163776">uint64</span><span class="op" id="6163782">(</span><span class="ident" id="6163783">ph</span><span class="op" id="6163785">.</span><span class="ident" id="6163786">Memsz</span><span class="op" id="6163791">)</span><span class="op" id="6163792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163798">Align</span><span class="op" id="6163803">:</span>&nbsp;&nbsp;<span class="ident" id="6163806">uint64</span><span class="op" id="6163812">(</span><span class="ident" id="6163813">ph</span><span class="op" id="6163815">.</span><span class="ident" id="6163816">Align</span><span class="op" id="6163821">)</span><span class="op" id="6163822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163827">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163831">case</span>&nbsp;<span class="ident" id="6163836">ELFCLASS64</span><span class="op" id="6163846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163851">ph</span>&nbsp;<span class="op" id="6163854">:=</span>&nbsp;<span class="builtinfunc" id="6163857">new</span><span class="op" id="6163860">(</span><span class="ident" id="6163861">Prog64</span><span class="op" id="6163867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163872">if</span>&nbsp;<span class="ident" id="6163875">err</span>&nbsp;<span class="op" id="6163879">:=</span>&nbsp;<span class="ident" id="6163882">binary</span><span class="op" id="6163888">.</span><span class="ident" id="6163889">Read</span><span class="op" id="6163893">(</span><span class="ident" id="6163894">sr</span><span class="op" id="6163896">,</span>&nbsp;<span class="ident" id="6163898">f</span><span class="op" id="6163899">.</span><span class="ident" id="6163900">ByteOrder</span><span class="op" id="6163909">,</span>&nbsp;<span class="ident" id="6163911">ph</span><span class="op" id="6163913">)</span><span class="op" id="6163914">;</span>&nbsp;<span class="ident" id="6163916">err</span>&nbsp;<span class="op" id="6163920">!=</span>&nbsp;<span class="ident" id="6163923">nil</span>&nbsp;<span class="op" id="6163927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163933">return</span>&nbsp;<span class="ident" id="6163940">nil</span><span class="op" id="6163943">,</span>&nbsp;<span class="ident" id="6163945">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163952">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163957">p</span><span class="op" id="6163958">.</span><span class="ident" id="6163959">ProgHeader</span>&nbsp;<span class="op" id="6163970">=</span>&nbsp;<span class="ident" id="6163972">ProgHeader</span><span class="op" id="6163982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163988">Type</span><span class="op" id="6163992">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6163996">ProgType</span><span class="op" id="6164004">(</span><span class="ident" id="6164005">ph</span><span class="op" id="6164007">.</span><span class="ident" id="6164008">Type</span><span class="op" id="6164012">)</span><span class="op" id="6164013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164019">Flags</span><span class="op" id="6164024">:</span>&nbsp;&nbsp;<span class="ident" id="6164027">ProgFlag</span><span class="op" id="6164035">(</span><span class="ident" id="6164036">ph</span><span class="op" id="6164038">.</span><span class="ident" id="6164039">Flags</span><span class="op" id="6164044">)</span><span class="op" id="6164045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164051">Off</span><span class="op" id="6164054">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164059">uint64</span><span class="op" id="6164065">(</span><span class="ident" id="6164066">ph</span><span class="op" id="6164068">.</span><span class="ident" id="6164069">Off</span><span class="op" id="6164072">)</span><span class="op" id="6164073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164079">Vaddr</span><span class="op" id="6164084">:</span>&nbsp;&nbsp;<span class="ident" id="6164087">uint64</span><span class="op" id="6164093">(</span><span class="ident" id="6164094">ph</span><span class="op" id="6164096">.</span><span class="ident" id="6164097">Vaddr</span><span class="op" id="6164102">)</span><span class="op" id="6164103">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164109">Paddr</span><span class="op" id="6164114">:</span>&nbsp;&nbsp;<span class="ident" id="6164117">uint64</span><span class="op" id="6164123">(</span><span class="ident" id="6164124">ph</span><span class="op" id="6164126">.</span><span class="ident" id="6164127">Paddr</span><span class="op" id="6164132">)</span><span class="op" id="6164133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164139">Filesz</span><span class="op" id="6164145">:</span>&nbsp;<span class="ident" id="6164147">uint64</span><span class="op" id="6164153">(</span><span class="ident" id="6164154">ph</span><span class="op" id="6164156">.</span><span class="ident" id="6164157">Filesz</span><span class="op" id="6164163">)</span><span class="op" id="6164164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164170">Memsz</span><span class="op" id="6164175">:</span>&nbsp;&nbsp;<span class="ident" id="6164178">uint64</span><span class="op" id="6164184">(</span><span class="ident" id="6164185">ph</span><span class="op" id="6164187">.</span><span class="ident" id="6164188">Memsz</span><span class="op" id="6164193">)</span><span class="op" id="6164194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164200">Align</span><span class="op" id="6164205">:</span>&nbsp;&nbsp;<span class="ident" id="6164208">uint64</span><span class="op" id="6164214">(</span><span class="ident" id="6164215">ph</span><span class="op" id="6164217">.</span><span class="ident" id="6164218">Align</span><span class="op" id="6164223">)</span><span class="op" id="6164224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164229">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164237">p</span><span class="op" id="6164238">.</span><span class="ident" id="6164239">sr</span>&nbsp;<span class="op" id="6164242">=</span>&nbsp;<span class="ident" id="6164244">io</span><span class="op" id="6164246">.</span><span class="ident" id="6164247">NewSectionReader</span><span class="op" id="6164263">(</span><span class="ident" id="6164264">r</span><span class="op" id="6164265">,</span>&nbsp;<span class="ident" id="6164267">int64</span><span class="op" id="6164272">(</span><span class="ident" id="6164273">p</span><span class="op" id="6164274">.</span><span class="ident" id="6164275">Off</span><span class="op" id="6164278">)</span><span class="op" id="6164279">,</span>&nbsp;<span class="ident" id="6164281">int64</span><span class="op" id="6164286">(</span><span class="ident" id="6164287">p</span><span class="op" id="6164288">.</span><span class="ident" id="6164289">Filesz</span><span class="op" id="6164295">)</span><span class="op" id="6164296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164300">p</span><span class="op" id="6164301">.</span><span class="ident" id="6164302">ReaderAt</span>&nbsp;<span class="op" id="6164311">=</span>&nbsp;<span class="ident" id="6164313">p</span><span class="op" id="6164314">.</span><span class="ident" id="6164315">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164320">f</span><span class="op" id="6164321">.</span><span class="ident" id="6164322">Progs</span><span class="op" id="6164327">[</span><span class="ident" id="6164328">i</span><span class="op" id="6164329">]</span>&nbsp;<span class="op" id="6164331">=</span>&nbsp;<span class="ident" id="6164333">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164336">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164340">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164365">f</span><span class="op" id="6164366">.</span><span class="ident" id="6164367">Sections</span>&nbsp;<span class="op" id="6164376">=</span>&nbsp;<span class="builtinfunc" id="6164378">make</span><span class="op" id="6164382">(</span><span class="op" id="6164383">[</span><span class="op" id="6164384">]</span><span class="op" id="6164385">*</span><span class="ident" id="6164386">Section</span><span class="op" id="6164393">,</span>&nbsp;<span class="ident" id="6164395">shnum</span><span class="op" id="6164400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164403">names</span>&nbsp;<span class="op" id="6164409">:=</span>&nbsp;<span class="builtinfunc" id="6164412">make</span><span class="op" id="6164416">(</span><span class="op" id="6164417">[</span><span class="op" id="6164418">]</span><span class="builtintype" id="6164419">uint32</span><span class="op" id="6164425">,</span>&nbsp;<span class="ident" id="6164427">shnum</span><span class="op" id="6164432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164435">for</span>&nbsp;<span class="ident" id="6164439">i</span>&nbsp;<span class="op" id="6164441">:=</span>&nbsp;<span class="num" id="6164444">0</span><span class="op" id="6164445">;</span>&nbsp;<span class="ident" id="6164447">i</span>&nbsp;<span class="op" id="6164449">&lt;</span>&nbsp;<span class="ident" id="6164451">shnum</span><span class="op" id="6164456">;</span>&nbsp;<span class="ident" id="6164458">i</span><span class="op" id="6164459">++</span>&nbsp;<span class="op" id="6164462">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164466">off</span>&nbsp;<span class="op" id="6164470">:=</span>&nbsp;<span class="ident" id="6164473">shoff</span>&nbsp;<span class="op" id="6164479">+</span>&nbsp;<span class="ident" id="6164481">int64</span><span class="op" id="6164486">(</span><span class="ident" id="6164487">i</span><span class="op" id="6164488">)</span><span class="op" id="6164489">*</span><span class="ident" id="6164490">int64</span><span class="op" id="6164495">(</span><span class="ident" id="6164496">shentsize</span><span class="op" id="6164505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164509">sr</span><span class="op" id="6164511">.</span><span class="ident" id="6164512">Seek</span><span class="op" id="6164516">(</span><span class="ident" id="6164517">off</span><span class="op" id="6164520">,</span>&nbsp;<span class="ident" id="6164522">os</span><span class="op" id="6164524">.</span><span class="ident" id="6164525">SEEK_SET</span><span class="op" id="6164533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164537">s</span>&nbsp;<span class="op" id="6164539">:=</span>&nbsp;<span class="builtinfunc" id="6164542">new</span><span class="op" id="6164545">(</span><span class="ident" id="6164546">Section</span><span class="op" id="6164553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164557">switch</span>&nbsp;<span class="ident" id="6164564">f</span><span class="op" id="6164565">.</span><span class="ident" id="6164566">Class</span>&nbsp;<span class="op" id="6164572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164576">case</span>&nbsp;<span class="ident" id="6164581">ELFCLASS32</span><span class="op" id="6164591">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164596">sh</span>&nbsp;<span class="op" id="6164599">:=</span>&nbsp;<span class="builtinfunc" id="6164602">new</span><span class="op" id="6164605">(</span><span class="ident" id="6164606">Section32</span><span class="op" id="6164615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164620">if</span>&nbsp;<span class="ident" id="6164623">err</span>&nbsp;<span class="op" id="6164627">:=</span>&nbsp;<span class="ident" id="6164630">binary</span><span class="op" id="6164636">.</span><span class="ident" id="6164637">Read</span><span class="op" id="6164641">(</span><span class="ident" id="6164642">sr</span><span class="op" id="6164644">,</span>&nbsp;<span class="ident" id="6164646">f</span><span class="op" id="6164647">.</span><span class="ident" id="6164648">ByteOrder</span><span class="op" id="6164657">,</span>&nbsp;<span class="ident" id="6164659">sh</span><span class="op" id="6164661">)</span><span class="op" id="6164662">;</span>&nbsp;<span class="ident" id="6164664">err</span>&nbsp;<span class="op" id="6164668">!=</span>&nbsp;<span class="ident" id="6164671">nil</span>&nbsp;<span class="op" id="6164675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164681">return</span>&nbsp;<span class="ident" id="6164688">nil</span><span class="op" id="6164691">,</span>&nbsp;<span class="ident" id="6164693">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164705">names</span><span class="op" id="6164710">[</span><span class="ident" id="6164711">i</span><span class="op" id="6164712">]</span>&nbsp;<span class="op" id="6164714">=</span>&nbsp;<span class="ident" id="6164716">sh</span><span class="op" id="6164718">.</span><span class="ident" id="6164719">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164727">s</span><span class="op" id="6164728">.</span><span class="ident" id="6164729">SectionHeader</span>&nbsp;<span class="op" id="6164743">=</span>&nbsp;<span class="ident" id="6164745">SectionHeader</span><span class="op" id="6164758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164764">Type</span><span class="op" id="6164768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164775">SectionType</span><span class="op" id="6164786">(</span><span class="ident" id="6164787">sh</span><span class="op" id="6164789">.</span><span class="ident" id="6164790">Type</span><span class="op" id="6164794">)</span><span class="op" id="6164795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164801">Flags</span><span class="op" id="6164806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164812">SectionFlag</span><span class="op" id="6164823">(</span><span class="ident" id="6164824">sh</span><span class="op" id="6164826">.</span><span class="ident" id="6164827">Flags</span><span class="op" id="6164832">)</span><span class="op" id="6164833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164839">Addr</span><span class="op" id="6164843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164850">uint64</span><span class="op" id="6164856">(</span><span class="ident" id="6164857">sh</span><span class="op" id="6164859">.</span><span class="ident" id="6164860">Addr</span><span class="op" id="6164864">)</span><span class="op" id="6164865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164871">Offset</span><span class="op" id="6164877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164882">uint64</span><span class="op" id="6164888">(</span><span class="ident" id="6164889">sh</span><span class="op" id="6164891">.</span><span class="ident" id="6164892">Off</span><span class="op" id="6164895">)</span><span class="op" id="6164896">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164902">Size</span><span class="op" id="6164906">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6164913">uint64</span><span class="op" id="6164919">(</span><span class="ident" id="6164920">sh</span><span class="op" id="6164922">.</span><span class="ident" id="6164923">Size</span><span class="op" id="6164927">)</span><span class="op" id="6164928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164934">Link</span><span class="op" id="6164938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6164945">uint32</span><span class="op" id="6164951">(</span><span class="ident" id="6164952">sh</span><span class="op" id="6164954">.</span><span class="ident" id="6164955">Link</span><span class="op" id="6164959">)</span><span class="op" id="6164960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164966">Info</span><span class="op" id="6164970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6164977">uint32</span><span class="op" id="6164983">(</span><span class="ident" id="6164984">sh</span><span class="op" id="6164986">.</span><span class="ident" id="6164987">Info</span><span class="op" id="6164991">)</span><span class="op" id="6164992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164998">Addralign</span><span class="op" id="6165007">:</span>&nbsp;<span class="ident" id="6165009">uint64</span><span class="op" id="6165015">(</span><span class="ident" id="6165016">sh</span><span class="op" id="6165018">.</span><span class="ident" id="6165019">Addralign</span><span class="op" id="6165028">)</span><span class="op" id="6165029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165035">Entsize</span><span class="op" id="6165042">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6165046">uint64</span><span class="op" id="6165052">(</span><span class="ident" id="6165053">sh</span><span class="op" id="6165055">.</span><span class="ident" id="6165056">Entsize</span><span class="op" id="6165063">)</span><span class="op" id="6165064">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165073">case</span>&nbsp;<span class="ident" id="6165078">ELFCLASS64</span><span class="op" id="6165088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165093">sh</span>&nbsp;<span class="op" id="6165096">:=</span>&nbsp;<span class="builtinfunc" id="6165099">new</span><span class="op" id="6165102">(</span><span class="ident" id="6165103">Section64</span><span class="op" id="6165112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165117">if</span>&nbsp;<span class="ident" id="6165120">err</span>&nbsp;<span class="op" id="6165124">:=</span>&nbsp;<span class="ident" id="6165127">binary</span><span class="op" id="6165133">.</span><span class="ident" id="6165134">Read</span><span class="op" id="6165138">(</span><span class="ident" id="6165139">sr</span><span class="op" id="6165141">,</span>&nbsp;<span class="ident" id="6165143">f</span><span class="op" id="6165144">.</span><span class="ident" id="6165145">ByteOrder</span><span class="op" id="6165154">,</span>&nbsp;<span class="ident" id="6165156">sh</span><span class="op" id="6165158">)</span><span class="op" id="6165159">;</span>&nbsp;<span class="ident" id="6165161">err</span>&nbsp;<span class="op" id="6165165">!=</span>&nbsp;<span class="ident" id="6165168">nil</span>&nbsp;<span class="op" id="6165172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165178">return</span>&nbsp;<span class="ident" id="6165185">nil</span><span class="op" id="6165188">,</span>&nbsp;<span class="ident" id="6165190">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165202">names</span><span class="op" id="6165207">[</span><span class="ident" id="6165208">i</span><span class="op" id="6165209">]</span>&nbsp;<span class="op" id="6165211">=</span>&nbsp;<span class="ident" id="6165213">sh</span><span class="op" id="6165215">.</span><span class="ident" id="6165216">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165224">s</span><span class="op" id="6165225">.</span><span class="ident" id="6165226">SectionHeader</span>&nbsp;<span class="op" id="6165240">=</span>&nbsp;<span class="ident" id="6165242">SectionHeader</span><span class="op" id="6165255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165261">Type</span><span class="op" id="6165265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6165272">SectionType</span><span class="op" id="6165283">(</span><span class="ident" id="6165284">sh</span><span class="op" id="6165286">.</span><span class="ident" id="6165287">Type</span><span class="op" id="6165291">)</span><span class="op" id="6165292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165298">Flags</span><span class="op" id="6165303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6165309">SectionFlag</span><span class="op" id="6165320">(</span><span class="ident" id="6165321">sh</span><span class="op" id="6165323">.</span><span class="ident" id="6165324">Flags</span><span class="op" id="6165329">)</span><span class="op" id="6165330">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165336">Offset</span><span class="op" id="6165342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6165347">uint64</span><span class="op" id="6165353">(</span><span class="ident" id="6165354">sh</span><span class="op" id="6165356">.</span><span class="ident" id="6165357">Off</span><span class="op" id="6165360">)</span><span class="op" id="6165361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165367">Size</span><span class="op" id="6165371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6165378">uint64</span><span class="op" id="6165384">(</span><span class="ident" id="6165385">sh</span><span class="op" id="6165387">.</span><span class="ident" id="6165388">Size</span><span class="op" id="6165392">)</span><span class="op" id="6165393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165399">Addr</span><span class="op" id="6165403">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6165410">uint64</span><span class="op" id="6165416">(</span><span class="ident" id="6165417">sh</span><span class="op" id="6165419">.</span><span class="ident" id="6165420">Addr</span><span class="op" id="6165424">)</span><span class="op" id="6165425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165431">Link</span><span class="op" id="6165435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6165442">uint32</span><span class="op" id="6165448">(</span><span class="ident" id="6165449">sh</span><span class="op" id="6165451">.</span><span class="ident" id="6165452">Link</span><span class="op" id="6165456">)</span><span class="op" id="6165457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165463">Info</span><span class="op" id="6165467">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6165474">uint32</span><span class="op" id="6165480">(</span><span class="ident" id="6165481">sh</span><span class="op" id="6165483">.</span><span class="ident" id="6165484">Info</span><span class="op" id="6165488">)</span><span class="op" id="6165489">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165495">Addralign</span><span class="op" id="6165504">:</span>&nbsp;<span class="ident" id="6165506">uint64</span><span class="op" id="6165512">(</span><span class="ident" id="6165513">sh</span><span class="op" id="6165515">.</span><span class="ident" id="6165516">Addralign</span><span class="op" id="6165525">)</span><span class="op" id="6165526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165532">Entsize</span><span class="op" id="6165539">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6165543">uint64</span><span class="op" id="6165549">(</span><span class="ident" id="6165550">sh</span><span class="op" id="6165552">.</span><span class="ident" id="6165553">Entsize</span><span class="op" id="6165560">)</span><span class="op" id="6165561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165574">s</span><span class="op" id="6165575">.</span><span class="ident" id="6165576">sr</span>&nbsp;<span class="op" id="6165579">=</span>&nbsp;<span class="ident" id="6165581">io</span><span class="op" id="6165583">.</span><span class="ident" id="6165584">NewSectionReader</span><span class="op" id="6165600">(</span><span class="ident" id="6165601">r</span><span class="op" id="6165602">,</span>&nbsp;<span class="ident" id="6165604">int64</span><span class="op" id="6165609">(</span><span class="ident" id="6165610">s</span><span class="op" id="6165611">.</span><span class="ident" id="6165612">Offset</span><span class="op" id="6165618">)</span><span class="op" id="6165619">,</span>&nbsp;<span class="ident" id="6165621">int64</span><span class="op" id="6165626">(</span><span class="ident" id="6165627">s</span><span class="op" id="6165628">.</span><span class="ident" id="6165629">Size</span><span class="op" id="6165633">)</span><span class="op" id="6165634">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165638">s</span><span class="op" id="6165639">.</span><span class="ident" id="6165640">ReaderAt</span>&nbsp;<span class="op" id="6165649">=</span>&nbsp;<span class="ident" id="6165651">s</span><span class="op" id="6165652">.</span><span class="ident" id="6165653">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165658">f</span><span class="op" id="6165659">.</span><span class="ident" id="6165660">Sections</span><span class="op" id="6165668">[</span><span class="ident" id="6165669">i</span><span class="op" id="6165670">]</span>&nbsp;<span class="op" id="6165672">=</span>&nbsp;<span class="ident" id="6165674">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165681">if</span>&nbsp;<span class="builtinfunc" id="6165684">len</span><span class="op" id="6165687">(</span><span class="ident" id="6165688">f</span><span class="op" id="6165689">.</span><span class="ident" id="6165690">Sections</span><span class="op" id="6165698">)</span>&nbsp;<span class="op" id="6165700">==</span>&nbsp;<span class="num" id="6165703">0</span>&nbsp;<span class="op" id="6165705">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165709">return</span>&nbsp;<span class="ident" id="6165716">f</span><span class="op" id="6165717">,</span>&nbsp;<span class="ident" id="6165719">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165728">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165766">shstrtab</span><span class="op" id="6165774">,</span>&nbsp;<span class="ident" id="6165776">err</span>&nbsp;<span class="op" id="6165780">:=</span>&nbsp;<span class="ident" id="6165783">f</span><span class="op" id="6165784">.</span><span class="ident" id="6165785">Sections</span><span class="op" id="6165793">[</span><span class="ident" id="6165794">shstrndx</span><span class="op" id="6165802">]</span><span class="op" id="6165803">.</span><span class="ident" id="6165804">Data</span><span class="op" id="6165808">(</span><span class="op" id="6165809">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165812">if</span>&nbsp;<span class="ident" id="6165815">err</span>&nbsp;<span class="op" id="6165819">!=</span>&nbsp;<span class="ident" id="6165822">nil</span>&nbsp;<span class="op" id="6165826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165830">return</span>&nbsp;<span class="ident" id="6165837">nil</span><span class="op" id="6165840">,</span>&nbsp;<span class="ident" id="6165842">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165850">for</span>&nbsp;<span class="ident" id="6165854">i</span><span class="op" id="6165855">,</span>&nbsp;<span class="ident" id="6165857">s</span>&nbsp;<span class="op" id="6165859">:=</span>&nbsp;<span class="keyword" id="6165862">range</span>&nbsp;<span class="ident" id="6165868">f</span><span class="op" id="6165869">.</span><span class="ident" id="6165870">Sections</span>&nbsp;<span class="op" id="6165879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165883">var</span>&nbsp;<span class="ident" id="6165887">ok</span>&nbsp;<span class="builtintype" id="6165890">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165897">s</span><span class="op" id="6165898">.</span><span class="ident" id="6165899">Name</span><span class="op" id="6165903">,</span>&nbsp;<span class="ident" id="6165905">ok</span>&nbsp;<span class="op" id="6165908">=</span>&nbsp;<span class="ident" id="6165910">getString</span><span class="op" id="6165919">(</span><span class="ident" id="6165920">shstrtab</span><span class="op" id="6165928">,</span>&nbsp;<span class="builtintype" id="6165930">int</span><span class="op" id="6165933">(</span><span class="ident" id="6165934">names</span><span class="op" id="6165939">[</span><span class="ident" id="6165940">i</span><span class="op" id="6165941">]</span><span class="op" id="6165942">)</span><span class="op" id="6165943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165947">if</span>&nbsp;<span class="op" id="6165950">!</span><span class="ident" id="6165951">ok</span>&nbsp;<span class="op" id="6165954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165959">return</span>&nbsp;<span class="ident" id="6165966">nil</span><span class="op" id="6165969">,</span>&nbsp;<span class="op" id="6165971">&amp;</span><span class="ident" id="6165972">FormatError</span><span class="op" id="6165983">{</span><span class="ident" id="6165984">shoff</span>&nbsp;<span class="op" id="6165990">+</span>&nbsp;<span class="ident" id="6165992">int64</span><span class="op" id="6165997">(</span><span class="ident" id="6165998">i</span><span class="op" id="6165999">*</span><span class="ident" id="6166000">shentsize</span><span class="op" id="6166009">)</span><span class="op" id="6166010">,</span>&nbsp;<span class="string" id="6166012">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="6166036">,</span>&nbsp;<span class="ident" id="6166038">names</span><span class="op" id="6166043">[</span><span class="ident" id="6166044">i</span><span class="op" id="6166045">]</span><span class="op" id="6166046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166053">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166057">return</span>&nbsp;<span class="ident" id="6166064">f</span><span class="op" id="6166065">,</span>&nbsp;<span class="ident" id="6166067">nil</span><br>
<span class="lineno"></span><span class="op" id="6166071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6166074">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="6166145">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6166209">func</span>&nbsp;<span class="op" id="6166214">(</span><span class="ident" id="6166215">f</span>&nbsp;<span class="op" id="6166217">*</span><span class="ident" id="6166218">File</span><span class="op" id="6166222">)</span>&nbsp;<span class="ident" id="6166224">getSymbols</span><span class="op" id="6166234">(</span><span class="ident" id="6166235">typ</span>&nbsp;<span class="ident" id="6166239">SectionType</span><span class="op" id="6166250">)</span>&nbsp;<span class="op" id="6166252">(</span><span class="op" id="6166253">[</span><span class="op" id="6166254">]</span><span class="ident" id="6166255">Symbol</span><span class="op" id="6166261">,</span>&nbsp;<span class="op" id="6166263">[</span><span class="op" id="6166264">]</span><span class="builtintype" id="6166265">byte</span><span class="op" id="6166269">,</span>&nbsp;<span class="builtintype" id="6166271">error</span><span class="op" id="6166276">)</span>&nbsp;<span class="op" id="6166278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166281">switch</span>&nbsp;<span class="ident" id="6166288">f</span><span class="op" id="6166289">.</span><span class="ident" id="6166290">Class</span>&nbsp;<span class="op" id="6166296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166299">case</span>&nbsp;<span class="ident" id="6166304">ELFCLASS64</span><span class="op" id="6166314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166318">return</span>&nbsp;<span class="ident" id="6166325">f</span><span class="op" id="6166326">.</span><span class="ident" id="6166327">getSymbols64</span><span class="op" id="6166339">(</span><span class="ident" id="6166340">typ</span><span class="op" id="6166343">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166347">case</span>&nbsp;<span class="ident" id="6166352">ELFCLASS32</span><span class="op" id="6166362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166366">return</span>&nbsp;<span class="ident" id="6166373">f</span><span class="op" id="6166374">.</span><span class="ident" id="6166375">getSymbols32</span><span class="op" id="6166387">(</span><span class="ident" id="6166388">typ</span><span class="op" id="6166391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166398">return</span>&nbsp;<span class="ident" id="6166405">nil</span><span class="op" id="6166408">,</span>&nbsp;<span class="ident" id="6166410">nil</span><span class="op" id="6166413">,</span>&nbsp;<span class="ident" id="6166415">errors</span><span class="op" id="6166421">.</span><span class="ident" id="6166422">New</span><span class="op" id="6166425">(</span><span class="string" id="6166426">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6166443">)</span><br>
<span class="lineno"></span><span class="op" id="6166445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6166448">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="6166516">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="6166560">var</span>&nbsp;<span class="ident" id="6166564">ErrNoSymbols</span>&nbsp;<span class="op" id="6166577">=</span>&nbsp;<span class="ident" id="6166579">errors</span><span class="op" id="6166585">.</span><span class="ident" id="6166586">New</span><span class="op" id="6166589">(</span><span class="string" id="6166590">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6166609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6166612">func</span>&nbsp;<span class="op" id="6166617">(</span><span class="ident" id="6166618">f</span>&nbsp;<span class="op" id="6166620">*</span><span class="ident" id="6166621">File</span><span class="op" id="6166625">)</span>&nbsp;<span class="ident" id="6166627">getSymbols32</span><span class="op" id="6166639">(</span><span class="ident" id="6166640">typ</span>&nbsp;<span class="ident" id="6166644">SectionType</span><span class="op" id="6166655">)</span>&nbsp;<span class="op" id="6166657">(</span><span class="op" id="6166658">[</span><span class="op" id="6166659">]</span><span class="ident" id="6166660">Symbol</span><span class="op" id="6166666">,</span>&nbsp;<span class="op" id="6166668">[</span><span class="op" id="6166669">]</span><span class="builtintype" id="6166670">byte</span><span class="op" id="6166674">,</span>&nbsp;<span class="builtintype" id="6166676">error</span><span class="op" id="6166681">)</span>&nbsp;<span class="op" id="6166683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166686">symtabSection</span>&nbsp;<span class="op" id="6166700">:=</span>&nbsp;<span class="ident" id="6166703">f</span><span class="op" id="6166704">.</span><span class="ident" id="6166705">SectionByType</span><span class="op" id="6166718">(</span><span class="ident" id="6166719">typ</span><span class="op" id="6166722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166725">if</span>&nbsp;<span class="ident" id="6166728">symtabSection</span>&nbsp;<span class="op" id="6166742">==</span>&nbsp;<span class="ident" id="6166745">nil</span>&nbsp;<span class="op" id="6166749">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166753">return</span>&nbsp;<span class="ident" id="6166760">nil</span><span class="op" id="6166763">,</span>&nbsp;<span class="ident" id="6166765">nil</span><span class="op" id="6166768">,</span>&nbsp;<span class="ident" id="6166770">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166788">data</span><span class="op" id="6166792">,</span>&nbsp;<span class="ident" id="6166794">err</span>&nbsp;<span class="op" id="6166798">:=</span>&nbsp;<span class="ident" id="6166801">symtabSection</span><span class="op" id="6166814">.</span><span class="ident" id="6166815">Data</span><span class="op" id="6166819">(</span><span class="op" id="6166820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166823">if</span>&nbsp;<span class="ident" id="6166826">err</span>&nbsp;<span class="op" id="6166830">!=</span>&nbsp;<span class="ident" id="6166833">nil</span>&nbsp;<span class="op" id="6166837">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166841">return</span>&nbsp;<span class="ident" id="6166848">nil</span><span class="op" id="6166851">,</span>&nbsp;<span class="ident" id="6166853">nil</span><span class="op" id="6166856">,</span>&nbsp;<span class="ident" id="6166858">errors</span><span class="op" id="6166864">.</span><span class="ident" id="6166865">New</span><span class="op" id="6166868">(</span><span class="string" id="6166869">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6166897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166903">symtab</span>&nbsp;<span class="op" id="6166910">:=</span>&nbsp;<span class="ident" id="6166913">bytes</span><span class="op" id="6166918">.</span><span class="ident" id="6166919">NewReader</span><span class="op" id="6166928">(</span><span class="ident" id="6166929">data</span><span class="op" id="6166933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166936">if</span>&nbsp;<span class="ident" id="6166939">symtab</span><span class="op" id="6166945">.</span><span class="ident" id="6166946">Len</span><span class="op" id="6166949">(</span><span class="op" id="6166950">)</span><span class="op" id="6166951">%</span><span class="ident" id="6166952">Sym32Size</span>&nbsp;<span class="op" id="6166962">!=</span>&nbsp;<span class="num" id="6166965">0</span>&nbsp;<span class="op" id="6166967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166971">return</span>&nbsp;<span class="ident" id="6166978">nil</span><span class="op" id="6166981">,</span>&nbsp;<span class="ident" id="6166983">nil</span><span class="op" id="6166986">,</span>&nbsp;<span class="ident" id="6166988">errors</span><span class="op" id="6166994">.</span><span class="ident" id="6166995">New</span><span class="op" id="6166998">(</span><span class="string" id="6166999">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="6167054">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167061">strdata</span><span class="op" id="6167068">,</span>&nbsp;<span class="ident" id="6167070">err</span>&nbsp;<span class="op" id="6167074">:=</span>&nbsp;<span class="ident" id="6167077">f</span><span class="op" id="6167078">.</span><span class="ident" id="6167079">stringTable</span><span class="op" id="6167090">(</span><span class="ident" id="6167091">symtabSection</span><span class="op" id="6167104">.</span><span class="ident" id="6167105">Link</span><span class="op" id="6167109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167112">if</span>&nbsp;<span class="ident" id="6167115">err</span>&nbsp;<span class="op" id="6167119">!=</span>&nbsp;<span class="ident" id="6167122">nil</span>&nbsp;<span class="op" id="6167126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167130">return</span>&nbsp;<span class="ident" id="6167137">nil</span><span class="op" id="6167140">,</span>&nbsp;<span class="ident" id="6167142">nil</span><span class="op" id="6167145">,</span>&nbsp;<span class="ident" id="6167147">errors</span><span class="op" id="6167153">.</span><span class="ident" id="6167154">New</span><span class="op" id="6167157">(</span><span class="string" id="6167158">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6167192">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167199">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167233">var</span>&nbsp;<span class="ident" id="6167237">skip</span>&nbsp;<span class="op" id="6167242">[</span><span class="ident" id="6167243">Sym32Size</span><span class="op" id="6167252">]</span><span class="builtintype" id="6167253">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167259">symtab</span><span class="op" id="6167265">.</span><span class="ident" id="6167266">Read</span><span class="op" id="6167270">(</span><span class="ident" id="6167271">skip</span><span class="op" id="6167275">[</span><span class="op" id="6167276">:</span><span class="op" id="6167277">]</span><span class="op" id="6167278">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167282">symbols</span>&nbsp;<span class="op" id="6167290">:=</span>&nbsp;<span class="builtinfunc" id="6167293">make</span><span class="op" id="6167297">(</span><span class="op" id="6167298">[</span><span class="op" id="6167299">]</span><span class="ident" id="6167300">Symbol</span><span class="op" id="6167306">,</span>&nbsp;<span class="ident" id="6167308">symtab</span><span class="op" id="6167314">.</span><span class="ident" id="6167315">Len</span><span class="op" id="6167318">(</span><span class="op" id="6167319">)</span><span class="op" id="6167320">/</span><span class="ident" id="6167321">Sym32Size</span><span class="op" id="6167330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167334">i</span>&nbsp;<span class="op" id="6167336">:=</span>&nbsp;<span class="num" id="6167339">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167342">var</span>&nbsp;<span class="ident" id="6167346">sym</span>&nbsp;<span class="ident" id="6167350">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167357">for</span>&nbsp;<span class="ident" id="6167361">symtab</span><span class="op" id="6167367">.</span><span class="ident" id="6167368">Len</span><span class="op" id="6167371">(</span><span class="op" id="6167372">)</span>&nbsp;<span class="op" id="6167374">&gt;</span>&nbsp;<span class="num" id="6167376">0</span>&nbsp;<span class="op" id="6167378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167382">binary</span><span class="op" id="6167388">.</span><span class="ident" id="6167389">Read</span><span class="op" id="6167393">(</span><span class="ident" id="6167394">symtab</span><span class="op" id="6167400">,</span>&nbsp;<span class="ident" id="6167402">f</span><span class="op" id="6167403">.</span><span class="ident" id="6167404">ByteOrder</span><span class="op" id="6167413">,</span>&nbsp;<span class="op" id="6167415">&amp;</span><span class="ident" id="6167416">sym</span><span class="op" id="6167419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167423">str</span><span class="op" id="6167426">,</span>&nbsp;<span class="ident" id="6167428">_</span>&nbsp;<span class="op" id="6167430">:=</span>&nbsp;<span class="ident" id="6167433">getString</span><span class="op" id="6167442">(</span><span class="ident" id="6167443">strdata</span><span class="op" id="6167450">,</span>&nbsp;<span class="builtintype" id="6167452">int</span><span class="op" id="6167455">(</span><span class="ident" id="6167456">sym</span><span class="op" id="6167459">.</span><span class="ident" id="6167460">Name</span><span class="op" id="6167464">)</span><span class="op" id="6167465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167469">symbols</span><span class="op" id="6167476">[</span><span class="ident" id="6167477">i</span><span class="op" id="6167478">]</span><span class="op" id="6167479">.</span><span class="ident" id="6167480">Name</span>&nbsp;<span class="op" id="6167485">=</span>&nbsp;<span class="ident" id="6167487">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167493">symbols</span><span class="op" id="6167500">[</span><span class="ident" id="6167501">i</span><span class="op" id="6167502">]</span><span class="op" id="6167503">.</span><span class="ident" id="6167504">Info</span>&nbsp;<span class="op" id="6167509">=</span>&nbsp;<span class="ident" id="6167511">sym</span><span class="op" id="6167514">.</span><span class="ident" id="6167515">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167522">symbols</span><span class="op" id="6167529">[</span><span class="ident" id="6167530">i</span><span class="op" id="6167531">]</span><span class="op" id="6167532">.</span><span class="ident" id="6167533">Other</span>&nbsp;<span class="op" id="6167539">=</span>&nbsp;<span class="ident" id="6167541">sym</span><span class="op" id="6167544">.</span><span class="ident" id="6167545">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167553">symbols</span><span class="op" id="6167560">[</span><span class="ident" id="6167561">i</span><span class="op" id="6167562">]</span><span class="op" id="6167563">.</span><span class="ident" id="6167564">Section</span>&nbsp;<span class="op" id="6167572">=</span>&nbsp;<span class="ident" id="6167574">SectionIndex</span><span class="op" id="6167586">(</span><span class="ident" id="6167587">sym</span><span class="op" id="6167590">.</span><span class="ident" id="6167591">Shndx</span><span class="op" id="6167596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167600">symbols</span><span class="op" id="6167607">[</span><span class="ident" id="6167608">i</span><span class="op" id="6167609">]</span><span class="op" id="6167610">.</span><span class="ident" id="6167611">Value</span>&nbsp;<span class="op" id="6167617">=</span>&nbsp;<span class="ident" id="6167619">uint64</span><span class="op" id="6167625">(</span><span class="ident" id="6167626">sym</span><span class="op" id="6167629">.</span><span class="ident" id="6167630">Value</span><span class="op" id="6167635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167639">symbols</span><span class="op" id="6167646">[</span><span class="ident" id="6167647">i</span><span class="op" id="6167648">]</span><span class="op" id="6167649">.</span><span class="ident" id="6167650">Size</span>&nbsp;<span class="op" id="6167655">=</span>&nbsp;<span class="ident" id="6167657">uint64</span><span class="op" id="6167663">(</span><span class="ident" id="6167664">sym</span><span class="op" id="6167667">.</span><span class="ident" id="6167668">Size</span><span class="op" id="6167672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167676">i</span><span class="op" id="6167677">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167685">return</span>&nbsp;<span class="ident" id="6167692">symbols</span><span class="op" id="6167699">,</span>&nbsp;<span class="ident" id="6167701">strdata</span><span class="op" id="6167708">,</span>&nbsp;<span class="ident" id="6167710">nil</span><br>
<span class="lineno"></span><span class="op" id="6167714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="6167717">func</span>&nbsp;<span class="op" id="6167722">(</span><span class="ident" id="6167723">f</span>&nbsp;<span class="op" id="6167725">*</span><span class="ident" id="6167726">File</span><span class="op" id="6167730">)</span>&nbsp;<span class="ident" id="6167732">getSymbols64</span><span class="op" id="6167744">(</span><span class="ident" id="6167745">typ</span>&nbsp;<span class="ident" id="6167749">SectionType</span><span class="op" id="6167760">)</span>&nbsp;<span class="op" id="6167762">(</span><span class="op" id="6167763">[</span><span class="op" id="6167764">]</span><span class="ident" id="6167765">Symbol</span><span class="op" id="6167771">,</span>&nbsp;<span class="op" id="6167773">[</span><span class="op" id="6167774">]</span><span class="builtintype" id="6167775">byte</span><span class="op" id="6167779">,</span>&nbsp;<span class="builtintype" id="6167781">error</span><span class="op" id="6167786">)</span>&nbsp;<span class="op" id="6167788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167791">symtabSection</span>&nbsp;<span class="op" id="6167805">:=</span>&nbsp;<span class="ident" id="6167808">f</span><span class="op" id="6167809">.</span><span class="ident" id="6167810">SectionByType</span><span class="op" id="6167823">(</span><span class="ident" id="6167824">typ</span><span class="op" id="6167827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167830">if</span>&nbsp;<span class="ident" id="6167833">symtabSection</span>&nbsp;<span class="op" id="6167847">==</span>&nbsp;<span class="ident" id="6167850">nil</span>&nbsp;<span class="op" id="6167854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167858">return</span>&nbsp;<span class="ident" id="6167865">nil</span><span class="op" id="6167868">,</span>&nbsp;<span class="ident" id="6167870">nil</span><span class="op" id="6167873">,</span>&nbsp;<span class="ident" id="6167875">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167889">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167893">data</span><span class="op" id="6167897">,</span>&nbsp;<span class="ident" id="6167899">err</span>&nbsp;<span class="op" id="6167903">:=</span>&nbsp;<span class="ident" id="6167906">symtabSection</span><span class="op" id="6167919">.</span><span class="ident" id="6167920">Data</span><span class="op" id="6167924">(</span><span class="op" id="6167925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167928">if</span>&nbsp;<span class="ident" id="6167931">err</span>&nbsp;<span class="op" id="6167935">!=</span>&nbsp;<span class="ident" id="6167938">nil</span>&nbsp;<span class="op" id="6167942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167946">return</span>&nbsp;<span class="ident" id="6167953">nil</span><span class="op" id="6167956">,</span>&nbsp;<span class="ident" id="6167958">nil</span><span class="op" id="6167961">,</span>&nbsp;<span class="ident" id="6167963">errors</span><span class="op" id="6167969">.</span><span class="ident" id="6167970">New</span><span class="op" id="6167973">(</span><span class="string" id="6167974">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6168002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168005">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168008">symtab</span>&nbsp;<span class="op" id="6168015">:=</span>&nbsp;<span class="ident" id="6168018">bytes</span><span class="op" id="6168023">.</span><span class="ident" id="6168024">NewReader</span><span class="op" id="6168033">(</span><span class="ident" id="6168034">data</span><span class="op" id="6168038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168041">if</span>&nbsp;<span class="ident" id="6168044">symtab</span><span class="op" id="6168050">.</span><span class="ident" id="6168051">Len</span><span class="op" id="6168054">(</span><span class="op" id="6168055">)</span><span class="op" id="6168056">%</span><span class="ident" id="6168057">Sym64Size</span>&nbsp;<span class="op" id="6168067">!=</span>&nbsp;<span class="num" id="6168070">0</span>&nbsp;<span class="op" id="6168072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168076">return</span>&nbsp;<span class="ident" id="6168083">nil</span><span class="op" id="6168086">,</span>&nbsp;<span class="ident" id="6168088">nil</span><span class="op" id="6168091">,</span>&nbsp;<span class="ident" id="6168093">errors</span><span class="op" id="6168099">.</span><span class="ident" id="6168100">New</span><span class="op" id="6168103">(</span><span class="string" id="6168104">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="6168161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168168">strdata</span><span class="op" id="6168175">,</span>&nbsp;<span class="ident" id="6168177">err</span>&nbsp;<span class="op" id="6168181">:=</span>&nbsp;<span class="ident" id="6168184">f</span><span class="op" id="6168185">.</span><span class="ident" id="6168186">stringTable</span><span class="op" id="6168197">(</span><span class="ident" id="6168198">symtabSection</span><span class="op" id="6168211">.</span><span class="ident" id="6168212">Link</span><span class="op" id="6168216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168219">if</span>&nbsp;<span class="ident" id="6168222">err</span>&nbsp;<span class="op" id="6168226">!=</span>&nbsp;<span class="ident" id="6168229">nil</span>&nbsp;<span class="op" id="6168233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168237">return</span>&nbsp;<span class="ident" id="6168244">nil</span><span class="op" id="6168247">,</span>&nbsp;<span class="ident" id="6168249">nil</span><span class="op" id="6168252">,</span>&nbsp;<span class="ident" id="6168254">errors</span><span class="op" id="6168260">.</span><span class="ident" id="6168261">New</span><span class="op" id="6168264">(</span><span class="string" id="6168265">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="6168299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168306">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168340">var</span>&nbsp;<span class="ident" id="6168344">skip</span>&nbsp;<span class="op" id="6168349">[</span><span class="ident" id="6168350">Sym64Size</span><span class="op" id="6168359">]</span><span class="builtintype" id="6168360">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168366">symtab</span><span class="op" id="6168372">.</span><span class="ident" id="6168373">Read</span><span class="op" id="6168377">(</span><span class="ident" id="6168378">skip</span><span class="op" id="6168382">[</span><span class="op" id="6168383">:</span><span class="op" id="6168384">]</span><span class="op" id="6168385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168389">symbols</span>&nbsp;<span class="op" id="6168397">:=</span>&nbsp;<span class="builtinfunc" id="6168400">make</span><span class="op" id="6168404">(</span><span class="op" id="6168405">[</span><span class="op" id="6168406">]</span><span class="ident" id="6168407">Symbol</span><span class="op" id="6168413">,</span>&nbsp;<span class="ident" id="6168415">symtab</span><span class="op" id="6168421">.</span><span class="ident" id="6168422">Len</span><span class="op" id="6168425">(</span><span class="op" id="6168426">)</span><span class="op" id="6168427">/</span><span class="ident" id="6168428">Sym64Size</span><span class="op" id="6168437">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168441">i</span>&nbsp;<span class="op" id="6168443">:=</span>&nbsp;<span class="num" id="6168446">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168449">var</span>&nbsp;<span class="ident" id="6168453">sym</span>&nbsp;<span class="ident" id="6168457">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168464">for</span>&nbsp;<span class="ident" id="6168468">symtab</span><span class="op" id="6168474">.</span><span class="ident" id="6168475">Len</span><span class="op" id="6168478">(</span><span class="op" id="6168479">)</span>&nbsp;<span class="op" id="6168481">&gt;</span>&nbsp;<span class="num" id="6168483">0</span>&nbsp;<span class="op" id="6168485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168489">binary</span><span class="op" id="6168495">.</span><span class="ident" id="6168496">Read</span><span class="op" id="6168500">(</span><span class="ident" id="6168501">symtab</span><span class="op" id="6168507">,</span>&nbsp;<span class="ident" id="6168509">f</span><span class="op" id="6168510">.</span><span class="ident" id="6168511">ByteOrder</span><span class="op" id="6168520">,</span>&nbsp;<span class="op" id="6168522">&amp;</span><span class="ident" id="6168523">sym</span><span class="op" id="6168526">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168530">str</span><span class="op" id="6168533">,</span>&nbsp;<span class="ident" id="6168535">_</span>&nbsp;<span class="op" id="6168537">:=</span>&nbsp;<span class="ident" id="6168540">getString</span><span class="op" id="6168549">(</span><span class="ident" id="6168550">strdata</span><span class="op" id="6168557">,</span>&nbsp;<span class="builtintype" id="6168559">int</span><span class="op" id="6168562">(</span><span class="ident" id="6168563">sym</span><span class="op" id="6168566">.</span><span class="ident" id="6168567">Name</span><span class="op" id="6168571">)</span><span class="op" id="6168572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168576">symbols</span><span class="op" id="6168583">[</span><span class="ident" id="6168584">i</span><span class="op" id="6168585">]</span><span class="op" id="6168586">.</span><span class="ident" id="6168587">Name</span>&nbsp;<span class="op" id="6168592">=</span>&nbsp;<span class="ident" id="6168594">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168600">symbols</span><span class="op" id="6168607">[</span><span class="ident" id="6168608">i</span><span class="op" id="6168609">]</span><span class="op" id="6168610">.</span><span class="ident" id="6168611">Info</span>&nbsp;<span class="op" id="6168616">=</span>&nbsp;<span class="ident" id="6168618">sym</span><span class="op" id="6168621">.</span><span class="ident" id="6168622">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168629">symbols</span><span class="op" id="6168636">[</span><span class="ident" id="6168637">i</span><span class="op" id="6168638">]</span><span class="op" id="6168639">.</span><span class="ident" id="6168640">Other</span>&nbsp;<span class="op" id="6168646">=</span>&nbsp;<span class="ident" id="6168648">sym</span><span class="op" id="6168651">.</span><span class="ident" id="6168652">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168660">symbols</span><span class="op" id="6168667">[</span><span class="ident" id="6168668">i</span><span class="op" id="6168669">]</span><span class="op" id="6168670">.</span><span class="ident" id="6168671">Section</span>&nbsp;<span class="op" id="6168679">=</span>&nbsp;<span class="ident" id="6168681">SectionIndex</span><span class="op" id="6168693">(</span><span class="ident" id="6168694">sym</span><span class="op" id="6168697">.</span><span class="ident" id="6168698">Shndx</span><span class="op" id="6168703">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168707">symbols</span><span class="op" id="6168714">[</span><span class="ident" id="6168715">i</span><span class="op" id="6168716">]</span><span class="op" id="6168717">.</span><span class="ident" id="6168718">Value</span>&nbsp;<span class="op" id="6168724">=</span>&nbsp;<span class="ident" id="6168726">sym</span><span class="op" id="6168729">.</span><span class="ident" id="6168730">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168738">symbols</span><span class="op" id="6168745">[</span><span class="ident" id="6168746">i</span><span class="op" id="6168747">]</span><span class="op" id="6168748">.</span><span class="ident" id="6168749">Size</span>&nbsp;<span class="op" id="6168754">=</span>&nbsp;<span class="ident" id="6168756">sym</span><span class="op" id="6168759">.</span><span class="ident" id="6168760">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168767">i</span><span class="op" id="6168768">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168776">return</span>&nbsp;<span class="ident" id="6168783">symbols</span><span class="op" id="6168790">,</span>&nbsp;<span class="ident" id="6168792">strdata</span><span class="op" id="6168799">,</span>&nbsp;<span class="ident" id="6168801">nil</span><br>
<span class="lineno"></span><span class="op" id="6168805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6168808">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6168865">func</span>&nbsp;<span class="ident" id="6168870">getString</span><span class="op" id="6168879">(</span><span class="ident" id="6168880">section</span>&nbsp;<span class="op" id="6168888">[</span><span class="op" id="6168889">]</span><span class="builtintype" id="6168890">byte</span><span class="op" id="6168894">,</span>&nbsp;<span class="ident" id="6168896">start</span>&nbsp;<span class="builtintype" id="6168902">int</span><span class="op" id="6168905">)</span>&nbsp;<span class="op" id="6168907">(</span><span class="builtintype" id="6168908">string</span><span class="op" id="6168914">,</span>&nbsp;<span class="builtintype" id="6168916">bool</span><span class="op" id="6168920">)</span>&nbsp;<span class="op" id="6168922">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168925">if</span>&nbsp;<span class="ident" id="6168928">start</span>&nbsp;<span class="op" id="6168934">&lt;</span>&nbsp;<span class="num" id="6168936">0</span>&nbsp;<span class="op" id="6168938">||</span>&nbsp;<span class="ident" id="6168941">start</span>&nbsp;<span class="op" id="6168947">&gt;=</span>&nbsp;<span class="builtinfunc" id="6168950">len</span><span class="op" id="6168953">(</span><span class="ident" id="6168954">section</span><span class="op" id="6168961">)</span>&nbsp;<span class="op" id="6168963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168967">return</span>&nbsp;<span class="string" id="6168974">&#34;&#34;</span><span class="op" id="6168976">,</span>&nbsp;<span class="builtintype" id="6168978">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168989">for</span>&nbsp;<span class="ident" id="6168993">end</span>&nbsp;<span class="op" id="6168997">:=</span>&nbsp;<span class="ident" id="6169000">start</span><span class="op" id="6169005">;</span>&nbsp;<span class="ident" id="6169007">end</span>&nbsp;<span class="op" id="6169011">&lt;</span>&nbsp;<span class="builtinfunc" id="6169013">len</span><span class="op" id="6169016">(</span><span class="ident" id="6169017">section</span><span class="op" id="6169024">)</span><span class="op" id="6169025">;</span>&nbsp;<span class="ident" id="6169027">end</span><span class="op" id="6169030">++</span>&nbsp;<span class="op" id="6169033">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169037">if</span>&nbsp;<span class="ident" id="6169040">section</span><span class="op" id="6169047">[</span><span class="ident" id="6169048">end</span><span class="op" id="6169051">]</span>&nbsp;<span class="op" id="6169053">==</span>&nbsp;<span class="num" id="6169056">0</span>&nbsp;<span class="op" id="6169058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169063">return</span>&nbsp;<span class="builtintype" id="6169070">string</span><span class="op" id="6169076">(</span><span class="ident" id="6169077">section</span><span class="op" id="6169084">[</span><span class="ident" id="6169085">start</span><span class="op" id="6169090">:</span><span class="ident" id="6169091">end</span><span class="op" id="6169094">]</span><span class="op" id="6169095">)</span><span class="op" id="6169096">,</span>&nbsp;<span class="builtintype" id="6169098">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169111">return</span>&nbsp;<span class="string" id="6169118">&#34;&#34;</span><span class="op" id="6169120">,</span>&nbsp;<span class="builtintype" id="6169122">false</span><br>
<span class="lineno">510</span><span class="op" id="6169128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6169131">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6169199">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6169218">func</span>&nbsp;<span class="op" id="6169223">(</span><span class="ident" id="6169224">f</span>&nbsp;<span class="op" id="6169226">*</span><span class="ident" id="6169227">File</span><span class="op" id="6169231">)</span>&nbsp;<span class="ident" id="6169233">Section</span><span class="op" id="6169240">(</span><span class="ident" id="6169241">name</span>&nbsp;<span class="builtintype" id="6169246">string</span><span class="op" id="6169252">)</span>&nbsp;<span class="op" id="6169254">*</span><span class="ident" id="6169255">Section</span>&nbsp;<span class="op" id="6169263">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169266">for</span>&nbsp;<span class="ident" id="6169270">_</span><span class="op" id="6169271">,</span>&nbsp;<span class="ident" id="6169273">s</span>&nbsp;<span class="op" id="6169275">:=</span>&nbsp;<span class="keyword" id="6169278">range</span>&nbsp;<span class="ident" id="6169284">f</span><span class="op" id="6169285">.</span><span class="ident" id="6169286">Sections</span>&nbsp;<span class="op" id="6169295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169299">if</span>&nbsp;<span class="ident" id="6169302">s</span><span class="op" id="6169303">.</span><span class="ident" id="6169304">Name</span>&nbsp;<span class="op" id="6169309">==</span>&nbsp;<span class="ident" id="6169312">name</span>&nbsp;<span class="op" id="6169317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169322">return</span>&nbsp;<span class="ident" id="6169329">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169336">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169339">return</span>&nbsp;<span class="ident" id="6169346">nil</span><br>
<span class="lineno"></span><span class="op" id="6169350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6169353">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="6169431">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="6169450">func</span>&nbsp;<span class="op" id="6169455">(</span><span class="ident" id="6169456">f</span>&nbsp;<span class="op" id="6169458">*</span><span class="ident" id="6169459">File</span><span class="op" id="6169463">)</span>&nbsp;<span class="ident" id="6169465">applyRelocations</span><span class="op" id="6169481">(</span><span class="ident" id="6169482">dst</span>&nbsp;<span class="op" id="6169486">[</span><span class="op" id="6169487">]</span><span class="builtintype" id="6169488">byte</span><span class="op" id="6169492">,</span>&nbsp;<span class="ident" id="6169494">rels</span>&nbsp;<span class="op" id="6169499">[</span><span class="op" id="6169500">]</span><span class="builtintype" id="6169501">byte</span><span class="op" id="6169505">)</span>&nbsp;<span class="builtintype" id="6169507">error</span>&nbsp;<span class="op" id="6169513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169516">if</span>&nbsp;<span class="ident" id="6169519">f</span><span class="op" id="6169520">.</span><span class="ident" id="6169521">Class</span>&nbsp;<span class="op" id="6169527">==</span>&nbsp;<span class="ident" id="6169530">ELFCLASS64</span>&nbsp;<span class="op" id="6169541">&amp;&amp;</span>&nbsp;<span class="ident" id="6169544">f</span><span class="op" id="6169545">.</span><span class="ident" id="6169546">Machine</span>&nbsp;<span class="op" id="6169554">==</span>&nbsp;<span class="ident" id="6169557">EM_X86_64</span>&nbsp;<span class="op" id="6169567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169571">return</span>&nbsp;<span class="ident" id="6169578">f</span><span class="op" id="6169579">.</span><span class="ident" id="6169580">applyRelocationsAMD64</span><span class="op" id="6169601">(</span><span class="ident" id="6169602">dst</span><span class="op" id="6169605">,</span>&nbsp;<span class="ident" id="6169607">rels</span><span class="op" id="6169611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169617">if</span>&nbsp;<span class="ident" id="6169620">f</span><span class="op" id="6169621">.</span><span class="ident" id="6169622">Class</span>&nbsp;<span class="op" id="6169628">==</span>&nbsp;<span class="ident" id="6169631">ELFCLASS32</span>&nbsp;<span class="op" id="6169642">&amp;&amp;</span>&nbsp;<span class="ident" id="6169645">f</span><span class="op" id="6169646">.</span><span class="ident" id="6169647">Machine</span>&nbsp;<span class="op" id="6169655">==</span>&nbsp;<span class="ident" id="6169658">EM_386</span>&nbsp;<span class="op" id="6169665">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169669">return</span>&nbsp;<span class="ident" id="6169676">f</span><span class="op" id="6169677">.</span><span class="ident" id="6169678">applyRelocations386</span><span class="op" id="6169697">(</span><span class="ident" id="6169698">dst</span><span class="op" id="6169701">,</span>&nbsp;<span class="ident" id="6169703">rels</span><span class="op" id="6169707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169713">if</span>&nbsp;<span class="ident" id="6169716">f</span><span class="op" id="6169717">.</span><span class="ident" id="6169718">Class</span>&nbsp;<span class="op" id="6169724">==</span>&nbsp;<span class="ident" id="6169727">ELFCLASS64</span>&nbsp;<span class="op" id="6169738">&amp;&amp;</span>&nbsp;<span class="ident" id="6169741">f</span><span class="op" id="6169742">.</span><span class="ident" id="6169743">Machine</span>&nbsp;<span class="op" id="6169751">==</span>&nbsp;<span class="ident" id="6169754">EM_AARCH64</span>&nbsp;<span class="op" id="6169765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169769">return</span>&nbsp;<span class="ident" id="6169776">f</span><span class="op" id="6169777">.</span><span class="ident" id="6169778">applyRelocationsARM64</span><span class="op" id="6169799">(</span><span class="ident" id="6169800">dst</span><span class="op" id="6169803">,</span>&nbsp;<span class="ident" id="6169805">rels</span><span class="op" id="6169809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6169812">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169816">return</span>&nbsp;<span class="ident" id="6169823">errors</span><span class="op" id="6169829">.</span><span class="ident" id="6169830">New</span><span class="op" id="6169833">(</span><span class="string" id="6169834">&#34;not&nbsp;implemented&#34;</span><span class="op" id="6169851">)</span><br>
<span class="lineno"></span><span class="op" id="6169853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6169856">func</span>&nbsp;<span class="op" id="6169861">(</span><span class="ident" id="6169862">f</span>&nbsp;<span class="op" id="6169864">*</span><span class="ident" id="6169865">File</span><span class="op" id="6169869">)</span>&nbsp;<span class="ident" id="6169871">applyRelocationsAMD64</span><span class="op" id="6169892">(</span><span class="ident" id="6169893">dst</span>&nbsp;<span class="op" id="6169897">[</span><span class="op" id="6169898">]</span><span class="builtintype" id="6169899">byte</span><span class="op" id="6169903">,</span>&nbsp;<span class="ident" id="6169905">rels</span>&nbsp;<span class="op" id="6169910">[</span><span class="op" id="6169911">]</span><span class="builtintype" id="6169912">byte</span><span class="op" id="6169916">)</span>&nbsp;<span class="builtintype" id="6169918">error</span>&nbsp;<span class="op" id="6169924">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169927">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169957">if</span>&nbsp;<span class="builtinfunc" id="6169960">len</span><span class="op" id="6169963">(</span><span class="ident" id="6169964">rels</span><span class="op" id="6169968">)</span><span class="op" id="6169969">%</span><span class="num" id="6169970">24</span>&nbsp;<span class="op" id="6169973">!=</span>&nbsp;<span class="num" id="6169976">0</span>&nbsp;<span class="op" id="6169978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6169982">return</span>&nbsp;<span class="ident" id="6169989">errors</span><span class="op" id="6169995">.</span><span class="ident" id="6169996">New</span><span class="op" id="6169999">(</span><span class="string" id="6170000">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6170054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170061">symbols</span><span class="op" id="6170068">,</span>&nbsp;<span class="ident" id="6170070">_</span><span class="op" id="6170071">,</span>&nbsp;<span class="ident" id="6170073">err</span>&nbsp;<span class="op" id="6170077">:=</span>&nbsp;<span class="ident" id="6170080">f</span><span class="op" id="6170081">.</span><span class="ident" id="6170082">getSymbols</span><span class="op" id="6170092">(</span><span class="ident" id="6170093">SHT_SYMTAB</span><span class="op" id="6170103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170106">if</span>&nbsp;<span class="ident" id="6170109">err</span>&nbsp;<span class="op" id="6170113">!=</span>&nbsp;<span class="ident" id="6170116">nil</span>&nbsp;<span class="op" id="6170120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170124">return</span>&nbsp;<span class="ident" id="6170131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170140">b</span>&nbsp;<span class="op" id="6170142">:=</span>&nbsp;<span class="ident" id="6170145">bytes</span><span class="op" id="6170150">.</span><span class="ident" id="6170151">NewReader</span><span class="op" id="6170160">(</span><span class="ident" id="6170161">rels</span><span class="op" id="6170165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170168">var</span>&nbsp;<span class="ident" id="6170172">rela</span>&nbsp;<span class="ident" id="6170177">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170186">for</span>&nbsp;<span class="ident" id="6170190">b</span><span class="op" id="6170191">.</span><span class="ident" id="6170192">Len</span><span class="op" id="6170195">(</span><span class="op" id="6170196">)</span>&nbsp;<span class="op" id="6170198">&gt;</span>&nbsp;<span class="num" id="6170200">0</span>&nbsp;<span class="op" id="6170202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170206">binary</span><span class="op" id="6170212">.</span><span class="ident" id="6170213">Read</span><span class="op" id="6170217">(</span><span class="ident" id="6170218">b</span><span class="op" id="6170219">,</span>&nbsp;<span class="ident" id="6170221">f</span><span class="op" id="6170222">.</span><span class="ident" id="6170223">ByteOrder</span><span class="op" id="6170232">,</span>&nbsp;<span class="op" id="6170234">&amp;</span><span class="ident" id="6170235">rela</span><span class="op" id="6170239">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170243">symNo</span>&nbsp;<span class="op" id="6170249">:=</span>&nbsp;<span class="ident" id="6170252">rela</span><span class="op" id="6170256">.</span><span class="ident" id="6170257">Info</span>&nbsp;<span class="op" id="6170262">&gt;&gt;</span>&nbsp;<span class="num" id="6170265">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170270">t</span>&nbsp;<span class="op" id="6170272">:=</span>&nbsp;<span class="ident" id="6170275">R_X86_64</span><span class="op" id="6170283">(</span><span class="ident" id="6170284">rela</span><span class="op" id="6170288">.</span><span class="ident" id="6170289">Info</span>&nbsp;<span class="op" id="6170294">&amp;</span>&nbsp;<span class="num" id="6170296">0xffff</span><span class="op" id="6170302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170307">if</span>&nbsp;<span class="ident" id="6170310">symNo</span>&nbsp;<span class="op" id="6170316">==</span>&nbsp;<span class="num" id="6170319">0</span>&nbsp;<span class="op" id="6170321">||</span>&nbsp;<span class="ident" id="6170324">symNo</span>&nbsp;<span class="op" id="6170330">&gt;</span>&nbsp;<span class="ident" id="6170332">uint64</span><span class="op" id="6170338">(</span><span class="builtinfunc" id="6170339">len</span><span class="op" id="6170342">(</span><span class="ident" id="6170343">symbols</span><span class="op" id="6170350">)</span><span class="op" id="6170351">)</span>&nbsp;<span class="op" id="6170353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170358">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170373">sym</span>&nbsp;<span class="op" id="6170377">:=</span>&nbsp;<span class="op" id="6170380">&amp;</span><span class="ident" id="6170381">symbols</span><span class="op" id="6170388">[</span><span class="ident" id="6170389">symNo</span><span class="op" id="6170394">-</span><span class="num" id="6170395">1</span><span class="op" id="6170396">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170400">if</span>&nbsp;<span class="ident" id="6170403">SymType</span><span class="op" id="6170410">(</span><span class="ident" id="6170411">sym</span><span class="op" id="6170414">.</span><span class="ident" id="6170415">Info</span><span class="op" id="6170419">&amp;</span><span class="num" id="6170420">0xf</span><span class="op" id="6170423">)</span>&nbsp;<span class="op" id="6170425">!=</span>&nbsp;<span class="ident" id="6170428">STT_SECTION</span>&nbsp;<span class="op" id="6170440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170445">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170500">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170516">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170569">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170624">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170671">switch</span>&nbsp;<span class="ident" id="6170678">t</span>&nbsp;<span class="op" id="6170680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170684">case</span>&nbsp;<span class="ident" id="6170689">R_X86_64_64</span><span class="op" id="6170700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170705">if</span>&nbsp;<span class="ident" id="6170708">rela</span><span class="op" id="6170712">.</span><span class="ident" id="6170713">Off</span><span class="op" id="6170716">+</span><span class="num" id="6170717">8</span>&nbsp;<span class="op" id="6170719">&gt;=</span>&nbsp;<span class="ident" id="6170722">uint64</span><span class="op" id="6170728">(</span><span class="builtinfunc" id="6170729">len</span><span class="op" id="6170732">(</span><span class="ident" id="6170733">dst</span><span class="op" id="6170736">)</span><span class="op" id="6170737">)</span>&nbsp;<span class="op" id="6170739">||</span>&nbsp;<span class="ident" id="6170742">rela</span><span class="op" id="6170746">.</span><span class="ident" id="6170747">Addend</span>&nbsp;<span class="op" id="6170754">&lt;</span>&nbsp;<span class="num" id="6170756">0</span>&nbsp;<span class="op" id="6170758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170764">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170781">f</span><span class="op" id="6170782">.</span><span class="ident" id="6170783">ByteOrder</span><span class="op" id="6170792">.</span><span class="ident" id="6170793">PutUint64</span><span class="op" id="6170802">(</span><span class="ident" id="6170803">dst</span><span class="op" id="6170806">[</span><span class="ident" id="6170807">rela</span><span class="op" id="6170811">.</span><span class="ident" id="6170812">Off</span><span class="op" id="6170815">:</span><span class="ident" id="6170816">rela</span><span class="op" id="6170820">.</span><span class="ident" id="6170821">Off</span><span class="op" id="6170824">+</span><span class="num" id="6170825">8</span><span class="op" id="6170826">]</span><span class="op" id="6170827">,</span>&nbsp;<span class="ident" id="6170829">uint64</span><span class="op" id="6170835">(</span><span class="ident" id="6170836">rela</span><span class="op" id="6170840">.</span><span class="ident" id="6170841">Addend</span><span class="op" id="6170847">)</span><span class="op" id="6170848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170852">case</span>&nbsp;<span class="ident" id="6170857">R_X86_64_32</span><span class="op" id="6170868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170873">if</span>&nbsp;<span class="ident" id="6170876">rela</span><span class="op" id="6170880">.</span><span class="ident" id="6170881">Off</span><span class="op" id="6170884">+</span><span class="num" id="6170885">4</span>&nbsp;<span class="op" id="6170887">&gt;=</span>&nbsp;<span class="ident" id="6170890">uint64</span><span class="op" id="6170896">(</span><span class="builtinfunc" id="6170897">len</span><span class="op" id="6170900">(</span><span class="ident" id="6170901">dst</span><span class="op" id="6170904">)</span><span class="op" id="6170905">)</span>&nbsp;<span class="op" id="6170907">||</span>&nbsp;<span class="ident" id="6170910">rela</span><span class="op" id="6170914">.</span><span class="ident" id="6170915">Addend</span>&nbsp;<span class="op" id="6170922">&lt;</span>&nbsp;<span class="num" id="6170924">0</span>&nbsp;<span class="op" id="6170926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6170932">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6170944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170949">f</span><span class="op" id="6170950">.</span><span class="ident" id="6170951">ByteOrder</span><span class="op" id="6170960">.</span><span class="ident" id="6170961">PutUint32</span><span class="op" id="6170970">(</span><span class="ident" id="6170971">dst</span><span class="op" id="6170974">[</span><span class="ident" id="6170975">rela</span><span class="op" id="6170979">.</span><span class="ident" id="6170980">Off</span><span class="op" id="6170983">:</span><span class="ident" id="6170984">rela</span><span class="op" id="6170988">.</span><span class="ident" id="6170989">Off</span><span class="op" id="6170992">+</span><span class="num" id="6170993">4</span><span class="op" id="6170994">]</span><span class="op" id="6170995">,</span>&nbsp;<span class="builtintype" id="6170997">uint32</span><span class="op" id="6171003">(</span><span class="ident" id="6171004">rela</span><span class="op" id="6171008">.</span><span class="ident" id="6171009">Addend</span><span class="op" id="6171015">)</span><span class="op" id="6171016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171027">return</span>&nbsp;<span class="ident" id="6171034">nil</span><br>
<span class="lineno"></span><span class="op" id="6171038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6171041">func</span>&nbsp;<span class="op" id="6171046">(</span><span class="ident" id="6171047">f</span>&nbsp;<span class="op" id="6171049">*</span><span class="ident" id="6171050">File</span><span class="op" id="6171054">)</span>&nbsp;<span class="ident" id="6171056">applyRelocations386</span><span class="op" id="6171075">(</span><span class="ident" id="6171076">dst</span>&nbsp;<span class="op" id="6171080">[</span><span class="op" id="6171081">]</span><span class="builtintype" id="6171082">byte</span><span class="op" id="6171086">,</span>&nbsp;<span class="ident" id="6171088">rels</span>&nbsp;<span class="op" id="6171093">[</span><span class="op" id="6171094">]</span><span class="builtintype" id="6171095">byte</span><span class="op" id="6171099">)</span>&nbsp;<span class="builtintype" id="6171101">error</span>&nbsp;<span class="op" id="6171107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6171110">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171138">if</span>&nbsp;<span class="builtinfunc" id="6171141">len</span><span class="op" id="6171144">(</span><span class="ident" id="6171145">rels</span><span class="op" id="6171149">)</span><span class="op" id="6171150">%</span><span class="num" id="6171151">8</span>&nbsp;<span class="op" id="6171153">!=</span>&nbsp;<span class="num" id="6171156">0</span>&nbsp;<span class="op" id="6171158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171162">return</span>&nbsp;<span class="ident" id="6171169">errors</span><span class="op" id="6171175">.</span><span class="ident" id="6171176">New</span><span class="op" id="6171179">(</span><span class="string" id="6171180">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="6171233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171240">symbols</span><span class="op" id="6171247">,</span>&nbsp;<span class="ident" id="6171249">_</span><span class="op" id="6171250">,</span>&nbsp;<span class="ident" id="6171252">err</span>&nbsp;<span class="op" id="6171256">:=</span>&nbsp;<span class="ident" id="6171259">f</span><span class="op" id="6171260">.</span><span class="ident" id="6171261">getSymbols</span><span class="op" id="6171271">(</span><span class="ident" id="6171272">SHT_SYMTAB</span><span class="op" id="6171282">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171285">if</span>&nbsp;<span class="ident" id="6171288">err</span>&nbsp;<span class="op" id="6171292">!=</span>&nbsp;<span class="ident" id="6171295">nil</span>&nbsp;<span class="op" id="6171299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171303">return</span>&nbsp;<span class="ident" id="6171310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171319">b</span>&nbsp;<span class="op" id="6171321">:=</span>&nbsp;<span class="ident" id="6171324">bytes</span><span class="op" id="6171329">.</span><span class="ident" id="6171330">NewReader</span><span class="op" id="6171339">(</span><span class="ident" id="6171340">rels</span><span class="op" id="6171344">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171347">var</span>&nbsp;<span class="ident" id="6171351">rel</span>&nbsp;<span class="ident" id="6171355">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171363">for</span>&nbsp;<span class="ident" id="6171367">b</span><span class="op" id="6171368">.</span><span class="ident" id="6171369">Len</span><span class="op" id="6171372">(</span><span class="op" id="6171373">)</span>&nbsp;<span class="op" id="6171375">&gt;</span>&nbsp;<span class="num" id="6171377">0</span>&nbsp;<span class="op" id="6171379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171383">binary</span><span class="op" id="6171389">.</span><span class="ident" id="6171390">Read</span><span class="op" id="6171394">(</span><span class="ident" id="6171395">b</span><span class="op" id="6171396">,</span>&nbsp;<span class="ident" id="6171398">f</span><span class="op" id="6171399">.</span><span class="ident" id="6171400">ByteOrder</span><span class="op" id="6171409">,</span>&nbsp;<span class="op" id="6171411">&amp;</span><span class="ident" id="6171412">rel</span><span class="op" id="6171415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171419">symNo</span>&nbsp;<span class="op" id="6171425">:=</span>&nbsp;<span class="ident" id="6171428">rel</span><span class="op" id="6171431">.</span><span class="ident" id="6171432">Info</span>&nbsp;<span class="op" id="6171437">&gt;&gt;</span>&nbsp;<span class="num" id="6171440">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171444">t</span>&nbsp;<span class="op" id="6171446">:=</span>&nbsp;<span class="ident" id="6171449">R_386</span><span class="op" id="6171454">(</span><span class="ident" id="6171455">rel</span><span class="op" id="6171458">.</span><span class="ident" id="6171459">Info</span>&nbsp;<span class="op" id="6171464">&amp;</span>&nbsp;<span class="num" id="6171466">0xff</span><span class="op" id="6171470">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171475">if</span>&nbsp;<span class="ident" id="6171478">symNo</span>&nbsp;<span class="op" id="6171484">==</span>&nbsp;<span class="num" id="6171487">0</span>&nbsp;<span class="op" id="6171489">||</span>&nbsp;<span class="ident" id="6171492">symNo</span>&nbsp;<span class="op" id="6171498">&gt;</span>&nbsp;<span class="builtintype" id="6171500">uint32</span><span class="op" id="6171506">(</span><span class="builtinfunc" id="6171507">len</span><span class="op" id="6171510">(</span><span class="ident" id="6171511">symbols</span><span class="op" id="6171518">)</span><span class="op" id="6171519">)</span>&nbsp;<span class="op" id="6171521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171526">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171537">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171541">sym</span>&nbsp;<span class="op" id="6171545">:=</span>&nbsp;<span class="op" id="6171548">&amp;</span><span class="ident" id="6171549">symbols</span><span class="op" id="6171556">[</span><span class="ident" id="6171557">symNo</span><span class="op" id="6171562">-</span><span class="num" id="6171563">1</span><span class="op" id="6171564">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171569">if</span>&nbsp;<span class="ident" id="6171572">t</span>&nbsp;<span class="op" id="6171574">==</span>&nbsp;<span class="ident" id="6171577">R_386_32</span>&nbsp;<span class="op" id="6171586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171591">if</span>&nbsp;<span class="ident" id="6171594">rel</span><span class="op" id="6171597">.</span><span class="ident" id="6171598">Off</span><span class="op" id="6171601">+</span><span class="num" id="6171602">4</span>&nbsp;<span class="op" id="6171604">&gt;=</span>&nbsp;<span class="builtintype" id="6171607">uint32</span><span class="op" id="6171613">(</span><span class="builtinfunc" id="6171614">len</span><span class="op" id="6171617">(</span><span class="ident" id="6171618">dst</span><span class="op" id="6171621">)</span><span class="op" id="6171622">)</span>&nbsp;<span class="op" id="6171624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171630">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171647">val</span>&nbsp;<span class="op" id="6171651">:=</span>&nbsp;<span class="ident" id="6171654">f</span><span class="op" id="6171655">.</span><span class="ident" id="6171656">ByteOrder</span><span class="op" id="6171665">.</span><span class="ident" id="6171666">Uint32</span><span class="op" id="6171672">(</span><span class="ident" id="6171673">dst</span><span class="op" id="6171676">[</span><span class="ident" id="6171677">rel</span><span class="op" id="6171680">.</span><span class="ident" id="6171681">Off</span>&nbsp;<span class="op" id="6171685">:</span>&nbsp;<span class="ident" id="6171687">rel</span><span class="op" id="6171690">.</span><span class="ident" id="6171691">Off</span><span class="op" id="6171694">+</span><span class="num" id="6171695">4</span><span class="op" id="6171696">]</span><span class="op" id="6171697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171702">val</span>&nbsp;<span class="op" id="6171706">+=</span>&nbsp;<span class="builtintype" id="6171709">uint32</span><span class="op" id="6171715">(</span><span class="ident" id="6171716">sym</span><span class="op" id="6171719">.</span><span class="ident" id="6171720">Value</span><span class="op" id="6171725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171730">f</span><span class="op" id="6171731">.</span><span class="ident" id="6171732">ByteOrder</span><span class="op" id="6171741">.</span><span class="ident" id="6171742">PutUint32</span><span class="op" id="6171751">(</span><span class="ident" id="6171752">dst</span><span class="op" id="6171755">[</span><span class="ident" id="6171756">rel</span><span class="op" id="6171759">.</span><span class="ident" id="6171760">Off</span><span class="op" id="6171763">:</span><span class="ident" id="6171764">rel</span><span class="op" id="6171767">.</span><span class="ident" id="6171768">Off</span><span class="op" id="6171771">+</span><span class="num" id="6171772">4</span><span class="op" id="6171773">]</span><span class="op" id="6171774">,</span>&nbsp;<span class="ident" id="6171776">val</span><span class="op" id="6171779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171783">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6171786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171790">return</span>&nbsp;<span class="ident" id="6171797">nil</span><br>
<span class="lineno"></span><span class="op" id="6171801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="6171804">func</span>&nbsp;<span class="op" id="6171809">(</span><span class="ident" id="6171810">f</span>&nbsp;<span class="op" id="6171812">*</span><span class="ident" id="6171813">File</span><span class="op" id="6171817">)</span>&nbsp;<span class="ident" id="6171819">applyRelocationsARM64</span><span class="op" id="6171840">(</span><span class="ident" id="6171841">dst</span>&nbsp;<span class="op" id="6171845">[</span><span class="op" id="6171846">]</span><span class="builtintype" id="6171847">byte</span><span class="op" id="6171851">,</span>&nbsp;<span class="ident" id="6171853">rels</span>&nbsp;<span class="op" id="6171858">[</span><span class="op" id="6171859">]</span><span class="builtintype" id="6171860">byte</span><span class="op" id="6171864">)</span>&nbsp;<span class="builtintype" id="6171866">error</span>&nbsp;<span class="op" id="6171872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6171875">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171905">if</span>&nbsp;<span class="builtinfunc" id="6171908">len</span><span class="op" id="6171911">(</span><span class="ident" id="6171912">rels</span><span class="op" id="6171916">)</span><span class="op" id="6171917">%</span><span class="num" id="6171918">24</span>&nbsp;<span class="op" id="6171921">!=</span>&nbsp;<span class="num" id="6171924">0</span>&nbsp;<span class="op" id="6171926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171930">return</span>&nbsp;<span class="ident" id="6171937">errors</span><span class="op" id="6171943">.</span><span class="ident" id="6171944">New</span><span class="op" id="6171947">(</span><span class="string" id="6171948">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="6172002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172005">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172009">symbols</span><span class="op" id="6172016">,</span>&nbsp;<span class="ident" id="6172018">_</span><span class="op" id="6172019">,</span>&nbsp;<span class="ident" id="6172021">err</span>&nbsp;<span class="op" id="6172025">:=</span>&nbsp;<span class="ident" id="6172028">f</span><span class="op" id="6172029">.</span><span class="ident" id="6172030">getSymbols</span><span class="op" id="6172040">(</span><span class="ident" id="6172041">SHT_SYMTAB</span><span class="op" id="6172051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172054">if</span>&nbsp;<span class="ident" id="6172057">err</span>&nbsp;<span class="op" id="6172061">!=</span>&nbsp;<span class="ident" id="6172064">nil</span>&nbsp;<span class="op" id="6172068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172072">return</span>&nbsp;<span class="ident" id="6172079">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172084">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172088">b</span>&nbsp;<span class="op" id="6172090">:=</span>&nbsp;<span class="ident" id="6172093">bytes</span><span class="op" id="6172098">.</span><span class="ident" id="6172099">NewReader</span><span class="op" id="6172108">(</span><span class="ident" id="6172109">rels</span><span class="op" id="6172113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172116">var</span>&nbsp;<span class="ident" id="6172120">rela</span>&nbsp;<span class="ident" id="6172125">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172134">for</span>&nbsp;<span class="ident" id="6172138">b</span><span class="op" id="6172139">.</span><span class="ident" id="6172140">Len</span><span class="op" id="6172143">(</span><span class="op" id="6172144">)</span>&nbsp;<span class="op" id="6172146">&gt;</span>&nbsp;<span class="num" id="6172148">0</span>&nbsp;<span class="op" id="6172150">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172154">binary</span><span class="op" id="6172160">.</span><span class="ident" id="6172161">Read</span><span class="op" id="6172165">(</span><span class="ident" id="6172166">b</span><span class="op" id="6172167">,</span>&nbsp;<span class="ident" id="6172169">f</span><span class="op" id="6172170">.</span><span class="ident" id="6172171">ByteOrder</span><span class="op" id="6172180">,</span>&nbsp;<span class="op" id="6172182">&amp;</span><span class="ident" id="6172183">rela</span><span class="op" id="6172187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172191">symNo</span>&nbsp;<span class="op" id="6172197">:=</span>&nbsp;<span class="ident" id="6172200">rela</span><span class="op" id="6172204">.</span><span class="ident" id="6172205">Info</span>&nbsp;<span class="op" id="6172210">&gt;&gt;</span>&nbsp;<span class="num" id="6172213">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172218">t</span>&nbsp;<span class="op" id="6172220">:=</span>&nbsp;<span class="ident" id="6172223">R_AARCH64</span><span class="op" id="6172232">(</span><span class="ident" id="6172233">rela</span><span class="op" id="6172237">.</span><span class="ident" id="6172238">Info</span>&nbsp;<span class="op" id="6172243">&amp;</span>&nbsp;<span class="num" id="6172245">0xffff</span><span class="op" id="6172251">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172256">if</span>&nbsp;<span class="ident" id="6172259">symNo</span>&nbsp;<span class="op" id="6172265">==</span>&nbsp;<span class="num" id="6172268">0</span>&nbsp;<span class="op" id="6172270">||</span>&nbsp;<span class="ident" id="6172273">symNo</span>&nbsp;<span class="op" id="6172279">&gt;</span>&nbsp;<span class="ident" id="6172281">uint64</span><span class="op" id="6172287">(</span><span class="builtinfunc" id="6172288">len</span><span class="op" id="6172291">(</span><span class="ident" id="6172292">symbols</span><span class="op" id="6172299">)</span><span class="op" id="6172300">)</span>&nbsp;<span class="op" id="6172302">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172307">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172322">sym</span>&nbsp;<span class="op" id="6172326">:=</span>&nbsp;<span class="op" id="6172329">&amp;</span><span class="ident" id="6172330">symbols</span><span class="op" id="6172337">[</span><span class="ident" id="6172338">symNo</span><span class="op" id="6172343">-</span><span class="num" id="6172344">1</span><span class="op" id="6172345">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172349">if</span>&nbsp;<span class="ident" id="6172352">SymType</span><span class="op" id="6172359">(</span><span class="ident" id="6172360">sym</span><span class="op" id="6172363">.</span><span class="ident" id="6172364">Info</span><span class="op" id="6172368">&amp;</span><span class="num" id="6172369">0xf</span><span class="op" id="6172372">)</span>&nbsp;<span class="op" id="6172374">!=</span>&nbsp;<span class="ident" id="6172377">STT_SECTION</span>&nbsp;<span class="op" id="6172389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172394">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172449">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172465">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172518">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172573">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172620">switch</span>&nbsp;<span class="ident" id="6172627">t</span>&nbsp;<span class="op" id="6172629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172633">case</span>&nbsp;<span class="ident" id="6172638">R_AARCH64_ABS64</span><span class="op" id="6172653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172658">if</span>&nbsp;<span class="ident" id="6172661">rela</span><span class="op" id="6172665">.</span><span class="ident" id="6172666">Off</span><span class="op" id="6172669">+</span><span class="num" id="6172670">8</span>&nbsp;<span class="op" id="6172672">&gt;=</span>&nbsp;<span class="ident" id="6172675">uint64</span><span class="op" id="6172681">(</span><span class="builtinfunc" id="6172682">len</span><span class="op" id="6172685">(</span><span class="ident" id="6172686">dst</span><span class="op" id="6172689">)</span><span class="op" id="6172690">)</span>&nbsp;<span class="op" id="6172692">||</span>&nbsp;<span class="ident" id="6172695">rela</span><span class="op" id="6172699">.</span><span class="ident" id="6172700">Addend</span>&nbsp;<span class="op" id="6172707">&lt;</span>&nbsp;<span class="num" id="6172709">0</span>&nbsp;<span class="op" id="6172711">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172717">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172734">f</span><span class="op" id="6172735">.</span><span class="ident" id="6172736">ByteOrder</span><span class="op" id="6172745">.</span><span class="ident" id="6172746">PutUint64</span><span class="op" id="6172755">(</span><span class="ident" id="6172756">dst</span><span class="op" id="6172759">[</span><span class="ident" id="6172760">rela</span><span class="op" id="6172764">.</span><span class="ident" id="6172765">Off</span><span class="op" id="6172768">:</span><span class="ident" id="6172769">rela</span><span class="op" id="6172773">.</span><span class="ident" id="6172774">Off</span><span class="op" id="6172777">+</span><span class="num" id="6172778">8</span><span class="op" id="6172779">]</span><span class="op" id="6172780">,</span>&nbsp;<span class="ident" id="6172782">uint64</span><span class="op" id="6172788">(</span><span class="ident" id="6172789">rela</span><span class="op" id="6172793">.</span><span class="ident" id="6172794">Addend</span><span class="op" id="6172800">)</span><span class="op" id="6172801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172805">case</span>&nbsp;<span class="ident" id="6172810">R_AARCH64_ABS32</span><span class="op" id="6172825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172830">if</span>&nbsp;<span class="ident" id="6172833">rela</span><span class="op" id="6172837">.</span><span class="ident" id="6172838">Off</span><span class="op" id="6172841">+</span><span class="num" id="6172842">4</span>&nbsp;<span class="op" id="6172844">&gt;=</span>&nbsp;<span class="ident" id="6172847">uint64</span><span class="op" id="6172853">(</span><span class="builtinfunc" id="6172854">len</span><span class="op" id="6172857">(</span><span class="ident" id="6172858">dst</span><span class="op" id="6172861">)</span><span class="op" id="6172862">)</span>&nbsp;<span class="op" id="6172864">||</span>&nbsp;<span class="ident" id="6172867">rela</span><span class="op" id="6172871">.</span><span class="ident" id="6172872">Addend</span>&nbsp;<span class="op" id="6172879">&lt;</span>&nbsp;<span class="num" id="6172881">0</span>&nbsp;<span class="op" id="6172883">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172889">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172906">f</span><span class="op" id="6172907">.</span><span class="ident" id="6172908">ByteOrder</span><span class="op" id="6172917">.</span><span class="ident" id="6172918">PutUint32</span><span class="op" id="6172927">(</span><span class="ident" id="6172928">dst</span><span class="op" id="6172931">[</span><span class="ident" id="6172932">rela</span><span class="op" id="6172936">.</span><span class="ident" id="6172937">Off</span><span class="op" id="6172940">:</span><span class="ident" id="6172941">rela</span><span class="op" id="6172945">.</span><span class="ident" id="6172946">Off</span><span class="op" id="6172949">+</span><span class="num" id="6172950">4</span><span class="op" id="6172951">]</span><span class="op" id="6172952">,</span>&nbsp;<span class="builtintype" id="6172954">uint32</span><span class="op" id="6172960">(</span><span class="ident" id="6172961">rela</span><span class="op" id="6172965">.</span><span class="ident" id="6172966">Addend</span><span class="op" id="6172972">)</span><span class="op" id="6172973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172980">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172984">return</span>&nbsp;<span class="ident" id="6172991">nil</span><br>
<span class="lineno"></span><span class="op" id="6172995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6172998">func</span>&nbsp;<span class="op" id="6173003">(</span><span class="ident" id="6173004">f</span>&nbsp;<span class="op" id="6173006">*</span><span class="ident" id="6173007">File</span><span class="op" id="6173011">)</span>&nbsp;<span class="ident" id="6173013">DWARF</span><span class="op" id="6173018">(</span><span class="op" id="6173019">)</span>&nbsp;<span class="op" id="6173021">(</span><span class="op" id="6173022">*</span><span class="ident" id="6173023">dwarf</span><span class="op" id="6173028">.</span><span class="ident" id="6173029">Data</span><span class="op" id="6173033">,</span>&nbsp;<span class="builtintype" id="6173035">error</span><span class="op" id="6173040">)</span>&nbsp;<span class="op" id="6173042">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173045">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173096">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173151">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173210">var</span>&nbsp;<span class="ident" id="6173214">names</span>&nbsp;<span class="op" id="6173220">=</span>&nbsp;<span class="op" id="6173222">[</span><span class="op" id="6173223">...</span><span class="op" id="6173226">]</span><span class="builtintype" id="6173227">string</span><span class="op" id="6173233">{</span><span class="string" id="6173234">&#34;abbrev&#34;</span><span class="op" id="6173242">,</span>&nbsp;<span class="string" id="6173244">&#34;info&#34;</span><span class="op" id="6173250">,</span>&nbsp;<span class="string" id="6173252">&#34;str&#34;</span><span class="op" id="6173257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173260">var</span>&nbsp;<span class="ident" id="6173264">dat</span>&nbsp;<span class="op" id="6173268">[</span><span class="builtinfunc" id="6173269">len</span><span class="op" id="6173272">(</span><span class="ident" id="6173273">names</span><span class="op" id="6173278">)</span><span class="op" id="6173279">]</span><span class="op" id="6173280">[</span><span class="op" id="6173281">]</span><span class="builtintype" id="6173282">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173288">for</span>&nbsp;<span class="ident" id="6173292">i</span><span class="op" id="6173293">,</span>&nbsp;<span class="ident" id="6173295">name</span>&nbsp;<span class="op" id="6173300">:=</span>&nbsp;<span class="keyword" id="6173303">range</span>&nbsp;<span class="ident" id="6173309">names</span>&nbsp;<span class="op" id="6173315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173319">name</span>&nbsp;<span class="op" id="6173324">=</span>&nbsp;<span class="string" id="6173326">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6173336">+</span>&nbsp;<span class="ident" id="6173338">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173345">s</span>&nbsp;<span class="op" id="6173347">:=</span>&nbsp;<span class="ident" id="6173350">f</span><span class="op" id="6173351">.</span><span class="ident" id="6173352">Section</span><span class="op" id="6173359">(</span><span class="ident" id="6173360">name</span><span class="op" id="6173364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173368">if</span>&nbsp;<span class="ident" id="6173371">s</span>&nbsp;<span class="op" id="6173373">==</span>&nbsp;<span class="ident" id="6173376">nil</span>&nbsp;<span class="op" id="6173380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173385">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173400">b</span><span class="op" id="6173401">,</span>&nbsp;<span class="ident" id="6173403">err</span>&nbsp;<span class="op" id="6173407">:=</span>&nbsp;<span class="ident" id="6173410">s</span><span class="op" id="6173411">.</span><span class="ident" id="6173412">Data</span><span class="op" id="6173416">(</span><span class="op" id="6173417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173421">if</span>&nbsp;<span class="ident" id="6173424">err</span>&nbsp;<span class="op" id="6173428">!=</span>&nbsp;<span class="ident" id="6173431">nil</span>&nbsp;<span class="op" id="6173435">&amp;&amp;</span>&nbsp;<span class="ident" id="6173438">uint64</span><span class="op" id="6173444">(</span><span class="builtinfunc" id="6173445">len</span><span class="op" id="6173448">(</span><span class="ident" id="6173449">b</span><span class="op" id="6173450">)</span><span class="op" id="6173451">)</span>&nbsp;<span class="op" id="6173453">&lt;</span>&nbsp;<span class="ident" id="6173455">s</span><span class="op" id="6173456">.</span><span class="ident" id="6173457">Size</span>&nbsp;<span class="op" id="6173462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173467">return</span>&nbsp;<span class="ident" id="6173474">nil</span><span class="op" id="6173477">,</span>&nbsp;<span class="ident" id="6173479">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173485">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173489">dat</span><span class="op" id="6173492">[</span><span class="ident" id="6173493">i</span><span class="op" id="6173494">]</span>&nbsp;<span class="op" id="6173496">=</span>&nbsp;<span class="ident" id="6173498">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173505">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173578">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173651">rela</span>&nbsp;<span class="op" id="6173656">:=</span>&nbsp;<span class="ident" id="6173659">f</span><span class="op" id="6173660">.</span><span class="ident" id="6173661">Section</span><span class="op" id="6173668">(</span><span class="string" id="6173669">&#34;.rela.debug_info&#34;</span><span class="op" id="6173687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173690">if</span>&nbsp;<span class="ident" id="6173693">rela</span>&nbsp;<span class="op" id="6173698">!=</span>&nbsp;<span class="ident" id="6173701">nil</span>&nbsp;<span class="op" id="6173705">&amp;&amp;</span>&nbsp;<span class="ident" id="6173708">rela</span><span class="op" id="6173712">.</span><span class="ident" id="6173713">Type</span>&nbsp;<span class="op" id="6173718">==</span>&nbsp;<span class="ident" id="6173721">SHT_RELA</span>&nbsp;<span class="op" id="6173730">&amp;&amp;</span>&nbsp;<span class="op" id="6173733">(</span><span class="ident" id="6173734">f</span><span class="op" id="6173735">.</span><span class="ident" id="6173736">Machine</span>&nbsp;<span class="op" id="6173744">==</span>&nbsp;<span class="ident" id="6173747">EM_X86_64</span>&nbsp;<span class="op" id="6173757">||</span>&nbsp;<span class="ident" id="6173760">f</span><span class="op" id="6173761">.</span><span class="ident" id="6173762">Machine</span>&nbsp;<span class="op" id="6173770">==</span>&nbsp;<span class="ident" id="6173773">EM_AARCH64</span><span class="op" id="6173783">)</span>&nbsp;<span class="op" id="6173785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173789">data</span><span class="op" id="6173793">,</span>&nbsp;<span class="ident" id="6173795">err</span>&nbsp;<span class="op" id="6173799">:=</span>&nbsp;<span class="ident" id="6173802">rela</span><span class="op" id="6173806">.</span><span class="ident" id="6173807">Data</span><span class="op" id="6173811">(</span><span class="op" id="6173812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173816">if</span>&nbsp;<span class="ident" id="6173819">err</span>&nbsp;<span class="op" id="6173823">!=</span>&nbsp;<span class="ident" id="6173826">nil</span>&nbsp;<span class="op" id="6173830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173835">return</span>&nbsp;<span class="ident" id="6173842">nil</span><span class="op" id="6173845">,</span>&nbsp;<span class="ident" id="6173847">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173857">err</span>&nbsp;<span class="op" id="6173861">=</span>&nbsp;<span class="ident" id="6173863">f</span><span class="op" id="6173864">.</span><span class="ident" id="6173865">applyRelocations</span><span class="op" id="6173881">(</span><span class="ident" id="6173882">dat</span><span class="op" id="6173885">[</span><span class="num" id="6173886">1</span><span class="op" id="6173887">]</span><span class="op" id="6173888">,</span>&nbsp;<span class="ident" id="6173890">data</span><span class="op" id="6173894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173898">if</span>&nbsp;<span class="ident" id="6173901">err</span>&nbsp;<span class="op" id="6173905">!=</span>&nbsp;<span class="ident" id="6173908">nil</span>&nbsp;<span class="op" id="6173912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173917">return</span>&nbsp;<span class="ident" id="6173924">nil</span><span class="op" id="6173927">,</span>&nbsp;<span class="ident" id="6173929">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173935">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6173942">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174008">rel</span>&nbsp;<span class="op" id="6174012">:=</span>&nbsp;<span class="ident" id="6174015">f</span><span class="op" id="6174016">.</span><span class="ident" id="6174017">Section</span><span class="op" id="6174024">(</span><span class="string" id="6174025">&#34;.rel.debug_info&#34;</span><span class="op" id="6174042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174045">if</span>&nbsp;<span class="ident" id="6174048">rel</span>&nbsp;<span class="op" id="6174052">!=</span>&nbsp;<span class="ident" id="6174055">nil</span>&nbsp;<span class="op" id="6174059">&amp;&amp;</span>&nbsp;<span class="ident" id="6174062">rel</span><span class="op" id="6174065">.</span><span class="ident" id="6174066">Type</span>&nbsp;<span class="op" id="6174071">==</span>&nbsp;<span class="ident" id="6174074">SHT_REL</span>&nbsp;<span class="op" id="6174082">&amp;&amp;</span>&nbsp;<span class="ident" id="6174085">f</span><span class="op" id="6174086">.</span><span class="ident" id="6174087">Machine</span>&nbsp;<span class="op" id="6174095">==</span>&nbsp;<span class="ident" id="6174098">EM_386</span>&nbsp;<span class="op" id="6174105">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174109">data</span><span class="op" id="6174113">,</span>&nbsp;<span class="ident" id="6174115">err</span>&nbsp;<span class="op" id="6174119">:=</span>&nbsp;<span class="ident" id="6174122">rel</span><span class="op" id="6174125">.</span><span class="ident" id="6174126">Data</span><span class="op" id="6174130">(</span><span class="op" id="6174131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174135">if</span>&nbsp;<span class="ident" id="6174138">err</span>&nbsp;<span class="op" id="6174142">!=</span>&nbsp;<span class="ident" id="6174145">nil</span>&nbsp;<span class="op" id="6174149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174154">return</span>&nbsp;<span class="ident" id="6174161">nil</span><span class="op" id="6174164">,</span>&nbsp;<span class="ident" id="6174166">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174176">err</span>&nbsp;<span class="op" id="6174180">=</span>&nbsp;<span class="ident" id="6174182">f</span><span class="op" id="6174183">.</span><span class="ident" id="6174184">applyRelocations</span><span class="op" id="6174200">(</span><span class="ident" id="6174201">dat</span><span class="op" id="6174204">[</span><span class="num" id="6174205">1</span><span class="op" id="6174206">]</span><span class="op" id="6174207">,</span>&nbsp;<span class="ident" id="6174209">data</span><span class="op" id="6174213">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174217">if</span>&nbsp;<span class="ident" id="6174220">err</span>&nbsp;<span class="op" id="6174224">!=</span>&nbsp;<span class="ident" id="6174227">nil</span>&nbsp;<span class="op" id="6174231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174236">return</span>&nbsp;<span class="ident" id="6174243">nil</span><span class="op" id="6174246">,</span>&nbsp;<span class="ident" id="6174248">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174261">abbrev</span><span class="op" id="6174267">,</span>&nbsp;<span class="ident" id="6174269">info</span><span class="op" id="6174273">,</span>&nbsp;<span class="ident" id="6174275">str</span>&nbsp;<span class="op" id="6174279">:=</span>&nbsp;<span class="ident" id="6174282">dat</span><span class="op" id="6174285">[</span><span class="num" id="6174286">0</span><span class="op" id="6174287">]</span><span class="op" id="6174288">,</span>&nbsp;<span class="ident" id="6174290">dat</span><span class="op" id="6174293">[</span><span class="num" id="6174294">1</span><span class="op" id="6174295">]</span><span class="op" id="6174296">,</span>&nbsp;<span class="ident" id="6174298">dat</span><span class="op" id="6174301">[</span><span class="num" id="6174302">2</span><span class="op" id="6174303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174306">d</span><span class="op" id="6174307">,</span>&nbsp;<span class="ident" id="6174309">err</span>&nbsp;<span class="op" id="6174313">:=</span>&nbsp;<span class="ident" id="6174316">dwarf</span><span class="op" id="6174321">.</span><span class="ident" id="6174322">New</span><span class="op" id="6174325">(</span><span class="ident" id="6174326">abbrev</span><span class="op" id="6174332">,</span>&nbsp;<span class="ident" id="6174334">nil</span><span class="op" id="6174337">,</span>&nbsp;<span class="ident" id="6174339">nil</span><span class="op" id="6174342">,</span>&nbsp;<span class="ident" id="6174344">info</span><span class="op" id="6174348">,</span>&nbsp;<span class="ident" id="6174350">nil</span><span class="op" id="6174353">,</span>&nbsp;<span class="ident" id="6174355">nil</span><span class="op" id="6174358">,</span>&nbsp;<span class="ident" id="6174360">nil</span><span class="op" id="6174363">,</span>&nbsp;<span class="ident" id="6174365">str</span><span class="op" id="6174368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174371">if</span>&nbsp;<span class="ident" id="6174374">err</span>&nbsp;<span class="op" id="6174378">!=</span>&nbsp;<span class="ident" id="6174381">nil</span>&nbsp;<span class="op" id="6174385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174389">return</span>&nbsp;<span class="ident" id="6174396">nil</span><span class="op" id="6174399">,</span>&nbsp;<span class="ident" id="6174401">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174406">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6174410">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174453">for</span>&nbsp;<span class="ident" id="6174457">i</span><span class="op" id="6174458">,</span>&nbsp;<span class="ident" id="6174460">s</span>&nbsp;<span class="op" id="6174462">:=</span>&nbsp;<span class="keyword" id="6174465">range</span>&nbsp;<span class="ident" id="6174471">f</span><span class="op" id="6174472">.</span><span class="ident" id="6174473">Sections</span>&nbsp;<span class="op" id="6174482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174486">if</span>&nbsp;<span class="ident" id="6174489">s</span><span class="op" id="6174490">.</span><span class="ident" id="6174491">Name</span>&nbsp;<span class="op" id="6174496">==</span>&nbsp;<span class="string" id="6174499">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="6174514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174519">b</span><span class="op" id="6174520">,</span>&nbsp;<span class="ident" id="6174522">err</span>&nbsp;<span class="op" id="6174526">:=</span>&nbsp;<span class="ident" id="6174529">s</span><span class="op" id="6174530">.</span><span class="ident" id="6174531">Data</span><span class="op" id="6174535">(</span><span class="op" id="6174536">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174541">if</span>&nbsp;<span class="ident" id="6174544">err</span>&nbsp;<span class="op" id="6174548">!=</span>&nbsp;<span class="ident" id="6174551">nil</span>&nbsp;<span class="op" id="6174555">&amp;&amp;</span>&nbsp;<span class="ident" id="6174558">uint64</span><span class="op" id="6174564">(</span><span class="builtinfunc" id="6174565">len</span><span class="op" id="6174568">(</span><span class="ident" id="6174569">b</span><span class="op" id="6174570">)</span><span class="op" id="6174571">)</span>&nbsp;<span class="op" id="6174573">&lt;</span>&nbsp;<span class="ident" id="6174575">s</span><span class="op" id="6174576">.</span><span class="ident" id="6174577">Size</span>&nbsp;<span class="op" id="6174582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174588">return</span>&nbsp;<span class="ident" id="6174595">nil</span><span class="op" id="6174598">,</span>&nbsp;<span class="ident" id="6174600">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174613">for</span>&nbsp;<span class="ident" id="6174617">_</span><span class="op" id="6174618">,</span>&nbsp;<span class="ident" id="6174620">r</span>&nbsp;<span class="op" id="6174622">:=</span>&nbsp;<span class="keyword" id="6174625">range</span>&nbsp;<span class="ident" id="6174631">f</span><span class="op" id="6174632">.</span><span class="ident" id="6174633">Sections</span>&nbsp;<span class="op" id="6174642">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174648">if</span>&nbsp;<span class="ident" id="6174651">r</span><span class="op" id="6174652">.</span><span class="ident" id="6174653">Type</span>&nbsp;<span class="op" id="6174658">!=</span>&nbsp;<span class="ident" id="6174661">SHT_RELA</span>&nbsp;<span class="op" id="6174670">&amp;&amp;</span>&nbsp;<span class="ident" id="6174673">r</span><span class="op" id="6174674">.</span><span class="ident" id="6174675">Type</span>&nbsp;<span class="op" id="6174680">!=</span>&nbsp;<span class="ident" id="6174683">SHT_REL</span>&nbsp;<span class="op" id="6174691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174698">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174717">if</span>&nbsp;<span class="builtintype" id="6174720">int</span><span class="op" id="6174723">(</span><span class="ident" id="6174724">r</span><span class="op" id="6174725">.</span><span class="ident" id="6174726">Info</span><span class="op" id="6174730">)</span>&nbsp;<span class="op" id="6174732">!=</span>&nbsp;<span class="ident" id="6174735">i</span>&nbsp;<span class="op" id="6174737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174744">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174763">rd</span><span class="op" id="6174765">,</span>&nbsp;<span class="ident" id="6174767">err</span>&nbsp;<span class="op" id="6174771">:=</span>&nbsp;<span class="ident" id="6174774">r</span><span class="op" id="6174775">.</span><span class="ident" id="6174776">Data</span><span class="op" id="6174780">(</span><span class="op" id="6174781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174787">if</span>&nbsp;<span class="ident" id="6174790">err</span>&nbsp;<span class="op" id="6174794">!=</span>&nbsp;<span class="ident" id="6174797">nil</span>&nbsp;<span class="op" id="6174801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174808">return</span>&nbsp;<span class="ident" id="6174815">nil</span><span class="op" id="6174818">,</span>&nbsp;<span class="ident" id="6174820">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174828">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174834">err</span>&nbsp;<span class="op" id="6174838">=</span>&nbsp;<span class="ident" id="6174840">f</span><span class="op" id="6174841">.</span><span class="ident" id="6174842">applyRelocations</span><span class="op" id="6174858">(</span><span class="ident" id="6174859">b</span><span class="op" id="6174860">,</span>&nbsp;<span class="ident" id="6174862">rd</span><span class="op" id="6174864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174870">if</span>&nbsp;<span class="ident" id="6174873">err</span>&nbsp;<span class="op" id="6174877">!=</span>&nbsp;<span class="ident" id="6174880">nil</span>&nbsp;<span class="op" id="6174884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174891">return</span>&nbsp;<span class="ident" id="6174898">nil</span><span class="op" id="6174901">,</span>&nbsp;<span class="ident" id="6174903">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174916">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174922">err</span>&nbsp;<span class="op" id="6174926">=</span>&nbsp;<span class="ident" id="6174928">d</span><span class="op" id="6174929">.</span><span class="ident" id="6174930">AddTypes</span><span class="op" id="6174938">(</span><span class="ident" id="6174939">fmt</span><span class="op" id="6174942">.</span><span class="ident" id="6174943">Sprintf</span><span class="op" id="6174950">(</span><span class="string" id="6174951">&#34;types-%d&#34;</span><span class="op" id="6174961">,</span>&nbsp;<span class="ident" id="6174963">i</span><span class="op" id="6174964">)</span><span class="op" id="6174965">,</span>&nbsp;<span class="ident" id="6174967">b</span><span class="op" id="6174968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174973">if</span>&nbsp;<span class="ident" id="6174976">err</span>&nbsp;<span class="op" id="6174980">!=</span>&nbsp;<span class="ident" id="6174983">nil</span>&nbsp;<span class="op" id="6174987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174993">return</span>&nbsp;<span class="ident" id="6175000">nil</span><span class="op" id="6175003">,</span>&nbsp;<span class="ident" id="6175005">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175012">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175023">return</span>&nbsp;<span class="ident" id="6175030">d</span><span class="op" id="6175031">,</span>&nbsp;<span class="ident" id="6175033">nil</span><br>
<span class="lineno"></span><span class="op" id="6175037">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="6175040">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="6175123">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6175144">//</span><br>
<span class="lineno"></span><span class="comment" id="6175147">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="6175223">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6175297">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6175343">func</span>&nbsp;<span class="op" id="6175348">(</span><span class="ident" id="6175349">f</span>&nbsp;<span class="op" id="6175351">*</span><span class="ident" id="6175352">File</span><span class="op" id="6175356">)</span>&nbsp;<span class="ident" id="6175358">Symbols</span><span class="op" id="6175365">(</span><span class="op" id="6175366">)</span>&nbsp;<span class="op" id="6175368">(</span><span class="op" id="6175369">[</span><span class="op" id="6175370">]</span><span class="ident" id="6175371">Symbol</span><span class="op" id="6175377">,</span>&nbsp;<span class="builtintype" id="6175379">error</span><span class="op" id="6175384">)</span>&nbsp;<span class="op" id="6175386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175389">sym</span><span class="op" id="6175392">,</span>&nbsp;<span class="ident" id="6175394">_</span><span class="op" id="6175395">,</span>&nbsp;<span class="ident" id="6175397">err</span>&nbsp;<span class="op" id="6175401">:=</span>&nbsp;<span class="ident" id="6175404">f</span><span class="op" id="6175405">.</span><span class="ident" id="6175406">getSymbols</span><span class="op" id="6175416">(</span><span class="ident" id="6175417">SHT_SYMTAB</span><span class="op" id="6175427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175430">return</span>&nbsp;<span class="ident" id="6175437">sym</span><span class="op" id="6175440">,</span>&nbsp;<span class="ident" id="6175442">err</span><br>
<span class="lineno">770</span><span class="op" id="6175446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6175449">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6175519">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="6175568">//</span><br>
<span class="lineno">775</span><span class="comment" id="6175571">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6175655">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="6175729">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="6175775">func</span>&nbsp;<span class="op" id="6175780">(</span><span class="ident" id="6175781">f</span>&nbsp;<span class="op" id="6175783">*</span><span class="ident" id="6175784">File</span><span class="op" id="6175788">)</span>&nbsp;<span class="ident" id="6175790">DynamicSymbols</span><span class="op" id="6175804">(</span><span class="op" id="6175805">)</span>&nbsp;<span class="op" id="6175807">(</span><span class="op" id="6175808">[</span><span class="op" id="6175809">]</span><span class="ident" id="6175810">Symbol</span><span class="op" id="6175816">,</span>&nbsp;<span class="builtintype" id="6175818">error</span><span class="op" id="6175823">)</span>&nbsp;<span class="op" id="6175825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175828">sym</span><span class="op" id="6175831">,</span>&nbsp;<span class="ident" id="6175833">_</span><span class="op" id="6175834">,</span>&nbsp;<span class="ident" id="6175836">err</span>&nbsp;<span class="op" id="6175840">:=</span>&nbsp;<span class="ident" id="6175843">f</span><span class="op" id="6175844">.</span><span class="ident" id="6175845">getSymbols</span><span class="op" id="6175855">(</span><span class="ident" id="6175856">SHT_DYNSYM</span><span class="op" id="6175866">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175869">return</span>&nbsp;<span class="ident" id="6175876">sym</span><span class="op" id="6175879">,</span>&nbsp;<span class="ident" id="6175881">err</span><br>
<span class="lineno"></span><span class="op" id="6175885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6175888">type</span>&nbsp;<span class="ident" id="6175893">ImportedSymbol</span>&nbsp;<span class="keyword" id="6175908">struct</span>&nbsp;<span class="op" id="6175915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175918">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6175926">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175934">Version</span>&nbsp;<span class="builtintype" id="6175942">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175950">Library</span>&nbsp;<span class="builtintype" id="6175958">string</span><br>
<span class="lineno"></span><span class="op" id="6175965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6175968">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="6176020">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6176075">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6176129">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6176165">func</span>&nbsp;<span class="op" id="6176170">(</span><span class="ident" id="6176171">f</span>&nbsp;<span class="op" id="6176173">*</span><span class="ident" id="6176174">File</span><span class="op" id="6176178">)</span>&nbsp;<span class="ident" id="6176180">ImportedSymbols</span><span class="op" id="6176195">(</span><span class="op" id="6176196">)</span>&nbsp;<span class="op" id="6176198">(</span><span class="op" id="6176199">[</span><span class="op" id="6176200">]</span><span class="ident" id="6176201">ImportedSymbol</span><span class="op" id="6176215">,</span>&nbsp;<span class="builtintype" id="6176217">error</span><span class="op" id="6176222">)</span>&nbsp;<span class="op" id="6176224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176227">sym</span><span class="op" id="6176230">,</span>&nbsp;<span class="ident" id="6176232">str</span><span class="op" id="6176235">,</span>&nbsp;<span class="ident" id="6176237">err</span>&nbsp;<span class="op" id="6176241">:=</span>&nbsp;<span class="ident" id="6176244">f</span><span class="op" id="6176245">.</span><span class="ident" id="6176246">getSymbols</span><span class="op" id="6176256">(</span><span class="ident" id="6176257">SHT_DYNSYM</span><span class="op" id="6176267">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176270">if</span>&nbsp;<span class="ident" id="6176273">err</span>&nbsp;<span class="op" id="6176277">!=</span>&nbsp;<span class="ident" id="6176280">nil</span>&nbsp;<span class="op" id="6176284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176288">return</span>&nbsp;<span class="ident" id="6176295">nil</span><span class="op" id="6176298">,</span>&nbsp;<span class="ident" id="6176300">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176308">f</span><span class="op" id="6176309">.</span><span class="ident" id="6176310">gnuVersionInit</span><span class="op" id="6176324">(</span><span class="ident" id="6176325">str</span><span class="op" id="6176328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176331">var</span>&nbsp;<span class="ident" id="6176335">all</span>&nbsp;<span class="op" id="6176339">[</span><span class="op" id="6176340">]</span><span class="ident" id="6176341">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176357">for</span>&nbsp;<span class="ident" id="6176361">i</span><span class="op" id="6176362">,</span>&nbsp;<span class="ident" id="6176364">s</span>&nbsp;<span class="op" id="6176366">:=</span>&nbsp;<span class="keyword" id="6176369">range</span>&nbsp;<span class="ident" id="6176375">sym</span>&nbsp;<span class="op" id="6176379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176383">if</span>&nbsp;<span class="ident" id="6176386">ST_BIND</span><span class="op" id="6176393">(</span><span class="ident" id="6176394">s</span><span class="op" id="6176395">.</span><span class="ident" id="6176396">Info</span><span class="op" id="6176400">)</span>&nbsp;<span class="op" id="6176402">==</span>&nbsp;<span class="ident" id="6176405">STB_GLOBAL</span>&nbsp;<span class="op" id="6176416">&amp;&amp;</span>&nbsp;<span class="ident" id="6176419">s</span><span class="op" id="6176420">.</span><span class="ident" id="6176421">Section</span>&nbsp;<span class="op" id="6176429">==</span>&nbsp;<span class="ident" id="6176432">SHN_UNDEF</span>&nbsp;<span class="op" id="6176442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176447">all</span>&nbsp;<span class="op" id="6176451">=</span>&nbsp;<span class="builtinfunc" id="6176453">append</span><span class="op" id="6176459">(</span><span class="ident" id="6176460">all</span><span class="op" id="6176463">,</span>&nbsp;<span class="ident" id="6176465">ImportedSymbol</span><span class="op" id="6176479">{</span><span class="ident" id="6176480">Name</span><span class="op" id="6176484">:</span>&nbsp;<span class="ident" id="6176486">s</span><span class="op" id="6176487">.</span><span class="ident" id="6176488">Name</span><span class="op" id="6176492">}</span><span class="op" id="6176493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176498">f</span><span class="op" id="6176499">.</span><span class="ident" id="6176500">gnuVersion</span><span class="op" id="6176510">(</span><span class="ident" id="6176511">i</span><span class="op" id="6176512">,</span>&nbsp;<span class="op" id="6176514">&amp;</span><span class="ident" id="6176515">all</span><span class="op" id="6176518">[</span><span class="builtinfunc" id="6176519">len</span><span class="op" id="6176522">(</span><span class="ident" id="6176523">all</span><span class="op" id="6176526">)</span><span class="op" id="6176527">-</span><span class="num" id="6176528">1</span><span class="op" id="6176529">]</span><span class="op" id="6176530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176534">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176540">return</span>&nbsp;<span class="ident" id="6176547">all</span><span class="op" id="6176550">,</span>&nbsp;<span class="ident" id="6176552">nil</span><br>
<span class="lineno"></span><span class="op" id="6176556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6176559">type</span>&nbsp;<span class="ident" id="6176564">verneed</span>&nbsp;<span class="keyword" id="6176572">struct</span>&nbsp;<span class="op" id="6176579">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176582">File</span>&nbsp;<span class="builtintype" id="6176587">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176595">Name</span>&nbsp;<span class="builtintype" id="6176600">string</span><br>
<span class="lineno"></span><span class="op" id="6176607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6176610">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="6176658">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="6176693">func</span>&nbsp;<span class="op" id="6176698">(</span><span class="ident" id="6176699">f</span>&nbsp;<span class="op" id="6176701">*</span><span class="ident" id="6176702">File</span><span class="op" id="6176706">)</span>&nbsp;<span class="ident" id="6176708">gnuVersionInit</span><span class="op" id="6176722">(</span><span class="ident" id="6176723">str</span>&nbsp;<span class="op" id="6176727">[</span><span class="op" id="6176728">]</span><span class="builtintype" id="6176729">byte</span><span class="op" id="6176733">)</span>&nbsp;<span class="op" id="6176735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6176738">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176774">vn</span>&nbsp;<span class="op" id="6176777">:=</span>&nbsp;<span class="ident" id="6176780">f</span><span class="op" id="6176781">.</span><span class="ident" id="6176782">SectionByType</span><span class="op" id="6176795">(</span><span class="ident" id="6176796">SHT_GNU_VERNEED</span><span class="op" id="6176811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176814">if</span>&nbsp;<span class="ident" id="6176817">vn</span>&nbsp;<span class="op" id="6176820">==</span>&nbsp;<span class="ident" id="6176823">nil</span>&nbsp;<span class="op" id="6176827">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176831">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176842">d</span><span class="op" id="6176843">,</span>&nbsp;<span class="ident" id="6176845">_</span>&nbsp;<span class="op" id="6176847">:=</span>&nbsp;<span class="ident" id="6176850">vn</span><span class="op" id="6176852">.</span><span class="ident" id="6176853">Data</span><span class="op" id="6176857">(</span><span class="op" id="6176858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176862">var</span>&nbsp;<span class="ident" id="6176866">need</span>&nbsp;<span class="op" id="6176871">[</span><span class="op" id="6176872">]</span><span class="ident" id="6176873">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176882">i</span>&nbsp;<span class="op" id="6176884">:=</span>&nbsp;<span class="num" id="6176887">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176890">for</span>&nbsp;<span class="op" id="6176894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176898">if</span>&nbsp;<span class="ident" id="6176901">i</span><span class="op" id="6176902">+</span><span class="num" id="6176903">16</span>&nbsp;<span class="op" id="6176906">&gt;</span>&nbsp;<span class="builtinfunc" id="6176908">len</span><span class="op" id="6176911">(</span><span class="ident" id="6176912">d</span><span class="op" id="6176913">)</span>&nbsp;<span class="op" id="6176915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176920">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176928">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176932">vers</span>&nbsp;<span class="op" id="6176937">:=</span>&nbsp;<span class="ident" id="6176940">f</span><span class="op" id="6176941">.</span><span class="ident" id="6176942">ByteOrder</span><span class="op" id="6176951">.</span><span class="ident" id="6176952">Uint16</span><span class="op" id="6176958">(</span><span class="ident" id="6176959">d</span><span class="op" id="6176960">[</span><span class="ident" id="6176961">i</span>&nbsp;<span class="op" id="6176963">:</span>&nbsp;<span class="ident" id="6176965">i</span><span class="op" id="6176966">+</span><span class="num" id="6176967">2</span><span class="op" id="6176968">]</span><span class="op" id="6176969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176973">if</span>&nbsp;<span class="ident" id="6176976">vers</span>&nbsp;<span class="op" id="6176981">!=</span>&nbsp;<span class="num" id="6176984">1</span>&nbsp;<span class="op" id="6176986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176991">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177003">cnt</span>&nbsp;<span class="op" id="6177007">:=</span>&nbsp;<span class="ident" id="6177010">f</span><span class="op" id="6177011">.</span><span class="ident" id="6177012">ByteOrder</span><span class="op" id="6177021">.</span><span class="ident" id="6177022">Uint16</span><span class="op" id="6177028">(</span><span class="ident" id="6177029">d</span><span class="op" id="6177030">[</span><span class="ident" id="6177031">i</span><span class="op" id="6177032">+</span><span class="num" id="6177033">2</span>&nbsp;<span class="op" id="6177035">:</span>&nbsp;<span class="ident" id="6177037">i</span><span class="op" id="6177038">+</span><span class="num" id="6177039">4</span><span class="op" id="6177040">]</span><span class="op" id="6177041">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177045">fileoff</span>&nbsp;<span class="op" id="6177053">:=</span>&nbsp;<span class="ident" id="6177056">f</span><span class="op" id="6177057">.</span><span class="ident" id="6177058">ByteOrder</span><span class="op" id="6177067">.</span><span class="ident" id="6177068">Uint32</span><span class="op" id="6177074">(</span><span class="ident" id="6177075">d</span><span class="op" id="6177076">[</span><span class="ident" id="6177077">i</span><span class="op" id="6177078">+</span><span class="num" id="6177079">4</span>&nbsp;<span class="op" id="6177081">:</span>&nbsp;<span class="ident" id="6177083">i</span><span class="op" id="6177084">+</span><span class="num" id="6177085">8</span><span class="op" id="6177086">]</span><span class="op" id="6177087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177091">aux</span>&nbsp;<span class="op" id="6177095">:=</span>&nbsp;<span class="ident" id="6177098">f</span><span class="op" id="6177099">.</span><span class="ident" id="6177100">ByteOrder</span><span class="op" id="6177109">.</span><span class="ident" id="6177110">Uint32</span><span class="op" id="6177116">(</span><span class="ident" id="6177117">d</span><span class="op" id="6177118">[</span><span class="ident" id="6177119">i</span><span class="op" id="6177120">+</span><span class="num" id="6177121">8</span>&nbsp;<span class="op" id="6177123">:</span>&nbsp;<span class="ident" id="6177125">i</span><span class="op" id="6177126">+</span><span class="num" id="6177127">12</span><span class="op" id="6177129">]</span><span class="op" id="6177130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177134">next</span>&nbsp;<span class="op" id="6177139">:=</span>&nbsp;<span class="ident" id="6177142">f</span><span class="op" id="6177143">.</span><span class="ident" id="6177144">ByteOrder</span><span class="op" id="6177153">.</span><span class="ident" id="6177154">Uint32</span><span class="op" id="6177160">(</span><span class="ident" id="6177161">d</span><span class="op" id="6177162">[</span><span class="ident" id="6177163">i</span><span class="op" id="6177164">+</span><span class="num" id="6177165">12</span>&nbsp;<span class="op" id="6177168">:</span>&nbsp;<span class="ident" id="6177170">i</span><span class="op" id="6177171">+</span><span class="num" id="6177172">16</span><span class="op" id="6177174">]</span><span class="op" id="6177175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177179">file</span><span class="op" id="6177183">,</span>&nbsp;<span class="ident" id="6177185">_</span>&nbsp;<span class="op" id="6177187">:=</span>&nbsp;<span class="ident" id="6177190">getString</span><span class="op" id="6177199">(</span><span class="ident" id="6177200">str</span><span class="op" id="6177203">,</span>&nbsp;<span class="builtintype" id="6177205">int</span><span class="op" id="6177208">(</span><span class="ident" id="6177209">fileoff</span><span class="op" id="6177216">)</span><span class="op" id="6177217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177222">var</span>&nbsp;<span class="ident" id="6177226">name</span>&nbsp;<span class="builtintype" id="6177231">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177240">j</span>&nbsp;<span class="op" id="6177242">:=</span>&nbsp;<span class="ident" id="6177245">i</span>&nbsp;<span class="op" id="6177247">+</span>&nbsp;<span class="builtintype" id="6177249">int</span><span class="op" id="6177252">(</span><span class="ident" id="6177253">aux</span><span class="op" id="6177256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177260">for</span>&nbsp;<span class="ident" id="6177264">c</span>&nbsp;<span class="op" id="6177266">:=</span>&nbsp;<span class="num" id="6177269">0</span><span class="op" id="6177270">;</span>&nbsp;<span class="ident" id="6177272">c</span>&nbsp;<span class="op" id="6177274">&lt;</span>&nbsp;<span class="builtintype" id="6177276">int</span><span class="op" id="6177279">(</span><span class="ident" id="6177280">cnt</span><span class="op" id="6177283">)</span><span class="op" id="6177284">;</span>&nbsp;<span class="ident" id="6177286">c</span><span class="op" id="6177287">++</span>&nbsp;<span class="op" id="6177290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177295">if</span>&nbsp;<span class="ident" id="6177298">j</span><span class="op" id="6177299">+</span><span class="num" id="6177300">16</span>&nbsp;<span class="op" id="6177303">&gt;</span>&nbsp;<span class="builtinfunc" id="6177305">len</span><span class="op" id="6177308">(</span><span class="ident" id="6177309">d</span><span class="op" id="6177310">)</span>&nbsp;<span class="op" id="6177312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177318">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6177332">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6177375">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177421">other</span>&nbsp;<span class="op" id="6177427">:=</span>&nbsp;<span class="ident" id="6177430">f</span><span class="op" id="6177431">.</span><span class="ident" id="6177432">ByteOrder</span><span class="op" id="6177441">.</span><span class="ident" id="6177442">Uint16</span><span class="op" id="6177448">(</span><span class="ident" id="6177449">d</span><span class="op" id="6177450">[</span><span class="ident" id="6177451">j</span><span class="op" id="6177452">+</span><span class="num" id="6177453">6</span>&nbsp;<span class="op" id="6177455">:</span>&nbsp;<span class="ident" id="6177457">j</span><span class="op" id="6177458">+</span><span class="num" id="6177459">8</span><span class="op" id="6177460">]</span><span class="op" id="6177461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177466">nameoff</span>&nbsp;<span class="op" id="6177474">:=</span>&nbsp;<span class="ident" id="6177477">f</span><span class="op" id="6177478">.</span><span class="ident" id="6177479">ByteOrder</span><span class="op" id="6177488">.</span><span class="ident" id="6177489">Uint32</span><span class="op" id="6177495">(</span><span class="ident" id="6177496">d</span><span class="op" id="6177497">[</span><span class="ident" id="6177498">j</span><span class="op" id="6177499">+</span><span class="num" id="6177500">8</span>&nbsp;<span class="op" id="6177502">:</span>&nbsp;<span class="ident" id="6177504">j</span><span class="op" id="6177505">+</span><span class="num" id="6177506">12</span><span class="op" id="6177508">]</span><span class="op" id="6177509">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177514">next</span>&nbsp;<span class="op" id="6177519">:=</span>&nbsp;<span class="ident" id="6177522">f</span><span class="op" id="6177523">.</span><span class="ident" id="6177524">ByteOrder</span><span class="op" id="6177533">.</span><span class="ident" id="6177534">Uint32</span><span class="op" id="6177540">(</span><span class="ident" id="6177541">d</span><span class="op" id="6177542">[</span><span class="ident" id="6177543">j</span><span class="op" id="6177544">+</span><span class="num" id="6177545">12</span>&nbsp;<span class="op" id="6177548">:</span>&nbsp;<span class="ident" id="6177550">j</span><span class="op" id="6177551">+</span><span class="num" id="6177552">16</span><span class="op" id="6177554">]</span><span class="op" id="6177555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177560">name</span><span class="op" id="6177564">,</span>&nbsp;<span class="ident" id="6177566">_</span>&nbsp;<span class="op" id="6177568">=</span>&nbsp;<span class="ident" id="6177570">getString</span><span class="op" id="6177579">(</span><span class="ident" id="6177580">str</span><span class="op" id="6177583">,</span>&nbsp;<span class="builtintype" id="6177585">int</span><span class="op" id="6177588">(</span><span class="ident" id="6177589">nameoff</span><span class="op" id="6177596">)</span><span class="op" id="6177597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177602">ndx</span>&nbsp;<span class="op" id="6177606">:=</span>&nbsp;<span class="builtintype" id="6177609">int</span><span class="op" id="6177612">(</span><span class="ident" id="6177613">other</span><span class="op" id="6177618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177623">if</span>&nbsp;<span class="ident" id="6177626">ndx</span>&nbsp;<span class="op" id="6177630">&gt;=</span>&nbsp;<span class="builtinfunc" id="6177633">len</span><span class="op" id="6177636">(</span><span class="ident" id="6177637">need</span><span class="op" id="6177641">)</span>&nbsp;<span class="op" id="6177643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177649">a</span>&nbsp;<span class="op" id="6177651">:=</span>&nbsp;<span class="builtinfunc" id="6177654">make</span><span class="op" id="6177658">(</span><span class="op" id="6177659">[</span><span class="op" id="6177660">]</span><span class="ident" id="6177661">verneed</span><span class="op" id="6177668">,</span>&nbsp;<span class="num" id="6177670">2</span><span class="op" id="6177671">*</span><span class="op" id="6177672">(</span><span class="ident" id="6177673">ndx</span><span class="op" id="6177676">+</span><span class="num" id="6177677">1</span><span class="op" id="6177678">)</span><span class="op" id="6177679">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6177685">copy</span><span class="op" id="6177689">(</span><span class="ident" id="6177690">a</span><span class="op" id="6177691">,</span>&nbsp;<span class="ident" id="6177693">need</span><span class="op" id="6177697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177703">need</span>&nbsp;<span class="op" id="6177708">=</span>&nbsp;<span class="ident" id="6177710">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177721">need</span><span class="op" id="6177725">[</span><span class="ident" id="6177726">ndx</span><span class="op" id="6177729">]</span>&nbsp;<span class="op" id="6177731">=</span>&nbsp;<span class="ident" id="6177733">verneed</span><span class="op" id="6177740">{</span><span class="ident" id="6177741">file</span><span class="op" id="6177745">,</span>&nbsp;<span class="ident" id="6177747">name</span><span class="op" id="6177751">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177756">if</span>&nbsp;<span class="ident" id="6177759">next</span>&nbsp;<span class="op" id="6177764">==</span>&nbsp;<span class="num" id="6177767">0</span>&nbsp;<span class="op" id="6177769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177775">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177789">j</span>&nbsp;<span class="op" id="6177791">+=</span>&nbsp;<span class="builtintype" id="6177794">int</span><span class="op" id="6177797">(</span><span class="ident" id="6177798">next</span><span class="op" id="6177802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177806">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177811">if</span>&nbsp;<span class="ident" id="6177814">next</span>&nbsp;<span class="op" id="6177819">==</span>&nbsp;<span class="num" id="6177822">0</span>&nbsp;<span class="op" id="6177824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177829">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177841">i</span>&nbsp;<span class="op" id="6177843">+=</span>&nbsp;<span class="builtintype" id="6177846">int</span><span class="op" id="6177849">(</span><span class="ident" id="6177850">next</span><span class="op" id="6177854">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6177861">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177919">vs</span>&nbsp;<span class="op" id="6177922">:=</span>&nbsp;<span class="ident" id="6177925">f</span><span class="op" id="6177926">.</span><span class="ident" id="6177927">SectionByType</span><span class="op" id="6177940">(</span><span class="ident" id="6177941">SHT_GNU_VERSYM</span><span class="op" id="6177955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177958">if</span>&nbsp;<span class="ident" id="6177961">vs</span>&nbsp;<span class="op" id="6177964">==</span>&nbsp;<span class="ident" id="6177967">nil</span>&nbsp;<span class="op" id="6177971">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177975">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177986">d</span><span class="op" id="6177987">,</span>&nbsp;<span class="ident" id="6177989">_</span>&nbsp;<span class="op" id="6177991">=</span>&nbsp;<span class="ident" id="6177993">vs</span><span class="op" id="6177995">.</span><span class="ident" id="6177996">Data</span><span class="op" id="6178000">(</span><span class="op" id="6178001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178005">f</span><span class="op" id="6178006">.</span><span class="ident" id="6178007">gnuNeed</span>&nbsp;<span class="op" id="6178015">=</span>&nbsp;<span class="ident" id="6178017">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178023">f</span><span class="op" id="6178024">.</span><span class="ident" id="6178025">gnuVersym</span>&nbsp;<span class="op" id="6178035">=</span>&nbsp;<span class="ident" id="6178037">d</span><br>
<span class="lineno"></span><span class="op" id="6178039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6178042">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="6178101">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="6178150">func</span>&nbsp;<span class="op" id="6178155">(</span><span class="ident" id="6178156">f</span>&nbsp;<span class="op" id="6178158">*</span><span class="ident" id="6178159">File</span><span class="op" id="6178163">)</span>&nbsp;<span class="ident" id="6178165">gnuVersion</span><span class="op" id="6178175">(</span><span class="ident" id="6178176">i</span>&nbsp;<span class="builtintype" id="6178178">int</span><span class="op" id="6178181">,</span>&nbsp;<span class="ident" id="6178183">sym</span>&nbsp;<span class="op" id="6178187">*</span><span class="ident" id="6178188">ImportedSymbol</span><span class="op" id="6178202">)</span>&nbsp;<span class="op" id="6178204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6178207">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178236">i</span>&nbsp;<span class="op" id="6178238">=</span>&nbsp;<span class="op" id="6178240">(</span><span class="ident" id="6178241">i</span>&nbsp;<span class="op" id="6178243">+</span>&nbsp;<span class="num" id="6178245">1</span><span class="op" id="6178246">)</span>&nbsp;<span class="op" id="6178248">*</span>&nbsp;<span class="num" id="6178250">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178253">if</span>&nbsp;<span class="ident" id="6178256">i</span>&nbsp;<span class="op" id="6178258">&gt;=</span>&nbsp;<span class="builtinfunc" id="6178261">len</span><span class="op" id="6178264">(</span><span class="ident" id="6178265">f</span><span class="op" id="6178266">.</span><span class="ident" id="6178267">gnuVersym</span><span class="op" id="6178276">)</span>&nbsp;<span class="op" id="6178278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178282">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178293">j</span>&nbsp;<span class="op" id="6178295">:=</span>&nbsp;<span class="builtintype" id="6178298">int</span><span class="op" id="6178301">(</span><span class="ident" id="6178302">f</span><span class="op" id="6178303">.</span><span class="ident" id="6178304">ByteOrder</span><span class="op" id="6178313">.</span><span class="ident" id="6178314">Uint16</span><span class="op" id="6178320">(</span><span class="ident" id="6178321">f</span><span class="op" id="6178322">.</span><span class="ident" id="6178323">gnuVersym</span><span class="op" id="6178332">[</span><span class="ident" id="6178333">i</span><span class="op" id="6178334">:</span><span class="op" id="6178335">]</span><span class="op" id="6178336">)</span><span class="op" id="6178337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178340">if</span>&nbsp;<span class="ident" id="6178343">j</span>&nbsp;<span class="op" id="6178345">&lt;</span>&nbsp;<span class="num" id="6178347">2</span>&nbsp;<span class="op" id="6178349">||</span>&nbsp;<span class="ident" id="6178352">j</span>&nbsp;<span class="op" id="6178354">&gt;=</span>&nbsp;<span class="builtinfunc" id="6178357">len</span><span class="op" id="6178360">(</span><span class="ident" id="6178361">f</span><span class="op" id="6178362">.</span><span class="ident" id="6178363">gnuNeed</span><span class="op" id="6178370">)</span>&nbsp;<span class="op" id="6178372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178376">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178384">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178387">n</span>&nbsp;<span class="op" id="6178389">:=</span>&nbsp;<span class="op" id="6178392">&amp;</span><span class="ident" id="6178393">f</span><span class="op" id="6178394">.</span><span class="ident" id="6178395">gnuNeed</span><span class="op" id="6178402">[</span><span class="ident" id="6178403">j</span><span class="op" id="6178404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178407">sym</span><span class="op" id="6178410">.</span><span class="ident" id="6178411">Library</span>&nbsp;<span class="op" id="6178419">=</span>&nbsp;<span class="ident" id="6178421">n</span><span class="op" id="6178422">.</span><span class="ident" id="6178423">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178429">sym</span><span class="op" id="6178432">.</span><span class="ident" id="6178433">Version</span>&nbsp;<span class="op" id="6178441">=</span>&nbsp;<span class="ident" id="6178443">n</span><span class="op" id="6178444">.</span><span class="ident" id="6178445">Name</span><br>
<span class="lineno"></span><span class="op" id="6178450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="6178453">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6178509">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6178564">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6178612">func</span>&nbsp;<span class="op" id="6178617">(</span><span class="ident" id="6178618">f</span>&nbsp;<span class="op" id="6178620">*</span><span class="ident" id="6178621">File</span><span class="op" id="6178625">)</span>&nbsp;<span class="ident" id="6178627">ImportedLibraries</span><span class="op" id="6178644">(</span><span class="op" id="6178645">)</span>&nbsp;<span class="op" id="6178647">(</span><span class="op" id="6178648">[</span><span class="op" id="6178649">]</span><span class="builtintype" id="6178650">string</span><span class="op" id="6178656">,</span>&nbsp;<span class="builtintype" id="6178658">error</span><span class="op" id="6178663">)</span>&nbsp;<span class="op" id="6178665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178668">return</span>&nbsp;<span class="ident" id="6178675">f</span><span class="op" id="6178676">.</span><span class="ident" id="6178677">DynString</span><span class="op" id="6178686">(</span><span class="ident" id="6178687">DT_NEEDED</span><span class="op" id="6178696">)</span><br>
<span class="lineno">905</span><span class="op" id="6178698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6178701">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="6178781">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="6178793">//</span><br>
<span class="lineno">910</span><span class="comment" id="6178796">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6178880">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="6178895">func</span>&nbsp;<span class="op" id="6178900">(</span><span class="ident" id="6178901">f</span>&nbsp;<span class="op" id="6178903">*</span><span class="ident" id="6178904">File</span><span class="op" id="6178908">)</span>&nbsp;<span class="ident" id="6178910">DynString</span><span class="op" id="6178919">(</span><span class="ident" id="6178920">tag</span>&nbsp;<span class="ident" id="6178924">DynTag</span><span class="op" id="6178930">)</span>&nbsp;<span class="op" id="6178932">(</span><span class="op" id="6178933">[</span><span class="op" id="6178934">]</span><span class="builtintype" id="6178935">string</span><span class="op" id="6178941">,</span>&nbsp;<span class="builtintype" id="6178943">error</span><span class="op" id="6178948">)</span>&nbsp;<span class="op" id="6178950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178953">switch</span>&nbsp;<span class="ident" id="6178960">tag</span>&nbsp;<span class="op" id="6178964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178967">case</span>&nbsp;<span class="ident" id="6178972">DT_NEEDED</span><span class="op" id="6178981">,</span>&nbsp;<span class="ident" id="6178983">DT_SONAME</span><span class="op" id="6178992">,</span>&nbsp;<span class="ident" id="6178994">DT_RPATH</span><span class="op" id="6179002">,</span>&nbsp;<span class="ident" id="6179004">DT_RUNPATH</span><span class="op" id="6179014">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179017">default</span><span class="op" id="6179024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179028">return</span>&nbsp;<span class="ident" id="6179035">nil</span><span class="op" id="6179038">,</span>&nbsp;<span class="ident" id="6179040">fmt</span><span class="op" id="6179043">.</span><span class="ident" id="6179044">Errorf</span><span class="op" id="6179050">(</span><span class="string" id="6179051">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="6179077">,</span>&nbsp;<span class="ident" id="6179079">tag</span><span class="op" id="6179082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179088">ds</span>&nbsp;<span class="op" id="6179091">:=</span>&nbsp;<span class="ident" id="6179094">f</span><span class="op" id="6179095">.</span><span class="ident" id="6179096">SectionByType</span><span class="op" id="6179109">(</span><span class="ident" id="6179110">SHT_DYNAMIC</span><span class="op" id="6179121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179124">if</span>&nbsp;<span class="ident" id="6179127">ds</span>&nbsp;<span class="op" id="6179130">==</span>&nbsp;<span class="ident" id="6179133">nil</span>&nbsp;<span class="op" id="6179137">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6179141">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179175">return</span>&nbsp;<span class="ident" id="6179182">nil</span><span class="op" id="6179185">,</span>&nbsp;<span class="ident" id="6179187">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179195">d</span><span class="op" id="6179196">,</span>&nbsp;<span class="ident" id="6179198">err</span>&nbsp;<span class="op" id="6179202">:=</span>&nbsp;<span class="ident" id="6179205">ds</span><span class="op" id="6179207">.</span><span class="ident" id="6179208">Data</span><span class="op" id="6179212">(</span><span class="op" id="6179213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179216">if</span>&nbsp;<span class="ident" id="6179219">err</span>&nbsp;<span class="op" id="6179223">!=</span>&nbsp;<span class="ident" id="6179226">nil</span>&nbsp;<span class="op" id="6179230">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179234">return</span>&nbsp;<span class="ident" id="6179241">nil</span><span class="op" id="6179244">,</span>&nbsp;<span class="ident" id="6179246">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179254">str</span><span class="op" id="6179257">,</span>&nbsp;<span class="ident" id="6179259">err</span>&nbsp;<span class="op" id="6179263">:=</span>&nbsp;<span class="ident" id="6179266">f</span><span class="op" id="6179267">.</span><span class="ident" id="6179268">stringTable</span><span class="op" id="6179279">(</span><span class="ident" id="6179280">ds</span><span class="op" id="6179282">.</span><span class="ident" id="6179283">Link</span><span class="op" id="6179287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179290">if</span>&nbsp;<span class="ident" id="6179293">err</span>&nbsp;<span class="op" id="6179297">!=</span>&nbsp;<span class="ident" id="6179300">nil</span>&nbsp;<span class="op" id="6179304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179308">return</span>&nbsp;<span class="ident" id="6179315">nil</span><span class="op" id="6179318">,</span>&nbsp;<span class="ident" id="6179320">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179328">var</span>&nbsp;<span class="ident" id="6179332">all</span>&nbsp;<span class="op" id="6179336">[</span><span class="op" id="6179337">]</span><span class="builtintype" id="6179338">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179346">for</span>&nbsp;<span class="builtinfunc" id="6179350">len</span><span class="op" id="6179353">(</span><span class="ident" id="6179354">d</span><span class="op" id="6179355">)</span>&nbsp;<span class="op" id="6179357">&gt;</span>&nbsp;<span class="num" id="6179359">0</span>&nbsp;<span class="op" id="6179361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179365">var</span>&nbsp;<span class="ident" id="6179369">t</span>&nbsp;<span class="ident" id="6179371">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179380">var</span>&nbsp;<span class="ident" id="6179384">v</span>&nbsp;<span class="ident" id="6179386">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179395">switch</span>&nbsp;<span class="ident" id="6179402">f</span><span class="op" id="6179403">.</span><span class="ident" id="6179404">Class</span>&nbsp;<span class="op" id="6179410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179414">case</span>&nbsp;<span class="ident" id="6179419">ELFCLASS32</span><span class="op" id="6179429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179434">t</span>&nbsp;<span class="op" id="6179436">=</span>&nbsp;<span class="ident" id="6179438">DynTag</span><span class="op" id="6179444">(</span><span class="ident" id="6179445">f</span><span class="op" id="6179446">.</span><span class="ident" id="6179447">ByteOrder</span><span class="op" id="6179456">.</span><span class="ident" id="6179457">Uint32</span><span class="op" id="6179463">(</span><span class="ident" id="6179464">d</span><span class="op" id="6179465">[</span><span class="num" id="6179466">0</span><span class="op" id="6179467">:</span><span class="num" id="6179468">4</span><span class="op" id="6179469">]</span><span class="op" id="6179470">)</span><span class="op" id="6179471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179476">v</span>&nbsp;<span class="op" id="6179478">=</span>&nbsp;<span class="ident" id="6179480">uint64</span><span class="op" id="6179486">(</span><span class="ident" id="6179487">f</span><span class="op" id="6179488">.</span><span class="ident" id="6179489">ByteOrder</span><span class="op" id="6179498">.</span><span class="ident" id="6179499">Uint32</span><span class="op" id="6179505">(</span><span class="ident" id="6179506">d</span><span class="op" id="6179507">[</span><span class="num" id="6179508">4</span><span class="op" id="6179509">:</span><span class="num" id="6179510">8</span><span class="op" id="6179511">]</span><span class="op" id="6179512">)</span><span class="op" id="6179513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179518">d</span>&nbsp;<span class="op" id="6179520">=</span>&nbsp;<span class="ident" id="6179522">d</span><span class="op" id="6179523">[</span><span class="num" id="6179524">8</span><span class="op" id="6179525">:</span><span class="op" id="6179526">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179530">case</span>&nbsp;<span class="ident" id="6179535">ELFCLASS64</span><span class="op" id="6179545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179550">t</span>&nbsp;<span class="op" id="6179552">=</span>&nbsp;<span class="ident" id="6179554">DynTag</span><span class="op" id="6179560">(</span><span class="ident" id="6179561">f</span><span class="op" id="6179562">.</span><span class="ident" id="6179563">ByteOrder</span><span class="op" id="6179572">.</span><span class="ident" id="6179573">Uint64</span><span class="op" id="6179579">(</span><span class="ident" id="6179580">d</span><span class="op" id="6179581">[</span><span class="num" id="6179582">0</span><span class="op" id="6179583">:</span><span class="num" id="6179584">8</span><span class="op" id="6179585">]</span><span class="op" id="6179586">)</span><span class="op" id="6179587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179592">v</span>&nbsp;<span class="op" id="6179594">=</span>&nbsp;<span class="ident" id="6179596">f</span><span class="op" id="6179597">.</span><span class="ident" id="6179598">ByteOrder</span><span class="op" id="6179607">.</span><span class="ident" id="6179608">Uint64</span><span class="op" id="6179614">(</span><span class="ident" id="6179615">d</span><span class="op" id="6179616">[</span><span class="num" id="6179617">8</span><span class="op" id="6179618">:</span><span class="num" id="6179619">16</span><span class="op" id="6179621">]</span><span class="op" id="6179622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179627">d</span>&nbsp;<span class="op" id="6179629">=</span>&nbsp;<span class="ident" id="6179631">d</span><span class="op" id="6179632">[</span><span class="num" id="6179633">16</span><span class="op" id="6179635">:</span><span class="op" id="6179636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179640">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179644">if</span>&nbsp;<span class="ident" id="6179647">t</span>&nbsp;<span class="op" id="6179649">==</span>&nbsp;<span class="ident" id="6179652">tag</span>&nbsp;<span class="op" id="6179656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179661">s</span><span class="op" id="6179662">,</span>&nbsp;<span class="ident" id="6179664">ok</span>&nbsp;<span class="op" id="6179667">:=</span>&nbsp;<span class="ident" id="6179670">getString</span><span class="op" id="6179679">(</span><span class="ident" id="6179680">str</span><span class="op" id="6179683">,</span>&nbsp;<span class="builtintype" id="6179685">int</span><span class="op" id="6179688">(</span><span class="ident" id="6179689">v</span><span class="op" id="6179690">)</span><span class="op" id="6179691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179696">if</span>&nbsp;<span class="ident" id="6179699">ok</span>&nbsp;<span class="op" id="6179702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179708">all</span>&nbsp;<span class="op" id="6179712">=</span>&nbsp;<span class="builtinfunc" id="6179714">append</span><span class="op" id="6179720">(</span><span class="ident" id="6179721">all</span><span class="op" id="6179724">,</span>&nbsp;<span class="ident" id="6179726">s</span><span class="op" id="6179727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179732">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179742">return</span>&nbsp;<span class="ident" id="6179749">all</span><span class="op" id="6179752">,</span>&nbsp;<span class="ident" id="6179754">nil</span><br>
<span class="lineno"></span><span class="op" id="6179758">}</span>
</div>
</body>
</html>
