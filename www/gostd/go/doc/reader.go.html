<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5459697">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5459752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5459806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5459857">package</span>&nbsp;<span class="ident" id="5459865">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5459870">import</span>&nbsp;<span class="op" id="5459877">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5459880">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5459890">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5459902">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5459912">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5459920">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5459930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5459933">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5460013">//&nbsp;function/method&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="5460037">//</span><br>
<span class="lineno"></span><span class="comment" id="5460040">//&nbsp;Internally,&nbsp;we&nbsp;treat&nbsp;functions&nbsp;like&nbsp;methods&nbsp;and&nbsp;collect&nbsp;them&nbsp;in&nbsp;method&nbsp;sets.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5460121">//&nbsp;A&nbsp;methodSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;methods.&nbsp;Entries&nbsp;where&nbsp;Decl&nbsp;==&nbsp;nil&nbsp;are&nbsp;conflict</span><br>
<span class="lineno"></span><span class="comment" id="5460203">//&nbsp;entries&nbsp;(more&nbsp;then&nbsp;one&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;embedding&nbsp;level).</span><br>
<span class="lineno"></span><span class="comment" id="5460285">//</span><br>
<span class="lineno"></span><span class="keyword" id="5460288">type</span>&nbsp;<span class="ident" id="5460293">methodSet</span>&nbsp;<span class="keyword" id="5460303">map</span><span class="op" id="5460306">[</span><span class="builtintype" id="5460307">string</span><span class="op" id="5460313">]</span><span class="op" id="5460314">*</span><span class="ident" id="5460315">Func</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5460321">//&nbsp;recvString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;recv&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5460382">//&nbsp;form&nbsp;&#34;T&#34;,&nbsp;&#34;*T&#34;,&nbsp;or&nbsp;&#34;BADRECV&#34;&nbsp;(if&nbsp;not&nbsp;a&nbsp;proper&nbsp;receiver&nbsp;type).</span><br>
<span class="lineno"></span><span class="comment" id="5460447">//</span><br>
<span class="lineno"></span><span class="keyword" id="5460450">func</span>&nbsp;<span class="ident" id="5460455">recvString</span><span class="op" id="5460465">(</span><span class="ident" id="5460466">recv</span>&nbsp;<span class="ident" id="5460471">ast</span><span class="op" id="5460474">.</span><span class="ident" id="5460475">Expr</span><span class="op" id="5460479">)</span>&nbsp;<span class="builtintype" id="5460481">string</span>&nbsp;<span class="op" id="5460488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460491">switch</span>&nbsp;<span class="ident" id="5460498">t</span>&nbsp;<span class="op" id="5460500">:=</span>&nbsp;<span class="ident" id="5460503">recv</span><span class="op" id="5460507">.</span><span class="op" id="5460508">(</span><span class="keyword" id="5460509">type</span><span class="op" id="5460513">)</span>&nbsp;<span class="op" id="5460515">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460518">case</span>&nbsp;<span class="op" id="5460523">*</span><span class="ident" id="5460524">ast</span><span class="op" id="5460527">.</span><span class="ident" id="5460528">Ident</span><span class="op" id="5460533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460537">return</span>&nbsp;<span class="ident" id="5460544">t</span><span class="op" id="5460545">.</span><span class="ident" id="5460546">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460552">case</span>&nbsp;<span class="op" id="5460557">*</span><span class="ident" id="5460558">ast</span><span class="op" id="5460561">.</span><span class="ident" id="5460562">StarExpr</span><span class="op" id="5460570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460574">return</span>&nbsp;<span class="string" id="5460581">&#34;*&#34;</span>&nbsp;<span class="op" id="5460585">+</span>&nbsp;<span class="ident" id="5460587">recvString</span><span class="op" id="5460597">(</span><span class="ident" id="5460598">t</span><span class="op" id="5460599">.</span><span class="ident" id="5460600">X</span><span class="op" id="5460601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5460604">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460607">return</span>&nbsp;<span class="string" id="5460614">&#34;BADRECV&#34;</span><br>
<span class="lineno"></span><span class="op" id="5460624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5460627">//&nbsp;set&nbsp;creates&nbsp;the&nbsp;corresponding&nbsp;Func&nbsp;for&nbsp;f&nbsp;and&nbsp;adds&nbsp;it&nbsp;to&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5460692">//&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;f&#39;s&nbsp;with&nbsp;the&nbsp;same&nbsp;name,&nbsp;set&nbsp;keeps&nbsp;the&nbsp;first</span><br>
<span class="lineno">40</span><span class="comment" id="5460761">//&nbsp;one&nbsp;with&nbsp;documentation;&nbsp;conflicts&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5460811">//</span><br>
<span class="lineno"></span><span class="keyword" id="5460814">func</span>&nbsp;<span class="op" id="5460819">(</span><span class="ident" id="5460820">mset</span>&nbsp;<span class="ident" id="5460825">methodSet</span><span class="op" id="5460834">)</span>&nbsp;<span class="ident" id="5460836">set</span><span class="op" id="5460839">(</span><span class="ident" id="5460840">f</span>&nbsp;<span class="op" id="5460842">*</span><span class="ident" id="5460843">ast</span><span class="op" id="5460846">.</span><span class="ident" id="5460847">FuncDecl</span><span class="op" id="5460855">)</span>&nbsp;<span class="op" id="5460857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5460860">name</span>&nbsp;<span class="op" id="5460865">:=</span>&nbsp;<span class="ident" id="5460868">f</span><span class="op" id="5460869">.</span><span class="ident" id="5460870">Name</span><span class="op" id="5460874">.</span><span class="ident" id="5460875">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5460881">if</span>&nbsp;<span class="ident" id="5460884">g</span>&nbsp;<span class="op" id="5460886">:=</span>&nbsp;<span class="ident" id="5460889">mset</span><span class="op" id="5460893">[</span><span class="ident" id="5460894">name</span><span class="op" id="5460898">]</span><span class="op" id="5460899">;</span>&nbsp;<span class="ident" id="5460901">g</span>&nbsp;<span class="op" id="5460903">!=</span>&nbsp;<span class="ident" id="5460906">nil</span>&nbsp;<span class="op" id="5460910">&amp;&amp;</span>&nbsp;<span class="ident" id="5460913">g</span><span class="op" id="5460914">.</span><span class="ident" id="5460915">Doc</span>&nbsp;<span class="op" id="5460919">!=</span>&nbsp;<span class="string" id="5460922">&#34;&#34;</span>&nbsp;<span class="op" id="5460925">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5460929">//&nbsp;A&nbsp;function&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;has&nbsp;already&nbsp;been&nbsp;registered;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5460993">//&nbsp;since&nbsp;it&nbsp;has&nbsp;documentation,&nbsp;assume&nbsp;f&nbsp;is&nbsp;simply&nbsp;another</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461053">//&nbsp;implementation&nbsp;and&nbsp;ignore&nbsp;it.&nbsp;This&nbsp;does&nbsp;not&nbsp;happen&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461116">//&nbsp;caller&nbsp;is&nbsp;using&nbsp;go/build.ScanDir&nbsp;to&nbsp;determine&nbsp;the&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461179">//&nbsp;files&nbsp;implementing&nbsp;a&nbsp;package.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461214">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461225">//&nbsp;function&nbsp;doesn&#39;t&nbsp;exist&nbsp;or&nbsp;has&nbsp;no&nbsp;documentation;&nbsp;use&nbsp;f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461283">recv</span>&nbsp;<span class="op" id="5461288">:=</span>&nbsp;<span class="string" id="5461291">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461295">if</span>&nbsp;<span class="ident" id="5461298">f</span><span class="op" id="5461299">.</span><span class="ident" id="5461300">Recv</span>&nbsp;<span class="op" id="5461305">!=</span>&nbsp;<span class="ident" id="5461308">nil</span>&nbsp;<span class="op" id="5461312">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461316">var</span>&nbsp;<span class="ident" id="5461320">typ</span>&nbsp;<span class="ident" id="5461324">ast</span><span class="op" id="5461327">.</span><span class="ident" id="5461328">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461335">//&nbsp;be&nbsp;careful&nbsp;in&nbsp;case&nbsp;of&nbsp;incorrect&nbsp;ASTs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461377">if</span>&nbsp;<span class="ident" id="5461380">list</span>&nbsp;<span class="op" id="5461385">:=</span>&nbsp;<span class="ident" id="5461388">f</span><span class="op" id="5461389">.</span><span class="ident" id="5461390">Recv</span><span class="op" id="5461394">.</span><span class="ident" id="5461395">List</span><span class="op" id="5461399">;</span>&nbsp;<span class="builtinfunc" id="5461401">len</span><span class="op" id="5461404">(</span><span class="ident" id="5461405">list</span><span class="op" id="5461409">)</span>&nbsp;<span class="op" id="5461411">==</span>&nbsp;<span class="num" id="5461414">1</span>&nbsp;<span class="op" id="5461416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461421">typ</span>&nbsp;<span class="op" id="5461425">=</span>&nbsp;<span class="ident" id="5461427">list</span><span class="op" id="5461431">[</span><span class="num" id="5461432">0</span><span class="op" id="5461433">]</span><span class="op" id="5461434">.</span><span class="ident" id="5461435">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461442">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461446">recv</span>&nbsp;<span class="op" id="5461451">=</span>&nbsp;<span class="ident" id="5461453">recvString</span><span class="op" id="5461463">(</span><span class="ident" id="5461464">typ</span><span class="op" id="5461467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461473">mset</span><span class="op" id="5461477">[</span><span class="ident" id="5461478">name</span><span class="op" id="5461482">]</span>&nbsp;<span class="op" id="5461484">=</span>&nbsp;<span class="op" id="5461486">&amp;</span><span class="ident" id="5461487">Func</span><span class="op" id="5461491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461495">Doc</span><span class="op" id="5461498">:</span>&nbsp;&nbsp;<span class="ident" id="5461501">f</span><span class="op" id="5461502">.</span><span class="ident" id="5461503">Doc</span><span class="op" id="5461506">.</span><span class="ident" id="5461507">Text</span><span class="op" id="5461511">(</span><span class="op" id="5461512">)</span><span class="op" id="5461513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461517">Name</span><span class="op" id="5461521">:</span>&nbsp;<span class="ident" id="5461523">name</span><span class="op" id="5461527">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461531">Decl</span><span class="op" id="5461535">:</span>&nbsp;<span class="ident" id="5461537">f</span><span class="op" id="5461538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461542">Recv</span><span class="op" id="5461546">:</span>&nbsp;<span class="ident" id="5461548">recv</span><span class="op" id="5461552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461556">Orig</span><span class="op" id="5461560">:</span>&nbsp;<span class="ident" id="5461562">recv</span><span class="op" id="5461566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461572">f</span><span class="op" id="5461573">.</span><span class="ident" id="5461574">Doc</span>&nbsp;<span class="op" id="5461578">=</span>&nbsp;<span class="ident" id="5461580">nil</span>&nbsp;<span class="comment" id="5461584">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno">70</span><span class="op" id="5461618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5461621">//&nbsp;add&nbsp;adds&nbsp;method&nbsp;m&nbsp;to&nbsp;the&nbsp;method&nbsp;set;&nbsp;m&nbsp;is&nbsp;ignored&nbsp;if&nbsp;the&nbsp;method&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="5461692">//&nbsp;already&nbsp;contains&nbsp;a&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;or&nbsp;a&nbsp;higher</span><br>
<span class="lineno"></span><span class="comment" id="5461764">//&nbsp;level&nbsp;then&nbsp;m.</span><br>
<span class="lineno">75</span><span class="comment" id="5461781">//</span><br>
<span class="lineno"></span><span class="keyword" id="5461784">func</span>&nbsp;<span class="op" id="5461789">(</span><span class="ident" id="5461790">mset</span>&nbsp;<span class="ident" id="5461795">methodSet</span><span class="op" id="5461804">)</span>&nbsp;<span class="ident" id="5461806">add</span><span class="op" id="5461809">(</span><span class="ident" id="5461810">m</span>&nbsp;<span class="op" id="5461812">*</span><span class="ident" id="5461813">Func</span><span class="op" id="5461817">)</span>&nbsp;<span class="op" id="5461819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461822">old</span>&nbsp;<span class="op" id="5461826">:=</span>&nbsp;<span class="ident" id="5461829">mset</span><span class="op" id="5461833">[</span><span class="ident" id="5461834">m</span><span class="op" id="5461835">.</span><span class="ident" id="5461836">Name</span><span class="op" id="5461840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461843">if</span>&nbsp;<span class="ident" id="5461846">old</span>&nbsp;<span class="op" id="5461850">==</span>&nbsp;<span class="ident" id="5461853">nil</span>&nbsp;<span class="op" id="5461857">||</span>&nbsp;<span class="ident" id="5461860">m</span><span class="op" id="5461861">.</span><span class="ident" id="5461862">Level</span>&nbsp;<span class="op" id="5461868">&lt;</span>&nbsp;<span class="ident" id="5461870">old</span><span class="op" id="5461873">.</span><span class="ident" id="5461874">Level</span>&nbsp;<span class="op" id="5461880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5461884">mset</span><span class="op" id="5461888">[</span><span class="ident" id="5461889">m</span><span class="op" id="5461890">.</span><span class="ident" id="5461891">Name</span><span class="op" id="5461895">]</span>&nbsp;<span class="op" id="5461897">=</span>&nbsp;<span class="ident" id="5461899">m</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5461911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5461914">if</span>&nbsp;<span class="ident" id="5461917">old</span>&nbsp;<span class="op" id="5461921">!=</span>&nbsp;<span class="ident" id="5461924">nil</span>&nbsp;<span class="op" id="5461928">&amp;&amp;</span>&nbsp;<span class="ident" id="5461931">m</span><span class="op" id="5461932">.</span><span class="ident" id="5461933">Level</span>&nbsp;<span class="op" id="5461939">==</span>&nbsp;<span class="ident" id="5461942">old</span><span class="op" id="5461945">.</span><span class="ident" id="5461946">Level</span>&nbsp;<span class="op" id="5461952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5461956">//&nbsp;conflict&nbsp;-&nbsp;mark&nbsp;it&nbsp;using&nbsp;a&nbsp;method&nbsp;with&nbsp;nil&nbsp;Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462009">mset</span><span class="op" id="5462013">[</span><span class="ident" id="5462014">m</span><span class="op" id="5462015">.</span><span class="ident" id="5462016">Name</span><span class="op" id="5462020">]</span>&nbsp;<span class="op" id="5462022">=</span>&nbsp;<span class="op" id="5462024">&amp;</span><span class="ident" id="5462025">Func</span><span class="op" id="5462029">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462034">Name</span><span class="op" id="5462038">:</span>&nbsp;&nbsp;<span class="ident" id="5462041">m</span><span class="op" id="5462042">.</span><span class="ident" id="5462043">Name</span><span class="op" id="5462047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462052">Level</span><span class="op" id="5462057">:</span>&nbsp;<span class="ident" id="5462059">m</span><span class="op" id="5462060">.</span><span class="ident" id="5462061">Level</span><span class="op" id="5462066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462073">}</span><br>
<span class="lineno"></span><span class="op" id="5462075">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5462078">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5462158">//&nbsp;Named&nbsp;types</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5462174">//&nbsp;baseTypeName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;base&nbsp;type&nbsp;of&nbsp;x&nbsp;(or&nbsp;&#34;&#34;)</span><br>
<span class="lineno">95</span><span class="comment" id="5462237">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;type&nbsp;is&nbsp;imported&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span><span class="comment" id="5462281">//</span><br>
<span class="lineno"></span><span class="keyword" id="5462284">func</span>&nbsp;<span class="ident" id="5462289">baseTypeName</span><span class="op" id="5462301">(</span><span class="ident" id="5462302">x</span>&nbsp;<span class="ident" id="5462304">ast</span><span class="op" id="5462307">.</span><span class="ident" id="5462308">Expr</span><span class="op" id="5462312">)</span>&nbsp;<span class="op" id="5462314">(</span><span class="ident" id="5462315">name</span>&nbsp;<span class="builtintype" id="5462320">string</span><span class="op" id="5462326">,</span>&nbsp;<span class="ident" id="5462328">imported</span>&nbsp;<span class="builtintype" id="5462337">bool</span><span class="op" id="5462341">)</span>&nbsp;<span class="op" id="5462343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462346">switch</span>&nbsp;<span class="ident" id="5462353">t</span>&nbsp;<span class="op" id="5462355">:=</span>&nbsp;<span class="ident" id="5462358">x</span><span class="op" id="5462359">.</span><span class="op" id="5462360">(</span><span class="keyword" id="5462361">type</span><span class="op" id="5462365">)</span>&nbsp;<span class="op" id="5462367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462370">case</span>&nbsp;<span class="op" id="5462375">*</span><span class="ident" id="5462376">ast</span><span class="op" id="5462379">.</span><span class="ident" id="5462380">Ident</span><span class="op" id="5462385">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462389">return</span>&nbsp;<span class="ident" id="5462396">t</span><span class="op" id="5462397">.</span><span class="ident" id="5462398">Name</span><span class="op" id="5462402">,</span>&nbsp;<span class="builtintype" id="5462404">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462411">case</span>&nbsp;<span class="op" id="5462416">*</span><span class="ident" id="5462417">ast</span><span class="op" id="5462420">.</span><span class="ident" id="5462421">SelectorExpr</span><span class="op" id="5462433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462437">if</span>&nbsp;<span class="ident" id="5462440">_</span><span class="op" id="5462441">,</span>&nbsp;<span class="ident" id="5462443">ok</span>&nbsp;<span class="op" id="5462446">:=</span>&nbsp;<span class="ident" id="5462449">t</span><span class="op" id="5462450">.</span><span class="ident" id="5462451">X</span><span class="op" id="5462452">.</span><span class="op" id="5462453">(</span><span class="op" id="5462454">*</span><span class="ident" id="5462455">ast</span><span class="op" id="5462458">.</span><span class="ident" id="5462459">Ident</span><span class="op" id="5462464">)</span><span class="op" id="5462465">;</span>&nbsp;<span class="ident" id="5462467">ok</span>&nbsp;<span class="op" id="5462470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5462475">//&nbsp;only&nbsp;possible&nbsp;for&nbsp;qualified&nbsp;type&nbsp;names;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5462521">//&nbsp;assume&nbsp;type&nbsp;is&nbsp;imported</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462551">return</span>&nbsp;<span class="ident" id="5462558">t</span><span class="op" id="5462559">.</span><span class="ident" id="5462560">Sel</span><span class="op" id="5462563">.</span><span class="ident" id="5462564">Name</span><span class="op" id="5462568">,</span>&nbsp;<span class="builtintype" id="5462570">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462580">case</span>&nbsp;<span class="op" id="5462585">*</span><span class="ident" id="5462586">ast</span><span class="op" id="5462589">.</span><span class="ident" id="5462590">StarExpr</span><span class="op" id="5462598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462602">return</span>&nbsp;<span class="ident" id="5462609">baseTypeName</span><span class="op" id="5462621">(</span><span class="ident" id="5462622">t</span><span class="op" id="5462623">.</span><span class="ident" id="5462624">X</span><span class="op" id="5462625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5462628">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5462631">return</span><br>
<span class="lineno"></span><span class="op" id="5462638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5462641">//&nbsp;An&nbsp;embeddedSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;embedded&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5462694">type</span>&nbsp;<span class="ident" id="5462699">embeddedSet</span>&nbsp;<span class="keyword" id="5462711">map</span><span class="op" id="5462714">[</span><span class="op" id="5462715">*</span><span class="ident" id="5462716">namedType</span><span class="op" id="5462725">]</span><span class="builtintype" id="5462726">bool</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5462732">//&nbsp;A&nbsp;namedType&nbsp;represents&nbsp;a&nbsp;named&nbsp;unqualified&nbsp;(package&nbsp;local,&nbsp;or&nbsp;possibly</span><br>
<span class="lineno"></span><span class="comment" id="5462806">//&nbsp;predeclared)&nbsp;type.&nbsp;The&nbsp;namedType&nbsp;for&nbsp;a&nbsp;type&nbsp;name&nbsp;is&nbsp;always&nbsp;found&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="5462878">//&nbsp;reader.lookupType.</span><br>
<span class="lineno"></span><span class="comment" id="5462900">//</span><br>
<span class="lineno">120</span><span class="keyword" id="5462903">type</span>&nbsp;<span class="ident" id="5462908">namedType</span>&nbsp;<span class="keyword" id="5462918">struct</span>&nbsp;<span class="op" id="5462925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462928">doc</span>&nbsp;&nbsp;<span class="builtintype" id="5462933">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5462946">//&nbsp;doc&nbsp;comment&nbsp;for&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5462971">name</span>&nbsp;<span class="builtintype" id="5462976">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5462989">//&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463003">decl</span>&nbsp;<span class="op" id="5463008">*</span><span class="ident" id="5463009">ast</span><span class="op" id="5463012">.</span><span class="ident" id="5463013">GenDecl</span>&nbsp;<span class="comment" id="5463021">//&nbsp;nil&nbsp;if&nbsp;declaration&nbsp;hasn&#39;t&nbsp;been&nbsp;seen&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463066">isEmbedded</span>&nbsp;<span class="builtintype" id="5463077">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463089">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463123">isStruct</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5463134">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5463146">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463180">embedded</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5463191">embeddedSet</span>&nbsp;<span class="comment" id="5463203">//&nbsp;true&nbsp;if&nbsp;the&nbsp;embedded&nbsp;type&nbsp;is&nbsp;a&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5463247">//&nbsp;associated&nbsp;declarations</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463275">values</span>&nbsp;&nbsp;<span class="op" id="5463283">[</span><span class="op" id="5463284">]</span><span class="op" id="5463285">*</span><span class="ident" id="5463286">Value</span>&nbsp;<span class="comment" id="5463292">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463312">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5463320">methodSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463331">methods</span>&nbsp;<span class="ident" id="5463339">methodSet</span><br>
<span class="lineno"></span><span class="op" id="5463349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5463352">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5463432">//&nbsp;AST&nbsp;reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5463447">//&nbsp;reader&nbsp;accumulates&nbsp;documentation&nbsp;for&nbsp;a&nbsp;single&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="5463505">//&nbsp;It&nbsp;modifies&nbsp;the&nbsp;AST:&nbsp;Comments&nbsp;(declaration&nbsp;documentation)</span><br>
<span class="lineno">140</span><span class="comment" id="5463566">//&nbsp;that&nbsp;have&nbsp;been&nbsp;collected&nbsp;by&nbsp;the&nbsp;reader&nbsp;are&nbsp;set&nbsp;to&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="5463623">//&nbsp;in&nbsp;the&nbsp;respective&nbsp;AST&nbsp;nodes&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;printed</span><br>
<span class="lineno"></span><span class="comment" id="5463683">//&nbsp;twice&nbsp;(once&nbsp;when&nbsp;printing&nbsp;the&nbsp;documentation&nbsp;and&nbsp;once&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5463744">//&nbsp;printing&nbsp;the&nbsp;corresponding&nbsp;AST&nbsp;node).</span><br>
<span class="lineno"></span><span class="comment" id="5463785">//</span><br>
<span class="lineno">145</span><span class="keyword" id="5463788">type</span>&nbsp;<span class="ident" id="5463793">reader</span>&nbsp;<span class="keyword" id="5463800">struct</span>&nbsp;<span class="op" id="5463807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463810">mode</span>&nbsp;<span class="ident" id="5463815">Mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5463822">//&nbsp;package&nbsp;properties</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463845">doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5463855">string</span>&nbsp;<span class="comment" id="5463862">//&nbsp;package&nbsp;documentation,&nbsp;if&nbsp;any</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463896">filenames</span>&nbsp;<span class="op" id="5463906">[</span><span class="op" id="5463907">]</span><span class="builtintype" id="5463908">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463916">notes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5463926">map</span><span class="op" id="5463929">[</span><span class="builtintype" id="5463930">string</span><span class="op" id="5463936">]</span><span class="op" id="5463937">[</span><span class="op" id="5463938">]</span><span class="op" id="5463939">*</span><span class="ident" id="5463940">Note</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5463947">//&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463964">imports</span>&nbsp;<span class="keyword" id="5463972">map</span><span class="op" id="5463975">[</span><span class="builtintype" id="5463976">string</span><span class="op" id="5463982">]</span><span class="builtintype" id="5463983">int</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5463988">values</span>&nbsp;&nbsp;<span class="op" id="5463996">[</span><span class="op" id="5463997">]</span><span class="op" id="5463998">*</span><span class="ident" id="5463999">Value</span>&nbsp;<span class="comment" id="5464005">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464025">types</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5464033">map</span><span class="op" id="5464036">[</span><span class="builtintype" id="5464037">string</span><span class="op" id="5464043">]</span><span class="op" id="5464044">*</span><span class="ident" id="5464045">namedType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464056">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5464064">methodSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5464076">//&nbsp;support&nbsp;for&nbsp;package-local&nbsp;error&nbsp;type&nbsp;declarations</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464130">errorDecl</span>&nbsp;<span class="builtintype" id="5464140">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5464161">//&nbsp;if&nbsp;set,&nbsp;type&nbsp;&#34;error&#34;&nbsp;was&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464207">fixlist</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5464217">[</span><span class="op" id="5464218">]</span><span class="op" id="5464219">*</span><span class="ident" id="5464220">ast</span><span class="op" id="5464223">.</span><span class="ident" id="5464224">InterfaceType</span>&nbsp;<span class="comment" id="5464238">//&nbsp;list&nbsp;of&nbsp;interfaces&nbsp;containing&nbsp;anonymous&nbsp;field&nbsp;&#34;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="5464295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5464298">func</span>&nbsp;<span class="op" id="5464303">(</span><span class="ident" id="5464304">r</span>&nbsp;<span class="op" id="5464306">*</span><span class="ident" id="5464307">reader</span><span class="op" id="5464313">)</span>&nbsp;<span class="ident" id="5464315">isVisible</span><span class="op" id="5464324">(</span><span class="ident" id="5464325">name</span>&nbsp;<span class="builtintype" id="5464330">string</span><span class="op" id="5464336">)</span>&nbsp;<span class="builtintype" id="5464338">bool</span>&nbsp;<span class="op" id="5464343">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5464346">return</span>&nbsp;<span class="ident" id="5464353">r</span><span class="op" id="5464354">.</span><span class="ident" id="5464355">mode</span><span class="op" id="5464359">&amp;</span><span class="ident" id="5464360">AllDecls</span>&nbsp;<span class="op" id="5464369">!=</span>&nbsp;<span class="num" id="5464372">0</span>&nbsp;<span class="op" id="5464374">||</span>&nbsp;<span class="ident" id="5464377">ast</span><span class="op" id="5464380">.</span><span class="ident" id="5464381">IsExported</span><span class="op" id="5464391">(</span><span class="ident" id="5464392">name</span><span class="op" id="5464396">)</span><br>
<span class="lineno"></span><span class="op" id="5464398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5464401">//&nbsp;lookupType&nbsp;returns&nbsp;the&nbsp;base&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="5464458">//&nbsp;If&nbsp;the&nbsp;base&nbsp;type&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;yet,&nbsp;a&nbsp;new</span><br>
<span class="lineno">170</span><span class="comment" id="5464514">//&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;but&nbsp;no&nbsp;associated&nbsp;declaration</span><br>
<span class="lineno"></span><span class="comment" id="5464572">//&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;type&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5464601">//</span><br>
<span class="lineno"></span><span class="keyword" id="5464604">func</span>&nbsp;<span class="op" id="5464609">(</span><span class="ident" id="5464610">r</span>&nbsp;<span class="op" id="5464612">*</span><span class="ident" id="5464613">reader</span><span class="op" id="5464619">)</span>&nbsp;<span class="ident" id="5464621">lookupType</span><span class="op" id="5464631">(</span><span class="ident" id="5464632">name</span>&nbsp;<span class="builtintype" id="5464637">string</span><span class="op" id="5464643">)</span>&nbsp;<span class="op" id="5464645">*</span><span class="ident" id="5464646">namedType</span>&nbsp;<span class="op" id="5464656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5464659">if</span>&nbsp;<span class="ident" id="5464662">name</span>&nbsp;<span class="op" id="5464667">==</span>&nbsp;<span class="string" id="5464670">&#34;&#34;</span>&nbsp;<span class="op" id="5464673">||</span>&nbsp;<span class="ident" id="5464676">name</span>&nbsp;<span class="op" id="5464681">==</span>&nbsp;<span class="string" id="5464684">&#34;_&#34;</span>&nbsp;<span class="op" id="5464688">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5464692">return</span>&nbsp;<span class="ident" id="5464699">nil</span>&nbsp;<span class="comment" id="5464703">//&nbsp;no&nbsp;type&nbsp;docs&nbsp;for&nbsp;anonymous&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5464740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5464743">if</span>&nbsp;<span class="ident" id="5464746">typ</span><span class="op" id="5464749">,</span>&nbsp;<span class="ident" id="5464751">found</span>&nbsp;<span class="op" id="5464757">:=</span>&nbsp;<span class="ident" id="5464760">r</span><span class="op" id="5464761">.</span><span class="ident" id="5464762">types</span><span class="op" id="5464767">[</span><span class="ident" id="5464768">name</span><span class="op" id="5464772">]</span><span class="op" id="5464773">;</span>&nbsp;<span class="ident" id="5464775">found</span>&nbsp;<span class="op" id="5464781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5464785">return</span>&nbsp;<span class="ident" id="5464792">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5464797">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5464800">//&nbsp;type&nbsp;not&nbsp;found&nbsp;-&nbsp;add&nbsp;one&nbsp;without&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464849">typ</span>&nbsp;<span class="op" id="5464853">:=</span>&nbsp;<span class="op" id="5464856">&amp;</span><span class="ident" id="5464857">namedType</span><span class="op" id="5464866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464870">name</span><span class="op" id="5464874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5464880">name</span><span class="op" id="5464884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464888">embedded</span><span class="op" id="5464896">:</span>&nbsp;<span class="builtinfunc" id="5464898">make</span><span class="op" id="5464902">(</span><span class="ident" id="5464903">embeddedSet</span><span class="op" id="5464914">)</span><span class="op" id="5464915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464919">funcs</span><span class="op" id="5464924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5464929">make</span><span class="op" id="5464933">(</span><span class="ident" id="5464934">methodSet</span><span class="op" id="5464943">)</span><span class="op" id="5464944">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464948">methods</span><span class="op" id="5464955">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="5464958">make</span><span class="op" id="5464962">(</span><span class="ident" id="5464963">methodSet</span><span class="op" id="5464972">)</span><span class="op" id="5464973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5464976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5464979">r</span><span class="op" id="5464980">.</span><span class="ident" id="5464981">types</span><span class="op" id="5464986">[</span><span class="ident" id="5464987">name</span><span class="op" id="5464991">]</span>&nbsp;<span class="op" id="5464993">=</span>&nbsp;<span class="ident" id="5464995">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465000">return</span>&nbsp;<span class="ident" id="5465007">typ</span><br>
<span class="lineno"></span><span class="op" id="5465011">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5465014">//&nbsp;recordAnonymousField&nbsp;registers&nbsp;fieldType&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5465076">//&nbsp;anonymous&nbsp;field&nbsp;in&nbsp;the&nbsp;parent&nbsp;type.&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5465140">//&nbsp;(qualified&nbsp;name)&nbsp;or&nbsp;the&nbsp;parent&nbsp;is&nbsp;nil,&nbsp;the&nbsp;field&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5465204">//&nbsp;The&nbsp;function&nbsp;returns&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">195</span><span class="comment" id="5465244">//</span><br>
<span class="lineno"></span><span class="keyword" id="5465247">func</span>&nbsp;<span class="op" id="5465252">(</span><span class="ident" id="5465253">r</span>&nbsp;<span class="op" id="5465255">*</span><span class="ident" id="5465256">reader</span><span class="op" id="5465262">)</span>&nbsp;<span class="ident" id="5465264">recordAnonymousField</span><span class="op" id="5465284">(</span><span class="ident" id="5465285">parent</span>&nbsp;<span class="op" id="5465292">*</span><span class="ident" id="5465293">namedType</span><span class="op" id="5465302">,</span>&nbsp;<span class="ident" id="5465304">fieldType</span>&nbsp;<span class="ident" id="5465314">ast</span><span class="op" id="5465317">.</span><span class="ident" id="5465318">Expr</span><span class="op" id="5465322">)</span>&nbsp;<span class="op" id="5465324">(</span><span class="ident" id="5465325">fname</span>&nbsp;<span class="builtintype" id="5465331">string</span><span class="op" id="5465337">)</span>&nbsp;<span class="op" id="5465339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465342">fname</span><span class="op" id="5465347">,</span>&nbsp;<span class="ident" id="5465349">imp</span>&nbsp;<span class="op" id="5465353">:=</span>&nbsp;<span class="ident" id="5465356">baseTypeName</span><span class="op" id="5465368">(</span><span class="ident" id="5465369">fieldType</span><span class="op" id="5465378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465381">if</span>&nbsp;<span class="ident" id="5465384">parent</span>&nbsp;<span class="op" id="5465391">==</span>&nbsp;<span class="ident" id="5465394">nil</span>&nbsp;<span class="op" id="5465398">||</span>&nbsp;<span class="ident" id="5465401">imp</span>&nbsp;<span class="op" id="5465405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465409">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5465417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465420">if</span>&nbsp;<span class="ident" id="5465423">ftype</span>&nbsp;<span class="op" id="5465429">:=</span>&nbsp;<span class="ident" id="5465432">r</span><span class="op" id="5465433">.</span><span class="ident" id="5465434">lookupType</span><span class="op" id="5465444">(</span><span class="ident" id="5465445">fname</span><span class="op" id="5465450">)</span><span class="op" id="5465451">;</span>&nbsp;<span class="ident" id="5465453">ftype</span>&nbsp;<span class="op" id="5465459">!=</span>&nbsp;<span class="ident" id="5465462">nil</span>&nbsp;<span class="op" id="5465466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465470">ftype</span><span class="op" id="5465475">.</span><span class="ident" id="5465476">isEmbedded</span>&nbsp;<span class="op" id="5465487">=</span>&nbsp;<span class="builtintype" id="5465489">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465496">_</span><span class="op" id="5465497">,</span>&nbsp;<span class="ident" id="5465499">ptr</span>&nbsp;<span class="op" id="5465503">:=</span>&nbsp;<span class="ident" id="5465506">fieldType</span><span class="op" id="5465515">.</span><span class="op" id="5465516">(</span><span class="op" id="5465517">*</span><span class="ident" id="5465518">ast</span><span class="op" id="5465521">.</span><span class="ident" id="5465522">StarExpr</span><span class="op" id="5465530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465534">parent</span><span class="op" id="5465540">.</span><span class="ident" id="5465541">embedded</span><span class="op" id="5465549">[</span><span class="ident" id="5465550">ftype</span><span class="op" id="5465555">]</span>&nbsp;<span class="op" id="5465557">=</span>&nbsp;<span class="ident" id="5465559">ptr</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5465564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465567">return</span><br>
<span class="lineno"></span><span class="op" id="5465574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5465577">func</span>&nbsp;<span class="op" id="5465582">(</span><span class="ident" id="5465583">r</span>&nbsp;<span class="op" id="5465585">*</span><span class="ident" id="5465586">reader</span><span class="op" id="5465592">)</span>&nbsp;<span class="ident" id="5465594">readDoc</span><span class="op" id="5465601">(</span><span class="ident" id="5465602">comment</span>&nbsp;<span class="op" id="5465610">*</span><span class="ident" id="5465611">ast</span><span class="op" id="5465614">.</span><span class="ident" id="5465615">CommentGroup</span><span class="op" id="5465627">)</span>&nbsp;<span class="op" id="5465629">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5465632">//&nbsp;By&nbsp;convention&nbsp;there&nbsp;should&nbsp;be&nbsp;only&nbsp;one&nbsp;package&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5465691">//&nbsp;but&nbsp;collect&nbsp;all&nbsp;of&nbsp;them&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;then&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465747">text</span>&nbsp;<span class="op" id="5465752">:=</span>&nbsp;<span class="ident" id="5465755">comment</span><span class="op" id="5465762">.</span><span class="ident" id="5465763">Text</span><span class="op" id="5465767">(</span><span class="op" id="5465768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465771">if</span>&nbsp;<span class="ident" id="5465774">r</span><span class="op" id="5465775">.</span><span class="ident" id="5465776">doc</span>&nbsp;<span class="op" id="5465780">==</span>&nbsp;<span class="string" id="5465783">&#34;&#34;</span>&nbsp;<span class="op" id="5465786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465790">r</span><span class="op" id="5465791">.</span><span class="ident" id="5465792">doc</span>&nbsp;<span class="op" id="5465796">=</span>&nbsp;<span class="ident" id="5465798">text</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5465805">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5465813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465816">r</span><span class="op" id="5465817">.</span><span class="ident" id="5465818">doc</span>&nbsp;<span class="op" id="5465822">+=</span>&nbsp;<span class="string" id="5465825">&#34;\n&#34;</span>&nbsp;<span class="op" id="5465830">+</span>&nbsp;<span class="ident" id="5465832">text</span><br>
<span class="lineno"></span><span class="op" id="5465837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="5465840">func</span>&nbsp;<span class="op" id="5465845">(</span><span class="ident" id="5465846">r</span>&nbsp;<span class="op" id="5465848">*</span><span class="ident" id="5465849">reader</span><span class="op" id="5465855">)</span>&nbsp;<span class="ident" id="5465857">remember</span><span class="op" id="5465865">(</span><span class="ident" id="5465866">typ</span>&nbsp;<span class="op" id="5465870">*</span><span class="ident" id="5465871">ast</span><span class="op" id="5465874">.</span><span class="ident" id="5465875">InterfaceType</span><span class="op" id="5465888">)</span>&nbsp;<span class="op" id="5465890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465893">r</span><span class="op" id="5465894">.</span><span class="ident" id="5465895">fixlist</span>&nbsp;<span class="op" id="5465903">=</span>&nbsp;<span class="builtinfunc" id="5465905">append</span><span class="op" id="5465911">(</span><span class="ident" id="5465912">r</span><span class="op" id="5465913">.</span><span class="ident" id="5465914">fixlist</span><span class="op" id="5465921">,</span>&nbsp;<span class="ident" id="5465923">typ</span><span class="op" id="5465926">)</span><br>
<span class="lineno"></span><span class="op" id="5465928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5465931">func</span>&nbsp;<span class="ident" id="5465936">specNames</span><span class="op" id="5465945">(</span><span class="ident" id="5465946">specs</span>&nbsp;<span class="op" id="5465952">[</span><span class="op" id="5465953">]</span><span class="ident" id="5465954">ast</span><span class="op" id="5465957">.</span><span class="ident" id="5465958">Spec</span><span class="op" id="5465962">)</span>&nbsp;<span class="op" id="5465964">[</span><span class="op" id="5465965">]</span><span class="builtintype" id="5465966">string</span>&nbsp;<span class="op" id="5465973">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5465976">names</span>&nbsp;<span class="op" id="5465982">:=</span>&nbsp;<span class="builtinfunc" id="5465985">make</span><span class="op" id="5465989">(</span><span class="op" id="5465990">[</span><span class="op" id="5465991">]</span><span class="builtintype" id="5465992">string</span><span class="op" id="5465998">,</span>&nbsp;<span class="num" id="5466000">0</span><span class="op" id="5466001">,</span>&nbsp;<span class="builtinfunc" id="5466003">len</span><span class="op" id="5466006">(</span><span class="ident" id="5466007">specs</span><span class="op" id="5466012">)</span><span class="op" id="5466013">)</span>&nbsp;<span class="comment" id="5466015">//&nbsp;reasonable&nbsp;estimate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466039">for</span>&nbsp;<span class="ident" id="5466043">_</span><span class="op" id="5466044">,</span>&nbsp;<span class="ident" id="5466046">s</span>&nbsp;<span class="op" id="5466048">:=</span>&nbsp;<span class="keyword" id="5466051">range</span>&nbsp;<span class="ident" id="5466057">specs</span>&nbsp;<span class="op" id="5466063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466067">//&nbsp;s&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;an&nbsp;*ast.ValueSpec&nbsp;by&nbsp;readValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466122">for</span>&nbsp;<span class="ident" id="5466126">_</span><span class="op" id="5466127">,</span>&nbsp;<span class="ident" id="5466129">ident</span>&nbsp;<span class="op" id="5466135">:=</span>&nbsp;<span class="keyword" id="5466138">range</span>&nbsp;<span class="ident" id="5466144">s</span><span class="op" id="5466145">.</span><span class="op" id="5466146">(</span><span class="op" id="5466147">*</span><span class="ident" id="5466148">ast</span><span class="op" id="5466151">.</span><span class="ident" id="5466152">ValueSpec</span><span class="op" id="5466161">)</span><span class="op" id="5466162">.</span><span class="ident" id="5466163">Names</span>&nbsp;<span class="op" id="5466169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466174">names</span>&nbsp;<span class="op" id="5466180">=</span>&nbsp;<span class="builtinfunc" id="5466182">append</span><span class="op" id="5466188">(</span><span class="ident" id="5466189">names</span><span class="op" id="5466194">,</span>&nbsp;<span class="ident" id="5466196">ident</span><span class="op" id="5466201">.</span><span class="ident" id="5466202">Name</span><span class="op" id="5466206">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5466210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5466213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466216">return</span>&nbsp;<span class="ident" id="5466223">names</span><br>
<span class="lineno"></span><span class="op" id="5466229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="5466232">//&nbsp;readValue&nbsp;processes&nbsp;a&nbsp;const&nbsp;or&nbsp;var&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5466283">//</span><br>
<span class="lineno"></span><span class="keyword" id="5466286">func</span>&nbsp;<span class="op" id="5466291">(</span><span class="ident" id="5466292">r</span>&nbsp;<span class="op" id="5466294">*</span><span class="ident" id="5466295">reader</span><span class="op" id="5466301">)</span>&nbsp;<span class="ident" id="5466303">readValue</span><span class="op" id="5466312">(</span><span class="ident" id="5466313">decl</span>&nbsp;<span class="op" id="5466318">*</span><span class="ident" id="5466319">ast</span><span class="op" id="5466322">.</span><span class="ident" id="5466323">GenDecl</span><span class="op" id="5466330">)</span>&nbsp;<span class="op" id="5466332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466335">//&nbsp;determine&nbsp;if&nbsp;decl&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466390">//&nbsp;Heuristic:&nbsp;For&nbsp;each&nbsp;typed&nbsp;entry,&nbsp;determine&nbsp;the&nbsp;type&nbsp;name,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;type&nbsp;name&nbsp;that&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequent,&nbsp;associate&nbsp;the&nbsp;decl&nbsp;with&nbsp;the&nbsp;respective&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466600">domName</span>&nbsp;<span class="op" id="5466608">:=</span>&nbsp;<span class="string" id="5466611">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466615">domFreq</span>&nbsp;<span class="op" id="5466623">:=</span>&nbsp;<span class="num" id="5466626">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466629">prev</span>&nbsp;<span class="op" id="5466634">:=</span>&nbsp;<span class="string" id="5466637">&#34;&#34;</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466641">n</span>&nbsp;<span class="op" id="5466643">:=</span>&nbsp;<span class="num" id="5466646">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466649">for</span>&nbsp;<span class="ident" id="5466653">_</span><span class="op" id="5466654">,</span>&nbsp;<span class="ident" id="5466656">spec</span>&nbsp;<span class="op" id="5466661">:=</span>&nbsp;<span class="keyword" id="5466664">range</span>&nbsp;<span class="ident" id="5466670">decl</span><span class="op" id="5466674">.</span><span class="ident" id="5466675">Specs</span>&nbsp;<span class="op" id="5466681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466685">s</span><span class="op" id="5466686">,</span>&nbsp;<span class="ident" id="5466688">ok</span>&nbsp;<span class="op" id="5466691">:=</span>&nbsp;<span class="ident" id="5466694">spec</span><span class="op" id="5466698">.</span><span class="op" id="5466699">(</span><span class="op" id="5466700">*</span><span class="ident" id="5466701">ast</span><span class="op" id="5466704">.</span><span class="ident" id="5466705">ValueSpec</span><span class="op" id="5466714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466718">if</span>&nbsp;<span class="op" id="5466721">!</span><span class="ident" id="5466722">ok</span>&nbsp;<span class="op" id="5466725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466730">continue</span>&nbsp;<span class="comment" id="5466739">//&nbsp;should&nbsp;not&nbsp;happen,&nbsp;but&nbsp;be&nbsp;conservative</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5466783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466787">name</span>&nbsp;<span class="op" id="5466792">:=</span>&nbsp;<span class="string" id="5466795">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466800">switch</span>&nbsp;<span class="op" id="5466807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466811">case</span>&nbsp;<span class="ident" id="5466816">s</span><span class="op" id="5466817">.</span><span class="ident" id="5466818">Type</span>&nbsp;<span class="op" id="5466823">!=</span>&nbsp;<span class="ident" id="5466826">nil</span><span class="op" id="5466829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466834">//&nbsp;a&nbsp;type&nbsp;is&nbsp;present;&nbsp;determine&nbsp;its&nbsp;name</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466878">if</span>&nbsp;<span class="ident" id="5466881">n</span><span class="op" id="5466882">,</span>&nbsp;<span class="ident" id="5466884">imp</span>&nbsp;<span class="op" id="5466888">:=</span>&nbsp;<span class="ident" id="5466891">baseTypeName</span><span class="op" id="5466903">(</span><span class="ident" id="5466904">s</span><span class="op" id="5466905">.</span><span class="ident" id="5466906">Type</span><span class="op" id="5466910">)</span><span class="op" id="5466911">;</span>&nbsp;<span class="op" id="5466913">!</span><span class="ident" id="5466914">imp</span>&nbsp;<span class="op" id="5466918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5466924">name</span>&nbsp;<span class="op" id="5466929">=</span>&nbsp;<span class="ident" id="5466931">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5466936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5466940">case</span>&nbsp;<span class="ident" id="5466945">decl</span><span class="op" id="5466949">.</span><span class="ident" id="5466950">Tok</span>&nbsp;<span class="op" id="5466954">==</span>&nbsp;<span class="ident" id="5466957">token</span><span class="op" id="5466962">.</span><span class="ident" id="5466963">CONST</span><span class="op" id="5466968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5466973">//&nbsp;no&nbsp;type&nbsp;is&nbsp;present&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;constant&nbsp;declaration;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467034">//&nbsp;use&nbsp;the&nbsp;previous&nbsp;type&nbsp;name&nbsp;(w/o&nbsp;more&nbsp;type&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467094">//&nbsp;we&nbsp;cannot&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;unnamed&nbsp;variables&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467152">//&nbsp;initializer&nbsp;expressions&nbsp;except&nbsp;for&nbsp;some&nbsp;trivial&nbsp;cases)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467213">name</span>&nbsp;<span class="op" id="5467218">=</span>&nbsp;<span class="ident" id="5467220">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467227">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467231">if</span>&nbsp;<span class="ident" id="5467234">name</span>&nbsp;<span class="op" id="5467239">!=</span>&nbsp;<span class="string" id="5467242">&#34;&#34;</span>&nbsp;<span class="op" id="5467245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467250">//&nbsp;entry&nbsp;has&nbsp;a&nbsp;named&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467279">if</span>&nbsp;<span class="ident" id="5467282">domName</span>&nbsp;<span class="op" id="5467290">!=</span>&nbsp;<span class="string" id="5467293">&#34;&#34;</span>&nbsp;<span class="op" id="5467296">&amp;&amp;</span>&nbsp;<span class="ident" id="5467299">domName</span>&nbsp;<span class="op" id="5467307">!=</span>&nbsp;<span class="ident" id="5467310">name</span>&nbsp;<span class="op" id="5467315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467321">//&nbsp;more&nbsp;than&nbsp;one&nbsp;type&nbsp;name&nbsp;-&nbsp;do&nbsp;not&nbsp;associate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467371">//&nbsp;with&nbsp;any&nbsp;type</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467392">domName</span>&nbsp;<span class="op" id="5467400">=</span>&nbsp;<span class="string" id="5467402">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467409">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467423">domName</span>&nbsp;<span class="op" id="5467431">=</span>&nbsp;<span class="ident" id="5467433">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467441">domFreq</span><span class="op" id="5467448">++</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467457">prev</span>&nbsp;<span class="op" id="5467462">=</span>&nbsp;<span class="ident" id="5467464">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467471">n</span><span class="op" id="5467472">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467480">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;w/o&nbsp;a&nbsp;legal&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467522">if</span>&nbsp;<span class="ident" id="5467525">n</span>&nbsp;<span class="op" id="5467527">==</span>&nbsp;<span class="num" id="5467530">0</span>&nbsp;<span class="op" id="5467532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467548">//&nbsp;determine&nbsp;values&nbsp;list&nbsp;with&nbsp;which&nbsp;to&nbsp;associate&nbsp;the&nbsp;Value&nbsp;for&nbsp;this&nbsp;decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467622">values</span>&nbsp;<span class="op" id="5467629">:=</span>&nbsp;<span class="op" id="5467632">&amp;</span><span class="ident" id="5467633">r</span><span class="op" id="5467634">.</span><span class="ident" id="5467635">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467643">const</span>&nbsp;<span class="ident" id="5467649">threshold</span>&nbsp;<span class="op" id="5467659">=</span>&nbsp;<span class="num" id="5467661">0.75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467667">if</span>&nbsp;<span class="ident" id="5467670">domName</span>&nbsp;<span class="op" id="5467678">!=</span>&nbsp;<span class="string" id="5467681">&#34;&#34;</span>&nbsp;<span class="op" id="5467684">&amp;&amp;</span>&nbsp;<span class="ident" id="5467687">r</span><span class="op" id="5467688">.</span><span class="ident" id="5467689">isVisible</span><span class="op" id="5467698">(</span><span class="ident" id="5467699">domName</span><span class="op" id="5467706">)</span>&nbsp;<span class="op" id="5467708">&amp;&amp;</span>&nbsp;<span class="ident" id="5467711">domFreq</span>&nbsp;<span class="op" id="5467719">&gt;=</span>&nbsp;<span class="builtintype" id="5467722">int</span><span class="op" id="5467725">(</span><span class="builtintype" id="5467726">float64</span><span class="op" id="5467733">(</span><span class="builtinfunc" id="5467734">len</span><span class="op" id="5467737">(</span><span class="ident" id="5467738">decl</span><span class="op" id="5467742">.</span><span class="ident" id="5467743">Specs</span><span class="op" id="5467748">)</span><span class="op" id="5467749">)</span><span class="op" id="5467750">*</span><span class="ident" id="5467751">threshold</span><span class="op" id="5467760">)</span>&nbsp;<span class="op" id="5467762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5467766">//&nbsp;typed&nbsp;entries&nbsp;are&nbsp;sufficiently&nbsp;frequent</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5467811">if</span>&nbsp;<span class="ident" id="5467814">typ</span>&nbsp;<span class="op" id="5467818">:=</span>&nbsp;<span class="ident" id="5467821">r</span><span class="op" id="5467822">.</span><span class="ident" id="5467823">lookupType</span><span class="op" id="5467833">(</span><span class="ident" id="5467834">domName</span><span class="op" id="5467841">)</span><span class="op" id="5467842">;</span>&nbsp;<span class="ident" id="5467844">typ</span>&nbsp;<span class="op" id="5467848">!=</span>&nbsp;<span class="ident" id="5467851">nil</span>&nbsp;<span class="op" id="5467855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467860">values</span>&nbsp;<span class="op" id="5467867">=</span>&nbsp;<span class="op" id="5467869">&amp;</span><span class="ident" id="5467870">typ</span><span class="op" id="5467873">.</span><span class="ident" id="5467874">values</span>&nbsp;<span class="comment" id="5467881">//&nbsp;associate&nbsp;with&nbsp;that&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5467918">*</span><span class="ident" id="5467919">values</span>&nbsp;<span class="op" id="5467926">=</span>&nbsp;<span class="builtinfunc" id="5467928">append</span><span class="op" id="5467934">(</span><span class="op" id="5467935">*</span><span class="ident" id="5467936">values</span><span class="op" id="5467942">,</span>&nbsp;<span class="op" id="5467944">&amp;</span><span class="ident" id="5467945">Value</span><span class="op" id="5467950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467954">Doc</span><span class="op" id="5467957">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5467961">decl</span><span class="op" id="5467965">.</span><span class="ident" id="5467966">Doc</span><span class="op" id="5467969">.</span><span class="ident" id="5467970">Text</span><span class="op" id="5467974">(</span><span class="op" id="5467975">)</span><span class="op" id="5467976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5467980">Names</span><span class="op" id="5467985">:</span>&nbsp;<span class="ident" id="5467987">specNames</span><span class="op" id="5467996">(</span><span class="ident" id="5467997">decl</span><span class="op" id="5468001">.</span><span class="ident" id="5468002">Specs</span><span class="op" id="5468007">)</span><span class="op" id="5468008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468012">Decl</span><span class="op" id="5468016">:</span>&nbsp;&nbsp;<span class="ident" id="5468019">decl</span><span class="op" id="5468023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468027">order</span><span class="op" id="5468032">:</span>&nbsp;<span class="builtinfunc" id="5468034">len</span><span class="op" id="5468037">(</span><span class="op" id="5468038">*</span><span class="ident" id="5468039">values</span><span class="op" id="5468045">)</span><span class="op" id="5468046">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5468049">}</span><span class="op" id="5468050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468053">decl</span><span class="op" id="5468057">.</span><span class="ident" id="5468058">Doc</span>&nbsp;<span class="op" id="5468062">=</span>&nbsp;<span class="ident" id="5468064">nil</span>&nbsp;<span class="comment" id="5468068">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5468102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5468105">//&nbsp;fields&nbsp;returns&nbsp;a&nbsp;struct&#39;s&nbsp;fields&nbsp;or&nbsp;an&nbsp;interface&#39;s&nbsp;methods.</span><br>
<span class="lineno">305</span><span class="comment" id="5468168">//</span><br>
<span class="lineno"></span><span class="keyword" id="5468171">func</span>&nbsp;<span class="ident" id="5468176">fields</span><span class="op" id="5468182">(</span><span class="ident" id="5468183">typ</span>&nbsp;<span class="ident" id="5468187">ast</span><span class="op" id="5468190">.</span><span class="ident" id="5468191">Expr</span><span class="op" id="5468195">)</span>&nbsp;<span class="op" id="5468197">(</span><span class="ident" id="5468198">list</span>&nbsp;<span class="op" id="5468203">[</span><span class="op" id="5468204">]</span><span class="op" id="5468205">*</span><span class="ident" id="5468206">ast</span><span class="op" id="5468209">.</span><span class="ident" id="5468210">Field</span><span class="op" id="5468215">,</span>&nbsp;<span class="ident" id="5468217">isStruct</span>&nbsp;<span class="builtintype" id="5468226">bool</span><span class="op" id="5468230">)</span>&nbsp;<span class="op" id="5468232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468235">var</span>&nbsp;<span class="ident" id="5468239">fields</span>&nbsp;<span class="op" id="5468246">*</span><span class="ident" id="5468247">ast</span><span class="op" id="5468250">.</span><span class="ident" id="5468251">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468262">switch</span>&nbsp;<span class="ident" id="5468269">t</span>&nbsp;<span class="op" id="5468271">:=</span>&nbsp;<span class="ident" id="5468274">typ</span><span class="op" id="5468277">.</span><span class="op" id="5468278">(</span><span class="keyword" id="5468279">type</span><span class="op" id="5468283">)</span>&nbsp;<span class="op" id="5468285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468288">case</span>&nbsp;<span class="op" id="5468293">*</span><span class="ident" id="5468294">ast</span><span class="op" id="5468297">.</span><span class="ident" id="5468298">StructType</span><span class="op" id="5468308">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468312">fields</span>&nbsp;<span class="op" id="5468319">=</span>&nbsp;<span class="ident" id="5468321">t</span><span class="op" id="5468322">.</span><span class="ident" id="5468323">Fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468332">isStruct</span>&nbsp;<span class="op" id="5468341">=</span>&nbsp;<span class="builtintype" id="5468343">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468349">case</span>&nbsp;<span class="op" id="5468354">*</span><span class="ident" id="5468355">ast</span><span class="op" id="5468358">.</span><span class="ident" id="5468359">InterfaceType</span><span class="op" id="5468372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468376">fields</span>&nbsp;<span class="op" id="5468383">=</span>&nbsp;<span class="ident" id="5468385">t</span><span class="op" id="5468386">.</span><span class="ident" id="5468387">Methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5468396">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468399">if</span>&nbsp;<span class="ident" id="5468402">fields</span>&nbsp;<span class="op" id="5468409">!=</span>&nbsp;<span class="ident" id="5468412">nil</span>&nbsp;<span class="op" id="5468416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468420">list</span>&nbsp;<span class="op" id="5468425">=</span>&nbsp;<span class="ident" id="5468427">fields</span><span class="op" id="5468433">.</span><span class="ident" id="5468434">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5468440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468443">return</span><br>
<span class="lineno"></span><span class="op" id="5468450">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5468453">//&nbsp;readType&nbsp;processes&nbsp;a&nbsp;type&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5468495">//</span><br>
<span class="lineno"></span><span class="keyword" id="5468498">func</span>&nbsp;<span class="op" id="5468503">(</span><span class="ident" id="5468504">r</span>&nbsp;<span class="op" id="5468506">*</span><span class="ident" id="5468507">reader</span><span class="op" id="5468513">)</span>&nbsp;<span class="ident" id="5468515">readType</span><span class="op" id="5468523">(</span><span class="ident" id="5468524">decl</span>&nbsp;<span class="op" id="5468529">*</span><span class="ident" id="5468530">ast</span><span class="op" id="5468533">.</span><span class="ident" id="5468534">GenDecl</span><span class="op" id="5468541">,</span>&nbsp;<span class="ident" id="5468543">spec</span>&nbsp;<span class="op" id="5468548">*</span><span class="ident" id="5468549">ast</span><span class="op" id="5468552">.</span><span class="ident" id="5468553">TypeSpec</span><span class="op" id="5468561">)</span>&nbsp;<span class="op" id="5468563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468566">typ</span>&nbsp;<span class="op" id="5468570">:=</span>&nbsp;<span class="ident" id="5468573">r</span><span class="op" id="5468574">.</span><span class="ident" id="5468575">lookupType</span><span class="op" id="5468585">(</span><span class="ident" id="5468586">spec</span><span class="op" id="5468590">.</span><span class="ident" id="5468591">Name</span><span class="op" id="5468595">.</span><span class="ident" id="5468596">Name</span><span class="op" id="5468600">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468603">if</span>&nbsp;<span class="ident" id="5468606">typ</span>&nbsp;<span class="op" id="5468610">==</span>&nbsp;<span class="ident" id="5468613">nil</span>&nbsp;<span class="op" id="5468617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468621">return</span>&nbsp;<span class="comment" id="5468628">//&nbsp;no&nbsp;name&nbsp;or&nbsp;blank&nbsp;name&nbsp;-&nbsp;ignore&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5468672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5468676">//&nbsp;A&nbsp;type&nbsp;should&nbsp;be&nbsp;added&nbsp;at&nbsp;most&nbsp;once,&nbsp;so&nbsp;typ.decl</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5468729">//&nbsp;should&nbsp;be&nbsp;nil&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;not,&nbsp;simply&nbsp;overwrite&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468784">typ</span><span class="op" id="5468787">.</span><span class="ident" id="5468788">decl</span>&nbsp;<span class="op" id="5468793">=</span>&nbsp;<span class="ident" id="5468795">decl</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5468802">//&nbsp;compute&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468828">doc</span>&nbsp;<span class="op" id="5468832">:=</span>&nbsp;<span class="ident" id="5468835">spec</span><span class="op" id="5468839">.</span><span class="ident" id="5468840">Doc</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468845">spec</span><span class="op" id="5468849">.</span><span class="ident" id="5468850">Doc</span>&nbsp;<span class="op" id="5468854">=</span>&nbsp;<span class="ident" id="5468856">nil</span>&nbsp;<span class="comment" id="5468860">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5468895">if</span>&nbsp;<span class="ident" id="5468898">doc</span>&nbsp;<span class="op" id="5468902">==</span>&nbsp;<span class="ident" id="5468905">nil</span>&nbsp;<span class="op" id="5468909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5468913">//&nbsp;no&nbsp;doc&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec,&nbsp;use&nbsp;the&nbsp;declaration&nbsp;doc,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5468983">doc</span>&nbsp;<span class="op" id="5468987">=</span>&nbsp;<span class="ident" id="5468989">decl</span><span class="op" id="5468993">.</span><span class="ident" id="5468994">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5468999">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469002">decl</span><span class="op" id="5469006">.</span><span class="ident" id="5469007">Doc</span>&nbsp;<span class="op" id="5469011">=</span>&nbsp;<span class="ident" id="5469013">nil</span>&nbsp;<span class="comment" id="5469017">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469052">typ</span><span class="op" id="5469055">.</span><span class="ident" id="5469056">doc</span>&nbsp;<span class="op" id="5469060">=</span>&nbsp;<span class="ident" id="5469062">doc</span><span class="op" id="5469065">.</span><span class="ident" id="5469066">Text</span><span class="op" id="5469070">(</span><span class="op" id="5469071">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469075">//&nbsp;record&nbsp;anonymous&nbsp;fields&nbsp;(they&nbsp;may&nbsp;contribute&nbsp;methods)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469133">//&nbsp;(some&nbsp;fields&nbsp;may&nbsp;have&nbsp;been&nbsp;recorded&nbsp;already&nbsp;when&nbsp;filtering</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469196">//&nbsp;exports,&nbsp;but&nbsp;that&#39;s&nbsp;ok)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469224">var</span>&nbsp;<span class="ident" id="5469228">list</span>&nbsp;<span class="op" id="5469233">[</span><span class="op" id="5469234">]</span><span class="op" id="5469235">*</span><span class="ident" id="5469236">ast</span><span class="op" id="5469239">.</span><span class="ident" id="5469240">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469247">list</span><span class="op" id="5469251">,</span>&nbsp;<span class="ident" id="5469253">typ</span><span class="op" id="5469256">.</span><span class="ident" id="5469257">isStruct</span>&nbsp;<span class="op" id="5469266">=</span>&nbsp;<span class="ident" id="5469268">fields</span><span class="op" id="5469274">(</span><span class="ident" id="5469275">spec</span><span class="op" id="5469279">.</span><span class="ident" id="5469280">Type</span><span class="op" id="5469284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469287">for</span>&nbsp;<span class="ident" id="5469291">_</span><span class="op" id="5469292">,</span>&nbsp;<span class="ident" id="5469294">field</span>&nbsp;<span class="op" id="5469300">:=</span>&nbsp;<span class="keyword" id="5469303">range</span>&nbsp;<span class="ident" id="5469309">list</span>&nbsp;<span class="op" id="5469314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469318">if</span>&nbsp;<span class="builtinfunc" id="5469321">len</span><span class="op" id="5469324">(</span><span class="ident" id="5469325">field</span><span class="op" id="5469330">.</span><span class="ident" id="5469331">Names</span><span class="op" id="5469336">)</span>&nbsp;<span class="op" id="5469338">==</span>&nbsp;<span class="num" id="5469341">0</span>&nbsp;<span class="op" id="5469343">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469348">r</span><span class="op" id="5469349">.</span><span class="ident" id="5469350">recordAnonymousField</span><span class="op" id="5469370">(</span><span class="ident" id="5469371">typ</span><span class="op" id="5469374">,</span>&nbsp;<span class="ident" id="5469376">field</span><span class="op" id="5469381">.</span><span class="ident" id="5469382">Type</span><span class="op" id="5469386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5469390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5469393">}</span><br>
<span class="lineno"></span><span class="op" id="5469395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="5469398">//&nbsp;readFunc&nbsp;processes&nbsp;a&nbsp;func&nbsp;or&nbsp;method&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5469450">//</span><br>
<span class="lineno"></span><span class="keyword" id="5469453">func</span>&nbsp;<span class="op" id="5469458">(</span><span class="ident" id="5469459">r</span>&nbsp;<span class="op" id="5469461">*</span><span class="ident" id="5469462">reader</span><span class="op" id="5469468">)</span>&nbsp;<span class="ident" id="5469470">readFunc</span><span class="op" id="5469478">(</span><span class="ident" id="5469479">fun</span>&nbsp;<span class="op" id="5469483">*</span><span class="ident" id="5469484">ast</span><span class="op" id="5469487">.</span><span class="ident" id="5469488">FuncDecl</span><span class="op" id="5469496">)</span>&nbsp;<span class="op" id="5469498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469501">//&nbsp;strip&nbsp;function&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469525">fun</span><span class="op" id="5469528">.</span><span class="ident" id="5469529">Body</span>&nbsp;<span class="op" id="5469534">=</span>&nbsp;<span class="ident" id="5469536">nil</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469542">//&nbsp;associate&nbsp;methods&nbsp;with&nbsp;the&nbsp;receiver&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469595">if</span>&nbsp;<span class="ident" id="5469598">fun</span><span class="op" id="5469601">.</span><span class="ident" id="5469602">Recv</span>&nbsp;<span class="op" id="5469607">!=</span>&nbsp;<span class="ident" id="5469610">nil</span>&nbsp;<span class="op" id="5469614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469618">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469630">recvTypeName</span><span class="op" id="5469642">,</span>&nbsp;<span class="ident" id="5469644">imp</span>&nbsp;<span class="op" id="5469648">:=</span>&nbsp;<span class="ident" id="5469651">baseTypeName</span><span class="op" id="5469663">(</span><span class="ident" id="5469664">fun</span><span class="op" id="5469667">.</span><span class="ident" id="5469668">Recv</span><span class="op" id="5469672">.</span><span class="ident" id="5469673">List</span><span class="op" id="5469677">[</span><span class="num" id="5469678">0</span><span class="op" id="5469679">]</span><span class="op" id="5469680">.</span><span class="ident" id="5469681">Type</span><span class="op" id="5469685">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469689">if</span>&nbsp;<span class="ident" id="5469692">imp</span>&nbsp;<span class="op" id="5469696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469701">//&nbsp;should&nbsp;not&nbsp;happen&nbsp;(incorrect&nbsp;AST);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469742">//&nbsp;don&#39;t&nbsp;show&nbsp;this&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469771">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5469780">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5469784">if</span>&nbsp;<span class="ident" id="5469787">typ</span>&nbsp;<span class="op" id="5469791">:=</span>&nbsp;<span class="ident" id="5469794">r</span><span class="op" id="5469795">.</span><span class="ident" id="5469796">lookupType</span><span class="op" id="5469806">(</span><span class="ident" id="5469807">recvTypeName</span><span class="op" id="5469819">)</span><span class="op" id="5469820">;</span>&nbsp;<span class="ident" id="5469822">typ</span>&nbsp;<span class="op" id="5469826">!=</span>&nbsp;<span class="ident" id="5469829">nil</span>&nbsp;<span class="op" id="5469833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5469838">typ</span><span class="op" id="5469841">.</span><span class="ident" id="5469842">methods</span><span class="op" id="5469849">.</span><span class="ident" id="5469850">set</span><span class="op" id="5469853">(</span><span class="ident" id="5469854">fun</span><span class="op" id="5469857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5469861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469865">//&nbsp;otherwise&nbsp;ignore&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469898">//&nbsp;TODO(gri):&nbsp;There&nbsp;may&nbsp;be&nbsp;exported&nbsp;methods&nbsp;of&nbsp;non-exported&nbsp;types</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5469966">//&nbsp;that&nbsp;can&nbsp;be&nbsp;called&nbsp;because&nbsp;of&nbsp;exported&nbsp;values&nbsp;(consts,&nbsp;vars,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470035">//&nbsp;function&nbsp;results)&nbsp;of&nbsp;that&nbsp;type.&nbsp;Could&nbsp;determine&nbsp;if&nbsp;that&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470103">//&nbsp;case&nbsp;and&nbsp;then&nbsp;show&nbsp;those&nbsp;methods&nbsp;in&nbsp;an&nbsp;appropriate&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470168">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5470176">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470180">//&nbsp;associate&nbsp;factory&nbsp;functions&nbsp;with&nbsp;the&nbsp;first&nbsp;visible&nbsp;result&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470255">if</span>&nbsp;<span class="ident" id="5470258">fun</span><span class="op" id="5470261">.</span><span class="ident" id="5470262">Type</span><span class="op" id="5470266">.</span><span class="ident" id="5470267">Results</span><span class="op" id="5470274">.</span><span class="ident" id="5470275">NumFields</span><span class="op" id="5470284">(</span><span class="op" id="5470285">)</span>&nbsp;<span class="op" id="5470287">&gt;=</span>&nbsp;<span class="num" id="5470290">1</span>&nbsp;<span class="op" id="5470292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470296">res</span>&nbsp;<span class="op" id="5470300">:=</span>&nbsp;<span class="ident" id="5470303">fun</span><span class="op" id="5470306">.</span><span class="ident" id="5470307">Type</span><span class="op" id="5470311">.</span><span class="ident" id="5470312">Results</span><span class="op" id="5470319">.</span><span class="ident" id="5470320">List</span><span class="op" id="5470324">[</span><span class="num" id="5470325">0</span><span class="op" id="5470326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470330">if</span>&nbsp;<span class="builtinfunc" id="5470333">len</span><span class="op" id="5470336">(</span><span class="ident" id="5470337">res</span><span class="op" id="5470340">.</span><span class="ident" id="5470341">Names</span><span class="op" id="5470346">)</span>&nbsp;<span class="op" id="5470348">&lt;=</span>&nbsp;<span class="num" id="5470351">1</span>&nbsp;<span class="op" id="5470353">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470358">//&nbsp;exactly&nbsp;one&nbsp;(named&nbsp;or&nbsp;anonymous)&nbsp;result&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470415">//&nbsp;with&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;result&nbsp;signature&nbsp;(there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470472">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;result)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470503">if</span>&nbsp;<span class="ident" id="5470506">n</span><span class="op" id="5470507">,</span>&nbsp;<span class="ident" id="5470509">imp</span>&nbsp;<span class="op" id="5470513">:=</span>&nbsp;<span class="ident" id="5470516">baseTypeName</span><span class="op" id="5470528">(</span><span class="ident" id="5470529">res</span><span class="op" id="5470532">.</span><span class="ident" id="5470533">Type</span><span class="op" id="5470537">)</span><span class="op" id="5470538">;</span>&nbsp;<span class="op" id="5470540">!</span><span class="ident" id="5470541">imp</span>&nbsp;<span class="op" id="5470545">&amp;&amp;</span>&nbsp;<span class="ident" id="5470548">r</span><span class="op" id="5470549">.</span><span class="ident" id="5470550">isVisible</span><span class="op" id="5470559">(</span><span class="ident" id="5470560">n</span><span class="op" id="5470561">)</span>&nbsp;<span class="op" id="5470563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470569">if</span>&nbsp;<span class="ident" id="5470572">typ</span>&nbsp;<span class="op" id="5470576">:=</span>&nbsp;<span class="ident" id="5470579">r</span><span class="op" id="5470580">.</span><span class="ident" id="5470581">lookupType</span><span class="op" id="5470591">(</span><span class="ident" id="5470592">n</span><span class="op" id="5470593">)</span><span class="op" id="5470594">;</span>&nbsp;<span class="ident" id="5470596">typ</span>&nbsp;<span class="op" id="5470600">!=</span>&nbsp;<span class="ident" id="5470603">nil</span>&nbsp;<span class="op" id="5470607">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470614">//&nbsp;associate&nbsp;function&nbsp;with&nbsp;typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470650">typ</span><span class="op" id="5470653">.</span><span class="ident" id="5470654">funcs</span><span class="op" id="5470659">.</span><span class="ident" id="5470660">set</span><span class="op" id="5470663">(</span><span class="ident" id="5470664">fun</span><span class="op" id="5470667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5470674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5470685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5470690">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5470694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5470697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5470701">//&nbsp;just&nbsp;an&nbsp;ordinary&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470731">r</span><span class="op" id="5470732">.</span><span class="ident" id="5470733">funcs</span><span class="op" id="5470738">.</span><span class="ident" id="5470739">set</span><span class="op" id="5470742">(</span><span class="ident" id="5470743">fun</span><span class="op" id="5470746">)</span><br>
<span class="lineno">400</span><span class="op" id="5470748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5470751">var</span>&nbsp;<span class="op" id="5470755">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470758">noteMarker</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5470772">=</span>&nbsp;<span class="string" id="5470774">`([A-Z][A-Z]+)\(([^)]+)\):?`</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5470822">//&nbsp;MARKER(uid),&nbsp;MARKER&nbsp;at&nbsp;least&nbsp;2&nbsp;chars,&nbsp;uid&nbsp;at&nbsp;least&nbsp;1&nbsp;char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470884">noteMarkerRx</span>&nbsp;&nbsp;<span class="op" id="5470898">=</span>&nbsp;<span class="ident" id="5470900">regexp</span><span class="op" id="5470906">.</span><span class="ident" id="5470907">MustCompile</span><span class="op" id="5470918">(</span><span class="string" id="5470919">`^[&nbsp;\t]*`</span>&nbsp;<span class="op" id="5470929">+</span>&nbsp;<span class="ident" id="5470931">noteMarker</span><span class="op" id="5470941">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5470948">//&nbsp;MARKER(uid)&nbsp;at&nbsp;text&nbsp;start</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5470978">noteCommentRx</span>&nbsp;<span class="op" id="5470992">=</span>&nbsp;<span class="ident" id="5470994">regexp</span><span class="op" id="5471000">.</span><span class="ident" id="5471001">MustCompile</span><span class="op" id="5471012">(</span><span class="string" id="5471013">`^/[/*][&nbsp;\t]*`</span>&nbsp;<span class="op" id="5471028">+</span>&nbsp;<span class="ident" id="5471030">noteMarker</span><span class="op" id="5471040">)</span>&nbsp;<span class="comment" id="5471042">//&nbsp;MARKER(uid)&nbsp;at&nbsp;comment&nbsp;start</span><br>
<span class="lineno"></span><span class="op" id="5471074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5471077">//&nbsp;readNote&nbsp;collects&nbsp;a&nbsp;single&nbsp;note&nbsp;from&nbsp;a&nbsp;sequence&nbsp;of&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5471141">//</span><br>
<span class="lineno">410</span><span class="keyword" id="5471144">func</span>&nbsp;<span class="op" id="5471149">(</span><span class="ident" id="5471150">r</span>&nbsp;<span class="op" id="5471152">*</span><span class="ident" id="5471153">reader</span><span class="op" id="5471159">)</span>&nbsp;<span class="ident" id="5471161">readNote</span><span class="op" id="5471169">(</span><span class="ident" id="5471170">list</span>&nbsp;<span class="op" id="5471175">[</span><span class="op" id="5471176">]</span><span class="op" id="5471177">*</span><span class="ident" id="5471178">ast</span><span class="op" id="5471181">.</span><span class="ident" id="5471182">Comment</span><span class="op" id="5471189">)</span>&nbsp;<span class="op" id="5471191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471194">text</span>&nbsp;<span class="op" id="5471199">:=</span>&nbsp;<span class="op" id="5471202">(</span><span class="op" id="5471203">&amp;</span><span class="ident" id="5471204">ast</span><span class="op" id="5471207">.</span><span class="ident" id="5471208">CommentGroup</span><span class="op" id="5471220">{</span><span class="ident" id="5471221">List</span><span class="op" id="5471225">:</span>&nbsp;<span class="ident" id="5471227">list</span><span class="op" id="5471231">}</span><span class="op" id="5471232">)</span><span class="op" id="5471233">.</span><span class="ident" id="5471234">Text</span><span class="op" id="5471238">(</span><span class="op" id="5471239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5471242">if</span>&nbsp;<span class="ident" id="5471245">m</span>&nbsp;<span class="op" id="5471247">:=</span>&nbsp;<span class="ident" id="5471250">noteMarkerRx</span><span class="op" id="5471262">.</span><span class="ident" id="5471263">FindStringSubmatchIndex</span><span class="op" id="5471286">(</span><span class="ident" id="5471287">text</span><span class="op" id="5471291">)</span><span class="op" id="5471292">;</span>&nbsp;<span class="ident" id="5471294">m</span>&nbsp;<span class="op" id="5471296">!=</span>&nbsp;<span class="ident" id="5471299">nil</span>&nbsp;<span class="op" id="5471303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5471307">//&nbsp;The&nbsp;note&nbsp;body&nbsp;starts&nbsp;after&nbsp;the&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5471351">//&nbsp;We&nbsp;remove&nbsp;any&nbsp;formatting&nbsp;so&nbsp;that&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5471398">//&nbsp;get&nbsp;spurious&nbsp;line&nbsp;breaks/indentation&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5471445">//&nbsp;showing&nbsp;the&nbsp;TODO&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471473">body</span>&nbsp;<span class="op" id="5471478">:=</span>&nbsp;<span class="ident" id="5471481">clean</span><span class="op" id="5471486">(</span><span class="ident" id="5471487">text</span><span class="op" id="5471491">[</span><span class="ident" id="5471492">m</span><span class="op" id="5471493">[</span><span class="num" id="5471494">1</span><span class="op" id="5471495">]</span><span class="op" id="5471496">:</span><span class="op" id="5471497">]</span><span class="op" id="5471498">,</span>&nbsp;<span class="ident" id="5471500">keepNL</span><span class="op" id="5471506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5471510">if</span>&nbsp;<span class="ident" id="5471513">body</span>&nbsp;<span class="op" id="5471518">!=</span>&nbsp;<span class="string" id="5471521">&#34;&#34;</span>&nbsp;<span class="op" id="5471524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471529">marker</span>&nbsp;<span class="op" id="5471536">:=</span>&nbsp;<span class="ident" id="5471539">text</span><span class="op" id="5471543">[</span><span class="ident" id="5471544">m</span><span class="op" id="5471545">[</span><span class="num" id="5471546">2</span><span class="op" id="5471547">]</span><span class="op" id="5471548">:</span><span class="ident" id="5471549">m</span><span class="op" id="5471550">[</span><span class="num" id="5471551">3</span><span class="op" id="5471552">]</span><span class="op" id="5471553">]</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471558">r</span><span class="op" id="5471559">.</span><span class="ident" id="5471560">notes</span><span class="op" id="5471565">[</span><span class="ident" id="5471566">marker</span><span class="op" id="5471572">]</span>&nbsp;<span class="op" id="5471574">=</span>&nbsp;<span class="builtinfunc" id="5471576">append</span><span class="op" id="5471582">(</span><span class="ident" id="5471583">r</span><span class="op" id="5471584">.</span><span class="ident" id="5471585">notes</span><span class="op" id="5471590">[</span><span class="ident" id="5471591">marker</span><span class="op" id="5471597">]</span><span class="op" id="5471598">,</span>&nbsp;<span class="op" id="5471600">&amp;</span><span class="ident" id="5471601">Note</span><span class="op" id="5471605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471611">Pos</span><span class="op" id="5471614">:</span>&nbsp;&nbsp;<span class="ident" id="5471617">list</span><span class="op" id="5471621">[</span><span class="num" id="5471622">0</span><span class="op" id="5471623">]</span><span class="op" id="5471624">.</span><span class="ident" id="5471625">Pos</span><span class="op" id="5471628">(</span><span class="op" id="5471629">)</span><span class="op" id="5471630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471636">End</span><span class="op" id="5471639">:</span>&nbsp;&nbsp;<span class="ident" id="5471642">list</span><span class="op" id="5471646">[</span><span class="builtinfunc" id="5471647">len</span><span class="op" id="5471650">(</span><span class="ident" id="5471651">list</span><span class="op" id="5471655">)</span><span class="op" id="5471656">-</span><span class="num" id="5471657">1</span><span class="op" id="5471658">]</span><span class="op" id="5471659">.</span><span class="ident" id="5471660">End</span><span class="op" id="5471663">(</span><span class="op" id="5471664">)</span><span class="op" id="5471665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471671">UID</span><span class="op" id="5471674">:</span>&nbsp;&nbsp;<span class="ident" id="5471677">text</span><span class="op" id="5471681">[</span><span class="ident" id="5471682">m</span><span class="op" id="5471683">[</span><span class="num" id="5471684">4</span><span class="op" id="5471685">]</span><span class="op" id="5471686">:</span><span class="ident" id="5471687">m</span><span class="op" id="5471688">[</span><span class="num" id="5471689">5</span><span class="op" id="5471690">]</span><span class="op" id="5471691">]</span><span class="op" id="5471692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5471698">Body</span><span class="op" id="5471702">:</span>&nbsp;<span class="ident" id="5471704">body</span><span class="op" id="5471708">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5471713">}</span><span class="op" id="5471714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5471718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5471721">}</span><br>
<span class="lineno"></span><span class="op" id="5471723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5471726">//&nbsp;readNotes&nbsp;extracts&nbsp;notes&nbsp;from&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5471769">//&nbsp;A&nbsp;note&nbsp;must&nbsp;start&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;comment&nbsp;with&nbsp;&#34;MARKER(uid):&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5471840">//&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;the&nbsp;note&nbsp;body&nbsp;(e.g.,&nbsp;&#34;//&nbsp;BUG(gri):&nbsp;fix&nbsp;this&#34;).</span><br>
<span class="lineno"></span><span class="comment" id="5471909">//&nbsp;The&nbsp;note&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;comment&nbsp;group&nbsp;or&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5471977">//&nbsp;another&nbsp;note&nbsp;in&nbsp;the&nbsp;same&nbsp;comment&nbsp;group,&nbsp;whichever&nbsp;comes&nbsp;first.</span><br>
<span class="lineno">435</span><span class="comment" id="5472043">//</span><br>
<span class="lineno"></span><span class="keyword" id="5472046">func</span>&nbsp;<span class="op" id="5472051">(</span><span class="ident" id="5472052">r</span>&nbsp;<span class="op" id="5472054">*</span><span class="ident" id="5472055">reader</span><span class="op" id="5472061">)</span>&nbsp;<span class="ident" id="5472063">readNotes</span><span class="op" id="5472072">(</span><span class="ident" id="5472073">comments</span>&nbsp;<span class="op" id="5472082">[</span><span class="op" id="5472083">]</span><span class="op" id="5472084">*</span><span class="ident" id="5472085">ast</span><span class="op" id="5472088">.</span><span class="ident" id="5472089">CommentGroup</span><span class="op" id="5472101">)</span>&nbsp;<span class="op" id="5472103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472106">for</span>&nbsp;<span class="ident" id="5472110">_</span><span class="op" id="5472111">,</span>&nbsp;<span class="ident" id="5472113">group</span>&nbsp;<span class="op" id="5472119">:=</span>&nbsp;<span class="keyword" id="5472122">range</span>&nbsp;<span class="ident" id="5472128">comments</span>&nbsp;<span class="op" id="5472137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472141">i</span>&nbsp;<span class="op" id="5472143">:=</span>&nbsp;<span class="op" id="5472146">-</span><span class="num" id="5472147">1</span>&nbsp;<span class="comment" id="5472149">//&nbsp;comment&nbsp;index&nbsp;of&nbsp;most&nbsp;recent&nbsp;note&nbsp;start,&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472209">list</span>&nbsp;<span class="op" id="5472214">:=</span>&nbsp;<span class="ident" id="5472217">group</span><span class="op" id="5472222">.</span><span class="ident" id="5472223">List</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472230">for</span>&nbsp;<span class="ident" id="5472234">j</span><span class="op" id="5472235">,</span>&nbsp;<span class="ident" id="5472237">c</span>&nbsp;<span class="op" id="5472239">:=</span>&nbsp;<span class="keyword" id="5472242">range</span>&nbsp;<span class="ident" id="5472248">list</span>&nbsp;<span class="op" id="5472253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472258">if</span>&nbsp;<span class="ident" id="5472261">noteCommentRx</span><span class="op" id="5472274">.</span><span class="ident" id="5472275">MatchString</span><span class="op" id="5472286">(</span><span class="ident" id="5472287">c</span><span class="op" id="5472288">.</span><span class="ident" id="5472289">Text</span><span class="op" id="5472293">)</span>&nbsp;<span class="op" id="5472295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472301">if</span>&nbsp;<span class="ident" id="5472304">i</span>&nbsp;<span class="op" id="5472306">&gt;=</span>&nbsp;<span class="num" id="5472309">0</span>&nbsp;<span class="op" id="5472311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472318">r</span><span class="op" id="5472319">.</span><span class="ident" id="5472320">readNote</span><span class="op" id="5472328">(</span><span class="ident" id="5472329">list</span><span class="op" id="5472333">[</span><span class="ident" id="5472334">i</span><span class="op" id="5472335">:</span><span class="ident" id="5472336">j</span><span class="op" id="5472337">]</span><span class="op" id="5472338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472344">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472350">i</span>&nbsp;<span class="op" id="5472352">=</span>&nbsp;<span class="ident" id="5472354">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472367">if</span>&nbsp;<span class="ident" id="5472370">i</span>&nbsp;<span class="op" id="5472372">&gt;=</span>&nbsp;<span class="num" id="5472375">0</span>&nbsp;<span class="op" id="5472377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472382">r</span><span class="op" id="5472383">.</span><span class="ident" id="5472384">readNote</span><span class="op" id="5472392">(</span><span class="ident" id="5472393">list</span><span class="op" id="5472397">[</span><span class="ident" id="5472398">i</span><span class="op" id="5472399">:</span><span class="op" id="5472400">]</span><span class="op" id="5472401">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472408">}</span><br>
<span class="lineno"></span><span class="op" id="5472410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5472413">//&nbsp;readFile&nbsp;adds&nbsp;the&nbsp;AST&nbsp;for&nbsp;a&nbsp;source&nbsp;file&nbsp;to&nbsp;the&nbsp;reader.</span><br>
<span class="lineno">455</span><span class="comment" id="5472471">//</span><br>
<span class="lineno"></span><span class="keyword" id="5472474">func</span>&nbsp;<span class="op" id="5472479">(</span><span class="ident" id="5472480">r</span>&nbsp;<span class="op" id="5472482">*</span><span class="ident" id="5472483">reader</span><span class="op" id="5472489">)</span>&nbsp;<span class="ident" id="5472491">readFile</span><span class="op" id="5472499">(</span><span class="ident" id="5472500">src</span>&nbsp;<span class="op" id="5472504">*</span><span class="ident" id="5472505">ast</span><span class="op" id="5472508">.</span><span class="ident" id="5472509">File</span><span class="op" id="5472513">)</span>&nbsp;<span class="op" id="5472515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5472518">//&nbsp;add&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472548">if</span>&nbsp;<span class="ident" id="5472551">src</span><span class="op" id="5472554">.</span><span class="ident" id="5472555">Doc</span>&nbsp;<span class="op" id="5472559">!=</span>&nbsp;<span class="ident" id="5472562">nil</span>&nbsp;<span class="op" id="5472566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472570">r</span><span class="op" id="5472571">.</span><span class="ident" id="5472572">readDoc</span><span class="op" id="5472579">(</span><span class="ident" id="5472580">src</span><span class="op" id="5472583">.</span><span class="ident" id="5472584">Doc</span><span class="op" id="5472587">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472591">src</span><span class="op" id="5472594">.</span><span class="ident" id="5472595">Doc</span>&nbsp;<span class="op" id="5472599">=</span>&nbsp;<span class="ident" id="5472601">nil</span>&nbsp;<span class="comment" id="5472605">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5472640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5472644">//&nbsp;add&nbsp;all&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472669">for</span>&nbsp;<span class="ident" id="5472673">_</span><span class="op" id="5472674">,</span>&nbsp;<span class="ident" id="5472676">decl</span>&nbsp;<span class="op" id="5472681">:=</span>&nbsp;<span class="keyword" id="5472684">range</span>&nbsp;<span class="ident" id="5472690">src</span><span class="op" id="5472693">.</span><span class="ident" id="5472694">Decls</span>&nbsp;<span class="op" id="5472700">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472704">switch</span>&nbsp;<span class="ident" id="5472711">d</span>&nbsp;<span class="op" id="5472713">:=</span>&nbsp;<span class="ident" id="5472716">decl</span><span class="op" id="5472720">.</span><span class="op" id="5472721">(</span><span class="keyword" id="5472722">type</span><span class="op" id="5472726">)</span>&nbsp;<span class="op" id="5472728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472732">case</span>&nbsp;<span class="op" id="5472737">*</span><span class="ident" id="5472738">ast</span><span class="op" id="5472741">.</span><span class="ident" id="5472742">GenDecl</span><span class="op" id="5472749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472754">switch</span>&nbsp;<span class="ident" id="5472761">d</span><span class="op" id="5472762">.</span><span class="ident" id="5472763">Tok</span>&nbsp;<span class="op" id="5472767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472772">case</span>&nbsp;<span class="ident" id="5472777">token</span><span class="op" id="5472782">.</span><span class="ident" id="5472783">IMPORT</span><span class="op" id="5472789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5472795">//&nbsp;imports&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472835">for</span>&nbsp;<span class="ident" id="5472839">_</span><span class="op" id="5472840">,</span>&nbsp;<span class="ident" id="5472842">spec</span>&nbsp;<span class="op" id="5472847">:=</span>&nbsp;<span class="keyword" id="5472850">range</span>&nbsp;<span class="ident" id="5472856">d</span><span class="op" id="5472857">.</span><span class="ident" id="5472858">Specs</span>&nbsp;<span class="op" id="5472864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472871">if</span>&nbsp;<span class="ident" id="5472874">s</span><span class="op" id="5472875">,</span>&nbsp;<span class="ident" id="5472877">ok</span>&nbsp;<span class="op" id="5472880">:=</span>&nbsp;<span class="ident" id="5472883">spec</span><span class="op" id="5472887">.</span><span class="op" id="5472888">(</span><span class="op" id="5472889">*</span><span class="ident" id="5472890">ast</span><span class="op" id="5472893">.</span><span class="ident" id="5472894">ImportSpec</span><span class="op" id="5472904">)</span><span class="op" id="5472905">;</span>&nbsp;<span class="ident" id="5472907">ok</span>&nbsp;<span class="op" id="5472910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5472918">if</span>&nbsp;<span class="ident" id="5472921">import_</span><span class="op" id="5472928">,</span>&nbsp;<span class="ident" id="5472930">err</span>&nbsp;<span class="op" id="5472934">:=</span>&nbsp;<span class="ident" id="5472937">strconv</span><span class="op" id="5472944">.</span><span class="ident" id="5472945">Unquote</span><span class="op" id="5472952">(</span><span class="ident" id="5472953">s</span><span class="op" id="5472954">.</span><span class="ident" id="5472955">Path</span><span class="op" id="5472959">.</span><span class="ident" id="5472960">Value</span><span class="op" id="5472965">)</span><span class="op" id="5472966">;</span>&nbsp;<span class="ident" id="5472968">err</span>&nbsp;<span class="op" id="5472972">==</span>&nbsp;<span class="ident" id="5472975">nil</span>&nbsp;<span class="op" id="5472979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5472988">r</span><span class="op" id="5472989">.</span><span class="ident" id="5472990">imports</span><span class="op" id="5472997">[</span><span class="ident" id="5472998">import_</span><span class="op" id="5473005">]</span>&nbsp;<span class="op" id="5473007">=</span>&nbsp;<span class="num" id="5473009">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5473017">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5473024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5473030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473035">case</span>&nbsp;<span class="ident" id="5473040">token</span><span class="op" id="5473045">.</span><span class="ident" id="5473046">CONST</span><span class="op" id="5473051">,</span>&nbsp;<span class="ident" id="5473053">token</span><span class="op" id="5473058">.</span><span class="ident" id="5473059">VAR</span><span class="op" id="5473062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473068">//&nbsp;constants&nbsp;and&nbsp;variables&nbsp;are&nbsp;always&nbsp;handled&nbsp;as&nbsp;a&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5473129">r</span><span class="op" id="5473130">.</span><span class="ident" id="5473131">readValue</span><span class="op" id="5473140">(</span><span class="ident" id="5473141">d</span><span class="op" id="5473142">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473147">case</span>&nbsp;<span class="ident" id="5473152">token</span><span class="op" id="5473157">.</span><span class="ident" id="5473158">TYPE</span><span class="op" id="5473162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473168">//&nbsp;types&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473206">if</span>&nbsp;<span class="builtinfunc" id="5473209">len</span><span class="op" id="5473212">(</span><span class="ident" id="5473213">d</span><span class="op" id="5473214">.</span><span class="ident" id="5473215">Specs</span><span class="op" id="5473220">)</span>&nbsp;<span class="op" id="5473222">==</span>&nbsp;<span class="num" id="5473225">1</span>&nbsp;<span class="op" id="5473227">&amp;&amp;</span>&nbsp;<span class="op" id="5473230">!</span><span class="ident" id="5473231">d</span><span class="op" id="5473232">.</span><span class="ident" id="5473233">Lparen</span><span class="op" id="5473239">.</span><span class="ident" id="5473240">IsValid</span><span class="op" id="5473247">(</span><span class="op" id="5473248">)</span>&nbsp;<span class="op" id="5473250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473257">//&nbsp;common&nbsp;case:&nbsp;single&nbsp;declaration&nbsp;w/o&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473313">//&nbsp;(if&nbsp;a&nbsp;single&nbsp;declaration&nbsp;is&nbsp;parenthesized,</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473364">//&nbsp;create&nbsp;a&nbsp;new&nbsp;fake&nbsp;declaration&nbsp;below,&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473417">//&nbsp;go/doc&nbsp;type&nbsp;declarations&nbsp;always&nbsp;appear&nbsp;w/o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473468">//&nbsp;parentheses)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473489">if</span>&nbsp;<span class="ident" id="5473492">s</span><span class="op" id="5473493">,</span>&nbsp;<span class="ident" id="5473495">ok</span>&nbsp;<span class="op" id="5473498">:=</span>&nbsp;<span class="ident" id="5473501">d</span><span class="op" id="5473502">.</span><span class="ident" id="5473503">Specs</span><span class="op" id="5473508">[</span><span class="num" id="5473509">0</span><span class="op" id="5473510">]</span><span class="op" id="5473511">.</span><span class="op" id="5473512">(</span><span class="op" id="5473513">*</span><span class="ident" id="5473514">ast</span><span class="op" id="5473517">.</span><span class="ident" id="5473518">TypeSpec</span><span class="op" id="5473526">)</span><span class="op" id="5473527">;</span>&nbsp;<span class="ident" id="5473529">ok</span>&nbsp;<span class="op" id="5473532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5473540">r</span><span class="op" id="5473541">.</span><span class="ident" id="5473542">readType</span><span class="op" id="5473550">(</span><span class="ident" id="5473551">d</span><span class="op" id="5473552">,</span>&nbsp;<span class="ident" id="5473554">s</span><span class="op" id="5473555">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5473562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473569">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5473579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473585">for</span>&nbsp;<span class="ident" id="5473589">_</span><span class="op" id="5473590">,</span>&nbsp;<span class="ident" id="5473592">spec</span>&nbsp;<span class="op" id="5473597">:=</span>&nbsp;<span class="keyword" id="5473600">range</span>&nbsp;<span class="ident" id="5473606">d</span><span class="op" id="5473607">.</span><span class="ident" id="5473608">Specs</span>&nbsp;<span class="op" id="5473614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5473621">if</span>&nbsp;<span class="ident" id="5473624">s</span><span class="op" id="5473625">,</span>&nbsp;<span class="ident" id="5473627">ok</span>&nbsp;<span class="op" id="5473630">:=</span>&nbsp;<span class="ident" id="5473633">spec</span><span class="op" id="5473637">.</span><span class="op" id="5473638">(</span><span class="op" id="5473639">*</span><span class="ident" id="5473640">ast</span><span class="op" id="5473643">.</span><span class="ident" id="5473644">TypeSpec</span><span class="op" id="5473652">)</span><span class="op" id="5473653">;</span>&nbsp;<span class="ident" id="5473655">ok</span>&nbsp;<span class="op" id="5473658">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473666">//&nbsp;use&nbsp;an&nbsp;individual&nbsp;(possibly&nbsp;fake)&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473721">//&nbsp;for&nbsp;each&nbsp;type;&nbsp;this&nbsp;also&nbsp;ensures&nbsp;that&nbsp;each&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473778">//&nbsp;gets&nbsp;to&nbsp;(re-)use&nbsp;the&nbsp;declaration&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473834">//&nbsp;if&nbsp;there&#39;s&nbsp;none&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5473891">fake</span>&nbsp;<span class="op" id="5473896">:=</span>&nbsp;<span class="op" id="5473899">&amp;</span><span class="ident" id="5473900">ast</span><span class="op" id="5473903">.</span><span class="ident" id="5473904">GenDecl</span><span class="op" id="5473911">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5473920">Doc</span><span class="op" id="5473923">:</span>&nbsp;<span class="ident" id="5473925">d</span><span class="op" id="5473926">.</span><span class="ident" id="5473927">Doc</span><span class="op" id="5473930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473939">//&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;existing&nbsp;TokPos&nbsp;because&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5473990">//&nbsp;will&nbsp;lead&nbsp;to&nbsp;the&nbsp;wrong&nbsp;selection&nbsp;range&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474043">//&nbsp;the&nbsp;fake&nbsp;declaration&nbsp;if&nbsp;there&nbsp;are&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474092">//&nbsp;than&nbsp;one&nbsp;type&nbsp;in&nbsp;the&nbsp;group&nbsp;(this&nbsp;affects</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474143">//&nbsp;src/cmd/godoc/godoc.go&#39;s&nbsp;posLink_urlFunc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474195">TokPos</span><span class="op" id="5474201">:</span>&nbsp;<span class="ident" id="5474203">s</span><span class="op" id="5474204">.</span><span class="ident" id="5474205">Pos</span><span class="op" id="5474208">(</span><span class="op" id="5474209">)</span><span class="op" id="5474210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474219">Tok</span><span class="op" id="5474222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5474227">token</span><span class="op" id="5474232">.</span><span class="ident" id="5474233">TYPE</span><span class="op" id="5474237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474246">Specs</span><span class="op" id="5474251">:</span>&nbsp;&nbsp;<span class="op" id="5474254">[</span><span class="op" id="5474255">]</span><span class="ident" id="5474256">ast</span><span class="op" id="5474259">.</span><span class="ident" id="5474260">Spec</span><span class="op" id="5474264">{</span><span class="ident" id="5474265">s</span><span class="op" id="5474266">}</span><span class="op" id="5474267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474275">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474283">r</span><span class="op" id="5474284">.</span><span class="ident" id="5474285">readType</span><span class="op" id="5474293">(</span><span class="ident" id="5474294">fake</span><span class="op" id="5474298">,</span>&nbsp;<span class="ident" id="5474300">s</span><span class="op" id="5474301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5474323">case</span>&nbsp;<span class="op" id="5474328">*</span><span class="ident" id="5474329">ast</span><span class="op" id="5474332">.</span><span class="ident" id="5474333">FuncDecl</span><span class="op" id="5474341">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474346">r</span><span class="op" id="5474347">.</span><span class="ident" id="5474348">readFunc</span><span class="op" id="5474356">(</span><span class="ident" id="5474357">d</span><span class="op" id="5474358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474369">//&nbsp;collect&nbsp;MARKER(...):&nbsp;annotations</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474406">r</span><span class="op" id="5474407">.</span><span class="ident" id="5474408">readNotes</span><span class="op" id="5474417">(</span><span class="ident" id="5474418">src</span><span class="op" id="5474421">.</span><span class="ident" id="5474422">Comments</span><span class="op" id="5474430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474433">src</span><span class="op" id="5474436">.</span><span class="ident" id="5474437">Comments</span>&nbsp;<span class="op" id="5474446">=</span>&nbsp;<span class="ident" id="5474448">nil</span>&nbsp;<span class="comment" id="5474452">//&nbsp;consumed&nbsp;unassociated&nbsp;comments&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5474504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5474507">func</span>&nbsp;<span class="op" id="5474512">(</span><span class="ident" id="5474513">r</span>&nbsp;<span class="op" id="5474515">*</span><span class="ident" id="5474516">reader</span><span class="op" id="5474522">)</span>&nbsp;<span class="ident" id="5474524">readPackage</span><span class="op" id="5474535">(</span><span class="ident" id="5474536">pkg</span>&nbsp;<span class="op" id="5474540">*</span><span class="ident" id="5474541">ast</span><span class="op" id="5474544">.</span><span class="ident" id="5474545">Package</span><span class="op" id="5474552">,</span>&nbsp;<span class="ident" id="5474554">mode</span>&nbsp;<span class="ident" id="5474559">Mode</span><span class="op" id="5474563">)</span>&nbsp;<span class="op" id="5474565">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474568">//&nbsp;initialize&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474590">r</span><span class="op" id="5474591">.</span><span class="ident" id="5474592">filenames</span>&nbsp;<span class="op" id="5474602">=</span>&nbsp;<span class="builtinfunc" id="5474604">make</span><span class="op" id="5474608">(</span><span class="op" id="5474609">[</span><span class="op" id="5474610">]</span><span class="builtintype" id="5474611">string</span><span class="op" id="5474617">,</span>&nbsp;<span class="builtinfunc" id="5474619">len</span><span class="op" id="5474622">(</span><span class="ident" id="5474623">pkg</span><span class="op" id="5474626">.</span><span class="ident" id="5474627">Files</span><span class="op" id="5474632">)</span><span class="op" id="5474633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474636">r</span><span class="op" id="5474637">.</span><span class="ident" id="5474638">imports</span>&nbsp;<span class="op" id="5474646">=</span>&nbsp;<span class="builtinfunc" id="5474648">make</span><span class="op" id="5474652">(</span><span class="keyword" id="5474653">map</span><span class="op" id="5474656">[</span><span class="builtintype" id="5474657">string</span><span class="op" id="5474663">]</span><span class="builtintype" id="5474664">int</span><span class="op" id="5474667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474670">r</span><span class="op" id="5474671">.</span><span class="ident" id="5474672">mode</span>&nbsp;<span class="op" id="5474677">=</span>&nbsp;<span class="ident" id="5474679">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474685">r</span><span class="op" id="5474686">.</span><span class="ident" id="5474687">types</span>&nbsp;<span class="op" id="5474693">=</span>&nbsp;<span class="builtinfunc" id="5474695">make</span><span class="op" id="5474699">(</span><span class="keyword" id="5474700">map</span><span class="op" id="5474703">[</span><span class="builtintype" id="5474704">string</span><span class="op" id="5474710">]</span><span class="op" id="5474711">*</span><span class="ident" id="5474712">namedType</span><span class="op" id="5474721">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474724">r</span><span class="op" id="5474725">.</span><span class="ident" id="5474726">funcs</span>&nbsp;<span class="op" id="5474732">=</span>&nbsp;<span class="builtinfunc" id="5474734">make</span><span class="op" id="5474738">(</span><span class="ident" id="5474739">methodSet</span><span class="op" id="5474748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474751">r</span><span class="op" id="5474752">.</span><span class="ident" id="5474753">notes</span>&nbsp;<span class="op" id="5474759">=</span>&nbsp;<span class="builtinfunc" id="5474761">make</span><span class="op" id="5474765">(</span><span class="keyword" id="5474766">map</span><span class="op" id="5474769">[</span><span class="builtintype" id="5474770">string</span><span class="op" id="5474776">]</span><span class="op" id="5474777">[</span><span class="op" id="5474778">]</span><span class="op" id="5474779">*</span><span class="ident" id="5474780">Note</span><span class="op" id="5474784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474788">//&nbsp;sort&nbsp;package&nbsp;files&nbsp;before&nbsp;reading&nbsp;them&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5474843">//&nbsp;result&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;map&nbsp;iteration&nbsp;order</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474893">i</span>&nbsp;<span class="op" id="5474895">:=</span>&nbsp;<span class="num" id="5474898">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5474901">for</span>&nbsp;<span class="ident" id="5474905">filename</span>&nbsp;<span class="op" id="5474914">:=</span>&nbsp;<span class="keyword" id="5474917">range</span>&nbsp;<span class="ident" id="5474923">pkg</span><span class="op" id="5474926">.</span><span class="ident" id="5474927">Files</span>&nbsp;<span class="op" id="5474933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474937">r</span><span class="op" id="5474938">.</span><span class="ident" id="5474939">filenames</span><span class="op" id="5474948">[</span><span class="ident" id="5474949">i</span><span class="op" id="5474950">]</span>&nbsp;<span class="op" id="5474952">=</span>&nbsp;<span class="ident" id="5474954">filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474965">i</span><span class="op" id="5474966">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5474970">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5474973">sort</span><span class="op" id="5474977">.</span><span class="ident" id="5474978">Strings</span><span class="op" id="5474985">(</span><span class="ident" id="5474986">r</span><span class="op" id="5474987">.</span><span class="ident" id="5474988">filenames</span><span class="op" id="5474997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5475001">//&nbsp;process&nbsp;files&nbsp;in&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475035">for</span>&nbsp;<span class="ident" id="5475039">_</span><span class="op" id="5475040">,</span>&nbsp;<span class="ident" id="5475042">filename</span>&nbsp;<span class="op" id="5475051">:=</span>&nbsp;<span class="keyword" id="5475054">range</span>&nbsp;<span class="ident" id="5475060">r</span><span class="op" id="5475061">.</span><span class="ident" id="5475062">filenames</span>&nbsp;<span class="op" id="5475072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475076">f</span>&nbsp;<span class="op" id="5475078">:=</span>&nbsp;<span class="ident" id="5475081">pkg</span><span class="op" id="5475084">.</span><span class="ident" id="5475085">Files</span><span class="op" id="5475090">[</span><span class="ident" id="5475091">filename</span><span class="op" id="5475099">]</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475103">if</span>&nbsp;<span class="ident" id="5475106">mode</span><span class="op" id="5475110">&amp;</span><span class="ident" id="5475111">AllDecls</span>&nbsp;<span class="op" id="5475120">==</span>&nbsp;<span class="num" id="5475123">0</span>&nbsp;<span class="op" id="5475125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475130">r</span><span class="op" id="5475131">.</span><span class="ident" id="5475132">fileExports</span><span class="op" id="5475143">(</span><span class="ident" id="5475144">f</span><span class="op" id="5475145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5475149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475153">r</span><span class="op" id="5475154">.</span><span class="ident" id="5475155">readFile</span><span class="op" id="5475163">(</span><span class="ident" id="5475164">f</span><span class="op" id="5475165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5475168">}</span><br>
<span class="lineno">550</span><span class="op" id="5475170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5475173">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5475253">//&nbsp;Types</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="5475263">func</span>&nbsp;<span class="ident" id="5475268">customizeRecv</span><span class="op" id="5475281">(</span><span class="ident" id="5475282">f</span>&nbsp;<span class="op" id="5475284">*</span><span class="ident" id="5475285">Func</span><span class="op" id="5475289">,</span>&nbsp;<span class="ident" id="5475291">recvTypeName</span>&nbsp;<span class="builtintype" id="5475304">string</span><span class="op" id="5475310">,</span>&nbsp;<span class="ident" id="5475312">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5475326">bool</span><span class="op" id="5475330">,</span>&nbsp;<span class="ident" id="5475332">level</span>&nbsp;<span class="builtintype" id="5475338">int</span><span class="op" id="5475341">)</span>&nbsp;<span class="op" id="5475343">*</span><span class="ident" id="5475344">Func</span>&nbsp;<span class="op" id="5475349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475352">if</span>&nbsp;<span class="ident" id="5475355">f</span>&nbsp;<span class="op" id="5475357">==</span>&nbsp;<span class="ident" id="5475360">nil</span>&nbsp;<span class="op" id="5475364">||</span>&nbsp;<span class="ident" id="5475367">f</span><span class="op" id="5475368">.</span><span class="ident" id="5475369">Decl</span>&nbsp;<span class="op" id="5475374">==</span>&nbsp;<span class="ident" id="5475377">nil</span>&nbsp;<span class="op" id="5475381">||</span>&nbsp;<span class="ident" id="5475384">f</span><span class="op" id="5475385">.</span><span class="ident" id="5475386">Decl</span><span class="op" id="5475390">.</span><span class="ident" id="5475391">Recv</span>&nbsp;<span class="op" id="5475396">==</span>&nbsp;<span class="ident" id="5475399">nil</span>&nbsp;<span class="op" id="5475403">||</span>&nbsp;<span class="builtinfunc" id="5475406">len</span><span class="op" id="5475409">(</span><span class="ident" id="5475410">f</span><span class="op" id="5475411">.</span><span class="ident" id="5475412">Decl</span><span class="op" id="5475416">.</span><span class="ident" id="5475417">Recv</span><span class="op" id="5475421">.</span><span class="ident" id="5475422">List</span><span class="op" id="5475426">)</span>&nbsp;<span class="op" id="5475428">!=</span>&nbsp;<span class="num" id="5475431">1</span>&nbsp;<span class="op" id="5475433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475437">return</span>&nbsp;<span class="ident" id="5475444">f</span>&nbsp;<span class="comment" id="5475446">//&nbsp;shouldn&#39;t&nbsp;happen,&nbsp;but&nbsp;be&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5475480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5475484">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;and&nbsp;set&nbsp;new&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475534">newField</span>&nbsp;<span class="op" id="5475543">:=</span>&nbsp;<span class="op" id="5475546">*</span><span class="ident" id="5475547">f</span><span class="op" id="5475548">.</span><span class="ident" id="5475549">Decl</span><span class="op" id="5475553">.</span><span class="ident" id="5475554">Recv</span><span class="op" id="5475558">.</span><span class="ident" id="5475559">List</span><span class="op" id="5475563">[</span><span class="num" id="5475564">0</span><span class="op" id="5475565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475568">origPos</span>&nbsp;<span class="op" id="5475576">:=</span>&nbsp;<span class="ident" id="5475579">newField</span><span class="op" id="5475587">.</span><span class="ident" id="5475588">Type</span><span class="op" id="5475592">.</span><span class="ident" id="5475593">Pos</span><span class="op" id="5475596">(</span><span class="op" id="5475597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475600">_</span><span class="op" id="5475601">,</span>&nbsp;<span class="ident" id="5475603">origRecvIsPtr</span>&nbsp;<span class="op" id="5475617">:=</span>&nbsp;<span class="ident" id="5475620">newField</span><span class="op" id="5475628">.</span><span class="ident" id="5475629">Type</span><span class="op" id="5475633">.</span><span class="op" id="5475634">(</span><span class="op" id="5475635">*</span><span class="ident" id="5475636">ast</span><span class="op" id="5475639">.</span><span class="ident" id="5475640">StarExpr</span><span class="op" id="5475648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475651">newIdent</span>&nbsp;<span class="op" id="5475660">:=</span>&nbsp;<span class="op" id="5475663">&amp;</span><span class="ident" id="5475664">ast</span><span class="op" id="5475667">.</span><span class="ident" id="5475668">Ident</span><span class="op" id="5475673">{</span><span class="ident" id="5475674">NamePos</span><span class="op" id="5475681">:</span>&nbsp;<span class="ident" id="5475683">origPos</span><span class="op" id="5475690">,</span>&nbsp;<span class="ident" id="5475692">Name</span><span class="op" id="5475696">:</span>&nbsp;<span class="ident" id="5475698">recvTypeName</span><span class="op" id="5475710">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475713">var</span>&nbsp;<span class="ident" id="5475717">typ</span>&nbsp;<span class="ident" id="5475721">ast</span><span class="op" id="5475724">.</span><span class="ident" id="5475725">Expr</span>&nbsp;<span class="op" id="5475730">=</span>&nbsp;<span class="ident" id="5475732">newIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5475742">if</span>&nbsp;<span class="op" id="5475745">!</span><span class="ident" id="5475746">embeddedIsPtr</span>&nbsp;<span class="op" id="5475760">&amp;&amp;</span>&nbsp;<span class="ident" id="5475763">origRecvIsPtr</span>&nbsp;<span class="op" id="5475777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475781">newIdent</span><span class="op" id="5475789">.</span><span class="ident" id="5475790">NamePos</span><span class="op" id="5475797">++</span>&nbsp;<span class="comment" id="5475800">//&nbsp;&#39;*&#39;&nbsp;is&nbsp;one&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475826">typ</span>&nbsp;<span class="op" id="5475830">=</span>&nbsp;<span class="op" id="5475832">&amp;</span><span class="ident" id="5475833">ast</span><span class="op" id="5475836">.</span><span class="ident" id="5475837">StarExpr</span><span class="op" id="5475845">{</span><span class="ident" id="5475846">Star</span><span class="op" id="5475850">:</span>&nbsp;<span class="ident" id="5475852">origPos</span><span class="op" id="5475859">,</span>&nbsp;<span class="ident" id="5475861">X</span><span class="op" id="5475862">:</span>&nbsp;<span class="ident" id="5475864">newIdent</span><span class="op" id="5475872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5475875">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475878">newField</span><span class="op" id="5475886">.</span><span class="ident" id="5475887">Type</span>&nbsp;<span class="op" id="5475892">=</span>&nbsp;<span class="ident" id="5475894">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5475900">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;list&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475965">newFieldList</span>&nbsp;<span class="op" id="5475978">:=</span>&nbsp;<span class="op" id="5475981">*</span><span class="ident" id="5475982">f</span><span class="op" id="5475983">.</span><span class="ident" id="5475984">Decl</span><span class="op" id="5475988">.</span><span class="ident" id="5475989">Recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5475995">newFieldList</span><span class="op" id="5476007">.</span><span class="ident" id="5476008">List</span>&nbsp;<span class="op" id="5476013">=</span>&nbsp;<span class="op" id="5476015">[</span><span class="op" id="5476016">]</span><span class="op" id="5476017">*</span><span class="ident" id="5476018">ast</span><span class="op" id="5476021">.</span><span class="ident" id="5476022">Field</span><span class="op" id="5476027">{</span><span class="op" id="5476028">&amp;</span><span class="ident" id="5476029">newField</span><span class="op" id="5476037">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476041">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;declaration&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476112">newFuncDecl</span>&nbsp;<span class="op" id="5476124">:=</span>&nbsp;<span class="op" id="5476127">*</span><span class="ident" id="5476128">f</span><span class="op" id="5476129">.</span><span class="ident" id="5476130">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476136">newFuncDecl</span><span class="op" id="5476147">.</span><span class="ident" id="5476148">Recv</span>&nbsp;<span class="op" id="5476153">=</span>&nbsp;<span class="op" id="5476155">&amp;</span><span class="ident" id="5476156">newFieldList</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476171">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;documentation&nbsp;and&nbsp;set&nbsp;new&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476236">newF</span>&nbsp;<span class="op" id="5476241">:=</span>&nbsp;<span class="op" id="5476244">*</span><span class="ident" id="5476245">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476248">newF</span><span class="op" id="5476252">.</span><span class="ident" id="5476253">Decl</span>&nbsp;<span class="op" id="5476258">=</span>&nbsp;<span class="op" id="5476260">&amp;</span><span class="ident" id="5476261">newFuncDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476274">newF</span><span class="op" id="5476278">.</span><span class="ident" id="5476279">Recv</span>&nbsp;<span class="op" id="5476284">=</span>&nbsp;<span class="ident" id="5476286">recvString</span><span class="op" id="5476296">(</span><span class="ident" id="5476297">typ</span><span class="op" id="5476300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476303">//&nbsp;the&nbsp;Orig&nbsp;field&nbsp;never&nbsp;changes</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476336">newF</span><span class="op" id="5476340">.</span><span class="ident" id="5476341">Level</span>&nbsp;<span class="op" id="5476347">=</span>&nbsp;<span class="ident" id="5476349">level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5476357">return</span>&nbsp;<span class="op" id="5476364">&amp;</span><span class="ident" id="5476365">newF</span><br>
<span class="lineno"></span><span class="op" id="5476370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="5476373">//&nbsp;collectEmbeddedMethods&nbsp;collects&nbsp;the&nbsp;embedded&nbsp;methods&nbsp;of&nbsp;typ&nbsp;in&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5476445">//</span><br>
<span class="lineno"></span><span class="keyword" id="5476448">func</span>&nbsp;<span class="op" id="5476453">(</span><span class="ident" id="5476454">r</span>&nbsp;<span class="op" id="5476456">*</span><span class="ident" id="5476457">reader</span><span class="op" id="5476463">)</span>&nbsp;<span class="ident" id="5476465">collectEmbeddedMethods</span><span class="op" id="5476487">(</span><span class="ident" id="5476488">mset</span>&nbsp;<span class="ident" id="5476493">methodSet</span><span class="op" id="5476502">,</span>&nbsp;<span class="ident" id="5476504">typ</span>&nbsp;<span class="op" id="5476508">*</span><span class="ident" id="5476509">namedType</span><span class="op" id="5476518">,</span>&nbsp;<span class="ident" id="5476520">recvTypeName</span>&nbsp;<span class="builtintype" id="5476533">string</span><span class="op" id="5476539">,</span>&nbsp;<span class="ident" id="5476541">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5476555">bool</span><span class="op" id="5476559">,</span>&nbsp;<span class="ident" id="5476561">level</span>&nbsp;<span class="builtintype" id="5476567">int</span><span class="op" id="5476570">,</span>&nbsp;<span class="ident" id="5476572">visited</span>&nbsp;<span class="ident" id="5476580">embeddedSet</span><span class="op" id="5476591">)</span>&nbsp;<span class="op" id="5476593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476596">visited</span><span class="op" id="5476603">[</span><span class="ident" id="5476604">typ</span><span class="op" id="5476607">]</span>&nbsp;<span class="op" id="5476609">=</span>&nbsp;<span class="builtintype" id="5476611">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5476617">for</span>&nbsp;<span class="ident" id="5476621">embedded</span><span class="op" id="5476629">,</span>&nbsp;<span class="ident" id="5476631">isPtr</span>&nbsp;<span class="op" id="5476637">:=</span>&nbsp;<span class="keyword" id="5476640">range</span>&nbsp;<span class="ident" id="5476646">typ</span><span class="op" id="5476649">.</span><span class="ident" id="5476650">embedded</span>&nbsp;<span class="op" id="5476659">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476663">//&nbsp;Once&nbsp;an&nbsp;embedded&nbsp;type&nbsp;is&nbsp;embedded&nbsp;as&nbsp;a&nbsp;pointer&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476720">//&nbsp;all&nbsp;embedded&nbsp;types&nbsp;in&nbsp;those&nbsp;types&nbsp;are&nbsp;treated&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476776">//&nbsp;pointer&nbsp;types&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;receiver&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476832">//&nbsp;computation;&nbsp;i.e.,&nbsp;embeddedIsPtr&nbsp;is&nbsp;sticky&nbsp;for&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5476889">//&nbsp;embedding&nbsp;hierarchy.</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5476915">thisEmbeddedIsPtr</span>&nbsp;<span class="op" id="5476933">:=</span>&nbsp;<span class="ident" id="5476936">embeddedIsPtr</span>&nbsp;<span class="op" id="5476950">||</span>&nbsp;<span class="ident" id="5476953">isPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5476961">for</span>&nbsp;<span class="ident" id="5476965">_</span><span class="op" id="5476966">,</span>&nbsp;<span class="ident" id="5476968">m</span>&nbsp;<span class="op" id="5476970">:=</span>&nbsp;<span class="keyword" id="5476973">range</span>&nbsp;<span class="ident" id="5476979">embedded</span><span class="op" id="5476987">.</span><span class="ident" id="5476988">methods</span>&nbsp;<span class="op" id="5476996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477001">//&nbsp;only&nbsp;top-level&nbsp;methods&nbsp;are&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477043">if</span>&nbsp;<span class="ident" id="5477046">m</span><span class="op" id="5477047">.</span><span class="ident" id="5477048">Level</span>&nbsp;<span class="op" id="5477054">==</span>&nbsp;<span class="num" id="5477057">0</span>&nbsp;<span class="op" id="5477059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5477065">mset</span><span class="op" id="5477069">.</span><span class="ident" id="5477070">add</span><span class="op" id="5477073">(</span><span class="ident" id="5477074">customizeRecv</span><span class="op" id="5477087">(</span><span class="ident" id="5477088">m</span><span class="op" id="5477089">,</span>&nbsp;<span class="ident" id="5477091">recvTypeName</span><span class="op" id="5477103">,</span>&nbsp;<span class="ident" id="5477105">thisEmbeddedIsPtr</span><span class="op" id="5477122">,</span>&nbsp;<span class="ident" id="5477124">level</span><span class="op" id="5477129">)</span><span class="op" id="5477130">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477143">if</span>&nbsp;<span class="op" id="5477146">!</span><span class="ident" id="5477147">visited</span><span class="op" id="5477154">[</span><span class="ident" id="5477155">embedded</span><span class="op" id="5477163">]</span>&nbsp;<span class="op" id="5477165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5477170">r</span><span class="op" id="5477171">.</span><span class="ident" id="5477172">collectEmbeddedMethods</span><span class="op" id="5477194">(</span><span class="ident" id="5477195">mset</span><span class="op" id="5477199">,</span>&nbsp;<span class="ident" id="5477201">embedded</span><span class="op" id="5477209">,</span>&nbsp;<span class="ident" id="5477211">recvTypeName</span><span class="op" id="5477223">,</span>&nbsp;<span class="ident" id="5477225">thisEmbeddedIsPtr</span><span class="op" id="5477242">,</span>&nbsp;<span class="ident" id="5477244">level</span><span class="op" id="5477249">+</span><span class="num" id="5477250">1</span><span class="op" id="5477251">,</span>&nbsp;<span class="ident" id="5477253">visited</span><span class="op" id="5477260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477264">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5477270">delete</span><span class="op" id="5477276">(</span><span class="ident" id="5477277">visited</span><span class="op" id="5477284">,</span>&nbsp;<span class="ident" id="5477286">typ</span><span class="op" id="5477289">)</span><br>
<span class="lineno"></span><span class="op" id="5477291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5477294">//&nbsp;computeMethodSets&nbsp;determines&nbsp;the&nbsp;actual&nbsp;method&nbsp;sets&nbsp;for&nbsp;each&nbsp;type&nbsp;encountered.</span><br>
<span class="lineno">615</span><span class="comment" id="5477376">//</span><br>
<span class="lineno"></span><span class="keyword" id="5477379">func</span>&nbsp;<span class="op" id="5477384">(</span><span class="ident" id="5477385">r</span>&nbsp;<span class="op" id="5477387">*</span><span class="ident" id="5477388">reader</span><span class="op" id="5477394">)</span>&nbsp;<span class="ident" id="5477396">computeMethodSets</span><span class="op" id="5477413">(</span><span class="op" id="5477414">)</span>&nbsp;<span class="op" id="5477416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477419">for</span>&nbsp;<span class="ident" id="5477423">_</span><span class="op" id="5477424">,</span>&nbsp;<span class="ident" id="5477426">t</span>&nbsp;<span class="op" id="5477428">:=</span>&nbsp;<span class="keyword" id="5477431">range</span>&nbsp;<span class="ident" id="5477437">r</span><span class="op" id="5477438">.</span><span class="ident" id="5477439">types</span>&nbsp;<span class="op" id="5477445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477449">//&nbsp;collect&nbsp;embedded&nbsp;methods&nbsp;for&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477485">if</span>&nbsp;<span class="ident" id="5477488">t</span><span class="op" id="5477489">.</span><span class="ident" id="5477490">isStruct</span>&nbsp;<span class="op" id="5477499">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477504">//&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5477517">r</span><span class="op" id="5477518">.</span><span class="ident" id="5477519">collectEmbeddedMethods</span><span class="op" id="5477541">(</span><span class="ident" id="5477542">t</span><span class="op" id="5477543">.</span><span class="ident" id="5477544">methods</span><span class="op" id="5477551">,</span>&nbsp;<span class="ident" id="5477553">t</span><span class="op" id="5477554">,</span>&nbsp;<span class="ident" id="5477556">t</span><span class="op" id="5477557">.</span><span class="ident" id="5477558">name</span><span class="op" id="5477562">,</span>&nbsp;<span class="builtintype" id="5477564">false</span><span class="op" id="5477569">,</span>&nbsp;<span class="num" id="5477571">1</span><span class="op" id="5477572">,</span>&nbsp;<span class="builtinfunc" id="5477574">make</span><span class="op" id="5477578">(</span><span class="ident" id="5477579">embeddedSet</span><span class="op" id="5477590">)</span><span class="op" id="5477591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477595">}</span>&nbsp;<span class="keyword" id="5477597">else</span>&nbsp;<span class="op" id="5477602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477607">//&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477623">//&nbsp;TODO(gri)&nbsp;fix&nbsp;this</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5477654">//&nbsp;if&nbsp;error&nbsp;was&nbsp;declared&nbsp;locally,&nbsp;don&#39;t&nbsp;treat&nbsp;it&nbsp;as&nbsp;exported&nbsp;field&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477730">if</span>&nbsp;<span class="ident" id="5477733">r</span><span class="op" id="5477734">.</span><span class="ident" id="5477735">errorDecl</span>&nbsp;<span class="op" id="5477745">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5477749">for</span>&nbsp;<span class="ident" id="5477753">_</span><span class="op" id="5477754">,</span>&nbsp;<span class="ident" id="5477756">ityp</span>&nbsp;<span class="op" id="5477761">:=</span>&nbsp;<span class="keyword" id="5477764">range</span>&nbsp;<span class="ident" id="5477770">r</span><span class="op" id="5477771">.</span><span class="ident" id="5477772">fixlist</span>&nbsp;<span class="op" id="5477780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5477785">removeErrorField</span><span class="op" id="5477801">(</span><span class="ident" id="5477802">ityp</span><span class="op" id="5477806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5477813">}</span><br>
<span class="lineno"></span><span class="op" id="5477815">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="5477818">//&nbsp;cleanupTypes&nbsp;removes&nbsp;the&nbsp;association&nbsp;of&nbsp;functions&nbsp;and&nbsp;methods&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5477888">//&nbsp;types&nbsp;that&nbsp;have&nbsp;no&nbsp;declaration.&nbsp;Instead,&nbsp;these&nbsp;functions&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="5477960">//&nbsp;are&nbsp;shown&nbsp;at&nbsp;the&nbsp;package&nbsp;level.&nbsp;It&nbsp;also&nbsp;removes&nbsp;types&nbsp;with&nbsp;missing</span><br>
<span class="lineno"></span><span class="comment" id="5478030">//&nbsp;declarations&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible.</span><br>
<span class="lineno">640</span><span class="comment" id="5478072">//</span><br>
<span class="lineno"></span><span class="keyword" id="5478075">func</span>&nbsp;<span class="op" id="5478080">(</span><span class="ident" id="5478081">r</span>&nbsp;<span class="op" id="5478083">*</span><span class="ident" id="5478084">reader</span><span class="op" id="5478090">)</span>&nbsp;<span class="ident" id="5478092">cleanupTypes</span><span class="op" id="5478104">(</span><span class="op" id="5478105">)</span>&nbsp;<span class="op" id="5478107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5478110">for</span>&nbsp;<span class="ident" id="5478114">_</span><span class="op" id="5478115">,</span>&nbsp;<span class="ident" id="5478117">t</span>&nbsp;<span class="op" id="5478119">:=</span>&nbsp;<span class="keyword" id="5478122">range</span>&nbsp;<span class="ident" id="5478128">r</span><span class="op" id="5478129">.</span><span class="ident" id="5478130">types</span>&nbsp;<span class="op" id="5478136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5478140">visible</span>&nbsp;<span class="op" id="5478148">:=</span>&nbsp;<span class="ident" id="5478151">r</span><span class="op" id="5478152">.</span><span class="ident" id="5478153">isVisible</span><span class="op" id="5478162">(</span><span class="ident" id="5478163">t</span><span class="op" id="5478164">.</span><span class="ident" id="5478165">name</span><span class="op" id="5478169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5478173">if</span>&nbsp;<span class="ident" id="5478176">t</span><span class="op" id="5478177">.</span><span class="ident" id="5478178">decl</span>&nbsp;<span class="op" id="5478183">==</span>&nbsp;<span class="ident" id="5478186">nil</span>&nbsp;<span class="op" id="5478190">&amp;&amp;</span>&nbsp;<span class="op" id="5478193">(</span><span class="ident" id="5478194">predeclaredTypes</span><span class="op" id="5478210">[</span><span class="ident" id="5478211">t</span><span class="op" id="5478212">.</span><span class="ident" id="5478213">name</span><span class="op" id="5478217">]</span>&nbsp;<span class="op" id="5478219">||</span>&nbsp;<span class="ident" id="5478222">t</span><span class="op" id="5478223">.</span><span class="ident" id="5478224">isEmbedded</span>&nbsp;<span class="op" id="5478235">&amp;&amp;</span>&nbsp;<span class="ident" id="5478238">visible</span><span class="op" id="5478245">)</span>&nbsp;<span class="op" id="5478247">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478252">//&nbsp;t.name&nbsp;is&nbsp;a&nbsp;predeclared&nbsp;type&nbsp;(and&nbsp;was&nbsp;not&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;package),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478329">//&nbsp;or&nbsp;it&nbsp;was&nbsp;embedded&nbsp;somewhere&nbsp;but&nbsp;its&nbsp;declaration&nbsp;is&nbsp;missing&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478404">//&nbsp;the&nbsp;AST&nbsp;is&nbsp;incomplete):&nbsp;move&nbsp;any&nbsp;associated&nbsp;values,&nbsp;funcs,&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478481">//&nbsp;back&nbsp;to&nbsp;the&nbsp;top-level&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;lost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478536">//&nbsp;1)&nbsp;move&nbsp;values</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5478557">r</span><span class="op" id="5478558">.</span><span class="ident" id="5478559">values</span>&nbsp;<span class="op" id="5478566">=</span>&nbsp;<span class="builtinfunc" id="5478568">append</span><span class="op" id="5478574">(</span><span class="ident" id="5478575">r</span><span class="op" id="5478576">.</span><span class="ident" id="5478577">values</span><span class="op" id="5478583">,</span>&nbsp;<span class="ident" id="5478585">t</span><span class="op" id="5478586">.</span><span class="ident" id="5478587">values</span><span class="op" id="5478593">...</span><span class="op" id="5478596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478601">//&nbsp;2)&nbsp;move&nbsp;factory&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5478633">for</span>&nbsp;<span class="ident" id="5478637">name</span><span class="op" id="5478641">,</span>&nbsp;<span class="ident" id="5478643">f</span>&nbsp;<span class="op" id="5478645">:=</span>&nbsp;<span class="keyword" id="5478648">range</span>&nbsp;<span class="ident" id="5478654">t</span><span class="op" id="5478655">.</span><span class="ident" id="5478656">funcs</span>&nbsp;<span class="op" id="5478662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478668">//&nbsp;in&nbsp;a&nbsp;correct&nbsp;AST,&nbsp;package-level&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478722">//&nbsp;are&nbsp;all&nbsp;different&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;conflicts</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5478780">r</span><span class="op" id="5478781">.</span><span class="ident" id="5478782">funcs</span><span class="op" id="5478787">[</span><span class="ident" id="5478788">name</span><span class="op" id="5478792">]</span>&nbsp;<span class="op" id="5478794">=</span>&nbsp;<span class="ident" id="5478796">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5478801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478806">//&nbsp;3)&nbsp;move&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5478828">for</span>&nbsp;<span class="ident" id="5478832">name</span><span class="op" id="5478836">,</span>&nbsp;<span class="ident" id="5478838">m</span>&nbsp;<span class="op" id="5478840">:=</span>&nbsp;<span class="keyword" id="5478843">range</span>&nbsp;<span class="ident" id="5478849">t</span><span class="op" id="5478850">.</span><span class="ident" id="5478851">methods</span>&nbsp;<span class="op" id="5478859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5478865">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;functions&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;-&nbsp;drop&nbsp;them</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5478929">if</span>&nbsp;<span class="ident" id="5478932">_</span><span class="op" id="5478933">,</span>&nbsp;<span class="ident" id="5478935">found</span>&nbsp;<span class="op" id="5478941">:=</span>&nbsp;<span class="ident" id="5478944">r</span><span class="op" id="5478945">.</span><span class="ident" id="5478946">funcs</span><span class="op" id="5478951">[</span><span class="ident" id="5478952">name</span><span class="op" id="5478956">]</span><span class="op" id="5478957">;</span>&nbsp;<span class="op" id="5478959">!</span><span class="ident" id="5478960">found</span>&nbsp;<span class="op" id="5478966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5478973">r</span><span class="op" id="5478974">.</span><span class="ident" id="5478975">funcs</span><span class="op" id="5478980">[</span><span class="ident" id="5478981">name</span><span class="op" id="5478985">]</span>&nbsp;<span class="op" id="5478987">=</span>&nbsp;<span class="ident" id="5478989">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5478995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479004">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5479008">//&nbsp;remove&nbsp;types&nbsp;w/o&nbsp;declaration&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479067">if</span>&nbsp;<span class="ident" id="5479070">t</span><span class="op" id="5479071">.</span><span class="ident" id="5479072">decl</span>&nbsp;<span class="op" id="5479077">==</span>&nbsp;<span class="ident" id="5479080">nil</span>&nbsp;<span class="op" id="5479084">||</span>&nbsp;<span class="op" id="5479087">!</span><span class="ident" id="5479088">visible</span>&nbsp;<span class="op" id="5479096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5479101">delete</span><span class="op" id="5479107">(</span><span class="ident" id="5479108">r</span><span class="op" id="5479109">.</span><span class="ident" id="5479110">types</span><span class="op" id="5479115">,</span>&nbsp;<span class="ident" id="5479117">t</span><span class="op" id="5479118">.</span><span class="ident" id="5479119">name</span><span class="op" id="5479123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479130">}</span><br>
<span class="lineno">670</span><span class="op" id="5479132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5479135">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5479215">//&nbsp;Sorting</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5479227">type</span>&nbsp;<span class="ident" id="5479232">data</span>&nbsp;<span class="keyword" id="5479237">struct</span>&nbsp;<span class="op" id="5479244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479247">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5479252">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479257">swap</span>&nbsp;<span class="keyword" id="5479262">func</span><span class="op" id="5479266">(</span><span class="ident" id="5479267">i</span><span class="op" id="5479268">,</span>&nbsp;<span class="ident" id="5479270">j</span>&nbsp;<span class="builtintype" id="5479272">int</span><span class="op" id="5479275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479278">less</span>&nbsp;<span class="keyword" id="5479283">func</span><span class="op" id="5479287">(</span><span class="ident" id="5479288">i</span><span class="op" id="5479289">,</span>&nbsp;<span class="ident" id="5479291">j</span>&nbsp;<span class="builtintype" id="5479293">int</span><span class="op" id="5479296">)</span>&nbsp;<span class="builtintype" id="5479298">bool</span><br>
<span class="lineno"></span><span class="op" id="5479303">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="5479306">func</span>&nbsp;<span class="op" id="5479311">(</span><span class="ident" id="5479312">d</span>&nbsp;<span class="op" id="5479314">*</span><span class="ident" id="5479315">data</span><span class="op" id="5479319">)</span>&nbsp;<span class="ident" id="5479321">Len</span><span class="op" id="5479324">(</span><span class="op" id="5479325">)</span>&nbsp;<span class="builtintype" id="5479327">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5479341">{</span>&nbsp;<span class="keyword" id="5479343">return</span>&nbsp;<span class="ident" id="5479350">d</span><span class="op" id="5479351">.</span><span class="ident" id="5479352">n</span>&nbsp;<span class="op" id="5479354">}</span><br>
<span class="lineno"></span><span class="keyword" id="5479356">func</span>&nbsp;<span class="op" id="5479361">(</span><span class="ident" id="5479362">d</span>&nbsp;<span class="op" id="5479364">*</span><span class="ident" id="5479365">data</span><span class="op" id="5479369">)</span>&nbsp;<span class="ident" id="5479371">Swap</span><span class="op" id="5479375">(</span><span class="ident" id="5479376">i</span><span class="op" id="5479377">,</span>&nbsp;<span class="ident" id="5479379">j</span>&nbsp;<span class="builtintype" id="5479381">int</span><span class="op" id="5479384">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5479391">{</span>&nbsp;<span class="ident" id="5479393">d</span><span class="op" id="5479394">.</span><span class="ident" id="5479395">swap</span><span class="op" id="5479399">(</span><span class="ident" id="5479400">i</span><span class="op" id="5479401">,</span>&nbsp;<span class="ident" id="5479403">j</span><span class="op" id="5479404">)</span>&nbsp;<span class="op" id="5479406">}</span><br>
<span class="lineno"></span><span class="keyword" id="5479408">func</span>&nbsp;<span class="op" id="5479413">(</span><span class="ident" id="5479414">d</span>&nbsp;<span class="op" id="5479416">*</span><span class="ident" id="5479417">data</span><span class="op" id="5479421">)</span>&nbsp;<span class="ident" id="5479423">Less</span><span class="op" id="5479427">(</span><span class="ident" id="5479428">i</span><span class="op" id="5479429">,</span>&nbsp;<span class="ident" id="5479431">j</span>&nbsp;<span class="builtintype" id="5479433">int</span><span class="op" id="5479436">)</span>&nbsp;<span class="builtintype" id="5479438">bool</span>&nbsp;<span class="op" id="5479443">{</span>&nbsp;<span class="keyword" id="5479445">return</span>&nbsp;<span class="ident" id="5479452">d</span><span class="op" id="5479453">.</span><span class="ident" id="5479454">less</span><span class="op" id="5479458">(</span><span class="ident" id="5479459">i</span><span class="op" id="5479460">,</span>&nbsp;<span class="ident" id="5479462">j</span><span class="op" id="5479463">)</span>&nbsp;<span class="op" id="5479465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="comment" id="5479468">//&nbsp;sortBy&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;sorting</span><br>
<span class="lineno"></span><span class="keyword" id="5479511">func</span>&nbsp;<span class="ident" id="5479516">sortBy</span><span class="op" id="5479522">(</span><span class="ident" id="5479523">less</span>&nbsp;<span class="keyword" id="5479528">func</span><span class="op" id="5479532">(</span><span class="ident" id="5479533">i</span><span class="op" id="5479534">,</span>&nbsp;<span class="ident" id="5479536">j</span>&nbsp;<span class="builtintype" id="5479538">int</span><span class="op" id="5479541">)</span>&nbsp;<span class="builtintype" id="5479543">bool</span><span class="op" id="5479547">,</span>&nbsp;<span class="ident" id="5479549">swap</span>&nbsp;<span class="keyword" id="5479554">func</span><span class="op" id="5479558">(</span><span class="ident" id="5479559">i</span><span class="op" id="5479560">,</span>&nbsp;<span class="ident" id="5479562">j</span>&nbsp;<span class="builtintype" id="5479564">int</span><span class="op" id="5479567">)</span><span class="op" id="5479568">,</span>&nbsp;<span class="ident" id="5479570">n</span>&nbsp;<span class="builtintype" id="5479572">int</span><span class="op" id="5479575">)</span>&nbsp;<span class="op" id="5479577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479580">sort</span><span class="op" id="5479584">.</span><span class="ident" id="5479585">Sort</span><span class="op" id="5479589">(</span><span class="op" id="5479590">&amp;</span><span class="ident" id="5479591">data</span><span class="op" id="5479595">{</span><span class="ident" id="5479596">n</span><span class="op" id="5479597">,</span>&nbsp;<span class="ident" id="5479599">swap</span><span class="op" id="5479603">,</span>&nbsp;<span class="ident" id="5479605">less</span><span class="op" id="5479609">}</span><span class="op" id="5479610">)</span><br>
<span class="lineno"></span><span class="op" id="5479612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="5479615">func</span>&nbsp;<span class="ident" id="5479620">sortedKeys</span><span class="op" id="5479630">(</span><span class="ident" id="5479631">m</span>&nbsp;<span class="keyword" id="5479633">map</span><span class="op" id="5479636">[</span><span class="builtintype" id="5479637">string</span><span class="op" id="5479643">]</span><span class="builtintype" id="5479644">int</span><span class="op" id="5479647">)</span>&nbsp;<span class="op" id="5479649">[</span><span class="op" id="5479650">]</span><span class="builtintype" id="5479651">string</span>&nbsp;<span class="op" id="5479658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479661">list</span>&nbsp;<span class="op" id="5479666">:=</span>&nbsp;<span class="builtinfunc" id="5479669">make</span><span class="op" id="5479673">(</span><span class="op" id="5479674">[</span><span class="op" id="5479675">]</span><span class="builtintype" id="5479676">string</span><span class="op" id="5479682">,</span>&nbsp;<span class="builtinfunc" id="5479684">len</span><span class="op" id="5479687">(</span><span class="ident" id="5479688">m</span><span class="op" id="5479689">)</span><span class="op" id="5479690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479693">i</span>&nbsp;<span class="op" id="5479695">:=</span>&nbsp;<span class="num" id="5479698">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479701">for</span>&nbsp;<span class="ident" id="5479705">key</span>&nbsp;<span class="op" id="5479709">:=</span>&nbsp;<span class="keyword" id="5479712">range</span>&nbsp;<span class="ident" id="5479718">m</span>&nbsp;<span class="op" id="5479720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479724">list</span><span class="op" id="5479728">[</span><span class="ident" id="5479729">i</span><span class="op" id="5479730">]</span>&nbsp;<span class="op" id="5479732">=</span>&nbsp;<span class="ident" id="5479734">key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479740">i</span><span class="op" id="5479741">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5479748">sort</span><span class="op" id="5479752">.</span><span class="ident" id="5479753">Strings</span><span class="op" id="5479760">(</span><span class="ident" id="5479761">list</span><span class="op" id="5479765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479768">return</span>&nbsp;<span class="ident" id="5479775">list</span><br>
<span class="lineno"></span><span class="op" id="5479780">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="comment" id="5479783">//&nbsp;sortingName&nbsp;returns&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;when&nbsp;sorting&nbsp;d&nbsp;into&nbsp;place.</span><br>
<span class="lineno"></span><span class="comment" id="5479849">//</span><br>
<span class="lineno"></span><span class="keyword" id="5479852">func</span>&nbsp;<span class="ident" id="5479857">sortingName</span><span class="op" id="5479868">(</span><span class="ident" id="5479869">d</span>&nbsp;<span class="op" id="5479871">*</span><span class="ident" id="5479872">ast</span><span class="op" id="5479875">.</span><span class="ident" id="5479876">GenDecl</span><span class="op" id="5479883">)</span>&nbsp;<span class="builtintype" id="5479885">string</span>&nbsp;<span class="op" id="5479892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479895">if</span>&nbsp;<span class="builtinfunc" id="5479898">len</span><span class="op" id="5479901">(</span><span class="ident" id="5479902">d</span><span class="op" id="5479903">.</span><span class="ident" id="5479904">Specs</span><span class="op" id="5479909">)</span>&nbsp;<span class="op" id="5479911">==</span>&nbsp;<span class="num" id="5479914">1</span>&nbsp;<span class="op" id="5479916">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479920">if</span>&nbsp;<span class="ident" id="5479923">s</span><span class="op" id="5479924">,</span>&nbsp;<span class="ident" id="5479926">ok</span>&nbsp;<span class="op" id="5479929">:=</span>&nbsp;<span class="ident" id="5479932">d</span><span class="op" id="5479933">.</span><span class="ident" id="5479934">Specs</span><span class="op" id="5479939">[</span><span class="num" id="5479940">0</span><span class="op" id="5479941">]</span><span class="op" id="5479942">.</span><span class="op" id="5479943">(</span><span class="op" id="5479944">*</span><span class="ident" id="5479945">ast</span><span class="op" id="5479948">.</span><span class="ident" id="5479949">ValueSpec</span><span class="op" id="5479958">)</span><span class="op" id="5479959">;</span>&nbsp;<span class="ident" id="5479961">ok</span>&nbsp;<span class="op" id="5479964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5479969">return</span>&nbsp;<span class="ident" id="5479976">s</span><span class="op" id="5479977">.</span><span class="ident" id="5479978">Names</span><span class="op" id="5479983">[</span><span class="num" id="5479984">0</span><span class="op" id="5479985">]</span><span class="op" id="5479986">.</span><span class="ident" id="5479987">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5479997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480000">return</span>&nbsp;<span class="string" id="5480007">&#34;&#34;</span><br>
<span class="lineno">710</span><span class="op" id="5480010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5480013">func</span>&nbsp;<span class="ident" id="5480018">sortedValues</span><span class="op" id="5480030">(</span><span class="ident" id="5480031">m</span>&nbsp;<span class="op" id="5480033">[</span><span class="op" id="5480034">]</span><span class="op" id="5480035">*</span><span class="ident" id="5480036">Value</span><span class="op" id="5480041">,</span>&nbsp;<span class="ident" id="5480043">tok</span>&nbsp;<span class="ident" id="5480047">token</span><span class="op" id="5480052">.</span><span class="ident" id="5480053">Token</span><span class="op" id="5480058">)</span>&nbsp;<span class="op" id="5480060">[</span><span class="op" id="5480061">]</span><span class="op" id="5480062">*</span><span class="ident" id="5480063">Value</span>&nbsp;<span class="op" id="5480069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480072">list</span>&nbsp;<span class="op" id="5480077">:=</span>&nbsp;<span class="builtinfunc" id="5480080">make</span><span class="op" id="5480084">(</span><span class="op" id="5480085">[</span><span class="op" id="5480086">]</span><span class="op" id="5480087">*</span><span class="ident" id="5480088">Value</span><span class="op" id="5480093">,</span>&nbsp;<span class="builtinfunc" id="5480095">len</span><span class="op" id="5480098">(</span><span class="ident" id="5480099">m</span><span class="op" id="5480100">)</span><span class="op" id="5480101">)</span>&nbsp;<span class="comment" id="5480103">//&nbsp;big&nbsp;enough&nbsp;in&nbsp;any&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480130">i</span>&nbsp;<span class="op" id="5480132">:=</span>&nbsp;<span class="num" id="5480135">0</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480138">for</span>&nbsp;<span class="ident" id="5480142">_</span><span class="op" id="5480143">,</span>&nbsp;<span class="ident" id="5480145">val</span>&nbsp;<span class="op" id="5480149">:=</span>&nbsp;<span class="keyword" id="5480152">range</span>&nbsp;<span class="ident" id="5480158">m</span>&nbsp;<span class="op" id="5480160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480164">if</span>&nbsp;<span class="ident" id="5480167">val</span><span class="op" id="5480170">.</span><span class="ident" id="5480171">Decl</span><span class="op" id="5480175">.</span><span class="ident" id="5480176">Tok</span>&nbsp;<span class="op" id="5480180">==</span>&nbsp;<span class="ident" id="5480183">tok</span>&nbsp;<span class="op" id="5480187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480192">list</span><span class="op" id="5480196">[</span><span class="ident" id="5480197">i</span><span class="op" id="5480198">]</span>&nbsp;<span class="op" id="5480200">=</span>&nbsp;<span class="ident" id="5480202">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480209">i</span><span class="op" id="5480210">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480215">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480221">list</span>&nbsp;<span class="op" id="5480226">=</span>&nbsp;<span class="ident" id="5480228">list</span><span class="op" id="5480232">[</span><span class="num" id="5480233">0</span><span class="op" id="5480234">:</span><span class="ident" id="5480235">i</span><span class="op" id="5480236">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480240">sortBy</span><span class="op" id="5480246">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480250">func</span><span class="op" id="5480254">(</span><span class="ident" id="5480255">i</span><span class="op" id="5480256">,</span>&nbsp;<span class="ident" id="5480258">j</span>&nbsp;<span class="builtintype" id="5480260">int</span><span class="op" id="5480263">)</span>&nbsp;<span class="builtintype" id="5480265">bool</span>&nbsp;<span class="op" id="5480270">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480275">if</span>&nbsp;<span class="ident" id="5480278">ni</span><span class="op" id="5480280">,</span>&nbsp;<span class="ident" id="5480282">nj</span>&nbsp;<span class="op" id="5480285">:=</span>&nbsp;<span class="ident" id="5480288">sortingName</span><span class="op" id="5480299">(</span><span class="ident" id="5480300">list</span><span class="op" id="5480304">[</span><span class="ident" id="5480305">i</span><span class="op" id="5480306">]</span><span class="op" id="5480307">.</span><span class="ident" id="5480308">Decl</span><span class="op" id="5480312">)</span><span class="op" id="5480313">,</span>&nbsp;<span class="ident" id="5480315">sortingName</span><span class="op" id="5480326">(</span><span class="ident" id="5480327">list</span><span class="op" id="5480331">[</span><span class="ident" id="5480332">j</span><span class="op" id="5480333">]</span><span class="op" id="5480334">.</span><span class="ident" id="5480335">Decl</span><span class="op" id="5480339">)</span><span class="op" id="5480340">;</span>&nbsp;<span class="ident" id="5480342">ni</span>&nbsp;<span class="op" id="5480345">!=</span>&nbsp;<span class="ident" id="5480348">nj</span>&nbsp;<span class="op" id="5480351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480357">return</span>&nbsp;<span class="ident" id="5480364">ni</span>&nbsp;<span class="op" id="5480367">&lt;</span>&nbsp;<span class="ident" id="5480369">nj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480380">return</span>&nbsp;<span class="ident" id="5480387">list</span><span class="op" id="5480391">[</span><span class="ident" id="5480392">i</span><span class="op" id="5480393">]</span><span class="op" id="5480394">.</span><span class="ident" id="5480395">order</span>&nbsp;<span class="op" id="5480401">&lt;</span>&nbsp;<span class="ident" id="5480403">list</span><span class="op" id="5480407">[</span><span class="ident" id="5480408">j</span><span class="op" id="5480409">]</span><span class="op" id="5480410">.</span><span class="ident" id="5480411">order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480419">}</span><span class="op" id="5480420">,</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480424">func</span><span class="op" id="5480428">(</span><span class="ident" id="5480429">i</span><span class="op" id="5480430">,</span>&nbsp;<span class="ident" id="5480432">j</span>&nbsp;<span class="builtintype" id="5480434">int</span><span class="op" id="5480437">)</span>&nbsp;<span class="op" id="5480439">{</span>&nbsp;<span class="ident" id="5480441">list</span><span class="op" id="5480445">[</span><span class="ident" id="5480446">i</span><span class="op" id="5480447">]</span><span class="op" id="5480448">,</span>&nbsp;<span class="ident" id="5480450">list</span><span class="op" id="5480454">[</span><span class="ident" id="5480455">j</span><span class="op" id="5480456">]</span>&nbsp;<span class="op" id="5480458">=</span>&nbsp;<span class="ident" id="5480460">list</span><span class="op" id="5480464">[</span><span class="ident" id="5480465">j</span><span class="op" id="5480466">]</span><span class="op" id="5480467">,</span>&nbsp;<span class="ident" id="5480469">list</span><span class="op" id="5480473">[</span><span class="ident" id="5480474">i</span><span class="op" id="5480475">]</span>&nbsp;<span class="op" id="5480477">}</span><span class="op" id="5480478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5480482">len</span><span class="op" id="5480485">(</span><span class="ident" id="5480486">list</span><span class="op" id="5480490">)</span><span class="op" id="5480491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480498">return</span>&nbsp;<span class="ident" id="5480505">list</span><br>
<span class="lineno">735</span><span class="op" id="5480510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5480513">func</span>&nbsp;<span class="ident" id="5480518">sortedTypes</span><span class="op" id="5480529">(</span><span class="ident" id="5480530">m</span>&nbsp;<span class="keyword" id="5480532">map</span><span class="op" id="5480535">[</span><span class="builtintype" id="5480536">string</span><span class="op" id="5480542">]</span><span class="op" id="5480543">*</span><span class="ident" id="5480544">namedType</span><span class="op" id="5480553">,</span>&nbsp;<span class="ident" id="5480555">allMethods</span>&nbsp;<span class="builtintype" id="5480566">bool</span><span class="op" id="5480570">)</span>&nbsp;<span class="op" id="5480572">[</span><span class="op" id="5480573">]</span><span class="op" id="5480574">*</span><span class="ident" id="5480575">Type</span>&nbsp;<span class="op" id="5480580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480583">list</span>&nbsp;<span class="op" id="5480588">:=</span>&nbsp;<span class="builtinfunc" id="5480591">make</span><span class="op" id="5480595">(</span><span class="op" id="5480596">[</span><span class="op" id="5480597">]</span><span class="op" id="5480598">*</span><span class="ident" id="5480599">Type</span><span class="op" id="5480603">,</span>&nbsp;<span class="builtinfunc" id="5480605">len</span><span class="op" id="5480608">(</span><span class="ident" id="5480609">m</span><span class="op" id="5480610">)</span><span class="op" id="5480611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480614">i</span>&nbsp;<span class="op" id="5480616">:=</span>&nbsp;<span class="num" id="5480619">0</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480622">for</span>&nbsp;<span class="ident" id="5480626">_</span><span class="op" id="5480627">,</span>&nbsp;<span class="ident" id="5480629">t</span>&nbsp;<span class="op" id="5480631">:=</span>&nbsp;<span class="keyword" id="5480634">range</span>&nbsp;<span class="ident" id="5480640">m</span>&nbsp;<span class="op" id="5480642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480646">list</span><span class="op" id="5480650">[</span><span class="ident" id="5480651">i</span><span class="op" id="5480652">]</span>&nbsp;<span class="op" id="5480654">=</span>&nbsp;<span class="op" id="5480656">&amp;</span><span class="ident" id="5480657">Type</span><span class="op" id="5480661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480666">Doc</span><span class="op" id="5480669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5480675">t</span><span class="op" id="5480676">.</span><span class="ident" id="5480677">doc</span><span class="op" id="5480680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480685">Name</span><span class="op" id="5480689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5480694">t</span><span class="op" id="5480695">.</span><span class="ident" id="5480696">name</span><span class="op" id="5480700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480705">Decl</span><span class="op" id="5480709">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5480714">t</span><span class="op" id="5480715">.</span><span class="ident" id="5480716">decl</span><span class="op" id="5480720">,</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480725">Consts</span><span class="op" id="5480731">:</span>&nbsp;&nbsp;<span class="ident" id="5480734">sortedValues</span><span class="op" id="5480746">(</span><span class="ident" id="5480747">t</span><span class="op" id="5480748">.</span><span class="ident" id="5480749">values</span><span class="op" id="5480755">,</span>&nbsp;<span class="ident" id="5480757">token</span><span class="op" id="5480762">.</span><span class="ident" id="5480763">CONST</span><span class="op" id="5480768">)</span><span class="op" id="5480769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480774">Vars</span><span class="op" id="5480778">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5480783">sortedValues</span><span class="op" id="5480795">(</span><span class="ident" id="5480796">t</span><span class="op" id="5480797">.</span><span class="ident" id="5480798">values</span><span class="op" id="5480804">,</span>&nbsp;<span class="ident" id="5480806">token</span><span class="op" id="5480811">.</span><span class="ident" id="5480812">VAR</span><span class="op" id="5480815">)</span><span class="op" id="5480816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480821">Funcs</span><span class="op" id="5480826">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5480830">sortedFuncs</span><span class="op" id="5480841">(</span><span class="ident" id="5480842">t</span><span class="op" id="5480843">.</span><span class="ident" id="5480844">funcs</span><span class="op" id="5480849">,</span>&nbsp;<span class="builtintype" id="5480851">true</span><span class="op" id="5480855">)</span><span class="op" id="5480856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480861">Methods</span><span class="op" id="5480868">:</span>&nbsp;<span class="ident" id="5480870">sortedFuncs</span><span class="op" id="5480881">(</span><span class="ident" id="5480882">t</span><span class="op" id="5480883">.</span><span class="ident" id="5480884">methods</span><span class="op" id="5480891">,</span>&nbsp;<span class="ident" id="5480893">allMethods</span><span class="op" id="5480903">)</span><span class="op" id="5480904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480908">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480912">i</span><span class="op" id="5480913">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5480917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5480921">sortBy</span><span class="op" id="5480927">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480931">func</span><span class="op" id="5480935">(</span><span class="ident" id="5480936">i</span><span class="op" id="5480937">,</span>&nbsp;<span class="ident" id="5480939">j</span>&nbsp;<span class="builtintype" id="5480941">int</span><span class="op" id="5480944">)</span>&nbsp;<span class="builtintype" id="5480946">bool</span>&nbsp;<span class="op" id="5480951">{</span>&nbsp;<span class="keyword" id="5480953">return</span>&nbsp;<span class="ident" id="5480960">list</span><span class="op" id="5480964">[</span><span class="ident" id="5480965">i</span><span class="op" id="5480966">]</span><span class="op" id="5480967">.</span><span class="ident" id="5480968">Name</span>&nbsp;<span class="op" id="5480973">&lt;</span>&nbsp;<span class="ident" id="5480975">list</span><span class="op" id="5480979">[</span><span class="ident" id="5480980">j</span><span class="op" id="5480981">]</span><span class="op" id="5480982">.</span><span class="ident" id="5480983">Name</span>&nbsp;<span class="op" id="5480988">}</span><span class="op" id="5480989">,</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5480993">func</span><span class="op" id="5480997">(</span><span class="ident" id="5480998">i</span><span class="op" id="5480999">,</span>&nbsp;<span class="ident" id="5481001">j</span>&nbsp;<span class="builtintype" id="5481003">int</span><span class="op" id="5481006">)</span>&nbsp;<span class="op" id="5481008">{</span>&nbsp;<span class="ident" id="5481010">list</span><span class="op" id="5481014">[</span><span class="ident" id="5481015">i</span><span class="op" id="5481016">]</span><span class="op" id="5481017">,</span>&nbsp;<span class="ident" id="5481019">list</span><span class="op" id="5481023">[</span><span class="ident" id="5481024">j</span><span class="op" id="5481025">]</span>&nbsp;<span class="op" id="5481027">=</span>&nbsp;<span class="ident" id="5481029">list</span><span class="op" id="5481033">[</span><span class="ident" id="5481034">j</span><span class="op" id="5481035">]</span><span class="op" id="5481036">,</span>&nbsp;<span class="ident" id="5481038">list</span><span class="op" id="5481042">[</span><span class="ident" id="5481043">i</span><span class="op" id="5481044">]</span>&nbsp;<span class="op" id="5481046">}</span><span class="op" id="5481047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5481051">len</span><span class="op" id="5481054">(</span><span class="ident" id="5481055">list</span><span class="op" id="5481059">)</span><span class="op" id="5481060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5481063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481067">return</span>&nbsp;<span class="ident" id="5481074">list</span><br>
<span class="lineno">760</span><span class="op" id="5481079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5481082">func</span>&nbsp;<span class="ident" id="5481087">removeStar</span><span class="op" id="5481097">(</span><span class="ident" id="5481098">s</span>&nbsp;<span class="builtintype" id="5481100">string</span><span class="op" id="5481106">)</span>&nbsp;<span class="builtintype" id="5481108">string</span>&nbsp;<span class="op" id="5481115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481118">if</span>&nbsp;<span class="builtinfunc" id="5481121">len</span><span class="op" id="5481124">(</span><span class="ident" id="5481125">s</span><span class="op" id="5481126">)</span>&nbsp;<span class="op" id="5481128">&gt;</span>&nbsp;<span class="num" id="5481130">0</span>&nbsp;<span class="op" id="5481132">&amp;&amp;</span>&nbsp;<span class="ident" id="5481135">s</span><span class="op" id="5481136">[</span><span class="num" id="5481137">0</span><span class="op" id="5481138">]</span>&nbsp;<span class="op" id="5481140">==</span>&nbsp;<span class="string" id="5481143">&#39;*&#39;</span>&nbsp;<span class="op" id="5481147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481151">return</span>&nbsp;<span class="ident" id="5481158">s</span><span class="op" id="5481159">[</span><span class="num" id="5481160">1</span><span class="op" id="5481161">:</span><span class="op" id="5481162">]</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5481165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481168">return</span>&nbsp;<span class="ident" id="5481175">s</span><br>
<span class="lineno"></span><span class="op" id="5481177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5481180">func</span>&nbsp;<span class="ident" id="5481185">sortedFuncs</span><span class="op" id="5481196">(</span><span class="ident" id="5481197">m</span>&nbsp;<span class="ident" id="5481199">methodSet</span><span class="op" id="5481208">,</span>&nbsp;<span class="ident" id="5481210">allMethods</span>&nbsp;<span class="builtintype" id="5481221">bool</span><span class="op" id="5481225">)</span>&nbsp;<span class="op" id="5481227">[</span><span class="op" id="5481228">]</span><span class="op" id="5481229">*</span><span class="ident" id="5481230">Func</span>&nbsp;<span class="op" id="5481235">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481238">list</span>&nbsp;<span class="op" id="5481243">:=</span>&nbsp;<span class="builtinfunc" id="5481246">make</span><span class="op" id="5481250">(</span><span class="op" id="5481251">[</span><span class="op" id="5481252">]</span><span class="op" id="5481253">*</span><span class="ident" id="5481254">Func</span><span class="op" id="5481258">,</span>&nbsp;<span class="builtinfunc" id="5481260">len</span><span class="op" id="5481263">(</span><span class="ident" id="5481264">m</span><span class="op" id="5481265">)</span><span class="op" id="5481266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481269">i</span>&nbsp;<span class="op" id="5481271">:=</span>&nbsp;<span class="num" id="5481274">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481277">for</span>&nbsp;<span class="ident" id="5481281">_</span><span class="op" id="5481282">,</span>&nbsp;<span class="ident" id="5481284">m</span>&nbsp;<span class="op" id="5481286">:=</span>&nbsp;<span class="keyword" id="5481289">range</span>&nbsp;<span class="ident" id="5481295">m</span>&nbsp;<span class="op" id="5481297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5481301">//&nbsp;determine&nbsp;which&nbsp;methods&nbsp;to&nbsp;include</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481341">switch</span>&nbsp;<span class="op" id="5481348">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481352">case</span>&nbsp;<span class="ident" id="5481357">m</span><span class="op" id="5481358">.</span><span class="ident" id="5481359">Decl</span>&nbsp;<span class="op" id="5481364">==</span>&nbsp;<span class="ident" id="5481367">nil</span><span class="op" id="5481370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5481375">//&nbsp;exclude&nbsp;conflict&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481403">case</span>&nbsp;<span class="ident" id="5481408">allMethods</span><span class="op" id="5481418">,</span>&nbsp;<span class="ident" id="5481420">m</span><span class="op" id="5481421">.</span><span class="ident" id="5481422">Level</span>&nbsp;<span class="op" id="5481428">==</span>&nbsp;<span class="num" id="5481431">0</span><span class="op" id="5481432">,</span>&nbsp;<span class="op" id="5481434">!</span><span class="ident" id="5481435">ast</span><span class="op" id="5481438">.</span><span class="ident" id="5481439">IsExported</span><span class="op" id="5481449">(</span><span class="ident" id="5481450">removeStar</span><span class="op" id="5481460">(</span><span class="ident" id="5481461">m</span><span class="op" id="5481462">.</span><span class="ident" id="5481463">Orig</span><span class="op" id="5481467">)</span><span class="op" id="5481468">)</span><span class="op" id="5481469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5481474">//&nbsp;forced&nbsp;inclusion,&nbsp;method&nbsp;not&nbsp;embedded,&nbsp;or&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5481529">//&nbsp;embedded&nbsp;but&nbsp;original&nbsp;receiver&nbsp;type&nbsp;not&nbsp;exported</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481584">list</span><span class="op" id="5481588">[</span><span class="ident" id="5481589">i</span><span class="op" id="5481590">]</span>&nbsp;<span class="op" id="5481592">=</span>&nbsp;<span class="ident" id="5481594">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481599">i</span><span class="op" id="5481600">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5481605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5481608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481611">list</span>&nbsp;<span class="op" id="5481616">=</span>&nbsp;<span class="ident" id="5481618">list</span><span class="op" id="5481622">[</span><span class="num" id="5481623">0</span><span class="op" id="5481624">:</span><span class="ident" id="5481625">i</span><span class="op" id="5481626">]</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5481629">sortBy</span><span class="op" id="5481635">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481639">func</span><span class="op" id="5481643">(</span><span class="ident" id="5481644">i</span><span class="op" id="5481645">,</span>&nbsp;<span class="ident" id="5481647">j</span>&nbsp;<span class="builtintype" id="5481649">int</span><span class="op" id="5481652">)</span>&nbsp;<span class="builtintype" id="5481654">bool</span>&nbsp;<span class="op" id="5481659">{</span>&nbsp;<span class="keyword" id="5481661">return</span>&nbsp;<span class="ident" id="5481668">list</span><span class="op" id="5481672">[</span><span class="ident" id="5481673">i</span><span class="op" id="5481674">]</span><span class="op" id="5481675">.</span><span class="ident" id="5481676">Name</span>&nbsp;<span class="op" id="5481681">&lt;</span>&nbsp;<span class="ident" id="5481683">list</span><span class="op" id="5481687">[</span><span class="ident" id="5481688">j</span><span class="op" id="5481689">]</span><span class="op" id="5481690">.</span><span class="ident" id="5481691">Name</span>&nbsp;<span class="op" id="5481696">}</span><span class="op" id="5481697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481701">func</span><span class="op" id="5481705">(</span><span class="ident" id="5481706">i</span><span class="op" id="5481707">,</span>&nbsp;<span class="ident" id="5481709">j</span>&nbsp;<span class="builtintype" id="5481711">int</span><span class="op" id="5481714">)</span>&nbsp;<span class="op" id="5481716">{</span>&nbsp;<span class="ident" id="5481718">list</span><span class="op" id="5481722">[</span><span class="ident" id="5481723">i</span><span class="op" id="5481724">]</span><span class="op" id="5481725">,</span>&nbsp;<span class="ident" id="5481727">list</span><span class="op" id="5481731">[</span><span class="ident" id="5481732">j</span><span class="op" id="5481733">]</span>&nbsp;<span class="op" id="5481735">=</span>&nbsp;<span class="ident" id="5481737">list</span><span class="op" id="5481741">[</span><span class="ident" id="5481742">j</span><span class="op" id="5481743">]</span><span class="op" id="5481744">,</span>&nbsp;<span class="ident" id="5481746">list</span><span class="op" id="5481750">[</span><span class="ident" id="5481751">i</span><span class="op" id="5481752">]</span>&nbsp;<span class="op" id="5481754">}</span><span class="op" id="5481755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5481759">len</span><span class="op" id="5481762">(</span><span class="ident" id="5481763">list</span><span class="op" id="5481767">)</span><span class="op" id="5481768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5481771">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481774">return</span>&nbsp;<span class="ident" id="5481781">list</span><br>
<span class="lineno"></span><span class="op" id="5481786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5481789">//&nbsp;noteBodies&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;note&nbsp;body&nbsp;strings&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;notes.</span><br>
<span class="lineno"></span><span class="comment" id="5481862">//&nbsp;This&nbsp;is&nbsp;only&nbsp;used&nbsp;to&nbsp;populate&nbsp;the&nbsp;deprecated&nbsp;Package.Bugs&nbsp;field.</span><br>
<span class="lineno">795</span><span class="comment" id="5481930">//</span><br>
<span class="lineno"></span><span class="keyword" id="5481933">func</span>&nbsp;<span class="ident" id="5481938">noteBodies</span><span class="op" id="5481948">(</span><span class="ident" id="5481949">notes</span>&nbsp;<span class="op" id="5481955">[</span><span class="op" id="5481956">]</span><span class="op" id="5481957">*</span><span class="ident" id="5481958">Note</span><span class="op" id="5481962">)</span>&nbsp;<span class="op" id="5481964">[</span><span class="op" id="5481965">]</span><span class="builtintype" id="5481966">string</span>&nbsp;<span class="op" id="5481973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481976">var</span>&nbsp;<span class="ident" id="5481980">list</span>&nbsp;<span class="op" id="5481985">[</span><span class="op" id="5481986">]</span><span class="builtintype" id="5481987">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5481995">for</span>&nbsp;<span class="ident" id="5481999">_</span><span class="op" id="5482000">,</span>&nbsp;<span class="ident" id="5482002">n</span>&nbsp;<span class="op" id="5482004">:=</span>&nbsp;<span class="keyword" id="5482007">range</span>&nbsp;<span class="ident" id="5482013">notes</span>&nbsp;<span class="op" id="5482019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5482023">list</span>&nbsp;<span class="op" id="5482028">=</span>&nbsp;<span class="builtinfunc" id="5482030">append</span><span class="op" id="5482036">(</span><span class="ident" id="5482037">list</span><span class="op" id="5482041">,</span>&nbsp;<span class="ident" id="5482043">n</span><span class="op" id="5482044">.</span><span class="ident" id="5482045">Body</span><span class="op" id="5482049">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5482052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5482055">return</span>&nbsp;<span class="ident" id="5482062">list</span><br>
<span class="lineno"></span><span class="op" id="5482067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5482070">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">805</span><span class="comment" id="5482150">//&nbsp;Predeclared&nbsp;identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5482178">var</span>&nbsp;<span class="ident" id="5482182">predeclaredTypes</span>&nbsp;<span class="op" id="5482199">=</span>&nbsp;<span class="keyword" id="5482201">map</span><span class="op" id="5482204">[</span><span class="builtintype" id="5482205">string</span><span class="op" id="5482211">]</span><span class="builtintype" id="5482212">bool</span><span class="op" id="5482216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482219">&#34;bool&#34;</span><span class="op" id="5482225">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482233">true</span><span class="op" id="5482237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482240">&#34;byte&#34;</span><span class="op" id="5482246">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482254">true</span><span class="op" id="5482258">,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482261">&#34;complex64&#34;</span><span class="op" id="5482272">:</span>&nbsp;&nbsp;<span class="builtintype" id="5482275">true</span><span class="op" id="5482279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482282">&#34;complex128&#34;</span><span class="op" id="5482294">:</span>&nbsp;<span class="builtintype" id="5482296">true</span><span class="op" id="5482300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482303">&#34;error&#34;</span><span class="op" id="5482310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482317">true</span><span class="op" id="5482321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482324">&#34;float32&#34;</span><span class="op" id="5482333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482338">true</span><span class="op" id="5482342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482345">&#34;float64&#34;</span><span class="op" id="5482354">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482359">true</span><span class="op" id="5482363">,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482366">&#34;int&#34;</span><span class="op" id="5482371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482380">true</span><span class="op" id="5482384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482387">&#34;int8&#34;</span><span class="op" id="5482393">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482401">true</span><span class="op" id="5482405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482408">&#34;int16&#34;</span><span class="op" id="5482415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482422">true</span><span class="op" id="5482426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482429">&#34;int32&#34;</span><span class="op" id="5482436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482443">true</span><span class="op" id="5482447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482450">&#34;int64&#34;</span><span class="op" id="5482457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482464">true</span><span class="op" id="5482468">,</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482471">&#34;rune&#34;</span><span class="op" id="5482477">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482485">true</span><span class="op" id="5482489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482492">&#34;string&#34;</span><span class="op" id="5482500">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482506">true</span><span class="op" id="5482510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482513">&#34;uint&#34;</span><span class="op" id="5482519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482527">true</span><span class="op" id="5482531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482534">&#34;uint8&#34;</span><span class="op" id="5482541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482548">true</span><span class="op" id="5482552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482555">&#34;uint16&#34;</span><span class="op" id="5482563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482569">true</span><span class="op" id="5482573">,</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482576">&#34;uint32&#34;</span><span class="op" id="5482584">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482590">true</span><span class="op" id="5482594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482597">&#34;uint64&#34;</span><span class="op" id="5482605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482611">true</span><span class="op" id="5482615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482618">&#34;uintptr&#34;</span><span class="op" id="5482627">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482632">true</span><span class="op" id="5482636">,</span><br>
<span class="lineno"></span><span class="op" id="5482638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="keyword" id="5482641">var</span>&nbsp;<span class="ident" id="5482645">predeclaredFuncs</span>&nbsp;<span class="op" id="5482662">=</span>&nbsp;<span class="keyword" id="5482664">map</span><span class="op" id="5482667">[</span><span class="builtintype" id="5482668">string</span><span class="op" id="5482674">]</span><span class="builtintype" id="5482675">bool</span><span class="op" id="5482679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482682">&#34;append&#34;</span><span class="op" id="5482690">:</span>&nbsp;&nbsp;<span class="builtintype" id="5482693">true</span><span class="op" id="5482697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482700">&#34;cap&#34;</span><span class="op" id="5482705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482711">true</span><span class="op" id="5482715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482718">&#34;close&#34;</span><span class="op" id="5482725">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482729">true</span><span class="op" id="5482733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482736">&#34;complex&#34;</span><span class="op" id="5482745">:</span>&nbsp;<span class="builtintype" id="5482747">true</span><span class="op" id="5482751">,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482754">&#34;copy&#34;</span><span class="op" id="5482760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482765">true</span><span class="op" id="5482769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482772">&#34;delete&#34;</span><span class="op" id="5482780">:</span>&nbsp;&nbsp;<span class="builtintype" id="5482783">true</span><span class="op" id="5482787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482790">&#34;imag&#34;</span><span class="op" id="5482796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482801">true</span><span class="op" id="5482805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482808">&#34;len&#34;</span><span class="op" id="5482813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482819">true</span><span class="op" id="5482823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482826">&#34;make&#34;</span><span class="op" id="5482832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482837">true</span><span class="op" id="5482841">,</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482844">&#34;new&#34;</span><span class="op" id="5482849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482855">true</span><span class="op" id="5482859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482862">&#34;panic&#34;</span><span class="op" id="5482869">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482873">true</span><span class="op" id="5482877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482880">&#34;print&#34;</span><span class="op" id="5482887">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482891">true</span><span class="op" id="5482895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482898">&#34;println&#34;</span><span class="op" id="5482907">:</span>&nbsp;<span class="builtintype" id="5482909">true</span><span class="op" id="5482913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482916">&#34;real&#34;</span><span class="op" id="5482922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5482927">true</span><span class="op" id="5482931">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482934">&#34;recover&#34;</span><span class="op" id="5482943">:</span>&nbsp;<span class="builtintype" id="5482945">true</span><span class="op" id="5482949">,</span><br>
<span class="lineno"></span><span class="op" id="5482951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5482954">var</span>&nbsp;<span class="ident" id="5482958">predeclaredConstants</span>&nbsp;<span class="op" id="5482979">=</span>&nbsp;<span class="keyword" id="5482981">map</span><span class="op" id="5482984">[</span><span class="builtintype" id="5482985">string</span><span class="op" id="5482991">]</span><span class="builtintype" id="5482992">bool</span><span class="op" id="5482996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5482999">&#34;false&#34;</span><span class="op" id="5483006">:</span>&nbsp;<span class="builtintype" id="5483008">true</span><span class="op" id="5483012">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483015">&#34;iota&#34;</span><span class="op" id="5483021">:</span>&nbsp;&nbsp;<span class="builtintype" id="5483024">true</span><span class="op" id="5483028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483031">&#34;nil&#34;</span><span class="op" id="5483036">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5483040">true</span><span class="op" id="5483044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483047">&#34;true&#34;</span><span class="op" id="5483053">:</span>&nbsp;&nbsp;<span class="builtintype" id="5483056">true</span><span class="op" id="5483060">,</span><br>
<span class="lineno"></span><span class="op" id="5483062">}</span>
</div>
</body>
</html>
