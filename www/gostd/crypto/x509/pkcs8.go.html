<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3809839">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3809894">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3809948">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3809999">package</span>&nbsp;<span class="ident" id="3810007">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810013">import</span>&nbsp;<span class="op" id="3810020">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3810023">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3810043">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3810060">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3810070">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="3810076">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3810079">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="3810130">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="3810190">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3810206">type</span>&nbsp;<span class="ident" id="3810211">pkcs8</span>&nbsp;<span class="keyword" id="3810217">struct</span>&nbsp;<span class="op" id="3810224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810227">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3810238">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810243">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810254">pkix</span><span class="op" id="3810258">.</span><span class="ident" id="3810259">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810280">PrivateKey</span>&nbsp;<span class="op" id="3810291">[</span><span class="op" id="3810292">]</span><span class="builtintype" id="3810293">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3810299">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="3810331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3810334">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="3810405">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3810465">func</span>&nbsp;<span class="ident" id="3810470">ParsePKCS8PrivateKey</span><span class="op" id="3810490">(</span><span class="ident" id="3810491">der</span>&nbsp;<span class="op" id="3810495">[</span><span class="op" id="3810496">]</span><span class="builtintype" id="3810497">byte</span><span class="op" id="3810501">)</span>&nbsp;<span class="op" id="3810503">(</span><span class="ident" id="3810504">key</span>&nbsp;<span class="keyword" id="3810508">interface</span><span class="op" id="3810517">{</span><span class="op" id="3810518">}</span><span class="op" id="3810519">,</span>&nbsp;<span class="ident" id="3810521">err</span>&nbsp;<span class="builtintype" id="3810525">error</span><span class="op" id="3810530">)</span>&nbsp;<span class="op" id="3810532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810535">var</span>&nbsp;<span class="ident" id="3810539">privKey</span>&nbsp;<span class="ident" id="3810547">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810554">if</span>&nbsp;<span class="ident" id="3810557">_</span><span class="op" id="3810558">,</span>&nbsp;<span class="ident" id="3810560">err</span>&nbsp;<span class="op" id="3810564">:=</span>&nbsp;<span class="ident" id="3810567">asn1</span><span class="op" id="3810571">.</span><span class="ident" id="3810572">Unmarshal</span><span class="op" id="3810581">(</span><span class="ident" id="3810582">der</span><span class="op" id="3810585">,</span>&nbsp;<span class="op" id="3810587">&amp;</span><span class="ident" id="3810588">privKey</span><span class="op" id="3810595">)</span><span class="op" id="3810596">;</span>&nbsp;<span class="ident" id="3810598">err</span>&nbsp;<span class="op" id="3810602">!=</span>&nbsp;<span class="ident" id="3810605">nil</span>&nbsp;<span class="op" id="3810609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810613">return</span>&nbsp;<span class="ident" id="3810620">nil</span><span class="op" id="3810623">,</span>&nbsp;<span class="ident" id="3810625">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810633">switch</span>&nbsp;<span class="op" id="3810640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810643">case</span>&nbsp;<span class="ident" id="3810648">privKey</span><span class="op" id="3810655">.</span><span class="ident" id="3810656">Algo</span><span class="op" id="3810660">.</span><span class="ident" id="3810661">Algorithm</span><span class="op" id="3810670">.</span><span class="ident" id="3810671">Equal</span><span class="op" id="3810676">(</span><span class="ident" id="3810677">oidPublicKeyRSA</span><span class="op" id="3810692">)</span><span class="op" id="3810693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810697">key</span><span class="op" id="3810700">,</span>&nbsp;<span class="ident" id="3810702">err</span>&nbsp;<span class="op" id="3810706">=</span>&nbsp;<span class="ident" id="3810708">ParsePKCS1PrivateKey</span><span class="op" id="3810728">(</span><span class="ident" id="3810729">privKey</span><span class="op" id="3810736">.</span><span class="ident" id="3810737">PrivateKey</span><span class="op" id="3810747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810751">if</span>&nbsp;<span class="ident" id="3810754">err</span>&nbsp;<span class="op" id="3810758">!=</span>&nbsp;<span class="ident" id="3810761">nil</span>&nbsp;<span class="op" id="3810765">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810770">return</span>&nbsp;<span class="ident" id="3810777">nil</span><span class="op" id="3810780">,</span>&nbsp;<span class="ident" id="3810782">errors</span><span class="op" id="3810788">.</span><span class="ident" id="3810789">New</span><span class="op" id="3810792">(</span><span class="string" id="3810793">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3810854">+</span>&nbsp;<span class="ident" id="3810856">err</span><span class="op" id="3810859">.</span><span class="ident" id="3810860">Error</span><span class="op" id="3810865">(</span><span class="op" id="3810866">)</span><span class="op" id="3810867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810875">return</span>&nbsp;<span class="ident" id="3810882">key</span><span class="op" id="3810885">,</span>&nbsp;<span class="ident" id="3810887">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810893">case</span>&nbsp;<span class="ident" id="3810898">privKey</span><span class="op" id="3810905">.</span><span class="ident" id="3810906">Algo</span><span class="op" id="3810910">.</span><span class="ident" id="3810911">Algorithm</span><span class="op" id="3810920">.</span><span class="ident" id="3810921">Equal</span><span class="op" id="3810926">(</span><span class="ident" id="3810927">oidPublicKeyECDSA</span><span class="op" id="3810944">)</span><span class="op" id="3810945">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810949">bytes</span>&nbsp;<span class="op" id="3810955">:=</span>&nbsp;<span class="ident" id="3810958">privKey</span><span class="op" id="3810965">.</span><span class="ident" id="3810966">Algo</span><span class="op" id="3810970">.</span><span class="ident" id="3810971">Parameters</span><span class="op" id="3810981">.</span><span class="ident" id="3810982">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810994">namedCurveOID</span>&nbsp;<span class="op" id="3811008">:=</span>&nbsp;<span class="builtinfunc" id="3811011">new</span><span class="op" id="3811014">(</span><span class="ident" id="3811015">asn1</span><span class="op" id="3811019">.</span><span class="ident" id="3811020">ObjectIdentifier</span><span class="op" id="3811036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811040">if</span>&nbsp;<span class="ident" id="3811043">_</span><span class="op" id="3811044">,</span>&nbsp;<span class="ident" id="3811046">err</span>&nbsp;<span class="op" id="3811050">:=</span>&nbsp;<span class="ident" id="3811053">asn1</span><span class="op" id="3811057">.</span><span class="ident" id="3811058">Unmarshal</span><span class="op" id="3811067">(</span><span class="ident" id="3811068">bytes</span><span class="op" id="3811073">,</span>&nbsp;<span class="ident" id="3811075">namedCurveOID</span><span class="op" id="3811088">)</span><span class="op" id="3811089">;</span>&nbsp;<span class="ident" id="3811091">err</span>&nbsp;<span class="op" id="3811095">!=</span>&nbsp;<span class="ident" id="3811098">nil</span>&nbsp;<span class="op" id="3811102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811107">namedCurveOID</span>&nbsp;<span class="op" id="3811121">=</span>&nbsp;<span class="ident" id="3811123">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811129">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811133">key</span><span class="op" id="3811136">,</span>&nbsp;<span class="ident" id="3811138">err</span>&nbsp;<span class="op" id="3811142">=</span>&nbsp;<span class="ident" id="3811144">parseECPrivateKey</span><span class="op" id="3811161">(</span><span class="ident" id="3811162">namedCurveOID</span><span class="op" id="3811175">,</span>&nbsp;<span class="ident" id="3811177">privKey</span><span class="op" id="3811184">.</span><span class="ident" id="3811185">PrivateKey</span><span class="op" id="3811195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811199">if</span>&nbsp;<span class="ident" id="3811202">err</span>&nbsp;<span class="op" id="3811206">!=</span>&nbsp;<span class="ident" id="3811209">nil</span>&nbsp;<span class="op" id="3811213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811218">return</span>&nbsp;<span class="ident" id="3811225">nil</span><span class="op" id="3811228">,</span>&nbsp;<span class="ident" id="3811230">errors</span><span class="op" id="3811236">.</span><span class="ident" id="3811237">New</span><span class="op" id="3811240">(</span><span class="string" id="3811241">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3811301">+</span>&nbsp;<span class="ident" id="3811303">err</span><span class="op" id="3811306">.</span><span class="ident" id="3811307">Error</span><span class="op" id="3811312">(</span><span class="op" id="3811313">)</span><span class="op" id="3811314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811322">return</span>&nbsp;<span class="ident" id="3811329">key</span><span class="op" id="3811332">,</span>&nbsp;<span class="ident" id="3811334">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811340">default</span><span class="op" id="3811347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811351">return</span>&nbsp;<span class="ident" id="3811358">nil</span><span class="op" id="3811361">,</span>&nbsp;<span class="ident" id="3811363">fmt</span><span class="op" id="3811366">.</span><span class="ident" id="3811367">Errorf</span><span class="op" id="3811373">(</span><span class="string" id="3811374">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="3811446">,</span>&nbsp;<span class="ident" id="3811448">privKey</span><span class="op" id="3811455">.</span><span class="ident" id="3811456">Algo</span><span class="op" id="3811460">.</span><span class="ident" id="3811461">Algorithm</span><span class="op" id="3811470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811473">}</span><br>
<span class="lineno"></span><span class="op" id="3811475">}</span>
</div>
</body>
</html>
