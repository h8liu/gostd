<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7930875">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7930930">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7930984">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7931035">package</span>&nbsp;<span class="ident" id="7931043">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7931048">import</span>&nbsp;<span class="op" id="7931055">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931058">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931064">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931077">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931083">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931094">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7931105">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7931112">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7931115">func</span>&nbsp;<span class="ident" id="7931120">TestShutdown</span><span class="op" id="7931132">(</span><span class="ident" id="7931133">t</span>&nbsp;<span class="op" id="7931135">*</span><span class="ident" id="7931136"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7931143">.</span><span class="ident" id="7931144">T</span><span class="op" id="7931145">)</span>&nbsp;<span class="op" id="7931147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931150">if</span>&nbsp;<span class="ident" id="7931153"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7931160">.</span><span class="ident" id="7931161">GOOS</span>&nbsp;<span class="op" id="7931166">==</span>&nbsp;<span class="string" id="7931169">&#34;plan9&#34;</span>&nbsp;<span class="op" id="7931177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931181"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931182">.</span><span class="ident" id="7931183">Skipf</span><span class="op" id="7931188">(</span><span class="string" id="7931189">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7931210">,</span>&nbsp;<span class="ident" id="7931212"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7931219">.</span><span class="ident" id="7931220">GOOS</span><span class="op" id="7931224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931227">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931230">ln</span><span class="op" id="7931232">,</span>&nbsp;<span class="ident" id="7931234">err</span>&nbsp;<span class="op" id="7931238">:=</span>&nbsp;<span class="ident" id="7931241"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7931247">(</span><span class="string" id="7931248">&#34;tcp&#34;</span><span class="op" id="7931253">,</span>&nbsp;<span class="string" id="7931255">&#34;127.0.0.1:0&#34;</span><span class="op" id="7931268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931271">if</span>&nbsp;<span class="ident" id="7931274"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931278">!=</span>&nbsp;<span class="ident" id="7931281">nil</span>&nbsp;<span class="op" id="7931285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931289">if</span>&nbsp;<span class="ident" id="7931292"><a href="/net/net_test.go.html#7931230">ln</a></span><span class="op" id="7931294">,</span>&nbsp;<span class="ident" id="7931296"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931300">=</span>&nbsp;<span class="ident" id="7931302"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7931308">(</span><span class="string" id="7931309">&#34;tcp6&#34;</span><span class="op" id="7931315">,</span>&nbsp;<span class="string" id="7931317">&#34;[::1]:0&#34;</span><span class="op" id="7931326">)</span><span class="op" id="7931327">;</span>&nbsp;<span class="ident" id="7931329"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931333">!=</span>&nbsp;<span class="ident" id="7931336">nil</span>&nbsp;<span class="op" id="7931340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931345"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931346">.</span><span class="ident" id="7931347">Fatalf</span><span class="op" id="7931353">(</span><span class="string" id="7931354">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7931375">,</span>&nbsp;<span class="ident" id="7931377"><a href="/net/net_test.go.html#7931234">err</a></span><span class="op" id="7931380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931384">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931391">go</span>&nbsp;<span class="keyword" id="7931394">func</span><span class="op" id="7931398">(</span><span class="op" id="7931399">)</span>&nbsp;<span class="op" id="7931401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931405">defer</span>&nbsp;<span class="ident" id="7931411"><a href="/net/net_test.go.html#7931230">ln</a></span><span class="op" id="7931413">.</span><span class="ident" id="7931414">Close</span><span class="op" id="7931419">(</span><span class="op" id="7931420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931424">c</span><span class="op" id="7931425">,</span>&nbsp;<span class="ident" id="7931427">err</span>&nbsp;<span class="op" id="7931431">:=</span>&nbsp;<span class="ident" id="7931434"><a href="/net/net_test.go.html#7931230">ln</a></span><span class="op" id="7931436">.</span><span class="ident" id="7931437">Accept</span><span class="op" id="7931443">(</span><span class="op" id="7931444">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931448">if</span>&nbsp;<span class="ident" id="7931451"><a href="/net/net_test.go.html#7931427">err</a></span>&nbsp;<span class="op" id="7931455">!=</span>&nbsp;<span class="ident" id="7931458">nil</span>&nbsp;<span class="op" id="7931462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931467"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931468">.</span><span class="ident" id="7931469">Errorf</span><span class="op" id="7931475">(</span><span class="string" id="7931476">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7931488">,</span>&nbsp;<span class="ident" id="7931490"><a href="/net/net_test.go.html#7931427">err</a></span><span class="op" id="7931493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931498">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931511">var</span>&nbsp;<span class="ident" id="7931515">buf</span>&nbsp;<span class="op" id="7931519">[</span><span class="num" id="7931520">10</span><span class="op" id="7931522">]</span><span class="builtintype" id="7931523">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931530">n</span><span class="op" id="7931531">,</span>&nbsp;<span class="ident" id="7931533"><a href="/net/net_test.go.html#7931427">err</a></span>&nbsp;<span class="op" id="7931537">:=</span>&nbsp;<span class="ident" id="7931540"><a href="/net/net_test.go.html#7931424">c</a></span><span class="op" id="7931541">.</span><span class="ident" id="7931542">Read</span><span class="op" id="7931546">(</span><span class="ident" id="7931547"><a href="/net/net_test.go.html#7931515">buf</a></span><span class="op" id="7931550">[</span><span class="op" id="7931551">:</span><span class="op" id="7931552">]</span><span class="op" id="7931553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931557">if</span>&nbsp;<span class="ident" id="7931560"><a href="/net/net_test.go.html#7931530">n</a></span>&nbsp;<span class="op" id="7931562">!=</span>&nbsp;<span class="num" id="7931565">0</span>&nbsp;<span class="op" id="7931567">||</span>&nbsp;<span class="ident" id="7931570"><a href="/net/net_test.go.html#7931427">err</a></span>&nbsp;<span class="op" id="7931574">!=</span>&nbsp;<span class="ident" id="7931577"><a href="/net/net_test.go.html#7931058">io</a></span><span class="op" id="7931579">.</span><span class="ident" id="7931580">EOF</span>&nbsp;<span class="op" id="7931584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931589"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931590">.</span><span class="ident" id="7931591">Errorf</span><span class="op" id="7931597">(</span><span class="string" id="7931598">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7931636">,</span>&nbsp;<span class="ident" id="7931638"><a href="/net/net_test.go.html#7931530">n</a></span><span class="op" id="7931639">,</span>&nbsp;<span class="ident" id="7931641"><a href="/net/net_test.go.html#7931427">err</a></span><span class="op" id="7931644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931658">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931662"><a href="/net/net_test.go.html#7931424">c</a></span><span class="op" id="7931663">.</span><span class="ident" id="7931664">Write</span><span class="op" id="7931669">(</span><span class="op" id="7931670">[</span><span class="op" id="7931671">]</span><span class="builtintype" id="7931672">byte</span><span class="op" id="7931676">(</span><span class="string" id="7931677">&#34;response&#34;</span><span class="op" id="7931687">)</span><span class="op" id="7931688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931692"><a href="/net/net_test.go.html#7931424">c</a></span><span class="op" id="7931693">.</span><span class="ident" id="7931694">Close</span><span class="op" id="7931699">(</span><span class="op" id="7931700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931703">}</span><span class="op" id="7931704">(</span><span class="op" id="7931705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931709">c</span><span class="op" id="7931710">,</span>&nbsp;<span class="ident" id="7931712"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931716">:=</span>&nbsp;<span class="ident" id="7931719"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7931723">(</span><span class="string" id="7931724">&#34;tcp&#34;</span><span class="op" id="7931729">,</span>&nbsp;<span class="ident" id="7931731"><a href="/net/net_test.go.html#7931230">ln</a></span><span class="op" id="7931733">.</span><span class="ident" id="7931734">Addr</span><span class="op" id="7931738">(</span><span class="op" id="7931739">)</span><span class="op" id="7931740">.</span><span class="ident" id="7931741">String</span><span class="op" id="7931747">(</span><span class="op" id="7931748">)</span><span class="op" id="7931749">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931752">if</span>&nbsp;<span class="ident" id="7931755"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931759">!=</span>&nbsp;<span class="ident" id="7931762">nil</span>&nbsp;<span class="op" id="7931766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931770"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931771">.</span><span class="ident" id="7931772">Fatalf</span><span class="op" id="7931778">(</span><span class="string" id="7931779">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7931789">,</span>&nbsp;<span class="ident" id="7931791"><a href="/net/net_test.go.html#7931234">err</a></span><span class="op" id="7931794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931800">defer</span>&nbsp;<span class="ident" id="7931806"><a href="/net/net_test.go.html#7931709">c</a></span><span class="op" id="7931807">.</span><span class="ident" id="7931808">Close</span><span class="op" id="7931813">(</span><span class="op" id="7931814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931818"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931822">=</span>&nbsp;<span class="ident" id="7931824"><a href="/net/net_test.go.html#7931709">c</a></span><span class="op" id="7931825">.</span><span class="op" id="7931826">(</span><span class="op" id="7931827">*</span><span class="ident" id="7931828"><a href="/net/tcpsock_posix.go.html#1507019">TCPConn</a></span><span class="op" id="7931835">)</span><span class="op" id="7931836">.</span><span class="ident" id="7931837">CloseWrite</span><span class="op" id="7931847">(</span><span class="op" id="7931848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931851">if</span>&nbsp;<span class="ident" id="7931854"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931858">!=</span>&nbsp;<span class="ident" id="7931861">nil</span>&nbsp;<span class="op" id="7931865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931869"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931870">.</span><span class="ident" id="7931871">Fatalf</span><span class="op" id="7931877">(</span><span class="string" id="7931878">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7931894">,</span>&nbsp;<span class="ident" id="7931896"><a href="/net/net_test.go.html#7931234">err</a></span><span class="op" id="7931899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931905">var</span>&nbsp;<span class="ident" id="7931909">buf</span>&nbsp;<span class="op" id="7931913">[</span><span class="num" id="7931914">10</span><span class="op" id="7931916">]</span><span class="builtintype" id="7931917">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931923">n</span><span class="op" id="7931924">,</span>&nbsp;<span class="ident" id="7931926"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931930">:=</span>&nbsp;<span class="ident" id="7931933"><a href="/net/net_test.go.html#7931709">c</a></span><span class="op" id="7931934">.</span><span class="ident" id="7931935">Read</span><span class="op" id="7931939">(</span><span class="ident" id="7931940"><a href="/net/net_test.go.html#7931909">buf</a></span><span class="op" id="7931943">[</span><span class="op" id="7931944">:</span><span class="op" id="7931945">]</span><span class="op" id="7931946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931949">if</span>&nbsp;<span class="ident" id="7931952"><a href="/net/net_test.go.html#7931234">err</a></span>&nbsp;<span class="op" id="7931956">!=</span>&nbsp;<span class="ident" id="7931959">nil</span>&nbsp;<span class="op" id="7931963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931967"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7931968">.</span><span class="ident" id="7931969">Fatalf</span><span class="op" id="7931975">(</span><span class="string" id="7931976">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7931997">,</span>&nbsp;<span class="ident" id="7931999"><a href="/net/net_test.go.html#7931923">n</a></span><span class="op" id="7932000">,</span>&nbsp;<span class="ident" id="7932002"><a href="/net/net_test.go.html#7931234">err</a></span><span class="op" id="7932005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932011">got</span>&nbsp;<span class="op" id="7932015">:=</span>&nbsp;<span class="builtintype" id="7932018">string</span><span class="op" id="7932024">(</span><span class="ident" id="7932025"><a href="/net/net_test.go.html#7931909">buf</a></span><span class="op" id="7932028">[</span><span class="op" id="7932029">:</span><span class="ident" id="7932030"><a href="/net/net_test.go.html#7931923">n</a></span><span class="op" id="7932031">]</span><span class="op" id="7932032">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932035">if</span>&nbsp;<span class="ident" id="7932038"><a href="/net/net_test.go.html#7932011">got</a></span>&nbsp;<span class="op" id="7932042">!=</span>&nbsp;<span class="string" id="7932045">&#34;response&#34;</span>&nbsp;<span class="op" id="7932056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932060"><a href="/net/net_test.go.html#7931133">t</a></span><span class="op" id="7932061">.</span><span class="ident" id="7932062">Errorf</span><span class="op" id="7932068">(</span><span class="string" id="7932069">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7932099">,</span>&nbsp;<span class="ident" id="7932101"><a href="/net/net_test.go.html#7932011">got</a></span><span class="op" id="7932104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932107">}</span><br>
<span class="lineno"></span><span class="op" id="7932109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7932112">func</span>&nbsp;<span class="ident" id="7932117">TestShutdownUnix</span><span class="op" id="7932133">(</span><span class="ident" id="7932134">t</span>&nbsp;<span class="op" id="7932136">*</span><span class="ident" id="7932137"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7932144">.</span><span class="ident" id="7932145">T</span><span class="op" id="7932146">)</span>&nbsp;<span class="op" id="7932148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932151">switch</span>&nbsp;<span class="ident" id="7932158"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7932165">.</span><span class="ident" id="7932166">GOOS</span>&nbsp;<span class="op" id="7932171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932174">case</span>&nbsp;<span class="string" id="7932179">&#34;nacl&#34;</span><span class="op" id="7932185">,</span>&nbsp;<span class="string" id="7932187">&#34;plan9&#34;</span><span class="op" id="7932194">,</span>&nbsp;<span class="string" id="7932196">&#34;windows&#34;</span><span class="op" id="7932205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932209"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932210">.</span><span class="ident" id="7932211">Skipf</span><span class="op" id="7932216">(</span><span class="string" id="7932217">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7932238">,</span>&nbsp;<span class="ident" id="7932240"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7932247">.</span><span class="ident" id="7932248">GOOS</span><span class="op" id="7932252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932255">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932258">f</span><span class="op" id="7932259">,</span>&nbsp;<span class="ident" id="7932261">err</span>&nbsp;<span class="op" id="7932265">:=</span>&nbsp;<span class="ident" id="7932268"><a href="/net/net_test.go.html#7931064">ioutil</a></span><span class="op" id="7932274">.</span><span class="ident" id="7932275">TempFile</span><span class="op" id="7932283">(</span><span class="string" id="7932284">&#34;&#34;</span><span class="op" id="7932286">,</span>&nbsp;<span class="string" id="7932288">&#34;go_net_unixtest&#34;</span><span class="op" id="7932305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932308">if</span>&nbsp;<span class="ident" id="7932311"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932315">!=</span>&nbsp;<span class="ident" id="7932318">nil</span>&nbsp;<span class="op" id="7932322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932326"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932327">.</span><span class="ident" id="7932328">Fatalf</span><span class="op" id="7932334">(</span><span class="string" id="7932335">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="7932349">,</span>&nbsp;<span class="ident" id="7932351"><a href="/net/net_test.go.html#7932261">err</a></span><span class="op" id="7932354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932360"><a href="/net/net_test.go.html#7932258">f</a></span><span class="op" id="7932361">.</span><span class="ident" id="7932362">Close</span><span class="op" id="7932367">(</span><span class="op" id="7932368">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932371">tmpname</span>&nbsp;<span class="op" id="7932379">:=</span>&nbsp;<span class="ident" id="7932382"><a href="/net/net_test.go.html#7932258">f</a></span><span class="op" id="7932383">.</span><span class="ident" id="7932384">Name</span><span class="op" id="7932388">(</span><span class="op" id="7932389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932392"><a href="/net/net_test.go.html#7931077">os</a></span><span class="op" id="7932394">.</span><span class="ident" id="7932395">Remove</span><span class="op" id="7932401">(</span><span class="ident" id="7932402"><a href="/net/net_test.go.html#7932371">tmpname</a></span><span class="op" id="7932409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932412">ln</span><span class="op" id="7932414">,</span>&nbsp;<span class="ident" id="7932416"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932420">:=</span>&nbsp;<span class="ident" id="7932423"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7932429">(</span><span class="string" id="7932430">&#34;unix&#34;</span><span class="op" id="7932436">,</span>&nbsp;<span class="ident" id="7932438"><a href="/net/net_test.go.html#7932371">tmpname</a></span><span class="op" id="7932445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932448">if</span>&nbsp;<span class="ident" id="7932451"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932455">!=</span>&nbsp;<span class="ident" id="7932458">nil</span>&nbsp;<span class="op" id="7932462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932466"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932467">.</span><span class="ident" id="7932468">Fatalf</span><span class="op" id="7932474">(</span><span class="string" id="7932475">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="7932497">,</span>&nbsp;<span class="ident" id="7932499"><a href="/net/net_test.go.html#7932371">tmpname</a></span><span class="op" id="7932506">,</span>&nbsp;<span class="ident" id="7932508"><a href="/net/net_test.go.html#7932261">err</a></span><span class="op" id="7932511">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932517">defer</span>&nbsp;<span class="keyword" id="7932523">func</span><span class="op" id="7932527">(</span><span class="op" id="7932528">)</span>&nbsp;<span class="op" id="7932530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932534"><a href="/net/net_test.go.html#7932412">ln</a></span><span class="op" id="7932536">.</span><span class="ident" id="7932537">Close</span><span class="op" id="7932542">(</span><span class="op" id="7932543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932547"><a href="/net/net_test.go.html#7931077">os</a></span><span class="op" id="7932549">.</span><span class="ident" id="7932550">Remove</span><span class="op" id="7932556">(</span><span class="ident" id="7932557"><a href="/net/net_test.go.html#7932371">tmpname</a></span><span class="op" id="7932564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932567">}</span><span class="op" id="7932568">(</span><span class="op" id="7932569">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932573">go</span>&nbsp;<span class="keyword" id="7932576">func</span><span class="op" id="7932580">(</span><span class="op" id="7932581">)</span>&nbsp;<span class="op" id="7932583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932587">c</span><span class="op" id="7932588">,</span>&nbsp;<span class="ident" id="7932590">err</span>&nbsp;<span class="op" id="7932594">:=</span>&nbsp;<span class="ident" id="7932597"><a href="/net/net_test.go.html#7932412">ln</a></span><span class="op" id="7932599">.</span><span class="ident" id="7932600">Accept</span><span class="op" id="7932606">(</span><span class="op" id="7932607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932611">if</span>&nbsp;<span class="ident" id="7932614"><a href="/net/net_test.go.html#7932590">err</a></span>&nbsp;<span class="op" id="7932618">!=</span>&nbsp;<span class="ident" id="7932621">nil</span>&nbsp;<span class="op" id="7932625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932630"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932631">.</span><span class="ident" id="7932632">Errorf</span><span class="op" id="7932638">(</span><span class="string" id="7932639">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7932651">,</span>&nbsp;<span class="ident" id="7932653"><a href="/net/net_test.go.html#7932590">err</a></span><span class="op" id="7932656">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932674">var</span>&nbsp;<span class="ident" id="7932678">buf</span>&nbsp;<span class="op" id="7932682">[</span><span class="num" id="7932683">10</span><span class="op" id="7932685">]</span><span class="builtintype" id="7932686">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932693">n</span><span class="op" id="7932694">,</span>&nbsp;<span class="ident" id="7932696"><a href="/net/net_test.go.html#7932590">err</a></span>&nbsp;<span class="op" id="7932700">:=</span>&nbsp;<span class="ident" id="7932703"><a href="/net/net_test.go.html#7932587">c</a></span><span class="op" id="7932704">.</span><span class="ident" id="7932705">Read</span><span class="op" id="7932709">(</span><span class="ident" id="7932710"><a href="/net/net_test.go.html#7932678">buf</a></span><span class="op" id="7932713">[</span><span class="op" id="7932714">:</span><span class="op" id="7932715">]</span><span class="op" id="7932716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932720">if</span>&nbsp;<span class="ident" id="7932723"><a href="/net/net_test.go.html#7932693">n</a></span>&nbsp;<span class="op" id="7932725">!=</span>&nbsp;<span class="num" id="7932728">0</span>&nbsp;<span class="op" id="7932730">||</span>&nbsp;<span class="ident" id="7932733"><a href="/net/net_test.go.html#7932590">err</a></span>&nbsp;<span class="op" id="7932737">!=</span>&nbsp;<span class="ident" id="7932740"><a href="/net/net_test.go.html#7931058">io</a></span><span class="op" id="7932742">.</span><span class="ident" id="7932743">EOF</span>&nbsp;<span class="op" id="7932747">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932752"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932753">.</span><span class="ident" id="7932754">Errorf</span><span class="op" id="7932760">(</span><span class="string" id="7932761">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7932799">,</span>&nbsp;<span class="ident" id="7932801"><a href="/net/net_test.go.html#7932693">n</a></span><span class="op" id="7932802">,</span>&nbsp;<span class="ident" id="7932804"><a href="/net/net_test.go.html#7932590">err</a></span><span class="op" id="7932807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932825"><a href="/net/net_test.go.html#7932587">c</a></span><span class="op" id="7932826">.</span><span class="ident" id="7932827">Write</span><span class="op" id="7932832">(</span><span class="op" id="7932833">[</span><span class="op" id="7932834">]</span><span class="builtintype" id="7932835">byte</span><span class="op" id="7932839">(</span><span class="string" id="7932840">&#34;response&#34;</span><span class="op" id="7932850">)</span><span class="op" id="7932851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932855"><a href="/net/net_test.go.html#7932587">c</a></span><span class="op" id="7932856">.</span><span class="ident" id="7932857">Close</span><span class="op" id="7932862">(</span><span class="op" id="7932863">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932866">}</span><span class="op" id="7932867">(</span><span class="op" id="7932868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932872">c</span><span class="op" id="7932873">,</span>&nbsp;<span class="ident" id="7932875"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932879">:=</span>&nbsp;<span class="ident" id="7932882"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7932886">(</span><span class="string" id="7932887">&#34;unix&#34;</span><span class="op" id="7932893">,</span>&nbsp;<span class="ident" id="7932895"><a href="/net/net_test.go.html#7932371">tmpname</a></span><span class="op" id="7932902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932905">if</span>&nbsp;<span class="ident" id="7932908"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932912">!=</span>&nbsp;<span class="ident" id="7932915">nil</span>&nbsp;<span class="op" id="7932919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932923"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7932924">.</span><span class="ident" id="7932925">Fatalf</span><span class="op" id="7932931">(</span><span class="string" id="7932932">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7932942">,</span>&nbsp;<span class="ident" id="7932944"><a href="/net/net_test.go.html#7932261">err</a></span><span class="op" id="7932947">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932953">defer</span>&nbsp;<span class="ident" id="7932959"><a href="/net/net_test.go.html#7932872">c</a></span><span class="op" id="7932960">.</span><span class="ident" id="7932961">Close</span><span class="op" id="7932966">(</span><span class="op" id="7932967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932971"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7932975">=</span>&nbsp;<span class="ident" id="7932977"><a href="/net/net_test.go.html#7932872">c</a></span><span class="op" id="7932978">.</span><span class="op" id="7932979">(</span><span class="op" id="7932980">*</span><span class="ident" id="7932981"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="7932989">)</span><span class="op" id="7932990">.</span><span class="ident" id="7932991">CloseWrite</span><span class="op" id="7933001">(</span><span class="op" id="7933002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933005">if</span>&nbsp;<span class="ident" id="7933008"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7933012">!=</span>&nbsp;<span class="ident" id="7933015">nil</span>&nbsp;<span class="op" id="7933019">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933023"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7933024">.</span><span class="ident" id="7933025">Fatalf</span><span class="op" id="7933031">(</span><span class="string" id="7933032">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7933048">,</span>&nbsp;<span class="ident" id="7933050"><a href="/net/net_test.go.html#7932261">err</a></span><span class="op" id="7933053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933059">var</span>&nbsp;<span class="ident" id="7933063">buf</span>&nbsp;<span class="op" id="7933067">[</span><span class="num" id="7933068">10</span><span class="op" id="7933070">]</span><span class="builtintype" id="7933071">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933077">n</span><span class="op" id="7933078">,</span>&nbsp;<span class="ident" id="7933080"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7933084">:=</span>&nbsp;<span class="ident" id="7933087"><a href="/net/net_test.go.html#7932872">c</a></span><span class="op" id="7933088">.</span><span class="ident" id="7933089">Read</span><span class="op" id="7933093">(</span><span class="ident" id="7933094"><a href="/net/net_test.go.html#7933063">buf</a></span><span class="op" id="7933097">[</span><span class="op" id="7933098">:</span><span class="op" id="7933099">]</span><span class="op" id="7933100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933103">if</span>&nbsp;<span class="ident" id="7933106"><a href="/net/net_test.go.html#7932261">err</a></span>&nbsp;<span class="op" id="7933110">!=</span>&nbsp;<span class="ident" id="7933113">nil</span>&nbsp;<span class="op" id="7933117">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933121"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7933122">.</span><span class="ident" id="7933123">Fatalf</span><span class="op" id="7933129">(</span><span class="string" id="7933130">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7933151">,</span>&nbsp;<span class="ident" id="7933153"><a href="/net/net_test.go.html#7933077">n</a></span><span class="op" id="7933154">,</span>&nbsp;<span class="ident" id="7933156"><a href="/net/net_test.go.html#7932261">err</a></span><span class="op" id="7933159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933165">got</span>&nbsp;<span class="op" id="7933169">:=</span>&nbsp;<span class="builtintype" id="7933172">string</span><span class="op" id="7933178">(</span><span class="ident" id="7933179"><a href="/net/net_test.go.html#7933063">buf</a></span><span class="op" id="7933182">[</span><span class="op" id="7933183">:</span><span class="ident" id="7933184"><a href="/net/net_test.go.html#7933077">n</a></span><span class="op" id="7933185">]</span><span class="op" id="7933186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933189">if</span>&nbsp;<span class="ident" id="7933192"><a href="/net/net_test.go.html#7933165">got</a></span>&nbsp;<span class="op" id="7933196">!=</span>&nbsp;<span class="string" id="7933199">&#34;response&#34;</span>&nbsp;<span class="op" id="7933210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933214"><a href="/net/net_test.go.html#7932134">t</a></span><span class="op" id="7933215">.</span><span class="ident" id="7933216">Errorf</span><span class="op" id="7933222">(</span><span class="string" id="7933223">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7933253">,</span>&nbsp;<span class="ident" id="7933255"><a href="/net/net_test.go.html#7933165">got</a></span><span class="op" id="7933258">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933261">}</span><br>
<span class="lineno"></span><span class="op" id="7933263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7933266">func</span>&nbsp;<span class="ident" id="7933271">TestTCPListenClose</span><span class="op" id="7933289">(</span><span class="ident" id="7933290">t</span>&nbsp;<span class="op" id="7933292">*</span><span class="ident" id="7933293"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7933300">.</span><span class="ident" id="7933301">T</span><span class="op" id="7933302">)</span>&nbsp;<span class="op" id="7933304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933307">ln</span><span class="op" id="7933309">,</span>&nbsp;<span class="ident" id="7933311">err</span>&nbsp;<span class="op" id="7933315">:=</span>&nbsp;<span class="ident" id="7933318"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7933324">(</span><span class="string" id="7933325">&#34;tcp&#34;</span><span class="op" id="7933330">,</span>&nbsp;<span class="string" id="7933332">&#34;127.0.0.1:0&#34;</span><span class="op" id="7933345">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933348">if</span>&nbsp;<span class="ident" id="7933351"><a href="/net/net_test.go.html#7933311">err</a></span>&nbsp;<span class="op" id="7933355">!=</span>&nbsp;<span class="ident" id="7933358">nil</span>&nbsp;<span class="op" id="7933362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933366"><a href="/net/net_test.go.html#7933290">t</a></span><span class="op" id="7933367">.</span><span class="ident" id="7933368">Fatalf</span><span class="op" id="7933374">(</span><span class="string" id="7933375">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7933394">,</span>&nbsp;<span class="ident" id="7933396"><a href="/net/net_test.go.html#7933311">err</a></span><span class="op" id="7933399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933406">done</span>&nbsp;<span class="op" id="7933411">:=</span>&nbsp;<span class="builtinfunc" id="7933414">make</span><span class="op" id="7933418">(</span><span class="keyword" id="7933419">chan</span>&nbsp;<span class="builtintype" id="7933424">bool</span><span class="op" id="7933428">,</span>&nbsp;<span class="num" id="7933430">1</span><span class="op" id="7933431">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933434">go</span>&nbsp;<span class="keyword" id="7933437">func</span><span class="op" id="7933441">(</span><span class="op" id="7933442">)</span>&nbsp;<span class="op" id="7933444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933448"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7933452">.</span><span class="ident" id="7933453">Sleep</span><span class="op" id="7933458">(</span><span class="num" id="7933459">100</span>&nbsp;<span class="op" id="7933463">*</span>&nbsp;<span class="ident" id="7933465"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7933469">.</span><span class="ident" id="7933470">Millisecond</span><span class="op" id="7933481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933485"><a href="/net/net_test.go.html#7933307">ln</a></span><span class="op" id="7933487">.</span><span class="ident" id="7933488">Close</span><span class="op" id="7933493">(</span><span class="op" id="7933494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933497">}</span><span class="op" id="7933498">(</span><span class="op" id="7933499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933502">go</span>&nbsp;<span class="keyword" id="7933505">func</span><span class="op" id="7933509">(</span><span class="op" id="7933510">)</span>&nbsp;<span class="op" id="7933512">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933516">c</span><span class="op" id="7933517">,</span>&nbsp;<span class="ident" id="7933519">err</span>&nbsp;<span class="op" id="7933523">:=</span>&nbsp;<span class="ident" id="7933526"><a href="/net/net_test.go.html#7933307">ln</a></span><span class="op" id="7933528">.</span><span class="ident" id="7933529">Accept</span><span class="op" id="7933535">(</span><span class="op" id="7933536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933540">if</span>&nbsp;<span class="ident" id="7933543"><a href="/net/net_test.go.html#7933519">err</a></span>&nbsp;<span class="op" id="7933547">==</span>&nbsp;<span class="ident" id="7933550">nil</span>&nbsp;<span class="op" id="7933554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933559"><a href="/net/net_test.go.html#7933516">c</a></span><span class="op" id="7933560">.</span><span class="ident" id="7933561">Close</span><span class="op" id="7933566">(</span><span class="op" id="7933567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933572"><a href="/net/net_test.go.html#7933290">t</a></span><span class="op" id="7933573">.</span><span class="ident" id="7933574">Error</span><span class="op" id="7933579">(</span><span class="string" id="7933580">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="7933598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933602">}</span>&nbsp;<span class="keyword" id="7933604">else</span>&nbsp;<span class="op" id="7933609">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933614"><a href="/net/net_test.go.html#7933290">t</a></span><span class="op" id="7933615">.</span><span class="ident" id="7933616">Logf</span><span class="op" id="7933620">(</span><span class="string" id="7933621">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7933667">,</span>&nbsp;<span class="ident" id="7933669"><a href="/net/net_test.go.html#7933519">err</a></span><span class="op" id="7933672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933680"><a href="/net/net_test.go.html#7933406">done</a></span>&nbsp;<span class="op" id="7933685">&lt;-</span>&nbsp;<span class="builtintype" id="7933688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933694">}</span><span class="op" id="7933695">(</span><span class="op" id="7933696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933699">select</span>&nbsp;<span class="op" id="7933706">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933709">case</span>&nbsp;<span class="op" id="7933714">&lt;-</span><span class="ident" id="7933716"><a href="/net/net_test.go.html#7933406">done</a></span><span class="op" id="7933720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933723">case</span>&nbsp;<span class="op" id="7933728">&lt;-</span><span class="ident" id="7933730"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7933734">.</span><span class="ident" id="7933735">After</span><span class="op" id="7933740">(</span><span class="num" id="7933741">2</span>&nbsp;<span class="op" id="7933743">*</span>&nbsp;<span class="ident" id="7933745"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7933749">.</span><span class="ident" id="7933750">Second</span><span class="op" id="7933756">)</span><span class="op" id="7933757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933761"><a href="/net/net_test.go.html#7933290">t</a></span><span class="op" id="7933762">.</span><span class="ident" id="7933763">Fatal</span><span class="op" id="7933768">(</span><span class="string" id="7933769">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="7933800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933803">}</span><br>
<span class="lineno"></span><span class="op" id="7933805">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="7933808">func</span>&nbsp;<span class="ident" id="7933813">TestUDPListenClose</span><span class="op" id="7933831">(</span><span class="ident" id="7933832">t</span>&nbsp;<span class="op" id="7933834">*</span><span class="ident" id="7933835"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7933842">.</span><span class="ident" id="7933843">T</span><span class="op" id="7933844">)</span>&nbsp;<span class="op" id="7933846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933849">switch</span>&nbsp;<span class="ident" id="7933856"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7933863">.</span><span class="ident" id="7933864">GOOS</span>&nbsp;<span class="op" id="7933869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933872">case</span>&nbsp;<span class="string" id="7933877">&#34;plan9&#34;</span><span class="op" id="7933884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933888"><a href="/net/net_test.go.html#7933832">t</a></span><span class="op" id="7933889">.</span><span class="ident" id="7933890">Skipf</span><span class="op" id="7933895">(</span><span class="string" id="7933896">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7933917">,</span>&nbsp;<span class="ident" id="7933919"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7933926">.</span><span class="ident" id="7933927">GOOS</span><span class="op" id="7933931">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933937">ln</span><span class="op" id="7933939">,</span>&nbsp;<span class="ident" id="7933941">err</span>&nbsp;<span class="op" id="7933945">:=</span>&nbsp;<span class="ident" id="7933948"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="7933960">(</span><span class="string" id="7933961">&#34;udp&#34;</span><span class="op" id="7933966">,</span>&nbsp;<span class="string" id="7933968">&#34;127.0.0.1:0&#34;</span><span class="op" id="7933981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933984">if</span>&nbsp;<span class="ident" id="7933987"><a href="/net/net_test.go.html#7933941">err</a></span>&nbsp;<span class="op" id="7933991">!=</span>&nbsp;<span class="ident" id="7933994">nil</span>&nbsp;<span class="op" id="7933998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934002"><a href="/net/net_test.go.html#7933832">t</a></span><span class="op" id="7934003">.</span><span class="ident" id="7934004">Fatalf</span><span class="op" id="7934010">(</span><span class="string" id="7934011">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7934030">,</span>&nbsp;<span class="ident" id="7934032"><a href="/net/net_test.go.html#7933941">err</a></span><span class="op" id="7934035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934038">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934042">buf</span>&nbsp;<span class="op" id="7934046">:=</span>&nbsp;<span class="builtinfunc" id="7934049">make</span><span class="op" id="7934053">(</span><span class="op" id="7934054">[</span><span class="op" id="7934055">]</span><span class="builtintype" id="7934056">byte</span><span class="op" id="7934060">,</span>&nbsp;<span class="num" id="7934062">1000</span><span class="op" id="7934066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934069">done</span>&nbsp;<span class="op" id="7934074">:=</span>&nbsp;<span class="builtinfunc" id="7934077">make</span><span class="op" id="7934081">(</span><span class="keyword" id="7934082">chan</span>&nbsp;<span class="builtintype" id="7934087">bool</span><span class="op" id="7934091">,</span>&nbsp;<span class="num" id="7934093">1</span><span class="op" id="7934094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934097">go</span>&nbsp;<span class="keyword" id="7934100">func</span><span class="op" id="7934104">(</span><span class="op" id="7934105">)</span>&nbsp;<span class="op" id="7934107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934111"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934115">.</span><span class="ident" id="7934116">Sleep</span><span class="op" id="7934121">(</span><span class="num" id="7934122">100</span>&nbsp;<span class="op" id="7934126">*</span>&nbsp;<span class="ident" id="7934128"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934132">.</span><span class="ident" id="7934133">Millisecond</span><span class="op" id="7934144">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934148"><a href="/net/net_test.go.html#7933937">ln</a></span><span class="op" id="7934150">.</span><span class="ident" id="7934151">Close</span><span class="op" id="7934156">(</span><span class="op" id="7934157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934160">}</span><span class="op" id="7934161">(</span><span class="op" id="7934162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934165">go</span>&nbsp;<span class="keyword" id="7934168">func</span><span class="op" id="7934172">(</span><span class="op" id="7934173">)</span>&nbsp;<span class="op" id="7934175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934179">_</span><span class="op" id="7934180">,</span>&nbsp;<span class="ident" id="7934182">_</span><span class="op" id="7934183">,</span>&nbsp;<span class="ident" id="7934185"><a href="/net/net_test.go.html#7933941">err</a></span>&nbsp;<span class="op" id="7934189">=</span>&nbsp;<span class="ident" id="7934191"><a href="/net/net_test.go.html#7933937">ln</a></span><span class="op" id="7934193">.</span><span class="ident" id="7934194">ReadFrom</span><span class="op" id="7934202">(</span><span class="ident" id="7934203"><a href="/net/net_test.go.html#7934042">buf</a></span><span class="op" id="7934206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934210">if</span>&nbsp;<span class="ident" id="7934213"><a href="/net/net_test.go.html#7933941">err</a></span>&nbsp;<span class="op" id="7934217">==</span>&nbsp;<span class="ident" id="7934220">nil</span>&nbsp;<span class="op" id="7934224">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934229"><a href="/net/net_test.go.html#7933832">t</a></span><span class="op" id="7934230">.</span><span class="ident" id="7934231">Error</span><span class="op" id="7934236">(</span><span class="string" id="7934237">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="7934257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934261">}</span>&nbsp;<span class="keyword" id="7934263">else</span>&nbsp;<span class="op" id="7934268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934273"><a href="/net/net_test.go.html#7933832">t</a></span><span class="op" id="7934274">.</span><span class="ident" id="7934275">Logf</span><span class="op" id="7934279">(</span><span class="string" id="7934280">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7934328">,</span>&nbsp;<span class="ident" id="7934330"><a href="/net/net_test.go.html#7933941">err</a></span><span class="op" id="7934333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934341"><a href="/net/net_test.go.html#7934069">done</a></span>&nbsp;<span class="op" id="7934346">&lt;-</span>&nbsp;<span class="builtintype" id="7934349">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934355">}</span><span class="op" id="7934356">(</span><span class="op" id="7934357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934360">select</span>&nbsp;<span class="op" id="7934367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934370">case</span>&nbsp;<span class="op" id="7934375">&lt;-</span><span class="ident" id="7934377"><a href="/net/net_test.go.html#7934069">done</a></span><span class="op" id="7934381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934384">case</span>&nbsp;<span class="op" id="7934389">&lt;-</span><span class="ident" id="7934391"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934395">.</span><span class="ident" id="7934396">After</span><span class="op" id="7934401">(</span><span class="num" id="7934402">2</span>&nbsp;<span class="op" id="7934404">*</span>&nbsp;<span class="ident" id="7934406"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934410">.</span><span class="ident" id="7934411">Second</span><span class="op" id="7934417">)</span><span class="op" id="7934418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934422"><a href="/net/net_test.go.html#7933832">t</a></span><span class="op" id="7934423">.</span><span class="ident" id="7934424">Fatal</span><span class="op" id="7934429">(</span><span class="string" id="7934430">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="7934461">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934464">}</span><br>
<span class="lineno"></span><span class="op" id="7934466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7934469">func</span>&nbsp;<span class="ident" id="7934474">TestTCPClose</span><span class="op" id="7934486">(</span><span class="ident" id="7934487">t</span>&nbsp;<span class="op" id="7934489">*</span><span class="ident" id="7934490"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7934497">.</span><span class="ident" id="7934498">T</span><span class="op" id="7934499">)</span>&nbsp;<span class="op" id="7934501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934504">switch</span>&nbsp;<span class="ident" id="7934511"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7934518">.</span><span class="ident" id="7934519">GOOS</span>&nbsp;<span class="op" id="7934524">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934527">case</span>&nbsp;<span class="string" id="7934532">&#34;plan9&#34;</span><span class="op" id="7934539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934543"><a href="/net/net_test.go.html#7934487">t</a></span><span class="op" id="7934544">.</span><span class="ident" id="7934545">Skipf</span><span class="op" id="7934550">(</span><span class="string" id="7934551">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7934572">,</span>&nbsp;<span class="ident" id="7934574"><a href="/net/net_test.go.html#7931083">runtime</a></span><span class="op" id="7934581">.</span><span class="ident" id="7934582">GOOS</span><span class="op" id="7934586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934592">l</span><span class="op" id="7934593">,</span>&nbsp;<span class="ident" id="7934595">err</span>&nbsp;<span class="op" id="7934599">:=</span>&nbsp;<span class="ident" id="7934602"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7934608">(</span><span class="string" id="7934609">&#34;tcp&#34;</span><span class="op" id="7934614">,</span>&nbsp;<span class="string" id="7934616">&#34;127.0.0.1:0&#34;</span><span class="op" id="7934629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934632">if</span>&nbsp;<span class="ident" id="7934635"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7934639">!=</span>&nbsp;<span class="ident" id="7934642">nil</span>&nbsp;<span class="op" id="7934646">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934650"><a href="/net/net_test.go.html#7934487">t</a></span><span class="op" id="7934651">.</span><span class="ident" id="7934652">Fatal</span><span class="op" id="7934657">(</span><span class="ident" id="7934658"><a href="/net/net_test.go.html#7934595">err</a></span><span class="op" id="7934661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934667">defer</span>&nbsp;<span class="ident" id="7934673"><a href="/net/net_test.go.html#7934592">l</a></span><span class="op" id="7934674">.</span><span class="ident" id="7934675">Close</span><span class="op" id="7934680">(</span><span class="op" id="7934681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934685">read</span>&nbsp;<span class="op" id="7934690">:=</span>&nbsp;<span class="keyword" id="7934693">func</span><span class="op" id="7934697">(</span><span class="ident" id="7934698">r</span>&nbsp;<span class="ident" id="7934700"><a href="/net/net_test.go.html#7931058">io</a></span><span class="op" id="7934702">.</span><span class="ident" id="7934703">Reader</span><span class="op" id="7934709">)</span>&nbsp;<span class="builtintype" id="7934711">error</span>&nbsp;<span class="op" id="7934717">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934721">var</span>&nbsp;<span class="ident" id="7934725">m</span>&nbsp;<span class="op" id="7934727">[</span><span class="num" id="7934728">1</span><span class="op" id="7934729">]</span><span class="builtintype" id="7934730">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934737">_</span><span class="op" id="7934738">,</span>&nbsp;<span class="ident" id="7934740">err</span>&nbsp;<span class="op" id="7934744">:=</span>&nbsp;<span class="ident" id="7934747"><a href="/net/net_test.go.html#7934698">r</a></span><span class="op" id="7934748">.</span><span class="ident" id="7934749">Read</span><span class="op" id="7934753">(</span><span class="ident" id="7934754"><a href="/net/net_test.go.html#7934725">m</a></span><span class="op" id="7934755">[</span><span class="op" id="7934756">:</span><span class="op" id="7934757">]</span><span class="op" id="7934758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934762">return</span>&nbsp;<span class="ident" id="7934769"><a href="/net/net_test.go.html#7934740">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934778">go</span>&nbsp;<span class="keyword" id="7934781">func</span><span class="op" id="7934785">(</span><span class="op" id="7934786">)</span>&nbsp;<span class="op" id="7934788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934792">c</span><span class="op" id="7934793">,</span>&nbsp;<span class="ident" id="7934795">err</span>&nbsp;<span class="op" id="7934799">:=</span>&nbsp;<span class="ident" id="7934802"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7934806">(</span><span class="string" id="7934807">&#34;tcp&#34;</span><span class="op" id="7934812">,</span>&nbsp;<span class="ident" id="7934814"><a href="/net/net_test.go.html#7934592">l</a></span><span class="op" id="7934815">.</span><span class="ident" id="7934816">Addr</span><span class="op" id="7934820">(</span><span class="op" id="7934821">)</span><span class="op" id="7934822">.</span><span class="ident" id="7934823">String</span><span class="op" id="7934829">(</span><span class="op" id="7934830">)</span><span class="op" id="7934831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934835">if</span>&nbsp;<span class="ident" id="7934838"><a href="/net/net_test.go.html#7934795">err</a></span>&nbsp;<span class="op" id="7934842">!=</span>&nbsp;<span class="ident" id="7934845">nil</span>&nbsp;<span class="op" id="7934849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934854"><a href="/net/net_test.go.html#7934487">t</a></span><span class="op" id="7934855">.</span><span class="ident" id="7934856">Errorf</span><span class="op" id="7934862">(</span><span class="string" id="7934863">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7934873">,</span>&nbsp;<span class="ident" id="7934875"><a href="/net/net_test.go.html#7934795">err</a></span><span class="op" id="7934878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934883">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934897">go</span>&nbsp;<span class="ident" id="7934900"><a href="/net/net_test.go.html#7934685">read</a></span><span class="op" id="7934904">(</span><span class="ident" id="7934905"><a href="/net/net_test.go.html#7934792">c</a></span><span class="op" id="7934906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934911"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934915">.</span><span class="ident" id="7934916">Sleep</span><span class="op" id="7934921">(</span><span class="num" id="7934922">10</span>&nbsp;<span class="op" id="7934925">*</span>&nbsp;<span class="ident" id="7934927"><a href="/net/net_test.go.html#7931105">time</a></span><span class="op" id="7934931">.</span><span class="ident" id="7934932">Millisecond</span><span class="op" id="7934943">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934947"><a href="/net/net_test.go.html#7934792">c</a></span><span class="op" id="7934948">.</span><span class="ident" id="7934949">Close</span><span class="op" id="7934954">(</span><span class="op" id="7934955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934958">}</span><span class="op" id="7934959">(</span><span class="op" id="7934960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934964">c</span><span class="op" id="7934965">,</span>&nbsp;<span class="ident" id="7934967"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7934971">:=</span>&nbsp;<span class="ident" id="7934974"><a href="/net/net_test.go.html#7934592">l</a></span><span class="op" id="7934975">.</span><span class="ident" id="7934976">Accept</span><span class="op" id="7934982">(</span><span class="op" id="7934983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934986">if</span>&nbsp;<span class="ident" id="7934989"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7934993">!=</span>&nbsp;<span class="ident" id="7934996">nil</span>&nbsp;<span class="op" id="7935000">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935004"><a href="/net/net_test.go.html#7934487">t</a></span><span class="op" id="7935005">.</span><span class="ident" id="7935006">Fatal</span><span class="op" id="7935011">(</span><span class="ident" id="7935012"><a href="/net/net_test.go.html#7934595">err</a></span><span class="op" id="7935015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935021">defer</span>&nbsp;<span class="ident" id="7935027"><a href="/net/net_test.go.html#7934964">c</a></span><span class="op" id="7935028">.</span><span class="ident" id="7935029">Close</span><span class="op" id="7935034">(</span><span class="op" id="7935035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935039">for</span>&nbsp;<span class="ident" id="7935043"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7935047">==</span>&nbsp;<span class="ident" id="7935050">nil</span>&nbsp;<span class="op" id="7935054">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935058"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7935062">=</span>&nbsp;<span class="ident" id="7935064"><a href="/net/net_test.go.html#7934685">read</a></span><span class="op" id="7935068">(</span><span class="ident" id="7935069"><a href="/net/net_test.go.html#7934964">c</a></span><span class="op" id="7935070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935076">if</span>&nbsp;<span class="ident" id="7935079"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7935083">!=</span>&nbsp;<span class="ident" id="7935086">nil</span>&nbsp;<span class="op" id="7935090">&amp;&amp;</span>&nbsp;<span class="ident" id="7935093"><a href="/net/net_test.go.html#7934595">err</a></span>&nbsp;<span class="op" id="7935097">!=</span>&nbsp;<span class="ident" id="7935100"><a href="/net/net_test.go.html#7931058">io</a></span><span class="op" id="7935102">.</span><span class="ident" id="7935103">EOF</span>&nbsp;<span class="op" id="7935107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935111"><a href="/net/net_test.go.html#7934487">t</a></span><span class="op" id="7935112">.</span><span class="ident" id="7935113">Fatal</span><span class="op" id="7935118">(</span><span class="ident" id="7935119"><a href="/net/net_test.go.html#7934595">err</a></span><span class="op" id="7935122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935125">}</span><br>
<span class="lineno">225</span><span class="op" id="7935127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7935130">func</span>&nbsp;<span class="ident" id="7935135">TestErrorNil</span><span class="op" id="7935147">(</span><span class="ident" id="7935148">t</span>&nbsp;<span class="op" id="7935150">*</span><span class="ident" id="7935151"><a href="/net/net_test.go.html#7931094">testing</a></span><span class="op" id="7935158">.</span><span class="ident" id="7935159">T</span><span class="op" id="7935160">)</span>&nbsp;<span class="op" id="7935162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935165">c</span><span class="op" id="7935166">,</span>&nbsp;<span class="ident" id="7935168">err</span>&nbsp;<span class="op" id="7935172">:=</span>&nbsp;<span class="ident" id="7935175"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7935179">(</span><span class="string" id="7935180">&#34;tcp&#34;</span><span class="op" id="7935185">,</span>&nbsp;<span class="string" id="7935187">&#34;127.0.0.1:65535&#34;</span><span class="op" id="7935204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935207">if</span>&nbsp;<span class="ident" id="7935210"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935214">==</span>&nbsp;<span class="ident" id="7935217">nil</span>&nbsp;<span class="op" id="7935221">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935225"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935226">.</span><span class="ident" id="7935227">Fatal</span><span class="op" id="7935232">(</span><span class="string" id="7935233">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="7935265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935271">if</span>&nbsp;<span class="ident" id="7935274"><a href="/net/net_test.go.html#7935165">c</a></span>&nbsp;<span class="op" id="7935276">!=</span>&nbsp;<span class="ident" id="7935279">nil</span>&nbsp;<span class="op" id="7935283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935287"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935288">.</span><span class="ident" id="7935289">Fatalf</span><span class="op" id="7935295">(</span><span class="string" id="7935296">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7935352">,</span>&nbsp;<span class="ident" id="7935354"><a href="/net/net_test.go.html#7935165">c</a></span><span class="op" id="7935355">,</span>&nbsp;<span class="ident" id="7935357"><a href="/net/net_test.go.html#7935165">c</a></span><span class="op" id="7935358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935361">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7935365">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935422">l</span><span class="op" id="7935423">,</span>&nbsp;<span class="ident" id="7935425"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935429">:=</span>&nbsp;<span class="ident" id="7935432"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7935438">(</span><span class="string" id="7935439">&#34;tcp&#34;</span><span class="op" id="7935444">,</span>&nbsp;<span class="string" id="7935446">&#34;127.0.0.1:0&#34;</span><span class="op" id="7935459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935462">if</span>&nbsp;<span class="ident" id="7935465"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935469">!=</span>&nbsp;<span class="ident" id="7935472">nil</span>&nbsp;<span class="op" id="7935476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935480"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935481">.</span><span class="ident" id="7935482">Fatalf</span><span class="op" id="7935488">(</span><span class="string" id="7935489">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7935513">,</span>&nbsp;<span class="ident" id="7935515"><a href="/net/net_test.go.html#7935168">err</a></span><span class="op" id="7935518">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935524">defer</span>&nbsp;<span class="ident" id="7935530"><a href="/net/net_test.go.html#7935422">l</a></span><span class="op" id="7935531">.</span><span class="ident" id="7935532">Close</span><span class="op" id="7935537">(</span><span class="op" id="7935538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935541">l1</span><span class="op" id="7935543">,</span>&nbsp;<span class="ident" id="7935545"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935549">:=</span>&nbsp;<span class="ident" id="7935552"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="7935558">(</span><span class="string" id="7935559">&#34;tcp&#34;</span><span class="op" id="7935564">,</span>&nbsp;<span class="ident" id="7935566"><a href="/net/net_test.go.html#7935422">l</a></span><span class="op" id="7935567">.</span><span class="ident" id="7935568">Addr</span><span class="op" id="7935572">(</span><span class="op" id="7935573">)</span><span class="op" id="7935574">.</span><span class="ident" id="7935575">String</span><span class="op" id="7935581">(</span><span class="op" id="7935582">)</span><span class="op" id="7935583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935586">if</span>&nbsp;<span class="ident" id="7935589"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935593">==</span>&nbsp;<span class="ident" id="7935596">nil</span>&nbsp;<span class="op" id="7935600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935604"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935605">.</span><span class="ident" id="7935606">Fatalf</span><span class="op" id="7935612">(</span><span class="string" id="7935613">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7935635">,</span>&nbsp;<span class="ident" id="7935637"><a href="/net/net_test.go.html#7935422">l</a></span><span class="op" id="7935638">.</span><span class="ident" id="7935639">Addr</span><span class="op" id="7935643">(</span><span class="op" id="7935644">)</span><span class="op" id="7935645">,</span>&nbsp;<span class="ident" id="7935647"><a href="/net/net_test.go.html#7935168">err</a></span><span class="op" id="7935650">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935656">if</span>&nbsp;<span class="ident" id="7935659"><a href="/net/net_test.go.html#7935541">l1</a></span>&nbsp;<span class="op" id="7935662">!=</span>&nbsp;<span class="ident" id="7935665">nil</span>&nbsp;<span class="op" id="7935669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935673"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935674">.</span><span class="ident" id="7935675">Fatalf</span><span class="op" id="7935681">(</span><span class="string" id="7935682">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7935740">,</span>&nbsp;<span class="ident" id="7935742"><a href="/net/net_test.go.html#7935541">l1</a></span><span class="op" id="7935744">,</span>&nbsp;<span class="ident" id="7935746"><a href="/net/net_test.go.html#7935541">l1</a></span><span class="op" id="7935748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7935755">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935818">lp</span><span class="op" id="7935820">,</span>&nbsp;<span class="ident" id="7935822"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935826">:=</span>&nbsp;<span class="ident" id="7935829"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="7935841">(</span><span class="string" id="7935842">&#34;udp&#34;</span><span class="op" id="7935847">,</span>&nbsp;<span class="string" id="7935849">&#34;127.0.0.1:0&#34;</span><span class="op" id="7935862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935865">if</span>&nbsp;<span class="ident" id="7935868"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935872">!=</span>&nbsp;<span class="ident" id="7935875">nil</span>&nbsp;<span class="op" id="7935879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935883"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7935884">.</span><span class="ident" id="7935885">Fatalf</span><span class="op" id="7935891">(</span><span class="string" id="7935892">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7935916">,</span>&nbsp;<span class="ident" id="7935918"><a href="/net/net_test.go.html#7935168">err</a></span><span class="op" id="7935921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935924">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935927">defer</span>&nbsp;<span class="ident" id="7935933"><a href="/net/net_test.go.html#7935818">lp</a></span><span class="op" id="7935935">.</span><span class="ident" id="7935936">Close</span><span class="op" id="7935941">(</span><span class="op" id="7935942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935945">lp1</span><span class="op" id="7935948">,</span>&nbsp;<span class="ident" id="7935950"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7935954">:=</span>&nbsp;<span class="ident" id="7935957"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="7935969">(</span><span class="string" id="7935970">&#34;udp&#34;</span><span class="op" id="7935975">,</span>&nbsp;<span class="ident" id="7935977"><a href="/net/net_test.go.html#7935818">lp</a></span><span class="op" id="7935979">.</span><span class="ident" id="7935980">LocalAddr</span><span class="op" id="7935989">(</span><span class="op" id="7935990">)</span><span class="op" id="7935991">.</span><span class="ident" id="7935992">String</span><span class="op" id="7935998">(</span><span class="op" id="7935999">)</span><span class="op" id="7936000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936003">if</span>&nbsp;<span class="ident" id="7936006"><a href="/net/net_test.go.html#7935168">err</a></span>&nbsp;<span class="op" id="7936010">==</span>&nbsp;<span class="ident" id="7936013">nil</span>&nbsp;<span class="op" id="7936017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936021"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7936022">.</span><span class="ident" id="7936023">Fatalf</span><span class="op" id="7936029">(</span><span class="string" id="7936030">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7936052">,</span>&nbsp;<span class="ident" id="7936054"><a href="/net/net_test.go.html#7935818">lp</a></span><span class="op" id="7936056">.</span><span class="ident" id="7936057">LocalAddr</span><span class="op" id="7936066">(</span><span class="op" id="7936067">)</span><span class="op" id="7936068">,</span>&nbsp;<span class="ident" id="7936070"><a href="/net/net_test.go.html#7935168">err</a></span><span class="op" id="7936073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936076">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936079">if</span>&nbsp;<span class="ident" id="7936082"><a href="/net/net_test.go.html#7935945">lp1</a></span>&nbsp;<span class="op" id="7936086">!=</span>&nbsp;<span class="ident" id="7936089">nil</span>&nbsp;<span class="op" id="7936093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936097"><a href="/net/net_test.go.html#7935148">t</a></span><span class="op" id="7936098">.</span><span class="ident" id="7936099">Fatalf</span><span class="op" id="7936105">(</span><span class="string" id="7936106">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7936170">,</span>&nbsp;<span class="ident" id="7936172"><a href="/net/net_test.go.html#7935945">lp1</a></span><span class="op" id="7936175">,</span>&nbsp;<span class="ident" id="7936177"><a href="/net/net_test.go.html#7935945">lp1</a></span><span class="op" id="7936180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936183">}</span><br>
<span class="lineno"></span><span class="op" id="7936185">}</span>
</div>
</body>
</html>
