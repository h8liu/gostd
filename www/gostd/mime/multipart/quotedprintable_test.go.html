<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6783634">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6783689">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6783743">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6783794">package</span>&nbsp;<span class="ident" id="6783802">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783813">import</span>&nbsp;<span class="op" id="6783820">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783823">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783832">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783841">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783851">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783859">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783866">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783872">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783883">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783893">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783901">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783912">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6783923">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="6783930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783933">func</span>&nbsp;<span class="ident" id="6783938">TestQuotedPrintable</span><span class="op" id="6783957">(</span><span class="ident" id="6783958">t</span>&nbsp;<span class="op" id="6783960">*</span><span class="ident" id="6783961">testing</span><span class="op" id="6783968">.</span><span class="ident" id="6783969">T</span><span class="op" id="6783970">)</span>&nbsp;<span class="op" id="6783972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783975">tests</span>&nbsp;<span class="op" id="6783981">:=</span>&nbsp;<span class="op" id="6783984">[</span><span class="op" id="6783985">]</span><span class="keyword" id="6783986">struct</span>&nbsp;<span class="op" id="6783993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783997">in</span><span class="op" id="6783999">,</span>&nbsp;<span class="ident" id="6784001">want</span>&nbsp;<span class="builtintype" id="6784006">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784015">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784024">interface</span><span class="op" id="6784033">{</span><span class="op" id="6784034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784037">}</span><span class="op" id="6784038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784042">{</span><span class="ident" id="6784043">in</span><span class="op" id="6784045">:</span>&nbsp;<span class="string" id="6784047">&#34;&#34;</span><span class="op" id="6784049">,</span>&nbsp;<span class="ident" id="6784051">want</span><span class="op" id="6784055">:</span>&nbsp;<span class="string" id="6784057">&#34;&#34;</span><span class="op" id="6784059">}</span><span class="op" id="6784060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784064">{</span><span class="ident" id="6784065">in</span><span class="op" id="6784067">:</span>&nbsp;<span class="string" id="6784069">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784078">,</span>&nbsp;<span class="ident" id="6784080">want</span><span class="op" id="6784084">:</span>&nbsp;<span class="string" id="6784086">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784095">}</span><span class="op" id="6784096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784100">{</span><span class="ident" id="6784101">in</span><span class="op" id="6784103">:</span>&nbsp;<span class="string" id="6784105">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="6784117">,</span>&nbsp;<span class="ident" id="6784119">want</span><span class="op" id="6784123">:</span>&nbsp;<span class="string" id="6784125">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="6784135">}</span><span class="op" id="6784136">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784140">{</span><span class="ident" id="6784141">in</span><span class="op" id="6784143">:</span>&nbsp;<span class="string" id="6784145">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="6784157">,</span>&nbsp;<span class="ident" id="6784159">want</span><span class="op" id="6784163">:</span>&nbsp;<span class="string" id="6784165">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784174">}</span><span class="op" id="6784175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784179">{</span><span class="ident" id="6784180">in</span><span class="op" id="6784182">:</span>&nbsp;<span class="string" id="6784184">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6784195">,</span>&nbsp;<span class="ident" id="6784197">want</span><span class="op" id="6784201">:</span>&nbsp;<span class="string" id="6784203">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6784214">}</span><span class="op" id="6784215">,</span>&nbsp;<span class="comment" id="6784217">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784236">{</span><span class="ident" id="6784237">in</span><span class="op" id="6784239">:</span>&nbsp;<span class="string" id="6784241">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="6784252">,</span>&nbsp;<span class="ident" id="6784254">want</span><span class="op" id="6784258">:</span>&nbsp;<span class="string" id="6784260">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784269">,</span>&nbsp;<span class="ident" id="6784271">err</span><span class="op" id="6784274">:</span>&nbsp;<span class="ident" id="6784276">io</span><span class="op" id="6784278">.</span><span class="ident" id="6784279">ErrUnexpectedEOF</span><span class="op" id="6784295">}</span><span class="op" id="6784296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784300">{</span><span class="ident" id="6784301">in</span><span class="op" id="6784303">:</span>&nbsp;<span class="string" id="6784305">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="6784317">,</span>&nbsp;<span class="ident" id="6784319">want</span><span class="op" id="6784323">:</span>&nbsp;<span class="string" id="6784325">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784334">,</span>&nbsp;<span class="ident" id="6784336">err</span><span class="op" id="6784339">:</span>&nbsp;<span class="string" id="6784341">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="6784392">}</span><span class="op" id="6784393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784397">{</span><span class="ident" id="6784398">in</span><span class="op" id="6784400">:</span>&nbsp;<span class="string" id="6784402">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="6784417">,</span>&nbsp;<span class="ident" id="6784419">want</span><span class="op" id="6784423">:</span>&nbsp;<span class="string" id="6784425">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="6784438">}</span><span class="op" id="6784439">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784443">{</span><span class="ident" id="6784444">in</span><span class="op" id="6784446">:</span>&nbsp;<span class="string" id="6784448">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6784469">,</span>&nbsp;<span class="ident" id="6784471">want</span><span class="op" id="6784475">:</span>&nbsp;<span class="string" id="6784477">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="6784489">}</span><span class="op" id="6784490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784494">{</span><span class="ident" id="6784495">in</span><span class="op" id="6784497">:</span>&nbsp;<span class="string" id="6784499">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6784514">,</span>&nbsp;<span class="ident" id="6784516">want</span><span class="op" id="6784520">:</span>&nbsp;<span class="string" id="6784522">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6784531">}</span><span class="op" id="6784532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784536">{</span><span class="ident" id="6784537">in</span><span class="op" id="6784539">:</span>&nbsp;<span class="string" id="6784541">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6784554">,</span>&nbsp;<span class="ident" id="6784556">want</span><span class="op" id="6784560">:</span>&nbsp;<span class="string" id="6784562">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6784571">}</span><span class="op" id="6784572">,</span>&nbsp;<span class="comment" id="6784574">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784604">{</span><span class="ident" id="6784605">in</span><span class="op" id="6784607">:</span>&nbsp;<span class="string" id="6784609">&#34;foo=\nbar&#34;</span><span class="op" id="6784620">,</span>&nbsp;<span class="ident" id="6784622">want</span><span class="op" id="6784626">:</span>&nbsp;<span class="string" id="6784628">&#34;foobar&#34;</span><span class="op" id="6784636">}</span><span class="op" id="6784637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784641">{</span><span class="ident" id="6784642">in</span><span class="op" id="6784644">:</span>&nbsp;<span class="string" id="6784646">&#34;foo\x00bar&#34;</span><span class="op" id="6784658">,</span>&nbsp;<span class="ident" id="6784660">want</span><span class="op" id="6784664">:</span>&nbsp;<span class="string" id="6784666">&#34;foo&#34;</span><span class="op" id="6784671">,</span>&nbsp;<span class="ident" id="6784673">err</span><span class="op" id="6784676">:</span>&nbsp;<span class="string" id="6784678">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6784743">}</span><span class="op" id="6784744">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784748">{</span><span class="ident" id="6784749">in</span><span class="op" id="6784751">:</span>&nbsp;<span class="string" id="6784753">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="6784766">,</span>&nbsp;<span class="ident" id="6784768">want</span><span class="op" id="6784772">:</span>&nbsp;<span class="string" id="6784774">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6784783">,</span>&nbsp;<span class="ident" id="6784785">err</span><span class="op" id="6784788">:</span>&nbsp;<span class="string" id="6784790">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6784855">}</span><span class="op" id="6784856">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6784861">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784878">{</span><span class="ident" id="6784879">in</span><span class="op" id="6784881">:</span>&nbsp;<span class="string" id="6784883">&#34;=3D30\n&#34;</span><span class="op" id="6784892">,</span>&nbsp;<span class="ident" id="6784894">want</span><span class="op" id="6784898">:</span>&nbsp;<span class="string" id="6784900">&#34;=30\n&#34;</span><span class="op" id="6784907">}</span><span class="op" id="6784908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784912">{</span><span class="ident" id="6784913">in</span><span class="op" id="6784915">:</span>&nbsp;<span class="string" id="6784917">&#34;=00=FF0=\n&#34;</span><span class="op" id="6784929">,</span>&nbsp;<span class="ident" id="6784931">want</span><span class="op" id="6784935">:</span>&nbsp;<span class="string" id="6784937">&#34;\x00\xff0&#34;</span><span class="op" id="6784948">}</span><span class="op" id="6784949">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6784954">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784979">{</span><span class="ident" id="6784980">in</span><span class="op" id="6784982">:</span>&nbsp;<span class="string" id="6784984">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="6784993">,</span>&nbsp;<span class="ident" id="6784995">want</span><span class="op" id="6784999">:</span>&nbsp;<span class="string" id="6785001">&#34;foo\n&#34;</span><span class="op" id="6785008">}</span><span class="op" id="6785009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785013">{</span><span class="ident" id="6785014">in</span><span class="op" id="6785016">:</span>&nbsp;<span class="string" id="6785018">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="6785048">,</span>&nbsp;<span class="ident" id="6785050">want</span><span class="op" id="6785054">:</span>&nbsp;<span class="string" id="6785056">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="6785079">}</span><span class="op" id="6785080">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6785085">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6785160">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785225">{</span><span class="ident" id="6785226">in</span><span class="op" id="6785228">:</span>&nbsp;<span class="string" id="6785230">&#34;foo\nbar&#34;</span><span class="op" id="6785240">,</span>&nbsp;<span class="ident" id="6785242">want</span><span class="op" id="6785246">:</span>&nbsp;<span class="string" id="6785248">&#34;foo\nbar&#34;</span><span class="op" id="6785258">}</span><span class="op" id="6785259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785263">{</span><span class="ident" id="6785264">in</span><span class="op" id="6785266">:</span>&nbsp;<span class="string" id="6785268">&#34;foo\rbar&#34;</span><span class="op" id="6785278">,</span>&nbsp;<span class="ident" id="6785280">want</span><span class="op" id="6785284">:</span>&nbsp;<span class="string" id="6785286">&#34;foo\rbar&#34;</span><span class="op" id="6785296">}</span><span class="op" id="6785297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785301">{</span><span class="ident" id="6785302">in</span><span class="op" id="6785304">:</span>&nbsp;<span class="string" id="6785306">&#34;foo\r\nbar&#34;</span><span class="op" id="6785318">,</span>&nbsp;<span class="ident" id="6785320">want</span><span class="op" id="6785324">:</span>&nbsp;<span class="string" id="6785326">&#34;foo\r\nbar&#34;</span><span class="op" id="6785338">}</span><span class="op" id="6785339">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6785344">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785386">{</span><span class="ident" id="6785387">in</span><span class="op" id="6785389">:</span>&nbsp;<span class="string" id="6785391">&#34;foo=\r\nbar&#34;</span><span class="op" id="6785404">,</span>&nbsp;<span class="ident" id="6785406">want</span><span class="op" id="6785410">:</span>&nbsp;<span class="string" id="6785412">&#34;foobar&#34;</span><span class="op" id="6785420">}</span><span class="op" id="6785421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785425">{</span><span class="ident" id="6785426">in</span><span class="op" id="6785428">:</span>&nbsp;<span class="string" id="6785430">&#34;foo=\nbar&#34;</span><span class="op" id="6785441">,</span>&nbsp;<span class="ident" id="6785443">want</span><span class="op" id="6785447">:</span>&nbsp;<span class="string" id="6785449">&#34;foobar&#34;</span><span class="op" id="6785457">}</span><span class="op" id="6785458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785462">{</span><span class="ident" id="6785463">in</span><span class="op" id="6785465">:</span>&nbsp;<span class="string" id="6785467">&#34;foo=\rbar&#34;</span><span class="op" id="6785478">,</span>&nbsp;<span class="ident" id="6785480">want</span><span class="op" id="6785484">:</span>&nbsp;<span class="string" id="6785486">&#34;foo&#34;</span><span class="op" id="6785491">,</span>&nbsp;<span class="ident" id="6785493">err</span><span class="op" id="6785496">:</span>&nbsp;<span class="string" id="6785498">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="6785549">}</span><span class="op" id="6785550">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785554">{</span><span class="ident" id="6785555">in</span><span class="op" id="6785557">:</span>&nbsp;<span class="string" id="6785559">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="6785577">,</span>&nbsp;<span class="ident" id="6785579">want</span><span class="op" id="6785583">:</span>&nbsp;<span class="string" id="6785585">&#34;foo&#34;</span><span class="op" id="6785590">,</span>&nbsp;<span class="ident" id="6785592">err</span><span class="op" id="6785595">:</span>&nbsp;<span class="string" id="6785597">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="6785644">}</span><span class="op" id="6785645">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6785650">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785678">{</span><span class="ident" id="6785679">in</span><span class="op" id="6785681">:</span>&nbsp;<span class="string" id="6785683">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="6785704">+</span>&nbsp;<span class="string" id="6785706">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="6785732">+</span>&nbsp;<span class="string" id="6785734">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6785765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785770">want</span><span class="op" id="6785774">:</span>&nbsp;<span class="string" id="6785776">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6785842">}</span><span class="op" id="6785843">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785849">for</span>&nbsp;<span class="ident" id="6785853">_</span><span class="op" id="6785854">,</span>&nbsp;<span class="ident" id="6785856">tt</span>&nbsp;<span class="op" id="6785859">:=</span>&nbsp;<span class="keyword" id="6785862">range</span>&nbsp;<span class="ident" id="6785868">tests</span>&nbsp;<span class="op" id="6785874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785878">var</span>&nbsp;<span class="ident" id="6785882">buf</span>&nbsp;<span class="ident" id="6785886">bytes</span><span class="op" id="6785891">.</span><span class="ident" id="6785892">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785901">_</span><span class="op" id="6785902">,</span>&nbsp;<span class="ident" id="6785904">err</span>&nbsp;<span class="op" id="6785908">:=</span>&nbsp;<span class="ident" id="6785911">io</span><span class="op" id="6785913">.</span><span class="ident" id="6785914">Copy</span><span class="op" id="6785918">(</span><span class="op" id="6785919">&amp;</span><span class="ident" id="6785920">buf</span><span class="op" id="6785923">,</span>&nbsp;<span class="ident" id="6785925">newQuotedPrintableReader</span><span class="op" id="6785949">(</span><span class="ident" id="6785950">strings</span><span class="op" id="6785957">.</span><span class="ident" id="6785958">NewReader</span><span class="op" id="6785967">(</span><span class="ident" id="6785968">tt</span><span class="op" id="6785970">.</span><span class="ident" id="6785971">in</span><span class="op" id="6785973">)</span><span class="op" id="6785974">)</span><span class="op" id="6785975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785979">if</span>&nbsp;<span class="ident" id="6785982">got</span>&nbsp;<span class="op" id="6785986">:=</span>&nbsp;<span class="ident" id="6785989">buf</span><span class="op" id="6785992">.</span><span class="ident" id="6785993">String</span><span class="op" id="6785999">(</span><span class="op" id="6786000">)</span><span class="op" id="6786001">;</span>&nbsp;<span class="ident" id="6786003">got</span>&nbsp;<span class="op" id="6786007">!=</span>&nbsp;<span class="ident" id="6786010">tt</span><span class="op" id="6786012">.</span><span class="ident" id="6786013">want</span>&nbsp;<span class="op" id="6786018">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786023">t</span><span class="op" id="6786024">.</span><span class="ident" id="6786025">Errorf</span><span class="op" id="6786031">(</span><span class="string" id="6786032">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6786057">,</span>&nbsp;<span class="ident" id="6786059">tt</span><span class="op" id="6786061">.</span><span class="ident" id="6786062">in</span><span class="op" id="6786064">,</span>&nbsp;<span class="ident" id="6786066">got</span><span class="op" id="6786069">,</span>&nbsp;<span class="ident" id="6786071">tt</span><span class="op" id="6786073">.</span><span class="ident" id="6786074">want</span><span class="op" id="6786078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786086">switch</span>&nbsp;<span class="ident" id="6786093">verr</span>&nbsp;<span class="op" id="6786098">:=</span>&nbsp;<span class="ident" id="6786101">tt</span><span class="op" id="6786103">.</span><span class="ident" id="6786104">err</span><span class="op" id="6786107">.</span><span class="op" id="6786108">(</span><span class="keyword" id="6786109">type</span><span class="op" id="6786113">)</span>&nbsp;<span class="op" id="6786115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786119">case</span>&nbsp;<span class="ident" id="6786124">nil</span><span class="op" id="6786127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786132">if</span>&nbsp;<span class="ident" id="6786135">err</span>&nbsp;<span class="op" id="6786139">!=</span>&nbsp;<span class="ident" id="6786142">nil</span>&nbsp;<span class="op" id="6786146">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786152">t</span><span class="op" id="6786153">.</span><span class="ident" id="6786154">Errorf</span><span class="op" id="6786160">(</span><span class="string" id="6786161">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6786195">,</span>&nbsp;<span class="ident" id="6786197">tt</span><span class="op" id="6786199">.</span><span class="ident" id="6786200">in</span><span class="op" id="6786202">,</span>&nbsp;<span class="ident" id="6786204">err</span><span class="op" id="6786207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786216">case</span>&nbsp;<span class="builtintype" id="6786221">string</span><span class="op" id="6786227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786232">if</span>&nbsp;<span class="ident" id="6786235">got</span>&nbsp;<span class="op" id="6786239">:=</span>&nbsp;<span class="ident" id="6786242">fmt</span><span class="op" id="6786245">.</span><span class="ident" id="6786246">Sprint</span><span class="op" id="6786252">(</span><span class="ident" id="6786253">err</span><span class="op" id="6786256">)</span><span class="op" id="6786257">;</span>&nbsp;<span class="ident" id="6786259">got</span>&nbsp;<span class="op" id="6786263">!=</span>&nbsp;<span class="ident" id="6786266">verr</span>&nbsp;<span class="op" id="6786271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786277">t</span><span class="op" id="6786278">.</span><span class="ident" id="6786279">Errorf</span><span class="op" id="6786285">(</span><span class="string" id="6786286">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6786317">,</span>&nbsp;<span class="ident" id="6786319">tt</span><span class="op" id="6786321">.</span><span class="ident" id="6786322">in</span><span class="op" id="6786324">,</span>&nbsp;<span class="ident" id="6786326">got</span><span class="op" id="6786329">,</span>&nbsp;<span class="ident" id="6786331">verr</span><span class="op" id="6786335">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786344">case</span>&nbsp;<span class="builtintype" id="6786349">error</span><span class="op" id="6786354">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786359">if</span>&nbsp;<span class="ident" id="6786362">err</span>&nbsp;<span class="op" id="6786366">!=</span>&nbsp;<span class="ident" id="6786369">verr</span>&nbsp;<span class="op" id="6786374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786380">t</span><span class="op" id="6786381">.</span><span class="ident" id="6786382">Errorf</span><span class="op" id="6786388">(</span><span class="string" id="6786389">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6786420">,</span>&nbsp;<span class="ident" id="6786422">tt</span><span class="op" id="6786424">.</span><span class="ident" id="6786425">in</span><span class="op" id="6786427">,</span>&nbsp;<span class="ident" id="6786429">err</span><span class="op" id="6786432">,</span>&nbsp;<span class="ident" id="6786434">verr</span><span class="op" id="6786438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786443">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="6786453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6786456">func</span>&nbsp;<span class="ident" id="6786461">everySequence</span><span class="op" id="6786474">(</span><span class="ident" id="6786475">base</span><span class="op" id="6786479">,</span>&nbsp;<span class="ident" id="6786481">alpha</span>&nbsp;<span class="builtintype" id="6786487">string</span><span class="op" id="6786493">,</span>&nbsp;<span class="ident" id="6786495">length</span>&nbsp;<span class="builtintype" id="6786502">int</span><span class="op" id="6786505">,</span>&nbsp;<span class="ident" id="6786507">fn</span>&nbsp;<span class="keyword" id="6786510">func</span><span class="op" id="6786514">(</span><span class="builtintype" id="6786515">string</span><span class="op" id="6786521">)</span><span class="op" id="6786522">)</span>&nbsp;<span class="op" id="6786524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786527">if</span>&nbsp;<span class="builtinfunc" id="6786530">len</span><span class="op" id="6786533">(</span><span class="ident" id="6786534">base</span><span class="op" id="6786538">)</span>&nbsp;<span class="op" id="6786540">==</span>&nbsp;<span class="ident" id="6786543">length</span>&nbsp;<span class="op" id="6786550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786554">fn</span><span class="op" id="6786556">(</span><span class="ident" id="6786557">base</span><span class="op" id="6786561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786565">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786573">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786576">for</span>&nbsp;<span class="ident" id="6786580">i</span>&nbsp;<span class="op" id="6786582">:=</span>&nbsp;<span class="num" id="6786585">0</span><span class="op" id="6786586">;</span>&nbsp;<span class="ident" id="6786588">i</span>&nbsp;<span class="op" id="6786590">&lt;</span>&nbsp;<span class="builtinfunc" id="6786592">len</span><span class="op" id="6786595">(</span><span class="ident" id="6786596">alpha</span><span class="op" id="6786601">)</span><span class="op" id="6786602">;</span>&nbsp;<span class="ident" id="6786604">i</span><span class="op" id="6786605">++</span>&nbsp;<span class="op" id="6786608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786612">everySequence</span><span class="op" id="6786625">(</span><span class="ident" id="6786626">base</span><span class="op" id="6786630">+</span><span class="ident" id="6786631">alpha</span><span class="op" id="6786636">[</span><span class="ident" id="6786637">i</span><span class="op" id="6786638">:</span><span class="ident" id="6786639">i</span><span class="op" id="6786640">+</span><span class="num" id="6786641">1</span><span class="op" id="6786642">]</span><span class="op" id="6786643">,</span>&nbsp;<span class="ident" id="6786645">alpha</span><span class="op" id="6786650">,</span>&nbsp;<span class="ident" id="6786652">length</span><span class="op" id="6786658">,</span>&nbsp;<span class="ident" id="6786660">fn</span><span class="op" id="6786662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786665">}</span><br>
<span class="lineno"></span><span class="op" id="6786667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6786670">var</span>&nbsp;<span class="ident" id="6786674">useQprint</span>&nbsp;<span class="op" id="6786684">=</span>&nbsp;<span class="ident" id="6786686">flag</span><span class="op" id="6786690">.</span><span class="ident" id="6786691">Bool</span><span class="op" id="6786695">(</span><span class="string" id="6786696">&#34;qprint&#34;</span><span class="op" id="6786704">,</span>&nbsp;<span class="builtintype" id="6786706">false</span><span class="op" id="6786711">,</span>&nbsp;<span class="string" id="6786713">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="6786752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6786755">var</span>&nbsp;<span class="ident" id="6786759">badSoftRx</span>&nbsp;<span class="op" id="6786769">=</span>&nbsp;<span class="ident" id="6786771">regexp</span><span class="op" id="6786777">.</span><span class="ident" id="6786778">MustCompile</span><span class="op" id="6786789">(</span><span class="string" id="6786790">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="6786845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6786848">func</span>&nbsp;<span class="ident" id="6786853">TestQPExhaustive</span><span class="op" id="6786869">(</span><span class="ident" id="6786870">t</span>&nbsp;<span class="op" id="6786872">*</span><span class="ident" id="6786873">testing</span><span class="op" id="6786880">.</span><span class="ident" id="6786881">T</span><span class="op" id="6786882">)</span>&nbsp;<span class="op" id="6786884">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786887">if</span>&nbsp;<span class="op" id="6786890">*</span><span class="ident" id="6786891">useQprint</span>&nbsp;<span class="op" id="6786901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786905">_</span><span class="op" id="6786906">,</span>&nbsp;<span class="ident" id="6786908">err</span>&nbsp;<span class="op" id="6786912">:=</span>&nbsp;<span class="ident" id="6786915">exec</span><span class="op" id="6786919">.</span><span class="ident" id="6786920">LookPath</span><span class="op" id="6786928">(</span><span class="string" id="6786929">&#34;qprint&#34;</span><span class="op" id="6786937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786941">if</span>&nbsp;<span class="ident" id="6786944">err</span>&nbsp;<span class="op" id="6786948">!=</span>&nbsp;<span class="ident" id="6786951">nil</span>&nbsp;<span class="op" id="6786955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786960">t</span><span class="op" id="6786961">.</span><span class="ident" id="6786962">Fatalf</span><span class="op" id="6786968">(</span><span class="string" id="6786969">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="6786999">,</span>&nbsp;<span class="ident" id="6787001">err</span><span class="op" id="6787004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787008">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787015">var</span>&nbsp;<span class="ident" id="6787019">buf</span>&nbsp;<span class="ident" id="6787023">bytes</span><span class="op" id="6787028">.</span><span class="ident" id="6787029">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787037">res</span>&nbsp;<span class="op" id="6787041">:=</span>&nbsp;<span class="builtinfunc" id="6787044">make</span><span class="op" id="6787048">(</span><span class="keyword" id="6787049">map</span><span class="op" id="6787052">[</span><span class="builtintype" id="6787053">string</span><span class="op" id="6787059">]</span><span class="builtintype" id="6787060">int</span><span class="op" id="6787063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787066">everySequence</span><span class="op" id="6787079">(</span><span class="string" id="6787080">&#34;&#34;</span><span class="op" id="6787082">,</span>&nbsp;<span class="string" id="6787084">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="6787094">,</span>&nbsp;<span class="num" id="6787096">6</span><span class="op" id="6787097">,</span>&nbsp;<span class="keyword" id="6787099">func</span><span class="op" id="6787103">(</span><span class="ident" id="6787104">s</span>&nbsp;<span class="builtintype" id="6787106">string</span><span class="op" id="6787112">)</span>&nbsp;<span class="op" id="6787114">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787118">if</span>&nbsp;<span class="ident" id="6787121">strings</span><span class="op" id="6787128">.</span><span class="ident" id="6787129">HasSuffix</span><span class="op" id="6787138">(</span><span class="ident" id="6787139">s</span><span class="op" id="6787140">,</span>&nbsp;<span class="string" id="6787142">&#34;=&#34;</span><span class="op" id="6787145">)</span>&nbsp;<span class="op" id="6787147">||</span>&nbsp;<span class="ident" id="6787150">strings</span><span class="op" id="6787157">.</span><span class="ident" id="6787158">Contains</span><span class="op" id="6787166">(</span><span class="ident" id="6787167">s</span><span class="op" id="6787168">,</span>&nbsp;<span class="string" id="6787170">&#34;==&#34;</span><span class="op" id="6787174">)</span>&nbsp;<span class="op" id="6787176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787181">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787194">buf</span><span class="op" id="6787197">.</span><span class="ident" id="6787198">Reset</span><span class="op" id="6787203">(</span><span class="op" id="6787204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787208">_</span><span class="op" id="6787209">,</span>&nbsp;<span class="ident" id="6787211">err</span>&nbsp;<span class="op" id="6787215">:=</span>&nbsp;<span class="ident" id="6787218">io</span><span class="op" id="6787220">.</span><span class="ident" id="6787221">Copy</span><span class="op" id="6787225">(</span><span class="op" id="6787226">&amp;</span><span class="ident" id="6787227">buf</span><span class="op" id="6787230">,</span>&nbsp;<span class="ident" id="6787232">newQuotedPrintableReader</span><span class="op" id="6787256">(</span><span class="ident" id="6787257">strings</span><span class="op" id="6787264">.</span><span class="ident" id="6787265">NewReader</span><span class="op" id="6787274">(</span><span class="ident" id="6787275">s</span><span class="op" id="6787276">)</span><span class="op" id="6787277">)</span><span class="op" id="6787278">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787282">if</span>&nbsp;<span class="ident" id="6787285">err</span>&nbsp;<span class="op" id="6787289">!=</span>&nbsp;<span class="ident" id="6787292">nil</span>&nbsp;<span class="op" id="6787296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787301">errStr</span>&nbsp;<span class="op" id="6787308">:=</span>&nbsp;<span class="ident" id="6787311">err</span><span class="op" id="6787314">.</span><span class="ident" id="6787315">Error</span><span class="op" id="6787320">(</span><span class="op" id="6787321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787326">if</span>&nbsp;<span class="ident" id="6787329">strings</span><span class="op" id="6787336">.</span><span class="ident" id="6787337">Contains</span><span class="op" id="6787345">(</span><span class="ident" id="6787346">errStr</span><span class="op" id="6787352">,</span>&nbsp;<span class="string" id="6787354">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="6787378">)</span>&nbsp;<span class="op" id="6787380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787386">errStr</span>&nbsp;<span class="op" id="6787393">=</span>&nbsp;<span class="string" id="6787395">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787422">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787427">res</span><span class="op" id="6787430">[</span><span class="ident" id="6787431">errStr</span><span class="op" id="6787437">]</span><span class="op" id="6787438">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787444">if</span>&nbsp;<span class="ident" id="6787447">strings</span><span class="op" id="6787454">.</span><span class="ident" id="6787455">Contains</span><span class="op" id="6787463">(</span><span class="ident" id="6787464">errStr</span><span class="op" id="6787470">,</span>&nbsp;<span class="string" id="6787472">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="6787508">)</span>&nbsp;<span class="op" id="6787510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787516">if</span>&nbsp;<span class="ident" id="6787519">strings</span><span class="op" id="6787526">.</span><span class="ident" id="6787527">HasSuffix</span><span class="op" id="6787536">(</span><span class="ident" id="6787537">errStr</span><span class="op" id="6787543">,</span>&nbsp;<span class="string" id="6787545">&#34;0x20&#34;</span><span class="op" id="6787551">)</span>&nbsp;<span class="op" id="6787553">&amp;&amp;</span>&nbsp;<span class="op" id="6787556">(</span><span class="ident" id="6787557">strings</span><span class="op" id="6787564">.</span><span class="ident" id="6787565">Contains</span><span class="op" id="6787573">(</span><span class="ident" id="6787574">s</span><span class="op" id="6787575">,</span>&nbsp;<span class="string" id="6787577">&#34;=0&nbsp;&#34;</span><span class="op" id="6787582">)</span>&nbsp;<span class="op" id="6787584">||</span>&nbsp;<span class="ident" id="6787587">strings</span><span class="op" id="6787594">.</span><span class="ident" id="6787595">Contains</span><span class="op" id="6787603">(</span><span class="ident" id="6787604">s</span><span class="op" id="6787605">,</span>&nbsp;<span class="string" id="6787607">&#34;=A&nbsp;&#34;</span><span class="op" id="6787612">)</span>&nbsp;<span class="op" id="6787614">||</span>&nbsp;<span class="ident" id="6787617">strings</span><span class="op" id="6787624">.</span><span class="ident" id="6787625">Contains</span><span class="op" id="6787633">(</span><span class="ident" id="6787634">s</span><span class="op" id="6787635">,</span>&nbsp;<span class="string" id="6787637">&#34;=&nbsp;&#34;</span><span class="op" id="6787641">)</span><span class="op" id="6787642">)</span>&nbsp;<span class="op" id="6787644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787651">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787662">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787668">if</span>&nbsp;<span class="ident" id="6787671">strings</span><span class="op" id="6787678">.</span><span class="ident" id="6787679">HasSuffix</span><span class="op" id="6787688">(</span><span class="ident" id="6787689">errStr</span><span class="op" id="6787695">,</span>&nbsp;<span class="string" id="6787697">&#34;0x3d&#34;</span><span class="op" id="6787703">)</span>&nbsp;<span class="op" id="6787705">&amp;&amp;</span>&nbsp;<span class="op" id="6787708">(</span><span class="ident" id="6787709">strings</span><span class="op" id="6787716">.</span><span class="ident" id="6787717">Contains</span><span class="op" id="6787725">(</span><span class="ident" id="6787726">s</span><span class="op" id="6787727">,</span>&nbsp;<span class="string" id="6787729">&#34;=0=&#34;</span><span class="op" id="6787734">)</span>&nbsp;<span class="op" id="6787736">||</span>&nbsp;<span class="ident" id="6787739">strings</span><span class="op" id="6787746">.</span><span class="ident" id="6787747">Contains</span><span class="op" id="6787755">(</span><span class="ident" id="6787756">s</span><span class="op" id="6787757">,</span>&nbsp;<span class="string" id="6787759">&#34;=A=&#34;</span><span class="op" id="6787764">)</span><span class="op" id="6787765">)</span>&nbsp;<span class="op" id="6787767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787774">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787791">if</span>&nbsp;<span class="ident" id="6787794">strings</span><span class="op" id="6787801">.</span><span class="ident" id="6787802">HasSuffix</span><span class="op" id="6787811">(</span><span class="ident" id="6787812">errStr</span><span class="op" id="6787818">,</span>&nbsp;<span class="string" id="6787820">&#34;0x0a&#34;</span><span class="op" id="6787826">)</span>&nbsp;<span class="op" id="6787828">||</span>&nbsp;<span class="ident" id="6787831">strings</span><span class="op" id="6787838">.</span><span class="ident" id="6787839">HasSuffix</span><span class="op" id="6787848">(</span><span class="ident" id="6787849">errStr</span><span class="op" id="6787855">,</span>&nbsp;<span class="string" id="6787857">&#34;0x0d&#34;</span><span class="op" id="6787863">)</span>&nbsp;<span class="op" id="6787865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6787872">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787956">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787977">if</span>&nbsp;<span class="ident" id="6787980">strings</span><span class="op" id="6787987">.</span><span class="ident" id="6787988">Contains</span><span class="op" id="6787996">(</span><span class="ident" id="6787997">errStr</span><span class="op" id="6788003">,</span>&nbsp;<span class="string" id="6788005">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6788021">)</span>&nbsp;<span class="op" id="6788023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788029">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788044">if</span>&nbsp;<span class="ident" id="6788047">errStr</span>&nbsp;<span class="op" id="6788054">==</span>&nbsp;<span class="string" id="6788057">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="6788081">&amp;&amp;</span>&nbsp;<span class="ident" id="6788084">badSoftRx</span><span class="op" id="6788093">.</span><span class="ident" id="6788094">MatchString</span><span class="op" id="6788105">(</span><span class="ident" id="6788106">s</span><span class="op" id="6788107">)</span>&nbsp;<span class="op" id="6788109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788115">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788130">t</span><span class="op" id="6788131">.</span><span class="ident" id="6788132">Errorf</span><span class="op" id="6788138">(</span><span class="string" id="6788139">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6788156">,</span>&nbsp;<span class="ident" id="6788158">s</span><span class="op" id="6788159">,</span>&nbsp;<span class="ident" id="6788161">err</span><span class="op" id="6788164">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788169">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788182">if</span>&nbsp;<span class="op" id="6788185">*</span><span class="ident" id="6788186">useQprint</span>&nbsp;<span class="op" id="6788196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788201">cmd</span>&nbsp;<span class="op" id="6788205">:=</span>&nbsp;<span class="ident" id="6788208">exec</span><span class="op" id="6788212">.</span><span class="ident" id="6788213">Command</span><span class="op" id="6788220">(</span><span class="string" id="6788221">&#34;qprint&#34;</span><span class="op" id="6788229">,</span>&nbsp;<span class="string" id="6788231">&#34;-d&#34;</span><span class="op" id="6788235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788240">cmd</span><span class="op" id="6788243">.</span><span class="ident" id="6788244">Stdin</span>&nbsp;<span class="op" id="6788250">=</span>&nbsp;<span class="ident" id="6788252">strings</span><span class="op" id="6788259">.</span><span class="ident" id="6788260">NewReader</span><span class="op" id="6788269">(</span><span class="ident" id="6788270">s</span><span class="op" id="6788271">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788276">stderr</span><span class="op" id="6788282">,</span>&nbsp;<span class="ident" id="6788284">err</span>&nbsp;<span class="op" id="6788288">:=</span>&nbsp;<span class="ident" id="6788291">cmd</span><span class="op" id="6788294">.</span><span class="ident" id="6788295">StderrPipe</span><span class="op" id="6788305">(</span><span class="op" id="6788306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788311">if</span>&nbsp;<span class="ident" id="6788314">err</span>&nbsp;<span class="op" id="6788318">!=</span>&nbsp;<span class="ident" id="6788321">nil</span>&nbsp;<span class="op" id="6788325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6788331">panic</span><span class="op" id="6788336">(</span><span class="ident" id="6788337">err</span><span class="op" id="6788340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788350">qpres</span>&nbsp;<span class="op" id="6788356">:=</span>&nbsp;<span class="builtinfunc" id="6788359">make</span><span class="op" id="6788363">(</span><span class="keyword" id="6788364">chan</span>&nbsp;<span class="keyword" id="6788369">interface</span><span class="op" id="6788378">{</span><span class="op" id="6788379">}</span><span class="op" id="6788380">,</span>&nbsp;<span class="num" id="6788382">2</span><span class="op" id="6788383">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788388">go</span>&nbsp;<span class="keyword" id="6788391">func</span><span class="op" id="6788395">(</span><span class="op" id="6788396">)</span>&nbsp;<span class="op" id="6788398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788404">br</span>&nbsp;<span class="op" id="6788407">:=</span>&nbsp;<span class="ident" id="6788410">bufio</span><span class="op" id="6788415">.</span><span class="ident" id="6788416">NewReader</span><span class="op" id="6788425">(</span><span class="ident" id="6788426">stderr</span><span class="op" id="6788432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788438">s</span><span class="op" id="6788439">,</span>&nbsp;<span class="ident" id="6788441">_</span>&nbsp;<span class="op" id="6788443">:=</span>&nbsp;<span class="ident" id="6788446">br</span><span class="op" id="6788448">.</span><span class="ident" id="6788449">ReadString</span><span class="op" id="6788459">(</span><span class="string" id="6788460">&#39;\n&#39;</span><span class="op" id="6788464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788470">if</span>&nbsp;<span class="ident" id="6788473">s</span>&nbsp;<span class="op" id="6788475">!=</span>&nbsp;<span class="string" id="6788478">&#34;&#34;</span>&nbsp;<span class="op" id="6788481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788488">qpres</span>&nbsp;<span class="op" id="6788494">&lt;-</span>&nbsp;<span class="ident" id="6788497">errors</span><span class="op" id="6788503">.</span><span class="ident" id="6788504">New</span><span class="op" id="6788507">(</span><span class="ident" id="6788508">s</span><span class="op" id="6788509">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788516">if</span>&nbsp;<span class="ident" id="6788519">cmd</span><span class="op" id="6788522">.</span><span class="ident" id="6788523">Process</span>&nbsp;<span class="op" id="6788531">!=</span>&nbsp;<span class="ident" id="6788534">nil</span>&nbsp;<span class="op" id="6788538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6788546">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6788596">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788634">cmd</span><span class="op" id="6788637">.</span><span class="ident" id="6788638">Process</span><span class="op" id="6788645">.</span><span class="ident" id="6788646">Kill</span><span class="op" id="6788650">(</span><span class="op" id="6788651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788658">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788669">}</span><span class="op" id="6788670">(</span><span class="op" id="6788671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788676">go</span>&nbsp;<span class="keyword" id="6788679">func</span><span class="op" id="6788683">(</span><span class="op" id="6788684">)</span>&nbsp;<span class="op" id="6788686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788692">want</span><span class="op" id="6788696">,</span>&nbsp;<span class="ident" id="6788698">err</span>&nbsp;<span class="op" id="6788702">:=</span>&nbsp;<span class="ident" id="6788705">cmd</span><span class="op" id="6788708">.</span><span class="ident" id="6788709">Output</span><span class="op" id="6788715">(</span><span class="op" id="6788716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788722">if</span>&nbsp;<span class="ident" id="6788725">err</span>&nbsp;<span class="op" id="6788729">==</span>&nbsp;<span class="ident" id="6788732">nil</span>&nbsp;<span class="op" id="6788736">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788743">qpres</span>&nbsp;<span class="op" id="6788749">&lt;-</span>&nbsp;<span class="ident" id="6788752">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788766">}</span><span class="op" id="6788767">(</span><span class="op" id="6788768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788773">select</span>&nbsp;<span class="op" id="6788780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788785">case</span>&nbsp;<span class="ident" id="6788790">got</span>&nbsp;<span class="op" id="6788794">:=</span>&nbsp;<span class="op" id="6788797">&lt;-</span><span class="ident" id="6788799">qpres</span><span class="op" id="6788804">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788810">if</span>&nbsp;<span class="ident" id="6788813">want</span><span class="op" id="6788817">,</span>&nbsp;<span class="ident" id="6788819">ok</span>&nbsp;<span class="op" id="6788822">:=</span>&nbsp;<span class="ident" id="6788825">got</span><span class="op" id="6788828">.</span><span class="op" id="6788829">(</span><span class="op" id="6788830">[</span><span class="op" id="6788831">]</span><span class="builtintype" id="6788832">byte</span><span class="op" id="6788836">)</span><span class="op" id="6788837">;</span>&nbsp;<span class="ident" id="6788839">ok</span>&nbsp;<span class="op" id="6788842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788849">if</span>&nbsp;<span class="builtintype" id="6788852">string</span><span class="op" id="6788858">(</span><span class="ident" id="6788859">want</span><span class="op" id="6788863">)</span>&nbsp;<span class="op" id="6788865">!=</span>&nbsp;<span class="ident" id="6788868">buf</span><span class="op" id="6788871">.</span><span class="ident" id="6788872">String</span><span class="op" id="6788878">(</span><span class="op" id="6788879">)</span>&nbsp;<span class="op" id="6788881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788889">t</span><span class="op" id="6788890">.</span><span class="ident" id="6788891">Errorf</span><span class="op" id="6788897">(</span><span class="string" id="6788898">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="6788931">,</span>&nbsp;<span class="ident" id="6788933">s</span><span class="op" id="6788934">,</span>&nbsp;<span class="ident" id="6788936">want</span><span class="op" id="6788940">,</span>&nbsp;<span class="ident" id="6788942">buf</span><span class="op" id="6788945">.</span><span class="ident" id="6788946">String</span><span class="op" id="6788952">(</span><span class="op" id="6788953">)</span><span class="op" id="6788954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788967">}</span>&nbsp;<span class="keyword" id="6788969">else</span>&nbsp;<span class="op" id="6788974">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788981">t</span><span class="op" id="6788982">.</span><span class="ident" id="6788983">Logf</span><span class="op" id="6788987">(</span><span class="string" id="6788988">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6789008">,</span>&nbsp;<span class="ident" id="6789010">s</span><span class="op" id="6789011">,</span>&nbsp;<span class="ident" id="6789013">got</span><span class="op" id="6789016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6789027">case</span>&nbsp;<span class="op" id="6789032">&lt;-</span><span class="ident" id="6789034">time</span><span class="op" id="6789038">.</span><span class="ident" id="6789039">After</span><span class="op" id="6789044">(</span><span class="num" id="6789045">5</span>&nbsp;<span class="op" id="6789047">*</span>&nbsp;<span class="ident" id="6789049">time</span><span class="op" id="6789053">.</span><span class="ident" id="6789054">Second</span><span class="op" id="6789060">)</span><span class="op" id="6789061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789067">t</span><span class="op" id="6789068">.</span><span class="ident" id="6789069">Logf</span><span class="op" id="6789073">(</span><span class="string" id="6789074">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6789096">,</span>&nbsp;<span class="ident" id="6789098">s</span><span class="op" id="6789099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789104">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789112">res</span><span class="op" id="6789115">[</span><span class="string" id="6789116">&#34;OK&#34;</span><span class="op" id="6789120">]</span><span class="op" id="6789121">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789125">}</span><span class="op" id="6789126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6789129">var</span>&nbsp;<span class="ident" id="6789133">outcomes</span>&nbsp;<span class="op" id="6789142">[</span><span class="op" id="6789143">]</span><span class="builtintype" id="6789144">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6789152">for</span>&nbsp;<span class="ident" id="6789156">k</span><span class="op" id="6789157">,</span>&nbsp;<span class="ident" id="6789159">v</span>&nbsp;<span class="op" id="6789161">:=</span>&nbsp;<span class="keyword" id="6789164">range</span>&nbsp;<span class="ident" id="6789170">res</span>&nbsp;<span class="op" id="6789174">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789178">outcomes</span>&nbsp;<span class="op" id="6789187">=</span>&nbsp;<span class="builtinfunc" id="6789189">append</span><span class="op" id="6789195">(</span><span class="ident" id="6789196">outcomes</span><span class="op" id="6789204">,</span>&nbsp;<span class="ident" id="6789206">fmt</span><span class="op" id="6789209">.</span><span class="ident" id="6789210">Sprintf</span><span class="op" id="6789217">(</span><span class="string" id="6789218">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="6789226">,</span>&nbsp;<span class="ident" id="6789228">k</span><span class="op" id="6789229">,</span>&nbsp;<span class="ident" id="6789231">v</span><span class="op" id="6789232">)</span><span class="op" id="6789233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789239">sort</span><span class="op" id="6789243">.</span><span class="ident" id="6789244">Strings</span><span class="op" id="6789251">(</span><span class="ident" id="6789252">outcomes</span><span class="op" id="6789260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789263">got</span>&nbsp;<span class="op" id="6789267">:=</span>&nbsp;<span class="ident" id="6789270">strings</span><span class="op" id="6789277">.</span><span class="ident" id="6789278">Join</span><span class="op" id="6789282">(</span><span class="ident" id="6789283">outcomes</span><span class="op" id="6789291">,</span>&nbsp;<span class="string" id="6789293">&#34;\n&#34;</span><span class="op" id="6789297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789300">want</span>&nbsp;<span class="op" id="6789305">:=</span>&nbsp;<span class="string" id="6789308">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6789593">if</span>&nbsp;<span class="ident" id="6789596">got</span>&nbsp;<span class="op" id="6789600">!=</span>&nbsp;<span class="ident" id="6789603">want</span>&nbsp;<span class="op" id="6789608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789612">t</span><span class="op" id="6789613">.</span><span class="ident" id="6789614">Errorf</span><span class="op" id="6789620">(</span><span class="string" id="6789621">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="6789642">,</span>&nbsp;<span class="ident" id="6789644">got</span><span class="op" id="6789647">,</span>&nbsp;<span class="ident" id="6789649">want</span><span class="op" id="6789653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789656">}</span><br>
<span class="lineno"></span><span class="op" id="6789658">}</span>
</div>
</body>
</html>
