<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3491047">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3491102">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3491156">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3491207">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3491224">package</span>&nbsp;<span class="ident" id="3491232">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3491237">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3491265">func</span>&nbsp;<span class="ident" id="3491270">hasAsm</span><span class="op" id="3491276">(</span><span class="op" id="3491277">)</span>&nbsp;<span class="builtintype" id="3491279">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3491284">func</span>&nbsp;<span class="ident" id="3491289">encryptBlockAsm</span><span class="op" id="3491304">(</span><span class="ident" id="3491305">nr</span>&nbsp;<span class="builtintype" id="3491308">int</span><span class="op" id="3491311">,</span>&nbsp;<span class="ident" id="3491313">xk</span>&nbsp;<span class="op" id="3491316">*</span><span class="builtintype" id="3491317">uint32</span><span class="op" id="3491323">,</span>&nbsp;<span class="ident" id="3491325">dst</span><span class="op" id="3491328">,</span>&nbsp;<span class="ident" id="3491330">src</span>&nbsp;<span class="op" id="3491334">*</span><span class="builtintype" id="3491335">byte</span><span class="op" id="3491339">)</span><br>
<span class="lineno"></span><span class="keyword" id="3491341">func</span>&nbsp;<span class="ident" id="3491346">decryptBlockAsm</span><span class="op" id="3491361">(</span><span class="ident" id="3491362">nr</span>&nbsp;<span class="builtintype" id="3491365">int</span><span class="op" id="3491368">,</span>&nbsp;<span class="ident" id="3491370">xk</span>&nbsp;<span class="op" id="3491373">*</span><span class="builtintype" id="3491374">uint32</span><span class="op" id="3491380">,</span>&nbsp;<span class="ident" id="3491382">dst</span><span class="op" id="3491385">,</span>&nbsp;<span class="ident" id="3491387">src</span>&nbsp;<span class="op" id="3491391">*</span><span class="builtintype" id="3491392">byte</span><span class="op" id="3491396">)</span><br>
<span class="lineno"></span><span class="keyword" id="3491398">func</span>&nbsp;<span class="ident" id="3491403">expandKeyAsm</span><span class="op" id="3491415">(</span><span class="ident" id="3491416">nr</span>&nbsp;<span class="builtintype" id="3491419">int</span><span class="op" id="3491422">,</span>&nbsp;<span class="ident" id="3491424">key</span>&nbsp;<span class="op" id="3491428">*</span><span class="builtintype" id="3491429">byte</span><span class="op" id="3491433">,</span>&nbsp;<span class="ident" id="3491435">enc</span>&nbsp;<span class="op" id="3491439">*</span><span class="builtintype" id="3491440">uint32</span><span class="op" id="3491446">,</span>&nbsp;<span class="ident" id="3491448">dec</span>&nbsp;<span class="op" id="3491452">*</span><span class="builtintype" id="3491453">uint32</span><span class="op" id="3491459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3491462">var</span>&nbsp;<span class="ident" id="3491466">useAsm</span>&nbsp;<span class="op" id="3491473">=</span>&nbsp;<span class="ident" id="3491475">hasAsm</span><span class="op" id="3491481">(</span><span class="op" id="3491482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3491485">func</span>&nbsp;<span class="ident" id="3491490">encryptBlock</span><span class="op" id="3491502">(</span><span class="ident" id="3491503">xk</span>&nbsp;<span class="op" id="3491506">[</span><span class="op" id="3491507">]</span><span class="builtintype" id="3491508">uint32</span><span class="op" id="3491514">,</span>&nbsp;<span class="ident" id="3491516">dst</span><span class="op" id="3491519">,</span>&nbsp;<span class="ident" id="3491521">src</span>&nbsp;<span class="op" id="3491525">[</span><span class="op" id="3491526">]</span><span class="builtintype" id="3491527">byte</span><span class="op" id="3491531">)</span>&nbsp;<span class="op" id="3491533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491536">if</span>&nbsp;<span class="ident" id="3491539">useAsm</span>&nbsp;<span class="op" id="3491546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491550">encryptBlockAsm</span><span class="op" id="3491565">(</span><span class="builtinfunc" id="3491566">len</span><span class="op" id="3491569">(</span><span class="ident" id="3491570">xk</span><span class="op" id="3491572">)</span><span class="op" id="3491573">/</span><span class="num" id="3491574">4</span><span class="op" id="3491575">-</span><span class="num" id="3491576">1</span><span class="op" id="3491577">,</span>&nbsp;<span class="op" id="3491579">&amp;</span><span class="ident" id="3491580">xk</span><span class="op" id="3491582">[</span><span class="num" id="3491583">0</span><span class="op" id="3491584">]</span><span class="op" id="3491585">,</span>&nbsp;<span class="op" id="3491587">&amp;</span><span class="ident" id="3491588">dst</span><span class="op" id="3491591">[</span><span class="num" id="3491592">0</span><span class="op" id="3491593">]</span><span class="op" id="3491594">,</span>&nbsp;<span class="op" id="3491596">&amp;</span><span class="ident" id="3491597">src</span><span class="op" id="3491600">[</span><span class="num" id="3491601">0</span><span class="op" id="3491602">]</span><span class="op" id="3491603">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491606">}</span>&nbsp;<span class="keyword" id="3491608">else</span>&nbsp;<span class="op" id="3491613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491617">encryptBlockGo</span><span class="op" id="3491631">(</span><span class="ident" id="3491632">xk</span><span class="op" id="3491634">,</span>&nbsp;<span class="ident" id="3491636">dst</span><span class="op" id="3491639">,</span>&nbsp;<span class="ident" id="3491641">src</span><span class="op" id="3491644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491647">}</span><br>
<span class="lineno"></span><span class="op" id="3491649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3491652">func</span>&nbsp;<span class="ident" id="3491657">decryptBlock</span><span class="op" id="3491669">(</span><span class="ident" id="3491670">xk</span>&nbsp;<span class="op" id="3491673">[</span><span class="op" id="3491674">]</span><span class="builtintype" id="3491675">uint32</span><span class="op" id="3491681">,</span>&nbsp;<span class="ident" id="3491683">dst</span><span class="op" id="3491686">,</span>&nbsp;<span class="ident" id="3491688">src</span>&nbsp;<span class="op" id="3491692">[</span><span class="op" id="3491693">]</span><span class="builtintype" id="3491694">byte</span><span class="op" id="3491698">)</span>&nbsp;<span class="op" id="3491700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491703">if</span>&nbsp;<span class="ident" id="3491706">useAsm</span>&nbsp;<span class="op" id="3491713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491717">decryptBlockAsm</span><span class="op" id="3491732">(</span><span class="builtinfunc" id="3491733">len</span><span class="op" id="3491736">(</span><span class="ident" id="3491737">xk</span><span class="op" id="3491739">)</span><span class="op" id="3491740">/</span><span class="num" id="3491741">4</span><span class="op" id="3491742">-</span><span class="num" id="3491743">1</span><span class="op" id="3491744">,</span>&nbsp;<span class="op" id="3491746">&amp;</span><span class="ident" id="3491747">xk</span><span class="op" id="3491749">[</span><span class="num" id="3491750">0</span><span class="op" id="3491751">]</span><span class="op" id="3491752">,</span>&nbsp;<span class="op" id="3491754">&amp;</span><span class="ident" id="3491755">dst</span><span class="op" id="3491758">[</span><span class="num" id="3491759">0</span><span class="op" id="3491760">]</span><span class="op" id="3491761">,</span>&nbsp;<span class="op" id="3491763">&amp;</span><span class="ident" id="3491764">src</span><span class="op" id="3491767">[</span><span class="num" id="3491768">0</span><span class="op" id="3491769">]</span><span class="op" id="3491770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491773">}</span>&nbsp;<span class="keyword" id="3491775">else</span>&nbsp;<span class="op" id="3491780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491784">decryptBlockGo</span><span class="op" id="3491798">(</span><span class="ident" id="3491799">xk</span><span class="op" id="3491801">,</span>&nbsp;<span class="ident" id="3491803">dst</span><span class="op" id="3491806">,</span>&nbsp;<span class="ident" id="3491808">src</span><span class="op" id="3491811">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491814">}</span><br>
<span class="lineno"></span><span class="op" id="3491816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3491819">func</span>&nbsp;<span class="ident" id="3491824">expandKey</span><span class="op" id="3491833">(</span><span class="ident" id="3491834">key</span>&nbsp;<span class="op" id="3491838">[</span><span class="op" id="3491839">]</span><span class="builtintype" id="3491840">byte</span><span class="op" id="3491844">,</span>&nbsp;<span class="ident" id="3491846">enc</span><span class="op" id="3491849">,</span>&nbsp;<span class="ident" id="3491851">dec</span>&nbsp;<span class="op" id="3491855">[</span><span class="op" id="3491856">]</span><span class="builtintype" id="3491857">uint32</span><span class="op" id="3491863">)</span>&nbsp;<span class="op" id="3491865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491868">if</span>&nbsp;<span class="ident" id="3491871">useAsm</span>&nbsp;<span class="op" id="3491878">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491882">rounds</span>&nbsp;<span class="op" id="3491889">:=</span>&nbsp;<span class="num" id="3491892">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491897">switch</span>&nbsp;<span class="builtinfunc" id="3491904">len</span><span class="op" id="3491907">(</span><span class="ident" id="3491908">key</span><span class="op" id="3491911">)</span>&nbsp;<span class="op" id="3491913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491917">case</span>&nbsp;<span class="num" id="3491922">128</span>&nbsp;<span class="op" id="3491926">/</span>&nbsp;<span class="num" id="3491928">8</span><span class="op" id="3491929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491934">rounds</span>&nbsp;<span class="op" id="3491941">=</span>&nbsp;<span class="num" id="3491943">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491948">case</span>&nbsp;<span class="num" id="3491953">192</span>&nbsp;<span class="op" id="3491957">/</span>&nbsp;<span class="num" id="3491959">8</span><span class="op" id="3491960">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491965">rounds</span>&nbsp;<span class="op" id="3491972">=</span>&nbsp;<span class="num" id="3491974">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491979">case</span>&nbsp;<span class="num" id="3491984">256</span>&nbsp;<span class="op" id="3491988">/</span>&nbsp;<span class="num" id="3491990">8</span><span class="op" id="3491991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491996">rounds</span>&nbsp;<span class="op" id="3492003">=</span>&nbsp;<span class="num" id="3492005">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492014">expandKeyAsm</span><span class="op" id="3492026">(</span><span class="ident" id="3492027">rounds</span><span class="op" id="3492033">,</span>&nbsp;<span class="op" id="3492035">&amp;</span><span class="ident" id="3492036">key</span><span class="op" id="3492039">[</span><span class="num" id="3492040">0</span><span class="op" id="3492041">]</span><span class="op" id="3492042">,</span>&nbsp;<span class="op" id="3492044">&amp;</span><span class="ident" id="3492045">enc</span><span class="op" id="3492048">[</span><span class="num" id="3492049">0</span><span class="op" id="3492050">]</span><span class="op" id="3492051">,</span>&nbsp;<span class="op" id="3492053">&amp;</span><span class="ident" id="3492054">dec</span><span class="op" id="3492057">[</span><span class="num" id="3492058">0</span><span class="op" id="3492059">]</span><span class="op" id="3492060">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492063">}</span>&nbsp;<span class="keyword" id="3492065">else</span>&nbsp;<span class="op" id="3492070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492074">expandKeyGo</span><span class="op" id="3492085">(</span><span class="ident" id="3492086">key</span><span class="op" id="3492089">,</span>&nbsp;<span class="ident" id="3492091">enc</span><span class="op" id="3492094">,</span>&nbsp;<span class="ident" id="3492096">dec</span><span class="op" id="3492099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492102">}</span><br>
<span class="lineno"></span><span class="op" id="3492104">}</span>
</div>
</body>
</html>
