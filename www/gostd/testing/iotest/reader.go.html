<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5793884">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5793939">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5793993">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5794044">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5794120">package</span>&nbsp;<span class="ident" id="5794128">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5794136">import</span>&nbsp;<span class="op" id="5794143">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5794146">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5794156">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5794161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5794164">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5794214">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5794265">func</span>&nbsp;<span class="ident" id="5794270">OneByteReader</span><span class="op" id="5794283">(</span><span class="ident" id="5794284">r</span>&nbsp;<span class="ident" id="5794286">io</span><span class="op" id="5794288">.</span><span class="ident" id="5794289">Reader</span><span class="op" id="5794295">)</span>&nbsp;<span class="ident" id="5794297">io</span><span class="op" id="5794299">.</span><span class="ident" id="5794300">Reader</span>&nbsp;<span class="op" id="5794307">{</span>&nbsp;<span class="keyword" id="5794309">return</span>&nbsp;<span class="op" id="5794316">&amp;</span><span class="ident" id="5794317">oneByteReader</span><span class="op" id="5794330">{</span><span class="ident" id="5794331">r</span><span class="op" id="5794332">}</span>&nbsp;<span class="op" id="5794334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5794337">type</span>&nbsp;<span class="ident" id="5794342">oneByteReader</span>&nbsp;<span class="keyword" id="5794356">struct</span>&nbsp;<span class="op" id="5794363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794366">r</span>&nbsp;<span class="ident" id="5794368">io</span><span class="op" id="5794370">.</span><span class="ident" id="5794371">Reader</span><br>
<span class="lineno"></span><span class="op" id="5794378">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5794381">func</span>&nbsp;<span class="op" id="5794386">(</span><span class="ident" id="5794387">r</span>&nbsp;<span class="op" id="5794389">*</span><span class="ident" id="5794390">oneByteReader</span><span class="op" id="5794403">)</span>&nbsp;<span class="ident" id="5794405">Read</span><span class="op" id="5794409">(</span><span class="ident" id="5794410">p</span>&nbsp;<span class="op" id="5794412">[</span><span class="op" id="5794413">]</span><span class="builtintype" id="5794414">byte</span><span class="op" id="5794418">)</span>&nbsp;<span class="op" id="5794420">(</span><span class="builtintype" id="5794421">int</span><span class="op" id="5794424">,</span>&nbsp;<span class="builtintype" id="5794426">error</span><span class="op" id="5794431">)</span>&nbsp;<span class="op" id="5794433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794436">if</span>&nbsp;<span class="builtinfunc" id="5794439">len</span><span class="op" id="5794442">(</span><span class="ident" id="5794443">p</span><span class="op" id="5794444">)</span>&nbsp;<span class="op" id="5794446">==</span>&nbsp;<span class="num" id="5794449">0</span>&nbsp;<span class="op" id="5794451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794455">return</span>&nbsp;<span class="num" id="5794462">0</span><span class="op" id="5794463">,</span>&nbsp;<span class="ident" id="5794465">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794470">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794473">return</span>&nbsp;<span class="ident" id="5794480">r</span><span class="op" id="5794481">.</span><span class="ident" id="5794482">r</span><span class="op" id="5794483">.</span><span class="ident" id="5794484">Read</span><span class="op" id="5794488">(</span><span class="ident" id="5794489">p</span><span class="op" id="5794490">[</span><span class="num" id="5794491">0</span><span class="op" id="5794492">:</span><span class="num" id="5794493">1</span><span class="op" id="5794494">]</span><span class="op" id="5794495">)</span><br>
<span class="lineno"></span><span class="op" id="5794497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5794500">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5794552">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5794603">func</span>&nbsp;<span class="ident" id="5794608">HalfReader</span><span class="op" id="5794618">(</span><span class="ident" id="5794619">r</span>&nbsp;<span class="ident" id="5794621">io</span><span class="op" id="5794623">.</span><span class="ident" id="5794624">Reader</span><span class="op" id="5794630">)</span>&nbsp;<span class="ident" id="5794632">io</span><span class="op" id="5794634">.</span><span class="ident" id="5794635">Reader</span>&nbsp;<span class="op" id="5794642">{</span>&nbsp;<span class="keyword" id="5794644">return</span>&nbsp;<span class="op" id="5794651">&amp;</span><span class="ident" id="5794652">halfReader</span><span class="op" id="5794662">{</span><span class="ident" id="5794663">r</span><span class="op" id="5794664">}</span>&nbsp;<span class="op" id="5794666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5794669">type</span>&nbsp;<span class="ident" id="5794674">halfReader</span>&nbsp;<span class="keyword" id="5794685">struct</span>&nbsp;<span class="op" id="5794692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794695">r</span>&nbsp;<span class="ident" id="5794697">io</span><span class="op" id="5794699">.</span><span class="ident" id="5794700">Reader</span><br>
<span class="lineno"></span><span class="op" id="5794707">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5794710">func</span>&nbsp;<span class="op" id="5794715">(</span><span class="ident" id="5794716">r</span>&nbsp;<span class="op" id="5794718">*</span><span class="ident" id="5794719">halfReader</span><span class="op" id="5794729">)</span>&nbsp;<span class="ident" id="5794731">Read</span><span class="op" id="5794735">(</span><span class="ident" id="5794736">p</span>&nbsp;<span class="op" id="5794738">[</span><span class="op" id="5794739">]</span><span class="builtintype" id="5794740">byte</span><span class="op" id="5794744">)</span>&nbsp;<span class="op" id="5794746">(</span><span class="builtintype" id="5794747">int</span><span class="op" id="5794750">,</span>&nbsp;<span class="builtintype" id="5794752">error</span><span class="op" id="5794757">)</span>&nbsp;<span class="op" id="5794759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794762">return</span>&nbsp;<span class="ident" id="5794769">r</span><span class="op" id="5794770">.</span><span class="ident" id="5794771">r</span><span class="op" id="5794772">.</span><span class="ident" id="5794773">Read</span><span class="op" id="5794777">(</span><span class="ident" id="5794778">p</span><span class="op" id="5794779">[</span><span class="num" id="5794780">0</span>&nbsp;<span class="op" id="5794782">:</span>&nbsp;<span class="op" id="5794784">(</span><span class="builtinfunc" id="5794785">len</span><span class="op" id="5794788">(</span><span class="ident" id="5794789">p</span><span class="op" id="5794790">)</span><span class="op" id="5794791">+</span><span class="num" id="5794792">1</span><span class="op" id="5794793">)</span><span class="op" id="5794794">/</span><span class="num" id="5794795">2</span><span class="op" id="5794796">]</span><span class="op" id="5794797">)</span><br>
<span class="lineno"></span><span class="op" id="5794799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5794802">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5794879">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5794957">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5795033">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5795111">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5795157">func</span>&nbsp;<span class="ident" id="5795162">DataErrReader</span><span class="op" id="5795175">(</span><span class="ident" id="5795176">r</span>&nbsp;<span class="ident" id="5795178">io</span><span class="op" id="5795180">.</span><span class="ident" id="5795181">Reader</span><span class="op" id="5795187">)</span>&nbsp;<span class="ident" id="5795189">io</span><span class="op" id="5795191">.</span><span class="ident" id="5795192">Reader</span>&nbsp;<span class="op" id="5795199">{</span>&nbsp;<span class="keyword" id="5795201">return</span>&nbsp;<span class="op" id="5795208">&amp;</span><span class="ident" id="5795209">dataErrReader</span><span class="op" id="5795222">{</span><span class="ident" id="5795223">r</span><span class="op" id="5795224">,</span>&nbsp;<span class="ident" id="5795226">nil</span><span class="op" id="5795229">,</span>&nbsp;<span class="builtinfunc" id="5795231">make</span><span class="op" id="5795235">(</span><span class="op" id="5795236">[</span><span class="op" id="5795237">]</span><span class="builtintype" id="5795238">byte</span><span class="op" id="5795242">,</span>&nbsp;<span class="num" id="5795244">1024</span><span class="op" id="5795248">)</span><span class="op" id="5795249">}</span>&nbsp;<span class="op" id="5795251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795254">type</span>&nbsp;<span class="ident" id="5795259">dataErrReader</span>&nbsp;<span class="keyword" id="5795273">struct</span>&nbsp;<span class="op" id="5795280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795283">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5795290">io</span><span class="op" id="5795292">.</span><span class="ident" id="5795293">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795301">unread</span>&nbsp;<span class="op" id="5795308">[</span><span class="op" id="5795309">]</span><span class="builtintype" id="5795310">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795316">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5795323">[</span><span class="op" id="5795324">]</span><span class="builtintype" id="5795325">byte</span><br>
<span class="lineno"></span><span class="op" id="5795330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795333">func</span>&nbsp;<span class="op" id="5795338">(</span><span class="ident" id="5795339">r</span>&nbsp;<span class="op" id="5795341">*</span><span class="ident" id="5795342">dataErrReader</span><span class="op" id="5795355">)</span>&nbsp;<span class="ident" id="5795357">Read</span><span class="op" id="5795361">(</span><span class="ident" id="5795362">p</span>&nbsp;<span class="op" id="5795364">[</span><span class="op" id="5795365">]</span><span class="builtintype" id="5795366">byte</span><span class="op" id="5795370">)</span>&nbsp;<span class="op" id="5795372">(</span><span class="ident" id="5795373">n</span>&nbsp;<span class="builtintype" id="5795375">int</span><span class="op" id="5795378">,</span>&nbsp;<span class="ident" id="5795380">err</span>&nbsp;<span class="builtintype" id="5795384">error</span><span class="op" id="5795389">)</span>&nbsp;<span class="op" id="5795391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5795394">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5795439">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795494">for</span>&nbsp;<span class="op" id="5795498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795502">if</span>&nbsp;<span class="builtinfunc" id="5795505">len</span><span class="op" id="5795508">(</span><span class="ident" id="5795509">r</span><span class="op" id="5795510">.</span><span class="ident" id="5795511">unread</span><span class="op" id="5795517">)</span>&nbsp;<span class="op" id="5795519">==</span>&nbsp;<span class="num" id="5795522">0</span>&nbsp;<span class="op" id="5795524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795529">n1</span><span class="op" id="5795531">,</span>&nbsp;<span class="ident" id="5795533">err1</span>&nbsp;<span class="op" id="5795538">:=</span>&nbsp;<span class="ident" id="5795541">r</span><span class="op" id="5795542">.</span><span class="ident" id="5795543">r</span><span class="op" id="5795544">.</span><span class="ident" id="5795545">Read</span><span class="op" id="5795549">(</span><span class="ident" id="5795550">r</span><span class="op" id="5795551">.</span><span class="ident" id="5795552">data</span><span class="op" id="5795556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795561">r</span><span class="op" id="5795562">.</span><span class="ident" id="5795563">unread</span>&nbsp;<span class="op" id="5795570">=</span>&nbsp;<span class="ident" id="5795572">r</span><span class="op" id="5795573">.</span><span class="ident" id="5795574">data</span><span class="op" id="5795578">[</span><span class="num" id="5795579">0</span><span class="op" id="5795580">:</span><span class="ident" id="5795581">n1</span><span class="op" id="5795583">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795588">err</span>&nbsp;<span class="op" id="5795592">=</span>&nbsp;<span class="ident" id="5795594">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795605">if</span>&nbsp;<span class="ident" id="5795608">n</span>&nbsp;<span class="op" id="5795610">&gt;</span>&nbsp;<span class="num" id="5795612">0</span>&nbsp;<span class="op" id="5795614">||</span>&nbsp;<span class="ident" id="5795617">err</span>&nbsp;<span class="op" id="5795621">!=</span>&nbsp;<span class="ident" id="5795624">nil</span>&nbsp;<span class="op" id="5795628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795633">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795641">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795645">n</span>&nbsp;<span class="op" id="5795647">=</span>&nbsp;<span class="builtinfunc" id="5795649">copy</span><span class="op" id="5795653">(</span><span class="ident" id="5795654">p</span><span class="op" id="5795655">,</span>&nbsp;<span class="ident" id="5795657">r</span><span class="op" id="5795658">.</span><span class="ident" id="5795659">unread</span><span class="op" id="5795665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795669">r</span><span class="op" id="5795670">.</span><span class="ident" id="5795671">unread</span>&nbsp;<span class="op" id="5795678">=</span>&nbsp;<span class="ident" id="5795680">r</span><span class="op" id="5795681">.</span><span class="ident" id="5795682">unread</span><span class="op" id="5795688">[</span><span class="ident" id="5795689">n</span><span class="op" id="5795690">:</span><span class="op" id="5795691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795697">return</span><br>
<span class="lineno"></span><span class="op" id="5795704">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5795707">var</span>&nbsp;<span class="ident" id="5795711">ErrTimeout</span>&nbsp;<span class="op" id="5795722">=</span>&nbsp;<span class="ident" id="5795724">errors</span><span class="op" id="5795730">.</span><span class="ident" id="5795731">New</span><span class="op" id="5795734">(</span><span class="string" id="5795735">&#34;timeout&#34;</span><span class="op" id="5795744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5795747">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5795802">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5795854">func</span>&nbsp;<span class="ident" id="5795859">TimeoutReader</span><span class="op" id="5795872">(</span><span class="ident" id="5795873">r</span>&nbsp;<span class="ident" id="5795875">io</span><span class="op" id="5795877">.</span><span class="ident" id="5795878">Reader</span><span class="op" id="5795884">)</span>&nbsp;<span class="ident" id="5795886">io</span><span class="op" id="5795888">.</span><span class="ident" id="5795889">Reader</span>&nbsp;<span class="op" id="5795896">{</span>&nbsp;<span class="keyword" id="5795898">return</span>&nbsp;<span class="op" id="5795905">&amp;</span><span class="ident" id="5795906">timeoutReader</span><span class="op" id="5795919">{</span><span class="ident" id="5795920">r</span><span class="op" id="5795921">,</span>&nbsp;<span class="num" id="5795923">0</span><span class="op" id="5795924">}</span>&nbsp;<span class="op" id="5795926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795929">type</span>&nbsp;<span class="ident" id="5795934">timeoutReader</span>&nbsp;<span class="keyword" id="5795948">struct</span>&nbsp;<span class="op" id="5795955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795958">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5795964">io</span><span class="op" id="5795966">.</span><span class="ident" id="5795967">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795975">count</span>&nbsp;<span class="builtintype" id="5795981">int</span><br>
<span class="lineno">80</span><span class="op" id="5795985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795988">func</span>&nbsp;<span class="op" id="5795993">(</span><span class="ident" id="5795994">r</span>&nbsp;<span class="op" id="5795996">*</span><span class="ident" id="5795997">timeoutReader</span><span class="op" id="5796010">)</span>&nbsp;<span class="ident" id="5796012">Read</span><span class="op" id="5796016">(</span><span class="ident" id="5796017">p</span>&nbsp;<span class="op" id="5796019">[</span><span class="op" id="5796020">]</span><span class="builtintype" id="5796021">byte</span><span class="op" id="5796025">)</span>&nbsp;<span class="op" id="5796027">(</span><span class="builtintype" id="5796028">int</span><span class="op" id="5796031">,</span>&nbsp;<span class="builtintype" id="5796033">error</span><span class="op" id="5796038">)</span>&nbsp;<span class="op" id="5796040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5796043">r</span><span class="op" id="5796044">.</span><span class="ident" id="5796045">count</span><span class="op" id="5796050">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796054">if</span>&nbsp;<span class="ident" id="5796057">r</span><span class="op" id="5796058">.</span><span class="ident" id="5796059">count</span>&nbsp;<span class="op" id="5796065">==</span>&nbsp;<span class="num" id="5796068">2</span>&nbsp;<span class="op" id="5796070">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796074">return</span>&nbsp;<span class="num" id="5796081">0</span><span class="op" id="5796082">,</span>&nbsp;<span class="ident" id="5796084">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5796096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5796099">return</span>&nbsp;<span class="ident" id="5796106">r</span><span class="op" id="5796107">.</span><span class="ident" id="5796108">r</span><span class="op" id="5796109">.</span><span class="ident" id="5796110">Read</span><span class="op" id="5796114">(</span><span class="ident" id="5796115">p</span><span class="op" id="5796116">)</span><br>
<span class="lineno"></span><span class="op" id="5796118">}</span>
</div>
</body>
</html>
