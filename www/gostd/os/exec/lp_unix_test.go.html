<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6792320">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6792376">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6792430">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6792481">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6792546">package</span>&nbsp;<span class="ident" id="6792554">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6792560">import</span>&nbsp;<span class="op" id="6792567">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6792570">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6792583">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6792589">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6792599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6792602">func</span>&nbsp;<span class="ident" id="6792607">TestLookPathUnixEmptyPath</span><span class="op" id="6792632">(</span><span class="ident" id="6792633">t</span>&nbsp;<span class="op" id="6792635">*</span><span class="ident" id="6792636">testing</span><span class="op" id="6792643">.</span><span class="ident" id="6792644">T</span><span class="op" id="6792645">)</span>&nbsp;<span class="op" id="6792647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792650">tmp</span><span class="op" id="6792653">,</span>&nbsp;<span class="ident" id="6792655">err</span>&nbsp;<span class="op" id="6792659">:=</span>&nbsp;<span class="ident" id="6792662">ioutil</span><span class="op" id="6792668">.</span><span class="ident" id="6792669">TempDir</span><span class="op" id="6792676">(</span><span class="string" id="6792677">&#34;&#34;</span><span class="op" id="6792679">,</span>&nbsp;<span class="string" id="6792681">&#34;TestLookPathUnixEmptyPath&#34;</span><span class="op" id="6792708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6792711">if</span>&nbsp;<span class="ident" id="6792714">err</span>&nbsp;<span class="op" id="6792718">!=</span>&nbsp;<span class="ident" id="6792721">nil</span>&nbsp;<span class="op" id="6792725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792729">t</span><span class="op" id="6792730">.</span><span class="ident" id="6792731">Fatal</span><span class="op" id="6792736">(</span><span class="string" id="6792737">&#34;TempDir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6792755">,</span>&nbsp;<span class="ident" id="6792757">err</span><span class="op" id="6792760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6792763">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6792766">defer</span>&nbsp;<span class="ident" id="6792772">os</span><span class="op" id="6792774">.</span><span class="ident" id="6792775">RemoveAll</span><span class="op" id="6792784">(</span><span class="ident" id="6792785">tmp</span><span class="op" id="6792788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792791">wd</span><span class="op" id="6792793">,</span>&nbsp;<span class="ident" id="6792795">err</span>&nbsp;<span class="op" id="6792799">:=</span>&nbsp;<span class="ident" id="6792802">os</span><span class="op" id="6792804">.</span><span class="ident" id="6792805">Getwd</span><span class="op" id="6792810">(</span><span class="op" id="6792811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6792814">if</span>&nbsp;<span class="ident" id="6792817">err</span>&nbsp;<span class="op" id="6792821">!=</span>&nbsp;<span class="ident" id="6792824">nil</span>&nbsp;<span class="op" id="6792828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792832">t</span><span class="op" id="6792833">.</span><span class="ident" id="6792834">Fatal</span><span class="op" id="6792839">(</span><span class="string" id="6792840">&#34;Getwd&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6792856">,</span>&nbsp;<span class="ident" id="6792858">err</span><span class="op" id="6792861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6792864">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792867">err</span>&nbsp;<span class="op" id="6792871">=</span>&nbsp;<span class="ident" id="6792873">os</span><span class="op" id="6792875">.</span><span class="ident" id="6792876">Chdir</span><span class="op" id="6792881">(</span><span class="ident" id="6792882">tmp</span><span class="op" id="6792885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6792888">if</span>&nbsp;<span class="ident" id="6792891">err</span>&nbsp;<span class="op" id="6792895">!=</span>&nbsp;<span class="ident" id="6792898">nil</span>&nbsp;<span class="op" id="6792902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792906">t</span><span class="op" id="6792907">.</span><span class="ident" id="6792908">Fatal</span><span class="op" id="6792913">(</span><span class="string" id="6792914">&#34;Chdir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6792930">,</span>&nbsp;<span class="ident" id="6792932">err</span><span class="op" id="6792935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6792938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6792941">defer</span>&nbsp;<span class="ident" id="6792947">os</span><span class="op" id="6792949">.</span><span class="ident" id="6792950">Chdir</span><span class="op" id="6792955">(</span><span class="ident" id="6792956">wd</span><span class="op" id="6792958">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6792962">f</span><span class="op" id="6792963">,</span>&nbsp;<span class="ident" id="6792965">err</span>&nbsp;<span class="op" id="6792969">:=</span>&nbsp;<span class="ident" id="6792972">os</span><span class="op" id="6792974">.</span><span class="ident" id="6792975">OpenFile</span><span class="op" id="6792983">(</span><span class="string" id="6792984">&#34;exec_me&#34;</span><span class="op" id="6792993">,</span>&nbsp;<span class="ident" id="6792995">os</span><span class="op" id="6792997">.</span><span class="ident" id="6792998">O_CREATE</span><span class="op" id="6793006">|</span><span class="ident" id="6793007">os</span><span class="op" id="6793009">.</span><span class="ident" id="6793010">O_EXCL</span><span class="op" id="6793016">,</span>&nbsp;<span class="num" id="6793018">0700</span><span class="op" id="6793022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793025">if</span>&nbsp;<span class="ident" id="6793028">err</span>&nbsp;<span class="op" id="6793032">!=</span>&nbsp;<span class="ident" id="6793035">nil</span>&nbsp;<span class="op" id="6793039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793043">t</span><span class="op" id="6793044">.</span><span class="ident" id="6793045">Fatal</span><span class="op" id="6793050">(</span><span class="string" id="6793051">&#34;OpenFile&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6793070">,</span>&nbsp;<span class="ident" id="6793072">err</span><span class="op" id="6793075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6793078">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793081">err</span>&nbsp;<span class="op" id="6793085">=</span>&nbsp;<span class="ident" id="6793087">f</span><span class="op" id="6793088">.</span><span class="ident" id="6793089">Close</span><span class="op" id="6793094">(</span><span class="op" id="6793095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793098">if</span>&nbsp;<span class="ident" id="6793101">err</span>&nbsp;<span class="op" id="6793105">!=</span>&nbsp;<span class="ident" id="6793108">nil</span>&nbsp;<span class="op" id="6793112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793116">t</span><span class="op" id="6793117">.</span><span class="ident" id="6793118">Fatal</span><span class="op" id="6793123">(</span><span class="string" id="6793124">&#34;Close&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6793140">,</span>&nbsp;<span class="ident" id="6793142">err</span><span class="op" id="6793145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6793148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793152">pathenv</span>&nbsp;<span class="op" id="6793160">:=</span>&nbsp;<span class="ident" id="6793163">os</span><span class="op" id="6793165">.</span><span class="ident" id="6793166">Getenv</span><span class="op" id="6793172">(</span><span class="string" id="6793173">&#34;PATH&#34;</span><span class="op" id="6793179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793182">defer</span>&nbsp;<span class="ident" id="6793188">os</span><span class="op" id="6793190">.</span><span class="ident" id="6793191">Setenv</span><span class="op" id="6793197">(</span><span class="string" id="6793198">&#34;PATH&#34;</span><span class="op" id="6793204">,</span>&nbsp;<span class="ident" id="6793206">pathenv</span><span class="op" id="6793213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793217">err</span>&nbsp;<span class="op" id="6793221">=</span>&nbsp;<span class="ident" id="6793223">os</span><span class="op" id="6793225">.</span><span class="ident" id="6793226">Setenv</span><span class="op" id="6793232">(</span><span class="string" id="6793233">&#34;PATH&#34;</span><span class="op" id="6793239">,</span>&nbsp;<span class="string" id="6793241">&#34;&#34;</span><span class="op" id="6793243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793246">if</span>&nbsp;<span class="ident" id="6793249">err</span>&nbsp;<span class="op" id="6793253">!=</span>&nbsp;<span class="ident" id="6793256">nil</span>&nbsp;<span class="op" id="6793260">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793264">t</span><span class="op" id="6793265">.</span><span class="ident" id="6793266">Fatal</span><span class="op" id="6793271">(</span><span class="string" id="6793272">&#34;Setenv&nbsp;failed:&nbsp;&#34;</span><span class="op" id="6793289">,</span>&nbsp;<span class="ident" id="6793291">err</span><span class="op" id="6793294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6793297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793301">path</span><span class="op" id="6793305">,</span>&nbsp;<span class="ident" id="6793307">err</span>&nbsp;<span class="op" id="6793311">:=</span>&nbsp;<span class="ident" id="6793314">LookPath</span><span class="op" id="6793322">(</span><span class="string" id="6793323">&#34;exec_me&#34;</span><span class="op" id="6793332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793335">if</span>&nbsp;<span class="ident" id="6793338">err</span>&nbsp;<span class="op" id="6793342">==</span>&nbsp;<span class="ident" id="6793345">nil</span>&nbsp;<span class="op" id="6793349">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793353">t</span><span class="op" id="6793354">.</span><span class="ident" id="6793355">Fatal</span><span class="op" id="6793360">(</span><span class="string" id="6793361">&#34;LookPath&nbsp;found&nbsp;exec_me&nbsp;in&nbsp;empty&nbsp;$PATH&#34;</span><span class="op" id="6793400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6793403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6793406">if</span>&nbsp;<span class="ident" id="6793409">path</span>&nbsp;<span class="op" id="6793414">!=</span>&nbsp;<span class="string" id="6793417">&#34;&#34;</span>&nbsp;<span class="op" id="6793420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6793424">t</span><span class="op" id="6793425">.</span><span class="ident" id="6793426">Fatalf</span><span class="op" id="6793432">(</span><span class="string" id="6793433">&#34;LookPath&nbsp;path&nbsp;==&nbsp;%q&nbsp;when&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6793470">,</span>&nbsp;<span class="ident" id="6793472">path</span><span class="op" id="6793476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6793479">}</span><br>
<span class="lineno">55</span><span class="op" id="6793481">}</span>
</div>
</body>
</html>
