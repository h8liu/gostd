<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2590934">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2590989">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2591043">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2591094">//&nbsp;Read&nbsp;static&nbsp;host/IP&nbsp;entries&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2591143">package</span>&nbsp;<span class="ident" id="2591151">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2591156">import</span>&nbsp;<span class="op" id="2591163">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2591166">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2591174">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2591181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2591184">const</span>&nbsp;<span class="ident" id="2591190">cacheMaxAge</span>&nbsp;<span class="op" id="2591202">=</span>&nbsp;<span class="num" id="2591204">5</span>&nbsp;<span class="op" id="2591206">*</span>&nbsp;<span class="ident" id="2591208"><a href="/net/hosts.go.html#2591174">time</a></span><span class="op" id="2591212">.</span><span class="ident" id="2591213">Minute</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2591221">//&nbsp;hostsPath&nbsp;points&nbsp;to&nbsp;the&nbsp;file&nbsp;with&nbsp;static&nbsp;IP/address&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="2591285">var</span>&nbsp;<span class="ident" id="2591289">hostsPath</span>&nbsp;<span class="op" id="2591299">=</span>&nbsp;<span class="string" id="2591301">&#34;/etc/hosts&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2591315">//&nbsp;Simple&nbsp;cache.</span><br>
<span class="lineno">20</span><span class="keyword" id="2591332">var</span>&nbsp;<span class="ident" id="2591336">hosts</span>&nbsp;<span class="keyword" id="2591342">struct</span>&nbsp;<span class="op" id="2591349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591352"><a href="/net/hosts.go.html#2591166">sync</a></span><span class="op" id="2591356">.</span><span class="ident" id="2591357">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591364">byName</span>&nbsp;<span class="keyword" id="2591371">map</span><span class="op" id="2591374">[</span><span class="builtintype" id="2591375">string</span><span class="op" id="2591381">]</span><span class="op" id="2591382">[</span><span class="op" id="2591383">]</span><span class="builtintype" id="2591384">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591392">byAddr</span>&nbsp;<span class="keyword" id="2591399">map</span><span class="op" id="2591402">[</span><span class="builtintype" id="2591403">string</span><span class="op" id="2591409">]</span><span class="op" id="2591410">[</span><span class="op" id="2591411">]</span><span class="builtintype" id="2591412">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591420">expire</span>&nbsp;<span class="ident" id="2591427"><a href="/net/hosts.go.html#2591174">time</a></span><span class="op" id="2591431">.</span><span class="ident" id="2591432">Time</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591438">path</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2591445">string</span><br>
<span class="lineno"></span><span class="op" id="2591452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2591455">func</span>&nbsp;<span class="ident" id="2591460">readHosts</span><span class="op" id="2591469">(</span><span class="op" id="2591470">)</span>&nbsp;<span class="op" id="2591472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591475">now</span>&nbsp;<span class="op" id="2591479">:=</span>&nbsp;<span class="ident" id="2591482"><a href="/net/hosts.go.html#2591174">time</a></span><span class="op" id="2591486">.</span><span class="ident" id="2591487">Now</span><span class="op" id="2591490">(</span><span class="op" id="2591491">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591494">hp</span>&nbsp;<span class="op" id="2591497">:=</span>&nbsp;<span class="ident" id="2591500"><a href="/net/hosts.go.html#2591289">hostsPath</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591511">if</span>&nbsp;<span class="builtinfunc" id="2591514">len</span><span class="op" id="2591517">(</span><span class="ident" id="2591518"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2591523">.</span><span class="ident" id="2591524">byName</span><span class="op" id="2591530">)</span>&nbsp;<span class="op" id="2591532">==</span>&nbsp;<span class="num" id="2591535">0</span>&nbsp;<span class="op" id="2591537">||</span>&nbsp;<span class="ident" id="2591540"><a href="/net/hosts.go.html#2591475">now</a></span><span class="op" id="2591543">.</span><span class="ident" id="2591544">After</span><span class="op" id="2591549">(</span><span class="ident" id="2591550"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2591555">.</span><span class="ident" id="2591556">expire</span><span class="op" id="2591562">)</span>&nbsp;<span class="op" id="2591564">||</span>&nbsp;<span class="ident" id="2591567"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2591572">.</span><span class="ident" id="2591573">path</span>&nbsp;<span class="op" id="2591578">!=</span>&nbsp;<span class="ident" id="2591581"><a href="/net/hosts.go.html#2591494">hp</a></span>&nbsp;<span class="op" id="2591584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591588">hs</span>&nbsp;<span class="op" id="2591591">:=</span>&nbsp;<span class="builtinfunc" id="2591594">make</span><span class="op" id="2591598">(</span><span class="keyword" id="2591599">map</span><span class="op" id="2591602">[</span><span class="builtintype" id="2591603">string</span><span class="op" id="2591609">]</span><span class="op" id="2591610">[</span><span class="op" id="2591611">]</span><span class="builtintype" id="2591612">string</span><span class="op" id="2591618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591622">is</span>&nbsp;<span class="op" id="2591625">:=</span>&nbsp;<span class="builtinfunc" id="2591628">make</span><span class="op" id="2591632">(</span><span class="keyword" id="2591633">map</span><span class="op" id="2591636">[</span><span class="builtintype" id="2591637">string</span><span class="op" id="2591643">]</span><span class="op" id="2591644">[</span><span class="op" id="2591645">]</span><span class="builtintype" id="2591646">string</span><span class="op" id="2591652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591656">var</span>&nbsp;<span class="ident" id="2591660">file</span>&nbsp;<span class="op" id="2591665">*</span><span class="ident" id="2591666"><a href="/net/parse.go.html#2663047">file</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591673">if</span>&nbsp;<span class="ident" id="2591676"><a href="/net/hosts.go.html#2591660">file</a></span><span class="op" id="2591680">,</span>&nbsp;<span class="ident" id="2591682">_</span>&nbsp;<span class="op" id="2591684">=</span>&nbsp;<span class="ident" id="2591686"><a href="/net/parse.go.html#2663938">open</a></span><span class="op" id="2591690">(</span><span class="ident" id="2591691"><a href="/net/hosts.go.html#2591494">hp</a></span><span class="op" id="2591693">)</span><span class="op" id="2591694">;</span>&nbsp;<span class="ident" id="2591696"><a href="/net/hosts.go.html#2591660">file</a></span>&nbsp;<span class="op" id="2591701">==</span>&nbsp;<span class="ident" id="2591704">nil</span>&nbsp;<span class="op" id="2591708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591713">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591726">for</span>&nbsp;<span class="ident" id="2591730">line</span><span class="op" id="2591734">,</span>&nbsp;<span class="ident" id="2591736">ok</span>&nbsp;<span class="op" id="2591739">:=</span>&nbsp;<span class="ident" id="2591742"><a href="/net/hosts.go.html#2591660">file</a></span><span class="op" id="2591746">.</span><span class="ident" id="2591747">readLine</span><span class="op" id="2591755">(</span><span class="op" id="2591756">)</span><span class="op" id="2591757">;</span>&nbsp;<span class="ident" id="2591759"><a href="/net/hosts.go.html#2591736">ok</a></span><span class="op" id="2591761">;</span>&nbsp;<span class="ident" id="2591763"><a href="/net/hosts.go.html#2591730">line</a></span><span class="op" id="2591767">,</span>&nbsp;<span class="ident" id="2591769"><a href="/net/hosts.go.html#2591736">ok</a></span>&nbsp;<span class="op" id="2591772">=</span>&nbsp;<span class="ident" id="2591774"><a href="/net/hosts.go.html#2591660">file</a></span><span class="op" id="2591778">.</span><span class="ident" id="2591779">readLine</span><span class="op" id="2591787">(</span><span class="op" id="2591788">)</span>&nbsp;<span class="op" id="2591790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591795">if</span>&nbsp;<span class="ident" id="2591798">i</span>&nbsp;<span class="op" id="2591800">:=</span>&nbsp;<span class="ident" id="2591803"><a href="/net/parse.go.html#2664110">byteIndex</a></span><span class="op" id="2591812">(</span><span class="ident" id="2591813"><a href="/net/hosts.go.html#2591730">line</a></span><span class="op" id="2591817">,</span>&nbsp;<span class="string" id="2591819">&#39;#&#39;</span><span class="op" id="2591822">)</span><span class="op" id="2591823">;</span>&nbsp;<span class="ident" id="2591825"><a href="/net/hosts.go.html#2591798">i</a></span>&nbsp;<span class="op" id="2591827">&gt;=</span>&nbsp;<span class="num" id="2591830">0</span>&nbsp;<span class="op" id="2591832">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2591838">//&nbsp;Discard&nbsp;comments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591863"><a href="/net/hosts.go.html#2591730">line</a></span>&nbsp;<span class="op" id="2591868">=</span>&nbsp;<span class="ident" id="2591870"><a href="/net/hosts.go.html#2591730">line</a></span><span class="op" id="2591874">[</span><span class="num" id="2591875">0</span><span class="op" id="2591876">:</span><span class="ident" id="2591877"><a href="/net/hosts.go.html#2591798">i</a></span><span class="op" id="2591878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2591888">f</span>&nbsp;<span class="op" id="2591890">:=</span>&nbsp;<span class="ident" id="2591893"><a href="/net/parse.go.html#2664774">getFields</a></span><span class="op" id="2591902">(</span><span class="ident" id="2591903"><a href="/net/hosts.go.html#2591730">line</a></span><span class="op" id="2591907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591912">if</span>&nbsp;<span class="builtinfunc" id="2591915">len</span><span class="op" id="2591918">(</span><span class="ident" id="2591919"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2591920">)</span>&nbsp;<span class="op" id="2591922">&lt;</span>&nbsp;<span class="num" id="2591924">2</span>&nbsp;<span class="op" id="2591926">||</span>&nbsp;<span class="ident" id="2591929"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="2591936">(</span><span class="ident" id="2591937"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2591938">[</span><span class="num" id="2591939">0</span><span class="op" id="2591940">]</span><span class="op" id="2591941">)</span>&nbsp;<span class="op" id="2591943">==</span>&nbsp;<span class="ident" id="2591946">nil</span>&nbsp;<span class="op" id="2591950">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591956">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2591968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2591973">for</span>&nbsp;<span class="ident" id="2591977">i</span>&nbsp;<span class="op" id="2591979">:=</span>&nbsp;<span class="num" id="2591982">1</span><span class="op" id="2591983">;</span>&nbsp;<span class="ident" id="2591985"><a href="/net/hosts.go.html#2591977">i</a></span>&nbsp;<span class="op" id="2591987">&lt;</span>&nbsp;<span class="builtinfunc" id="2591989">len</span><span class="op" id="2591992">(</span><span class="ident" id="2591993"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2591994">)</span><span class="op" id="2591995">;</span>&nbsp;<span class="ident" id="2591997"><a href="/net/hosts.go.html#2591977">i</a></span><span class="op" id="2591998">++</span>&nbsp;<span class="op" id="2592001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592007">h</span>&nbsp;<span class="op" id="2592009">:=</span>&nbsp;<span class="ident" id="2592012"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2592013">[</span><span class="ident" id="2592014"><a href="/net/hosts.go.html#2591977">i</a></span><span class="op" id="2592015">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592021"><a href="/net/hosts.go.html#2591588">hs</a></span><span class="op" id="2592023">[</span><span class="ident" id="2592024"><a href="/net/hosts.go.html#2592007">h</a></span><span class="op" id="2592025">]</span>&nbsp;<span class="op" id="2592027">=</span>&nbsp;<span class="builtinfunc" id="2592029">append</span><span class="op" id="2592035">(</span><span class="ident" id="2592036"><a href="/net/hosts.go.html#2591588">hs</a></span><span class="op" id="2592038">[</span><span class="ident" id="2592039"><a href="/net/hosts.go.html#2592007">h</a></span><span class="op" id="2592040">]</span><span class="op" id="2592041">,</span>&nbsp;<span class="ident" id="2592043"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2592044">[</span><span class="num" id="2592045">0</span><span class="op" id="2592046">]</span><span class="op" id="2592047">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592053"><a href="/net/hosts.go.html#2591622">is</a></span><span class="op" id="2592055">[</span><span class="ident" id="2592056"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2592057">[</span><span class="num" id="2592058">0</span><span class="op" id="2592059">]</span><span class="op" id="2592060">]</span>&nbsp;<span class="op" id="2592062">=</span>&nbsp;<span class="builtinfunc" id="2592064">append</span><span class="op" id="2592070">(</span><span class="ident" id="2592071"><a href="/net/hosts.go.html#2591622">is</a></span><span class="op" id="2592073">[</span><span class="ident" id="2592074"><a href="/net/hosts.go.html#2591888">f</a></span><span class="op" id="2592075">[</span><span class="num" id="2592076">0</span><span class="op" id="2592077">]</span><span class="op" id="2592078">]</span><span class="op" id="2592079">,</span>&nbsp;<span class="ident" id="2592081"><a href="/net/hosts.go.html#2592007">h</a></span><span class="op" id="2592082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2592095">//&nbsp;Update&nbsp;the&nbsp;data&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592123"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592128">.</span><span class="ident" id="2592129">expire</span>&nbsp;<span class="op" id="2592136">=</span>&nbsp;<span class="ident" id="2592138"><a href="/net/hosts.go.html#2591475">now</a></span><span class="op" id="2592141">.</span><span class="ident" id="2592142">Add</span><span class="op" id="2592145">(</span><span class="ident" id="2592146"><a href="/net/hosts.go.html#2591190">cacheMaxAge</a></span><span class="op" id="2592157">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592161"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592166">.</span><span class="ident" id="2592167">path</span>&nbsp;<span class="op" id="2592172">=</span>&nbsp;<span class="ident" id="2592174"><a href="/net/hosts.go.html#2591494">hp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592179"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592184">.</span><span class="ident" id="2592185">byName</span>&nbsp;<span class="op" id="2592192">=</span>&nbsp;<span class="ident" id="2592194"><a href="/net/hosts.go.html#2591588">hs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592199"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592204">.</span><span class="ident" id="2592205">byAddr</span>&nbsp;<span class="op" id="2592212">=</span>&nbsp;<span class="ident" id="2592214"><a href="/net/hosts.go.html#2591622">is</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592219"><a href="/net/hosts.go.html#2591660">file</a></span><span class="op" id="2592223">.</span><span class="builtinfunc" id="2592224">close</span><span class="op" id="2592229">(</span><span class="op" id="2592230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592233">}</span><br>
<span class="lineno">60</span><span class="op" id="2592235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2592238">//&nbsp;lookupStaticHost&nbsp;looks&nbsp;up&nbsp;the&nbsp;addresses&nbsp;for&nbsp;the&nbsp;given&nbsp;host&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="2592317">func</span>&nbsp;<span class="ident" id="2592322">lookupStaticHost</span><span class="op" id="2592338">(</span><span class="ident" id="2592339">host</span>&nbsp;<span class="builtintype" id="2592344">string</span><span class="op" id="2592350">)</span>&nbsp;<span class="op" id="2592352">[</span><span class="op" id="2592353">]</span><span class="builtintype" id="2592354">string</span>&nbsp;<span class="op" id="2592361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592364"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592369">.</span><span class="ident" id="2592370">Lock</span><span class="op" id="2592374">(</span><span class="op" id="2592375">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592378">defer</span>&nbsp;<span class="ident" id="2592384"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592389">.</span><span class="ident" id="2592390">Unlock</span><span class="op" id="2592396">(</span><span class="op" id="2592397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592400"><a href="/net/hosts.go.html#2591460">readHosts</a></span><span class="op" id="2592409">(</span><span class="op" id="2592410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592413">if</span>&nbsp;<span class="builtinfunc" id="2592416">len</span><span class="op" id="2592419">(</span><span class="ident" id="2592420"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592425">.</span><span class="ident" id="2592426">byName</span><span class="op" id="2592432">)</span>&nbsp;<span class="op" id="2592434">!=</span>&nbsp;<span class="num" id="2592437">0</span>&nbsp;<span class="op" id="2592439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592443">if</span>&nbsp;<span class="ident" id="2592446">ips</span><span class="op" id="2592449">,</span>&nbsp;<span class="ident" id="2592451">ok</span>&nbsp;<span class="op" id="2592454">:=</span>&nbsp;<span class="ident" id="2592457"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592462">.</span><span class="ident" id="2592463">byName</span><span class="op" id="2592469">[</span><span class="ident" id="2592470"><a href="/net/hosts.go.html#2592339">host</a></span><span class="op" id="2592474">]</span><span class="op" id="2592475">;</span>&nbsp;<span class="ident" id="2592477"><a href="/net/hosts.go.html#2592451">ok</a></span>&nbsp;<span class="op" id="2592480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592485">return</span>&nbsp;<span class="ident" id="2592492"><a href="/net/hosts.go.html#2592446">ips</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592504">return</span>&nbsp;<span class="ident" id="2592511">nil</span><br>
<span class="lineno"></span><span class="op" id="2592515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2592518">//&nbsp;lookupStaticAddr&nbsp;looks&nbsp;up&nbsp;the&nbsp;hosts&nbsp;for&nbsp;the&nbsp;given&nbsp;address&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="2592596">func</span>&nbsp;<span class="ident" id="2592601">lookupStaticAddr</span><span class="op" id="2592617">(</span><span class="ident" id="2592618">addr</span>&nbsp;<span class="builtintype" id="2592623">string</span><span class="op" id="2592629">)</span>&nbsp;<span class="op" id="2592631">[</span><span class="op" id="2592632">]</span><span class="builtintype" id="2592633">string</span>&nbsp;<span class="op" id="2592640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592643"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592648">.</span><span class="ident" id="2592649">Lock</span><span class="op" id="2592653">(</span><span class="op" id="2592654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592657">defer</span>&nbsp;<span class="ident" id="2592663"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592668">.</span><span class="ident" id="2592669">Unlock</span><span class="op" id="2592675">(</span><span class="op" id="2592676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2592679"><a href="/net/hosts.go.html#2591460">readHosts</a></span><span class="op" id="2592688">(</span><span class="op" id="2592689">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592692">if</span>&nbsp;<span class="builtinfunc" id="2592695">len</span><span class="op" id="2592698">(</span><span class="ident" id="2592699"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592704">.</span><span class="ident" id="2592705">byAddr</span><span class="op" id="2592711">)</span>&nbsp;<span class="op" id="2592713">!=</span>&nbsp;<span class="num" id="2592716">0</span>&nbsp;<span class="op" id="2592718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592722">if</span>&nbsp;<span class="ident" id="2592725">hosts</span><span class="op" id="2592730">,</span>&nbsp;<span class="ident" id="2592732">ok</span>&nbsp;<span class="op" id="2592735">:=</span>&nbsp;<span class="ident" id="2592738"><a href="/net/hosts.go.html#2591336">hosts</a></span><span class="op" id="2592743">.</span><span class="ident" id="2592744">byAddr</span><span class="op" id="2592750">[</span><span class="ident" id="2592751"><a href="/net/hosts.go.html#2592618">addr</a></span><span class="op" id="2592755">]</span><span class="op" id="2592756">;</span>&nbsp;<span class="ident" id="2592758"><a href="/net/hosts.go.html#2592732">ok</a></span>&nbsp;<span class="op" id="2592761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592766">return</span>&nbsp;<span class="ident" id="2592773"><a href="/net/hosts.go.html#2592725">hosts</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2592784">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2592787">return</span>&nbsp;<span class="ident" id="2592794">nil</span><br>
<span class="lineno"></span><span class="op" id="2592798">}</span>
</div>
</body>
</html>
