<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8255412">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8255467">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8255521">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8255572">package</span>&nbsp;<span class="ident" id="8255580">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8255590">import</span>&nbsp;<span class="op" id="8255597">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255600">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255609">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255616">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255622">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255635">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255647">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255658">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255669">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8255680">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8255690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8255693">type</span>&nbsp;<span class="ident" id="8255698">dumpTest</span>&nbsp;<span class="keyword" id="8255707">struct</span>&nbsp;<span class="op" id="8255714">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255717">Req</span>&nbsp;&nbsp;<span class="ident" id="8255722">http</span><span class="op" id="8255726">.</span><span class="ident" id="8255727">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255736">Body</span>&nbsp;<span class="keyword" id="8255741">interface</span><span class="op" id="8255750">{</span><span class="op" id="8255751">}</span>&nbsp;<span class="comment" id="8255753">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255819">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8255831">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255839">WantDumpOut</span>&nbsp;<span class="builtintype" id="8255851">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255859">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8255871">bool</span>&nbsp;<span class="comment" id="8255876">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="8255924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8255927">var</span>&nbsp;<span class="ident" id="8255931">dumpTests</span>&nbsp;<span class="op" id="8255941">=</span>&nbsp;<span class="op" id="8255943">[</span><span class="op" id="8255944">]</span><span class="ident" id="8255945">dumpTest</span><span class="op" id="8255953">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8255957">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256013">Req</span><span class="op" id="8256016">:</span>&nbsp;<span class="ident" id="8256018">http</span><span class="op" id="8256022">.</span><span class="ident" id="8256023">Request</span><span class="op" id="8256030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256035">Method</span><span class="op" id="8256041">:</span>&nbsp;<span class="string" id="8256043">&#34;GET&#34;</span><span class="op" id="8256048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256053">URL</span><span class="op" id="8256056">:</span>&nbsp;<span class="op" id="8256058">&amp;</span><span class="ident" id="8256059">url</span><span class="op" id="8256062">.</span><span class="ident" id="8256063">URL</span><span class="op" id="8256066">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256072">Scheme</span><span class="op" id="8256078">:</span>&nbsp;<span class="string" id="8256080">&#34;http&#34;</span><span class="op" id="8256086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256092">Host</span><span class="op" id="8256096">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8256100">&#34;www.google.com&#34;</span><span class="op" id="8256116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256122">Path</span><span class="op" id="8256126">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8256130">&#34;/search&#34;</span><span class="op" id="8256139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256144">}</span><span class="op" id="8256145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256150">ProtoMajor</span><span class="op" id="8256160">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8256168">1</span><span class="op" id="8256169">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256174">ProtoMinor</span><span class="op" id="8256184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8256192">1</span><span class="op" id="8256193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256198">TransferEncoding</span><span class="op" id="8256214">:</span>&nbsp;<span class="op" id="8256216">[</span><span class="op" id="8256217">]</span><span class="builtintype" id="8256218">string</span><span class="op" id="8256224">{</span><span class="string" id="8256225">&#34;chunked&#34;</span><span class="op" id="8256234">}</span><span class="op" id="8256235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256239">}</span><span class="op" id="8256240">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256245">Body</span><span class="op" id="8256249">:</span>&nbsp;<span class="op" id="8256251">[</span><span class="op" id="8256252">]</span><span class="builtintype" id="8256253">byte</span><span class="op" id="8256257">(</span><span class="string" id="8256258">&#34;abcdef&#34;</span><span class="op" id="8256266">)</span><span class="op" id="8256267">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256272">WantDump</span><span class="op" id="8256280">:</span>&nbsp;<span class="string" id="8256282">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8256309">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256314">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8256341">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256346">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8256383">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256388">chunk</span><span class="op" id="8256393">(</span><span class="string" id="8256394">&#34;abcdef&#34;</span><span class="op" id="8256402">)</span>&nbsp;<span class="op" id="8256404">+</span>&nbsp;<span class="ident" id="8256406">chunk</span><span class="op" id="8256411">(</span><span class="string" id="8256412">&#34;&#34;</span><span class="op" id="8256414">)</span><span class="op" id="8256415">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256418">}</span><span class="op" id="8256419">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8256423">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8256506">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256540">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256544">Req</span><span class="op" id="8256547">:</span>&nbsp;<span class="ident" id="8256549">http</span><span class="op" id="8256553">.</span><span class="ident" id="8256554">Request</span><span class="op" id="8256561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256566">Method</span><span class="op" id="8256572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256578">&#34;GET&#34;</span><span class="op" id="8256583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256588">URL</span><span class="op" id="8256591">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256600">mustParseURL</span><span class="op" id="8256612">(</span><span class="string" id="8256613">&#34;/foo&#34;</span><span class="op" id="8256619">)</span><span class="op" id="8256620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256625">ProtoMajor</span><span class="op" id="8256635">:</span>&nbsp;<span class="num" id="8256637">1</span><span class="op" id="8256638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256643">ProtoMinor</span><span class="op" id="8256653">:</span>&nbsp;<span class="num" id="8256655">0</span><span class="op" id="8256656">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256661">Header</span><span class="op" id="8256667">:</span>&nbsp;<span class="ident" id="8256669">http</span><span class="op" id="8256673">.</span><span class="ident" id="8256674">Header</span><span class="op" id="8256680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256686">&#34;X-Foo&#34;</span><span class="op" id="8256693">:</span>&nbsp;<span class="op" id="8256695">[</span><span class="op" id="8256696">]</span><span class="builtintype" id="8256697">string</span><span class="op" id="8256703">{</span><span class="string" id="8256704">&#34;X-Bar&#34;</span><span class="op" id="8256711">}</span><span class="op" id="8256712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256717">}</span><span class="op" id="8256718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256722">}</span><span class="op" id="8256723">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256728">WantDump</span><span class="op" id="8256736">:</span>&nbsp;<span class="string" id="8256738">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="8256762">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256767">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8256789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256792">}</span><span class="op" id="8256793">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256797">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256801">Req</span><span class="op" id="8256804">:</span>&nbsp;<span class="op" id="8256806">*</span><span class="ident" id="8256807">mustNewRequest</span><span class="op" id="8256821">(</span><span class="string" id="8256822">&#34;GET&#34;</span><span class="op" id="8256827">,</span>&nbsp;<span class="string" id="8256829">&#34;http://example.com/foo&#34;</span><span class="op" id="8256853">,</span>&nbsp;<span class="ident" id="8256855">nil</span><span class="op" id="8256858">)</span><span class="op" id="8256859">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256864">WantDumpOut</span><span class="op" id="8256875">:</span>&nbsp;<span class="string" id="8256877">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8256901">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256906">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8256930">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256935">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8256973">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8256978">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8257009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257012">}</span><span class="op" id="8257013">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8257017">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8257081">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8257138">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257156">Req</span><span class="op" id="8257159">:</span>&nbsp;<span class="op" id="8257161">*</span><span class="ident" id="8257162">mustNewRequest</span><span class="op" id="8257176">(</span><span class="string" id="8257177">&#34;GET&#34;</span><span class="op" id="8257182">,</span>&nbsp;<span class="string" id="8257184">&#34;https://example.com/foo&#34;</span><span class="op" id="8257209">,</span>&nbsp;<span class="ident" id="8257211">nil</span><span class="op" id="8257214">)</span><span class="op" id="8257215">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257220">WantDumpOut</span><span class="op" id="8257231">:</span>&nbsp;<span class="string" id="8257233">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8257257">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257262">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8257286">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257291">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8257329">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257334">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8257365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257368">}</span><span class="op" id="8257369">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8257373">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257431">Req</span><span class="op" id="8257434">:</span>&nbsp;<span class="ident" id="8257436">http</span><span class="op" id="8257440">.</span><span class="ident" id="8257441">Request</span><span class="op" id="8257448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257453">Method</span><span class="op" id="8257459">:</span>&nbsp;<span class="string" id="8257461">&#34;POST&#34;</span><span class="op" id="8257467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257472">URL</span><span class="op" id="8257475">:</span>&nbsp;<span class="op" id="8257477">&amp;</span><span class="ident" id="8257478">url</span><span class="op" id="8257481">.</span><span class="ident" id="8257482">URL</span><span class="op" id="8257485">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257491">Scheme</span><span class="op" id="8257497">:</span>&nbsp;<span class="string" id="8257499">&#34;http&#34;</span><span class="op" id="8257505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257511">Host</span><span class="op" id="8257515">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8257519">&#34;post.tld&#34;</span><span class="op" id="8257529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257535">Path</span><span class="op" id="8257539">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8257543">&#34;/&#34;</span><span class="op" id="8257546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257551">}</span><span class="op" id="8257552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257557">ContentLength</span><span class="op" id="8257570">:</span>&nbsp;<span class="num" id="8257572">6</span><span class="op" id="8257573">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257578">ProtoMajor</span><span class="op" id="8257588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8257593">1</span><span class="op" id="8257594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257599">ProtoMinor</span><span class="op" id="8257609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8257614">1</span><span class="op" id="8257615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257619">}</span><span class="op" id="8257620">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257625">Body</span><span class="op" id="8257629">:</span>&nbsp;<span class="op" id="8257631">[</span><span class="op" id="8257632">]</span><span class="builtintype" id="8257633">byte</span><span class="op" id="8257637">(</span><span class="string" id="8257638">&#34;abcdef&#34;</span><span class="op" id="8257646">)</span><span class="op" id="8257647">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257652">WantDumpOut</span><span class="op" id="8257663">:</span>&nbsp;<span class="string" id="8257665">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8257687">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257692">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8257713">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257718">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8257756">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257761">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8257785">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8257790">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="8257821">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257826">NoBody</span><span class="op" id="8257832">:</span>&nbsp;<span class="builtintype" id="8257834">true</span><span class="op" id="8257838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257841">}</span><span class="op" id="8257842">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8257846">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8257897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257901">Req</span><span class="op" id="8257904">:</span>&nbsp;<span class="ident" id="8257906">http</span><span class="op" id="8257910">.</span><span class="ident" id="8257911">Request</span><span class="op" id="8257918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257923">Method</span><span class="op" id="8257929">:</span>&nbsp;<span class="string" id="8257931">&#34;POST&#34;</span><span class="op" id="8257937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257942">URL</span><span class="op" id="8257945">:</span>&nbsp;<span class="op" id="8257947">&amp;</span><span class="ident" id="8257948">url</span><span class="op" id="8257951">.</span><span class="ident" id="8257952">URL</span><span class="op" id="8257955">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257961">Scheme</span><span class="op" id="8257967">:</span>&nbsp;<span class="string" id="8257969">&#34;http&#34;</span><span class="op" id="8257975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8257981">Host</span><span class="op" id="8257985">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8257989">&#34;post.tld&#34;</span><span class="op" id="8257999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258005">Path</span><span class="op" id="8258009">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8258013">&#34;/&#34;</span><span class="op" id="8258016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258021">}</span><span class="op" id="8258022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258027">ContentLength</span><span class="op" id="8258040">:</span>&nbsp;<span class="num" id="8258042">8193</span><span class="op" id="8258046">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258051">ProtoMajor</span><span class="op" id="8258061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8258066">1</span><span class="op" id="8258067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258072">ProtoMinor</span><span class="op" id="8258082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8258087">1</span><span class="op" id="8258088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258092">}</span><span class="op" id="8258093">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258098">Body</span><span class="op" id="8258102">:</span>&nbsp;<span class="ident" id="8258104">bytes</span><span class="op" id="8258109">.</span><span class="ident" id="8258110">Repeat</span><span class="op" id="8258116">(</span><span class="op" id="8258117">[</span><span class="op" id="8258118">]</span><span class="builtintype" id="8258119">byte</span><span class="op" id="8258123">(</span><span class="string" id="8258124">&#34;a&#34;</span><span class="op" id="8258127">)</span><span class="op" id="8258128">,</span>&nbsp;<span class="num" id="8258130">8193</span><span class="op" id="8258134">)</span><span class="op" id="8258135">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258140">WantDumpOut</span><span class="op" id="8258151">:</span>&nbsp;<span class="string" id="8258153">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8258175">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8258180">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="8258201">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8258206">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8258244">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8258249">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="8258276">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8258281">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8258313">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258318">strings</span><span class="op" id="8258325">.</span><span class="ident" id="8258326">Repeat</span><span class="op" id="8258332">(</span><span class="string" id="8258333">&#34;a&#34;</span><span class="op" id="8258336">,</span>&nbsp;<span class="num" id="8258338">8193</span><span class="op" id="8258342">)</span><span class="op" id="8258343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258346">}</span><span class="op" id="8258347">,</span><br>
<span class="lineno"></span><span class="op" id="8258349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="8258352">func</span>&nbsp;<span class="ident" id="8258357">TestDumpRequest</span><span class="op" id="8258372">(</span><span class="ident" id="8258373">t</span>&nbsp;<span class="op" id="8258375">*</span><span class="ident" id="8258376">testing</span><span class="op" id="8258383">.</span><span class="ident" id="8258384">T</span><span class="op" id="8258385">)</span>&nbsp;<span class="op" id="8258387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258390">numg0</span>&nbsp;<span class="op" id="8258396">:=</span>&nbsp;<span class="ident" id="8258399">runtime</span><span class="op" id="8258406">.</span><span class="ident" id="8258407">NumGoroutine</span><span class="op" id="8258419">(</span><span class="op" id="8258420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258423">for</span>&nbsp;<span class="ident" id="8258427">i</span><span class="op" id="8258428">,</span>&nbsp;<span class="ident" id="8258430">tt</span>&nbsp;<span class="op" id="8258433">:=</span>&nbsp;<span class="keyword" id="8258436">range</span>&nbsp;<span class="ident" id="8258442">dumpTests</span>&nbsp;<span class="op" id="8258452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258456">setBody</span>&nbsp;<span class="op" id="8258464">:=</span>&nbsp;<span class="keyword" id="8258467">func</span><span class="op" id="8258471">(</span><span class="op" id="8258472">)</span>&nbsp;<span class="op" id="8258474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258479">if</span>&nbsp;<span class="ident" id="8258482">tt</span><span class="op" id="8258484">.</span><span class="ident" id="8258485">Body</span>&nbsp;<span class="op" id="8258490">==</span>&nbsp;<span class="ident" id="8258493">nil</span>&nbsp;<span class="op" id="8258497">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258503">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258518">switch</span>&nbsp;<span class="ident" id="8258525">b</span>&nbsp;<span class="op" id="8258527">:=</span>&nbsp;<span class="ident" id="8258530">tt</span><span class="op" id="8258532">.</span><span class="ident" id="8258533">Body</span><span class="op" id="8258537">.</span><span class="op" id="8258538">(</span><span class="keyword" id="8258539">type</span><span class="op" id="8258543">)</span>&nbsp;<span class="op" id="8258545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258550">case</span>&nbsp;<span class="op" id="8258555">[</span><span class="op" id="8258556">]</span><span class="builtintype" id="8258557">byte</span><span class="op" id="8258561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258567">tt</span><span class="op" id="8258569">.</span><span class="ident" id="8258570">Req</span><span class="op" id="8258573">.</span><span class="ident" id="8258574">Body</span>&nbsp;<span class="op" id="8258579">=</span>&nbsp;<span class="ident" id="8258581">ioutil</span><span class="op" id="8258587">.</span><span class="ident" id="8258588">NopCloser</span><span class="op" id="8258597">(</span><span class="ident" id="8258598">bytes</span><span class="op" id="8258603">.</span><span class="ident" id="8258604">NewReader</span><span class="op" id="8258613">(</span><span class="ident" id="8258614">b</span><span class="op" id="8258615">)</span><span class="op" id="8258616">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258621">case</span>&nbsp;<span class="keyword" id="8258626">func</span><span class="op" id="8258630">(</span><span class="op" id="8258631">)</span>&nbsp;<span class="ident" id="8258633">io</span><span class="op" id="8258635">.</span><span class="ident" id="8258636">ReadCloser</span><span class="op" id="8258646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258652">tt</span><span class="op" id="8258654">.</span><span class="ident" id="8258655">Req</span><span class="op" id="8258658">.</span><span class="ident" id="8258659">Body</span>&nbsp;<span class="op" id="8258664">=</span>&nbsp;<span class="ident" id="8258666">b</span><span class="op" id="8258667">(</span><span class="op" id="8258668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258673">default</span><span class="op" id="8258680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258686">t</span><span class="op" id="8258687">.</span><span class="ident" id="8258688">Fatalf</span><span class="op" id="8258694">(</span><span class="string" id="8258695">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="8258728">,</span>&nbsp;<span class="ident" id="8258730">i</span><span class="op" id="8258731">,</span>&nbsp;<span class="ident" id="8258733">tt</span><span class="op" id="8258735">.</span><span class="ident" id="8258736">Body</span><span class="op" id="8258740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258745">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258753">setBody</span><span class="op" id="8258760">(</span><span class="op" id="8258761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258765">if</span>&nbsp;<span class="ident" id="8258768">tt</span><span class="op" id="8258770">.</span><span class="ident" id="8258771">Req</span><span class="op" id="8258774">.</span><span class="ident" id="8258775">Header</span>&nbsp;<span class="op" id="8258782">==</span>&nbsp;<span class="ident" id="8258785">nil</span>&nbsp;<span class="op" id="8258789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258794">tt</span><span class="op" id="8258796">.</span><span class="ident" id="8258797">Req</span><span class="op" id="8258800">.</span><span class="ident" id="8258801">Header</span>&nbsp;<span class="op" id="8258808">=</span>&nbsp;<span class="builtinfunc" id="8258810">make</span><span class="op" id="8258814">(</span><span class="ident" id="8258815">http</span><span class="op" id="8258819">.</span><span class="ident" id="8258820">Header</span><span class="op" id="8258826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258830">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258835">if</span>&nbsp;<span class="ident" id="8258838">tt</span><span class="op" id="8258840">.</span><span class="ident" id="8258841">WantDump</span>&nbsp;<span class="op" id="8258850">!=</span>&nbsp;<span class="string" id="8258853">&#34;&#34;</span>&nbsp;<span class="op" id="8258856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258861">setBody</span><span class="op" id="8258868">(</span><span class="op" id="8258869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258874">dump</span><span class="op" id="8258878">,</span>&nbsp;<span class="ident" id="8258880">err</span>&nbsp;<span class="op" id="8258884">:=</span>&nbsp;<span class="ident" id="8258887">DumpRequest</span><span class="op" id="8258898">(</span><span class="op" id="8258899">&amp;</span><span class="ident" id="8258900">tt</span><span class="op" id="8258902">.</span><span class="ident" id="8258903">Req</span><span class="op" id="8258906">,</span>&nbsp;<span class="op" id="8258908">!</span><span class="ident" id="8258909">tt</span><span class="op" id="8258911">.</span><span class="ident" id="8258912">NoBody</span><span class="op" id="8258918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258923">if</span>&nbsp;<span class="ident" id="8258926">err</span>&nbsp;<span class="op" id="8258930">!=</span>&nbsp;<span class="ident" id="8258933">nil</span>&nbsp;<span class="op" id="8258937">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8258943">t</span><span class="op" id="8258944">.</span><span class="ident" id="8258945">Errorf</span><span class="op" id="8258951">(</span><span class="string" id="8258952">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8258973">,</span>&nbsp;<span class="ident" id="8258975">i</span><span class="op" id="8258976">,</span>&nbsp;<span class="ident" id="8258978">err</span><span class="op" id="8258981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8258987">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8258999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259004">if</span>&nbsp;<span class="builtintype" id="8259007">string</span><span class="op" id="8259013">(</span><span class="ident" id="8259014">dump</span><span class="op" id="8259018">)</span>&nbsp;<span class="op" id="8259020">!=</span>&nbsp;<span class="ident" id="8259023">tt</span><span class="op" id="8259025">.</span><span class="ident" id="8259026">WantDump</span>&nbsp;<span class="op" id="8259035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259041">t</span><span class="op" id="8259042">.</span><span class="ident" id="8259043">Errorf</span><span class="op" id="8259049">(</span><span class="string" id="8259050">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8259094">,</span>&nbsp;<span class="ident" id="8259096">i</span><span class="op" id="8259097">,</span>&nbsp;<span class="ident" id="8259099">tt</span><span class="op" id="8259101">.</span><span class="ident" id="8259102">WantDump</span><span class="op" id="8259110">,</span>&nbsp;<span class="builtintype" id="8259112">string</span><span class="op" id="8259118">(</span><span class="ident" id="8259119">dump</span><span class="op" id="8259123">)</span><span class="op" id="8259124">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259130">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259151">if</span>&nbsp;<span class="ident" id="8259154">tt</span><span class="op" id="8259156">.</span><span class="ident" id="8259157">WantDumpOut</span>&nbsp;<span class="op" id="8259169">!=</span>&nbsp;<span class="string" id="8259172">&#34;&#34;</span>&nbsp;<span class="op" id="8259175">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259180">setBody</span><span class="op" id="8259187">(</span><span class="op" id="8259188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259193">dump</span><span class="op" id="8259197">,</span>&nbsp;<span class="ident" id="8259199">err</span>&nbsp;<span class="op" id="8259203">:=</span>&nbsp;<span class="ident" id="8259206">DumpRequestOut</span><span class="op" id="8259220">(</span><span class="op" id="8259221">&amp;</span><span class="ident" id="8259222">tt</span><span class="op" id="8259224">.</span><span class="ident" id="8259225">Req</span><span class="op" id="8259228">,</span>&nbsp;<span class="op" id="8259230">!</span><span class="ident" id="8259231">tt</span><span class="op" id="8259233">.</span><span class="ident" id="8259234">NoBody</span><span class="op" id="8259240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259245">if</span>&nbsp;<span class="ident" id="8259248">err</span>&nbsp;<span class="op" id="8259252">!=</span>&nbsp;<span class="ident" id="8259255">nil</span>&nbsp;<span class="op" id="8259259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259265">t</span><span class="op" id="8259266">.</span><span class="ident" id="8259267">Errorf</span><span class="op" id="8259273">(</span><span class="string" id="8259274">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8259298">,</span>&nbsp;<span class="ident" id="8259300">i</span><span class="op" id="8259301">,</span>&nbsp;<span class="ident" id="8259303">err</span><span class="op" id="8259306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259312">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259329">if</span>&nbsp;<span class="builtintype" id="8259332">string</span><span class="op" id="8259338">(</span><span class="ident" id="8259339">dump</span><span class="op" id="8259343">)</span>&nbsp;<span class="op" id="8259345">!=</span>&nbsp;<span class="ident" id="8259348">tt</span><span class="op" id="8259350">.</span><span class="ident" id="8259351">WantDumpOut</span>&nbsp;<span class="op" id="8259363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259369">t</span><span class="op" id="8259370">.</span><span class="ident" id="8259371">Errorf</span><span class="op" id="8259377">(</span><span class="string" id="8259378">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8259425">,</span>&nbsp;<span class="ident" id="8259427">i</span><span class="op" id="8259428">,</span>&nbsp;<span class="ident" id="8259430">tt</span><span class="op" id="8259432">.</span><span class="ident" id="8259433">WantDumpOut</span><span class="op" id="8259444">,</span>&nbsp;<span class="builtintype" id="8259446">string</span><span class="op" id="8259452">(</span><span class="ident" id="8259453">dump</span><span class="op" id="8259457">)</span><span class="op" id="8259458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259464">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259476">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259486">if</span>&nbsp;<span class="ident" id="8259489">dg</span>&nbsp;<span class="op" id="8259492">:=</span>&nbsp;<span class="ident" id="8259495">runtime</span><span class="op" id="8259502">.</span><span class="ident" id="8259503">NumGoroutine</span><span class="op" id="8259515">(</span><span class="op" id="8259516">)</span>&nbsp;<span class="op" id="8259518">-</span>&nbsp;<span class="ident" id="8259520">numg0</span><span class="op" id="8259525">;</span>&nbsp;<span class="ident" id="8259527">dg</span>&nbsp;<span class="op" id="8259530">&gt;</span>&nbsp;<span class="num" id="8259532">4</span>&nbsp;<span class="op" id="8259534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259538">buf</span>&nbsp;<span class="op" id="8259542">:=</span>&nbsp;<span class="builtinfunc" id="8259545">make</span><span class="op" id="8259549">(</span><span class="op" id="8259550">[</span><span class="op" id="8259551">]</span><span class="builtintype" id="8259552">byte</span><span class="op" id="8259556">,</span>&nbsp;<span class="num" id="8259558">4096</span><span class="op" id="8259562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259566">buf</span>&nbsp;<span class="op" id="8259570">=</span>&nbsp;<span class="ident" id="8259572">buf</span><span class="op" id="8259575">[</span><span class="op" id="8259576">:</span><span class="ident" id="8259577">runtime</span><span class="op" id="8259584">.</span><span class="ident" id="8259585">Stack</span><span class="op" id="8259590">(</span><span class="ident" id="8259591">buf</span><span class="op" id="8259594">,</span>&nbsp;<span class="builtintype" id="8259596">true</span><span class="op" id="8259600">)</span><span class="op" id="8259601">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259605">t</span><span class="op" id="8259606">.</span><span class="ident" id="8259607">Errorf</span><span class="op" id="8259613">(</span><span class="string" id="8259614">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="8259671">,</span>&nbsp;<span class="ident" id="8259673">dg</span><span class="op" id="8259675">,</span>&nbsp;<span class="ident" id="8259677">buf</span><span class="op" id="8259680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259683">}</span><br>
<span class="lineno"></span><span class="op" id="8259685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8259688">func</span>&nbsp;<span class="ident" id="8259693">chunk</span><span class="op" id="8259698">(</span><span class="ident" id="8259699">s</span>&nbsp;<span class="builtintype" id="8259701">string</span><span class="op" id="8259707">)</span>&nbsp;<span class="builtintype" id="8259709">string</span>&nbsp;<span class="op" id="8259716">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259719">return</span>&nbsp;<span class="ident" id="8259726">fmt</span><span class="op" id="8259729">.</span><span class="ident" id="8259730">Sprintf</span><span class="op" id="8259737">(</span><span class="string" id="8259738">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8259752">,</span>&nbsp;<span class="builtinfunc" id="8259754">len</span><span class="op" id="8259757">(</span><span class="ident" id="8259758">s</span><span class="op" id="8259759">)</span><span class="op" id="8259760">,</span>&nbsp;<span class="ident" id="8259762">s</span><span class="op" id="8259763">)</span><br>
<span class="lineno"></span><span class="op" id="8259765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8259768">func</span>&nbsp;<span class="ident" id="8259773">mustParseURL</span><span class="op" id="8259785">(</span><span class="ident" id="8259786">s</span>&nbsp;<span class="builtintype" id="8259788">string</span><span class="op" id="8259794">)</span>&nbsp;<span class="op" id="8259796">*</span><span class="ident" id="8259797">url</span><span class="op" id="8259800">.</span><span class="ident" id="8259801">URL</span>&nbsp;<span class="op" id="8259805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259808">u</span><span class="op" id="8259809">,</span>&nbsp;<span class="ident" id="8259811">err</span>&nbsp;<span class="op" id="8259815">:=</span>&nbsp;<span class="ident" id="8259818">url</span><span class="op" id="8259821">.</span><span class="ident" id="8259822">Parse</span><span class="op" id="8259827">(</span><span class="ident" id="8259828">s</span><span class="op" id="8259829">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259832">if</span>&nbsp;<span class="ident" id="8259835">err</span>&nbsp;<span class="op" id="8259839">!=</span>&nbsp;<span class="ident" id="8259842">nil</span>&nbsp;<span class="op" id="8259846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8259850">panic</span><span class="op" id="8259855">(</span><span class="ident" id="8259856">fmt</span><span class="op" id="8259859">.</span><span class="ident" id="8259860">Sprintf</span><span class="op" id="8259867">(</span><span class="string" id="8259868">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8259894">,</span>&nbsp;<span class="ident" id="8259896">s</span><span class="op" id="8259897">,</span>&nbsp;<span class="ident" id="8259899">err</span><span class="op" id="8259902">)</span><span class="op" id="8259903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8259906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8259909">return</span>&nbsp;<span class="ident" id="8259916">u</span><br>
<span class="lineno"></span><span class="op" id="8259918">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="8259921">func</span>&nbsp;<span class="ident" id="8259926">mustNewRequest</span><span class="op" id="8259940">(</span><span class="ident" id="8259941">method</span><span class="op" id="8259947">,</span>&nbsp;<span class="ident" id="8259949">url</span>&nbsp;<span class="builtintype" id="8259953">string</span><span class="op" id="8259959">,</span>&nbsp;<span class="ident" id="8259961">body</span>&nbsp;<span class="ident" id="8259966">io</span><span class="op" id="8259968">.</span><span class="ident" id="8259969">Reader</span><span class="op" id="8259975">)</span>&nbsp;<span class="op" id="8259977">*</span><span class="ident" id="8259978">http</span><span class="op" id="8259982">.</span><span class="ident" id="8259983">Request</span>&nbsp;<span class="op" id="8259991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8259994">req</span><span class="op" id="8259997">,</span>&nbsp;<span class="ident" id="8259999">err</span>&nbsp;<span class="op" id="8260003">:=</span>&nbsp;<span class="ident" id="8260006">http</span><span class="op" id="8260010">.</span><span class="ident" id="8260011">NewRequest</span><span class="op" id="8260021">(</span><span class="ident" id="8260022">method</span><span class="op" id="8260028">,</span>&nbsp;<span class="ident" id="8260030">url</span><span class="op" id="8260033">,</span>&nbsp;<span class="ident" id="8260035">body</span><span class="op" id="8260039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8260042">if</span>&nbsp;<span class="ident" id="8260045">err</span>&nbsp;<span class="op" id="8260049">!=</span>&nbsp;<span class="ident" id="8260052">nil</span>&nbsp;<span class="op" id="8260056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8260060">panic</span><span class="op" id="8260065">(</span><span class="ident" id="8260066">fmt</span><span class="op" id="8260069">.</span><span class="ident" id="8260070">Sprintf</span><span class="op" id="8260077">(</span><span class="string" id="8260078">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8260111">,</span>&nbsp;<span class="ident" id="8260113">method</span><span class="op" id="8260119">,</span>&nbsp;<span class="ident" id="8260121">url</span><span class="op" id="8260124">,</span>&nbsp;<span class="ident" id="8260126">body</span><span class="op" id="8260130">,</span>&nbsp;<span class="ident" id="8260132">err</span><span class="op" id="8260135">)</span><span class="op" id="8260136">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8260142">return</span>&nbsp;<span class="ident" id="8260149">req</span><br>
<span class="lineno"></span><span class="op" id="8260153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8260156">var</span>&nbsp;<span class="ident" id="8260160">dumpResTests</span>&nbsp;<span class="op" id="8260173">=</span>&nbsp;<span class="op" id="8260175">[</span><span class="op" id="8260176">]</span><span class="keyword" id="8260177">struct</span>&nbsp;<span class="op" id="8260184">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260187">res</span>&nbsp;&nbsp;<span class="op" id="8260192">*</span><span class="ident" id="8260193">http</span><span class="op" id="8260197">.</span><span class="ident" id="8260198">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260208">body</span>&nbsp;<span class="builtintype" id="8260213">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260219">want</span>&nbsp;<span class="builtintype" id="8260224">string</span><br>
<span class="lineno"></span><span class="op" id="8260231">}</span><span class="op" id="8260232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260235">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260239">res</span><span class="op" id="8260242">:</span>&nbsp;<span class="op" id="8260244">&amp;</span><span class="ident" id="8260245">http</span><span class="op" id="8260249">.</span><span class="ident" id="8260250">Response</span><span class="op" id="8260258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260263">Status</span><span class="op" id="8260269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260278">&#34;200&nbsp;OK&#34;</span><span class="op" id="8260286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260291">StatusCode</span><span class="op" id="8260301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260306">200</span><span class="op" id="8260309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260314">Proto</span><span class="op" id="8260319">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260329">&#34;HTTP/1.1&#34;</span><span class="op" id="8260339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260344">ProtoMajor</span><span class="op" id="8260354">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260359">1</span><span class="op" id="8260360">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260365">ProtoMinor</span><span class="op" id="8260375">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260380">1</span><span class="op" id="8260381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260386">ContentLength</span><span class="op" id="8260399">:</span>&nbsp;<span class="num" id="8260401">50</span><span class="op" id="8260403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260408">Header</span><span class="op" id="8260414">:</span>&nbsp;<span class="ident" id="8260416">http</span><span class="op" id="8260420">.</span><span class="ident" id="8260421">Header</span><span class="op" id="8260427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8260433">&#34;Foo&#34;</span><span class="op" id="8260438">:</span>&nbsp;<span class="op" id="8260440">[</span><span class="op" id="8260441">]</span><span class="builtintype" id="8260442">string</span><span class="op" id="8260448">{</span><span class="string" id="8260449">&#34;Bar&#34;</span><span class="op" id="8260454">}</span><span class="op" id="8260455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260460">}</span><span class="op" id="8260461">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260466">Body</span><span class="op" id="8260470">:</span>&nbsp;<span class="ident" id="8260472">ioutil</span><span class="op" id="8260478">.</span><span class="ident" id="8260479">NopCloser</span><span class="op" id="8260488">(</span><span class="ident" id="8260489">strings</span><span class="op" id="8260496">.</span><span class="ident" id="8260497">NewReader</span><span class="op" id="8260506">(</span><span class="string" id="8260507">&#34;foo&#34;</span><span class="op" id="8260512">)</span><span class="op" id="8260513">)</span><span class="op" id="8260514">,</span>&nbsp;<span class="comment" id="8260516">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260539">}</span><span class="op" id="8260540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260544">body</span><span class="op" id="8260548">:</span>&nbsp;<span class="builtintype" id="8260550">false</span><span class="op" id="8260555">,</span>&nbsp;<span class="comment" id="8260557">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260599">want</span><span class="op" id="8260603">:</span>&nbsp;<span class="string" id="8260605">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="8260650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260653">}</span><span class="op" id="8260654">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260662">res</span><span class="op" id="8260665">:</span>&nbsp;<span class="op" id="8260667">&amp;</span><span class="ident" id="8260668">http</span><span class="op" id="8260672">.</span><span class="ident" id="8260673">Response</span><span class="op" id="8260681">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260686">Status</span><span class="op" id="8260692">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260701">&#34;200&nbsp;OK&#34;</span><span class="op" id="8260709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260714">StatusCode</span><span class="op" id="8260724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260729">200</span><span class="op" id="8260732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260737">Proto</span><span class="op" id="8260742">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260752">&#34;HTTP/1.1&#34;</span><span class="op" id="8260762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260767">ProtoMajor</span><span class="op" id="8260777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260782">1</span><span class="op" id="8260783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260788">ProtoMinor</span><span class="op" id="8260798">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260803">1</span><span class="op" id="8260804">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260809">ContentLength</span><span class="op" id="8260822">:</span>&nbsp;<span class="num" id="8260824">3</span><span class="op" id="8260825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260830">Body</span><span class="op" id="8260834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260845">ioutil</span><span class="op" id="8260851">.</span><span class="ident" id="8260852">NopCloser</span><span class="op" id="8260861">(</span><span class="ident" id="8260862">strings</span><span class="op" id="8260869">.</span><span class="ident" id="8260870">NewReader</span><span class="op" id="8260879">(</span><span class="string" id="8260880">&#34;foo&#34;</span><span class="op" id="8260885">)</span><span class="op" id="8260886">)</span><span class="op" id="8260887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260891">}</span><span class="op" id="8260892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260896">body</span><span class="op" id="8260900">:</span>&nbsp;<span class="builtintype" id="8260902">true</span><span class="op" id="8260906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260910">want</span><span class="op" id="8260914">:</span>&nbsp;<span class="string" id="8260916">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="8260956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260959">}</span><span class="op" id="8260960">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8260964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260968">res</span><span class="op" id="8260971">:</span>&nbsp;<span class="op" id="8260973">&amp;</span><span class="ident" id="8260974">http</span><span class="op" id="8260978">.</span><span class="ident" id="8260979">Response</span><span class="op" id="8260987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8260992">Status</span><span class="op" id="8260998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261010">&#34;200&nbsp;OK&#34;</span><span class="op" id="8261018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261023">StatusCode</span><span class="op" id="8261033">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8261041">200</span><span class="op" id="8261044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261049">Proto</span><span class="op" id="8261054">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261067">&#34;HTTP/1.1&#34;</span><span class="op" id="8261077">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261082">ProtoMajor</span><span class="op" id="8261092">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8261100">1</span><span class="op" id="8261101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261106">ProtoMinor</span><span class="op" id="8261116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8261124">1</span><span class="op" id="8261125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261130">ContentLength</span><span class="op" id="8261143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261148">-</span><span class="num" id="8261149">1</span><span class="op" id="8261150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261155">Body</span><span class="op" id="8261159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261173">ioutil</span><span class="op" id="8261179">.</span><span class="ident" id="8261180">NopCloser</span><span class="op" id="8261189">(</span><span class="ident" id="8261190">strings</span><span class="op" id="8261197">.</span><span class="ident" id="8261198">NewReader</span><span class="op" id="8261207">(</span><span class="string" id="8261208">&#34;foo&#34;</span><span class="op" id="8261213">)</span><span class="op" id="8261214">)</span><span class="op" id="8261215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261220">TransferEncoding</span><span class="op" id="8261236">:</span>&nbsp;<span class="op" id="8261238">[</span><span class="op" id="8261239">]</span><span class="builtintype" id="8261240">string</span><span class="op" id="8261246">{</span><span class="string" id="8261247">&#34;chunked&#34;</span><span class="op" id="8261256">}</span><span class="op" id="8261257">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8261261">}</span><span class="op" id="8261262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261266">body</span><span class="op" id="8261270">:</span>&nbsp;<span class="builtintype" id="8261272">true</span><span class="op" id="8261276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261280">want</span><span class="op" id="8261284">:</span>&nbsp;<span class="string" id="8261286">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="8261339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8261342">}</span><span class="op" id="8261343">,</span><br>
<span class="lineno"></span><span class="op" id="8261345">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="8261348">func</span>&nbsp;<span class="ident" id="8261353">TestDumpResponse</span><span class="op" id="8261369">(</span><span class="ident" id="8261370">t</span>&nbsp;<span class="op" id="8261372">*</span><span class="ident" id="8261373">testing</span><span class="op" id="8261380">.</span><span class="ident" id="8261381">T</span><span class="op" id="8261382">)</span>&nbsp;<span class="op" id="8261384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8261387">for</span>&nbsp;<span class="ident" id="8261391">i</span><span class="op" id="8261392">,</span>&nbsp;<span class="ident" id="8261394">tt</span>&nbsp;<span class="op" id="8261397">:=</span>&nbsp;<span class="keyword" id="8261400">range</span>&nbsp;<span class="ident" id="8261406">dumpResTests</span>&nbsp;<span class="op" id="8261419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261423">gotb</span><span class="op" id="8261427">,</span>&nbsp;<span class="ident" id="8261429">err</span>&nbsp;<span class="op" id="8261433">:=</span>&nbsp;<span class="ident" id="8261436">DumpResponse</span><span class="op" id="8261448">(</span><span class="ident" id="8261449">tt</span><span class="op" id="8261451">.</span><span class="ident" id="8261452">res</span><span class="op" id="8261455">,</span>&nbsp;<span class="ident" id="8261457">tt</span><span class="op" id="8261459">.</span><span class="ident" id="8261460">body</span><span class="op" id="8261464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8261468">if</span>&nbsp;<span class="ident" id="8261471">err</span>&nbsp;<span class="op" id="8261475">!=</span>&nbsp;<span class="ident" id="8261478">nil</span>&nbsp;<span class="op" id="8261482">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261487">t</span><span class="op" id="8261488">.</span><span class="ident" id="8261489">Errorf</span><span class="op" id="8261495">(</span><span class="string" id="8261496">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8261519">,</span>&nbsp;<span class="ident" id="8261521">i</span><span class="op" id="8261522">,</span>&nbsp;<span class="ident" id="8261524">err</span><span class="op" id="8261527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8261532">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8261543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261547">got</span>&nbsp;<span class="op" id="8261551">:=</span>&nbsp;<span class="builtintype" id="8261554">string</span><span class="op" id="8261560">(</span><span class="ident" id="8261561">gotb</span><span class="op" id="8261565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261569">got</span>&nbsp;<span class="op" id="8261573">=</span>&nbsp;<span class="ident" id="8261575">strings</span><span class="op" id="8261582">.</span><span class="ident" id="8261583">TrimSpace</span><span class="op" id="8261592">(</span><span class="ident" id="8261593">got</span><span class="op" id="8261596">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261600">got</span>&nbsp;<span class="op" id="8261604">=</span>&nbsp;<span class="ident" id="8261606">strings</span><span class="op" id="8261613">.</span><span class="ident" id="8261614">Replace</span><span class="op" id="8261621">(</span><span class="ident" id="8261622">got</span><span class="op" id="8261625">,</span>&nbsp;<span class="string" id="8261627">&#34;\r&#34;</span><span class="op" id="8261631">,</span>&nbsp;<span class="string" id="8261633">&#34;&#34;</span><span class="op" id="8261635">,</span>&nbsp;<span class="op" id="8261637">-</span><span class="num" id="8261638">1</span><span class="op" id="8261639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8261644">if</span>&nbsp;<span class="ident" id="8261647">got</span>&nbsp;<span class="op" id="8261651">!=</span>&nbsp;<span class="ident" id="8261654">tt</span><span class="op" id="8261656">.</span><span class="ident" id="8261657">want</span>&nbsp;<span class="op" id="8261662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8261667">t</span><span class="op" id="8261668">.</span><span class="ident" id="8261669">Errorf</span><span class="op" id="8261675">(</span><span class="string" id="8261676">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="8261719">,</span>&nbsp;<span class="ident" id="8261721">i</span><span class="op" id="8261722">,</span>&nbsp;<span class="ident" id="8261724">got</span><span class="op" id="8261727">,</span>&nbsp;<span class="ident" id="8261729">tt</span><span class="op" id="8261731">.</span><span class="ident" id="8261732">want</span><span class="op" id="8261736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8261740">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8261743">}</span><br>
<span class="lineno"></span><span class="op" id="8261745">}</span>
</div>
</body>
</html>
