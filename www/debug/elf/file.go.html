<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5366519">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5366575">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5366629">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5366680">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5366734">package</span>&nbsp;<span class="ident" id="5366742">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5366747">import</span>&nbsp;<span class="op" id="5366754">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366757">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366766">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366781">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366800">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366810">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366817">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5366823">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5366828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5366831">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5366864">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5366903">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5366950">type</span>&nbsp;<span class="ident" id="5366955">FileHeader</span>&nbsp;<span class="keyword" id="5366966">struct</span>&nbsp;<span class="op" id="5366973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366976">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5366987">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5366994">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367005">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367011">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367022">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367031">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367042">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367049">ABIVersion</span>&nbsp;<span class="builtintype" id="5367060">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367067">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5367078">binary</span><span class="op" id="5367084">.</span><span class="ident" id="5367085">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367096">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367107">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367113">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367124">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367133">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367144">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5367151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5367154">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5367193">type</span>&nbsp;<span class="ident" id="5367198">File</span>&nbsp;<span class="keyword" id="5367203">struct</span>&nbsp;<span class="op" id="5367210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367213">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367225">Sections</span>&nbsp;&nbsp;<span class="op" id="5367235">[</span><span class="op" id="5367236">]</span><span class="op" id="5367237">*</span><span class="ident" id="5367238">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367247">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5367257">[</span><span class="op" id="5367258">]</span><span class="op" id="5367259">*</span><span class="ident" id="5367260">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367266">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367276">io</span><span class="op" id="5367278">.</span><span class="ident" id="5367279">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367287">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5367297">[</span><span class="op" id="5367298">]</span><span class="ident" id="5367299">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367308">gnuVersym</span>&nbsp;<span class="op" id="5367318">[</span><span class="op" id="5367319">]</span><span class="builtintype" id="5367320">byte</span><br>
<span class="lineno">45</span><span class="op" id="5367325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5367328">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5367387">type</span>&nbsp;<span class="ident" id="5367392">SectionHeader</span>&nbsp;<span class="keyword" id="5367406">struct</span>&nbsp;<span class="op" id="5367413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367416">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5367426">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367434">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367444">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367457">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367467">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367480">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367490">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367498">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367508">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367516">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5367526">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367534">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5367544">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367552">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5367562">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367570">Addralign</span>&nbsp;<span class="ident" id="5367580">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367588">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5367598">uint64</span><br>
<span class="lineno"></span><span class="op" id="5367605">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5367608">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5367665">type</span>&nbsp;<span class="ident" id="5367670">Section</span>&nbsp;<span class="keyword" id="5367678">struct</span>&nbsp;<span class="op" id="5367685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367688">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367704">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367742">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367782">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367817">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367865">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5367915">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367939">io</span><span class="op" id="5367941">.</span><span class="ident" id="5367942">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5367952">sr</span>&nbsp;<span class="op" id="5367955">*</span><span class="ident" id="5367956">io</span><span class="op" id="5367958">.</span><span class="ident" id="5367959">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5367973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5367976">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5368035">func</span>&nbsp;<span class="op" id="5368040">(</span><span class="ident" id="5368041">s</span>&nbsp;<span class="op" id="5368043">*</span><span class="ident" id="5368044">Section</span><span class="op" id="5368051">)</span>&nbsp;<span class="ident" id="5368053">Data</span><span class="op" id="5368057">(</span><span class="op" id="5368058">)</span>&nbsp;<span class="op" id="5368060">(</span><span class="op" id="5368061">[</span><span class="op" id="5368062">]</span><span class="builtintype" id="5368063">byte</span><span class="op" id="5368067">,</span>&nbsp;<span class="builtintype" id="5368069">error</span><span class="op" id="5368074">)</span>&nbsp;<span class="op" id="5368076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368079">dat</span>&nbsp;<span class="op" id="5368083">:=</span>&nbsp;<span class="builtinfunc" id="5368086">make</span><span class="op" id="5368090">(</span><span class="op" id="5368091">[</span><span class="op" id="5368092">]</span><span class="builtintype" id="5368093">byte</span><span class="op" id="5368097">,</span>&nbsp;<span class="ident" id="5368099">s</span><span class="op" id="5368100">.</span><span class="ident" id="5368101">sr</span><span class="op" id="5368103">.</span><span class="ident" id="5368104">Size</span><span class="op" id="5368108">(</span><span class="op" id="5368109">)</span><span class="op" id="5368110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368113">n</span><span class="op" id="5368114">,</span>&nbsp;<span class="ident" id="5368116">err</span>&nbsp;<span class="op" id="5368120">:=</span>&nbsp;<span class="ident" id="5368123">s</span><span class="op" id="5368124">.</span><span class="ident" id="5368125">sr</span><span class="op" id="5368127">.</span><span class="ident" id="5368128">ReadAt</span><span class="op" id="5368134">(</span><span class="ident" id="5368135">dat</span><span class="op" id="5368138">,</span>&nbsp;<span class="num" id="5368140">0</span><span class="op" id="5368141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368144">if</span>&nbsp;<span class="ident" id="5368147">n</span>&nbsp;<span class="op" id="5368149">==</span>&nbsp;<span class="builtinfunc" id="5368152">len</span><span class="op" id="5368155">(</span><span class="ident" id="5368156">dat</span><span class="op" id="5368159">)</span>&nbsp;<span class="op" id="5368161">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368165">err</span>&nbsp;<span class="op" id="5368169">=</span>&nbsp;<span class="ident" id="5368171">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368179">return</span>&nbsp;<span class="ident" id="5368186">dat</span><span class="op" id="5368189">[</span><span class="num" id="5368190">0</span><span class="op" id="5368191">:</span><span class="ident" id="5368192">n</span><span class="op" id="5368193">]</span><span class="op" id="5368194">,</span>&nbsp;<span class="ident" id="5368196">err</span><br>
<span class="lineno"></span><span class="op" id="5368200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5368203">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5368266">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5368291">func</span>&nbsp;<span class="op" id="5368296">(</span><span class="ident" id="5368297">f</span>&nbsp;<span class="op" id="5368299">*</span><span class="ident" id="5368300">File</span><span class="op" id="5368304">)</span>&nbsp;<span class="ident" id="5368306">stringTable</span><span class="op" id="5368317">(</span><span class="ident" id="5368318">link</span>&nbsp;<span class="builtintype" id="5368323">uint32</span><span class="op" id="5368329">)</span>&nbsp;<span class="op" id="5368331">(</span><span class="op" id="5368332">[</span><span class="op" id="5368333">]</span><span class="builtintype" id="5368334">byte</span><span class="op" id="5368338">,</span>&nbsp;<span class="builtintype" id="5368340">error</span><span class="op" id="5368345">)</span>&nbsp;<span class="op" id="5368347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368350">if</span>&nbsp;<span class="ident" id="5368353">link</span>&nbsp;<span class="op" id="5368358">&lt;=</span>&nbsp;<span class="num" id="5368361">0</span>&nbsp;<span class="op" id="5368363">||</span>&nbsp;<span class="ident" id="5368366">link</span>&nbsp;<span class="op" id="5368371">&gt;=</span>&nbsp;<span class="builtintype" id="5368374">uint32</span><span class="op" id="5368380">(</span><span class="builtinfunc" id="5368381">len</span><span class="op" id="5368384">(</span><span class="ident" id="5368385">f</span><span class="op" id="5368386">.</span><span class="ident" id="5368387">Sections</span><span class="op" id="5368395">)</span><span class="op" id="5368396">)</span>&nbsp;<span class="op" id="5368398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368402">return</span>&nbsp;<span class="ident" id="5368409">nil</span><span class="op" id="5368412">,</span>&nbsp;<span class="ident" id="5368414">errors</span><span class="op" id="5368420">.</span><span class="ident" id="5368421">New</span><span class="op" id="5368424">(</span><span class="string" id="5368425">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5368464">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5368467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5368470">return</span>&nbsp;<span class="ident" id="5368477">f</span><span class="op" id="5368478">.</span><span class="ident" id="5368479">Sections</span><span class="op" id="5368487">[</span><span class="ident" id="5368488">link</span><span class="op" id="5368492">]</span><span class="op" id="5368493">.</span><span class="ident" id="5368494">Data</span><span class="op" id="5368498">(</span><span class="op" id="5368499">)</span><br>
<span class="lineno"></span><span class="op" id="5368501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5368504">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5368562">func</span>&nbsp;<span class="op" id="5368567">(</span><span class="ident" id="5368568">s</span>&nbsp;<span class="op" id="5368570">*</span><span class="ident" id="5368571">Section</span><span class="op" id="5368578">)</span>&nbsp;<span class="ident" id="5368580">Open</span><span class="op" id="5368584">(</span><span class="op" id="5368585">)</span>&nbsp;<span class="ident" id="5368587">io</span><span class="op" id="5368589">.</span><span class="ident" id="5368590">ReadSeeker</span>&nbsp;<span class="op" id="5368601">{</span>&nbsp;<span class="keyword" id="5368603">return</span>&nbsp;<span class="ident" id="5368610">io</span><span class="op" id="5368612">.</span><span class="ident" id="5368613">NewSectionReader</span><span class="op" id="5368629">(</span><span class="ident" id="5368630">s</span><span class="op" id="5368631">.</span><span class="ident" id="5368632">sr</span><span class="op" id="5368634">,</span>&nbsp;<span class="num" id="5368636">0</span><span class="op" id="5368637">,</span>&nbsp;<span class="num" id="5368639">1</span><span class="op" id="5368640">&lt;&lt;</span><span class="num" id="5368642">63</span><span class="op" id="5368644">-</span><span class="num" id="5368645">1</span><span class="op" id="5368646">)</span>&nbsp;<span class="op" id="5368648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5368651">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5368707">type</span>&nbsp;<span class="ident" id="5368712">ProgHeader</span>&nbsp;<span class="keyword" id="5368723">struct</span>&nbsp;<span class="op" id="5368730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368733">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5368740">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368750">Flags</span>&nbsp;&nbsp;<span class="ident" id="5368757">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368767">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5368774">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368782">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5368789">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368797">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5368804">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368812">Filesz</span>&nbsp;<span class="ident" id="5368819">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368827">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5368834">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368842">Align</span>&nbsp;&nbsp;<span class="ident" id="5368849">uint64</span><br>
<span class="lineno"></span><span class="op" id="5368856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5368859">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5368926">type</span>&nbsp;<span class="ident" id="5368931">Prog</span>&nbsp;<span class="keyword" id="5368936">struct</span>&nbsp;<span class="op" id="5368943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5368946">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5368959">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5368997">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5369037">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5369072">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5369120">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5369170">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369194">io</span><span class="op" id="5369196">.</span><span class="ident" id="5369197">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369207">sr</span>&nbsp;<span class="op" id="5369210">*</span><span class="ident" id="5369211">io</span><span class="op" id="5369213">.</span><span class="ident" id="5369214">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5369228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5369231">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5369294">func</span>&nbsp;<span class="op" id="5369299">(</span><span class="ident" id="5369300">p</span>&nbsp;<span class="op" id="5369302">*</span><span class="ident" id="5369303">Prog</span><span class="op" id="5369307">)</span>&nbsp;<span class="ident" id="5369309">Open</span><span class="op" id="5369313">(</span><span class="op" id="5369314">)</span>&nbsp;<span class="ident" id="5369316">io</span><span class="op" id="5369318">.</span><span class="ident" id="5369319">ReadSeeker</span>&nbsp;<span class="op" id="5369330">{</span>&nbsp;<span class="keyword" id="5369332">return</span>&nbsp;<span class="ident" id="5369339">io</span><span class="op" id="5369341">.</span><span class="ident" id="5369342">NewSectionReader</span><span class="op" id="5369358">(</span><span class="ident" id="5369359">p</span><span class="op" id="5369360">.</span><span class="ident" id="5369361">sr</span><span class="op" id="5369363">,</span>&nbsp;<span class="num" id="5369365">0</span><span class="op" id="5369366">,</span>&nbsp;<span class="num" id="5369368">1</span><span class="op" id="5369369">&lt;&lt;</span><span class="num" id="5369371">63</span><span class="op" id="5369373">-</span><span class="num" id="5369374">1</span><span class="op" id="5369375">)</span>&nbsp;<span class="op" id="5369377">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5369380">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5369444">type</span>&nbsp;<span class="ident" id="5369449">Symbol</span>&nbsp;<span class="keyword" id="5369456">struct</span>&nbsp;<span class="op" id="5369463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369466">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5369478">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369486">Info</span><span class="op" id="5369490">,</span>&nbsp;<span class="ident" id="5369492">Other</span>&nbsp;<span class="builtintype" id="5369498">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369504">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5369516">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369530">Value</span><span class="op" id="5369535">,</span>&nbsp;<span class="ident" id="5369537">Size</span>&nbsp;<span class="ident" id="5369542">uint64</span><br>
<span class="lineno"></span><span class="op" id="5369549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5369552">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5369574">type</span>&nbsp;<span class="ident" id="5369579">FormatError</span>&nbsp;<span class="keyword" id="5369591">struct</span>&nbsp;<span class="op" id="5369598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369601">off</span>&nbsp;<span class="ident" id="5369605">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369612">msg</span>&nbsp;<span class="builtintype" id="5369616">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369624">val</span>&nbsp;<span class="keyword" id="5369628">interface</span><span class="op" id="5369637">{</span><span class="op" id="5369638">}</span><br>
<span class="lineno"></span><span class="op" id="5369640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5369643">func</span>&nbsp;<span class="op" id="5369648">(</span><span class="ident" id="5369649">e</span>&nbsp;<span class="op" id="5369651">*</span><span class="ident" id="5369652">FormatError</span><span class="op" id="5369663">)</span>&nbsp;<span class="ident" id="5369665">Error</span><span class="op" id="5369670">(</span><span class="op" id="5369671">)</span>&nbsp;<span class="builtintype" id="5369673">string</span>&nbsp;<span class="op" id="5369680">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369683">msg</span>&nbsp;<span class="op" id="5369687">:=</span>&nbsp;<span class="ident" id="5369690">e</span><span class="op" id="5369691">.</span><span class="ident" id="5369692">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369697">if</span>&nbsp;<span class="ident" id="5369700">e</span><span class="op" id="5369701">.</span><span class="ident" id="5369702">val</span>&nbsp;<span class="op" id="5369706">!=</span>&nbsp;<span class="ident" id="5369709">nil</span>&nbsp;<span class="op" id="5369713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369717">msg</span>&nbsp;<span class="op" id="5369721">+=</span>&nbsp;<span class="ident" id="5369724">fmt</span><span class="op" id="5369727">.</span><span class="ident" id="5369728">Sprintf</span><span class="op" id="5369735">(</span><span class="string" id="5369736">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5369744">,</span>&nbsp;<span class="ident" id="5369746">e</span><span class="op" id="5369747">.</span><span class="ident" id="5369748">val</span><span class="op" id="5369751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5369754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369757">msg</span>&nbsp;<span class="op" id="5369761">+=</span>&nbsp;<span class="ident" id="5369764">fmt</span><span class="op" id="5369767">.</span><span class="ident" id="5369768">Sprintf</span><span class="op" id="5369775">(</span><span class="string" id="5369776">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5369799">,</span>&nbsp;<span class="ident" id="5369801">e</span><span class="op" id="5369802">.</span><span class="ident" id="5369803">off</span><span class="op" id="5369806">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369809">return</span>&nbsp;<span class="ident" id="5369816">msg</span><br>
<span class="lineno"></span><span class="op" id="5369820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5369823">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5369908">func</span>&nbsp;<span class="ident" id="5369913">Open</span><span class="op" id="5369917">(</span><span class="ident" id="5369918">name</span>&nbsp;<span class="builtintype" id="5369923">string</span><span class="op" id="5369929">)</span>&nbsp;<span class="op" id="5369931">(</span><span class="op" id="5369932">*</span><span class="ident" id="5369933">File</span><span class="op" id="5369937">,</span>&nbsp;<span class="builtintype" id="5369939">error</span><span class="op" id="5369944">)</span>&nbsp;<span class="op" id="5369946">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5369949">f</span><span class="op" id="5369950">,</span>&nbsp;<span class="ident" id="5369952">err</span>&nbsp;<span class="op" id="5369956">:=</span>&nbsp;<span class="ident" id="5369959">os</span><span class="op" id="5369961">.</span><span class="ident" id="5369962">Open</span><span class="op" id="5369966">(</span><span class="ident" id="5369967">name</span><span class="op" id="5369971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369974">if</span>&nbsp;<span class="ident" id="5369977">err</span>&nbsp;<span class="op" id="5369981">!=</span>&nbsp;<span class="ident" id="5369984">nil</span>&nbsp;<span class="op" id="5369988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5369992">return</span>&nbsp;<span class="ident" id="5369999">nil</span><span class="op" id="5370002">,</span>&nbsp;<span class="ident" id="5370004">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370012">ff</span><span class="op" id="5370014">,</span>&nbsp;<span class="ident" id="5370016">err</span>&nbsp;<span class="op" id="5370020">:=</span>&nbsp;<span class="ident" id="5370023">NewFile</span><span class="op" id="5370030">(</span><span class="ident" id="5370031">f</span><span class="op" id="5370032">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370035">if</span>&nbsp;<span class="ident" id="5370038">err</span>&nbsp;<span class="op" id="5370042">!=</span>&nbsp;<span class="ident" id="5370045">nil</span>&nbsp;<span class="op" id="5370049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370053">f</span><span class="op" id="5370054">.</span><span class="ident" id="5370055">Close</span><span class="op" id="5370060">(</span><span class="op" id="5370061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370065">return</span>&nbsp;<span class="ident" id="5370072">nil</span><span class="op" id="5370075">,</span>&nbsp;<span class="ident" id="5370077">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370085">ff</span><span class="op" id="5370087">.</span><span class="ident" id="5370088">closer</span>&nbsp;<span class="op" id="5370095">=</span>&nbsp;<span class="ident" id="5370097">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370100">return</span>&nbsp;<span class="ident" id="5370107">ff</span><span class="op" id="5370109">,</span>&nbsp;<span class="ident" id="5370111">nil</span><br>
<span class="lineno"></span><span class="op" id="5370115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5370118">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5370144">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5370211">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5370235">func</span>&nbsp;<span class="op" id="5370240">(</span><span class="ident" id="5370241">f</span>&nbsp;<span class="op" id="5370243">*</span><span class="ident" id="5370244">File</span><span class="op" id="5370248">)</span>&nbsp;<span class="ident" id="5370250">Close</span><span class="op" id="5370255">(</span><span class="op" id="5370256">)</span>&nbsp;<span class="builtintype" id="5370258">error</span>&nbsp;<span class="op" id="5370264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370267">var</span>&nbsp;<span class="ident" id="5370271">err</span>&nbsp;<span class="builtintype" id="5370275">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370282">if</span>&nbsp;<span class="ident" id="5370285">f</span><span class="op" id="5370286">.</span><span class="ident" id="5370287">closer</span>&nbsp;<span class="op" id="5370294">!=</span>&nbsp;<span class="ident" id="5370297">nil</span>&nbsp;<span class="op" id="5370301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370305">err</span>&nbsp;<span class="op" id="5370309">=</span>&nbsp;<span class="ident" id="5370311">f</span><span class="op" id="5370312">.</span><span class="ident" id="5370313">closer</span><span class="op" id="5370319">.</span><span class="ident" id="5370320">Close</span><span class="op" id="5370325">(</span><span class="op" id="5370326">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370330">f</span><span class="op" id="5370331">.</span><span class="ident" id="5370332">closer</span>&nbsp;<span class="op" id="5370339">=</span>&nbsp;<span class="ident" id="5370341">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370349">return</span>&nbsp;<span class="ident" id="5370356">err</span><br>
<span class="lineno"></span><span class="op" id="5370360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5370363">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5370420">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5370471">func</span>&nbsp;<span class="op" id="5370476">(</span><span class="ident" id="5370477">f</span>&nbsp;<span class="op" id="5370479">*</span><span class="ident" id="5370480">File</span><span class="op" id="5370484">)</span>&nbsp;<span class="ident" id="5370486">SectionByType</span><span class="op" id="5370499">(</span><span class="ident" id="5370500">typ</span>&nbsp;<span class="ident" id="5370504">SectionType</span><span class="op" id="5370515">)</span>&nbsp;<span class="op" id="5370517">*</span><span class="ident" id="5370518">Section</span>&nbsp;<span class="op" id="5370526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370529">for</span>&nbsp;<span class="ident" id="5370533">_</span><span class="op" id="5370534">,</span>&nbsp;<span class="ident" id="5370536">s</span>&nbsp;<span class="op" id="5370538">:=</span>&nbsp;<span class="keyword" id="5370541">range</span>&nbsp;<span class="ident" id="5370547">f</span><span class="op" id="5370548">.</span><span class="ident" id="5370549">Sections</span>&nbsp;<span class="op" id="5370558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370562">if</span>&nbsp;<span class="ident" id="5370565">s</span><span class="op" id="5370566">.</span><span class="ident" id="5370567">Type</span>&nbsp;<span class="op" id="5370572">==</span>&nbsp;<span class="ident" id="5370575">typ</span>&nbsp;<span class="op" id="5370579">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370584">return</span>&nbsp;<span class="ident" id="5370591">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370601">return</span>&nbsp;<span class="ident" id="5370608">nil</span><br>
<span class="lineno"></span><span class="op" id="5370612">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5370615">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5370698">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5370768">func</span>&nbsp;<span class="ident" id="5370773">NewFile</span><span class="op" id="5370780">(</span><span class="ident" id="5370781">r</span>&nbsp;<span class="ident" id="5370783">io</span><span class="op" id="5370785">.</span><span class="ident" id="5370786">ReaderAt</span><span class="op" id="5370794">)</span>&nbsp;<span class="op" id="5370796">(</span><span class="op" id="5370797">*</span><span class="ident" id="5370798">File</span><span class="op" id="5370802">,</span>&nbsp;<span class="builtintype" id="5370804">error</span><span class="op" id="5370809">)</span>&nbsp;<span class="op" id="5370811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5370814">sr</span>&nbsp;<span class="op" id="5370817">:=</span>&nbsp;<span class="ident" id="5370820">io</span><span class="op" id="5370822">.</span><span class="ident" id="5370823">NewSectionReader</span><span class="op" id="5370839">(</span><span class="ident" id="5370840">r</span><span class="op" id="5370841">,</span>&nbsp;<span class="num" id="5370843">0</span><span class="op" id="5370844">,</span>&nbsp;<span class="num" id="5370846">1</span><span class="op" id="5370847">&lt;&lt;</span><span class="num" id="5370849">63</span><span class="op" id="5370851">-</span><span class="num" id="5370852">1</span><span class="op" id="5370853">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5370856">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370891">var</span>&nbsp;<span class="ident" id="5370895">ident</span>&nbsp;<span class="op" id="5370901">[</span><span class="num" id="5370902">16</span><span class="op" id="5370904">]</span><span class="builtintype" id="5370905">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370912">if</span>&nbsp;<span class="ident" id="5370915">_</span><span class="op" id="5370916">,</span>&nbsp;<span class="ident" id="5370918">err</span>&nbsp;<span class="op" id="5370922">:=</span>&nbsp;<span class="ident" id="5370925">r</span><span class="op" id="5370926">.</span><span class="ident" id="5370927">ReadAt</span><span class="op" id="5370933">(</span><span class="ident" id="5370934">ident</span><span class="op" id="5370939">[</span><span class="num" id="5370940">0</span><span class="op" id="5370941">:</span><span class="op" id="5370942">]</span><span class="op" id="5370943">,</span>&nbsp;<span class="num" id="5370945">0</span><span class="op" id="5370946">)</span><span class="op" id="5370947">;</span>&nbsp;<span class="ident" id="5370949">err</span>&nbsp;<span class="op" id="5370953">!=</span>&nbsp;<span class="ident" id="5370956">nil</span>&nbsp;<span class="op" id="5370960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370964">return</span>&nbsp;<span class="ident" id="5370971">nil</span><span class="op" id="5370974">,</span>&nbsp;<span class="ident" id="5370976">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5370981">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5370984">if</span>&nbsp;<span class="ident" id="5370987">ident</span><span class="op" id="5370992">[</span><span class="num" id="5370993">0</span><span class="op" id="5370994">]</span>&nbsp;<span class="op" id="5370996">!=</span>&nbsp;<span class="string" id="5370999">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5371006">||</span>&nbsp;<span class="ident" id="5371009">ident</span><span class="op" id="5371014">[</span><span class="num" id="5371015">1</span><span class="op" id="5371016">]</span>&nbsp;<span class="op" id="5371018">!=</span>&nbsp;<span class="string" id="5371021">&#39;E&#39;</span>&nbsp;<span class="op" id="5371025">||</span>&nbsp;<span class="ident" id="5371028">ident</span><span class="op" id="5371033">[</span><span class="num" id="5371034">2</span><span class="op" id="5371035">]</span>&nbsp;<span class="op" id="5371037">!=</span>&nbsp;<span class="string" id="5371040">&#39;L&#39;</span>&nbsp;<span class="op" id="5371044">||</span>&nbsp;<span class="ident" id="5371047">ident</span><span class="op" id="5371052">[</span><span class="num" id="5371053">3</span><span class="op" id="5371054">]</span>&nbsp;<span class="op" id="5371056">!=</span>&nbsp;<span class="string" id="5371059">&#39;F&#39;</span>&nbsp;<span class="op" id="5371063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371067">return</span>&nbsp;<span class="ident" id="5371074">nil</span><span class="op" id="5371077">,</span>&nbsp;<span class="op" id="5371079">&amp;</span><span class="ident" id="5371080">FormatError</span><span class="op" id="5371091">{</span><span class="num" id="5371092">0</span><span class="op" id="5371093">,</span>&nbsp;<span class="string" id="5371095">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5371113">,</span>&nbsp;<span class="ident" id="5371115">ident</span><span class="op" id="5371120">[</span><span class="num" id="5371121">0</span><span class="op" id="5371122">:</span><span class="num" id="5371123">4</span><span class="op" id="5371124">]</span><span class="op" id="5371125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371132">f</span>&nbsp;<span class="op" id="5371134">:=</span>&nbsp;<span class="builtinfunc" id="5371137">new</span><span class="op" id="5371140">(</span><span class="ident" id="5371141">File</span><span class="op" id="5371145">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371148">f</span><span class="op" id="5371149">.</span><span class="ident" id="5371150">Class</span>&nbsp;<span class="op" id="5371156">=</span>&nbsp;<span class="ident" id="5371158">Class</span><span class="op" id="5371163">(</span><span class="ident" id="5371164">ident</span><span class="op" id="5371169">[</span><span class="ident" id="5371170">EI_CLASS</span><span class="op" id="5371178">]</span><span class="op" id="5371179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371182">switch</span>&nbsp;<span class="ident" id="5371189">f</span><span class="op" id="5371190">.</span><span class="ident" id="5371191">Class</span>&nbsp;<span class="op" id="5371197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371200">case</span>&nbsp;<span class="ident" id="5371205">ELFCLASS32</span><span class="op" id="5371215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371218">case</span>&nbsp;<span class="ident" id="5371223">ELFCLASS64</span><span class="op" id="5371233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371237">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371244">default</span><span class="op" id="5371251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371255">return</span>&nbsp;<span class="ident" id="5371262">nil</span><span class="op" id="5371265">,</span>&nbsp;<span class="op" id="5371267">&amp;</span><span class="ident" id="5371268">FormatError</span><span class="op" id="5371279">{</span><span class="num" id="5371280">0</span><span class="op" id="5371281">,</span>&nbsp;<span class="string" id="5371283">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5371302">,</span>&nbsp;<span class="ident" id="5371304">f</span><span class="op" id="5371305">.</span><span class="ident" id="5371306">Class</span><span class="op" id="5371311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371318">f</span><span class="op" id="5371319">.</span><span class="ident" id="5371320">Data</span>&nbsp;<span class="op" id="5371325">=</span>&nbsp;<span class="ident" id="5371327">Data</span><span class="op" id="5371331">(</span><span class="ident" id="5371332">ident</span><span class="op" id="5371337">[</span><span class="ident" id="5371338">EI_DATA</span><span class="op" id="5371345">]</span><span class="op" id="5371346">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371349">switch</span>&nbsp;<span class="ident" id="5371356">f</span><span class="op" id="5371357">.</span><span class="ident" id="5371358">Data</span>&nbsp;<span class="op" id="5371363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371366">case</span>&nbsp;<span class="ident" id="5371371">ELFDATA2LSB</span><span class="op" id="5371382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371386">f</span><span class="op" id="5371387">.</span><span class="ident" id="5371388">ByteOrder</span>&nbsp;<span class="op" id="5371398">=</span>&nbsp;<span class="ident" id="5371400">binary</span><span class="op" id="5371406">.</span><span class="ident" id="5371407">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371421">case</span>&nbsp;<span class="ident" id="5371426">ELFDATA2MSB</span><span class="op" id="5371437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371441">f</span><span class="op" id="5371442">.</span><span class="ident" id="5371443">ByteOrder</span>&nbsp;<span class="op" id="5371453">=</span>&nbsp;<span class="ident" id="5371455">binary</span><span class="op" id="5371461">.</span><span class="ident" id="5371462">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371473">default</span><span class="op" id="5371480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371484">return</span>&nbsp;<span class="ident" id="5371491">nil</span><span class="op" id="5371494">,</span>&nbsp;<span class="op" id="5371496">&amp;</span><span class="ident" id="5371497">FormatError</span><span class="op" id="5371508">{</span><span class="num" id="5371509">0</span><span class="op" id="5371510">,</span>&nbsp;<span class="string" id="5371512">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5371539">,</span>&nbsp;<span class="ident" id="5371541">f</span><span class="op" id="5371542">.</span><span class="ident" id="5371543">Data</span><span class="op" id="5371547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371554">f</span><span class="op" id="5371555">.</span><span class="ident" id="5371556">Version</span>&nbsp;<span class="op" id="5371564">=</span>&nbsp;<span class="ident" id="5371566">Version</span><span class="op" id="5371573">(</span><span class="ident" id="5371574">ident</span><span class="op" id="5371579">[</span><span class="ident" id="5371580">EI_VERSION</span><span class="op" id="5371590">]</span><span class="op" id="5371591">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371594">if</span>&nbsp;<span class="ident" id="5371597">f</span><span class="op" id="5371598">.</span><span class="ident" id="5371599">Version</span>&nbsp;<span class="op" id="5371607">!=</span>&nbsp;<span class="ident" id="5371610">EV_CURRENT</span>&nbsp;<span class="op" id="5371621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371625">return</span>&nbsp;<span class="ident" id="5371632">nil</span><span class="op" id="5371635">,</span>&nbsp;<span class="op" id="5371637">&amp;</span><span class="ident" id="5371638">FormatError</span><span class="op" id="5371649">{</span><span class="num" id="5371650">0</span><span class="op" id="5371651">,</span>&nbsp;<span class="string" id="5371653">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5371674">,</span>&nbsp;<span class="ident" id="5371676">f</span><span class="op" id="5371677">.</span><span class="ident" id="5371678">Version</span><span class="op" id="5371685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5371688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371692">f</span><span class="op" id="5371693">.</span><span class="ident" id="5371694">OSABI</span>&nbsp;<span class="op" id="5371700">=</span>&nbsp;<span class="ident" id="5371702">OSABI</span><span class="op" id="5371707">(</span><span class="ident" id="5371708">ident</span><span class="op" id="5371713">[</span><span class="ident" id="5371714">EI_OSABI</span><span class="op" id="5371722">]</span><span class="op" id="5371723">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371726">f</span><span class="op" id="5371727">.</span><span class="ident" id="5371728">ABIVersion</span>&nbsp;<span class="op" id="5371739">=</span>&nbsp;<span class="ident" id="5371741">ident</span><span class="op" id="5371746">[</span><span class="ident" id="5371747">EI_ABIVERSION</span><span class="op" id="5371760">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5371764">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371789">var</span>&nbsp;<span class="ident" id="5371793">phoff</span>&nbsp;<span class="ident" id="5371799">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371806">var</span>&nbsp;<span class="ident" id="5371810">phentsize</span><span class="op" id="5371819">,</span>&nbsp;<span class="ident" id="5371821">phnum</span>&nbsp;<span class="builtintype" id="5371827">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371832">var</span>&nbsp;<span class="ident" id="5371836">shoff</span>&nbsp;<span class="ident" id="5371842">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371849">var</span>&nbsp;<span class="ident" id="5371853">shentsize</span><span class="op" id="5371862">,</span>&nbsp;<span class="ident" id="5371864">shnum</span><span class="op" id="5371869">,</span>&nbsp;<span class="ident" id="5371871">shstrndx</span>&nbsp;<span class="builtintype" id="5371880">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371885">shstrndx</span>&nbsp;<span class="op" id="5371894">=</span>&nbsp;<span class="op" id="5371896">-</span><span class="num" id="5371897">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371900">switch</span>&nbsp;<span class="ident" id="5371907">f</span><span class="op" id="5371908">.</span><span class="ident" id="5371909">Class</span>&nbsp;<span class="op" id="5371915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371918">case</span>&nbsp;<span class="ident" id="5371923">ELFCLASS32</span><span class="op" id="5371933">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371937">hdr</span>&nbsp;<span class="op" id="5371941">:=</span>&nbsp;<span class="builtinfunc" id="5371944">new</span><span class="op" id="5371947">(</span><span class="ident" id="5371948">Header32</span><span class="op" id="5371956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5371960">sr</span><span class="op" id="5371962">.</span><span class="ident" id="5371963">Seek</span><span class="op" id="5371967">(</span><span class="num" id="5371968">0</span><span class="op" id="5371969">,</span>&nbsp;<span class="ident" id="5371971">os</span><span class="op" id="5371973">.</span><span class="ident" id="5371974">SEEK_SET</span><span class="op" id="5371982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5371986">if</span>&nbsp;<span class="ident" id="5371989">err</span>&nbsp;<span class="op" id="5371993">:=</span>&nbsp;<span class="ident" id="5371996">binary</span><span class="op" id="5372002">.</span><span class="ident" id="5372003">Read</span><span class="op" id="5372007">(</span><span class="ident" id="5372008">sr</span><span class="op" id="5372010">,</span>&nbsp;<span class="ident" id="5372012">f</span><span class="op" id="5372013">.</span><span class="ident" id="5372014">ByteOrder</span><span class="op" id="5372023">,</span>&nbsp;<span class="ident" id="5372025">hdr</span><span class="op" id="5372028">)</span><span class="op" id="5372029">;</span>&nbsp;<span class="ident" id="5372031">err</span>&nbsp;<span class="op" id="5372035">!=</span>&nbsp;<span class="ident" id="5372038">nil</span>&nbsp;<span class="op" id="5372042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372047">return</span>&nbsp;<span class="ident" id="5372054">nil</span><span class="op" id="5372057">,</span>&nbsp;<span class="ident" id="5372059">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372065">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372069">f</span><span class="op" id="5372070">.</span><span class="ident" id="5372071">Type</span>&nbsp;<span class="op" id="5372076">=</span>&nbsp;<span class="ident" id="5372078">Type</span><span class="op" id="5372082">(</span><span class="ident" id="5372083">hdr</span><span class="op" id="5372086">.</span><span class="ident" id="5372087">Type</span><span class="op" id="5372091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372095">f</span><span class="op" id="5372096">.</span><span class="ident" id="5372097">Machine</span>&nbsp;<span class="op" id="5372105">=</span>&nbsp;<span class="ident" id="5372107">Machine</span><span class="op" id="5372114">(</span><span class="ident" id="5372115">hdr</span><span class="op" id="5372118">.</span><span class="ident" id="5372119">Machine</span><span class="op" id="5372126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372130">f</span><span class="op" id="5372131">.</span><span class="ident" id="5372132">Entry</span>&nbsp;<span class="op" id="5372138">=</span>&nbsp;<span class="ident" id="5372140">uint64</span><span class="op" id="5372146">(</span><span class="ident" id="5372147">hdr</span><span class="op" id="5372150">.</span><span class="ident" id="5372151">Entry</span><span class="op" id="5372156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372160">if</span>&nbsp;<span class="ident" id="5372163">v</span>&nbsp;<span class="op" id="5372165">:=</span>&nbsp;<span class="ident" id="5372168">Version</span><span class="op" id="5372175">(</span><span class="ident" id="5372176">hdr</span><span class="op" id="5372179">.</span><span class="ident" id="5372180">Version</span><span class="op" id="5372187">)</span><span class="op" id="5372188">;</span>&nbsp;<span class="ident" id="5372190">v</span>&nbsp;<span class="op" id="5372192">!=</span>&nbsp;<span class="ident" id="5372195">f</span><span class="op" id="5372196">.</span><span class="ident" id="5372197">Version</span>&nbsp;<span class="op" id="5372205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372210">return</span>&nbsp;<span class="ident" id="5372217">nil</span><span class="op" id="5372220">,</span>&nbsp;<span class="op" id="5372222">&amp;</span><span class="ident" id="5372223">FormatError</span><span class="op" id="5372234">{</span><span class="num" id="5372235">0</span><span class="op" id="5372236">,</span>&nbsp;<span class="string" id="5372238">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5372262">,</span>&nbsp;<span class="ident" id="5372264">v</span><span class="op" id="5372265">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372273">phoff</span>&nbsp;<span class="op" id="5372279">=</span>&nbsp;<span class="ident" id="5372281">int64</span><span class="op" id="5372286">(</span><span class="ident" id="5372287">hdr</span><span class="op" id="5372290">.</span><span class="ident" id="5372291">Phoff</span><span class="op" id="5372296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372300">phentsize</span>&nbsp;<span class="op" id="5372310">=</span>&nbsp;<span class="builtintype" id="5372312">int</span><span class="op" id="5372315">(</span><span class="ident" id="5372316">hdr</span><span class="op" id="5372319">.</span><span class="ident" id="5372320">Phentsize</span><span class="op" id="5372329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372333">phnum</span>&nbsp;<span class="op" id="5372339">=</span>&nbsp;<span class="builtintype" id="5372341">int</span><span class="op" id="5372344">(</span><span class="ident" id="5372345">hdr</span><span class="op" id="5372348">.</span><span class="ident" id="5372349">Phnum</span><span class="op" id="5372354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372358">shoff</span>&nbsp;<span class="op" id="5372364">=</span>&nbsp;<span class="ident" id="5372366">int64</span><span class="op" id="5372371">(</span><span class="ident" id="5372372">hdr</span><span class="op" id="5372375">.</span><span class="ident" id="5372376">Shoff</span><span class="op" id="5372381">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372385">shentsize</span>&nbsp;<span class="op" id="5372395">=</span>&nbsp;<span class="builtintype" id="5372397">int</span><span class="op" id="5372400">(</span><span class="ident" id="5372401">hdr</span><span class="op" id="5372404">.</span><span class="ident" id="5372405">Shentsize</span><span class="op" id="5372414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372418">shnum</span>&nbsp;<span class="op" id="5372424">=</span>&nbsp;<span class="builtintype" id="5372426">int</span><span class="op" id="5372429">(</span><span class="ident" id="5372430">hdr</span><span class="op" id="5372433">.</span><span class="ident" id="5372434">Shnum</span><span class="op" id="5372439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372443">shstrndx</span>&nbsp;<span class="op" id="5372452">=</span>&nbsp;<span class="builtintype" id="5372454">int</span><span class="op" id="5372457">(</span><span class="ident" id="5372458">hdr</span><span class="op" id="5372461">.</span><span class="ident" id="5372462">Shstrndx</span><span class="op" id="5372470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372473">case</span>&nbsp;<span class="ident" id="5372478">ELFCLASS64</span><span class="op" id="5372488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372492">hdr</span>&nbsp;<span class="op" id="5372496">:=</span>&nbsp;<span class="builtinfunc" id="5372499">new</span><span class="op" id="5372502">(</span><span class="ident" id="5372503">Header64</span><span class="op" id="5372511">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372515">sr</span><span class="op" id="5372517">.</span><span class="ident" id="5372518">Seek</span><span class="op" id="5372522">(</span><span class="num" id="5372523">0</span><span class="op" id="5372524">,</span>&nbsp;<span class="ident" id="5372526">os</span><span class="op" id="5372528">.</span><span class="ident" id="5372529">SEEK_SET</span><span class="op" id="5372537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372541">if</span>&nbsp;<span class="ident" id="5372544">err</span>&nbsp;<span class="op" id="5372548">:=</span>&nbsp;<span class="ident" id="5372551">binary</span><span class="op" id="5372557">.</span><span class="ident" id="5372558">Read</span><span class="op" id="5372562">(</span><span class="ident" id="5372563">sr</span><span class="op" id="5372565">,</span>&nbsp;<span class="ident" id="5372567">f</span><span class="op" id="5372568">.</span><span class="ident" id="5372569">ByteOrder</span><span class="op" id="5372578">,</span>&nbsp;<span class="ident" id="5372580">hdr</span><span class="op" id="5372583">)</span><span class="op" id="5372584">;</span>&nbsp;<span class="ident" id="5372586">err</span>&nbsp;<span class="op" id="5372590">!=</span>&nbsp;<span class="ident" id="5372593">nil</span>&nbsp;<span class="op" id="5372597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372602">return</span>&nbsp;<span class="ident" id="5372609">nil</span><span class="op" id="5372612">,</span>&nbsp;<span class="ident" id="5372614">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372624">f</span><span class="op" id="5372625">.</span><span class="ident" id="5372626">Type</span>&nbsp;<span class="op" id="5372631">=</span>&nbsp;<span class="ident" id="5372633">Type</span><span class="op" id="5372637">(</span><span class="ident" id="5372638">hdr</span><span class="op" id="5372641">.</span><span class="ident" id="5372642">Type</span><span class="op" id="5372646">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372650">f</span><span class="op" id="5372651">.</span><span class="ident" id="5372652">Machine</span>&nbsp;<span class="op" id="5372660">=</span>&nbsp;<span class="ident" id="5372662">Machine</span><span class="op" id="5372669">(</span><span class="ident" id="5372670">hdr</span><span class="op" id="5372673">.</span><span class="ident" id="5372674">Machine</span><span class="op" id="5372681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372685">f</span><span class="op" id="5372686">.</span><span class="ident" id="5372687">Entry</span>&nbsp;<span class="op" id="5372693">=</span>&nbsp;<span class="ident" id="5372695">uint64</span><span class="op" id="5372701">(</span><span class="ident" id="5372702">hdr</span><span class="op" id="5372705">.</span><span class="ident" id="5372706">Entry</span><span class="op" id="5372711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372715">if</span>&nbsp;<span class="ident" id="5372718">v</span>&nbsp;<span class="op" id="5372720">:=</span>&nbsp;<span class="ident" id="5372723">Version</span><span class="op" id="5372730">(</span><span class="ident" id="5372731">hdr</span><span class="op" id="5372734">.</span><span class="ident" id="5372735">Version</span><span class="op" id="5372742">)</span><span class="op" id="5372743">;</span>&nbsp;<span class="ident" id="5372745">v</span>&nbsp;<span class="op" id="5372747">!=</span>&nbsp;<span class="ident" id="5372750">f</span><span class="op" id="5372751">.</span><span class="ident" id="5372752">Version</span>&nbsp;<span class="op" id="5372760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5372765">return</span>&nbsp;<span class="ident" id="5372772">nil</span><span class="op" id="5372775">,</span>&nbsp;<span class="op" id="5372777">&amp;</span><span class="ident" id="5372778">FormatError</span><span class="op" id="5372789">{</span><span class="num" id="5372790">0</span><span class="op" id="5372791">,</span>&nbsp;<span class="string" id="5372793">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5372817">,</span>&nbsp;<span class="ident" id="5372819">v</span><span class="op" id="5372820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5372824">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372828">phoff</span>&nbsp;<span class="op" id="5372834">=</span>&nbsp;<span class="ident" id="5372836">int64</span><span class="op" id="5372841">(</span><span class="ident" id="5372842">hdr</span><span class="op" id="5372845">.</span><span class="ident" id="5372846">Phoff</span><span class="op" id="5372851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372855">phentsize</span>&nbsp;<span class="op" id="5372865">=</span>&nbsp;<span class="builtintype" id="5372867">int</span><span class="op" id="5372870">(</span><span class="ident" id="5372871">hdr</span><span class="op" id="5372874">.</span><span class="ident" id="5372875">Phentsize</span><span class="op" id="5372884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372888">phnum</span>&nbsp;<span class="op" id="5372894">=</span>&nbsp;<span class="builtintype" id="5372896">int</span><span class="op" id="5372899">(</span><span class="ident" id="5372900">hdr</span><span class="op" id="5372903">.</span><span class="ident" id="5372904">Phnum</span><span class="op" id="5372909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372913">shoff</span>&nbsp;<span class="op" id="5372919">=</span>&nbsp;<span class="ident" id="5372921">int64</span><span class="op" id="5372926">(</span><span class="ident" id="5372927">hdr</span><span class="op" id="5372930">.</span><span class="ident" id="5372931">Shoff</span><span class="op" id="5372936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372940">shentsize</span>&nbsp;<span class="op" id="5372950">=</span>&nbsp;<span class="builtintype" id="5372952">int</span><span class="op" id="5372955">(</span><span class="ident" id="5372956">hdr</span><span class="op" id="5372959">.</span><span class="ident" id="5372960">Shentsize</span><span class="op" id="5372969">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372973">shnum</span>&nbsp;<span class="op" id="5372979">=</span>&nbsp;<span class="builtintype" id="5372981">int</span><span class="op" id="5372984">(</span><span class="ident" id="5372985">hdr</span><span class="op" id="5372988">.</span><span class="ident" id="5372989">Shnum</span><span class="op" id="5372994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5372998">shstrndx</span>&nbsp;<span class="op" id="5373007">=</span>&nbsp;<span class="builtintype" id="5373009">int</span><span class="op" id="5373012">(</span><span class="ident" id="5373013">hdr</span><span class="op" id="5373016">.</span><span class="ident" id="5373017">Shstrndx</span><span class="op" id="5373025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373032">if</span>&nbsp;<span class="ident" id="5373035">shnum</span>&nbsp;<span class="op" id="5373041">&gt;</span>&nbsp;<span class="num" id="5373043">0</span>&nbsp;<span class="op" id="5373045">&amp;&amp;</span>&nbsp;<span class="ident" id="5373048">shoff</span>&nbsp;<span class="op" id="5373054">&gt;</span>&nbsp;<span class="num" id="5373056">0</span>&nbsp;<span class="op" id="5373058">&amp;&amp;</span>&nbsp;<span class="op" id="5373061">(</span><span class="ident" id="5373062">shstrndx</span>&nbsp;<span class="op" id="5373071">&lt;</span>&nbsp;<span class="num" id="5373073">0</span>&nbsp;<span class="op" id="5373075">||</span>&nbsp;<span class="ident" id="5373078">shstrndx</span>&nbsp;<span class="op" id="5373087">&gt;=</span>&nbsp;<span class="ident" id="5373090">shnum</span><span class="op" id="5373095">)</span>&nbsp;<span class="op" id="5373097">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373101">return</span>&nbsp;<span class="ident" id="5373108">nil</span><span class="op" id="5373111">,</span>&nbsp;<span class="op" id="5373113">&amp;</span><span class="ident" id="5373114">FormatError</span><span class="op" id="5373125">{</span><span class="num" id="5373126">0</span><span class="op" id="5373127">,</span>&nbsp;<span class="string" id="5373129">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5373151">,</span>&nbsp;<span class="ident" id="5373153">shstrndx</span><span class="op" id="5373161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5373168">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373193">f</span><span class="op" id="5373194">.</span><span class="ident" id="5373195">Progs</span>&nbsp;<span class="op" id="5373201">=</span>&nbsp;<span class="builtinfunc" id="5373203">make</span><span class="op" id="5373207">(</span><span class="op" id="5373208">[</span><span class="op" id="5373209">]</span><span class="op" id="5373210">*</span><span class="ident" id="5373211">Prog</span><span class="op" id="5373215">,</span>&nbsp;<span class="ident" id="5373217">phnum</span><span class="op" id="5373222">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373225">for</span>&nbsp;<span class="ident" id="5373229">i</span>&nbsp;<span class="op" id="5373231">:=</span>&nbsp;<span class="num" id="5373234">0</span><span class="op" id="5373235">;</span>&nbsp;<span class="ident" id="5373237">i</span>&nbsp;<span class="op" id="5373239">&lt;</span>&nbsp;<span class="ident" id="5373241">phnum</span><span class="op" id="5373246">;</span>&nbsp;<span class="ident" id="5373248">i</span><span class="op" id="5373249">++</span>&nbsp;<span class="op" id="5373252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373256">off</span>&nbsp;<span class="op" id="5373260">:=</span>&nbsp;<span class="ident" id="5373263">phoff</span>&nbsp;<span class="op" id="5373269">+</span>&nbsp;<span class="ident" id="5373271">int64</span><span class="op" id="5373276">(</span><span class="ident" id="5373277">i</span><span class="op" id="5373278">)</span><span class="op" id="5373279">*</span><span class="ident" id="5373280">int64</span><span class="op" id="5373285">(</span><span class="ident" id="5373286">phentsize</span><span class="op" id="5373295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373299">sr</span><span class="op" id="5373301">.</span><span class="ident" id="5373302">Seek</span><span class="op" id="5373306">(</span><span class="ident" id="5373307">off</span><span class="op" id="5373310">,</span>&nbsp;<span class="ident" id="5373312">os</span><span class="op" id="5373314">.</span><span class="ident" id="5373315">SEEK_SET</span><span class="op" id="5373323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373327">p</span>&nbsp;<span class="op" id="5373329">:=</span>&nbsp;<span class="builtinfunc" id="5373332">new</span><span class="op" id="5373335">(</span><span class="ident" id="5373336">Prog</span><span class="op" id="5373340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373344">switch</span>&nbsp;<span class="ident" id="5373351">f</span><span class="op" id="5373352">.</span><span class="ident" id="5373353">Class</span>&nbsp;<span class="op" id="5373359">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373363">case</span>&nbsp;<span class="ident" id="5373368">ELFCLASS32</span><span class="op" id="5373378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373383">ph</span>&nbsp;<span class="op" id="5373386">:=</span>&nbsp;<span class="builtinfunc" id="5373389">new</span><span class="op" id="5373392">(</span><span class="ident" id="5373393">Prog32</span><span class="op" id="5373399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373404">if</span>&nbsp;<span class="ident" id="5373407">err</span>&nbsp;<span class="op" id="5373411">:=</span>&nbsp;<span class="ident" id="5373414">binary</span><span class="op" id="5373420">.</span><span class="ident" id="5373421">Read</span><span class="op" id="5373425">(</span><span class="ident" id="5373426">sr</span><span class="op" id="5373428">,</span>&nbsp;<span class="ident" id="5373430">f</span><span class="op" id="5373431">.</span><span class="ident" id="5373432">ByteOrder</span><span class="op" id="5373441">,</span>&nbsp;<span class="ident" id="5373443">ph</span><span class="op" id="5373445">)</span><span class="op" id="5373446">;</span>&nbsp;<span class="ident" id="5373448">err</span>&nbsp;<span class="op" id="5373452">!=</span>&nbsp;<span class="ident" id="5373455">nil</span>&nbsp;<span class="op" id="5373459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373465">return</span>&nbsp;<span class="ident" id="5373472">nil</span><span class="op" id="5373475">,</span>&nbsp;<span class="ident" id="5373477">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373484">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373489">p</span><span class="op" id="5373490">.</span><span class="ident" id="5373491">ProgHeader</span>&nbsp;<span class="op" id="5373502">=</span>&nbsp;<span class="ident" id="5373504">ProgHeader</span><span class="op" id="5373514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373520">Type</span><span class="op" id="5373524">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5373528">ProgType</span><span class="op" id="5373536">(</span><span class="ident" id="5373537">ph</span><span class="op" id="5373539">.</span><span class="ident" id="5373540">Type</span><span class="op" id="5373544">)</span><span class="op" id="5373545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373551">Flags</span><span class="op" id="5373556">:</span>&nbsp;&nbsp;<span class="ident" id="5373559">ProgFlag</span><span class="op" id="5373567">(</span><span class="ident" id="5373568">ph</span><span class="op" id="5373570">.</span><span class="ident" id="5373571">Flags</span><span class="op" id="5373576">)</span><span class="op" id="5373577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373583">Off</span><span class="op" id="5373586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5373591">uint64</span><span class="op" id="5373597">(</span><span class="ident" id="5373598">ph</span><span class="op" id="5373600">.</span><span class="ident" id="5373601">Off</span><span class="op" id="5373604">)</span><span class="op" id="5373605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373611">Vaddr</span><span class="op" id="5373616">:</span>&nbsp;&nbsp;<span class="ident" id="5373619">uint64</span><span class="op" id="5373625">(</span><span class="ident" id="5373626">ph</span><span class="op" id="5373628">.</span><span class="ident" id="5373629">Vaddr</span><span class="op" id="5373634">)</span><span class="op" id="5373635">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373641">Paddr</span><span class="op" id="5373646">:</span>&nbsp;&nbsp;<span class="ident" id="5373649">uint64</span><span class="op" id="5373655">(</span><span class="ident" id="5373656">ph</span><span class="op" id="5373658">.</span><span class="ident" id="5373659">Paddr</span><span class="op" id="5373664">)</span><span class="op" id="5373665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373671">Filesz</span><span class="op" id="5373677">:</span>&nbsp;<span class="ident" id="5373679">uint64</span><span class="op" id="5373685">(</span><span class="ident" id="5373686">ph</span><span class="op" id="5373688">.</span><span class="ident" id="5373689">Filesz</span><span class="op" id="5373695">)</span><span class="op" id="5373696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373702">Memsz</span><span class="op" id="5373707">:</span>&nbsp;&nbsp;<span class="ident" id="5373710">uint64</span><span class="op" id="5373716">(</span><span class="ident" id="5373717">ph</span><span class="op" id="5373719">.</span><span class="ident" id="5373720">Memsz</span><span class="op" id="5373725">)</span><span class="op" id="5373726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373732">Align</span><span class="op" id="5373737">:</span>&nbsp;&nbsp;<span class="ident" id="5373740">uint64</span><span class="op" id="5373746">(</span><span class="ident" id="5373747">ph</span><span class="op" id="5373749">.</span><span class="ident" id="5373750">Align</span><span class="op" id="5373755">)</span><span class="op" id="5373756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373761">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373765">case</span>&nbsp;<span class="ident" id="5373770">ELFCLASS64</span><span class="op" id="5373780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373785">ph</span>&nbsp;<span class="op" id="5373788">:=</span>&nbsp;<span class="builtinfunc" id="5373791">new</span><span class="op" id="5373794">(</span><span class="ident" id="5373795">Prog64</span><span class="op" id="5373801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373806">if</span>&nbsp;<span class="ident" id="5373809">err</span>&nbsp;<span class="op" id="5373813">:=</span>&nbsp;<span class="ident" id="5373816">binary</span><span class="op" id="5373822">.</span><span class="ident" id="5373823">Read</span><span class="op" id="5373827">(</span><span class="ident" id="5373828">sr</span><span class="op" id="5373830">,</span>&nbsp;<span class="ident" id="5373832">f</span><span class="op" id="5373833">.</span><span class="ident" id="5373834">ByteOrder</span><span class="op" id="5373843">,</span>&nbsp;<span class="ident" id="5373845">ph</span><span class="op" id="5373847">)</span><span class="op" id="5373848">;</span>&nbsp;<span class="ident" id="5373850">err</span>&nbsp;<span class="op" id="5373854">!=</span>&nbsp;<span class="ident" id="5373857">nil</span>&nbsp;<span class="op" id="5373861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5373867">return</span>&nbsp;<span class="ident" id="5373874">nil</span><span class="op" id="5373877">,</span>&nbsp;<span class="ident" id="5373879">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5373886">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373891">p</span><span class="op" id="5373892">.</span><span class="ident" id="5373893">ProgHeader</span>&nbsp;<span class="op" id="5373904">=</span>&nbsp;<span class="ident" id="5373906">ProgHeader</span><span class="op" id="5373916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373922">Type</span><span class="op" id="5373926">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5373930">ProgType</span><span class="op" id="5373938">(</span><span class="ident" id="5373939">ph</span><span class="op" id="5373941">.</span><span class="ident" id="5373942">Type</span><span class="op" id="5373946">)</span><span class="op" id="5373947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373953">Flags</span><span class="op" id="5373958">:</span>&nbsp;&nbsp;<span class="ident" id="5373961">ProgFlag</span><span class="op" id="5373969">(</span><span class="ident" id="5373970">ph</span><span class="op" id="5373972">.</span><span class="ident" id="5373973">Flags</span><span class="op" id="5373978">)</span><span class="op" id="5373979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5373985">Off</span><span class="op" id="5373988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5373993">uint64</span><span class="op" id="5373999">(</span><span class="ident" id="5374000">ph</span><span class="op" id="5374002">.</span><span class="ident" id="5374003">Off</span><span class="op" id="5374006">)</span><span class="op" id="5374007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374013">Vaddr</span><span class="op" id="5374018">:</span>&nbsp;&nbsp;<span class="ident" id="5374021">uint64</span><span class="op" id="5374027">(</span><span class="ident" id="5374028">ph</span><span class="op" id="5374030">.</span><span class="ident" id="5374031">Vaddr</span><span class="op" id="5374036">)</span><span class="op" id="5374037">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374043">Paddr</span><span class="op" id="5374048">:</span>&nbsp;&nbsp;<span class="ident" id="5374051">uint64</span><span class="op" id="5374057">(</span><span class="ident" id="5374058">ph</span><span class="op" id="5374060">.</span><span class="ident" id="5374061">Paddr</span><span class="op" id="5374066">)</span><span class="op" id="5374067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374073">Filesz</span><span class="op" id="5374079">:</span>&nbsp;<span class="ident" id="5374081">uint64</span><span class="op" id="5374087">(</span><span class="ident" id="5374088">ph</span><span class="op" id="5374090">.</span><span class="ident" id="5374091">Filesz</span><span class="op" id="5374097">)</span><span class="op" id="5374098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374104">Memsz</span><span class="op" id="5374109">:</span>&nbsp;&nbsp;<span class="ident" id="5374112">uint64</span><span class="op" id="5374118">(</span><span class="ident" id="5374119">ph</span><span class="op" id="5374121">.</span><span class="ident" id="5374122">Memsz</span><span class="op" id="5374127">)</span><span class="op" id="5374128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374134">Align</span><span class="op" id="5374139">:</span>&nbsp;&nbsp;<span class="ident" id="5374142">uint64</span><span class="op" id="5374148">(</span><span class="ident" id="5374149">ph</span><span class="op" id="5374151">.</span><span class="ident" id="5374152">Align</span><span class="op" id="5374157">)</span><span class="op" id="5374158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5374163">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5374167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374171">p</span><span class="op" id="5374172">.</span><span class="ident" id="5374173">sr</span>&nbsp;<span class="op" id="5374176">=</span>&nbsp;<span class="ident" id="5374178">io</span><span class="op" id="5374180">.</span><span class="ident" id="5374181">NewSectionReader</span><span class="op" id="5374197">(</span><span class="ident" id="5374198">r</span><span class="op" id="5374199">,</span>&nbsp;<span class="ident" id="5374201">int64</span><span class="op" id="5374206">(</span><span class="ident" id="5374207">p</span><span class="op" id="5374208">.</span><span class="ident" id="5374209">Off</span><span class="op" id="5374212">)</span><span class="op" id="5374213">,</span>&nbsp;<span class="ident" id="5374215">int64</span><span class="op" id="5374220">(</span><span class="ident" id="5374221">p</span><span class="op" id="5374222">.</span><span class="ident" id="5374223">Filesz</span><span class="op" id="5374229">)</span><span class="op" id="5374230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374234">p</span><span class="op" id="5374235">.</span><span class="ident" id="5374236">ReaderAt</span>&nbsp;<span class="op" id="5374245">=</span>&nbsp;<span class="ident" id="5374247">p</span><span class="op" id="5374248">.</span><span class="ident" id="5374249">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374254">f</span><span class="op" id="5374255">.</span><span class="ident" id="5374256">Progs</span><span class="op" id="5374261">[</span><span class="ident" id="5374262">i</span><span class="op" id="5374263">]</span>&nbsp;<span class="op" id="5374265">=</span>&nbsp;<span class="ident" id="5374267">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5374270">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5374274">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374299">f</span><span class="op" id="5374300">.</span><span class="ident" id="5374301">Sections</span>&nbsp;<span class="op" id="5374310">=</span>&nbsp;<span class="builtinfunc" id="5374312">make</span><span class="op" id="5374316">(</span><span class="op" id="5374317">[</span><span class="op" id="5374318">]</span><span class="op" id="5374319">*</span><span class="ident" id="5374320">Section</span><span class="op" id="5374327">,</span>&nbsp;<span class="ident" id="5374329">shnum</span><span class="op" id="5374334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374337">names</span>&nbsp;<span class="op" id="5374343">:=</span>&nbsp;<span class="builtinfunc" id="5374346">make</span><span class="op" id="5374350">(</span><span class="op" id="5374351">[</span><span class="op" id="5374352">]</span><span class="builtintype" id="5374353">uint32</span><span class="op" id="5374359">,</span>&nbsp;<span class="ident" id="5374361">shnum</span><span class="op" id="5374366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5374369">for</span>&nbsp;<span class="ident" id="5374373">i</span>&nbsp;<span class="op" id="5374375">:=</span>&nbsp;<span class="num" id="5374378">0</span><span class="op" id="5374379">;</span>&nbsp;<span class="ident" id="5374381">i</span>&nbsp;<span class="op" id="5374383">&lt;</span>&nbsp;<span class="ident" id="5374385">shnum</span><span class="op" id="5374390">;</span>&nbsp;<span class="ident" id="5374392">i</span><span class="op" id="5374393">++</span>&nbsp;<span class="op" id="5374396">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374400">off</span>&nbsp;<span class="op" id="5374404">:=</span>&nbsp;<span class="ident" id="5374407">shoff</span>&nbsp;<span class="op" id="5374413">+</span>&nbsp;<span class="ident" id="5374415">int64</span><span class="op" id="5374420">(</span><span class="ident" id="5374421">i</span><span class="op" id="5374422">)</span><span class="op" id="5374423">*</span><span class="ident" id="5374424">int64</span><span class="op" id="5374429">(</span><span class="ident" id="5374430">shentsize</span><span class="op" id="5374439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374443">sr</span><span class="op" id="5374445">.</span><span class="ident" id="5374446">Seek</span><span class="op" id="5374450">(</span><span class="ident" id="5374451">off</span><span class="op" id="5374454">,</span>&nbsp;<span class="ident" id="5374456">os</span><span class="op" id="5374458">.</span><span class="ident" id="5374459">SEEK_SET</span><span class="op" id="5374467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374471">s</span>&nbsp;<span class="op" id="5374473">:=</span>&nbsp;<span class="builtinfunc" id="5374476">new</span><span class="op" id="5374479">(</span><span class="ident" id="5374480">Section</span><span class="op" id="5374487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5374491">switch</span>&nbsp;<span class="ident" id="5374498">f</span><span class="op" id="5374499">.</span><span class="ident" id="5374500">Class</span>&nbsp;<span class="op" id="5374506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5374510">case</span>&nbsp;<span class="ident" id="5374515">ELFCLASS32</span><span class="op" id="5374525">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374530">sh</span>&nbsp;<span class="op" id="5374533">:=</span>&nbsp;<span class="builtinfunc" id="5374536">new</span><span class="op" id="5374539">(</span><span class="ident" id="5374540">Section32</span><span class="op" id="5374549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5374554">if</span>&nbsp;<span class="ident" id="5374557">err</span>&nbsp;<span class="op" id="5374561">:=</span>&nbsp;<span class="ident" id="5374564">binary</span><span class="op" id="5374570">.</span><span class="ident" id="5374571">Read</span><span class="op" id="5374575">(</span><span class="ident" id="5374576">sr</span><span class="op" id="5374578">,</span>&nbsp;<span class="ident" id="5374580">f</span><span class="op" id="5374581">.</span><span class="ident" id="5374582">ByteOrder</span><span class="op" id="5374591">,</span>&nbsp;<span class="ident" id="5374593">sh</span><span class="op" id="5374595">)</span><span class="op" id="5374596">;</span>&nbsp;<span class="ident" id="5374598">err</span>&nbsp;<span class="op" id="5374602">!=</span>&nbsp;<span class="ident" id="5374605">nil</span>&nbsp;<span class="op" id="5374609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5374615">return</span>&nbsp;<span class="ident" id="5374622">nil</span><span class="op" id="5374625">,</span>&nbsp;<span class="ident" id="5374627">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5374634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374639">names</span><span class="op" id="5374644">[</span><span class="ident" id="5374645">i</span><span class="op" id="5374646">]</span>&nbsp;<span class="op" id="5374648">=</span>&nbsp;<span class="ident" id="5374650">sh</span><span class="op" id="5374652">.</span><span class="ident" id="5374653">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374661">s</span><span class="op" id="5374662">.</span><span class="ident" id="5374663">SectionHeader</span>&nbsp;<span class="op" id="5374677">=</span>&nbsp;<span class="ident" id="5374679">SectionHeader</span><span class="op" id="5374692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374698">Type</span><span class="op" id="5374702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5374709">SectionType</span><span class="op" id="5374720">(</span><span class="ident" id="5374721">sh</span><span class="op" id="5374723">.</span><span class="ident" id="5374724">Type</span><span class="op" id="5374728">)</span><span class="op" id="5374729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374735">Flags</span><span class="op" id="5374740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5374746">SectionFlag</span><span class="op" id="5374757">(</span><span class="ident" id="5374758">sh</span><span class="op" id="5374760">.</span><span class="ident" id="5374761">Flags</span><span class="op" id="5374766">)</span><span class="op" id="5374767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374773">Addr</span><span class="op" id="5374777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5374784">uint64</span><span class="op" id="5374790">(</span><span class="ident" id="5374791">sh</span><span class="op" id="5374793">.</span><span class="ident" id="5374794">Addr</span><span class="op" id="5374798">)</span><span class="op" id="5374799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374805">Offset</span><span class="op" id="5374811">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5374816">uint64</span><span class="op" id="5374822">(</span><span class="ident" id="5374823">sh</span><span class="op" id="5374825">.</span><span class="ident" id="5374826">Off</span><span class="op" id="5374829">)</span><span class="op" id="5374830">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374836">Size</span><span class="op" id="5374840">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5374847">uint64</span><span class="op" id="5374853">(</span><span class="ident" id="5374854">sh</span><span class="op" id="5374856">.</span><span class="ident" id="5374857">Size</span><span class="op" id="5374861">)</span><span class="op" id="5374862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374868">Link</span><span class="op" id="5374872">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5374879">uint32</span><span class="op" id="5374885">(</span><span class="ident" id="5374886">sh</span><span class="op" id="5374888">.</span><span class="ident" id="5374889">Link</span><span class="op" id="5374893">)</span><span class="op" id="5374894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374900">Info</span><span class="op" id="5374904">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5374911">uint32</span><span class="op" id="5374917">(</span><span class="ident" id="5374918">sh</span><span class="op" id="5374920">.</span><span class="ident" id="5374921">Info</span><span class="op" id="5374925">)</span><span class="op" id="5374926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374932">Addralign</span><span class="op" id="5374941">:</span>&nbsp;<span class="ident" id="5374943">uint64</span><span class="op" id="5374949">(</span><span class="ident" id="5374950">sh</span><span class="op" id="5374952">.</span><span class="ident" id="5374953">Addralign</span><span class="op" id="5374962">)</span><span class="op" id="5374963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5374969">Entsize</span><span class="op" id="5374976">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5374980">uint64</span><span class="op" id="5374986">(</span><span class="ident" id="5374987">sh</span><span class="op" id="5374989">.</span><span class="ident" id="5374990">Entsize</span><span class="op" id="5374997">)</span><span class="op" id="5374998">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375007">case</span>&nbsp;<span class="ident" id="5375012">ELFCLASS64</span><span class="op" id="5375022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375027">sh</span>&nbsp;<span class="op" id="5375030">:=</span>&nbsp;<span class="builtinfunc" id="5375033">new</span><span class="op" id="5375036">(</span><span class="ident" id="5375037">Section64</span><span class="op" id="5375046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375051">if</span>&nbsp;<span class="ident" id="5375054">err</span>&nbsp;<span class="op" id="5375058">:=</span>&nbsp;<span class="ident" id="5375061">binary</span><span class="op" id="5375067">.</span><span class="ident" id="5375068">Read</span><span class="op" id="5375072">(</span><span class="ident" id="5375073">sr</span><span class="op" id="5375075">,</span>&nbsp;<span class="ident" id="5375077">f</span><span class="op" id="5375078">.</span><span class="ident" id="5375079">ByteOrder</span><span class="op" id="5375088">,</span>&nbsp;<span class="ident" id="5375090">sh</span><span class="op" id="5375092">)</span><span class="op" id="5375093">;</span>&nbsp;<span class="ident" id="5375095">err</span>&nbsp;<span class="op" id="5375099">!=</span>&nbsp;<span class="ident" id="5375102">nil</span>&nbsp;<span class="op" id="5375106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375112">return</span>&nbsp;<span class="ident" id="5375119">nil</span><span class="op" id="5375122">,</span>&nbsp;<span class="ident" id="5375124">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375136">names</span><span class="op" id="5375141">[</span><span class="ident" id="5375142">i</span><span class="op" id="5375143">]</span>&nbsp;<span class="op" id="5375145">=</span>&nbsp;<span class="ident" id="5375147">sh</span><span class="op" id="5375149">.</span><span class="ident" id="5375150">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375158">s</span><span class="op" id="5375159">.</span><span class="ident" id="5375160">SectionHeader</span>&nbsp;<span class="op" id="5375174">=</span>&nbsp;<span class="ident" id="5375176">SectionHeader</span><span class="op" id="5375189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375195">Type</span><span class="op" id="5375199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5375206">SectionType</span><span class="op" id="5375217">(</span><span class="ident" id="5375218">sh</span><span class="op" id="5375220">.</span><span class="ident" id="5375221">Type</span><span class="op" id="5375225">)</span><span class="op" id="5375226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375232">Flags</span><span class="op" id="5375237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5375243">SectionFlag</span><span class="op" id="5375254">(</span><span class="ident" id="5375255">sh</span><span class="op" id="5375257">.</span><span class="ident" id="5375258">Flags</span><span class="op" id="5375263">)</span><span class="op" id="5375264">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375270">Offset</span><span class="op" id="5375276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5375281">uint64</span><span class="op" id="5375287">(</span><span class="ident" id="5375288">sh</span><span class="op" id="5375290">.</span><span class="ident" id="5375291">Off</span><span class="op" id="5375294">)</span><span class="op" id="5375295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375301">Size</span><span class="op" id="5375305">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5375312">uint64</span><span class="op" id="5375318">(</span><span class="ident" id="5375319">sh</span><span class="op" id="5375321">.</span><span class="ident" id="5375322">Size</span><span class="op" id="5375326">)</span><span class="op" id="5375327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375333">Addr</span><span class="op" id="5375337">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5375344">uint64</span><span class="op" id="5375350">(</span><span class="ident" id="5375351">sh</span><span class="op" id="5375353">.</span><span class="ident" id="5375354">Addr</span><span class="op" id="5375358">)</span><span class="op" id="5375359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375365">Link</span><span class="op" id="5375369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5375376">uint32</span><span class="op" id="5375382">(</span><span class="ident" id="5375383">sh</span><span class="op" id="5375385">.</span><span class="ident" id="5375386">Link</span><span class="op" id="5375390">)</span><span class="op" id="5375391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375397">Info</span><span class="op" id="5375401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5375408">uint32</span><span class="op" id="5375414">(</span><span class="ident" id="5375415">sh</span><span class="op" id="5375417">.</span><span class="ident" id="5375418">Info</span><span class="op" id="5375422">)</span><span class="op" id="5375423">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375429">Addralign</span><span class="op" id="5375438">:</span>&nbsp;<span class="ident" id="5375440">uint64</span><span class="op" id="5375446">(</span><span class="ident" id="5375447">sh</span><span class="op" id="5375449">.</span><span class="ident" id="5375450">Addralign</span><span class="op" id="5375459">)</span><span class="op" id="5375460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375466">Entsize</span><span class="op" id="5375473">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5375477">uint64</span><span class="op" id="5375483">(</span><span class="ident" id="5375484">sh</span><span class="op" id="5375486">.</span><span class="ident" id="5375487">Entsize</span><span class="op" id="5375494">)</span><span class="op" id="5375495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375508">s</span><span class="op" id="5375509">.</span><span class="ident" id="5375510">sr</span>&nbsp;<span class="op" id="5375513">=</span>&nbsp;<span class="ident" id="5375515">io</span><span class="op" id="5375517">.</span><span class="ident" id="5375518">NewSectionReader</span><span class="op" id="5375534">(</span><span class="ident" id="5375535">r</span><span class="op" id="5375536">,</span>&nbsp;<span class="ident" id="5375538">int64</span><span class="op" id="5375543">(</span><span class="ident" id="5375544">s</span><span class="op" id="5375545">.</span><span class="ident" id="5375546">Offset</span><span class="op" id="5375552">)</span><span class="op" id="5375553">,</span>&nbsp;<span class="ident" id="5375555">int64</span><span class="op" id="5375560">(</span><span class="ident" id="5375561">s</span><span class="op" id="5375562">.</span><span class="ident" id="5375563">Size</span><span class="op" id="5375567">)</span><span class="op" id="5375568">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375572">s</span><span class="op" id="5375573">.</span><span class="ident" id="5375574">ReaderAt</span>&nbsp;<span class="op" id="5375583">=</span>&nbsp;<span class="ident" id="5375585">s</span><span class="op" id="5375586">.</span><span class="ident" id="5375587">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375592">f</span><span class="op" id="5375593">.</span><span class="ident" id="5375594">Sections</span><span class="op" id="5375602">[</span><span class="ident" id="5375603">i</span><span class="op" id="5375604">]</span>&nbsp;<span class="op" id="5375606">=</span>&nbsp;<span class="ident" id="5375608">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375615">if</span>&nbsp;<span class="builtinfunc" id="5375618">len</span><span class="op" id="5375621">(</span><span class="ident" id="5375622">f</span><span class="op" id="5375623">.</span><span class="ident" id="5375624">Sections</span><span class="op" id="5375632">)</span>&nbsp;<span class="op" id="5375634">==</span>&nbsp;<span class="num" id="5375637">0</span>&nbsp;<span class="op" id="5375639">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375643">return</span>&nbsp;<span class="ident" id="5375650">f</span><span class="op" id="5375651">,</span>&nbsp;<span class="ident" id="5375653">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5375662">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375700">shstrtab</span><span class="op" id="5375708">,</span>&nbsp;<span class="ident" id="5375710">err</span>&nbsp;<span class="op" id="5375714">:=</span>&nbsp;<span class="ident" id="5375717">f</span><span class="op" id="5375718">.</span><span class="ident" id="5375719">Sections</span><span class="op" id="5375727">[</span><span class="ident" id="5375728">shstrndx</span><span class="op" id="5375736">]</span><span class="op" id="5375737">.</span><span class="ident" id="5375738">Data</span><span class="op" id="5375742">(</span><span class="op" id="5375743">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375746">if</span>&nbsp;<span class="ident" id="5375749">err</span>&nbsp;<span class="op" id="5375753">!=</span>&nbsp;<span class="ident" id="5375756">nil</span>&nbsp;<span class="op" id="5375760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375764">return</span>&nbsp;<span class="ident" id="5375771">nil</span><span class="op" id="5375774">,</span>&nbsp;<span class="ident" id="5375776">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375784">for</span>&nbsp;<span class="ident" id="5375788">i</span><span class="op" id="5375789">,</span>&nbsp;<span class="ident" id="5375791">s</span>&nbsp;<span class="op" id="5375793">:=</span>&nbsp;<span class="keyword" id="5375796">range</span>&nbsp;<span class="ident" id="5375802">f</span><span class="op" id="5375803">.</span><span class="ident" id="5375804">Sections</span>&nbsp;<span class="op" id="5375813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375817">var</span>&nbsp;<span class="ident" id="5375821">ok</span>&nbsp;<span class="builtintype" id="5375824">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5375831">s</span><span class="op" id="5375832">.</span><span class="ident" id="5375833">Name</span><span class="op" id="5375837">,</span>&nbsp;<span class="ident" id="5375839">ok</span>&nbsp;<span class="op" id="5375842">=</span>&nbsp;<span class="ident" id="5375844">getString</span><span class="op" id="5375853">(</span><span class="ident" id="5375854">shstrtab</span><span class="op" id="5375862">,</span>&nbsp;<span class="builtintype" id="5375864">int</span><span class="op" id="5375867">(</span><span class="ident" id="5375868">names</span><span class="op" id="5375873">[</span><span class="ident" id="5375874">i</span><span class="op" id="5375875">]</span><span class="op" id="5375876">)</span><span class="op" id="5375877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375881">if</span>&nbsp;<span class="op" id="5375884">!</span><span class="ident" id="5375885">ok</span>&nbsp;<span class="op" id="5375888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375893">return</span>&nbsp;<span class="ident" id="5375900">nil</span><span class="op" id="5375903">,</span>&nbsp;<span class="op" id="5375905">&amp;</span><span class="ident" id="5375906">FormatError</span><span class="op" id="5375917">{</span><span class="ident" id="5375918">shoff</span>&nbsp;<span class="op" id="5375924">+</span>&nbsp;<span class="ident" id="5375926">int64</span><span class="op" id="5375931">(</span><span class="ident" id="5375932">i</span><span class="op" id="5375933">*</span><span class="ident" id="5375934">shentsize</span><span class="op" id="5375943">)</span><span class="op" id="5375944">,</span>&nbsp;<span class="string" id="5375946">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5375970">,</span>&nbsp;<span class="ident" id="5375972">names</span><span class="op" id="5375977">[</span><span class="ident" id="5375978">i</span><span class="op" id="5375979">]</span><span class="op" id="5375980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5375987">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5375991">return</span>&nbsp;<span class="ident" id="5375998">f</span><span class="op" id="5375999">,</span>&nbsp;<span class="ident" id="5376001">nil</span><br>
<span class="lineno"></span><span class="op" id="5376005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5376008">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5376079">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5376143">func</span>&nbsp;<span class="op" id="5376148">(</span><span class="ident" id="5376149">f</span>&nbsp;<span class="op" id="5376151">*</span><span class="ident" id="5376152">File</span><span class="op" id="5376156">)</span>&nbsp;<span class="ident" id="5376158">getSymbols</span><span class="op" id="5376168">(</span><span class="ident" id="5376169">typ</span>&nbsp;<span class="ident" id="5376173">SectionType</span><span class="op" id="5376184">)</span>&nbsp;<span class="op" id="5376186">(</span><span class="op" id="5376187">[</span><span class="op" id="5376188">]</span><span class="ident" id="5376189">Symbol</span><span class="op" id="5376195">,</span>&nbsp;<span class="op" id="5376197">[</span><span class="op" id="5376198">]</span><span class="builtintype" id="5376199">byte</span><span class="op" id="5376203">,</span>&nbsp;<span class="builtintype" id="5376205">error</span><span class="op" id="5376210">)</span>&nbsp;<span class="op" id="5376212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376215">switch</span>&nbsp;<span class="ident" id="5376222">f</span><span class="op" id="5376223">.</span><span class="ident" id="5376224">Class</span>&nbsp;<span class="op" id="5376230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376233">case</span>&nbsp;<span class="ident" id="5376238">ELFCLASS64</span><span class="op" id="5376248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376252">return</span>&nbsp;<span class="ident" id="5376259">f</span><span class="op" id="5376260">.</span><span class="ident" id="5376261">getSymbols64</span><span class="op" id="5376273">(</span><span class="ident" id="5376274">typ</span><span class="op" id="5376277">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376281">case</span>&nbsp;<span class="ident" id="5376286">ELFCLASS32</span><span class="op" id="5376296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376300">return</span>&nbsp;<span class="ident" id="5376307">f</span><span class="op" id="5376308">.</span><span class="ident" id="5376309">getSymbols32</span><span class="op" id="5376321">(</span><span class="ident" id="5376322">typ</span><span class="op" id="5376325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5376328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376332">return</span>&nbsp;<span class="ident" id="5376339">nil</span><span class="op" id="5376342">,</span>&nbsp;<span class="ident" id="5376344">nil</span><span class="op" id="5376347">,</span>&nbsp;<span class="ident" id="5376349">errors</span><span class="op" id="5376355">.</span><span class="ident" id="5376356">New</span><span class="op" id="5376359">(</span><span class="string" id="5376360">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5376377">)</span><br>
<span class="lineno"></span><span class="op" id="5376379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5376382">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5376450">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5376494">var</span>&nbsp;<span class="ident" id="5376498">ErrNoSymbols</span>&nbsp;<span class="op" id="5376511">=</span>&nbsp;<span class="ident" id="5376513">errors</span><span class="op" id="5376519">.</span><span class="ident" id="5376520">New</span><span class="op" id="5376523">(</span><span class="string" id="5376524">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5376543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5376546">func</span>&nbsp;<span class="op" id="5376551">(</span><span class="ident" id="5376552">f</span>&nbsp;<span class="op" id="5376554">*</span><span class="ident" id="5376555">File</span><span class="op" id="5376559">)</span>&nbsp;<span class="ident" id="5376561">getSymbols32</span><span class="op" id="5376573">(</span><span class="ident" id="5376574">typ</span>&nbsp;<span class="ident" id="5376578">SectionType</span><span class="op" id="5376589">)</span>&nbsp;<span class="op" id="5376591">(</span><span class="op" id="5376592">[</span><span class="op" id="5376593">]</span><span class="ident" id="5376594">Symbol</span><span class="op" id="5376600">,</span>&nbsp;<span class="op" id="5376602">[</span><span class="op" id="5376603">]</span><span class="builtintype" id="5376604">byte</span><span class="op" id="5376608">,</span>&nbsp;<span class="builtintype" id="5376610">error</span><span class="op" id="5376615">)</span>&nbsp;<span class="op" id="5376617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5376620">symtabSection</span>&nbsp;<span class="op" id="5376634">:=</span>&nbsp;<span class="ident" id="5376637">f</span><span class="op" id="5376638">.</span><span class="ident" id="5376639">SectionByType</span><span class="op" id="5376652">(</span><span class="ident" id="5376653">typ</span><span class="op" id="5376656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376659">if</span>&nbsp;<span class="ident" id="5376662">symtabSection</span>&nbsp;<span class="op" id="5376676">==</span>&nbsp;<span class="ident" id="5376679">nil</span>&nbsp;<span class="op" id="5376683">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376687">return</span>&nbsp;<span class="ident" id="5376694">nil</span><span class="op" id="5376697">,</span>&nbsp;<span class="ident" id="5376699">nil</span><span class="op" id="5376702">,</span>&nbsp;<span class="ident" id="5376704">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5376718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5376722">data</span><span class="op" id="5376726">,</span>&nbsp;<span class="ident" id="5376728">err</span>&nbsp;<span class="op" id="5376732">:=</span>&nbsp;<span class="ident" id="5376735">symtabSection</span><span class="op" id="5376748">.</span><span class="ident" id="5376749">Data</span><span class="op" id="5376753">(</span><span class="op" id="5376754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376757">if</span>&nbsp;<span class="ident" id="5376760">err</span>&nbsp;<span class="op" id="5376764">!=</span>&nbsp;<span class="ident" id="5376767">nil</span>&nbsp;<span class="op" id="5376771">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376775">return</span>&nbsp;<span class="ident" id="5376782">nil</span><span class="op" id="5376785">,</span>&nbsp;<span class="ident" id="5376787">nil</span><span class="op" id="5376790">,</span>&nbsp;<span class="ident" id="5376792">errors</span><span class="op" id="5376798">.</span><span class="ident" id="5376799">New</span><span class="op" id="5376802">(</span><span class="string" id="5376803">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5376831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5376834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5376837">symtab</span>&nbsp;<span class="op" id="5376844">:=</span>&nbsp;<span class="ident" id="5376847">bytes</span><span class="op" id="5376852">.</span><span class="ident" id="5376853">NewReader</span><span class="op" id="5376862">(</span><span class="ident" id="5376863">data</span><span class="op" id="5376867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376870">if</span>&nbsp;<span class="ident" id="5376873">symtab</span><span class="op" id="5376879">.</span><span class="ident" id="5376880">Len</span><span class="op" id="5376883">(</span><span class="op" id="5376884">)</span><span class="op" id="5376885">%</span><span class="ident" id="5376886">Sym32Size</span>&nbsp;<span class="op" id="5376896">!=</span>&nbsp;<span class="num" id="5376899">0</span>&nbsp;<span class="op" id="5376901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5376905">return</span>&nbsp;<span class="ident" id="5376912">nil</span><span class="op" id="5376915">,</span>&nbsp;<span class="ident" id="5376917">nil</span><span class="op" id="5376920">,</span>&nbsp;<span class="ident" id="5376922">errors</span><span class="op" id="5376928">.</span><span class="ident" id="5376929">New</span><span class="op" id="5376932">(</span><span class="string" id="5376933">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5376988">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5376991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5376995">strdata</span><span class="op" id="5377002">,</span>&nbsp;<span class="ident" id="5377004">err</span>&nbsp;<span class="op" id="5377008">:=</span>&nbsp;<span class="ident" id="5377011">f</span><span class="op" id="5377012">.</span><span class="ident" id="5377013">stringTable</span><span class="op" id="5377024">(</span><span class="ident" id="5377025">symtabSection</span><span class="op" id="5377038">.</span><span class="ident" id="5377039">Link</span><span class="op" id="5377043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377046">if</span>&nbsp;<span class="ident" id="5377049">err</span>&nbsp;<span class="op" id="5377053">!=</span>&nbsp;<span class="ident" id="5377056">nil</span>&nbsp;<span class="op" id="5377060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377064">return</span>&nbsp;<span class="ident" id="5377071">nil</span><span class="op" id="5377074">,</span>&nbsp;<span class="ident" id="5377076">nil</span><span class="op" id="5377079">,</span>&nbsp;<span class="ident" id="5377081">errors</span><span class="op" id="5377087">.</span><span class="ident" id="5377088">New</span><span class="op" id="5377091">(</span><span class="string" id="5377092">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5377126">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5377129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5377133">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377167">var</span>&nbsp;<span class="ident" id="5377171">skip</span>&nbsp;<span class="op" id="5377176">[</span><span class="ident" id="5377177">Sym32Size</span><span class="op" id="5377186">]</span><span class="builtintype" id="5377187">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377193">symtab</span><span class="op" id="5377199">.</span><span class="ident" id="5377200">Read</span><span class="op" id="5377204">(</span><span class="ident" id="5377205">skip</span><span class="op" id="5377209">[</span><span class="op" id="5377210">:</span><span class="op" id="5377211">]</span><span class="op" id="5377212">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377216">symbols</span>&nbsp;<span class="op" id="5377224">:=</span>&nbsp;<span class="builtinfunc" id="5377227">make</span><span class="op" id="5377231">(</span><span class="op" id="5377232">[</span><span class="op" id="5377233">]</span><span class="ident" id="5377234">Symbol</span><span class="op" id="5377240">,</span>&nbsp;<span class="ident" id="5377242">symtab</span><span class="op" id="5377248">.</span><span class="ident" id="5377249">Len</span><span class="op" id="5377252">(</span><span class="op" id="5377253">)</span><span class="op" id="5377254">/</span><span class="ident" id="5377255">Sym32Size</span><span class="op" id="5377264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377268">i</span>&nbsp;<span class="op" id="5377270">:=</span>&nbsp;<span class="num" id="5377273">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377276">var</span>&nbsp;<span class="ident" id="5377280">sym</span>&nbsp;<span class="ident" id="5377284">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377291">for</span>&nbsp;<span class="ident" id="5377295">symtab</span><span class="op" id="5377301">.</span><span class="ident" id="5377302">Len</span><span class="op" id="5377305">(</span><span class="op" id="5377306">)</span>&nbsp;<span class="op" id="5377308">&gt;</span>&nbsp;<span class="num" id="5377310">0</span>&nbsp;<span class="op" id="5377312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377316">binary</span><span class="op" id="5377322">.</span><span class="ident" id="5377323">Read</span><span class="op" id="5377327">(</span><span class="ident" id="5377328">symtab</span><span class="op" id="5377334">,</span>&nbsp;<span class="ident" id="5377336">f</span><span class="op" id="5377337">.</span><span class="ident" id="5377338">ByteOrder</span><span class="op" id="5377347">,</span>&nbsp;<span class="op" id="5377349">&amp;</span><span class="ident" id="5377350">sym</span><span class="op" id="5377353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377357">str</span><span class="op" id="5377360">,</span>&nbsp;<span class="ident" id="5377362">_</span>&nbsp;<span class="op" id="5377364">:=</span>&nbsp;<span class="ident" id="5377367">getString</span><span class="op" id="5377376">(</span><span class="ident" id="5377377">strdata</span><span class="op" id="5377384">,</span>&nbsp;<span class="builtintype" id="5377386">int</span><span class="op" id="5377389">(</span><span class="ident" id="5377390">sym</span><span class="op" id="5377393">.</span><span class="ident" id="5377394">Name</span><span class="op" id="5377398">)</span><span class="op" id="5377399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377403">symbols</span><span class="op" id="5377410">[</span><span class="ident" id="5377411">i</span><span class="op" id="5377412">]</span><span class="op" id="5377413">.</span><span class="ident" id="5377414">Name</span>&nbsp;<span class="op" id="5377419">=</span>&nbsp;<span class="ident" id="5377421">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377427">symbols</span><span class="op" id="5377434">[</span><span class="ident" id="5377435">i</span><span class="op" id="5377436">]</span><span class="op" id="5377437">.</span><span class="ident" id="5377438">Info</span>&nbsp;<span class="op" id="5377443">=</span>&nbsp;<span class="ident" id="5377445">sym</span><span class="op" id="5377448">.</span><span class="ident" id="5377449">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377456">symbols</span><span class="op" id="5377463">[</span><span class="ident" id="5377464">i</span><span class="op" id="5377465">]</span><span class="op" id="5377466">.</span><span class="ident" id="5377467">Other</span>&nbsp;<span class="op" id="5377473">=</span>&nbsp;<span class="ident" id="5377475">sym</span><span class="op" id="5377478">.</span><span class="ident" id="5377479">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377487">symbols</span><span class="op" id="5377494">[</span><span class="ident" id="5377495">i</span><span class="op" id="5377496">]</span><span class="op" id="5377497">.</span><span class="ident" id="5377498">Section</span>&nbsp;<span class="op" id="5377506">=</span>&nbsp;<span class="ident" id="5377508">SectionIndex</span><span class="op" id="5377520">(</span><span class="ident" id="5377521">sym</span><span class="op" id="5377524">.</span><span class="ident" id="5377525">Shndx</span><span class="op" id="5377530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377534">symbols</span><span class="op" id="5377541">[</span><span class="ident" id="5377542">i</span><span class="op" id="5377543">]</span><span class="op" id="5377544">.</span><span class="ident" id="5377545">Value</span>&nbsp;<span class="op" id="5377551">=</span>&nbsp;<span class="ident" id="5377553">uint64</span><span class="op" id="5377559">(</span><span class="ident" id="5377560">sym</span><span class="op" id="5377563">.</span><span class="ident" id="5377564">Value</span><span class="op" id="5377569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377573">symbols</span><span class="op" id="5377580">[</span><span class="ident" id="5377581">i</span><span class="op" id="5377582">]</span><span class="op" id="5377583">.</span><span class="ident" id="5377584">Size</span>&nbsp;<span class="op" id="5377589">=</span>&nbsp;<span class="ident" id="5377591">uint64</span><span class="op" id="5377597">(</span><span class="ident" id="5377598">sym</span><span class="op" id="5377601">.</span><span class="ident" id="5377602">Size</span><span class="op" id="5377606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377610">i</span><span class="op" id="5377611">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5377615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377619">return</span>&nbsp;<span class="ident" id="5377626">symbols</span><span class="op" id="5377633">,</span>&nbsp;<span class="ident" id="5377635">strdata</span><span class="op" id="5377642">,</span>&nbsp;<span class="ident" id="5377644">nil</span><br>
<span class="lineno"></span><span class="op" id="5377648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5377651">func</span>&nbsp;<span class="op" id="5377656">(</span><span class="ident" id="5377657">f</span>&nbsp;<span class="op" id="5377659">*</span><span class="ident" id="5377660">File</span><span class="op" id="5377664">)</span>&nbsp;<span class="ident" id="5377666">getSymbols64</span><span class="op" id="5377678">(</span><span class="ident" id="5377679">typ</span>&nbsp;<span class="ident" id="5377683">SectionType</span><span class="op" id="5377694">)</span>&nbsp;<span class="op" id="5377696">(</span><span class="op" id="5377697">[</span><span class="op" id="5377698">]</span><span class="ident" id="5377699">Symbol</span><span class="op" id="5377705">,</span>&nbsp;<span class="op" id="5377707">[</span><span class="op" id="5377708">]</span><span class="builtintype" id="5377709">byte</span><span class="op" id="5377713">,</span>&nbsp;<span class="builtintype" id="5377715">error</span><span class="op" id="5377720">)</span>&nbsp;<span class="op" id="5377722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377725">symtabSection</span>&nbsp;<span class="op" id="5377739">:=</span>&nbsp;<span class="ident" id="5377742">f</span><span class="op" id="5377743">.</span><span class="ident" id="5377744">SectionByType</span><span class="op" id="5377757">(</span><span class="ident" id="5377758">typ</span><span class="op" id="5377761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377764">if</span>&nbsp;<span class="ident" id="5377767">symtabSection</span>&nbsp;<span class="op" id="5377781">==</span>&nbsp;<span class="ident" id="5377784">nil</span>&nbsp;<span class="op" id="5377788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377792">return</span>&nbsp;<span class="ident" id="5377799">nil</span><span class="op" id="5377802">,</span>&nbsp;<span class="ident" id="5377804">nil</span><span class="op" id="5377807">,</span>&nbsp;<span class="ident" id="5377809">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5377823">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377827">data</span><span class="op" id="5377831">,</span>&nbsp;<span class="ident" id="5377833">err</span>&nbsp;<span class="op" id="5377837">:=</span>&nbsp;<span class="ident" id="5377840">symtabSection</span><span class="op" id="5377853">.</span><span class="ident" id="5377854">Data</span><span class="op" id="5377858">(</span><span class="op" id="5377859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377862">if</span>&nbsp;<span class="ident" id="5377865">err</span>&nbsp;<span class="op" id="5377869">!=</span>&nbsp;<span class="ident" id="5377872">nil</span>&nbsp;<span class="op" id="5377876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377880">return</span>&nbsp;<span class="ident" id="5377887">nil</span><span class="op" id="5377890">,</span>&nbsp;<span class="ident" id="5377892">nil</span><span class="op" id="5377895">,</span>&nbsp;<span class="ident" id="5377897">errors</span><span class="op" id="5377903">.</span><span class="ident" id="5377904">New</span><span class="op" id="5377907">(</span><span class="string" id="5377908">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5377936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5377939">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5377942">symtab</span>&nbsp;<span class="op" id="5377949">:=</span>&nbsp;<span class="ident" id="5377952">bytes</span><span class="op" id="5377957">.</span><span class="ident" id="5377958">NewReader</span><span class="op" id="5377967">(</span><span class="ident" id="5377968">data</span><span class="op" id="5377972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5377975">if</span>&nbsp;<span class="ident" id="5377978">symtab</span><span class="op" id="5377984">.</span><span class="ident" id="5377985">Len</span><span class="op" id="5377988">(</span><span class="op" id="5377989">)</span><span class="op" id="5377990">%</span><span class="ident" id="5377991">Sym64Size</span>&nbsp;<span class="op" id="5378001">!=</span>&nbsp;<span class="num" id="5378004">0</span>&nbsp;<span class="op" id="5378006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378010">return</span>&nbsp;<span class="ident" id="5378017">nil</span><span class="op" id="5378020">,</span>&nbsp;<span class="ident" id="5378022">nil</span><span class="op" id="5378025">,</span>&nbsp;<span class="ident" id="5378027">errors</span><span class="op" id="5378033">.</span><span class="ident" id="5378034">New</span><span class="op" id="5378037">(</span><span class="string" id="5378038">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5378095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5378098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378102">strdata</span><span class="op" id="5378109">,</span>&nbsp;<span class="ident" id="5378111">err</span>&nbsp;<span class="op" id="5378115">:=</span>&nbsp;<span class="ident" id="5378118">f</span><span class="op" id="5378119">.</span><span class="ident" id="5378120">stringTable</span><span class="op" id="5378131">(</span><span class="ident" id="5378132">symtabSection</span><span class="op" id="5378145">.</span><span class="ident" id="5378146">Link</span><span class="op" id="5378150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378153">if</span>&nbsp;<span class="ident" id="5378156">err</span>&nbsp;<span class="op" id="5378160">!=</span>&nbsp;<span class="ident" id="5378163">nil</span>&nbsp;<span class="op" id="5378167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378171">return</span>&nbsp;<span class="ident" id="5378178">nil</span><span class="op" id="5378181">,</span>&nbsp;<span class="ident" id="5378183">nil</span><span class="op" id="5378186">,</span>&nbsp;<span class="ident" id="5378188">errors</span><span class="op" id="5378194">.</span><span class="ident" id="5378195">New</span><span class="op" id="5378198">(</span><span class="string" id="5378199">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5378233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5378236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5378240">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378274">var</span>&nbsp;<span class="ident" id="5378278">skip</span>&nbsp;<span class="op" id="5378283">[</span><span class="ident" id="5378284">Sym64Size</span><span class="op" id="5378293">]</span><span class="builtintype" id="5378294">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378300">symtab</span><span class="op" id="5378306">.</span><span class="ident" id="5378307">Read</span><span class="op" id="5378311">(</span><span class="ident" id="5378312">skip</span><span class="op" id="5378316">[</span><span class="op" id="5378317">:</span><span class="op" id="5378318">]</span><span class="op" id="5378319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378323">symbols</span>&nbsp;<span class="op" id="5378331">:=</span>&nbsp;<span class="builtinfunc" id="5378334">make</span><span class="op" id="5378338">(</span><span class="op" id="5378339">[</span><span class="op" id="5378340">]</span><span class="ident" id="5378341">Symbol</span><span class="op" id="5378347">,</span>&nbsp;<span class="ident" id="5378349">symtab</span><span class="op" id="5378355">.</span><span class="ident" id="5378356">Len</span><span class="op" id="5378359">(</span><span class="op" id="5378360">)</span><span class="op" id="5378361">/</span><span class="ident" id="5378362">Sym64Size</span><span class="op" id="5378371">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378375">i</span>&nbsp;<span class="op" id="5378377">:=</span>&nbsp;<span class="num" id="5378380">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378383">var</span>&nbsp;<span class="ident" id="5378387">sym</span>&nbsp;<span class="ident" id="5378391">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378398">for</span>&nbsp;<span class="ident" id="5378402">symtab</span><span class="op" id="5378408">.</span><span class="ident" id="5378409">Len</span><span class="op" id="5378412">(</span><span class="op" id="5378413">)</span>&nbsp;<span class="op" id="5378415">&gt;</span>&nbsp;<span class="num" id="5378417">0</span>&nbsp;<span class="op" id="5378419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378423">binary</span><span class="op" id="5378429">.</span><span class="ident" id="5378430">Read</span><span class="op" id="5378434">(</span><span class="ident" id="5378435">symtab</span><span class="op" id="5378441">,</span>&nbsp;<span class="ident" id="5378443">f</span><span class="op" id="5378444">.</span><span class="ident" id="5378445">ByteOrder</span><span class="op" id="5378454">,</span>&nbsp;<span class="op" id="5378456">&amp;</span><span class="ident" id="5378457">sym</span><span class="op" id="5378460">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378464">str</span><span class="op" id="5378467">,</span>&nbsp;<span class="ident" id="5378469">_</span>&nbsp;<span class="op" id="5378471">:=</span>&nbsp;<span class="ident" id="5378474">getString</span><span class="op" id="5378483">(</span><span class="ident" id="5378484">strdata</span><span class="op" id="5378491">,</span>&nbsp;<span class="builtintype" id="5378493">int</span><span class="op" id="5378496">(</span><span class="ident" id="5378497">sym</span><span class="op" id="5378500">.</span><span class="ident" id="5378501">Name</span><span class="op" id="5378505">)</span><span class="op" id="5378506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378510">symbols</span><span class="op" id="5378517">[</span><span class="ident" id="5378518">i</span><span class="op" id="5378519">]</span><span class="op" id="5378520">.</span><span class="ident" id="5378521">Name</span>&nbsp;<span class="op" id="5378526">=</span>&nbsp;<span class="ident" id="5378528">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378534">symbols</span><span class="op" id="5378541">[</span><span class="ident" id="5378542">i</span><span class="op" id="5378543">]</span><span class="op" id="5378544">.</span><span class="ident" id="5378545">Info</span>&nbsp;<span class="op" id="5378550">=</span>&nbsp;<span class="ident" id="5378552">sym</span><span class="op" id="5378555">.</span><span class="ident" id="5378556">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378563">symbols</span><span class="op" id="5378570">[</span><span class="ident" id="5378571">i</span><span class="op" id="5378572">]</span><span class="op" id="5378573">.</span><span class="ident" id="5378574">Other</span>&nbsp;<span class="op" id="5378580">=</span>&nbsp;<span class="ident" id="5378582">sym</span><span class="op" id="5378585">.</span><span class="ident" id="5378586">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378594">symbols</span><span class="op" id="5378601">[</span><span class="ident" id="5378602">i</span><span class="op" id="5378603">]</span><span class="op" id="5378604">.</span><span class="ident" id="5378605">Section</span>&nbsp;<span class="op" id="5378613">=</span>&nbsp;<span class="ident" id="5378615">SectionIndex</span><span class="op" id="5378627">(</span><span class="ident" id="5378628">sym</span><span class="op" id="5378631">.</span><span class="ident" id="5378632">Shndx</span><span class="op" id="5378637">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378641">symbols</span><span class="op" id="5378648">[</span><span class="ident" id="5378649">i</span><span class="op" id="5378650">]</span><span class="op" id="5378651">.</span><span class="ident" id="5378652">Value</span>&nbsp;<span class="op" id="5378658">=</span>&nbsp;<span class="ident" id="5378660">sym</span><span class="op" id="5378663">.</span><span class="ident" id="5378664">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378672">symbols</span><span class="op" id="5378679">[</span><span class="ident" id="5378680">i</span><span class="op" id="5378681">]</span><span class="op" id="5378682">.</span><span class="ident" id="5378683">Size</span>&nbsp;<span class="op" id="5378688">=</span>&nbsp;<span class="ident" id="5378690">sym</span><span class="op" id="5378693">.</span><span class="ident" id="5378694">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5378701">i</span><span class="op" id="5378702">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5378706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378710">return</span>&nbsp;<span class="ident" id="5378717">symbols</span><span class="op" id="5378724">,</span>&nbsp;<span class="ident" id="5378726">strdata</span><span class="op" id="5378733">,</span>&nbsp;<span class="ident" id="5378735">nil</span><br>
<span class="lineno"></span><span class="op" id="5378739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5378742">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5378799">func</span>&nbsp;<span class="ident" id="5378804">getString</span><span class="op" id="5378813">(</span><span class="ident" id="5378814">section</span>&nbsp;<span class="op" id="5378822">[</span><span class="op" id="5378823">]</span><span class="builtintype" id="5378824">byte</span><span class="op" id="5378828">,</span>&nbsp;<span class="ident" id="5378830">start</span>&nbsp;<span class="builtintype" id="5378836">int</span><span class="op" id="5378839">)</span>&nbsp;<span class="op" id="5378841">(</span><span class="builtintype" id="5378842">string</span><span class="op" id="5378848">,</span>&nbsp;<span class="builtintype" id="5378850">bool</span><span class="op" id="5378854">)</span>&nbsp;<span class="op" id="5378856">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378859">if</span>&nbsp;<span class="ident" id="5378862">start</span>&nbsp;<span class="op" id="5378868">&lt;</span>&nbsp;<span class="num" id="5378870">0</span>&nbsp;<span class="op" id="5378872">||</span>&nbsp;<span class="ident" id="5378875">start</span>&nbsp;<span class="op" id="5378881">&gt;=</span>&nbsp;<span class="builtinfunc" id="5378884">len</span><span class="op" id="5378887">(</span><span class="ident" id="5378888">section</span><span class="op" id="5378895">)</span>&nbsp;<span class="op" id="5378897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378901">return</span>&nbsp;<span class="string" id="5378908">&#34;&#34;</span><span class="op" id="5378910">,</span>&nbsp;<span class="ident" id="5378912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5378919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378923">for</span>&nbsp;<span class="ident" id="5378927">end</span>&nbsp;<span class="op" id="5378931">:=</span>&nbsp;<span class="ident" id="5378934">start</span><span class="op" id="5378939">;</span>&nbsp;<span class="ident" id="5378941">end</span>&nbsp;<span class="op" id="5378945">&lt;</span>&nbsp;<span class="builtinfunc" id="5378947">len</span><span class="op" id="5378950">(</span><span class="ident" id="5378951">section</span><span class="op" id="5378958">)</span><span class="op" id="5378959">;</span>&nbsp;<span class="ident" id="5378961">end</span><span class="op" id="5378964">++</span>&nbsp;<span class="op" id="5378967">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378971">if</span>&nbsp;<span class="ident" id="5378974">section</span><span class="op" id="5378981">[</span><span class="ident" id="5378982">end</span><span class="op" id="5378985">]</span>&nbsp;<span class="op" id="5378987">==</span>&nbsp;<span class="num" id="5378990">0</span>&nbsp;<span class="op" id="5378992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5378997">return</span>&nbsp;<span class="builtintype" id="5379004">string</span><span class="op" id="5379010">(</span><span class="ident" id="5379011">section</span><span class="op" id="5379018">[</span><span class="ident" id="5379019">start</span><span class="op" id="5379024">:</span><span class="ident" id="5379025">end</span><span class="op" id="5379028">]</span><span class="op" id="5379029">)</span><span class="op" id="5379030">,</span>&nbsp;<span class="ident" id="5379032">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379045">return</span>&nbsp;<span class="string" id="5379052">&#34;&#34;</span><span class="op" id="5379054">,</span>&nbsp;<span class="ident" id="5379056">false</span><br>
<span class="lineno">510</span><span class="op" id="5379062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5379065">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5379133">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5379152">func</span>&nbsp;<span class="op" id="5379157">(</span><span class="ident" id="5379158">f</span>&nbsp;<span class="op" id="5379160">*</span><span class="ident" id="5379161">File</span><span class="op" id="5379165">)</span>&nbsp;<span class="ident" id="5379167">Section</span><span class="op" id="5379174">(</span><span class="ident" id="5379175">name</span>&nbsp;<span class="builtintype" id="5379180">string</span><span class="op" id="5379186">)</span>&nbsp;<span class="op" id="5379188">*</span><span class="ident" id="5379189">Section</span>&nbsp;<span class="op" id="5379197">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379200">for</span>&nbsp;<span class="ident" id="5379204">_</span><span class="op" id="5379205">,</span>&nbsp;<span class="ident" id="5379207">s</span>&nbsp;<span class="op" id="5379209">:=</span>&nbsp;<span class="keyword" id="5379212">range</span>&nbsp;<span class="ident" id="5379218">f</span><span class="op" id="5379219">.</span><span class="ident" id="5379220">Sections</span>&nbsp;<span class="op" id="5379229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379233">if</span>&nbsp;<span class="ident" id="5379236">s</span><span class="op" id="5379237">.</span><span class="ident" id="5379238">Name</span>&nbsp;<span class="op" id="5379243">==</span>&nbsp;<span class="ident" id="5379246">name</span>&nbsp;<span class="op" id="5379251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379256">return</span>&nbsp;<span class="ident" id="5379263">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379270">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379273">return</span>&nbsp;<span class="ident" id="5379280">nil</span><br>
<span class="lineno"></span><span class="op" id="5379284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5379287">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5379365">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5379384">func</span>&nbsp;<span class="op" id="5379389">(</span><span class="ident" id="5379390">f</span>&nbsp;<span class="op" id="5379392">*</span><span class="ident" id="5379393">File</span><span class="op" id="5379397">)</span>&nbsp;<span class="ident" id="5379399">applyRelocations</span><span class="op" id="5379415">(</span><span class="ident" id="5379416">dst</span>&nbsp;<span class="op" id="5379420">[</span><span class="op" id="5379421">]</span><span class="builtintype" id="5379422">byte</span><span class="op" id="5379426">,</span>&nbsp;<span class="ident" id="5379428">rels</span>&nbsp;<span class="op" id="5379433">[</span><span class="op" id="5379434">]</span><span class="builtintype" id="5379435">byte</span><span class="op" id="5379439">)</span>&nbsp;<span class="builtintype" id="5379441">error</span>&nbsp;<span class="op" id="5379447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379450">if</span>&nbsp;<span class="ident" id="5379453">f</span><span class="op" id="5379454">.</span><span class="ident" id="5379455">Class</span>&nbsp;<span class="op" id="5379461">==</span>&nbsp;<span class="ident" id="5379464">ELFCLASS64</span>&nbsp;<span class="op" id="5379475">&amp;&amp;</span>&nbsp;<span class="ident" id="5379478">f</span><span class="op" id="5379479">.</span><span class="ident" id="5379480">Machine</span>&nbsp;<span class="op" id="5379488">==</span>&nbsp;<span class="ident" id="5379491">EM_X86_64</span>&nbsp;<span class="op" id="5379501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379505">return</span>&nbsp;<span class="ident" id="5379512">f</span><span class="op" id="5379513">.</span><span class="ident" id="5379514">applyRelocationsAMD64</span><span class="op" id="5379535">(</span><span class="ident" id="5379536">dst</span><span class="op" id="5379539">,</span>&nbsp;<span class="ident" id="5379541">rels</span><span class="op" id="5379545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379551">if</span>&nbsp;<span class="ident" id="5379554">f</span><span class="op" id="5379555">.</span><span class="ident" id="5379556">Class</span>&nbsp;<span class="op" id="5379562">==</span>&nbsp;<span class="ident" id="5379565">ELFCLASS32</span>&nbsp;<span class="op" id="5379576">&amp;&amp;</span>&nbsp;<span class="ident" id="5379579">f</span><span class="op" id="5379580">.</span><span class="ident" id="5379581">Machine</span>&nbsp;<span class="op" id="5379589">==</span>&nbsp;<span class="ident" id="5379592">EM_386</span>&nbsp;<span class="op" id="5379599">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379603">return</span>&nbsp;<span class="ident" id="5379610">f</span><span class="op" id="5379611">.</span><span class="ident" id="5379612">applyRelocations386</span><span class="op" id="5379631">(</span><span class="ident" id="5379632">dst</span><span class="op" id="5379635">,</span>&nbsp;<span class="ident" id="5379637">rels</span><span class="op" id="5379641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379647">if</span>&nbsp;<span class="ident" id="5379650">f</span><span class="op" id="5379651">.</span><span class="ident" id="5379652">Class</span>&nbsp;<span class="op" id="5379658">==</span>&nbsp;<span class="ident" id="5379661">ELFCLASS64</span>&nbsp;<span class="op" id="5379672">&amp;&amp;</span>&nbsp;<span class="ident" id="5379675">f</span><span class="op" id="5379676">.</span><span class="ident" id="5379677">Machine</span>&nbsp;<span class="op" id="5379685">==</span>&nbsp;<span class="ident" id="5379688">EM_AARCH64</span>&nbsp;<span class="op" id="5379699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379703">return</span>&nbsp;<span class="ident" id="5379710">f</span><span class="op" id="5379711">.</span><span class="ident" id="5379712">applyRelocationsARM64</span><span class="op" id="5379733">(</span><span class="ident" id="5379734">dst</span><span class="op" id="5379737">,</span>&nbsp;<span class="ident" id="5379739">rels</span><span class="op" id="5379743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379746">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379750">return</span>&nbsp;<span class="ident" id="5379757">errors</span><span class="op" id="5379763">.</span><span class="ident" id="5379764">New</span><span class="op" id="5379767">(</span><span class="string" id="5379768">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5379785">)</span><br>
<span class="lineno"></span><span class="op" id="5379787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5379790">func</span>&nbsp;<span class="op" id="5379795">(</span><span class="ident" id="5379796">f</span>&nbsp;<span class="op" id="5379798">*</span><span class="ident" id="5379799">File</span><span class="op" id="5379803">)</span>&nbsp;<span class="ident" id="5379805">applyRelocationsAMD64</span><span class="op" id="5379826">(</span><span class="ident" id="5379827">dst</span>&nbsp;<span class="op" id="5379831">[</span><span class="op" id="5379832">]</span><span class="builtintype" id="5379833">byte</span><span class="op" id="5379837">,</span>&nbsp;<span class="ident" id="5379839">rels</span>&nbsp;<span class="op" id="5379844">[</span><span class="op" id="5379845">]</span><span class="builtintype" id="5379846">byte</span><span class="op" id="5379850">)</span>&nbsp;<span class="builtintype" id="5379852">error</span>&nbsp;<span class="op" id="5379858">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5379861">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379891">if</span>&nbsp;<span class="builtinfunc" id="5379894">len</span><span class="op" id="5379897">(</span><span class="ident" id="5379898">rels</span><span class="op" id="5379902">)</span><span class="op" id="5379903">%</span><span class="num" id="5379904">24</span>&nbsp;<span class="op" id="5379907">!=</span>&nbsp;<span class="num" id="5379910">0</span>&nbsp;<span class="op" id="5379912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5379916">return</span>&nbsp;<span class="ident" id="5379923">errors</span><span class="op" id="5379929">.</span><span class="ident" id="5379930">New</span><span class="op" id="5379933">(</span><span class="string" id="5379934">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5379988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5379991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5379995">symbols</span><span class="op" id="5380002">,</span>&nbsp;<span class="ident" id="5380004">_</span><span class="op" id="5380005">,</span>&nbsp;<span class="ident" id="5380007">err</span>&nbsp;<span class="op" id="5380011">:=</span>&nbsp;<span class="ident" id="5380014">f</span><span class="op" id="5380015">.</span><span class="ident" id="5380016">getSymbols</span><span class="op" id="5380026">(</span><span class="ident" id="5380027">SHT_SYMTAB</span><span class="op" id="5380037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380040">if</span>&nbsp;<span class="ident" id="5380043">err</span>&nbsp;<span class="op" id="5380047">!=</span>&nbsp;<span class="ident" id="5380050">nil</span>&nbsp;<span class="op" id="5380054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380058">return</span>&nbsp;<span class="ident" id="5380065">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380074">b</span>&nbsp;<span class="op" id="5380076">:=</span>&nbsp;<span class="ident" id="5380079">bytes</span><span class="op" id="5380084">.</span><span class="ident" id="5380085">NewReader</span><span class="op" id="5380094">(</span><span class="ident" id="5380095">rels</span><span class="op" id="5380099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380102">var</span>&nbsp;<span class="ident" id="5380106">rela</span>&nbsp;<span class="ident" id="5380111">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380120">for</span>&nbsp;<span class="ident" id="5380124">b</span><span class="op" id="5380125">.</span><span class="ident" id="5380126">Len</span><span class="op" id="5380129">(</span><span class="op" id="5380130">)</span>&nbsp;<span class="op" id="5380132">&gt;</span>&nbsp;<span class="num" id="5380134">0</span>&nbsp;<span class="op" id="5380136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380140">binary</span><span class="op" id="5380146">.</span><span class="ident" id="5380147">Read</span><span class="op" id="5380151">(</span><span class="ident" id="5380152">b</span><span class="op" id="5380153">,</span>&nbsp;<span class="ident" id="5380155">f</span><span class="op" id="5380156">.</span><span class="ident" id="5380157">ByteOrder</span><span class="op" id="5380166">,</span>&nbsp;<span class="op" id="5380168">&amp;</span><span class="ident" id="5380169">rela</span><span class="op" id="5380173">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380177">symNo</span>&nbsp;<span class="op" id="5380183">:=</span>&nbsp;<span class="ident" id="5380186">rela</span><span class="op" id="5380190">.</span><span class="ident" id="5380191">Info</span>&nbsp;<span class="op" id="5380196">&gt;&gt;</span>&nbsp;<span class="num" id="5380199">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380204">t</span>&nbsp;<span class="op" id="5380206">:=</span>&nbsp;<span class="ident" id="5380209">R_X86_64</span><span class="op" id="5380217">(</span><span class="ident" id="5380218">rela</span><span class="op" id="5380222">.</span><span class="ident" id="5380223">Info</span>&nbsp;<span class="op" id="5380228">&amp;</span>&nbsp;<span class="num" id="5380230">0xffff</span><span class="op" id="5380236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380241">if</span>&nbsp;<span class="ident" id="5380244">symNo</span>&nbsp;<span class="op" id="5380250">==</span>&nbsp;<span class="num" id="5380253">0</span>&nbsp;<span class="op" id="5380255">||</span>&nbsp;<span class="ident" id="5380258">symNo</span>&nbsp;<span class="op" id="5380264">&gt;</span>&nbsp;<span class="ident" id="5380266">uint64</span><span class="op" id="5380272">(</span><span class="builtinfunc" id="5380273">len</span><span class="op" id="5380276">(</span><span class="ident" id="5380277">symbols</span><span class="op" id="5380284">)</span><span class="op" id="5380285">)</span>&nbsp;<span class="op" id="5380287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380292">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380307">sym</span>&nbsp;<span class="op" id="5380311">:=</span>&nbsp;<span class="op" id="5380314">&amp;</span><span class="ident" id="5380315">symbols</span><span class="op" id="5380322">[</span><span class="ident" id="5380323">symNo</span><span class="op" id="5380328">-</span><span class="num" id="5380329">1</span><span class="op" id="5380330">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380334">if</span>&nbsp;<span class="ident" id="5380337">SymType</span><span class="op" id="5380344">(</span><span class="ident" id="5380345">sym</span><span class="op" id="5380348">.</span><span class="ident" id="5380349">Info</span><span class="op" id="5380353">&amp;</span><span class="num" id="5380354">0xf</span><span class="op" id="5380357">)</span>&nbsp;<span class="op" id="5380359">!=</span>&nbsp;<span class="ident" id="5380362">STT_SECTION</span>&nbsp;<span class="op" id="5380374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5380379">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380434">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5380450">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5380503">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5380558">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380605">switch</span>&nbsp;<span class="ident" id="5380612">t</span>&nbsp;<span class="op" id="5380614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380618">case</span>&nbsp;<span class="ident" id="5380623">R_X86_64_64</span><span class="op" id="5380634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380639">if</span>&nbsp;<span class="ident" id="5380642">rela</span><span class="op" id="5380646">.</span><span class="ident" id="5380647">Off</span><span class="op" id="5380650">+</span><span class="num" id="5380651">8</span>&nbsp;<span class="op" id="5380653">&gt;=</span>&nbsp;<span class="ident" id="5380656">uint64</span><span class="op" id="5380662">(</span><span class="builtinfunc" id="5380663">len</span><span class="op" id="5380666">(</span><span class="ident" id="5380667">dst</span><span class="op" id="5380670">)</span><span class="op" id="5380671">)</span>&nbsp;<span class="op" id="5380673">||</span>&nbsp;<span class="ident" id="5380676">rela</span><span class="op" id="5380680">.</span><span class="ident" id="5380681">Addend</span>&nbsp;<span class="op" id="5380688">&lt;</span>&nbsp;<span class="num" id="5380690">0</span>&nbsp;<span class="op" id="5380692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380698">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380715">f</span><span class="op" id="5380716">.</span><span class="ident" id="5380717">ByteOrder</span><span class="op" id="5380726">.</span><span class="ident" id="5380727">PutUint64</span><span class="op" id="5380736">(</span><span class="ident" id="5380737">dst</span><span class="op" id="5380740">[</span><span class="ident" id="5380741">rela</span><span class="op" id="5380745">.</span><span class="ident" id="5380746">Off</span><span class="op" id="5380749">:</span><span class="ident" id="5380750">rela</span><span class="op" id="5380754">.</span><span class="ident" id="5380755">Off</span><span class="op" id="5380758">+</span><span class="num" id="5380759">8</span><span class="op" id="5380760">]</span><span class="op" id="5380761">,</span>&nbsp;<span class="ident" id="5380763">uint64</span><span class="op" id="5380769">(</span><span class="ident" id="5380770">rela</span><span class="op" id="5380774">.</span><span class="ident" id="5380775">Addend</span><span class="op" id="5380781">)</span><span class="op" id="5380782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380786">case</span>&nbsp;<span class="ident" id="5380791">R_X86_64_32</span><span class="op" id="5380802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380807">if</span>&nbsp;<span class="ident" id="5380810">rela</span><span class="op" id="5380814">.</span><span class="ident" id="5380815">Off</span><span class="op" id="5380818">+</span><span class="num" id="5380819">4</span>&nbsp;<span class="op" id="5380821">&gt;=</span>&nbsp;<span class="ident" id="5380824">uint64</span><span class="op" id="5380830">(</span><span class="builtinfunc" id="5380831">len</span><span class="op" id="5380834">(</span><span class="ident" id="5380835">dst</span><span class="op" id="5380838">)</span><span class="op" id="5380839">)</span>&nbsp;<span class="op" id="5380841">||</span>&nbsp;<span class="ident" id="5380844">rela</span><span class="op" id="5380848">.</span><span class="ident" id="5380849">Addend</span>&nbsp;<span class="op" id="5380856">&lt;</span>&nbsp;<span class="num" id="5380858">0</span>&nbsp;<span class="op" id="5380860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380866">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5380883">f</span><span class="op" id="5380884">.</span><span class="ident" id="5380885">ByteOrder</span><span class="op" id="5380894">.</span><span class="ident" id="5380895">PutUint32</span><span class="op" id="5380904">(</span><span class="ident" id="5380905">dst</span><span class="op" id="5380908">[</span><span class="ident" id="5380909">rela</span><span class="op" id="5380913">.</span><span class="ident" id="5380914">Off</span><span class="op" id="5380917">:</span><span class="ident" id="5380918">rela</span><span class="op" id="5380922">.</span><span class="ident" id="5380923">Off</span><span class="op" id="5380926">+</span><span class="num" id="5380927">4</span><span class="op" id="5380928">]</span><span class="op" id="5380929">,</span>&nbsp;<span class="builtintype" id="5380931">uint32</span><span class="op" id="5380937">(</span><span class="ident" id="5380938">rela</span><span class="op" id="5380942">.</span><span class="ident" id="5380943">Addend</span><span class="op" id="5380949">)</span><span class="op" id="5380950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5380957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5380961">return</span>&nbsp;<span class="ident" id="5380968">nil</span><br>
<span class="lineno"></span><span class="op" id="5380972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5380975">func</span>&nbsp;<span class="op" id="5380980">(</span><span class="ident" id="5380981">f</span>&nbsp;<span class="op" id="5380983">*</span><span class="ident" id="5380984">File</span><span class="op" id="5380988">)</span>&nbsp;<span class="ident" id="5380990">applyRelocations386</span><span class="op" id="5381009">(</span><span class="ident" id="5381010">dst</span>&nbsp;<span class="op" id="5381014">[</span><span class="op" id="5381015">]</span><span class="builtintype" id="5381016">byte</span><span class="op" id="5381020">,</span>&nbsp;<span class="ident" id="5381022">rels</span>&nbsp;<span class="op" id="5381027">[</span><span class="op" id="5381028">]</span><span class="builtintype" id="5381029">byte</span><span class="op" id="5381033">)</span>&nbsp;<span class="builtintype" id="5381035">error</span>&nbsp;<span class="op" id="5381041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5381044">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381072">if</span>&nbsp;<span class="builtinfunc" id="5381075">len</span><span class="op" id="5381078">(</span><span class="ident" id="5381079">rels</span><span class="op" id="5381083">)</span><span class="op" id="5381084">%</span><span class="num" id="5381085">8</span>&nbsp;<span class="op" id="5381087">!=</span>&nbsp;<span class="num" id="5381090">0</span>&nbsp;<span class="op" id="5381092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381096">return</span>&nbsp;<span class="ident" id="5381103">errors</span><span class="op" id="5381109">.</span><span class="ident" id="5381110">New</span><span class="op" id="5381113">(</span><span class="string" id="5381114">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5381167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381174">symbols</span><span class="op" id="5381181">,</span>&nbsp;<span class="ident" id="5381183">_</span><span class="op" id="5381184">,</span>&nbsp;<span class="ident" id="5381186">err</span>&nbsp;<span class="op" id="5381190">:=</span>&nbsp;<span class="ident" id="5381193">f</span><span class="op" id="5381194">.</span><span class="ident" id="5381195">getSymbols</span><span class="op" id="5381205">(</span><span class="ident" id="5381206">SHT_SYMTAB</span><span class="op" id="5381216">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381219">if</span>&nbsp;<span class="ident" id="5381222">err</span>&nbsp;<span class="op" id="5381226">!=</span>&nbsp;<span class="ident" id="5381229">nil</span>&nbsp;<span class="op" id="5381233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381237">return</span>&nbsp;<span class="ident" id="5381244">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381253">b</span>&nbsp;<span class="op" id="5381255">:=</span>&nbsp;<span class="ident" id="5381258">bytes</span><span class="op" id="5381263">.</span><span class="ident" id="5381264">NewReader</span><span class="op" id="5381273">(</span><span class="ident" id="5381274">rels</span><span class="op" id="5381278">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381281">var</span>&nbsp;<span class="ident" id="5381285">rel</span>&nbsp;<span class="ident" id="5381289">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381297">for</span>&nbsp;<span class="ident" id="5381301">b</span><span class="op" id="5381302">.</span><span class="ident" id="5381303">Len</span><span class="op" id="5381306">(</span><span class="op" id="5381307">)</span>&nbsp;<span class="op" id="5381309">&gt;</span>&nbsp;<span class="num" id="5381311">0</span>&nbsp;<span class="op" id="5381313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381317">binary</span><span class="op" id="5381323">.</span><span class="ident" id="5381324">Read</span><span class="op" id="5381328">(</span><span class="ident" id="5381329">b</span><span class="op" id="5381330">,</span>&nbsp;<span class="ident" id="5381332">f</span><span class="op" id="5381333">.</span><span class="ident" id="5381334">ByteOrder</span><span class="op" id="5381343">,</span>&nbsp;<span class="op" id="5381345">&amp;</span><span class="ident" id="5381346">rel</span><span class="op" id="5381349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381353">symNo</span>&nbsp;<span class="op" id="5381359">:=</span>&nbsp;<span class="ident" id="5381362">rel</span><span class="op" id="5381365">.</span><span class="ident" id="5381366">Info</span>&nbsp;<span class="op" id="5381371">&gt;&gt;</span>&nbsp;<span class="num" id="5381374">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381378">t</span>&nbsp;<span class="op" id="5381380">:=</span>&nbsp;<span class="ident" id="5381383">R_386</span><span class="op" id="5381388">(</span><span class="ident" id="5381389">rel</span><span class="op" id="5381392">.</span><span class="ident" id="5381393">Info</span>&nbsp;<span class="op" id="5381398">&amp;</span>&nbsp;<span class="num" id="5381400">0xff</span><span class="op" id="5381404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381409">if</span>&nbsp;<span class="ident" id="5381412">symNo</span>&nbsp;<span class="op" id="5381418">==</span>&nbsp;<span class="num" id="5381421">0</span>&nbsp;<span class="op" id="5381423">||</span>&nbsp;<span class="ident" id="5381426">symNo</span>&nbsp;<span class="op" id="5381432">&gt;</span>&nbsp;<span class="builtintype" id="5381434">uint32</span><span class="op" id="5381440">(</span><span class="builtinfunc" id="5381441">len</span><span class="op" id="5381444">(</span><span class="ident" id="5381445">symbols</span><span class="op" id="5381452">)</span><span class="op" id="5381453">)</span>&nbsp;<span class="op" id="5381455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381460">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381471">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381475">sym</span>&nbsp;<span class="op" id="5381479">:=</span>&nbsp;<span class="op" id="5381482">&amp;</span><span class="ident" id="5381483">symbols</span><span class="op" id="5381490">[</span><span class="ident" id="5381491">symNo</span><span class="op" id="5381496">-</span><span class="num" id="5381497">1</span><span class="op" id="5381498">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381503">if</span>&nbsp;<span class="ident" id="5381506">t</span>&nbsp;<span class="op" id="5381508">==</span>&nbsp;<span class="ident" id="5381511">R_386_32</span>&nbsp;<span class="op" id="5381520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381525">if</span>&nbsp;<span class="ident" id="5381528">rel</span><span class="op" id="5381531">.</span><span class="ident" id="5381532">Off</span><span class="op" id="5381535">+</span><span class="num" id="5381536">4</span>&nbsp;<span class="op" id="5381538">&gt;=</span>&nbsp;<span class="builtintype" id="5381541">uint32</span><span class="op" id="5381547">(</span><span class="builtinfunc" id="5381548">len</span><span class="op" id="5381551">(</span><span class="ident" id="5381552">dst</span><span class="op" id="5381555">)</span><span class="op" id="5381556">)</span>&nbsp;<span class="op" id="5381558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381564">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381581">val</span>&nbsp;<span class="op" id="5381585">:=</span>&nbsp;<span class="ident" id="5381588">f</span><span class="op" id="5381589">.</span><span class="ident" id="5381590">ByteOrder</span><span class="op" id="5381599">.</span><span class="ident" id="5381600">Uint32</span><span class="op" id="5381606">(</span><span class="ident" id="5381607">dst</span><span class="op" id="5381610">[</span><span class="ident" id="5381611">rel</span><span class="op" id="5381614">.</span><span class="ident" id="5381615">Off</span>&nbsp;<span class="op" id="5381619">:</span>&nbsp;<span class="ident" id="5381621">rel</span><span class="op" id="5381624">.</span><span class="ident" id="5381625">Off</span><span class="op" id="5381628">+</span><span class="num" id="5381629">4</span><span class="op" id="5381630">]</span><span class="op" id="5381631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381636">val</span>&nbsp;<span class="op" id="5381640">+=</span>&nbsp;<span class="builtintype" id="5381643">uint32</span><span class="op" id="5381649">(</span><span class="ident" id="5381650">sym</span><span class="op" id="5381653">.</span><span class="ident" id="5381654">Value</span><span class="op" id="5381659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381664">f</span><span class="op" id="5381665">.</span><span class="ident" id="5381666">ByteOrder</span><span class="op" id="5381675">.</span><span class="ident" id="5381676">PutUint32</span><span class="op" id="5381685">(</span><span class="ident" id="5381686">dst</span><span class="op" id="5381689">[</span><span class="ident" id="5381690">rel</span><span class="op" id="5381693">.</span><span class="ident" id="5381694">Off</span><span class="op" id="5381697">:</span><span class="ident" id="5381698">rel</span><span class="op" id="5381701">.</span><span class="ident" id="5381702">Off</span><span class="op" id="5381705">+</span><span class="num" id="5381706">4</span><span class="op" id="5381707">]</span><span class="op" id="5381708">,</span>&nbsp;<span class="ident" id="5381710">val</span><span class="op" id="5381713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381717">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381724">return</span>&nbsp;<span class="ident" id="5381731">nil</span><br>
<span class="lineno"></span><span class="op" id="5381735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5381738">func</span>&nbsp;<span class="op" id="5381743">(</span><span class="ident" id="5381744">f</span>&nbsp;<span class="op" id="5381746">*</span><span class="ident" id="5381747">File</span><span class="op" id="5381751">)</span>&nbsp;<span class="ident" id="5381753">applyRelocationsARM64</span><span class="op" id="5381774">(</span><span class="ident" id="5381775">dst</span>&nbsp;<span class="op" id="5381779">[</span><span class="op" id="5381780">]</span><span class="builtintype" id="5381781">byte</span><span class="op" id="5381785">,</span>&nbsp;<span class="ident" id="5381787">rels</span>&nbsp;<span class="op" id="5381792">[</span><span class="op" id="5381793">]</span><span class="builtintype" id="5381794">byte</span><span class="op" id="5381798">)</span>&nbsp;<span class="builtintype" id="5381800">error</span>&nbsp;<span class="op" id="5381806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5381809">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381839">if</span>&nbsp;<span class="builtinfunc" id="5381842">len</span><span class="op" id="5381845">(</span><span class="ident" id="5381846">rels</span><span class="op" id="5381850">)</span><span class="op" id="5381851">%</span><span class="num" id="5381852">24</span>&nbsp;<span class="op" id="5381855">!=</span>&nbsp;<span class="num" id="5381858">0</span>&nbsp;<span class="op" id="5381860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381864">return</span>&nbsp;<span class="ident" id="5381871">errors</span><span class="op" id="5381877">.</span><span class="ident" id="5381878">New</span><span class="op" id="5381881">(</span><span class="string" id="5381882">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5381936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5381939">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5381943">symbols</span><span class="op" id="5381950">,</span>&nbsp;<span class="ident" id="5381952">_</span><span class="op" id="5381953">,</span>&nbsp;<span class="ident" id="5381955">err</span>&nbsp;<span class="op" id="5381959">:=</span>&nbsp;<span class="ident" id="5381962">f</span><span class="op" id="5381963">.</span><span class="ident" id="5381964">getSymbols</span><span class="op" id="5381974">(</span><span class="ident" id="5381975">SHT_SYMTAB</span><span class="op" id="5381985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5381988">if</span>&nbsp;<span class="ident" id="5381991">err</span>&nbsp;<span class="op" id="5381995">!=</span>&nbsp;<span class="ident" id="5381998">nil</span>&nbsp;<span class="op" id="5382002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382006">return</span>&nbsp;<span class="ident" id="5382013">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382018">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382022">b</span>&nbsp;<span class="op" id="5382024">:=</span>&nbsp;<span class="ident" id="5382027">bytes</span><span class="op" id="5382032">.</span><span class="ident" id="5382033">NewReader</span><span class="op" id="5382042">(</span><span class="ident" id="5382043">rels</span><span class="op" id="5382047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382050">var</span>&nbsp;<span class="ident" id="5382054">rela</span>&nbsp;<span class="ident" id="5382059">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382068">for</span>&nbsp;<span class="ident" id="5382072">b</span><span class="op" id="5382073">.</span><span class="ident" id="5382074">Len</span><span class="op" id="5382077">(</span><span class="op" id="5382078">)</span>&nbsp;<span class="op" id="5382080">&gt;</span>&nbsp;<span class="num" id="5382082">0</span>&nbsp;<span class="op" id="5382084">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382088">binary</span><span class="op" id="5382094">.</span><span class="ident" id="5382095">Read</span><span class="op" id="5382099">(</span><span class="ident" id="5382100">b</span><span class="op" id="5382101">,</span>&nbsp;<span class="ident" id="5382103">f</span><span class="op" id="5382104">.</span><span class="ident" id="5382105">ByteOrder</span><span class="op" id="5382114">,</span>&nbsp;<span class="op" id="5382116">&amp;</span><span class="ident" id="5382117">rela</span><span class="op" id="5382121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382125">symNo</span>&nbsp;<span class="op" id="5382131">:=</span>&nbsp;<span class="ident" id="5382134">rela</span><span class="op" id="5382138">.</span><span class="ident" id="5382139">Info</span>&nbsp;<span class="op" id="5382144">&gt;&gt;</span>&nbsp;<span class="num" id="5382147">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382152">t</span>&nbsp;<span class="op" id="5382154">:=</span>&nbsp;<span class="ident" id="5382157">R_AARCH64</span><span class="op" id="5382166">(</span><span class="ident" id="5382167">rela</span><span class="op" id="5382171">.</span><span class="ident" id="5382172">Info</span>&nbsp;<span class="op" id="5382177">&amp;</span>&nbsp;<span class="num" id="5382179">0xffff</span><span class="op" id="5382185">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382190">if</span>&nbsp;<span class="ident" id="5382193">symNo</span>&nbsp;<span class="op" id="5382199">==</span>&nbsp;<span class="num" id="5382202">0</span>&nbsp;<span class="op" id="5382204">||</span>&nbsp;<span class="ident" id="5382207">symNo</span>&nbsp;<span class="op" id="5382213">&gt;</span>&nbsp;<span class="ident" id="5382215">uint64</span><span class="op" id="5382221">(</span><span class="builtinfunc" id="5382222">len</span><span class="op" id="5382225">(</span><span class="ident" id="5382226">symbols</span><span class="op" id="5382233">)</span><span class="op" id="5382234">)</span>&nbsp;<span class="op" id="5382236">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382241">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382256">sym</span>&nbsp;<span class="op" id="5382260">:=</span>&nbsp;<span class="op" id="5382263">&amp;</span><span class="ident" id="5382264">symbols</span><span class="op" id="5382271">[</span><span class="ident" id="5382272">symNo</span><span class="op" id="5382277">-</span><span class="num" id="5382278">1</span><span class="op" id="5382279">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382283">if</span>&nbsp;<span class="ident" id="5382286">SymType</span><span class="op" id="5382293">(</span><span class="ident" id="5382294">sym</span><span class="op" id="5382297">.</span><span class="ident" id="5382298">Info</span><span class="op" id="5382302">&amp;</span><span class="num" id="5382303">0xf</span><span class="op" id="5382306">)</span>&nbsp;<span class="op" id="5382308">!=</span>&nbsp;<span class="ident" id="5382311">STT_SECTION</span>&nbsp;<span class="op" id="5382323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5382328">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382383">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5382399">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5382452">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5382507">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382554">switch</span>&nbsp;<span class="ident" id="5382561">t</span>&nbsp;<span class="op" id="5382563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382567">case</span>&nbsp;<span class="ident" id="5382572">R_AARCH64_ABS64</span><span class="op" id="5382587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382592">if</span>&nbsp;<span class="ident" id="5382595">rela</span><span class="op" id="5382599">.</span><span class="ident" id="5382600">Off</span><span class="op" id="5382603">+</span><span class="num" id="5382604">8</span>&nbsp;<span class="op" id="5382606">&gt;=</span>&nbsp;<span class="ident" id="5382609">uint64</span><span class="op" id="5382615">(</span><span class="builtinfunc" id="5382616">len</span><span class="op" id="5382619">(</span><span class="ident" id="5382620">dst</span><span class="op" id="5382623">)</span><span class="op" id="5382624">)</span>&nbsp;<span class="op" id="5382626">||</span>&nbsp;<span class="ident" id="5382629">rela</span><span class="op" id="5382633">.</span><span class="ident" id="5382634">Addend</span>&nbsp;<span class="op" id="5382641">&lt;</span>&nbsp;<span class="num" id="5382643">0</span>&nbsp;<span class="op" id="5382645">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382651">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382668">f</span><span class="op" id="5382669">.</span><span class="ident" id="5382670">ByteOrder</span><span class="op" id="5382679">.</span><span class="ident" id="5382680">PutUint64</span><span class="op" id="5382689">(</span><span class="ident" id="5382690">dst</span><span class="op" id="5382693">[</span><span class="ident" id="5382694">rela</span><span class="op" id="5382698">.</span><span class="ident" id="5382699">Off</span><span class="op" id="5382702">:</span><span class="ident" id="5382703">rela</span><span class="op" id="5382707">.</span><span class="ident" id="5382708">Off</span><span class="op" id="5382711">+</span><span class="num" id="5382712">8</span><span class="op" id="5382713">]</span><span class="op" id="5382714">,</span>&nbsp;<span class="ident" id="5382716">uint64</span><span class="op" id="5382722">(</span><span class="ident" id="5382723">rela</span><span class="op" id="5382727">.</span><span class="ident" id="5382728">Addend</span><span class="op" id="5382734">)</span><span class="op" id="5382735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382739">case</span>&nbsp;<span class="ident" id="5382744">R_AARCH64_ABS32</span><span class="op" id="5382759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382764">if</span>&nbsp;<span class="ident" id="5382767">rela</span><span class="op" id="5382771">.</span><span class="ident" id="5382772">Off</span><span class="op" id="5382775">+</span><span class="num" id="5382776">4</span>&nbsp;<span class="op" id="5382778">&gt;=</span>&nbsp;<span class="ident" id="5382781">uint64</span><span class="op" id="5382787">(</span><span class="builtinfunc" id="5382788">len</span><span class="op" id="5382791">(</span><span class="ident" id="5382792">dst</span><span class="op" id="5382795">)</span><span class="op" id="5382796">)</span>&nbsp;<span class="op" id="5382798">||</span>&nbsp;<span class="ident" id="5382801">rela</span><span class="op" id="5382805">.</span><span class="ident" id="5382806">Addend</span>&nbsp;<span class="op" id="5382813">&lt;</span>&nbsp;<span class="num" id="5382815">0</span>&nbsp;<span class="op" id="5382817">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382823">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5382840">f</span><span class="op" id="5382841">.</span><span class="ident" id="5382842">ByteOrder</span><span class="op" id="5382851">.</span><span class="ident" id="5382852">PutUint32</span><span class="op" id="5382861">(</span><span class="ident" id="5382862">dst</span><span class="op" id="5382865">[</span><span class="ident" id="5382866">rela</span><span class="op" id="5382870">.</span><span class="ident" id="5382871">Off</span><span class="op" id="5382874">:</span><span class="ident" id="5382875">rela</span><span class="op" id="5382879">.</span><span class="ident" id="5382880">Off</span><span class="op" id="5382883">+</span><span class="num" id="5382884">4</span><span class="op" id="5382885">]</span><span class="op" id="5382886">,</span>&nbsp;<span class="builtintype" id="5382888">uint32</span><span class="op" id="5382894">(</span><span class="ident" id="5382895">rela</span><span class="op" id="5382899">.</span><span class="ident" id="5382900">Addend</span><span class="op" id="5382906">)</span><span class="op" id="5382907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5382914">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5382918">return</span>&nbsp;<span class="ident" id="5382925">nil</span><br>
<span class="lineno"></span><span class="op" id="5382929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5382932">func</span>&nbsp;<span class="op" id="5382937">(</span><span class="ident" id="5382938">f</span>&nbsp;<span class="op" id="5382940">*</span><span class="ident" id="5382941">File</span><span class="op" id="5382945">)</span>&nbsp;<span class="ident" id="5382947">DWARF</span><span class="op" id="5382952">(</span><span class="op" id="5382953">)</span>&nbsp;<span class="op" id="5382955">(</span><span class="op" id="5382956">*</span><span class="ident" id="5382957">dwarf</span><span class="op" id="5382962">.</span><span class="ident" id="5382963">Data</span><span class="op" id="5382967">,</span>&nbsp;<span class="builtintype" id="5382969">error</span><span class="op" id="5382974">)</span>&nbsp;<span class="op" id="5382976">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5382979">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5383030">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5383085">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383144">var</span>&nbsp;<span class="ident" id="5383148">names</span>&nbsp;<span class="op" id="5383154">=</span>&nbsp;<span class="op" id="5383156">[</span><span class="op" id="5383157">...</span><span class="op" id="5383160">]</span><span class="builtintype" id="5383161">string</span><span class="op" id="5383167">{</span><span class="string" id="5383168">&#34;abbrev&#34;</span><span class="op" id="5383176">,</span>&nbsp;<span class="string" id="5383178">&#34;info&#34;</span><span class="op" id="5383184">,</span>&nbsp;<span class="string" id="5383186">&#34;str&#34;</span><span class="op" id="5383191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383194">var</span>&nbsp;<span class="ident" id="5383198">dat</span>&nbsp;<span class="op" id="5383202">[</span><span class="builtinfunc" id="5383203">len</span><span class="op" id="5383206">(</span><span class="ident" id="5383207">names</span><span class="op" id="5383212">)</span><span class="op" id="5383213">]</span><span class="op" id="5383214">[</span><span class="op" id="5383215">]</span><span class="builtintype" id="5383216">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383222">for</span>&nbsp;<span class="ident" id="5383226">i</span><span class="op" id="5383227">,</span>&nbsp;<span class="ident" id="5383229">name</span>&nbsp;<span class="op" id="5383234">:=</span>&nbsp;<span class="keyword" id="5383237">range</span>&nbsp;<span class="ident" id="5383243">names</span>&nbsp;<span class="op" id="5383249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383253">name</span>&nbsp;<span class="op" id="5383258">=</span>&nbsp;<span class="string" id="5383260">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5383270">+</span>&nbsp;<span class="ident" id="5383272">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383279">s</span>&nbsp;<span class="op" id="5383281">:=</span>&nbsp;<span class="ident" id="5383284">f</span><span class="op" id="5383285">.</span><span class="ident" id="5383286">Section</span><span class="op" id="5383293">(</span><span class="ident" id="5383294">name</span><span class="op" id="5383298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383302">if</span>&nbsp;<span class="ident" id="5383305">s</span>&nbsp;<span class="op" id="5383307">==</span>&nbsp;<span class="ident" id="5383310">nil</span>&nbsp;<span class="op" id="5383314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383319">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383334">b</span><span class="op" id="5383335">,</span>&nbsp;<span class="ident" id="5383337">err</span>&nbsp;<span class="op" id="5383341">:=</span>&nbsp;<span class="ident" id="5383344">s</span><span class="op" id="5383345">.</span><span class="ident" id="5383346">Data</span><span class="op" id="5383350">(</span><span class="op" id="5383351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383355">if</span>&nbsp;<span class="ident" id="5383358">err</span>&nbsp;<span class="op" id="5383362">!=</span>&nbsp;<span class="ident" id="5383365">nil</span>&nbsp;<span class="op" id="5383369">&amp;&amp;</span>&nbsp;<span class="ident" id="5383372">uint64</span><span class="op" id="5383378">(</span><span class="builtinfunc" id="5383379">len</span><span class="op" id="5383382">(</span><span class="ident" id="5383383">b</span><span class="op" id="5383384">)</span><span class="op" id="5383385">)</span>&nbsp;<span class="op" id="5383387">&lt;</span>&nbsp;<span class="ident" id="5383389">s</span><span class="op" id="5383390">.</span><span class="ident" id="5383391">Size</span>&nbsp;<span class="op" id="5383396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383401">return</span>&nbsp;<span class="ident" id="5383408">nil</span><span class="op" id="5383411">,</span>&nbsp;<span class="ident" id="5383413">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383419">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383423">dat</span><span class="op" id="5383426">[</span><span class="ident" id="5383427">i</span><span class="op" id="5383428">]</span>&nbsp;<span class="op" id="5383430">=</span>&nbsp;<span class="ident" id="5383432">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5383439">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5383512">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383585">rela</span>&nbsp;<span class="op" id="5383590">:=</span>&nbsp;<span class="ident" id="5383593">f</span><span class="op" id="5383594">.</span><span class="ident" id="5383595">Section</span><span class="op" id="5383602">(</span><span class="string" id="5383603">&#34;.rela.debug_info&#34;</span><span class="op" id="5383621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383624">if</span>&nbsp;<span class="ident" id="5383627">rela</span>&nbsp;<span class="op" id="5383632">!=</span>&nbsp;<span class="ident" id="5383635">nil</span>&nbsp;<span class="op" id="5383639">&amp;&amp;</span>&nbsp;<span class="ident" id="5383642">rela</span><span class="op" id="5383646">.</span><span class="ident" id="5383647">Type</span>&nbsp;<span class="op" id="5383652">==</span>&nbsp;<span class="ident" id="5383655">SHT_RELA</span>&nbsp;<span class="op" id="5383664">&amp;&amp;</span>&nbsp;<span class="op" id="5383667">(</span><span class="ident" id="5383668">f</span><span class="op" id="5383669">.</span><span class="ident" id="5383670">Machine</span>&nbsp;<span class="op" id="5383678">==</span>&nbsp;<span class="ident" id="5383681">EM_X86_64</span>&nbsp;<span class="op" id="5383691">||</span>&nbsp;<span class="ident" id="5383694">f</span><span class="op" id="5383695">.</span><span class="ident" id="5383696">Machine</span>&nbsp;<span class="op" id="5383704">==</span>&nbsp;<span class="ident" id="5383707">EM_AARCH64</span><span class="op" id="5383717">)</span>&nbsp;<span class="op" id="5383719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383723">data</span><span class="op" id="5383727">,</span>&nbsp;<span class="ident" id="5383729">err</span>&nbsp;<span class="op" id="5383733">:=</span>&nbsp;<span class="ident" id="5383736">rela</span><span class="op" id="5383740">.</span><span class="ident" id="5383741">Data</span><span class="op" id="5383745">(</span><span class="op" id="5383746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383750">if</span>&nbsp;<span class="ident" id="5383753">err</span>&nbsp;<span class="op" id="5383757">!=</span>&nbsp;<span class="ident" id="5383760">nil</span>&nbsp;<span class="op" id="5383764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383769">return</span>&nbsp;<span class="ident" id="5383776">nil</span><span class="op" id="5383779">,</span>&nbsp;<span class="ident" id="5383781">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383791">err</span>&nbsp;<span class="op" id="5383795">=</span>&nbsp;<span class="ident" id="5383797">f</span><span class="op" id="5383798">.</span><span class="ident" id="5383799">applyRelocations</span><span class="op" id="5383815">(</span><span class="ident" id="5383816">dat</span><span class="op" id="5383819">[</span><span class="num" id="5383820">1</span><span class="op" id="5383821">]</span><span class="op" id="5383822">,</span>&nbsp;<span class="ident" id="5383824">data</span><span class="op" id="5383828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383832">if</span>&nbsp;<span class="ident" id="5383835">err</span>&nbsp;<span class="op" id="5383839">!=</span>&nbsp;<span class="ident" id="5383842">nil</span>&nbsp;<span class="op" id="5383846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383851">return</span>&nbsp;<span class="ident" id="5383858">nil</span><span class="op" id="5383861">,</span>&nbsp;<span class="ident" id="5383863">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383869">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5383872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5383876">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5383942">rel</span>&nbsp;<span class="op" id="5383946">:=</span>&nbsp;<span class="ident" id="5383949">f</span><span class="op" id="5383950">.</span><span class="ident" id="5383951">Section</span><span class="op" id="5383958">(</span><span class="string" id="5383959">&#34;.rel.debug_info&#34;</span><span class="op" id="5383976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5383979">if</span>&nbsp;<span class="ident" id="5383982">rel</span>&nbsp;<span class="op" id="5383986">!=</span>&nbsp;<span class="ident" id="5383989">nil</span>&nbsp;<span class="op" id="5383993">&amp;&amp;</span>&nbsp;<span class="ident" id="5383996">rel</span><span class="op" id="5383999">.</span><span class="ident" id="5384000">Type</span>&nbsp;<span class="op" id="5384005">==</span>&nbsp;<span class="ident" id="5384008">SHT_REL</span>&nbsp;<span class="op" id="5384016">&amp;&amp;</span>&nbsp;<span class="ident" id="5384019">f</span><span class="op" id="5384020">.</span><span class="ident" id="5384021">Machine</span>&nbsp;<span class="op" id="5384029">==</span>&nbsp;<span class="ident" id="5384032">EM_386</span>&nbsp;<span class="op" id="5384039">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384043">data</span><span class="op" id="5384047">,</span>&nbsp;<span class="ident" id="5384049">err</span>&nbsp;<span class="op" id="5384053">:=</span>&nbsp;<span class="ident" id="5384056">rel</span><span class="op" id="5384059">.</span><span class="ident" id="5384060">Data</span><span class="op" id="5384064">(</span><span class="op" id="5384065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384069">if</span>&nbsp;<span class="ident" id="5384072">err</span>&nbsp;<span class="op" id="5384076">!=</span>&nbsp;<span class="ident" id="5384079">nil</span>&nbsp;<span class="op" id="5384083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384088">return</span>&nbsp;<span class="ident" id="5384095">nil</span><span class="op" id="5384098">,</span>&nbsp;<span class="ident" id="5384100">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384110">err</span>&nbsp;<span class="op" id="5384114">=</span>&nbsp;<span class="ident" id="5384116">f</span><span class="op" id="5384117">.</span><span class="ident" id="5384118">applyRelocations</span><span class="op" id="5384134">(</span><span class="ident" id="5384135">dat</span><span class="op" id="5384138">[</span><span class="num" id="5384139">1</span><span class="op" id="5384140">]</span><span class="op" id="5384141">,</span>&nbsp;<span class="ident" id="5384143">data</span><span class="op" id="5384147">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384151">if</span>&nbsp;<span class="ident" id="5384154">err</span>&nbsp;<span class="op" id="5384158">!=</span>&nbsp;<span class="ident" id="5384161">nil</span>&nbsp;<span class="op" id="5384165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384170">return</span>&nbsp;<span class="ident" id="5384177">nil</span><span class="op" id="5384180">,</span>&nbsp;<span class="ident" id="5384182">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384195">abbrev</span><span class="op" id="5384201">,</span>&nbsp;<span class="ident" id="5384203">info</span><span class="op" id="5384207">,</span>&nbsp;<span class="ident" id="5384209">str</span>&nbsp;<span class="op" id="5384213">:=</span>&nbsp;<span class="ident" id="5384216">dat</span><span class="op" id="5384219">[</span><span class="num" id="5384220">0</span><span class="op" id="5384221">]</span><span class="op" id="5384222">,</span>&nbsp;<span class="ident" id="5384224">dat</span><span class="op" id="5384227">[</span><span class="num" id="5384228">1</span><span class="op" id="5384229">]</span><span class="op" id="5384230">,</span>&nbsp;<span class="ident" id="5384232">dat</span><span class="op" id="5384235">[</span><span class="num" id="5384236">2</span><span class="op" id="5384237">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384240">d</span><span class="op" id="5384241">,</span>&nbsp;<span class="ident" id="5384243">err</span>&nbsp;<span class="op" id="5384247">:=</span>&nbsp;<span class="ident" id="5384250">dwarf</span><span class="op" id="5384255">.</span><span class="ident" id="5384256">New</span><span class="op" id="5384259">(</span><span class="ident" id="5384260">abbrev</span><span class="op" id="5384266">,</span>&nbsp;<span class="ident" id="5384268">nil</span><span class="op" id="5384271">,</span>&nbsp;<span class="ident" id="5384273">nil</span><span class="op" id="5384276">,</span>&nbsp;<span class="ident" id="5384278">info</span><span class="op" id="5384282">,</span>&nbsp;<span class="ident" id="5384284">nil</span><span class="op" id="5384287">,</span>&nbsp;<span class="ident" id="5384289">nil</span><span class="op" id="5384292">,</span>&nbsp;<span class="ident" id="5384294">nil</span><span class="op" id="5384297">,</span>&nbsp;<span class="ident" id="5384299">str</span><span class="op" id="5384302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384305">if</span>&nbsp;<span class="ident" id="5384308">err</span>&nbsp;<span class="op" id="5384312">!=</span>&nbsp;<span class="ident" id="5384315">nil</span>&nbsp;<span class="op" id="5384319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384323">return</span>&nbsp;<span class="ident" id="5384330">nil</span><span class="op" id="5384333">,</span>&nbsp;<span class="ident" id="5384335">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384340">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5384344">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384387">for</span>&nbsp;<span class="ident" id="5384391">i</span><span class="op" id="5384392">,</span>&nbsp;<span class="ident" id="5384394">s</span>&nbsp;<span class="op" id="5384396">:=</span>&nbsp;<span class="keyword" id="5384399">range</span>&nbsp;<span class="ident" id="5384405">f</span><span class="op" id="5384406">.</span><span class="ident" id="5384407">Sections</span>&nbsp;<span class="op" id="5384416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384420">if</span>&nbsp;<span class="ident" id="5384423">s</span><span class="op" id="5384424">.</span><span class="ident" id="5384425">Name</span>&nbsp;<span class="op" id="5384430">==</span>&nbsp;<span class="string" id="5384433">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5384448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384453">b</span><span class="op" id="5384454">,</span>&nbsp;<span class="ident" id="5384456">err</span>&nbsp;<span class="op" id="5384460">:=</span>&nbsp;<span class="ident" id="5384463">s</span><span class="op" id="5384464">.</span><span class="ident" id="5384465">Data</span><span class="op" id="5384469">(</span><span class="op" id="5384470">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384475">if</span>&nbsp;<span class="ident" id="5384478">err</span>&nbsp;<span class="op" id="5384482">!=</span>&nbsp;<span class="ident" id="5384485">nil</span>&nbsp;<span class="op" id="5384489">&amp;&amp;</span>&nbsp;<span class="ident" id="5384492">uint64</span><span class="op" id="5384498">(</span><span class="builtinfunc" id="5384499">len</span><span class="op" id="5384502">(</span><span class="ident" id="5384503">b</span><span class="op" id="5384504">)</span><span class="op" id="5384505">)</span>&nbsp;<span class="op" id="5384507">&lt;</span>&nbsp;<span class="ident" id="5384509">s</span><span class="op" id="5384510">.</span><span class="ident" id="5384511">Size</span>&nbsp;<span class="op" id="5384516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384522">return</span>&nbsp;<span class="ident" id="5384529">nil</span><span class="op" id="5384532">,</span>&nbsp;<span class="ident" id="5384534">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384547">for</span>&nbsp;<span class="ident" id="5384551">_</span><span class="op" id="5384552">,</span>&nbsp;<span class="ident" id="5384554">r</span>&nbsp;<span class="op" id="5384556">:=</span>&nbsp;<span class="keyword" id="5384559">range</span>&nbsp;<span class="ident" id="5384565">f</span><span class="op" id="5384566">.</span><span class="ident" id="5384567">Sections</span>&nbsp;<span class="op" id="5384576">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384582">if</span>&nbsp;<span class="ident" id="5384585">r</span><span class="op" id="5384586">.</span><span class="ident" id="5384587">Type</span>&nbsp;<span class="op" id="5384592">!=</span>&nbsp;<span class="ident" id="5384595">SHT_RELA</span>&nbsp;<span class="op" id="5384604">&amp;&amp;</span>&nbsp;<span class="ident" id="5384607">r</span><span class="op" id="5384608">.</span><span class="ident" id="5384609">Type</span>&nbsp;<span class="op" id="5384614">!=</span>&nbsp;<span class="ident" id="5384617">SHT_REL</span>&nbsp;<span class="op" id="5384625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384632">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384651">if</span>&nbsp;<span class="builtintype" id="5384654">int</span><span class="op" id="5384657">(</span><span class="ident" id="5384658">r</span><span class="op" id="5384659">.</span><span class="ident" id="5384660">Info</span><span class="op" id="5384664">)</span>&nbsp;<span class="op" id="5384666">!=</span>&nbsp;<span class="ident" id="5384669">i</span>&nbsp;<span class="op" id="5384671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384678">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384697">rd</span><span class="op" id="5384699">,</span>&nbsp;<span class="ident" id="5384701">err</span>&nbsp;<span class="op" id="5384705">:=</span>&nbsp;<span class="ident" id="5384708">r</span><span class="op" id="5384709">.</span><span class="ident" id="5384710">Data</span><span class="op" id="5384714">(</span><span class="op" id="5384715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384721">if</span>&nbsp;<span class="ident" id="5384724">err</span>&nbsp;<span class="op" id="5384728">!=</span>&nbsp;<span class="ident" id="5384731">nil</span>&nbsp;<span class="op" id="5384735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384742">return</span>&nbsp;<span class="ident" id="5384749">nil</span><span class="op" id="5384752">,</span>&nbsp;<span class="ident" id="5384754">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384762">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384768">err</span>&nbsp;<span class="op" id="5384772">=</span>&nbsp;<span class="ident" id="5384774">f</span><span class="op" id="5384775">.</span><span class="ident" id="5384776">applyRelocations</span><span class="op" id="5384792">(</span><span class="ident" id="5384793">b</span><span class="op" id="5384794">,</span>&nbsp;<span class="ident" id="5384796">rd</span><span class="op" id="5384798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384804">if</span>&nbsp;<span class="ident" id="5384807">err</span>&nbsp;<span class="op" id="5384811">!=</span>&nbsp;<span class="ident" id="5384814">nil</span>&nbsp;<span class="op" id="5384818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384825">return</span>&nbsp;<span class="ident" id="5384832">nil</span><span class="op" id="5384835">,</span>&nbsp;<span class="ident" id="5384837">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384850">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5384856">err</span>&nbsp;<span class="op" id="5384860">=</span>&nbsp;<span class="ident" id="5384862">d</span><span class="op" id="5384863">.</span><span class="ident" id="5384864">AddTypes</span><span class="op" id="5384872">(</span><span class="ident" id="5384873">fmt</span><span class="op" id="5384876">.</span><span class="ident" id="5384877">Sprintf</span><span class="op" id="5384884">(</span><span class="string" id="5384885">&#34;types-%d&#34;</span><span class="op" id="5384895">,</span>&nbsp;<span class="ident" id="5384897">i</span><span class="op" id="5384898">)</span><span class="op" id="5384899">,</span>&nbsp;<span class="ident" id="5384901">b</span><span class="op" id="5384902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384907">if</span>&nbsp;<span class="ident" id="5384910">err</span>&nbsp;<span class="op" id="5384914">!=</span>&nbsp;<span class="ident" id="5384917">nil</span>&nbsp;<span class="op" id="5384921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384927">return</span>&nbsp;<span class="ident" id="5384934">nil</span><span class="op" id="5384937">,</span>&nbsp;<span class="ident" id="5384939">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384946">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5384953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5384957">return</span>&nbsp;<span class="ident" id="5384964">d</span><span class="op" id="5384965">,</span>&nbsp;<span class="ident" id="5384967">nil</span><br>
<span class="lineno"></span><span class="op" id="5384971">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5384974">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5385057">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5385078">//</span><br>
<span class="lineno"></span><span class="comment" id="5385081">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5385157">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5385231">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5385277">func</span>&nbsp;<span class="op" id="5385282">(</span><span class="ident" id="5385283">f</span>&nbsp;<span class="op" id="5385285">*</span><span class="ident" id="5385286">File</span><span class="op" id="5385290">)</span>&nbsp;<span class="ident" id="5385292">Symbols</span><span class="op" id="5385299">(</span><span class="op" id="5385300">)</span>&nbsp;<span class="op" id="5385302">(</span><span class="op" id="5385303">[</span><span class="op" id="5385304">]</span><span class="ident" id="5385305">Symbol</span><span class="op" id="5385311">,</span>&nbsp;<span class="builtintype" id="5385313">error</span><span class="op" id="5385318">)</span>&nbsp;<span class="op" id="5385320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385323">sym</span><span class="op" id="5385326">,</span>&nbsp;<span class="ident" id="5385328">_</span><span class="op" id="5385329">,</span>&nbsp;<span class="ident" id="5385331">err</span>&nbsp;<span class="op" id="5385335">:=</span>&nbsp;<span class="ident" id="5385338">f</span><span class="op" id="5385339">.</span><span class="ident" id="5385340">getSymbols</span><span class="op" id="5385350">(</span><span class="ident" id="5385351">SHT_SYMTAB</span><span class="op" id="5385361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5385364">return</span>&nbsp;<span class="ident" id="5385371">sym</span><span class="op" id="5385374">,</span>&nbsp;<span class="ident" id="5385376">err</span><br>
<span class="lineno">770</span><span class="op" id="5385380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385383">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5385453">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5385502">//</span><br>
<span class="lineno">775</span><span class="comment" id="5385505">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5385589">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5385663">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5385709">func</span>&nbsp;<span class="op" id="5385714">(</span><span class="ident" id="5385715">f</span>&nbsp;<span class="op" id="5385717">*</span><span class="ident" id="5385718">File</span><span class="op" id="5385722">)</span>&nbsp;<span class="ident" id="5385724">DynamicSymbols</span><span class="op" id="5385738">(</span><span class="op" id="5385739">)</span>&nbsp;<span class="op" id="5385741">(</span><span class="op" id="5385742">[</span><span class="op" id="5385743">]</span><span class="ident" id="5385744">Symbol</span><span class="op" id="5385750">,</span>&nbsp;<span class="builtintype" id="5385752">error</span><span class="op" id="5385757">)</span>&nbsp;<span class="op" id="5385759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385762">sym</span><span class="op" id="5385765">,</span>&nbsp;<span class="ident" id="5385767">_</span><span class="op" id="5385768">,</span>&nbsp;<span class="ident" id="5385770">err</span>&nbsp;<span class="op" id="5385774">:=</span>&nbsp;<span class="ident" id="5385777">f</span><span class="op" id="5385778">.</span><span class="ident" id="5385779">getSymbols</span><span class="op" id="5385789">(</span><span class="ident" id="5385790">SHT_DYNSYM</span><span class="op" id="5385800">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5385803">return</span>&nbsp;<span class="ident" id="5385810">sym</span><span class="op" id="5385813">,</span>&nbsp;<span class="ident" id="5385815">err</span><br>
<span class="lineno"></span><span class="op" id="5385819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5385822">type</span>&nbsp;<span class="ident" id="5385827">ImportedSymbol</span>&nbsp;<span class="keyword" id="5385842">struct</span>&nbsp;<span class="op" id="5385849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385852">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5385860">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385868">Version</span>&nbsp;<span class="builtintype" id="5385876">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385884">Library</span>&nbsp;<span class="builtintype" id="5385892">string</span><br>
<span class="lineno"></span><span class="op" id="5385899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385902">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5385954">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5386009">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5386063">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5386099">func</span>&nbsp;<span class="op" id="5386104">(</span><span class="ident" id="5386105">f</span>&nbsp;<span class="op" id="5386107">*</span><span class="ident" id="5386108">File</span><span class="op" id="5386112">)</span>&nbsp;<span class="ident" id="5386114">ImportedSymbols</span><span class="op" id="5386129">(</span><span class="op" id="5386130">)</span>&nbsp;<span class="op" id="5386132">(</span><span class="op" id="5386133">[</span><span class="op" id="5386134">]</span><span class="ident" id="5386135">ImportedSymbol</span><span class="op" id="5386149">,</span>&nbsp;<span class="builtintype" id="5386151">error</span><span class="op" id="5386156">)</span>&nbsp;<span class="op" id="5386158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386161">sym</span><span class="op" id="5386164">,</span>&nbsp;<span class="ident" id="5386166">str</span><span class="op" id="5386169">,</span>&nbsp;<span class="ident" id="5386171">err</span>&nbsp;<span class="op" id="5386175">:=</span>&nbsp;<span class="ident" id="5386178">f</span><span class="op" id="5386179">.</span><span class="ident" id="5386180">getSymbols</span><span class="op" id="5386190">(</span><span class="ident" id="5386191">SHT_DYNSYM</span><span class="op" id="5386201">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386204">if</span>&nbsp;<span class="ident" id="5386207">err</span>&nbsp;<span class="op" id="5386211">!=</span>&nbsp;<span class="ident" id="5386214">nil</span>&nbsp;<span class="op" id="5386218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386222">return</span>&nbsp;<span class="ident" id="5386229">nil</span><span class="op" id="5386232">,</span>&nbsp;<span class="ident" id="5386234">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386242">f</span><span class="op" id="5386243">.</span><span class="ident" id="5386244">gnuVersionInit</span><span class="op" id="5386258">(</span><span class="ident" id="5386259">str</span><span class="op" id="5386262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386265">var</span>&nbsp;<span class="ident" id="5386269">all</span>&nbsp;<span class="op" id="5386273">[</span><span class="op" id="5386274">]</span><span class="ident" id="5386275">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386291">for</span>&nbsp;<span class="ident" id="5386295">i</span><span class="op" id="5386296">,</span>&nbsp;<span class="ident" id="5386298">s</span>&nbsp;<span class="op" id="5386300">:=</span>&nbsp;<span class="keyword" id="5386303">range</span>&nbsp;<span class="ident" id="5386309">sym</span>&nbsp;<span class="op" id="5386313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386317">if</span>&nbsp;<span class="ident" id="5386320">ST_BIND</span><span class="op" id="5386327">(</span><span class="ident" id="5386328">s</span><span class="op" id="5386329">.</span><span class="ident" id="5386330">Info</span><span class="op" id="5386334">)</span>&nbsp;<span class="op" id="5386336">==</span>&nbsp;<span class="ident" id="5386339">STB_GLOBAL</span>&nbsp;<span class="op" id="5386350">&amp;&amp;</span>&nbsp;<span class="ident" id="5386353">s</span><span class="op" id="5386354">.</span><span class="ident" id="5386355">Section</span>&nbsp;<span class="op" id="5386363">==</span>&nbsp;<span class="ident" id="5386366">SHN_UNDEF</span>&nbsp;<span class="op" id="5386376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386381">all</span>&nbsp;<span class="op" id="5386385">=</span>&nbsp;<span class="builtinfunc" id="5386387">append</span><span class="op" id="5386393">(</span><span class="ident" id="5386394">all</span><span class="op" id="5386397">,</span>&nbsp;<span class="ident" id="5386399">ImportedSymbol</span><span class="op" id="5386413">{</span><span class="ident" id="5386414">Name</span><span class="op" id="5386418">:</span>&nbsp;<span class="ident" id="5386420">s</span><span class="op" id="5386421">.</span><span class="ident" id="5386422">Name</span><span class="op" id="5386426">}</span><span class="op" id="5386427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386432">f</span><span class="op" id="5386433">.</span><span class="ident" id="5386434">gnuVersion</span><span class="op" id="5386444">(</span><span class="ident" id="5386445">i</span><span class="op" id="5386446">,</span>&nbsp;<span class="op" id="5386448">&amp;</span><span class="ident" id="5386449">all</span><span class="op" id="5386452">[</span><span class="builtinfunc" id="5386453">len</span><span class="op" id="5386456">(</span><span class="ident" id="5386457">all</span><span class="op" id="5386460">)</span><span class="op" id="5386461">-</span><span class="num" id="5386462">1</span><span class="op" id="5386463">]</span><span class="op" id="5386464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386468">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386474">return</span>&nbsp;<span class="ident" id="5386481">all</span><span class="op" id="5386484">,</span>&nbsp;<span class="ident" id="5386486">nil</span><br>
<span class="lineno"></span><span class="op" id="5386490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5386493">type</span>&nbsp;<span class="ident" id="5386498">verneed</span>&nbsp;<span class="keyword" id="5386506">struct</span>&nbsp;<span class="op" id="5386513">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386516">File</span>&nbsp;<span class="builtintype" id="5386521">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386529">Name</span>&nbsp;<span class="builtintype" id="5386534">string</span><br>
<span class="lineno"></span><span class="op" id="5386541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5386544">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5386592">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5386627">func</span>&nbsp;<span class="op" id="5386632">(</span><span class="ident" id="5386633">f</span>&nbsp;<span class="op" id="5386635">*</span><span class="ident" id="5386636">File</span><span class="op" id="5386640">)</span>&nbsp;<span class="ident" id="5386642">gnuVersionInit</span><span class="op" id="5386656">(</span><span class="ident" id="5386657">str</span>&nbsp;<span class="op" id="5386661">[</span><span class="op" id="5386662">]</span><span class="builtintype" id="5386663">byte</span><span class="op" id="5386667">)</span>&nbsp;<span class="op" id="5386669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5386672">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386708">vn</span>&nbsp;<span class="op" id="5386711">:=</span>&nbsp;<span class="ident" id="5386714">f</span><span class="op" id="5386715">.</span><span class="ident" id="5386716">SectionByType</span><span class="op" id="5386729">(</span><span class="ident" id="5386730">SHT_GNU_VERNEED</span><span class="op" id="5386745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386748">if</span>&nbsp;<span class="ident" id="5386751">vn</span>&nbsp;<span class="op" id="5386754">==</span>&nbsp;<span class="ident" id="5386757">nil</span>&nbsp;<span class="op" id="5386761">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386765">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386776">d</span><span class="op" id="5386777">,</span>&nbsp;<span class="ident" id="5386779">_</span>&nbsp;<span class="op" id="5386781">:=</span>&nbsp;<span class="ident" id="5386784">vn</span><span class="op" id="5386786">.</span><span class="ident" id="5386787">Data</span><span class="op" id="5386791">(</span><span class="op" id="5386792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386796">var</span>&nbsp;<span class="ident" id="5386800">need</span>&nbsp;<span class="op" id="5386805">[</span><span class="op" id="5386806">]</span><span class="ident" id="5386807">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386816">i</span>&nbsp;<span class="op" id="5386818">:=</span>&nbsp;<span class="num" id="5386821">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386824">for</span>&nbsp;<span class="op" id="5386828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386832">if</span>&nbsp;<span class="ident" id="5386835">i</span><span class="op" id="5386836">+</span><span class="num" id="5386837">16</span>&nbsp;<span class="op" id="5386840">&gt;</span>&nbsp;<span class="builtinfunc" id="5386842">len</span><span class="op" id="5386845">(</span><span class="ident" id="5386846">d</span><span class="op" id="5386847">)</span>&nbsp;<span class="op" id="5386849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386854">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386862">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386866">vers</span>&nbsp;<span class="op" id="5386871">:=</span>&nbsp;<span class="ident" id="5386874">f</span><span class="op" id="5386875">.</span><span class="ident" id="5386876">ByteOrder</span><span class="op" id="5386885">.</span><span class="ident" id="5386886">Uint16</span><span class="op" id="5386892">(</span><span class="ident" id="5386893">d</span><span class="op" id="5386894">[</span><span class="ident" id="5386895">i</span>&nbsp;<span class="op" id="5386897">:</span>&nbsp;<span class="ident" id="5386899">i</span><span class="op" id="5386900">+</span><span class="num" id="5386901">2</span><span class="op" id="5386902">]</span><span class="op" id="5386903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386907">if</span>&nbsp;<span class="ident" id="5386910">vers</span>&nbsp;<span class="op" id="5386915">!=</span>&nbsp;<span class="num" id="5386918">1</span>&nbsp;<span class="op" id="5386920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386925">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386937">cnt</span>&nbsp;<span class="op" id="5386941">:=</span>&nbsp;<span class="ident" id="5386944">f</span><span class="op" id="5386945">.</span><span class="ident" id="5386946">ByteOrder</span><span class="op" id="5386955">.</span><span class="ident" id="5386956">Uint16</span><span class="op" id="5386962">(</span><span class="ident" id="5386963">d</span><span class="op" id="5386964">[</span><span class="ident" id="5386965">i</span><span class="op" id="5386966">+</span><span class="num" id="5386967">2</span>&nbsp;<span class="op" id="5386969">:</span>&nbsp;<span class="ident" id="5386971">i</span><span class="op" id="5386972">+</span><span class="num" id="5386973">4</span><span class="op" id="5386974">]</span><span class="op" id="5386975">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386979">fileoff</span>&nbsp;<span class="op" id="5386987">:=</span>&nbsp;<span class="ident" id="5386990">f</span><span class="op" id="5386991">.</span><span class="ident" id="5386992">ByteOrder</span><span class="op" id="5387001">.</span><span class="ident" id="5387002">Uint32</span><span class="op" id="5387008">(</span><span class="ident" id="5387009">d</span><span class="op" id="5387010">[</span><span class="ident" id="5387011">i</span><span class="op" id="5387012">+</span><span class="num" id="5387013">4</span>&nbsp;<span class="op" id="5387015">:</span>&nbsp;<span class="ident" id="5387017">i</span><span class="op" id="5387018">+</span><span class="num" id="5387019">8</span><span class="op" id="5387020">]</span><span class="op" id="5387021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387025">aux</span>&nbsp;<span class="op" id="5387029">:=</span>&nbsp;<span class="ident" id="5387032">f</span><span class="op" id="5387033">.</span><span class="ident" id="5387034">ByteOrder</span><span class="op" id="5387043">.</span><span class="ident" id="5387044">Uint32</span><span class="op" id="5387050">(</span><span class="ident" id="5387051">d</span><span class="op" id="5387052">[</span><span class="ident" id="5387053">i</span><span class="op" id="5387054">+</span><span class="num" id="5387055">8</span>&nbsp;<span class="op" id="5387057">:</span>&nbsp;<span class="ident" id="5387059">i</span><span class="op" id="5387060">+</span><span class="num" id="5387061">12</span><span class="op" id="5387063">]</span><span class="op" id="5387064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387068">next</span>&nbsp;<span class="op" id="5387073">:=</span>&nbsp;<span class="ident" id="5387076">f</span><span class="op" id="5387077">.</span><span class="ident" id="5387078">ByteOrder</span><span class="op" id="5387087">.</span><span class="ident" id="5387088">Uint32</span><span class="op" id="5387094">(</span><span class="ident" id="5387095">d</span><span class="op" id="5387096">[</span><span class="ident" id="5387097">i</span><span class="op" id="5387098">+</span><span class="num" id="5387099">12</span>&nbsp;<span class="op" id="5387102">:</span>&nbsp;<span class="ident" id="5387104">i</span><span class="op" id="5387105">+</span><span class="num" id="5387106">16</span><span class="op" id="5387108">]</span><span class="op" id="5387109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387113">file</span><span class="op" id="5387117">,</span>&nbsp;<span class="ident" id="5387119">_</span>&nbsp;<span class="op" id="5387121">:=</span>&nbsp;<span class="ident" id="5387124">getString</span><span class="op" id="5387133">(</span><span class="ident" id="5387134">str</span><span class="op" id="5387137">,</span>&nbsp;<span class="builtintype" id="5387139">int</span><span class="op" id="5387142">(</span><span class="ident" id="5387143">fileoff</span><span class="op" id="5387150">)</span><span class="op" id="5387151">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387156">var</span>&nbsp;<span class="ident" id="5387160">name</span>&nbsp;<span class="builtintype" id="5387165">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387174">j</span>&nbsp;<span class="op" id="5387176">:=</span>&nbsp;<span class="ident" id="5387179">i</span>&nbsp;<span class="op" id="5387181">+</span>&nbsp;<span class="builtintype" id="5387183">int</span><span class="op" id="5387186">(</span><span class="ident" id="5387187">aux</span><span class="op" id="5387190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387194">for</span>&nbsp;<span class="ident" id="5387198">c</span>&nbsp;<span class="op" id="5387200">:=</span>&nbsp;<span class="num" id="5387203">0</span><span class="op" id="5387204">;</span>&nbsp;<span class="ident" id="5387206">c</span>&nbsp;<span class="op" id="5387208">&lt;</span>&nbsp;<span class="builtintype" id="5387210">int</span><span class="op" id="5387213">(</span><span class="ident" id="5387214">cnt</span><span class="op" id="5387217">)</span><span class="op" id="5387218">;</span>&nbsp;<span class="ident" id="5387220">c</span><span class="op" id="5387221">++</span>&nbsp;<span class="op" id="5387224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387229">if</span>&nbsp;<span class="ident" id="5387232">j</span><span class="op" id="5387233">+</span><span class="num" id="5387234">16</span>&nbsp;<span class="op" id="5387237">&gt;</span>&nbsp;<span class="builtinfunc" id="5387239">len</span><span class="op" id="5387242">(</span><span class="ident" id="5387243">d</span><span class="op" id="5387244">)</span>&nbsp;<span class="op" id="5387246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387252">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5387266">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5387309">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387355">other</span>&nbsp;<span class="op" id="5387361">:=</span>&nbsp;<span class="ident" id="5387364">f</span><span class="op" id="5387365">.</span><span class="ident" id="5387366">ByteOrder</span><span class="op" id="5387375">.</span><span class="ident" id="5387376">Uint16</span><span class="op" id="5387382">(</span><span class="ident" id="5387383">d</span><span class="op" id="5387384">[</span><span class="ident" id="5387385">j</span><span class="op" id="5387386">+</span><span class="num" id="5387387">6</span>&nbsp;<span class="op" id="5387389">:</span>&nbsp;<span class="ident" id="5387391">j</span><span class="op" id="5387392">+</span><span class="num" id="5387393">8</span><span class="op" id="5387394">]</span><span class="op" id="5387395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387400">nameoff</span>&nbsp;<span class="op" id="5387408">:=</span>&nbsp;<span class="ident" id="5387411">f</span><span class="op" id="5387412">.</span><span class="ident" id="5387413">ByteOrder</span><span class="op" id="5387422">.</span><span class="ident" id="5387423">Uint32</span><span class="op" id="5387429">(</span><span class="ident" id="5387430">d</span><span class="op" id="5387431">[</span><span class="ident" id="5387432">j</span><span class="op" id="5387433">+</span><span class="num" id="5387434">8</span>&nbsp;<span class="op" id="5387436">:</span>&nbsp;<span class="ident" id="5387438">j</span><span class="op" id="5387439">+</span><span class="num" id="5387440">12</span><span class="op" id="5387442">]</span><span class="op" id="5387443">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387448">next</span>&nbsp;<span class="op" id="5387453">:=</span>&nbsp;<span class="ident" id="5387456">f</span><span class="op" id="5387457">.</span><span class="ident" id="5387458">ByteOrder</span><span class="op" id="5387467">.</span><span class="ident" id="5387468">Uint32</span><span class="op" id="5387474">(</span><span class="ident" id="5387475">d</span><span class="op" id="5387476">[</span><span class="ident" id="5387477">j</span><span class="op" id="5387478">+</span><span class="num" id="5387479">12</span>&nbsp;<span class="op" id="5387482">:</span>&nbsp;<span class="ident" id="5387484">j</span><span class="op" id="5387485">+</span><span class="num" id="5387486">16</span><span class="op" id="5387488">]</span><span class="op" id="5387489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387494">name</span><span class="op" id="5387498">,</span>&nbsp;<span class="ident" id="5387500">_</span>&nbsp;<span class="op" id="5387502">=</span>&nbsp;<span class="ident" id="5387504">getString</span><span class="op" id="5387513">(</span><span class="ident" id="5387514">str</span><span class="op" id="5387517">,</span>&nbsp;<span class="builtintype" id="5387519">int</span><span class="op" id="5387522">(</span><span class="ident" id="5387523">nameoff</span><span class="op" id="5387530">)</span><span class="op" id="5387531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387536">ndx</span>&nbsp;<span class="op" id="5387540">:=</span>&nbsp;<span class="builtintype" id="5387543">int</span><span class="op" id="5387546">(</span><span class="ident" id="5387547">other</span><span class="op" id="5387552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387557">if</span>&nbsp;<span class="ident" id="5387560">ndx</span>&nbsp;<span class="op" id="5387564">&gt;=</span>&nbsp;<span class="builtinfunc" id="5387567">len</span><span class="op" id="5387570">(</span><span class="ident" id="5387571">need</span><span class="op" id="5387575">)</span>&nbsp;<span class="op" id="5387577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387583">a</span>&nbsp;<span class="op" id="5387585">:=</span>&nbsp;<span class="builtinfunc" id="5387588">make</span><span class="op" id="5387592">(</span><span class="op" id="5387593">[</span><span class="op" id="5387594">]</span><span class="ident" id="5387595">verneed</span><span class="op" id="5387602">,</span>&nbsp;<span class="num" id="5387604">2</span><span class="op" id="5387605">*</span><span class="op" id="5387606">(</span><span class="ident" id="5387607">ndx</span><span class="op" id="5387610">+</span><span class="num" id="5387611">1</span><span class="op" id="5387612">)</span><span class="op" id="5387613">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5387619">copy</span><span class="op" id="5387623">(</span><span class="ident" id="5387624">a</span><span class="op" id="5387625">,</span>&nbsp;<span class="ident" id="5387627">need</span><span class="op" id="5387631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387637">need</span>&nbsp;<span class="op" id="5387642">=</span>&nbsp;<span class="ident" id="5387644">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387655">need</span><span class="op" id="5387659">[</span><span class="ident" id="5387660">ndx</span><span class="op" id="5387663">]</span>&nbsp;<span class="op" id="5387665">=</span>&nbsp;<span class="ident" id="5387667">verneed</span><span class="op" id="5387674">{</span><span class="ident" id="5387675">file</span><span class="op" id="5387679">,</span>&nbsp;<span class="ident" id="5387681">name</span><span class="op" id="5387685">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387690">if</span>&nbsp;<span class="ident" id="5387693">next</span>&nbsp;<span class="op" id="5387698">==</span>&nbsp;<span class="num" id="5387701">0</span>&nbsp;<span class="op" id="5387703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387709">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387723">j</span>&nbsp;<span class="op" id="5387725">+=</span>&nbsp;<span class="builtintype" id="5387728">int</span><span class="op" id="5387731">(</span><span class="ident" id="5387732">next</span><span class="op" id="5387736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387740">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387745">if</span>&nbsp;<span class="ident" id="5387748">next</span>&nbsp;<span class="op" id="5387753">==</span>&nbsp;<span class="num" id="5387756">0</span>&nbsp;<span class="op" id="5387758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387763">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387775">i</span>&nbsp;<span class="op" id="5387777">+=</span>&nbsp;<span class="builtintype" id="5387780">int</span><span class="op" id="5387783">(</span><span class="ident" id="5387784">next</span><span class="op" id="5387788">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5387795">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387853">vs</span>&nbsp;<span class="op" id="5387856">:=</span>&nbsp;<span class="ident" id="5387859">f</span><span class="op" id="5387860">.</span><span class="ident" id="5387861">SectionByType</span><span class="op" id="5387874">(</span><span class="ident" id="5387875">SHT_GNU_VERSYM</span><span class="op" id="5387889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387892">if</span>&nbsp;<span class="ident" id="5387895">vs</span>&nbsp;<span class="op" id="5387898">==</span>&nbsp;<span class="ident" id="5387901">nil</span>&nbsp;<span class="op" id="5387905">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387920">d</span><span class="op" id="5387921">,</span>&nbsp;<span class="ident" id="5387923">_</span>&nbsp;<span class="op" id="5387925">=</span>&nbsp;<span class="ident" id="5387927">vs</span><span class="op" id="5387929">.</span><span class="ident" id="5387930">Data</span><span class="op" id="5387934">(</span><span class="op" id="5387935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387939">f</span><span class="op" id="5387940">.</span><span class="ident" id="5387941">gnuNeed</span>&nbsp;<span class="op" id="5387949">=</span>&nbsp;<span class="ident" id="5387951">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387957">f</span><span class="op" id="5387958">.</span><span class="ident" id="5387959">gnuVersym</span>&nbsp;<span class="op" id="5387969">=</span>&nbsp;<span class="ident" id="5387971">d</span><br>
<span class="lineno"></span><span class="op" id="5387973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387976">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5388035">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5388084">func</span>&nbsp;<span class="op" id="5388089">(</span><span class="ident" id="5388090">f</span>&nbsp;<span class="op" id="5388092">*</span><span class="ident" id="5388093">File</span><span class="op" id="5388097">)</span>&nbsp;<span class="ident" id="5388099">gnuVersion</span><span class="op" id="5388109">(</span><span class="ident" id="5388110">i</span>&nbsp;<span class="builtintype" id="5388112">int</span><span class="op" id="5388115">,</span>&nbsp;<span class="ident" id="5388117">sym</span>&nbsp;<span class="op" id="5388121">*</span><span class="ident" id="5388122">ImportedSymbol</span><span class="op" id="5388136">)</span>&nbsp;<span class="op" id="5388138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388141">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388170">i</span>&nbsp;<span class="op" id="5388172">=</span>&nbsp;<span class="op" id="5388174">(</span><span class="ident" id="5388175">i</span>&nbsp;<span class="op" id="5388177">+</span>&nbsp;<span class="num" id="5388179">1</span><span class="op" id="5388180">)</span>&nbsp;<span class="op" id="5388182">*</span>&nbsp;<span class="num" id="5388184">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388187">if</span>&nbsp;<span class="ident" id="5388190">i</span>&nbsp;<span class="op" id="5388192">&gt;=</span>&nbsp;<span class="builtinfunc" id="5388195">len</span><span class="op" id="5388198">(</span><span class="ident" id="5388199">f</span><span class="op" id="5388200">.</span><span class="ident" id="5388201">gnuVersym</span><span class="op" id="5388210">)</span>&nbsp;<span class="op" id="5388212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388216">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5388224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388227">j</span>&nbsp;<span class="op" id="5388229">:=</span>&nbsp;<span class="builtintype" id="5388232">int</span><span class="op" id="5388235">(</span><span class="ident" id="5388236">f</span><span class="op" id="5388237">.</span><span class="ident" id="5388238">ByteOrder</span><span class="op" id="5388247">.</span><span class="ident" id="5388248">Uint16</span><span class="op" id="5388254">(</span><span class="ident" id="5388255">f</span><span class="op" id="5388256">.</span><span class="ident" id="5388257">gnuVersym</span><span class="op" id="5388266">[</span><span class="ident" id="5388267">i</span><span class="op" id="5388268">:</span><span class="op" id="5388269">]</span><span class="op" id="5388270">)</span><span class="op" id="5388271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388274">if</span>&nbsp;<span class="ident" id="5388277">j</span>&nbsp;<span class="op" id="5388279">&lt;</span>&nbsp;<span class="num" id="5388281">2</span>&nbsp;<span class="op" id="5388283">||</span>&nbsp;<span class="ident" id="5388286">j</span>&nbsp;<span class="op" id="5388288">&gt;=</span>&nbsp;<span class="builtinfunc" id="5388291">len</span><span class="op" id="5388294">(</span><span class="ident" id="5388295">f</span><span class="op" id="5388296">.</span><span class="ident" id="5388297">gnuNeed</span><span class="op" id="5388304">)</span>&nbsp;<span class="op" id="5388306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5388318">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388321">n</span>&nbsp;<span class="op" id="5388323">:=</span>&nbsp;<span class="op" id="5388326">&amp;</span><span class="ident" id="5388327">f</span><span class="op" id="5388328">.</span><span class="ident" id="5388329">gnuNeed</span><span class="op" id="5388336">[</span><span class="ident" id="5388337">j</span><span class="op" id="5388338">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388341">sym</span><span class="op" id="5388344">.</span><span class="ident" id="5388345">Library</span>&nbsp;<span class="op" id="5388353">=</span>&nbsp;<span class="ident" id="5388355">n</span><span class="op" id="5388356">.</span><span class="ident" id="5388357">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388363">sym</span><span class="op" id="5388366">.</span><span class="ident" id="5388367">Version</span>&nbsp;<span class="op" id="5388375">=</span>&nbsp;<span class="ident" id="5388377">n</span><span class="op" id="5388378">.</span><span class="ident" id="5388379">Name</span><br>
<span class="lineno"></span><span class="op" id="5388384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5388387">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5388443">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5388498">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5388546">func</span>&nbsp;<span class="op" id="5388551">(</span><span class="ident" id="5388552">f</span>&nbsp;<span class="op" id="5388554">*</span><span class="ident" id="5388555">File</span><span class="op" id="5388559">)</span>&nbsp;<span class="ident" id="5388561">ImportedLibraries</span><span class="op" id="5388578">(</span><span class="op" id="5388579">)</span>&nbsp;<span class="op" id="5388581">(</span><span class="op" id="5388582">[</span><span class="op" id="5388583">]</span><span class="builtintype" id="5388584">string</span><span class="op" id="5388590">,</span>&nbsp;<span class="builtintype" id="5388592">error</span><span class="op" id="5388597">)</span>&nbsp;<span class="op" id="5388599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388602">return</span>&nbsp;<span class="ident" id="5388609">f</span><span class="op" id="5388610">.</span><span class="ident" id="5388611">DynString</span><span class="op" id="5388620">(</span><span class="ident" id="5388621">DT_NEEDED</span><span class="op" id="5388630">)</span><br>
<span class="lineno">905</span><span class="op" id="5388632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5388635">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5388715">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5388727">//</span><br>
<span class="lineno">910</span><span class="comment" id="5388730">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5388814">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5388829">func</span>&nbsp;<span class="op" id="5388834">(</span><span class="ident" id="5388835">f</span>&nbsp;<span class="op" id="5388837">*</span><span class="ident" id="5388838">File</span><span class="op" id="5388842">)</span>&nbsp;<span class="ident" id="5388844">DynString</span><span class="op" id="5388853">(</span><span class="ident" id="5388854">tag</span>&nbsp;<span class="ident" id="5388858">DynTag</span><span class="op" id="5388864">)</span>&nbsp;<span class="op" id="5388866">(</span><span class="op" id="5388867">[</span><span class="op" id="5388868">]</span><span class="builtintype" id="5388869">string</span><span class="op" id="5388875">,</span>&nbsp;<span class="builtintype" id="5388877">error</span><span class="op" id="5388882">)</span>&nbsp;<span class="op" id="5388884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388887">switch</span>&nbsp;<span class="ident" id="5388894">tag</span>&nbsp;<span class="op" id="5388898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388901">case</span>&nbsp;<span class="ident" id="5388906">DT_NEEDED</span><span class="op" id="5388915">,</span>&nbsp;<span class="ident" id="5388917">DT_SONAME</span><span class="op" id="5388926">,</span>&nbsp;<span class="ident" id="5388928">DT_RPATH</span><span class="op" id="5388936">,</span>&nbsp;<span class="ident" id="5388938">DT_RUNPATH</span><span class="op" id="5388948">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388951">default</span><span class="op" id="5388958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388962">return</span>&nbsp;<span class="ident" id="5388969">nil</span><span class="op" id="5388972">,</span>&nbsp;<span class="ident" id="5388974">fmt</span><span class="op" id="5388977">.</span><span class="ident" id="5388978">Errorf</span><span class="op" id="5388984">(</span><span class="string" id="5388985">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5389011">,</span>&nbsp;<span class="ident" id="5389013">tag</span><span class="op" id="5389016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389022">ds</span>&nbsp;<span class="op" id="5389025">:=</span>&nbsp;<span class="ident" id="5389028">f</span><span class="op" id="5389029">.</span><span class="ident" id="5389030">SectionByType</span><span class="op" id="5389043">(</span><span class="ident" id="5389044">SHT_DYNAMIC</span><span class="op" id="5389055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389058">if</span>&nbsp;<span class="ident" id="5389061">ds</span>&nbsp;<span class="op" id="5389064">==</span>&nbsp;<span class="ident" id="5389067">nil</span>&nbsp;<span class="op" id="5389071">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389075">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389109">return</span>&nbsp;<span class="ident" id="5389116">nil</span><span class="op" id="5389119">,</span>&nbsp;<span class="ident" id="5389121">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389129">d</span><span class="op" id="5389130">,</span>&nbsp;<span class="ident" id="5389132">err</span>&nbsp;<span class="op" id="5389136">:=</span>&nbsp;<span class="ident" id="5389139">ds</span><span class="op" id="5389141">.</span><span class="ident" id="5389142">Data</span><span class="op" id="5389146">(</span><span class="op" id="5389147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389150">if</span>&nbsp;<span class="ident" id="5389153">err</span>&nbsp;<span class="op" id="5389157">!=</span>&nbsp;<span class="ident" id="5389160">nil</span>&nbsp;<span class="op" id="5389164">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389168">return</span>&nbsp;<span class="ident" id="5389175">nil</span><span class="op" id="5389178">,</span>&nbsp;<span class="ident" id="5389180">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389188">str</span><span class="op" id="5389191">,</span>&nbsp;<span class="ident" id="5389193">err</span>&nbsp;<span class="op" id="5389197">:=</span>&nbsp;<span class="ident" id="5389200">f</span><span class="op" id="5389201">.</span><span class="ident" id="5389202">stringTable</span><span class="op" id="5389213">(</span><span class="ident" id="5389214">ds</span><span class="op" id="5389216">.</span><span class="ident" id="5389217">Link</span><span class="op" id="5389221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389224">if</span>&nbsp;<span class="ident" id="5389227">err</span>&nbsp;<span class="op" id="5389231">!=</span>&nbsp;<span class="ident" id="5389234">nil</span>&nbsp;<span class="op" id="5389238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389242">return</span>&nbsp;<span class="ident" id="5389249">nil</span><span class="op" id="5389252">,</span>&nbsp;<span class="ident" id="5389254">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389262">var</span>&nbsp;<span class="ident" id="5389266">all</span>&nbsp;<span class="op" id="5389270">[</span><span class="op" id="5389271">]</span><span class="builtintype" id="5389272">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389280">for</span>&nbsp;<span class="builtinfunc" id="5389284">len</span><span class="op" id="5389287">(</span><span class="ident" id="5389288">d</span><span class="op" id="5389289">)</span>&nbsp;<span class="op" id="5389291">&gt;</span>&nbsp;<span class="num" id="5389293">0</span>&nbsp;<span class="op" id="5389295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389299">var</span>&nbsp;<span class="ident" id="5389303">t</span>&nbsp;<span class="ident" id="5389305">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389314">var</span>&nbsp;<span class="ident" id="5389318">v</span>&nbsp;<span class="ident" id="5389320">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389329">switch</span>&nbsp;<span class="ident" id="5389336">f</span><span class="op" id="5389337">.</span><span class="ident" id="5389338">Class</span>&nbsp;<span class="op" id="5389344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389348">case</span>&nbsp;<span class="ident" id="5389353">ELFCLASS32</span><span class="op" id="5389363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389368">t</span>&nbsp;<span class="op" id="5389370">=</span>&nbsp;<span class="ident" id="5389372">DynTag</span><span class="op" id="5389378">(</span><span class="ident" id="5389379">f</span><span class="op" id="5389380">.</span><span class="ident" id="5389381">ByteOrder</span><span class="op" id="5389390">.</span><span class="ident" id="5389391">Uint32</span><span class="op" id="5389397">(</span><span class="ident" id="5389398">d</span><span class="op" id="5389399">[</span><span class="num" id="5389400">0</span><span class="op" id="5389401">:</span><span class="num" id="5389402">4</span><span class="op" id="5389403">]</span><span class="op" id="5389404">)</span><span class="op" id="5389405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389410">v</span>&nbsp;<span class="op" id="5389412">=</span>&nbsp;<span class="ident" id="5389414">uint64</span><span class="op" id="5389420">(</span><span class="ident" id="5389421">f</span><span class="op" id="5389422">.</span><span class="ident" id="5389423">ByteOrder</span><span class="op" id="5389432">.</span><span class="ident" id="5389433">Uint32</span><span class="op" id="5389439">(</span><span class="ident" id="5389440">d</span><span class="op" id="5389441">[</span><span class="num" id="5389442">4</span><span class="op" id="5389443">:</span><span class="num" id="5389444">8</span><span class="op" id="5389445">]</span><span class="op" id="5389446">)</span><span class="op" id="5389447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389452">d</span>&nbsp;<span class="op" id="5389454">=</span>&nbsp;<span class="ident" id="5389456">d</span><span class="op" id="5389457">[</span><span class="num" id="5389458">8</span><span class="op" id="5389459">:</span><span class="op" id="5389460">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389464">case</span>&nbsp;<span class="ident" id="5389469">ELFCLASS64</span><span class="op" id="5389479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389484">t</span>&nbsp;<span class="op" id="5389486">=</span>&nbsp;<span class="ident" id="5389488">DynTag</span><span class="op" id="5389494">(</span><span class="ident" id="5389495">f</span><span class="op" id="5389496">.</span><span class="ident" id="5389497">ByteOrder</span><span class="op" id="5389506">.</span><span class="ident" id="5389507">Uint64</span><span class="op" id="5389513">(</span><span class="ident" id="5389514">d</span><span class="op" id="5389515">[</span><span class="num" id="5389516">0</span><span class="op" id="5389517">:</span><span class="num" id="5389518">8</span><span class="op" id="5389519">]</span><span class="op" id="5389520">)</span><span class="op" id="5389521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389526">v</span>&nbsp;<span class="op" id="5389528">=</span>&nbsp;<span class="ident" id="5389530">f</span><span class="op" id="5389531">.</span><span class="ident" id="5389532">ByteOrder</span><span class="op" id="5389541">.</span><span class="ident" id="5389542">Uint64</span><span class="op" id="5389548">(</span><span class="ident" id="5389549">d</span><span class="op" id="5389550">[</span><span class="num" id="5389551">8</span><span class="op" id="5389552">:</span><span class="num" id="5389553">16</span><span class="op" id="5389555">]</span><span class="op" id="5389556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389561">d</span>&nbsp;<span class="op" id="5389563">=</span>&nbsp;<span class="ident" id="5389565">d</span><span class="op" id="5389566">[</span><span class="num" id="5389567">16</span><span class="op" id="5389569">:</span><span class="op" id="5389570">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389574">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389578">if</span>&nbsp;<span class="ident" id="5389581">t</span>&nbsp;<span class="op" id="5389583">==</span>&nbsp;<span class="ident" id="5389586">tag</span>&nbsp;<span class="op" id="5389590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389595">s</span><span class="op" id="5389596">,</span>&nbsp;<span class="ident" id="5389598">ok</span>&nbsp;<span class="op" id="5389601">:=</span>&nbsp;<span class="ident" id="5389604">getString</span><span class="op" id="5389613">(</span><span class="ident" id="5389614">str</span><span class="op" id="5389617">,</span>&nbsp;<span class="builtintype" id="5389619">int</span><span class="op" id="5389622">(</span><span class="ident" id="5389623">v</span><span class="op" id="5389624">)</span><span class="op" id="5389625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389630">if</span>&nbsp;<span class="ident" id="5389633">ok</span>&nbsp;<span class="op" id="5389636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389642">all</span>&nbsp;<span class="op" id="5389646">=</span>&nbsp;<span class="builtinfunc" id="5389648">append</span><span class="op" id="5389654">(</span><span class="ident" id="5389655">all</span><span class="op" id="5389658">,</span>&nbsp;<span class="ident" id="5389660">s</span><span class="op" id="5389661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389666">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5389673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5389676">return</span>&nbsp;<span class="ident" id="5389683">all</span><span class="op" id="5389686">,</span>&nbsp;<span class="ident" id="5389688">nil</span><br>
<span class="lineno"></span><span class="op" id="5389692">}</span>
</div>
</body>
</html>
