<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1502614">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1502669">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1502723">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1502774">package</span>&nbsp;<span class="ident" id="1502782">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1502788">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1502844">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1502898">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1502955">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1503010">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1503040">//</span><br>
<span class="lineno"></span><span class="comment" id="1503043">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1503099">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1503168">//</span><br>
<span class="lineno"></span><span class="comment" id="1503171">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1503230">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1503286">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1503343">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1503360">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1503416">//</span><br>
<span class="lineno">25</span><span class="comment" id="1503419">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="1503454">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1503514">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1503570">//</span><br>
<span class="lineno"></span><span class="comment" id="1503573">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="1503584">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="1503626">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1503686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1503731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="1503780">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="1503801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="1503854">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="1503911">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="1503980">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="1504034">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="1504104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="1504169">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="1504201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="1504269">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="1504320">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="1504381">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="1504425">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="1504452">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="1504500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="1504522">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="1504575">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="1504637">//</span><br>
<span class="lineno"></span><span class="comment" id="1504640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="1504704">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1504774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="1504829">//</span><br>
<span class="lineno"></span><span class="comment" id="1504832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="1504899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="1504929">//</span><br>
<span class="lineno"></span><span class="comment" id="1504932">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="1504958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="1505030">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="1505055">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="1505118">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="1505161">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="1505214">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1505225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="1505286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="1505345">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1505359">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="1505398">//</span><br>
<span class="lineno"></span><span class="comment" id="1505401">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="1505453">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="1505499">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="1505515">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="1505564">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1505634">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1505688">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="1505732">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="1505798">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="1505863">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="1505906">//</span><br>
<span class="lineno"></span><span class="comment" id="1505909">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="1505931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1505984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="1506022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1506069">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="1506115">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="1506156">//</span><br>
<span class="lineno"></span><span class="comment" id="1506159">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="1506163">var</span>&nbsp;<span class="ident" id="1506167">_lgamA</span>&nbsp;<span class="op" id="1506174">=</span>&nbsp;<span class="op" id="1506176">[</span><span class="op" id="1506177">...</span><span class="op" id="1506180">]</span><span class="builtintype" id="1506181">float64</span><span class="op" id="1506188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506191">7.72156649015328655494e-02</span><span class="op" id="1506217">,</span>&nbsp;<span class="comment" id="1506219">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506242">3.22467033424113591611e-01</span><span class="op" id="1506268">,</span>&nbsp;<span class="comment" id="1506270">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506293">6.73523010531292681824e-02</span><span class="op" id="1506319">,</span>&nbsp;<span class="comment" id="1506321">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506344">2.05808084325167332806e-02</span><span class="op" id="1506370">,</span>&nbsp;<span class="comment" id="1506372">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506395">7.38555086081402883957e-03</span><span class="op" id="1506421">,</span>&nbsp;<span class="comment" id="1506423">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506446">2.89051383673415629091e-03</span><span class="op" id="1506472">,</span>&nbsp;<span class="comment" id="1506474">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506497">1.19270763183362067845e-03</span><span class="op" id="1506523">,</span>&nbsp;<span class="comment" id="1506525">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506548">5.10069792153511336608e-04</span><span class="op" id="1506574">,</span>&nbsp;<span class="comment" id="1506576">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506599">2.20862790713908385557e-04</span><span class="op" id="1506625">,</span>&nbsp;<span class="comment" id="1506627">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506650">1.08011567247583939954e-04</span><span class="op" id="1506676">,</span>&nbsp;<span class="comment" id="1506678">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506701">2.52144565451257326939e-05</span><span class="op" id="1506727">,</span>&nbsp;<span class="comment" id="1506729">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506752">4.48640949618915160150e-05</span><span class="op" id="1506778">,</span>&nbsp;<span class="comment" id="1506780">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="1506802">}</span><br>
<span class="lineno">105</span><span class="keyword" id="1506804">var</span>&nbsp;<span class="ident" id="1506808">_lgamR</span>&nbsp;<span class="op" id="1506815">=</span>&nbsp;<span class="op" id="1506817">[</span><span class="op" id="1506818">...</span><span class="op" id="1506821">]</span><span class="builtintype" id="1506822">float64</span><span class="op" id="1506829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506832">1.0</span><span class="op" id="1506835">,</span>&nbsp;<span class="comment" id="1506837">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506853">1.39200533467621045958e+00</span><span class="op" id="1506879">,</span>&nbsp;<span class="comment" id="1506881">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506904">7.21935547567138069525e-01</span><span class="op" id="1506930">,</span>&nbsp;<span class="comment" id="1506932">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1506955">1.71933865632803078993e-01</span><span class="op" id="1506981">,</span>&nbsp;<span class="comment" id="1506983">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507006">1.86459191715652901344e-02</span><span class="op" id="1507032">,</span>&nbsp;<span class="comment" id="1507034">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507057">7.77942496381893596434e-04</span><span class="op" id="1507083">,</span>&nbsp;<span class="comment" id="1507085">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507108">7.32668430744625636189e-06</span><span class="op" id="1507134">,</span>&nbsp;<span class="comment" id="1507136">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="1507158">}</span><br>
<span class="lineno"></span><span class="keyword" id="1507160">var</span>&nbsp;<span class="ident" id="1507164">_lgamS</span>&nbsp;<span class="op" id="1507171">=</span>&nbsp;<span class="op" id="1507173">[</span><span class="op" id="1507174">...</span><span class="op" id="1507177">]</span><span class="builtintype" id="1507178">float64</span><span class="op" id="1507185">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507188">-</span><span class="num" id="1507189">7.72156649015328655494e-02</span><span class="op" id="1507215">,</span>&nbsp;<span class="comment" id="1507217">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507240">2.14982415960608852501e-01</span><span class="op" id="1507266">,</span>&nbsp;&nbsp;<span class="comment" id="1507269">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507292">3.25778796408930981787e-01</span><span class="op" id="1507318">,</span>&nbsp;&nbsp;<span class="comment" id="1507321">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507344">1.46350472652464452805e-01</span><span class="op" id="1507370">,</span>&nbsp;&nbsp;<span class="comment" id="1507373">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507396">2.66422703033638609560e-02</span><span class="op" id="1507422">,</span>&nbsp;&nbsp;<span class="comment" id="1507425">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507448">1.84028451407337715652e-03</span><span class="op" id="1507474">,</span>&nbsp;&nbsp;<span class="comment" id="1507477">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507500">3.19475326584100867617e-05</span><span class="op" id="1507526">,</span>&nbsp;&nbsp;<span class="comment" id="1507529">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="1507551">}</span><br>
<span class="lineno"></span><span class="keyword" id="1507553">var</span>&nbsp;<span class="ident" id="1507557">_lgamT</span>&nbsp;<span class="op" id="1507564">=</span>&nbsp;<span class="op" id="1507566">[</span><span class="op" id="1507567">...</span><span class="op" id="1507570">]</span><span class="builtintype" id="1507571">float64</span><span class="op" id="1507578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507581">4.83836122723810047042e-01</span><span class="op" id="1507607">,</span>&nbsp;&nbsp;<span class="comment" id="1507610">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507633">-</span><span class="num" id="1507634">1.47587722994593911752e-01</span><span class="op" id="1507660">,</span>&nbsp;<span class="comment" id="1507662">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507685">6.46249402391333854778e-02</span><span class="op" id="1507711">,</span>&nbsp;&nbsp;<span class="comment" id="1507714">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507737">-</span><span class="num" id="1507738">3.27885410759859649565e-02</span><span class="op" id="1507764">,</span>&nbsp;<span class="comment" id="1507766">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507789">1.79706750811820387126e-02</span><span class="op" id="1507815">,</span>&nbsp;&nbsp;<span class="comment" id="1507818">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507841">-</span><span class="num" id="1507842">1.03142241298341437450e-02</span><span class="op" id="1507868">,</span>&nbsp;<span class="comment" id="1507870">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507893">6.10053870246291332635e-03</span><span class="op" id="1507919">,</span>&nbsp;&nbsp;<span class="comment" id="1507922">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1507945">-</span><span class="num" id="1507946">3.68452016781138256760e-03</span><span class="op" id="1507972">,</span>&nbsp;<span class="comment" id="1507974">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1507997">2.25964780900612472250e-03</span><span class="op" id="1508023">,</span>&nbsp;&nbsp;<span class="comment" id="1508026">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508049">-</span><span class="num" id="1508050">1.40346469989232843813e-03</span><span class="op" id="1508076">,</span>&nbsp;<span class="comment" id="1508078">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508101">8.81081882437654011382e-04</span><span class="op" id="1508127">,</span>&nbsp;&nbsp;<span class="comment" id="1508130">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508153">-</span><span class="num" id="1508154">5.38595305356740546715e-04</span><span class="op" id="1508180">,</span>&nbsp;<span class="comment" id="1508182">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508205">3.15632070903625950361e-04</span><span class="op" id="1508231">,</span>&nbsp;&nbsp;<span class="comment" id="1508234">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508257">-</span><span class="num" id="1508258">3.12754168375120860518e-04</span><span class="op" id="1508284">,</span>&nbsp;<span class="comment" id="1508286">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508309">3.35529192635519073543e-04</span><span class="op" id="1508335">,</span>&nbsp;&nbsp;<span class="comment" id="1508338">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="1508360">}</span><br>
<span class="lineno">140</span><span class="keyword" id="1508362">var</span>&nbsp;<span class="ident" id="1508366">_lgamU</span>&nbsp;<span class="op" id="1508373">=</span>&nbsp;<span class="op" id="1508375">[</span><span class="op" id="1508376">...</span><span class="op" id="1508379">]</span><span class="builtintype" id="1508380">float64</span><span class="op" id="1508387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1508390">-</span><span class="num" id="1508391">7.72156649015328655494e-02</span><span class="op" id="1508417">,</span>&nbsp;<span class="comment" id="1508419">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508442">6.32827064025093366517e-01</span><span class="op" id="1508468">,</span>&nbsp;&nbsp;<span class="comment" id="1508471">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508494">1.45492250137234768737e+00</span><span class="op" id="1508520">,</span>&nbsp;&nbsp;<span class="comment" id="1508523">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508546">9.77717527963372745603e-01</span><span class="op" id="1508572">,</span>&nbsp;&nbsp;<span class="comment" id="1508575">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508598">2.28963728064692451092e-01</span><span class="op" id="1508624">,</span>&nbsp;&nbsp;<span class="comment" id="1508627">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508650">1.33810918536787660377e-02</span><span class="op" id="1508676">,</span>&nbsp;&nbsp;<span class="comment" id="1508679">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="1508701">}</span><br>
<span class="lineno"></span><span class="keyword" id="1508703">var</span>&nbsp;<span class="ident" id="1508707">_lgamV</span>&nbsp;<span class="op" id="1508714">=</span>&nbsp;<span class="op" id="1508716">[</span><span class="op" id="1508717">...</span><span class="op" id="1508720">]</span><span class="builtintype" id="1508721">float64</span><span class="op" id="1508728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508731">1.0</span><span class="op" id="1508734">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508737">2.45597793713041134822e+00</span><span class="op" id="1508763">,</span>&nbsp;<span class="comment" id="1508765">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508788">2.12848976379893395361e+00</span><span class="op" id="1508814">,</span>&nbsp;<span class="comment" id="1508816">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508839">7.69285150456672783825e-01</span><span class="op" id="1508865">,</span>&nbsp;<span class="comment" id="1508867">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508890">1.04222645593369134254e-01</span><span class="op" id="1508916">,</span>&nbsp;<span class="comment" id="1508918">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1508941">3.21709242282423911810e-03</span><span class="op" id="1508967">,</span>&nbsp;<span class="comment" id="1508969">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="1508991">}</span><br>
<span class="lineno"></span><span class="keyword" id="1508993">var</span>&nbsp;<span class="ident" id="1508997">_lgamW</span>&nbsp;<span class="op" id="1509004">=</span>&nbsp;<span class="op" id="1509006">[</span><span class="op" id="1509007">...</span><span class="op" id="1509010">]</span><span class="builtintype" id="1509011">float64</span><span class="op" id="1509018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1509021">4.18938533204672725052e-01</span><span class="op" id="1509047">,</span>&nbsp;&nbsp;<span class="comment" id="1509050">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1509073">8.33333333333329678849e-02</span><span class="op" id="1509099">,</span>&nbsp;&nbsp;<span class="comment" id="1509102">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509125">-</span><span class="num" id="1509126">2.77777777728775536470e-03</span><span class="op" id="1509152">,</span>&nbsp;<span class="comment" id="1509154">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1509177">7.93650558643019558500e-04</span><span class="op" id="1509203">,</span>&nbsp;&nbsp;<span class="comment" id="1509206">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509229">-</span><span class="num" id="1509230">5.95187557450339963135e-04</span><span class="op" id="1509256">,</span>&nbsp;<span class="comment" id="1509258">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1509281">8.36339918996282139126e-04</span><span class="op" id="1509307">,</span>&nbsp;&nbsp;<span class="comment" id="1509310">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1509333">-</span><span class="num" id="1509334">1.63092934096575273989e-03</span><span class="op" id="1509360">,</span>&nbsp;<span class="comment" id="1509362">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="1509384">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="1509387">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1509460">//</span><br>
<span class="lineno"></span><span class="comment" id="1509463">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1509485">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="1509508">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1509528">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1509555">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1509578">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1509599">func</span>&nbsp;<span class="ident" id="1509604">Lgamma</span><span class="op" id="1509610">(</span><span class="ident" id="1509611">x</span>&nbsp;<span class="builtintype" id="1509613">float64</span><span class="op" id="1509620">)</span>&nbsp;<span class="op" id="1509622">(</span><span class="ident" id="1509623">lgamma</span>&nbsp;<span class="builtintype" id="1509630">float64</span><span class="op" id="1509637">,</span>&nbsp;<span class="ident" id="1509639">sign</span>&nbsp;<span class="builtintype" id="1509644">int</span><span class="op" id="1509647">)</span>&nbsp;<span class="op" id="1509649">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1509652">const</span>&nbsp;<span class="op" id="1509658">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509662">Ymin</span>&nbsp;&nbsp;<span class="op" id="1509668">=</span>&nbsp;<span class="num" id="1509670">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509693">Two52</span>&nbsp;<span class="op" id="1509699">=</span>&nbsp;<span class="num" id="1509701">1</span>&nbsp;<span class="op" id="1509703">&lt;&lt;</span>&nbsp;<span class="num" id="1509706">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1509729">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509765">Two53</span>&nbsp;<span class="op" id="1509771">=</span>&nbsp;<span class="num" id="1509773">1</span>&nbsp;<span class="op" id="1509775">&lt;&lt;</span>&nbsp;<span class="num" id="1509778">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1509801">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509837">Two58</span>&nbsp;<span class="op" id="1509843">=</span>&nbsp;<span class="num" id="1509845">1</span>&nbsp;<span class="op" id="1509847">&lt;&lt;</span>&nbsp;<span class="num" id="1509850">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1509873">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509909">Tiny</span>&nbsp;&nbsp;<span class="op" id="1509915">=</span>&nbsp;<span class="num" id="1509917">1.0</span>&nbsp;<span class="op" id="1509921">/</span>&nbsp;<span class="op" id="1509923">(</span><span class="num" id="1509924">1</span>&nbsp;<span class="op" id="1509926">&lt;&lt;</span>&nbsp;<span class="num" id="1509929">70</span><span class="op" id="1509931">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1509945">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1509982">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1509988">=</span>&nbsp;<span class="num" id="1509990">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="1510018">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510042">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1510048">=</span>&nbsp;<span class="op" id="1510050">-</span><span class="num" id="1510051">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="1510078">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1510102">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510126">Tt</span>&nbsp;<span class="op" id="1510129">=</span>&nbsp;<span class="op" id="1510131">-</span><span class="num" id="1510132">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="1510159">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1510185">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510203"><a href="/math/lgamma.go.html#1509639">sign</a></span>&nbsp;<span class="op" id="1510208">=</span>&nbsp;<span class="num" id="1510210">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510213">switch</span>&nbsp;<span class="op" id="1510220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510223">case</span>&nbsp;<span class="ident" id="1510228"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1510233">(</span><span class="ident" id="1510234"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510235">)</span><span class="op" id="1510236">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510240"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510247">=</span>&nbsp;<span class="ident" id="1510249"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510253">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510261">case</span>&nbsp;<span class="ident" id="1510266"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1510271">(</span><span class="ident" id="1510272"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510273">,</span>&nbsp;<span class="num" id="1510275">0</span><span class="op" id="1510276">)</span><span class="op" id="1510277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510281"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510288">=</span>&nbsp;<span class="ident" id="1510290"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510294">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510302">case</span>&nbsp;<span class="ident" id="1510307"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510309">==</span>&nbsp;<span class="num" id="1510312">0</span><span class="op" id="1510313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510317"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510324">=</span>&nbsp;<span class="ident" id="1510326"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1510329">(</span><span class="num" id="1510330">1</span><span class="op" id="1510331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510335">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510347">neg</span>&nbsp;<span class="op" id="1510351">:=</span>&nbsp;<span class="ident" id="1510354">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510361">if</span>&nbsp;<span class="ident" id="1510364"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510366">&lt;</span>&nbsp;<span class="num" id="1510368">0</span>&nbsp;<span class="op" id="1510370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510374"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510376">=</span>&nbsp;<span class="op" id="1510378">-</span><span class="ident" id="1510379"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510383"><a href="/math/lgamma.go.html#1510347">neg</a></span>&nbsp;<span class="op" id="1510387">=</span>&nbsp;<span class="ident" id="1510389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510395">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510399">if</span>&nbsp;<span class="ident" id="1510402"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510404">&lt;</span>&nbsp;<span class="ident" id="1510406"><a href="/math/lgamma.go.html#1509909">Tiny</a></span>&nbsp;<span class="op" id="1510411">{</span>&nbsp;<span class="comment" id="1510413">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510452">if</span>&nbsp;<span class="ident" id="1510455"><a href="/math/lgamma.go.html#1510347">neg</a></span>&nbsp;<span class="op" id="1510459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510464"><a href="/math/lgamma.go.html#1509639">sign</a></span>&nbsp;<span class="op" id="1510469">=</span>&nbsp;<span class="op" id="1510471">-</span><span class="num" id="1510472">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510476">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510480"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510487">=</span>&nbsp;<span class="op" id="1510489">-</span><span class="ident" id="1510490"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1510493">(</span><span class="ident" id="1510494"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510510">var</span>&nbsp;<span class="ident" id="1510514">nadj</span>&nbsp;<span class="builtintype" id="1510519">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510528">if</span>&nbsp;<span class="ident" id="1510531"><a href="/math/lgamma.go.html#1510347">neg</a></span>&nbsp;<span class="op" id="1510535">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510539">if</span>&nbsp;<span class="ident" id="1510542"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510544">&gt;=</span>&nbsp;<span class="ident" id="1510547"><a href="/math/lgamma.go.html#1509693">Two52</a></span>&nbsp;<span class="op" id="1510553">{</span>&nbsp;<span class="comment" id="1510555">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510592"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510599">=</span>&nbsp;<span class="ident" id="1510601"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1510604">(</span><span class="num" id="1510605">1</span><span class="op" id="1510606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510611">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510624">t</span>&nbsp;<span class="op" id="1510626">:=</span>&nbsp;<span class="ident" id="1510629"><a href="/math/lgamma.go.html#1513193">sinPi</a></span><span class="op" id="1510634">(</span><span class="ident" id="1510635"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510636">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510640">if</span>&nbsp;<span class="ident" id="1510643"><a href="/math/lgamma.go.html#1510624">t</a></span>&nbsp;<span class="op" id="1510645">==</span>&nbsp;<span class="num" id="1510648">0</span>&nbsp;<span class="op" id="1510650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510655"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510662">=</span>&nbsp;<span class="ident" id="1510664"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1510667">(</span><span class="num" id="1510668">1</span><span class="op" id="1510669">)</span>&nbsp;<span class="comment" id="1510671">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510686">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510699"><a href="/math/lgamma.go.html#1510514">nadj</a></span>&nbsp;<span class="op" id="1510704">=</span>&nbsp;<span class="ident" id="1510706"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1510709">(</span><span class="ident" id="1510710"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1510713">/</span>&nbsp;<span class="ident" id="1510715"><a href="/math/abs.go.html#1415452">Abs</a></span><span class="op" id="1510718">(</span><span class="ident" id="1510719"><a href="/math/lgamma.go.html#1510624">t</a></span><span class="op" id="1510720">*</span><span class="ident" id="1510721"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510722">)</span><span class="op" id="1510723">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510727">if</span>&nbsp;<span class="ident" id="1510730"><a href="/math/lgamma.go.html#1510624">t</a></span>&nbsp;<span class="op" id="1510732">&lt;</span>&nbsp;<span class="num" id="1510734">0</span>&nbsp;<span class="op" id="1510736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510741"><a href="/math/lgamma.go.html#1509639">sign</a></span>&nbsp;<span class="op" id="1510746">=</span>&nbsp;<span class="op" id="1510748">-</span><span class="num" id="1510749">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1510756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510760">switch</span>&nbsp;<span class="op" id="1510767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510770">case</span>&nbsp;<span class="ident" id="1510775"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510777">==</span>&nbsp;<span class="num" id="1510780">1</span>&nbsp;<span class="op" id="1510782">||</span>&nbsp;<span class="ident" id="1510785"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510787">==</span>&nbsp;<span class="num" id="1510790">2</span><span class="op" id="1510791">:</span>&nbsp;<span class="comment" id="1510793">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510816"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510823">=</span>&nbsp;<span class="num" id="1510825">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510837">case</span>&nbsp;<span class="ident" id="1510842"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510844">&lt;</span>&nbsp;<span class="num" id="1510846">2</span><span class="op" id="1510847">:</span>&nbsp;<span class="comment" id="1510849">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510891">var</span>&nbsp;<span class="ident" id="1510895">y</span>&nbsp;<span class="builtintype" id="1510897">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510907">var</span>&nbsp;<span class="ident" id="1510911">i</span>&nbsp;<span class="builtintype" id="1510913">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510919">if</span>&nbsp;<span class="ident" id="1510922"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510924">&lt;=</span>&nbsp;<span class="num" id="1510927">0.9</span>&nbsp;<span class="op" id="1510931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1510936"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1510943">=</span>&nbsp;<span class="op" id="1510945">-</span><span class="ident" id="1510946"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1510949">(</span><span class="ident" id="1510950"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1510951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510956">switch</span>&nbsp;<span class="op" id="1510963">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1510968">case</span>&nbsp;<span class="ident" id="1510973"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1510975">&gt;=</span>&nbsp;<span class="op" id="1510978">(</span><span class="ident" id="1510979"><a href="/math/lgamma.go.html#1509662">Ymin</a></span>&nbsp;<span class="op" id="1510984">-</span>&nbsp;<span class="num" id="1510986">1</span>&nbsp;<span class="op" id="1510988">+</span>&nbsp;<span class="num" id="1510990">0.27</span><span class="op" id="1510994">)</span><span class="op" id="1510995">:</span>&nbsp;<span class="comment" id="1510997">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511024"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511026">=</span>&nbsp;<span class="num" id="1511028">1</span>&nbsp;<span class="op" id="1511030">-</span>&nbsp;<span class="ident" id="1511032"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511038"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511040">=</span>&nbsp;<span class="num" id="1511042">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511047">case</span>&nbsp;<span class="ident" id="1511052"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511054">&gt;=</span>&nbsp;<span class="op" id="1511057">(</span><span class="ident" id="1511058"><a href="/math/lgamma.go.html#1509662">Ymin</a></span>&nbsp;<span class="op" id="1511063">-</span>&nbsp;<span class="num" id="1511065">1</span>&nbsp;<span class="op" id="1511067">-</span>&nbsp;<span class="num" id="1511069">0.27</span><span class="op" id="1511073">)</span><span class="op" id="1511074">:</span>&nbsp;<span class="comment" id="1511076">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511104"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511106">=</span>&nbsp;<span class="ident" id="1511108"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511110">-</span>&nbsp;<span class="op" id="1511112">(</span><span class="ident" id="1511113"><a href="/math/lgamma.go.html#1509982">Tc</a></span>&nbsp;<span class="op" id="1511116">-</span>&nbsp;<span class="num" id="1511118">1</span><span class="op" id="1511119">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511125"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511127">=</span>&nbsp;<span class="num" id="1511129">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511134">default</span><span class="op" id="1511141">:</span>&nbsp;<span class="comment" id="1511143">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511165"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511167">=</span>&nbsp;<span class="ident" id="1511169"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511175"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511177">=</span>&nbsp;<span class="num" id="1511179">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511184">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511188">}</span>&nbsp;<span class="keyword" id="1511190">else</span>&nbsp;<span class="op" id="1511195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511200"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1511207">=</span>&nbsp;<span class="num" id="1511209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511214">switch</span>&nbsp;<span class="op" id="1511221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511226">case</span>&nbsp;<span class="ident" id="1511231"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511233">&gt;=</span>&nbsp;<span class="op" id="1511236">(</span><span class="ident" id="1511237"><a href="/math/lgamma.go.html#1509662">Ymin</a></span>&nbsp;<span class="op" id="1511242">+</span>&nbsp;<span class="num" id="1511244">0.27</span><span class="op" id="1511248">)</span><span class="op" id="1511249">:</span>&nbsp;<span class="comment" id="1511251">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511274"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511276">=</span>&nbsp;<span class="num" id="1511278">2</span>&nbsp;<span class="op" id="1511280">-</span>&nbsp;<span class="ident" id="1511282"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511288"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511290">=</span>&nbsp;<span class="num" id="1511292">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511297">case</span>&nbsp;<span class="ident" id="1511302"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511304">&gt;=</span>&nbsp;<span class="op" id="1511307">(</span><span class="ident" id="1511308"><a href="/math/lgamma.go.html#1509662">Ymin</a></span>&nbsp;<span class="op" id="1511313">-</span>&nbsp;<span class="num" id="1511315">0.27</span><span class="op" id="1511319">)</span><span class="op" id="1511320">:</span>&nbsp;<span class="comment" id="1511322">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511350"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511352">=</span>&nbsp;<span class="ident" id="1511354"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511356">-</span>&nbsp;<span class="ident" id="1511358"><a href="/math/lgamma.go.html#1509982">Tc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511365"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511367">=</span>&nbsp;<span class="num" id="1511369">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511374">default</span><span class="op" id="1511381">:</span>&nbsp;<span class="comment" id="1511383">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511407"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511409">=</span>&nbsp;<span class="ident" id="1511411"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1511413">-</span>&nbsp;<span class="num" id="1511415">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511421"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511423">=</span>&nbsp;<span class="num" id="1511425">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1511434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511438">switch</span>&nbsp;<span class="ident" id="1511445"><a href="/math/lgamma.go.html#1510911">i</a></span>&nbsp;<span class="op" id="1511447">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511451">case</span>&nbsp;<span class="num" id="1511456">0</span><span class="op" id="1511457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511462">z</span>&nbsp;<span class="op" id="1511464">:=</span>&nbsp;<span class="ident" id="1511467"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511469">*</span>&nbsp;<span class="ident" id="1511471"><a href="/math/lgamma.go.html#1510895">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511476">p1</span>&nbsp;<span class="op" id="1511479">:=</span>&nbsp;<span class="ident" id="1511482"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511488">[</span><span class="num" id="1511489">0</span><span class="op" id="1511490">]</span>&nbsp;<span class="op" id="1511492">+</span>&nbsp;<span class="ident" id="1511494"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511495">*</span><span class="op" id="1511496">(</span><span class="ident" id="1511497"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511503">[</span><span class="num" id="1511504">2</span><span class="op" id="1511505">]</span><span class="op" id="1511506">+</span><span class="ident" id="1511507"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511508">*</span><span class="op" id="1511509">(</span><span class="ident" id="1511510"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511516">[</span><span class="num" id="1511517">4</span><span class="op" id="1511518">]</span><span class="op" id="1511519">+</span><span class="ident" id="1511520"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511521">*</span><span class="op" id="1511522">(</span><span class="ident" id="1511523"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511529">[</span><span class="num" id="1511530">6</span><span class="op" id="1511531">]</span><span class="op" id="1511532">+</span><span class="ident" id="1511533"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511534">*</span><span class="op" id="1511535">(</span><span class="ident" id="1511536"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511542">[</span><span class="num" id="1511543">8</span><span class="op" id="1511544">]</span><span class="op" id="1511545">+</span><span class="ident" id="1511546"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511547">*</span><span class="ident" id="1511548"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511554">[</span><span class="num" id="1511555">10</span><span class="op" id="1511557">]</span><span class="op" id="1511558">)</span><span class="op" id="1511559">)</span><span class="op" id="1511560">)</span><span class="op" id="1511561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511566">p2</span>&nbsp;<span class="op" id="1511569">:=</span>&nbsp;<span class="ident" id="1511572"><a href="/math/lgamma.go.html#1511462">z</a></span>&nbsp;<span class="op" id="1511574">*</span>&nbsp;<span class="op" id="1511576">(</span><span class="ident" id="1511577"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511583">[</span><span class="num" id="1511584">1</span><span class="op" id="1511585">]</span>&nbsp;<span class="op" id="1511587">+</span>&nbsp;<span class="ident" id="1511589"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511590">*</span><span class="op" id="1511591">(</span><span class="op" id="1511592">+</span><span class="ident" id="1511593"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511599">[</span><span class="num" id="1511600">3</span><span class="op" id="1511601">]</span><span class="op" id="1511602">+</span><span class="ident" id="1511603"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511604">*</span><span class="op" id="1511605">(</span><span class="ident" id="1511606"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511612">[</span><span class="num" id="1511613">5</span><span class="op" id="1511614">]</span><span class="op" id="1511615">+</span><span class="ident" id="1511616"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511617">*</span><span class="op" id="1511618">(</span><span class="ident" id="1511619"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511625">[</span><span class="num" id="1511626">7</span><span class="op" id="1511627">]</span><span class="op" id="1511628">+</span><span class="ident" id="1511629"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511630">*</span><span class="op" id="1511631">(</span><span class="ident" id="1511632"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511638">[</span><span class="num" id="1511639">9</span><span class="op" id="1511640">]</span><span class="op" id="1511641">+</span><span class="ident" id="1511642"><a href="/math/lgamma.go.html#1511462">z</a></span><span class="op" id="1511643">*</span><span class="ident" id="1511644"><a href="/math/lgamma.go.html#1506167">_lgamA</a></span><span class="op" id="1511650">[</span><span class="num" id="1511651">11</span><span class="op" id="1511653">]</span><span class="op" id="1511654">)</span><span class="op" id="1511655">)</span><span class="op" id="1511656">)</span><span class="op" id="1511657">)</span><span class="op" id="1511658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511663">p</span>&nbsp;<span class="op" id="1511665">:=</span>&nbsp;<span class="ident" id="1511668"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1511669">*</span><span class="ident" id="1511670"><a href="/math/lgamma.go.html#1511476">p1</a></span>&nbsp;<span class="op" id="1511673">+</span>&nbsp;<span class="ident" id="1511675"><a href="/math/lgamma.go.html#1511566">p2</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511681"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1511688">+=</span>&nbsp;<span class="op" id="1511691">(</span><span class="ident" id="1511692"><a href="/math/lgamma.go.html#1511663">p</a></span>&nbsp;<span class="op" id="1511694">-</span>&nbsp;<span class="num" id="1511696">0.5</span><span class="op" id="1511699">*</span><span class="ident" id="1511700"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1511701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1511705">case</span>&nbsp;<span class="num" id="1511710">1</span><span class="op" id="1511711">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511716">z</span>&nbsp;<span class="op" id="1511718">:=</span>&nbsp;<span class="ident" id="1511721"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1511723">*</span>&nbsp;<span class="ident" id="1511725"><a href="/math/lgamma.go.html#1510895">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511730">w</span>&nbsp;<span class="op" id="1511732">:=</span>&nbsp;<span class="ident" id="1511735"><a href="/math/lgamma.go.html#1511716">z</a></span>&nbsp;<span class="op" id="1511737">*</span>&nbsp;<span class="ident" id="1511739"><a href="/math/lgamma.go.html#1510895">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511744">p1</span>&nbsp;<span class="op" id="1511747">:=</span>&nbsp;<span class="ident" id="1511750"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511756">[</span><span class="num" id="1511757">0</span><span class="op" id="1511758">]</span>&nbsp;<span class="op" id="1511760">+</span>&nbsp;<span class="ident" id="1511762"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511763">*</span><span class="op" id="1511764">(</span><span class="ident" id="1511765"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511771">[</span><span class="num" id="1511772">3</span><span class="op" id="1511773">]</span><span class="op" id="1511774">+</span><span class="ident" id="1511775"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511776">*</span><span class="op" id="1511777">(</span><span class="ident" id="1511778"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511784">[</span><span class="num" id="1511785">6</span><span class="op" id="1511786">]</span><span class="op" id="1511787">+</span><span class="ident" id="1511788"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511789">*</span><span class="op" id="1511790">(</span><span class="ident" id="1511791"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511797">[</span><span class="num" id="1511798">9</span><span class="op" id="1511799">]</span><span class="op" id="1511800">+</span><span class="ident" id="1511801"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511802">*</span><span class="ident" id="1511803"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511809">[</span><span class="num" id="1511810">12</span><span class="op" id="1511812">]</span><span class="op" id="1511813">)</span><span class="op" id="1511814">)</span><span class="op" id="1511815">)</span>&nbsp;<span class="comment" id="1511817">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511837">p2</span>&nbsp;<span class="op" id="1511840">:=</span>&nbsp;<span class="ident" id="1511843"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511849">[</span><span class="num" id="1511850">1</span><span class="op" id="1511851">]</span>&nbsp;<span class="op" id="1511853">+</span>&nbsp;<span class="ident" id="1511855"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511856">*</span><span class="op" id="1511857">(</span><span class="ident" id="1511858"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511864">[</span><span class="num" id="1511865">4</span><span class="op" id="1511866">]</span><span class="op" id="1511867">+</span><span class="ident" id="1511868"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511869">*</span><span class="op" id="1511870">(</span><span class="ident" id="1511871"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511877">[</span><span class="num" id="1511878">7</span><span class="op" id="1511879">]</span><span class="op" id="1511880">+</span><span class="ident" id="1511881"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511882">*</span><span class="op" id="1511883">(</span><span class="ident" id="1511884"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511890">[</span><span class="num" id="1511891">10</span><span class="op" id="1511893">]</span><span class="op" id="1511894">+</span><span class="ident" id="1511895"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511896">*</span><span class="ident" id="1511897"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511903">[</span><span class="num" id="1511904">13</span><span class="op" id="1511906">]</span><span class="op" id="1511907">)</span><span class="op" id="1511908">)</span><span class="op" id="1511909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511914">p3</span>&nbsp;<span class="op" id="1511917">:=</span>&nbsp;<span class="ident" id="1511920"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511926">[</span><span class="num" id="1511927">2</span><span class="op" id="1511928">]</span>&nbsp;<span class="op" id="1511930">+</span>&nbsp;<span class="ident" id="1511932"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511933">*</span><span class="op" id="1511934">(</span><span class="ident" id="1511935"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511941">[</span><span class="num" id="1511942">5</span><span class="op" id="1511943">]</span><span class="op" id="1511944">+</span><span class="ident" id="1511945"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511946">*</span><span class="op" id="1511947">(</span><span class="ident" id="1511948"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511954">[</span><span class="num" id="1511955">8</span><span class="op" id="1511956">]</span><span class="op" id="1511957">+</span><span class="ident" id="1511958"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511959">*</span><span class="op" id="1511960">(</span><span class="ident" id="1511961"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511967">[</span><span class="num" id="1511968">11</span><span class="op" id="1511970">]</span><span class="op" id="1511971">+</span><span class="ident" id="1511972"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1511973">*</span><span class="ident" id="1511974"><a href="/math/lgamma.go.html#1507557">_lgamT</a></span><span class="op" id="1511980">[</span><span class="num" id="1511981">14</span><span class="op" id="1511983">]</span><span class="op" id="1511984">)</span><span class="op" id="1511985">)</span><span class="op" id="1511986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1511991">p</span>&nbsp;<span class="op" id="1511993">:=</span>&nbsp;<span class="ident" id="1511996"><a href="/math/lgamma.go.html#1511716">z</a></span><span class="op" id="1511997">*</span><span class="ident" id="1511998"><a href="/math/lgamma.go.html#1511744">p1</a></span>&nbsp;<span class="op" id="1512001">-</span>&nbsp;<span class="op" id="1512003">(</span><span class="ident" id="1512004"><a href="/math/lgamma.go.html#1510126">Tt</a></span>&nbsp;<span class="op" id="1512007">-</span>&nbsp;<span class="ident" id="1512009"><a href="/math/lgamma.go.html#1511730">w</a></span><span class="op" id="1512010">*</span><span class="op" id="1512011">(</span><span class="ident" id="1512012"><a href="/math/lgamma.go.html#1511837">p2</a></span><span class="op" id="1512014">+</span><span class="ident" id="1512015"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512016">*</span><span class="ident" id="1512017"><a href="/math/lgamma.go.html#1511914">p3</a></span><span class="op" id="1512019">)</span><span class="op" id="1512020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512025"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1512032">+=</span>&nbsp;<span class="op" id="1512035">(</span><span class="ident" id="1512036"><a href="/math/lgamma.go.html#1510042">Tf</a></span>&nbsp;<span class="op" id="1512039">+</span>&nbsp;<span class="ident" id="1512041"><a href="/math/lgamma.go.html#1511991">p</a></span><span class="op" id="1512042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512046">case</span>&nbsp;<span class="num" id="1512051">2</span><span class="op" id="1512052">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512057">p1</span>&nbsp;<span class="op" id="1512060">:=</span>&nbsp;<span class="ident" id="1512063"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1512065">*</span>&nbsp;<span class="op" id="1512067">(</span><span class="ident" id="1512068"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512074">[</span><span class="num" id="1512075">0</span><span class="op" id="1512076">]</span>&nbsp;<span class="op" id="1512078">+</span>&nbsp;<span class="ident" id="1512080"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512081">*</span><span class="op" id="1512082">(</span><span class="ident" id="1512083"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512089">[</span><span class="num" id="1512090">1</span><span class="op" id="1512091">]</span><span class="op" id="1512092">+</span><span class="ident" id="1512093"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512094">*</span><span class="op" id="1512095">(</span><span class="ident" id="1512096"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512102">[</span><span class="num" id="1512103">2</span><span class="op" id="1512104">]</span><span class="op" id="1512105">+</span><span class="ident" id="1512106"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512107">*</span><span class="op" id="1512108">(</span><span class="ident" id="1512109"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512115">[</span><span class="num" id="1512116">3</span><span class="op" id="1512117">]</span><span class="op" id="1512118">+</span><span class="ident" id="1512119"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512120">*</span><span class="op" id="1512121">(</span><span class="ident" id="1512122"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512128">[</span><span class="num" id="1512129">4</span><span class="op" id="1512130">]</span><span class="op" id="1512131">+</span><span class="ident" id="1512132"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512133">*</span><span class="ident" id="1512134"><a href="/math/lgamma.go.html#1508366">_lgamU</a></span><span class="op" id="1512140">[</span><span class="num" id="1512141">5</span><span class="op" id="1512142">]</span><span class="op" id="1512143">)</span><span class="op" id="1512144">)</span><span class="op" id="1512145">)</span><span class="op" id="1512146">)</span><span class="op" id="1512147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512152">p2</span>&nbsp;<span class="op" id="1512155">:=</span>&nbsp;<span class="num" id="1512158">1</span>&nbsp;<span class="op" id="1512160">+</span>&nbsp;<span class="ident" id="1512162"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512163">*</span><span class="op" id="1512164">(</span><span class="ident" id="1512165"><a href="/math/lgamma.go.html#1508707">_lgamV</a></span><span class="op" id="1512171">[</span><span class="num" id="1512172">1</span><span class="op" id="1512173">]</span><span class="op" id="1512174">+</span><span class="ident" id="1512175"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512176">*</span><span class="op" id="1512177">(</span><span class="ident" id="1512178"><a href="/math/lgamma.go.html#1508707">_lgamV</a></span><span class="op" id="1512184">[</span><span class="num" id="1512185">2</span><span class="op" id="1512186">]</span><span class="op" id="1512187">+</span><span class="ident" id="1512188"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512189">*</span><span class="op" id="1512190">(</span><span class="ident" id="1512191"><a href="/math/lgamma.go.html#1508707">_lgamV</a></span><span class="op" id="1512197">[</span><span class="num" id="1512198">3</span><span class="op" id="1512199">]</span><span class="op" id="1512200">+</span><span class="ident" id="1512201"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512202">*</span><span class="op" id="1512203">(</span><span class="ident" id="1512204"><a href="/math/lgamma.go.html#1508707">_lgamV</a></span><span class="op" id="1512210">[</span><span class="num" id="1512211">4</span><span class="op" id="1512212">]</span><span class="op" id="1512213">+</span><span class="ident" id="1512214"><a href="/math/lgamma.go.html#1510895">y</a></span><span class="op" id="1512215">*</span><span class="ident" id="1512216"><a href="/math/lgamma.go.html#1508707">_lgamV</a></span><span class="op" id="1512222">[</span><span class="num" id="1512223">5</span><span class="op" id="1512224">]</span><span class="op" id="1512225">)</span><span class="op" id="1512226">)</span><span class="op" id="1512227">)</span><span class="op" id="1512228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512233"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1512240">+=</span>&nbsp;<span class="op" id="1512243">(</span><span class="op" id="1512244">-</span><span class="num" id="1512245">0.5</span><span class="op" id="1512248">*</span><span class="ident" id="1512249"><a href="/math/lgamma.go.html#1510895">y</a></span>&nbsp;<span class="op" id="1512251">+</span>&nbsp;<span class="ident" id="1512253"><a href="/math/lgamma.go.html#1512057">p1</a></span><span class="op" id="1512255">/</span><span class="ident" id="1512256"><a href="/math/lgamma.go.html#1512152">p2</a></span><span class="op" id="1512258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512265">case</span>&nbsp;<span class="ident" id="1512270"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1512272">&lt;</span>&nbsp;<span class="num" id="1512274">8</span><span class="op" id="1512275">:</span>&nbsp;<span class="comment" id="1512277">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512293">i</span>&nbsp;<span class="op" id="1512295">:=</span>&nbsp;<span class="builtintype" id="1512298">int</span><span class="op" id="1512301">(</span><span class="ident" id="1512302"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1512303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512307">y</span>&nbsp;<span class="op" id="1512309">:=</span>&nbsp;<span class="ident" id="1512312"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1512314">-</span>&nbsp;<span class="builtintype" id="1512316">float64</span><span class="op" id="1512323">(</span><span class="ident" id="1512324"><a href="/math/lgamma.go.html#1512293">i</a></span><span class="op" id="1512325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512329">p</span>&nbsp;<span class="op" id="1512331">:=</span>&nbsp;<span class="ident" id="1512334"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512336">*</span>&nbsp;<span class="op" id="1512338">(</span><span class="ident" id="1512339"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512345">[</span><span class="num" id="1512346">0</span><span class="op" id="1512347">]</span>&nbsp;<span class="op" id="1512349">+</span>&nbsp;<span class="ident" id="1512351"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512352">*</span><span class="op" id="1512353">(</span><span class="ident" id="1512354"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512360">[</span><span class="num" id="1512361">1</span><span class="op" id="1512362">]</span><span class="op" id="1512363">+</span><span class="ident" id="1512364"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512365">*</span><span class="op" id="1512366">(</span><span class="ident" id="1512367"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512373">[</span><span class="num" id="1512374">2</span><span class="op" id="1512375">]</span><span class="op" id="1512376">+</span><span class="ident" id="1512377"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512378">*</span><span class="op" id="1512379">(</span><span class="ident" id="1512380"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512386">[</span><span class="num" id="1512387">3</span><span class="op" id="1512388">]</span><span class="op" id="1512389">+</span><span class="ident" id="1512390"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512391">*</span><span class="op" id="1512392">(</span><span class="ident" id="1512393"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512399">[</span><span class="num" id="1512400">4</span><span class="op" id="1512401">]</span><span class="op" id="1512402">+</span><span class="ident" id="1512403"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512404">*</span><span class="op" id="1512405">(</span><span class="ident" id="1512406"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512412">[</span><span class="num" id="1512413">5</span><span class="op" id="1512414">]</span><span class="op" id="1512415">+</span><span class="ident" id="1512416"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512417">*</span><span class="ident" id="1512418"><a href="/math/lgamma.go.html#1507164">_lgamS</a></span><span class="op" id="1512424">[</span><span class="num" id="1512425">6</span><span class="op" id="1512426">]</span><span class="op" id="1512427">)</span><span class="op" id="1512428">)</span><span class="op" id="1512429">)</span><span class="op" id="1512430">)</span><span class="op" id="1512431">)</span><span class="op" id="1512432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512436">q</span>&nbsp;<span class="op" id="1512438">:=</span>&nbsp;<span class="num" id="1512441">1</span>&nbsp;<span class="op" id="1512443">+</span>&nbsp;<span class="ident" id="1512445"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512446">*</span><span class="op" id="1512447">(</span><span class="ident" id="1512448"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512454">[</span><span class="num" id="1512455">1</span><span class="op" id="1512456">]</span><span class="op" id="1512457">+</span><span class="ident" id="1512458"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512459">*</span><span class="op" id="1512460">(</span><span class="ident" id="1512461"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512467">[</span><span class="num" id="1512468">2</span><span class="op" id="1512469">]</span><span class="op" id="1512470">+</span><span class="ident" id="1512471"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512472">*</span><span class="op" id="1512473">(</span><span class="ident" id="1512474"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512480">[</span><span class="num" id="1512481">3</span><span class="op" id="1512482">]</span><span class="op" id="1512483">+</span><span class="ident" id="1512484"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512485">*</span><span class="op" id="1512486">(</span><span class="ident" id="1512487"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512493">[</span><span class="num" id="1512494">4</span><span class="op" id="1512495">]</span><span class="op" id="1512496">+</span><span class="ident" id="1512497"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512498">*</span><span class="op" id="1512499">(</span><span class="ident" id="1512500"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512506">[</span><span class="num" id="1512507">5</span><span class="op" id="1512508">]</span><span class="op" id="1512509">+</span><span class="ident" id="1512510"><a href="/math/lgamma.go.html#1512307">y</a></span><span class="op" id="1512511">*</span><span class="ident" id="1512512"><a href="/math/lgamma.go.html#1506808">_lgamR</a></span><span class="op" id="1512518">[</span><span class="num" id="1512519">6</span><span class="op" id="1512520">]</span><span class="op" id="1512521">)</span><span class="op" id="1512522">)</span><span class="op" id="1512523">)</span><span class="op" id="1512524">)</span><span class="op" id="1512525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512529"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1512536">=</span>&nbsp;<span class="num" id="1512538">0.5</span><span class="op" id="1512541">*</span><span class="ident" id="1512542"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512544">+</span>&nbsp;<span class="ident" id="1512546"><a href="/math/lgamma.go.html#1512329">p</a></span><span class="op" id="1512547">/</span><span class="ident" id="1512548"><a href="/math/lgamma.go.html#1512436">q</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512552">z</span>&nbsp;<span class="op" id="1512554">:=</span>&nbsp;<span class="num" id="1512557">1.0</span>&nbsp;<span class="comment" id="1512561">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512599">switch</span>&nbsp;<span class="ident" id="1512606"><a href="/math/lgamma.go.html#1512293">i</a></span>&nbsp;<span class="op" id="1512608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512612">case</span>&nbsp;<span class="num" id="1512617">7</span><span class="op" id="1512618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512623"><a href="/math/lgamma.go.html#1512552">z</a></span>&nbsp;<span class="op" id="1512625">*=</span>&nbsp;<span class="op" id="1512628">(</span><span class="ident" id="1512629"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512631">+</span>&nbsp;<span class="num" id="1512633">6</span><span class="op" id="1512634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512639">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512653">case</span>&nbsp;<span class="num" id="1512658">6</span><span class="op" id="1512659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512664"><a href="/math/lgamma.go.html#1512552">z</a></span>&nbsp;<span class="op" id="1512666">*=</span>&nbsp;<span class="op" id="1512669">(</span><span class="ident" id="1512670"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512672">+</span>&nbsp;<span class="num" id="1512674">5</span><span class="op" id="1512675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512680">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512694">case</span>&nbsp;<span class="num" id="1512699">5</span><span class="op" id="1512700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512705"><a href="/math/lgamma.go.html#1512552">z</a></span>&nbsp;<span class="op" id="1512707">*=</span>&nbsp;<span class="op" id="1512710">(</span><span class="ident" id="1512711"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512713">+</span>&nbsp;<span class="num" id="1512715">4</span><span class="op" id="1512716">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512721">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512735">case</span>&nbsp;<span class="num" id="1512740">4</span><span class="op" id="1512741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512746"><a href="/math/lgamma.go.html#1512552">z</a></span>&nbsp;<span class="op" id="1512748">*=</span>&nbsp;<span class="op" id="1512751">(</span><span class="ident" id="1512752"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512754">+</span>&nbsp;<span class="num" id="1512756">3</span><span class="op" id="1512757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512762">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512776">case</span>&nbsp;<span class="num" id="1512781">3</span><span class="op" id="1512782">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512787"><a href="/math/lgamma.go.html#1512552">z</a></span>&nbsp;<span class="op" id="1512789">*=</span>&nbsp;<span class="op" id="1512792">(</span><span class="ident" id="1512793"><a href="/math/lgamma.go.html#1512307">y</a></span>&nbsp;<span class="op" id="1512795">+</span>&nbsp;<span class="num" id="1512797">2</span><span class="op" id="1512798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512803"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1512810">+=</span>&nbsp;<span class="ident" id="1512813"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1512816">(</span><span class="ident" id="1512817"><a href="/math/lgamma.go.html#1512552">z</a></span><span class="op" id="1512818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1512822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1512825">case</span>&nbsp;<span class="ident" id="1512830"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1512832">&lt;</span>&nbsp;<span class="ident" id="1512834"><a href="/math/lgamma.go.html#1509837">Two58</a></span><span class="op" id="1512839">:</span>&nbsp;<span class="comment" id="1512841">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512861">t</span>&nbsp;<span class="op" id="1512863">:=</span>&nbsp;<span class="ident" id="1512866"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1512869">(</span><span class="ident" id="1512870"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1512871">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512875">z</span>&nbsp;<span class="op" id="1512877">:=</span>&nbsp;<span class="num" id="1512880">1</span>&nbsp;<span class="op" id="1512882">/</span>&nbsp;<span class="ident" id="1512884"><a href="/math/lgamma.go.html#1509611">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512888">y</span>&nbsp;<span class="op" id="1512890">:=</span>&nbsp;<span class="ident" id="1512893"><a href="/math/lgamma.go.html#1512875">z</a></span>&nbsp;<span class="op" id="1512895">*</span>&nbsp;<span class="ident" id="1512897"><a href="/math/lgamma.go.html#1512875">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1512901">w</span>&nbsp;<span class="op" id="1512903">:=</span>&nbsp;<span class="ident" id="1512906"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512912">[</span><span class="num" id="1512913">0</span><span class="op" id="1512914">]</span>&nbsp;<span class="op" id="1512916">+</span>&nbsp;<span class="ident" id="1512918"><a href="/math/lgamma.go.html#1512875">z</a></span><span class="op" id="1512919">*</span><span class="op" id="1512920">(</span><span class="ident" id="1512921"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512927">[</span><span class="num" id="1512928">1</span><span class="op" id="1512929">]</span><span class="op" id="1512930">+</span><span class="ident" id="1512931"><a href="/math/lgamma.go.html#1512888">y</a></span><span class="op" id="1512932">*</span><span class="op" id="1512933">(</span><span class="ident" id="1512934"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512940">[</span><span class="num" id="1512941">2</span><span class="op" id="1512942">]</span><span class="op" id="1512943">+</span><span class="ident" id="1512944"><a href="/math/lgamma.go.html#1512888">y</a></span><span class="op" id="1512945">*</span><span class="op" id="1512946">(</span><span class="ident" id="1512947"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512953">[</span><span class="num" id="1512954">3</span><span class="op" id="1512955">]</span><span class="op" id="1512956">+</span><span class="ident" id="1512957"><a href="/math/lgamma.go.html#1512888">y</a></span><span class="op" id="1512958">*</span><span class="op" id="1512959">(</span><span class="ident" id="1512960"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512966">[</span><span class="num" id="1512967">4</span><span class="op" id="1512968">]</span><span class="op" id="1512969">+</span><span class="ident" id="1512970"><a href="/math/lgamma.go.html#1512888">y</a></span><span class="op" id="1512971">*</span><span class="op" id="1512972">(</span><span class="ident" id="1512973"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512979">[</span><span class="num" id="1512980">5</span><span class="op" id="1512981">]</span><span class="op" id="1512982">+</span><span class="ident" id="1512983"><a href="/math/lgamma.go.html#1512888">y</a></span><span class="op" id="1512984">*</span><span class="ident" id="1512985"><a href="/math/lgamma.go.html#1508997">_lgamW</a></span><span class="op" id="1512991">[</span><span class="num" id="1512992">6</span><span class="op" id="1512993">]</span><span class="op" id="1512994">)</span><span class="op" id="1512995">)</span><span class="op" id="1512996">)</span><span class="op" id="1512997">)</span><span class="op" id="1512998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513002"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1513009">=</span>&nbsp;<span class="op" id="1513011">(</span><span class="ident" id="1513012"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1513013">-</span><span class="num" id="1513014">0.5</span><span class="op" id="1513017">)</span><span class="op" id="1513018">*</span><span class="op" id="1513019">(</span><span class="ident" id="1513020"><a href="/math/lgamma.go.html#1512861">t</a></span><span class="op" id="1513021">-</span><span class="num" id="1513022">1</span><span class="op" id="1513023">)</span>&nbsp;<span class="op" id="1513025">+</span>&nbsp;<span class="ident" id="1513027"><a href="/math/lgamma.go.html#1512901">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513030">default</span><span class="op" id="1513037">:</span>&nbsp;<span class="comment" id="1513039">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513062"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1513069">=</span>&nbsp;<span class="ident" id="1513071"><a href="/math/lgamma.go.html#1509611">x</a></span>&nbsp;<span class="op" id="1513073">*</span>&nbsp;<span class="op" id="1513075">(</span><span class="ident" id="1513076"><a href="/math/log.go.html#1516693">Log</a></span><span class="op" id="1513079">(</span><span class="ident" id="1513080"><a href="/math/lgamma.go.html#1509611">x</a></span><span class="op" id="1513081">)</span>&nbsp;<span class="op" id="1513083">-</span>&nbsp;<span class="num" id="1513085">1</span><span class="op" id="1513086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513092">if</span>&nbsp;<span class="ident" id="1513095"><a href="/math/lgamma.go.html#1510347">neg</a></span>&nbsp;<span class="op" id="1513099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513103"><a href="/math/lgamma.go.html#1509623">lgamma</a></span>&nbsp;<span class="op" id="1513110">=</span>&nbsp;<span class="ident" id="1513112"><a href="/math/lgamma.go.html#1510514">nadj</a></span>&nbsp;<span class="op" id="1513117">-</span>&nbsp;<span class="ident" id="1513119"><a href="/math/lgamma.go.html#1509623">lgamma</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513127">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513130">return</span><br>
<span class="lineno"></span><span class="op" id="1513137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1513140">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="1513188">func</span>&nbsp;<span class="ident" id="1513193">sinPi</span><span class="op" id="1513198">(</span><span class="ident" id="1513199">x</span>&nbsp;<span class="builtintype" id="1513201">float64</span><span class="op" id="1513208">)</span>&nbsp;<span class="builtintype" id="1513210">float64</span>&nbsp;<span class="op" id="1513218">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513221">const</span>&nbsp;<span class="op" id="1513227">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513231">Two52</span>&nbsp;<span class="op" id="1513237">=</span>&nbsp;<span class="num" id="1513239">1</span>&nbsp;<span class="op" id="1513241">&lt;&lt;</span>&nbsp;<span class="num" id="1513244">52</span>&nbsp;<span class="comment" id="1513247">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513283">Two53</span>&nbsp;<span class="op" id="1513289">=</span>&nbsp;<span class="num" id="1513291">1</span>&nbsp;<span class="op" id="1513293">&lt;&lt;</span>&nbsp;<span class="num" id="1513296">53</span>&nbsp;<span class="comment" id="1513299">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513337">if</span>&nbsp;<span class="ident" id="1513340"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513342">&lt;</span>&nbsp;<span class="num" id="1513344">0.25</span>&nbsp;<span class="op" id="1513349">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513353">return</span>&nbsp;<span class="op" id="1513360">-</span><span class="ident" id="1513361"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1513364">(</span><span class="ident" id="1513365"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513368">*</span>&nbsp;<span class="ident" id="1513370"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1513378">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513401">z</span>&nbsp;<span class="op" id="1513403">:=</span>&nbsp;<span class="ident" id="1513406"><a href="/math/floor.go.html#1459326">Floor</a></span><span class="op" id="1513411">(</span><span class="ident" id="1513412"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513413">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513416">var</span>&nbsp;<span class="ident" id="1513420">n</span>&nbsp;<span class="builtintype" id="1513422">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513427">if</span>&nbsp;<span class="ident" id="1513430"><a href="/math/lgamma.go.html#1513401">z</a></span>&nbsp;<span class="op" id="1513432">!=</span>&nbsp;<span class="ident" id="1513435"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513437">{</span>&nbsp;<span class="comment" id="1513439">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513452"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513454">=</span>&nbsp;<span class="ident" id="1513456"><a href="/math/mod.go.html#1526320">Mod</a></span><span class="op" id="1513459">(</span><span class="ident" id="1513460"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513461">,</span>&nbsp;<span class="num" id="1513463">2</span><span class="op" id="1513464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513468"><a href="/math/lgamma.go.html#1513420">n</a></span>&nbsp;<span class="op" id="1513470">=</span>&nbsp;<span class="builtintype" id="1513472">int</span><span class="op" id="1513475">(</span><span class="ident" id="1513476"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513478">*</span>&nbsp;<span class="num" id="1513480">4</span><span class="op" id="1513481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513484">}</span>&nbsp;<span class="keyword" id="1513486">else</span>&nbsp;<span class="op" id="1513491">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513495">if</span>&nbsp;<span class="ident" id="1513498"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513500">&gt;=</span>&nbsp;<span class="ident" id="1513503"><a href="/math/lgamma.go.html#1513283">Two53</a></span>&nbsp;<span class="op" id="1513509">{</span>&nbsp;<span class="comment" id="1513511">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513532"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513534">=</span>&nbsp;<span class="num" id="1513536">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513541"><a href="/math/lgamma.go.html#1513420">n</a></span>&nbsp;<span class="op" id="1513543">=</span>&nbsp;<span class="num" id="1513545">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513549">}</span>&nbsp;<span class="keyword" id="1513551">else</span>&nbsp;<span class="op" id="1513556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513561">if</span>&nbsp;<span class="ident" id="1513564"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513566">&lt;</span>&nbsp;<span class="ident" id="1513568"><a href="/math/lgamma.go.html#1513231">Two52</a></span>&nbsp;<span class="op" id="1513574">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513580"><a href="/math/lgamma.go.html#1513401">z</a></span>&nbsp;<span class="op" id="1513582">=</span>&nbsp;<span class="ident" id="1513584"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513586">+</span>&nbsp;<span class="ident" id="1513588"><a href="/math/lgamma.go.html#1513231">Two52</a></span>&nbsp;<span class="comment" id="1513594">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513611"><a href="/math/lgamma.go.html#1513420">n</a></span>&nbsp;<span class="op" id="1513613">=</span>&nbsp;<span class="builtintype" id="1513615">int</span><span class="op" id="1513618">(</span><span class="num" id="1513619">1</span>&nbsp;<span class="op" id="1513621">&amp;</span>&nbsp;<span class="ident" id="1513623"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1513634">(</span><span class="ident" id="1513635"><a href="/math/lgamma.go.html#1513401">z</a></span><span class="op" id="1513636">)</span><span class="op" id="1513637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513642"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513644">=</span>&nbsp;<span class="builtintype" id="1513646">float64</span><span class="op" id="1513653">(</span><span class="ident" id="1513654"><a href="/math/lgamma.go.html#1513420">n</a></span><span class="op" id="1513655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513660"><a href="/math/lgamma.go.html#1513420">n</a></span>&nbsp;<span class="op" id="1513662">&lt;&lt;=</span>&nbsp;<span class="num" id="1513666">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513676">switch</span>&nbsp;<span class="ident" id="1513683"><a href="/math/lgamma.go.html#1513420">n</a></span>&nbsp;<span class="op" id="1513685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513688">case</span>&nbsp;<span class="num" id="1513693">0</span><span class="op" id="1513694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513698"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513700">=</span>&nbsp;<span class="ident" id="1513702"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1513705">(</span><span class="ident" id="1513706"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513709">*</span>&nbsp;<span class="ident" id="1513711"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513712">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513715">case</span>&nbsp;<span class="num" id="1513720">1</span><span class="op" id="1513721">,</span>&nbsp;<span class="num" id="1513723">2</span><span class="op" id="1513724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513728"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513730">=</span>&nbsp;<span class="ident" id="1513732"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1513735">(</span><span class="ident" id="1513736"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513739">*</span>&nbsp;<span class="op" id="1513741">(</span><span class="num" id="1513742">0.5</span>&nbsp;<span class="op" id="1513746">-</span>&nbsp;<span class="ident" id="1513748"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513749">)</span><span class="op" id="1513750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513753">case</span>&nbsp;<span class="num" id="1513758">3</span><span class="op" id="1513759">,</span>&nbsp;<span class="num" id="1513761">4</span><span class="op" id="1513762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513766"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513768">=</span>&nbsp;<span class="ident" id="1513770"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1513773">(</span><span class="ident" id="1513774"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513777">*</span>&nbsp;<span class="op" id="1513779">(</span><span class="num" id="1513780">1</span>&nbsp;<span class="op" id="1513782">-</span>&nbsp;<span class="ident" id="1513784"><a href="/math/lgamma.go.html#1513199">x</a></span><span class="op" id="1513785">)</span><span class="op" id="1513786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513789">case</span>&nbsp;<span class="num" id="1513794">5</span><span class="op" id="1513795">,</span>&nbsp;<span class="num" id="1513797">6</span><span class="op" id="1513798">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513802"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513804">=</span>&nbsp;<span class="op" id="1513806">-</span><span class="ident" id="1513807"><a href="/math/sin.go.html#1538181">Cos</a></span><span class="op" id="1513810">(</span><span class="ident" id="1513811"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513814">*</span>&nbsp;<span class="op" id="1513816">(</span><span class="ident" id="1513817"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513819">-</span>&nbsp;<span class="num" id="1513821">1.5</span><span class="op" id="1513824">)</span><span class="op" id="1513825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513828">default</span><span class="op" id="1513835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1513839"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513841">=</span>&nbsp;<span class="ident" id="1513843"><a href="/math/sin.go.html#1539575">Sin</a></span><span class="op" id="1513846">(</span><span class="ident" id="1513847"><a href="/math/const.go.html#1430552">Pi</a></span>&nbsp;<span class="op" id="1513850">*</span>&nbsp;<span class="op" id="1513852">(</span><span class="ident" id="1513853"><a href="/math/lgamma.go.html#1513199">x</a></span>&nbsp;<span class="op" id="1513855">-</span>&nbsp;<span class="num" id="1513857">2</span><span class="op" id="1513858">)</span><span class="op" id="1513859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1513862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1513865">return</span>&nbsp;<span class="op" id="1513872">-</span><span class="ident" id="1513873"><a href="/math/lgamma.go.html#1513199">x</a></span><br>
<span class="lineno">365</span><span class="op" id="1513875">}</span>
</div>
</body>
</html>
