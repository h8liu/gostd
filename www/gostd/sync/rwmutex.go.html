<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>sync</h2>
<ul>
<li><a href="/gostd/sync/cond.go.html">cond.go</a></li>
<li><a href="/gostd/sync/cond_test.go.html">cond_test.go</a></li>
<li><a href="/gostd/sync/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/sync/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/sync/mutex.go.html">mutex.go</a></li>
<li><a href="/gostd/sync/mutex_test.go.html">mutex_test.go</a></li>
<li><a href="/gostd/sync/once.go.html">once.go</a></li>
<li><a href="/gostd/sync/once_test.go.html">once_test.go</a></li>
<li><a href="/gostd/sync/pool.go.html">pool.go</a></li>
<li><a href="/gostd/sync/pool_test.go.html">pool_test.go</a></li>
<li><a href="/gostd/sync/race0.go.html">race0.go</a></li>
<li><a href="/gostd/sync/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/sync/runtime_sema_test.go.html">runtime_sema_test.go</a></li>
<li><a href="/gostd/sync/rwmutex.go.html" class="current">rwmutex.go</a></li>
<li><a href="/gostd/sync/rwmutex_test.go.html">rwmutex_test.go</a></li>
<li><a href="/gostd/sync/waitgroup.go.html">waitgroup.go</a></li>
<li><a href="/gostd/sync/waitgroup_test.go.html">waitgroup_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1455609">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1455664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1455718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1455769">package</span>&nbsp;<span class="ident" id="1455777">sync</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1455783">import</span>&nbsp;<span class="op" id="1455790">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1455793">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1455808">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><span class="op" id="1455817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1455820">//&nbsp;An&nbsp;RWMutex&nbsp;is&nbsp;a&nbsp;reader/writer&nbsp;mutual&nbsp;exclusion&nbsp;lock.</span><br>
<span class="lineno"></span><span class="comment" id="1455876">//&nbsp;The&nbsp;lock&nbsp;can&nbsp;be&nbsp;held&nbsp;by&nbsp;an&nbsp;arbitrary&nbsp;number&nbsp;of&nbsp;readers</span><br>
<span class="lineno"></span><span class="comment" id="1455934">//&nbsp;or&nbsp;a&nbsp;single&nbsp;writer.</span><br>
<span class="lineno">15</span><span class="comment" id="1455957">//&nbsp;RWMutexes&nbsp;can&nbsp;be&nbsp;created&nbsp;as&nbsp;part&nbsp;of&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="1456002">//&nbsp;structures;&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;RWMutex&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1456049">//&nbsp;an&nbsp;unlocked&nbsp;mutex.</span><br>
<span class="lineno"></span><span class="keyword" id="1456071">type</span>&nbsp;<span class="ident" id="1456076">RWMutex</span>&nbsp;<span class="keyword" id="1456084">struct</span>&nbsp;<span class="op" id="1456091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456094">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456106"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span>&nbsp;&nbsp;<span class="comment" id="1456113">//&nbsp;held&nbsp;if&nbsp;there&nbsp;are&nbsp;pending&nbsp;writers</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456151">writerSem</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1456163">uint32</span>&nbsp;<span class="comment" id="1456170">//&nbsp;semaphore&nbsp;for&nbsp;writers&nbsp;to&nbsp;wait&nbsp;for&nbsp;completing&nbsp;readers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456227">readerSem</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1456239">uint32</span>&nbsp;<span class="comment" id="1456246">//&nbsp;semaphore&nbsp;for&nbsp;readers&nbsp;to&nbsp;wait&nbsp;for&nbsp;completing&nbsp;writers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456303">readerCount</span>&nbsp;<span class="builtintype" id="1456315">int32</span>&nbsp;&nbsp;<span class="comment" id="1456322">//&nbsp;number&nbsp;of&nbsp;pending&nbsp;readers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456352">readerWait</span>&nbsp;&nbsp;<span class="builtintype" id="1456364">int32</span>&nbsp;&nbsp;<span class="comment" id="1456371">//&nbsp;number&nbsp;of&nbsp;departing&nbsp;readers</span><br>
<span class="lineno"></span><span class="op" id="1456402">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="1456405">const</span>&nbsp;<span class="ident" id="1456411">rwmutexMaxReaders</span>&nbsp;<span class="op" id="1456429">=</span>&nbsp;<span class="num" id="1456431">1</span>&nbsp;<span class="op" id="1456433">&lt;&lt;</span>&nbsp;<span class="num" id="1456436">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1456440">//&nbsp;RLock&nbsp;locks&nbsp;rw&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span><span class="keyword" id="1456471">func</span>&nbsp;<span class="op" id="1456476">(</span><span class="ident" id="1456477">rw</span>&nbsp;<span class="op" id="1456480">*</span><span class="ident" id="1456481"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1456488">)</span>&nbsp;<span class="ident" id="1456490">RLock</span><span class="op" id="1456495">(</span><span class="op" id="1456496">)</span>&nbsp;<span class="op" id="1456498">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1456501">if</span>&nbsp;<span class="ident" id="1456504"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1456516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456520">_</span>&nbsp;<span class="op" id="1456522">=</span>&nbsp;<span class="ident" id="1456524"><a href="/gostd/sync/rwmutex.go.html#1456477">rw</a></span><span class="op" id="1456526">.</span><span class="ident" id="1456527"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1456528">.</span><span class="ident" id="1456529"><a href="/gostd/sync/mutex.go.html#1443990">state</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456537"><a href="/gostd/sync/race0.go.html#1454219">raceDisable</a></span><span class="op" id="1456548">(</span><span class="op" id="1456549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1456552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1456555">if</span>&nbsp;<span class="ident" id="1456558"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1456564">.</span><span class="ident" id="1456565"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1456573">(</span><span class="op" id="1456574">&amp;</span><span class="ident" id="1456575"><a href="/gostd/sync/rwmutex.go.html#1456477">rw</a></span><span class="op" id="1456577">.</span><span class="ident" id="1456578"><a href="/gostd/sync/rwmutex.go.html#1456303">readerCount</a></span><span class="op" id="1456589">,</span>&nbsp;<span class="num" id="1456591">1</span><span class="op" id="1456592">)</span>&nbsp;<span class="op" id="1456594">&lt;</span>&nbsp;<span class="num" id="1456596">0</span>&nbsp;<span class="op" id="1456598">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1456602">//&nbsp;A&nbsp;writer&nbsp;is&nbsp;pending,&nbsp;wait&nbsp;for&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456641"><a href="/gostd/sync/runtime.go.html#1454759">runtime_Semacquire</a></span><span class="op" id="1456659">(</span><span class="op" id="1456660">&amp;</span><span class="ident" id="1456661"><a href="/gostd/sync/rwmutex.go.html#1456477">rw</a></span><span class="op" id="1456663">.</span><span class="ident" id="1456664"><a href="/gostd/sync/rwmutex.go.html#1456227">readerSem</a></span><span class="op" id="1456673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1456676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1456679">if</span>&nbsp;<span class="ident" id="1456682"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1456694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456698"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1456708">(</span><span class="op" id="1456709">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456713"><a href="/gostd/sync/race0.go.html#1454085">raceAcquire</a></span><span class="op" id="1456724">(</span><span class="ident" id="1456725"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1456731">.</span><span class="ident" id="1456732">Pointer</span><span class="op" id="1456739">(</span><span class="op" id="1456740">&amp;</span><span class="ident" id="1456741"><a href="/gostd/sync/rwmutex.go.html#1456477">rw</a></span><span class="op" id="1456743">.</span><span class="ident" id="1456744"><a href="/gostd/sync/rwmutex.go.html#1456227">readerSem</a></span><span class="op" id="1456753">)</span><span class="op" id="1456754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1456757">}</span><br>
<span class="lineno"></span><span class="op" id="1456759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1456762">//&nbsp;RUnlock&nbsp;undoes&nbsp;a&nbsp;single&nbsp;RLock&nbsp;call;</span><br>
<span class="lineno">45</span><span class="comment" id="1456801">//&nbsp;it&nbsp;does&nbsp;not&nbsp;affect&nbsp;other&nbsp;simultaneous&nbsp;readers.</span><br>
<span class="lineno"></span><span class="comment" id="1456851">//&nbsp;It&nbsp;is&nbsp;a&nbsp;run-time&nbsp;error&nbsp;if&nbsp;rw&nbsp;is&nbsp;not&nbsp;locked&nbsp;for&nbsp;reading</span><br>
<span class="lineno"></span><span class="comment" id="1456909">//&nbsp;on&nbsp;entry&nbsp;to&nbsp;RUnlock.</span><br>
<span class="lineno"></span><span class="keyword" id="1456933">func</span>&nbsp;<span class="op" id="1456938">(</span><span class="ident" id="1456939">rw</span>&nbsp;<span class="op" id="1456942">*</span><span class="ident" id="1456943"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1456950">)</span>&nbsp;<span class="ident" id="1456952">RUnlock</span><span class="op" id="1456959">(</span><span class="op" id="1456960">)</span>&nbsp;<span class="op" id="1456962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1456965">if</span>&nbsp;<span class="ident" id="1456968"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1456980">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1456984">_</span>&nbsp;<span class="op" id="1456986">=</span>&nbsp;<span class="ident" id="1456988"><a href="/gostd/sync/rwmutex.go.html#1456939">rw</a></span><span class="op" id="1456990">.</span><span class="ident" id="1456991"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1456992">.</span><span class="ident" id="1456993"><a href="/gostd/sync/mutex.go.html#1443990">state</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457001"><a href="/gostd/sync/race0.go.html#1454171">raceReleaseMerge</a></span><span class="op" id="1457017">(</span><span class="ident" id="1457018"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1457024">.</span><span class="ident" id="1457025">Pointer</span><span class="op" id="1457032">(</span><span class="op" id="1457033">&amp;</span><span class="ident" id="1457034"><a href="/gostd/sync/rwmutex.go.html#1456939">rw</a></span><span class="op" id="1457036">.</span><span class="ident" id="1457037"><a href="/gostd/sync/rwmutex.go.html#1456151">writerSem</a></span><span class="op" id="1457046">)</span><span class="op" id="1457047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457051"><a href="/gostd/sync/race0.go.html#1454219">raceDisable</a></span><span class="op" id="1457062">(</span><span class="op" id="1457063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1457069">if</span>&nbsp;<span class="ident" id="1457072">r</span>&nbsp;<span class="op" id="1457074">:=</span>&nbsp;<span class="ident" id="1457077"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1457083">.</span><span class="ident" id="1457084"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1457092">(</span><span class="op" id="1457093">&amp;</span><span class="ident" id="1457094"><a href="/gostd/sync/rwmutex.go.html#1456939">rw</a></span><span class="op" id="1457096">.</span><span class="ident" id="1457097"><a href="/gostd/sync/rwmutex.go.html#1456303">readerCount</a></span><span class="op" id="1457108">,</span>&nbsp;<span class="op" id="1457110">-</span><span class="num" id="1457111">1</span><span class="op" id="1457112">)</span><span class="op" id="1457113">;</span>&nbsp;<span class="ident" id="1457115"><a href="/gostd/sync/rwmutex.go.html#1457072">r</a></span>&nbsp;<span class="op" id="1457117">&lt;</span>&nbsp;<span class="num" id="1457119">0</span>&nbsp;<span class="op" id="1457121">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1457125">if</span>&nbsp;<span class="ident" id="1457128"><a href="/gostd/sync/rwmutex.go.html#1457072">r</a></span><span class="op" id="1457129">+</span><span class="num" id="1457130">1</span>&nbsp;<span class="op" id="1457132">==</span>&nbsp;<span class="num" id="1457135">0</span>&nbsp;<span class="op" id="1457137">||</span>&nbsp;<span class="ident" id="1457140"><a href="/gostd/sync/rwmutex.go.html#1457072">r</a></span><span class="op" id="1457141">+</span><span class="num" id="1457142">1</span>&nbsp;<span class="op" id="1457144">==</span>&nbsp;<span class="op" id="1457147">-</span><span class="ident" id="1457148"><a href="/gostd/sync/rwmutex.go.html#1456411">rwmutexMaxReaders</a></span>&nbsp;<span class="op" id="1457166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457171"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1457181">(</span><span class="op" id="1457182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1457187">panic</span><span class="op" id="1457192">(</span><span class="string" id="1457193">&#34;sync:&nbsp;RUnlock&nbsp;of&nbsp;unlocked&nbsp;RWMutex&#34;</span><span class="op" id="1457228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1457236">//&nbsp;A&nbsp;writer&nbsp;is&nbsp;pending.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1457262">if</span>&nbsp;<span class="ident" id="1457265"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1457271">.</span><span class="ident" id="1457272"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1457280">(</span><span class="op" id="1457281">&amp;</span><span class="ident" id="1457282"><a href="/gostd/sync/rwmutex.go.html#1456939">rw</a></span><span class="op" id="1457284">.</span><span class="ident" id="1457285"><a href="/gostd/sync/rwmutex.go.html#1456352">readerWait</a></span><span class="op" id="1457295">,</span>&nbsp;<span class="op" id="1457297">-</span><span class="num" id="1457298">1</span><span class="op" id="1457299">)</span>&nbsp;<span class="op" id="1457301">==</span>&nbsp;<span class="num" id="1457304">0</span>&nbsp;<span class="op" id="1457306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1457311">//&nbsp;The&nbsp;last&nbsp;reader&nbsp;unblocks&nbsp;the&nbsp;writer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457354"><a href="/gostd/sync/runtime.go.html#1455025">runtime_Semrelease</a></span><span class="op" id="1457372">(</span><span class="op" id="1457373">&amp;</span><span class="ident" id="1457374"><a href="/gostd/sync/rwmutex.go.html#1456939">rw</a></span><span class="op" id="1457376">.</span><span class="ident" id="1457377"><a href="/gostd/sync/rwmutex.go.html#1456151">writerSem</a></span><span class="op" id="1457386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457393">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1457396">if</span>&nbsp;<span class="ident" id="1457399"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1457411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457415"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1457425">(</span><span class="op" id="1457426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457429">}</span><br>
<span class="lineno"></span><span class="op" id="1457431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1457434">//&nbsp;Lock&nbsp;locks&nbsp;rw&nbsp;for&nbsp;writing.</span><br>
<span class="lineno"></span><span class="comment" id="1457464">//&nbsp;If&nbsp;the&nbsp;lock&nbsp;is&nbsp;already&nbsp;locked&nbsp;for&nbsp;reading&nbsp;or&nbsp;writing,</span><br>
<span class="lineno"></span><span class="comment" id="1457521">//&nbsp;Lock&nbsp;blocks&nbsp;until&nbsp;the&nbsp;lock&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1457565">//&nbsp;To&nbsp;ensure&nbsp;that&nbsp;the&nbsp;lock&nbsp;eventually&nbsp;becomes&nbsp;available,</span><br>
<span class="lineno"></span><span class="comment" id="1457622">//&nbsp;a&nbsp;blocked&nbsp;Lock&nbsp;call&nbsp;excludes&nbsp;new&nbsp;readers&nbsp;from&nbsp;acquiring</span><br>
<span class="lineno">75</span><span class="comment" id="1457681">//&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="1457694">func</span>&nbsp;<span class="op" id="1457699">(</span><span class="ident" id="1457700">rw</span>&nbsp;<span class="op" id="1457703">*</span><span class="ident" id="1457704"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1457711">)</span>&nbsp;<span class="ident" id="1457713">Lock</span><span class="op" id="1457717">(</span><span class="op" id="1457718">)</span>&nbsp;<span class="op" id="1457720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1457723">if</span>&nbsp;<span class="ident" id="1457726"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1457738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457742">_</span>&nbsp;<span class="op" id="1457744">=</span>&nbsp;<span class="ident" id="1457746"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1457748">.</span><span class="ident" id="1457749"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1457750">.</span><span class="ident" id="1457751"><a href="/gostd/sync/mutex.go.html#1443990">state</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457759"><a href="/gostd/sync/race0.go.html#1454219">raceDisable</a></span><span class="op" id="1457770">(</span><span class="op" id="1457771">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1457774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1457777">//&nbsp;First,&nbsp;resolve&nbsp;competition&nbsp;with&nbsp;other&nbsp;writers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457828"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1457830">.</span><span class="ident" id="1457831"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1457832">.</span><span class="ident" id="1457833"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="1457837">(</span><span class="op" id="1457838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1457841">//&nbsp;Announce&nbsp;to&nbsp;readers&nbsp;there&nbsp;is&nbsp;a&nbsp;pending&nbsp;writer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1457892">r</span>&nbsp;<span class="op" id="1457894">:=</span>&nbsp;<span class="ident" id="1457897"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1457903">.</span><span class="ident" id="1457904"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1457912">(</span><span class="op" id="1457913">&amp;</span><span class="ident" id="1457914"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1457916">.</span><span class="ident" id="1457917"><a href="/gostd/sync/rwmutex.go.html#1456303">readerCount</a></span><span class="op" id="1457928">,</span>&nbsp;<span class="op" id="1457930">-</span><span class="ident" id="1457931"><a href="/gostd/sync/rwmutex.go.html#1456411">rwmutexMaxReaders</a></span><span class="op" id="1457948">)</span>&nbsp;<span class="op" id="1457950">+</span>&nbsp;<span class="ident" id="1457952"><a href="/gostd/sync/rwmutex.go.html#1456411">rwmutexMaxReaders</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1457971">//&nbsp;Wait&nbsp;for&nbsp;active&nbsp;readers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1458000">if</span>&nbsp;<span class="ident" id="1458003"><a href="/gostd/sync/rwmutex.go.html#1457892">r</a></span>&nbsp;<span class="op" id="1458005">!=</span>&nbsp;<span class="num" id="1458008">0</span>&nbsp;<span class="op" id="1458010">&amp;&amp;</span>&nbsp;<span class="ident" id="1458013"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1458019">.</span><span class="ident" id="1458020"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1458028">(</span><span class="op" id="1458029">&amp;</span><span class="ident" id="1458030"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1458032">.</span><span class="ident" id="1458033"><a href="/gostd/sync/rwmutex.go.html#1456352">readerWait</a></span><span class="op" id="1458043">,</span>&nbsp;<span class="ident" id="1458045"><a href="/gostd/sync/rwmutex.go.html#1457892">r</a></span><span class="op" id="1458046">)</span>&nbsp;<span class="op" id="1458048">!=</span>&nbsp;<span class="num" id="1458051">0</span>&nbsp;<span class="op" id="1458053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458057"><a href="/gostd/sync/runtime.go.html#1454759">runtime_Semacquire</a></span><span class="op" id="1458075">(</span><span class="op" id="1458076">&amp;</span><span class="ident" id="1458077"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1458079">.</span><span class="ident" id="1458080"><a href="/gostd/sync/rwmutex.go.html#1456151">writerSem</a></span><span class="op" id="1458089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1458092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1458095">if</span>&nbsp;<span class="ident" id="1458098"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1458110">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458114"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1458124">(</span><span class="op" id="1458125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458129"><a href="/gostd/sync/race0.go.html#1454085">raceAcquire</a></span><span class="op" id="1458140">(</span><span class="ident" id="1458141"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1458147">.</span><span class="ident" id="1458148">Pointer</span><span class="op" id="1458155">(</span><span class="op" id="1458156">&amp;</span><span class="ident" id="1458157"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1458159">.</span><span class="ident" id="1458160"><a href="/gostd/sync/rwmutex.go.html#1456227">readerSem</a></span><span class="op" id="1458169">)</span><span class="op" id="1458170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458174"><a href="/gostd/sync/race0.go.html#1454085">raceAcquire</a></span><span class="op" id="1458185">(</span><span class="ident" id="1458186"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1458192">.</span><span class="ident" id="1458193">Pointer</span><span class="op" id="1458200">(</span><span class="op" id="1458201">&amp;</span><span class="ident" id="1458202"><a href="/gostd/sync/rwmutex.go.html#1457700">rw</a></span><span class="op" id="1458204">.</span><span class="ident" id="1458205"><a href="/gostd/sync/rwmutex.go.html#1456151">writerSem</a></span><span class="op" id="1458214">)</span><span class="op" id="1458215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1458218">}</span><br>
<span class="lineno"></span><span class="op" id="1458220">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="1458223">//&nbsp;Unlock&nbsp;unlocks&nbsp;rw&nbsp;for&nbsp;writing.&nbsp;&nbsp;It&nbsp;is&nbsp;a&nbsp;run-time&nbsp;error&nbsp;if&nbsp;rw&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1458290">//&nbsp;not&nbsp;locked&nbsp;for&nbsp;writing&nbsp;on&nbsp;entry&nbsp;to&nbsp;Unlock.</span><br>
<span class="lineno"></span><span class="comment" id="1458336">//</span><br>
<span class="lineno"></span><span class="comment" id="1458339">//&nbsp;As&nbsp;with&nbsp;Mutexes,&nbsp;a&nbsp;locked&nbsp;RWMutex&nbsp;is&nbsp;not&nbsp;associated&nbsp;with&nbsp;a&nbsp;particular</span><br>
<span class="lineno">100</span><span class="comment" id="1458412">//&nbsp;goroutine.&nbsp;&nbsp;One&nbsp;goroutine&nbsp;may&nbsp;RLock&nbsp;(Lock)&nbsp;an&nbsp;RWMutex&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="1458478">//&nbsp;arrange&nbsp;for&nbsp;another&nbsp;goroutine&nbsp;to&nbsp;RUnlock&nbsp;(Unlock)&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1458535">func</span>&nbsp;<span class="op" id="1458540">(</span><span class="ident" id="1458541">rw</span>&nbsp;<span class="op" id="1458544">*</span><span class="ident" id="1458545"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1458552">)</span>&nbsp;<span class="ident" id="1458554">Unlock</span><span class="op" id="1458560">(</span><span class="op" id="1458561">)</span>&nbsp;<span class="op" id="1458563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1458566">if</span>&nbsp;<span class="ident" id="1458569"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1458581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458585">_</span>&nbsp;<span class="op" id="1458587">=</span>&nbsp;<span class="ident" id="1458589"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1458591">.</span><span class="ident" id="1458592"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1458593">.</span><span class="ident" id="1458594"><a href="/gostd/sync/mutex.go.html#1443990">state</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458602"><a href="/gostd/sync/race0.go.html#1454128">raceRelease</a></span><span class="op" id="1458613">(</span><span class="ident" id="1458614"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1458620">.</span><span class="ident" id="1458621">Pointer</span><span class="op" id="1458628">(</span><span class="op" id="1458629">&amp;</span><span class="ident" id="1458630"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1458632">.</span><span class="ident" id="1458633"><a href="/gostd/sync/rwmutex.go.html#1456227">readerSem</a></span><span class="op" id="1458642">)</span><span class="op" id="1458643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458647"><a href="/gostd/sync/race0.go.html#1454128">raceRelease</a></span><span class="op" id="1458658">(</span><span class="ident" id="1458659"><a href="/gostd/sync/rwmutex.go.html#1455808">unsafe</a></span><span class="op" id="1458665">.</span><span class="ident" id="1458666">Pointer</span><span class="op" id="1458673">(</span><span class="op" id="1458674">&amp;</span><span class="ident" id="1458675"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1458677">.</span><span class="ident" id="1458678"><a href="/gostd/sync/rwmutex.go.html#1456151">writerSem</a></span><span class="op" id="1458687">)</span><span class="op" id="1458688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458692"><a href="/gostd/sync/race0.go.html#1454219">raceDisable</a></span><span class="op" id="1458703">(</span><span class="op" id="1458704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1458707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1458711">//&nbsp;Announce&nbsp;to&nbsp;readers&nbsp;there&nbsp;is&nbsp;no&nbsp;active&nbsp;writer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458762">r</span>&nbsp;<span class="op" id="1458764">:=</span>&nbsp;<span class="ident" id="1458767"><a href="/gostd/sync/rwmutex.go.html#1455793">atomic</a></span><span class="op" id="1458773">.</span><span class="ident" id="1458774"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="1458782">(</span><span class="op" id="1458783">&amp;</span><span class="ident" id="1458784"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1458786">.</span><span class="ident" id="1458787"><a href="/gostd/sync/rwmutex.go.html#1456303">readerCount</a></span><span class="op" id="1458798">,</span>&nbsp;<span class="ident" id="1458800"><a href="/gostd/sync/rwmutex.go.html#1456411">rwmutexMaxReaders</a></span><span class="op" id="1458817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1458820">if</span>&nbsp;<span class="ident" id="1458823"><a href="/gostd/sync/rwmutex.go.html#1458762">r</a></span>&nbsp;<span class="op" id="1458825">&gt;=</span>&nbsp;<span class="ident" id="1458828"><a href="/gostd/sync/rwmutex.go.html#1456411">rwmutexMaxReaders</a></span>&nbsp;<span class="op" id="1458846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458850"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1458860">(</span><span class="op" id="1458861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1458865">panic</span><span class="op" id="1458870">(</span><span class="string" id="1458871">&#34;sync:&nbsp;Unlock&nbsp;of&nbsp;unlocked&nbsp;RWMutex&#34;</span><span class="op" id="1458905">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1458908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1458911">//&nbsp;Unblock&nbsp;blocked&nbsp;readers,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1458948">for</span>&nbsp;<span class="ident" id="1458952">i</span>&nbsp;<span class="op" id="1458954">:=</span>&nbsp;<span class="num" id="1458957">0</span><span class="op" id="1458958">;</span>&nbsp;<span class="ident" id="1458960"><a href="/gostd/sync/rwmutex.go.html#1458952">i</a></span>&nbsp;<span class="op" id="1458962">&lt;</span>&nbsp;<span class="builtintype" id="1458964">int</span><span class="op" id="1458967">(</span><span class="ident" id="1458968"><a href="/gostd/sync/rwmutex.go.html#1458762">r</a></span><span class="op" id="1458969">)</span><span class="op" id="1458970">;</span>&nbsp;<span class="ident" id="1458972"><a href="/gostd/sync/rwmutex.go.html#1458952">i</a></span><span class="op" id="1458973">++</span>&nbsp;<span class="op" id="1458976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1458980"><a href="/gostd/sync/runtime.go.html#1455025">runtime_Semrelease</a></span><span class="op" id="1458998">(</span><span class="op" id="1458999">&amp;</span><span class="ident" id="1459000"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1459002">.</span><span class="ident" id="1459003"><a href="/gostd/sync/rwmutex.go.html#1456227">readerSem</a></span><span class="op" id="1459012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1459015">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1459018">//&nbsp;Allow&nbsp;other&nbsp;writers&nbsp;to&nbsp;proceed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1459054"><a href="/gostd/sync/rwmutex.go.html#1458541">rw</a></span><span class="op" id="1459056">.</span><span class="ident" id="1459057"><a href="/gostd/sync/rwmutex.go.html#1456094">w</a></span><span class="op" id="1459058">.</span><span class="ident" id="1459059"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="1459065">(</span><span class="op" id="1459066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1459069">if</span>&nbsp;<span class="ident" id="1459072"><a href="/gostd/sync/race0.go.html#1454059">raceenabled</a></span>&nbsp;<span class="op" id="1459084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1459088"><a href="/gostd/sync/race0.go.html#1454243">raceEnable</a></span><span class="op" id="1459098">(</span><span class="op" id="1459099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1459102">}</span><br>
<span class="lineno">125</span><span class="op" id="1459104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1459107">//&nbsp;RLocker&nbsp;returns&nbsp;a&nbsp;Locker&nbsp;interface&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="1459161">//&nbsp;the&nbsp;Lock&nbsp;and&nbsp;Unlock&nbsp;methods&nbsp;by&nbsp;calling&nbsp;rw.RLock&nbsp;and&nbsp;rw.RUnlock.</span><br>
<span class="lineno"></span><span class="keyword" id="1459228">func</span>&nbsp;<span class="op" id="1459233">(</span><span class="ident" id="1459234">rw</span>&nbsp;<span class="op" id="1459237">*</span><span class="ident" id="1459238"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1459245">)</span>&nbsp;<span class="ident" id="1459247">RLocker</span><span class="op" id="1459254">(</span><span class="op" id="1459255">)</span>&nbsp;<span class="ident" id="1459257"><a href="/gostd/sync/mutex.go.html#1444090">Locker</a></span>&nbsp;<span class="op" id="1459264">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1459267">return</span>&nbsp;<span class="op" id="1459274">(</span><span class="op" id="1459275">*</span><span class="ident" id="1459276"><a href="/gostd/sync/rwmutex.go.html#1459297">rlocker</a></span><span class="op" id="1459283">)</span><span class="op" id="1459284">(</span><span class="ident" id="1459285"><a href="/gostd/sync/rwmutex.go.html#1459234">rw</a></span><span class="op" id="1459287">)</span><br>
<span class="lineno"></span><span class="op" id="1459289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1459292">type</span>&nbsp;<span class="ident" id="1459297">rlocker</span>&nbsp;<span class="ident" id="1459305"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="1459314">func</span>&nbsp;<span class="op" id="1459319">(</span><span class="ident" id="1459320">r</span>&nbsp;<span class="op" id="1459322">*</span><span class="ident" id="1459323"><a href="/gostd/sync/rwmutex.go.html#1459297">rlocker</a></span><span class="op" id="1459330">)</span>&nbsp;<span class="ident" id="1459332">Lock</span><span class="op" id="1459336">(</span><span class="op" id="1459337">)</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1459341">{</span>&nbsp;<span class="op" id="1459343">(</span><span class="op" id="1459344">*</span><span class="ident" id="1459345"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1459352">)</span><span class="op" id="1459353">(</span><span class="ident" id="1459354"><a href="/gostd/sync/rwmutex.go.html#1459320">r</a></span><span class="op" id="1459355">)</span><span class="op" id="1459356">.</span><span class="ident" id="1459357"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="1459362">(</span><span class="op" id="1459363">)</span>&nbsp;<span class="op" id="1459365">}</span><br>
<span class="lineno"></span><span class="keyword" id="1459367">func</span>&nbsp;<span class="op" id="1459372">(</span><span class="ident" id="1459373">r</span>&nbsp;<span class="op" id="1459375">*</span><span class="ident" id="1459376"><a href="/gostd/sync/rwmutex.go.html#1459297">rlocker</a></span><span class="op" id="1459383">)</span>&nbsp;<span class="ident" id="1459385">Unlock</span><span class="op" id="1459391">(</span><span class="op" id="1459392">)</span>&nbsp;<span class="op" id="1459394">{</span>&nbsp;<span class="op" id="1459396">(</span><span class="op" id="1459397">*</span><span class="ident" id="1459398"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><span class="op" id="1459405">)</span><span class="op" id="1459406">(</span><span class="ident" id="1459407"><a href="/gostd/sync/rwmutex.go.html#1459373">r</a></span><span class="op" id="1459408">)</span><span class="op" id="1459409">.</span><span class="ident" id="1459410"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="1459417">(</span><span class="op" id="1459418">)</span>&nbsp;<span class="op" id="1459420">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
