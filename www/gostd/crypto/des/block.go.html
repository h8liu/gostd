<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3911632">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3911687">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3911741">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3911792">package</span>&nbsp;<span class="ident" id="3911800">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3911805">import</span>&nbsp;<span class="op" id="3911812">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3911815">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="3911833">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3911836">func</span>&nbsp;<span class="ident" id="3911841">cryptBlock</span><span class="op" id="3911851">(</span><span class="ident" id="3911852">subkeys</span>&nbsp;<span class="op" id="3911860">[</span><span class="op" id="3911861">]</span><span class="ident" id="3911862">uint64</span><span class="op" id="3911868">,</span>&nbsp;<span class="ident" id="3911870">dst</span><span class="op" id="3911873">,</span>&nbsp;<span class="ident" id="3911875">src</span>&nbsp;<span class="op" id="3911879">[</span><span class="op" id="3911880">]</span><span class="builtintype" id="3911881">byte</span><span class="op" id="3911885">,</span>&nbsp;<span class="ident" id="3911887">decrypt</span>&nbsp;<span class="builtintype" id="3911895">bool</span><span class="op" id="3911899">)</span>&nbsp;<span class="op" id="3911901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911904">b</span>&nbsp;<span class="op" id="3911906">:=</span>&nbsp;<span class="ident" id="3911909">binary</span><span class="op" id="3911915">.</span><span class="ident" id="3911916">BigEndian</span><span class="op" id="3911925">.</span><span class="ident" id="3911926">Uint64</span><span class="op" id="3911932">(</span><span class="ident" id="3911933">src</span><span class="op" id="3911936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911939">b</span>&nbsp;<span class="op" id="3911941">=</span>&nbsp;<span class="ident" id="3911943">permuteInitialBlock</span><span class="op" id="3911962">(</span><span class="ident" id="3911963">b</span><span class="op" id="3911964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911967">left</span><span class="op" id="3911971">,</span>&nbsp;<span class="ident" id="3911973">right</span>&nbsp;<span class="op" id="3911979">:=</span>&nbsp;<span class="builtintype" id="3911982">uint32</span><span class="op" id="3911988">(</span><span class="ident" id="3911989">b</span><span class="op" id="3911990">&gt;&gt;</span><span class="num" id="3911992">32</span><span class="op" id="3911994">)</span><span class="op" id="3911995">,</span>&nbsp;<span class="builtintype" id="3911997">uint32</span><span class="op" id="3912003">(</span><span class="ident" id="3912004">b</span><span class="op" id="3912005">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912009">var</span>&nbsp;<span class="ident" id="3912013">subkey</span>&nbsp;<span class="ident" id="3912020">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912028">for</span>&nbsp;<span class="ident" id="3912032">i</span>&nbsp;<span class="op" id="3912034">:=</span>&nbsp;<span class="num" id="3912037">0</span><span class="op" id="3912038">;</span>&nbsp;<span class="ident" id="3912040">i</span>&nbsp;<span class="op" id="3912042">&lt;</span>&nbsp;<span class="num" id="3912044">16</span><span class="op" id="3912046">;</span>&nbsp;<span class="ident" id="3912048">i</span><span class="op" id="3912049">++</span>&nbsp;<span class="op" id="3912052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912056">if</span>&nbsp;<span class="ident" id="3912059">decrypt</span>&nbsp;<span class="op" id="3912067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912072">subkey</span>&nbsp;<span class="op" id="3912079">=</span>&nbsp;<span class="ident" id="3912081">subkeys</span><span class="op" id="3912088">[</span><span class="num" id="3912089">15</span><span class="op" id="3912091">-</span><span class="ident" id="3912092">i</span><span class="op" id="3912093">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912097">}</span>&nbsp;<span class="keyword" id="3912099">else</span>&nbsp;<span class="op" id="3912104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912109">subkey</span>&nbsp;<span class="op" id="3912116">=</span>&nbsp;<span class="ident" id="3912118">subkeys</span><span class="op" id="3912125">[</span><span class="ident" id="3912126">i</span><span class="op" id="3912127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912136">left</span><span class="op" id="3912140">,</span>&nbsp;<span class="ident" id="3912142">right</span>&nbsp;<span class="op" id="3912148">=</span>&nbsp;<span class="ident" id="3912150">right</span><span class="op" id="3912155">,</span>&nbsp;<span class="ident" id="3912157">left</span><span class="op" id="3912161">^</span><span class="ident" id="3912162">feistel</span><span class="op" id="3912169">(</span><span class="ident" id="3912170">right</span><span class="op" id="3912175">,</span>&nbsp;<span class="ident" id="3912177">subkey</span><span class="op" id="3912183">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3912189">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912243">preOutput</span>&nbsp;<span class="op" id="3912253">:=</span>&nbsp;<span class="op" id="3912256">(</span><span class="ident" id="3912257">uint64</span><span class="op" id="3912263">(</span><span class="ident" id="3912264">right</span><span class="op" id="3912269">)</span>&nbsp;<span class="op" id="3912271">&lt;&lt;</span>&nbsp;<span class="num" id="3912274">32</span><span class="op" id="3912276">)</span>&nbsp;<span class="op" id="3912278">|</span>&nbsp;<span class="ident" id="3912280">uint64</span><span class="op" id="3912286">(</span><span class="ident" id="3912287">left</span><span class="op" id="3912291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912294">binary</span><span class="op" id="3912300">.</span><span class="ident" id="3912301">BigEndian</span><span class="op" id="3912310">.</span><span class="ident" id="3912311">PutUint64</span><span class="op" id="3912320">(</span><span class="ident" id="3912321">dst</span><span class="op" id="3912324">,</span>&nbsp;<span class="ident" id="3912326">permuteFinalBlock</span><span class="op" id="3912343">(</span><span class="ident" id="3912344">preOutput</span><span class="op" id="3912353">)</span><span class="op" id="3912354">)</span><br>
<span class="lineno"></span><span class="op" id="3912356">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3912359">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3912418">func</span>&nbsp;<span class="ident" id="3912423">encryptBlock</span><span class="op" id="3912435">(</span><span class="ident" id="3912436">subkeys</span>&nbsp;<span class="op" id="3912444">[</span><span class="op" id="3912445">]</span><span class="ident" id="3912446">uint64</span><span class="op" id="3912452">,</span>&nbsp;<span class="ident" id="3912454">dst</span><span class="op" id="3912457">,</span>&nbsp;<span class="ident" id="3912459">src</span>&nbsp;<span class="op" id="3912463">[</span><span class="op" id="3912464">]</span><span class="builtintype" id="3912465">byte</span><span class="op" id="3912469">)</span>&nbsp;<span class="op" id="3912471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912474">cryptBlock</span><span class="op" id="3912484">(</span><span class="ident" id="3912485">subkeys</span><span class="op" id="3912492">,</span>&nbsp;<span class="ident" id="3912494">dst</span><span class="op" id="3912497">,</span>&nbsp;<span class="ident" id="3912499">src</span><span class="op" id="3912502">,</span>&nbsp;<span class="builtintype" id="3912504">false</span><span class="op" id="3912509">)</span><br>
<span class="lineno"></span><span class="op" id="3912511">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3912514">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3912573">func</span>&nbsp;<span class="ident" id="3912578">decryptBlock</span><span class="op" id="3912590">(</span><span class="ident" id="3912591">subkeys</span>&nbsp;<span class="op" id="3912599">[</span><span class="op" id="3912600">]</span><span class="ident" id="3912601">uint64</span><span class="op" id="3912607">,</span>&nbsp;<span class="ident" id="3912609">dst</span><span class="op" id="3912612">,</span>&nbsp;<span class="ident" id="3912614">src</span>&nbsp;<span class="op" id="3912618">[</span><span class="op" id="3912619">]</span><span class="builtintype" id="3912620">byte</span><span class="op" id="3912624">)</span>&nbsp;<span class="op" id="3912626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912629">cryptBlock</span><span class="op" id="3912639">(</span><span class="ident" id="3912640">subkeys</span><span class="op" id="3912647">,</span>&nbsp;<span class="ident" id="3912649">dst</span><span class="op" id="3912652">,</span>&nbsp;<span class="ident" id="3912654">src</span><span class="op" id="3912657">,</span>&nbsp;<span class="builtintype" id="3912659">true</span><span class="op" id="3912663">)</span><br>
<span class="lineno"></span><span class="op" id="3912665">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3912668">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3912692">func</span>&nbsp;<span class="ident" id="3912697">feistel</span><span class="op" id="3912704">(</span><span class="ident" id="3912705">right</span>&nbsp;<span class="builtintype" id="3912711">uint32</span><span class="op" id="3912717">,</span>&nbsp;<span class="ident" id="3912719">key</span>&nbsp;<span class="ident" id="3912723">uint64</span><span class="op" id="3912729">)</span>&nbsp;<span class="op" id="3912731">(</span><span class="ident" id="3912732">result</span>&nbsp;<span class="builtintype" id="3912739">uint32</span><span class="op" id="3912745">)</span>&nbsp;<span class="op" id="3912747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912750">sBoxLocations</span>&nbsp;<span class="op" id="3912764">:=</span>&nbsp;<span class="ident" id="3912767">key</span>&nbsp;<span class="op" id="3912771">^</span>&nbsp;<span class="ident" id="3912773">expandBlock</span><span class="op" id="3912784">(</span><span class="ident" id="3912785">right</span><span class="op" id="3912790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912793">var</span>&nbsp;<span class="ident" id="3912797">sBoxResult</span>&nbsp;<span class="builtintype" id="3912808">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912816">for</span>&nbsp;<span class="ident" id="3912820">i</span>&nbsp;<span class="op" id="3912822">:=</span>&nbsp;<span class="builtintype" id="3912825">uint8</span><span class="op" id="3912830">(</span><span class="num" id="3912831">0</span><span class="op" id="3912832">)</span><span class="op" id="3912833">;</span>&nbsp;<span class="ident" id="3912835">i</span>&nbsp;<span class="op" id="3912837">&lt;</span>&nbsp;<span class="num" id="3912839">8</span><span class="op" id="3912840">;</span>&nbsp;<span class="ident" id="3912842">i</span><span class="op" id="3912843">++</span>&nbsp;<span class="op" id="3912846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912850">sBoxLocation</span>&nbsp;<span class="op" id="3912863">:=</span>&nbsp;<span class="builtintype" id="3912866">uint8</span><span class="op" id="3912871">(</span><span class="ident" id="3912872">sBoxLocations</span><span class="op" id="3912885">&gt;&gt;</span><span class="num" id="3912887">42</span><span class="op" id="3912889">)</span>&nbsp;<span class="op" id="3912891">&amp;</span>&nbsp;<span class="num" id="3912893">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912900">sBoxLocations</span>&nbsp;<span class="op" id="3912914">&lt;&lt;=</span>&nbsp;<span class="num" id="3912918">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3912922">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3912961">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912993">row</span>&nbsp;<span class="op" id="3912997">:=</span>&nbsp;<span class="op" id="3913000">(</span><span class="ident" id="3913001">sBoxLocation</span>&nbsp;<span class="op" id="3913014">&amp;</span>&nbsp;<span class="num" id="3913016">0x1</span><span class="op" id="3913019">)</span>&nbsp;<span class="op" id="3913021">|</span>&nbsp;<span class="op" id="3913023">(</span><span class="op" id="3913024">(</span><span class="ident" id="3913025">sBoxLocation</span>&nbsp;<span class="op" id="3913038">&amp;</span>&nbsp;<span class="num" id="3913040">0x20</span><span class="op" id="3913044">)</span>&nbsp;<span class="op" id="3913046">&gt;&gt;</span>&nbsp;<span class="num" id="3913049">4</span><span class="op" id="3913050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913054">column</span>&nbsp;<span class="op" id="3913061">:=</span>&nbsp;<span class="op" id="3913064">(</span><span class="ident" id="3913065">sBoxLocation</span>&nbsp;<span class="op" id="3913078">&gt;&gt;</span>&nbsp;<span class="num" id="3913081">1</span><span class="op" id="3913082">)</span>&nbsp;<span class="op" id="3913084">&amp;</span>&nbsp;<span class="num" id="3913086">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913092">sBoxResult</span>&nbsp;<span class="op" id="3913103">^=</span>&nbsp;<span class="ident" id="3913106">feistelBox</span><span class="op" id="3913116">[</span><span class="ident" id="3913117">i</span><span class="op" id="3913118">]</span><span class="op" id="3913119">[</span><span class="num" id="3913120">16</span><span class="op" id="3913122">*</span><span class="ident" id="3913123">row</span><span class="op" id="3913126">+</span><span class="ident" id="3913127">column</span><span class="op" id="3913133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913139">return</span>&nbsp;<span class="ident" id="3913146">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="3913157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913160">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="3913228">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="3913262">var</span>&nbsp;<span class="ident" id="3913266">feistelBox</span>&nbsp;<span class="op" id="3913277">[</span><span class="num" id="3913278">8</span><span class="op" id="3913279">]</span><span class="op" id="3913280">[</span><span class="num" id="3913281">64</span><span class="op" id="3913283">]</span><span class="builtintype" id="3913284">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3913292">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="3913354">func</span>&nbsp;<span class="ident" id="3913359">permuteBlock</span><span class="op" id="3913371">(</span><span class="ident" id="3913372">src</span>&nbsp;<span class="ident" id="3913376">uint64</span><span class="op" id="3913382">,</span>&nbsp;<span class="ident" id="3913384">permutation</span>&nbsp;<span class="op" id="3913396">[</span><span class="op" id="3913397">]</span><span class="builtintype" id="3913398">uint8</span><span class="op" id="3913403">)</span>&nbsp;<span class="op" id="3913405">(</span><span class="ident" id="3913406">block</span>&nbsp;<span class="ident" id="3913412">uint64</span><span class="op" id="3913418">)</span>&nbsp;<span class="op" id="3913420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913423">for</span>&nbsp;<span class="ident" id="3913427">position</span><span class="op" id="3913435">,</span>&nbsp;<span class="ident" id="3913437">n</span>&nbsp;<span class="op" id="3913439">:=</span>&nbsp;<span class="keyword" id="3913442">range</span>&nbsp;<span class="ident" id="3913448">permutation</span>&nbsp;<span class="op" id="3913460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913464">bit</span>&nbsp;<span class="op" id="3913468">:=</span>&nbsp;<span class="op" id="3913471">(</span><span class="ident" id="3913472">src</span>&nbsp;<span class="op" id="3913476">&gt;&gt;</span>&nbsp;<span class="ident" id="3913479">n</span><span class="op" id="3913480">)</span>&nbsp;<span class="op" id="3913482">&amp;</span>&nbsp;<span class="num" id="3913484">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913488">block</span>&nbsp;<span class="op" id="3913494">|=</span>&nbsp;<span class="ident" id="3913497">bit</span>&nbsp;<span class="op" id="3913501">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3913504">uint</span><span class="op" id="3913508">(</span><span class="op" id="3913509">(</span><span class="builtinfunc" id="3913510">len</span><span class="op" id="3913513">(</span><span class="ident" id="3913514">permutation</span><span class="op" id="3913525">)</span><span class="op" id="3913526">-</span><span class="num" id="3913527">1</span><span class="op" id="3913528">)</span><span class="op" id="3913529">-</span><span class="ident" id="3913530">position</span><span class="op" id="3913538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913544">return</span><br>
<span class="lineno"></span><span class="op" id="3913551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3913554">func</span>&nbsp;<span class="ident" id="3913559">init</span><span class="op" id="3913563">(</span><span class="op" id="3913564">)</span>&nbsp;<span class="op" id="3913566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913569">for</span>&nbsp;<span class="ident" id="3913573">s</span>&nbsp;<span class="op" id="3913575">:=</span>&nbsp;<span class="keyword" id="3913578">range</span>&nbsp;<span class="ident" id="3913584">sBoxes</span>&nbsp;<span class="op" id="3913591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913595">for</span>&nbsp;<span class="ident" id="3913599">i</span>&nbsp;<span class="op" id="3913601">:=</span>&nbsp;<span class="num" id="3913604">0</span><span class="op" id="3913605">;</span>&nbsp;<span class="ident" id="3913607">i</span>&nbsp;<span class="op" id="3913609">&lt;</span>&nbsp;<span class="num" id="3913611">4</span><span class="op" id="3913612">;</span>&nbsp;<span class="ident" id="3913614">i</span><span class="op" id="3913615">++</span>&nbsp;<span class="op" id="3913618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913623">for</span>&nbsp;<span class="ident" id="3913627">j</span>&nbsp;<span class="op" id="3913629">:=</span>&nbsp;<span class="num" id="3913632">0</span><span class="op" id="3913633">;</span>&nbsp;<span class="ident" id="3913635">j</span>&nbsp;<span class="op" id="3913637">&lt;</span>&nbsp;<span class="num" id="3913639">16</span><span class="op" id="3913641">;</span>&nbsp;<span class="ident" id="3913643">j</span><span class="op" id="3913644">++</span>&nbsp;<span class="op" id="3913647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913653">f</span>&nbsp;<span class="op" id="3913655">:=</span>&nbsp;<span class="ident" id="3913658">uint64</span><span class="op" id="3913664">(</span><span class="ident" id="3913665">sBoxes</span><span class="op" id="3913671">[</span><span class="ident" id="3913672">s</span><span class="op" id="3913673">]</span><span class="op" id="3913674">[</span><span class="ident" id="3913675">i</span><span class="op" id="3913676">]</span><span class="op" id="3913677">[</span><span class="ident" id="3913678">j</span><span class="op" id="3913679">]</span><span class="op" id="3913680">)</span>&nbsp;<span class="op" id="3913682">&lt;&lt;</span>&nbsp;<span class="op" id="3913685">(</span><span class="num" id="3913686">4</span>&nbsp;<span class="op" id="3913688">*</span>&nbsp;<span class="op" id="3913690">(</span><span class="num" id="3913691">7</span>&nbsp;<span class="op" id="3913693">-</span>&nbsp;<span class="builtintype" id="3913695">uint</span><span class="op" id="3913699">(</span><span class="ident" id="3913700">s</span><span class="op" id="3913701">)</span><span class="op" id="3913702">)</span><span class="op" id="3913703">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913709">f</span>&nbsp;<span class="op" id="3913711">=</span>&nbsp;<span class="ident" id="3913713">permuteBlock</span><span class="op" id="3913725">(</span><span class="ident" id="3913726">uint64</span><span class="op" id="3913732">(</span><span class="ident" id="3913733">f</span><span class="op" id="3913734">)</span><span class="op" id="3913735">,</span>&nbsp;<span class="ident" id="3913737">permutationFunction</span><span class="op" id="3913756">[</span><span class="op" id="3913757">:</span><span class="op" id="3913758">]</span><span class="op" id="3913759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913765">feistelBox</span><span class="op" id="3913775">[</span><span class="ident" id="3913776">s</span><span class="op" id="3913777">]</span><span class="op" id="3913778">[</span><span class="num" id="3913779">16</span><span class="op" id="3913781">*</span><span class="ident" id="3913782">i</span><span class="op" id="3913783">+</span><span class="ident" id="3913784">j</span><span class="op" id="3913785">]</span>&nbsp;<span class="op" id="3913787">=</span>&nbsp;<span class="builtintype" id="3913789">uint32</span><span class="op" id="3913795">(</span><span class="ident" id="3913796">f</span><span class="op" id="3913797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913809">}</span><br>
<span class="lineno">80</span><span class="op" id="3913811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913814">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3913864">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="3913905">func</span>&nbsp;<span class="ident" id="3913910">expandBlock</span><span class="op" id="3913921">(</span><span class="ident" id="3913922">src</span>&nbsp;<span class="builtintype" id="3913926">uint32</span><span class="op" id="3913932">)</span>&nbsp;<span class="op" id="3913934">(</span><span class="ident" id="3913935">block</span>&nbsp;<span class="ident" id="3913941">uint64</span><span class="op" id="3913947">)</span>&nbsp;<span class="op" id="3913949">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3913952">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913996">src</span>&nbsp;<span class="op" id="3914000">=</span>&nbsp;<span class="op" id="3914002">(</span><span class="ident" id="3914003">src</span>&nbsp;<span class="op" id="3914007">&lt;&lt;</span>&nbsp;<span class="num" id="3914010">5</span><span class="op" id="3914011">)</span>&nbsp;<span class="op" id="3914013">|</span>&nbsp;<span class="op" id="3914015">(</span><span class="ident" id="3914016">src</span>&nbsp;<span class="op" id="3914020">&gt;&gt;</span>&nbsp;<span class="num" id="3914023">27</span><span class="op" id="3914025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914028">for</span>&nbsp;<span class="ident" id="3914032">i</span>&nbsp;<span class="op" id="3914034">:=</span>&nbsp;<span class="num" id="3914037">0</span><span class="op" id="3914038">;</span>&nbsp;<span class="ident" id="3914040">i</span>&nbsp;<span class="op" id="3914042">&lt;</span>&nbsp;<span class="num" id="3914044">8</span><span class="op" id="3914045">;</span>&nbsp;<span class="ident" id="3914047">i</span><span class="op" id="3914048">++</span>&nbsp;<span class="op" id="3914051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914055">block</span>&nbsp;<span class="op" id="3914061">&lt;&lt;=</span>&nbsp;<span class="num" id="3914065">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914069">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914103">block</span>&nbsp;<span class="op" id="3914109">|=</span>&nbsp;<span class="ident" id="3914112">uint64</span><span class="op" id="3914118">(</span><span class="ident" id="3914119">src</span><span class="op" id="3914122">)</span>&nbsp;<span class="op" id="3914124">&amp;</span>&nbsp;<span class="op" id="3914126">(</span><span class="num" id="3914127">1</span><span class="op" id="3914128">&lt;&lt;</span><span class="num" id="3914130">6</span>&nbsp;<span class="op" id="3914132">-</span>&nbsp;<span class="num" id="3914134">1</span><span class="op" id="3914135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914139">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914163">src</span>&nbsp;<span class="op" id="3914167">=</span>&nbsp;<span class="op" id="3914169">(</span><span class="ident" id="3914170">src</span>&nbsp;<span class="op" id="3914174">&lt;&lt;</span>&nbsp;<span class="num" id="3914177">4</span><span class="op" id="3914178">)</span>&nbsp;<span class="op" id="3914180">|</span>&nbsp;<span class="op" id="3914182">(</span><span class="ident" id="3914183">src</span>&nbsp;<span class="op" id="3914187">&gt;&gt;</span>&nbsp;<span class="num" id="3914190">28</span><span class="op" id="3914192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914198">return</span><br>
<span class="lineno">95</span><span class="op" id="3914205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3914208">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3914272">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3914298">func</span>&nbsp;<span class="ident" id="3914303">permuteInitialBlock</span><span class="op" id="3914322">(</span><span class="ident" id="3914323">block</span>&nbsp;<span class="ident" id="3914329">uint64</span><span class="op" id="3914335">)</span>&nbsp;<span class="ident" id="3914337">uint64</span>&nbsp;<span class="op" id="3914344">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914347">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914393">b1</span>&nbsp;<span class="op" id="3914396">:=</span>&nbsp;<span class="ident" id="3914399">block</span>&nbsp;<span class="op" id="3914405">&gt;&gt;</span>&nbsp;<span class="num" id="3914408">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914412">b2</span>&nbsp;<span class="op" id="3914415">:=</span>&nbsp;<span class="ident" id="3914418">block</span>&nbsp;<span class="op" id="3914424">&lt;&lt;</span>&nbsp;<span class="num" id="3914427">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914431">block</span>&nbsp;<span class="op" id="3914437">^=</span>&nbsp;<span class="ident" id="3914440">b1</span>&nbsp;<span class="op" id="3914443">^</span>&nbsp;<span class="ident" id="3914445">b2</span>&nbsp;<span class="op" id="3914448">^</span>&nbsp;<span class="ident" id="3914450">b1</span><span class="op" id="3914452">&lt;&lt;</span><span class="num" id="3914454">48</span>&nbsp;<span class="op" id="3914457">^</span>&nbsp;<span class="ident" id="3914459">b2</span><span class="op" id="3914461">&gt;&gt;</span><span class="num" id="3914463">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914468">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914504">b1</span>&nbsp;<span class="op" id="3914507">=</span>&nbsp;<span class="ident" id="3914509">block</span>&nbsp;<span class="op" id="3914515">&gt;&gt;</span>&nbsp;<span class="num" id="3914518">32</span>&nbsp;<span class="op" id="3914521">&amp;</span>&nbsp;<span class="num" id="3914523">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914533">b2</span>&nbsp;<span class="op" id="3914536">=</span>&nbsp;<span class="op" id="3914538">(</span><span class="ident" id="3914539">block</span>&nbsp;<span class="op" id="3914545">&amp;</span>&nbsp;<span class="num" id="3914547">0xff00ff00</span><span class="op" id="3914557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914560">block</span>&nbsp;<span class="op" id="3914566">^=</span>&nbsp;<span class="ident" id="3914569">b1</span><span class="op" id="3914571">&lt;&lt;</span><span class="num" id="3914573">32</span>&nbsp;<span class="op" id="3914576">^</span>&nbsp;<span class="ident" id="3914578">b2</span>&nbsp;<span class="op" id="3914581">^</span>&nbsp;<span class="ident" id="3914583">b1</span><span class="op" id="3914585">&lt;&lt;</span><span class="num" id="3914587">8</span>&nbsp;<span class="op" id="3914589">^</span>&nbsp;<span class="ident" id="3914591">b2</span><span class="op" id="3914593">&lt;&lt;</span><span class="num" id="3914595">24</span>&nbsp;<span class="comment" id="3914598">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914629">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914688">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914800">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914828">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914856">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3914913">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914956">b1</span>&nbsp;<span class="op" id="3914959">=</span>&nbsp;<span class="ident" id="3914961">block</span>&nbsp;<span class="op" id="3914967">&amp;</span>&nbsp;<span class="num" id="3914969">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914989">b2</span>&nbsp;<span class="op" id="3914992">=</span>&nbsp;<span class="ident" id="3914994">block</span>&nbsp;<span class="op" id="3915000">&amp;</span>&nbsp;<span class="num" id="3915002">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915022">block</span>&nbsp;<span class="op" id="3915028">^=</span>&nbsp;<span class="ident" id="3915031">b1</span>&nbsp;<span class="op" id="3915034">^</span>&nbsp;<span class="ident" id="3915036">b2</span>&nbsp;<span class="op" id="3915039">^</span>&nbsp;<span class="ident" id="3915041">b1</span><span class="op" id="3915043">&gt;&gt;</span><span class="num" id="3915045">12</span>&nbsp;<span class="op" id="3915048">^</span>&nbsp;<span class="ident" id="3915050">b2</span><span class="op" id="3915052">&lt;&lt;</span><span class="num" id="3915054">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915059">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915089">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915093">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915118">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915122">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915138">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915154">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915170">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915196">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915234">b1</span>&nbsp;<span class="op" id="3915237">=</span>&nbsp;<span class="ident" id="3915239">block</span>&nbsp;<span class="op" id="3915245">&amp;</span>&nbsp;<span class="num" id="3915247">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915267">b2</span>&nbsp;<span class="op" id="3915270">=</span>&nbsp;<span class="ident" id="3915272">block</span>&nbsp;<span class="op" id="3915278">&amp;</span>&nbsp;<span class="num" id="3915280">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915300">block</span>&nbsp;<span class="op" id="3915306">^=</span>&nbsp;<span class="ident" id="3915309">b1</span>&nbsp;<span class="op" id="3915312">^</span>&nbsp;<span class="ident" id="3915314">b2</span>&nbsp;<span class="op" id="3915317">^</span>&nbsp;<span class="ident" id="3915319">b1</span><span class="op" id="3915321">&gt;&gt;</span><span class="num" id="3915323">6</span>&nbsp;<span class="op" id="3915325">^</span>&nbsp;<span class="ident" id="3915327">b2</span><span class="op" id="3915329">&lt;&lt;</span><span class="num" id="3915331">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915335">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915365">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915375">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915385">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915395">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915405">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915415">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915425">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915435">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915464">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915502">b1</span>&nbsp;<span class="op" id="3915505">=</span>&nbsp;<span class="ident" id="3915507">block</span>&nbsp;<span class="op" id="3915513">&amp;</span>&nbsp;<span class="num" id="3915515">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915535">block</span>&nbsp;<span class="op" id="3915541">^=</span>&nbsp;<span class="ident" id="3915544">b1</span>&nbsp;<span class="op" id="3915547">^</span>&nbsp;<span class="ident" id="3915549">b1</span><span class="op" id="3915551">&gt;&gt;</span><span class="num" id="3915553">33</span>&nbsp;<span class="op" id="3915556">^</span>&nbsp;<span class="ident" id="3915558">b1</span><span class="op" id="3915560">&lt;&lt;</span><span class="num" id="3915562">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915567">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915597">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915624">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915651">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915678">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915705">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915732">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915759">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915786">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915813">return</span>&nbsp;<span class="ident" id="3915820">block</span><br>
<span class="lineno"></span><span class="op" id="3915826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3915829">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3915893">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3915917">func</span>&nbsp;<span class="ident" id="3915922">permuteFinalBlock</span><span class="op" id="3915939">(</span><span class="ident" id="3915940">block</span>&nbsp;<span class="ident" id="3915946">uint64</span><span class="op" id="3915952">)</span>&nbsp;<span class="ident" id="3915954">uint64</span>&nbsp;<span class="op" id="3915961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915964">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3916022">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916048">b1</span>&nbsp;<span class="op" id="3916051">:=</span>&nbsp;<span class="ident" id="3916054">block</span>&nbsp;<span class="op" id="3916060">&amp;</span>&nbsp;<span class="num" id="3916062">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916082">block</span>&nbsp;<span class="op" id="3916088">^=</span>&nbsp;<span class="ident" id="3916091">b1</span>&nbsp;<span class="op" id="3916094">^</span>&nbsp;<span class="ident" id="3916096">b1</span><span class="op" id="3916098">&gt;&gt;</span><span class="num" id="3916100">33</span>&nbsp;<span class="op" id="3916103">^</span>&nbsp;<span class="ident" id="3916105">b1</span><span class="op" id="3916107">&lt;&lt;</span><span class="num" id="3916109">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916114">b1</span>&nbsp;<span class="op" id="3916117">=</span>&nbsp;<span class="ident" id="3916119">block</span>&nbsp;<span class="op" id="3916125">&amp;</span>&nbsp;<span class="num" id="3916127">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916147">b2</span>&nbsp;<span class="op" id="3916150">:=</span>&nbsp;<span class="ident" id="3916153">block</span>&nbsp;<span class="op" id="3916159">&amp;</span>&nbsp;<span class="num" id="3916161">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916181">block</span>&nbsp;<span class="op" id="3916187">^=</span>&nbsp;<span class="ident" id="3916190">b1</span>&nbsp;<span class="op" id="3916193">^</span>&nbsp;<span class="ident" id="3916195">b2</span>&nbsp;<span class="op" id="3916198">^</span>&nbsp;<span class="ident" id="3916200">b1</span><span class="op" id="3916202">&gt;&gt;</span><span class="num" id="3916204">6</span>&nbsp;<span class="op" id="3916206">^</span>&nbsp;<span class="ident" id="3916208">b2</span><span class="op" id="3916210">&lt;&lt;</span><span class="num" id="3916212">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916216">b1</span>&nbsp;<span class="op" id="3916219">=</span>&nbsp;<span class="ident" id="3916221">block</span>&nbsp;<span class="op" id="3916227">&amp;</span>&nbsp;<span class="num" id="3916229">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916249">b2</span>&nbsp;<span class="op" id="3916252">=</span>&nbsp;<span class="ident" id="3916254">block</span>&nbsp;<span class="op" id="3916260">&amp;</span>&nbsp;<span class="num" id="3916262">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916282">block</span>&nbsp;<span class="op" id="3916288">^=</span>&nbsp;<span class="ident" id="3916291">b1</span>&nbsp;<span class="op" id="3916294">^</span>&nbsp;<span class="ident" id="3916296">b2</span>&nbsp;<span class="op" id="3916299">^</span>&nbsp;<span class="ident" id="3916301">b1</span><span class="op" id="3916303">&gt;&gt;</span><span class="num" id="3916305">12</span>&nbsp;<span class="op" id="3916308">^</span>&nbsp;<span class="ident" id="3916310">b2</span><span class="op" id="3916312">&lt;&lt;</span><span class="num" id="3916314">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916319">b1</span>&nbsp;<span class="op" id="3916322">=</span>&nbsp;<span class="ident" id="3916324">block</span>&nbsp;<span class="op" id="3916330">&gt;&gt;</span>&nbsp;<span class="num" id="3916333">32</span>&nbsp;<span class="op" id="3916336">&amp;</span>&nbsp;<span class="num" id="3916338">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916348">b2</span>&nbsp;<span class="op" id="3916351">=</span>&nbsp;<span class="op" id="3916353">(</span><span class="ident" id="3916354">block</span>&nbsp;<span class="op" id="3916360">&amp;</span>&nbsp;<span class="num" id="3916362">0xff00ff00</span><span class="op" id="3916372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916375">block</span>&nbsp;<span class="op" id="3916381">^=</span>&nbsp;<span class="ident" id="3916384">b1</span><span class="op" id="3916386">&lt;&lt;</span><span class="num" id="3916388">32</span>&nbsp;<span class="op" id="3916391">^</span>&nbsp;<span class="ident" id="3916393">b2</span>&nbsp;<span class="op" id="3916396">^</span>&nbsp;<span class="ident" id="3916398">b1</span><span class="op" id="3916400">&lt;&lt;</span><span class="num" id="3916402">8</span>&nbsp;<span class="op" id="3916404">^</span>&nbsp;<span class="ident" id="3916406">b2</span><span class="op" id="3916408">&lt;&lt;</span><span class="num" id="3916410">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916415">b1</span>&nbsp;<span class="op" id="3916418">=</span>&nbsp;<span class="ident" id="3916420">block</span>&nbsp;<span class="op" id="3916426">&gt;&gt;</span>&nbsp;<span class="num" id="3916429">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916433">b2</span>&nbsp;<span class="op" id="3916436">=</span>&nbsp;<span class="ident" id="3916438">block</span>&nbsp;<span class="op" id="3916444">&lt;&lt;</span>&nbsp;<span class="num" id="3916447">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916451">block</span>&nbsp;<span class="op" id="3916457">^=</span>&nbsp;<span class="ident" id="3916460">b1</span>&nbsp;<span class="op" id="3916463">^</span>&nbsp;<span class="ident" id="3916465">b2</span>&nbsp;<span class="op" id="3916468">^</span>&nbsp;<span class="ident" id="3916470">b1</span><span class="op" id="3916472">&lt;&lt;</span><span class="num" id="3916474">48</span>&nbsp;<span class="op" id="3916477">^</span>&nbsp;<span class="ident" id="3916479">b2</span><span class="op" id="3916481">&gt;&gt;</span><span class="num" id="3916483">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916487">return</span>&nbsp;<span class="ident" id="3916494">block</span><br>
<span class="lineno"></span><span class="op" id="3916500">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3916503">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="3916549">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="3916577">func</span>&nbsp;<span class="ident" id="3916582">ksRotate</span><span class="op" id="3916590">(</span><span class="ident" id="3916591">in</span>&nbsp;<span class="builtintype" id="3916594">uint32</span><span class="op" id="3916600">)</span>&nbsp;<span class="op" id="3916602">(</span><span class="ident" id="3916603">out</span>&nbsp;<span class="op" id="3916607">[</span><span class="op" id="3916608">]</span><span class="builtintype" id="3916609">uint32</span><span class="op" id="3916615">)</span>&nbsp;<span class="op" id="3916617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916620">out</span>&nbsp;<span class="op" id="3916624">=</span>&nbsp;<span class="builtinfunc" id="3916626">make</span><span class="op" id="3916630">(</span><span class="op" id="3916631">[</span><span class="op" id="3916632">]</span><span class="builtintype" id="3916633">uint32</span><span class="op" id="3916639">,</span>&nbsp;<span class="num" id="3916641">16</span><span class="op" id="3916643">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916646">last</span>&nbsp;<span class="op" id="3916651">:=</span>&nbsp;<span class="ident" id="3916654">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916658">for</span>&nbsp;<span class="ident" id="3916662">i</span>&nbsp;<span class="op" id="3916664">:=</span>&nbsp;<span class="num" id="3916667">0</span><span class="op" id="3916668">;</span>&nbsp;<span class="ident" id="3916670">i</span>&nbsp;<span class="op" id="3916672">&lt;</span>&nbsp;<span class="num" id="3916674">16</span><span class="op" id="3916676">;</span>&nbsp;<span class="ident" id="3916678">i</span><span class="op" id="3916679">++</span>&nbsp;<span class="op" id="3916682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3916686">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916718">left</span>&nbsp;<span class="op" id="3916723">:=</span>&nbsp;<span class="op" id="3916726">(</span><span class="ident" id="3916727">last</span>&nbsp;<span class="op" id="3916732">&lt;&lt;</span>&nbsp;<span class="op" id="3916735">(</span><span class="num" id="3916736">4</span>&nbsp;<span class="op" id="3916738">+</span>&nbsp;<span class="ident" id="3916740">ksRotations</span><span class="op" id="3916751">[</span><span class="ident" id="3916752">i</span><span class="op" id="3916753">]</span><span class="op" id="3916754">)</span><span class="op" id="3916755">)</span>&nbsp;<span class="op" id="3916757">&gt;&gt;</span>&nbsp;<span class="num" id="3916760">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916764">right</span>&nbsp;<span class="op" id="3916770">:=</span>&nbsp;<span class="op" id="3916773">(</span><span class="ident" id="3916774">last</span>&nbsp;<span class="op" id="3916779">&lt;&lt;</span>&nbsp;<span class="num" id="3916782">4</span><span class="op" id="3916783">)</span>&nbsp;<span class="op" id="3916785">&gt;&gt;</span>&nbsp;<span class="op" id="3916788">(</span><span class="num" id="3916789">32</span>&nbsp;<span class="op" id="3916792">-</span>&nbsp;<span class="ident" id="3916794">ksRotations</span><span class="op" id="3916805">[</span><span class="ident" id="3916806">i</span><span class="op" id="3916807">]</span><span class="op" id="3916808">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916812">out</span><span class="op" id="3916815">[</span><span class="ident" id="3916816">i</span><span class="op" id="3916817">]</span>&nbsp;<span class="op" id="3916819">=</span>&nbsp;<span class="ident" id="3916821">left</span>&nbsp;<span class="op" id="3916826">|</span>&nbsp;<span class="ident" id="3916828">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916836">last</span>&nbsp;<span class="op" id="3916841">=</span>&nbsp;<span class="ident" id="3916843">out</span><span class="op" id="3916846">[</span><span class="ident" id="3916847">i</span><span class="op" id="3916848">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916854">return</span><br>
<span class="lineno"></span><span class="op" id="3916861">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3916864">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="3916915">func</span>&nbsp;<span class="op" id="3916920">(</span><span class="ident" id="3916921">c</span>&nbsp;<span class="op" id="3916923">*</span><span class="ident" id="3916924">desCipher</span><span class="op" id="3916933">)</span>&nbsp;<span class="ident" id="3916935">generateSubkeys</span><span class="op" id="3916950">(</span><span class="ident" id="3916951">keyBytes</span>&nbsp;<span class="op" id="3916960">[</span><span class="op" id="3916961">]</span><span class="builtintype" id="3916962">byte</span><span class="op" id="3916966">)</span>&nbsp;<span class="op" id="3916968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3916971">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917004">key</span>&nbsp;<span class="op" id="3917008">:=</span>&nbsp;<span class="ident" id="3917011">binary</span><span class="op" id="3917017">.</span><span class="ident" id="3917018">BigEndian</span><span class="op" id="3917027">.</span><span class="ident" id="3917028">Uint64</span><span class="op" id="3917034">(</span><span class="ident" id="3917035">keyBytes</span><span class="op" id="3917043">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917046">permutedKey</span>&nbsp;<span class="op" id="3917058">:=</span>&nbsp;<span class="ident" id="3917061">permuteBlock</span><span class="op" id="3917073">(</span><span class="ident" id="3917074">key</span><span class="op" id="3917077">,</span>&nbsp;<span class="ident" id="3917079">permutedChoice1</span><span class="op" id="3917094">[</span><span class="op" id="3917095">:</span><span class="op" id="3917096">]</span><span class="op" id="3917097">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3917101">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917170">leftRotations</span>&nbsp;<span class="op" id="3917184">:=</span>&nbsp;<span class="ident" id="3917187">ksRotate</span><span class="op" id="3917195">(</span><span class="builtintype" id="3917196">uint32</span><span class="op" id="3917202">(</span><span class="ident" id="3917203">permutedKey</span>&nbsp;<span class="op" id="3917215">&gt;&gt;</span>&nbsp;<span class="num" id="3917218">28</span><span class="op" id="3917220">)</span><span class="op" id="3917221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917224">rightRotations</span>&nbsp;<span class="op" id="3917239">:=</span>&nbsp;<span class="ident" id="3917242">ksRotate</span><span class="op" id="3917250">(</span><span class="builtintype" id="3917251">uint32</span><span class="op" id="3917257">(</span><span class="ident" id="3917258">permutedKey</span><span class="op" id="3917269">&lt;&lt;</span><span class="num" id="3917271">4</span><span class="op" id="3917272">)</span>&nbsp;<span class="op" id="3917274">&gt;&gt;</span>&nbsp;<span class="num" id="3917277">4</span><span class="op" id="3917278">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3917282">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917303">for</span>&nbsp;<span class="ident" id="3917307">i</span>&nbsp;<span class="op" id="3917309">:=</span>&nbsp;<span class="num" id="3917312">0</span><span class="op" id="3917313">;</span>&nbsp;<span class="ident" id="3917315">i</span>&nbsp;<span class="op" id="3917317">&lt;</span>&nbsp;<span class="num" id="3917319">16</span><span class="op" id="3917321">;</span>&nbsp;<span class="ident" id="3917323">i</span><span class="op" id="3917324">++</span>&nbsp;<span class="op" id="3917327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3917331">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917379">pc2Input</span>&nbsp;<span class="op" id="3917388">:=</span>&nbsp;<span class="ident" id="3917391">uint64</span><span class="op" id="3917397">(</span><span class="ident" id="3917398">leftRotations</span><span class="op" id="3917411">[</span><span class="ident" id="3917412">i</span><span class="op" id="3917413">]</span><span class="op" id="3917414">)</span><span class="op" id="3917415">&lt;&lt;</span><span class="num" id="3917417">28</span>&nbsp;<span class="op" id="3917420">|</span>&nbsp;<span class="ident" id="3917422">uint64</span><span class="op" id="3917428">(</span><span class="ident" id="3917429">rightRotations</span><span class="op" id="3917443">[</span><span class="ident" id="3917444">i</span><span class="op" id="3917445">]</span><span class="op" id="3917446">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3917450">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917493">c</span><span class="op" id="3917494">.</span><span class="ident" id="3917495">subkeys</span><span class="op" id="3917502">[</span><span class="ident" id="3917503">i</span><span class="op" id="3917504">]</span>&nbsp;<span class="op" id="3917506">=</span>&nbsp;<span class="ident" id="3917508">permuteBlock</span><span class="op" id="3917520">(</span><span class="ident" id="3917521">pc2Input</span><span class="op" id="3917529">,</span>&nbsp;<span class="ident" id="3917531">permutedChoice2</span><span class="op" id="3917546">[</span><span class="op" id="3917547">:</span><span class="op" id="3917548">]</span><span class="op" id="3917549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917552">}</span><br>
<span class="lineno"></span><span class="op" id="3917554">}</span>
</div>
</body>
</html>
