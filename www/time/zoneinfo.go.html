<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2526638">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2526693">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2526747">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2526798">package</span>&nbsp;<span class="ident" id="2526806">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2526812">import</span>&nbsp;<span class="op" id="2526819">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2526822">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2526830">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2526840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526843">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2526909">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2526978">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2527053">type</span>&nbsp;<span class="ident" id="2527058">Location</span>&nbsp;<span class="keyword" id="2527067">struct</span>&nbsp;<span class="op" id="2527074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527077">name</span>&nbsp;<span class="builtintype" id="2527082">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527090">zone</span>&nbsp;<span class="op" id="2527095">[</span><span class="op" id="2527096">]</span><span class="ident" id="2527097">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527103">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2527108">[</span><span class="op" id="2527109">]</span><span class="ident" id="2527110">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527122">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527169">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527219">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527271">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527324">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527360">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527393">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527447">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527500">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527515">cacheStart</span>&nbsp;<span class="ident" id="2527526">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527533">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2527544">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527551">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2527562">*</span><span class="ident" id="2527563">zone</span><br>
<span class="lineno"></span><span class="op" id="2527568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2527571">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2527632">type</span>&nbsp;<span class="ident" id="2527637">zone</span>&nbsp;<span class="keyword" id="2527642">struct</span>&nbsp;<span class="op" id="2527649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527652">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2527659">string</span>&nbsp;<span class="comment" id="2527666">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527694">offset</span>&nbsp;<span class="builtintype" id="2527701">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2527708">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527732">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2527739">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2527746">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2527785">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2527788">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2527845">type</span>&nbsp;<span class="ident" id="2527850">zoneTrans</span>&nbsp;<span class="keyword" id="2527860">struct</span>&nbsp;<span class="op" id="2527867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527870">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2527883">int64</span>&nbsp;<span class="comment" id="2527889">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527936">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2527949">uint8</span>&nbsp;<span class="comment" id="2527955">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528016">isstd</span><span class="op" id="2528021">,</span>&nbsp;<span class="ident" id="2528023">isutc</span>&nbsp;<span class="builtintype" id="2528029">bool</span>&nbsp;&nbsp;<span class="comment" id="2528035">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2528072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2528075">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2528137">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2528153">const</span>&nbsp;<span class="op" id="2528159">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528162">alpha</span>&nbsp;<span class="op" id="2528168">=</span>&nbsp;<span class="op" id="2528170">-</span><span class="num" id="2528171">1</span>&nbsp;<span class="op" id="2528173">&lt;&lt;</span>&nbsp;<span class="num" id="2528176">63</span>&nbsp;&nbsp;<span class="comment" id="2528180">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528198">omega</span>&nbsp;<span class="op" id="2528204">=</span>&nbsp;<span class="num" id="2528206">1</span><span class="op" id="2528207">&lt;&lt;</span><span class="num" id="2528209">63</span>&nbsp;<span class="op" id="2528212">-</span>&nbsp;<span class="num" id="2528214">1</span>&nbsp;<span class="comment" id="2528216">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2528233">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2528236">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2528288">var</span>&nbsp;<span class="ident" id="2528292">UTC</span>&nbsp;<span class="op" id="2528296">*</span><span class="ident" id="2528297">Location</span>&nbsp;<span class="op" id="2528306">=</span>&nbsp;<span class="op" id="2528308">&amp;</span><span class="ident" id="2528309">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2528317">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2528372">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2528425">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2528476">var</span>&nbsp;<span class="ident" id="2528480">utcLoc</span>&nbsp;<span class="op" id="2528487">=</span>&nbsp;<span class="ident" id="2528489">Location</span><span class="op" id="2528497">{</span><span class="ident" id="2528498">name</span><span class="op" id="2528502">:</span>&nbsp;<span class="string" id="2528504">&#34;UTC&#34;</span><span class="op" id="2528509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2528512">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2528562">var</span>&nbsp;<span class="ident" id="2528566">Local</span>&nbsp;<span class="op" id="2528572">*</span><span class="ident" id="2528573">Location</span>&nbsp;<span class="op" id="2528582">=</span>&nbsp;<span class="op" id="2528584">&amp;</span><span class="ident" id="2528585">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2528595">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2528652">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2528694">var</span>&nbsp;<span class="ident" id="2528698">localLoc</span>&nbsp;<span class="ident" id="2528707">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2528716">var</span>&nbsp;<span class="ident" id="2528720">localOnce</span>&nbsp;<span class="ident" id="2528730">sync</span><span class="op" id="2528734">.</span><span class="ident" id="2528735">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2528741">func</span>&nbsp;<span class="op" id="2528746">(</span><span class="ident" id="2528747">l</span>&nbsp;<span class="op" id="2528749">*</span><span class="ident" id="2528750">Location</span><span class="op" id="2528758">)</span>&nbsp;<span class="ident" id="2528760">get</span><span class="op" id="2528763">(</span><span class="op" id="2528764">)</span>&nbsp;<span class="op" id="2528766">*</span><span class="ident" id="2528767">Location</span>&nbsp;<span class="op" id="2528776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528779">if</span>&nbsp;<span class="ident" id="2528782">l</span>&nbsp;<span class="op" id="2528784">==</span>&nbsp;<span class="ident" id="2528787">nil</span>&nbsp;<span class="op" id="2528791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528795">return</span>&nbsp;<span class="op" id="2528802">&amp;</span><span class="ident" id="2528803">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528811">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528814">if</span>&nbsp;<span class="ident" id="2528817">l</span>&nbsp;<span class="op" id="2528819">==</span>&nbsp;<span class="op" id="2528822">&amp;</span><span class="ident" id="2528823">localLoc</span>&nbsp;<span class="op" id="2528832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528836">localOnce</span><span class="op" id="2528845">.</span><span class="ident" id="2528846">Do</span><span class="op" id="2528848">(</span><span class="ident" id="2528849">initLocal</span><span class="op" id="2528858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528864">return</span>&nbsp;<span class="ident" id="2528871">l</span><br>
<span class="lineno"></span><span class="op" id="2528873">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2528876">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2528944">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2528994">func</span>&nbsp;<span class="op" id="2528999">(</span><span class="ident" id="2529000">l</span>&nbsp;<span class="op" id="2529002">*</span><span class="ident" id="2529003">Location</span><span class="op" id="2529011">)</span>&nbsp;<span class="ident" id="2529013">String</span><span class="op" id="2529019">(</span><span class="op" id="2529020">)</span>&nbsp;<span class="builtintype" id="2529022">string</span>&nbsp;<span class="op" id="2529029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529032">return</span>&nbsp;<span class="ident" id="2529039">l</span><span class="op" id="2529040">.</span><span class="ident" id="2529041">get</span><span class="op" id="2529044">(</span><span class="op" id="2529045">)</span><span class="op" id="2529046">.</span><span class="ident" id="2529047">name</span><br>
<span class="lineno">85</span><span class="op" id="2529052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2529055">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2529104">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2529161">func</span>&nbsp;<span class="ident" id="2529166">FixedZone</span><span class="op" id="2529175">(</span><span class="ident" id="2529176">name</span>&nbsp;<span class="builtintype" id="2529181">string</span><span class="op" id="2529187">,</span>&nbsp;<span class="ident" id="2529189">offset</span>&nbsp;<span class="builtintype" id="2529196">int</span><span class="op" id="2529199">)</span>&nbsp;<span class="op" id="2529201">*</span><span class="ident" id="2529202">Location</span>&nbsp;<span class="op" id="2529211">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529214">l</span>&nbsp;<span class="op" id="2529216">:=</span>&nbsp;<span class="op" id="2529219">&amp;</span><span class="ident" id="2529220">Location</span><span class="op" id="2529228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529232">name</span><span class="op" id="2529236">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2529244">name</span><span class="op" id="2529248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529252">zone</span><span class="op" id="2529256">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2529264">[</span><span class="op" id="2529265">]</span><span class="ident" id="2529266">zone</span><span class="op" id="2529270">{</span><span class="op" id="2529271">{</span><span class="ident" id="2529272">name</span><span class="op" id="2529276">,</span>&nbsp;<span class="ident" id="2529278">offset</span><span class="op" id="2529284">,</span>&nbsp;<span class="ident" id="2529286">false</span><span class="op" id="2529291">}</span><span class="op" id="2529292">}</span><span class="op" id="2529293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529297">tx</span><span class="op" id="2529299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2529309">[</span><span class="op" id="2529310">]</span><span class="ident" id="2529311">zoneTrans</span><span class="op" id="2529320">{</span><span class="op" id="2529321">{</span><span class="ident" id="2529322">alpha</span><span class="op" id="2529327">,</span>&nbsp;<span class="num" id="2529329">0</span><span class="op" id="2529330">,</span>&nbsp;<span class="ident" id="2529332">false</span><span class="op" id="2529337">,</span>&nbsp;<span class="ident" id="2529339">false</span><span class="op" id="2529344">}</span><span class="op" id="2529345">}</span><span class="op" id="2529346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529350">cacheStart</span><span class="op" id="2529360">:</span>&nbsp;<span class="ident" id="2529362">alpha</span><span class="op" id="2529367">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529371">cacheEnd</span><span class="op" id="2529379">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2529383">omega</span><span class="op" id="2529388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529394">l</span><span class="op" id="2529395">.</span><span class="ident" id="2529396">cacheZone</span>&nbsp;<span class="op" id="2529406">=</span>&nbsp;<span class="op" id="2529408">&amp;</span><span class="ident" id="2529409">l</span><span class="op" id="2529410">.</span><span class="ident" id="2529411">zone</span><span class="op" id="2529415">[</span><span class="num" id="2529416">0</span><span class="op" id="2529417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529420">return</span>&nbsp;<span class="ident" id="2529427">l</span><br>
<span class="lineno"></span><span class="op" id="2529429">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2529432">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2529495">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2529571">//</span><br>
<span class="lineno"></span><span class="comment" id="2529574">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2529646">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2529717">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2529786">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2529842">func</span>&nbsp;<span class="op" id="2529847">(</span><span class="ident" id="2529848">l</span>&nbsp;<span class="op" id="2529850">*</span><span class="ident" id="2529851">Location</span><span class="op" id="2529859">)</span>&nbsp;<span class="ident" id="2529861">lookup</span><span class="op" id="2529867">(</span><span class="ident" id="2529868">sec</span>&nbsp;<span class="ident" id="2529872">int64</span><span class="op" id="2529877">)</span>&nbsp;<span class="op" id="2529879">(</span><span class="ident" id="2529880">name</span>&nbsp;<span class="builtintype" id="2529885">string</span><span class="op" id="2529891">,</span>&nbsp;<span class="ident" id="2529893">offset</span>&nbsp;<span class="builtintype" id="2529900">int</span><span class="op" id="2529903">,</span>&nbsp;<span class="ident" id="2529905">isDST</span>&nbsp;<span class="builtintype" id="2529911">bool</span><span class="op" id="2529915">,</span>&nbsp;<span class="ident" id="2529917">start</span><span class="op" id="2529922">,</span>&nbsp;<span class="ident" id="2529924">end</span>&nbsp;<span class="ident" id="2529928">int64</span><span class="op" id="2529933">)</span>&nbsp;<span class="op" id="2529935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529938">l</span>&nbsp;<span class="op" id="2529940">=</span>&nbsp;<span class="ident" id="2529942">l</span><span class="op" id="2529943">.</span><span class="ident" id="2529944">get</span><span class="op" id="2529947">(</span><span class="op" id="2529948">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529952">if</span>&nbsp;<span class="builtinfunc" id="2529955">len</span><span class="op" id="2529958">(</span><span class="ident" id="2529959">l</span><span class="op" id="2529960">.</span><span class="ident" id="2529961">zone</span><span class="op" id="2529965">)</span>&nbsp;<span class="op" id="2529967">==</span>&nbsp;<span class="num" id="2529970">0</span>&nbsp;<span class="op" id="2529972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529976">name</span>&nbsp;<span class="op" id="2529981">=</span>&nbsp;<span class="string" id="2529983">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529991">offset</span>&nbsp;<span class="op" id="2529998">=</span>&nbsp;<span class="num" id="2530000">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530004">isDST</span>&nbsp;<span class="op" id="2530010">=</span>&nbsp;<span class="ident" id="2530012">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530020">start</span>&nbsp;<span class="op" id="2530026">=</span>&nbsp;<span class="ident" id="2530028">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530036">end</span>&nbsp;<span class="op" id="2530040">=</span>&nbsp;<span class="ident" id="2530042">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530050">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530062">if</span>&nbsp;<span class="ident" id="2530065">zone</span>&nbsp;<span class="op" id="2530070">:=</span>&nbsp;<span class="ident" id="2530073">l</span><span class="op" id="2530074">.</span><span class="ident" id="2530075">cacheZone</span><span class="op" id="2530084">;</span>&nbsp;<span class="ident" id="2530086">zone</span>&nbsp;<span class="op" id="2530091">!=</span>&nbsp;<span class="ident" id="2530094">nil</span>&nbsp;<span class="op" id="2530098">&amp;&amp;</span>&nbsp;<span class="ident" id="2530101">l</span><span class="op" id="2530102">.</span><span class="ident" id="2530103">cacheStart</span>&nbsp;<span class="op" id="2530114">&lt;=</span>&nbsp;<span class="ident" id="2530117">sec</span>&nbsp;<span class="op" id="2530121">&amp;&amp;</span>&nbsp;<span class="ident" id="2530124">sec</span>&nbsp;<span class="op" id="2530128">&lt;</span>&nbsp;<span class="ident" id="2530130">l</span><span class="op" id="2530131">.</span><span class="ident" id="2530132">cacheEnd</span>&nbsp;<span class="op" id="2530141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530145">name</span>&nbsp;<span class="op" id="2530150">=</span>&nbsp;<span class="ident" id="2530152">zone</span><span class="op" id="2530156">.</span><span class="ident" id="2530157">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530164">offset</span>&nbsp;<span class="op" id="2530171">=</span>&nbsp;<span class="ident" id="2530173">zone</span><span class="op" id="2530177">.</span><span class="ident" id="2530178">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530187">isDST</span>&nbsp;<span class="op" id="2530193">=</span>&nbsp;<span class="ident" id="2530195">zone</span><span class="op" id="2530199">.</span><span class="ident" id="2530200">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530208">start</span>&nbsp;<span class="op" id="2530214">=</span>&nbsp;<span class="ident" id="2530216">l</span><span class="op" id="2530217">.</span><span class="ident" id="2530218">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530231">end</span>&nbsp;<span class="op" id="2530235">=</span>&nbsp;<span class="ident" id="2530237">l</span><span class="op" id="2530238">.</span><span class="ident" id="2530239">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530250">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530262">if</span>&nbsp;<span class="builtinfunc" id="2530265">len</span><span class="op" id="2530268">(</span><span class="ident" id="2530269">l</span><span class="op" id="2530270">.</span><span class="ident" id="2530271">tx</span><span class="op" id="2530273">)</span>&nbsp;<span class="op" id="2530275">==</span>&nbsp;<span class="num" id="2530278">0</span>&nbsp;<span class="op" id="2530280">||</span>&nbsp;<span class="ident" id="2530283">sec</span>&nbsp;<span class="op" id="2530287">&lt;</span>&nbsp;<span class="ident" id="2530289">l</span><span class="op" id="2530290">.</span><span class="ident" id="2530291">tx</span><span class="op" id="2530293">[</span><span class="num" id="2530294">0</span><span class="op" id="2530295">]</span><span class="op" id="2530296">.</span><span class="ident" id="2530297">when</span>&nbsp;<span class="op" id="2530302">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530306">zone</span>&nbsp;<span class="op" id="2530311">:=</span>&nbsp;<span class="op" id="2530314">&amp;</span><span class="ident" id="2530315">l</span><span class="op" id="2530316">.</span><span class="ident" id="2530317">zone</span><span class="op" id="2530321">[</span><span class="ident" id="2530322">l</span><span class="op" id="2530323">.</span><span class="ident" id="2530324">lookupFirstZone</span><span class="op" id="2530339">(</span><span class="op" id="2530340">)</span><span class="op" id="2530341">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530345">name</span>&nbsp;<span class="op" id="2530350">=</span>&nbsp;<span class="ident" id="2530352">zone</span><span class="op" id="2530356">.</span><span class="ident" id="2530357">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530364">offset</span>&nbsp;<span class="op" id="2530371">=</span>&nbsp;<span class="ident" id="2530373">zone</span><span class="op" id="2530377">.</span><span class="ident" id="2530378">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530387">isDST</span>&nbsp;<span class="op" id="2530393">=</span>&nbsp;<span class="ident" id="2530395">zone</span><span class="op" id="2530399">.</span><span class="ident" id="2530400">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530408">start</span>&nbsp;<span class="op" id="2530414">=</span>&nbsp;<span class="ident" id="2530416">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530424">if</span>&nbsp;<span class="builtinfunc" id="2530427">len</span><span class="op" id="2530430">(</span><span class="ident" id="2530431">l</span><span class="op" id="2530432">.</span><span class="ident" id="2530433">tx</span><span class="op" id="2530435">)</span>&nbsp;<span class="op" id="2530437">&gt;</span>&nbsp;<span class="num" id="2530439">0</span>&nbsp;<span class="op" id="2530441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530446">end</span>&nbsp;<span class="op" id="2530450">=</span>&nbsp;<span class="ident" id="2530452">l</span><span class="op" id="2530453">.</span><span class="ident" id="2530454">tx</span><span class="op" id="2530456">[</span><span class="num" id="2530457">0</span><span class="op" id="2530458">]</span><span class="op" id="2530459">.</span><span class="ident" id="2530460">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530467">}</span>&nbsp;<span class="keyword" id="2530469">else</span>&nbsp;<span class="op" id="2530474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530479">end</span>&nbsp;<span class="op" id="2530483">=</span>&nbsp;<span class="ident" id="2530485">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530493">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530497">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530509">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530563">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530612">tx</span>&nbsp;<span class="op" id="2530615">:=</span>&nbsp;<span class="ident" id="2530618">l</span><span class="op" id="2530619">.</span><span class="ident" id="2530620">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530624">end</span>&nbsp;<span class="op" id="2530628">=</span>&nbsp;<span class="ident" id="2530630">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530637">lo</span>&nbsp;<span class="op" id="2530640">:=</span>&nbsp;<span class="num" id="2530643">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530646">hi</span>&nbsp;<span class="op" id="2530649">:=</span>&nbsp;<span class="builtinfunc" id="2530652">len</span><span class="op" id="2530655">(</span><span class="ident" id="2530656">tx</span><span class="op" id="2530658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530661">for</span>&nbsp;<span class="ident" id="2530665">hi</span><span class="op" id="2530667">-</span><span class="ident" id="2530668">lo</span>&nbsp;<span class="op" id="2530671">&gt;</span>&nbsp;<span class="num" id="2530673">1</span>&nbsp;<span class="op" id="2530675">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530679">m</span>&nbsp;<span class="op" id="2530681">:=</span>&nbsp;<span class="ident" id="2530684">lo</span>&nbsp;<span class="op" id="2530687">+</span>&nbsp;<span class="op" id="2530689">(</span><span class="ident" id="2530690">hi</span><span class="op" id="2530692">-</span><span class="ident" id="2530693">lo</span><span class="op" id="2530695">)</span><span class="op" id="2530696">/</span><span class="num" id="2530697">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530701">lim</span>&nbsp;<span class="op" id="2530705">:=</span>&nbsp;<span class="ident" id="2530708">tx</span><span class="op" id="2530710">[</span><span class="ident" id="2530711">m</span><span class="op" id="2530712">]</span><span class="op" id="2530713">.</span><span class="ident" id="2530714">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530721">if</span>&nbsp;<span class="ident" id="2530724">sec</span>&nbsp;<span class="op" id="2530728">&lt;</span>&nbsp;<span class="ident" id="2530730">lim</span>&nbsp;<span class="op" id="2530734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530739">end</span>&nbsp;<span class="op" id="2530743">=</span>&nbsp;<span class="ident" id="2530745">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530752">hi</span>&nbsp;<span class="op" id="2530755">=</span>&nbsp;<span class="ident" id="2530757">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530761">}</span>&nbsp;<span class="keyword" id="2530763">else</span>&nbsp;<span class="op" id="2530768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530773">lo</span>&nbsp;<span class="op" id="2530776">=</span>&nbsp;<span class="ident" id="2530778">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530788">zone</span>&nbsp;<span class="op" id="2530793">:=</span>&nbsp;<span class="op" id="2530796">&amp;</span><span class="ident" id="2530797">l</span><span class="op" id="2530798">.</span><span class="ident" id="2530799">zone</span><span class="op" id="2530803">[</span><span class="ident" id="2530804">tx</span><span class="op" id="2530806">[</span><span class="ident" id="2530807">lo</span><span class="op" id="2530809">]</span><span class="op" id="2530810">.</span><span class="ident" id="2530811">index</span><span class="op" id="2530816">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530819">name</span>&nbsp;<span class="op" id="2530824">=</span>&nbsp;<span class="ident" id="2530826">zone</span><span class="op" id="2530830">.</span><span class="ident" id="2530831">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530837">offset</span>&nbsp;<span class="op" id="2530844">=</span>&nbsp;<span class="ident" id="2530846">zone</span><span class="op" id="2530850">.</span><span class="ident" id="2530851">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530859">isDST</span>&nbsp;<span class="op" id="2530865">=</span>&nbsp;<span class="ident" id="2530867">zone</span><span class="op" id="2530871">.</span><span class="ident" id="2530872">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530879">start</span>&nbsp;<span class="op" id="2530885">=</span>&nbsp;<span class="ident" id="2530887">tx</span><span class="op" id="2530889">[</span><span class="ident" id="2530890">lo</span><span class="op" id="2530892">]</span><span class="op" id="2530893">.</span><span class="ident" id="2530894">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530900">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530939">return</span><br>
<span class="lineno"></span><span class="op" id="2530946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2530949">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2531020">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2531089">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2531099">//</span><br>
<span class="lineno"></span><span class="comment" id="2531102">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2531154">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2531227">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2531282">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2531344">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2531406">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2531469">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2531541">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2531553">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2531619">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2531639">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2531676">func</span>&nbsp;<span class="op" id="2531681">(</span><span class="ident" id="2531682">l</span>&nbsp;<span class="op" id="2531684">*</span><span class="ident" id="2531685">Location</span><span class="op" id="2531693">)</span>&nbsp;<span class="ident" id="2531695">lookupFirstZone</span><span class="op" id="2531710">(</span><span class="op" id="2531711">)</span>&nbsp;<span class="builtintype" id="2531713">int</span>&nbsp;<span class="op" id="2531717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531720">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531732">if</span>&nbsp;<span class="op" id="2531735">!</span><span class="ident" id="2531736">l</span><span class="op" id="2531737">.</span><span class="ident" id="2531738">firstZoneUsed</span><span class="op" id="2531751">(</span><span class="op" id="2531752">)</span>&nbsp;<span class="op" id="2531754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531758">return</span>&nbsp;<span class="num" id="2531765">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531772">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531784">if</span>&nbsp;<span class="builtinfunc" id="2531787">len</span><span class="op" id="2531790">(</span><span class="ident" id="2531791">l</span><span class="op" id="2531792">.</span><span class="ident" id="2531793">tx</span><span class="op" id="2531795">)</span>&nbsp;<span class="op" id="2531797">&gt;</span>&nbsp;<span class="num" id="2531799">0</span>&nbsp;<span class="op" id="2531801">&amp;&amp;</span>&nbsp;<span class="ident" id="2531804">l</span><span class="op" id="2531805">.</span><span class="ident" id="2531806">zone</span><span class="op" id="2531810">[</span><span class="ident" id="2531811">l</span><span class="op" id="2531812">.</span><span class="ident" id="2531813">tx</span><span class="op" id="2531815">[</span><span class="num" id="2531816">0</span><span class="op" id="2531817">]</span><span class="op" id="2531818">.</span><span class="ident" id="2531819">index</span><span class="op" id="2531824">]</span><span class="op" id="2531825">.</span><span class="ident" id="2531826">isDST</span>&nbsp;<span class="op" id="2531832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531836">for</span>&nbsp;<span class="ident" id="2531840">zi</span>&nbsp;<span class="op" id="2531843">:=</span>&nbsp;<span class="builtintype" id="2531846">int</span><span class="op" id="2531849">(</span><span class="ident" id="2531850">l</span><span class="op" id="2531851">.</span><span class="ident" id="2531852">tx</span><span class="op" id="2531854">[</span><span class="num" id="2531855">0</span><span class="op" id="2531856">]</span><span class="op" id="2531857">.</span><span class="ident" id="2531858">index</span><span class="op" id="2531863">)</span>&nbsp;<span class="op" id="2531865">-</span>&nbsp;<span class="num" id="2531867">1</span><span class="op" id="2531868">;</span>&nbsp;<span class="ident" id="2531870">zi</span>&nbsp;<span class="op" id="2531873">&gt;=</span>&nbsp;<span class="num" id="2531876">0</span><span class="op" id="2531877">;</span>&nbsp;<span class="ident" id="2531879">zi</span><span class="op" id="2531881">--</span>&nbsp;<span class="op" id="2531884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531889">if</span>&nbsp;<span class="op" id="2531892">!</span><span class="ident" id="2531893">l</span><span class="op" id="2531894">.</span><span class="ident" id="2531895">zone</span><span class="op" id="2531899">[</span><span class="ident" id="2531900">zi</span><span class="op" id="2531902">]</span><span class="op" id="2531903">.</span><span class="ident" id="2531904">isDST</span>&nbsp;<span class="op" id="2531910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531916">return</span>&nbsp;<span class="ident" id="2531923">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531929">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531940">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531952">for</span>&nbsp;<span class="ident" id="2531956">zi</span>&nbsp;<span class="op" id="2531959">:=</span>&nbsp;<span class="keyword" id="2531962">range</span>&nbsp;<span class="ident" id="2531968">l</span><span class="op" id="2531969">.</span><span class="ident" id="2531970">zone</span>&nbsp;<span class="op" id="2531975">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531979">if</span>&nbsp;<span class="op" id="2531982">!</span><span class="ident" id="2531983">l</span><span class="op" id="2531984">.</span><span class="ident" id="2531985">zone</span><span class="op" id="2531989">[</span><span class="ident" id="2531990">zi</span><span class="op" id="2531992">]</span><span class="op" id="2531993">.</span><span class="ident" id="2531994">isDST</span>&nbsp;<span class="op" id="2532000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532005">return</span>&nbsp;<span class="ident" id="2532012">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532024">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532036">return</span>&nbsp;<span class="num" id="2532043">0</span><br>
<span class="lineno"></span><span class="op" id="2532045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532048">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2532112">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2532127">func</span>&nbsp;<span class="op" id="2532132">(</span><span class="ident" id="2532133">l</span>&nbsp;<span class="op" id="2532135">*</span><span class="ident" id="2532136">Location</span><span class="op" id="2532144">)</span>&nbsp;<span class="ident" id="2532146">firstZoneUsed</span><span class="op" id="2532159">(</span><span class="op" id="2532160">)</span>&nbsp;<span class="builtintype" id="2532162">bool</span>&nbsp;<span class="op" id="2532167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532170">for</span>&nbsp;<span class="ident" id="2532174">_</span><span class="op" id="2532175">,</span>&nbsp;<span class="ident" id="2532177">tx</span>&nbsp;<span class="op" id="2532180">:=</span>&nbsp;<span class="keyword" id="2532183">range</span>&nbsp;<span class="ident" id="2532189">l</span><span class="op" id="2532190">.</span><span class="ident" id="2532191">tx</span>&nbsp;<span class="op" id="2532194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532198">if</span>&nbsp;<span class="ident" id="2532201">tx</span><span class="op" id="2532203">.</span><span class="ident" id="2532204">index</span>&nbsp;<span class="op" id="2532210">==</span>&nbsp;<span class="num" id="2532213">0</span>&nbsp;<span class="op" id="2532215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532220">return</span>&nbsp;<span class="ident" id="2532227">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532240">return</span>&nbsp;<span class="ident" id="2532247">false</span><br>
<span class="lineno"></span><span class="op" id="2532253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2532256">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2532315">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2532379">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2532428">func</span>&nbsp;<span class="op" id="2532433">(</span><span class="ident" id="2532434">l</span>&nbsp;<span class="op" id="2532436">*</span><span class="ident" id="2532437">Location</span><span class="op" id="2532445">)</span>&nbsp;<span class="ident" id="2532447">lookupName</span><span class="op" id="2532457">(</span><span class="ident" id="2532458">name</span>&nbsp;<span class="builtintype" id="2532463">string</span><span class="op" id="2532469">,</span>&nbsp;<span class="ident" id="2532471">unix</span>&nbsp;<span class="ident" id="2532476">int64</span><span class="op" id="2532481">)</span>&nbsp;<span class="op" id="2532483">(</span><span class="ident" id="2532484">offset</span>&nbsp;<span class="builtintype" id="2532491">int</span><span class="op" id="2532494">,</span>&nbsp;<span class="ident" id="2532496">isDST</span>&nbsp;<span class="builtintype" id="2532502">bool</span><span class="op" id="2532506">,</span>&nbsp;<span class="ident" id="2532508">ok</span>&nbsp;<span class="builtintype" id="2532511">bool</span><span class="op" id="2532515">)</span>&nbsp;<span class="op" id="2532517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532520">l</span>&nbsp;<span class="op" id="2532522">=</span>&nbsp;<span class="ident" id="2532524">l</span><span class="op" id="2532525">.</span><span class="ident" id="2532526">get</span><span class="op" id="2532529">(</span><span class="op" id="2532530">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532534">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532597">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532667">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532730">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532789">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532856">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532873">for</span>&nbsp;<span class="ident" id="2532877">i</span>&nbsp;<span class="op" id="2532879">:=</span>&nbsp;<span class="keyword" id="2532882">range</span>&nbsp;<span class="ident" id="2532888">l</span><span class="op" id="2532889">.</span><span class="ident" id="2532890">zone</span>&nbsp;<span class="op" id="2532895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532899">zone</span>&nbsp;<span class="op" id="2532904">:=</span>&nbsp;<span class="op" id="2532907">&amp;</span><span class="ident" id="2532908">l</span><span class="op" id="2532909">.</span><span class="ident" id="2532910">zone</span><span class="op" id="2532914">[</span><span class="ident" id="2532915">i</span><span class="op" id="2532916">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532920">if</span>&nbsp;<span class="ident" id="2532923">zone</span><span class="op" id="2532927">.</span><span class="ident" id="2532928">name</span>&nbsp;<span class="op" id="2532933">==</span>&nbsp;<span class="ident" id="2532936">name</span>&nbsp;<span class="op" id="2532941">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532946">nam</span><span class="op" id="2532949">,</span>&nbsp;<span class="ident" id="2532951">offset</span><span class="op" id="2532957">,</span>&nbsp;<span class="ident" id="2532959">isDST</span><span class="op" id="2532964">,</span>&nbsp;<span class="ident" id="2532966">_</span><span class="op" id="2532967">,</span>&nbsp;<span class="ident" id="2532969">_</span>&nbsp;<span class="op" id="2532971">:=</span>&nbsp;<span class="ident" id="2532974">l</span><span class="op" id="2532975">.</span><span class="ident" id="2532976">lookup</span><span class="op" id="2532982">(</span><span class="ident" id="2532983">unix</span>&nbsp;<span class="op" id="2532988">-</span>&nbsp;<span class="ident" id="2532990">int64</span><span class="op" id="2532995">(</span><span class="ident" id="2532996">zone</span><span class="op" id="2533000">.</span><span class="ident" id="2533001">offset</span><span class="op" id="2533007">)</span><span class="op" id="2533008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533013">if</span>&nbsp;<span class="ident" id="2533016">nam</span>&nbsp;<span class="op" id="2533020">==</span>&nbsp;<span class="ident" id="2533023">zone</span><span class="op" id="2533027">.</span><span class="ident" id="2533028">name</span>&nbsp;<span class="op" id="2533033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533039">return</span>&nbsp;<span class="ident" id="2533046">offset</span><span class="op" id="2533052">,</span>&nbsp;<span class="ident" id="2533054">isDST</span><span class="op" id="2533059">,</span>&nbsp;<span class="ident" id="2533061">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533073">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533080">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533131">for</span>&nbsp;<span class="ident" id="2533135">i</span>&nbsp;<span class="op" id="2533137">:=</span>&nbsp;<span class="keyword" id="2533140">range</span>&nbsp;<span class="ident" id="2533146">l</span><span class="op" id="2533147">.</span><span class="ident" id="2533148">zone</span>&nbsp;<span class="op" id="2533153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533157">zone</span>&nbsp;<span class="op" id="2533162">:=</span>&nbsp;<span class="op" id="2533165">&amp;</span><span class="ident" id="2533166">l</span><span class="op" id="2533167">.</span><span class="ident" id="2533168">zone</span><span class="op" id="2533172">[</span><span class="ident" id="2533173">i</span><span class="op" id="2533174">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533178">if</span>&nbsp;<span class="ident" id="2533181">zone</span><span class="op" id="2533185">.</span><span class="ident" id="2533186">name</span>&nbsp;<span class="op" id="2533191">==</span>&nbsp;<span class="ident" id="2533194">name</span>&nbsp;<span class="op" id="2533199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533204">return</span>&nbsp;<span class="ident" id="2533211">zone</span><span class="op" id="2533215">.</span><span class="ident" id="2533216">offset</span><span class="op" id="2533222">,</span>&nbsp;<span class="ident" id="2533224">zone</span><span class="op" id="2533228">.</span><span class="ident" id="2533229">isDST</span><span class="op" id="2533234">,</span>&nbsp;<span class="ident" id="2533236">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533250">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533274">return</span><br>
<span class="lineno"></span><span class="op" id="2533281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533284">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2533357">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2533418">var</span>&nbsp;<span class="ident" id="2533422">zoneinfo</span><span class="op" id="2533430">,</span>&nbsp;<span class="ident" id="2533432">_</span>&nbsp;<span class="op" id="2533434">=</span>&nbsp;<span class="ident" id="2533436">syscall</span><span class="op" id="2533443">.</span><span class="ident" id="2533444">Getenv</span><span class="op" id="2533450">(</span><span class="string" id="2533451">&#34;ZONEINFO&#34;</span><span class="op" id="2533461">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533464">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2533522">//</span><br>
<span class="lineno"></span><span class="comment" id="2533525">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2533582">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2533637">//</span><br>
<span class="lineno"></span><span class="comment" id="2533640">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2533718">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2533781">//</span><br>
<span class="lineno"></span><span class="comment" id="2533784">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2533844">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2533900">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2533964">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2534033">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2534082">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2534137">func</span>&nbsp;<span class="ident" id="2534142">LoadLocation</span><span class="op" id="2534154">(</span><span class="ident" id="2534155">name</span>&nbsp;<span class="builtintype" id="2534160">string</span><span class="op" id="2534166">)</span>&nbsp;<span class="op" id="2534168">(</span><span class="op" id="2534169">*</span><span class="ident" id="2534170">Location</span><span class="op" id="2534178">,</span>&nbsp;<span class="builtintype" id="2534180">error</span><span class="op" id="2534185">)</span>&nbsp;<span class="op" id="2534187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534190">if</span>&nbsp;<span class="ident" id="2534193">name</span>&nbsp;<span class="op" id="2534198">==</span>&nbsp;<span class="string" id="2534201">&#34;&#34;</span>&nbsp;<span class="op" id="2534204">||</span>&nbsp;<span class="ident" id="2534207">name</span>&nbsp;<span class="op" id="2534212">==</span>&nbsp;<span class="string" id="2534215">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2534221">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534225">return</span>&nbsp;<span class="ident" id="2534232">UTC</span><span class="op" id="2534235">,</span>&nbsp;<span class="ident" id="2534237">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534245">if</span>&nbsp;<span class="ident" id="2534248">name</span>&nbsp;<span class="op" id="2534253">==</span>&nbsp;<span class="string" id="2534256">&#34;Local&#34;</span>&nbsp;<span class="op" id="2534264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534268">return</span>&nbsp;<span class="ident" id="2534275">Local</span><span class="op" id="2534280">,</span>&nbsp;<span class="ident" id="2534282">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534287">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534290">if</span>&nbsp;<span class="ident" id="2534293">zoneinfo</span>&nbsp;<span class="op" id="2534302">!=</span>&nbsp;<span class="string" id="2534305">&#34;&#34;</span>&nbsp;<span class="op" id="2534308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534312">if</span>&nbsp;<span class="ident" id="2534315">z</span><span class="op" id="2534316">,</span>&nbsp;<span class="ident" id="2534318">err</span>&nbsp;<span class="op" id="2534322">:=</span>&nbsp;<span class="ident" id="2534325">loadZoneFile</span><span class="op" id="2534337">(</span><span class="ident" id="2534338">zoneinfo</span><span class="op" id="2534346">,</span>&nbsp;<span class="ident" id="2534348">name</span><span class="op" id="2534352">)</span><span class="op" id="2534353">;</span>&nbsp;<span class="ident" id="2534355">err</span>&nbsp;<span class="op" id="2534359">==</span>&nbsp;<span class="ident" id="2534362">nil</span>&nbsp;<span class="op" id="2534366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534371">z</span><span class="op" id="2534372">.</span><span class="ident" id="2534373">name</span>&nbsp;<span class="op" id="2534378">=</span>&nbsp;<span class="ident" id="2534380">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534388">return</span>&nbsp;<span class="ident" id="2534395">z</span><span class="op" id="2534396">,</span>&nbsp;<span class="ident" id="2534398">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534404">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534410">return</span>&nbsp;<span class="ident" id="2534417">loadLocation</span><span class="op" id="2534429">(</span><span class="ident" id="2534430">name</span><span class="op" id="2534434">)</span><br>
<span class="lineno"></span><span class="op" id="2534436">}</span>
</div>
</body>
</html>
