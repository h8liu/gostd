<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4280088">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4280143">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4280197">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4280248">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4280307">package</span>&nbsp;<span class="ident" id="4280315">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4280323">import</span>&nbsp;<span class="op" id="4280330">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4280333">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4280341">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4280347">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4280357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4280360">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="4280440">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4280452">type</span>&nbsp;<span class="ident" id="4280457">Hash</span>&nbsp;<span class="builtintype" id="4280462">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4280468">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4280546">func</span>&nbsp;<span class="op" id="4280551">(</span><span class="ident" id="4280552">h</span>&nbsp;<span class="ident" id="4280554"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><span class="op" id="4280558">)</span>&nbsp;<span class="ident" id="4280560">HashFunc</span><span class="op" id="4280568">(</span><span class="op" id="4280569">)</span>&nbsp;<span class="ident" id="4280571"><a href="/crypto/crypto.go.html#4280457">Hash</a></span>&nbsp;<span class="op" id="4280576">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280579">return</span>&nbsp;<span class="ident" id="4280586"><a href="/crypto/crypto.go.html#4280552">h</a></span><br>
<span class="lineno"></span><span class="op" id="4280588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4280591">const</span>&nbsp;<span class="op" id="4280597">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280600">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4280610"><a href="/crypto/crypto.go.html#4280457">Hash</a></span>&nbsp;<span class="op" id="4280615">=</span>&nbsp;<span class="num" id="4280617">1</span>&nbsp;<span class="op" id="4280619">+</span>&nbsp;<span class="ident" id="4280621">iota</span>&nbsp;<span class="comment" id="4280626">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280661">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280687">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280709">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280735">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280758">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280784">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280809">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280835">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280860">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280886">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280911">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280937">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280962">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4280988">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281037">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4281063">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281104">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4281130">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281166">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4281192">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281228">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4281254">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281290">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4281316">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281352">maxHash</span><br>
<span class="lineno"></span><span class="op" id="4281360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4281363">var</span>&nbsp;<span class="ident" id="4281367">digestSizes</span>&nbsp;<span class="op" id="4281379">=</span>&nbsp;<span class="op" id="4281381">[</span><span class="op" id="4281382">]</span><span class="builtintype" id="4281383">uint8</span><span class="op" id="4281388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281391"><a href="/crypto/crypto.go.html#4280600">MD4</a></span><span class="op" id="4281394">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281402">16</span><span class="op" id="4281404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281407"><a href="/crypto/crypto.go.html#4280661">MD5</a></span><span class="op" id="4281410">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281418">16</span><span class="op" id="4281420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281423"><a href="/crypto/crypto.go.html#4280709">SHA1</a></span><span class="op" id="4281427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281434">20</span><span class="op" id="4281436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281439"><a href="/crypto/crypto.go.html#4280758">SHA224</a></span><span class="op" id="4281445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281450">28</span><span class="op" id="4281452">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281455"><a href="/crypto/crypto.go.html#4280809">SHA256</a></span><span class="op" id="4281461">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281466">32</span><span class="op" id="4281468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281471"><a href="/crypto/crypto.go.html#4280860">SHA384</a></span><span class="op" id="4281477">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281482">48</span><span class="op" id="4281484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281487"><a href="/crypto/crypto.go.html#4280911">SHA512</a></span><span class="op" id="4281493">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4281498">64</span><span class="op" id="4281500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281503"><a href="/crypto/crypto.go.html#4281104">SHA3_224</a></span><span class="op" id="4281511">:</span>&nbsp;&nbsp;<span class="num" id="4281514">28</span><span class="op" id="4281516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281519"><a href="/crypto/crypto.go.html#4281166">SHA3_256</a></span><span class="op" id="4281527">:</span>&nbsp;&nbsp;<span class="num" id="4281530">32</span><span class="op" id="4281532">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281535"><a href="/crypto/crypto.go.html#4281228">SHA3_384</a></span><span class="op" id="4281543">:</span>&nbsp;&nbsp;<span class="num" id="4281546">48</span><span class="op" id="4281548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281551"><a href="/crypto/crypto.go.html#4281290">SHA3_512</a></span><span class="op" id="4281559">:</span>&nbsp;&nbsp;<span class="num" id="4281562">64</span><span class="op" id="4281564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281567"><a href="/crypto/crypto.go.html#4280962">MD5SHA1</a></span><span class="op" id="4281574">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4281578">36</span><span class="op" id="4281580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281583"><a href="/crypto/crypto.go.html#4281037">RIPEMD160</a></span><span class="op" id="4281592">:</span>&nbsp;<span class="num" id="4281594">20</span><span class="op" id="4281596">,</span><br>
<span class="lineno"></span><span class="op" id="4281598">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4281601">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4281681">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="4281758">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="4281779">func</span>&nbsp;<span class="op" id="4281784">(</span><span class="ident" id="4281785">h</span>&nbsp;<span class="ident" id="4281787"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><span class="op" id="4281791">)</span>&nbsp;<span class="ident" id="4281793">Size</span><span class="op" id="4281797">(</span><span class="op" id="4281798">)</span>&nbsp;<span class="builtintype" id="4281800">int</span>&nbsp;<span class="op" id="4281804">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281807">if</span>&nbsp;<span class="ident" id="4281810"><a href="/crypto/crypto.go.html#4281785">h</a></span>&nbsp;<span class="op" id="4281812">&gt;</span>&nbsp;<span class="num" id="4281814">0</span>&nbsp;<span class="op" id="4281816">&amp;&amp;</span>&nbsp;<span class="ident" id="4281819"><a href="/crypto/crypto.go.html#4281785">h</a></span>&nbsp;<span class="op" id="4281821">&lt;</span>&nbsp;<span class="ident" id="4281823"><a href="/crypto/crypto.go.html#4281352">maxHash</a></span>&nbsp;<span class="op" id="4281831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281835">return</span>&nbsp;<span class="builtintype" id="4281842">int</span><span class="op" id="4281845">(</span><span class="ident" id="4281846"><a href="/crypto/crypto.go.html#4281367">digestSizes</a></span><span class="op" id="4281857">[</span><span class="ident" id="4281858"><a href="/crypto/crypto.go.html#4281785">h</a></span><span class="op" id="4281859">]</span><span class="op" id="4281860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4281866">panic</span><span class="op" id="4281871">(</span><span class="string" id="4281872">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4281911">)</span><br>
<span class="lineno"></span><span class="op" id="4281913">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4281916">var</span>&nbsp;<span class="ident" id="4281920">hashes</span>&nbsp;<span class="op" id="4281927">=</span>&nbsp;<span class="builtinfunc" id="4281929">make</span><span class="op" id="4281933">(</span><span class="op" id="4281934">[</span><span class="op" id="4281935">]</span><span class="keyword" id="4281936">func</span><span class="op" id="4281940">(</span><span class="op" id="4281941">)</span>&nbsp;<span class="ident" id="4281943"><a href="/crypto/crypto.go.html#4280333">hash</a></span><span class="op" id="4281947">.</span><span class="ident" id="4281948">Hash</span><span class="op" id="4281952">,</span>&nbsp;<span class="ident" id="4281954"><a href="/crypto/crypto.go.html#4281352">maxHash</a></span><span class="op" id="4281961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4281964">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="4282043">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="4282098">func</span>&nbsp;<span class="op" id="4282103">(</span><span class="ident" id="4282104">h</span>&nbsp;<span class="ident" id="4282106"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><span class="op" id="4282110">)</span>&nbsp;<span class="ident" id="4282112">New</span><span class="op" id="4282115">(</span><span class="op" id="4282116">)</span>&nbsp;<span class="ident" id="4282118"><a href="/crypto/crypto.go.html#4280333">hash</a></span><span class="op" id="4282122">.</span><span class="ident" id="4282123">Hash</span>&nbsp;<span class="op" id="4282128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282131">if</span>&nbsp;<span class="ident" id="4282134"><a href="/crypto/crypto.go.html#4282104">h</a></span>&nbsp;<span class="op" id="4282136">&gt;</span>&nbsp;<span class="num" id="4282138">0</span>&nbsp;<span class="op" id="4282140">&amp;&amp;</span>&nbsp;<span class="ident" id="4282143"><a href="/crypto/crypto.go.html#4282104">h</a></span>&nbsp;<span class="op" id="4282145">&lt;</span>&nbsp;<span class="ident" id="4282147"><a href="/crypto/crypto.go.html#4281352">maxHash</a></span>&nbsp;<span class="op" id="4282155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282159">f</span>&nbsp;<span class="op" id="4282161">:=</span>&nbsp;<span class="ident" id="4282164"><a href="/crypto/crypto.go.html#4281920">hashes</a></span><span class="op" id="4282170">[</span><span class="ident" id="4282171"><a href="/crypto/crypto.go.html#4282104">h</a></span><span class="op" id="4282172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282176">if</span>&nbsp;<span class="ident" id="4282179"><a href="/crypto/crypto.go.html#4282159">f</a></span>&nbsp;<span class="op" id="4282181">!=</span>&nbsp;<span class="ident" id="4282184">nil</span>&nbsp;<span class="op" id="4282188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282193">return</span>&nbsp;<span class="ident" id="4282200"><a href="/crypto/crypto.go.html#4282159">f</a></span><span class="op" id="4282201">(</span><span class="op" id="4282202">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4282212">panic</span><span class="op" id="4282217">(</span><span class="string" id="4282218">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="4282254">+</span>&nbsp;<span class="ident" id="4282256"><a href="/crypto/crypto.go.html#4280347">strconv</a></span><span class="op" id="4282263">.</span><span class="ident" id="4282264">Itoa</span><span class="op" id="4282268">(</span><span class="builtintype" id="4282269">int</span><span class="op" id="4282272">(</span><span class="ident" id="4282273"><a href="/crypto/crypto.go.html#4282104">h</a></span><span class="op" id="4282274">)</span><span class="op" id="4282275">)</span>&nbsp;<span class="op" id="4282277">+</span>&nbsp;<span class="string" id="4282279">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="4282296">)</span><br>
<span class="lineno"></span><span class="op" id="4282298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4282301">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4282381">func</span>&nbsp;<span class="op" id="4282386">(</span><span class="ident" id="4282387">h</span>&nbsp;<span class="ident" id="4282389"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><span class="op" id="4282393">)</span>&nbsp;<span class="ident" id="4282395">Available</span><span class="op" id="4282404">(</span><span class="op" id="4282405">)</span>&nbsp;<span class="builtintype" id="4282407">bool</span>&nbsp;<span class="op" id="4282412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282415">return</span>&nbsp;<span class="ident" id="4282422"><a href="/crypto/crypto.go.html#4282387">h</a></span>&nbsp;<span class="op" id="4282424">&lt;</span>&nbsp;<span class="ident" id="4282426"><a href="/crypto/crypto.go.html#4281352">maxHash</a></span>&nbsp;<span class="op" id="4282434">&amp;&amp;</span>&nbsp;<span class="ident" id="4282437"><a href="/crypto/crypto.go.html#4281920">hashes</a></span><span class="op" id="4282443">[</span><span class="ident" id="4282444"><a href="/crypto/crypto.go.html#4282387">h</a></span><span class="op" id="4282445">]</span>&nbsp;<span class="op" id="4282447">!=</span>&nbsp;<span class="ident" id="4282450">nil</span><br>
<span class="lineno"></span><span class="op" id="4282454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4282457">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4282535">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4282609">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="4282652">func</span>&nbsp;<span class="ident" id="4282657">RegisterHash</span><span class="op" id="4282669">(</span><span class="ident" id="4282670">h</span>&nbsp;<span class="ident" id="4282672"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><span class="op" id="4282676">,</span>&nbsp;<span class="ident" id="4282678">f</span>&nbsp;<span class="keyword" id="4282680">func</span><span class="op" id="4282684">(</span><span class="op" id="4282685">)</span>&nbsp;<span class="ident" id="4282687"><a href="/crypto/crypto.go.html#4280333">hash</a></span><span class="op" id="4282691">.</span><span class="ident" id="4282692">Hash</span><span class="op" id="4282696">)</span>&nbsp;<span class="op" id="4282698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282701">if</span>&nbsp;<span class="ident" id="4282704"><a href="/crypto/crypto.go.html#4282670">h</a></span>&nbsp;<span class="op" id="4282706">&gt;=</span>&nbsp;<span class="ident" id="4282709"><a href="/crypto/crypto.go.html#4281352">maxHash</a></span>&nbsp;<span class="op" id="4282717">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4282721">panic</span><span class="op" id="4282726">(</span><span class="string" id="4282727">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4282774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282780"><a href="/crypto/crypto.go.html#4281920">hashes</a></span><span class="op" id="4282786">[</span><span class="ident" id="4282787"><a href="/crypto/crypto.go.html#4282670">h</a></span><span class="op" id="4282788">]</span>&nbsp;<span class="op" id="4282790">=</span>&nbsp;<span class="ident" id="4282792"><a href="/crypto/crypto.go.html#4282678">f</a></span><br>
<span class="lineno"></span><span class="op" id="4282794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4282797">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4282866">type</span>&nbsp;<span class="ident" id="4282871">PublicKey</span>&nbsp;<span class="keyword" id="4282881">interface</span><span class="op" id="4282890">{</span><span class="op" id="4282891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4282894">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4282965">type</span>&nbsp;<span class="ident" id="4282970">PrivateKey</span>&nbsp;<span class="keyword" id="4282981">interface</span><span class="op" id="4282990">{</span><span class="op" id="4282991">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4282994">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4283067">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="4283141">type</span>&nbsp;<span class="ident" id="4283146">Signer</span>&nbsp;<span class="keyword" id="4283153">interface</span>&nbsp;<span class="op" id="4283163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283166">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283229">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283246">Public</span><span class="op" id="4283252">(</span><span class="op" id="4283253">)</span>&nbsp;<span class="ident" id="4283255"><a href="/crypto/crypto.go.html#4282871">PublicKey</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283267">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283336">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283405">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283477">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283544">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283548">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283621">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283694">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283762">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283834">Sign</span><span class="op" id="4283838">(</span><span class="ident" id="4283839">rand</span>&nbsp;<span class="ident" id="4283844"><a href="/crypto/crypto.go.html#4280341">io</a></span><span class="op" id="4283846">.</span><span class="ident" id="4283847">Reader</span><span class="op" id="4283853">,</span>&nbsp;<span class="ident" id="4283855">msg</span>&nbsp;<span class="op" id="4283859">[</span><span class="op" id="4283860">]</span><span class="builtintype" id="4283861">byte</span><span class="op" id="4283865">,</span>&nbsp;<span class="ident" id="4283867">opts</span>&nbsp;<span class="ident" id="4283872"><a href="/crypto/crypto.go.html#4283980">SignerOpts</a></span><span class="op" id="4283882">)</span>&nbsp;<span class="op" id="4283884">(</span><span class="ident" id="4283885">signature</span>&nbsp;<span class="op" id="4283895">[</span><span class="op" id="4283896">]</span><span class="builtintype" id="4283897">byte</span><span class="op" id="4283901">,</span>&nbsp;<span class="ident" id="4283903">err</span>&nbsp;<span class="builtintype" id="4283907">error</span><span class="op" id="4283912">)</span><br>
<span class="lineno"></span><span class="op" id="4283914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4283917">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="4283975">type</span>&nbsp;<span class="ident" id="4283980">SignerOpts</span>&nbsp;<span class="keyword" id="4283991">interface</span>&nbsp;<span class="op" id="4284001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284004">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284077">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284149">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284171">HashFunc</span><span class="op" id="4284179">(</span><span class="op" id="4284180">)</span>&nbsp;<span class="ident" id="4284182"><a href="/crypto/crypto.go.html#4280457">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="4284187">}</span>
</div>
</body>
</html>
