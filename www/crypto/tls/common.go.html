<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3822468">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3822523">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3822577">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3822628">package</span>&nbsp;<span class="ident" id="3822636">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3822641">import</span>&nbsp;<span class="op" id="3822648">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822651">&#34;container/list&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822669">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822679">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822694">&#34;crypto/x509&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822709">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822716">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822722">&#34;math/big&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822734">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822745">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3822753">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3822760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="3822763">const</span>&nbsp;<span class="op" id="3822769">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822772">VersionSSL30</span>&nbsp;<span class="op" id="3822785">=</span>&nbsp;<span class="num" id="3822787">0x0300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822795">VersionTLS10</span>&nbsp;<span class="op" id="3822808">=</span>&nbsp;<span class="num" id="3822810">0x0301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822818">VersionTLS11</span>&nbsp;<span class="op" id="3822831">=</span>&nbsp;<span class="num" id="3822833">0x0302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822841">VersionTLS12</span>&nbsp;<span class="op" id="3822854">=</span>&nbsp;<span class="num" id="3822856">0x0303</span><br>
<span class="lineno">25</span><span class="op" id="3822863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3822866">const</span>&nbsp;<span class="op" id="3822872">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822875">maxPlaintext</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3822891">=</span>&nbsp;<span class="num" id="3822893">16384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3822906">//&nbsp;maximum&nbsp;plaintext&nbsp;payload&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3822943">maxCiphertext</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3822959">=</span>&nbsp;<span class="num" id="3822961">16384</span>&nbsp;<span class="op" id="3822967">+</span>&nbsp;<span class="num" id="3822969">2048</span>&nbsp;<span class="comment" id="3822974">//&nbsp;maximum&nbsp;ciphertext&nbsp;payload&nbsp;length</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823012">recordHeaderLen</span>&nbsp;<span class="op" id="3823028">=</span>&nbsp;<span class="num" id="3823030">5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3823043">//&nbsp;record&nbsp;header&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823068">maxHandshake</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3823084">=</span>&nbsp;<span class="num" id="3823086">65536</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3823099">//&nbsp;maximum&nbsp;handshake&nbsp;we&nbsp;support&nbsp;(protocol&nbsp;max&nbsp;is&nbsp;16&nbsp;MB)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823157">minVersion</span>&nbsp;<span class="op" id="3823168">=</span>&nbsp;<span class="ident" id="3823170"><a href="/crypto/tls/common.go.html#3822772">VersionSSL30</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823184">maxVersion</span>&nbsp;<span class="op" id="3823195">=</span>&nbsp;<span class="ident" id="3823197"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span><br>
<span class="lineno">35</span><span class="op" id="3823210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3823213">//&nbsp;TLS&nbsp;record&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="3823234">type</span>&nbsp;<span class="ident" id="3823239">recordType</span>&nbsp;<span class="builtintype" id="3823250">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3823257">const</span>&nbsp;<span class="op" id="3823263">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823266">recordTypeChangeCipherSpec</span>&nbsp;<span class="ident" id="3823293"><a href="/crypto/tls/common.go.html#3823239">recordType</a></span>&nbsp;<span class="op" id="3823304">=</span>&nbsp;<span class="num" id="3823306">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823310">recordTypeAlert</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3823337"><a href="/crypto/tls/common.go.html#3823239">recordType</a></span>&nbsp;<span class="op" id="3823348">=</span>&nbsp;<span class="num" id="3823350">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823354">recordTypeHandshake</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3823381"><a href="/crypto/tls/common.go.html#3823239">recordType</a></span>&nbsp;<span class="op" id="3823392">=</span>&nbsp;<span class="num" id="3823394">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823398">recordTypeApplicationData</span>&nbsp;&nbsp;<span class="ident" id="3823425"><a href="/crypto/tls/common.go.html#3823239">recordType</a></span>&nbsp;<span class="op" id="3823436">=</span>&nbsp;<span class="num" id="3823438">23</span><br>
<span class="lineno">45</span><span class="op" id="3823441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3823444">//&nbsp;TLS&nbsp;handshake&nbsp;message&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="3823476">const</span>&nbsp;<span class="op" id="3823482">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823485">typeClientHello</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823508">uint8</span>&nbsp;<span class="op" id="3823514">=</span>&nbsp;<span class="num" id="3823516">1</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823519">typeServerHello</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823542">uint8</span>&nbsp;<span class="op" id="3823548">=</span>&nbsp;<span class="num" id="3823550">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823553">typeNewSessionTicket</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823576">uint8</span>&nbsp;<span class="op" id="3823582">=</span>&nbsp;<span class="num" id="3823584">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823587">typeCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823610">uint8</span>&nbsp;<span class="op" id="3823616">=</span>&nbsp;<span class="num" id="3823618">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823622">typeServerKeyExchange</span>&nbsp;&nbsp;<span class="builtintype" id="3823645">uint8</span>&nbsp;<span class="op" id="3823651">=</span>&nbsp;<span class="num" id="3823653">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823657">typeCertificateRequest</span>&nbsp;<span class="builtintype" id="3823680">uint8</span>&nbsp;<span class="op" id="3823686">=</span>&nbsp;<span class="num" id="3823688">13</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823692">typeServerHelloDone</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823715">uint8</span>&nbsp;<span class="op" id="3823721">=</span>&nbsp;<span class="num" id="3823723">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823727">typeCertificateVerify</span>&nbsp;&nbsp;<span class="builtintype" id="3823750">uint8</span>&nbsp;<span class="op" id="3823756">=</span>&nbsp;<span class="num" id="3823758">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823762">typeClientKeyExchange</span>&nbsp;&nbsp;<span class="builtintype" id="3823785">uint8</span>&nbsp;<span class="op" id="3823791">=</span>&nbsp;<span class="num" id="3823793">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823797">typeFinished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823820">uint8</span>&nbsp;<span class="op" id="3823826">=</span>&nbsp;<span class="num" id="3823828">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823832">typeCertificateStatus</span>&nbsp;&nbsp;<span class="builtintype" id="3823855">uint8</span>&nbsp;<span class="op" id="3823861">=</span>&nbsp;<span class="num" id="3823863">22</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823867">typeNextProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3823890">uint8</span>&nbsp;<span class="op" id="3823896">=</span>&nbsp;<span class="num" id="3823898">67</span>&nbsp;<span class="comment" id="3823901">//&nbsp;Not&nbsp;IANA&nbsp;assigned</span><br>
<span class="lineno"></span><span class="op" id="3823922">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3823925">//&nbsp;TLS&nbsp;compression&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="3823951">const</span>&nbsp;<span class="op" id="3823957">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3823960">compressionNone</span>&nbsp;<span class="builtintype" id="3823976">uint8</span>&nbsp;<span class="op" id="3823982">=</span>&nbsp;<span class="num" id="3823984">0</span><br>
<span class="lineno"></span><span class="op" id="3823986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3823989">//&nbsp;TLS&nbsp;extension&nbsp;numbers</span><br>
<span class="lineno"></span><span class="keyword" id="3824014">const</span>&nbsp;<span class="op" id="3824020">(</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824023">extensionServerName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824052">uint16</span>&nbsp;<span class="op" id="3824059">=</span>&nbsp;<span class="num" id="3824061">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824064">extensionStatusRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824093">uint16</span>&nbsp;<span class="op" id="3824100">=</span>&nbsp;<span class="num" id="3824102">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824105">extensionSupportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824134">uint16</span>&nbsp;<span class="op" id="3824141">=</span>&nbsp;<span class="num" id="3824143">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824147">extensionSupportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824176">uint16</span>&nbsp;<span class="op" id="3824183">=</span>&nbsp;<span class="num" id="3824185">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824189">extensionSignatureAlgorithms</span>&nbsp;<span class="builtintype" id="3824218">uint16</span>&nbsp;<span class="op" id="3824225">=</span>&nbsp;<span class="num" id="3824227">13</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824231">extensionALPN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824260">uint16</span>&nbsp;<span class="op" id="3824267">=</span>&nbsp;<span class="num" id="3824269">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824273">extensionSessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824302">uint16</span>&nbsp;<span class="op" id="3824309">=</span>&nbsp;<span class="num" id="3824311">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824315">extensionNextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824344">uint16</span>&nbsp;<span class="op" id="3824351">=</span>&nbsp;<span class="num" id="3824353">13172</span>&nbsp;<span class="comment" id="3824359">//&nbsp;not&nbsp;IANA&nbsp;assigned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824381">extensionRenegotiationInfo</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3824410">uint16</span>&nbsp;<span class="op" id="3824417">=</span>&nbsp;<span class="num" id="3824419">0xff01</span><br>
<span class="lineno"></span><span class="op" id="3824426">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3824429">//&nbsp;TLS&nbsp;signaling&nbsp;cipher&nbsp;suite&nbsp;values</span><br>
<span class="lineno"></span><span class="keyword" id="3824466">const</span>&nbsp;<span class="op" id="3824472">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824475">scsvRenegotiation</span>&nbsp;<span class="builtintype" id="3824493">uint16</span>&nbsp;<span class="op" id="3824500">=</span>&nbsp;<span class="num" id="3824502">0x00ff</span><br>
<span class="lineno"></span><span class="op" id="3824509">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3824512">//&nbsp;CurveID&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;TLS&nbsp;identifier&nbsp;for&nbsp;an&nbsp;elliptic&nbsp;curve.&nbsp;See</span><br>
<span class="lineno"></span><span class="comment" id="3824582">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-8</span><br>
<span class="lineno"></span><span class="keyword" id="3824668">type</span>&nbsp;<span class="ident" id="3824673">CurveID</span>&nbsp;<span class="builtintype" id="3824681">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="3824689">const</span>&nbsp;<span class="op" id="3824695">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824698">CurveP256</span>&nbsp;<span class="ident" id="3824708"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span>&nbsp;<span class="op" id="3824716">=</span>&nbsp;<span class="num" id="3824718">23</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824722">CurveP384</span>&nbsp;<span class="ident" id="3824732"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span>&nbsp;<span class="op" id="3824740">=</span>&nbsp;<span class="num" id="3824742">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824746">CurveP521</span>&nbsp;<span class="ident" id="3824756"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span>&nbsp;<span class="op" id="3824764">=</span>&nbsp;<span class="num" id="3824766">25</span><br>
<span class="lineno"></span><span class="op" id="3824769">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="3824772">//&nbsp;TLS&nbsp;Elliptic&nbsp;Curve&nbsp;Point&nbsp;Formats</span><br>
<span class="lineno"></span><span class="comment" id="3824808">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-9</span><br>
<span class="lineno"></span><span class="keyword" id="3824894">const</span>&nbsp;<span class="op" id="3824900">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824903">pointFormatUncompressed</span>&nbsp;<span class="builtintype" id="3824927">uint8</span>&nbsp;<span class="op" id="3824933">=</span>&nbsp;<span class="num" id="3824935">0</span><br>
<span class="lineno">100</span><span class="op" id="3824937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3824940">//&nbsp;TLS&nbsp;CertificateStatusType&nbsp;(RFC&nbsp;3546)</span><br>
<span class="lineno"></span><span class="keyword" id="3824980">const</span>&nbsp;<span class="op" id="3824986">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3824989">statusTypeOCSP</span>&nbsp;<span class="builtintype" id="3825004">uint8</span>&nbsp;<span class="op" id="3825010">=</span>&nbsp;<span class="num" id="3825012">1</span><br>
<span class="lineno">105</span><span class="op" id="3825014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3825017">//&nbsp;Certificate&nbsp;types&nbsp;(for&nbsp;certificateRequestMsg)</span><br>
<span class="lineno"></span><span class="keyword" id="3825066">const</span>&nbsp;<span class="op" id="3825072">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825075">certTypeRSASign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825094">=</span>&nbsp;<span class="num" id="3825096">1</span>&nbsp;<span class="comment" id="3825098">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;RSA&nbsp;key</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825138">certTypeDSSSign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825157">=</span>&nbsp;<span class="num" id="3825159">2</span>&nbsp;<span class="comment" id="3825161">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;DSA&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825200">certTypeRSAFixedDH</span>&nbsp;<span class="op" id="3825219">=</span>&nbsp;<span class="num" id="3825221">3</span>&nbsp;<span class="comment" id="3825223">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;static&nbsp;DH&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825268">certTypeDSSFixedDH</span>&nbsp;<span class="op" id="3825287">=</span>&nbsp;<span class="num" id="3825289">4</span>&nbsp;<span class="comment" id="3825291">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;a&nbsp;static&nbsp;DH&nbsp;key</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3825337">//&nbsp;See&nbsp;RFC4492&nbsp;sections&nbsp;3&nbsp;and&nbsp;5.5.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825373">certTypeECDSASign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3825396">=</span>&nbsp;<span class="num" id="3825398">64</span>&nbsp;<span class="comment" id="3825401">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDSA-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;ECDSA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825478">certTypeRSAFixedECDH</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3825501">=</span>&nbsp;<span class="num" id="3825503">65</span>&nbsp;<span class="comment" id="3825506">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDH-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;RSA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825580">certTypeECDSAFixedECDH</span>&nbsp;<span class="op" id="3825603">=</span>&nbsp;<span class="num" id="3825605">66</span>&nbsp;<span class="comment" id="3825608">//&nbsp;A&nbsp;certificate&nbsp;containing&nbsp;an&nbsp;ECDH-capable&nbsp;public&nbsp;key,&nbsp;signed&nbsp;with&nbsp;ECDSA.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3825685">//&nbsp;Rest&nbsp;of&nbsp;these&nbsp;are&nbsp;reserved&nbsp;by&nbsp;the&nbsp;TLS&nbsp;spec</span><br>
<span class="lineno">120</span><span class="op" id="3825731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3825734">//&nbsp;Hash&nbsp;functions&nbsp;for&nbsp;TLS&nbsp;1.2&nbsp;(See&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1)</span><br>
<span class="lineno"></span><span class="keyword" id="3825794">const</span>&nbsp;<span class="op" id="3825800">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825803">hashSHA1</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3825814">uint8</span>&nbsp;<span class="op" id="3825820">=</span>&nbsp;<span class="num" id="3825822">2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825825">hashSHA256</span>&nbsp;<span class="builtintype" id="3825836">uint8</span>&nbsp;<span class="op" id="3825842">=</span>&nbsp;<span class="num" id="3825844">4</span><br>
<span class="lineno"></span><span class="op" id="3825846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3825849">//&nbsp;Signature&nbsp;algorithms&nbsp;for&nbsp;TLS&nbsp;1.2&nbsp;(See&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1)</span><br>
<span class="lineno"></span><span class="keyword" id="3825915">const</span>&nbsp;<span class="op" id="3825921">(</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825924">signatureRSA</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3825939">uint8</span>&nbsp;<span class="op" id="3825945">=</span>&nbsp;<span class="num" id="3825947">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3825950">signatureECDSA</span>&nbsp;<span class="builtintype" id="3825965">uint8</span>&nbsp;<span class="op" id="3825971">=</span>&nbsp;<span class="num" id="3825973">3</span><br>
<span class="lineno"></span><span class="op" id="3825975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3825978">//&nbsp;signatureAndHash&nbsp;mirrors&nbsp;the&nbsp;TLS&nbsp;1.2,&nbsp;SignatureAndHashAlgorithm&nbsp;struct.&nbsp;See</span><br>
<span class="lineno">135</span><span class="comment" id="3826057">//&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;A.4.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3826085">type</span>&nbsp;<span class="ident" id="3826090">signatureAndHash</span>&nbsp;<span class="keyword" id="3826107">struct</span>&nbsp;<span class="op" id="3826114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3826117">hash</span><span class="op" id="3826121">,</span>&nbsp;<span class="ident" id="3826123">signature</span>&nbsp;<span class="builtintype" id="3826133">uint8</span><br>
<span class="lineno"></span><span class="op" id="3826139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3826142">//&nbsp;supportedSKXSignatureAlgorithms&nbsp;contains&nbsp;the&nbsp;signature&nbsp;and&nbsp;hash&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3826220">//&nbsp;that&nbsp;the&nbsp;code&nbsp;advertises&nbsp;as&nbsp;supported&nbsp;in&nbsp;a&nbsp;TLS&nbsp;1.2&nbsp;ClientHello.</span><br>
<span class="lineno"></span><span class="keyword" id="3826287">var</span>&nbsp;<span class="ident" id="3826291">supportedSKXSignatureAlgorithms</span>&nbsp;<span class="op" id="3826323">=</span>&nbsp;<span class="op" id="3826325">[</span><span class="op" id="3826326">]</span><span class="ident" id="3826327"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><span class="op" id="3826343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826346">{</span><span class="ident" id="3826347"><a href="/crypto/tls/common.go.html#3825825">hashSHA256</a></span><span class="op" id="3826357">,</span>&nbsp;<span class="ident" id="3826359"><a href="/crypto/tls/common.go.html#3825924">signatureRSA</a></span><span class="op" id="3826371">}</span><span class="op" id="3826372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826375">{</span><span class="ident" id="3826376"><a href="/crypto/tls/common.go.html#3825825">hashSHA256</a></span><span class="op" id="3826386">,</span>&nbsp;<span class="ident" id="3826388"><a href="/crypto/tls/common.go.html#3825950">signatureECDSA</a></span><span class="op" id="3826402">}</span><span class="op" id="3826403">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826406">{</span><span class="ident" id="3826407"><a href="/crypto/tls/common.go.html#3825803">hashSHA1</a></span><span class="op" id="3826415">,</span>&nbsp;<span class="ident" id="3826417"><a href="/crypto/tls/common.go.html#3825924">signatureRSA</a></span><span class="op" id="3826429">}</span><span class="op" id="3826430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826433">{</span><span class="ident" id="3826434"><a href="/crypto/tls/common.go.html#3825803">hashSHA1</a></span><span class="op" id="3826442">,</span>&nbsp;<span class="ident" id="3826444"><a href="/crypto/tls/common.go.html#3825950">signatureECDSA</a></span><span class="op" id="3826458">}</span><span class="op" id="3826459">,</span><br>
<span class="lineno"></span><span class="op" id="3826461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3826464">//&nbsp;supportedClientCertSignatureAlgorithms&nbsp;contains&nbsp;the&nbsp;signature&nbsp;and&nbsp;hash</span><br>
<span class="lineno">150</span><span class="comment" id="3826538">//&nbsp;algorithms&nbsp;that&nbsp;the&nbsp;code&nbsp;advertises&nbsp;as&nbsp;supported&nbsp;in&nbsp;a&nbsp;TLS&nbsp;1.2</span><br>
<span class="lineno"></span><span class="comment" id="3826603">//&nbsp;CertificateRequest.</span><br>
<span class="lineno"></span><span class="keyword" id="3826626">var</span>&nbsp;<span class="ident" id="3826630">supportedClientCertSignatureAlgorithms</span>&nbsp;<span class="op" id="3826669">=</span>&nbsp;<span class="op" id="3826671">[</span><span class="op" id="3826672">]</span><span class="ident" id="3826673"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><span class="op" id="3826689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826692">{</span><span class="ident" id="3826693"><a href="/crypto/tls/common.go.html#3825825">hashSHA256</a></span><span class="op" id="3826703">,</span>&nbsp;<span class="ident" id="3826705"><a href="/crypto/tls/common.go.html#3825924">signatureRSA</a></span><span class="op" id="3826717">}</span><span class="op" id="3826718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3826721">{</span><span class="ident" id="3826722"><a href="/crypto/tls/common.go.html#3825825">hashSHA256</a></span><span class="op" id="3826732">,</span>&nbsp;<span class="ident" id="3826734"><a href="/crypto/tls/common.go.html#3825950">signatureECDSA</a></span><span class="op" id="3826748">}</span><span class="op" id="3826749">,</span><br>
<span class="lineno">155</span><span class="op" id="3826751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3826754">//&nbsp;ConnectionState&nbsp;records&nbsp;basic&nbsp;TLS&nbsp;details&nbsp;about&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3826821">type</span>&nbsp;<span class="ident" id="3826826">ConnectionState</span>&nbsp;<span class="keyword" id="3826842">struct</span>&nbsp;<span class="op" id="3826849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3826852">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3826879">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3826901">//&nbsp;TLS&nbsp;version&nbsp;used&nbsp;by&nbsp;the&nbsp;connection&nbsp;(e.g.&nbsp;VersionTLS12)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3826960">HandshakeComplete</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3826987">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827009">//&nbsp;TLS&nbsp;handshake&nbsp;is&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827039">DidResume</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3827066">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827088">//&nbsp;connection&nbsp;resumes&nbsp;a&nbsp;previous&nbsp;TLS&nbsp;connection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827137">CipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3827164">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827186">//&nbsp;cipher&nbsp;suite&nbsp;in&nbsp;use&nbsp;(TLS_RSA_WITH_RC4_128_SHA,&nbsp;...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827242">NegotiatedProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3827269">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827291">//&nbsp;negotiated&nbsp;next&nbsp;protocol&nbsp;(from&nbsp;Config.NextProtos)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827345">NegotiatedProtocolIsMutual</span>&nbsp;<span class="builtintype" id="3827372">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827394">//&nbsp;negotiated&nbsp;protocol&nbsp;was&nbsp;advertised&nbsp;by&nbsp;server</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827443">ServerName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3827470">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3827492">//&nbsp;server&nbsp;name&nbsp;requested&nbsp;by&nbsp;client,&nbsp;if&nbsp;any&nbsp;(server&nbsp;side&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827555">PeerCertificates</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827582">[</span><span class="op" id="3827583">]</span><span class="op" id="3827584">*</span><span class="ident" id="3827585"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3827589">.</span><span class="ident" id="3827590">Certificate</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3827604">//&nbsp;certificate&nbsp;chain&nbsp;presented&nbsp;by&nbsp;remote&nbsp;peer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3827651">VerifiedChains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3827678">[</span><span class="op" id="3827679">]</span><span class="op" id="3827680">[</span><span class="op" id="3827681">]</span><span class="op" id="3827682">*</span><span class="ident" id="3827683"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3827687">.</span><span class="ident" id="3827688">Certificate</span>&nbsp;<span class="comment" id="3827700">//&nbsp;verified&nbsp;chains&nbsp;built&nbsp;from&nbsp;PeerCertificates</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3827749">//&nbsp;TLSUnique&nbsp;contains&nbsp;the&nbsp;&#34;tls-unique&#34;&nbsp;channel&nbsp;binding&nbsp;value&nbsp;(see&nbsp;RFC</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3827820">//&nbsp;5929,&nbsp;section&nbsp;3).&nbsp;For&nbsp;resumed&nbsp;sessions&nbsp;this&nbsp;value&nbsp;will&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3827886">//&nbsp;because&nbsp;resumption&nbsp;does&nbsp;not&nbsp;include&nbsp;enough&nbsp;context&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3827946">//&nbsp;https://secure-resumption.com/#channelbindings).&nbsp;This&nbsp;will&nbsp;change&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3828019">//&nbsp;future&nbsp;versions&nbsp;of&nbsp;Go&nbsp;once&nbsp;the&nbsp;TLS&nbsp;master-secret&nbsp;fix&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3828085">//&nbsp;standardized&nbsp;and&nbsp;implemented.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828119">TLSUnique</span>&nbsp;<span class="op" id="3828129">[</span><span class="op" id="3828130">]</span><span class="builtintype" id="3828131">byte</span><br>
<span class="lineno"></span><span class="op" id="3828136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3828139">//&nbsp;ClientAuthType&nbsp;declares&nbsp;the&nbsp;policy&nbsp;the&nbsp;server&nbsp;will&nbsp;follow&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3828204">//&nbsp;TLS&nbsp;Client&nbsp;Authentication.</span><br>
<span class="lineno">180</span><span class="keyword" id="3828234">type</span>&nbsp;<span class="ident" id="3828239">ClientAuthType</span>&nbsp;<span class="builtintype" id="3828254">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3828259">const</span>&nbsp;<span class="op" id="3828265">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828268">NoClientCert</span>&nbsp;<span class="ident" id="3828281"><a href="/crypto/tls/common.go.html#3828239">ClientAuthType</a></span>&nbsp;<span class="op" id="3828296">=</span>&nbsp;<span class="ident" id="3828298">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828304">RequestClientCert</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828323">RequireAnyClientCert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828345">VerifyClientCertIfGiven</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828370">RequireAndVerifyClientCert</span><br>
<span class="lineno"></span><span class="op" id="3828397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3828400">//&nbsp;ClientSessionState&nbsp;contains&nbsp;the&nbsp;state&nbsp;needed&nbsp;by&nbsp;clients&nbsp;to&nbsp;resume&nbsp;TLS</span><br>
<span class="lineno"></span><span class="comment" id="3828473">//&nbsp;sessions.</span><br>
<span class="lineno"></span><span class="keyword" id="3828486">type</span>&nbsp;<span class="ident" id="3828491">ClientSessionState</span>&nbsp;<span class="keyword" id="3828510">struct</span>&nbsp;<span class="op" id="3828517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828520">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3828539">[</span><span class="op" id="3828540">]</span><span class="builtintype" id="3828541">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3828559">//&nbsp;Encrypted&nbsp;ticket&nbsp;used&nbsp;for&nbsp;session&nbsp;resumption&nbsp;with&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828620">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3828639">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3828659">//&nbsp;SSL/TLS&nbsp;version&nbsp;negotiated&nbsp;for&nbsp;the&nbsp;session</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828706">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3828725">uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3828745">//&nbsp;Ciphersuite&nbsp;negotiated&nbsp;for&nbsp;the&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828788">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3828807">[</span><span class="op" id="3828808">]</span><span class="builtintype" id="3828809">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3828827">//&nbsp;MasterSecret&nbsp;generated&nbsp;by&nbsp;client&nbsp;on&nbsp;a&nbsp;full&nbsp;handshake</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3828884">serverCertificates</span>&nbsp;<span class="op" id="3828903">[</span><span class="op" id="3828904">]</span><span class="op" id="3828905">*</span><span class="ident" id="3828906"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3828910">.</span><span class="ident" id="3828911">Certificate</span>&nbsp;<span class="comment" id="3828923">//&nbsp;Certificate&nbsp;chain&nbsp;presented&nbsp;by&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="op" id="3828968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3828971">//&nbsp;ClientSessionCache&nbsp;is&nbsp;a&nbsp;cache&nbsp;of&nbsp;ClientSessionState&nbsp;objects&nbsp;that&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3829051">//&nbsp;by&nbsp;a&nbsp;client&nbsp;to&nbsp;resume&nbsp;a&nbsp;TLS&nbsp;session&nbsp;with&nbsp;a&nbsp;given&nbsp;server.&nbsp;ClientSessionCache</span><br>
<span class="lineno"></span><span class="comment" id="3829130">//&nbsp;implementations&nbsp;should&nbsp;expect&nbsp;to&nbsp;be&nbsp;called&nbsp;concurrently&nbsp;from&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3829204">//&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="3829219">type</span>&nbsp;<span class="ident" id="3829224">ClientSessionCache</span>&nbsp;<span class="keyword" id="3829243">interface</span>&nbsp;<span class="op" id="3829253">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829256">//&nbsp;Get&nbsp;searches&nbsp;for&nbsp;a&nbsp;ClientSessionState&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829329">//&nbsp;On&nbsp;return,&nbsp;ok&nbsp;is&nbsp;true&nbsp;if&nbsp;one&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829373">Get</span><span class="op" id="3829376">(</span><span class="ident" id="3829377">sessionKey</span>&nbsp;<span class="builtintype" id="3829388">string</span><span class="op" id="3829394">)</span>&nbsp;<span class="op" id="3829396">(</span><span class="ident" id="3829397">session</span>&nbsp;<span class="op" id="3829405">*</span><span class="ident" id="3829406"><a href="/crypto/tls/common.go.html#3828491">ClientSessionState</a></span><span class="op" id="3829424">,</span>&nbsp;<span class="ident" id="3829426">ok</span>&nbsp;<span class="builtintype" id="3829429">bool</span><span class="op" id="3829433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829437">//&nbsp;Put&nbsp;adds&nbsp;the&nbsp;ClientSessionState&nbsp;to&nbsp;the&nbsp;cache&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829506">Put</span><span class="op" id="3829509">(</span><span class="ident" id="3829510">sessionKey</span>&nbsp;<span class="builtintype" id="3829521">string</span><span class="op" id="3829527">,</span>&nbsp;<span class="ident" id="3829529">cs</span>&nbsp;<span class="op" id="3829532">*</span><span class="ident" id="3829533"><a href="/crypto/tls/common.go.html#3828491">ClientSessionState</a></span><span class="op" id="3829551">)</span><br>
<span class="lineno"></span><span class="op" id="3829553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3829556">//&nbsp;ClientHelloInfo&nbsp;contains&nbsp;information&nbsp;from&nbsp;a&nbsp;ClientHello&nbsp;message&nbsp;in&nbsp;order&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3829635">//&nbsp;guide&nbsp;certificate&nbsp;selection&nbsp;in&nbsp;the&nbsp;GetCertificate&nbsp;callback.</span><br>
<span class="lineno">215</span><span class="keyword" id="3829698">type</span>&nbsp;<span class="ident" id="3829703">ClientHelloInfo</span>&nbsp;<span class="keyword" id="3829719">struct</span>&nbsp;<span class="op" id="3829726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829729">//&nbsp;CipherSuites&nbsp;lists&nbsp;the&nbsp;CipherSuites&nbsp;supported&nbsp;by&nbsp;the&nbsp;client&nbsp;(e.g.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829799">//&nbsp;TLS_RSA_WITH_RC4_128_SHA).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829830">CipherSuites</span>&nbsp;<span class="op" id="3829843">[</span><span class="op" id="3829844">]</span><span class="builtintype" id="3829845">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829854">//&nbsp;ServerName&nbsp;indicates&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;server&nbsp;requested&nbsp;by&nbsp;the&nbsp;client</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829926">//&nbsp;in&nbsp;order&nbsp;to&nbsp;support&nbsp;virtual&nbsp;hosting.&nbsp;ServerName&nbsp;is&nbsp;only&nbsp;set&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3829997">//&nbsp;client&nbsp;is&nbsp;using&nbsp;SNI&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830026">//&nbsp;http://tools.ietf.org/html/rfc4366#section-3.1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830079">ServerName</span>&nbsp;<span class="builtintype" id="3830090">string</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830099">//&nbsp;SupportedCurves&nbsp;lists&nbsp;the&nbsp;elliptic&nbsp;curves&nbsp;supported&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830170">//&nbsp;SupportedCurves&nbsp;is&nbsp;set&nbsp;only&nbsp;if&nbsp;the&nbsp;Supported&nbsp;Elliptic&nbsp;Curves</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830235">//&nbsp;Extension&nbsp;is&nbsp;being&nbsp;used&nbsp;(see</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830268">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.1.1).</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830323">SupportedCurves</span>&nbsp;<span class="op" id="3830339">[</span><span class="op" id="3830340">]</span><span class="ident" id="3830341"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830351">//&nbsp;SupportedPoints&nbsp;lists&nbsp;the&nbsp;point&nbsp;formats&nbsp;supported&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830420">//&nbsp;SupportedPoints&nbsp;is&nbsp;set&nbsp;only&nbsp;if&nbsp;the&nbsp;Supported&nbsp;Point&nbsp;Formats&nbsp;Extension</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830493">//&nbsp;is&nbsp;being&nbsp;used&nbsp;(see</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830516">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.1.2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830571">SupportedPoints</span>&nbsp;<span class="op" id="3830587">[</span><span class="op" id="3830588">]</span><span class="builtintype" id="3830589">uint8</span><br>
<span class="lineno"></span><span class="op" id="3830595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3830598">//&nbsp;A&nbsp;Config&nbsp;structure&nbsp;is&nbsp;used&nbsp;to&nbsp;configure&nbsp;a&nbsp;TLS&nbsp;client&nbsp;or&nbsp;server.</span><br>
<span class="lineno">240</span><span class="comment" id="3830665">//&nbsp;After&nbsp;one&nbsp;has&nbsp;been&nbsp;passed&nbsp;to&nbsp;a&nbsp;TLS&nbsp;function&nbsp;it&nbsp;must&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3830727">//&nbsp;modified.&nbsp;A&nbsp;Config&nbsp;may&nbsp;be&nbsp;reused;&nbsp;the&nbsp;tls&nbsp;package&nbsp;will&nbsp;also&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3830794">//&nbsp;modify&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3830808">type</span>&nbsp;<span class="ident" id="3830813">Config</span>&nbsp;<span class="keyword" id="3830820">struct</span>&nbsp;<span class="op" id="3830827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830830">//&nbsp;Rand&nbsp;provides&nbsp;the&nbsp;source&nbsp;of&nbsp;entropy&nbsp;for&nbsp;nonces&nbsp;and&nbsp;RSA&nbsp;blinding.</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830899">//&nbsp;If&nbsp;Rand&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;the&nbsp;cryptographic&nbsp;random&nbsp;reader&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830971">//&nbsp;crypto/rand.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3830988">//&nbsp;The&nbsp;Reader&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831048">Rand</span>&nbsp;<span class="ident" id="3831053"><a href="/crypto/tls/common.go.html#3822716">io</a></span><span class="op" id="3831055">.</span><span class="ident" id="3831056">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831065">//&nbsp;Time&nbsp;returns&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;since&nbsp;the&nbsp;epoch.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831141">//&nbsp;If&nbsp;Time&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;time.Now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831180">Time</span>&nbsp;<span class="keyword" id="3831185">func</span><span class="op" id="3831189">(</span><span class="op" id="3831190">)</span>&nbsp;<span class="ident" id="3831192"><a href="/crypto/tls/common.go.html#3822753">time</a></span><span class="op" id="3831196">.</span><span class="ident" id="3831197">Time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831204">//&nbsp;Certificates&nbsp;contains&nbsp;one&nbsp;or&nbsp;more&nbsp;certificate&nbsp;chains</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831261">//&nbsp;to&nbsp;present&nbsp;to&nbsp;the&nbsp;other&nbsp;side&nbsp;of&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831313">//&nbsp;Server&nbsp;configurations&nbsp;must&nbsp;include&nbsp;at&nbsp;least&nbsp;one&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831378">Certificates</span>&nbsp;<span class="op" id="3831391">[</span><span class="op" id="3831392">]</span><span class="ident" id="3831393"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831407">//&nbsp;NameToCertificate&nbsp;maps&nbsp;from&nbsp;a&nbsp;certificate&nbsp;name&nbsp;to&nbsp;an&nbsp;element&nbsp;of</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831475">//&nbsp;Certificates.&nbsp;Note&nbsp;that&nbsp;a&nbsp;certificate&nbsp;name&nbsp;can&nbsp;be&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831541">//&nbsp;&#39;*.example.com&#39;&nbsp;and&nbsp;so&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;a&nbsp;domain&nbsp;name&nbsp;as&nbsp;such.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831610">//&nbsp;See&nbsp;Config.BuildNameToCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831648">//&nbsp;The&nbsp;nil&nbsp;value&nbsp;causes&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Certificates&nbsp;to&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831718">//&nbsp;for&nbsp;all&nbsp;connections.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831743">NameToCertificate</span>&nbsp;<span class="keyword" id="3831761">map</span><span class="op" id="3831764">[</span><span class="builtintype" id="3831765">string</span><span class="op" id="3831771">]</span><span class="op" id="3831772">*</span><span class="ident" id="3831773"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831787">//&nbsp;GetCertificate&nbsp;returns&nbsp;a&nbsp;Certificate&nbsp;based&nbsp;on&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831847">//&nbsp;ClientHelloInfo.&nbsp;If&nbsp;GetCertificate&nbsp;is&nbsp;nil&nbsp;or&nbsp;returns&nbsp;nil,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831918">//&nbsp;certificate&nbsp;is&nbsp;retrieved&nbsp;from&nbsp;NameToCertificate.&nbsp;If</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3831974">//&nbsp;NameToCertificate&nbsp;is&nbsp;nil,&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Certificates&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832046">//&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832056">GetCertificate</span>&nbsp;<span class="keyword" id="3832071">func</span><span class="op" id="3832075">(</span><span class="ident" id="3832076">clientHello</span>&nbsp;<span class="op" id="3832088">*</span><span class="ident" id="3832089"><a href="/crypto/tls/common.go.html#3829703">ClientHelloInfo</a></span><span class="op" id="3832104">)</span>&nbsp;<span class="op" id="3832106">(</span><span class="op" id="3832107">*</span><span class="ident" id="3832108"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><span class="op" id="3832119">,</span>&nbsp;<span class="builtintype" id="3832121">error</span><span class="op" id="3832126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832130">//&nbsp;RootCAs&nbsp;defines&nbsp;the&nbsp;set&nbsp;of&nbsp;root&nbsp;certificate&nbsp;authorities</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832190">//&nbsp;that&nbsp;clients&nbsp;use&nbsp;when&nbsp;verifying&nbsp;server&nbsp;certificates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832247">//&nbsp;If&nbsp;RootCAs&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;the&nbsp;host&#39;s&nbsp;root&nbsp;CA&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832303">RootCAs</span>&nbsp;<span class="op" id="3832311">*</span><span class="ident" id="3832312"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3832316">.</span><span class="ident" id="3832317">CertPool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832328">//&nbsp;NextProtos&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;supported,&nbsp;application&nbsp;level&nbsp;protocols.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832396">NextProtos</span>&nbsp;<span class="op" id="3832407">[</span><span class="op" id="3832408">]</span><span class="builtintype" id="3832409">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832418">//&nbsp;ServerName&nbsp;is&nbsp;used&nbsp;to&nbsp;verify&nbsp;the&nbsp;hostname&nbsp;on&nbsp;the&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832480">//&nbsp;certificates&nbsp;unless&nbsp;InsecureSkipVerify&nbsp;is&nbsp;given.&nbsp;It&nbsp;is&nbsp;also&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832553">//&nbsp;in&nbsp;the&nbsp;client&#39;s&nbsp;handshake&nbsp;to&nbsp;support&nbsp;virtual&nbsp;hosting.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832611">ServerName</span>&nbsp;<span class="builtintype" id="3832622">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832631">//&nbsp;ClientAuth&nbsp;determines&nbsp;the&nbsp;server&#39;s&nbsp;policy&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832681">//&nbsp;TLS&nbsp;Client&nbsp;Authentication.&nbsp;The&nbsp;default&nbsp;is&nbsp;NoClientCert.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832741">ClientAuth</span>&nbsp;<span class="ident" id="3832752"><a href="/crypto/tls/common.go.html#3828239">ClientAuthType</a></span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832769">//&nbsp;ClientCAs&nbsp;defines&nbsp;the&nbsp;set&nbsp;of&nbsp;root&nbsp;certificate&nbsp;authorities</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832831">//&nbsp;that&nbsp;servers&nbsp;use&nbsp;if&nbsp;required&nbsp;to&nbsp;verify&nbsp;a&nbsp;client&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832895">//&nbsp;by&nbsp;the&nbsp;policy&nbsp;in&nbsp;ClientAuth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832928">ClientCAs</span>&nbsp;<span class="op" id="3832938">*</span><span class="ident" id="3832939"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3832943">.</span><span class="ident" id="3832944">CertPool</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832955">//&nbsp;InsecureSkipVerify&nbsp;controls&nbsp;whether&nbsp;a&nbsp;client&nbsp;verifies&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833017">//&nbsp;server&#39;s&nbsp;certificate&nbsp;chain&nbsp;and&nbsp;host&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833063">//&nbsp;If&nbsp;InsecureSkipVerify&nbsp;is&nbsp;true,&nbsp;TLS&nbsp;accepts&nbsp;any&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833126">//&nbsp;presented&nbsp;by&nbsp;the&nbsp;server&nbsp;and&nbsp;any&nbsp;host&nbsp;name&nbsp;in&nbsp;that&nbsp;certificate.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833193">//&nbsp;In&nbsp;this&nbsp;mode,&nbsp;TLS&nbsp;is&nbsp;susceptible&nbsp;to&nbsp;man-in-the-middle&nbsp;attacks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833260">//&nbsp;This&nbsp;should&nbsp;be&nbsp;used&nbsp;only&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833302">InsecureSkipVerify</span>&nbsp;<span class="builtintype" id="3833321">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833328">//&nbsp;CipherSuites&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;supported&nbsp;cipher&nbsp;suites.&nbsp;If&nbsp;CipherSuites</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833399">//&nbsp;is&nbsp;nil,&nbsp;TLS&nbsp;uses&nbsp;a&nbsp;list&nbsp;of&nbsp;suites&nbsp;supported&nbsp;by&nbsp;the&nbsp;implementation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833470">CipherSuites</span>&nbsp;<span class="op" id="3833483">[</span><span class="op" id="3833484">]</span><span class="builtintype" id="3833485">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833494">//&nbsp;PreferServerCipherSuites&nbsp;controls&nbsp;whether&nbsp;the&nbsp;server&nbsp;selects&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833563">//&nbsp;client&#39;s&nbsp;most&nbsp;preferred&nbsp;ciphersuite,&nbsp;or&nbsp;the&nbsp;server&#39;s&nbsp;most&nbsp;preferred</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833635">//&nbsp;ciphersuite.&nbsp;If&nbsp;true&nbsp;then&nbsp;the&nbsp;server&#39;s&nbsp;preference,&nbsp;as&nbsp;expressed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833706">//&nbsp;the&nbsp;order&nbsp;of&nbsp;elements&nbsp;in&nbsp;CipherSuites,&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833758">PreferServerCipherSuites</span>&nbsp;<span class="builtintype" id="3833783">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833790">//&nbsp;SessionTicketsDisabled&nbsp;may&nbsp;be&nbsp;set&nbsp;to&nbsp;true&nbsp;to&nbsp;disable&nbsp;session&nbsp;ticket</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833862">//&nbsp;(resumption)&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833888">SessionTicketsDisabled</span>&nbsp;<span class="builtintype" id="3833911">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833918">//&nbsp;SessionTicketKey&nbsp;is&nbsp;used&nbsp;by&nbsp;TLS&nbsp;servers&nbsp;to&nbsp;provide&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833981">//&nbsp;resumption.&nbsp;See&nbsp;RFC&nbsp;5077.&nbsp;If&nbsp;zero,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834043">//&nbsp;random&nbsp;data&nbsp;before&nbsp;the&nbsp;first&nbsp;server&nbsp;handshake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834094">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834098">//&nbsp;If&nbsp;multiple&nbsp;servers&nbsp;are&nbsp;terminating&nbsp;connections&nbsp;for&nbsp;the&nbsp;same&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834168">//&nbsp;they&nbsp;should&nbsp;all&nbsp;have&nbsp;the&nbsp;same&nbsp;SessionTicketKey.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834227">//&nbsp;SessionTicketKey&nbsp;leaks,&nbsp;previously&nbsp;recorded&nbsp;and&nbsp;future&nbsp;TLS</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834290">//&nbsp;connections&nbsp;using&nbsp;that&nbsp;key&nbsp;are&nbsp;compromised.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834338">SessionTicketKey</span>&nbsp;<span class="op" id="3834355">[</span><span class="num" id="3834356">32</span><span class="op" id="3834358">]</span><span class="builtintype" id="3834359">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834366">//&nbsp;SessionCache&nbsp;is&nbsp;a&nbsp;cache&nbsp;of&nbsp;ClientSessionState&nbsp;entries&nbsp;for&nbsp;TLS&nbsp;session</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834440">//&nbsp;resumption.</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834456">ClientSessionCache</span>&nbsp;<span class="ident" id="3834475"><a href="/crypto/tls/common.go.html#3829224">ClientSessionCache</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834496">//&nbsp;MinVersion&nbsp;contains&nbsp;the&nbsp;minimum&nbsp;SSL/TLS&nbsp;version&nbsp;that&nbsp;is&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834568">//&nbsp;If&nbsp;zero,&nbsp;then&nbsp;SSLv3&nbsp;is&nbsp;taken&nbsp;as&nbsp;the&nbsp;minimum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834617">MinVersion</span>&nbsp;<span class="builtintype" id="3834628">uint16</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834637">//&nbsp;MaxVersion&nbsp;contains&nbsp;the&nbsp;maximum&nbsp;SSL/TLS&nbsp;version&nbsp;that&nbsp;is&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834709">//&nbsp;If&nbsp;zero,&nbsp;then&nbsp;the&nbsp;maximum&nbsp;version&nbsp;supported&nbsp;by&nbsp;this&nbsp;package&nbsp;is&nbsp;used,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834782">//&nbsp;which&nbsp;is&nbsp;currently&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834814">MaxVersion</span>&nbsp;<span class="builtintype" id="3834825">uint16</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834834">//&nbsp;CurvePreferences&nbsp;contains&nbsp;the&nbsp;elliptic&nbsp;curves&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834905">//&nbsp;an&nbsp;ECDHE&nbsp;handshake,&nbsp;in&nbsp;preference&nbsp;order.&nbsp;If&nbsp;empty,&nbsp;the&nbsp;default&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834977">//&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834990">CurvePreferences</span>&nbsp;<span class="op" id="3835007">[</span><span class="op" id="3835008">]</span><span class="ident" id="3835009"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835019">serverInitOnce</span>&nbsp;<span class="ident" id="3835034"><a href="/crypto/tls/common.go.html#3822745">sync</a></span><span class="op" id="3835038">.</span><span class="ident" id="3835039">Once</span>&nbsp;<span class="comment" id="3835044">//&nbsp;guards&nbsp;calling&nbsp;(*Config).serverInit</span><br>
<span class="lineno"></span><span class="op" id="3835083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3835086">func</span>&nbsp;<span class="op" id="3835091">(</span><span class="ident" id="3835092">c</span>&nbsp;<span class="op" id="3835094">*</span><span class="ident" id="3835095"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835101">)</span>&nbsp;<span class="ident" id="3835103">serverInit</span><span class="op" id="3835113">(</span><span class="op" id="3835114">)</span>&nbsp;<span class="op" id="3835116">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835119">if</span>&nbsp;<span class="ident" id="3835122"><a href="/crypto/tls/common.go.html#3835092">c</a></span><span class="op" id="3835123">.</span><span class="ident" id="3835124">SessionTicketsDisabled</span>&nbsp;<span class="op" id="3835147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835151">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3835163">//&nbsp;If&nbsp;the&nbsp;key&nbsp;has&nbsp;already&nbsp;been&nbsp;set&nbsp;then&nbsp;we&nbsp;have&nbsp;nothing&nbsp;to&nbsp;do.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835227">for</span>&nbsp;<span class="ident" id="3835231">_</span><span class="op" id="3835232">,</span>&nbsp;<span class="ident" id="3835234">b</span>&nbsp;<span class="op" id="3835236">:=</span>&nbsp;<span class="keyword" id="3835239">range</span>&nbsp;<span class="ident" id="3835245"><a href="/crypto/tls/common.go.html#3835092">c</a></span><span class="op" id="3835246">.</span><span class="ident" id="3835247">SessionTicketKey</span>&nbsp;<span class="op" id="3835264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835268">if</span>&nbsp;<span class="ident" id="3835271"><a href="/crypto/tls/common.go.html#3835234">b</a></span>&nbsp;<span class="op" id="3835273">!=</span>&nbsp;<span class="num" id="3835276">0</span>&nbsp;<span class="op" id="3835278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835283">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835295">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835299">if</span>&nbsp;<span class="ident" id="3835302">_</span><span class="op" id="3835303">,</span>&nbsp;<span class="ident" id="3835305">err</span>&nbsp;<span class="op" id="3835309">:=</span>&nbsp;<span class="ident" id="3835312"><a href="/crypto/tls/common.go.html#3822716">io</a></span><span class="op" id="3835314">.</span><span class="ident" id="3835315">ReadFull</span><span class="op" id="3835323">(</span><span class="ident" id="3835324"><a href="/crypto/tls/common.go.html#3835092">c</a></span><span class="op" id="3835325">.</span><span class="ident" id="3835326">rand</span><span class="op" id="3835330">(</span><span class="op" id="3835331">)</span><span class="op" id="3835332">,</span>&nbsp;<span class="ident" id="3835334"><a href="/crypto/tls/common.go.html#3835092">c</a></span><span class="op" id="3835335">.</span><span class="ident" id="3835336">SessionTicketKey</span><span class="op" id="3835352">[</span><span class="op" id="3835353">:</span><span class="op" id="3835354">]</span><span class="op" id="3835355">)</span><span class="op" id="3835356">;</span>&nbsp;<span class="ident" id="3835358"><a href="/crypto/tls/common.go.html#3835305">err</a></span>&nbsp;<span class="op" id="3835362">!=</span>&nbsp;<span class="ident" id="3835365">nil</span>&nbsp;<span class="op" id="3835369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835373"><a href="/crypto/tls/common.go.html#3835092">c</a></span><span class="op" id="3835374">.</span><span class="ident" id="3835375">SessionTicketsDisabled</span>&nbsp;<span class="op" id="3835398">=</span>&nbsp;<span class="builtintype" id="3835400">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835406">}</span><br>
<span class="lineno"></span><span class="op" id="3835408">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="3835411">func</span>&nbsp;<span class="op" id="3835416">(</span><span class="ident" id="3835417">c</span>&nbsp;<span class="op" id="3835419">*</span><span class="ident" id="3835420"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835426">)</span>&nbsp;<span class="ident" id="3835428">rand</span><span class="op" id="3835432">(</span><span class="op" id="3835433">)</span>&nbsp;<span class="ident" id="3835435"><a href="/crypto/tls/common.go.html#3822716">io</a></span><span class="op" id="3835437">.</span><span class="ident" id="3835438">Reader</span>&nbsp;<span class="op" id="3835445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835448">r</span>&nbsp;<span class="op" id="3835450">:=</span>&nbsp;<span class="ident" id="3835453"><a href="/crypto/tls/common.go.html#3835417">c</a></span><span class="op" id="3835454">.</span><span class="ident" id="3835455">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835461">if</span>&nbsp;<span class="ident" id="3835464"><a href="/crypto/tls/common.go.html#3835448">r</a></span>&nbsp;<span class="op" id="3835466">==</span>&nbsp;<span class="ident" id="3835469">nil</span>&nbsp;<span class="op" id="3835473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835477">return</span>&nbsp;<span class="ident" id="3835484"><a href="/crypto/tls/common.go.html#3822679">rand</a></span><span class="op" id="3835488">.</span><span class="ident" id="3835489">Reader</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835500">return</span>&nbsp;<span class="ident" id="3835507"><a href="/crypto/tls/common.go.html#3835448">r</a></span><br>
<span class="lineno"></span><span class="op" id="3835509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3835512">func</span>&nbsp;<span class="op" id="3835517">(</span><span class="ident" id="3835518">c</span>&nbsp;<span class="op" id="3835520">*</span><span class="ident" id="3835521"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835527">)</span>&nbsp;<span class="ident" id="3835529">time</span><span class="op" id="3835533">(</span><span class="op" id="3835534">)</span>&nbsp;<span class="ident" id="3835536"><a href="/crypto/tls/common.go.html#3822753">time</a></span><span class="op" id="3835540">.</span><span class="ident" id="3835541">Time</span>&nbsp;<span class="op" id="3835546">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835549">t</span>&nbsp;<span class="op" id="3835551">:=</span>&nbsp;<span class="ident" id="3835554"><a href="/crypto/tls/common.go.html#3835518">c</a></span><span class="op" id="3835555">.</span><span class="ident" id="3835556">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835562">if</span>&nbsp;<span class="ident" id="3835565"><a href="/crypto/tls/common.go.html#3835549">t</a></span>&nbsp;<span class="op" id="3835567">==</span>&nbsp;<span class="ident" id="3835570">nil</span>&nbsp;<span class="op" id="3835574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835578"><a href="/crypto/tls/common.go.html#3835549">t</a></span>&nbsp;<span class="op" id="3835580">=</span>&nbsp;<span class="ident" id="3835582"><a href="/crypto/tls/common.go.html#3822753">time</a></span><span class="op" id="3835586">.</span><span class="ident" id="3835587">Now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835595">return</span>&nbsp;<span class="ident" id="3835602"><a href="/crypto/tls/common.go.html#3835549">t</a></span><span class="op" id="3835603">(</span><span class="op" id="3835604">)</span><br>
<span class="lineno">380</span><span class="op" id="3835606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3835609">func</span>&nbsp;<span class="op" id="3835614">(</span><span class="ident" id="3835615">c</span>&nbsp;<span class="op" id="3835617">*</span><span class="ident" id="3835618"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835624">)</span>&nbsp;<span class="ident" id="3835626">cipherSuites</span><span class="op" id="3835638">(</span><span class="op" id="3835639">)</span>&nbsp;<span class="op" id="3835641">[</span><span class="op" id="3835642">]</span><span class="builtintype" id="3835643">uint16</span>&nbsp;<span class="op" id="3835650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835653">s</span>&nbsp;<span class="op" id="3835655">:=</span>&nbsp;<span class="ident" id="3835658"><a href="/crypto/tls/common.go.html#3835615">c</a></span><span class="op" id="3835659">.</span><span class="ident" id="3835660">CipherSuites</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835674">if</span>&nbsp;<span class="ident" id="3835677"><a href="/crypto/tls/common.go.html#3835653">s</a></span>&nbsp;<span class="op" id="3835679">==</span>&nbsp;<span class="ident" id="3835682">nil</span>&nbsp;<span class="op" id="3835686">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835690"><a href="/crypto/tls/common.go.html#3835653">s</a></span>&nbsp;<span class="op" id="3835692">=</span>&nbsp;<span class="ident" id="3835694"><a href="/crypto/tls/common.go.html#3841361">defaultCipherSuites</a></span><span class="op" id="3835713">(</span><span class="op" id="3835714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835720">return</span>&nbsp;<span class="ident" id="3835727"><a href="/crypto/tls/common.go.html#3835653">s</a></span><br>
<span class="lineno"></span><span class="op" id="3835729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="3835732">func</span>&nbsp;<span class="op" id="3835737">(</span><span class="ident" id="3835738">c</span>&nbsp;<span class="op" id="3835740">*</span><span class="ident" id="3835741"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835747">)</span>&nbsp;<span class="ident" id="3835749">minVersion</span><span class="op" id="3835759">(</span><span class="op" id="3835760">)</span>&nbsp;<span class="builtintype" id="3835762">uint16</span>&nbsp;<span class="op" id="3835769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835772">if</span>&nbsp;<span class="ident" id="3835775"><a href="/crypto/tls/common.go.html#3835738">c</a></span>&nbsp;<span class="op" id="3835777">==</span>&nbsp;<span class="ident" id="3835780">nil</span>&nbsp;<span class="op" id="3835784">||</span>&nbsp;<span class="ident" id="3835787"><a href="/crypto/tls/common.go.html#3835738">c</a></span><span class="op" id="3835788">.</span><span class="ident" id="3835789">MinVersion</span>&nbsp;<span class="op" id="3835800">==</span>&nbsp;<span class="num" id="3835803">0</span>&nbsp;<span class="op" id="3835805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835809">return</span>&nbsp;<span class="ident" id="3835816"><a href="/crypto/tls/common.go.html#3823157">minVersion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835831">return</span>&nbsp;<span class="ident" id="3835838"><a href="/crypto/tls/common.go.html#3835738">c</a></span><span class="op" id="3835839">.</span><span class="ident" id="3835840">MinVersion</span><br>
<span class="lineno">395</span><span class="op" id="3835851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3835854">func</span>&nbsp;<span class="op" id="3835859">(</span><span class="ident" id="3835860">c</span>&nbsp;<span class="op" id="3835862">*</span><span class="ident" id="3835863"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3835869">)</span>&nbsp;<span class="ident" id="3835871">maxVersion</span><span class="op" id="3835881">(</span><span class="op" id="3835882">)</span>&nbsp;<span class="builtintype" id="3835884">uint16</span>&nbsp;<span class="op" id="3835891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835894">if</span>&nbsp;<span class="ident" id="3835897"><a href="/crypto/tls/common.go.html#3835860">c</a></span>&nbsp;<span class="op" id="3835899">==</span>&nbsp;<span class="ident" id="3835902">nil</span>&nbsp;<span class="op" id="3835906">||</span>&nbsp;<span class="ident" id="3835909"><a href="/crypto/tls/common.go.html#3835860">c</a></span><span class="op" id="3835910">.</span><span class="ident" id="3835911">MaxVersion</span>&nbsp;<span class="op" id="3835922">==</span>&nbsp;<span class="num" id="3835925">0</span>&nbsp;<span class="op" id="3835927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835931">return</span>&nbsp;<span class="ident" id="3835938"><a href="/crypto/tls/common.go.html#3823184">maxVersion</a></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835953">return</span>&nbsp;<span class="ident" id="3835960"><a href="/crypto/tls/common.go.html#3835860">c</a></span><span class="op" id="3835961">.</span><span class="ident" id="3835962">MaxVersion</span><br>
<span class="lineno"></span><span class="op" id="3835973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3835976">var</span>&nbsp;<span class="ident" id="3835980">defaultCurvePreferences</span>&nbsp;<span class="op" id="3836004">=</span>&nbsp;<span class="op" id="3836006">[</span><span class="op" id="3836007">]</span><span class="ident" id="3836008"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><span class="op" id="3836015">{</span><span class="ident" id="3836016"><a href="/crypto/tls/common.go.html#3824698">CurveP256</a></span><span class="op" id="3836025">,</span>&nbsp;<span class="ident" id="3836027"><a href="/crypto/tls/common.go.html#3824722">CurveP384</a></span><span class="op" id="3836036">,</span>&nbsp;<span class="ident" id="3836038"><a href="/crypto/tls/common.go.html#3824746">CurveP521</a></span><span class="op" id="3836047">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3836050">func</span>&nbsp;<span class="op" id="3836055">(</span><span class="ident" id="3836056">c</span>&nbsp;<span class="op" id="3836058">*</span><span class="ident" id="3836059"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3836065">)</span>&nbsp;<span class="ident" id="3836067">curvePreferences</span><span class="op" id="3836083">(</span><span class="op" id="3836084">)</span>&nbsp;<span class="op" id="3836086">[</span><span class="op" id="3836087">]</span><span class="ident" id="3836088"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span>&nbsp;<span class="op" id="3836096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836099">if</span>&nbsp;<span class="ident" id="3836102"><a href="/crypto/tls/common.go.html#3836056">c</a></span>&nbsp;<span class="op" id="3836104">==</span>&nbsp;<span class="ident" id="3836107">nil</span>&nbsp;<span class="op" id="3836111">||</span>&nbsp;<span class="builtinfunc" id="3836114">len</span><span class="op" id="3836117">(</span><span class="ident" id="3836118"><a href="/crypto/tls/common.go.html#3836056">c</a></span><span class="op" id="3836119">.</span><span class="ident" id="3836120">CurvePreferences</span><span class="op" id="3836136">)</span>&nbsp;<span class="op" id="3836138">==</span>&nbsp;<span class="num" id="3836141">0</span>&nbsp;<span class="op" id="3836143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836147">return</span>&nbsp;<span class="ident" id="3836154"><a href="/crypto/tls/common.go.html#3835980">defaultCurvePreferences</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836179">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836182">return</span>&nbsp;<span class="ident" id="3836189"><a href="/crypto/tls/common.go.html#3836056">c</a></span><span class="op" id="3836190">.</span><span class="ident" id="3836191">CurvePreferences</span><br>
<span class="lineno"></span><span class="op" id="3836208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3836211">//&nbsp;mutualVersion&nbsp;returns&nbsp;the&nbsp;protocol&nbsp;version&nbsp;to&nbsp;use&nbsp;given&nbsp;the&nbsp;advertised</span><br>
<span class="lineno"></span><span class="comment" id="3836285">//&nbsp;version&nbsp;of&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">415</span><span class="keyword" id="3836309">func</span>&nbsp;<span class="op" id="3836314">(</span><span class="ident" id="3836315">c</span>&nbsp;<span class="op" id="3836317">*</span><span class="ident" id="3836318"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3836324">)</span>&nbsp;<span class="ident" id="3836326">mutualVersion</span><span class="op" id="3836339">(</span><span class="ident" id="3836340">vers</span>&nbsp;<span class="builtintype" id="3836345">uint16</span><span class="op" id="3836351">)</span>&nbsp;<span class="op" id="3836353">(</span><span class="builtintype" id="3836354">uint16</span><span class="op" id="3836360">,</span>&nbsp;<span class="builtintype" id="3836362">bool</span><span class="op" id="3836366">)</span>&nbsp;<span class="op" id="3836368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836371">minVersion</span>&nbsp;<span class="op" id="3836382">:=</span>&nbsp;<span class="ident" id="3836385"><a href="/crypto/tls/common.go.html#3836315">c</a></span><span class="op" id="3836386">.</span><span class="ident" id="3836387">minVersion</span><span class="op" id="3836397">(</span><span class="op" id="3836398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836401">maxVersion</span>&nbsp;<span class="op" id="3836412">:=</span>&nbsp;<span class="ident" id="3836415"><a href="/crypto/tls/common.go.html#3836315">c</a></span><span class="op" id="3836416">.</span><span class="ident" id="3836417">maxVersion</span><span class="op" id="3836427">(</span><span class="op" id="3836428">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836432">if</span>&nbsp;<span class="ident" id="3836435"><a href="/crypto/tls/common.go.html#3836340">vers</a></span>&nbsp;<span class="op" id="3836440">&lt;</span>&nbsp;<span class="ident" id="3836442"><a href="/crypto/tls/common.go.html#3836371">minVersion</a></span>&nbsp;<span class="op" id="3836453">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836457">return</span>&nbsp;<span class="num" id="3836464">0</span><span class="op" id="3836465">,</span>&nbsp;<span class="builtintype" id="3836467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836477">if</span>&nbsp;<span class="ident" id="3836480"><a href="/crypto/tls/common.go.html#3836340">vers</a></span>&nbsp;<span class="op" id="3836485">&gt;</span>&nbsp;<span class="ident" id="3836487"><a href="/crypto/tls/common.go.html#3836401">maxVersion</a></span>&nbsp;<span class="op" id="3836498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836502"><a href="/crypto/tls/common.go.html#3836340">vers</a></span>&nbsp;<span class="op" id="3836507">=</span>&nbsp;<span class="ident" id="3836509"><a href="/crypto/tls/common.go.html#3836401">maxVersion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836521">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836524">return</span>&nbsp;<span class="ident" id="3836531"><a href="/crypto/tls/common.go.html#3836340">vers</a></span><span class="op" id="3836535">,</span>&nbsp;<span class="builtintype" id="3836537">true</span><br>
<span class="lineno"></span><span class="op" id="3836542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3836545">//&nbsp;getCertificate&nbsp;returns&nbsp;the&nbsp;best&nbsp;certificate&nbsp;for&nbsp;the&nbsp;given&nbsp;ClientHelloInfo,</span><br>
<span class="lineno"></span><span class="comment" id="3836623">//&nbsp;defaulting&nbsp;to&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;c.Certificates.</span><br>
<span class="lineno">430</span><span class="keyword" id="3836677">func</span>&nbsp;<span class="op" id="3836682">(</span><span class="ident" id="3836683">c</span>&nbsp;<span class="op" id="3836685">*</span><span class="ident" id="3836686"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3836692">)</span>&nbsp;<span class="ident" id="3836694">getCertificate</span><span class="op" id="3836708">(</span><span class="ident" id="3836709">clientHello</span>&nbsp;<span class="op" id="3836721">*</span><span class="ident" id="3836722"><a href="/crypto/tls/common.go.html#3829703">ClientHelloInfo</a></span><span class="op" id="3836737">)</span>&nbsp;<span class="op" id="3836739">(</span><span class="op" id="3836740">*</span><span class="ident" id="3836741"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><span class="op" id="3836752">,</span>&nbsp;<span class="builtintype" id="3836754">error</span><span class="op" id="3836759">)</span>&nbsp;<span class="op" id="3836761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836764">if</span>&nbsp;<span class="ident" id="3836767"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3836768">.</span><span class="ident" id="3836769">GetCertificate</span>&nbsp;<span class="op" id="3836784">!=</span>&nbsp;<span class="ident" id="3836787">nil</span>&nbsp;<span class="op" id="3836791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836795">cert</span><span class="op" id="3836799">,</span>&nbsp;<span class="ident" id="3836801">err</span>&nbsp;<span class="op" id="3836805">:=</span>&nbsp;<span class="ident" id="3836808"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3836809">.</span><span class="ident" id="3836810">GetCertificate</span><span class="op" id="3836824">(</span><span class="ident" id="3836825"><a href="/crypto/tls/common.go.html#3836709">clientHello</a></span><span class="op" id="3836836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836840">if</span>&nbsp;<span class="ident" id="3836843"><a href="/crypto/tls/common.go.html#3836795">cert</a></span>&nbsp;<span class="op" id="3836848">!=</span>&nbsp;<span class="ident" id="3836851">nil</span>&nbsp;<span class="op" id="3836855">||</span>&nbsp;<span class="ident" id="3836858"><a href="/crypto/tls/common.go.html#3836801">err</a></span>&nbsp;<span class="op" id="3836862">!=</span>&nbsp;<span class="ident" id="3836865">nil</span>&nbsp;<span class="op" id="3836869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836874">return</span>&nbsp;<span class="ident" id="3836881"><a href="/crypto/tls/common.go.html#3836795">cert</a></span><span class="op" id="3836885">,</span>&nbsp;<span class="ident" id="3836887"><a href="/crypto/tls/common.go.html#3836801">err</a></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836900">if</span>&nbsp;<span class="builtinfunc" id="3836903">len</span><span class="op" id="3836906">(</span><span class="ident" id="3836907"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3836908">.</span><span class="ident" id="3836909">Certificates</span><span class="op" id="3836921">)</span>&nbsp;<span class="op" id="3836923">==</span>&nbsp;<span class="num" id="3836926">1</span>&nbsp;<span class="op" id="3836928">||</span>&nbsp;<span class="ident" id="3836931"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3836932">.</span><span class="ident" id="3836933">NameToCertificate</span>&nbsp;<span class="op" id="3836951">==</span>&nbsp;<span class="ident" id="3836954">nil</span>&nbsp;<span class="op" id="3836958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3836962">//&nbsp;There&#39;s&nbsp;only&nbsp;one&nbsp;choice,&nbsp;so&nbsp;no&nbsp;point&nbsp;doing&nbsp;any&nbsp;work.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837020">return</span>&nbsp;<span class="op" id="3837027">&amp;</span><span class="ident" id="3837028"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3837029">.</span><span class="ident" id="3837030">Certificates</span><span class="op" id="3837042">[</span><span class="num" id="3837043">0</span><span class="op" id="3837044">]</span><span class="op" id="3837045">,</span>&nbsp;<span class="ident" id="3837047">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837056">name</span>&nbsp;<span class="op" id="3837061">:=</span>&nbsp;<span class="ident" id="3837064"><a href="/crypto/tls/common.go.html#3822734">strings</a></span><span class="op" id="3837071">.</span><span class="ident" id="3837072">ToLower</span><span class="op" id="3837079">(</span><span class="ident" id="3837080"><a href="/crypto/tls/common.go.html#3836709">clientHello</a></span><span class="op" id="3837091">.</span><span class="ident" id="3837092">ServerName</span><span class="op" id="3837102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837105">for</span>&nbsp;<span class="builtinfunc" id="3837109">len</span><span class="op" id="3837112">(</span><span class="ident" id="3837113"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837117">)</span>&nbsp;<span class="op" id="3837119">&gt;</span>&nbsp;<span class="num" id="3837121">0</span>&nbsp;<span class="op" id="3837123">&amp;&amp;</span>&nbsp;<span class="ident" id="3837126"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837130">[</span><span class="builtinfunc" id="3837131">len</span><span class="op" id="3837134">(</span><span class="ident" id="3837135"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837139">)</span><span class="op" id="3837140">-</span><span class="num" id="3837141">1</span><span class="op" id="3837142">]</span>&nbsp;<span class="op" id="3837144">==</span>&nbsp;<span class="string" id="3837147">&#39;.&#39;</span>&nbsp;<span class="op" id="3837151">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837155"><a href="/crypto/tls/common.go.html#3837056">name</a></span>&nbsp;<span class="op" id="3837160">=</span>&nbsp;<span class="ident" id="3837162"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837166">[</span><span class="op" id="3837167">:</span><span class="builtinfunc" id="3837168">len</span><span class="op" id="3837171">(</span><span class="ident" id="3837172"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837176">)</span><span class="op" id="3837177">-</span><span class="num" id="3837178">1</span><span class="op" id="3837179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837186">if</span>&nbsp;<span class="ident" id="3837189">cert</span><span class="op" id="3837193">,</span>&nbsp;<span class="ident" id="3837195">ok</span>&nbsp;<span class="op" id="3837198">:=</span>&nbsp;<span class="ident" id="3837201"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3837202">.</span><span class="ident" id="3837203">NameToCertificate</span><span class="op" id="3837220">[</span><span class="ident" id="3837221"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837225">]</span><span class="op" id="3837226">;</span>&nbsp;<span class="ident" id="3837228"><a href="/crypto/tls/common.go.html#3837195">ok</a></span>&nbsp;<span class="op" id="3837231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837235">return</span>&nbsp;<span class="ident" id="3837242"><a href="/crypto/tls/common.go.html#3837189">cert</a></span><span class="op" id="3837246">,</span>&nbsp;<span class="ident" id="3837248">nil</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3837257">//&nbsp;try&nbsp;replacing&nbsp;labels&nbsp;in&nbsp;the&nbsp;name&nbsp;with&nbsp;wildcards&nbsp;until&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3837324">//&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837335">labels</span>&nbsp;<span class="op" id="3837342">:=</span>&nbsp;<span class="ident" id="3837345"><a href="/crypto/tls/common.go.html#3822734">strings</a></span><span class="op" id="3837352">.</span><span class="ident" id="3837353">Split</span><span class="op" id="3837358">(</span><span class="ident" id="3837359"><a href="/crypto/tls/common.go.html#3837056">name</a></span><span class="op" id="3837363">,</span>&nbsp;<span class="string" id="3837365">&#34;.&#34;</span><span class="op" id="3837368">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837371">for</span>&nbsp;<span class="ident" id="3837375">i</span>&nbsp;<span class="op" id="3837377">:=</span>&nbsp;<span class="keyword" id="3837380">range</span>&nbsp;<span class="ident" id="3837386"><a href="/crypto/tls/common.go.html#3837335">labels</a></span>&nbsp;<span class="op" id="3837393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837397"><a href="/crypto/tls/common.go.html#3837335">labels</a></span><span class="op" id="3837403">[</span><span class="ident" id="3837404"><a href="/crypto/tls/common.go.html#3837375">i</a></span><span class="op" id="3837405">]</span>&nbsp;<span class="op" id="3837407">=</span>&nbsp;<span class="string" id="3837409">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837415">candidate</span>&nbsp;<span class="op" id="3837425">:=</span>&nbsp;<span class="ident" id="3837428"><a href="/crypto/tls/common.go.html#3822734">strings</a></span><span class="op" id="3837435">.</span><span class="ident" id="3837436">Join</span><span class="op" id="3837440">(</span><span class="ident" id="3837441"><a href="/crypto/tls/common.go.html#3837335">labels</a></span><span class="op" id="3837447">,</span>&nbsp;<span class="string" id="3837449">&#34;.&#34;</span><span class="op" id="3837452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837456">if</span>&nbsp;<span class="ident" id="3837459">cert</span><span class="op" id="3837463">,</span>&nbsp;<span class="ident" id="3837465">ok</span>&nbsp;<span class="op" id="3837468">:=</span>&nbsp;<span class="ident" id="3837471"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3837472">.</span><span class="ident" id="3837473">NameToCertificate</span><span class="op" id="3837490">[</span><span class="ident" id="3837491"><a href="/crypto/tls/common.go.html#3837415">candidate</a></span><span class="op" id="3837500">]</span><span class="op" id="3837501">;</span>&nbsp;<span class="ident" id="3837503"><a href="/crypto/tls/common.go.html#3837465">ok</a></span>&nbsp;<span class="op" id="3837506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837511">return</span>&nbsp;<span class="ident" id="3837518"><a href="/crypto/tls/common.go.html#3837459">cert</a></span><span class="op" id="3837522">,</span>&nbsp;<span class="ident" id="3837524">nil</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3837537">//&nbsp;If&nbsp;nothing&nbsp;matches,&nbsp;return&nbsp;the&nbsp;first&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837591">return</span>&nbsp;<span class="op" id="3837598">&amp;</span><span class="ident" id="3837599"><a href="/crypto/tls/common.go.html#3836683">c</a></span><span class="op" id="3837600">.</span><span class="ident" id="3837601">Certificates</span><span class="op" id="3837613">[</span><span class="num" id="3837614">0</span><span class="op" id="3837615">]</span><span class="op" id="3837616">,</span>&nbsp;<span class="ident" id="3837618">nil</span><br>
<span class="lineno">465</span><span class="op" id="3837622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3837625">//&nbsp;BuildNameToCertificate&nbsp;parses&nbsp;c.Certificates&nbsp;and&nbsp;builds&nbsp;c.NameToCertificate</span><br>
<span class="lineno"></span><span class="comment" id="3837704">//&nbsp;from&nbsp;the&nbsp;CommonName&nbsp;and&nbsp;SubjectAlternateName&nbsp;fields&nbsp;of&nbsp;each&nbsp;of&nbsp;the&nbsp;leaf</span><br>
<span class="lineno"></span><span class="comment" id="3837779">//&nbsp;certificates.</span><br>
<span class="lineno">470</span><span class="keyword" id="3837796">func</span>&nbsp;<span class="op" id="3837801">(</span><span class="ident" id="3837802">c</span>&nbsp;<span class="op" id="3837804">*</span><span class="ident" id="3837805"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="3837811">)</span>&nbsp;<span class="ident" id="3837813">BuildNameToCertificate</span><span class="op" id="3837835">(</span><span class="op" id="3837836">)</span>&nbsp;<span class="op" id="3837838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837841"><a href="/crypto/tls/common.go.html#3837802">c</a></span><span class="op" id="3837842">.</span><span class="ident" id="3837843">NameToCertificate</span>&nbsp;<span class="op" id="3837861">=</span>&nbsp;<span class="builtinfunc" id="3837863">make</span><span class="op" id="3837867">(</span><span class="keyword" id="3837868">map</span><span class="op" id="3837871">[</span><span class="builtintype" id="3837872">string</span><span class="op" id="3837878">]</span><span class="op" id="3837879">*</span><span class="ident" id="3837880"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><span class="op" id="3837891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837894">for</span>&nbsp;<span class="ident" id="3837898">i</span>&nbsp;<span class="op" id="3837900">:=</span>&nbsp;<span class="keyword" id="3837903">range</span>&nbsp;<span class="ident" id="3837909"><a href="/crypto/tls/common.go.html#3837802">c</a></span><span class="op" id="3837910">.</span><span class="ident" id="3837911">Certificates</span>&nbsp;<span class="op" id="3837924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837928">cert</span>&nbsp;<span class="op" id="3837933">:=</span>&nbsp;<span class="op" id="3837936">&amp;</span><span class="ident" id="3837937"><a href="/crypto/tls/common.go.html#3837802">c</a></span><span class="op" id="3837938">.</span><span class="ident" id="3837939">Certificates</span><span class="op" id="3837951">[</span><span class="ident" id="3837952"><a href="/crypto/tls/common.go.html#3837898">i</a></span><span class="op" id="3837953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837957">x509Cert</span><span class="op" id="3837965">,</span>&nbsp;<span class="ident" id="3837967">err</span>&nbsp;<span class="op" id="3837971">:=</span>&nbsp;<span class="ident" id="3837974"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3837978">.</span><span class="ident" id="3837979">ParseCertificate</span><span class="op" id="3837995">(</span><span class="ident" id="3837996"><a href="/crypto/tls/common.go.html#3837928">cert</a></span><span class="op" id="3838000">.</span><span class="ident" id="3838001">Certificate</span><span class="op" id="3838012">[</span><span class="num" id="3838013">0</span><span class="op" id="3838014">]</span><span class="op" id="3838015">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838019">if</span>&nbsp;<span class="ident" id="3838022"><a href="/crypto/tls/common.go.html#3837967">err</a></span>&nbsp;<span class="op" id="3838026">!=</span>&nbsp;<span class="ident" id="3838029">nil</span>&nbsp;<span class="op" id="3838033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838038">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838053">if</span>&nbsp;<span class="builtinfunc" id="3838056">len</span><span class="op" id="3838059">(</span><span class="ident" id="3838060"><a href="/crypto/tls/common.go.html#3837957">x509Cert</a></span><span class="op" id="3838068">.</span><span class="ident" id="3838069">Subject</span><span class="op" id="3838076">.</span><span class="ident" id="3838077">CommonName</span><span class="op" id="3838087">)</span>&nbsp;<span class="op" id="3838089">&gt;</span>&nbsp;<span class="num" id="3838091">0</span>&nbsp;<span class="op" id="3838093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838098"><a href="/crypto/tls/common.go.html#3837802">c</a></span><span class="op" id="3838099">.</span><span class="ident" id="3838100">NameToCertificate</span><span class="op" id="3838117">[</span><span class="ident" id="3838118"><a href="/crypto/tls/common.go.html#3837957">x509Cert</a></span><span class="op" id="3838126">.</span><span class="ident" id="3838127">Subject</span><span class="op" id="3838134">.</span><span class="ident" id="3838135">CommonName</span><span class="op" id="3838145">]</span>&nbsp;<span class="op" id="3838147">=</span>&nbsp;<span class="ident" id="3838149"><a href="/crypto/tls/common.go.html#3837928">cert</a></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838160">for</span>&nbsp;<span class="ident" id="3838164">_</span><span class="op" id="3838165">,</span>&nbsp;<span class="ident" id="3838167">san</span>&nbsp;<span class="op" id="3838171">:=</span>&nbsp;<span class="keyword" id="3838174">range</span>&nbsp;<span class="ident" id="3838180"><a href="/crypto/tls/common.go.html#3837957">x509Cert</a></span><span class="op" id="3838188">.</span><span class="ident" id="3838189">DNSNames</span>&nbsp;<span class="op" id="3838198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838203"><a href="/crypto/tls/common.go.html#3837802">c</a></span><span class="op" id="3838204">.</span><span class="ident" id="3838205">NameToCertificate</span><span class="op" id="3838222">[</span><span class="ident" id="3838223"><a href="/crypto/tls/common.go.html#3838167">san</a></span><span class="op" id="3838226">]</span>&nbsp;<span class="op" id="3838228">=</span>&nbsp;<span class="ident" id="3838230"><a href="/crypto/tls/common.go.html#3837928">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838240">}</span><br>
<span class="lineno">485</span><span class="op" id="3838242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3838245">//&nbsp;A&nbsp;Certificate&nbsp;is&nbsp;a&nbsp;chain&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates,&nbsp;leaf&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="3838314">type</span>&nbsp;<span class="ident" id="3838319">Certificate</span>&nbsp;<span class="keyword" id="3838331">struct</span>&nbsp;<span class="op" id="3838338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838341">Certificate</span>&nbsp;<span class="op" id="3838353">[</span><span class="op" id="3838354">]</span><span class="op" id="3838355">[</span><span class="op" id="3838356">]</span><span class="builtintype" id="3838357">byte</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838363">//&nbsp;PrivateKey&nbsp;contains&nbsp;the&nbsp;private&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;public&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838435">//&nbsp;in&nbsp;Leaf.&nbsp;For&nbsp;a&nbsp;server,&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;*rsa.PrivateKey&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838496">//&nbsp;*ecdsa.PrivateKey.&nbsp;For&nbsp;a&nbsp;client&nbsp;doing&nbsp;client&nbsp;authentication,&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838566">//&nbsp;can&nbsp;be&nbsp;any&nbsp;type&nbsp;that&nbsp;implements&nbsp;crypto.Signer&nbsp;(which&nbsp;includes&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838636">//&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys).</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838665">PrivateKey</span>&nbsp;<span class="ident" id="3838676"><a href="/crypto/tls/common.go.html#3822669">crypto</a></span><span class="op" id="3838682">.</span><span class="ident" id="3838683">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838695">//&nbsp;OCSPStaple&nbsp;contains&nbsp;an&nbsp;optional&nbsp;OCSP&nbsp;response&nbsp;which&nbsp;will&nbsp;be&nbsp;served</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838766">//&nbsp;to&nbsp;clients&nbsp;that&nbsp;request&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838798">OCSPStaple</span>&nbsp;<span class="op" id="3838809">[</span><span class="op" id="3838810">]</span><span class="builtintype" id="3838811">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838817">//&nbsp;Leaf&nbsp;is&nbsp;the&nbsp;parsed&nbsp;form&nbsp;of&nbsp;the&nbsp;leaf&nbsp;certificate,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838883">//&nbsp;initialized&nbsp;using&nbsp;x509.ParseCertificate&nbsp;to&nbsp;reduce&nbsp;per-handshake</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838951">//&nbsp;processing&nbsp;for&nbsp;TLS&nbsp;clients&nbsp;doing&nbsp;client&nbsp;authentication.&nbsp;If&nbsp;nil,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3839023">//&nbsp;leaf&nbsp;certificate&nbsp;will&nbsp;be&nbsp;parsed&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839070">Leaf</span>&nbsp;<span class="op" id="3839075">*</span><span class="ident" id="3839076"><a href="/crypto/tls/common.go.html#3822694">x509</a></span><span class="op" id="3839080">.</span><span class="ident" id="3839081">Certificate</span><br>
<span class="lineno"></span><span class="op" id="3839093">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="3839096">//&nbsp;A&nbsp;TLS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3839113">type</span>&nbsp;<span class="ident" id="3839118">record</span>&nbsp;<span class="keyword" id="3839125">struct</span>&nbsp;<span class="op" id="3839132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839135">contentType</span>&nbsp;&nbsp;<span class="ident" id="3839148"><a href="/crypto/tls/common.go.html#3823239">recordType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839160">major</span><span class="op" id="3839165">,</span>&nbsp;<span class="ident" id="3839167">minor</span>&nbsp;<span class="builtintype" id="3839173">uint8</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839180">payload</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3839193">[</span><span class="op" id="3839194">]</span><span class="builtintype" id="3839195">byte</span><br>
<span class="lineno"></span><span class="op" id="3839200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3839203">type</span>&nbsp;<span class="ident" id="3839208">handshakeMessage</span>&nbsp;<span class="keyword" id="3839225">interface</span>&nbsp;<span class="op" id="3839235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839238">marshal</span><span class="op" id="3839245">(</span><span class="op" id="3839246">)</span>&nbsp;<span class="op" id="3839248">[</span><span class="op" id="3839249">]</span><span class="builtintype" id="3839250">byte</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839256">unmarshal</span><span class="op" id="3839265">(</span><span class="op" id="3839266">[</span><span class="op" id="3839267">]</span><span class="builtintype" id="3839268">byte</span><span class="op" id="3839272">)</span>&nbsp;<span class="builtintype" id="3839274">bool</span><br>
<span class="lineno"></span><span class="op" id="3839279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3839282">//&nbsp;lruSessionCache&nbsp;is&nbsp;a&nbsp;ClientSessionCache&nbsp;implementation&nbsp;that&nbsp;uses&nbsp;an&nbsp;LRU</span><br>
<span class="lineno"></span><span class="comment" id="3839357">//&nbsp;caching&nbsp;strategy.</span><br>
<span class="lineno">520</span><span class="keyword" id="3839378">type</span>&nbsp;<span class="ident" id="3839383">lruSessionCache</span>&nbsp;<span class="keyword" id="3839399">struct</span>&nbsp;<span class="op" id="3839406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839409"><a href="/crypto/tls/common.go.html#3822745">sync</a></span><span class="op" id="3839413">.</span><span class="ident" id="3839414">Mutex</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839422">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3839431">map</span><span class="op" id="3839434">[</span><span class="builtintype" id="3839435">string</span><span class="op" id="3839441">]</span><span class="op" id="3839442">*</span><span class="ident" id="3839443"><a href="/crypto/tls/common.go.html#3822651">list</a></span><span class="op" id="3839447">.</span><span class="ident" id="3839448">Element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839457">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3839466">*</span><span class="ident" id="3839467"><a href="/crypto/tls/common.go.html#3822651">list</a></span><span class="op" id="3839471">.</span><span class="ident" id="3839472">List</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839478">capacity</span>&nbsp;<span class="builtintype" id="3839487">int</span><br>
<span class="lineno"></span><span class="op" id="3839491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3839494">type</span>&nbsp;<span class="ident" id="3839499">lruSessionCacheEntry</span>&nbsp;<span class="keyword" id="3839520">struct</span>&nbsp;<span class="op" id="3839527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839530">sessionKey</span>&nbsp;<span class="builtintype" id="3839541">string</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839549">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3839560">*</span><span class="ident" id="3839561"><a href="/crypto/tls/common.go.html#3828491">ClientSessionState</a></span><br>
<span class="lineno"></span><span class="op" id="3839580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3839583">//&nbsp;NewLRUClientSessionCache&nbsp;returns&nbsp;a&nbsp;ClientSessionCache&nbsp;with&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3839655">//&nbsp;capacity&nbsp;that&nbsp;uses&nbsp;an&nbsp;LRU&nbsp;strategy.&nbsp;If&nbsp;capacity&nbsp;is&nbsp;&lt;&nbsp;1,&nbsp;a&nbsp;default&nbsp;capacity</span><br>
<span class="lineno">535</span><span class="comment" id="3839733">//&nbsp;is&nbsp;used&nbsp;instead.</span><br>
<span class="lineno"></span><span class="keyword" id="3839753">func</span>&nbsp;<span class="ident" id="3839758">NewLRUClientSessionCache</span><span class="op" id="3839782">(</span><span class="ident" id="3839783">capacity</span>&nbsp;<span class="builtintype" id="3839792">int</span><span class="op" id="3839795">)</span>&nbsp;<span class="ident" id="3839797"><a href="/crypto/tls/common.go.html#3829224">ClientSessionCache</a></span>&nbsp;<span class="op" id="3839816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839819">const</span>&nbsp;<span class="ident" id="3839825">defaultSessionCacheCapacity</span>&nbsp;<span class="op" id="3839853">=</span>&nbsp;<span class="num" id="3839855">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839860">if</span>&nbsp;<span class="ident" id="3839863"><a href="/crypto/tls/common.go.html#3839783">capacity</a></span>&nbsp;<span class="op" id="3839872">&lt;</span>&nbsp;<span class="num" id="3839874">1</span>&nbsp;<span class="op" id="3839876">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839880"><a href="/crypto/tls/common.go.html#3839783">capacity</a></span>&nbsp;<span class="op" id="3839889">=</span>&nbsp;<span class="ident" id="3839891"><a href="/crypto/tls/common.go.html#3839825">defaultSessionCacheCapacity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839923">return</span>&nbsp;<span class="op" id="3839930">&amp;</span><span class="ident" id="3839931"><a href="/crypto/tls/common.go.html#3839383">lruSessionCache</a></span><span class="op" id="3839946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839950">m</span><span class="op" id="3839951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3839960">make</span><span class="op" id="3839964">(</span><span class="keyword" id="3839965">map</span><span class="op" id="3839968">[</span><span class="builtintype" id="3839969">string</span><span class="op" id="3839975">]</span><span class="op" id="3839976">*</span><span class="ident" id="3839977"><a href="/crypto/tls/common.go.html#3822651">list</a></span><span class="op" id="3839981">.</span><span class="ident" id="3839982">Element</span><span class="op" id="3839989">)</span><span class="op" id="3839990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839994">q</span><span class="op" id="3839995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3840004"><a href="/crypto/tls/common.go.html#3822651">list</a></span><span class="op" id="3840008">.</span><span class="ident" id="3840009">New</span><span class="op" id="3840012">(</span><span class="op" id="3840013">)</span><span class="op" id="3840014">,</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840018">capacity</span><span class="op" id="3840026">:</span>&nbsp;<span class="ident" id="3840028"><a href="/crypto/tls/common.go.html#3839783">capacity</a></span><span class="op" id="3840036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840039">}</span><br>
<span class="lineno"></span><span class="op" id="3840041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3840044">//&nbsp;Put&nbsp;adds&nbsp;the&nbsp;provided&nbsp;(sessionKey,&nbsp;cs)&nbsp;pair&nbsp;to&nbsp;the&nbsp;cache.</span><br>
<span class="lineno">550</span><span class="keyword" id="3840105">func</span>&nbsp;<span class="op" id="3840110">(</span><span class="ident" id="3840111">c</span>&nbsp;<span class="op" id="3840113">*</span><span class="ident" id="3840114"><a href="/crypto/tls/common.go.html#3839383">lruSessionCache</a></span><span class="op" id="3840129">)</span>&nbsp;<span class="ident" id="3840131">Put</span><span class="op" id="3840134">(</span><span class="ident" id="3840135">sessionKey</span>&nbsp;<span class="builtintype" id="3840146">string</span><span class="op" id="3840152">,</span>&nbsp;<span class="ident" id="3840154">cs</span>&nbsp;<span class="op" id="3840157">*</span><span class="ident" id="3840158"><a href="/crypto/tls/common.go.html#3828491">ClientSessionState</a></span><span class="op" id="3840176">)</span>&nbsp;<span class="op" id="3840178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840181"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840182">.</span><span class="ident" id="3840183">Lock</span><span class="op" id="3840187">(</span><span class="op" id="3840188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840191">defer</span>&nbsp;<span class="ident" id="3840197"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840198">.</span><span class="ident" id="3840199">Unlock</span><span class="op" id="3840205">(</span><span class="op" id="3840206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840210">if</span>&nbsp;<span class="ident" id="3840213">elem</span><span class="op" id="3840217">,</span>&nbsp;<span class="ident" id="3840219">ok</span>&nbsp;<span class="op" id="3840222">:=</span>&nbsp;<span class="ident" id="3840225"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840226">.</span><span class="ident" id="3840227">m</span><span class="op" id="3840228">[</span><span class="ident" id="3840229"><a href="/crypto/tls/common.go.html#3840135">sessionKey</a></span><span class="op" id="3840239">]</span><span class="op" id="3840240">;</span>&nbsp;<span class="ident" id="3840242"><a href="/crypto/tls/common.go.html#3840219">ok</a></span>&nbsp;<span class="op" id="3840245">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840249">entry</span>&nbsp;<span class="op" id="3840255">:=</span>&nbsp;<span class="ident" id="3840258"><a href="/crypto/tls/common.go.html#3840213">elem</a></span><span class="op" id="3840262">.</span><span class="ident" id="3840263">Value</span><span class="op" id="3840268">.</span><span class="op" id="3840269">(</span><span class="op" id="3840270">*</span><span class="ident" id="3840271"><a href="/crypto/tls/common.go.html#3839499">lruSessionCacheEntry</a></span><span class="op" id="3840291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840295"><a href="/crypto/tls/common.go.html#3840249">entry</a></span><span class="op" id="3840300">.</span><span class="ident" id="3840301">state</span>&nbsp;<span class="op" id="3840307">=</span>&nbsp;<span class="ident" id="3840309"><a href="/crypto/tls/common.go.html#3840154">cs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840314"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840315">.</span><span class="ident" id="3840316">q</span><span class="op" id="3840317">.</span><span class="ident" id="3840318">MoveToFront</span><span class="op" id="3840329">(</span><span class="ident" id="3840330"><a href="/crypto/tls/common.go.html#3840213">elem</a></span><span class="op" id="3840334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840338">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840346">}</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840350">if</span>&nbsp;<span class="ident" id="3840353"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840354">.</span><span class="ident" id="3840355">q</span><span class="op" id="3840356">.</span><span class="ident" id="3840357">Len</span><span class="op" id="3840360">(</span><span class="op" id="3840361">)</span>&nbsp;<span class="op" id="3840363">&lt;</span>&nbsp;<span class="ident" id="3840365"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840366">.</span><span class="ident" id="3840367">capacity</span>&nbsp;<span class="op" id="3840376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840380">entry</span>&nbsp;<span class="op" id="3840386">:=</span>&nbsp;<span class="op" id="3840389">&amp;</span><span class="ident" id="3840390"><a href="/crypto/tls/common.go.html#3839499">lruSessionCacheEntry</a></span><span class="op" id="3840410">{</span><span class="ident" id="3840411"><a href="/crypto/tls/common.go.html#3840135">sessionKey</a></span><span class="op" id="3840421">,</span>&nbsp;<span class="ident" id="3840423"><a href="/crypto/tls/common.go.html#3840154">cs</a></span><span class="op" id="3840425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840429"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840430">.</span><span class="ident" id="3840431">m</span><span class="op" id="3840432">[</span><span class="ident" id="3840433"><a href="/crypto/tls/common.go.html#3840135">sessionKey</a></span><span class="op" id="3840443">]</span>&nbsp;<span class="op" id="3840445">=</span>&nbsp;<span class="ident" id="3840447"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840448">.</span><span class="ident" id="3840449">q</span><span class="op" id="3840450">.</span><span class="ident" id="3840451">PushFront</span><span class="op" id="3840460">(</span><span class="ident" id="3840461"><a href="/crypto/tls/common.go.html#3840380">entry</a></span><span class="op" id="3840466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840470">return</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840482">elem</span>&nbsp;<span class="op" id="3840487">:=</span>&nbsp;<span class="ident" id="3840490"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840491">.</span><span class="ident" id="3840492">q</span><span class="op" id="3840493">.</span><span class="ident" id="3840494">Back</span><span class="op" id="3840498">(</span><span class="op" id="3840499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840502">entry</span>&nbsp;<span class="op" id="3840508">:=</span>&nbsp;<span class="ident" id="3840511"><a href="/crypto/tls/common.go.html#3840482">elem</a></span><span class="op" id="3840515">.</span><span class="ident" id="3840516">Value</span><span class="op" id="3840521">.</span><span class="op" id="3840522">(</span><span class="op" id="3840523">*</span><span class="ident" id="3840524"><a href="/crypto/tls/common.go.html#3839499">lruSessionCacheEntry</a></span><span class="op" id="3840544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3840547">delete</span><span class="op" id="3840553">(</span><span class="ident" id="3840554"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840555">.</span><span class="ident" id="3840556">m</span><span class="op" id="3840557">,</span>&nbsp;<span class="ident" id="3840559"><a href="/crypto/tls/common.go.html#3840502">entry</a></span><span class="op" id="3840564">.</span><span class="ident" id="3840565">sessionKey</span><span class="op" id="3840575">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840578"><a href="/crypto/tls/common.go.html#3840502">entry</a></span><span class="op" id="3840583">.</span><span class="ident" id="3840584">sessionKey</span>&nbsp;<span class="op" id="3840595">=</span>&nbsp;<span class="ident" id="3840597"><a href="/crypto/tls/common.go.html#3840135">sessionKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840609"><a href="/crypto/tls/common.go.html#3840502">entry</a></span><span class="op" id="3840614">.</span><span class="ident" id="3840615">state</span>&nbsp;<span class="op" id="3840621">=</span>&nbsp;<span class="ident" id="3840623"><a href="/crypto/tls/common.go.html#3840154">cs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840627"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840628">.</span><span class="ident" id="3840629">q</span><span class="op" id="3840630">.</span><span class="ident" id="3840631">MoveToFront</span><span class="op" id="3840642">(</span><span class="ident" id="3840643"><a href="/crypto/tls/common.go.html#3840482">elem</a></span><span class="op" id="3840647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840650"><a href="/crypto/tls/common.go.html#3840111">c</a></span><span class="op" id="3840651">.</span><span class="ident" id="3840652">m</span><span class="op" id="3840653">[</span><span class="ident" id="3840654"><a href="/crypto/tls/common.go.html#3840135">sessionKey</a></span><span class="op" id="3840664">]</span>&nbsp;<span class="op" id="3840666">=</span>&nbsp;<span class="ident" id="3840668"><a href="/crypto/tls/common.go.html#3840482">elem</a></span><br>
<span class="lineno"></span><span class="op" id="3840673">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3840676">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;ClientSessionState&nbsp;value&nbsp;associated&nbsp;with&nbsp;a&nbsp;given&nbsp;key.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="3840752">//&nbsp;returns&nbsp;(nil,&nbsp;false)&nbsp;if&nbsp;no&nbsp;value&nbsp;is&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="3840798">func</span>&nbsp;<span class="op" id="3840803">(</span><span class="ident" id="3840804">c</span>&nbsp;<span class="op" id="3840806">*</span><span class="ident" id="3840807"><a href="/crypto/tls/common.go.html#3839383">lruSessionCache</a></span><span class="op" id="3840822">)</span>&nbsp;<span class="ident" id="3840824">Get</span><span class="op" id="3840827">(</span><span class="ident" id="3840828">sessionKey</span>&nbsp;<span class="builtintype" id="3840839">string</span><span class="op" id="3840845">)</span>&nbsp;<span class="op" id="3840847">(</span><span class="op" id="3840848">*</span><span class="ident" id="3840849"><a href="/crypto/tls/common.go.html#3828491">ClientSessionState</a></span><span class="op" id="3840867">,</span>&nbsp;<span class="builtintype" id="3840869">bool</span><span class="op" id="3840873">)</span>&nbsp;<span class="op" id="3840875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840878"><a href="/crypto/tls/common.go.html#3840804">c</a></span><span class="op" id="3840879">.</span><span class="ident" id="3840880">Lock</span><span class="op" id="3840884">(</span><span class="op" id="3840885">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840888">defer</span>&nbsp;<span class="ident" id="3840894"><a href="/crypto/tls/common.go.html#3840804">c</a></span><span class="op" id="3840895">.</span><span class="ident" id="3840896">Unlock</span><span class="op" id="3840902">(</span><span class="op" id="3840903">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840907">if</span>&nbsp;<span class="ident" id="3840910">elem</span><span class="op" id="3840914">,</span>&nbsp;<span class="ident" id="3840916">ok</span>&nbsp;<span class="op" id="3840919">:=</span>&nbsp;<span class="ident" id="3840922"><a href="/crypto/tls/common.go.html#3840804">c</a></span><span class="op" id="3840923">.</span><span class="ident" id="3840924">m</span><span class="op" id="3840925">[</span><span class="ident" id="3840926"><a href="/crypto/tls/common.go.html#3840828">sessionKey</a></span><span class="op" id="3840936">]</span><span class="op" id="3840937">;</span>&nbsp;<span class="ident" id="3840939"><a href="/crypto/tls/common.go.html#3840916">ok</a></span>&nbsp;<span class="op" id="3840942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840946"><a href="/crypto/tls/common.go.html#3840804">c</a></span><span class="op" id="3840947">.</span><span class="ident" id="3840948">q</span><span class="op" id="3840949">.</span><span class="ident" id="3840950">MoveToFront</span><span class="op" id="3840961">(</span><span class="ident" id="3840962"><a href="/crypto/tls/common.go.html#3840910">elem</a></span><span class="op" id="3840966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840970">return</span>&nbsp;<span class="ident" id="3840977"><a href="/crypto/tls/common.go.html#3840910">elem</a></span><span class="op" id="3840981">.</span><span class="ident" id="3840982">Value</span><span class="op" id="3840987">.</span><span class="op" id="3840988">(</span><span class="op" id="3840989">*</span><span class="ident" id="3840990"><a href="/crypto/tls/common.go.html#3839499">lruSessionCacheEntry</a></span><span class="op" id="3841010">)</span><span class="op" id="3841011">.</span><span class="ident" id="3841012">state</span><span class="op" id="3841017">,</span>&nbsp;<span class="builtintype" id="3841019">true</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841028">return</span>&nbsp;<span class="ident" id="3841035">nil</span><span class="op" id="3841038">,</span>&nbsp;<span class="builtintype" id="3841040">false</span><br>
<span class="lineno"></span><span class="op" id="3841046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3841049">//&nbsp;TODO(jsing):&nbsp;Make&nbsp;these&nbsp;available&nbsp;to&nbsp;both&nbsp;crypto/x509&nbsp;and&nbsp;crypto/tls.</span><br>
<span class="lineno">590</span><span class="keyword" id="3841122">type</span>&nbsp;<span class="ident" id="3841127">dsaSignature</span>&nbsp;<span class="keyword" id="3841140">struct</span>&nbsp;<span class="op" id="3841147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841150">R</span><span class="op" id="3841151">,</span>&nbsp;<span class="ident" id="3841153">S</span>&nbsp;<span class="op" id="3841155">*</span><span class="ident" id="3841156"><a href="/crypto/tls/common.go.html#3822722">big</a></span><span class="op" id="3841159">.</span><span class="ident" id="3841160">Int</span><br>
<span class="lineno"></span><span class="op" id="3841164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841167">type</span>&nbsp;<span class="ident" id="3841172">ecdsaSignature</span>&nbsp;<span class="ident" id="3841187"><a href="/crypto/tls/common.go.html#3841127">dsaSignature</a></span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="keyword" id="3841201">var</span>&nbsp;<span class="ident" id="3841205">emptyConfig</span>&nbsp;<span class="ident" id="3841217"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841225">func</span>&nbsp;<span class="ident" id="3841230">defaultConfig</span><span class="op" id="3841243">(</span><span class="op" id="3841244">)</span>&nbsp;<span class="op" id="3841246">*</span><span class="ident" id="3841247"><a href="/crypto/tls/common.go.html#3830813">Config</a></span>&nbsp;<span class="op" id="3841254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841257">return</span>&nbsp;<span class="op" id="3841264">&amp;</span><span class="ident" id="3841265"><a href="/crypto/tls/common.go.html#3841205">emptyConfig</a></span><br>
<span class="lineno">600</span><span class="op" id="3841277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841280">var</span>&nbsp;<span class="op" id="3841284">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841287">once</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3841310"><a href="/crypto/tls/common.go.html#3822745">sync</a></span><span class="op" id="3841314">.</span><span class="ident" id="3841315">Once</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841321">varDefaultCipherSuites</span>&nbsp;<span class="op" id="3841344">[</span><span class="op" id="3841345">]</span><span class="builtintype" id="3841346">uint16</span><br>
<span class="lineno">605</span><span class="op" id="3841353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841356">func</span>&nbsp;<span class="ident" id="3841361">defaultCipherSuites</span><span class="op" id="3841380">(</span><span class="op" id="3841381">)</span>&nbsp;<span class="op" id="3841383">[</span><span class="op" id="3841384">]</span><span class="builtintype" id="3841385">uint16</span>&nbsp;<span class="op" id="3841392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841395"><a href="/crypto/tls/common.go.html#3841287">once</a></span><span class="op" id="3841399">.</span><span class="ident" id="3841400">Do</span><span class="op" id="3841402">(</span><span class="ident" id="3841403"><a href="/crypto/tls/common.go.html#3841467">initDefaultCipherSuites</a></span><span class="op" id="3841426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841429">return</span>&nbsp;<span class="ident" id="3841436"><a href="/crypto/tls/common.go.html#3841321">varDefaultCipherSuites</a></span><br>
<span class="lineno">610</span><span class="op" id="3841459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841462">func</span>&nbsp;<span class="ident" id="3841467">initDefaultCipherSuites</span><span class="op" id="3841490">(</span><span class="op" id="3841491">)</span>&nbsp;<span class="op" id="3841493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841496"><a href="/crypto/tls/common.go.html#3841321">varDefaultCipherSuites</a></span>&nbsp;<span class="op" id="3841519">=</span>&nbsp;<span class="builtinfunc" id="3841521">make</span><span class="op" id="3841525">(</span><span class="op" id="3841526">[</span><span class="op" id="3841527">]</span><span class="builtintype" id="3841528">uint16</span><span class="op" id="3841534">,</span>&nbsp;<span class="builtinfunc" id="3841536">len</span><span class="op" id="3841539">(</span><span class="ident" id="3841540"><a href="/crypto/tls/cipher_suites.go.html#3815423">cipherSuites</a></span><span class="op" id="3841552">)</span><span class="op" id="3841553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841556">for</span>&nbsp;<span class="ident" id="3841560">i</span><span class="op" id="3841561">,</span>&nbsp;<span class="ident" id="3841563">suite</span>&nbsp;<span class="op" id="3841569">:=</span>&nbsp;<span class="keyword" id="3841572">range</span>&nbsp;<span class="ident" id="3841578"><a href="/crypto/tls/cipher_suites.go.html#3815423">cipherSuites</a></span>&nbsp;<span class="op" id="3841591">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841595"><a href="/crypto/tls/common.go.html#3841321">varDefaultCipherSuites</a></span><span class="op" id="3841617">[</span><span class="ident" id="3841618"><a href="/crypto/tls/common.go.html#3841560">i</a></span><span class="op" id="3841619">]</span>&nbsp;<span class="op" id="3841621">=</span>&nbsp;<span class="ident" id="3841623"><a href="/crypto/tls/common.go.html#3841563">suite</a></span><span class="op" id="3841628">.</span><span class="ident" id="3841629">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841633">}</span><br>
<span class="lineno"></span><span class="op" id="3841635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841638">func</span>&nbsp;<span class="ident" id="3841643">unexpectedMessageError</span><span class="op" id="3841665">(</span><span class="ident" id="3841666">wanted</span><span class="op" id="3841672">,</span>&nbsp;<span class="ident" id="3841674">got</span>&nbsp;<span class="keyword" id="3841678">interface</span><span class="op" id="3841687">{</span><span class="op" id="3841688">}</span><span class="op" id="3841689">)</span>&nbsp;<span class="builtintype" id="3841691">error</span>&nbsp;<span class="op" id="3841697">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841700">return</span>&nbsp;<span class="ident" id="3841707"><a href="/crypto/tls/common.go.html#3822709">fmt</a></span><span class="op" id="3841710">.</span><span class="ident" id="3841711">Errorf</span><span class="op" id="3841717">(</span><span class="string" id="3841718">&#34;tls:&nbsp;received&nbsp;unexpected&nbsp;handshake&nbsp;message&nbsp;of&nbsp;type&nbsp;%T&nbsp;when&nbsp;waiting&nbsp;for&nbsp;%T&#34;</span><span class="op" id="3841793">,</span>&nbsp;<span class="ident" id="3841795"><a href="/crypto/tls/common.go.html#3841674">got</a></span><span class="op" id="3841798">,</span>&nbsp;<span class="ident" id="3841800"><a href="/crypto/tls/common.go.html#3841666">wanted</a></span><span class="op" id="3841806">)</span><br>
<span class="lineno"></span><span class="op" id="3841808">}</span>
</div>
</body>
</html>
