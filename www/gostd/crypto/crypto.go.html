<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4343292">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4343347">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4343401">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4343452">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4343511">package</span>&nbsp;<span class="ident" id="4343519">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343527">import</span>&nbsp;<span class="op" id="4343534">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4343537">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4343545">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4343551">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4343561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4343564">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="4343644">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4343656">type</span>&nbsp;<span class="ident" id="4343661">Hash</span>&nbsp;<span class="builtintype" id="4343666">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4343672">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4343750">func</span>&nbsp;<span class="op" id="4343755">(</span><span class="ident" id="4343756">h</span>&nbsp;<span class="ident" id="4343758">Hash</span><span class="op" id="4343762">)</span>&nbsp;<span class="ident" id="4343764">HashFunc</span><span class="op" id="4343772">(</span><span class="op" id="4343773">)</span>&nbsp;<span class="ident" id="4343775">Hash</span>&nbsp;<span class="op" id="4343780">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4343783">return</span>&nbsp;<span class="ident" id="4343790">h</span><br>
<span class="lineno"></span><span class="op" id="4343792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343795">const</span>&nbsp;<span class="op" id="4343801">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343804">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343814">Hash</span>&nbsp;<span class="op" id="4343819">=</span>&nbsp;<span class="num" id="4343821">1</span>&nbsp;<span class="op" id="4343823">+</span>&nbsp;<span class="ident" id="4343825">iota</span>&nbsp;<span class="comment" id="4343830">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343865">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343891">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343913">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343939">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4343962">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4343988">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344013">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344039">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344064">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344090">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344115">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344141">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344166">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344192">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344241">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344267">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344308">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344334">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344370">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344396">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344432">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344458">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344494">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4344520">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344556">maxHash</span><br>
<span class="lineno"></span><span class="op" id="4344564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4344567">var</span>&nbsp;<span class="ident" id="4344571">digestSizes</span>&nbsp;<span class="op" id="4344583">=</span>&nbsp;<span class="op" id="4344585">[</span><span class="op" id="4344586">]</span><span class="builtintype" id="4344587">uint8</span><span class="op" id="4344592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344595">MD4</span><span class="op" id="4344598">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344606">16</span><span class="op" id="4344608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344611">MD5</span><span class="op" id="4344614">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344622">16</span><span class="op" id="4344624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344627">SHA1</span><span class="op" id="4344631">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344638">20</span><span class="op" id="4344640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344643">SHA224</span><span class="op" id="4344649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344654">28</span><span class="op" id="4344656">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344659">SHA256</span><span class="op" id="4344665">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344670">32</span><span class="op" id="4344672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344675">SHA384</span><span class="op" id="4344681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344686">48</span><span class="op" id="4344688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344691">SHA512</span><span class="op" id="4344697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4344702">64</span><span class="op" id="4344704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344707">SHA3_224</span><span class="op" id="4344715">:</span>&nbsp;&nbsp;<span class="num" id="4344718">28</span><span class="op" id="4344720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344723">SHA3_256</span><span class="op" id="4344731">:</span>&nbsp;&nbsp;<span class="num" id="4344734">32</span><span class="op" id="4344736">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344739">SHA3_384</span><span class="op" id="4344747">:</span>&nbsp;&nbsp;<span class="num" id="4344750">48</span><span class="op" id="4344752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344755">SHA3_512</span><span class="op" id="4344763">:</span>&nbsp;&nbsp;<span class="num" id="4344766">64</span><span class="op" id="4344768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344771">MD5SHA1</span><span class="op" id="4344778">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4344782">36</span><span class="op" id="4344784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4344787">RIPEMD160</span><span class="op" id="4344796">:</span>&nbsp;<span class="num" id="4344798">20</span><span class="op" id="4344800">,</span><br>
<span class="lineno"></span><span class="op" id="4344802">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4344805">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4344885">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="4344962">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="4344983">func</span>&nbsp;<span class="op" id="4344988">(</span><span class="ident" id="4344989">h</span>&nbsp;<span class="ident" id="4344991">Hash</span><span class="op" id="4344995">)</span>&nbsp;<span class="ident" id="4344997">Size</span><span class="op" id="4345001">(</span><span class="op" id="4345002">)</span>&nbsp;<span class="builtintype" id="4345004">int</span>&nbsp;<span class="op" id="4345008">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345011">if</span>&nbsp;<span class="ident" id="4345014">h</span>&nbsp;<span class="op" id="4345016">&gt;</span>&nbsp;<span class="num" id="4345018">0</span>&nbsp;<span class="op" id="4345020">&amp;&amp;</span>&nbsp;<span class="ident" id="4345023">h</span>&nbsp;<span class="op" id="4345025">&lt;</span>&nbsp;<span class="ident" id="4345027">maxHash</span>&nbsp;<span class="op" id="4345035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345039">return</span>&nbsp;<span class="builtintype" id="4345046">int</span><span class="op" id="4345049">(</span><span class="ident" id="4345050">digestSizes</span><span class="op" id="4345061">[</span><span class="ident" id="4345062">h</span><span class="op" id="4345063">]</span><span class="op" id="4345064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4345070">panic</span><span class="op" id="4345075">(</span><span class="string" id="4345076">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4345115">)</span><br>
<span class="lineno"></span><span class="op" id="4345117">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4345120">var</span>&nbsp;<span class="ident" id="4345124">hashes</span>&nbsp;<span class="op" id="4345131">=</span>&nbsp;<span class="builtinfunc" id="4345133">make</span><span class="op" id="4345137">(</span><span class="op" id="4345138">[</span><span class="op" id="4345139">]</span><span class="keyword" id="4345140">func</span><span class="op" id="4345144">(</span><span class="op" id="4345145">)</span>&nbsp;<span class="ident" id="4345147">hash</span><span class="op" id="4345151">.</span><span class="ident" id="4345152">Hash</span><span class="op" id="4345156">,</span>&nbsp;<span class="ident" id="4345158">maxHash</span><span class="op" id="4345165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4345168">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="4345247">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="4345302">func</span>&nbsp;<span class="op" id="4345307">(</span><span class="ident" id="4345308">h</span>&nbsp;<span class="ident" id="4345310">Hash</span><span class="op" id="4345314">)</span>&nbsp;<span class="ident" id="4345316">New</span><span class="op" id="4345319">(</span><span class="op" id="4345320">)</span>&nbsp;<span class="ident" id="4345322">hash</span><span class="op" id="4345326">.</span><span class="ident" id="4345327">Hash</span>&nbsp;<span class="op" id="4345332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345335">if</span>&nbsp;<span class="ident" id="4345338">h</span>&nbsp;<span class="op" id="4345340">&gt;</span>&nbsp;<span class="num" id="4345342">0</span>&nbsp;<span class="op" id="4345344">&amp;&amp;</span>&nbsp;<span class="ident" id="4345347">h</span>&nbsp;<span class="op" id="4345349">&lt;</span>&nbsp;<span class="ident" id="4345351">maxHash</span>&nbsp;<span class="op" id="4345359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345363">f</span>&nbsp;<span class="op" id="4345365">:=</span>&nbsp;<span class="ident" id="4345368">hashes</span><span class="op" id="4345374">[</span><span class="ident" id="4345375">h</span><span class="op" id="4345376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345380">if</span>&nbsp;<span class="ident" id="4345383">f</span>&nbsp;<span class="op" id="4345385">!=</span>&nbsp;<span class="builtintype" id="4345388">nil</span>&nbsp;<span class="op" id="4345392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345397">return</span>&nbsp;<span class="ident" id="4345404">f</span><span class="op" id="4345405">(</span><span class="op" id="4345406">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4345416">panic</span><span class="op" id="4345421">(</span><span class="string" id="4345422">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="4345458">+</span>&nbsp;<span class="ident" id="4345460">strconv</span><span class="op" id="4345467">.</span><span class="ident" id="4345468">Itoa</span><span class="op" id="4345472">(</span><span class="builtintype" id="4345473">int</span><span class="op" id="4345476">(</span><span class="ident" id="4345477">h</span><span class="op" id="4345478">)</span><span class="op" id="4345479">)</span>&nbsp;<span class="op" id="4345481">+</span>&nbsp;<span class="string" id="4345483">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="4345500">)</span><br>
<span class="lineno"></span><span class="op" id="4345502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4345505">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4345585">func</span>&nbsp;<span class="op" id="4345590">(</span><span class="ident" id="4345591">h</span>&nbsp;<span class="ident" id="4345593">Hash</span><span class="op" id="4345597">)</span>&nbsp;<span class="ident" id="4345599">Available</span><span class="op" id="4345608">(</span><span class="op" id="4345609">)</span>&nbsp;<span class="builtintype" id="4345611">bool</span>&nbsp;<span class="op" id="4345616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345619">return</span>&nbsp;<span class="ident" id="4345626">h</span>&nbsp;<span class="op" id="4345628">&lt;</span>&nbsp;<span class="ident" id="4345630">maxHash</span>&nbsp;<span class="op" id="4345638">&amp;&amp;</span>&nbsp;<span class="ident" id="4345641">hashes</span><span class="op" id="4345647">[</span><span class="ident" id="4345648">h</span><span class="op" id="4345649">]</span>&nbsp;<span class="op" id="4345651">!=</span>&nbsp;<span class="builtintype" id="4345654">nil</span><br>
<span class="lineno"></span><span class="op" id="4345658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4345661">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4345739">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4345813">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="4345856">func</span>&nbsp;<span class="ident" id="4345861">RegisterHash</span><span class="op" id="4345873">(</span><span class="ident" id="4345874">h</span>&nbsp;<span class="ident" id="4345876">Hash</span><span class="op" id="4345880">,</span>&nbsp;<span class="ident" id="4345882">f</span>&nbsp;<span class="keyword" id="4345884">func</span><span class="op" id="4345888">(</span><span class="op" id="4345889">)</span>&nbsp;<span class="ident" id="4345891">hash</span><span class="op" id="4345895">.</span><span class="ident" id="4345896">Hash</span><span class="op" id="4345900">)</span>&nbsp;<span class="op" id="4345902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4345905">if</span>&nbsp;<span class="ident" id="4345908">h</span>&nbsp;<span class="op" id="4345910">&gt;=</span>&nbsp;<span class="ident" id="4345913">maxHash</span>&nbsp;<span class="op" id="4345921">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4345925">panic</span><span class="op" id="4345930">(</span><span class="string" id="4345931">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4345978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4345984">hashes</span><span class="op" id="4345990">[</span><span class="ident" id="4345991">h</span><span class="op" id="4345992">]</span>&nbsp;<span class="op" id="4345994">=</span>&nbsp;<span class="ident" id="4345996">f</span><br>
<span class="lineno"></span><span class="op" id="4345998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4346001">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4346070">type</span>&nbsp;<span class="ident" id="4346075">PublicKey</span>&nbsp;<span class="keyword" id="4346085">interface</span><span class="op" id="4346094">{</span><span class="op" id="4346095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4346098">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4346169">type</span>&nbsp;<span class="ident" id="4346174">PrivateKey</span>&nbsp;<span class="keyword" id="4346185">interface</span><span class="op" id="4346194">{</span><span class="op" id="4346195">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4346198">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4346271">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="4346345">type</span>&nbsp;<span class="ident" id="4346350">Signer</span>&nbsp;<span class="keyword" id="4346357">interface</span>&nbsp;<span class="op" id="4346367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346370">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346433">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346450">Public</span><span class="op" id="4346456">(</span><span class="op" id="4346457">)</span>&nbsp;<span class="ident" id="4346459">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346471">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346540">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346609">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346681">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346748">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346752">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346825">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346898">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4346966">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347038">Sign</span><span class="op" id="4347042">(</span><span class="ident" id="4347043">rand</span>&nbsp;<span class="ident" id="4347048">io</span><span class="op" id="4347050">.</span><span class="ident" id="4347051">Reader</span><span class="op" id="4347057">,</span>&nbsp;<span class="ident" id="4347059">msg</span>&nbsp;<span class="op" id="4347063">[</span><span class="op" id="4347064">]</span><span class="builtintype" id="4347065">byte</span><span class="op" id="4347069">,</span>&nbsp;<span class="ident" id="4347071">opts</span>&nbsp;<span class="ident" id="4347076">SignerOpts</span><span class="op" id="4347086">)</span>&nbsp;<span class="op" id="4347088">(</span><span class="ident" id="4347089">signature</span>&nbsp;<span class="op" id="4347099">[</span><span class="op" id="4347100">]</span><span class="builtintype" id="4347101">byte</span><span class="op" id="4347105">,</span>&nbsp;<span class="ident" id="4347107">err</span>&nbsp;<span class="builtintype" id="4347111">error</span><span class="op" id="4347116">)</span><br>
<span class="lineno"></span><span class="op" id="4347118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4347121">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="4347179">type</span>&nbsp;<span class="ident" id="4347184">SignerOpts</span>&nbsp;<span class="keyword" id="4347195">interface</span>&nbsp;<span class="op" id="4347205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347208">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347281">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4347353">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347375">HashFunc</span><span class="op" id="4347383">(</span><span class="op" id="4347384">)</span>&nbsp;<span class="ident" id="4347386">Hash</span><br>
<span class="lineno"></span><span class="op" id="4347391">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
