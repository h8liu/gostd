<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2744919">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2744974">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2745028">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2745079">package</span>&nbsp;<span class="ident" id="2745087">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2745093">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2745160">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2745227">func</span>&nbsp;<span class="ident" id="2745232">Sleep</span><span class="op" id="2745237">(</span><span class="ident" id="2745238">d</span>&nbsp;<span class="ident" id="2745240">Duration</span><span class="op" id="2745248">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2745251">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2745329">func</span>&nbsp;<span class="ident" id="2745334">runtimeNano</span><span class="op" id="2745345">(</span><span class="op" id="2745346">)</span>&nbsp;<span class="ident" id="2745348">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2745355">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2745410">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2745471">type</span>&nbsp;<span class="ident" id="2745476">runtimeTimer</span>&nbsp;<span class="keyword" id="2745489">struct</span>&nbsp;<span class="op" id="2745496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745499">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2745506">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745511">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2745518">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745525">period</span>&nbsp;<span class="ident" id="2745532">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745539">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2745546">func</span><span class="op" id="2745550">(</span><span class="keyword" id="2745551">interface</span><span class="op" id="2745560">{</span><span class="op" id="2745561">}</span><span class="op" id="2745562">,</span>&nbsp;<span class="builtintype" id="2745564">uintptr</span><span class="op" id="2745571">)</span>&nbsp;<span class="comment" id="2745573">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745603">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2745610">interface</span><span class="op" id="2745619">{</span><span class="op" id="2745620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745623">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2745630">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2745638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2745641">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2745718">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2745797">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2745875">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2745929">func</span>&nbsp;<span class="ident" id="2745934">when</span><span class="op" id="2745938">(</span><span class="ident" id="2745939">d</span>&nbsp;<span class="ident" id="2745941">Duration</span><span class="op" id="2745949">)</span>&nbsp;<span class="ident" id="2745951">int64</span>&nbsp;<span class="op" id="2745957">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2745960">if</span>&nbsp;<span class="ident" id="2745963">d</span>&nbsp;<span class="op" id="2745965">&lt;=</span>&nbsp;<span class="num" id="2745968">0</span>&nbsp;<span class="op" id="2745970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2745974">return</span>&nbsp;<span class="ident" id="2745981">runtimeNano</span><span class="op" id="2745992">(</span><span class="op" id="2745993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2745996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2745999">t</span>&nbsp;<span class="op" id="2746001">:=</span>&nbsp;<span class="ident" id="2746004">runtimeNano</span><span class="op" id="2746015">(</span><span class="op" id="2746016">)</span>&nbsp;<span class="op" id="2746018">+</span>&nbsp;<span class="ident" id="2746020">int64</span><span class="op" id="2746025">(</span><span class="ident" id="2746026">d</span><span class="op" id="2746027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2746030">if</span>&nbsp;<span class="ident" id="2746033">t</span>&nbsp;<span class="op" id="2746035">&lt;</span>&nbsp;<span class="num" id="2746037">0</span>&nbsp;<span class="op" id="2746039">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746043">t</span>&nbsp;<span class="op" id="2746045">=</span>&nbsp;<span class="num" id="2746047">1</span><span class="op" id="2746048">&lt;&lt;</span><span class="num" id="2746050">63</span>&nbsp;<span class="op" id="2746053">-</span>&nbsp;<span class="num" id="2746055">1</span>&nbsp;<span class="comment" id="2746057">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2746075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2746078">return</span>&nbsp;<span class="ident" id="2746085">t</span><br>
<span class="lineno"></span><span class="op" id="2746087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2746090">func</span>&nbsp;<span class="ident" id="2746095">startTimer</span><span class="op" id="2746105">(</span><span class="op" id="2746106">*</span><span class="ident" id="2746107">runtimeTimer</span><span class="op" id="2746119">)</span><br>
<span class="lineno"></span><span class="keyword" id="2746121">func</span>&nbsp;<span class="ident" id="2746126">stopTimer</span><span class="op" id="2746135">(</span><span class="op" id="2746136">*</span><span class="ident" id="2746137">runtimeTimer</span><span class="op" id="2746149">)</span>&nbsp;<span class="builtintype" id="2746151">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746157">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2746202">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2746265">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2746311">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2746366">type</span>&nbsp;<span class="ident" id="2746371">Timer</span>&nbsp;<span class="keyword" id="2746377">struct</span>&nbsp;<span class="op" id="2746384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746387">C</span>&nbsp;<span class="op" id="2746389">&lt;-</span><span class="keyword" id="2746391">chan</span>&nbsp;<span class="ident" id="2746396">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746402">r</span>&nbsp;<span class="ident" id="2746404">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2746417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746420">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2746460">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2746539">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2746567">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2746649">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2746665">func</span>&nbsp;<span class="op" id="2746670">(</span><span class="ident" id="2746671">t</span>&nbsp;<span class="op" id="2746673">*</span><span class="ident" id="2746674">Timer</span><span class="op" id="2746679">)</span>&nbsp;<span class="ident" id="2746681">Stop</span><span class="op" id="2746685">(</span><span class="op" id="2746686">)</span>&nbsp;<span class="builtintype" id="2746688">bool</span>&nbsp;<span class="op" id="2746693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2746696">if</span>&nbsp;<span class="ident" id="2746699">t</span><span class="op" id="2746700">.</span><span class="ident" id="2746701">r</span><span class="op" id="2746702">.</span><span class="ident" id="2746703">f</span>&nbsp;<span class="op" id="2746705">==</span>&nbsp;<span class="ident" id="2746708">nil</span>&nbsp;<span class="op" id="2746712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2746716">panic</span><span class="op" id="2746721">(</span><span class="string" id="2746722">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2746764">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2746767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2746770">return</span>&nbsp;<span class="ident" id="2746777">stopTimer</span><span class="op" id="2746786">(</span><span class="op" id="2746787">&amp;</span><span class="ident" id="2746788">t</span><span class="op" id="2746789">.</span><span class="ident" id="2746790">r</span><span class="op" id="2746791">)</span><br>
<span class="lineno"></span><span class="op" id="2746793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746796">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2746843">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2746905">func</span>&nbsp;<span class="ident" id="2746910">NewTimer</span><span class="op" id="2746918">(</span><span class="ident" id="2746919">d</span>&nbsp;<span class="ident" id="2746921">Duration</span><span class="op" id="2746929">)</span>&nbsp;<span class="op" id="2746931">*</span><span class="ident" id="2746932">Timer</span>&nbsp;<span class="op" id="2746938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746941">c</span>&nbsp;<span class="op" id="2746943">:=</span>&nbsp;<span class="builtinfunc" id="2746946">make</span><span class="op" id="2746950">(</span><span class="keyword" id="2746951">chan</span>&nbsp;<span class="ident" id="2746956">Time</span><span class="op" id="2746960">,</span>&nbsp;<span class="num" id="2746962">1</span><span class="op" id="2746963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746966">t</span>&nbsp;<span class="op" id="2746968">:=</span>&nbsp;<span class="op" id="2746971">&amp;</span><span class="ident" id="2746972">Timer</span><span class="op" id="2746977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746981">C</span><span class="op" id="2746982">:</span>&nbsp;<span class="ident" id="2746984">c</span><span class="op" id="2746985">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2746989">r</span><span class="op" id="2746990">:</span>&nbsp;<span class="ident" id="2746992">runtimeTimer</span><span class="op" id="2747004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747009">when</span><span class="op" id="2747013">:</span>&nbsp;<span class="ident" id="2747015">when</span><span class="op" id="2747019">(</span><span class="ident" id="2747020">d</span><span class="op" id="2747021">)</span><span class="op" id="2747022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747027">f</span><span class="op" id="2747028">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747033">sendTime</span><span class="op" id="2747041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747046">arg</span><span class="op" id="2747049">:</span>&nbsp;&nbsp;<span class="ident" id="2747052">c</span><span class="op" id="2747053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2747057">}</span><span class="op" id="2747058">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2747061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747064">startTimer</span><span class="op" id="2747074">(</span><span class="op" id="2747075">&amp;</span><span class="ident" id="2747076">t</span><span class="op" id="2747077">.</span><span class="ident" id="2747078">r</span><span class="op" id="2747079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747082">return</span>&nbsp;<span class="ident" id="2747089">t</span><br>
<span class="lineno"></span><span class="op" id="2747091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2747094">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2747149">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2747221">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2747249">func</span>&nbsp;<span class="op" id="2747254">(</span><span class="ident" id="2747255">t</span>&nbsp;<span class="op" id="2747257">*</span><span class="ident" id="2747258">Timer</span><span class="op" id="2747263">)</span>&nbsp;<span class="ident" id="2747265">Reset</span><span class="op" id="2747270">(</span><span class="ident" id="2747271">d</span>&nbsp;<span class="ident" id="2747273">Duration</span><span class="op" id="2747281">)</span>&nbsp;<span class="builtintype" id="2747283">bool</span>&nbsp;<span class="op" id="2747288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747291">if</span>&nbsp;<span class="ident" id="2747294">t</span><span class="op" id="2747295">.</span><span class="ident" id="2747296">r</span><span class="op" id="2747297">.</span><span class="ident" id="2747298">f</span>&nbsp;<span class="op" id="2747300">==</span>&nbsp;<span class="ident" id="2747303">nil</span>&nbsp;<span class="op" id="2747307">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2747311">panic</span><span class="op" id="2747316">(</span><span class="string" id="2747317">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2747360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2747363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747366">w</span>&nbsp;<span class="op" id="2747368">:=</span>&nbsp;<span class="ident" id="2747371">when</span><span class="op" id="2747375">(</span><span class="ident" id="2747376">d</span><span class="op" id="2747377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747380">active</span>&nbsp;<span class="op" id="2747387">:=</span>&nbsp;<span class="ident" id="2747390">stopTimer</span><span class="op" id="2747399">(</span><span class="op" id="2747400">&amp;</span><span class="ident" id="2747401">t</span><span class="op" id="2747402">.</span><span class="ident" id="2747403">r</span><span class="op" id="2747404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747407">t</span><span class="op" id="2747408">.</span><span class="ident" id="2747409">r</span><span class="op" id="2747410">.</span><span class="ident" id="2747411">when</span>&nbsp;<span class="op" id="2747416">=</span>&nbsp;<span class="ident" id="2747418">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2747421">startTimer</span><span class="op" id="2747431">(</span><span class="op" id="2747432">&amp;</span><span class="ident" id="2747433">t</span><span class="op" id="2747434">.</span><span class="ident" id="2747435">r</span><span class="op" id="2747436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747439">return</span>&nbsp;<span class="ident" id="2747446">active</span><br>
<span class="lineno"></span><span class="op" id="2747453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2747456">func</span>&nbsp;<span class="ident" id="2747461">sendTime</span><span class="op" id="2747469">(</span><span class="ident" id="2747470">c</span>&nbsp;<span class="keyword" id="2747472">interface</span><span class="op" id="2747481">{</span><span class="op" id="2747482">}</span><span class="op" id="2747483">,</span>&nbsp;<span class="ident" id="2747485">seq</span>&nbsp;<span class="builtintype" id="2747489">uintptr</span><span class="op" id="2747496">)</span>&nbsp;<span class="op" id="2747498">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2747501">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2747537">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2747592">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2747646">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2747700">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747736">select</span>&nbsp;<span class="op" id="2747743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747746">case</span>&nbsp;<span class="ident" id="2747751">c</span><span class="op" id="2747752">.</span><span class="op" id="2747753">(</span><span class="keyword" id="2747754">chan</span>&nbsp;<span class="ident" id="2747759">Time</span><span class="op" id="2747763">)</span>&nbsp;<span class="op" id="2747765">&lt;-</span>&nbsp;<span class="ident" id="2747768">Now</span><span class="op" id="2747771">(</span><span class="op" id="2747772">)</span><span class="op" id="2747773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747776">default</span><span class="op" id="2747783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2747786">}</span><br>
<span class="lineno"></span><span class="op" id="2747788">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2747791">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2747865">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2747893">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2747931">func</span>&nbsp;<span class="ident" id="2747936">After</span><span class="op" id="2747941">(</span><span class="ident" id="2747942">d</span>&nbsp;<span class="ident" id="2747944">Duration</span><span class="op" id="2747952">)</span>&nbsp;<span class="op" id="2747954">&lt;-</span><span class="keyword" id="2747956">chan</span>&nbsp;<span class="ident" id="2747961">Time</span>&nbsp;<span class="op" id="2747966">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2747969">return</span>&nbsp;<span class="ident" id="2747976">NewTimer</span><span class="op" id="2747984">(</span><span class="ident" id="2747985">d</span><span class="op" id="2747986">)</span><span class="op" id="2747987">.</span><span class="ident" id="2747988">C</span><br>
<span class="lineno"></span><span class="op" id="2747990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2747993">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2748056">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2748109">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2748162">func</span>&nbsp;<span class="ident" id="2748167">AfterFunc</span><span class="op" id="2748176">(</span><span class="ident" id="2748177">d</span>&nbsp;<span class="ident" id="2748179">Duration</span><span class="op" id="2748187">,</span>&nbsp;<span class="ident" id="2748189">f</span>&nbsp;<span class="keyword" id="2748191">func</span><span class="op" id="2748195">(</span><span class="op" id="2748196">)</span><span class="op" id="2748197">)</span>&nbsp;<span class="op" id="2748199">*</span><span class="ident" id="2748200">Timer</span>&nbsp;<span class="op" id="2748206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748209">t</span>&nbsp;<span class="op" id="2748211">:=</span>&nbsp;<span class="op" id="2748214">&amp;</span><span class="ident" id="2748215">Timer</span><span class="op" id="2748220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748224">r</span><span class="op" id="2748225">:</span>&nbsp;<span class="ident" id="2748227">runtimeTimer</span><span class="op" id="2748239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748244">when</span><span class="op" id="2748248">:</span>&nbsp;<span class="ident" id="2748250">when</span><span class="op" id="2748254">(</span><span class="ident" id="2748255">d</span><span class="op" id="2748256">)</span><span class="op" id="2748257">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748262">f</span><span class="op" id="2748263">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748268">goFunc</span><span class="op" id="2748274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748279">arg</span><span class="op" id="2748282">:</span>&nbsp;&nbsp;<span class="ident" id="2748285">f</span><span class="op" id="2748286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2748290">}</span><span class="op" id="2748291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2748294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2748297">startTimer</span><span class="op" id="2748307">(</span><span class="op" id="2748308">&amp;</span><span class="ident" id="2748309">t</span><span class="op" id="2748310">.</span><span class="ident" id="2748311">r</span><span class="op" id="2748312">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2748315">return</span>&nbsp;<span class="ident" id="2748322">t</span><br>
<span class="lineno"></span><span class="op" id="2748324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2748327">func</span>&nbsp;<span class="ident" id="2748332">goFunc</span><span class="op" id="2748338">(</span><span class="ident" id="2748339">arg</span>&nbsp;<span class="keyword" id="2748343">interface</span><span class="op" id="2748352">{</span><span class="op" id="2748353">}</span><span class="op" id="2748354">,</span>&nbsp;<span class="ident" id="2748356">seq</span>&nbsp;<span class="builtintype" id="2748360">uintptr</span><span class="op" id="2748367">)</span>&nbsp;<span class="op" id="2748369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2748372">go</span>&nbsp;<span class="ident" id="2748375">arg</span><span class="op" id="2748378">.</span><span class="op" id="2748379">(</span><span class="keyword" id="2748380">func</span><span class="op" id="2748384">(</span><span class="op" id="2748385">)</span><span class="op" id="2748386">)</span><span class="op" id="2748387">(</span><span class="op" id="2748388">)</span><br>
<span class="lineno">130</span><span class="op" id="2748390">}</span>
</div>
</body>
</html>
