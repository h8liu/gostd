<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html" class="current">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5549858">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5549913">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5549967">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5550018">package</span>&nbsp;<span class="ident" id="5550026">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5550033">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5550090">func</span>&nbsp;<span class="ident" id="5550095">RGBToYCbCr</span><span class="op" id="5550105">(</span><span class="ident" id="5550106">r</span><span class="op" id="5550107">,</span>&nbsp;<span class="ident" id="5550109">g</span><span class="op" id="5550110">,</span>&nbsp;<span class="ident" id="5550112">b</span>&nbsp;<span class="builtintype" id="5550114">uint8</span><span class="op" id="5550119">)</span>&nbsp;<span class="op" id="5550121">(</span><span class="builtintype" id="5550122">uint8</span><span class="op" id="5550127">,</span>&nbsp;<span class="builtintype" id="5550129">uint8</span><span class="op" id="5550134">,</span>&nbsp;<span class="builtintype" id="5550136">uint8</span><span class="op" id="5550141">)</span>&nbsp;<span class="op" id="5550143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550146">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550179">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550220">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550267">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550314">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550381">r1</span>&nbsp;<span class="op" id="5550384">:=</span>&nbsp;<span class="builtintype" id="5550387">int</span><span class="op" id="5550390">(</span><span class="ident" id="5550391">r</span><span class="op" id="5550392">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550395">g1</span>&nbsp;<span class="op" id="5550398">:=</span>&nbsp;<span class="builtintype" id="5550401">int</span><span class="op" id="5550404">(</span><span class="ident" id="5550405">g</span><span class="op" id="5550406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550409">b1</span>&nbsp;<span class="op" id="5550412">:=</span>&nbsp;<span class="builtintype" id="5550415">int</span><span class="op" id="5550418">(</span><span class="ident" id="5550419">b</span><span class="op" id="5550420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550423">yy</span>&nbsp;<span class="op" id="5550426">:=</span>&nbsp;<span class="op" id="5550429">(</span><span class="num" id="5550430">19595</span><span class="op" id="5550435">*</span><span class="ident" id="5550436">r1</span>&nbsp;<span class="op" id="5550439">+</span>&nbsp;<span class="num" id="5550441">38470</span><span class="op" id="5550446">*</span><span class="ident" id="5550447">g1</span>&nbsp;<span class="op" id="5550450">+</span>&nbsp;<span class="num" id="5550452">7471</span><span class="op" id="5550456">*</span><span class="ident" id="5550457">b1</span>&nbsp;<span class="op" id="5550460">+</span>&nbsp;<span class="num" id="5550462">1</span><span class="op" id="5550463">&lt;&lt;</span><span class="num" id="5550465">15</span><span class="op" id="5550467">)</span>&nbsp;<span class="op" id="5550469">&gt;&gt;</span>&nbsp;<span class="num" id="5550472">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550476">cb</span>&nbsp;<span class="op" id="5550479">:=</span>&nbsp;<span class="op" id="5550482">(</span><span class="op" id="5550483">-</span><span class="num" id="5550484">11056</span><span class="op" id="5550489">*</span><span class="ident" id="5550490">r1</span>&nbsp;<span class="op" id="5550493">-</span>&nbsp;<span class="num" id="5550495">21712</span><span class="op" id="5550500">*</span><span class="ident" id="5550501">g1</span>&nbsp;<span class="op" id="5550504">+</span>&nbsp;<span class="num" id="5550506">32768</span><span class="op" id="5550511">*</span><span class="ident" id="5550512">b1</span>&nbsp;<span class="op" id="5550515">+</span>&nbsp;<span class="num" id="5550517">257</span><span class="op" id="5550520">&lt;&lt;</span><span class="num" id="5550522">15</span><span class="op" id="5550524">)</span>&nbsp;<span class="op" id="5550526">&gt;&gt;</span>&nbsp;<span class="num" id="5550529">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550533">cr</span>&nbsp;<span class="op" id="5550536">:=</span>&nbsp;<span class="op" id="5550539">(</span><span class="num" id="5550540">32768</span><span class="op" id="5550545">*</span><span class="ident" id="5550546">r1</span>&nbsp;<span class="op" id="5550549">-</span>&nbsp;<span class="num" id="5550551">27440</span><span class="op" id="5550556">*</span><span class="ident" id="5550557">g1</span>&nbsp;<span class="op" id="5550560">-</span>&nbsp;<span class="num" id="5550562">5328</span><span class="op" id="5550566">*</span><span class="ident" id="5550567">b1</span>&nbsp;<span class="op" id="5550570">+</span>&nbsp;<span class="num" id="5550572">257</span><span class="op" id="5550575">&lt;&lt;</span><span class="num" id="5550577">15</span><span class="op" id="5550579">)</span>&nbsp;<span class="op" id="5550581">&gt;&gt;</span>&nbsp;<span class="num" id="5550584">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5550588">if</span>&nbsp;<span class="ident" id="5550591">yy</span>&nbsp;<span class="op" id="5550594">&lt;</span>&nbsp;<span class="num" id="5550596">0</span>&nbsp;<span class="op" id="5550598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550602">yy</span>&nbsp;<span class="op" id="5550605">=</span>&nbsp;<span class="num" id="5550607">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550610">}</span>&nbsp;<span class="keyword" id="5550612">else</span>&nbsp;<span class="keyword" id="5550617">if</span>&nbsp;<span class="ident" id="5550620">yy</span>&nbsp;<span class="op" id="5550623">&gt;</span>&nbsp;<span class="num" id="5550625">255</span>&nbsp;<span class="op" id="5550629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550633">yy</span>&nbsp;<span class="op" id="5550636">=</span>&nbsp;<span class="num" id="5550638">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550643">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5550646">if</span>&nbsp;<span class="ident" id="5550649">cb</span>&nbsp;<span class="op" id="5550652">&lt;</span>&nbsp;<span class="num" id="5550654">0</span>&nbsp;<span class="op" id="5550656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550660">cb</span>&nbsp;<span class="op" id="5550663">=</span>&nbsp;<span class="num" id="5550665">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550668">}</span>&nbsp;<span class="keyword" id="5550670">else</span>&nbsp;<span class="keyword" id="5550675">if</span>&nbsp;<span class="ident" id="5550678">cb</span>&nbsp;<span class="op" id="5550681">&gt;</span>&nbsp;<span class="num" id="5550683">255</span>&nbsp;<span class="op" id="5550687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550691">cb</span>&nbsp;<span class="op" id="5550694">=</span>&nbsp;<span class="num" id="5550696">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550701">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5550704">if</span>&nbsp;<span class="ident" id="5550707">cr</span>&nbsp;<span class="op" id="5550710">&lt;</span>&nbsp;<span class="num" id="5550712">0</span>&nbsp;<span class="op" id="5550714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550718">cr</span>&nbsp;<span class="op" id="5550721">=</span>&nbsp;<span class="num" id="5550723">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550726">}</span>&nbsp;<span class="keyword" id="5550728">else</span>&nbsp;<span class="keyword" id="5550733">if</span>&nbsp;<span class="ident" id="5550736">cr</span>&nbsp;<span class="op" id="5550739">&gt;</span>&nbsp;<span class="num" id="5550741">255</span>&nbsp;<span class="op" id="5550745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5550749">cr</span>&nbsp;<span class="op" id="5550752">=</span>&nbsp;<span class="num" id="5550754">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5550759">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5550762">return</span>&nbsp;<span class="builtintype" id="5550769">uint8</span><span class="op" id="5550774">(</span><span class="ident" id="5550775">yy</span><span class="op" id="5550777">)</span><span class="op" id="5550778">,</span>&nbsp;<span class="builtintype" id="5550780">uint8</span><span class="op" id="5550785">(</span><span class="ident" id="5550786">cb</span><span class="op" id="5550788">)</span><span class="op" id="5550789">,</span>&nbsp;<span class="builtintype" id="5550791">uint8</span><span class="op" id="5550796">(</span><span class="ident" id="5550797">cr</span><span class="op" id="5550799">)</span><br>
<span class="lineno"></span><span class="op" id="5550801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5550804">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5550861">func</span>&nbsp;<span class="ident" id="5550866">YCbCrToRGB</span><span class="op" id="5550876">(</span><span class="ident" id="5550877">y</span><span class="op" id="5550878">,</span>&nbsp;<span class="ident" id="5550880">cb</span><span class="op" id="5550882">,</span>&nbsp;<span class="ident" id="5550884">cr</span>&nbsp;<span class="builtintype" id="5550887">uint8</span><span class="op" id="5550892">)</span>&nbsp;<span class="op" id="5550894">(</span><span class="builtintype" id="5550895">uint8</span><span class="op" id="5550900">,</span>&nbsp;<span class="builtintype" id="5550902">uint8</span><span class="op" id="5550907">,</span>&nbsp;<span class="builtintype" id="5550909">uint8</span><span class="op" id="5550914">)</span>&nbsp;<span class="op" id="5550916">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550919">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550952">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5550982">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5551031">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5551061">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551128">yy1</span>&nbsp;<span class="op" id="5551132">:=</span>&nbsp;<span class="builtintype" id="5551135">int</span><span class="op" id="5551138">(</span><span class="ident" id="5551139">y</span><span class="op" id="5551140">)</span><span class="op" id="5551141">&lt;&lt;</span><span class="num" id="5551143">16</span>&nbsp;<span class="op" id="5551146">+</span>&nbsp;<span class="num" id="5551148">1</span><span class="op" id="5551149">&lt;&lt;</span><span class="num" id="5551151">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551155">cb1</span>&nbsp;<span class="op" id="5551159">:=</span>&nbsp;<span class="builtintype" id="5551162">int</span><span class="op" id="5551165">(</span><span class="ident" id="5551166">cb</span><span class="op" id="5551168">)</span>&nbsp;<span class="op" id="5551170">-</span>&nbsp;<span class="num" id="5551172">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551177">cr1</span>&nbsp;<span class="op" id="5551181">:=</span>&nbsp;<span class="builtintype" id="5551184">int</span><span class="op" id="5551187">(</span><span class="ident" id="5551188">cr</span><span class="op" id="5551190">)</span>&nbsp;<span class="op" id="5551192">-</span>&nbsp;<span class="num" id="5551194">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551199">r</span>&nbsp;<span class="op" id="5551201">:=</span>&nbsp;<span class="op" id="5551204">(</span><span class="ident" id="5551205">yy1</span>&nbsp;<span class="op" id="5551209">+</span>&nbsp;<span class="num" id="5551211">91881</span><span class="op" id="5551216">*</span><span class="ident" id="5551217">cr1</span><span class="op" id="5551220">)</span>&nbsp;<span class="op" id="5551222">&gt;&gt;</span>&nbsp;<span class="num" id="5551225">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551229">g</span>&nbsp;<span class="op" id="5551231">:=</span>&nbsp;<span class="op" id="5551234">(</span><span class="ident" id="5551235">yy1</span>&nbsp;<span class="op" id="5551239">-</span>&nbsp;<span class="num" id="5551241">22554</span><span class="op" id="5551246">*</span><span class="ident" id="5551247">cb1</span>&nbsp;<span class="op" id="5551251">-</span>&nbsp;<span class="num" id="5551253">46802</span><span class="op" id="5551258">*</span><span class="ident" id="5551259">cr1</span><span class="op" id="5551262">)</span>&nbsp;<span class="op" id="5551264">&gt;&gt;</span>&nbsp;<span class="num" id="5551267">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551271">b</span>&nbsp;<span class="op" id="5551273">:=</span>&nbsp;<span class="op" id="5551276">(</span><span class="ident" id="5551277">yy1</span>&nbsp;<span class="op" id="5551281">+</span>&nbsp;<span class="num" id="5551283">116130</span><span class="op" id="5551289">*</span><span class="ident" id="5551290">cb1</span><span class="op" id="5551293">)</span>&nbsp;<span class="op" id="5551295">&gt;&gt;</span>&nbsp;<span class="num" id="5551298">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5551302">if</span>&nbsp;<span class="ident" id="5551305">r</span>&nbsp;<span class="op" id="5551307">&lt;</span>&nbsp;<span class="num" id="5551309">0</span>&nbsp;<span class="op" id="5551311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551315">r</span>&nbsp;<span class="op" id="5551317">=</span>&nbsp;<span class="num" id="5551319">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551322">}</span>&nbsp;<span class="keyword" id="5551324">else</span>&nbsp;<span class="keyword" id="5551329">if</span>&nbsp;<span class="ident" id="5551332">r</span>&nbsp;<span class="op" id="5551334">&gt;</span>&nbsp;<span class="num" id="5551336">255</span>&nbsp;<span class="op" id="5551340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551344">r</span>&nbsp;<span class="op" id="5551346">=</span>&nbsp;<span class="num" id="5551348">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5551356">if</span>&nbsp;<span class="ident" id="5551359">g</span>&nbsp;<span class="op" id="5551361">&lt;</span>&nbsp;<span class="num" id="5551363">0</span>&nbsp;<span class="op" id="5551365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551369">g</span>&nbsp;<span class="op" id="5551371">=</span>&nbsp;<span class="num" id="5551373">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551376">}</span>&nbsp;<span class="keyword" id="5551378">else</span>&nbsp;<span class="keyword" id="5551383">if</span>&nbsp;<span class="ident" id="5551386">g</span>&nbsp;<span class="op" id="5551388">&gt;</span>&nbsp;<span class="num" id="5551390">255</span>&nbsp;<span class="op" id="5551394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551398">g</span>&nbsp;<span class="op" id="5551400">=</span>&nbsp;<span class="num" id="5551402">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5551410">if</span>&nbsp;<span class="ident" id="5551413">b</span>&nbsp;<span class="op" id="5551415">&lt;</span>&nbsp;<span class="num" id="5551417">0</span>&nbsp;<span class="op" id="5551419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551423">b</span>&nbsp;<span class="op" id="5551425">=</span>&nbsp;<span class="num" id="5551427">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551430">}</span>&nbsp;<span class="keyword" id="5551432">else</span>&nbsp;<span class="keyword" id="5551437">if</span>&nbsp;<span class="ident" id="5551440">b</span>&nbsp;<span class="op" id="5551442">&gt;</span>&nbsp;<span class="num" id="5551444">255</span>&nbsp;<span class="op" id="5551448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5551452">b</span>&nbsp;<span class="op" id="5551454">=</span>&nbsp;<span class="num" id="5551456">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5551461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5551464">return</span>&nbsp;<span class="builtintype" id="5551471">uint8</span><span class="op" id="5551476">(</span><span class="ident" id="5551477">r</span><span class="op" id="5551478">)</span><span class="op" id="5551479">,</span>&nbsp;<span class="builtintype" id="5551481">uint8</span><span class="op" id="5551486">(</span><span class="ident" id="5551487">g</span><span class="op" id="5551488">)</span><span class="op" id="5551489">,</span>&nbsp;<span class="builtintype" id="5551491">uint8</span><span class="op" id="5551496">(</span><span class="ident" id="5551497">b</span><span class="op" id="5551498">)</span><br>
<span class="lineno"></span><span class="op" id="5551500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5551503">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="5551582">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="5551621">//</span><br>
<span class="lineno"></span><span class="comment" id="5551624">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="5551698">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="5551773">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="5551851">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="5551904">//</span><br>
<span class="lineno"></span><span class="comment" id="5551907">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="5551986">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="5552061">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="5552133">type</span>&nbsp;<span class="ident" id="5552138">YCbCr</span>&nbsp;<span class="keyword" id="5552144">struct</span>&nbsp;<span class="op" id="5552151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5552154">Y</span><span class="op" id="5552155">,</span>&nbsp;<span class="ident" id="5552157">Cb</span><span class="op" id="5552159">,</span>&nbsp;<span class="ident" id="5552161">Cr</span>&nbsp;<span class="builtintype" id="5552164">uint8</span><br>
<span class="lineno"></span><span class="op" id="5552170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5552173">func</span>&nbsp;<span class="op" id="5552178">(</span><span class="ident" id="5552179">c</span>&nbsp;<span class="ident" id="5552181">YCbCr</span><span class="op" id="5552186">)</span>&nbsp;<span class="ident" id="5552188">RGBA</span><span class="op" id="5552192">(</span><span class="op" id="5552193">)</span>&nbsp;<span class="op" id="5552195">(</span><span class="builtintype" id="5552196">uint32</span><span class="op" id="5552202">,</span>&nbsp;<span class="builtintype" id="5552204">uint32</span><span class="op" id="5552210">,</span>&nbsp;<span class="builtintype" id="5552212">uint32</span><span class="op" id="5552218">,</span>&nbsp;<span class="builtintype" id="5552220">uint32</span><span class="op" id="5552226">)</span>&nbsp;<span class="op" id="5552228">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5552231">r</span><span class="op" id="5552232">,</span>&nbsp;<span class="ident" id="5552234">g</span><span class="op" id="5552235">,</span>&nbsp;<span class="ident" id="5552237">b</span>&nbsp;<span class="op" id="5552239">:=</span>&nbsp;<span class="ident" id="5552242">YCbCrToRGB</span><span class="op" id="5552252">(</span><span class="ident" id="5552253">c</span><span class="op" id="5552254">.</span><span class="ident" id="5552255">Y</span><span class="op" id="5552256">,</span>&nbsp;<span class="ident" id="5552258">c</span><span class="op" id="5552259">.</span><span class="ident" id="5552260">Cb</span><span class="op" id="5552262">,</span>&nbsp;<span class="ident" id="5552264">c</span><span class="op" id="5552265">.</span><span class="ident" id="5552266">Cr</span><span class="op" id="5552268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5552271">return</span>&nbsp;<span class="builtintype" id="5552278">uint32</span><span class="op" id="5552284">(</span><span class="ident" id="5552285">r</span><span class="op" id="5552286">)</span>&nbsp;<span class="op" id="5552288">*</span>&nbsp;<span class="num" id="5552290">0x101</span><span class="op" id="5552295">,</span>&nbsp;<span class="builtintype" id="5552297">uint32</span><span class="op" id="5552303">(</span><span class="ident" id="5552304">g</span><span class="op" id="5552305">)</span>&nbsp;<span class="op" id="5552307">*</span>&nbsp;<span class="num" id="5552309">0x101</span><span class="op" id="5552314">,</span>&nbsp;<span class="builtintype" id="5552316">uint32</span><span class="op" id="5552322">(</span><span class="ident" id="5552323">b</span><span class="op" id="5552324">)</span>&nbsp;<span class="op" id="5552326">*</span>&nbsp;<span class="num" id="5552328">0x101</span><span class="op" id="5552333">,</span>&nbsp;<span class="num" id="5552335">0xffff</span><br>
<span class="lineno"></span><span class="op" id="5552342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5552345">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="5552391">var</span>&nbsp;<span class="ident" id="5552395">YCbCrModel</span>&nbsp;<span class="ident" id="5552406">Model</span>&nbsp;<span class="op" id="5552412">=</span>&nbsp;<span class="ident" id="5552414">ModelFunc</span><span class="op" id="5552423">(</span><span class="ident" id="5552424">yCbCrModel</span><span class="op" id="5552434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5552437">func</span>&nbsp;<span class="ident" id="5552442">yCbCrModel</span><span class="op" id="5552452">(</span><span class="ident" id="5552453">c</span>&nbsp;<span class="ident" id="5552455">Color</span><span class="op" id="5552460">)</span>&nbsp;<span class="ident" id="5552462">Color</span>&nbsp;<span class="op" id="5552468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5552471">if</span>&nbsp;<span class="ident" id="5552474">_</span><span class="op" id="5552475">,</span>&nbsp;<span class="ident" id="5552477">ok</span>&nbsp;<span class="op" id="5552480">:=</span>&nbsp;<span class="ident" id="5552483">c</span><span class="op" id="5552484">.</span><span class="op" id="5552485">(</span><span class="ident" id="5552486">YCbCr</span><span class="op" id="5552491">)</span><span class="op" id="5552492">;</span>&nbsp;<span class="ident" id="5552494">ok</span>&nbsp;<span class="op" id="5552497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5552501">return</span>&nbsp;<span class="ident" id="5552508">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5552511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5552514">r</span><span class="op" id="5552515">,</span>&nbsp;<span class="ident" id="5552517">g</span><span class="op" id="5552518">,</span>&nbsp;<span class="ident" id="5552520">b</span><span class="op" id="5552521">,</span>&nbsp;<span class="ident" id="5552523">_</span>&nbsp;<span class="op" id="5552525">:=</span>&nbsp;<span class="ident" id="5552528">c</span><span class="op" id="5552529">.</span><span class="ident" id="5552530">RGBA</span><span class="op" id="5552534">(</span><span class="op" id="5552535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5552538">y</span><span class="op" id="5552539">,</span>&nbsp;<span class="ident" id="5552541">u</span><span class="op" id="5552542">,</span>&nbsp;<span class="ident" id="5552544">v</span>&nbsp;<span class="op" id="5552546">:=</span>&nbsp;<span class="ident" id="5552549">RGBToYCbCr</span><span class="op" id="5552559">(</span><span class="builtintype" id="5552560">uint8</span><span class="op" id="5552565">(</span><span class="ident" id="5552566">r</span><span class="op" id="5552567">&gt;&gt;</span><span class="num" id="5552569">8</span><span class="op" id="5552570">)</span><span class="op" id="5552571">,</span>&nbsp;<span class="builtintype" id="5552573">uint8</span><span class="op" id="5552578">(</span><span class="ident" id="5552579">g</span><span class="op" id="5552580">&gt;&gt;</span><span class="num" id="5552582">8</span><span class="op" id="5552583">)</span><span class="op" id="5552584">,</span>&nbsp;<span class="builtintype" id="5552586">uint8</span><span class="op" id="5552591">(</span><span class="ident" id="5552592">b</span><span class="op" id="5552593">&gt;&gt;</span><span class="num" id="5552595">8</span><span class="op" id="5552596">)</span><span class="op" id="5552597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5552600">return</span>&nbsp;<span class="ident" id="5552607">YCbCr</span><span class="op" id="5552612">{</span><span class="ident" id="5552613">y</span><span class="op" id="5552614">,</span>&nbsp;<span class="ident" id="5552616">u</span><span class="op" id="5552617">,</span>&nbsp;<span class="ident" id="5552619">v</span><span class="op" id="5552620">}</span><br>
<span class="lineno"></span><span class="op" id="5552622">}</span>
</div>
</body>
</html>
