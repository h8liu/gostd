<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3804543">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3804598">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3804652">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3804703">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804720">package</span>&nbsp;<span class="ident" id="3804728">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3804733">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3804761">func</span>&nbsp;<span class="ident" id="3804766">hasAsm</span><span class="op" id="3804772">(</span><span class="op" id="3804773">)</span>&nbsp;<span class="builtintype" id="3804775">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3804780">func</span>&nbsp;<span class="ident" id="3804785">encryptBlockAsm</span><span class="op" id="3804800">(</span><span class="ident" id="3804801">nr</span>&nbsp;<span class="builtintype" id="3804804">int</span><span class="op" id="3804807">,</span>&nbsp;<span class="ident" id="3804809">xk</span>&nbsp;<span class="op" id="3804812">*</span><span class="builtintype" id="3804813">uint32</span><span class="op" id="3804819">,</span>&nbsp;<span class="ident" id="3804821">dst</span><span class="op" id="3804824">,</span>&nbsp;<span class="ident" id="3804826">src</span>&nbsp;<span class="op" id="3804830">*</span><span class="builtintype" id="3804831">byte</span><span class="op" id="3804835">)</span><br>
<span class="lineno"></span><span class="keyword" id="3804837">func</span>&nbsp;<span class="ident" id="3804842">decryptBlockAsm</span><span class="op" id="3804857">(</span><span class="ident" id="3804858">nr</span>&nbsp;<span class="builtintype" id="3804861">int</span><span class="op" id="3804864">,</span>&nbsp;<span class="ident" id="3804866">xk</span>&nbsp;<span class="op" id="3804869">*</span><span class="builtintype" id="3804870">uint32</span><span class="op" id="3804876">,</span>&nbsp;<span class="ident" id="3804878">dst</span><span class="op" id="3804881">,</span>&nbsp;<span class="ident" id="3804883">src</span>&nbsp;<span class="op" id="3804887">*</span><span class="builtintype" id="3804888">byte</span><span class="op" id="3804892">)</span><br>
<span class="lineno"></span><span class="keyword" id="3804894">func</span>&nbsp;<span class="ident" id="3804899">expandKeyAsm</span><span class="op" id="3804911">(</span><span class="ident" id="3804912">nr</span>&nbsp;<span class="builtintype" id="3804915">int</span><span class="op" id="3804918">,</span>&nbsp;<span class="ident" id="3804920">key</span>&nbsp;<span class="op" id="3804924">*</span><span class="builtintype" id="3804925">byte</span><span class="op" id="3804929">,</span>&nbsp;<span class="ident" id="3804931">enc</span>&nbsp;<span class="op" id="3804935">*</span><span class="builtintype" id="3804936">uint32</span><span class="op" id="3804942">,</span>&nbsp;<span class="ident" id="3804944">dec</span>&nbsp;<span class="op" id="3804948">*</span><span class="builtintype" id="3804949">uint32</span><span class="op" id="3804955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3804958">var</span>&nbsp;<span class="ident" id="3804962">useAsm</span>&nbsp;<span class="op" id="3804969">=</span>&nbsp;<span class="ident" id="3804971">hasAsm</span><span class="op" id="3804977">(</span><span class="op" id="3804978">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3804981">func</span>&nbsp;<span class="ident" id="3804986">encryptBlock</span><span class="op" id="3804998">(</span><span class="ident" id="3804999">xk</span>&nbsp;<span class="op" id="3805002">[</span><span class="op" id="3805003">]</span><span class="builtintype" id="3805004">uint32</span><span class="op" id="3805010">,</span>&nbsp;<span class="ident" id="3805012">dst</span><span class="op" id="3805015">,</span>&nbsp;<span class="ident" id="3805017">src</span>&nbsp;<span class="op" id="3805021">[</span><span class="op" id="3805022">]</span><span class="builtintype" id="3805023">byte</span><span class="op" id="3805027">)</span>&nbsp;<span class="op" id="3805029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805032">if</span>&nbsp;<span class="ident" id="3805035">useAsm</span>&nbsp;<span class="op" id="3805042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805046">encryptBlockAsm</span><span class="op" id="3805061">(</span><span class="builtinfunc" id="3805062">len</span><span class="op" id="3805065">(</span><span class="ident" id="3805066">xk</span><span class="op" id="3805068">)</span><span class="op" id="3805069">/</span><span class="num" id="3805070">4</span><span class="op" id="3805071">-</span><span class="num" id="3805072">1</span><span class="op" id="3805073">,</span>&nbsp;<span class="op" id="3805075">&amp;</span><span class="ident" id="3805076">xk</span><span class="op" id="3805078">[</span><span class="num" id="3805079">0</span><span class="op" id="3805080">]</span><span class="op" id="3805081">,</span>&nbsp;<span class="op" id="3805083">&amp;</span><span class="ident" id="3805084">dst</span><span class="op" id="3805087">[</span><span class="num" id="3805088">0</span><span class="op" id="3805089">]</span><span class="op" id="3805090">,</span>&nbsp;<span class="op" id="3805092">&amp;</span><span class="ident" id="3805093">src</span><span class="op" id="3805096">[</span><span class="num" id="3805097">0</span><span class="op" id="3805098">]</span><span class="op" id="3805099">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805102">}</span>&nbsp;<span class="keyword" id="3805104">else</span>&nbsp;<span class="op" id="3805109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805113">encryptBlockGo</span><span class="op" id="3805127">(</span><span class="ident" id="3805128">xk</span><span class="op" id="3805130">,</span>&nbsp;<span class="ident" id="3805132">dst</span><span class="op" id="3805135">,</span>&nbsp;<span class="ident" id="3805137">src</span><span class="op" id="3805140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805143">}</span><br>
<span class="lineno"></span><span class="op" id="3805145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3805148">func</span>&nbsp;<span class="ident" id="3805153">decryptBlock</span><span class="op" id="3805165">(</span><span class="ident" id="3805166">xk</span>&nbsp;<span class="op" id="3805169">[</span><span class="op" id="3805170">]</span><span class="builtintype" id="3805171">uint32</span><span class="op" id="3805177">,</span>&nbsp;<span class="ident" id="3805179">dst</span><span class="op" id="3805182">,</span>&nbsp;<span class="ident" id="3805184">src</span>&nbsp;<span class="op" id="3805188">[</span><span class="op" id="3805189">]</span><span class="builtintype" id="3805190">byte</span><span class="op" id="3805194">)</span>&nbsp;<span class="op" id="3805196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805199">if</span>&nbsp;<span class="ident" id="3805202">useAsm</span>&nbsp;<span class="op" id="3805209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805213">decryptBlockAsm</span><span class="op" id="3805228">(</span><span class="builtinfunc" id="3805229">len</span><span class="op" id="3805232">(</span><span class="ident" id="3805233">xk</span><span class="op" id="3805235">)</span><span class="op" id="3805236">/</span><span class="num" id="3805237">4</span><span class="op" id="3805238">-</span><span class="num" id="3805239">1</span><span class="op" id="3805240">,</span>&nbsp;<span class="op" id="3805242">&amp;</span><span class="ident" id="3805243">xk</span><span class="op" id="3805245">[</span><span class="num" id="3805246">0</span><span class="op" id="3805247">]</span><span class="op" id="3805248">,</span>&nbsp;<span class="op" id="3805250">&amp;</span><span class="ident" id="3805251">dst</span><span class="op" id="3805254">[</span><span class="num" id="3805255">0</span><span class="op" id="3805256">]</span><span class="op" id="3805257">,</span>&nbsp;<span class="op" id="3805259">&amp;</span><span class="ident" id="3805260">src</span><span class="op" id="3805263">[</span><span class="num" id="3805264">0</span><span class="op" id="3805265">]</span><span class="op" id="3805266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805269">}</span>&nbsp;<span class="keyword" id="3805271">else</span>&nbsp;<span class="op" id="3805276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805280">decryptBlockGo</span><span class="op" id="3805294">(</span><span class="ident" id="3805295">xk</span><span class="op" id="3805297">,</span>&nbsp;<span class="ident" id="3805299">dst</span><span class="op" id="3805302">,</span>&nbsp;<span class="ident" id="3805304">src</span><span class="op" id="3805307">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805310">}</span><br>
<span class="lineno"></span><span class="op" id="3805312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3805315">func</span>&nbsp;<span class="ident" id="3805320">expandKey</span><span class="op" id="3805329">(</span><span class="ident" id="3805330">key</span>&nbsp;<span class="op" id="3805334">[</span><span class="op" id="3805335">]</span><span class="builtintype" id="3805336">byte</span><span class="op" id="3805340">,</span>&nbsp;<span class="ident" id="3805342">enc</span><span class="op" id="3805345">,</span>&nbsp;<span class="ident" id="3805347">dec</span>&nbsp;<span class="op" id="3805351">[</span><span class="op" id="3805352">]</span><span class="builtintype" id="3805353">uint32</span><span class="op" id="3805359">)</span>&nbsp;<span class="op" id="3805361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805364">if</span>&nbsp;<span class="ident" id="3805367">useAsm</span>&nbsp;<span class="op" id="3805374">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805378">rounds</span>&nbsp;<span class="op" id="3805385">:=</span>&nbsp;<span class="num" id="3805388">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805393">switch</span>&nbsp;<span class="builtinfunc" id="3805400">len</span><span class="op" id="3805403">(</span><span class="ident" id="3805404">key</span><span class="op" id="3805407">)</span>&nbsp;<span class="op" id="3805409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805413">case</span>&nbsp;<span class="num" id="3805418">128</span>&nbsp;<span class="op" id="3805422">/</span>&nbsp;<span class="num" id="3805424">8</span><span class="op" id="3805425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805430">rounds</span>&nbsp;<span class="op" id="3805437">=</span>&nbsp;<span class="num" id="3805439">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805444">case</span>&nbsp;<span class="num" id="3805449">192</span>&nbsp;<span class="op" id="3805453">/</span>&nbsp;<span class="num" id="3805455">8</span><span class="op" id="3805456">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805461">rounds</span>&nbsp;<span class="op" id="3805468">=</span>&nbsp;<span class="num" id="3805470">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805475">case</span>&nbsp;<span class="num" id="3805480">256</span>&nbsp;<span class="op" id="3805484">/</span>&nbsp;<span class="num" id="3805486">8</span><span class="op" id="3805487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805492">rounds</span>&nbsp;<span class="op" id="3805499">=</span>&nbsp;<span class="num" id="3805501">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805510">expandKeyAsm</span><span class="op" id="3805522">(</span><span class="ident" id="3805523">rounds</span><span class="op" id="3805529">,</span>&nbsp;<span class="op" id="3805531">&amp;</span><span class="ident" id="3805532">key</span><span class="op" id="3805535">[</span><span class="num" id="3805536">0</span><span class="op" id="3805537">]</span><span class="op" id="3805538">,</span>&nbsp;<span class="op" id="3805540">&amp;</span><span class="ident" id="3805541">enc</span><span class="op" id="3805544">[</span><span class="num" id="3805545">0</span><span class="op" id="3805546">]</span><span class="op" id="3805547">,</span>&nbsp;<span class="op" id="3805549">&amp;</span><span class="ident" id="3805550">dec</span><span class="op" id="3805553">[</span><span class="num" id="3805554">0</span><span class="op" id="3805555">]</span><span class="op" id="3805556">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805559">}</span>&nbsp;<span class="keyword" id="3805561">else</span>&nbsp;<span class="op" id="3805566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805570">expandKeyGo</span><span class="op" id="3805581">(</span><span class="ident" id="3805582">key</span><span class="op" id="3805585">,</span>&nbsp;<span class="ident" id="3805587">enc</span><span class="op" id="3805590">,</span>&nbsp;<span class="ident" id="3805592">dec</span><span class="op" id="3805595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805598">}</span><br>
<span class="lineno"></span><span class="op" id="3805600">}</span>
</div>
</body>
</html>
