<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8545336">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8545391">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8545445">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8545496">package</span>&nbsp;<span class="ident" id="8545504">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545509">import</span>&nbsp;<span class="op" id="8545516">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545519">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545528">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545538">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545553">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545568">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545587">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545603">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545609">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545621">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545632">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8545648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8545651">func</span>&nbsp;<span class="ident" id="8545656">decodeBase64</span><span class="op" id="8545668">(</span><span class="ident" id="8545669">in</span>&nbsp;<span class="builtintype" id="8545672">string</span><span class="op" id="8545678">)</span>&nbsp;<span class="op" id="8545680">[</span><span class="op" id="8545681">]</span><span class="builtintype" id="8545682">byte</span>&nbsp;<span class="op" id="8545687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545690">out</span>&nbsp;<span class="op" id="8545694">:=</span>&nbsp;<span class="builtinfunc" id="8545697">make</span><span class="op" id="8545701">(</span><span class="op" id="8545702">[</span><span class="op" id="8545703">]</span><span class="builtintype" id="8545704">byte</span><span class="op" id="8545708">,</span>&nbsp;<span class="ident" id="8545710">base64</span><span class="op" id="8545716">.</span><span class="ident" id="8545717">StdEncoding</span><span class="op" id="8545728">.</span><span class="ident" id="8545729">DecodedLen</span><span class="op" id="8545739">(</span><span class="builtinfunc" id="8545740">len</span><span class="op" id="8545743">(</span><span class="ident" id="8545744">in</span><span class="op" id="8545746">)</span><span class="op" id="8545747">)</span><span class="op" id="8545748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545751">n</span><span class="op" id="8545752">,</span>&nbsp;<span class="ident" id="8545754">err</span>&nbsp;<span class="op" id="8545758">:=</span>&nbsp;<span class="ident" id="8545761">base64</span><span class="op" id="8545767">.</span><span class="ident" id="8545768">StdEncoding</span><span class="op" id="8545779">.</span><span class="ident" id="8545780">Decode</span><span class="op" id="8545786">(</span><span class="ident" id="8545787">out</span><span class="op" id="8545790">,</span>&nbsp;<span class="op" id="8545792">[</span><span class="op" id="8545793">]</span><span class="builtintype" id="8545794">byte</span><span class="op" id="8545798">(</span><span class="ident" id="8545799">in</span><span class="op" id="8545801">)</span><span class="op" id="8545802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545805">if</span>&nbsp;<span class="ident" id="8545808">err</span>&nbsp;<span class="op" id="8545812">!=</span>&nbsp;<span class="ident" id="8545815">nil</span>&nbsp;<span class="op" id="8545819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545823">return</span>&nbsp;<span class="ident" id="8545830">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545838">return</span>&nbsp;<span class="ident" id="8545845">out</span><span class="op" id="8545848">[</span><span class="num" id="8545849">0</span><span class="op" id="8545850">:</span><span class="ident" id="8545851">n</span><span class="op" id="8545852">]</span><br>
<span class="lineno"></span><span class="op" id="8545854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545857">type</span>&nbsp;<span class="ident" id="8545862">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8545882">struct</span>&nbsp;<span class="op" id="8545889">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545892">in</span><span class="op" id="8545894">,</span>&nbsp;<span class="ident" id="8545896">out</span>&nbsp;<span class="builtintype" id="8545900">string</span><br>
<span class="lineno"></span><span class="op" id="8545907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8545910">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8545984">var</span>&nbsp;<span class="ident" id="8545988">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8546009">=</span>&nbsp;<span class="op" id="8546011">[</span><span class="op" id="8546012">]</span><span class="ident" id="8546013">DecryptPKCS1v15Test</span><span class="op" id="8546032">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546039">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8546129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546133">&#34;x&#34;</span><span class="op" id="8546136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546139">}</span><span class="op" id="8546140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546143">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546147">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8546237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546241">&#34;testing.&#34;</span><span class="op" id="8546251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546254">}</span><span class="op" id="8546255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546262">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8546352">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546356">&#34;testing.\n&#34;</span><span class="op" id="8546368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546371">}</span><span class="op" id="8546372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546379">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8546469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546473">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8546528">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546531">}</span><span class="op" id="8546532">,</span><br>
<span class="lineno"></span><span class="op" id="8546534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8546537">func</span>&nbsp;<span class="ident" id="8546542">TestDecryptPKCS1v15</span><span class="op" id="8546561">(</span><span class="ident" id="8546562">t</span>&nbsp;<span class="op" id="8546564">*</span><span class="ident" id="8546565">testing</span><span class="op" id="8546572">.</span><span class="ident" id="8546573">T</span><span class="op" id="8546574">)</span>&nbsp;<span class="op" id="8546576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546579">for</span>&nbsp;<span class="ident" id="8546583">i</span><span class="op" id="8546584">,</span>&nbsp;<span class="ident" id="8546586">test</span>&nbsp;<span class="op" id="8546591">:=</span>&nbsp;<span class="keyword" id="8546594">range</span>&nbsp;<span class="ident" id="8546600">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8546621">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546625">out</span><span class="op" id="8546628">,</span>&nbsp;<span class="ident" id="8546630">err</span>&nbsp;<span class="op" id="8546634">:=</span>&nbsp;<span class="ident" id="8546637">DecryptPKCS1v15</span><span class="op" id="8546652">(</span><span class="ident" id="8546653">nil</span><span class="op" id="8546656">,</span>&nbsp;<span class="ident" id="8546658">rsaPrivateKey</span><span class="op" id="8546671">,</span>&nbsp;<span class="ident" id="8546673">decodeBase64</span><span class="op" id="8546685">(</span><span class="ident" id="8546686">test</span><span class="op" id="8546690">.</span><span class="ident" id="8546691">in</span><span class="op" id="8546693">)</span><span class="op" id="8546694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546698">if</span>&nbsp;<span class="ident" id="8546701">err</span>&nbsp;<span class="op" id="8546705">!=</span>&nbsp;<span class="ident" id="8546708">nil</span>&nbsp;<span class="op" id="8546712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546717">t</span><span class="op" id="8546718">.</span><span class="ident" id="8546719">Errorf</span><span class="op" id="8546725">(</span><span class="string" id="8546726">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8546748">,</span>&nbsp;<span class="ident" id="8546750">i</span><span class="op" id="8546751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546759">want</span>&nbsp;<span class="op" id="8546764">:=</span>&nbsp;<span class="op" id="8546767">[</span><span class="op" id="8546768">]</span><span class="builtintype" id="8546769">byte</span><span class="op" id="8546773">(</span><span class="ident" id="8546774">test</span><span class="op" id="8546778">.</span><span class="ident" id="8546779">out</span><span class="op" id="8546782">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546786">if</span>&nbsp;<span class="op" id="8546789">!</span><span class="ident" id="8546790">bytes</span><span class="op" id="8546795">.</span><span class="ident" id="8546796">Equal</span><span class="op" id="8546801">(</span><span class="ident" id="8546802">out</span><span class="op" id="8546805">,</span>&nbsp;<span class="ident" id="8546807">want</span><span class="op" id="8546811">)</span>&nbsp;<span class="op" id="8546813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546818">t</span><span class="op" id="8546819">.</span><span class="ident" id="8546820">Errorf</span><span class="op" id="8546826">(</span><span class="string" id="8546827">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8546849">,</span>&nbsp;<span class="ident" id="8546851">i</span><span class="op" id="8546852">,</span>&nbsp;<span class="ident" id="8546854">out</span><span class="op" id="8546857">,</span>&nbsp;<span class="ident" id="8546859">want</span><span class="op" id="8546863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546870">}</span><br>
<span class="lineno"></span><span class="op" id="8546872">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8546875">func</span>&nbsp;<span class="ident" id="8546880">TestEncryptPKCS1v15</span><span class="op" id="8546899">(</span><span class="ident" id="8546900">t</span>&nbsp;<span class="op" id="8546902">*</span><span class="ident" id="8546903">testing</span><span class="op" id="8546910">.</span><span class="ident" id="8546911">T</span><span class="op" id="8546912">)</span>&nbsp;<span class="op" id="8546914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546917">random</span>&nbsp;<span class="op" id="8546924">:=</span>&nbsp;<span class="ident" id="8546927">rand</span><span class="op" id="8546931">.</span><span class="ident" id="8546932">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546940">k</span>&nbsp;<span class="op" id="8546942">:=</span>&nbsp;<span class="op" id="8546945">(</span><span class="ident" id="8546946">rsaPrivateKey</span><span class="op" id="8546959">.</span><span class="ident" id="8546960">N</span><span class="op" id="8546961">.</span><span class="ident" id="8546962">BitLen</span><span class="op" id="8546968">(</span><span class="op" id="8546969">)</span>&nbsp;<span class="op" id="8546971">+</span>&nbsp;<span class="num" id="8546973">7</span><span class="op" id="8546974">)</span>&nbsp;<span class="op" id="8546976">/</span>&nbsp;<span class="num" id="8546978">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546982">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8547000">:=</span>&nbsp;<span class="keyword" id="8547003">func</span><span class="op" id="8547007">(</span><span class="ident" id="8547008">in</span>&nbsp;<span class="op" id="8547011">[</span><span class="op" id="8547012">]</span><span class="builtintype" id="8547013">byte</span><span class="op" id="8547017">,</span>&nbsp;<span class="ident" id="8547019">blind</span>&nbsp;<span class="builtintype" id="8547025">bool</span><span class="op" id="8547029">)</span>&nbsp;<span class="builtintype" id="8547031">bool</span>&nbsp;<span class="op" id="8547036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547040">if</span>&nbsp;<span class="builtinfunc" id="8547043">len</span><span class="op" id="8547046">(</span><span class="ident" id="8547047">in</span><span class="op" id="8547049">)</span>&nbsp;<span class="op" id="8547051">&gt;</span>&nbsp;<span class="ident" id="8547053">k</span><span class="op" id="8547054">-</span><span class="num" id="8547055">11</span>&nbsp;<span class="op" id="8547058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547063">in</span>&nbsp;<span class="op" id="8547066">=</span>&nbsp;<span class="ident" id="8547068">in</span><span class="op" id="8547070">[</span><span class="num" id="8547071">0</span>&nbsp;<span class="op" id="8547073">:</span>&nbsp;<span class="ident" id="8547075">k</span><span class="op" id="8547076">-</span><span class="num" id="8547077">11</span><span class="op" id="8547079">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547088">ciphertext</span><span class="op" id="8547098">,</span>&nbsp;<span class="ident" id="8547100">err</span>&nbsp;<span class="op" id="8547104">:=</span>&nbsp;<span class="ident" id="8547107">EncryptPKCS1v15</span><span class="op" id="8547122">(</span><span class="ident" id="8547123">random</span><span class="op" id="8547129">,</span>&nbsp;<span class="op" id="8547131">&amp;</span><span class="ident" id="8547132">rsaPrivateKey</span><span class="op" id="8547145">.</span><span class="ident" id="8547146">PublicKey</span><span class="op" id="8547155">,</span>&nbsp;<span class="ident" id="8547157">in</span><span class="op" id="8547159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547163">if</span>&nbsp;<span class="ident" id="8547166">err</span>&nbsp;<span class="op" id="8547170">!=</span>&nbsp;<span class="ident" id="8547173">nil</span>&nbsp;<span class="op" id="8547177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547182">t</span><span class="op" id="8547183">.</span><span class="ident" id="8547184">Errorf</span><span class="op" id="8547190">(</span><span class="string" id="8547191">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8547213">,</span>&nbsp;<span class="ident" id="8547215">err</span><span class="op" id="8547218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547223">return</span>&nbsp;<span class="builtintype" id="8547230">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547238">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547243">var</span>&nbsp;<span class="ident" id="8547247">rand</span>&nbsp;<span class="ident" id="8547252">io</span><span class="op" id="8547254">.</span><span class="ident" id="8547255">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547264">if</span>&nbsp;<span class="op" id="8547267">!</span><span class="ident" id="8547268">blind</span>&nbsp;<span class="op" id="8547274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547279">rand</span>&nbsp;<span class="op" id="8547284">=</span>&nbsp;<span class="ident" id="8547286">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547292">}</span>&nbsp;<span class="keyword" id="8547294">else</span>&nbsp;<span class="op" id="8547299">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547304">rand</span>&nbsp;<span class="op" id="8547309">=</span>&nbsp;<span class="ident" id="8547311">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547324">plaintext</span><span class="op" id="8547333">,</span>&nbsp;<span class="ident" id="8547335">err</span>&nbsp;<span class="op" id="8547339">:=</span>&nbsp;<span class="ident" id="8547342">DecryptPKCS1v15</span><span class="op" id="8547357">(</span><span class="ident" id="8547358">rand</span><span class="op" id="8547362">,</span>&nbsp;<span class="ident" id="8547364">rsaPrivateKey</span><span class="op" id="8547377">,</span>&nbsp;<span class="ident" id="8547379">ciphertext</span><span class="op" id="8547389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547393">if</span>&nbsp;<span class="ident" id="8547396">err</span>&nbsp;<span class="op" id="8547400">!=</span>&nbsp;<span class="ident" id="8547403">nil</span>&nbsp;<span class="op" id="8547407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547412">t</span><span class="op" id="8547413">.</span><span class="ident" id="8547414">Errorf</span><span class="op" id="8547420">(</span><span class="string" id="8547421">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8547443">,</span>&nbsp;<span class="ident" id="8547445">err</span><span class="op" id="8547448">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547453">return</span>&nbsp;<span class="builtintype" id="8547460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547473">if</span>&nbsp;<span class="op" id="8547476">!</span><span class="ident" id="8547477">bytes</span><span class="op" id="8547482">.</span><span class="ident" id="8547483">Equal</span><span class="op" id="8547488">(</span><span class="ident" id="8547489">plaintext</span><span class="op" id="8547498">,</span>&nbsp;<span class="ident" id="8547500">in</span><span class="op" id="8547502">)</span>&nbsp;<span class="op" id="8547504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547509">t</span><span class="op" id="8547510">.</span><span class="ident" id="8547511">Errorf</span><span class="op" id="8547517">(</span><span class="string" id="8547518">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8547544">,</span>&nbsp;<span class="ident" id="8547546">plaintext</span><span class="op" id="8547555">,</span>&nbsp;<span class="ident" id="8547557">in</span><span class="op" id="8547559">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547564">return</span>&nbsp;<span class="builtintype" id="8547571">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547583">return</span>&nbsp;<span class="builtintype" id="8547590">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547600">config</span>&nbsp;<span class="op" id="8547607">:=</span>&nbsp;<span class="builtinfunc" id="8547610">new</span><span class="op" id="8547613">(</span><span class="ident" id="8547614">quick</span><span class="op" id="8547619">.</span><span class="ident" id="8547620">Config</span><span class="op" id="8547626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547629">if</span>&nbsp;<span class="ident" id="8547632">testing</span><span class="op" id="8547639">.</span><span class="ident" id="8547640">Short</span><span class="op" id="8547645">(</span><span class="op" id="8547646">)</span>&nbsp;<span class="op" id="8547648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547652">config</span><span class="op" id="8547658">.</span><span class="ident" id="8547659">MaxCount</span>&nbsp;<span class="op" id="8547668">=</span>&nbsp;<span class="num" id="8547670">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547677">quick</span><span class="op" id="8547682">.</span><span class="ident" id="8547683">Check</span><span class="op" id="8547688">(</span><span class="ident" id="8547689">tryEncryptDecrypt</span><span class="op" id="8547706">,</span>&nbsp;<span class="ident" id="8547708">config</span><span class="op" id="8547714">)</span><br>
<span class="lineno">105</span><span class="op" id="8547716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8547719">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8547793">var</span>&nbsp;<span class="ident" id="8547797">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8547828">=</span>&nbsp;<span class="op" id="8547830">[</span><span class="op" id="8547831">]</span><span class="ident" id="8547832">DecryptPKCS1v15Test</span><span class="op" id="8547851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547854">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8547858">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8547948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8547952">&#34;1234&#34;</span><span class="op" id="8547958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547961">}</span><span class="op" id="8547962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8547969">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8548059">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548063">&#34;FAIL&#34;</span><span class="op" id="8548069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548072">}</span><span class="op" id="8548073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548080">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8548170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548174">&#34;abcd&#34;</span><span class="op" id="8548180">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548183">}</span><span class="op" id="8548184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548191">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8548281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8548285">&#34;FAIL&#34;</span><span class="op" id="8548291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548294">}</span><span class="op" id="8548295">,</span><br>
<span class="lineno">125</span><span class="op" id="8548297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8548300">func</span>&nbsp;<span class="ident" id="8548305">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8548334">(</span><span class="ident" id="8548335">t</span>&nbsp;<span class="op" id="8548337">*</span><span class="ident" id="8548338">testing</span><span class="op" id="8548345">.</span><span class="ident" id="8548346">T</span><span class="op" id="8548347">)</span>&nbsp;<span class="op" id="8548349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548352">for</span>&nbsp;<span class="ident" id="8548356">i</span><span class="op" id="8548357">,</span>&nbsp;<span class="ident" id="8548359">test</span>&nbsp;<span class="op" id="8548364">:=</span>&nbsp;<span class="keyword" id="8548367">range</span>&nbsp;<span class="ident" id="8548373">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8548404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548408">key</span>&nbsp;<span class="op" id="8548412">:=</span>&nbsp;<span class="op" id="8548415">[</span><span class="op" id="8548416">]</span><span class="builtintype" id="8548417">byte</span><span class="op" id="8548421">(</span><span class="string" id="8548422">&#34;FAIL&#34;</span><span class="op" id="8548428">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548432">err</span>&nbsp;<span class="op" id="8548436">:=</span>&nbsp;<span class="ident" id="8548439">DecryptPKCS1v15SessionKey</span><span class="op" id="8548464">(</span><span class="ident" id="8548465">nil</span><span class="op" id="8548468">,</span>&nbsp;<span class="ident" id="8548470">rsaPrivateKey</span><span class="op" id="8548483">,</span>&nbsp;<span class="ident" id="8548485">decodeBase64</span><span class="op" id="8548497">(</span><span class="ident" id="8548498">test</span><span class="op" id="8548502">.</span><span class="ident" id="8548503">in</span><span class="op" id="8548505">)</span><span class="op" id="8548506">,</span>&nbsp;<span class="ident" id="8548508">key</span><span class="op" id="8548511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548515">if</span>&nbsp;<span class="ident" id="8548518">err</span>&nbsp;<span class="op" id="8548522">!=</span>&nbsp;<span class="ident" id="8548525">nil</span>&nbsp;<span class="op" id="8548529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548534">t</span><span class="op" id="8548535">.</span><span class="ident" id="8548536">Errorf</span><span class="op" id="8548542">(</span><span class="string" id="8548543">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8548565">,</span>&nbsp;<span class="ident" id="8548567">i</span><span class="op" id="8548568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548576">want</span>&nbsp;<span class="op" id="8548581">:=</span>&nbsp;<span class="op" id="8548584">[</span><span class="op" id="8548585">]</span><span class="builtintype" id="8548586">byte</span><span class="op" id="8548590">(</span><span class="ident" id="8548591">test</span><span class="op" id="8548595">.</span><span class="ident" id="8548596">out</span><span class="op" id="8548599">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548603">if</span>&nbsp;<span class="op" id="8548606">!</span><span class="ident" id="8548607">bytes</span><span class="op" id="8548612">.</span><span class="ident" id="8548613">Equal</span><span class="op" id="8548618">(</span><span class="ident" id="8548619">key</span><span class="op" id="8548622">,</span>&nbsp;<span class="ident" id="8548624">want</span><span class="op" id="8548628">)</span>&nbsp;<span class="op" id="8548630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548635">t</span><span class="op" id="8548636">.</span><span class="ident" id="8548637">Errorf</span><span class="op" id="8548643">(</span><span class="string" id="8548644">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8548666">,</span>&nbsp;<span class="ident" id="8548668">i</span><span class="op" id="8548669">,</span>&nbsp;<span class="ident" id="8548671">key</span><span class="op" id="8548674">,</span>&nbsp;<span class="ident" id="8548676">want</span><span class="op" id="8548680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548687">}</span><br>
<span class="lineno"></span><span class="op" id="8548689">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8548692">func</span>&nbsp;<span class="ident" id="8548697">TestNonZeroRandomBytes</span><span class="op" id="8548719">(</span><span class="ident" id="8548720">t</span>&nbsp;<span class="op" id="8548722">*</span><span class="ident" id="8548723">testing</span><span class="op" id="8548730">.</span><span class="ident" id="8548731">T</span><span class="op" id="8548732">)</span>&nbsp;<span class="op" id="8548734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548737">random</span>&nbsp;<span class="op" id="8548744">:=</span>&nbsp;<span class="ident" id="8548747">rand</span><span class="op" id="8548751">.</span><span class="ident" id="8548752">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548761">b</span>&nbsp;<span class="op" id="8548763">:=</span>&nbsp;<span class="builtinfunc" id="8548766">make</span><span class="op" id="8548770">(</span><span class="op" id="8548771">[</span><span class="op" id="8548772">]</span><span class="builtintype" id="8548773">byte</span><span class="op" id="8548777">,</span>&nbsp;<span class="num" id="8548779">512</span><span class="op" id="8548782">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548785">err</span>&nbsp;<span class="op" id="8548789">:=</span>&nbsp;<span class="ident" id="8548792">nonZeroRandomBytes</span><span class="op" id="8548810">(</span><span class="ident" id="8548811">b</span><span class="op" id="8548812">,</span>&nbsp;<span class="ident" id="8548814">random</span><span class="op" id="8548820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548823">if</span>&nbsp;<span class="ident" id="8548826">err</span>&nbsp;<span class="op" id="8548830">!=</span>&nbsp;<span class="ident" id="8548833">nil</span>&nbsp;<span class="op" id="8548837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548841">t</span><span class="op" id="8548842">.</span><span class="ident" id="8548843">Errorf</span><span class="op" id="8548849">(</span><span class="string" id="8548850">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8548870">,</span>&nbsp;<span class="ident" id="8548872">err</span><span class="op" id="8548875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548881">for</span>&nbsp;<span class="ident" id="8548885">_</span><span class="op" id="8548886">,</span>&nbsp;<span class="ident" id="8548888">b</span>&nbsp;<span class="op" id="8548890">:=</span>&nbsp;<span class="keyword" id="8548893">range</span>&nbsp;<span class="ident" id="8548899">b</span>&nbsp;<span class="op" id="8548901">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548905">if</span>&nbsp;<span class="ident" id="8548908">b</span>&nbsp;<span class="op" id="8548910">==</span>&nbsp;<span class="num" id="8548913">0</span>&nbsp;<span class="op" id="8548915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548920">t</span><span class="op" id="8548921">.</span><span class="ident" id="8548922">Errorf</span><span class="op" id="8548928">(</span><span class="string" id="8548929">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8548947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548952">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548964">}</span><br>
<span class="lineno">155</span><span class="op" id="8548966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8548969">type</span>&nbsp;<span class="ident" id="8548974">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8548991">struct</span>&nbsp;<span class="op" id="8548998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549001">in</span><span class="op" id="8549003">,</span>&nbsp;<span class="ident" id="8549005">out</span>&nbsp;<span class="builtintype" id="8549009">string</span><br>
<span class="lineno"></span><span class="op" id="8549016">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8549019">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8549058">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8549125">var</span>&nbsp;<span class="ident" id="8549129">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8549147">=</span>&nbsp;<span class="op" id="8549149">[</span><span class="op" id="8549150">]</span><span class="ident" id="8549151">signPKCS1v15Test</span><span class="op" id="8549167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549170">{</span><span class="string" id="8549171">&#34;Test.\n&#34;</span><span class="op" id="8549180">,</span>&nbsp;<span class="string" id="8549182">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8549312">}</span><span class="op" id="8549313">,</span><br>
<span class="lineno">165</span><span class="op" id="8549315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8549318">func</span>&nbsp;<span class="ident" id="8549323">TestSignPKCS1v15</span><span class="op" id="8549339">(</span><span class="ident" id="8549340">t</span>&nbsp;<span class="op" id="8549342">*</span><span class="ident" id="8549343">testing</span><span class="op" id="8549350">.</span><span class="ident" id="8549351">T</span><span class="op" id="8549352">)</span>&nbsp;<span class="op" id="8549354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549357">for</span>&nbsp;<span class="ident" id="8549361">i</span><span class="op" id="8549362">,</span>&nbsp;<span class="ident" id="8549364">test</span>&nbsp;<span class="op" id="8549369">:=</span>&nbsp;<span class="keyword" id="8549372">range</span>&nbsp;<span class="ident" id="8549378">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8549396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549400">h</span>&nbsp;<span class="op" id="8549402">:=</span>&nbsp;<span class="ident" id="8549405">sha1</span><span class="op" id="8549409">.</span><span class="ident" id="8549410">New</span><span class="op" id="8549413">(</span><span class="op" id="8549414">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549418">h</span><span class="op" id="8549419">.</span><span class="ident" id="8549420">Write</span><span class="op" id="8549425">(</span><span class="op" id="8549426">[</span><span class="op" id="8549427">]</span><span class="builtintype" id="8549428">byte</span><span class="op" id="8549432">(</span><span class="ident" id="8549433">test</span><span class="op" id="8549437">.</span><span class="ident" id="8549438">in</span><span class="op" id="8549440">)</span><span class="op" id="8549441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549445">digest</span>&nbsp;<span class="op" id="8549452">:=</span>&nbsp;<span class="ident" id="8549455">h</span><span class="op" id="8549456">.</span><span class="ident" id="8549457">Sum</span><span class="op" id="8549460">(</span><span class="ident" id="8549461">nil</span><span class="op" id="8549464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549469">s</span><span class="op" id="8549470">,</span>&nbsp;<span class="ident" id="8549472">err</span>&nbsp;<span class="op" id="8549476">:=</span>&nbsp;<span class="ident" id="8549479">SignPKCS1v15</span><span class="op" id="8549491">(</span><span class="ident" id="8549492">nil</span><span class="op" id="8549495">,</span>&nbsp;<span class="ident" id="8549497">rsaPrivateKey</span><span class="op" id="8549510">,</span>&nbsp;<span class="ident" id="8549512">crypto</span><span class="op" id="8549518">.</span><span class="ident" id="8549519">SHA1</span><span class="op" id="8549523">,</span>&nbsp;<span class="ident" id="8549525">digest</span><span class="op" id="8549531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549535">if</span>&nbsp;<span class="ident" id="8549538">err</span>&nbsp;<span class="op" id="8549542">!=</span>&nbsp;<span class="ident" id="8549545">nil</span>&nbsp;<span class="op" id="8549549">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549554">t</span><span class="op" id="8549555">.</span><span class="ident" id="8549556">Errorf</span><span class="op" id="8549562">(</span><span class="string" id="8549563">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8549571">,</span>&nbsp;<span class="ident" id="8549573">i</span><span class="op" id="8549574">,</span>&nbsp;<span class="ident" id="8549576">err</span><span class="op" id="8549579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549588">expected</span><span class="op" id="8549596">,</span>&nbsp;<span class="ident" id="8549598">_</span>&nbsp;<span class="op" id="8549600">:=</span>&nbsp;<span class="ident" id="8549603">hex</span><span class="op" id="8549606">.</span><span class="ident" id="8549607">DecodeString</span><span class="op" id="8549619">(</span><span class="ident" id="8549620">test</span><span class="op" id="8549624">.</span><span class="ident" id="8549625">out</span><span class="op" id="8549628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549632">if</span>&nbsp;<span class="op" id="8549635">!</span><span class="ident" id="8549636">bytes</span><span class="op" id="8549641">.</span><span class="ident" id="8549642">Equal</span><span class="op" id="8549647">(</span><span class="ident" id="8549648">s</span><span class="op" id="8549649">,</span>&nbsp;<span class="ident" id="8549651">expected</span><span class="op" id="8549659">)</span>&nbsp;<span class="op" id="8549661">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549666">t</span><span class="op" id="8549667">.</span><span class="ident" id="8549668">Errorf</span><span class="op" id="8549674">(</span><span class="string" id="8549675">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8549697">,</span>&nbsp;<span class="ident" id="8549699">i</span><span class="op" id="8549700">,</span>&nbsp;<span class="ident" id="8549702">s</span><span class="op" id="8549703">,</span>&nbsp;<span class="ident" id="8549705">expected</span><span class="op" id="8549713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549720">}</span><br>
<span class="lineno"></span><span class="op" id="8549722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8549725">func</span>&nbsp;<span class="ident" id="8549730">TestVerifyPKCS1v15</span><span class="op" id="8549748">(</span><span class="ident" id="8549749">t</span>&nbsp;<span class="op" id="8549751">*</span><span class="ident" id="8549752">testing</span><span class="op" id="8549759">.</span><span class="ident" id="8549760">T</span><span class="op" id="8549761">)</span>&nbsp;<span class="op" id="8549763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549766">for</span>&nbsp;<span class="ident" id="8549770">i</span><span class="op" id="8549771">,</span>&nbsp;<span class="ident" id="8549773">test</span>&nbsp;<span class="op" id="8549778">:=</span>&nbsp;<span class="keyword" id="8549781">range</span>&nbsp;<span class="ident" id="8549787">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8549805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549809">h</span>&nbsp;<span class="op" id="8549811">:=</span>&nbsp;<span class="ident" id="8549814">sha1</span><span class="op" id="8549818">.</span><span class="ident" id="8549819">New</span><span class="op" id="8549822">(</span><span class="op" id="8549823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549827">h</span><span class="op" id="8549828">.</span><span class="ident" id="8549829">Write</span><span class="op" id="8549834">(</span><span class="op" id="8549835">[</span><span class="op" id="8549836">]</span><span class="builtintype" id="8549837">byte</span><span class="op" id="8549841">(</span><span class="ident" id="8549842">test</span><span class="op" id="8549846">.</span><span class="ident" id="8549847">in</span><span class="op" id="8549849">)</span><span class="op" id="8549850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549854">digest</span>&nbsp;<span class="op" id="8549861">:=</span>&nbsp;<span class="ident" id="8549864">h</span><span class="op" id="8549865">.</span><span class="ident" id="8549866">Sum</span><span class="op" id="8549869">(</span><span class="ident" id="8549870">nil</span><span class="op" id="8549873">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549878">sig</span><span class="op" id="8549881">,</span>&nbsp;<span class="ident" id="8549883">_</span>&nbsp;<span class="op" id="8549885">:=</span>&nbsp;<span class="ident" id="8549888">hex</span><span class="op" id="8549891">.</span><span class="ident" id="8549892">DecodeString</span><span class="op" id="8549904">(</span><span class="ident" id="8549905">test</span><span class="op" id="8549909">.</span><span class="ident" id="8549910">out</span><span class="op" id="8549913">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549918">err</span>&nbsp;<span class="op" id="8549922">:=</span>&nbsp;<span class="ident" id="8549925">VerifyPKCS1v15</span><span class="op" id="8549939">(</span><span class="op" id="8549940">&amp;</span><span class="ident" id="8549941">rsaPrivateKey</span><span class="op" id="8549954">.</span><span class="ident" id="8549955">PublicKey</span><span class="op" id="8549964">,</span>&nbsp;<span class="ident" id="8549966">crypto</span><span class="op" id="8549972">.</span><span class="ident" id="8549973">SHA1</span><span class="op" id="8549977">,</span>&nbsp;<span class="ident" id="8549979">digest</span><span class="op" id="8549985">,</span>&nbsp;<span class="ident" id="8549987">sig</span><span class="op" id="8549990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549994">if</span>&nbsp;<span class="ident" id="8549997">err</span>&nbsp;<span class="op" id="8550001">!=</span>&nbsp;<span class="ident" id="8550004">nil</span>&nbsp;<span class="op" id="8550008">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550013">t</span><span class="op" id="8550014">.</span><span class="ident" id="8550015">Errorf</span><span class="op" id="8550021">(</span><span class="string" id="8550022">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8550030">,</span>&nbsp;<span class="ident" id="8550032">i</span><span class="op" id="8550033">,</span>&nbsp;<span class="ident" id="8550035">err</span><span class="op" id="8550038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550045">}</span><br>
<span class="lineno"></span><span class="op" id="8550047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8550050">func</span>&nbsp;<span class="ident" id="8550055">TestOverlongMessagePKCS1v15</span><span class="op" id="8550082">(</span><span class="ident" id="8550083">t</span>&nbsp;<span class="op" id="8550085">*</span><span class="ident" id="8550086">testing</span><span class="op" id="8550093">.</span><span class="ident" id="8550094">T</span><span class="op" id="8550095">)</span>&nbsp;<span class="op" id="8550097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550100">ciphertext</span>&nbsp;<span class="op" id="8550111">:=</span>&nbsp;<span class="ident" id="8550114">decodeBase64</span><span class="op" id="8550126">(</span><span class="string" id="8550127">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8550219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550222">_</span><span class="op" id="8550223">,</span>&nbsp;<span class="ident" id="8550225">err</span>&nbsp;<span class="op" id="8550229">:=</span>&nbsp;<span class="ident" id="8550232">DecryptPKCS1v15</span><span class="op" id="8550247">(</span><span class="ident" id="8550248">nil</span><span class="op" id="8550251">,</span>&nbsp;<span class="ident" id="8550253">rsaPrivateKey</span><span class="op" id="8550266">,</span>&nbsp;<span class="ident" id="8550268">ciphertext</span><span class="op" id="8550278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550281">if</span>&nbsp;<span class="ident" id="8550284">err</span>&nbsp;<span class="op" id="8550288">==</span>&nbsp;<span class="ident" id="8550291">nil</span>&nbsp;<span class="op" id="8550295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550299">t</span><span class="op" id="8550300">.</span><span class="ident" id="8550301">Error</span><span class="op" id="8550306">(</span><span class="string" id="8550307">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8550351">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550354">}</span><br>
<span class="lineno"></span><span class="op" id="8550356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8550359">func</span>&nbsp;<span class="ident" id="8550364">TestUnpaddedSignature</span><span class="op" id="8550385">(</span><span class="ident" id="8550386">t</span>&nbsp;<span class="op" id="8550388">*</span><span class="ident" id="8550389">testing</span><span class="op" id="8550396">.</span><span class="ident" id="8550397">T</span><span class="op" id="8550398">)</span>&nbsp;<span class="op" id="8550400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550403">msg</span>&nbsp;<span class="op" id="8550407">:=</span>&nbsp;<span class="op" id="8550410">[</span><span class="op" id="8550411">]</span><span class="builtintype" id="8550412">byte</span><span class="op" id="8550416">(</span><span class="string" id="8550417">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8550449">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550452">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550494">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550545">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550610">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550614">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550687">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550697">expectedSig</span>&nbsp;<span class="op" id="8550709">:=</span>&nbsp;<span class="ident" id="8550712">decodeBase64</span><span class="op" id="8550724">(</span><span class="string" id="8550725">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8550815">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550819">sig</span><span class="op" id="8550822">,</span>&nbsp;<span class="ident" id="8550824">err</span>&nbsp;<span class="op" id="8550828">:=</span>&nbsp;<span class="ident" id="8550831">SignPKCS1v15</span><span class="op" id="8550843">(</span><span class="ident" id="8550844">nil</span><span class="op" id="8550847">,</span>&nbsp;<span class="ident" id="8550849">rsaPrivateKey</span><span class="op" id="8550862">,</span>&nbsp;<span class="ident" id="8550864">crypto</span><span class="op" id="8550870">.</span><span class="ident" id="8550871">Hash</span><span class="op" id="8550875">(</span><span class="num" id="8550876">0</span><span class="op" id="8550877">)</span><span class="op" id="8550878">,</span>&nbsp;<span class="ident" id="8550880">msg</span><span class="op" id="8550883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550886">if</span>&nbsp;<span class="ident" id="8550889">err</span>&nbsp;<span class="op" id="8550893">!=</span>&nbsp;<span class="ident" id="8550896">nil</span>&nbsp;<span class="op" id="8550900">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550904">t</span><span class="op" id="8550905">.</span><span class="ident" id="8550906">Fatalf</span><span class="op" id="8550912">(</span><span class="string" id="8550913">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8550938">,</span>&nbsp;<span class="ident" id="8550940">err</span><span class="op" id="8550943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550949">if</span>&nbsp;<span class="op" id="8550952">!</span><span class="ident" id="8550953">bytes</span><span class="op" id="8550958">.</span><span class="ident" id="8550959">Equal</span><span class="op" id="8550964">(</span><span class="ident" id="8550965">sig</span><span class="op" id="8550968">,</span>&nbsp;<span class="ident" id="8550970">expectedSig</span><span class="op" id="8550981">)</span>&nbsp;<span class="op" id="8550983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550987">t</span><span class="op" id="8550988">.</span><span class="ident" id="8550989">Fatalf</span><span class="op" id="8550995">(</span><span class="string" id="8550996">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8551046">,</span>&nbsp;<span class="ident" id="8551048">sig</span><span class="op" id="8551051">,</span>&nbsp;<span class="ident" id="8551053">expectedSig</span><span class="op" id="8551064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551067">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551070">if</span>&nbsp;<span class="ident" id="8551073">err</span>&nbsp;<span class="op" id="8551077">:=</span>&nbsp;<span class="ident" id="8551080">VerifyPKCS1v15</span><span class="op" id="8551094">(</span><span class="op" id="8551095">&amp;</span><span class="ident" id="8551096">rsaPrivateKey</span><span class="op" id="8551109">.</span><span class="ident" id="8551110">PublicKey</span><span class="op" id="8551119">,</span>&nbsp;<span class="ident" id="8551121">crypto</span><span class="op" id="8551127">.</span><span class="ident" id="8551128">Hash</span><span class="op" id="8551132">(</span><span class="num" id="8551133">0</span><span class="op" id="8551134">)</span><span class="op" id="8551135">,</span>&nbsp;<span class="ident" id="8551137">msg</span><span class="op" id="8551140">,</span>&nbsp;<span class="ident" id="8551142">sig</span><span class="op" id="8551145">)</span><span class="op" id="8551146">;</span>&nbsp;<span class="ident" id="8551148">err</span>&nbsp;<span class="op" id="8551152">!=</span>&nbsp;<span class="ident" id="8551155">nil</span>&nbsp;<span class="op" id="8551159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551163">t</span><span class="op" id="8551164">.</span><span class="ident" id="8551165">Fatalf</span><span class="op" id="8551171">(</span><span class="string" id="8551172">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8551204">,</span>&nbsp;<span class="ident" id="8551206">err</span><span class="op" id="8551209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551212">}</span><br>
<span class="lineno"></span><span class="op" id="8551214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8551217">func</span>&nbsp;<span class="ident" id="8551222">TestShortSessionKey</span><span class="op" id="8551241">(</span><span class="ident" id="8551242">t</span>&nbsp;<span class="op" id="8551244">*</span><span class="ident" id="8551245">testing</span><span class="op" id="8551252">.</span><span class="ident" id="8551253">T</span><span class="op" id="8551254">)</span>&nbsp;<span class="op" id="8551256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8551259">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8551325">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551391">ciphertext</span><span class="op" id="8551401">,</span>&nbsp;<span class="ident" id="8551403">err</span>&nbsp;<span class="op" id="8551407">:=</span>&nbsp;<span class="ident" id="8551410">EncryptPKCS1v15</span><span class="op" id="8551425">(</span><span class="ident" id="8551426">rand</span><span class="op" id="8551430">.</span><span class="ident" id="8551431">Reader</span><span class="op" id="8551437">,</span>&nbsp;<span class="op" id="8551439">&amp;</span><span class="ident" id="8551440">rsaPrivateKey</span><span class="op" id="8551453">.</span><span class="ident" id="8551454">PublicKey</span><span class="op" id="8551463">,</span>&nbsp;<span class="op" id="8551465">[</span><span class="op" id="8551466">]</span><span class="builtintype" id="8551467">byte</span><span class="op" id="8551471">{</span><span class="num" id="8551472">1</span><span class="op" id="8551473">}</span><span class="op" id="8551474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551477">if</span>&nbsp;<span class="ident" id="8551480">err</span>&nbsp;<span class="op" id="8551484">!=</span>&nbsp;<span class="ident" id="8551487">nil</span>&nbsp;<span class="op" id="8551491">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551495">t</span><span class="op" id="8551496">.</span><span class="ident" id="8551497">Fatalf</span><span class="op" id="8551503">(</span><span class="string" id="8551504">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8551541">,</span>&nbsp;<span class="ident" id="8551543">err</span><span class="op" id="8551546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551553">var</span>&nbsp;<span class="ident" id="8551557">key</span>&nbsp;<span class="op" id="8551561">[</span><span class="num" id="8551562">32</span><span class="op" id="8551564">]</span><span class="builtintype" id="8551565">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551571">if</span>&nbsp;<span class="ident" id="8551574">err</span>&nbsp;<span class="op" id="8551578">:=</span>&nbsp;<span class="ident" id="8551581">DecryptPKCS1v15SessionKey</span><span class="op" id="8551606">(</span><span class="ident" id="8551607">nil</span><span class="op" id="8551610">,</span>&nbsp;<span class="ident" id="8551612">rsaPrivateKey</span><span class="op" id="8551625">,</span>&nbsp;<span class="ident" id="8551627">ciphertext</span><span class="op" id="8551637">,</span>&nbsp;<span class="ident" id="8551639">key</span><span class="op" id="8551642">[</span><span class="op" id="8551643">:</span><span class="op" id="8551644">]</span><span class="op" id="8551645">)</span><span class="op" id="8551646">;</span>&nbsp;<span class="ident" id="8551648">err</span>&nbsp;<span class="op" id="8551652">!=</span>&nbsp;<span class="ident" id="8551655">nil</span>&nbsp;<span class="op" id="8551659">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551663">t</span><span class="op" id="8551664">.</span><span class="ident" id="8551665">Fatalf</span><span class="op" id="8551671">(</span><span class="string" id="8551672">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8551709">,</span>&nbsp;<span class="ident" id="8551711">err</span><span class="op" id="8551714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551721">for</span>&nbsp;<span class="ident" id="8551725">_</span><span class="op" id="8551726">,</span>&nbsp;<span class="ident" id="8551728">v</span>&nbsp;<span class="op" id="8551730">:=</span>&nbsp;<span class="keyword" id="8551733">range</span>&nbsp;<span class="ident" id="8551739">key</span>&nbsp;<span class="op" id="8551743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551747">if</span>&nbsp;<span class="ident" id="8551750">v</span>&nbsp;<span class="op" id="8551752">!=</span>&nbsp;<span class="num" id="8551755">0</span>&nbsp;<span class="op" id="8551757">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551762">t</span><span class="op" id="8551763">.</span><span class="ident" id="8551764">Fatal</span><span class="op" id="8551769">(</span><span class="string" id="8551770">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8551816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551823">}</span><br>
<span class="lineno"></span><span class="op" id="8551825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8551828">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8551907">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8551942">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8552010">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8552078">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8552146">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8552214">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8552282">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8552350">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8552394">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8552428">var</span>&nbsp;<span class="ident" id="8552432">rsaPrivateKey</span>&nbsp;<span class="op" id="8552446">=</span>&nbsp;<span class="op" id="8552448">&amp;</span><span class="ident" id="8552449">PrivateKey</span><span class="op" id="8552459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552462">PublicKey</span><span class="op" id="8552471">:</span>&nbsp;<span class="ident" id="8552473">PublicKey</span><span class="op" id="8552482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552486">N</span><span class="op" id="8552487">:</span>&nbsp;<span class="ident" id="8552489">fromBase10</span><span class="op" id="8552499">(</span><span class="string" id="8552500">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8552656">)</span><span class="op" id="8552657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552661">E</span><span class="op" id="8552662">:</span>&nbsp;<span class="num" id="8552664">65537</span><span class="op" id="8552669">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552672">}</span><span class="op" id="8552673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552676">D</span><span class="op" id="8552677">:</span>&nbsp;<span class="ident" id="8552679">fromBase10</span><span class="op" id="8552689">(</span><span class="string" id="8552690">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8552846">)</span><span class="op" id="8552847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552850">Primes</span><span class="op" id="8552856">:</span>&nbsp;<span class="op" id="8552858">[</span><span class="op" id="8552859">]</span><span class="op" id="8552860">*</span><span class="ident" id="8552861">big</span><span class="op" id="8552864">.</span><span class="ident" id="8552865">Int</span><span class="op" id="8552868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552872">fromBase10</span><span class="op" id="8552882">(</span><span class="string" id="8552883">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8552962">)</span><span class="op" id="8552963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552967">fromBase10</span><span class="op" id="8552977">(</span><span class="string" id="8552978">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8553057">)</span><span class="op" id="8553058">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8553061">}</span><span class="op" id="8553062">,</span><br>
<span class="lineno"></span><span class="op" id="8553064">}</span>
</div>
</body>
</html>
