<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html" class="current">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4314715">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4314771">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4314825">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4314876">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4314952">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="4315005">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4315020">package</span>&nbsp;<span class="ident" id="4315028">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4315034">import</span>&nbsp;<span class="op" id="4315041">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315044">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315053">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315067">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315084">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315090">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315096">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315107">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4315115">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4315122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4315125">const</span>&nbsp;<span class="ident" id="4315131">urandomDevice</span>&nbsp;<span class="op" id="4315145">=</span>&nbsp;<span class="string" id="4315147">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4315163">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="4315211">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4315263">func</span>&nbsp;<span class="ident" id="4315268">init</span><span class="op" id="4315272">(</span><span class="op" id="4315273">)</span>&nbsp;<span class="op" id="4315275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315278">if</span>&nbsp;<span class="ident" id="4315281">runtime</span><span class="op" id="4315288">.</span><span class="ident" id="4315289">GOOS</span>&nbsp;<span class="op" id="4315294">==</span>&nbsp;<span class="string" id="4315297">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4315305">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315309">Reader</span>&nbsp;<span class="op" id="4315316">=</span>&nbsp;<span class="ident" id="4315318">newReader</span><span class="op" id="4315327">(</span><span class="ident" id="4315328">nil</span><span class="op" id="4315331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315334">}</span>&nbsp;<span class="keyword" id="4315336">else</span>&nbsp;<span class="op" id="4315341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315345">Reader</span>&nbsp;<span class="op" id="4315352">=</span>&nbsp;<span class="op" id="4315354">&amp;</span><span class="ident" id="4315355">devReader</span><span class="op" id="4315364">{</span><span class="ident" id="4315365">name</span><span class="op" id="4315369">:</span>&nbsp;<span class="ident" id="4315371">urandomDevice</span><span class="op" id="4315384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315387">}</span><br>
<span class="lineno"></span><span class="op" id="4315389">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4315392">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4315455">type</span>&nbsp;<span class="ident" id="4315460">devReader</span>&nbsp;<span class="keyword" id="4315470">struct</span>&nbsp;<span class="op" id="4315477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315480">name</span>&nbsp;<span class="builtintype" id="4315485">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315493">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315498">io</span><span class="op" id="4315500">.</span><span class="ident" id="4315501">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315509">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4315514">sync</span><span class="op" id="4315518">.</span><span class="ident" id="4315519">Mutex</span><br>
<span class="lineno"></span><span class="op" id="4315525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4315528">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="4315596">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="4315625">var</span>&nbsp;<span class="ident" id="4315629">altGetRandom</span>&nbsp;<span class="keyword" id="4315642">func</span><span class="op" id="4315646">(</span><span class="op" id="4315647">[</span><span class="op" id="4315648">]</span><span class="builtintype" id="4315649">byte</span><span class="op" id="4315653">)</span>&nbsp;<span class="op" id="4315655">(</span><span class="ident" id="4315656">ok</span>&nbsp;<span class="builtintype" id="4315659">bool</span><span class="op" id="4315663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4315666">func</span>&nbsp;<span class="op" id="4315671">(</span><span class="ident" id="4315672">r</span>&nbsp;<span class="op" id="4315674">*</span><span class="ident" id="4315675">devReader</span><span class="op" id="4315684">)</span>&nbsp;<span class="ident" id="4315686">Read</span><span class="op" id="4315690">(</span><span class="ident" id="4315691">b</span>&nbsp;<span class="op" id="4315693">[</span><span class="op" id="4315694">]</span><span class="builtintype" id="4315695">byte</span><span class="op" id="4315699">)</span>&nbsp;<span class="op" id="4315701">(</span><span class="ident" id="4315702">n</span>&nbsp;<span class="builtintype" id="4315704">int</span><span class="op" id="4315707">,</span>&nbsp;<span class="ident" id="4315709">err</span>&nbsp;<span class="builtintype" id="4315713">error</span><span class="op" id="4315718">)</span>&nbsp;<span class="op" id="4315720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315723">if</span>&nbsp;<span class="ident" id="4315726">altGetRandom</span>&nbsp;<span class="op" id="4315739">!=</span>&nbsp;<span class="ident" id="4315742">nil</span>&nbsp;<span class="op" id="4315746">&amp;&amp;</span>&nbsp;<span class="ident" id="4315749">r</span><span class="op" id="4315750">.</span><span class="ident" id="4315751">name</span>&nbsp;<span class="op" id="4315756">==</span>&nbsp;<span class="ident" id="4315759">urandomDevice</span>&nbsp;<span class="op" id="4315773">&amp;&amp;</span>&nbsp;<span class="ident" id="4315776">altGetRandom</span><span class="op" id="4315788">(</span><span class="ident" id="4315789">b</span><span class="op" id="4315790">)</span>&nbsp;<span class="op" id="4315792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315796">return</span>&nbsp;<span class="builtinfunc" id="4315803">len</span><span class="op" id="4315806">(</span><span class="ident" id="4315807">b</span><span class="op" id="4315808">)</span><span class="op" id="4315809">,</span>&nbsp;<span class="ident" id="4315811">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315819">r</span><span class="op" id="4315820">.</span><span class="ident" id="4315821">mu</span><span class="op" id="4315823">.</span><span class="ident" id="4315824">Lock</span><span class="op" id="4315828">(</span><span class="op" id="4315829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315832">defer</span>&nbsp;<span class="ident" id="4315838">r</span><span class="op" id="4315839">.</span><span class="ident" id="4315840">mu</span><span class="op" id="4315842">.</span><span class="ident" id="4315843">Unlock</span><span class="op" id="4315849">(</span><span class="op" id="4315850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315853">if</span>&nbsp;<span class="ident" id="4315856">r</span><span class="op" id="4315857">.</span><span class="ident" id="4315858">f</span>&nbsp;<span class="op" id="4315860">==</span>&nbsp;<span class="ident" id="4315863">nil</span>&nbsp;<span class="op" id="4315867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315871">f</span><span class="op" id="4315872">,</span>&nbsp;<span class="ident" id="4315874">err</span>&nbsp;<span class="op" id="4315878">:=</span>&nbsp;<span class="ident" id="4315881">os</span><span class="op" id="4315883">.</span><span class="ident" id="4315884">Open</span><span class="op" id="4315888">(</span><span class="ident" id="4315889">r</span><span class="op" id="4315890">.</span><span class="ident" id="4315891">name</span><span class="op" id="4315895">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315899">if</span>&nbsp;<span class="ident" id="4315902">f</span>&nbsp;<span class="op" id="4315904">==</span>&nbsp;<span class="ident" id="4315907">nil</span>&nbsp;<span class="op" id="4315911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315916">return</span>&nbsp;<span class="num" id="4315923">0</span><span class="op" id="4315924">,</span>&nbsp;<span class="ident" id="4315926">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315936">if</span>&nbsp;<span class="ident" id="4315939">runtime</span><span class="op" id="4315946">.</span><span class="ident" id="4315947">GOOS</span>&nbsp;<span class="op" id="4315952">==</span>&nbsp;<span class="string" id="4315955">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4315963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315968">r</span><span class="op" id="4315969">.</span><span class="ident" id="4315970">f</span>&nbsp;<span class="op" id="4315972">=</span>&nbsp;<span class="ident" id="4315974">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315978">}</span>&nbsp;<span class="keyword" id="4315980">else</span>&nbsp;<span class="op" id="4315985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315990">r</span><span class="op" id="4315991">.</span><span class="ident" id="4315992">f</span>&nbsp;<span class="op" id="4315994">=</span>&nbsp;<span class="ident" id="4315996">bufio</span><span class="op" id="4316001">.</span><span class="ident" id="4316002">NewReader</span><span class="op" id="4316011">(</span><span class="ident" id="4316012">f</span><span class="op" id="4316013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316023">return</span>&nbsp;<span class="ident" id="4316030">r</span><span class="op" id="4316031">.</span><span class="ident" id="4316032">f</span><span class="op" id="4316033">.</span><span class="ident" id="4316034">Read</span><span class="op" id="4316038">(</span><span class="ident" id="4316039">b</span><span class="op" id="4316040">)</span><br>
<span class="lineno">65</span><span class="op" id="4316042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4316045">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="4316098">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4316143">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4316198">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="4316259">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4316318">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="4316369">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="4316426">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4316485">//</span><br>
<span class="lineno"></span><span class="comment" id="4316488">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="4316544">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4316593">func</span>&nbsp;<span class="ident" id="4316598">newReader</span><span class="op" id="4316607">(</span><span class="ident" id="4316608">entropy</span>&nbsp;<span class="ident" id="4316616">io</span><span class="op" id="4316618">.</span><span class="ident" id="4316619">Reader</span><span class="op" id="4316625">)</span>&nbsp;<span class="ident" id="4316627">io</span><span class="op" id="4316629">.</span><span class="ident" id="4316630">Reader</span>&nbsp;<span class="op" id="4316637">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316640">if</span>&nbsp;<span class="ident" id="4316643">entropy</span>&nbsp;<span class="op" id="4316651">==</span>&nbsp;<span class="ident" id="4316654">nil</span>&nbsp;<span class="op" id="4316658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316662">entropy</span>&nbsp;<span class="op" id="4316670">=</span>&nbsp;<span class="op" id="4316672">&amp;</span><span class="ident" id="4316673">devReader</span><span class="op" id="4316682">{</span><span class="ident" id="4316683">name</span><span class="op" id="4316687">:</span>&nbsp;<span class="string" id="4316689">&#34;/dev/random&#34;</span><span class="op" id="4316702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316708">return</span>&nbsp;<span class="op" id="4316715">&amp;</span><span class="ident" id="4316716">reader</span><span class="op" id="4316722">{</span><span class="ident" id="4316723">entropy</span><span class="op" id="4316730">:</span>&nbsp;<span class="ident" id="4316732">entropy</span><span class="op" id="4316739">}</span><br>
<span class="lineno"></span><span class="op" id="4316741">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4316744">type</span>&nbsp;<span class="ident" id="4316749">reader</span>&nbsp;<span class="keyword" id="4316756">struct</span>&nbsp;<span class="op" id="4316763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316766">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316787">sync</span><span class="op" id="4316791">.</span><span class="ident" id="4316792">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316799">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4316820">int</span>&nbsp;<span class="comment" id="4316824">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316866">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316887">cipher</span><span class="op" id="4316893">.</span><span class="ident" id="4316894">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316901">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316922">io</span><span class="op" id="4316924">.</span><span class="ident" id="4316925">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316933">time</span><span class="op" id="4316937">,</span>&nbsp;<span class="ident" id="4316939">seed</span><span class="op" id="4316943">,</span>&nbsp;<span class="ident" id="4316945">dst</span><span class="op" id="4316948">,</span>&nbsp;<span class="ident" id="4316950">key</span>&nbsp;<span class="op" id="4316954">[</span><span class="ident" id="4316955">aes</span><span class="op" id="4316958">.</span><span class="ident" id="4316959">BlockSize</span><span class="op" id="4316968">]</span><span class="builtintype" id="4316969">byte</span><br>
<span class="lineno"></span><span class="op" id="4316974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4316977">func</span>&nbsp;<span class="op" id="4316982">(</span><span class="ident" id="4316983">r</span>&nbsp;<span class="op" id="4316985">*</span><span class="ident" id="4316986">reader</span><span class="op" id="4316992">)</span>&nbsp;<span class="ident" id="4316994">Read</span><span class="op" id="4316998">(</span><span class="ident" id="4316999">b</span>&nbsp;<span class="op" id="4317001">[</span><span class="op" id="4317002">]</span><span class="builtintype" id="4317003">byte</span><span class="op" id="4317007">)</span>&nbsp;<span class="op" id="4317009">(</span><span class="ident" id="4317010">n</span>&nbsp;<span class="builtintype" id="4317012">int</span><span class="op" id="4317015">,</span>&nbsp;<span class="ident" id="4317017">err</span>&nbsp;<span class="builtintype" id="4317021">error</span><span class="op" id="4317026">)</span>&nbsp;<span class="op" id="4317028">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317031">r</span><span class="op" id="4317032">.</span><span class="ident" id="4317033">mu</span><span class="op" id="4317035">.</span><span class="ident" id="4317036">Lock</span><span class="op" id="4317040">(</span><span class="op" id="4317041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317044">defer</span>&nbsp;<span class="ident" id="4317050">r</span><span class="op" id="4317051">.</span><span class="ident" id="4317052">mu</span><span class="op" id="4317054">.</span><span class="ident" id="4317055">Unlock</span><span class="op" id="4317061">(</span><span class="op" id="4317062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317065">n</span>&nbsp;<span class="op" id="4317067">=</span>&nbsp;<span class="builtinfunc" id="4317069">len</span><span class="op" id="4317072">(</span><span class="ident" id="4317073">b</span><span class="op" id="4317074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317078">for</span>&nbsp;<span class="builtinfunc" id="4317082">len</span><span class="op" id="4317085">(</span><span class="ident" id="4317086">b</span><span class="op" id="4317087">)</span>&nbsp;<span class="op" id="4317089">&gt;</span>&nbsp;<span class="num" id="4317091">0</span>&nbsp;<span class="op" id="4317093">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317097">if</span>&nbsp;<span class="ident" id="4317100">r</span><span class="op" id="4317101">.</span><span class="ident" id="4317102">budget</span>&nbsp;<span class="op" id="4317109">==</span>&nbsp;<span class="num" id="4317112">0</span>&nbsp;<span class="op" id="4317114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317119">_</span><span class="op" id="4317120">,</span>&nbsp;<span class="ident" id="4317122">err</span>&nbsp;<span class="op" id="4317126">:=</span>&nbsp;<span class="ident" id="4317129">io</span><span class="op" id="4317131">.</span><span class="ident" id="4317132">ReadFull</span><span class="op" id="4317140">(</span><span class="ident" id="4317141">r</span><span class="op" id="4317142">.</span><span class="ident" id="4317143">entropy</span><span class="op" id="4317150">,</span>&nbsp;<span class="ident" id="4317152">r</span><span class="op" id="4317153">.</span><span class="ident" id="4317154">seed</span><span class="op" id="4317158">[</span><span class="num" id="4317159">0</span><span class="op" id="4317160">:</span><span class="op" id="4317161">]</span><span class="op" id="4317162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317167">if</span>&nbsp;<span class="ident" id="4317170">err</span>&nbsp;<span class="op" id="4317174">!=</span>&nbsp;<span class="ident" id="4317177">nil</span>&nbsp;<span class="op" id="4317181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317187">return</span>&nbsp;<span class="ident" id="4317194">n</span>&nbsp;<span class="op" id="4317196">-</span>&nbsp;<span class="builtinfunc" id="4317198">len</span><span class="op" id="4317201">(</span><span class="ident" id="4317202">b</span><span class="op" id="4317203">)</span><span class="op" id="4317204">,</span>&nbsp;<span class="ident" id="4317206">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317213">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317218">_</span><span class="op" id="4317219">,</span>&nbsp;<span class="ident" id="4317221">err</span>&nbsp;<span class="op" id="4317225">=</span>&nbsp;<span class="ident" id="4317227">io</span><span class="op" id="4317229">.</span><span class="ident" id="4317230">ReadFull</span><span class="op" id="4317238">(</span><span class="ident" id="4317239">r</span><span class="op" id="4317240">.</span><span class="ident" id="4317241">entropy</span><span class="op" id="4317248">,</span>&nbsp;<span class="ident" id="4317250">r</span><span class="op" id="4317251">.</span><span class="ident" id="4317252">key</span><span class="op" id="4317255">[</span><span class="num" id="4317256">0</span><span class="op" id="4317257">:</span><span class="op" id="4317258">]</span><span class="op" id="4317259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317264">if</span>&nbsp;<span class="ident" id="4317267">err</span>&nbsp;<span class="op" id="4317271">!=</span>&nbsp;<span class="ident" id="4317274">nil</span>&nbsp;<span class="op" id="4317278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317284">return</span>&nbsp;<span class="ident" id="4317291">n</span>&nbsp;<span class="op" id="4317293">-</span>&nbsp;<span class="builtinfunc" id="4317295">len</span><span class="op" id="4317298">(</span><span class="ident" id="4317299">b</span><span class="op" id="4317300">)</span><span class="op" id="4317301">,</span>&nbsp;<span class="ident" id="4317303">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317315">r</span><span class="op" id="4317316">.</span><span class="ident" id="4317317">cipher</span><span class="op" id="4317323">,</span>&nbsp;<span class="ident" id="4317325">err</span>&nbsp;<span class="op" id="4317329">=</span>&nbsp;<span class="ident" id="4317331">aes</span><span class="op" id="4317334">.</span><span class="ident" id="4317335">NewCipher</span><span class="op" id="4317344">(</span><span class="ident" id="4317345">r</span><span class="op" id="4317346">.</span><span class="ident" id="4317347">key</span><span class="op" id="4317350">[</span><span class="num" id="4317351">0</span><span class="op" id="4317352">:</span><span class="op" id="4317353">]</span><span class="op" id="4317354">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317359">if</span>&nbsp;<span class="ident" id="4317362">err</span>&nbsp;<span class="op" id="4317366">!=</span>&nbsp;<span class="ident" id="4317369">nil</span>&nbsp;<span class="op" id="4317373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317379">return</span>&nbsp;<span class="ident" id="4317386">n</span>&nbsp;<span class="op" id="4317388">-</span>&nbsp;<span class="builtinfunc" id="4317390">len</span><span class="op" id="4317393">(</span><span class="ident" id="4317394">b</span><span class="op" id="4317395">)</span><span class="op" id="4317396">,</span>&nbsp;<span class="ident" id="4317398">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317410">r</span><span class="op" id="4317411">.</span><span class="ident" id="4317412">budget</span>&nbsp;<span class="op" id="4317419">=</span>&nbsp;<span class="num" id="4317421">1</span>&nbsp;<span class="op" id="4317423">&lt;&lt;</span>&nbsp;<span class="num" id="4317426">20</span>&nbsp;<span class="comment" id="4317429">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4317462">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317466">r</span><span class="op" id="4317467">.</span><span class="ident" id="4317468">budget</span>&nbsp;<span class="op" id="4317475">-=</span>&nbsp;<span class="ident" id="4317478">aes</span><span class="op" id="4317481">.</span><span class="ident" id="4317482">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317495">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317565">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317570">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317589">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317612">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317639">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317666">ns</span>&nbsp;<span class="op" id="4317669">:=</span>&nbsp;<span class="ident" id="4317672">time</span><span class="op" id="4317676">.</span><span class="ident" id="4317677">Now</span><span class="op" id="4317680">(</span><span class="op" id="4317681">)</span><span class="op" id="4317682">.</span><span class="ident" id="4317683">UnixNano</span><span class="op" id="4317691">(</span><span class="op" id="4317692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317696">r</span><span class="op" id="4317697">.</span><span class="ident" id="4317698">time</span><span class="op" id="4317702">[</span><span class="num" id="4317703">0</span><span class="op" id="4317704">]</span>&nbsp;<span class="op" id="4317706">=</span>&nbsp;<span class="builtintype" id="4317708">byte</span><span class="op" id="4317712">(</span><span class="ident" id="4317713">ns</span>&nbsp;<span class="op" id="4317716">&gt;&gt;</span>&nbsp;<span class="num" id="4317719">56</span><span class="op" id="4317721">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317725">r</span><span class="op" id="4317726">.</span><span class="ident" id="4317727">time</span><span class="op" id="4317731">[</span><span class="num" id="4317732">1</span><span class="op" id="4317733">]</span>&nbsp;<span class="op" id="4317735">=</span>&nbsp;<span class="builtintype" id="4317737">byte</span><span class="op" id="4317741">(</span><span class="ident" id="4317742">ns</span>&nbsp;<span class="op" id="4317745">&gt;&gt;</span>&nbsp;<span class="num" id="4317748">48</span><span class="op" id="4317750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317754">r</span><span class="op" id="4317755">.</span><span class="ident" id="4317756">time</span><span class="op" id="4317760">[</span><span class="num" id="4317761">2</span><span class="op" id="4317762">]</span>&nbsp;<span class="op" id="4317764">=</span>&nbsp;<span class="builtintype" id="4317766">byte</span><span class="op" id="4317770">(</span><span class="ident" id="4317771">ns</span>&nbsp;<span class="op" id="4317774">&gt;&gt;</span>&nbsp;<span class="num" id="4317777">40</span><span class="op" id="4317779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317783">r</span><span class="op" id="4317784">.</span><span class="ident" id="4317785">time</span><span class="op" id="4317789">[</span><span class="num" id="4317790">3</span><span class="op" id="4317791">]</span>&nbsp;<span class="op" id="4317793">=</span>&nbsp;<span class="builtintype" id="4317795">byte</span><span class="op" id="4317799">(</span><span class="ident" id="4317800">ns</span>&nbsp;<span class="op" id="4317803">&gt;&gt;</span>&nbsp;<span class="num" id="4317806">32</span><span class="op" id="4317808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317812">r</span><span class="op" id="4317813">.</span><span class="ident" id="4317814">time</span><span class="op" id="4317818">[</span><span class="num" id="4317819">4</span><span class="op" id="4317820">]</span>&nbsp;<span class="op" id="4317822">=</span>&nbsp;<span class="builtintype" id="4317824">byte</span><span class="op" id="4317828">(</span><span class="ident" id="4317829">ns</span>&nbsp;<span class="op" id="4317832">&gt;&gt;</span>&nbsp;<span class="num" id="4317835">24</span><span class="op" id="4317837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317841">r</span><span class="op" id="4317842">.</span><span class="ident" id="4317843">time</span><span class="op" id="4317847">[</span><span class="num" id="4317848">5</span><span class="op" id="4317849">]</span>&nbsp;<span class="op" id="4317851">=</span>&nbsp;<span class="builtintype" id="4317853">byte</span><span class="op" id="4317857">(</span><span class="ident" id="4317858">ns</span>&nbsp;<span class="op" id="4317861">&gt;&gt;</span>&nbsp;<span class="num" id="4317864">16</span><span class="op" id="4317866">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317870">r</span><span class="op" id="4317871">.</span><span class="ident" id="4317872">time</span><span class="op" id="4317876">[</span><span class="num" id="4317877">6</span><span class="op" id="4317878">]</span>&nbsp;<span class="op" id="4317880">=</span>&nbsp;<span class="builtintype" id="4317882">byte</span><span class="op" id="4317886">(</span><span class="ident" id="4317887">ns</span>&nbsp;<span class="op" id="4317890">&gt;&gt;</span>&nbsp;<span class="num" id="4317893">8</span><span class="op" id="4317894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317898">r</span><span class="op" id="4317899">.</span><span class="ident" id="4317900">time</span><span class="op" id="4317904">[</span><span class="num" id="4317905">7</span><span class="op" id="4317906">]</span>&nbsp;<span class="op" id="4317908">=</span>&nbsp;<span class="builtintype" id="4317910">byte</span><span class="op" id="4317914">(</span><span class="ident" id="4317915">ns</span><span class="op" id="4317917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317921">r</span><span class="op" id="4317922">.</span><span class="ident" id="4317923">cipher</span><span class="op" id="4317929">.</span><span class="ident" id="4317930">Encrypt</span><span class="op" id="4317937">(</span><span class="ident" id="4317938">r</span><span class="op" id="4317939">.</span><span class="ident" id="4317940">time</span><span class="op" id="4317944">[</span><span class="num" id="4317945">0</span><span class="op" id="4317946">:</span><span class="op" id="4317947">]</span><span class="op" id="4317948">,</span>&nbsp;<span class="ident" id="4317950">r</span><span class="op" id="4317951">.</span><span class="ident" id="4317952">time</span><span class="op" id="4317956">[</span><span class="num" id="4317957">0</span><span class="op" id="4317958">:</span><span class="op" id="4317959">]</span><span class="op" id="4317960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4317964">for</span>&nbsp;<span class="ident" id="4317968">i</span>&nbsp;<span class="op" id="4317970">:=</span>&nbsp;<span class="num" id="4317973">0</span><span class="op" id="4317974">;</span>&nbsp;<span class="ident" id="4317976">i</span>&nbsp;<span class="op" id="4317978">&lt;</span>&nbsp;<span class="ident" id="4317980">aes</span><span class="op" id="4317983">.</span><span class="ident" id="4317984">BlockSize</span><span class="op" id="4317993">;</span>&nbsp;<span class="ident" id="4317995">i</span><span class="op" id="4317996">++</span>&nbsp;<span class="op" id="4317999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318004">r</span><span class="op" id="4318005">.</span><span class="ident" id="4318006">dst</span><span class="op" id="4318009">[</span><span class="ident" id="4318010">i</span><span class="op" id="4318011">]</span>&nbsp;<span class="op" id="4318013">=</span>&nbsp;<span class="ident" id="4318015">r</span><span class="op" id="4318016">.</span><span class="ident" id="4318017">time</span><span class="op" id="4318021">[</span><span class="ident" id="4318022">i</span><span class="op" id="4318023">]</span>&nbsp;<span class="op" id="4318025">^</span>&nbsp;<span class="ident" id="4318027">r</span><span class="op" id="4318028">.</span><span class="ident" id="4318029">seed</span><span class="op" id="4318033">[</span><span class="ident" id="4318034">i</span><span class="op" id="4318035">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318043">r</span><span class="op" id="4318044">.</span><span class="ident" id="4318045">cipher</span><span class="op" id="4318051">.</span><span class="ident" id="4318052">Encrypt</span><span class="op" id="4318059">(</span><span class="ident" id="4318060">r</span><span class="op" id="4318061">.</span><span class="ident" id="4318062">dst</span><span class="op" id="4318065">[</span><span class="num" id="4318066">0</span><span class="op" id="4318067">:</span><span class="op" id="4318068">]</span><span class="op" id="4318069">,</span>&nbsp;<span class="ident" id="4318071">r</span><span class="op" id="4318072">.</span><span class="ident" id="4318073">dst</span><span class="op" id="4318076">[</span><span class="num" id="4318077">0</span><span class="op" id="4318078">:</span><span class="op" id="4318079">]</span><span class="op" id="4318080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318084">for</span>&nbsp;<span class="ident" id="4318088">i</span>&nbsp;<span class="op" id="4318090">:=</span>&nbsp;<span class="num" id="4318093">0</span><span class="op" id="4318094">;</span>&nbsp;<span class="ident" id="4318096">i</span>&nbsp;<span class="op" id="4318098">&lt;</span>&nbsp;<span class="ident" id="4318100">aes</span><span class="op" id="4318103">.</span><span class="ident" id="4318104">BlockSize</span><span class="op" id="4318113">;</span>&nbsp;<span class="ident" id="4318115">i</span><span class="op" id="4318116">++</span>&nbsp;<span class="op" id="4318119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318124">r</span><span class="op" id="4318125">.</span><span class="ident" id="4318126">seed</span><span class="op" id="4318130">[</span><span class="ident" id="4318131">i</span><span class="op" id="4318132">]</span>&nbsp;<span class="op" id="4318134">=</span>&nbsp;<span class="ident" id="4318136">r</span><span class="op" id="4318137">.</span><span class="ident" id="4318138">time</span><span class="op" id="4318142">[</span><span class="ident" id="4318143">i</span><span class="op" id="4318144">]</span>&nbsp;<span class="op" id="4318146">^</span>&nbsp;<span class="ident" id="4318148">r</span><span class="op" id="4318149">.</span><span class="ident" id="4318150">dst</span><span class="op" id="4318153">[</span><span class="ident" id="4318154">i</span><span class="op" id="4318155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318159">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318163">r</span><span class="op" id="4318164">.</span><span class="ident" id="4318165">cipher</span><span class="op" id="4318171">.</span><span class="ident" id="4318172">Encrypt</span><span class="op" id="4318179">(</span><span class="ident" id="4318180">r</span><span class="op" id="4318181">.</span><span class="ident" id="4318182">seed</span><span class="op" id="4318186">[</span><span class="num" id="4318187">0</span><span class="op" id="4318188">:</span><span class="op" id="4318189">]</span><span class="op" id="4318190">,</span>&nbsp;<span class="ident" id="4318192">r</span><span class="op" id="4318193">.</span><span class="ident" id="4318194">seed</span><span class="op" id="4318198">[</span><span class="num" id="4318199">0</span><span class="op" id="4318200">:</span><span class="op" id="4318201">]</span><span class="op" id="4318202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318207">m</span>&nbsp;<span class="op" id="4318209">:=</span>&nbsp;<span class="builtinfunc" id="4318212">copy</span><span class="op" id="4318216">(</span><span class="ident" id="4318217">b</span><span class="op" id="4318218">,</span>&nbsp;<span class="ident" id="4318220">r</span><span class="op" id="4318221">.</span><span class="ident" id="4318222">dst</span><span class="op" id="4318225">[</span><span class="num" id="4318226">0</span><span class="op" id="4318227">:</span><span class="op" id="4318228">]</span><span class="op" id="4318229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318233">b</span>&nbsp;<span class="op" id="4318235">=</span>&nbsp;<span class="ident" id="4318237">b</span><span class="op" id="4318238">[</span><span class="ident" id="4318239">m</span><span class="op" id="4318240">:</span><span class="op" id="4318241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4318244">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4318248">return</span>&nbsp;<span class="ident" id="4318255">n</span><span class="op" id="4318256">,</span>&nbsp;<span class="ident" id="4318258">nil</span><br>
<span class="lineno"></span><span class="op" id="4318262">}</span>
</div>
</body>
</html>
