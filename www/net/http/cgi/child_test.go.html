<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6994274">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6994329">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6994383">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6994434">//&nbsp;Tests&nbsp;for&nbsp;CGI&nbsp;(the&nbsp;child&nbsp;process&nbsp;perspective)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6994484">package</span>&nbsp;<span class="ident" id="6994492">cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6994497">import</span>&nbsp;<span class="op" id="6994504">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994507">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6994517">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6994520">func</span>&nbsp;<span class="ident" id="6994525">TestRequest</span><span class="op" id="6994536">(</span><span class="ident" id="6994537">t</span>&nbsp;<span class="op" id="6994539">*</span><span class="ident" id="6994540"><a href="/net/http/cgi/child_test.go.html#6994507">testing</a></span><span class="op" id="6994547">.</span><span class="ident" id="6994548">T</span><span class="op" id="6994549">)</span>&nbsp;<span class="op" id="6994551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994554">env</span>&nbsp;<span class="op" id="6994558">:=</span>&nbsp;<span class="keyword" id="6994561">map</span><span class="op" id="6994564">[</span><span class="builtintype" id="6994565">string</span><span class="op" id="6994571">]</span><span class="builtintype" id="6994572">string</span><span class="op" id="6994578">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994582">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="6994599">:</span>&nbsp;<span class="string" id="6994601">&#34;HTTP/1.1&#34;</span><span class="op" id="6994611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994615">&#34;REQUEST_METHOD&#34;</span><span class="op" id="6994631">:</span>&nbsp;&nbsp;<span class="string" id="6994634">&#34;GET&#34;</span><span class="op" id="6994639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994643">&#34;HTTP_HOST&#34;</span><span class="op" id="6994654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994662">&#34;example.com&#34;</span><span class="op" id="6994675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994679">&#34;HTTP_REFERER&#34;</span><span class="op" id="6994693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994698">&#34;elsewhere&#34;</span><span class="op" id="6994709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994713">&#34;HTTP_USER_AGENT&#34;</span><span class="op" id="6994730">:</span>&nbsp;<span class="string" id="6994732">&#34;goclient&#34;</span><span class="op" id="6994742">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994746">&#34;HTTP_FOO_BAR&#34;</span><span class="op" id="6994760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994765">&#34;baz&#34;</span><span class="op" id="6994770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994774">&#34;REQUEST_URI&#34;</span><span class="op" id="6994787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994793">&#34;/path?a=b&#34;</span><span class="op" id="6994804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994808">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="6994824">:</span>&nbsp;&nbsp;<span class="string" id="6994827">&#34;123&#34;</span><span class="op" id="6994832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994836">&#34;CONTENT_TYPE&#34;</span><span class="op" id="6994850">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994855">&#34;text/xml&#34;</span><span class="op" id="6994865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6994869">&#34;REMOTE_ADDR&#34;</span><span class="op" id="6994882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6994888">&#34;5.6.7.8&#34;</span><span class="op" id="6994897">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994903">req</span><span class="op" id="6994906">,</span>&nbsp;<span class="ident" id="6994908">err</span>&nbsp;<span class="op" id="6994912">:=</span>&nbsp;<span class="ident" id="6994915"><a href="/net/http/cgi/child.go.html#6139250">RequestFromMap</a></span><span class="op" id="6994929">(</span><span class="ident" id="6994930"><a href="/net/http/cgi/child_test.go.html#6994554">env</a></span><span class="op" id="6994933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994936">if</span>&nbsp;<span class="ident" id="6994939"><a href="/net/http/cgi/child_test.go.html#6994908">err</a></span>&nbsp;<span class="op" id="6994943">!=</span>&nbsp;<span class="ident" id="6994946">nil</span>&nbsp;<span class="op" id="6994950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994954"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6994955">.</span><span class="ident" id="6994956">Fatalf</span><span class="op" id="6994962">(</span><span class="string" id="6994963">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="6994983">,</span>&nbsp;<span class="ident" id="6994985"><a href="/net/http/cgi/child_test.go.html#6994908">err</a></span><span class="op" id="6994988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994991">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994994">if</span>&nbsp;<span class="ident" id="6994997">g</span><span class="op" id="6994998">,</span>&nbsp;<span class="ident" id="6995000">e</span>&nbsp;<span class="op" id="6995002">:=</span>&nbsp;<span class="ident" id="6995005"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995008">.</span><span class="ident" id="6995009">UserAgent</span><span class="op" id="6995018">(</span><span class="op" id="6995019">)</span><span class="op" id="6995020">,</span>&nbsp;<span class="string" id="6995022">&#34;goclient&#34;</span><span class="op" id="6995032">;</span>&nbsp;<span class="ident" id="6995034"><a href="/net/http/cgi/child_test.go.html#6995000">e</a></span>&nbsp;<span class="op" id="6995036">!=</span>&nbsp;<span class="ident" id="6995039"><a href="/net/http/cgi/child_test.go.html#6994997">g</a></span>&nbsp;<span class="op" id="6995041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995045"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995046">.</span><span class="ident" id="6995047">Errorf</span><span class="op" id="6995053">(</span><span class="string" id="6995054">&#34;expected&nbsp;UserAgent&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995085">,</span>&nbsp;<span class="ident" id="6995087"><a href="/net/http/cgi/child_test.go.html#6995000">e</a></span><span class="op" id="6995088">,</span>&nbsp;<span class="ident" id="6995090"><a href="/net/http/cgi/child_test.go.html#6994997">g</a></span><span class="op" id="6995091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995097">if</span>&nbsp;<span class="ident" id="6995100">g</span><span class="op" id="6995101">,</span>&nbsp;<span class="ident" id="6995103">e</span>&nbsp;<span class="op" id="6995105">:=</span>&nbsp;<span class="ident" id="6995108"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995111">.</span><span class="ident" id="6995112">Method</span><span class="op" id="6995118">,</span>&nbsp;<span class="string" id="6995120">&#34;GET&#34;</span><span class="op" id="6995125">;</span>&nbsp;<span class="ident" id="6995127"><a href="/net/http/cgi/child_test.go.html#6995103">e</a></span>&nbsp;<span class="op" id="6995129">!=</span>&nbsp;<span class="ident" id="6995132"><a href="/net/http/cgi/child_test.go.html#6995100">g</a></span>&nbsp;<span class="op" id="6995134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995138"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995139">.</span><span class="ident" id="6995140">Errorf</span><span class="op" id="6995146">(</span><span class="string" id="6995147">&#34;expected&nbsp;Method&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995175">,</span>&nbsp;<span class="ident" id="6995177"><a href="/net/http/cgi/child_test.go.html#6995103">e</a></span><span class="op" id="6995178">,</span>&nbsp;<span class="ident" id="6995180"><a href="/net/http/cgi/child_test.go.html#6995100">g</a></span><span class="op" id="6995181">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995187">if</span>&nbsp;<span class="ident" id="6995190">g</span><span class="op" id="6995191">,</span>&nbsp;<span class="ident" id="6995193">e</span>&nbsp;<span class="op" id="6995195">:=</span>&nbsp;<span class="ident" id="6995198"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995201">.</span><span class="ident" id="6995202">Header</span><span class="op" id="6995208">.</span><span class="ident" id="6995209">Get</span><span class="op" id="6995212">(</span><span class="string" id="6995213">&#34;Content-Type&#34;</span><span class="op" id="6995227">)</span><span class="op" id="6995228">,</span>&nbsp;<span class="string" id="6995230">&#34;text/xml&#34;</span><span class="op" id="6995240">;</span>&nbsp;<span class="ident" id="6995242"><a href="/net/http/cgi/child_test.go.html#6995193">e</a></span>&nbsp;<span class="op" id="6995244">!=</span>&nbsp;<span class="ident" id="6995247"><a href="/net/http/cgi/child_test.go.html#6995190">g</a></span>&nbsp;<span class="op" id="6995249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995253"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995254">.</span><span class="ident" id="6995255">Errorf</span><span class="op" id="6995261">(</span><span class="string" id="6995262">&#34;expected&nbsp;Content-Type&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995296">,</span>&nbsp;<span class="ident" id="6995298"><a href="/net/http/cgi/child_test.go.html#6995193">e</a></span><span class="op" id="6995299">,</span>&nbsp;<span class="ident" id="6995301"><a href="/net/http/cgi/child_test.go.html#6995190">g</a></span><span class="op" id="6995302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995308">if</span>&nbsp;<span class="ident" id="6995311">g</span><span class="op" id="6995312">,</span>&nbsp;<span class="ident" id="6995314">e</span>&nbsp;<span class="op" id="6995316">:=</span>&nbsp;<span class="ident" id="6995319"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995322">.</span><span class="ident" id="6995323">ContentLength</span><span class="op" id="6995336">,</span>&nbsp;<span class="ident" id="6995338">int64</span><span class="op" id="6995343">(</span><span class="num" id="6995344">123</span><span class="op" id="6995347">)</span><span class="op" id="6995348">;</span>&nbsp;<span class="ident" id="6995350"><a href="/net/http/cgi/child_test.go.html#6995314">e</a></span>&nbsp;<span class="op" id="6995352">!=</span>&nbsp;<span class="ident" id="6995355"><a href="/net/http/cgi/child_test.go.html#6995311">g</a></span>&nbsp;<span class="op" id="6995357">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995361"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995362">.</span><span class="ident" id="6995363">Errorf</span><span class="op" id="6995369">(</span><span class="string" id="6995370">&#34;expected&nbsp;ContentLength&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6995405">,</span>&nbsp;<span class="ident" id="6995407"><a href="/net/http/cgi/child_test.go.html#6995314">e</a></span><span class="op" id="6995408">,</span>&nbsp;<span class="ident" id="6995410"><a href="/net/http/cgi/child_test.go.html#6995311">g</a></span><span class="op" id="6995411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995417">if</span>&nbsp;<span class="ident" id="6995420">g</span><span class="op" id="6995421">,</span>&nbsp;<span class="ident" id="6995423">e</span>&nbsp;<span class="op" id="6995425">:=</span>&nbsp;<span class="ident" id="6995428"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995431">.</span><span class="ident" id="6995432">Referer</span><span class="op" id="6995439">(</span><span class="op" id="6995440">)</span><span class="op" id="6995441">,</span>&nbsp;<span class="string" id="6995443">&#34;elsewhere&#34;</span><span class="op" id="6995454">;</span>&nbsp;<span class="ident" id="6995456"><a href="/net/http/cgi/child_test.go.html#6995423">e</a></span>&nbsp;<span class="op" id="6995458">!=</span>&nbsp;<span class="ident" id="6995461"><a href="/net/http/cgi/child_test.go.html#6995420">g</a></span>&nbsp;<span class="op" id="6995463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995467"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995468">.</span><span class="ident" id="6995469">Errorf</span><span class="op" id="6995475">(</span><span class="string" id="6995476">&#34;expected&nbsp;Referer&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995505">,</span>&nbsp;<span class="ident" id="6995507"><a href="/net/http/cgi/child_test.go.html#6995423">e</a></span><span class="op" id="6995508">,</span>&nbsp;<span class="ident" id="6995510"><a href="/net/http/cgi/child_test.go.html#6995420">g</a></span><span class="op" id="6995511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995514">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995517">if</span>&nbsp;<span class="ident" id="6995520"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995523">.</span><span class="ident" id="6995524">Header</span>&nbsp;<span class="op" id="6995531">==</span>&nbsp;<span class="ident" id="6995534">nil</span>&nbsp;<span class="op" id="6995538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995542"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995543">.</span><span class="ident" id="6995544">Fatalf</span><span class="op" id="6995550">(</span><span class="string" id="6995551">&#34;unexpected&nbsp;nil&nbsp;Header&#34;</span><span class="op" id="6995574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995580">if</span>&nbsp;<span class="ident" id="6995583">g</span><span class="op" id="6995584">,</span>&nbsp;<span class="ident" id="6995586">e</span>&nbsp;<span class="op" id="6995588">:=</span>&nbsp;<span class="ident" id="6995591"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995594">.</span><span class="ident" id="6995595">Header</span><span class="op" id="6995601">.</span><span class="ident" id="6995602">Get</span><span class="op" id="6995605">(</span><span class="string" id="6995606">&#34;Foo-Bar&#34;</span><span class="op" id="6995615">)</span><span class="op" id="6995616">,</span>&nbsp;<span class="string" id="6995618">&#34;baz&#34;</span><span class="op" id="6995623">;</span>&nbsp;<span class="ident" id="6995625"><a href="/net/http/cgi/child_test.go.html#6995586">e</a></span>&nbsp;<span class="op" id="6995627">!=</span>&nbsp;<span class="ident" id="6995630"><a href="/net/http/cgi/child_test.go.html#6995583">g</a></span>&nbsp;<span class="op" id="6995632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995636"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995637">.</span><span class="ident" id="6995638">Errorf</span><span class="op" id="6995644">(</span><span class="string" id="6995645">&#34;expected&nbsp;Foo-Bar&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995674">,</span>&nbsp;<span class="ident" id="6995676"><a href="/net/http/cgi/child_test.go.html#6995586">e</a></span><span class="op" id="6995677">,</span>&nbsp;<span class="ident" id="6995679"><a href="/net/http/cgi/child_test.go.html#6995583">g</a></span><span class="op" id="6995680">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995686">if</span>&nbsp;<span class="ident" id="6995689">g</span><span class="op" id="6995690">,</span>&nbsp;<span class="ident" id="6995692">e</span>&nbsp;<span class="op" id="6995694">:=</span>&nbsp;<span class="ident" id="6995697"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995700">.</span><span class="ident" id="6995701">URL</span><span class="op" id="6995704">.</span><span class="ident" id="6995705">String</span><span class="op" id="6995711">(</span><span class="op" id="6995712">)</span><span class="op" id="6995713">,</span>&nbsp;<span class="string" id="6995715">&#34;http://example.com/path?a=b&#34;</span><span class="op" id="6995744">;</span>&nbsp;<span class="ident" id="6995746"><a href="/net/http/cgi/child_test.go.html#6995692">e</a></span>&nbsp;<span class="op" id="6995748">!=</span>&nbsp;<span class="ident" id="6995751"><a href="/net/http/cgi/child_test.go.html#6995689">g</a></span>&nbsp;<span class="op" id="6995753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995757"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995758">.</span><span class="ident" id="6995759">Errorf</span><span class="op" id="6995765">(</span><span class="string" id="6995766">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995791">,</span>&nbsp;<span class="ident" id="6995793"><a href="/net/http/cgi/child_test.go.html#6995692">e</a></span><span class="op" id="6995794">,</span>&nbsp;<span class="ident" id="6995796"><a href="/net/http/cgi/child_test.go.html#6995689">g</a></span><span class="op" id="6995797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995803">if</span>&nbsp;<span class="ident" id="6995806">g</span><span class="op" id="6995807">,</span>&nbsp;<span class="ident" id="6995809">e</span>&nbsp;<span class="op" id="6995811">:=</span>&nbsp;<span class="ident" id="6995814"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995817">.</span><span class="ident" id="6995818">FormValue</span><span class="op" id="6995827">(</span><span class="string" id="6995828">&#34;a&#34;</span><span class="op" id="6995831">)</span><span class="op" id="6995832">,</span>&nbsp;<span class="string" id="6995834">&#34;b&#34;</span><span class="op" id="6995837">;</span>&nbsp;<span class="ident" id="6995839"><a href="/net/http/cgi/child_test.go.html#6995809">e</a></span>&nbsp;<span class="op" id="6995841">!=</span>&nbsp;<span class="ident" id="6995844"><a href="/net/http/cgi/child_test.go.html#6995806">g</a></span>&nbsp;<span class="op" id="6995846">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995850"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995851">.</span><span class="ident" id="6995852">Errorf</span><span class="op" id="6995858">(</span><span class="string" id="6995859">&#34;expected&nbsp;FormValue(a)&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6995893">,</span>&nbsp;<span class="ident" id="6995895"><a href="/net/http/cgi/child_test.go.html#6995809">e</a></span><span class="op" id="6995896">,</span>&nbsp;<span class="ident" id="6995898"><a href="/net/http/cgi/child_test.go.html#6995806">g</a></span><span class="op" id="6995899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995905">if</span>&nbsp;<span class="ident" id="6995908"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995911">.</span><span class="ident" id="6995912">Trailer</span>&nbsp;<span class="op" id="6995920">==</span>&nbsp;<span class="ident" id="6995923">nil</span>&nbsp;<span class="op" id="6995927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995931"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995932">.</span><span class="ident" id="6995933">Errorf</span><span class="op" id="6995939">(</span><span class="string" id="6995940">&#34;unexpected&nbsp;nil&nbsp;Trailer&#34;</span><span class="op" id="6995964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995967">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995970">if</span>&nbsp;<span class="ident" id="6995973"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6995976">.</span><span class="ident" id="6995977">TLS</span>&nbsp;<span class="op" id="6995981">!=</span>&nbsp;<span class="ident" id="6995984">nil</span>&nbsp;<span class="op" id="6995988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995992"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6995993">.</span><span class="ident" id="6995994">Errorf</span><span class="op" id="6996000">(</span><span class="string" id="6996001">&#34;expected&nbsp;nil&nbsp;TLS&#34;</span><span class="op" id="6996019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996025">if</span>&nbsp;<span class="ident" id="6996028">e</span><span class="op" id="6996029">,</span>&nbsp;<span class="ident" id="6996031">g</span>&nbsp;<span class="op" id="6996033">:=</span>&nbsp;<span class="string" id="6996036">&#34;5.6.7.8:0&#34;</span><span class="op" id="6996047">,</span>&nbsp;<span class="ident" id="6996049"><a href="/net/http/cgi/child_test.go.html#6994903">req</a></span><span class="op" id="6996052">.</span><span class="ident" id="6996053">RemoteAddr</span><span class="op" id="6996063">;</span>&nbsp;<span class="ident" id="6996065"><a href="/net/http/cgi/child_test.go.html#6996028">e</a></span>&nbsp;<span class="op" id="6996067">!=</span>&nbsp;<span class="ident" id="6996070"><a href="/net/http/cgi/child_test.go.html#6996031">g</a></span>&nbsp;<span class="op" id="6996072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996076"><a href="/net/http/cgi/child_test.go.html#6994537">t</a></span><span class="op" id="6996077">.</span><span class="ident" id="6996078">Errorf</span><span class="op" id="6996084">(</span><span class="string" id="6996085">&#34;RemoteAddr:&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6996114">,</span>&nbsp;<span class="ident" id="6996116"><a href="/net/http/cgi/child_test.go.html#6996031">g</a></span><span class="op" id="6996117">,</span>&nbsp;<span class="ident" id="6996119"><a href="/net/http/cgi/child_test.go.html#6996028">e</a></span><span class="op" id="6996120">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996123">}</span><br>
<span class="lineno"></span><span class="op" id="6996125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6996128">func</span>&nbsp;<span class="ident" id="6996133">TestRequestWithTLS</span><span class="op" id="6996151">(</span><span class="ident" id="6996152">t</span>&nbsp;<span class="op" id="6996154">*</span><span class="ident" id="6996155"><a href="/net/http/cgi/child_test.go.html#6994507">testing</a></span><span class="op" id="6996162">.</span><span class="ident" id="6996163">T</span><span class="op" id="6996164">)</span>&nbsp;<span class="op" id="6996166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996169">env</span>&nbsp;<span class="op" id="6996173">:=</span>&nbsp;<span class="keyword" id="6996176">map</span><span class="op" id="6996179">[</span><span class="builtintype" id="6996180">string</span><span class="op" id="6996186">]</span><span class="builtintype" id="6996187">string</span><span class="op" id="6996193">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996197">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="6996214">:</span>&nbsp;<span class="string" id="6996216">&#34;HTTP/1.1&#34;</span><span class="op" id="6996226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996230">&#34;REQUEST_METHOD&#34;</span><span class="op" id="6996246">:</span>&nbsp;&nbsp;<span class="string" id="6996249">&#34;GET&#34;</span><span class="op" id="6996254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996258">&#34;HTTP_HOST&#34;</span><span class="op" id="6996269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996277">&#34;example.com&#34;</span><span class="op" id="6996290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996294">&#34;HTTP_REFERER&#34;</span><span class="op" id="6996308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996313">&#34;elsewhere&#34;</span><span class="op" id="6996324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996328">&#34;REQUEST_URI&#34;</span><span class="op" id="6996341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996347">&#34;/path?a=b&#34;</span><span class="op" id="6996358">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996362">&#34;CONTENT_TYPE&#34;</span><span class="op" id="6996376">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996381">&#34;text/xml&#34;</span><span class="op" id="6996391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996395">&#34;HTTPS&#34;</span><span class="op" id="6996402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996414">&#34;1&#34;</span><span class="op" id="6996417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996421">&#34;REMOTE_ADDR&#34;</span><span class="op" id="6996434">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996440">&#34;5.6.7.8&#34;</span><span class="op" id="6996449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996455">req</span><span class="op" id="6996458">,</span>&nbsp;<span class="ident" id="6996460">err</span>&nbsp;<span class="op" id="6996464">:=</span>&nbsp;<span class="ident" id="6996467"><a href="/net/http/cgi/child.go.html#6139250">RequestFromMap</a></span><span class="op" id="6996481">(</span><span class="ident" id="6996482"><a href="/net/http/cgi/child_test.go.html#6996169">env</a></span><span class="op" id="6996485">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996488">if</span>&nbsp;<span class="ident" id="6996491"><a href="/net/http/cgi/child_test.go.html#6996460">err</a></span>&nbsp;<span class="op" id="6996495">!=</span>&nbsp;<span class="ident" id="6996498">nil</span>&nbsp;<span class="op" id="6996502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996506"><a href="/net/http/cgi/child_test.go.html#6996152">t</a></span><span class="op" id="6996507">.</span><span class="ident" id="6996508">Fatalf</span><span class="op" id="6996514">(</span><span class="string" id="6996515">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="6996535">,</span>&nbsp;<span class="ident" id="6996537"><a href="/net/http/cgi/child_test.go.html#6996460">err</a></span><span class="op" id="6996540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996546">if</span>&nbsp;<span class="ident" id="6996549">g</span><span class="op" id="6996550">,</span>&nbsp;<span class="ident" id="6996552">e</span>&nbsp;<span class="op" id="6996554">:=</span>&nbsp;<span class="ident" id="6996557"><a href="/net/http/cgi/child_test.go.html#6996455">req</a></span><span class="op" id="6996560">.</span><span class="ident" id="6996561">URL</span><span class="op" id="6996564">.</span><span class="ident" id="6996565">String</span><span class="op" id="6996571">(</span><span class="op" id="6996572">)</span><span class="op" id="6996573">,</span>&nbsp;<span class="string" id="6996575">&#34;https://example.com/path?a=b&#34;</span><span class="op" id="6996605">;</span>&nbsp;<span class="ident" id="6996607"><a href="/net/http/cgi/child_test.go.html#6996552">e</a></span>&nbsp;<span class="op" id="6996609">!=</span>&nbsp;<span class="ident" id="6996612"><a href="/net/http/cgi/child_test.go.html#6996549">g</a></span>&nbsp;<span class="op" id="6996614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996618"><a href="/net/http/cgi/child_test.go.html#6996152">t</a></span><span class="op" id="6996619">.</span><span class="ident" id="6996620">Errorf</span><span class="op" id="6996626">(</span><span class="string" id="6996627">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6996652">,</span>&nbsp;<span class="ident" id="6996654"><a href="/net/http/cgi/child_test.go.html#6996552">e</a></span><span class="op" id="6996655">,</span>&nbsp;<span class="ident" id="6996657"><a href="/net/http/cgi/child_test.go.html#6996549">g</a></span><span class="op" id="6996658">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996664">if</span>&nbsp;<span class="ident" id="6996667"><a href="/net/http/cgi/child_test.go.html#6996455">req</a></span><span class="op" id="6996670">.</span><span class="ident" id="6996671">TLS</span>&nbsp;<span class="op" id="6996675">==</span>&nbsp;<span class="ident" id="6996678">nil</span>&nbsp;<span class="op" id="6996682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996686"><a href="/net/http/cgi/child_test.go.html#6996152">t</a></span><span class="op" id="6996687">.</span><span class="ident" id="6996688">Errorf</span><span class="op" id="6996694">(</span><span class="string" id="6996695">&#34;expected&nbsp;non-nil&nbsp;TLS&#34;</span><span class="op" id="6996717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996720">}</span><br>
<span class="lineno"></span><span class="op" id="6996722">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6996725">func</span>&nbsp;<span class="ident" id="6996730">TestRequestWithoutHost</span><span class="op" id="6996752">(</span><span class="ident" id="6996753">t</span>&nbsp;<span class="op" id="6996755">*</span><span class="ident" id="6996756"><a href="/net/http/cgi/child_test.go.html#6994507">testing</a></span><span class="op" id="6996763">.</span><span class="ident" id="6996764">T</span><span class="op" id="6996765">)</span>&nbsp;<span class="op" id="6996767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996770">env</span>&nbsp;<span class="op" id="6996774">:=</span>&nbsp;<span class="keyword" id="6996777">map</span><span class="op" id="6996780">[</span><span class="builtintype" id="6996781">string</span><span class="op" id="6996787">]</span><span class="builtintype" id="6996788">string</span><span class="op" id="6996794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996798">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="6996815">:</span>&nbsp;<span class="string" id="6996817">&#34;HTTP/1.1&#34;</span><span class="op" id="6996827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996831">&#34;HTTP_HOST&#34;</span><span class="op" id="6996842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996850">&#34;&#34;</span><span class="op" id="6996852">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996856">&#34;REQUEST_METHOD&#34;</span><span class="op" id="6996872">:</span>&nbsp;&nbsp;<span class="string" id="6996875">&#34;GET&#34;</span><span class="op" id="6996880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996884">&#34;REQUEST_URI&#34;</span><span class="op" id="6996897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6996903">&#34;/path?a=b&#34;</span><span class="op" id="6996914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6996918">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="6996934">:</span>&nbsp;&nbsp;<span class="string" id="6996937">&#34;123&#34;</span><span class="op" id="6996942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996948">req</span><span class="op" id="6996951">,</span>&nbsp;<span class="ident" id="6996953">err</span>&nbsp;<span class="op" id="6996957">:=</span>&nbsp;<span class="ident" id="6996960"><a href="/net/http/cgi/child.go.html#6139250">RequestFromMap</a></span><span class="op" id="6996974">(</span><span class="ident" id="6996975"><a href="/net/http/cgi/child_test.go.html#6996770">env</a></span><span class="op" id="6996978">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996981">if</span>&nbsp;<span class="ident" id="6996984"><a href="/net/http/cgi/child_test.go.html#6996953">err</a></span>&nbsp;<span class="op" id="6996988">!=</span>&nbsp;<span class="ident" id="6996991">nil</span>&nbsp;<span class="op" id="6996995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996999"><a href="/net/http/cgi/child_test.go.html#6996753">t</a></span><span class="op" id="6997000">.</span><span class="ident" id="6997001">Fatalf</span><span class="op" id="6997007">(</span><span class="string" id="6997008">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="6997028">,</span>&nbsp;<span class="ident" id="6997030"><a href="/net/http/cgi/child_test.go.html#6996953">err</a></span><span class="op" id="6997033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6997039">if</span>&nbsp;<span class="ident" id="6997042"><a href="/net/http/cgi/child_test.go.html#6996948">req</a></span><span class="op" id="6997045">.</span><span class="ident" id="6997046">URL</span>&nbsp;<span class="op" id="6997050">==</span>&nbsp;<span class="ident" id="6997053">nil</span>&nbsp;<span class="op" id="6997057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997061"><a href="/net/http/cgi/child_test.go.html#6996753">t</a></span><span class="op" id="6997062">.</span><span class="ident" id="6997063">Fatalf</span><span class="op" id="6997069">(</span><span class="string" id="6997070">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="6997090">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6997096">if</span>&nbsp;<span class="ident" id="6997099">g</span><span class="op" id="6997100">,</span>&nbsp;<span class="ident" id="6997102">e</span>&nbsp;<span class="op" id="6997104">:=</span>&nbsp;<span class="ident" id="6997107"><a href="/net/http/cgi/child_test.go.html#6996948">req</a></span><span class="op" id="6997110">.</span><span class="ident" id="6997111">URL</span><span class="op" id="6997114">.</span><span class="ident" id="6997115">String</span><span class="op" id="6997121">(</span><span class="op" id="6997122">)</span><span class="op" id="6997123">,</span>&nbsp;<span class="string" id="6997125">&#34;/path?a=b&#34;</span><span class="op" id="6997136">;</span>&nbsp;<span class="ident" id="6997138"><a href="/net/http/cgi/child_test.go.html#6997102">e</a></span>&nbsp;<span class="op" id="6997140">!=</span>&nbsp;<span class="ident" id="6997143"><a href="/net/http/cgi/child_test.go.html#6997099">g</a></span>&nbsp;<span class="op" id="6997145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997149"><a href="/net/http/cgi/child_test.go.html#6996753">t</a></span><span class="op" id="6997150">.</span><span class="ident" id="6997151">Errorf</span><span class="op" id="6997157">(</span><span class="string" id="6997158">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6997177">,</span>&nbsp;<span class="ident" id="6997179"><a href="/net/http/cgi/child_test.go.html#6997099">g</a></span><span class="op" id="6997180">,</span>&nbsp;<span class="ident" id="6997182"><a href="/net/http/cgi/child_test.go.html#6997102">e</a></span><span class="op" id="6997183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997186">}</span><br>
<span class="lineno"></span><span class="op" id="6997188">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="6997191">func</span>&nbsp;<span class="ident" id="6997196">TestRequestWithoutRequestURI</span><span class="op" id="6997224">(</span><span class="ident" id="6997225">t</span>&nbsp;<span class="op" id="6997227">*</span><span class="ident" id="6997228"><a href="/net/http/cgi/child_test.go.html#6994507">testing</a></span><span class="op" id="6997235">.</span><span class="ident" id="6997236">T</span><span class="op" id="6997237">)</span>&nbsp;<span class="op" id="6997239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997242">env</span>&nbsp;<span class="op" id="6997246">:=</span>&nbsp;<span class="keyword" id="6997249">map</span><span class="op" id="6997252">[</span><span class="builtintype" id="6997253">string</span><span class="op" id="6997259">]</span><span class="builtintype" id="6997260">string</span><span class="op" id="6997266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997270">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="6997287">:</span>&nbsp;<span class="string" id="6997289">&#34;HTTP/1.1&#34;</span><span class="op" id="6997299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997303">&#34;HTTP_HOST&#34;</span><span class="op" id="6997314">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6997322">&#34;example.com&#34;</span><span class="op" id="6997335">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997339">&#34;REQUEST_METHOD&#34;</span><span class="op" id="6997355">:</span>&nbsp;&nbsp;<span class="string" id="6997358">&#34;GET&#34;</span><span class="op" id="6997363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997367">&#34;SCRIPT_NAME&#34;</span><span class="op" id="6997380">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6997386">&#34;/dir/scriptname&#34;</span><span class="op" id="6997403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997407">&#34;PATH_INFO&#34;</span><span class="op" id="6997418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6997426">&#34;/p1/p2&#34;</span><span class="op" id="6997434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997438">&#34;QUERY_STRING&#34;</span><span class="op" id="6997452">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6997457">&#34;a=1&amp;b=2&#34;</span><span class="op" id="6997466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6997470">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="6997486">:</span>&nbsp;&nbsp;<span class="string" id="6997489">&#34;123&#34;</span><span class="op" id="6997494">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997500">req</span><span class="op" id="6997503">,</span>&nbsp;<span class="ident" id="6997505">err</span>&nbsp;<span class="op" id="6997509">:=</span>&nbsp;<span class="ident" id="6997512"><a href="/net/http/cgi/child.go.html#6139250">RequestFromMap</a></span><span class="op" id="6997526">(</span><span class="ident" id="6997527"><a href="/net/http/cgi/child_test.go.html#6997242">env</a></span><span class="op" id="6997530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6997533">if</span>&nbsp;<span class="ident" id="6997536"><a href="/net/http/cgi/child_test.go.html#6997505">err</a></span>&nbsp;<span class="op" id="6997540">!=</span>&nbsp;<span class="ident" id="6997543">nil</span>&nbsp;<span class="op" id="6997547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997551"><a href="/net/http/cgi/child_test.go.html#6997225">t</a></span><span class="op" id="6997552">.</span><span class="ident" id="6997553">Fatalf</span><span class="op" id="6997559">(</span><span class="string" id="6997560">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="6997580">,</span>&nbsp;<span class="ident" id="6997582"><a href="/net/http/cgi/child_test.go.html#6997505">err</a></span><span class="op" id="6997585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997588">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6997591">if</span>&nbsp;<span class="ident" id="6997594"><a href="/net/http/cgi/child_test.go.html#6997500">req</a></span><span class="op" id="6997597">.</span><span class="ident" id="6997598">URL</span>&nbsp;<span class="op" id="6997602">==</span>&nbsp;<span class="ident" id="6997605">nil</span>&nbsp;<span class="op" id="6997609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997613"><a href="/net/http/cgi/child_test.go.html#6997225">t</a></span><span class="op" id="6997614">.</span><span class="ident" id="6997615">Fatalf</span><span class="op" id="6997621">(</span><span class="string" id="6997622">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="6997642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6997648">if</span>&nbsp;<span class="ident" id="6997651">g</span><span class="op" id="6997652">,</span>&nbsp;<span class="ident" id="6997654">e</span>&nbsp;<span class="op" id="6997656">:=</span>&nbsp;<span class="ident" id="6997659"><a href="/net/http/cgi/child_test.go.html#6997500">req</a></span><span class="op" id="6997662">.</span><span class="ident" id="6997663">URL</span><span class="op" id="6997666">.</span><span class="ident" id="6997667">String</span><span class="op" id="6997673">(</span><span class="op" id="6997674">)</span><span class="op" id="6997675">,</span>&nbsp;<span class="string" id="6997677">&#34;http://example.com/dir/scriptname/p1/p2?a=1&amp;b=2&#34;</span><span class="op" id="6997726">;</span>&nbsp;<span class="ident" id="6997728"><a href="/net/http/cgi/child_test.go.html#6997654">e</a></span>&nbsp;<span class="op" id="6997730">!=</span>&nbsp;<span class="ident" id="6997733"><a href="/net/http/cgi/child_test.go.html#6997651">g</a></span>&nbsp;<span class="op" id="6997735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6997739"><a href="/net/http/cgi/child_test.go.html#6997225">t</a></span><span class="op" id="6997740">.</span><span class="ident" id="6997741">Errorf</span><span class="op" id="6997747">(</span><span class="string" id="6997748">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6997767">,</span>&nbsp;<span class="ident" id="6997769"><a href="/net/http/cgi/child_test.go.html#6997651">g</a></span><span class="op" id="6997770">,</span>&nbsp;<span class="ident" id="6997772"><a href="/net/http/cgi/child_test.go.html#6997654">e</a></span><span class="op" id="6997773">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6997776">}</span><br>
<span class="lineno"></span><span class="op" id="6997778">}</span>
</div>
</body>
</html>
