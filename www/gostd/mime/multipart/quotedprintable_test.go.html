<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html" class="current">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8505610">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8505665">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8505719">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8505770">package</span>&nbsp;<span class="ident" id="8505778">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505789">import</span>&nbsp;<span class="op" id="8505796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505799">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505808">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505817">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505827">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505835">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505842">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505848">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505859">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505869">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505877">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505888">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8505899">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="8505906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8505909">func</span>&nbsp;<span class="ident" id="8505914">TestQuotedPrintable</span><span class="op" id="8505933">(</span><span class="ident" id="8505934">t</span>&nbsp;<span class="op" id="8505936">*</span><span class="ident" id="8505937">testing</span><span class="op" id="8505944">.</span><span class="ident" id="8505945">T</span><span class="op" id="8505946">)</span>&nbsp;<span class="op" id="8505948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505951">tests</span>&nbsp;<span class="op" id="8505957">:=</span>&nbsp;<span class="op" id="8505960">[</span><span class="op" id="8505961">]</span><span class="keyword" id="8505962">struct</span>&nbsp;<span class="op" id="8505969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505973">in</span><span class="op" id="8505975">,</span>&nbsp;<span class="ident" id="8505977">want</span>&nbsp;<span class="builtintype" id="8505982">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8505991">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8506000">interface</span><span class="op" id="8506009">{</span><span class="op" id="8506010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506013">}</span><span class="op" id="8506014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506018">{</span><span class="ident" id="8506019">in</span><span class="op" id="8506021">:</span>&nbsp;<span class="string" id="8506023">&#34;&#34;</span><span class="op" id="8506025">,</span>&nbsp;<span class="ident" id="8506027">want</span><span class="op" id="8506031">:</span>&nbsp;<span class="string" id="8506033">&#34;&#34;</span><span class="op" id="8506035">}</span><span class="op" id="8506036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506040">{</span><span class="ident" id="8506041">in</span><span class="op" id="8506043">:</span>&nbsp;<span class="string" id="8506045">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506054">,</span>&nbsp;<span class="ident" id="8506056">want</span><span class="op" id="8506060">:</span>&nbsp;<span class="string" id="8506062">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506071">}</span><span class="op" id="8506072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506076">{</span><span class="ident" id="8506077">in</span><span class="op" id="8506079">:</span>&nbsp;<span class="string" id="8506081">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="8506093">,</span>&nbsp;<span class="ident" id="8506095">want</span><span class="op" id="8506099">:</span>&nbsp;<span class="string" id="8506101">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="8506111">}</span><span class="op" id="8506112">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506116">{</span><span class="ident" id="8506117">in</span><span class="op" id="8506119">:</span>&nbsp;<span class="string" id="8506121">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="8506133">,</span>&nbsp;<span class="ident" id="8506135">want</span><span class="op" id="8506139">:</span>&nbsp;<span class="string" id="8506141">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506150">}</span><span class="op" id="8506151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506155">{</span><span class="ident" id="8506156">in</span><span class="op" id="8506158">:</span>&nbsp;<span class="string" id="8506160">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8506171">,</span>&nbsp;<span class="ident" id="8506173">want</span><span class="op" id="8506177">:</span>&nbsp;<span class="string" id="8506179">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8506190">}</span><span class="op" id="8506191">,</span>&nbsp;<span class="comment" id="8506193">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506212">{</span><span class="ident" id="8506213">in</span><span class="op" id="8506215">:</span>&nbsp;<span class="string" id="8506217">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="8506228">,</span>&nbsp;<span class="ident" id="8506230">want</span><span class="op" id="8506234">:</span>&nbsp;<span class="string" id="8506236">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506245">,</span>&nbsp;<span class="ident" id="8506247">err</span><span class="op" id="8506250">:</span>&nbsp;<span class="ident" id="8506252">io</span><span class="op" id="8506254">.</span><span class="ident" id="8506255">ErrUnexpectedEOF</span><span class="op" id="8506271">}</span><span class="op" id="8506272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506276">{</span><span class="ident" id="8506277">in</span><span class="op" id="8506279">:</span>&nbsp;<span class="string" id="8506281">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="8506293">,</span>&nbsp;<span class="ident" id="8506295">want</span><span class="op" id="8506299">:</span>&nbsp;<span class="string" id="8506301">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506310">,</span>&nbsp;<span class="ident" id="8506312">err</span><span class="op" id="8506315">:</span>&nbsp;<span class="string" id="8506317">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="8506368">}</span><span class="op" id="8506369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506373">{</span><span class="ident" id="8506374">in</span><span class="op" id="8506376">:</span>&nbsp;<span class="string" id="8506378">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="8506393">,</span>&nbsp;<span class="ident" id="8506395">want</span><span class="op" id="8506399">:</span>&nbsp;<span class="string" id="8506401">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="8506414">}</span><span class="op" id="8506415">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506419">{</span><span class="ident" id="8506420">in</span><span class="op" id="8506422">:</span>&nbsp;<span class="string" id="8506424">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8506445">,</span>&nbsp;<span class="ident" id="8506447">want</span><span class="op" id="8506451">:</span>&nbsp;<span class="string" id="8506453">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="8506465">}</span><span class="op" id="8506466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506470">{</span><span class="ident" id="8506471">in</span><span class="op" id="8506473">:</span>&nbsp;<span class="string" id="8506475">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8506490">,</span>&nbsp;<span class="ident" id="8506492">want</span><span class="op" id="8506496">:</span>&nbsp;<span class="string" id="8506498">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8506507">}</span><span class="op" id="8506508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506512">{</span><span class="ident" id="8506513">in</span><span class="op" id="8506515">:</span>&nbsp;<span class="string" id="8506517">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8506530">,</span>&nbsp;<span class="ident" id="8506532">want</span><span class="op" id="8506536">:</span>&nbsp;<span class="string" id="8506538">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8506547">}</span><span class="op" id="8506548">,</span>&nbsp;<span class="comment" id="8506550">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506580">{</span><span class="ident" id="8506581">in</span><span class="op" id="8506583">:</span>&nbsp;<span class="string" id="8506585">&#34;foo=\nbar&#34;</span><span class="op" id="8506596">,</span>&nbsp;<span class="ident" id="8506598">want</span><span class="op" id="8506602">:</span>&nbsp;<span class="string" id="8506604">&#34;foobar&#34;</span><span class="op" id="8506612">}</span><span class="op" id="8506613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506617">{</span><span class="ident" id="8506618">in</span><span class="op" id="8506620">:</span>&nbsp;<span class="string" id="8506622">&#34;foo\x00bar&#34;</span><span class="op" id="8506634">,</span>&nbsp;<span class="ident" id="8506636">want</span><span class="op" id="8506640">:</span>&nbsp;<span class="string" id="8506642">&#34;foo&#34;</span><span class="op" id="8506647">,</span>&nbsp;<span class="ident" id="8506649">err</span><span class="op" id="8506652">:</span>&nbsp;<span class="string" id="8506654">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8506719">}</span><span class="op" id="8506720">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506724">{</span><span class="ident" id="8506725">in</span><span class="op" id="8506727">:</span>&nbsp;<span class="string" id="8506729">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="8506742">,</span>&nbsp;<span class="ident" id="8506744">want</span><span class="op" id="8506748">:</span>&nbsp;<span class="string" id="8506750">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8506759">,</span>&nbsp;<span class="ident" id="8506761">err</span><span class="op" id="8506764">:</span>&nbsp;<span class="string" id="8506766">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8506831">}</span><span class="op" id="8506832">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8506837">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506854">{</span><span class="ident" id="8506855">in</span><span class="op" id="8506857">:</span>&nbsp;<span class="string" id="8506859">&#34;=3D30\n&#34;</span><span class="op" id="8506868">,</span>&nbsp;<span class="ident" id="8506870">want</span><span class="op" id="8506874">:</span>&nbsp;<span class="string" id="8506876">&#34;=30\n&#34;</span><span class="op" id="8506883">}</span><span class="op" id="8506884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506888">{</span><span class="ident" id="8506889">in</span><span class="op" id="8506891">:</span>&nbsp;<span class="string" id="8506893">&#34;=00=FF0=\n&#34;</span><span class="op" id="8506905">,</span>&nbsp;<span class="ident" id="8506907">want</span><span class="op" id="8506911">:</span>&nbsp;<span class="string" id="8506913">&#34;\x00\xff0&#34;</span><span class="op" id="8506924">}</span><span class="op" id="8506925">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8506930">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506955">{</span><span class="ident" id="8506956">in</span><span class="op" id="8506958">:</span>&nbsp;<span class="string" id="8506960">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="8506969">,</span>&nbsp;<span class="ident" id="8506971">want</span><span class="op" id="8506975">:</span>&nbsp;<span class="string" id="8506977">&#34;foo\n&#34;</span><span class="op" id="8506984">}</span><span class="op" id="8506985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8506989">{</span><span class="ident" id="8506990">in</span><span class="op" id="8506992">:</span>&nbsp;<span class="string" id="8506994">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="8507024">,</span>&nbsp;<span class="ident" id="8507026">want</span><span class="op" id="8507030">:</span>&nbsp;<span class="string" id="8507032">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="8507055">}</span><span class="op" id="8507056">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8507061">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8507136">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507201">{</span><span class="ident" id="8507202">in</span><span class="op" id="8507204">:</span>&nbsp;<span class="string" id="8507206">&#34;foo\nbar&#34;</span><span class="op" id="8507216">,</span>&nbsp;<span class="ident" id="8507218">want</span><span class="op" id="8507222">:</span>&nbsp;<span class="string" id="8507224">&#34;foo\nbar&#34;</span><span class="op" id="8507234">}</span><span class="op" id="8507235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507239">{</span><span class="ident" id="8507240">in</span><span class="op" id="8507242">:</span>&nbsp;<span class="string" id="8507244">&#34;foo\rbar&#34;</span><span class="op" id="8507254">,</span>&nbsp;<span class="ident" id="8507256">want</span><span class="op" id="8507260">:</span>&nbsp;<span class="string" id="8507262">&#34;foo\rbar&#34;</span><span class="op" id="8507272">}</span><span class="op" id="8507273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507277">{</span><span class="ident" id="8507278">in</span><span class="op" id="8507280">:</span>&nbsp;<span class="string" id="8507282">&#34;foo\r\nbar&#34;</span><span class="op" id="8507294">,</span>&nbsp;<span class="ident" id="8507296">want</span><span class="op" id="8507300">:</span>&nbsp;<span class="string" id="8507302">&#34;foo\r\nbar&#34;</span><span class="op" id="8507314">}</span><span class="op" id="8507315">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8507320">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507362">{</span><span class="ident" id="8507363">in</span><span class="op" id="8507365">:</span>&nbsp;<span class="string" id="8507367">&#34;foo=\r\nbar&#34;</span><span class="op" id="8507380">,</span>&nbsp;<span class="ident" id="8507382">want</span><span class="op" id="8507386">:</span>&nbsp;<span class="string" id="8507388">&#34;foobar&#34;</span><span class="op" id="8507396">}</span><span class="op" id="8507397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507401">{</span><span class="ident" id="8507402">in</span><span class="op" id="8507404">:</span>&nbsp;<span class="string" id="8507406">&#34;foo=\nbar&#34;</span><span class="op" id="8507417">,</span>&nbsp;<span class="ident" id="8507419">want</span><span class="op" id="8507423">:</span>&nbsp;<span class="string" id="8507425">&#34;foobar&#34;</span><span class="op" id="8507433">}</span><span class="op" id="8507434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507438">{</span><span class="ident" id="8507439">in</span><span class="op" id="8507441">:</span>&nbsp;<span class="string" id="8507443">&#34;foo=\rbar&#34;</span><span class="op" id="8507454">,</span>&nbsp;<span class="ident" id="8507456">want</span><span class="op" id="8507460">:</span>&nbsp;<span class="string" id="8507462">&#34;foo&#34;</span><span class="op" id="8507467">,</span>&nbsp;<span class="ident" id="8507469">err</span><span class="op" id="8507472">:</span>&nbsp;<span class="string" id="8507474">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="8507525">}</span><span class="op" id="8507526">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507530">{</span><span class="ident" id="8507531">in</span><span class="op" id="8507533">:</span>&nbsp;<span class="string" id="8507535">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="8507553">,</span>&nbsp;<span class="ident" id="8507555">want</span><span class="op" id="8507559">:</span>&nbsp;<span class="string" id="8507561">&#34;foo&#34;</span><span class="op" id="8507566">,</span>&nbsp;<span class="ident" id="8507568">err</span><span class="op" id="8507571">:</span>&nbsp;<span class="string" id="8507573">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="8507620">}</span><span class="op" id="8507621">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8507626">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507654">{</span><span class="ident" id="8507655">in</span><span class="op" id="8507657">:</span>&nbsp;<span class="string" id="8507659">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="8507680">+</span>&nbsp;<span class="string" id="8507682">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="8507708">+</span>&nbsp;<span class="string" id="8507710">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8507741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8507746">want</span><span class="op" id="8507750">:</span>&nbsp;<span class="string" id="8507752">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8507818">}</span><span class="op" id="8507819">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8507822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8507825">for</span>&nbsp;<span class="ident" id="8507829">_</span><span class="op" id="8507830">,</span>&nbsp;<span class="ident" id="8507832">tt</span>&nbsp;<span class="op" id="8507835">:=</span>&nbsp;<span class="keyword" id="8507838">range</span>&nbsp;<span class="ident" id="8507844">tests</span>&nbsp;<span class="op" id="8507850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8507854">var</span>&nbsp;<span class="ident" id="8507858">buf</span>&nbsp;<span class="ident" id="8507862">bytes</span><span class="op" id="8507867">.</span><span class="ident" id="8507868">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8507877">_</span><span class="op" id="8507878">,</span>&nbsp;<span class="ident" id="8507880">err</span>&nbsp;<span class="op" id="8507884">:=</span>&nbsp;<span class="ident" id="8507887">io</span><span class="op" id="8507889">.</span><span class="ident" id="8507890">Copy</span><span class="op" id="8507894">(</span><span class="op" id="8507895">&amp;</span><span class="ident" id="8507896">buf</span><span class="op" id="8507899">,</span>&nbsp;<span class="ident" id="8507901">newQuotedPrintableReader</span><span class="op" id="8507925">(</span><span class="ident" id="8507926">strings</span><span class="op" id="8507933">.</span><span class="ident" id="8507934">NewReader</span><span class="op" id="8507943">(</span><span class="ident" id="8507944">tt</span><span class="op" id="8507946">.</span><span class="ident" id="8507947">in</span><span class="op" id="8507949">)</span><span class="op" id="8507950">)</span><span class="op" id="8507951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8507955">if</span>&nbsp;<span class="ident" id="8507958">got</span>&nbsp;<span class="op" id="8507962">:=</span>&nbsp;<span class="ident" id="8507965">buf</span><span class="op" id="8507968">.</span><span class="ident" id="8507969">String</span><span class="op" id="8507975">(</span><span class="op" id="8507976">)</span><span class="op" id="8507977">;</span>&nbsp;<span class="ident" id="8507979">got</span>&nbsp;<span class="op" id="8507983">!=</span>&nbsp;<span class="ident" id="8507986">tt</span><span class="op" id="8507988">.</span><span class="ident" id="8507989">want</span>&nbsp;<span class="op" id="8507994">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8507999">t</span><span class="op" id="8508000">.</span><span class="ident" id="8508001">Errorf</span><span class="op" id="8508007">(</span><span class="string" id="8508008">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8508033">,</span>&nbsp;<span class="ident" id="8508035">tt</span><span class="op" id="8508037">.</span><span class="ident" id="8508038">in</span><span class="op" id="8508040">,</span>&nbsp;<span class="ident" id="8508042">got</span><span class="op" id="8508045">,</span>&nbsp;<span class="ident" id="8508047">tt</span><span class="op" id="8508049">.</span><span class="ident" id="8508050">want</span><span class="op" id="8508054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508062">switch</span>&nbsp;<span class="ident" id="8508069">verr</span>&nbsp;<span class="op" id="8508074">:=</span>&nbsp;<span class="ident" id="8508077">tt</span><span class="op" id="8508079">.</span><span class="ident" id="8508080">err</span><span class="op" id="8508083">.</span><span class="op" id="8508084">(</span><span class="keyword" id="8508085">type</span><span class="op" id="8508089">)</span>&nbsp;<span class="op" id="8508091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508095">case</span>&nbsp;<span class="builtintype" id="8508100">nil</span><span class="op" id="8508103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508108">if</span>&nbsp;<span class="ident" id="8508111">err</span>&nbsp;<span class="op" id="8508115">!=</span>&nbsp;<span class="builtintype" id="8508118">nil</span>&nbsp;<span class="op" id="8508122">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508128">t</span><span class="op" id="8508129">.</span><span class="ident" id="8508130">Errorf</span><span class="op" id="8508136">(</span><span class="string" id="8508137">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8508171">,</span>&nbsp;<span class="ident" id="8508173">tt</span><span class="op" id="8508175">.</span><span class="ident" id="8508176">in</span><span class="op" id="8508178">,</span>&nbsp;<span class="ident" id="8508180">err</span><span class="op" id="8508183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508192">case</span>&nbsp;<span class="builtintype" id="8508197">string</span><span class="op" id="8508203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508208">if</span>&nbsp;<span class="ident" id="8508211">got</span>&nbsp;<span class="op" id="8508215">:=</span>&nbsp;<span class="ident" id="8508218">fmt</span><span class="op" id="8508221">.</span><span class="ident" id="8508222">Sprint</span><span class="op" id="8508228">(</span><span class="ident" id="8508229">err</span><span class="op" id="8508232">)</span><span class="op" id="8508233">;</span>&nbsp;<span class="ident" id="8508235">got</span>&nbsp;<span class="op" id="8508239">!=</span>&nbsp;<span class="ident" id="8508242">verr</span>&nbsp;<span class="op" id="8508247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508253">t</span><span class="op" id="8508254">.</span><span class="ident" id="8508255">Errorf</span><span class="op" id="8508261">(</span><span class="string" id="8508262">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8508293">,</span>&nbsp;<span class="ident" id="8508295">tt</span><span class="op" id="8508297">.</span><span class="ident" id="8508298">in</span><span class="op" id="8508300">,</span>&nbsp;<span class="ident" id="8508302">got</span><span class="op" id="8508305">,</span>&nbsp;<span class="ident" id="8508307">verr</span><span class="op" id="8508311">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508320">case</span>&nbsp;<span class="builtintype" id="8508325">error</span><span class="op" id="8508330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508335">if</span>&nbsp;<span class="ident" id="8508338">err</span>&nbsp;<span class="op" id="8508342">!=</span>&nbsp;<span class="ident" id="8508345">verr</span>&nbsp;<span class="op" id="8508350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508356">t</span><span class="op" id="8508357">.</span><span class="ident" id="8508358">Errorf</span><span class="op" id="8508364">(</span><span class="string" id="8508365">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8508396">,</span>&nbsp;<span class="ident" id="8508398">tt</span><span class="op" id="8508400">.</span><span class="ident" id="8508401">in</span><span class="op" id="8508403">,</span>&nbsp;<span class="ident" id="8508405">err</span><span class="op" id="8508408">,</span>&nbsp;<span class="ident" id="8508410">verr</span><span class="op" id="8508414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508419">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="8508429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8508432">func</span>&nbsp;<span class="ident" id="8508437">everySequence</span><span class="op" id="8508450">(</span><span class="ident" id="8508451">base</span><span class="op" id="8508455">,</span>&nbsp;<span class="ident" id="8508457">alpha</span>&nbsp;<span class="builtintype" id="8508463">string</span><span class="op" id="8508469">,</span>&nbsp;<span class="ident" id="8508471">length</span>&nbsp;<span class="builtintype" id="8508478">int</span><span class="op" id="8508481">,</span>&nbsp;<span class="ident" id="8508483">fn</span>&nbsp;<span class="keyword" id="8508486">func</span><span class="op" id="8508490">(</span><span class="builtintype" id="8508491">string</span><span class="op" id="8508497">)</span><span class="op" id="8508498">)</span>&nbsp;<span class="op" id="8508500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508503">if</span>&nbsp;<span class="builtinfunc" id="8508506">len</span><span class="op" id="8508509">(</span><span class="ident" id="8508510">base</span><span class="op" id="8508514">)</span>&nbsp;<span class="op" id="8508516">==</span>&nbsp;<span class="ident" id="8508519">length</span>&nbsp;<span class="op" id="8508526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508530">fn</span><span class="op" id="8508532">(</span><span class="ident" id="8508533">base</span><span class="op" id="8508537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508541">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508549">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508552">for</span>&nbsp;<span class="ident" id="8508556">i</span>&nbsp;<span class="op" id="8508558">:=</span>&nbsp;<span class="num" id="8508561">0</span><span class="op" id="8508562">;</span>&nbsp;<span class="ident" id="8508564">i</span>&nbsp;<span class="op" id="8508566">&lt;</span>&nbsp;<span class="builtinfunc" id="8508568">len</span><span class="op" id="8508571">(</span><span class="ident" id="8508572">alpha</span><span class="op" id="8508577">)</span><span class="op" id="8508578">;</span>&nbsp;<span class="ident" id="8508580">i</span><span class="op" id="8508581">++</span>&nbsp;<span class="op" id="8508584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508588">everySequence</span><span class="op" id="8508601">(</span><span class="ident" id="8508602">base</span><span class="op" id="8508606">+</span><span class="ident" id="8508607">alpha</span><span class="op" id="8508612">[</span><span class="ident" id="8508613">i</span><span class="op" id="8508614">:</span><span class="ident" id="8508615">i</span><span class="op" id="8508616">+</span><span class="num" id="8508617">1</span><span class="op" id="8508618">]</span><span class="op" id="8508619">,</span>&nbsp;<span class="ident" id="8508621">alpha</span><span class="op" id="8508626">,</span>&nbsp;<span class="ident" id="8508628">length</span><span class="op" id="8508634">,</span>&nbsp;<span class="ident" id="8508636">fn</span><span class="op" id="8508638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508641">}</span><br>
<span class="lineno"></span><span class="op" id="8508643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8508646">var</span>&nbsp;<span class="ident" id="8508650">useQprint</span>&nbsp;<span class="op" id="8508660">=</span>&nbsp;<span class="ident" id="8508662">flag</span><span class="op" id="8508666">.</span><span class="ident" id="8508667">Bool</span><span class="op" id="8508671">(</span><span class="string" id="8508672">&#34;qprint&#34;</span><span class="op" id="8508680">,</span>&nbsp;<span class="builtintype" id="8508682">false</span><span class="op" id="8508687">,</span>&nbsp;<span class="string" id="8508689">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="8508728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8508731">var</span>&nbsp;<span class="ident" id="8508735">badSoftRx</span>&nbsp;<span class="op" id="8508745">=</span>&nbsp;<span class="ident" id="8508747">regexp</span><span class="op" id="8508753">.</span><span class="ident" id="8508754">MustCompile</span><span class="op" id="8508765">(</span><span class="string" id="8508766">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="8508821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8508824">func</span>&nbsp;<span class="ident" id="8508829">TestQPExhaustive</span><span class="op" id="8508845">(</span><span class="ident" id="8508846">t</span>&nbsp;<span class="op" id="8508848">*</span><span class="ident" id="8508849">testing</span><span class="op" id="8508856">.</span><span class="ident" id="8508857">T</span><span class="op" id="8508858">)</span>&nbsp;<span class="op" id="8508860">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508863">if</span>&nbsp;<span class="op" id="8508866">*</span><span class="ident" id="8508867">useQprint</span>&nbsp;<span class="op" id="8508877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508881">_</span><span class="op" id="8508882">,</span>&nbsp;<span class="ident" id="8508884">err</span>&nbsp;<span class="op" id="8508888">:=</span>&nbsp;<span class="ident" id="8508891">exec</span><span class="op" id="8508895">.</span><span class="ident" id="8508896">LookPath</span><span class="op" id="8508904">(</span><span class="string" id="8508905">&#34;qprint&#34;</span><span class="op" id="8508913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508917">if</span>&nbsp;<span class="ident" id="8508920">err</span>&nbsp;<span class="op" id="8508924">!=</span>&nbsp;<span class="builtintype" id="8508927">nil</span>&nbsp;<span class="op" id="8508931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8508936">t</span><span class="op" id="8508937">.</span><span class="ident" id="8508938">Fatalf</span><span class="op" id="8508944">(</span><span class="string" id="8508945">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="8508975">,</span>&nbsp;<span class="ident" id="8508977">err</span><span class="op" id="8508980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508984">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8508987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8508991">var</span>&nbsp;<span class="ident" id="8508995">buf</span>&nbsp;<span class="ident" id="8508999">bytes</span><span class="op" id="8509004">.</span><span class="ident" id="8509005">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509013">res</span>&nbsp;<span class="op" id="8509017">:=</span>&nbsp;<span class="builtinfunc" id="8509020">make</span><span class="op" id="8509024">(</span><span class="keyword" id="8509025">map</span><span class="op" id="8509028">[</span><span class="builtintype" id="8509029">string</span><span class="op" id="8509035">]</span><span class="builtintype" id="8509036">int</span><span class="op" id="8509039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509042">everySequence</span><span class="op" id="8509055">(</span><span class="string" id="8509056">&#34;&#34;</span><span class="op" id="8509058">,</span>&nbsp;<span class="string" id="8509060">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="8509070">,</span>&nbsp;<span class="num" id="8509072">6</span><span class="op" id="8509073">,</span>&nbsp;<span class="keyword" id="8509075">func</span><span class="op" id="8509079">(</span><span class="ident" id="8509080">s</span>&nbsp;<span class="builtintype" id="8509082">string</span><span class="op" id="8509088">)</span>&nbsp;<span class="op" id="8509090">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509094">if</span>&nbsp;<span class="ident" id="8509097">strings</span><span class="op" id="8509104">.</span><span class="ident" id="8509105">HasSuffix</span><span class="op" id="8509114">(</span><span class="ident" id="8509115">s</span><span class="op" id="8509116">,</span>&nbsp;<span class="string" id="8509118">&#34;=&#34;</span><span class="op" id="8509121">)</span>&nbsp;<span class="op" id="8509123">||</span>&nbsp;<span class="ident" id="8509126">strings</span><span class="op" id="8509133">.</span><span class="ident" id="8509134">Contains</span><span class="op" id="8509142">(</span><span class="ident" id="8509143">s</span><span class="op" id="8509144">,</span>&nbsp;<span class="string" id="8509146">&#34;==&#34;</span><span class="op" id="8509150">)</span>&nbsp;<span class="op" id="8509152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509157">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509170">buf</span><span class="op" id="8509173">.</span><span class="ident" id="8509174">Reset</span><span class="op" id="8509179">(</span><span class="op" id="8509180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509184">_</span><span class="op" id="8509185">,</span>&nbsp;<span class="ident" id="8509187">err</span>&nbsp;<span class="op" id="8509191">:=</span>&nbsp;<span class="ident" id="8509194">io</span><span class="op" id="8509196">.</span><span class="ident" id="8509197">Copy</span><span class="op" id="8509201">(</span><span class="op" id="8509202">&amp;</span><span class="ident" id="8509203">buf</span><span class="op" id="8509206">,</span>&nbsp;<span class="ident" id="8509208">newQuotedPrintableReader</span><span class="op" id="8509232">(</span><span class="ident" id="8509233">strings</span><span class="op" id="8509240">.</span><span class="ident" id="8509241">NewReader</span><span class="op" id="8509250">(</span><span class="ident" id="8509251">s</span><span class="op" id="8509252">)</span><span class="op" id="8509253">)</span><span class="op" id="8509254">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509258">if</span>&nbsp;<span class="ident" id="8509261">err</span>&nbsp;<span class="op" id="8509265">!=</span>&nbsp;<span class="builtintype" id="8509268">nil</span>&nbsp;<span class="op" id="8509272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509277">errStr</span>&nbsp;<span class="op" id="8509284">:=</span>&nbsp;<span class="ident" id="8509287">err</span><span class="op" id="8509290">.</span><span class="ident" id="8509291">Error</span><span class="op" id="8509296">(</span><span class="op" id="8509297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509302">if</span>&nbsp;<span class="ident" id="8509305">strings</span><span class="op" id="8509312">.</span><span class="ident" id="8509313">Contains</span><span class="op" id="8509321">(</span><span class="ident" id="8509322">errStr</span><span class="op" id="8509328">,</span>&nbsp;<span class="string" id="8509330">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="8509354">)</span>&nbsp;<span class="op" id="8509356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509362">errStr</span>&nbsp;<span class="op" id="8509369">=</span>&nbsp;<span class="string" id="8509371">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509398">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8509403">res</span><span class="op" id="8509406">[</span><span class="ident" id="8509407">errStr</span><span class="op" id="8509413">]</span><span class="op" id="8509414">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509420">if</span>&nbsp;<span class="ident" id="8509423">strings</span><span class="op" id="8509430">.</span><span class="ident" id="8509431">Contains</span><span class="op" id="8509439">(</span><span class="ident" id="8509440">errStr</span><span class="op" id="8509446">,</span>&nbsp;<span class="string" id="8509448">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="8509484">)</span>&nbsp;<span class="op" id="8509486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509492">if</span>&nbsp;<span class="ident" id="8509495">strings</span><span class="op" id="8509502">.</span><span class="ident" id="8509503">HasSuffix</span><span class="op" id="8509512">(</span><span class="ident" id="8509513">errStr</span><span class="op" id="8509519">,</span>&nbsp;<span class="string" id="8509521">&#34;0x20&#34;</span><span class="op" id="8509527">)</span>&nbsp;<span class="op" id="8509529">&amp;&amp;</span>&nbsp;<span class="op" id="8509532">(</span><span class="ident" id="8509533">strings</span><span class="op" id="8509540">.</span><span class="ident" id="8509541">Contains</span><span class="op" id="8509549">(</span><span class="ident" id="8509550">s</span><span class="op" id="8509551">,</span>&nbsp;<span class="string" id="8509553">&#34;=0&nbsp;&#34;</span><span class="op" id="8509558">)</span>&nbsp;<span class="op" id="8509560">||</span>&nbsp;<span class="ident" id="8509563">strings</span><span class="op" id="8509570">.</span><span class="ident" id="8509571">Contains</span><span class="op" id="8509579">(</span><span class="ident" id="8509580">s</span><span class="op" id="8509581">,</span>&nbsp;<span class="string" id="8509583">&#34;=A&nbsp;&#34;</span><span class="op" id="8509588">)</span>&nbsp;<span class="op" id="8509590">||</span>&nbsp;<span class="ident" id="8509593">strings</span><span class="op" id="8509600">.</span><span class="ident" id="8509601">Contains</span><span class="op" id="8509609">(</span><span class="ident" id="8509610">s</span><span class="op" id="8509611">,</span>&nbsp;<span class="string" id="8509613">&#34;=&nbsp;&#34;</span><span class="op" id="8509617">)</span><span class="op" id="8509618">)</span>&nbsp;<span class="op" id="8509620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509638">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509644">if</span>&nbsp;<span class="ident" id="8509647">strings</span><span class="op" id="8509654">.</span><span class="ident" id="8509655">HasSuffix</span><span class="op" id="8509664">(</span><span class="ident" id="8509665">errStr</span><span class="op" id="8509671">,</span>&nbsp;<span class="string" id="8509673">&#34;0x3d&#34;</span><span class="op" id="8509679">)</span>&nbsp;<span class="op" id="8509681">&amp;&amp;</span>&nbsp;<span class="op" id="8509684">(</span><span class="ident" id="8509685">strings</span><span class="op" id="8509692">.</span><span class="ident" id="8509693">Contains</span><span class="op" id="8509701">(</span><span class="ident" id="8509702">s</span><span class="op" id="8509703">,</span>&nbsp;<span class="string" id="8509705">&#34;=0=&#34;</span><span class="op" id="8509710">)</span>&nbsp;<span class="op" id="8509712">||</span>&nbsp;<span class="ident" id="8509715">strings</span><span class="op" id="8509722">.</span><span class="ident" id="8509723">Contains</span><span class="op" id="8509731">(</span><span class="ident" id="8509732">s</span><span class="op" id="8509733">,</span>&nbsp;<span class="string" id="8509735">&#34;=A=&#34;</span><span class="op" id="8509740">)</span><span class="op" id="8509741">)</span>&nbsp;<span class="op" id="8509743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509767">if</span>&nbsp;<span class="ident" id="8509770">strings</span><span class="op" id="8509777">.</span><span class="ident" id="8509778">HasSuffix</span><span class="op" id="8509787">(</span><span class="ident" id="8509788">errStr</span><span class="op" id="8509794">,</span>&nbsp;<span class="string" id="8509796">&#34;0x0a&#34;</span><span class="op" id="8509802">)</span>&nbsp;<span class="op" id="8509804">||</span>&nbsp;<span class="ident" id="8509807">strings</span><span class="op" id="8509814">.</span><span class="ident" id="8509815">HasSuffix</span><span class="op" id="8509824">(</span><span class="ident" id="8509825">errStr</span><span class="op" id="8509831">,</span>&nbsp;<span class="string" id="8509833">&#34;0x0d&#34;</span><span class="op" id="8509839">)</span>&nbsp;<span class="op" id="8509841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8509848">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8509948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8509953">if</span>&nbsp;<span class="ident" id="8509956">strings</span><span class="op" id="8509963">.</span><span class="ident" id="8509964">Contains</span><span class="op" id="8509972">(</span><span class="ident" id="8509973">errStr</span><span class="op" id="8509979">,</span>&nbsp;<span class="string" id="8509981">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8509997">)</span>&nbsp;<span class="op" id="8509999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510005">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510020">if</span>&nbsp;<span class="ident" id="8510023">errStr</span>&nbsp;<span class="op" id="8510030">==</span>&nbsp;<span class="string" id="8510033">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="8510057">&amp;&amp;</span>&nbsp;<span class="ident" id="8510060">badSoftRx</span><span class="op" id="8510069">.</span><span class="ident" id="8510070">MatchString</span><span class="op" id="8510081">(</span><span class="ident" id="8510082">s</span><span class="op" id="8510083">)</span>&nbsp;<span class="op" id="8510085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510091">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510106">t</span><span class="op" id="8510107">.</span><span class="ident" id="8510108">Errorf</span><span class="op" id="8510114">(</span><span class="string" id="8510115">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8510132">,</span>&nbsp;<span class="ident" id="8510134">s</span><span class="op" id="8510135">,</span>&nbsp;<span class="ident" id="8510137">err</span><span class="op" id="8510140">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510145">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510158">if</span>&nbsp;<span class="op" id="8510161">*</span><span class="ident" id="8510162">useQprint</span>&nbsp;<span class="op" id="8510172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510177">cmd</span>&nbsp;<span class="op" id="8510181">:=</span>&nbsp;<span class="ident" id="8510184">exec</span><span class="op" id="8510188">.</span><span class="ident" id="8510189">Command</span><span class="op" id="8510196">(</span><span class="string" id="8510197">&#34;qprint&#34;</span><span class="op" id="8510205">,</span>&nbsp;<span class="string" id="8510207">&#34;-d&#34;</span><span class="op" id="8510211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510216">cmd</span><span class="op" id="8510219">.</span><span class="ident" id="8510220">Stdin</span>&nbsp;<span class="op" id="8510226">=</span>&nbsp;<span class="ident" id="8510228">strings</span><span class="op" id="8510235">.</span><span class="ident" id="8510236">NewReader</span><span class="op" id="8510245">(</span><span class="ident" id="8510246">s</span><span class="op" id="8510247">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510252">stderr</span><span class="op" id="8510258">,</span>&nbsp;<span class="ident" id="8510260">err</span>&nbsp;<span class="op" id="8510264">:=</span>&nbsp;<span class="ident" id="8510267">cmd</span><span class="op" id="8510270">.</span><span class="ident" id="8510271">StderrPipe</span><span class="op" id="8510281">(</span><span class="op" id="8510282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510287">if</span>&nbsp;<span class="ident" id="8510290">err</span>&nbsp;<span class="op" id="8510294">!=</span>&nbsp;<span class="builtintype" id="8510297">nil</span>&nbsp;<span class="op" id="8510301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8510307">panic</span><span class="op" id="8510312">(</span><span class="ident" id="8510313">err</span><span class="op" id="8510316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510326">qpres</span>&nbsp;<span class="op" id="8510332">:=</span>&nbsp;<span class="builtinfunc" id="8510335">make</span><span class="op" id="8510339">(</span><span class="keyword" id="8510340">chan</span>&nbsp;<span class="keyword" id="8510345">interface</span><span class="op" id="8510354">{</span><span class="op" id="8510355">}</span><span class="op" id="8510356">,</span>&nbsp;<span class="num" id="8510358">2</span><span class="op" id="8510359">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510364">go</span>&nbsp;<span class="keyword" id="8510367">func</span><span class="op" id="8510371">(</span><span class="op" id="8510372">)</span>&nbsp;<span class="op" id="8510374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510380">br</span>&nbsp;<span class="op" id="8510383">:=</span>&nbsp;<span class="ident" id="8510386">bufio</span><span class="op" id="8510391">.</span><span class="ident" id="8510392">NewReader</span><span class="op" id="8510401">(</span><span class="ident" id="8510402">stderr</span><span class="op" id="8510408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510414">s</span><span class="op" id="8510415">,</span>&nbsp;<span class="ident" id="8510417">_</span>&nbsp;<span class="op" id="8510419">:=</span>&nbsp;<span class="ident" id="8510422">br</span><span class="op" id="8510424">.</span><span class="ident" id="8510425">ReadString</span><span class="op" id="8510435">(</span><span class="string" id="8510436">&#39;\n&#39;</span><span class="op" id="8510440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510446">if</span>&nbsp;<span class="ident" id="8510449">s</span>&nbsp;<span class="op" id="8510451">!=</span>&nbsp;<span class="string" id="8510454">&#34;&#34;</span>&nbsp;<span class="op" id="8510457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510464">qpres</span>&nbsp;<span class="op" id="8510470">&lt;-</span>&nbsp;<span class="ident" id="8510473">errors</span><span class="op" id="8510479">.</span><span class="ident" id="8510480">New</span><span class="op" id="8510483">(</span><span class="ident" id="8510484">s</span><span class="op" id="8510485">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510492">if</span>&nbsp;<span class="ident" id="8510495">cmd</span><span class="op" id="8510498">.</span><span class="ident" id="8510499">Process</span>&nbsp;<span class="op" id="8510507">!=</span>&nbsp;<span class="builtintype" id="8510510">nil</span>&nbsp;<span class="op" id="8510514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8510522">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8510572">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510610">cmd</span><span class="op" id="8510613">.</span><span class="ident" id="8510614">Process</span><span class="op" id="8510621">.</span><span class="ident" id="8510622">Kill</span><span class="op" id="8510626">(</span><span class="op" id="8510627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510634">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510645">}</span><span class="op" id="8510646">(</span><span class="op" id="8510647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510652">go</span>&nbsp;<span class="keyword" id="8510655">func</span><span class="op" id="8510659">(</span><span class="op" id="8510660">)</span>&nbsp;<span class="op" id="8510662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510668">want</span><span class="op" id="8510672">,</span>&nbsp;<span class="ident" id="8510674">err</span>&nbsp;<span class="op" id="8510678">:=</span>&nbsp;<span class="ident" id="8510681">cmd</span><span class="op" id="8510684">.</span><span class="ident" id="8510685">Output</span><span class="op" id="8510691">(</span><span class="op" id="8510692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510698">if</span>&nbsp;<span class="ident" id="8510701">err</span>&nbsp;<span class="op" id="8510705">==</span>&nbsp;<span class="builtintype" id="8510708">nil</span>&nbsp;<span class="op" id="8510712">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510719">qpres</span>&nbsp;<span class="op" id="8510725">&lt;-</span>&nbsp;<span class="ident" id="8510728">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510742">}</span><span class="op" id="8510743">(</span><span class="op" id="8510744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510749">select</span>&nbsp;<span class="op" id="8510756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510761">case</span>&nbsp;<span class="ident" id="8510766">got</span>&nbsp;<span class="op" id="8510770">:=</span>&nbsp;<span class="op" id="8510773">&lt;-</span><span class="ident" id="8510775">qpres</span><span class="op" id="8510780">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510786">if</span>&nbsp;<span class="ident" id="8510789">want</span><span class="op" id="8510793">,</span>&nbsp;<span class="ident" id="8510795">ok</span>&nbsp;<span class="op" id="8510798">:=</span>&nbsp;<span class="ident" id="8510801">got</span><span class="op" id="8510804">.</span><span class="op" id="8510805">(</span><span class="op" id="8510806">[</span><span class="op" id="8510807">]</span><span class="builtintype" id="8510808">byte</span><span class="op" id="8510812">)</span><span class="op" id="8510813">;</span>&nbsp;<span class="ident" id="8510815">ok</span>&nbsp;<span class="op" id="8510818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8510825">if</span>&nbsp;<span class="builtintype" id="8510828">string</span><span class="op" id="8510834">(</span><span class="ident" id="8510835">want</span><span class="op" id="8510839">)</span>&nbsp;<span class="op" id="8510841">!=</span>&nbsp;<span class="ident" id="8510844">buf</span><span class="op" id="8510847">.</span><span class="ident" id="8510848">String</span><span class="op" id="8510854">(</span><span class="op" id="8510855">)</span>&nbsp;<span class="op" id="8510857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510865">t</span><span class="op" id="8510866">.</span><span class="ident" id="8510867">Errorf</span><span class="op" id="8510873">(</span><span class="string" id="8510874">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="8510907">,</span>&nbsp;<span class="ident" id="8510909">s</span><span class="op" id="8510910">,</span>&nbsp;<span class="ident" id="8510912">want</span><span class="op" id="8510916">,</span>&nbsp;<span class="ident" id="8510918">buf</span><span class="op" id="8510921">.</span><span class="ident" id="8510922">String</span><span class="op" id="8510928">(</span><span class="op" id="8510929">)</span><span class="op" id="8510930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510943">}</span>&nbsp;<span class="keyword" id="8510945">else</span>&nbsp;<span class="op" id="8510950">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8510957">t</span><span class="op" id="8510958">.</span><span class="ident" id="8510959">Logf</span><span class="op" id="8510963">(</span><span class="string" id="8510964">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8510984">,</span>&nbsp;<span class="ident" id="8510986">s</span><span class="op" id="8510987">,</span>&nbsp;<span class="ident" id="8510989">got</span><span class="op" id="8510992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8510998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8511003">case</span>&nbsp;<span class="op" id="8511008">&lt;-</span><span class="ident" id="8511010">time</span><span class="op" id="8511014">.</span><span class="ident" id="8511015">After</span><span class="op" id="8511020">(</span><span class="num" id="8511021">5</span>&nbsp;<span class="op" id="8511023">*</span>&nbsp;<span class="ident" id="8511025">time</span><span class="op" id="8511029">.</span><span class="ident" id="8511030">Second</span><span class="op" id="8511036">)</span><span class="op" id="8511037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511043">t</span><span class="op" id="8511044">.</span><span class="ident" id="8511045">Logf</span><span class="op" id="8511049">(</span><span class="string" id="8511050">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8511072">,</span>&nbsp;<span class="ident" id="8511074">s</span><span class="op" id="8511075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8511080">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8511084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511088">res</span><span class="op" id="8511091">[</span><span class="string" id="8511092">&#34;OK&#34;</span><span class="op" id="8511096">]</span><span class="op" id="8511097">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8511101">}</span><span class="op" id="8511102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8511105">var</span>&nbsp;<span class="ident" id="8511109">outcomes</span>&nbsp;<span class="op" id="8511118">[</span><span class="op" id="8511119">]</span><span class="builtintype" id="8511120">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8511128">for</span>&nbsp;<span class="ident" id="8511132">k</span><span class="op" id="8511133">,</span>&nbsp;<span class="ident" id="8511135">v</span>&nbsp;<span class="op" id="8511137">:=</span>&nbsp;<span class="keyword" id="8511140">range</span>&nbsp;<span class="ident" id="8511146">res</span>&nbsp;<span class="op" id="8511150">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511154">outcomes</span>&nbsp;<span class="op" id="8511163">=</span>&nbsp;<span class="builtinfunc" id="8511165">append</span><span class="op" id="8511171">(</span><span class="ident" id="8511172">outcomes</span><span class="op" id="8511180">,</span>&nbsp;<span class="ident" id="8511182">fmt</span><span class="op" id="8511185">.</span><span class="ident" id="8511186">Sprintf</span><span class="op" id="8511193">(</span><span class="string" id="8511194">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="8511202">,</span>&nbsp;<span class="ident" id="8511204">k</span><span class="op" id="8511205">,</span>&nbsp;<span class="ident" id="8511207">v</span><span class="op" id="8511208">)</span><span class="op" id="8511209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8511212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511215">sort</span><span class="op" id="8511219">.</span><span class="ident" id="8511220">Strings</span><span class="op" id="8511227">(</span><span class="ident" id="8511228">outcomes</span><span class="op" id="8511236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511239">got</span>&nbsp;<span class="op" id="8511243">:=</span>&nbsp;<span class="ident" id="8511246">strings</span><span class="op" id="8511253">.</span><span class="ident" id="8511254">Join</span><span class="op" id="8511258">(</span><span class="ident" id="8511259">outcomes</span><span class="op" id="8511267">,</span>&nbsp;<span class="string" id="8511269">&#34;\n&#34;</span><span class="op" id="8511273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511276">want</span>&nbsp;<span class="op" id="8511281">:=</span>&nbsp;<span class="string" id="8511284">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8511569">if</span>&nbsp;<span class="ident" id="8511572">got</span>&nbsp;<span class="op" id="8511576">!=</span>&nbsp;<span class="ident" id="8511579">want</span>&nbsp;<span class="op" id="8511584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8511588">t</span><span class="op" id="8511589">.</span><span class="ident" id="8511590">Errorf</span><span class="op" id="8511596">(</span><span class="string" id="8511597">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="8511618">,</span>&nbsp;<span class="ident" id="8511620">got</span><span class="op" id="8511623">,</span>&nbsp;<span class="ident" id="8511625">want</span><span class="op" id="8511629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8511632">}</span><br>
<span class="lineno"></span><span class="op" id="8511634">}</span>
</div>
</body>
</html>
