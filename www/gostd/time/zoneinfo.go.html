<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2470607">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2470662">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2470716">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2470767">package</span>&nbsp;<span class="ident" id="2470775">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2470781">import</span>&nbsp;<span class="op" id="2470788">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2470791">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2470799">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2470809">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2470812">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2470878">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2470947">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2471022">type</span>&nbsp;<span class="ident" id="2471027">Location</span>&nbsp;<span class="keyword" id="2471036">struct</span>&nbsp;<span class="op" id="2471043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471046">name</span>&nbsp;<span class="builtintype" id="2471051">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471059">zone</span>&nbsp;<span class="op" id="2471064">[</span><span class="op" id="2471065">]</span><span class="ident" id="2471066">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471072">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2471077">[</span><span class="op" id="2471078">]</span><span class="ident" id="2471079">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471091">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471138">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471188">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471240">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471293">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471329">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471362">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471416">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2471469">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471484">cacheStart</span>&nbsp;<span class="ident" id="2471495">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471502">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2471513">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471520">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2471531">*</span><span class="ident" id="2471532">zone</span><br>
<span class="lineno"></span><span class="op" id="2471537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2471540">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2471601">type</span>&nbsp;<span class="ident" id="2471606">zone</span>&nbsp;<span class="keyword" id="2471611">struct</span>&nbsp;<span class="op" id="2471618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471621">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2471628">string</span>&nbsp;<span class="comment" id="2471635">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471663">offset</span>&nbsp;<span class="builtintype" id="2471670">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2471677">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471701">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2471708">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2471715">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2471754">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2471757">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2471814">type</span>&nbsp;<span class="ident" id="2471819">zoneTrans</span>&nbsp;<span class="keyword" id="2471829">struct</span>&nbsp;<span class="op" id="2471836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471839">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471852">int64</span>&nbsp;<span class="comment" id="2471858">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471905">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2471918">uint8</span>&nbsp;<span class="comment" id="2471924">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2471985">isstd</span><span class="op" id="2471990">,</span>&nbsp;<span class="ident" id="2471992">isutc</span>&nbsp;<span class="builtintype" id="2471998">bool</span>&nbsp;&nbsp;<span class="comment" id="2472004">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2472041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2472044">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2472106">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2472122">const</span>&nbsp;<span class="op" id="2472128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2472131">alpha</span>&nbsp;<span class="op" id="2472137">=</span>&nbsp;<span class="op" id="2472139">-</span><span class="num" id="2472140">1</span>&nbsp;<span class="op" id="2472142">&lt;&lt;</span>&nbsp;<span class="num" id="2472145">63</span>&nbsp;&nbsp;<span class="comment" id="2472149">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2472167">omega</span>&nbsp;<span class="op" id="2472173">=</span>&nbsp;<span class="num" id="2472175">1</span><span class="op" id="2472176">&lt;&lt;</span><span class="num" id="2472178">63</span>&nbsp;<span class="op" id="2472181">-</span>&nbsp;<span class="num" id="2472183">1</span>&nbsp;<span class="comment" id="2472185">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2472202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2472205">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2472257">var</span>&nbsp;<span class="ident" id="2472261">UTC</span>&nbsp;<span class="op" id="2472265">*</span><span class="ident" id="2472266">Location</span>&nbsp;<span class="op" id="2472275">=</span>&nbsp;<span class="op" id="2472277">&amp;</span><span class="ident" id="2472278">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2472286">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2472341">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2472394">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2472445">var</span>&nbsp;<span class="ident" id="2472449">utcLoc</span>&nbsp;<span class="op" id="2472456">=</span>&nbsp;<span class="ident" id="2472458">Location</span><span class="op" id="2472466">{</span><span class="ident" id="2472467">name</span><span class="op" id="2472471">:</span>&nbsp;<span class="string" id="2472473">&#34;UTC&#34;</span><span class="op" id="2472478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2472481">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2472531">var</span>&nbsp;<span class="ident" id="2472535">Local</span>&nbsp;<span class="op" id="2472541">*</span><span class="ident" id="2472542">Location</span>&nbsp;<span class="op" id="2472551">=</span>&nbsp;<span class="op" id="2472553">&amp;</span><span class="ident" id="2472554">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2472564">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2472621">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2472663">var</span>&nbsp;<span class="ident" id="2472667">localLoc</span>&nbsp;<span class="ident" id="2472676">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2472685">var</span>&nbsp;<span class="ident" id="2472689">localOnce</span>&nbsp;<span class="ident" id="2472699">sync</span><span class="op" id="2472703">.</span><span class="ident" id="2472704">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2472710">func</span>&nbsp;<span class="op" id="2472715">(</span><span class="ident" id="2472716">l</span>&nbsp;<span class="op" id="2472718">*</span><span class="ident" id="2472719">Location</span><span class="op" id="2472727">)</span>&nbsp;<span class="ident" id="2472729">get</span><span class="op" id="2472732">(</span><span class="op" id="2472733">)</span>&nbsp;<span class="op" id="2472735">*</span><span class="ident" id="2472736">Location</span>&nbsp;<span class="op" id="2472745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2472748">if</span>&nbsp;<span class="ident" id="2472751">l</span>&nbsp;<span class="op" id="2472753">==</span>&nbsp;<span class="ident" id="2472756">nil</span>&nbsp;<span class="op" id="2472760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2472764">return</span>&nbsp;<span class="op" id="2472771">&amp;</span><span class="ident" id="2472772">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2472780">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2472783">if</span>&nbsp;<span class="ident" id="2472786">l</span>&nbsp;<span class="op" id="2472788">==</span>&nbsp;<span class="op" id="2472791">&amp;</span><span class="ident" id="2472792">localLoc</span>&nbsp;<span class="op" id="2472801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2472805">localOnce</span><span class="op" id="2472814">.</span><span class="ident" id="2472815">Do</span><span class="op" id="2472817">(</span><span class="ident" id="2472818">initLocal</span><span class="op" id="2472827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2472830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2472833">return</span>&nbsp;<span class="ident" id="2472840">l</span><br>
<span class="lineno"></span><span class="op" id="2472842">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2472845">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2472913">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2472963">func</span>&nbsp;<span class="op" id="2472968">(</span><span class="ident" id="2472969">l</span>&nbsp;<span class="op" id="2472971">*</span><span class="ident" id="2472972">Location</span><span class="op" id="2472980">)</span>&nbsp;<span class="ident" id="2472982">String</span><span class="op" id="2472988">(</span><span class="op" id="2472989">)</span>&nbsp;<span class="builtintype" id="2472991">string</span>&nbsp;<span class="op" id="2472998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2473001">return</span>&nbsp;<span class="ident" id="2473008">l</span><span class="op" id="2473009">.</span><span class="ident" id="2473010">get</span><span class="op" id="2473013">(</span><span class="op" id="2473014">)</span><span class="op" id="2473015">.</span><span class="ident" id="2473016">name</span><br>
<span class="lineno">85</span><span class="op" id="2473021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2473024">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2473073">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2473130">func</span>&nbsp;<span class="ident" id="2473135">FixedZone</span><span class="op" id="2473144">(</span><span class="ident" id="2473145">name</span>&nbsp;<span class="builtintype" id="2473150">string</span><span class="op" id="2473156">,</span>&nbsp;<span class="ident" id="2473158">offset</span>&nbsp;<span class="builtintype" id="2473165">int</span><span class="op" id="2473168">)</span>&nbsp;<span class="op" id="2473170">*</span><span class="ident" id="2473171">Location</span>&nbsp;<span class="op" id="2473180">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473183">l</span>&nbsp;<span class="op" id="2473185">:=</span>&nbsp;<span class="op" id="2473188">&amp;</span><span class="ident" id="2473189">Location</span><span class="op" id="2473197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473201">name</span><span class="op" id="2473205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473213">name</span><span class="op" id="2473217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473221">zone</span><span class="op" id="2473225">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473233">[</span><span class="op" id="2473234">]</span><span class="ident" id="2473235">zone</span><span class="op" id="2473239">{</span><span class="op" id="2473240">{</span><span class="ident" id="2473241">name</span><span class="op" id="2473245">,</span>&nbsp;<span class="ident" id="2473247">offset</span><span class="op" id="2473253">,</span>&nbsp;<span class="builtintype" id="2473255">false</span><span class="op" id="2473260">}</span><span class="op" id="2473261">}</span><span class="op" id="2473262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473266">tx</span><span class="op" id="2473268">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473278">[</span><span class="op" id="2473279">]</span><span class="ident" id="2473280">zoneTrans</span><span class="op" id="2473289">{</span><span class="op" id="2473290">{</span><span class="ident" id="2473291">alpha</span><span class="op" id="2473296">,</span>&nbsp;<span class="num" id="2473298">0</span><span class="op" id="2473299">,</span>&nbsp;<span class="builtintype" id="2473301">false</span><span class="op" id="2473306">,</span>&nbsp;<span class="builtintype" id="2473308">false</span><span class="op" id="2473313">}</span><span class="op" id="2473314">}</span><span class="op" id="2473315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473319">cacheStart</span><span class="op" id="2473329">:</span>&nbsp;<span class="ident" id="2473331">alpha</span><span class="op" id="2473336">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473340">cacheEnd</span><span class="op" id="2473348">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2473352">omega</span><span class="op" id="2473357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2473360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473363">l</span><span class="op" id="2473364">.</span><span class="ident" id="2473365">cacheZone</span>&nbsp;<span class="op" id="2473375">=</span>&nbsp;<span class="op" id="2473377">&amp;</span><span class="ident" id="2473378">l</span><span class="op" id="2473379">.</span><span class="ident" id="2473380">zone</span><span class="op" id="2473384">[</span><span class="num" id="2473385">0</span><span class="op" id="2473386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2473389">return</span>&nbsp;<span class="ident" id="2473396">l</span><br>
<span class="lineno"></span><span class="op" id="2473398">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2473401">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2473464">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2473540">//</span><br>
<span class="lineno"></span><span class="comment" id="2473543">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2473615">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2473686">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2473755">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2473811">func</span>&nbsp;<span class="op" id="2473816">(</span><span class="ident" id="2473817">l</span>&nbsp;<span class="op" id="2473819">*</span><span class="ident" id="2473820">Location</span><span class="op" id="2473828">)</span>&nbsp;<span class="ident" id="2473830">lookup</span><span class="op" id="2473836">(</span><span class="ident" id="2473837">sec</span>&nbsp;<span class="ident" id="2473841">int64</span><span class="op" id="2473846">)</span>&nbsp;<span class="op" id="2473848">(</span><span class="ident" id="2473849">name</span>&nbsp;<span class="builtintype" id="2473854">string</span><span class="op" id="2473860">,</span>&nbsp;<span class="ident" id="2473862">offset</span>&nbsp;<span class="builtintype" id="2473869">int</span><span class="op" id="2473872">,</span>&nbsp;<span class="ident" id="2473874">isDST</span>&nbsp;<span class="builtintype" id="2473880">bool</span><span class="op" id="2473884">,</span>&nbsp;<span class="ident" id="2473886">start</span><span class="op" id="2473891">,</span>&nbsp;<span class="ident" id="2473893">end</span>&nbsp;<span class="ident" id="2473897">int64</span><span class="op" id="2473902">)</span>&nbsp;<span class="op" id="2473904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473907">l</span>&nbsp;<span class="op" id="2473909">=</span>&nbsp;<span class="ident" id="2473911">l</span><span class="op" id="2473912">.</span><span class="ident" id="2473913">get</span><span class="op" id="2473916">(</span><span class="op" id="2473917">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2473921">if</span>&nbsp;<span class="builtinfunc" id="2473924">len</span><span class="op" id="2473927">(</span><span class="ident" id="2473928">l</span><span class="op" id="2473929">.</span><span class="ident" id="2473930">zone</span><span class="op" id="2473934">)</span>&nbsp;<span class="op" id="2473936">==</span>&nbsp;<span class="num" id="2473939">0</span>&nbsp;<span class="op" id="2473941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473945">name</span>&nbsp;<span class="op" id="2473950">=</span>&nbsp;<span class="string" id="2473952">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473960">offset</span>&nbsp;<span class="op" id="2473967">=</span>&nbsp;<span class="num" id="2473969">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473973">isDST</span>&nbsp;<span class="op" id="2473979">=</span>&nbsp;<span class="builtintype" id="2473981">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2473989">start</span>&nbsp;<span class="op" id="2473995">=</span>&nbsp;<span class="ident" id="2473997">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474005">end</span>&nbsp;<span class="op" id="2474009">=</span>&nbsp;<span class="ident" id="2474011">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474019">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474031">if</span>&nbsp;<span class="ident" id="2474034">zone</span>&nbsp;<span class="op" id="2474039">:=</span>&nbsp;<span class="ident" id="2474042">l</span><span class="op" id="2474043">.</span><span class="ident" id="2474044">cacheZone</span><span class="op" id="2474053">;</span>&nbsp;<span class="ident" id="2474055">zone</span>&nbsp;<span class="op" id="2474060">!=</span>&nbsp;<span class="ident" id="2474063">nil</span>&nbsp;<span class="op" id="2474067">&amp;&amp;</span>&nbsp;<span class="ident" id="2474070">l</span><span class="op" id="2474071">.</span><span class="ident" id="2474072">cacheStart</span>&nbsp;<span class="op" id="2474083">&lt;=</span>&nbsp;<span class="ident" id="2474086">sec</span>&nbsp;<span class="op" id="2474090">&amp;&amp;</span>&nbsp;<span class="ident" id="2474093">sec</span>&nbsp;<span class="op" id="2474097">&lt;</span>&nbsp;<span class="ident" id="2474099">l</span><span class="op" id="2474100">.</span><span class="ident" id="2474101">cacheEnd</span>&nbsp;<span class="op" id="2474110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474114">name</span>&nbsp;<span class="op" id="2474119">=</span>&nbsp;<span class="ident" id="2474121">zone</span><span class="op" id="2474125">.</span><span class="ident" id="2474126">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474133">offset</span>&nbsp;<span class="op" id="2474140">=</span>&nbsp;<span class="ident" id="2474142">zone</span><span class="op" id="2474146">.</span><span class="ident" id="2474147">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474156">isDST</span>&nbsp;<span class="op" id="2474162">=</span>&nbsp;<span class="ident" id="2474164">zone</span><span class="op" id="2474168">.</span><span class="ident" id="2474169">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474177">start</span>&nbsp;<span class="op" id="2474183">=</span>&nbsp;<span class="ident" id="2474185">l</span><span class="op" id="2474186">.</span><span class="ident" id="2474187">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474200">end</span>&nbsp;<span class="op" id="2474204">=</span>&nbsp;<span class="ident" id="2474206">l</span><span class="op" id="2474207">.</span><span class="ident" id="2474208">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474231">if</span>&nbsp;<span class="builtinfunc" id="2474234">len</span><span class="op" id="2474237">(</span><span class="ident" id="2474238">l</span><span class="op" id="2474239">.</span><span class="ident" id="2474240">tx</span><span class="op" id="2474242">)</span>&nbsp;<span class="op" id="2474244">==</span>&nbsp;<span class="num" id="2474247">0</span>&nbsp;<span class="op" id="2474249">||</span>&nbsp;<span class="ident" id="2474252">sec</span>&nbsp;<span class="op" id="2474256">&lt;</span>&nbsp;<span class="ident" id="2474258">l</span><span class="op" id="2474259">.</span><span class="ident" id="2474260">tx</span><span class="op" id="2474262">[</span><span class="num" id="2474263">0</span><span class="op" id="2474264">]</span><span class="op" id="2474265">.</span><span class="ident" id="2474266">when</span>&nbsp;<span class="op" id="2474271">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474275">zone</span>&nbsp;<span class="op" id="2474280">:=</span>&nbsp;<span class="op" id="2474283">&amp;</span><span class="ident" id="2474284">l</span><span class="op" id="2474285">.</span><span class="ident" id="2474286">zone</span><span class="op" id="2474290">[</span><span class="ident" id="2474291">l</span><span class="op" id="2474292">.</span><span class="ident" id="2474293">lookupFirstZone</span><span class="op" id="2474308">(</span><span class="op" id="2474309">)</span><span class="op" id="2474310">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474314">name</span>&nbsp;<span class="op" id="2474319">=</span>&nbsp;<span class="ident" id="2474321">zone</span><span class="op" id="2474325">.</span><span class="ident" id="2474326">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474333">offset</span>&nbsp;<span class="op" id="2474340">=</span>&nbsp;<span class="ident" id="2474342">zone</span><span class="op" id="2474346">.</span><span class="ident" id="2474347">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474356">isDST</span>&nbsp;<span class="op" id="2474362">=</span>&nbsp;<span class="ident" id="2474364">zone</span><span class="op" id="2474368">.</span><span class="ident" id="2474369">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474377">start</span>&nbsp;<span class="op" id="2474383">=</span>&nbsp;<span class="ident" id="2474385">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474393">if</span>&nbsp;<span class="builtinfunc" id="2474396">len</span><span class="op" id="2474399">(</span><span class="ident" id="2474400">l</span><span class="op" id="2474401">.</span><span class="ident" id="2474402">tx</span><span class="op" id="2474404">)</span>&nbsp;<span class="op" id="2474406">&gt;</span>&nbsp;<span class="num" id="2474408">0</span>&nbsp;<span class="op" id="2474410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474415">end</span>&nbsp;<span class="op" id="2474419">=</span>&nbsp;<span class="ident" id="2474421">l</span><span class="op" id="2474422">.</span><span class="ident" id="2474423">tx</span><span class="op" id="2474425">[</span><span class="num" id="2474426">0</span><span class="op" id="2474427">]</span><span class="op" id="2474428">.</span><span class="ident" id="2474429">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474436">}</span>&nbsp;<span class="keyword" id="2474438">else</span>&nbsp;<span class="op" id="2474443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474448">end</span>&nbsp;<span class="op" id="2474452">=</span>&nbsp;<span class="ident" id="2474454">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474462">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474466">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2474478">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2474532">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474581">tx</span>&nbsp;<span class="op" id="2474584">:=</span>&nbsp;<span class="ident" id="2474587">l</span><span class="op" id="2474588">.</span><span class="ident" id="2474589">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474593">end</span>&nbsp;<span class="op" id="2474597">=</span>&nbsp;<span class="ident" id="2474599">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474606">lo</span>&nbsp;<span class="op" id="2474609">:=</span>&nbsp;<span class="num" id="2474612">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474615">hi</span>&nbsp;<span class="op" id="2474618">:=</span>&nbsp;<span class="builtinfunc" id="2474621">len</span><span class="op" id="2474624">(</span><span class="ident" id="2474625">tx</span><span class="op" id="2474627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474630">for</span>&nbsp;<span class="ident" id="2474634">hi</span><span class="op" id="2474636">-</span><span class="ident" id="2474637">lo</span>&nbsp;<span class="op" id="2474640">&gt;</span>&nbsp;<span class="num" id="2474642">1</span>&nbsp;<span class="op" id="2474644">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474648">m</span>&nbsp;<span class="op" id="2474650">:=</span>&nbsp;<span class="ident" id="2474653">lo</span>&nbsp;<span class="op" id="2474656">+</span>&nbsp;<span class="op" id="2474658">(</span><span class="ident" id="2474659">hi</span><span class="op" id="2474661">-</span><span class="ident" id="2474662">lo</span><span class="op" id="2474664">)</span><span class="op" id="2474665">/</span><span class="num" id="2474666">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474670">lim</span>&nbsp;<span class="op" id="2474674">:=</span>&nbsp;<span class="ident" id="2474677">tx</span><span class="op" id="2474679">[</span><span class="ident" id="2474680">m</span><span class="op" id="2474681">]</span><span class="op" id="2474682">.</span><span class="ident" id="2474683">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474690">if</span>&nbsp;<span class="ident" id="2474693">sec</span>&nbsp;<span class="op" id="2474697">&lt;</span>&nbsp;<span class="ident" id="2474699">lim</span>&nbsp;<span class="op" id="2474703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474708">end</span>&nbsp;<span class="op" id="2474712">=</span>&nbsp;<span class="ident" id="2474714">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474721">hi</span>&nbsp;<span class="op" id="2474724">=</span>&nbsp;<span class="ident" id="2474726">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474730">}</span>&nbsp;<span class="keyword" id="2474732">else</span>&nbsp;<span class="op" id="2474737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474742">lo</span>&nbsp;<span class="op" id="2474745">=</span>&nbsp;<span class="ident" id="2474747">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2474754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474757">zone</span>&nbsp;<span class="op" id="2474762">:=</span>&nbsp;<span class="op" id="2474765">&amp;</span><span class="ident" id="2474766">l</span><span class="op" id="2474767">.</span><span class="ident" id="2474768">zone</span><span class="op" id="2474772">[</span><span class="ident" id="2474773">tx</span><span class="op" id="2474775">[</span><span class="ident" id="2474776">lo</span><span class="op" id="2474778">]</span><span class="op" id="2474779">.</span><span class="ident" id="2474780">index</span><span class="op" id="2474785">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474788">name</span>&nbsp;<span class="op" id="2474793">=</span>&nbsp;<span class="ident" id="2474795">zone</span><span class="op" id="2474799">.</span><span class="ident" id="2474800">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474806">offset</span>&nbsp;<span class="op" id="2474813">=</span>&nbsp;<span class="ident" id="2474815">zone</span><span class="op" id="2474819">.</span><span class="ident" id="2474820">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474828">isDST</span>&nbsp;<span class="op" id="2474834">=</span>&nbsp;<span class="ident" id="2474836">zone</span><span class="op" id="2474840">.</span><span class="ident" id="2474841">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2474848">start</span>&nbsp;<span class="op" id="2474854">=</span>&nbsp;<span class="ident" id="2474856">tx</span><span class="op" id="2474858">[</span><span class="ident" id="2474859">lo</span><span class="op" id="2474861">]</span><span class="op" id="2474862">.</span><span class="ident" id="2474863">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2474869">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2474908">return</span><br>
<span class="lineno"></span><span class="op" id="2474915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2474918">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2474989">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2475058">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2475068">//</span><br>
<span class="lineno"></span><span class="comment" id="2475071">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2475123">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2475196">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2475251">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2475313">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2475375">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2475438">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2475510">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2475522">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2475588">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2475608">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2475645">func</span>&nbsp;<span class="op" id="2475650">(</span><span class="ident" id="2475651">l</span>&nbsp;<span class="op" id="2475653">*</span><span class="ident" id="2475654">Location</span><span class="op" id="2475662">)</span>&nbsp;<span class="ident" id="2475664">lookupFirstZone</span><span class="op" id="2475679">(</span><span class="op" id="2475680">)</span>&nbsp;<span class="builtintype" id="2475682">int</span>&nbsp;<span class="op" id="2475686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2475689">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475701">if</span>&nbsp;<span class="op" id="2475704">!</span><span class="ident" id="2475705">l</span><span class="op" id="2475706">.</span><span class="ident" id="2475707">firstZoneUsed</span><span class="op" id="2475720">(</span><span class="op" id="2475721">)</span>&nbsp;<span class="op" id="2475723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475727">return</span>&nbsp;<span class="num" id="2475734">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2475741">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475753">if</span>&nbsp;<span class="builtinfunc" id="2475756">len</span><span class="op" id="2475759">(</span><span class="ident" id="2475760">l</span><span class="op" id="2475761">.</span><span class="ident" id="2475762">tx</span><span class="op" id="2475764">)</span>&nbsp;<span class="op" id="2475766">&gt;</span>&nbsp;<span class="num" id="2475768">0</span>&nbsp;<span class="op" id="2475770">&amp;&amp;</span>&nbsp;<span class="ident" id="2475773">l</span><span class="op" id="2475774">.</span><span class="ident" id="2475775">zone</span><span class="op" id="2475779">[</span><span class="ident" id="2475780">l</span><span class="op" id="2475781">.</span><span class="ident" id="2475782">tx</span><span class="op" id="2475784">[</span><span class="num" id="2475785">0</span><span class="op" id="2475786">]</span><span class="op" id="2475787">.</span><span class="ident" id="2475788">index</span><span class="op" id="2475793">]</span><span class="op" id="2475794">.</span><span class="ident" id="2475795">isDST</span>&nbsp;<span class="op" id="2475801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475805">for</span>&nbsp;<span class="ident" id="2475809">zi</span>&nbsp;<span class="op" id="2475812">:=</span>&nbsp;<span class="builtintype" id="2475815">int</span><span class="op" id="2475818">(</span><span class="ident" id="2475819">l</span><span class="op" id="2475820">.</span><span class="ident" id="2475821">tx</span><span class="op" id="2475823">[</span><span class="num" id="2475824">0</span><span class="op" id="2475825">]</span><span class="op" id="2475826">.</span><span class="ident" id="2475827">index</span><span class="op" id="2475832">)</span>&nbsp;<span class="op" id="2475834">-</span>&nbsp;<span class="num" id="2475836">1</span><span class="op" id="2475837">;</span>&nbsp;<span class="ident" id="2475839">zi</span>&nbsp;<span class="op" id="2475842">&gt;=</span>&nbsp;<span class="num" id="2475845">0</span><span class="op" id="2475846">;</span>&nbsp;<span class="ident" id="2475848">zi</span><span class="op" id="2475850">--</span>&nbsp;<span class="op" id="2475853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475858">if</span>&nbsp;<span class="op" id="2475861">!</span><span class="ident" id="2475862">l</span><span class="op" id="2475863">.</span><span class="ident" id="2475864">zone</span><span class="op" id="2475868">[</span><span class="ident" id="2475869">zi</span><span class="op" id="2475871">]</span><span class="op" id="2475872">.</span><span class="ident" id="2475873">isDST</span>&nbsp;<span class="op" id="2475879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475885">return</span>&nbsp;<span class="ident" id="2475892">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475898">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2475909">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475921">for</span>&nbsp;<span class="ident" id="2475925">zi</span>&nbsp;<span class="op" id="2475928">:=</span>&nbsp;<span class="keyword" id="2475931">range</span>&nbsp;<span class="ident" id="2475937">l</span><span class="op" id="2475938">.</span><span class="ident" id="2475939">zone</span>&nbsp;<span class="op" id="2475944">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475948">if</span>&nbsp;<span class="op" id="2475951">!</span><span class="ident" id="2475952">l</span><span class="op" id="2475953">.</span><span class="ident" id="2475954">zone</span><span class="op" id="2475958">[</span><span class="ident" id="2475959">zi</span><span class="op" id="2475961">]</span><span class="op" id="2475962">.</span><span class="ident" id="2475963">isDST</span>&nbsp;<span class="op" id="2475969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2475974">return</span>&nbsp;<span class="ident" id="2475981">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2475989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2475993">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476005">return</span>&nbsp;<span class="num" id="2476012">0</span><br>
<span class="lineno"></span><span class="op" id="2476014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2476017">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2476081">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2476096">func</span>&nbsp;<span class="op" id="2476101">(</span><span class="ident" id="2476102">l</span>&nbsp;<span class="op" id="2476104">*</span><span class="ident" id="2476105">Location</span><span class="op" id="2476113">)</span>&nbsp;<span class="ident" id="2476115">firstZoneUsed</span><span class="op" id="2476128">(</span><span class="op" id="2476129">)</span>&nbsp;<span class="builtintype" id="2476131">bool</span>&nbsp;<span class="op" id="2476136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476139">for</span>&nbsp;<span class="ident" id="2476143">_</span><span class="op" id="2476144">,</span>&nbsp;<span class="ident" id="2476146">tx</span>&nbsp;<span class="op" id="2476149">:=</span>&nbsp;<span class="keyword" id="2476152">range</span>&nbsp;<span class="ident" id="2476158">l</span><span class="op" id="2476159">.</span><span class="ident" id="2476160">tx</span>&nbsp;<span class="op" id="2476163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476167">if</span>&nbsp;<span class="ident" id="2476170">tx</span><span class="op" id="2476172">.</span><span class="ident" id="2476173">index</span>&nbsp;<span class="op" id="2476179">==</span>&nbsp;<span class="num" id="2476182">0</span>&nbsp;<span class="op" id="2476184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476189">return</span>&nbsp;<span class="builtintype" id="2476196">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2476203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2476206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476209">return</span>&nbsp;<span class="builtintype" id="2476216">false</span><br>
<span class="lineno"></span><span class="op" id="2476222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2476225">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2476284">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2476348">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2476397">func</span>&nbsp;<span class="op" id="2476402">(</span><span class="ident" id="2476403">l</span>&nbsp;<span class="op" id="2476405">*</span><span class="ident" id="2476406">Location</span><span class="op" id="2476414">)</span>&nbsp;<span class="ident" id="2476416">lookupName</span><span class="op" id="2476426">(</span><span class="ident" id="2476427">name</span>&nbsp;<span class="builtintype" id="2476432">string</span><span class="op" id="2476438">,</span>&nbsp;<span class="ident" id="2476440">unix</span>&nbsp;<span class="ident" id="2476445">int64</span><span class="op" id="2476450">)</span>&nbsp;<span class="op" id="2476452">(</span><span class="ident" id="2476453">offset</span>&nbsp;<span class="builtintype" id="2476460">int</span><span class="op" id="2476463">,</span>&nbsp;<span class="ident" id="2476465">isDST</span>&nbsp;<span class="builtintype" id="2476471">bool</span><span class="op" id="2476475">,</span>&nbsp;<span class="ident" id="2476477">ok</span>&nbsp;<span class="builtintype" id="2476480">bool</span><span class="op" id="2476484">)</span>&nbsp;<span class="op" id="2476486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2476489">l</span>&nbsp;<span class="op" id="2476491">=</span>&nbsp;<span class="ident" id="2476493">l</span><span class="op" id="2476494">.</span><span class="ident" id="2476495">get</span><span class="op" id="2476498">(</span><span class="op" id="2476499">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476503">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476566">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476636">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476699">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476758">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2476825">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476842">for</span>&nbsp;<span class="ident" id="2476846">i</span>&nbsp;<span class="op" id="2476848">:=</span>&nbsp;<span class="keyword" id="2476851">range</span>&nbsp;<span class="ident" id="2476857">l</span><span class="op" id="2476858">.</span><span class="ident" id="2476859">zone</span>&nbsp;<span class="op" id="2476864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2476868">zone</span>&nbsp;<span class="op" id="2476873">:=</span>&nbsp;<span class="op" id="2476876">&amp;</span><span class="ident" id="2476877">l</span><span class="op" id="2476878">.</span><span class="ident" id="2476879">zone</span><span class="op" id="2476883">[</span><span class="ident" id="2476884">i</span><span class="op" id="2476885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476889">if</span>&nbsp;<span class="ident" id="2476892">zone</span><span class="op" id="2476896">.</span><span class="ident" id="2476897">name</span>&nbsp;<span class="op" id="2476902">==</span>&nbsp;<span class="ident" id="2476905">name</span>&nbsp;<span class="op" id="2476910">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2476915">nam</span><span class="op" id="2476918">,</span>&nbsp;<span class="ident" id="2476920">offset</span><span class="op" id="2476926">,</span>&nbsp;<span class="ident" id="2476928">isDST</span><span class="op" id="2476933">,</span>&nbsp;<span class="ident" id="2476935">_</span><span class="op" id="2476936">,</span>&nbsp;<span class="ident" id="2476938">_</span>&nbsp;<span class="op" id="2476940">:=</span>&nbsp;<span class="ident" id="2476943">l</span><span class="op" id="2476944">.</span><span class="ident" id="2476945">lookup</span><span class="op" id="2476951">(</span><span class="ident" id="2476952">unix</span>&nbsp;<span class="op" id="2476957">-</span>&nbsp;<span class="ident" id="2476959">int64</span><span class="op" id="2476964">(</span><span class="ident" id="2476965">zone</span><span class="op" id="2476969">.</span><span class="ident" id="2476970">offset</span><span class="op" id="2476976">)</span><span class="op" id="2476977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2476982">if</span>&nbsp;<span class="ident" id="2476985">nam</span>&nbsp;<span class="op" id="2476989">==</span>&nbsp;<span class="ident" id="2476992">zone</span><span class="op" id="2476996">.</span><span class="ident" id="2476997">name</span>&nbsp;<span class="op" id="2477002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2477008">return</span>&nbsp;<span class="ident" id="2477015">offset</span><span class="op" id="2477021">,</span>&nbsp;<span class="ident" id="2477023">isDST</span><span class="op" id="2477028">,</span>&nbsp;<span class="builtintype" id="2477030">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2477038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2477042">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2477045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2477049">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2477100">for</span>&nbsp;<span class="ident" id="2477104">i</span>&nbsp;<span class="op" id="2477106">:=</span>&nbsp;<span class="keyword" id="2477109">range</span>&nbsp;<span class="ident" id="2477115">l</span><span class="op" id="2477116">.</span><span class="ident" id="2477117">zone</span>&nbsp;<span class="op" id="2477122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2477126">zone</span>&nbsp;<span class="op" id="2477131">:=</span>&nbsp;<span class="op" id="2477134">&amp;</span><span class="ident" id="2477135">l</span><span class="op" id="2477136">.</span><span class="ident" id="2477137">zone</span><span class="op" id="2477141">[</span><span class="ident" id="2477142">i</span><span class="op" id="2477143">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2477147">if</span>&nbsp;<span class="ident" id="2477150">zone</span><span class="op" id="2477154">.</span><span class="ident" id="2477155">name</span>&nbsp;<span class="op" id="2477160">==</span>&nbsp;<span class="ident" id="2477163">name</span>&nbsp;<span class="op" id="2477168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2477173">return</span>&nbsp;<span class="ident" id="2477180">zone</span><span class="op" id="2477184">.</span><span class="ident" id="2477185">offset</span><span class="op" id="2477191">,</span>&nbsp;<span class="ident" id="2477193">zone</span><span class="op" id="2477197">.</span><span class="ident" id="2477198">isDST</span><span class="op" id="2477203">,</span>&nbsp;<span class="builtintype" id="2477205">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2477212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2477215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2477219">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2477243">return</span><br>
<span class="lineno"></span><span class="op" id="2477250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2477253">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2477326">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2477387">var</span>&nbsp;<span class="ident" id="2477391">zoneinfo</span><span class="op" id="2477399">,</span>&nbsp;<span class="ident" id="2477401">_</span>&nbsp;<span class="op" id="2477403">=</span>&nbsp;<span class="ident" id="2477405">syscall</span><span class="op" id="2477412">.</span><span class="ident" id="2477413">Getenv</span><span class="op" id="2477419">(</span><span class="string" id="2477420">&#34;ZONEINFO&#34;</span><span class="op" id="2477430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2477433">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2477491">//</span><br>
<span class="lineno"></span><span class="comment" id="2477494">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2477551">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2477606">//</span><br>
<span class="lineno"></span><span class="comment" id="2477609">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2477687">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2477750">//</span><br>
<span class="lineno"></span><span class="comment" id="2477753">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2477813">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2477869">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2477933">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2478002">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2478051">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2478106">func</span>&nbsp;<span class="ident" id="2478111">LoadLocation</span><span class="op" id="2478123">(</span><span class="ident" id="2478124">name</span>&nbsp;<span class="builtintype" id="2478129">string</span><span class="op" id="2478135">)</span>&nbsp;<span class="op" id="2478137">(</span><span class="op" id="2478138">*</span><span class="ident" id="2478139">Location</span><span class="op" id="2478147">,</span>&nbsp;<span class="builtintype" id="2478149">error</span><span class="op" id="2478154">)</span>&nbsp;<span class="op" id="2478156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478159">if</span>&nbsp;<span class="ident" id="2478162">name</span>&nbsp;<span class="op" id="2478167">==</span>&nbsp;<span class="string" id="2478170">&#34;&#34;</span>&nbsp;<span class="op" id="2478173">||</span>&nbsp;<span class="ident" id="2478176">name</span>&nbsp;<span class="op" id="2478181">==</span>&nbsp;<span class="string" id="2478184">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2478190">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478194">return</span>&nbsp;<span class="ident" id="2478201">UTC</span><span class="op" id="2478204">,</span>&nbsp;<span class="ident" id="2478206">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2478211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478214">if</span>&nbsp;<span class="ident" id="2478217">name</span>&nbsp;<span class="op" id="2478222">==</span>&nbsp;<span class="string" id="2478225">&#34;Local&#34;</span>&nbsp;<span class="op" id="2478233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478237">return</span>&nbsp;<span class="ident" id="2478244">Local</span><span class="op" id="2478249">,</span>&nbsp;<span class="ident" id="2478251">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2478256">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478259">if</span>&nbsp;<span class="ident" id="2478262">zoneinfo</span>&nbsp;<span class="op" id="2478271">!=</span>&nbsp;<span class="string" id="2478274">&#34;&#34;</span>&nbsp;<span class="op" id="2478277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478281">if</span>&nbsp;<span class="ident" id="2478284">z</span><span class="op" id="2478285">,</span>&nbsp;<span class="ident" id="2478287">err</span>&nbsp;<span class="op" id="2478291">:=</span>&nbsp;<span class="ident" id="2478294">loadZoneFile</span><span class="op" id="2478306">(</span><span class="ident" id="2478307">zoneinfo</span><span class="op" id="2478315">,</span>&nbsp;<span class="ident" id="2478317">name</span><span class="op" id="2478321">)</span><span class="op" id="2478322">;</span>&nbsp;<span class="ident" id="2478324">err</span>&nbsp;<span class="op" id="2478328">==</span>&nbsp;<span class="ident" id="2478331">nil</span>&nbsp;<span class="op" id="2478335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2478340">z</span><span class="op" id="2478341">.</span><span class="ident" id="2478342">name</span>&nbsp;<span class="op" id="2478347">=</span>&nbsp;<span class="ident" id="2478349">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478357">return</span>&nbsp;<span class="ident" id="2478364">z</span><span class="op" id="2478365">,</span>&nbsp;<span class="ident" id="2478367">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2478373">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2478376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2478379">return</span>&nbsp;<span class="ident" id="2478386">loadLocation</span><span class="op" id="2478398">(</span><span class="ident" id="2478399">name</span><span class="op" id="2478403">)</span><br>
<span class="lineno"></span><span class="op" id="2478405">}</span>
</div>
</body>
</html>
