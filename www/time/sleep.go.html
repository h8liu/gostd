<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2326955">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2327010">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2327064">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2327115">package</span>&nbsp;<span class="ident" id="2327123">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2327129">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2327196">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2327263">func</span>&nbsp;<span class="ident" id="2327268">Sleep</span><span class="op" id="2327273">(</span><span class="ident" id="2327274">d</span>&nbsp;<span class="ident" id="2327276"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2327284">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2327287">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2327365">func</span>&nbsp;<span class="ident" id="2327370">runtimeNano</span><span class="op" id="2327381">(</span><span class="op" id="2327382">)</span>&nbsp;<span class="ident" id="2327384">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2327391">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2327446">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2327507">type</span>&nbsp;<span class="ident" id="2327512">runtimeTimer</span>&nbsp;<span class="keyword" id="2327525">struct</span>&nbsp;<span class="op" id="2327532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327535">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2327542">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327547">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2327554">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327561">period</span>&nbsp;<span class="ident" id="2327568">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327575">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2327582">func</span><span class="op" id="2327586">(</span><span class="keyword" id="2327587">interface</span><span class="op" id="2327596">{</span><span class="op" id="2327597">}</span><span class="op" id="2327598">,</span>&nbsp;<span class="builtintype" id="2327600">uintptr</span><span class="op" id="2327607">)</span>&nbsp;<span class="comment" id="2327609">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327639">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2327646">interface</span><span class="op" id="2327655">{</span><span class="op" id="2327656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2327659">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2327666">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2327674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2327677">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2327754">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2327833">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2327911">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2327965">func</span>&nbsp;<span class="ident" id="2327970">when</span><span class="op" id="2327974">(</span><span class="ident" id="2327975">d</span>&nbsp;<span class="ident" id="2327977"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2327985">)</span>&nbsp;<span class="ident" id="2327987">int64</span>&nbsp;<span class="op" id="2327993">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2327996">if</span>&nbsp;<span class="ident" id="2327999"><a href="/time/sleep.go.html#2327975">d</a></span>&nbsp;<span class="op" id="2328001">&lt;=</span>&nbsp;<span class="num" id="2328004">0</span>&nbsp;<span class="op" id="2328006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328010">return</span>&nbsp;<span class="ident" id="2328017"><a href="/time/sleep.go.html#2327370">runtimeNano</a></span><span class="op" id="2328028">(</span><span class="op" id="2328029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328035">t</span>&nbsp;<span class="op" id="2328037">:=</span>&nbsp;<span class="ident" id="2328040"><a href="/time/sleep.go.html#2327370">runtimeNano</a></span><span class="op" id="2328051">(</span><span class="op" id="2328052">)</span>&nbsp;<span class="op" id="2328054">+</span>&nbsp;<span class="ident" id="2328056">int64</span><span class="op" id="2328061">(</span><span class="ident" id="2328062"><a href="/time/sleep.go.html#2327975">d</a></span><span class="op" id="2328063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328066">if</span>&nbsp;<span class="ident" id="2328069"><a href="/time/sleep.go.html#2328035">t</a></span>&nbsp;<span class="op" id="2328071">&lt;</span>&nbsp;<span class="num" id="2328073">0</span>&nbsp;<span class="op" id="2328075">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328079"><a href="/time/sleep.go.html#2328035">t</a></span>&nbsp;<span class="op" id="2328081">=</span>&nbsp;<span class="num" id="2328083">1</span><span class="op" id="2328084">&lt;&lt;</span><span class="num" id="2328086">63</span>&nbsp;<span class="op" id="2328089">-</span>&nbsp;<span class="num" id="2328091">1</span>&nbsp;<span class="comment" id="2328093">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328114">return</span>&nbsp;<span class="ident" id="2328121"><a href="/time/sleep.go.html#2328035">t</a></span><br>
<span class="lineno"></span><span class="op" id="2328123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2328126">func</span>&nbsp;<span class="ident" id="2328131">startTimer</span><span class="op" id="2328141">(</span><span class="op" id="2328142">*</span><span class="ident" id="2328143"><a href="/time/sleep.go.html#2327512">runtimeTimer</a></span><span class="op" id="2328155">)</span><br>
<span class="lineno"></span><span class="keyword" id="2328157">func</span>&nbsp;<span class="ident" id="2328162">stopTimer</span><span class="op" id="2328171">(</span><span class="op" id="2328172">*</span><span class="ident" id="2328173"><a href="/time/sleep.go.html#2327512">runtimeTimer</a></span><span class="op" id="2328185">)</span>&nbsp;<span class="builtintype" id="2328187">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2328193">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2328238">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2328301">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2328347">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2328402">type</span>&nbsp;<span class="ident" id="2328407">Timer</span>&nbsp;<span class="keyword" id="2328413">struct</span>&nbsp;<span class="op" id="2328420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328423">C</span>&nbsp;<span class="op" id="2328425">&lt;-</span><span class="keyword" id="2328427">chan</span>&nbsp;<span class="ident" id="2328432"><a href="/time/time.go.html#2335415">Time</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328438">r</span>&nbsp;<span class="ident" id="2328440"><a href="/time/sleep.go.html#2327512">runtimeTimer</a></span><br>
<span class="lineno">50</span><span class="op" id="2328453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2328456">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2328496">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2328575">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2328603">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2328685">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2328701">func</span>&nbsp;<span class="op" id="2328706">(</span><span class="ident" id="2328707">t</span>&nbsp;<span class="op" id="2328709">*</span><span class="ident" id="2328710"><a href="/time/sleep.go.html#2328407">Timer</a></span><span class="op" id="2328715">)</span>&nbsp;<span class="ident" id="2328717">Stop</span><span class="op" id="2328721">(</span><span class="op" id="2328722">)</span>&nbsp;<span class="builtintype" id="2328724">bool</span>&nbsp;<span class="op" id="2328729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328732">if</span>&nbsp;<span class="ident" id="2328735"><a href="/time/sleep.go.html#2328707">t</a></span><span class="op" id="2328736">.</span><span class="ident" id="2328737">r</span><span class="op" id="2328738">.</span><span class="ident" id="2328739">f</span>&nbsp;<span class="op" id="2328741">==</span>&nbsp;<span class="ident" id="2328744">nil</span>&nbsp;<span class="op" id="2328748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2328752">panic</span><span class="op" id="2328757">(</span><span class="string" id="2328758">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2328800">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2328803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2328806">return</span>&nbsp;<span class="ident" id="2328813"><a href="/time/sleep.go.html#2328162">stopTimer</a></span><span class="op" id="2328822">(</span><span class="op" id="2328823">&amp;</span><span class="ident" id="2328824"><a href="/time/sleep.go.html#2328707">t</a></span><span class="op" id="2328825">.</span><span class="ident" id="2328826">r</span><span class="op" id="2328827">)</span><br>
<span class="lineno"></span><span class="op" id="2328829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2328832">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2328879">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2328941">func</span>&nbsp;<span class="ident" id="2328946">NewTimer</span><span class="op" id="2328954">(</span><span class="ident" id="2328955">d</span>&nbsp;<span class="ident" id="2328957"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2328965">)</span>&nbsp;<span class="op" id="2328967">*</span><span class="ident" id="2328968"><a href="/time/sleep.go.html#2328407">Timer</a></span>&nbsp;<span class="op" id="2328974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2328977">c</span>&nbsp;<span class="op" id="2328979">:=</span>&nbsp;<span class="builtinfunc" id="2328982">make</span><span class="op" id="2328986">(</span><span class="keyword" id="2328987">chan</span>&nbsp;<span class="ident" id="2328992"><a href="/time/time.go.html#2335415">Time</a></span><span class="op" id="2328996">,</span>&nbsp;<span class="num" id="2328998">1</span><span class="op" id="2328999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329002">t</span>&nbsp;<span class="op" id="2329004">:=</span>&nbsp;<span class="op" id="2329007">&amp;</span><span class="ident" id="2329008"><a href="/time/sleep.go.html#2328407">Timer</a></span><span class="op" id="2329013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329017">C</span><span class="op" id="2329018">:</span>&nbsp;<span class="ident" id="2329020"><a href="/time/sleep.go.html#2328977">c</a></span><span class="op" id="2329021">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329025">r</span><span class="op" id="2329026">:</span>&nbsp;<span class="ident" id="2329028"><a href="/time/sleep.go.html#2327512">runtimeTimer</a></span><span class="op" id="2329040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329045">when</span><span class="op" id="2329049">:</span>&nbsp;<span class="ident" id="2329051"><a href="/time/sleep.go.html#2327970">when</a></span><span class="op" id="2329055">(</span><span class="ident" id="2329056"><a href="/time/sleep.go.html#2328955">d</a></span><span class="op" id="2329057">)</span><span class="op" id="2329058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329063">f</span><span class="op" id="2329064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2329069"><a href="/time/sleep.go.html#2329497">sendTime</a></span><span class="op" id="2329077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329082">arg</span><span class="op" id="2329085">:</span>&nbsp;&nbsp;<span class="ident" id="2329088"><a href="/time/sleep.go.html#2328977">c</a></span><span class="op" id="2329089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329093">}</span><span class="op" id="2329094">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329100"><a href="/time/sleep.go.html#2328131">startTimer</a></span><span class="op" id="2329110">(</span><span class="op" id="2329111">&amp;</span><span class="ident" id="2329112"><a href="/time/sleep.go.html#2329002">t</a></span><span class="op" id="2329113">.</span><span class="ident" id="2329114">r</span><span class="op" id="2329115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329118">return</span>&nbsp;<span class="ident" id="2329125"><a href="/time/sleep.go.html#2329002">t</a></span><br>
<span class="lineno"></span><span class="op" id="2329127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2329130">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2329185">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2329257">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2329285">func</span>&nbsp;<span class="op" id="2329290">(</span><span class="ident" id="2329291">t</span>&nbsp;<span class="op" id="2329293">*</span><span class="ident" id="2329294"><a href="/time/sleep.go.html#2328407">Timer</a></span><span class="op" id="2329299">)</span>&nbsp;<span class="ident" id="2329301">Reset</span><span class="op" id="2329306">(</span><span class="ident" id="2329307">d</span>&nbsp;<span class="ident" id="2329309"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2329317">)</span>&nbsp;<span class="builtintype" id="2329319">bool</span>&nbsp;<span class="op" id="2329324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329327">if</span>&nbsp;<span class="ident" id="2329330"><a href="/time/sleep.go.html#2329291">t</a></span><span class="op" id="2329331">.</span><span class="ident" id="2329332">r</span><span class="op" id="2329333">.</span><span class="ident" id="2329334">f</span>&nbsp;<span class="op" id="2329336">==</span>&nbsp;<span class="ident" id="2329339">nil</span>&nbsp;<span class="op" id="2329343">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2329347">panic</span><span class="op" id="2329352">(</span><span class="string" id="2329353">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2329396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329402">w</span>&nbsp;<span class="op" id="2329404">:=</span>&nbsp;<span class="ident" id="2329407"><a href="/time/sleep.go.html#2327970">when</a></span><span class="op" id="2329411">(</span><span class="ident" id="2329412"><a href="/time/sleep.go.html#2329307">d</a></span><span class="op" id="2329413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329416">active</span>&nbsp;<span class="op" id="2329423">:=</span>&nbsp;<span class="ident" id="2329426"><a href="/time/sleep.go.html#2328162">stopTimer</a></span><span class="op" id="2329435">(</span><span class="op" id="2329436">&amp;</span><span class="ident" id="2329437"><a href="/time/sleep.go.html#2329291">t</a></span><span class="op" id="2329438">.</span><span class="ident" id="2329439">r</span><span class="op" id="2329440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329443"><a href="/time/sleep.go.html#2329291">t</a></span><span class="op" id="2329444">.</span><span class="ident" id="2329445">r</span><span class="op" id="2329446">.</span><span class="ident" id="2329447">when</span>&nbsp;<span class="op" id="2329452">=</span>&nbsp;<span class="ident" id="2329454"><a href="/time/sleep.go.html#2329402">w</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2329457"><a href="/time/sleep.go.html#2328131">startTimer</a></span><span class="op" id="2329467">(</span><span class="op" id="2329468">&amp;</span><span class="ident" id="2329469"><a href="/time/sleep.go.html#2329291">t</a></span><span class="op" id="2329470">.</span><span class="ident" id="2329471">r</span><span class="op" id="2329472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329475">return</span>&nbsp;<span class="ident" id="2329482"><a href="/time/sleep.go.html#2329416">active</a></span><br>
<span class="lineno"></span><span class="op" id="2329489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2329492">func</span>&nbsp;<span class="ident" id="2329497">sendTime</span><span class="op" id="2329505">(</span><span class="ident" id="2329506">c</span>&nbsp;<span class="keyword" id="2329508">interface</span><span class="op" id="2329517">{</span><span class="op" id="2329518">}</span><span class="op" id="2329519">,</span>&nbsp;<span class="ident" id="2329521">seq</span>&nbsp;<span class="builtintype" id="2329525">uintptr</span><span class="op" id="2329532">)</span>&nbsp;<span class="op" id="2329534">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329537">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329573">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329628">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329682">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2329736">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329772">select</span>&nbsp;<span class="op" id="2329779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329782">case</span>&nbsp;<span class="ident" id="2329787"><a href="/time/sleep.go.html#2329506">c</a></span><span class="op" id="2329788">.</span><span class="op" id="2329789">(</span><span class="keyword" id="2329790">chan</span>&nbsp;<span class="ident" id="2329795"><a href="/time/time.go.html#2335415">Time</a></span><span class="op" id="2329799">)</span>&nbsp;<span class="op" id="2329801">&lt;-</span>&nbsp;<span class="ident" id="2329804"><a href="/time/time.go.html#2356416">Now</a></span><span class="op" id="2329807">(</span><span class="op" id="2329808">)</span><span class="op" id="2329809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2329812">default</span><span class="op" id="2329819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2329822">}</span><br>
<span class="lineno"></span><span class="op" id="2329824">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2329827">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2329901">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2329929">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2329967">func</span>&nbsp;<span class="ident" id="2329972">After</span><span class="op" id="2329977">(</span><span class="ident" id="2329978">d</span>&nbsp;<span class="ident" id="2329980"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2329988">)</span>&nbsp;<span class="op" id="2329990">&lt;-</span><span class="keyword" id="2329992">chan</span>&nbsp;<span class="ident" id="2329997"><a href="/time/time.go.html#2335415">Time</a></span>&nbsp;<span class="op" id="2330002">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2330005">return</span>&nbsp;<span class="ident" id="2330012"><a href="/time/sleep.go.html#2328946">NewTimer</a></span><span class="op" id="2330020">(</span><span class="ident" id="2330021"><a href="/time/sleep.go.html#2329978">d</a></span><span class="op" id="2330022">)</span><span class="op" id="2330023">.</span><span class="ident" id="2330024">C</span><br>
<span class="lineno"></span><span class="op" id="2330026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2330029">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2330092">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2330145">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2330198">func</span>&nbsp;<span class="ident" id="2330203">AfterFunc</span><span class="op" id="2330212">(</span><span class="ident" id="2330213">d</span>&nbsp;<span class="ident" id="2330215"><a href="/time/time.go.html#2347540">Duration</a></span><span class="op" id="2330223">,</span>&nbsp;<span class="ident" id="2330225">f</span>&nbsp;<span class="keyword" id="2330227">func</span><span class="op" id="2330231">(</span><span class="op" id="2330232">)</span><span class="op" id="2330233">)</span>&nbsp;<span class="op" id="2330235">*</span><span class="ident" id="2330236"><a href="/time/sleep.go.html#2328407">Timer</a></span>&nbsp;<span class="op" id="2330242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330245">t</span>&nbsp;<span class="op" id="2330247">:=</span>&nbsp;<span class="op" id="2330250">&amp;</span><span class="ident" id="2330251"><a href="/time/sleep.go.html#2328407">Timer</a></span><span class="op" id="2330256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330260">r</span><span class="op" id="2330261">:</span>&nbsp;<span class="ident" id="2330263"><a href="/time/sleep.go.html#2327512">runtimeTimer</a></span><span class="op" id="2330275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330280">when</span><span class="op" id="2330284">:</span>&nbsp;<span class="ident" id="2330286"><a href="/time/sleep.go.html#2327970">when</a></span><span class="op" id="2330290">(</span><span class="ident" id="2330291"><a href="/time/sleep.go.html#2330213">d</a></span><span class="op" id="2330292">)</span><span class="op" id="2330293">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330298">f</span><span class="op" id="2330299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330304"><a href="/time/sleep.go.html#2330368">goFunc</a></span><span class="op" id="2330310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330315">arg</span><span class="op" id="2330318">:</span>&nbsp;&nbsp;<span class="ident" id="2330321"><a href="/time/sleep.go.html#2330225">f</a></span><span class="op" id="2330322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2330326">}</span><span class="op" id="2330327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2330330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2330333"><a href="/time/sleep.go.html#2328131">startTimer</a></span><span class="op" id="2330343">(</span><span class="op" id="2330344">&amp;</span><span class="ident" id="2330345"><a href="/time/sleep.go.html#2330245">t</a></span><span class="op" id="2330346">.</span><span class="ident" id="2330347">r</span><span class="op" id="2330348">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2330351">return</span>&nbsp;<span class="ident" id="2330358"><a href="/time/sleep.go.html#2330245">t</a></span><br>
<span class="lineno"></span><span class="op" id="2330360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2330363">func</span>&nbsp;<span class="ident" id="2330368">goFunc</span><span class="op" id="2330374">(</span><span class="ident" id="2330375">arg</span>&nbsp;<span class="keyword" id="2330379">interface</span><span class="op" id="2330388">{</span><span class="op" id="2330389">}</span><span class="op" id="2330390">,</span>&nbsp;<span class="ident" id="2330392">seq</span>&nbsp;<span class="builtintype" id="2330396">uintptr</span><span class="op" id="2330403">)</span>&nbsp;<span class="op" id="2330405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2330408">go</span>&nbsp;<span class="ident" id="2330411"><a href="/time/sleep.go.html#2330375">arg</a></span><span class="op" id="2330414">.</span><span class="op" id="2330415">(</span><span class="keyword" id="2330416">func</span><span class="op" id="2330420">(</span><span class="op" id="2330421">)</span><span class="op" id="2330422">)</span><span class="op" id="2330423">(</span><span class="op" id="2330424">)</span><br>
<span class="lineno">130</span><span class="op" id="2330426">}</span>
</div>
</body>
</html>
