<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/ascii85</h2>
<ul>
<li><a href="/gostd/encoding/ascii85/ascii85.go.html">ascii85.go</a></li>
<li><a href="/gostd/encoding/ascii85/ascii85_test.go.html" class="current">ascii85_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7538018">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7538073">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7538127">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7538178">package</span>&nbsp;<span class="ident" id="7538186">ascii85</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7538195">import</span>&nbsp;<span class="op" id="7538202">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538205">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538214">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538220">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538233">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538244">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7538254">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7538257">type</span>&nbsp;<span class="ident" id="7538262">testpair</span>&nbsp;<span class="keyword" id="7538271">struct</span>&nbsp;<span class="op" id="7538278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7538281">decoded</span><span class="op" id="7538288">,</span>&nbsp;<span class="ident" id="7538290">encoded</span>&nbsp;<span class="builtintype" id="7538298">string</span><br>
<span class="lineno"></span><span class="op" id="7538305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7538308">var</span>&nbsp;<span class="ident" id="7538312">pairs</span>&nbsp;<span class="op" id="7538318">=</span>&nbsp;<span class="op" id="7538320">[</span><span class="op" id="7538321">]</span><span class="ident" id="7538322">testpair</span><span class="op" id="7538330">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7538333">//&nbsp;Encode&nbsp;returns&nbsp;0&nbsp;when&nbsp;len(src)&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7538373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538377">&#34;&#34;</span><span class="op" id="7538379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538383">&#34;&#34;</span><span class="op" id="7538385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7538388">}</span><span class="op" id="7538389">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7538392">//&nbsp;Wikipedia&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7538414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538418">&#34;Man&nbsp;is&nbsp;distinguished,&nbsp;not&nbsp;only&nbsp;by&nbsp;his&nbsp;reason,&nbsp;but&nbsp;by&nbsp;this&nbsp;singular&nbsp;passion&nbsp;from&nbsp;&#34;</span>&nbsp;<span class="op" id="7538501">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538506">&#34;other&nbsp;animals,&nbsp;which&nbsp;is&nbsp;a&nbsp;lust&nbsp;of&nbsp;the&nbsp;mind,&nbsp;that&nbsp;by&nbsp;a&nbsp;perseverance&nbsp;of&nbsp;delight&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="7538590">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538595">&#34;the&nbsp;continued&nbsp;and&nbsp;indefatigable&nbsp;generation&nbsp;of&nbsp;knowledge,&nbsp;exceeds&nbsp;the&nbsp;short&nbsp;&#34;</span>&nbsp;<span class="op" id="7538673">+</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538678">&#34;vehemence&nbsp;of&nbsp;any&nbsp;carnal&nbsp;pleasure.&#34;</span><span class="op" id="7538713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538717">&#34;9jqo^BlbD-BleB1DJ+*+F(f,q/0JhKF&lt;GL&gt;Cj@.4Gp$d7F!,L7@&lt;6@)/0JDEF&lt;G%&lt;+EV:2F!,\n&#34;</span>&nbsp;<span class="op" id="7538795">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538800">&#34;O&lt;DJ+*.@&lt;*K0@&lt;6L(Df-\\0Ec5e;DffZ(EZee.Bl.9pF\&#34;AGXBPCsi+DGm&gt;@3BB/F*&amp;OCAfu2/AKY\n&#34;</span>&nbsp;<span class="op" id="7538882">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538887">&#34;i(DIb:@FD,*)+C]U=@3BN#EcYf8ATD3s@q?d$AftVqCh[NqF&lt;G:8+EV:.+Cf&gt;-FD5W8ARlolDIa\n&#34;</span>&nbsp;<span class="op" id="7538967">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7538972">&#34;l(DId&lt;j@&lt;?3r@:F%a+D58&#39;ATD4$Bl@l3De:,-DJs`8ARoFb/0JMK@qB4^F!,R&lt;AKZ&amp;-DfTqBG%G\n&#34;</span>&nbsp;<span class="op" id="7539052">+</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7539057">&#34;&gt;uD.RTpAKYo&#39;+CT/5+Cei#DII?(E,9)oF*2M7/c\n&#34;</span><span class="op" id="7539100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539103">}</span><span class="op" id="7539104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7539107">//&nbsp;Special&nbsp;case&nbsp;when&nbsp;shortening&nbsp;!!!!!&nbsp;to&nbsp;z.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7539156">&#34;\000\000\000\000&#34;</span><span class="op" id="7539174">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7539178">&#34;z&#34;</span><span class="op" id="7539181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539184">}</span><span class="op" id="7539185">,</span><br>
<span class="lineno"></span><span class="op" id="7539187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7539190">var</span>&nbsp;<span class="ident" id="7539194">bigtest</span>&nbsp;<span class="op" id="7539202">=</span>&nbsp;<span class="ident" id="7539204">pairs</span><span class="op" id="7539209">[</span><span class="builtinfunc" id="7539210">len</span><span class="op" id="7539213">(</span><span class="ident" id="7539214">pairs</span><span class="op" id="7539219">)</span><span class="op" id="7539220">-</span><span class="num" id="7539221">1</span><span class="op" id="7539222">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7539225">func</span>&nbsp;<span class="ident" id="7539230">testEqual</span><span class="op" id="7539239">(</span><span class="ident" id="7539240">t</span>&nbsp;<span class="op" id="7539242">*</span><span class="ident" id="7539243">testing</span><span class="op" id="7539250">.</span><span class="ident" id="7539251">T</span><span class="op" id="7539252">,</span>&nbsp;<span class="ident" id="7539254">msg</span>&nbsp;<span class="builtintype" id="7539258">string</span><span class="op" id="7539264">,</span>&nbsp;<span class="ident" id="7539266">args</span>&nbsp;<span class="op" id="7539271">...</span><span class="keyword" id="7539274">interface</span><span class="op" id="7539283">{</span><span class="op" id="7539284">}</span><span class="op" id="7539285">)</span>&nbsp;<span class="builtintype" id="7539287">bool</span>&nbsp;<span class="op" id="7539292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539295">if</span>&nbsp;<span class="ident" id="7539298">args</span><span class="op" id="7539302">[</span><span class="builtinfunc" id="7539303">len</span><span class="op" id="7539306">(</span><span class="ident" id="7539307">args</span><span class="op" id="7539311">)</span><span class="op" id="7539312">-</span><span class="num" id="7539313">2</span><span class="op" id="7539314">]</span>&nbsp;<span class="op" id="7539316">!=</span>&nbsp;<span class="ident" id="7539319">args</span><span class="op" id="7539323">[</span><span class="builtinfunc" id="7539324">len</span><span class="op" id="7539327">(</span><span class="ident" id="7539328">args</span><span class="op" id="7539332">)</span><span class="op" id="7539333">-</span><span class="num" id="7539334">1</span><span class="op" id="7539335">]</span>&nbsp;<span class="op" id="7539337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539341">t</span><span class="op" id="7539342">.</span><span class="ident" id="7539343">Errorf</span><span class="op" id="7539349">(</span><span class="ident" id="7539350">msg</span><span class="op" id="7539353">,</span>&nbsp;<span class="ident" id="7539355">args</span><span class="op" id="7539359">...</span><span class="op" id="7539362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539366">return</span>&nbsp;<span class="builtintype" id="7539373">false</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539383">return</span>&nbsp;<span class="builtintype" id="7539390">true</span><br>
<span class="lineno"></span><span class="op" id="7539395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7539398">func</span>&nbsp;<span class="ident" id="7539403">strip85</span><span class="op" id="7539410">(</span><span class="ident" id="7539411">s</span>&nbsp;<span class="builtintype" id="7539413">string</span><span class="op" id="7539419">)</span>&nbsp;<span class="builtintype" id="7539421">string</span>&nbsp;<span class="op" id="7539428">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539431">t</span>&nbsp;<span class="op" id="7539433">:=</span>&nbsp;<span class="builtinfunc" id="7539436">make</span><span class="op" id="7539440">(</span><span class="op" id="7539441">[</span><span class="op" id="7539442">]</span><span class="builtintype" id="7539443">byte</span><span class="op" id="7539447">,</span>&nbsp;<span class="builtinfunc" id="7539449">len</span><span class="op" id="7539452">(</span><span class="ident" id="7539453">s</span><span class="op" id="7539454">)</span><span class="op" id="7539455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539458">w</span>&nbsp;<span class="op" id="7539460">:=</span>&nbsp;<span class="num" id="7539463">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539466">for</span>&nbsp;<span class="ident" id="7539470">r</span>&nbsp;<span class="op" id="7539472">:=</span>&nbsp;<span class="num" id="7539475">0</span><span class="op" id="7539476">;</span>&nbsp;<span class="ident" id="7539478">r</span>&nbsp;<span class="op" id="7539480">&lt;</span>&nbsp;<span class="builtinfunc" id="7539482">len</span><span class="op" id="7539485">(</span><span class="ident" id="7539486">s</span><span class="op" id="7539487">)</span><span class="op" id="7539488">;</span>&nbsp;<span class="ident" id="7539490">r</span><span class="op" id="7539491">++</span>&nbsp;<span class="op" id="7539494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539498">c</span>&nbsp;<span class="op" id="7539500">:=</span>&nbsp;<span class="ident" id="7539503">s</span><span class="op" id="7539504">[</span><span class="ident" id="7539505">r</span><span class="op" id="7539506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539510">if</span>&nbsp;<span class="ident" id="7539513">c</span>&nbsp;<span class="op" id="7539515">&gt;</span>&nbsp;<span class="string" id="7539517">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="7539521">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539526">t</span><span class="op" id="7539527">[</span><span class="ident" id="7539528">w</span><span class="op" id="7539529">]</span>&nbsp;<span class="op" id="7539531">=</span>&nbsp;<span class="ident" id="7539533">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539538">w</span><span class="op" id="7539539">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539550">return</span>&nbsp;<span class="builtintype" id="7539557">string</span><span class="op" id="7539563">(</span><span class="ident" id="7539564">t</span><span class="op" id="7539565">[</span><span class="num" id="7539566">0</span><span class="op" id="7539567">:</span><span class="ident" id="7539568">w</span><span class="op" id="7539569">]</span><span class="op" id="7539570">)</span><br>
<span class="lineno">65</span><span class="op" id="7539572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7539575">func</span>&nbsp;<span class="ident" id="7539580">TestEncode</span><span class="op" id="7539590">(</span><span class="ident" id="7539591">t</span>&nbsp;<span class="op" id="7539593">*</span><span class="ident" id="7539594">testing</span><span class="op" id="7539601">.</span><span class="ident" id="7539602">T</span><span class="op" id="7539603">)</span>&nbsp;<span class="op" id="7539605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539608">for</span>&nbsp;<span class="ident" id="7539612">_</span><span class="op" id="7539613">,</span>&nbsp;<span class="ident" id="7539615">p</span>&nbsp;<span class="op" id="7539617">:=</span>&nbsp;<span class="keyword" id="7539620">range</span>&nbsp;<span class="ident" id="7539626">pairs</span>&nbsp;<span class="op" id="7539632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539636">buf</span>&nbsp;<span class="op" id="7539640">:=</span>&nbsp;<span class="builtinfunc" id="7539643">make</span><span class="op" id="7539647">(</span><span class="op" id="7539648">[</span><span class="op" id="7539649">]</span><span class="builtintype" id="7539650">byte</span><span class="op" id="7539654">,</span>&nbsp;<span class="ident" id="7539656">MaxEncodedLen</span><span class="op" id="7539669">(</span><span class="builtinfunc" id="7539670">len</span><span class="op" id="7539673">(</span><span class="ident" id="7539674">p</span><span class="op" id="7539675">.</span><span class="ident" id="7539676">decoded</span><span class="op" id="7539683">)</span><span class="op" id="7539684">)</span><span class="op" id="7539685">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539689">n</span>&nbsp;<span class="op" id="7539691">:=</span>&nbsp;<span class="ident" id="7539694">Encode</span><span class="op" id="7539700">(</span><span class="ident" id="7539701">buf</span><span class="op" id="7539704">,</span>&nbsp;<span class="op" id="7539706">[</span><span class="op" id="7539707">]</span><span class="builtintype" id="7539708">byte</span><span class="op" id="7539712">(</span><span class="ident" id="7539713">p</span><span class="op" id="7539714">.</span><span class="ident" id="7539715">decoded</span><span class="op" id="7539722">)</span><span class="op" id="7539723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539727">buf</span>&nbsp;<span class="op" id="7539731">=</span>&nbsp;<span class="ident" id="7539733">buf</span><span class="op" id="7539736">[</span><span class="num" id="7539737">0</span><span class="op" id="7539738">:</span><span class="ident" id="7539739">n</span><span class="op" id="7539740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539744">testEqual</span><span class="op" id="7539753">(</span><span class="ident" id="7539754">t</span><span class="op" id="7539755">,</span>&nbsp;<span class="string" id="7539757">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7539783">,</span>&nbsp;<span class="ident" id="7539785">p</span><span class="op" id="7539786">.</span><span class="ident" id="7539787">decoded</span><span class="op" id="7539794">,</span>&nbsp;<span class="ident" id="7539796">strip85</span><span class="op" id="7539803">(</span><span class="builtintype" id="7539804">string</span><span class="op" id="7539810">(</span><span class="ident" id="7539811">buf</span><span class="op" id="7539814">)</span><span class="op" id="7539815">)</span><span class="op" id="7539816">,</span>&nbsp;<span class="ident" id="7539818">strip85</span><span class="op" id="7539825">(</span><span class="ident" id="7539826">p</span><span class="op" id="7539827">.</span><span class="ident" id="7539828">encoded</span><span class="op" id="7539835">)</span><span class="op" id="7539836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7539839">}</span><br>
<span class="lineno"></span><span class="op" id="7539841">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7539844">func</span>&nbsp;<span class="ident" id="7539849">TestEncoder</span><span class="op" id="7539860">(</span><span class="ident" id="7539861">t</span>&nbsp;<span class="op" id="7539863">*</span><span class="ident" id="7539864">testing</span><span class="op" id="7539871">.</span><span class="ident" id="7539872">T</span><span class="op" id="7539873">)</span>&nbsp;<span class="op" id="7539875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7539878">for</span>&nbsp;<span class="ident" id="7539882">_</span><span class="op" id="7539883">,</span>&nbsp;<span class="ident" id="7539885">p</span>&nbsp;<span class="op" id="7539887">:=</span>&nbsp;<span class="keyword" id="7539890">range</span>&nbsp;<span class="ident" id="7539896">pairs</span>&nbsp;<span class="op" id="7539902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539906">bb</span>&nbsp;<span class="op" id="7539909">:=</span>&nbsp;<span class="op" id="7539912">&amp;</span><span class="ident" id="7539913">bytes</span><span class="op" id="7539918">.</span><span class="ident" id="7539919">Buffer</span><span class="op" id="7539925">{</span><span class="op" id="7539926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539930">encoder</span>&nbsp;<span class="op" id="7539938">:=</span>&nbsp;<span class="ident" id="7539941">NewEncoder</span><span class="op" id="7539951">(</span><span class="ident" id="7539952">bb</span><span class="op" id="7539954">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539958">encoder</span><span class="op" id="7539965">.</span><span class="ident" id="7539966">Write</span><span class="op" id="7539971">(</span><span class="op" id="7539972">[</span><span class="op" id="7539973">]</span><span class="builtintype" id="7539974">byte</span><span class="op" id="7539978">(</span><span class="ident" id="7539979">p</span><span class="op" id="7539980">.</span><span class="ident" id="7539981">decoded</span><span class="op" id="7539988">)</span><span class="op" id="7539989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7539993">encoder</span><span class="op" id="7540000">.</span><span class="ident" id="7540001">Close</span><span class="op" id="7540006">(</span><span class="op" id="7540007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540011">testEqual</span><span class="op" id="7540020">(</span><span class="ident" id="7540021">t</span><span class="op" id="7540022">,</span>&nbsp;<span class="string" id="7540024">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7540050">,</span>&nbsp;<span class="ident" id="7540052">p</span><span class="op" id="7540053">.</span><span class="ident" id="7540054">decoded</span><span class="op" id="7540061">,</span>&nbsp;<span class="ident" id="7540063">strip85</span><span class="op" id="7540070">(</span><span class="ident" id="7540071">bb</span><span class="op" id="7540073">.</span><span class="ident" id="7540074">String</span><span class="op" id="7540080">(</span><span class="op" id="7540081">)</span><span class="op" id="7540082">)</span><span class="op" id="7540083">,</span>&nbsp;<span class="ident" id="7540085">strip85</span><span class="op" id="7540092">(</span><span class="ident" id="7540093">p</span><span class="op" id="7540094">.</span><span class="ident" id="7540095">encoded</span><span class="op" id="7540102">)</span><span class="op" id="7540103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7540106">}</span><br>
<span class="lineno"></span><span class="op" id="7540108">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7540111">func</span>&nbsp;<span class="ident" id="7540116">TestEncoderBuffering</span><span class="op" id="7540136">(</span><span class="ident" id="7540137">t</span>&nbsp;<span class="op" id="7540139">*</span><span class="ident" id="7540140">testing</span><span class="op" id="7540147">.</span><span class="ident" id="7540148">T</span><span class="op" id="7540149">)</span>&nbsp;<span class="op" id="7540151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540154">input</span>&nbsp;<span class="op" id="7540160">:=</span>&nbsp;<span class="op" id="7540163">[</span><span class="op" id="7540164">]</span><span class="builtintype" id="7540165">byte</span><span class="op" id="7540169">(</span><span class="ident" id="7540170">bigtest</span><span class="op" id="7540177">.</span><span class="ident" id="7540178">decoded</span><span class="op" id="7540185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7540188">for</span>&nbsp;<span class="ident" id="7540192">bs</span>&nbsp;<span class="op" id="7540195">:=</span>&nbsp;<span class="num" id="7540198">1</span><span class="op" id="7540199">;</span>&nbsp;<span class="ident" id="7540201">bs</span>&nbsp;<span class="op" id="7540204">&lt;=</span>&nbsp;<span class="num" id="7540207">12</span><span class="op" id="7540209">;</span>&nbsp;<span class="ident" id="7540211">bs</span><span class="op" id="7540213">++</span>&nbsp;<span class="op" id="7540216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540220">bb</span>&nbsp;<span class="op" id="7540223">:=</span>&nbsp;<span class="op" id="7540226">&amp;</span><span class="ident" id="7540227">bytes</span><span class="op" id="7540232">.</span><span class="ident" id="7540233">Buffer</span><span class="op" id="7540239">{</span><span class="op" id="7540240">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540244">encoder</span>&nbsp;<span class="op" id="7540252">:=</span>&nbsp;<span class="ident" id="7540255">NewEncoder</span><span class="op" id="7540265">(</span><span class="ident" id="7540266">bb</span><span class="op" id="7540268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7540272">for</span>&nbsp;<span class="ident" id="7540276">pos</span>&nbsp;<span class="op" id="7540280">:=</span>&nbsp;<span class="num" id="7540283">0</span><span class="op" id="7540284">;</span>&nbsp;<span class="ident" id="7540286">pos</span>&nbsp;<span class="op" id="7540290">&lt;</span>&nbsp;<span class="builtinfunc" id="7540292">len</span><span class="op" id="7540295">(</span><span class="ident" id="7540296">input</span><span class="op" id="7540301">)</span><span class="op" id="7540302">;</span>&nbsp;<span class="ident" id="7540304">pos</span>&nbsp;<span class="op" id="7540308">+=</span>&nbsp;<span class="ident" id="7540311">bs</span>&nbsp;<span class="op" id="7540314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540319">end</span>&nbsp;<span class="op" id="7540323">:=</span>&nbsp;<span class="ident" id="7540326">pos</span>&nbsp;<span class="op" id="7540330">+</span>&nbsp;<span class="ident" id="7540332">bs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7540338">if</span>&nbsp;<span class="ident" id="7540341">end</span>&nbsp;<span class="op" id="7540345">&gt;</span>&nbsp;<span class="builtinfunc" id="7540347">len</span><span class="op" id="7540350">(</span><span class="ident" id="7540351">input</span><span class="op" id="7540356">)</span>&nbsp;<span class="op" id="7540358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540364">end</span>&nbsp;<span class="op" id="7540368">=</span>&nbsp;<span class="builtinfunc" id="7540370">len</span><span class="op" id="7540373">(</span><span class="ident" id="7540374">input</span><span class="op" id="7540379">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7540384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540389">n</span><span class="op" id="7540390">,</span>&nbsp;<span class="ident" id="7540392">err</span>&nbsp;<span class="op" id="7540396">:=</span>&nbsp;<span class="ident" id="7540399">encoder</span><span class="op" id="7540406">.</span><span class="ident" id="7540407">Write</span><span class="op" id="7540412">(</span><span class="ident" id="7540413">input</span><span class="op" id="7540418">[</span><span class="ident" id="7540419">pos</span><span class="op" id="7540422">:</span><span class="ident" id="7540423">end</span><span class="op" id="7540426">]</span><span class="op" id="7540427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540432">testEqual</span><span class="op" id="7540441">(</span><span class="ident" id="7540442">t</span><span class="op" id="7540443">,</span>&nbsp;<span class="string" id="7540445">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7540479">,</span>&nbsp;<span class="ident" id="7540481">input</span><span class="op" id="7540486">[</span><span class="ident" id="7540487">pos</span><span class="op" id="7540490">:</span><span class="ident" id="7540491">end</span><span class="op" id="7540494">]</span><span class="op" id="7540495">,</span>&nbsp;<span class="ident" id="7540497">err</span><span class="op" id="7540500">,</span>&nbsp;<span class="builtintype" id="7540502">error</span><span class="op" id="7540507">(</span><span class="builtintype" id="7540508">nil</span><span class="op" id="7540511">)</span><span class="op" id="7540512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540517">testEqual</span><span class="op" id="7540526">(</span><span class="ident" id="7540527">t</span><span class="op" id="7540528">,</span>&nbsp;<span class="string" id="7540530">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7540565">,</span>&nbsp;<span class="ident" id="7540567">input</span><span class="op" id="7540572">[</span><span class="ident" id="7540573">pos</span><span class="op" id="7540576">:</span><span class="ident" id="7540577">end</span><span class="op" id="7540580">]</span><span class="op" id="7540581">,</span>&nbsp;<span class="ident" id="7540583">n</span><span class="op" id="7540584">,</span>&nbsp;<span class="ident" id="7540586">end</span><span class="op" id="7540589">-</span><span class="ident" id="7540590">pos</span><span class="op" id="7540593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7540597">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540601">err</span>&nbsp;<span class="op" id="7540605">:=</span>&nbsp;<span class="ident" id="7540608">encoder</span><span class="op" id="7540615">.</span><span class="ident" id="7540616">Close</span><span class="op" id="7540621">(</span><span class="op" id="7540622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540626">testEqual</span><span class="op" id="7540635">(</span><span class="ident" id="7540636">t</span><span class="op" id="7540637">,</span>&nbsp;<span class="string" id="7540639">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7540669">,</span>&nbsp;<span class="ident" id="7540671">err</span><span class="op" id="7540674">,</span>&nbsp;<span class="builtintype" id="7540676">error</span><span class="op" id="7540681">(</span><span class="builtintype" id="7540682">nil</span><span class="op" id="7540685">)</span><span class="op" id="7540686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540690">testEqual</span><span class="op" id="7540699">(</span><span class="ident" id="7540700">t</span><span class="op" id="7540701">,</span>&nbsp;<span class="string" id="7540703">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7540736">,</span>&nbsp;<span class="ident" id="7540738">bs</span><span class="op" id="7540740">,</span>&nbsp;<span class="ident" id="7540742">bigtest</span><span class="op" id="7540749">.</span><span class="ident" id="7540750">decoded</span><span class="op" id="7540757">,</span>&nbsp;<span class="ident" id="7540759">strip85</span><span class="op" id="7540766">(</span><span class="ident" id="7540767">bb</span><span class="op" id="7540769">.</span><span class="ident" id="7540770">String</span><span class="op" id="7540776">(</span><span class="op" id="7540777">)</span><span class="op" id="7540778">)</span><span class="op" id="7540779">,</span>&nbsp;<span class="ident" id="7540781">strip85</span><span class="op" id="7540788">(</span><span class="ident" id="7540789">bigtest</span><span class="op" id="7540796">.</span><span class="ident" id="7540797">encoded</span><span class="op" id="7540804">)</span><span class="op" id="7540805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7540808">}</span><br>
<span class="lineno"></span><span class="op" id="7540810">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7540813">func</span>&nbsp;<span class="ident" id="7540818">TestDecode</span><span class="op" id="7540828">(</span><span class="ident" id="7540829">t</span>&nbsp;<span class="op" id="7540831">*</span><span class="ident" id="7540832">testing</span><span class="op" id="7540839">.</span><span class="ident" id="7540840">T</span><span class="op" id="7540841">)</span>&nbsp;<span class="op" id="7540843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7540846">for</span>&nbsp;<span class="ident" id="7540850">_</span><span class="op" id="7540851">,</span>&nbsp;<span class="ident" id="7540853">p</span>&nbsp;<span class="op" id="7540855">:=</span>&nbsp;<span class="keyword" id="7540858">range</span>&nbsp;<span class="ident" id="7540864">pairs</span>&nbsp;<span class="op" id="7540870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540874">dbuf</span>&nbsp;<span class="op" id="7540879">:=</span>&nbsp;<span class="builtinfunc" id="7540882">make</span><span class="op" id="7540886">(</span><span class="op" id="7540887">[</span><span class="op" id="7540888">]</span><span class="builtintype" id="7540889">byte</span><span class="op" id="7540893">,</span>&nbsp;<span class="num" id="7540895">4</span><span class="op" id="7540896">*</span><span class="builtinfunc" id="7540897">len</span><span class="op" id="7540900">(</span><span class="ident" id="7540901">p</span><span class="op" id="7540902">.</span><span class="ident" id="7540903">encoded</span><span class="op" id="7540910">)</span><span class="op" id="7540911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540915">ndst</span><span class="op" id="7540919">,</span>&nbsp;<span class="ident" id="7540921">nsrc</span><span class="op" id="7540925">,</span>&nbsp;<span class="ident" id="7540927">err</span>&nbsp;<span class="op" id="7540931">:=</span>&nbsp;<span class="ident" id="7540934">Decode</span><span class="op" id="7540940">(</span><span class="ident" id="7540941">dbuf</span><span class="op" id="7540945">,</span>&nbsp;<span class="op" id="7540947">[</span><span class="op" id="7540948">]</span><span class="builtintype" id="7540949">byte</span><span class="op" id="7540953">(</span><span class="ident" id="7540954">p</span><span class="op" id="7540955">.</span><span class="ident" id="7540956">encoded</span><span class="op" id="7540963">)</span><span class="op" id="7540964">,</span>&nbsp;<span class="builtintype" id="7540966">true</span><span class="op" id="7540970">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7540974">testEqual</span><span class="op" id="7540983">(</span><span class="ident" id="7540984">t</span><span class="op" id="7540985">,</span>&nbsp;<span class="string" id="7540987">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7541019">,</span>&nbsp;<span class="ident" id="7541021">p</span><span class="op" id="7541022">.</span><span class="ident" id="7541023">encoded</span><span class="op" id="7541030">,</span>&nbsp;<span class="ident" id="7541032">err</span><span class="op" id="7541035">,</span>&nbsp;<span class="builtintype" id="7541037">error</span><span class="op" id="7541042">(</span><span class="builtintype" id="7541043">nil</span><span class="op" id="7541046">)</span><span class="op" id="7541047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541051">testEqual</span><span class="op" id="7541060">(</span><span class="ident" id="7541061">t</span><span class="op" id="7541062">,</span>&nbsp;<span class="string" id="7541064">&#34;Decode(%q)&nbsp;=&nbsp;nsrc&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7541095">,</span>&nbsp;<span class="ident" id="7541097">p</span><span class="op" id="7541098">.</span><span class="ident" id="7541099">encoded</span><span class="op" id="7541106">,</span>&nbsp;<span class="ident" id="7541108">nsrc</span><span class="op" id="7541112">,</span>&nbsp;<span class="builtinfunc" id="7541114">len</span><span class="op" id="7541117">(</span><span class="ident" id="7541118">p</span><span class="op" id="7541119">.</span><span class="ident" id="7541120">encoded</span><span class="op" id="7541127">)</span><span class="op" id="7541128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541132">testEqual</span><span class="op" id="7541141">(</span><span class="ident" id="7541142">t</span><span class="op" id="7541143">,</span>&nbsp;<span class="string" id="7541145">&#34;Decode(%q)&nbsp;=&nbsp;ndst&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7541176">,</span>&nbsp;<span class="ident" id="7541178">p</span><span class="op" id="7541179">.</span><span class="ident" id="7541180">encoded</span><span class="op" id="7541187">,</span>&nbsp;<span class="ident" id="7541189">ndst</span><span class="op" id="7541193">,</span>&nbsp;<span class="builtinfunc" id="7541195">len</span><span class="op" id="7541198">(</span><span class="ident" id="7541199">p</span><span class="op" id="7541200">.</span><span class="ident" id="7541201">decoded</span><span class="op" id="7541208">)</span><span class="op" id="7541209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541213">testEqual</span><span class="op" id="7541222">(</span><span class="ident" id="7541223">t</span><span class="op" id="7541224">,</span>&nbsp;<span class="string" id="7541226">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7541252">,</span>&nbsp;<span class="ident" id="7541254">p</span><span class="op" id="7541255">.</span><span class="ident" id="7541256">encoded</span><span class="op" id="7541263">,</span>&nbsp;<span class="builtintype" id="7541265">string</span><span class="op" id="7541271">(</span><span class="ident" id="7541272">dbuf</span><span class="op" id="7541276">[</span><span class="num" id="7541277">0</span><span class="op" id="7541278">:</span><span class="ident" id="7541279">ndst</span><span class="op" id="7541283">]</span><span class="op" id="7541284">)</span><span class="op" id="7541285">,</span>&nbsp;<span class="ident" id="7541287">p</span><span class="op" id="7541288">.</span><span class="ident" id="7541289">decoded</span><span class="op" id="7541296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7541299">}</span><br>
<span class="lineno">115</span><span class="op" id="7541301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7541304">func</span>&nbsp;<span class="ident" id="7541309">TestDecoder</span><span class="op" id="7541320">(</span><span class="ident" id="7541321">t</span>&nbsp;<span class="op" id="7541323">*</span><span class="ident" id="7541324">testing</span><span class="op" id="7541331">.</span><span class="ident" id="7541332">T</span><span class="op" id="7541333">)</span>&nbsp;<span class="op" id="7541335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541338">for</span>&nbsp;<span class="ident" id="7541342">_</span><span class="op" id="7541343">,</span>&nbsp;<span class="ident" id="7541345">p</span>&nbsp;<span class="op" id="7541347">:=</span>&nbsp;<span class="keyword" id="7541350">range</span>&nbsp;<span class="ident" id="7541356">pairs</span>&nbsp;<span class="op" id="7541362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541366">decoder</span>&nbsp;<span class="op" id="7541374">:=</span>&nbsp;<span class="ident" id="7541377">NewDecoder</span><span class="op" id="7541387">(</span><span class="ident" id="7541388">strings</span><span class="op" id="7541395">.</span><span class="ident" id="7541396">NewReader</span><span class="op" id="7541405">(</span><span class="ident" id="7541406">p</span><span class="op" id="7541407">.</span><span class="ident" id="7541408">encoded</span><span class="op" id="7541415">)</span><span class="op" id="7541416">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541420">dbuf</span><span class="op" id="7541424">,</span>&nbsp;<span class="ident" id="7541426">err</span>&nbsp;<span class="op" id="7541430">:=</span>&nbsp;<span class="ident" id="7541433">ioutil</span><span class="op" id="7541439">.</span><span class="ident" id="7541440">ReadAll</span><span class="op" id="7541447">(</span><span class="ident" id="7541448">decoder</span><span class="op" id="7541455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541459">if</span>&nbsp;<span class="ident" id="7541462">err</span>&nbsp;<span class="op" id="7541466">!=</span>&nbsp;<span class="builtintype" id="7541469">nil</span>&nbsp;<span class="op" id="7541473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541478">t</span><span class="op" id="7541479">.</span><span class="ident" id="7541480">Fatal</span><span class="op" id="7541485">(</span><span class="string" id="7541486">&#34;Read&nbsp;failed&#34;</span><span class="op" id="7541499">,</span>&nbsp;<span class="ident" id="7541501">err</span><span class="op" id="7541504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7541508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541512">testEqual</span><span class="op" id="7541521">(</span><span class="ident" id="7541522">t</span><span class="op" id="7541523">,</span>&nbsp;<span class="string" id="7541525">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7541560">,</span>&nbsp;<span class="ident" id="7541562">p</span><span class="op" id="7541563">.</span><span class="ident" id="7541564">encoded</span><span class="op" id="7541571">,</span>&nbsp;<span class="builtinfunc" id="7541573">len</span><span class="op" id="7541576">(</span><span class="ident" id="7541577">dbuf</span><span class="op" id="7541581">)</span><span class="op" id="7541582">,</span>&nbsp;<span class="builtinfunc" id="7541584">len</span><span class="op" id="7541587">(</span><span class="ident" id="7541588">p</span><span class="op" id="7541589">.</span><span class="ident" id="7541590">decoded</span><span class="op" id="7541597">)</span><span class="op" id="7541598">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541602">testEqual</span><span class="op" id="7541611">(</span><span class="ident" id="7541612">t</span><span class="op" id="7541613">,</span>&nbsp;<span class="string" id="7541615">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7541645">,</span>&nbsp;<span class="ident" id="7541647">p</span><span class="op" id="7541648">.</span><span class="ident" id="7541649">encoded</span><span class="op" id="7541656">,</span>&nbsp;<span class="builtintype" id="7541658">string</span><span class="op" id="7541664">(</span><span class="ident" id="7541665">dbuf</span><span class="op" id="7541669">)</span><span class="op" id="7541670">,</span>&nbsp;<span class="ident" id="7541672">p</span><span class="op" id="7541673">.</span><span class="ident" id="7541674">decoded</span><span class="op" id="7541681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541685">if</span>&nbsp;<span class="ident" id="7541688">err</span>&nbsp;<span class="op" id="7541692">!=</span>&nbsp;<span class="builtintype" id="7541695">nil</span>&nbsp;<span class="op" id="7541699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541704">testEqual</span><span class="op" id="7541713">(</span><span class="ident" id="7541714">t</span><span class="op" id="7541715">,</span>&nbsp;<span class="string" id="7541717">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7541745">,</span>&nbsp;<span class="ident" id="7541747">p</span><span class="op" id="7541748">.</span><span class="ident" id="7541749">encoded</span><span class="op" id="7541756">,</span>&nbsp;<span class="ident" id="7541758">err</span><span class="op" id="7541761">,</span>&nbsp;<span class="ident" id="7541763">io</span><span class="op" id="7541765">.</span><span class="ident" id="7541766">EOF</span><span class="op" id="7541769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7541773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7541776">}</span><br>
<span class="lineno">130</span><span class="op" id="7541778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7541781">func</span>&nbsp;<span class="ident" id="7541786">TestDecoderBuffering</span><span class="op" id="7541806">(</span><span class="ident" id="7541807">t</span>&nbsp;<span class="op" id="7541809">*</span><span class="ident" id="7541810">testing</span><span class="op" id="7541817">.</span><span class="ident" id="7541818">T</span><span class="op" id="7541819">)</span>&nbsp;<span class="op" id="7541821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541824">for</span>&nbsp;<span class="ident" id="7541828">bs</span>&nbsp;<span class="op" id="7541831">:=</span>&nbsp;<span class="num" id="7541834">1</span><span class="op" id="7541835">;</span>&nbsp;<span class="ident" id="7541837">bs</span>&nbsp;<span class="op" id="7541840">&lt;=</span>&nbsp;<span class="num" id="7541843">12</span><span class="op" id="7541845">;</span>&nbsp;<span class="ident" id="7541847">bs</span><span class="op" id="7541849">++</span>&nbsp;<span class="op" id="7541852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541856">decoder</span>&nbsp;<span class="op" id="7541864">:=</span>&nbsp;<span class="ident" id="7541867">NewDecoder</span><span class="op" id="7541877">(</span><span class="ident" id="7541878">strings</span><span class="op" id="7541885">.</span><span class="ident" id="7541886">NewReader</span><span class="op" id="7541895">(</span><span class="ident" id="7541896">bigtest</span><span class="op" id="7541903">.</span><span class="ident" id="7541904">encoded</span><span class="op" id="7541911">)</span><span class="op" id="7541912">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7541916">buf</span>&nbsp;<span class="op" id="7541920">:=</span>&nbsp;<span class="builtinfunc" id="7541923">make</span><span class="op" id="7541927">(</span><span class="op" id="7541928">[</span><span class="op" id="7541929">]</span><span class="builtintype" id="7541930">byte</span><span class="op" id="7541934">,</span>&nbsp;<span class="builtinfunc" id="7541936">len</span><span class="op" id="7541939">(</span><span class="ident" id="7541940">bigtest</span><span class="op" id="7541947">.</span><span class="ident" id="7541948">decoded</span><span class="op" id="7541955">)</span><span class="op" id="7541956">+</span><span class="num" id="7541957">12</span><span class="op" id="7541959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541963">var</span>&nbsp;<span class="ident" id="7541967">total</span>&nbsp;<span class="builtintype" id="7541973">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7541979">for</span>&nbsp;<span class="ident" id="7541983">total</span>&nbsp;<span class="op" id="7541989">=</span>&nbsp;<span class="num" id="7541991">0</span><span class="op" id="7541992">;</span>&nbsp;<span class="ident" id="7541994">total</span>&nbsp;<span class="op" id="7542000">&lt;</span>&nbsp;<span class="builtinfunc" id="7542002">len</span><span class="op" id="7542005">(</span><span class="ident" id="7542006">bigtest</span><span class="op" id="7542013">.</span><span class="ident" id="7542014">decoded</span><span class="op" id="7542021">)</span><span class="op" id="7542022">;</span>&nbsp;<span class="op" id="7542024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542029">n</span><span class="op" id="7542030">,</span>&nbsp;<span class="ident" id="7542032">err</span>&nbsp;<span class="op" id="7542036">:=</span>&nbsp;<span class="ident" id="7542039">decoder</span><span class="op" id="7542046">.</span><span class="ident" id="7542047">Read</span><span class="op" id="7542051">(</span><span class="ident" id="7542052">buf</span><span class="op" id="7542055">[</span><span class="ident" id="7542056">total</span>&nbsp;<span class="op" id="7542062">:</span>&nbsp;<span class="ident" id="7542064">total</span><span class="op" id="7542069">+</span><span class="ident" id="7542070">bs</span><span class="op" id="7542072">]</span><span class="op" id="7542073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542078">testEqual</span><span class="op" id="7542087">(</span><span class="ident" id="7542088">t</span><span class="op" id="7542089">,</span>&nbsp;<span class="string" id="7542091">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7542136">,</span>&nbsp;<span class="ident" id="7542138">bigtest</span><span class="op" id="7542145">.</span><span class="ident" id="7542146">encoded</span><span class="op" id="7542153">,</span>&nbsp;<span class="ident" id="7542155">total</span><span class="op" id="7542160">,</span>&nbsp;<span class="ident" id="7542162">n</span><span class="op" id="7542163">,</span>&nbsp;<span class="ident" id="7542165">err</span><span class="op" id="7542168">,</span>&nbsp;<span class="builtintype" id="7542170">error</span><span class="op" id="7542175">(</span><span class="builtintype" id="7542176">nil</span><span class="op" id="7542179">)</span><span class="op" id="7542180">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542185">total</span>&nbsp;<span class="op" id="7542191">+=</span>&nbsp;<span class="ident" id="7542194">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542202">testEqual</span><span class="op" id="7542211">(</span><span class="ident" id="7542212">t</span><span class="op" id="7542213">,</span>&nbsp;<span class="string" id="7542215">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7542248">,</span>&nbsp;<span class="ident" id="7542250">bs</span><span class="op" id="7542252">,</span>&nbsp;<span class="ident" id="7542254">bigtest</span><span class="op" id="7542261">.</span><span class="ident" id="7542262">encoded</span><span class="op" id="7542269">,</span>&nbsp;<span class="builtintype" id="7542271">string</span><span class="op" id="7542277">(</span><span class="ident" id="7542278">buf</span><span class="op" id="7542281">[</span><span class="num" id="7542282">0</span><span class="op" id="7542283">:</span><span class="ident" id="7542284">total</span><span class="op" id="7542289">]</span><span class="op" id="7542290">)</span><span class="op" id="7542291">,</span>&nbsp;<span class="ident" id="7542293">bigtest</span><span class="op" id="7542300">.</span><span class="ident" id="7542301">decoded</span><span class="op" id="7542308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542311">}</span><br>
<span class="lineno"></span><span class="op" id="7542313">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7542316">func</span>&nbsp;<span class="ident" id="7542321">TestDecodeCorrupt</span><span class="op" id="7542338">(</span><span class="ident" id="7542339">t</span>&nbsp;<span class="op" id="7542341">*</span><span class="ident" id="7542342">testing</span><span class="op" id="7542349">.</span><span class="ident" id="7542350">T</span><span class="op" id="7542351">)</span>&nbsp;<span class="op" id="7542353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542356">type</span>&nbsp;<span class="ident" id="7542361">corrupt</span>&nbsp;<span class="keyword" id="7542369">struct</span>&nbsp;<span class="op" id="7542376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542380">e</span>&nbsp;<span class="builtintype" id="7542382">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542391">p</span>&nbsp;<span class="builtintype" id="7542393">int</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542401">examples</span>&nbsp;<span class="op" id="7542410">:=</span>&nbsp;<span class="op" id="7542413">[</span><span class="op" id="7542414">]</span><span class="ident" id="7542415">corrupt</span><span class="op" id="7542422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542426">{</span><span class="string" id="7542427">&#34;v&#34;</span><span class="op" id="7542430">,</span>&nbsp;<span class="num" id="7542432">0</span><span class="op" id="7542433">}</span><span class="op" id="7542434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542438">{</span><span class="string" id="7542439">&#34;!z!!!!!!!!!&#34;</span><span class="op" id="7542452">,</span>&nbsp;<span class="num" id="7542454">1</span><span class="op" id="7542455">}</span><span class="op" id="7542456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542459">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542463">for</span>&nbsp;<span class="ident" id="7542467">_</span><span class="op" id="7542468">,</span>&nbsp;<span class="ident" id="7542470">e</span>&nbsp;<span class="op" id="7542472">:=</span>&nbsp;<span class="keyword" id="7542475">range</span>&nbsp;<span class="ident" id="7542481">examples</span>&nbsp;<span class="op" id="7542490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542494">dbuf</span>&nbsp;<span class="op" id="7542499">:=</span>&nbsp;<span class="builtinfunc" id="7542502">make</span><span class="op" id="7542506">(</span><span class="op" id="7542507">[</span><span class="op" id="7542508">]</span><span class="builtintype" id="7542509">byte</span><span class="op" id="7542513">,</span>&nbsp;<span class="num" id="7542515">4</span><span class="op" id="7542516">*</span><span class="builtinfunc" id="7542517">len</span><span class="op" id="7542520">(</span><span class="ident" id="7542521">e</span><span class="op" id="7542522">.</span><span class="ident" id="7542523">e</span><span class="op" id="7542524">)</span><span class="op" id="7542525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542529">_</span><span class="op" id="7542530">,</span>&nbsp;<span class="ident" id="7542532">_</span><span class="op" id="7542533">,</span>&nbsp;<span class="ident" id="7542535">err</span>&nbsp;<span class="op" id="7542539">:=</span>&nbsp;<span class="ident" id="7542542">Decode</span><span class="op" id="7542548">(</span><span class="ident" id="7542549">dbuf</span><span class="op" id="7542553">,</span>&nbsp;<span class="op" id="7542555">[</span><span class="op" id="7542556">]</span><span class="builtintype" id="7542557">byte</span><span class="op" id="7542561">(</span><span class="ident" id="7542562">e</span><span class="op" id="7542563">.</span><span class="ident" id="7542564">e</span><span class="op" id="7542565">)</span><span class="op" id="7542566">,</span>&nbsp;<span class="builtintype" id="7542568">true</span><span class="op" id="7542572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542576">switch</span>&nbsp;<span class="ident" id="7542583">err</span>&nbsp;<span class="op" id="7542587">:=</span>&nbsp;<span class="ident" id="7542590">err</span><span class="op" id="7542593">.</span><span class="op" id="7542594">(</span><span class="keyword" id="7542595">type</span><span class="op" id="7542599">)</span>&nbsp;<span class="op" id="7542601">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542605">case</span>&nbsp;<span class="ident" id="7542610">CorruptInputError</span><span class="op" id="7542627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542632">testEqual</span><span class="op" id="7542641">(</span><span class="ident" id="7542642">t</span><span class="op" id="7542643">,</span>&nbsp;<span class="string" id="7542645">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7542685">,</span>&nbsp;<span class="ident" id="7542687">e</span><span class="op" id="7542688">.</span><span class="ident" id="7542689">e</span><span class="op" id="7542690">,</span>&nbsp;<span class="builtintype" id="7542692">int</span><span class="op" id="7542695">(</span><span class="ident" id="7542696">err</span><span class="op" id="7542699">)</span><span class="op" id="7542700">,</span>&nbsp;<span class="ident" id="7542702">e</span><span class="op" id="7542703">.</span><span class="ident" id="7542704">p</span><span class="op" id="7542705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542709">default</span><span class="op" id="7542716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542721">t</span><span class="op" id="7542722">.</span><span class="ident" id="7542723">Error</span><span class="op" id="7542728">(</span><span class="string" id="7542729">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="7542769">,</span>&nbsp;<span class="ident" id="7542771">e</span><span class="op" id="7542772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542776">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542779">}</span><br>
<span class="lineno"></span><span class="op" id="7542781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7542784">func</span>&nbsp;<span class="ident" id="7542789">TestBig</span><span class="op" id="7542796">(</span><span class="ident" id="7542797">t</span>&nbsp;<span class="op" id="7542799">*</span><span class="ident" id="7542800">testing</span><span class="op" id="7542807">.</span><span class="ident" id="7542808">T</span><span class="op" id="7542809">)</span>&nbsp;<span class="op" id="7542811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542814">n</span>&nbsp;<span class="op" id="7542816">:=</span>&nbsp;<span class="num" id="7542819">3</span><span class="op" id="7542820">*</span><span class="num" id="7542821">1000</span>&nbsp;<span class="op" id="7542826">+</span>&nbsp;<span class="num" id="7542828">1</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542831">raw</span>&nbsp;<span class="op" id="7542835">:=</span>&nbsp;<span class="builtinfunc" id="7542838">make</span><span class="op" id="7542842">(</span><span class="op" id="7542843">[</span><span class="op" id="7542844">]</span><span class="builtintype" id="7542845">byte</span><span class="op" id="7542849">,</span>&nbsp;<span class="ident" id="7542851">n</span><span class="op" id="7542852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542855">const</span>&nbsp;<span class="ident" id="7542861">alpha</span>&nbsp;<span class="op" id="7542867">=</span>&nbsp;<span class="string" id="7542869">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7542935">for</span>&nbsp;<span class="ident" id="7542939">i</span>&nbsp;<span class="op" id="7542941">:=</span>&nbsp;<span class="num" id="7542944">0</span><span class="op" id="7542945">;</span>&nbsp;<span class="ident" id="7542947">i</span>&nbsp;<span class="op" id="7542949">&lt;</span>&nbsp;<span class="ident" id="7542951">n</span><span class="op" id="7542952">;</span>&nbsp;<span class="ident" id="7542954">i</span><span class="op" id="7542955">++</span>&nbsp;<span class="op" id="7542958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542962">raw</span><span class="op" id="7542965">[</span><span class="ident" id="7542966">i</span><span class="op" id="7542967">]</span>&nbsp;<span class="op" id="7542969">=</span>&nbsp;<span class="ident" id="7542971">alpha</span><span class="op" id="7542976">[</span><span class="ident" id="7542977">i</span><span class="op" id="7542978">%</span><span class="builtinfunc" id="7542979">len</span><span class="op" id="7542982">(</span><span class="ident" id="7542983">alpha</span><span class="op" id="7542988">)</span><span class="op" id="7542989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7542992">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7542995">encoded</span>&nbsp;<span class="op" id="7543003">:=</span>&nbsp;<span class="builtinfunc" id="7543006">new</span><span class="op" id="7543009">(</span><span class="ident" id="7543010">bytes</span><span class="op" id="7543015">.</span><span class="ident" id="7543016">Buffer</span><span class="op" id="7543022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543025">w</span>&nbsp;<span class="op" id="7543027">:=</span>&nbsp;<span class="ident" id="7543030">NewEncoder</span><span class="op" id="7543040">(</span><span class="ident" id="7543041">encoded</span><span class="op" id="7543048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543051">nn</span><span class="op" id="7543053">,</span>&nbsp;<span class="ident" id="7543055">err</span>&nbsp;<span class="op" id="7543059">:=</span>&nbsp;<span class="ident" id="7543062">w</span><span class="op" id="7543063">.</span><span class="ident" id="7543064">Write</span><span class="op" id="7543069">(</span><span class="ident" id="7543070">raw</span><span class="op" id="7543073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543076">if</span>&nbsp;<span class="ident" id="7543079">nn</span>&nbsp;<span class="op" id="7543082">!=</span>&nbsp;<span class="ident" id="7543085">n</span>&nbsp;<span class="op" id="7543087">||</span>&nbsp;<span class="ident" id="7543090">err</span>&nbsp;<span class="op" id="7543094">!=</span>&nbsp;<span class="builtintype" id="7543097">nil</span>&nbsp;<span class="op" id="7543101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543105">t</span><span class="op" id="7543106">.</span><span class="ident" id="7543107">Fatalf</span><span class="op" id="7543113">(</span><span class="string" id="7543114">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="7543156">,</span>&nbsp;<span class="ident" id="7543158">nn</span><span class="op" id="7543160">,</span>&nbsp;<span class="ident" id="7543162">err</span><span class="op" id="7543165">,</span>&nbsp;<span class="ident" id="7543167">n</span><span class="op" id="7543168">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543174">err</span>&nbsp;<span class="op" id="7543178">=</span>&nbsp;<span class="ident" id="7543180">w</span><span class="op" id="7543181">.</span><span class="ident" id="7543182">Close</span><span class="op" id="7543187">(</span><span class="op" id="7543188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543191">if</span>&nbsp;<span class="ident" id="7543194">err</span>&nbsp;<span class="op" id="7543198">!=</span>&nbsp;<span class="builtintype" id="7543201">nil</span>&nbsp;<span class="op" id="7543205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543209">t</span><span class="op" id="7543210">.</span><span class="ident" id="7543211">Fatalf</span><span class="op" id="7543217">(</span><span class="string" id="7543218">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7543249">,</span>&nbsp;<span class="ident" id="7543251">err</span><span class="op" id="7543254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543257">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543260">decoded</span><span class="op" id="7543267">,</span>&nbsp;<span class="ident" id="7543269">err</span>&nbsp;<span class="op" id="7543273">:=</span>&nbsp;<span class="ident" id="7543276">ioutil</span><span class="op" id="7543282">.</span><span class="ident" id="7543283">ReadAll</span><span class="op" id="7543290">(</span><span class="ident" id="7543291">NewDecoder</span><span class="op" id="7543301">(</span><span class="ident" id="7543302">encoded</span><span class="op" id="7543309">)</span><span class="op" id="7543310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543313">if</span>&nbsp;<span class="ident" id="7543316">err</span>&nbsp;<span class="op" id="7543320">!=</span>&nbsp;<span class="builtintype" id="7543323">nil</span>&nbsp;<span class="op" id="7543327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543331">t</span><span class="op" id="7543332">.</span><span class="ident" id="7543333">Fatalf</span><span class="op" id="7543339">(</span><span class="string" id="7543340">&#34;io.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="7543373">,</span>&nbsp;<span class="ident" id="7543375">err</span><span class="op" id="7543378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543385">if</span>&nbsp;<span class="op" id="7543388">!</span><span class="ident" id="7543389">bytes</span><span class="op" id="7543394">.</span><span class="ident" id="7543395">Equal</span><span class="op" id="7543400">(</span><span class="ident" id="7543401">raw</span><span class="op" id="7543404">,</span>&nbsp;<span class="ident" id="7543406">decoded</span><span class="op" id="7543413">)</span>&nbsp;<span class="op" id="7543415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543419">var</span>&nbsp;<span class="ident" id="7543423">i</span>&nbsp;<span class="builtintype" id="7543425">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543431">for</span>&nbsp;<span class="ident" id="7543435">i</span>&nbsp;<span class="op" id="7543437">=</span>&nbsp;<span class="num" id="7543439">0</span><span class="op" id="7543440">;</span>&nbsp;<span class="ident" id="7543442">i</span>&nbsp;<span class="op" id="7543444">&lt;</span>&nbsp;<span class="builtinfunc" id="7543446">len</span><span class="op" id="7543449">(</span><span class="ident" id="7543450">decoded</span><span class="op" id="7543457">)</span>&nbsp;<span class="op" id="7543459">&amp;&amp;</span>&nbsp;<span class="ident" id="7543462">i</span>&nbsp;<span class="op" id="7543464">&lt;</span>&nbsp;<span class="builtinfunc" id="7543466">len</span><span class="op" id="7543469">(</span><span class="ident" id="7543470">raw</span><span class="op" id="7543473">)</span><span class="op" id="7543474">;</span>&nbsp;<span class="ident" id="7543476">i</span><span class="op" id="7543477">++</span>&nbsp;<span class="op" id="7543480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543485">if</span>&nbsp;<span class="ident" id="7543488">decoded</span><span class="op" id="7543495">[</span><span class="ident" id="7543496">i</span><span class="op" id="7543497">]</span>&nbsp;<span class="op" id="7543499">!=</span>&nbsp;<span class="ident" id="7543502">raw</span><span class="op" id="7543505">[</span><span class="ident" id="7543506">i</span><span class="op" id="7543507">]</span>&nbsp;<span class="op" id="7543509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543515">break</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543532">t</span><span class="op" id="7543533">.</span><span class="ident" id="7543534">Errorf</span><span class="op" id="7543540">(</span><span class="string" id="7543541">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="7543593">,</span>&nbsp;<span class="ident" id="7543595">n</span><span class="op" id="7543596">,</span>&nbsp;<span class="ident" id="7543598">i</span><span class="op" id="7543599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543602">}</span><br>
<span class="lineno"></span><span class="op" id="7543604">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="7543607">func</span>&nbsp;<span class="ident" id="7543612">TestDecoderInternalWhitespace</span><span class="op" id="7543641">(</span><span class="ident" id="7543642">t</span>&nbsp;<span class="op" id="7543644">*</span><span class="ident" id="7543645">testing</span><span class="op" id="7543652">.</span><span class="ident" id="7543653">T</span><span class="op" id="7543654">)</span>&nbsp;<span class="op" id="7543656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543659">s</span>&nbsp;<span class="op" id="7543661">:=</span>&nbsp;<span class="ident" id="7543664">strings</span><span class="op" id="7543671">.</span><span class="ident" id="7543672">Repeat</span><span class="op" id="7543678">(</span><span class="string" id="7543679">&#34;&nbsp;&#34;</span><span class="op" id="7543682">,</span>&nbsp;<span class="num" id="7543684">2048</span><span class="op" id="7543688">)</span>&nbsp;<span class="op" id="7543690">+</span>&nbsp;<span class="string" id="7543692">&#34;z&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543697">decoded</span><span class="op" id="7543704">,</span>&nbsp;<span class="ident" id="7543706">err</span>&nbsp;<span class="op" id="7543710">:=</span>&nbsp;<span class="ident" id="7543713">ioutil</span><span class="op" id="7543719">.</span><span class="ident" id="7543720">ReadAll</span><span class="op" id="7543727">(</span><span class="ident" id="7543728">NewDecoder</span><span class="op" id="7543738">(</span><span class="ident" id="7543739">strings</span><span class="op" id="7543746">.</span><span class="ident" id="7543747">NewReader</span><span class="op" id="7543756">(</span><span class="ident" id="7543757">s</span><span class="op" id="7543758">)</span><span class="op" id="7543759">)</span><span class="op" id="7543760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543763">if</span>&nbsp;<span class="ident" id="7543766">err</span>&nbsp;<span class="op" id="7543770">!=</span>&nbsp;<span class="builtintype" id="7543773">nil</span>&nbsp;<span class="op" id="7543777">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543781">t</span><span class="op" id="7543782">.</span><span class="ident" id="7543783">Errorf</span><span class="op" id="7543789">(</span><span class="string" id="7543790">&#34;Decode&nbsp;gave&nbsp;error&nbsp;%v&#34;</span><span class="op" id="7543812">,</span>&nbsp;<span class="ident" id="7543814">err</span><span class="op" id="7543817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7543823">if</span>&nbsp;<span class="ident" id="7543826">want</span>&nbsp;<span class="op" id="7543831">:=</span>&nbsp;<span class="op" id="7543834">[</span><span class="op" id="7543835">]</span><span class="builtintype" id="7543836">byte</span><span class="op" id="7543840">(</span><span class="string" id="7543841">&#34;\000\000\000\000&#34;</span><span class="op" id="7543859">)</span><span class="op" id="7543860">;</span>&nbsp;<span class="op" id="7543862">!</span><span class="ident" id="7543863">bytes</span><span class="op" id="7543868">.</span><span class="ident" id="7543869">Equal</span><span class="op" id="7543874">(</span><span class="ident" id="7543875">want</span><span class="op" id="7543879">,</span>&nbsp;<span class="ident" id="7543881">decoded</span><span class="op" id="7543888">)</span>&nbsp;<span class="op" id="7543890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7543894">t</span><span class="op" id="7543895">.</span><span class="ident" id="7543896">Errorf</span><span class="op" id="7543902">(</span><span class="string" id="7543903">&#34;Decode&nbsp;failed:&nbsp;got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7543935">,</span>&nbsp;<span class="ident" id="7543937">decoded</span><span class="op" id="7543944">,</span>&nbsp;<span class="ident" id="7543946">want</span><span class="op" id="7543950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7543953">}</span><br>
<span class="lineno">210</span><span class="op" id="7543955">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
