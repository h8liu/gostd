<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7685609">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7685665">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7685719">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7685770">package</span>&nbsp;<span class="ident" id="7685778">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7685784">import</span>&nbsp;<span class="op" id="7685791">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685794">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685803">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685820">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685827">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685834">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685840">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685851">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685862">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7685873">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7685880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7685883">var</span>&nbsp;<span class="ident" id="7685887">writeSetCookiesTests</span>&nbsp;<span class="op" id="7685908">=</span>&nbsp;<span class="op" id="7685910">[</span><span class="op" id="7685911">]</span><span class="keyword" id="7685912">struct</span>&nbsp;<span class="op" id="7685919">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7685922">Cookie</span>&nbsp;<span class="op" id="7685929">*</span><span class="ident" id="7685930">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7685938">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7685945">string</span><br>
<span class="lineno"></span><span class="op" id="7685952">}</span><span class="op" id="7685953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7685956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7685960">&amp;</span><span class="ident" id="7685961">Cookie</span><span class="op" id="7685967">{</span><span class="ident" id="7685968">Name</span><span class="op" id="7685972">:</span>&nbsp;<span class="string" id="7685974">&#34;cookie-1&#34;</span><span class="op" id="7685984">,</span>&nbsp;<span class="ident" id="7685986">Value</span><span class="op" id="7685991">:</span>&nbsp;<span class="string" id="7685993">&#34;v$1&#34;</span><span class="op" id="7685998">}</span><span class="op" id="7685999">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686003">&#34;cookie-1=v$1&#34;</span><span class="op" id="7686017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686020">}</span><span class="op" id="7686021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686028">&amp;</span><span class="ident" id="7686029">Cookie</span><span class="op" id="7686035">{</span><span class="ident" id="7686036">Name</span><span class="op" id="7686040">:</span>&nbsp;<span class="string" id="7686042">&#34;cookie-2&#34;</span><span class="op" id="7686052">,</span>&nbsp;<span class="ident" id="7686054">Value</span><span class="op" id="7686059">:</span>&nbsp;<span class="string" id="7686061">&#34;two&#34;</span><span class="op" id="7686066">,</span>&nbsp;<span class="ident" id="7686068">MaxAge</span><span class="op" id="7686074">:</span>&nbsp;<span class="num" id="7686076">3600</span><span class="op" id="7686080">}</span><span class="op" id="7686081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686085">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7686113">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686116">}</span><span class="op" id="7686117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686124">&amp;</span><span class="ident" id="7686125">Cookie</span><span class="op" id="7686131">{</span><span class="ident" id="7686132">Name</span><span class="op" id="7686136">:</span>&nbsp;<span class="string" id="7686138">&#34;cookie-3&#34;</span><span class="op" id="7686148">,</span>&nbsp;<span class="ident" id="7686150">Value</span><span class="op" id="7686155">:</span>&nbsp;<span class="string" id="7686157">&#34;three&#34;</span><span class="op" id="7686164">,</span>&nbsp;<span class="ident" id="7686166">Domain</span><span class="op" id="7686172">:</span>&nbsp;<span class="string" id="7686174">&#34;.example.com&#34;</span><span class="op" id="7686188">}</span><span class="op" id="7686189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686193">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7686229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686232">}</span><span class="op" id="7686233">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686240">&amp;</span><span class="ident" id="7686241">Cookie</span><span class="op" id="7686247">{</span><span class="ident" id="7686248">Name</span><span class="op" id="7686252">:</span>&nbsp;<span class="string" id="7686254">&#34;cookie-4&#34;</span><span class="op" id="7686264">,</span>&nbsp;<span class="ident" id="7686266">Value</span><span class="op" id="7686271">:</span>&nbsp;<span class="string" id="7686273">&#34;four&#34;</span><span class="op" id="7686279">,</span>&nbsp;<span class="ident" id="7686281">Path</span><span class="op" id="7686285">:</span>&nbsp;<span class="string" id="7686287">&#34;/restricted/&#34;</span><span class="op" id="7686301">}</span><span class="op" id="7686302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686306">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7686340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686343">}</span><span class="op" id="7686344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686347">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686351">&amp;</span><span class="ident" id="7686352">Cookie</span><span class="op" id="7686358">{</span><span class="ident" id="7686359">Name</span><span class="op" id="7686363">:</span>&nbsp;<span class="string" id="7686365">&#34;cookie-5&#34;</span><span class="op" id="7686375">,</span>&nbsp;<span class="ident" id="7686377">Value</span><span class="op" id="7686382">:</span>&nbsp;<span class="string" id="7686384">&#34;five&#34;</span><span class="op" id="7686390">,</span>&nbsp;<span class="ident" id="7686392">Domain</span><span class="op" id="7686398">:</span>&nbsp;<span class="string" id="7686400">&#34;wrong;bad.abc&#34;</span><span class="op" id="7686415">}</span><span class="op" id="7686416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686420">&#34;cookie-5=five&#34;</span><span class="op" id="7686435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686438">}</span><span class="op" id="7686439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686446">&amp;</span><span class="ident" id="7686447">Cookie</span><span class="op" id="7686453">{</span><span class="ident" id="7686454">Name</span><span class="op" id="7686458">:</span>&nbsp;<span class="string" id="7686460">&#34;cookie-6&#34;</span><span class="op" id="7686470">,</span>&nbsp;<span class="ident" id="7686472">Value</span><span class="op" id="7686477">:</span>&nbsp;<span class="string" id="7686479">&#34;six&#34;</span><span class="op" id="7686484">,</span>&nbsp;<span class="ident" id="7686486">Domain</span><span class="op" id="7686492">:</span>&nbsp;<span class="string" id="7686494">&#34;bad-.abc&#34;</span><span class="op" id="7686504">}</span><span class="op" id="7686505">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686509">&#34;cookie-6=six&#34;</span><span class="op" id="7686523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686526">}</span><span class="op" id="7686527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686534">&amp;</span><span class="ident" id="7686535">Cookie</span><span class="op" id="7686541">{</span><span class="ident" id="7686542">Name</span><span class="op" id="7686546">:</span>&nbsp;<span class="string" id="7686548">&#34;cookie-7&#34;</span><span class="op" id="7686558">,</span>&nbsp;<span class="ident" id="7686560">Value</span><span class="op" id="7686565">:</span>&nbsp;<span class="string" id="7686567">&#34;seven&#34;</span><span class="op" id="7686574">,</span>&nbsp;<span class="ident" id="7686576">Domain</span><span class="op" id="7686582">:</span>&nbsp;<span class="string" id="7686584">&#34;127.0.0.1&#34;</span><span class="op" id="7686595">}</span><span class="op" id="7686596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686600">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7686634">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686637">}</span><span class="op" id="7686638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686645">&amp;</span><span class="ident" id="7686646">Cookie</span><span class="op" id="7686652">{</span><span class="ident" id="7686653">Name</span><span class="op" id="7686657">:</span>&nbsp;<span class="string" id="7686659">&#34;cookie-8&#34;</span><span class="op" id="7686669">,</span>&nbsp;<span class="ident" id="7686671">Value</span><span class="op" id="7686676">:</span>&nbsp;<span class="string" id="7686678">&#34;eight&#34;</span><span class="op" id="7686685">,</span>&nbsp;<span class="ident" id="7686687">Domain</span><span class="op" id="7686693">:</span>&nbsp;<span class="string" id="7686695">&#34;::1&#34;</span><span class="op" id="7686700">}</span><span class="op" id="7686701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686705">&#34;cookie-8=eight&#34;</span><span class="op" id="7686721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686724">}</span><span class="op" id="7686725">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7686728">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7686800">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686863">&amp;</span><span class="ident" id="7686864">Cookie</span><span class="op" id="7686870">{</span><span class="ident" id="7686871">Name</span><span class="op" id="7686875">:</span>&nbsp;<span class="string" id="7686877">&#34;special-1&#34;</span><span class="op" id="7686888">,</span>&nbsp;<span class="ident" id="7686890">Value</span><span class="op" id="7686895">:</span>&nbsp;<span class="string" id="7686897">&#34;a&nbsp;z&#34;</span><span class="op" id="7686902">}</span><span class="op" id="7686903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686907">`special-1=a&nbsp;z`</span><span class="op" id="7686922">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686925">}</span><span class="op" id="7686926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686933">&amp;</span><span class="ident" id="7686934">Cookie</span><span class="op" id="7686940">{</span><span class="ident" id="7686941">Name</span><span class="op" id="7686945">:</span>&nbsp;<span class="string" id="7686947">&#34;special-2&#34;</span><span class="op" id="7686958">,</span>&nbsp;<span class="ident" id="7686960">Value</span><span class="op" id="7686965">:</span>&nbsp;<span class="string" id="7686967">&#34;&nbsp;z&#34;</span><span class="op" id="7686971">}</span><span class="op" id="7686972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7686976">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7686992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686995">}</span><span class="op" id="7686996">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7686999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687003">&amp;</span><span class="ident" id="7687004">Cookie</span><span class="op" id="7687010">{</span><span class="ident" id="7687011">Name</span><span class="op" id="7687015">:</span>&nbsp;<span class="string" id="7687017">&#34;special-3&#34;</span><span class="op" id="7687028">,</span>&nbsp;<span class="ident" id="7687030">Value</span><span class="op" id="7687035">:</span>&nbsp;<span class="string" id="7687037">&#34;a&nbsp;&#34;</span><span class="op" id="7687041">}</span><span class="op" id="7687042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687046">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7687062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687065">}</span><span class="op" id="7687066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687069">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687073">&amp;</span><span class="ident" id="7687074">Cookie</span><span class="op" id="7687080">{</span><span class="ident" id="7687081">Name</span><span class="op" id="7687085">:</span>&nbsp;<span class="string" id="7687087">&#34;special-4&#34;</span><span class="op" id="7687098">,</span>&nbsp;<span class="ident" id="7687100">Value</span><span class="op" id="7687105">:</span>&nbsp;<span class="string" id="7687107">&#34;&nbsp;&#34;</span><span class="op" id="7687110">}</span><span class="op" id="7687111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687115">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7687130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687133">}</span><span class="op" id="7687134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687141">&amp;</span><span class="ident" id="7687142">Cookie</span><span class="op" id="7687148">{</span><span class="ident" id="7687149">Name</span><span class="op" id="7687153">:</span>&nbsp;<span class="string" id="7687155">&#34;special-5&#34;</span><span class="op" id="7687166">,</span>&nbsp;<span class="ident" id="7687168">Value</span><span class="op" id="7687173">:</span>&nbsp;<span class="string" id="7687175">&#34;a,z&#34;</span><span class="op" id="7687180">}</span><span class="op" id="7687181">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687185">`special-5=a,z`</span><span class="op" id="7687200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687203">}</span><span class="op" id="7687204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687211">&amp;</span><span class="ident" id="7687212">Cookie</span><span class="op" id="7687218">{</span><span class="ident" id="7687219">Name</span><span class="op" id="7687223">:</span>&nbsp;<span class="string" id="7687225">&#34;special-6&#34;</span><span class="op" id="7687236">,</span>&nbsp;<span class="ident" id="7687238">Value</span><span class="op" id="7687243">:</span>&nbsp;<span class="string" id="7687245">&#34;,z&#34;</span><span class="op" id="7687249">}</span><span class="op" id="7687250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687254">`special-6=&#34;,z&#34;`</span><span class="op" id="7687270">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687273">}</span><span class="op" id="7687274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687281">&amp;</span><span class="ident" id="7687282">Cookie</span><span class="op" id="7687288">{</span><span class="ident" id="7687289">Name</span><span class="op" id="7687293">:</span>&nbsp;<span class="string" id="7687295">&#34;special-7&#34;</span><span class="op" id="7687306">,</span>&nbsp;<span class="ident" id="7687308">Value</span><span class="op" id="7687313">:</span>&nbsp;<span class="string" id="7687315">&#34;a,&#34;</span><span class="op" id="7687319">}</span><span class="op" id="7687320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687324">`special-7=&#34;a,&#34;`</span><span class="op" id="7687340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687343">}</span><span class="op" id="7687344">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687351">&amp;</span><span class="ident" id="7687352">Cookie</span><span class="op" id="7687358">{</span><span class="ident" id="7687359">Name</span><span class="op" id="7687363">:</span>&nbsp;<span class="string" id="7687365">&#34;special-8&#34;</span><span class="op" id="7687376">,</span>&nbsp;<span class="ident" id="7687378">Value</span><span class="op" id="7687383">:</span>&nbsp;<span class="string" id="7687385">&#34;,&#34;</span><span class="op" id="7687388">}</span><span class="op" id="7687389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687393">`special-8=&#34;,&#34;`</span><span class="op" id="7687408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687411">}</span><span class="op" id="7687412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687415">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687419">&amp;</span><span class="ident" id="7687420">Cookie</span><span class="op" id="7687426">{</span><span class="ident" id="7687427">Name</span><span class="op" id="7687431">:</span>&nbsp;<span class="string" id="7687433">&#34;empty-value&#34;</span><span class="op" id="7687446">,</span>&nbsp;<span class="ident" id="7687448">Value</span><span class="op" id="7687453">:</span>&nbsp;<span class="string" id="7687455">&#34;&#34;</span><span class="op" id="7687457">}</span><span class="op" id="7687458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7687462">`empty-value=`</span><span class="op" id="7687476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687479">}</span><span class="op" id="7687480">,</span><br>
<span class="lineno"></span><span class="op" id="7687482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7687485">func</span>&nbsp;<span class="ident" id="7687490">TestWriteSetCookies</span><span class="op" id="7687509">(</span><span class="ident" id="7687510">t</span>&nbsp;<span class="op" id="7687512">*</span><span class="ident" id="7687513">testing</span><span class="op" id="7687520">.</span><span class="ident" id="7687521">T</span><span class="op" id="7687522">)</span>&nbsp;<span class="op" id="7687524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687527">defer</span>&nbsp;<span class="ident" id="7687533">log</span><span class="op" id="7687536">.</span><span class="ident" id="7687537">SetOutput</span><span class="op" id="7687546">(</span><span class="ident" id="7687547">os</span><span class="op" id="7687549">.</span><span class="ident" id="7687550">Stderr</span><span class="op" id="7687556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687559">var</span>&nbsp;<span class="ident" id="7687563">logbuf</span>&nbsp;<span class="ident" id="7687570">bytes</span><span class="op" id="7687575">.</span><span class="ident" id="7687576">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7687584">log</span><span class="op" id="7687587">.</span><span class="ident" id="7687588">SetOutput</span><span class="op" id="7687597">(</span><span class="op" id="7687598">&amp;</span><span class="ident" id="7687599">logbuf</span><span class="op" id="7687605">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687609">for</span>&nbsp;<span class="ident" id="7687613">i</span><span class="op" id="7687614">,</span>&nbsp;<span class="ident" id="7687616">tt</span>&nbsp;<span class="op" id="7687619">:=</span>&nbsp;<span class="keyword" id="7687622">range</span>&nbsp;<span class="ident" id="7687628">writeSetCookiesTests</span>&nbsp;<span class="op" id="7687649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687653">if</span>&nbsp;<span class="ident" id="7687656">g</span><span class="op" id="7687657">,</span>&nbsp;<span class="ident" id="7687659">e</span>&nbsp;<span class="op" id="7687661">:=</span>&nbsp;<span class="ident" id="7687664">tt</span><span class="op" id="7687666">.</span><span class="ident" id="7687667">Cookie</span><span class="op" id="7687673">.</span><span class="ident" id="7687674">String</span><span class="op" id="7687680">(</span><span class="op" id="7687681">)</span><span class="op" id="7687682">,</span>&nbsp;<span class="ident" id="7687684">tt</span><span class="op" id="7687686">.</span><span class="ident" id="7687687">Raw</span><span class="op" id="7687690">;</span>&nbsp;<span class="ident" id="7687692">g</span>&nbsp;<span class="op" id="7687694">!=</span>&nbsp;<span class="ident" id="7687697">e</span>&nbsp;<span class="op" id="7687699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7687704">t</span><span class="op" id="7687705">.</span><span class="ident" id="7687706">Errorf</span><span class="op" id="7687712">(</span><span class="string" id="7687713">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7687750">,</span>&nbsp;<span class="ident" id="7687752">i</span><span class="op" id="7687753">,</span>&nbsp;<span class="ident" id="7687755">e</span><span class="op" id="7687756">,</span>&nbsp;<span class="ident" id="7687758">g</span><span class="op" id="7687759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687764">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687775">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7687782">if</span>&nbsp;<span class="ident" id="7687785">got</span><span class="op" id="7687788">,</span>&nbsp;<span class="ident" id="7687790">sub</span>&nbsp;<span class="op" id="7687794">:=</span>&nbsp;<span class="ident" id="7687797">logbuf</span><span class="op" id="7687803">.</span><span class="ident" id="7687804">String</span><span class="op" id="7687810">(</span><span class="op" id="7687811">)</span><span class="op" id="7687812">,</span>&nbsp;<span class="string" id="7687814">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7687841">;</span>&nbsp;<span class="op" id="7687843">!</span><span class="ident" id="7687844">strings</span><span class="op" id="7687851">.</span><span class="ident" id="7687852">Contains</span><span class="op" id="7687860">(</span><span class="ident" id="7687861">got</span><span class="op" id="7687864">,</span>&nbsp;<span class="ident" id="7687866">sub</span><span class="op" id="7687869">)</span>&nbsp;<span class="op" id="7687871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7687875">t</span><span class="op" id="7687876">.</span><span class="ident" id="7687877">Errorf</span><span class="op" id="7687883">(</span><span class="string" id="7687884">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7687931">,</span>&nbsp;<span class="ident" id="7687933">sub</span><span class="op" id="7687936">,</span>&nbsp;<span class="ident" id="7687938">got</span><span class="op" id="7687941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7687944">}</span><br>
<span class="lineno">110</span><span class="op" id="7687946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7687949">type</span>&nbsp;<span class="ident" id="7687954">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7687979">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7687987">func</span>&nbsp;<span class="op" id="7687992">(</span><span class="ident" id="7687993">ho</span>&nbsp;<span class="ident" id="7687996">headerOnlyResponseWriter</span><span class="op" id="7688020">)</span>&nbsp;<span class="ident" id="7688022">Header</span><span class="op" id="7688028">(</span><span class="op" id="7688029">)</span>&nbsp;<span class="ident" id="7688031">Header</span>&nbsp;<span class="op" id="7688038">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7688041">return</span>&nbsp;<span class="ident" id="7688048">Header</span><span class="op" id="7688054">(</span><span class="ident" id="7688055">ho</span><span class="op" id="7688057">)</span><br>
<span class="lineno"></span><span class="op" id="7688059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7688062">func</span>&nbsp;<span class="op" id="7688067">(</span><span class="ident" id="7688068">ho</span>&nbsp;<span class="ident" id="7688071">headerOnlyResponseWriter</span><span class="op" id="7688095">)</span>&nbsp;<span class="ident" id="7688097">Write</span><span class="op" id="7688102">(</span><span class="op" id="7688103">[</span><span class="op" id="7688104">]</span><span class="builtintype" id="7688105">byte</span><span class="op" id="7688109">)</span>&nbsp;<span class="op" id="7688111">(</span><span class="builtintype" id="7688112">int</span><span class="op" id="7688115">,</span>&nbsp;<span class="builtintype" id="7688117">error</span><span class="op" id="7688122">)</span>&nbsp;<span class="op" id="7688124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7688127">panic</span><span class="op" id="7688132">(</span><span class="string" id="7688133">&#34;NOIMPL&#34;</span><span class="op" id="7688141">)</span><br>
<span class="lineno">120</span><span class="op" id="7688143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7688146">func</span>&nbsp;<span class="op" id="7688151">(</span><span class="ident" id="7688152">ho</span>&nbsp;<span class="ident" id="7688155">headerOnlyResponseWriter</span><span class="op" id="7688179">)</span>&nbsp;<span class="ident" id="7688181">WriteHeader</span><span class="op" id="7688192">(</span><span class="builtintype" id="7688193">int</span><span class="op" id="7688196">)</span>&nbsp;<span class="op" id="7688198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7688201">panic</span><span class="op" id="7688206">(</span><span class="string" id="7688207">&#34;NOIMPL&#34;</span><span class="op" id="7688215">)</span><br>
<span class="lineno"></span><span class="op" id="7688217">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7688220">func</span>&nbsp;<span class="ident" id="7688225">TestSetCookie</span><span class="op" id="7688238">(</span><span class="ident" id="7688239">t</span>&nbsp;<span class="op" id="7688241">*</span><span class="ident" id="7688242">testing</span><span class="op" id="7688249">.</span><span class="ident" id="7688250">T</span><span class="op" id="7688251">)</span>&nbsp;<span class="op" id="7688253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688256">m</span>&nbsp;<span class="op" id="7688258">:=</span>&nbsp;<span class="builtinfunc" id="7688261">make</span><span class="op" id="7688265">(</span><span class="ident" id="7688266">Header</span><span class="op" id="7688272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688275">SetCookie</span><span class="op" id="7688284">(</span><span class="ident" id="7688285">headerOnlyResponseWriter</span><span class="op" id="7688309">(</span><span class="ident" id="7688310">m</span><span class="op" id="7688311">)</span><span class="op" id="7688312">,</span>&nbsp;<span class="op" id="7688314">&amp;</span><span class="ident" id="7688315">Cookie</span><span class="op" id="7688321">{</span><span class="ident" id="7688322">Name</span><span class="op" id="7688326">:</span>&nbsp;<span class="string" id="7688328">&#34;cookie-1&#34;</span><span class="op" id="7688338">,</span>&nbsp;<span class="ident" id="7688340">Value</span><span class="op" id="7688345">:</span>&nbsp;<span class="string" id="7688347">&#34;one&#34;</span><span class="op" id="7688352">,</span>&nbsp;<span class="ident" id="7688354">Path</span><span class="op" id="7688358">:</span>&nbsp;<span class="string" id="7688360">&#34;/restricted/&#34;</span><span class="op" id="7688374">}</span><span class="op" id="7688375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688378">SetCookie</span><span class="op" id="7688387">(</span><span class="ident" id="7688388">headerOnlyResponseWriter</span><span class="op" id="7688412">(</span><span class="ident" id="7688413">m</span><span class="op" id="7688414">)</span><span class="op" id="7688415">,</span>&nbsp;<span class="op" id="7688417">&amp;</span><span class="ident" id="7688418">Cookie</span><span class="op" id="7688424">{</span><span class="ident" id="7688425">Name</span><span class="op" id="7688429">:</span>&nbsp;<span class="string" id="7688431">&#34;cookie-2&#34;</span><span class="op" id="7688441">,</span>&nbsp;<span class="ident" id="7688443">Value</span><span class="op" id="7688448">:</span>&nbsp;<span class="string" id="7688450">&#34;two&#34;</span><span class="op" id="7688455">,</span>&nbsp;<span class="ident" id="7688457">MaxAge</span><span class="op" id="7688463">:</span>&nbsp;<span class="num" id="7688465">3600</span><span class="op" id="7688469">}</span><span class="op" id="7688470">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7688473">if</span>&nbsp;<span class="ident" id="7688476">l</span>&nbsp;<span class="op" id="7688478">:=</span>&nbsp;<span class="builtinfunc" id="7688481">len</span><span class="op" id="7688484">(</span><span class="ident" id="7688485">m</span><span class="op" id="7688486">[</span><span class="string" id="7688487">&#34;Set-Cookie&#34;</span><span class="op" id="7688499">]</span><span class="op" id="7688500">)</span><span class="op" id="7688501">;</span>&nbsp;<span class="ident" id="7688503">l</span>&nbsp;<span class="op" id="7688505">!=</span>&nbsp;<span class="num" id="7688508">2</span>&nbsp;<span class="op" id="7688510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688514">t</span><span class="op" id="7688515">.</span><span class="ident" id="7688516">Fatalf</span><span class="op" id="7688522">(</span><span class="string" id="7688523">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7688552">,</span>&nbsp;<span class="num" id="7688554">2</span><span class="op" id="7688555">,</span>&nbsp;<span class="ident" id="7688557">l</span><span class="op" id="7688558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7688564">if</span>&nbsp;<span class="ident" id="7688567">g</span><span class="op" id="7688568">,</span>&nbsp;<span class="ident" id="7688570">e</span>&nbsp;<span class="op" id="7688572">:=</span>&nbsp;<span class="ident" id="7688575">m</span><span class="op" id="7688576">[</span><span class="string" id="7688577">&#34;Set-Cookie&#34;</span><span class="op" id="7688589">]</span><span class="op" id="7688590">[</span><span class="num" id="7688591">0</span><span class="op" id="7688592">]</span><span class="op" id="7688593">,</span>&nbsp;<span class="string" id="7688595">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7688628">;</span>&nbsp;<span class="ident" id="7688630">g</span>&nbsp;<span class="op" id="7688632">!=</span>&nbsp;<span class="ident" id="7688635">e</span>&nbsp;<span class="op" id="7688637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688641">t</span><span class="op" id="7688642">.</span><span class="ident" id="7688643">Errorf</span><span class="op" id="7688649">(</span><span class="string" id="7688650">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7688678">,</span>&nbsp;<span class="ident" id="7688680">e</span><span class="op" id="7688681">,</span>&nbsp;<span class="ident" id="7688683">g</span><span class="op" id="7688684">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7688690">if</span>&nbsp;<span class="ident" id="7688693">g</span><span class="op" id="7688694">,</span>&nbsp;<span class="ident" id="7688696">e</span>&nbsp;<span class="op" id="7688698">:=</span>&nbsp;<span class="ident" id="7688701">m</span><span class="op" id="7688702">[</span><span class="string" id="7688703">&#34;Set-Cookie&#34;</span><span class="op" id="7688715">]</span><span class="op" id="7688716">[</span><span class="num" id="7688717">1</span><span class="op" id="7688718">]</span><span class="op" id="7688719">,</span>&nbsp;<span class="string" id="7688721">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7688749">;</span>&nbsp;<span class="ident" id="7688751">g</span>&nbsp;<span class="op" id="7688753">!=</span>&nbsp;<span class="ident" id="7688756">e</span>&nbsp;<span class="op" id="7688758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688762">t</span><span class="op" id="7688763">.</span><span class="ident" id="7688764">Errorf</span><span class="op" id="7688770">(</span><span class="string" id="7688771">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7688799">,</span>&nbsp;<span class="ident" id="7688801">e</span><span class="op" id="7688802">,</span>&nbsp;<span class="ident" id="7688804">g</span><span class="op" id="7688805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688808">}</span><br>
<span class="lineno"></span><span class="op" id="7688810">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7688813">var</span>&nbsp;<span class="ident" id="7688817">addCookieTests</span>&nbsp;<span class="op" id="7688832">=</span>&nbsp;<span class="op" id="7688834">[</span><span class="op" id="7688835">]</span><span class="keyword" id="7688836">struct</span>&nbsp;<span class="op" id="7688843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688846">Cookies</span>&nbsp;<span class="op" id="7688854">[</span><span class="op" id="7688855">]</span><span class="op" id="7688856">*</span><span class="ident" id="7688857">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7688865">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7688873">string</span><br>
<span class="lineno"></span><span class="op" id="7688880">}</span><span class="op" id="7688881">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688888">[</span><span class="op" id="7688889">]</span><span class="op" id="7688890">*</span><span class="ident" id="7688891">Cookie</span><span class="op" id="7688897">{</span><span class="op" id="7688898">}</span><span class="op" id="7688899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7688903">&#34;&#34;</span><span class="op" id="7688905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688908">}</span><span class="op" id="7688909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688912">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688916">[</span><span class="op" id="7688917">]</span><span class="op" id="7688918">*</span><span class="ident" id="7688919">Cookie</span><span class="op" id="7688925">{</span><span class="op" id="7688926">{</span><span class="ident" id="7688927">Name</span><span class="op" id="7688931">:</span>&nbsp;<span class="string" id="7688933">&#34;cookie-1&#34;</span><span class="op" id="7688943">,</span>&nbsp;<span class="ident" id="7688945">Value</span><span class="op" id="7688950">:</span>&nbsp;<span class="string" id="7688952">&#34;v$1&#34;</span><span class="op" id="7688957">}</span><span class="op" id="7688958">}</span><span class="op" id="7688959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7688963">&#34;cookie-1=v$1&#34;</span><span class="op" id="7688977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688980">}</span><span class="op" id="7688981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7688988">[</span><span class="op" id="7688989">]</span><span class="op" id="7688990">*</span><span class="ident" id="7688991">Cookie</span><span class="op" id="7688997">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689002">{</span><span class="ident" id="7689003">Name</span><span class="op" id="7689007">:</span>&nbsp;<span class="string" id="7689009">&#34;cookie-1&#34;</span><span class="op" id="7689019">,</span>&nbsp;<span class="ident" id="7689021">Value</span><span class="op" id="7689026">:</span>&nbsp;<span class="string" id="7689028">&#34;v$1&#34;</span><span class="op" id="7689033">}</span><span class="op" id="7689034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689039">{</span><span class="ident" id="7689040">Name</span><span class="op" id="7689044">:</span>&nbsp;<span class="string" id="7689046">&#34;cookie-2&#34;</span><span class="op" id="7689056">,</span>&nbsp;<span class="ident" id="7689058">Value</span><span class="op" id="7689063">:</span>&nbsp;<span class="string" id="7689065">&#34;v$2&#34;</span><span class="op" id="7689070">}</span><span class="op" id="7689071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689076">{</span><span class="ident" id="7689077">Name</span><span class="op" id="7689081">:</span>&nbsp;<span class="string" id="7689083">&#34;cookie-3&#34;</span><span class="op" id="7689093">,</span>&nbsp;<span class="ident" id="7689095">Value</span><span class="op" id="7689100">:</span>&nbsp;<span class="string" id="7689102">&#34;v$3&#34;</span><span class="op" id="7689107">}</span><span class="op" id="7689108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689112">}</span><span class="op" id="7689113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7689117">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7689159">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689162">}</span><span class="op" id="7689163">,</span><br>
<span class="lineno"></span><span class="op" id="7689165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7689168">func</span>&nbsp;<span class="ident" id="7689173">TestAddCookie</span><span class="op" id="7689186">(</span><span class="ident" id="7689187">t</span>&nbsp;<span class="op" id="7689189">*</span><span class="ident" id="7689190">testing</span><span class="op" id="7689197">.</span><span class="ident" id="7689198">T</span><span class="op" id="7689199">)</span>&nbsp;<span class="op" id="7689201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7689204">for</span>&nbsp;<span class="ident" id="7689208">i</span><span class="op" id="7689209">,</span>&nbsp;<span class="ident" id="7689211">tt</span>&nbsp;<span class="op" id="7689214">:=</span>&nbsp;<span class="keyword" id="7689217">range</span>&nbsp;<span class="ident" id="7689223">addCookieTests</span>&nbsp;<span class="op" id="7689238">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689242">req</span><span class="op" id="7689245">,</span>&nbsp;<span class="ident" id="7689247">_</span>&nbsp;<span class="op" id="7689249">:=</span>&nbsp;<span class="ident" id="7689252">NewRequest</span><span class="op" id="7689262">(</span><span class="string" id="7689263">&#34;GET&#34;</span><span class="op" id="7689268">,</span>&nbsp;<span class="string" id="7689270">&#34;http://example.com/&#34;</span><span class="op" id="7689291">,</span>&nbsp;<span class="builtintype" id="7689293">nil</span><span class="op" id="7689296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7689300">for</span>&nbsp;<span class="ident" id="7689304">_</span><span class="op" id="7689305">,</span>&nbsp;<span class="ident" id="7689307">c</span>&nbsp;<span class="op" id="7689309">:=</span>&nbsp;<span class="keyword" id="7689312">range</span>&nbsp;<span class="ident" id="7689318">tt</span><span class="op" id="7689320">.</span><span class="ident" id="7689321">Cookies</span>&nbsp;<span class="op" id="7689329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689334">req</span><span class="op" id="7689337">.</span><span class="ident" id="7689338">AddCookie</span><span class="op" id="7689347">(</span><span class="ident" id="7689348">c</span><span class="op" id="7689349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7689357">if</span>&nbsp;<span class="ident" id="7689360">g</span>&nbsp;<span class="op" id="7689362">:=</span>&nbsp;<span class="ident" id="7689365">req</span><span class="op" id="7689368">.</span><span class="ident" id="7689369">Header</span><span class="op" id="7689375">.</span><span class="ident" id="7689376">Get</span><span class="op" id="7689379">(</span><span class="string" id="7689380">&#34;Cookie&#34;</span><span class="op" id="7689388">)</span><span class="op" id="7689389">;</span>&nbsp;<span class="ident" id="7689391">g</span>&nbsp;<span class="op" id="7689393">!=</span>&nbsp;<span class="ident" id="7689396">tt</span><span class="op" id="7689398">.</span><span class="ident" id="7689399">Raw</span>&nbsp;<span class="op" id="7689403">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689408">t</span><span class="op" id="7689409">.</span><span class="ident" id="7689410">Errorf</span><span class="op" id="7689416">(</span><span class="string" id="7689417">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7689449">,</span>&nbsp;<span class="ident" id="7689451">i</span><span class="op" id="7689452">,</span>&nbsp;<span class="ident" id="7689454">tt</span><span class="op" id="7689456">.</span><span class="ident" id="7689457">Raw</span><span class="op" id="7689460">,</span>&nbsp;<span class="ident" id="7689462">g</span><span class="op" id="7689463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7689468">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689482">}</span><br>
<span class="lineno"></span><span class="op" id="7689484">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7689487">var</span>&nbsp;<span class="ident" id="7689491">readSetCookiesTests</span>&nbsp;<span class="op" id="7689511">=</span>&nbsp;<span class="op" id="7689513">[</span><span class="op" id="7689514">]</span><span class="keyword" id="7689515">struct</span>&nbsp;<span class="op" id="7689522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689525">Header</span>&nbsp;&nbsp;<span class="ident" id="7689533">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689541">Cookies</span>&nbsp;<span class="op" id="7689549">[</span><span class="op" id="7689550">]</span><span class="op" id="7689551">*</span><span class="ident" id="7689552">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7689559">}</span><span class="op" id="7689560">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689567">Header</span><span class="op" id="7689573">{</span><span class="string" id="7689574">&#34;Set-Cookie&#34;</span><span class="op" id="7689586">:</span>&nbsp;<span class="op" id="7689588">{</span><span class="string" id="7689589">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7689603">}</span><span class="op" id="7689604">}</span><span class="op" id="7689605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689609">[</span><span class="op" id="7689610">]</span><span class="op" id="7689611">*</span><span class="ident" id="7689612">Cookie</span><span class="op" id="7689618">{</span><span class="op" id="7689619">{</span><span class="ident" id="7689620">Name</span><span class="op" id="7689624">:</span>&nbsp;<span class="string" id="7689626">&#34;Cookie-1&#34;</span><span class="op" id="7689636">,</span>&nbsp;<span class="ident" id="7689638">Value</span><span class="op" id="7689643">:</span>&nbsp;<span class="string" id="7689645">&#34;v$1&#34;</span><span class="op" id="7689650">,</span>&nbsp;<span class="ident" id="7689652">Raw</span><span class="op" id="7689655">:</span>&nbsp;<span class="string" id="7689657">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7689671">}</span><span class="op" id="7689672">}</span><span class="op" id="7689673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689676">}</span><span class="op" id="7689677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689680">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689684">Header</span><span class="op" id="7689690">{</span><span class="string" id="7689691">&#34;Set-Cookie&#34;</span><span class="op" id="7689703">:</span>&nbsp;<span class="op" id="7689705">{</span><span class="string" id="7689706">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7689805">}</span><span class="op" id="7689806">}</span><span class="op" id="7689807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7689811">[</span><span class="op" id="7689812">]</span><span class="op" id="7689813">*</span><span class="ident" id="7689814">Cookie</span><span class="op" id="7689820">{</span><span class="op" id="7689821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689826">Name</span><span class="op" id="7689830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7689838">&#34;NID&#34;</span><span class="op" id="7689843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689848">Value</span><span class="op" id="7689853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7689860">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7689879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689884">Path</span><span class="op" id="7689888">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7689896">&#34;/&#34;</span><span class="op" id="7689899">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689904">Domain</span><span class="op" id="7689910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7689916">&#34;.google.ch&#34;</span><span class="op" id="7689928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689933">HttpOnly</span><span class="op" id="7689941">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7689945">true</span><span class="op" id="7689949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689954">Expires</span><span class="op" id="7689961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7689966">time</span><span class="op" id="7689970">.</span><span class="ident" id="7689971">Date</span><span class="op" id="7689975">(</span><span class="num" id="7689976">2011</span><span class="op" id="7689980">,</span>&nbsp;<span class="num" id="7689982">11</span><span class="op" id="7689984">,</span>&nbsp;<span class="num" id="7689986">23</span><span class="op" id="7689988">,</span>&nbsp;<span class="num" id="7689990">1</span><span class="op" id="7689991">,</span>&nbsp;<span class="num" id="7689993">5</span><span class="op" id="7689994">,</span>&nbsp;<span class="num" id="7689996">3</span><span class="op" id="7689997">,</span>&nbsp;<span class="num" id="7689999">0</span><span class="op" id="7690000">,</span>&nbsp;<span class="ident" id="7690002">time</span><span class="op" id="7690006">.</span><span class="ident" id="7690007">UTC</span><span class="op" id="7690010">)</span><span class="op" id="7690011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690016">RawExpires</span><span class="op" id="7690026">:</span>&nbsp;<span class="string" id="7690028">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7690059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690064">Raw</span><span class="op" id="7690067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690076">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7690175">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690179">}</span><span class="op" id="7690180">}</span><span class="op" id="7690181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690184">}</span><span class="op" id="7690185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690192">Header</span><span class="op" id="7690198">{</span><span class="string" id="7690199">&#34;Set-Cookie&#34;</span><span class="op" id="7690211">:</span>&nbsp;<span class="op" id="7690213">{</span><span class="string" id="7690214">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7690288">}</span><span class="op" id="7690289">}</span><span class="op" id="7690290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690294">[</span><span class="op" id="7690295">]</span><span class="op" id="7690296">*</span><span class="ident" id="7690297">Cookie</span><span class="op" id="7690303">{</span><span class="op" id="7690304">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690309">Name</span><span class="op" id="7690313">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690321">&#34;.ASPXAUTH&#34;</span><span class="op" id="7690332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690337">Value</span><span class="op" id="7690342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690349">&#34;7E3AA&#34;</span><span class="op" id="7690356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690361">Path</span><span class="op" id="7690365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690373">&#34;/&#34;</span><span class="op" id="7690376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690381">Expires</span><span class="op" id="7690388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690393">time</span><span class="op" id="7690397">.</span><span class="ident" id="7690398">Date</span><span class="op" id="7690402">(</span><span class="num" id="7690403">2012</span><span class="op" id="7690407">,</span>&nbsp;<span class="num" id="7690409">3</span><span class="op" id="7690410">,</span>&nbsp;<span class="num" id="7690412">7</span><span class="op" id="7690413">,</span>&nbsp;<span class="num" id="7690415">14</span><span class="op" id="7690417">,</span>&nbsp;<span class="num" id="7690419">25</span><span class="op" id="7690421">,</span>&nbsp;<span class="num" id="7690423">6</span><span class="op" id="7690424">,</span>&nbsp;<span class="num" id="7690426">0</span><span class="op" id="7690427">,</span>&nbsp;<span class="ident" id="7690429">time</span><span class="op" id="7690433">.</span><span class="ident" id="7690434">UTC</span><span class="op" id="7690437">)</span><span class="op" id="7690438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690443">RawExpires</span><span class="op" id="7690453">:</span>&nbsp;<span class="string" id="7690455">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7690486">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690491">HttpOnly</span><span class="op" id="7690499">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7690503">true</span><span class="op" id="7690507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690512">Raw</span><span class="op" id="7690515">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690524">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7690598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690602">}</span><span class="op" id="7690603">}</span><span class="op" id="7690604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690607">}</span><span class="op" id="7690608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690611">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690615">Header</span><span class="op" id="7690621">{</span><span class="string" id="7690622">&#34;Set-Cookie&#34;</span><span class="op" id="7690634">:</span>&nbsp;<span class="op" id="7690636">{</span><span class="string" id="7690637">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7690678">}</span><span class="op" id="7690679">}</span><span class="op" id="7690680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690684">[</span><span class="op" id="7690685">]</span><span class="op" id="7690686">*</span><span class="ident" id="7690687">Cookie</span><span class="op" id="7690693">{</span><span class="op" id="7690694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690699">Name</span><span class="op" id="7690703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690709">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7690728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690733">Value</span><span class="op" id="7690738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690743">&#34;foo&#34;</span><span class="op" id="7690748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690753">Path</span><span class="op" id="7690757">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690763">&#34;/&#34;</span><span class="op" id="7690766">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690771">HttpOnly</span><span class="op" id="7690779">:</span>&nbsp;<span class="builtintype" id="7690781">true</span><span class="op" id="7690785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690790">Raw</span><span class="op" id="7690793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7690800">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7690841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690845">}</span><span class="op" id="7690846">}</span><span class="op" id="7690847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690850">}</span><span class="op" id="7690851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7690854">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7690927">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7690971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7690975">Header</span><span class="op" id="7690981">{</span><span class="string" id="7690982">&#34;Set-Cookie&#34;</span><span class="op" id="7690994">:</span>&nbsp;<span class="op" id="7690996">{</span><span class="string" id="7690997">`special-1=a&nbsp;z`</span><span class="op" id="7691012">}</span><span class="op" id="7691013">}</span><span class="op" id="7691014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691018">[</span><span class="op" id="7691019">]</span><span class="op" id="7691020">*</span><span class="ident" id="7691021">Cookie</span><span class="op" id="7691027">{</span><span class="op" id="7691028">{</span><span class="ident" id="7691029">Name</span><span class="op" id="7691033">:</span>&nbsp;<span class="string" id="7691035">&#34;special-1&#34;</span><span class="op" id="7691046">,</span>&nbsp;<span class="ident" id="7691048">Value</span><span class="op" id="7691053">:</span>&nbsp;<span class="string" id="7691055">&#34;a&nbsp;z&#34;</span><span class="op" id="7691060">,</span>&nbsp;<span class="ident" id="7691062">Raw</span><span class="op" id="7691065">:</span>&nbsp;<span class="string" id="7691067">`special-1=a&nbsp;z`</span><span class="op" id="7691082">}</span><span class="op" id="7691083">}</span><span class="op" id="7691084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691087">}</span><span class="op" id="7691088">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691095">Header</span><span class="op" id="7691101">{</span><span class="string" id="7691102">&#34;Set-Cookie&#34;</span><span class="op" id="7691114">:</span>&nbsp;<span class="op" id="7691116">{</span><span class="string" id="7691117">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7691133">}</span><span class="op" id="7691134">}</span><span class="op" id="7691135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691139">[</span><span class="op" id="7691140">]</span><span class="op" id="7691141">*</span><span class="ident" id="7691142">Cookie</span><span class="op" id="7691148">{</span><span class="op" id="7691149">{</span><span class="ident" id="7691150">Name</span><span class="op" id="7691154">:</span>&nbsp;<span class="string" id="7691156">&#34;special-2&#34;</span><span class="op" id="7691167">,</span>&nbsp;<span class="ident" id="7691169">Value</span><span class="op" id="7691174">:</span>&nbsp;<span class="string" id="7691176">&#34;&nbsp;z&#34;</span><span class="op" id="7691180">,</span>&nbsp;<span class="ident" id="7691182">Raw</span><span class="op" id="7691185">:</span>&nbsp;<span class="string" id="7691187">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7691203">}</span><span class="op" id="7691204">}</span><span class="op" id="7691205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691208">}</span><span class="op" id="7691209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691212">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691216">Header</span><span class="op" id="7691222">{</span><span class="string" id="7691223">&#34;Set-Cookie&#34;</span><span class="op" id="7691235">:</span>&nbsp;<span class="op" id="7691237">{</span><span class="string" id="7691238">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7691254">}</span><span class="op" id="7691255">}</span><span class="op" id="7691256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691260">[</span><span class="op" id="7691261">]</span><span class="op" id="7691262">*</span><span class="ident" id="7691263">Cookie</span><span class="op" id="7691269">{</span><span class="op" id="7691270">{</span><span class="ident" id="7691271">Name</span><span class="op" id="7691275">:</span>&nbsp;<span class="string" id="7691277">&#34;special-3&#34;</span><span class="op" id="7691288">,</span>&nbsp;<span class="ident" id="7691290">Value</span><span class="op" id="7691295">:</span>&nbsp;<span class="string" id="7691297">&#34;a&nbsp;&#34;</span><span class="op" id="7691301">,</span>&nbsp;<span class="ident" id="7691303">Raw</span><span class="op" id="7691306">:</span>&nbsp;<span class="string" id="7691308">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7691324">}</span><span class="op" id="7691325">}</span><span class="op" id="7691326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691329">}</span><span class="op" id="7691330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691337">Header</span><span class="op" id="7691343">{</span><span class="string" id="7691344">&#34;Set-Cookie&#34;</span><span class="op" id="7691356">:</span>&nbsp;<span class="op" id="7691358">{</span><span class="string" id="7691359">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7691374">}</span><span class="op" id="7691375">}</span><span class="op" id="7691376">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691380">[</span><span class="op" id="7691381">]</span><span class="op" id="7691382">*</span><span class="ident" id="7691383">Cookie</span><span class="op" id="7691389">{</span><span class="op" id="7691390">{</span><span class="ident" id="7691391">Name</span><span class="op" id="7691395">:</span>&nbsp;<span class="string" id="7691397">&#34;special-4&#34;</span><span class="op" id="7691408">,</span>&nbsp;<span class="ident" id="7691410">Value</span><span class="op" id="7691415">:</span>&nbsp;<span class="string" id="7691417">&#34;&nbsp;&#34;</span><span class="op" id="7691420">,</span>&nbsp;<span class="ident" id="7691422">Raw</span><span class="op" id="7691425">:</span>&nbsp;<span class="string" id="7691427">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7691442">}</span><span class="op" id="7691443">}</span><span class="op" id="7691444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691447">}</span><span class="op" id="7691448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691455">Header</span><span class="op" id="7691461">{</span><span class="string" id="7691462">&#34;Set-Cookie&#34;</span><span class="op" id="7691474">:</span>&nbsp;<span class="op" id="7691476">{</span><span class="string" id="7691477">`special-5=a,z`</span><span class="op" id="7691492">}</span><span class="op" id="7691493">}</span><span class="op" id="7691494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691498">[</span><span class="op" id="7691499">]</span><span class="op" id="7691500">*</span><span class="ident" id="7691501">Cookie</span><span class="op" id="7691507">{</span><span class="op" id="7691508">{</span><span class="ident" id="7691509">Name</span><span class="op" id="7691513">:</span>&nbsp;<span class="string" id="7691515">&#34;special-5&#34;</span><span class="op" id="7691526">,</span>&nbsp;<span class="ident" id="7691528">Value</span><span class="op" id="7691533">:</span>&nbsp;<span class="string" id="7691535">&#34;a,z&#34;</span><span class="op" id="7691540">,</span>&nbsp;<span class="ident" id="7691542">Raw</span><span class="op" id="7691545">:</span>&nbsp;<span class="string" id="7691547">`special-5=a,z`</span><span class="op" id="7691562">}</span><span class="op" id="7691563">}</span><span class="op" id="7691564">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691567">}</span><span class="op" id="7691568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691575">Header</span><span class="op" id="7691581">{</span><span class="string" id="7691582">&#34;Set-Cookie&#34;</span><span class="op" id="7691594">:</span>&nbsp;<span class="op" id="7691596">{</span><span class="string" id="7691597">`special-6=&#34;,z&#34;`</span><span class="op" id="7691613">}</span><span class="op" id="7691614">}</span><span class="op" id="7691615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691619">[</span><span class="op" id="7691620">]</span><span class="op" id="7691621">*</span><span class="ident" id="7691622">Cookie</span><span class="op" id="7691628">{</span><span class="op" id="7691629">{</span><span class="ident" id="7691630">Name</span><span class="op" id="7691634">:</span>&nbsp;<span class="string" id="7691636">&#34;special-6&#34;</span><span class="op" id="7691647">,</span>&nbsp;<span class="ident" id="7691649">Value</span><span class="op" id="7691654">:</span>&nbsp;<span class="string" id="7691656">&#34;,z&#34;</span><span class="op" id="7691660">,</span>&nbsp;<span class="ident" id="7691662">Raw</span><span class="op" id="7691665">:</span>&nbsp;<span class="string" id="7691667">`special-6=&#34;,z&#34;`</span><span class="op" id="7691683">}</span><span class="op" id="7691684">}</span><span class="op" id="7691685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691688">}</span><span class="op" id="7691689">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691696">Header</span><span class="op" id="7691702">{</span><span class="string" id="7691703">&#34;Set-Cookie&#34;</span><span class="op" id="7691715">:</span>&nbsp;<span class="op" id="7691717">{</span><span class="string" id="7691718">`special-7=a,`</span><span class="op" id="7691732">}</span><span class="op" id="7691733">}</span><span class="op" id="7691734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691738">[</span><span class="op" id="7691739">]</span><span class="op" id="7691740">*</span><span class="ident" id="7691741">Cookie</span><span class="op" id="7691747">{</span><span class="op" id="7691748">{</span><span class="ident" id="7691749">Name</span><span class="op" id="7691753">:</span>&nbsp;<span class="string" id="7691755">&#34;special-7&#34;</span><span class="op" id="7691766">,</span>&nbsp;<span class="ident" id="7691768">Value</span><span class="op" id="7691773">:</span>&nbsp;<span class="string" id="7691775">&#34;a,&#34;</span><span class="op" id="7691779">,</span>&nbsp;<span class="ident" id="7691781">Raw</span><span class="op" id="7691784">:</span>&nbsp;<span class="string" id="7691786">`special-7=a,`</span><span class="op" id="7691800">}</span><span class="op" id="7691801">}</span><span class="op" id="7691802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691805">}</span><span class="op" id="7691806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691809">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7691813">Header</span><span class="op" id="7691819">{</span><span class="string" id="7691820">&#34;Set-Cookie&#34;</span><span class="op" id="7691832">:</span>&nbsp;<span class="op" id="7691834">{</span><span class="string" id="7691835">`special-8=&#34;,&#34;`</span><span class="op" id="7691850">}</span><span class="op" id="7691851">}</span><span class="op" id="7691852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691856">[</span><span class="op" id="7691857">]</span><span class="op" id="7691858">*</span><span class="ident" id="7691859">Cookie</span><span class="op" id="7691865">{</span><span class="op" id="7691866">{</span><span class="ident" id="7691867">Name</span><span class="op" id="7691871">:</span>&nbsp;<span class="string" id="7691873">&#34;special-8&#34;</span><span class="op" id="7691884">,</span>&nbsp;<span class="ident" id="7691886">Value</span><span class="op" id="7691891">:</span>&nbsp;<span class="string" id="7691893">&#34;,&#34;</span><span class="op" id="7691896">,</span>&nbsp;<span class="ident" id="7691898">Raw</span><span class="op" id="7691901">:</span>&nbsp;<span class="string" id="7691903">`special-8=&#34;,&#34;`</span><span class="op" id="7691918">}</span><span class="op" id="7691919">}</span><span class="op" id="7691920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7691923">}</span><span class="op" id="7691924">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7691928">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7691987">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7692050">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7692114">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7692125">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7692269">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7692272">func</span>&nbsp;<span class="ident" id="7692277">toJSON</span><span class="op" id="7692283">(</span><span class="ident" id="7692284">v</span>&nbsp;<span class="keyword" id="7692286">interface</span><span class="op" id="7692295">{</span><span class="op" id="7692296">}</span><span class="op" id="7692297">)</span>&nbsp;<span class="builtintype" id="7692299">string</span>&nbsp;<span class="op" id="7692306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692309">b</span><span class="op" id="7692310">,</span>&nbsp;<span class="ident" id="7692312">err</span>&nbsp;<span class="op" id="7692316">:=</span>&nbsp;<span class="ident" id="7692319">json</span><span class="op" id="7692323">.</span><span class="ident" id="7692324">Marshal</span><span class="op" id="7692331">(</span><span class="ident" id="7692332">v</span><span class="op" id="7692333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692336">if</span>&nbsp;<span class="ident" id="7692339">err</span>&nbsp;<span class="op" id="7692343">!=</span>&nbsp;<span class="builtintype" id="7692346">nil</span>&nbsp;<span class="op" id="7692350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692354">return</span>&nbsp;<span class="ident" id="7692361">fmt</span><span class="op" id="7692364">.</span><span class="ident" id="7692365">Sprintf</span><span class="op" id="7692372">(</span><span class="string" id="7692373">&#34;%#v&#34;</span><span class="op" id="7692378">,</span>&nbsp;<span class="ident" id="7692380">v</span><span class="op" id="7692381">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692387">return</span>&nbsp;<span class="builtintype" id="7692394">string</span><span class="op" id="7692400">(</span><span class="ident" id="7692401">b</span><span class="op" id="7692402">)</span><br>
<span class="lineno"></span><span class="op" id="7692404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7692407">func</span>&nbsp;<span class="ident" id="7692412">TestReadSetCookies</span><span class="op" id="7692430">(</span><span class="ident" id="7692431">t</span>&nbsp;<span class="op" id="7692433">*</span><span class="ident" id="7692434">testing</span><span class="op" id="7692441">.</span><span class="ident" id="7692442">T</span><span class="op" id="7692443">)</span>&nbsp;<span class="op" id="7692445">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692448">for</span>&nbsp;<span class="ident" id="7692452">i</span><span class="op" id="7692453">,</span>&nbsp;<span class="ident" id="7692455">tt</span>&nbsp;<span class="op" id="7692458">:=</span>&nbsp;<span class="keyword" id="7692461">range</span>&nbsp;<span class="ident" id="7692467">readSetCookiesTests</span>&nbsp;<span class="op" id="7692487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692491">for</span>&nbsp;<span class="ident" id="7692495">n</span>&nbsp;<span class="op" id="7692497">:=</span>&nbsp;<span class="num" id="7692500">0</span><span class="op" id="7692501">;</span>&nbsp;<span class="ident" id="7692503">n</span>&nbsp;<span class="op" id="7692505">&lt;</span>&nbsp;<span class="num" id="7692507">2</span><span class="op" id="7692508">;</span>&nbsp;<span class="ident" id="7692510">n</span><span class="op" id="7692511">++</span>&nbsp;<span class="op" id="7692514">{</span>&nbsp;<span class="comment" id="7692516">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692572">c</span>&nbsp;<span class="op" id="7692574">:=</span>&nbsp;<span class="ident" id="7692577">readSetCookies</span><span class="op" id="7692591">(</span><span class="ident" id="7692592">tt</span><span class="op" id="7692594">.</span><span class="ident" id="7692595">Header</span><span class="op" id="7692601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692606">if</span>&nbsp;<span class="op" id="7692609">!</span><span class="ident" id="7692610">reflect</span><span class="op" id="7692617">.</span><span class="ident" id="7692618">DeepEqual</span><span class="op" id="7692627">(</span><span class="ident" id="7692628">c</span><span class="op" id="7692629">,</span>&nbsp;<span class="ident" id="7692631">tt</span><span class="op" id="7692633">.</span><span class="ident" id="7692634">Cookies</span><span class="op" id="7692641">)</span>&nbsp;<span class="op" id="7692643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692649">t</span><span class="op" id="7692650">.</span><span class="ident" id="7692651">Errorf</span><span class="op" id="7692657">(</span><span class="string" id="7692658">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7692700">,</span>&nbsp;<span class="ident" id="7692702">i</span><span class="op" id="7692703">,</span>&nbsp;<span class="ident" id="7692705">toJSON</span><span class="op" id="7692711">(</span><span class="ident" id="7692712">c</span><span class="op" id="7692713">)</span><span class="op" id="7692714">,</span>&nbsp;<span class="ident" id="7692716">toJSON</span><span class="op" id="7692722">(</span><span class="ident" id="7692723">tt</span><span class="op" id="7692725">.</span><span class="ident" id="7692726">Cookies</span><span class="op" id="7692733">)</span><span class="op" id="7692734">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7692740">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692759">}</span><br>
<span class="lineno"></span><span class="op" id="7692761">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7692764">var</span>&nbsp;<span class="ident" id="7692768">readCookiesTests</span>&nbsp;<span class="op" id="7692785">=</span>&nbsp;<span class="op" id="7692787">[</span><span class="op" id="7692788">]</span><span class="keyword" id="7692789">struct</span>&nbsp;<span class="op" id="7692796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692799">Header</span>&nbsp;&nbsp;<span class="ident" id="7692807">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692815">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7692823">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692831">Cookies</span>&nbsp;<span class="op" id="7692839">[</span><span class="op" id="7692840">]</span><span class="op" id="7692841">*</span><span class="ident" id="7692842">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7692849">}</span><span class="op" id="7692850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7692857">Header</span><span class="op" id="7692863">{</span><span class="string" id="7692864">&#34;Cookie&#34;</span><span class="op" id="7692872">:</span>&nbsp;<span class="op" id="7692874">{</span><span class="string" id="7692875">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7692889">,</span>&nbsp;<span class="string" id="7692891">&#34;c2=v2&#34;</span><span class="op" id="7692898">}</span><span class="op" id="7692899">}</span><span class="op" id="7692900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7692904">&#34;&#34;</span><span class="op" id="7692906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692910">[</span><span class="op" id="7692911">]</span><span class="op" id="7692912">*</span><span class="ident" id="7692913">Cookie</span><span class="op" id="7692919">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692924">{</span><span class="ident" id="7692925">Name</span><span class="op" id="7692929">:</span>&nbsp;<span class="string" id="7692931">&#34;Cookie-1&#34;</span><span class="op" id="7692941">,</span>&nbsp;<span class="ident" id="7692943">Value</span><span class="op" id="7692948">:</span>&nbsp;<span class="string" id="7692950">&#34;v$1&#34;</span><span class="op" id="7692955">}</span><span class="op" id="7692956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692961">{</span><span class="ident" id="7692962">Name</span><span class="op" id="7692966">:</span>&nbsp;<span class="string" id="7692968">&#34;c2&#34;</span><span class="op" id="7692972">,</span>&nbsp;<span class="ident" id="7692974">Value</span><span class="op" id="7692979">:</span>&nbsp;<span class="string" id="7692981">&#34;v2&#34;</span><span class="op" id="7692985">}</span><span class="op" id="7692986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692990">}</span><span class="op" id="7692991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692994">}</span><span class="op" id="7692995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7692998">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693002">Header</span><span class="op" id="7693008">{</span><span class="string" id="7693009">&#34;Cookie&#34;</span><span class="op" id="7693017">:</span>&nbsp;<span class="op" id="7693019">{</span><span class="string" id="7693020">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7693034">,</span>&nbsp;<span class="string" id="7693036">&#34;c2=v2&#34;</span><span class="op" id="7693043">}</span><span class="op" id="7693044">}</span><span class="op" id="7693045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7693049">&#34;c2&#34;</span><span class="op" id="7693053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693057">[</span><span class="op" id="7693058">]</span><span class="op" id="7693059">*</span><span class="ident" id="7693060">Cookie</span><span class="op" id="7693066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693071">{</span><span class="ident" id="7693072">Name</span><span class="op" id="7693076">:</span>&nbsp;<span class="string" id="7693078">&#34;c2&#34;</span><span class="op" id="7693082">,</span>&nbsp;<span class="ident" id="7693084">Value</span><span class="op" id="7693089">:</span>&nbsp;<span class="string" id="7693091">&#34;v2&#34;</span><span class="op" id="7693095">}</span><span class="op" id="7693096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693100">}</span><span class="op" id="7693101">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693104">}</span><span class="op" id="7693105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693112">Header</span><span class="op" id="7693118">{</span><span class="string" id="7693119">&#34;Cookie&#34;</span><span class="op" id="7693127">:</span>&nbsp;<span class="op" id="7693129">{</span><span class="string" id="7693130">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7693151">}</span><span class="op" id="7693152">}</span><span class="op" id="7693153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7693157">&#34;&#34;</span><span class="op" id="7693159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693163">[</span><span class="op" id="7693164">]</span><span class="op" id="7693165">*</span><span class="ident" id="7693166">Cookie</span><span class="op" id="7693172">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693177">{</span><span class="ident" id="7693178">Name</span><span class="op" id="7693182">:</span>&nbsp;<span class="string" id="7693184">&#34;Cookie-1&#34;</span><span class="op" id="7693194">,</span>&nbsp;<span class="ident" id="7693196">Value</span><span class="op" id="7693201">:</span>&nbsp;<span class="string" id="7693203">&#34;v$1&#34;</span><span class="op" id="7693208">}</span><span class="op" id="7693209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693214">{</span><span class="ident" id="7693215">Name</span><span class="op" id="7693219">:</span>&nbsp;<span class="string" id="7693221">&#34;c2&#34;</span><span class="op" id="7693225">,</span>&nbsp;<span class="ident" id="7693227">Value</span><span class="op" id="7693232">:</span>&nbsp;<span class="string" id="7693234">&#34;v2&#34;</span><span class="op" id="7693238">}</span><span class="op" id="7693239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693243">}</span><span class="op" id="7693244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693247">}</span><span class="op" id="7693248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693251">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693255">Header</span><span class="op" id="7693261">{</span><span class="string" id="7693262">&#34;Cookie&#34;</span><span class="op" id="7693270">:</span>&nbsp;<span class="op" id="7693272">{</span><span class="string" id="7693273">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7693294">}</span><span class="op" id="7693295">}</span><span class="op" id="7693296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7693300">&#34;c2&#34;</span><span class="op" id="7693304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693308">[</span><span class="op" id="7693309">]</span><span class="op" id="7693310">*</span><span class="ident" id="7693311">Cookie</span><span class="op" id="7693317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693322">{</span><span class="ident" id="7693323">Name</span><span class="op" id="7693327">:</span>&nbsp;<span class="string" id="7693329">&#34;c2&#34;</span><span class="op" id="7693333">,</span>&nbsp;<span class="ident" id="7693335">Value</span><span class="op" id="7693340">:</span>&nbsp;<span class="string" id="7693342">&#34;v2&#34;</span><span class="op" id="7693346">}</span><span class="op" id="7693347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693351">}</span><span class="op" id="7693352">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693355">}</span><span class="op" id="7693356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693363">Header</span><span class="op" id="7693369">{</span><span class="string" id="7693370">&#34;Cookie&#34;</span><span class="op" id="7693378">:</span>&nbsp;<span class="op" id="7693380">{</span><span class="string" id="7693381">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7693406">}</span><span class="op" id="7693407">}</span><span class="op" id="7693408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7693412">&#34;&#34;</span><span class="op" id="7693414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693418">[</span><span class="op" id="7693419">]</span><span class="op" id="7693420">*</span><span class="ident" id="7693421">Cookie</span><span class="op" id="7693427">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693432">{</span><span class="ident" id="7693433">Name</span><span class="op" id="7693437">:</span>&nbsp;<span class="string" id="7693439">&#34;Cookie-1&#34;</span><span class="op" id="7693449">,</span>&nbsp;<span class="ident" id="7693451">Value</span><span class="op" id="7693456">:</span>&nbsp;<span class="string" id="7693458">&#34;v$1&#34;</span><span class="op" id="7693463">}</span><span class="op" id="7693464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693469">{</span><span class="ident" id="7693470">Name</span><span class="op" id="7693474">:</span>&nbsp;<span class="string" id="7693476">&#34;c2&#34;</span><span class="op" id="7693480">,</span>&nbsp;<span class="ident" id="7693482">Value</span><span class="op" id="7693487">:</span>&nbsp;<span class="string" id="7693489">&#34;v2&#34;</span><span class="op" id="7693493">}</span><span class="op" id="7693494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693498">}</span><span class="op" id="7693499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693502">}</span><span class="op" id="7693503">,</span><br>
<span class="lineno"></span><span class="op" id="7693505">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7693508">func</span>&nbsp;<span class="ident" id="7693513">TestReadCookies</span><span class="op" id="7693528">(</span><span class="ident" id="7693529">t</span>&nbsp;<span class="op" id="7693531">*</span><span class="ident" id="7693532">testing</span><span class="op" id="7693539">.</span><span class="ident" id="7693540">T</span><span class="op" id="7693541">)</span>&nbsp;<span class="op" id="7693543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7693546">for</span>&nbsp;<span class="ident" id="7693550">i</span><span class="op" id="7693551">,</span>&nbsp;<span class="ident" id="7693553">tt</span>&nbsp;<span class="op" id="7693556">:=</span>&nbsp;<span class="keyword" id="7693559">range</span>&nbsp;<span class="ident" id="7693565">readCookiesTests</span>&nbsp;<span class="op" id="7693582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7693586">for</span>&nbsp;<span class="ident" id="7693590">n</span>&nbsp;<span class="op" id="7693592">:=</span>&nbsp;<span class="num" id="7693595">0</span><span class="op" id="7693596">;</span>&nbsp;<span class="ident" id="7693598">n</span>&nbsp;<span class="op" id="7693600">&lt;</span>&nbsp;<span class="num" id="7693602">2</span><span class="op" id="7693603">;</span>&nbsp;<span class="ident" id="7693605">n</span><span class="op" id="7693606">++</span>&nbsp;<span class="op" id="7693609">{</span>&nbsp;<span class="comment" id="7693611">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693664">c</span>&nbsp;<span class="op" id="7693666">:=</span>&nbsp;<span class="ident" id="7693669">readCookies</span><span class="op" id="7693680">(</span><span class="ident" id="7693681">tt</span><span class="op" id="7693683">.</span><span class="ident" id="7693684">Header</span><span class="op" id="7693690">,</span>&nbsp;<span class="ident" id="7693692">tt</span><span class="op" id="7693694">.</span><span class="ident" id="7693695">Filter</span><span class="op" id="7693701">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7693706">if</span>&nbsp;<span class="op" id="7693709">!</span><span class="ident" id="7693710">reflect</span><span class="op" id="7693717">.</span><span class="ident" id="7693718">DeepEqual</span><span class="op" id="7693727">(</span><span class="ident" id="7693728">c</span><span class="op" id="7693729">,</span>&nbsp;<span class="ident" id="7693731">tt</span><span class="op" id="7693733">.</span><span class="ident" id="7693734">Cookies</span><span class="op" id="7693741">)</span>&nbsp;<span class="op" id="7693743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693749">t</span><span class="op" id="7693750">.</span><span class="ident" id="7693751">Errorf</span><span class="op" id="7693757">(</span><span class="string" id="7693758">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7693798">,</span>&nbsp;<span class="ident" id="7693800">i</span><span class="op" id="7693801">,</span>&nbsp;<span class="ident" id="7693803">toJSON</span><span class="op" id="7693809">(</span><span class="ident" id="7693810">c</span><span class="op" id="7693811">)</span><span class="op" id="7693812">,</span>&nbsp;<span class="ident" id="7693814">toJSON</span><span class="op" id="7693820">(</span><span class="ident" id="7693821">tt</span><span class="op" id="7693823">.</span><span class="ident" id="7693824">Cookies</span><span class="op" id="7693831">)</span><span class="op" id="7693832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7693838">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693854">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7693857">}</span><br>
<span class="lineno"></span><span class="op" id="7693859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7693862">func</span>&nbsp;<span class="ident" id="7693867">TestSetCookieDoubleQuotes</span><span class="op" id="7693892">(</span><span class="ident" id="7693893">t</span>&nbsp;<span class="op" id="7693895">*</span><span class="ident" id="7693896">testing</span><span class="op" id="7693903">.</span><span class="ident" id="7693904">T</span><span class="op" id="7693905">)</span>&nbsp;<span class="op" id="7693907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693910">res</span>&nbsp;<span class="op" id="7693914">:=</span>&nbsp;<span class="op" id="7693917">&amp;</span><span class="ident" id="7693918">Response</span><span class="op" id="7693926">{</span><span class="ident" id="7693927">Header</span><span class="op" id="7693933">:</span>&nbsp;<span class="ident" id="7693935">Header</span><span class="op" id="7693941">{</span><span class="op" id="7693942">}</span><span class="op" id="7693943">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7693946">res</span><span class="op" id="7693949">.</span><span class="ident" id="7693950">Header</span><span class="op" id="7693956">.</span><span class="ident" id="7693957">Add</span><span class="op" id="7693960">(</span><span class="string" id="7693961">&#34;Set-Cookie&#34;</span><span class="op" id="7693973">,</span>&nbsp;<span class="string" id="7693975">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7694001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694004">res</span><span class="op" id="7694007">.</span><span class="ident" id="7694008">Header</span><span class="op" id="7694014">.</span><span class="ident" id="7694015">Add</span><span class="op" id="7694018">(</span><span class="string" id="7694019">&#34;Set-Cookie&#34;</span><span class="op" id="7694031">,</span>&nbsp;<span class="string" id="7694033">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7694068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694071">res</span><span class="op" id="7694074">.</span><span class="ident" id="7694075">Header</span><span class="op" id="7694081">.</span><span class="ident" id="7694082">Add</span><span class="op" id="7694085">(</span><span class="string" id="7694086">&#34;Set-Cookie&#34;</span><span class="op" id="7694098">,</span>&nbsp;<span class="string" id="7694100">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7694132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694135">res</span><span class="op" id="7694138">.</span><span class="ident" id="7694139">Header</span><span class="op" id="7694145">.</span><span class="ident" id="7694146">Add</span><span class="op" id="7694149">(</span><span class="string" id="7694150">&#34;Set-Cookie&#34;</span><span class="op" id="7694162">,</span>&nbsp;<span class="string" id="7694164">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7694194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694197">got</span>&nbsp;<span class="op" id="7694201">:=</span>&nbsp;<span class="ident" id="7694204">res</span><span class="op" id="7694207">.</span><span class="ident" id="7694208">Cookies</span><span class="op" id="7694215">(</span><span class="op" id="7694216">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694219">want</span>&nbsp;<span class="op" id="7694224">:=</span>&nbsp;<span class="op" id="7694227">[</span><span class="op" id="7694228">]</span><span class="op" id="7694229">*</span><span class="ident" id="7694230">Cookie</span><span class="op" id="7694236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694240">{</span><span class="ident" id="7694241">Name</span><span class="op" id="7694245">:</span>&nbsp;<span class="string" id="7694247">&#34;quoted0&#34;</span><span class="op" id="7694256">,</span>&nbsp;<span class="ident" id="7694258">Value</span><span class="op" id="7694263">:</span>&nbsp;<span class="string" id="7694265">&#34;none&#34;</span><span class="op" id="7694271">,</span>&nbsp;<span class="ident" id="7694273">MaxAge</span><span class="op" id="7694279">:</span>&nbsp;<span class="num" id="7694281">30</span><span class="op" id="7694283">}</span><span class="op" id="7694284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694288">{</span><span class="ident" id="7694289">Name</span><span class="op" id="7694293">:</span>&nbsp;<span class="string" id="7694295">&#34;quoted1&#34;</span><span class="op" id="7694304">,</span>&nbsp;<span class="ident" id="7694306">Value</span><span class="op" id="7694311">:</span>&nbsp;<span class="string" id="7694313">&#34;cookieValue&#34;</span><span class="op" id="7694326">,</span>&nbsp;<span class="ident" id="7694328">MaxAge</span><span class="op" id="7694334">:</span>&nbsp;<span class="num" id="7694336">31</span><span class="op" id="7694338">}</span><span class="op" id="7694339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694343">{</span><span class="ident" id="7694344">Name</span><span class="op" id="7694348">:</span>&nbsp;<span class="string" id="7694350">&#34;quoted2&#34;</span><span class="op" id="7694359">,</span>&nbsp;<span class="ident" id="7694361">Value</span><span class="op" id="7694366">:</span>&nbsp;<span class="string" id="7694368">&#34;cookieAV&#34;</span><span class="op" id="7694378">}</span><span class="op" id="7694379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694383">{</span><span class="ident" id="7694384">Name</span><span class="op" id="7694388">:</span>&nbsp;<span class="string" id="7694390">&#34;quoted3&#34;</span><span class="op" id="7694399">,</span>&nbsp;<span class="ident" id="7694401">Value</span><span class="op" id="7694406">:</span>&nbsp;<span class="string" id="7694408">&#34;both&#34;</span><span class="op" id="7694414">}</span><span class="op" id="7694415">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7694421">if</span>&nbsp;<span class="builtinfunc" id="7694424">len</span><span class="op" id="7694427">(</span><span class="ident" id="7694428">got</span><span class="op" id="7694431">)</span>&nbsp;<span class="op" id="7694433">!=</span>&nbsp;<span class="builtinfunc" id="7694436">len</span><span class="op" id="7694439">(</span><span class="ident" id="7694440">want</span><span class="op" id="7694444">)</span>&nbsp;<span class="op" id="7694446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694450">t</span><span class="op" id="7694451">.</span><span class="ident" id="7694452">Fatal</span><span class="op" id="7694457">(</span><span class="string" id="7694458">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7694483">,</span>&nbsp;<span class="builtinfunc" id="7694485">len</span><span class="op" id="7694488">(</span><span class="ident" id="7694489">got</span><span class="op" id="7694492">)</span><span class="op" id="7694493">,</span>&nbsp;<span class="builtinfunc" id="7694495">len</span><span class="op" id="7694498">(</span><span class="ident" id="7694499">want</span><span class="op" id="7694503">)</span><span class="op" id="7694504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7694510">for</span>&nbsp;<span class="ident" id="7694514">i</span><span class="op" id="7694515">,</span>&nbsp;<span class="ident" id="7694517">w</span>&nbsp;<span class="op" id="7694519">:=</span>&nbsp;<span class="keyword" id="7694522">range</span>&nbsp;<span class="ident" id="7694528">want</span>&nbsp;<span class="op" id="7694533">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694537">g</span>&nbsp;<span class="op" id="7694539">:=</span>&nbsp;<span class="ident" id="7694542">got</span><span class="op" id="7694545">[</span><span class="ident" id="7694546">i</span><span class="op" id="7694547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7694551">if</span>&nbsp;<span class="ident" id="7694554">g</span><span class="op" id="7694555">.</span><span class="ident" id="7694556">Name</span>&nbsp;<span class="op" id="7694561">!=</span>&nbsp;<span class="ident" id="7694564">w</span><span class="op" id="7694565">.</span><span class="ident" id="7694566">Name</span>&nbsp;<span class="op" id="7694571">||</span>&nbsp;<span class="ident" id="7694574">g</span><span class="op" id="7694575">.</span><span class="ident" id="7694576">Value</span>&nbsp;<span class="op" id="7694582">!=</span>&nbsp;<span class="ident" id="7694585">w</span><span class="op" id="7694586">.</span><span class="ident" id="7694587">Value</span>&nbsp;<span class="op" id="7694593">||</span>&nbsp;<span class="ident" id="7694596">g</span><span class="op" id="7694597">.</span><span class="ident" id="7694598">MaxAge</span>&nbsp;<span class="op" id="7694605">!=</span>&nbsp;<span class="ident" id="7694608">w</span><span class="op" id="7694609">.</span><span class="ident" id="7694610">MaxAge</span>&nbsp;<span class="op" id="7694617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694622">t</span><span class="op" id="7694623">.</span><span class="ident" id="7694624">Errorf</span><span class="op" id="7694630">(</span><span class="string" id="7694631">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7694662">,</span>&nbsp;<span class="ident" id="7694664">i</span><span class="op" id="7694665">,</span>&nbsp;<span class="ident" id="7694667">g</span><span class="op" id="7694668">,</span>&nbsp;<span class="ident" id="7694670">w</span><span class="op" id="7694671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694678">}</span><br>
<span class="lineno">360</span><span class="op" id="7694680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7694683">func</span>&nbsp;<span class="ident" id="7694688">TestCookieSanitizeValue</span><span class="op" id="7694711">(</span><span class="ident" id="7694712">t</span>&nbsp;<span class="op" id="7694714">*</span><span class="ident" id="7694715">testing</span><span class="op" id="7694722">.</span><span class="ident" id="7694723">T</span><span class="op" id="7694724">)</span>&nbsp;<span class="op" id="7694726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7694729">defer</span>&nbsp;<span class="ident" id="7694735">log</span><span class="op" id="7694738">.</span><span class="ident" id="7694739">SetOutput</span><span class="op" id="7694748">(</span><span class="ident" id="7694749">os</span><span class="op" id="7694751">.</span><span class="ident" id="7694752">Stderr</span><span class="op" id="7694758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7694761">var</span>&nbsp;<span class="ident" id="7694765">logbuf</span>&nbsp;<span class="ident" id="7694772">bytes</span><span class="op" id="7694777">.</span><span class="ident" id="7694778">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694786">log</span><span class="op" id="7694789">.</span><span class="ident" id="7694790">SetOutput</span><span class="op" id="7694799">(</span><span class="op" id="7694800">&amp;</span><span class="ident" id="7694801">logbuf</span><span class="op" id="7694807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694811">tests</span>&nbsp;<span class="op" id="7694817">:=</span>&nbsp;<span class="op" id="7694820">[</span><span class="op" id="7694821">]</span><span class="keyword" id="7694822">struct</span>&nbsp;<span class="op" id="7694829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7694833">in</span><span class="op" id="7694835">,</span>&nbsp;<span class="ident" id="7694837">want</span>&nbsp;<span class="builtintype" id="7694842">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694850">}</span><span class="op" id="7694851">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694855">{</span><span class="string" id="7694856">&#34;foo&#34;</span><span class="op" id="7694861">,</span>&nbsp;<span class="string" id="7694863">&#34;foo&#34;</span><span class="op" id="7694868">}</span><span class="op" id="7694869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694873">{</span><span class="string" id="7694874">&#34;foo;bar&#34;</span><span class="op" id="7694883">,</span>&nbsp;<span class="string" id="7694885">&#34;foobar&#34;</span><span class="op" id="7694893">}</span><span class="op" id="7694894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694898">{</span><span class="string" id="7694899">&#34;foo\\bar&#34;</span><span class="op" id="7694909">,</span>&nbsp;<span class="string" id="7694911">&#34;foobar&#34;</span><span class="op" id="7694919">}</span><span class="op" id="7694920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694924">{</span><span class="string" id="7694925">&#34;foo\&#34;bar&#34;</span><span class="op" id="7694935">,</span>&nbsp;<span class="string" id="7694937">&#34;foobar&#34;</span><span class="op" id="7694945">}</span><span class="op" id="7694946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694950">{</span><span class="string" id="7694951">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7694969">,</span>&nbsp;<span class="string" id="7694971">&#34;\x7e&#34;</span><span class="op" id="7694977">}</span><span class="op" id="7694978">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7694982">{</span><span class="string" id="7694983">`&#34;withquotes&#34;`</span><span class="op" id="7694997">,</span>&nbsp;<span class="string" id="7694999">&#34;withquotes&#34;</span><span class="op" id="7695011">}</span><span class="op" id="7695012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695016">{</span><span class="string" id="7695017">&#34;a&nbsp;z&#34;</span><span class="op" id="7695022">,</span>&nbsp;<span class="string" id="7695024">&#34;a&nbsp;z&#34;</span><span class="op" id="7695029">}</span><span class="op" id="7695030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695034">{</span><span class="string" id="7695035">&#34;&nbsp;z&#34;</span><span class="op" id="7695039">,</span>&nbsp;<span class="string" id="7695041">`&#34;&nbsp;z&#34;`</span><span class="op" id="7695047">}</span><span class="op" id="7695048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695052">{</span><span class="string" id="7695053">&#34;a&nbsp;&#34;</span><span class="op" id="7695057">,</span>&nbsp;<span class="string" id="7695059">`&#34;a&nbsp;&#34;`</span><span class="op" id="7695065">}</span><span class="op" id="7695066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695069">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695072">for</span>&nbsp;<span class="ident" id="7695076">_</span><span class="op" id="7695077">,</span>&nbsp;<span class="ident" id="7695079">tt</span>&nbsp;<span class="op" id="7695082">:=</span>&nbsp;<span class="keyword" id="7695085">range</span>&nbsp;<span class="ident" id="7695091">tests</span>&nbsp;<span class="op" id="7695097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695101">if</span>&nbsp;<span class="ident" id="7695104">got</span>&nbsp;<span class="op" id="7695108">:=</span>&nbsp;<span class="ident" id="7695111">sanitizeCookieValue</span><span class="op" id="7695130">(</span><span class="ident" id="7695131">tt</span><span class="op" id="7695133">.</span><span class="ident" id="7695134">in</span><span class="op" id="7695136">)</span><span class="op" id="7695137">;</span>&nbsp;<span class="ident" id="7695139">got</span>&nbsp;<span class="op" id="7695143">!=</span>&nbsp;<span class="ident" id="7695146">tt</span><span class="op" id="7695148">.</span><span class="ident" id="7695149">want</span>&nbsp;<span class="op" id="7695154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695159">t</span><span class="op" id="7695160">.</span><span class="ident" id="7695161">Errorf</span><span class="op" id="7695167">(</span><span class="string" id="7695168">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7695207">,</span>&nbsp;<span class="ident" id="7695209">tt</span><span class="op" id="7695211">.</span><span class="ident" id="7695212">in</span><span class="op" id="7695214">,</span>&nbsp;<span class="ident" id="7695216">got</span><span class="op" id="7695219">,</span>&nbsp;<span class="ident" id="7695221">tt</span><span class="op" id="7695223">.</span><span class="ident" id="7695224">want</span><span class="op" id="7695228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695235">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695239">if</span>&nbsp;<span class="ident" id="7695242">got</span><span class="op" id="7695245">,</span>&nbsp;<span class="ident" id="7695247">sub</span>&nbsp;<span class="op" id="7695251">:=</span>&nbsp;<span class="ident" id="7695254">logbuf</span><span class="op" id="7695260">.</span><span class="ident" id="7695261">String</span><span class="op" id="7695267">(</span><span class="op" id="7695268">)</span><span class="op" id="7695269">,</span>&nbsp;<span class="string" id="7695271">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7695295">;</span>&nbsp;<span class="op" id="7695297">!</span><span class="ident" id="7695298">strings</span><span class="op" id="7695305">.</span><span class="ident" id="7695306">Contains</span><span class="op" id="7695314">(</span><span class="ident" id="7695315">got</span><span class="op" id="7695318">,</span>&nbsp;<span class="ident" id="7695320">sub</span><span class="op" id="7695323">)</span>&nbsp;<span class="op" id="7695325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695329">t</span><span class="op" id="7695330">.</span><span class="ident" id="7695331">Errorf</span><span class="op" id="7695337">(</span><span class="string" id="7695338">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7695385">,</span>&nbsp;<span class="ident" id="7695387">sub</span><span class="op" id="7695390">,</span>&nbsp;<span class="ident" id="7695392">got</span><span class="op" id="7695395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695398">}</span><br>
<span class="lineno"></span><span class="op" id="7695400">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7695403">func</span>&nbsp;<span class="ident" id="7695408">TestCookieSanitizePath</span><span class="op" id="7695430">(</span><span class="ident" id="7695431">t</span>&nbsp;<span class="op" id="7695433">*</span><span class="ident" id="7695434">testing</span><span class="op" id="7695441">.</span><span class="ident" id="7695442">T</span><span class="op" id="7695443">)</span>&nbsp;<span class="op" id="7695445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695448">defer</span>&nbsp;<span class="ident" id="7695454">log</span><span class="op" id="7695457">.</span><span class="ident" id="7695458">SetOutput</span><span class="op" id="7695467">(</span><span class="ident" id="7695468">os</span><span class="op" id="7695470">.</span><span class="ident" id="7695471">Stderr</span><span class="op" id="7695477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695480">var</span>&nbsp;<span class="ident" id="7695484">logbuf</span>&nbsp;<span class="ident" id="7695491">bytes</span><span class="op" id="7695496">.</span><span class="ident" id="7695497">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695505">log</span><span class="op" id="7695508">.</span><span class="ident" id="7695509">SetOutput</span><span class="op" id="7695518">(</span><span class="op" id="7695519">&amp;</span><span class="ident" id="7695520">logbuf</span><span class="op" id="7695526">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695530">tests</span>&nbsp;<span class="op" id="7695536">:=</span>&nbsp;<span class="op" id="7695539">[</span><span class="op" id="7695540">]</span><span class="keyword" id="7695541">struct</span>&nbsp;<span class="op" id="7695548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695552">in</span><span class="op" id="7695554">,</span>&nbsp;<span class="ident" id="7695556">want</span>&nbsp;<span class="builtintype" id="7695561">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695569">}</span><span class="op" id="7695570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695574">{</span><span class="string" id="7695575">&#34;/path&#34;</span><span class="op" id="7695582">,</span>&nbsp;<span class="string" id="7695584">&#34;/path&#34;</span><span class="op" id="7695591">}</span><span class="op" id="7695592">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695596">{</span><span class="string" id="7695597">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7695616">,</span>&nbsp;<span class="string" id="7695618">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7695637">}</span><span class="op" id="7695638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695642">{</span><span class="string" id="7695643">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7695675">,</span>&nbsp;<span class="string" id="7695677">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7695703">}</span><span class="op" id="7695704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695710">for</span>&nbsp;<span class="ident" id="7695714">_</span><span class="op" id="7695715">,</span>&nbsp;<span class="ident" id="7695717">tt</span>&nbsp;<span class="op" id="7695720">:=</span>&nbsp;<span class="keyword" id="7695723">range</span>&nbsp;<span class="ident" id="7695729">tests</span>&nbsp;<span class="op" id="7695735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695739">if</span>&nbsp;<span class="ident" id="7695742">got</span>&nbsp;<span class="op" id="7695746">:=</span>&nbsp;<span class="ident" id="7695749">sanitizeCookiePath</span><span class="op" id="7695767">(</span><span class="ident" id="7695768">tt</span><span class="op" id="7695770">.</span><span class="ident" id="7695771">in</span><span class="op" id="7695773">)</span><span class="op" id="7695774">;</span>&nbsp;<span class="ident" id="7695776">got</span>&nbsp;<span class="op" id="7695780">!=</span>&nbsp;<span class="ident" id="7695783">tt</span><span class="op" id="7695785">.</span><span class="ident" id="7695786">want</span>&nbsp;<span class="op" id="7695791">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695796">t</span><span class="op" id="7695797">.</span><span class="ident" id="7695798">Errorf</span><span class="op" id="7695804">(</span><span class="string" id="7695805">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7695843">,</span>&nbsp;<span class="ident" id="7695845">tt</span><span class="op" id="7695847">.</span><span class="ident" id="7695848">in</span><span class="op" id="7695850">,</span>&nbsp;<span class="ident" id="7695852">got</span><span class="op" id="7695855">,</span>&nbsp;<span class="ident" id="7695857">tt</span><span class="op" id="7695859">.</span><span class="ident" id="7695860">want</span><span class="op" id="7695864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7695871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7695875">if</span>&nbsp;<span class="ident" id="7695878">got</span><span class="op" id="7695881">,</span>&nbsp;<span class="ident" id="7695883">sub</span>&nbsp;<span class="op" id="7695887">:=</span>&nbsp;<span class="ident" id="7695890">logbuf</span><span class="op" id="7695896">.</span><span class="ident" id="7695897">String</span><span class="op" id="7695903">(</span><span class="op" id="7695904">)</span><span class="op" id="7695905">,</span>&nbsp;<span class="string" id="7695907">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7695931">;</span>&nbsp;<span class="op" id="7695933">!</span><span class="ident" id="7695934">strings</span><span class="op" id="7695941">.</span><span class="ident" id="7695942">Contains</span><span class="op" id="7695950">(</span><span class="ident" id="7695951">got</span><span class="op" id="7695954">,</span>&nbsp;<span class="ident" id="7695956">sub</span><span class="op" id="7695959">)</span>&nbsp;<span class="op" id="7695961">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7695965">t</span><span class="op" id="7695966">.</span><span class="ident" id="7695967">Errorf</span><span class="op" id="7695973">(</span><span class="string" id="7695974">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7696021">,</span>&nbsp;<span class="ident" id="7696023">sub</span><span class="op" id="7696026">,</span>&nbsp;<span class="ident" id="7696028">got</span><span class="op" id="7696031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7696034">}</span><br>
<span class="lineno"></span><span class="op" id="7696036">}</span>
</div>
</body>
</html>
