<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6227981">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6228036">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6228090">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6228141">package</span>&nbsp;<span class="ident" id="6228149">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6228156">import</span>&nbsp;<span class="string" id="6228163">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6228171">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6228231">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6228301">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6228359">//</span><br>
<span class="lineno"></span><span class="comment" id="6228362">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6228410">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6228474">//</span><br>
<span class="lineno"></span><span class="comment" id="6228477">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6228538">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6228608">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6228683">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6228750">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6228823">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6228895">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6228909">//</span><br>
<span class="lineno"></span><span class="comment" id="6228912">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6228978">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6229044">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6229057">//</span><br>
<span class="lineno"></span><span class="comment" id="6229060">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6229084">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6229114">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="6229137">//</span><br>
<span class="lineno"></span><span class="comment" id="6229140">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6229156">//</span><br>
<span class="lineno">35</span><span class="comment" id="6229159">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6229192">//</span><br>
<span class="lineno"></span><span class="comment" id="6229195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6229224">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="6229254">//</span><br>
<span class="lineno">40</span><span class="comment" id="6229257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="6229286">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="6229316">//</span><br>
<span class="lineno"></span><span class="comment" id="6229319">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6229379">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="6229411">//</span><br>
<span class="lineno"></span><span class="comment" id="6229414">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="6229475">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="6229545">//</span><br>
<span class="lineno"></span><span class="comment" id="6229548">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="6229561">//</span><br>
<span class="lineno"></span><span class="comment" id="6229564">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6229604">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6229662">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="6229722">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6229783">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="6229821">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="6229911">func</span>&nbsp;<span class="ident" id="6229916">Sqrt</span><span class="op" id="6229920">(</span><span class="ident" id="6229921">x</span>&nbsp;<span class="builtintype" id="6229923">complex128</span><span class="op" id="6229933">)</span>&nbsp;<span class="builtintype" id="6229935">complex128</span>&nbsp;<span class="op" id="6229946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229949">if</span>&nbsp;<span class="builtinfunc" id="6229952">imag</span><span class="op" id="6229956">(</span><span class="ident" id="6229957">x</span><span class="op" id="6229958">)</span>&nbsp;<span class="op" id="6229960">==</span>&nbsp;<span class="num" id="6229963">0</span>&nbsp;<span class="op" id="6229965">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229969">if</span>&nbsp;<span class="builtinfunc" id="6229972">real</span><span class="op" id="6229976">(</span><span class="ident" id="6229977">x</span><span class="op" id="6229978">)</span>&nbsp;<span class="op" id="6229980">==</span>&nbsp;<span class="num" id="6229983">0</span>&nbsp;<span class="op" id="6229985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229990">return</span>&nbsp;<span class="builtinfunc" id="6229997">complex</span><span class="op" id="6230004">(</span><span class="num" id="6230005">0</span><span class="op" id="6230006">,</span>&nbsp;<span class="num" id="6230008">0</span><span class="op" id="6230009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230017">if</span>&nbsp;<span class="builtinfunc" id="6230020">real</span><span class="op" id="6230024">(</span><span class="ident" id="6230025">x</span><span class="op" id="6230026">)</span>&nbsp;<span class="op" id="6230028">&lt;</span>&nbsp;<span class="num" id="6230030">0</span>&nbsp;<span class="op" id="6230032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230037">return</span>&nbsp;<span class="builtinfunc" id="6230044">complex</span><span class="op" id="6230051">(</span><span class="num" id="6230052">0</span><span class="op" id="6230053">,</span>&nbsp;<span class="ident" id="6230055">math</span><span class="op" id="6230059">.</span><span class="ident" id="6230060">Sqrt</span><span class="op" id="6230064">(</span><span class="op" id="6230065">-</span><span class="builtinfunc" id="6230066">real</span><span class="op" id="6230070">(</span><span class="ident" id="6230071">x</span><span class="op" id="6230072">)</span><span class="op" id="6230073">)</span><span class="op" id="6230074">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230082">return</span>&nbsp;<span class="builtinfunc" id="6230089">complex</span><span class="op" id="6230096">(</span><span class="ident" id="6230097">math</span><span class="op" id="6230101">.</span><span class="ident" id="6230102">Sqrt</span><span class="op" id="6230106">(</span><span class="builtinfunc" id="6230107">real</span><span class="op" id="6230111">(</span><span class="ident" id="6230112">x</span><span class="op" id="6230113">)</span><span class="op" id="6230114">)</span><span class="op" id="6230115">,</span>&nbsp;<span class="num" id="6230117">0</span><span class="op" id="6230118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230124">if</span>&nbsp;<span class="builtinfunc" id="6230127">real</span><span class="op" id="6230131">(</span><span class="ident" id="6230132">x</span><span class="op" id="6230133">)</span>&nbsp;<span class="op" id="6230135">==</span>&nbsp;<span class="num" id="6230138">0</span>&nbsp;<span class="op" id="6230140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230144">if</span>&nbsp;<span class="builtinfunc" id="6230147">imag</span><span class="op" id="6230151">(</span><span class="ident" id="6230152">x</span><span class="op" id="6230153">)</span>&nbsp;<span class="op" id="6230155">&lt;</span>&nbsp;<span class="num" id="6230157">0</span>&nbsp;<span class="op" id="6230159">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230164">r</span>&nbsp;<span class="op" id="6230166">:=</span>&nbsp;<span class="ident" id="6230169">math</span><span class="op" id="6230173">.</span><span class="ident" id="6230174">Sqrt</span><span class="op" id="6230178">(</span><span class="op" id="6230179">-</span><span class="num" id="6230180">0.5</span>&nbsp;<span class="op" id="6230184">*</span>&nbsp;<span class="builtinfunc" id="6230186">imag</span><span class="op" id="6230190">(</span><span class="ident" id="6230191">x</span><span class="op" id="6230192">)</span><span class="op" id="6230193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230198">return</span>&nbsp;<span class="builtinfunc" id="6230205">complex</span><span class="op" id="6230212">(</span><span class="ident" id="6230213">r</span><span class="op" id="6230214">,</span>&nbsp;<span class="op" id="6230216">-</span><span class="ident" id="6230217">r</span><span class="op" id="6230218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230226">r</span>&nbsp;<span class="op" id="6230228">:=</span>&nbsp;<span class="ident" id="6230231">math</span><span class="op" id="6230235">.</span><span class="ident" id="6230236">Sqrt</span><span class="op" id="6230240">(</span><span class="num" id="6230241">0.5</span>&nbsp;<span class="op" id="6230245">*</span>&nbsp;<span class="builtinfunc" id="6230247">imag</span><span class="op" id="6230251">(</span><span class="ident" id="6230252">x</span><span class="op" id="6230253">)</span><span class="op" id="6230254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230258">return</span>&nbsp;<span class="builtinfunc" id="6230265">complex</span><span class="op" id="6230272">(</span><span class="ident" id="6230273">r</span><span class="op" id="6230274">,</span>&nbsp;<span class="ident" id="6230276">r</span><span class="op" id="6230277">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230283">a</span>&nbsp;<span class="op" id="6230285">:=</span>&nbsp;<span class="builtinfunc" id="6230288">real</span><span class="op" id="6230292">(</span><span class="ident" id="6230293">x</span><span class="op" id="6230294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230297">b</span>&nbsp;<span class="op" id="6230299">:=</span>&nbsp;<span class="builtinfunc" id="6230302">imag</span><span class="op" id="6230306">(</span><span class="ident" id="6230307">x</span><span class="op" id="6230308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230311">var</span>&nbsp;<span class="ident" id="6230315">scale</span>&nbsp;<span class="builtintype" id="6230321">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230330">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230383">if</span>&nbsp;<span class="ident" id="6230386">math</span><span class="op" id="6230390">.</span><span class="ident" id="6230391">Abs</span><span class="op" id="6230394">(</span><span class="ident" id="6230395">a</span><span class="op" id="6230396">)</span>&nbsp;<span class="op" id="6230398">&gt;</span>&nbsp;<span class="num" id="6230400">4</span>&nbsp;<span class="op" id="6230402">||</span>&nbsp;<span class="ident" id="6230405">math</span><span class="op" id="6230409">.</span><span class="ident" id="6230410">Abs</span><span class="op" id="6230413">(</span><span class="ident" id="6230414">b</span><span class="op" id="6230415">)</span>&nbsp;<span class="op" id="6230417">&gt;</span>&nbsp;<span class="num" id="6230419">4</span>&nbsp;<span class="op" id="6230421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230425">a</span>&nbsp;<span class="op" id="6230427">*=</span>&nbsp;<span class="num" id="6230430">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230437">b</span>&nbsp;<span class="op" id="6230439">*=</span>&nbsp;<span class="num" id="6230442">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230449">scale</span>&nbsp;<span class="op" id="6230455">=</span>&nbsp;<span class="num" id="6230457">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230460">}</span>&nbsp;<span class="keyword" id="6230462">else</span>&nbsp;<span class="op" id="6230467">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230471">a</span>&nbsp;<span class="op" id="6230473">*=</span>&nbsp;<span class="num" id="6230476">1.8014398509481984e16</span>&nbsp;<span class="comment" id="6230498">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230509">b</span>&nbsp;<span class="op" id="6230511">*=</span>&nbsp;<span class="num" id="6230514">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230538">scale</span>&nbsp;<span class="op" id="6230544">=</span>&nbsp;<span class="num" id="6230546">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="6230570">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230584">r</span>&nbsp;<span class="op" id="6230586">:=</span>&nbsp;<span class="ident" id="6230589">math</span><span class="op" id="6230593">.</span><span class="ident" id="6230594">Hypot</span><span class="op" id="6230599">(</span><span class="ident" id="6230600">a</span><span class="op" id="6230601">,</span>&nbsp;<span class="ident" id="6230603">b</span><span class="op" id="6230604">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230607">var</span>&nbsp;<span class="ident" id="6230611">t</span>&nbsp;<span class="builtintype" id="6230613">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230622">if</span>&nbsp;<span class="ident" id="6230625">a</span>&nbsp;<span class="op" id="6230627">&gt;</span>&nbsp;<span class="num" id="6230629">0</span>&nbsp;<span class="op" id="6230631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230635">t</span>&nbsp;<span class="op" id="6230637">=</span>&nbsp;<span class="ident" id="6230639">math</span><span class="op" id="6230643">.</span><span class="ident" id="6230644">Sqrt</span><span class="op" id="6230648">(</span><span class="num" id="6230649">0.5</span><span class="op" id="6230652">*</span><span class="ident" id="6230653">r</span>&nbsp;<span class="op" id="6230655">+</span>&nbsp;<span class="num" id="6230657">0.5</span><span class="op" id="6230660">*</span><span class="ident" id="6230661">a</span><span class="op" id="6230662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230666">r</span>&nbsp;<span class="op" id="6230668">=</span>&nbsp;<span class="ident" id="6230670">scale</span>&nbsp;<span class="op" id="6230676">*</span>&nbsp;<span class="ident" id="6230678">math</span><span class="op" id="6230682">.</span><span class="ident" id="6230683">Abs</span><span class="op" id="6230686">(</span><span class="op" id="6230687">(</span><span class="num" id="6230688">0.5</span><span class="op" id="6230691">*</span><span class="ident" id="6230692">b</span><span class="op" id="6230693">)</span><span class="op" id="6230694">/</span><span class="ident" id="6230695">t</span><span class="op" id="6230696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230700">t</span>&nbsp;<span class="op" id="6230702">*=</span>&nbsp;<span class="ident" id="6230705">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230712">}</span>&nbsp;<span class="keyword" id="6230714">else</span>&nbsp;<span class="op" id="6230719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230723">r</span>&nbsp;<span class="op" id="6230725">=</span>&nbsp;<span class="ident" id="6230727">math</span><span class="op" id="6230731">.</span><span class="ident" id="6230732">Sqrt</span><span class="op" id="6230736">(</span><span class="num" id="6230737">0.5</span><span class="op" id="6230740">*</span><span class="ident" id="6230741">r</span>&nbsp;<span class="op" id="6230743">-</span>&nbsp;<span class="num" id="6230745">0.5</span><span class="op" id="6230748">*</span><span class="ident" id="6230749">a</span><span class="op" id="6230750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230754">t</span>&nbsp;<span class="op" id="6230756">=</span>&nbsp;<span class="ident" id="6230758">scale</span>&nbsp;<span class="op" id="6230764">*</span>&nbsp;<span class="ident" id="6230766">math</span><span class="op" id="6230770">.</span><span class="ident" id="6230771">Abs</span><span class="op" id="6230774">(</span><span class="op" id="6230775">(</span><span class="num" id="6230776">0.5</span><span class="op" id="6230779">*</span><span class="ident" id="6230780">b</span><span class="op" id="6230781">)</span><span class="op" id="6230782">/</span><span class="ident" id="6230783">r</span><span class="op" id="6230784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230788">r</span>&nbsp;<span class="op" id="6230790">*=</span>&nbsp;<span class="ident" id="6230793">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230800">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230803">if</span>&nbsp;<span class="ident" id="6230806">b</span>&nbsp;<span class="op" id="6230808">&lt;</span>&nbsp;<span class="num" id="6230810">0</span>&nbsp;<span class="op" id="6230812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230816">return</span>&nbsp;<span class="builtinfunc" id="6230823">complex</span><span class="op" id="6230830">(</span><span class="ident" id="6230831">t</span><span class="op" id="6230832">,</span>&nbsp;<span class="op" id="6230834">-</span><span class="ident" id="6230835">r</span><span class="op" id="6230836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230842">return</span>&nbsp;<span class="builtinfunc" id="6230849">complex</span><span class="op" id="6230856">(</span><span class="ident" id="6230857">t</span><span class="op" id="6230858">,</span>&nbsp;<span class="ident" id="6230860">r</span><span class="op" id="6230861">)</span><br>
<span class="lineno"></span><span class="op" id="6230863">}</span>
</div>
</body>
</html>
