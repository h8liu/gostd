<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3303691">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3303746">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3303800">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3303851">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3303890">//</span><br>
<span class="lineno"></span><span class="comment" id="3303893">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3303953">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3303992">//</span><br>
<span class="lineno">10</span><span class="comment" id="3303995">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3304055">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3304120">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3304187">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3304211">//</span><br>
<span class="lineno">15</span><span class="comment" id="3304214">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3304278">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3304348">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3304411">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3304444">//</span><br>
<span class="lineno">20</span><span class="comment" id="3304447">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3304523">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304590">package</span>&nbsp;<span class="ident" id="3304598">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3304603">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3304622">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3304641">const</span>&nbsp;<span class="op" id="3304647">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304650">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304702">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304715">=</span>&nbsp;<span class="num" id="3304717">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304720">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304733">=</span>&nbsp;<span class="num" id="3304735">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304738">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304751">=</span>&nbsp;<span class="num" id="3304753">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304756">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304769">=</span>&nbsp;<span class="num" id="3304771">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304774">dnsTypeCNAME</span>&nbsp;<span class="op" id="3304787">=</span>&nbsp;<span class="num" id="3304789">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304792">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3304805">=</span>&nbsp;<span class="num" id="3304807">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304810">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304823">=</span>&nbsp;<span class="num" id="3304825">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304828">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304841">=</span>&nbsp;<span class="num" id="3304843">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304846">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304859">=</span>&nbsp;<span class="num" id="3304861">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304864">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3304877">=</span>&nbsp;<span class="num" id="3304879">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304883">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3304896">=</span>&nbsp;<span class="num" id="3304898">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304902">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3304915">=</span>&nbsp;<span class="num" id="3304917">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304921">dnsTypeHINFO</span>&nbsp;<span class="op" id="3304934">=</span>&nbsp;<span class="num" id="3304936">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304940">dnsTypeMINFO</span>&nbsp;<span class="op" id="3304953">=</span>&nbsp;<span class="num" id="3304955">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304959">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304972">=</span>&nbsp;<span class="num" id="3304974">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304978">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3304991">=</span>&nbsp;<span class="num" id="3304993">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304997">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3305010">=</span>&nbsp;<span class="num" id="3305012">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305016">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3305029">=</span>&nbsp;<span class="num" id="3305031">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305036">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305069">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3305082">=</span>&nbsp;<span class="num" id="3305084">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305089">dnsTypeMAILB</span>&nbsp;<span class="op" id="3305102">=</span>&nbsp;<span class="num" id="3305104">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305109">dnsTypeMAILA</span>&nbsp;<span class="op" id="3305122">=</span>&nbsp;<span class="num" id="3305124">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305129">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3305142">=</span>&nbsp;<span class="num" id="3305144">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305150">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305179">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3305194">=</span>&nbsp;<span class="num" id="3305196">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305199">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3305214">=</span>&nbsp;<span class="num" id="3305216">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305219">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3305234">=</span>&nbsp;<span class="num" id="3305236">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305239">dnsClassHESIOD</span>&nbsp;<span class="op" id="3305254">=</span>&nbsp;<span class="num" id="3305256">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305259">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305274">=</span>&nbsp;<span class="num" id="3305276">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305282">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305299">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305322">=</span>&nbsp;<span class="num" id="3305324">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305327">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305350">=</span>&nbsp;<span class="num" id="3305352">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305355">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3305378">=</span>&nbsp;<span class="num" id="3305380">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305383">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305406">=</span>&nbsp;<span class="num" id="3305408">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305411">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3305434">=</span>&nbsp;<span class="num" id="3305436">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305439">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3305462">=</span>&nbsp;<span class="num" id="3305464">5</span><br>
<span class="lineno"></span><span class="op" id="3305466">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3305469">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3305536">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3305563">type</span>&nbsp;<span class="ident" id="3305568">dnsStruct</span>&nbsp;<span class="keyword" id="3305578">interface</span>&nbsp;<span class="op" id="3305588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305591">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305648">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305706">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305762">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305812">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305868">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305910">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305966">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306004">Walk</span><span class="op" id="3306008">(</span><span class="ident" id="3306009">f</span>&nbsp;<span class="keyword" id="3306011">func</span><span class="op" id="3306015">(</span><span class="ident" id="3306016">v</span>&nbsp;<span class="keyword" id="3306018">interface</span><span class="op" id="3306027">{</span><span class="op" id="3306028">}</span><span class="op" id="3306029">,</span>&nbsp;<span class="ident" id="3306031">name</span><span class="op" id="3306035">,</span>&nbsp;<span class="ident" id="3306037">tag</span>&nbsp;<span class="builtintype" id="3306041">string</span><span class="op" id="3306047">)</span>&nbsp;<span class="op" id="3306049">(</span><span class="ident" id="3306050">ok</span>&nbsp;<span class="builtintype" id="3306053">bool</span><span class="op" id="3306057">)</span><span class="op" id="3306058">)</span>&nbsp;<span class="op" id="3306060">(</span><span class="ident" id="3306061">ok</span>&nbsp;<span class="builtintype" id="3306064">bool</span><span class="op" id="3306068">)</span><br>
<span class="lineno"></span><span class="op" id="3306070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3306073">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3306119">type</span>&nbsp;<span class="ident" id="3306124">dnsHeader</span>&nbsp;<span class="keyword" id="3306134">struct</span>&nbsp;<span class="op" id="3306141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306144">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3306179">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306187">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3306222">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306230">Qdcount</span><span class="op" id="3306237">,</span>&nbsp;<span class="ident" id="3306239">Ancount</span><span class="op" id="3306246">,</span>&nbsp;<span class="ident" id="3306248">Nscount</span><span class="op" id="3306255">,</span>&nbsp;<span class="ident" id="3306257">Arcount</span>&nbsp;<span class="builtintype" id="3306265">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3306272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3306275">func</span>&nbsp;<span class="op" id="3306280">(</span><span class="ident" id="3306281">h</span>&nbsp;<span class="op" id="3306283">*</span><span class="ident" id="3306284">dnsHeader</span><span class="op" id="3306293">)</span>&nbsp;<span class="ident" id="3306295">Walk</span><span class="op" id="3306299">(</span><span class="ident" id="3306300">f</span>&nbsp;<span class="keyword" id="3306302">func</span><span class="op" id="3306306">(</span><span class="ident" id="3306307">v</span>&nbsp;<span class="keyword" id="3306309">interface</span><span class="op" id="3306318">{</span><span class="op" id="3306319">}</span><span class="op" id="3306320">,</span>&nbsp;<span class="ident" id="3306322">name</span><span class="op" id="3306326">,</span>&nbsp;<span class="ident" id="3306328">tag</span>&nbsp;<span class="builtintype" id="3306332">string</span><span class="op" id="3306338">)</span>&nbsp;<span class="builtintype" id="3306340">bool</span><span class="op" id="3306344">)</span>&nbsp;<span class="builtintype" id="3306346">bool</span>&nbsp;<span class="op" id="3306351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306354">return</span>&nbsp;<span class="ident" id="3306361">f</span><span class="op" id="3306362">(</span><span class="op" id="3306363">&amp;</span><span class="ident" id="3306364">h</span><span class="op" id="3306365">.</span><span class="ident" id="3306366">Id</span><span class="op" id="3306368">,</span>&nbsp;<span class="string" id="3306370">&#34;Id&#34;</span><span class="op" id="3306374">,</span>&nbsp;<span class="string" id="3306376">&#34;&#34;</span><span class="op" id="3306378">)</span>&nbsp;<span class="op" id="3306380">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306385">f</span><span class="op" id="3306386">(</span><span class="op" id="3306387">&amp;</span><span class="ident" id="3306388">h</span><span class="op" id="3306389">.</span><span class="ident" id="3306390">Bits</span><span class="op" id="3306394">,</span>&nbsp;<span class="string" id="3306396">&#34;Bits&#34;</span><span class="op" id="3306402">,</span>&nbsp;<span class="string" id="3306404">&#34;&#34;</span><span class="op" id="3306406">)</span>&nbsp;<span class="op" id="3306408">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306413">f</span><span class="op" id="3306414">(</span><span class="op" id="3306415">&amp;</span><span class="ident" id="3306416">h</span><span class="op" id="3306417">.</span><span class="ident" id="3306418">Qdcount</span><span class="op" id="3306425">,</span>&nbsp;<span class="string" id="3306427">&#34;Qdcount&#34;</span><span class="op" id="3306436">,</span>&nbsp;<span class="string" id="3306438">&#34;&#34;</span><span class="op" id="3306440">)</span>&nbsp;<span class="op" id="3306442">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306447">f</span><span class="op" id="3306448">(</span><span class="op" id="3306449">&amp;</span><span class="ident" id="3306450">h</span><span class="op" id="3306451">.</span><span class="ident" id="3306452">Ancount</span><span class="op" id="3306459">,</span>&nbsp;<span class="string" id="3306461">&#34;Ancount&#34;</span><span class="op" id="3306470">,</span>&nbsp;<span class="string" id="3306472">&#34;&#34;</span><span class="op" id="3306474">)</span>&nbsp;<span class="op" id="3306476">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306481">f</span><span class="op" id="3306482">(</span><span class="op" id="3306483">&amp;</span><span class="ident" id="3306484">h</span><span class="op" id="3306485">.</span><span class="ident" id="3306486">Nscount</span><span class="op" id="3306493">,</span>&nbsp;<span class="string" id="3306495">&#34;Nscount&#34;</span><span class="op" id="3306504">,</span>&nbsp;<span class="string" id="3306506">&#34;&#34;</span><span class="op" id="3306508">)</span>&nbsp;<span class="op" id="3306510">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306515">f</span><span class="op" id="3306516">(</span><span class="op" id="3306517">&amp;</span><span class="ident" id="3306518">h</span><span class="op" id="3306519">.</span><span class="ident" id="3306520">Arcount</span><span class="op" id="3306527">,</span>&nbsp;<span class="string" id="3306529">&#34;Arcount&#34;</span><span class="op" id="3306538">,</span>&nbsp;<span class="string" id="3306540">&#34;&#34;</span><span class="op" id="3306542">)</span><br>
<span class="lineno"></span><span class="op" id="3306544">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3306547">const</span>&nbsp;<span class="op" id="3306553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306556">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306575">_QR</span>&nbsp;<span class="op" id="3306579">=</span>&nbsp;<span class="num" id="3306581">1</span>&nbsp;<span class="op" id="3306583">&lt;&lt;</span>&nbsp;<span class="num" id="3306586">15</span>&nbsp;<span class="comment" id="3306589">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306621">_AA</span>&nbsp;<span class="op" id="3306625">=</span>&nbsp;<span class="num" id="3306627">1</span>&nbsp;<span class="op" id="3306629">&lt;&lt;</span>&nbsp;<span class="num" id="3306632">10</span>&nbsp;<span class="comment" id="3306635">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306653">_TC</span>&nbsp;<span class="op" id="3306657">=</span>&nbsp;<span class="num" id="3306659">1</span>&nbsp;<span class="op" id="3306661">&lt;&lt;</span>&nbsp;<span class="num" id="3306664">9</span>&nbsp;&nbsp;<span class="comment" id="3306667">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306681">_RD</span>&nbsp;<span class="op" id="3306685">=</span>&nbsp;<span class="num" id="3306687">1</span>&nbsp;<span class="op" id="3306689">&lt;&lt;</span>&nbsp;<span class="num" id="3306692">8</span>&nbsp;&nbsp;<span class="comment" id="3306695">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306717">_RA</span>&nbsp;<span class="op" id="3306721">=</span>&nbsp;<span class="num" id="3306723">1</span>&nbsp;<span class="op" id="3306725">&lt;&lt;</span>&nbsp;<span class="num" id="3306728">7</span>&nbsp;&nbsp;<span class="comment" id="3306731">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3306754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3306757">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3306773">type</span>&nbsp;<span class="ident" id="3306778">dnsQuestion</span>&nbsp;<span class="keyword" id="3306790">struct</span>&nbsp;<span class="op" id="3306797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306800">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3306807">string</span>&nbsp;<span class="string" id="3306814">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3306834">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306896">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3306903">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306911">Qclass</span>&nbsp;<span class="builtintype" id="3306918">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3306925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3306928">func</span>&nbsp;<span class="op" id="3306933">(</span><span class="ident" id="3306934">q</span>&nbsp;<span class="op" id="3306936">*</span><span class="ident" id="3306937">dnsQuestion</span><span class="op" id="3306948">)</span>&nbsp;<span class="ident" id="3306950">Walk</span><span class="op" id="3306954">(</span><span class="ident" id="3306955">f</span>&nbsp;<span class="keyword" id="3306957">func</span><span class="op" id="3306961">(</span><span class="ident" id="3306962">v</span>&nbsp;<span class="keyword" id="3306964">interface</span><span class="op" id="3306973">{</span><span class="op" id="3306974">}</span><span class="op" id="3306975">,</span>&nbsp;<span class="ident" id="3306977">name</span><span class="op" id="3306981">,</span>&nbsp;<span class="ident" id="3306983">tag</span>&nbsp;<span class="builtintype" id="3306987">string</span><span class="op" id="3306993">)</span>&nbsp;<span class="builtintype" id="3306995">bool</span><span class="op" id="3306999">)</span>&nbsp;<span class="builtintype" id="3307001">bool</span>&nbsp;<span class="op" id="3307006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307009">return</span>&nbsp;<span class="ident" id="3307016">f</span><span class="op" id="3307017">(</span><span class="op" id="3307018">&amp;</span><span class="ident" id="3307019">q</span><span class="op" id="3307020">.</span><span class="ident" id="3307021">Name</span><span class="op" id="3307025">,</span>&nbsp;<span class="string" id="3307027">&#34;Name&#34;</span><span class="op" id="3307033">,</span>&nbsp;<span class="string" id="3307035">&#34;domain&#34;</span><span class="op" id="3307043">)</span>&nbsp;<span class="op" id="3307045">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307050">f</span><span class="op" id="3307051">(</span><span class="op" id="3307052">&amp;</span><span class="ident" id="3307053">q</span><span class="op" id="3307054">.</span><span class="ident" id="3307055">Qtype</span><span class="op" id="3307060">,</span>&nbsp;<span class="string" id="3307062">&#34;Qtype&#34;</span><span class="op" id="3307069">,</span>&nbsp;<span class="string" id="3307071">&#34;&#34;</span><span class="op" id="3307073">)</span>&nbsp;<span class="op" id="3307075">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307080">f</span><span class="op" id="3307081">(</span><span class="op" id="3307082">&amp;</span><span class="ident" id="3307083">q</span><span class="op" id="3307084">.</span><span class="ident" id="3307085">Qclass</span><span class="op" id="3307091">,</span>&nbsp;<span class="string" id="3307093">&#34;Qclass&#34;</span><span class="op" id="3307101">,</span>&nbsp;<span class="string" id="3307103">&#34;&#34;</span><span class="op" id="3307105">)</span><br>
<span class="lineno"></span><span class="op" id="3307107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3307110">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3307147">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3307184">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3307223">type</span>&nbsp;<span class="ident" id="3307228">dnsRR_Header</span>&nbsp;<span class="keyword" id="3307241">struct</span>&nbsp;<span class="op" id="3307248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307251">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3307260">string</span>&nbsp;<span class="string" id="3307267">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307288">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3307297">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307305">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3307314">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307322">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3307331">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307339">Rdlength</span>&nbsp;<span class="builtintype" id="3307348">uint16</span>&nbsp;<span class="comment" id="3307355">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3307386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307389">func</span>&nbsp;<span class="op" id="3307394">(</span><span class="ident" id="3307395">h</span>&nbsp;<span class="op" id="3307397">*</span><span class="ident" id="3307398">dnsRR_Header</span><span class="op" id="3307410">)</span>&nbsp;<span class="ident" id="3307412">Header</span><span class="op" id="3307418">(</span><span class="op" id="3307419">)</span>&nbsp;<span class="op" id="3307421">*</span><span class="ident" id="3307422">dnsRR_Header</span>&nbsp;<span class="op" id="3307435">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307438">return</span>&nbsp;<span class="ident" id="3307445">h</span><br>
<span class="lineno"></span><span class="op" id="3307447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307450">func</span>&nbsp;<span class="op" id="3307455">(</span><span class="ident" id="3307456">h</span>&nbsp;<span class="op" id="3307458">*</span><span class="ident" id="3307459">dnsRR_Header</span><span class="op" id="3307471">)</span>&nbsp;<span class="ident" id="3307473">Walk</span><span class="op" id="3307477">(</span><span class="ident" id="3307478">f</span>&nbsp;<span class="keyword" id="3307480">func</span><span class="op" id="3307484">(</span><span class="ident" id="3307485">v</span>&nbsp;<span class="keyword" id="3307487">interface</span><span class="op" id="3307496">{</span><span class="op" id="3307497">}</span><span class="op" id="3307498">,</span>&nbsp;<span class="ident" id="3307500">name</span><span class="op" id="3307504">,</span>&nbsp;<span class="ident" id="3307506">tag</span>&nbsp;<span class="builtintype" id="3307510">string</span><span class="op" id="3307516">)</span>&nbsp;<span class="builtintype" id="3307518">bool</span><span class="op" id="3307522">)</span>&nbsp;<span class="builtintype" id="3307524">bool</span>&nbsp;<span class="op" id="3307529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307532">return</span>&nbsp;<span class="ident" id="3307539">f</span><span class="op" id="3307540">(</span><span class="op" id="3307541">&amp;</span><span class="ident" id="3307542">h</span><span class="op" id="3307543">.</span><span class="ident" id="3307544">Name</span><span class="op" id="3307548">,</span>&nbsp;<span class="string" id="3307550">&#34;Name&#34;</span><span class="op" id="3307556">,</span>&nbsp;<span class="string" id="3307558">&#34;domain&#34;</span><span class="op" id="3307566">)</span>&nbsp;<span class="op" id="3307568">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307573">f</span><span class="op" id="3307574">(</span><span class="op" id="3307575">&amp;</span><span class="ident" id="3307576">h</span><span class="op" id="3307577">.</span><span class="ident" id="3307578">Rrtype</span><span class="op" id="3307584">,</span>&nbsp;<span class="string" id="3307586">&#34;Rrtype&#34;</span><span class="op" id="3307594">,</span>&nbsp;<span class="string" id="3307596">&#34;&#34;</span><span class="op" id="3307598">)</span>&nbsp;<span class="op" id="3307600">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307605">f</span><span class="op" id="3307606">(</span><span class="op" id="3307607">&amp;</span><span class="ident" id="3307608">h</span><span class="op" id="3307609">.</span><span class="ident" id="3307610">Class</span><span class="op" id="3307615">,</span>&nbsp;<span class="string" id="3307617">&#34;Class&#34;</span><span class="op" id="3307624">,</span>&nbsp;<span class="string" id="3307626">&#34;&#34;</span><span class="op" id="3307628">)</span>&nbsp;<span class="op" id="3307630">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307635">f</span><span class="op" id="3307636">(</span><span class="op" id="3307637">&amp;</span><span class="ident" id="3307638">h</span><span class="op" id="3307639">.</span><span class="ident" id="3307640">Ttl</span><span class="op" id="3307643">,</span>&nbsp;<span class="string" id="3307645">&#34;Ttl&#34;</span><span class="op" id="3307650">,</span>&nbsp;<span class="string" id="3307652">&#34;&#34;</span><span class="op" id="3307654">)</span>&nbsp;<span class="op" id="3307656">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307661">f</span><span class="op" id="3307662">(</span><span class="op" id="3307663">&amp;</span><span class="ident" id="3307664">h</span><span class="op" id="3307665">.</span><span class="ident" id="3307666">Rdlength</span><span class="op" id="3307674">,</span>&nbsp;<span class="string" id="3307676">&#34;Rdlength&#34;</span><span class="op" id="3307686">,</span>&nbsp;<span class="string" id="3307688">&#34;&#34;</span><span class="op" id="3307690">)</span><br>
<span class="lineno"></span><span class="op" id="3307692">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3307695">type</span>&nbsp;<span class="ident" id="3307700">dnsRR</span>&nbsp;<span class="keyword" id="3307706">interface</span>&nbsp;<span class="op" id="3307716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307719">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307730">Header</span><span class="op" id="3307736">(</span><span class="op" id="3307737">)</span>&nbsp;<span class="op" id="3307739">*</span><span class="ident" id="3307740">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3307753">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3307756">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307805">type</span>&nbsp;<span class="ident" id="3307810">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3307822">struct</span>&nbsp;<span class="op" id="3307829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307832">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3307838">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307852">Cname</span>&nbsp;<span class="builtintype" id="3307858">string</span>&nbsp;<span class="string" id="3307865">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3307885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307888">func</span>&nbsp;<span class="op" id="3307893">(</span><span class="ident" id="3307894">rr</span>&nbsp;<span class="op" id="3307897">*</span><span class="ident" id="3307898">dnsRR_CNAME</span><span class="op" id="3307909">)</span>&nbsp;<span class="ident" id="3307911">Header</span><span class="op" id="3307917">(</span><span class="op" id="3307918">)</span>&nbsp;<span class="op" id="3307920">*</span><span class="ident" id="3307921">dnsRR_Header</span>&nbsp;<span class="op" id="3307934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307937">return</span>&nbsp;<span class="op" id="3307944">&amp;</span><span class="ident" id="3307945">rr</span><span class="op" id="3307947">.</span><span class="ident" id="3307948">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3307952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3307955">func</span>&nbsp;<span class="op" id="3307960">(</span><span class="ident" id="3307961">rr</span>&nbsp;<span class="op" id="3307964">*</span><span class="ident" id="3307965">dnsRR_CNAME</span><span class="op" id="3307976">)</span>&nbsp;<span class="ident" id="3307978">Walk</span><span class="op" id="3307982">(</span><span class="ident" id="3307983">f</span>&nbsp;<span class="keyword" id="3307985">func</span><span class="op" id="3307989">(</span><span class="ident" id="3307990">v</span>&nbsp;<span class="keyword" id="3307992">interface</span><span class="op" id="3308001">{</span><span class="op" id="3308002">}</span><span class="op" id="3308003">,</span>&nbsp;<span class="ident" id="3308005">name</span><span class="op" id="3308009">,</span>&nbsp;<span class="ident" id="3308011">tag</span>&nbsp;<span class="builtintype" id="3308015">string</span><span class="op" id="3308021">)</span>&nbsp;<span class="builtintype" id="3308023">bool</span><span class="op" id="3308027">)</span>&nbsp;<span class="builtintype" id="3308029">bool</span>&nbsp;<span class="op" id="3308034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308037">return</span>&nbsp;<span class="ident" id="3308044">rr</span><span class="op" id="3308046">.</span><span class="ident" id="3308047">Hdr</span><span class="op" id="3308050">.</span><span class="ident" id="3308051">Walk</span><span class="op" id="3308055">(</span><span class="ident" id="3308056">f</span><span class="op" id="3308057">)</span>&nbsp;<span class="op" id="3308059">&amp;&amp;</span>&nbsp;<span class="ident" id="3308062">f</span><span class="op" id="3308063">(</span><span class="op" id="3308064">&amp;</span><span class="ident" id="3308065">rr</span><span class="op" id="3308067">.</span><span class="ident" id="3308068">Cname</span><span class="op" id="3308073">,</span>&nbsp;<span class="string" id="3308075">&#34;Cname&#34;</span><span class="op" id="3308082">,</span>&nbsp;<span class="string" id="3308084">&#34;domain&#34;</span><span class="op" id="3308092">)</span><br>
<span class="lineno"></span><span class="op" id="3308094">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3308097">type</span>&nbsp;<span class="ident" id="3308102">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3308114">struct</span>&nbsp;<span class="op" id="3308121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308124">Hdr</span>&nbsp;<span class="ident" id="3308128">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308142">Cpu</span>&nbsp;<span class="builtintype" id="3308146">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308154">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3308158">string</span><br>
<span class="lineno">170</span><span class="op" id="3308165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308168">func</span>&nbsp;<span class="op" id="3308173">(</span><span class="ident" id="3308174">rr</span>&nbsp;<span class="op" id="3308177">*</span><span class="ident" id="3308178">dnsRR_HINFO</span><span class="op" id="3308189">)</span>&nbsp;<span class="ident" id="3308191">Header</span><span class="op" id="3308197">(</span><span class="op" id="3308198">)</span>&nbsp;<span class="op" id="3308200">*</span><span class="ident" id="3308201">dnsRR_Header</span>&nbsp;<span class="op" id="3308214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308217">return</span>&nbsp;<span class="op" id="3308224">&amp;</span><span class="ident" id="3308225">rr</span><span class="op" id="3308227">.</span><span class="ident" id="3308228">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3308232">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3308235">func</span>&nbsp;<span class="op" id="3308240">(</span><span class="ident" id="3308241">rr</span>&nbsp;<span class="op" id="3308244">*</span><span class="ident" id="3308245">dnsRR_HINFO</span><span class="op" id="3308256">)</span>&nbsp;<span class="ident" id="3308258">Walk</span><span class="op" id="3308262">(</span><span class="ident" id="3308263">f</span>&nbsp;<span class="keyword" id="3308265">func</span><span class="op" id="3308269">(</span><span class="ident" id="3308270">v</span>&nbsp;<span class="keyword" id="3308272">interface</span><span class="op" id="3308281">{</span><span class="op" id="3308282">}</span><span class="op" id="3308283">,</span>&nbsp;<span class="ident" id="3308285">name</span><span class="op" id="3308289">,</span>&nbsp;<span class="ident" id="3308291">tag</span>&nbsp;<span class="builtintype" id="3308295">string</span><span class="op" id="3308301">)</span>&nbsp;<span class="builtintype" id="3308303">bool</span><span class="op" id="3308307">)</span>&nbsp;<span class="builtintype" id="3308309">bool</span>&nbsp;<span class="op" id="3308314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308317">return</span>&nbsp;<span class="ident" id="3308324">rr</span><span class="op" id="3308326">.</span><span class="ident" id="3308327">Hdr</span><span class="op" id="3308330">.</span><span class="ident" id="3308331">Walk</span><span class="op" id="3308335">(</span><span class="ident" id="3308336">f</span><span class="op" id="3308337">)</span>&nbsp;<span class="op" id="3308339">&amp;&amp;</span>&nbsp;<span class="ident" id="3308342">f</span><span class="op" id="3308343">(</span><span class="op" id="3308344">&amp;</span><span class="ident" id="3308345">rr</span><span class="op" id="3308347">.</span><span class="ident" id="3308348">Cpu</span><span class="op" id="3308351">,</span>&nbsp;<span class="string" id="3308353">&#34;Cpu&#34;</span><span class="op" id="3308358">,</span>&nbsp;<span class="string" id="3308360">&#34;&#34;</span><span class="op" id="3308362">)</span>&nbsp;<span class="op" id="3308364">&amp;&amp;</span>&nbsp;<span class="ident" id="3308367">f</span><span class="op" id="3308368">(</span><span class="op" id="3308369">&amp;</span><span class="ident" id="3308370">rr</span><span class="op" id="3308372">.</span><span class="ident" id="3308373">Os</span><span class="op" id="3308375">,</span>&nbsp;<span class="string" id="3308377">&#34;Os&#34;</span><span class="op" id="3308381">,</span>&nbsp;<span class="string" id="3308383">&#34;&#34;</span><span class="op" id="3308385">)</span><br>
<span class="lineno"></span><span class="op" id="3308387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3308390">type</span>&nbsp;<span class="ident" id="3308395">dnsRR_MB</span>&nbsp;<span class="keyword" id="3308404">struct</span>&nbsp;<span class="op" id="3308411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308414">Hdr</span>&nbsp;<span class="ident" id="3308418">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308432">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3308436">string</span>&nbsp;<span class="string" id="3308443">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3308463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3308466">func</span>&nbsp;<span class="op" id="3308471">(</span><span class="ident" id="3308472">rr</span>&nbsp;<span class="op" id="3308475">*</span><span class="ident" id="3308476">dnsRR_MB</span><span class="op" id="3308484">)</span>&nbsp;<span class="ident" id="3308486">Header</span><span class="op" id="3308492">(</span><span class="op" id="3308493">)</span>&nbsp;<span class="op" id="3308495">*</span><span class="ident" id="3308496">dnsRR_Header</span>&nbsp;<span class="op" id="3308509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308512">return</span>&nbsp;<span class="op" id="3308519">&amp;</span><span class="ident" id="3308520">rr</span><span class="op" id="3308522">.</span><span class="ident" id="3308523">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3308527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308530">func</span>&nbsp;<span class="op" id="3308535">(</span><span class="ident" id="3308536">rr</span>&nbsp;<span class="op" id="3308539">*</span><span class="ident" id="3308540">dnsRR_MB</span><span class="op" id="3308548">)</span>&nbsp;<span class="ident" id="3308550">Walk</span><span class="op" id="3308554">(</span><span class="ident" id="3308555">f</span>&nbsp;<span class="keyword" id="3308557">func</span><span class="op" id="3308561">(</span><span class="ident" id="3308562">v</span>&nbsp;<span class="keyword" id="3308564">interface</span><span class="op" id="3308573">{</span><span class="op" id="3308574">}</span><span class="op" id="3308575">,</span>&nbsp;<span class="ident" id="3308577">name</span><span class="op" id="3308581">,</span>&nbsp;<span class="ident" id="3308583">tag</span>&nbsp;<span class="builtintype" id="3308587">string</span><span class="op" id="3308593">)</span>&nbsp;<span class="builtintype" id="3308595">bool</span><span class="op" id="3308599">)</span>&nbsp;<span class="builtintype" id="3308601">bool</span>&nbsp;<span class="op" id="3308606">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308609">return</span>&nbsp;<span class="ident" id="3308616">rr</span><span class="op" id="3308618">.</span><span class="ident" id="3308619">Hdr</span><span class="op" id="3308622">.</span><span class="ident" id="3308623">Walk</span><span class="op" id="3308627">(</span><span class="ident" id="3308628">f</span><span class="op" id="3308629">)</span>&nbsp;<span class="op" id="3308631">&amp;&amp;</span>&nbsp;<span class="ident" id="3308634">f</span><span class="op" id="3308635">(</span><span class="op" id="3308636">&amp;</span><span class="ident" id="3308637">rr</span><span class="op" id="3308639">.</span><span class="ident" id="3308640">Mb</span><span class="op" id="3308642">,</span>&nbsp;<span class="string" id="3308644">&#34;Mb&#34;</span><span class="op" id="3308648">,</span>&nbsp;<span class="string" id="3308650">&#34;domain&#34;</span><span class="op" id="3308658">)</span><br>
<span class="lineno"></span><span class="op" id="3308660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308663">type</span>&nbsp;<span class="ident" id="3308668">dnsRR_MG</span>&nbsp;<span class="keyword" id="3308677">struct</span>&nbsp;<span class="op" id="3308684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308687">Hdr</span>&nbsp;<span class="ident" id="3308691">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308705">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3308709">string</span>&nbsp;<span class="string" id="3308716">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3308736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308739">func</span>&nbsp;<span class="op" id="3308744">(</span><span class="ident" id="3308745">rr</span>&nbsp;<span class="op" id="3308748">*</span><span class="ident" id="3308749">dnsRR_MG</span><span class="op" id="3308757">)</span>&nbsp;<span class="ident" id="3308759">Header</span><span class="op" id="3308765">(</span><span class="op" id="3308766">)</span>&nbsp;<span class="op" id="3308768">*</span><span class="ident" id="3308769">dnsRR_Header</span>&nbsp;<span class="op" id="3308782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308785">return</span>&nbsp;<span class="op" id="3308792">&amp;</span><span class="ident" id="3308793">rr</span><span class="op" id="3308795">.</span><span class="ident" id="3308796">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3308800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308803">func</span>&nbsp;<span class="op" id="3308808">(</span><span class="ident" id="3308809">rr</span>&nbsp;<span class="op" id="3308812">*</span><span class="ident" id="3308813">dnsRR_MG</span><span class="op" id="3308821">)</span>&nbsp;<span class="ident" id="3308823">Walk</span><span class="op" id="3308827">(</span><span class="ident" id="3308828">f</span>&nbsp;<span class="keyword" id="3308830">func</span><span class="op" id="3308834">(</span><span class="ident" id="3308835">v</span>&nbsp;<span class="keyword" id="3308837">interface</span><span class="op" id="3308846">{</span><span class="op" id="3308847">}</span><span class="op" id="3308848">,</span>&nbsp;<span class="ident" id="3308850">name</span><span class="op" id="3308854">,</span>&nbsp;<span class="ident" id="3308856">tag</span>&nbsp;<span class="builtintype" id="3308860">string</span><span class="op" id="3308866">)</span>&nbsp;<span class="builtintype" id="3308868">bool</span><span class="op" id="3308872">)</span>&nbsp;<span class="builtintype" id="3308874">bool</span>&nbsp;<span class="op" id="3308879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308882">return</span>&nbsp;<span class="ident" id="3308889">rr</span><span class="op" id="3308891">.</span><span class="ident" id="3308892">Hdr</span><span class="op" id="3308895">.</span><span class="ident" id="3308896">Walk</span><span class="op" id="3308900">(</span><span class="ident" id="3308901">f</span><span class="op" id="3308902">)</span>&nbsp;<span class="op" id="3308904">&amp;&amp;</span>&nbsp;<span class="ident" id="3308907">f</span><span class="op" id="3308908">(</span><span class="op" id="3308909">&amp;</span><span class="ident" id="3308910">rr</span><span class="op" id="3308912">.</span><span class="ident" id="3308913">Mg</span><span class="op" id="3308915">,</span>&nbsp;<span class="string" id="3308917">&#34;Mg&#34;</span><span class="op" id="3308921">,</span>&nbsp;<span class="string" id="3308923">&#34;domain&#34;</span><span class="op" id="3308931">)</span><br>
<span class="lineno"></span><span class="op" id="3308933">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3308936">type</span>&nbsp;<span class="ident" id="3308941">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3308953">struct</span>&nbsp;<span class="op" id="3308960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308963">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3308969">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308983">Rmail</span>&nbsp;<span class="builtintype" id="3308989">string</span>&nbsp;<span class="string" id="3308996">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309017">Email</span>&nbsp;<span class="builtintype" id="3309023">string</span>&nbsp;<span class="string" id="3309030">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3309050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309053">func</span>&nbsp;<span class="op" id="3309058">(</span><span class="ident" id="3309059">rr</span>&nbsp;<span class="op" id="3309062">*</span><span class="ident" id="3309063">dnsRR_MINFO</span><span class="op" id="3309074">)</span>&nbsp;<span class="ident" id="3309076">Header</span><span class="op" id="3309082">(</span><span class="op" id="3309083">)</span>&nbsp;<span class="op" id="3309085">*</span><span class="ident" id="3309086">dnsRR_Header</span>&nbsp;<span class="op" id="3309099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309102">return</span>&nbsp;<span class="op" id="3309109">&amp;</span><span class="ident" id="3309110">rr</span><span class="op" id="3309112">.</span><span class="ident" id="3309113">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3309117">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3309120">func</span>&nbsp;<span class="op" id="3309125">(</span><span class="ident" id="3309126">rr</span>&nbsp;<span class="op" id="3309129">*</span><span class="ident" id="3309130">dnsRR_MINFO</span><span class="op" id="3309141">)</span>&nbsp;<span class="ident" id="3309143">Walk</span><span class="op" id="3309147">(</span><span class="ident" id="3309148">f</span>&nbsp;<span class="keyword" id="3309150">func</span><span class="op" id="3309154">(</span><span class="ident" id="3309155">v</span>&nbsp;<span class="keyword" id="3309157">interface</span><span class="op" id="3309166">{</span><span class="op" id="3309167">}</span><span class="op" id="3309168">,</span>&nbsp;<span class="ident" id="3309170">name</span><span class="op" id="3309174">,</span>&nbsp;<span class="ident" id="3309176">tag</span>&nbsp;<span class="builtintype" id="3309180">string</span><span class="op" id="3309186">)</span>&nbsp;<span class="builtintype" id="3309188">bool</span><span class="op" id="3309192">)</span>&nbsp;<span class="builtintype" id="3309194">bool</span>&nbsp;<span class="op" id="3309199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309202">return</span>&nbsp;<span class="ident" id="3309209">rr</span><span class="op" id="3309211">.</span><span class="ident" id="3309212">Hdr</span><span class="op" id="3309215">.</span><span class="ident" id="3309216">Walk</span><span class="op" id="3309220">(</span><span class="ident" id="3309221">f</span><span class="op" id="3309222">)</span>&nbsp;<span class="op" id="3309224">&amp;&amp;</span>&nbsp;<span class="ident" id="3309227">f</span><span class="op" id="3309228">(</span><span class="op" id="3309229">&amp;</span><span class="ident" id="3309230">rr</span><span class="op" id="3309232">.</span><span class="ident" id="3309233">Rmail</span><span class="op" id="3309238">,</span>&nbsp;<span class="string" id="3309240">&#34;Rmail&#34;</span><span class="op" id="3309247">,</span>&nbsp;<span class="string" id="3309249">&#34;domain&#34;</span><span class="op" id="3309257">)</span>&nbsp;<span class="op" id="3309259">&amp;&amp;</span>&nbsp;<span class="ident" id="3309262">f</span><span class="op" id="3309263">(</span><span class="op" id="3309264">&amp;</span><span class="ident" id="3309265">rr</span><span class="op" id="3309267">.</span><span class="ident" id="3309268">Email</span><span class="op" id="3309273">,</span>&nbsp;<span class="string" id="3309275">&#34;Email&#34;</span><span class="op" id="3309282">,</span>&nbsp;<span class="string" id="3309284">&#34;domain&#34;</span><span class="op" id="3309292">)</span><br>
<span class="lineno"></span><span class="op" id="3309294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3309297">type</span>&nbsp;<span class="ident" id="3309302">dnsRR_MR</span>&nbsp;<span class="keyword" id="3309311">struct</span>&nbsp;<span class="op" id="3309318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309321">Hdr</span>&nbsp;<span class="ident" id="3309325">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309339">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3309343">string</span>&nbsp;<span class="string" id="3309350">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3309370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3309373">func</span>&nbsp;<span class="op" id="3309378">(</span><span class="ident" id="3309379">rr</span>&nbsp;<span class="op" id="3309382">*</span><span class="ident" id="3309383">dnsRR_MR</span><span class="op" id="3309391">)</span>&nbsp;<span class="ident" id="3309393">Header</span><span class="op" id="3309399">(</span><span class="op" id="3309400">)</span>&nbsp;<span class="op" id="3309402">*</span><span class="ident" id="3309403">dnsRR_Header</span>&nbsp;<span class="op" id="3309416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309419">return</span>&nbsp;<span class="op" id="3309426">&amp;</span><span class="ident" id="3309427">rr</span><span class="op" id="3309429">.</span><span class="ident" id="3309430">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3309434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309437">func</span>&nbsp;<span class="op" id="3309442">(</span><span class="ident" id="3309443">rr</span>&nbsp;<span class="op" id="3309446">*</span><span class="ident" id="3309447">dnsRR_MR</span><span class="op" id="3309455">)</span>&nbsp;<span class="ident" id="3309457">Walk</span><span class="op" id="3309461">(</span><span class="ident" id="3309462">f</span>&nbsp;<span class="keyword" id="3309464">func</span><span class="op" id="3309468">(</span><span class="ident" id="3309469">v</span>&nbsp;<span class="keyword" id="3309471">interface</span><span class="op" id="3309480">{</span><span class="op" id="3309481">}</span><span class="op" id="3309482">,</span>&nbsp;<span class="ident" id="3309484">name</span><span class="op" id="3309488">,</span>&nbsp;<span class="ident" id="3309490">tag</span>&nbsp;<span class="builtintype" id="3309494">string</span><span class="op" id="3309500">)</span>&nbsp;<span class="builtintype" id="3309502">bool</span><span class="op" id="3309506">)</span>&nbsp;<span class="builtintype" id="3309508">bool</span>&nbsp;<span class="op" id="3309513">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309516">return</span>&nbsp;<span class="ident" id="3309523">rr</span><span class="op" id="3309525">.</span><span class="ident" id="3309526">Hdr</span><span class="op" id="3309529">.</span><span class="ident" id="3309530">Walk</span><span class="op" id="3309534">(</span><span class="ident" id="3309535">f</span><span class="op" id="3309536">)</span>&nbsp;<span class="op" id="3309538">&amp;&amp;</span>&nbsp;<span class="ident" id="3309541">f</span><span class="op" id="3309542">(</span><span class="op" id="3309543">&amp;</span><span class="ident" id="3309544">rr</span><span class="op" id="3309546">.</span><span class="ident" id="3309547">Mr</span><span class="op" id="3309549">,</span>&nbsp;<span class="string" id="3309551">&#34;Mr&#34;</span><span class="op" id="3309555">,</span>&nbsp;<span class="string" id="3309557">&#34;domain&#34;</span><span class="op" id="3309565">)</span><br>
<span class="lineno"></span><span class="op" id="3309567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309570">type</span>&nbsp;<span class="ident" id="3309575">dnsRR_MX</span>&nbsp;<span class="keyword" id="3309584">struct</span>&nbsp;<span class="op" id="3309591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309594">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3309599">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309613">Pref</span>&nbsp;<span class="builtintype" id="3309618">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309626">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3309631">string</span>&nbsp;<span class="string" id="3309638">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3309658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309661">func</span>&nbsp;<span class="op" id="3309666">(</span><span class="ident" id="3309667">rr</span>&nbsp;<span class="op" id="3309670">*</span><span class="ident" id="3309671">dnsRR_MX</span><span class="op" id="3309679">)</span>&nbsp;<span class="ident" id="3309681">Header</span><span class="op" id="3309687">(</span><span class="op" id="3309688">)</span>&nbsp;<span class="op" id="3309690">*</span><span class="ident" id="3309691">dnsRR_Header</span>&nbsp;<span class="op" id="3309704">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309707">return</span>&nbsp;<span class="op" id="3309714">&amp;</span><span class="ident" id="3309715">rr</span><span class="op" id="3309717">.</span><span class="ident" id="3309718">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3309722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309725">func</span>&nbsp;<span class="op" id="3309730">(</span><span class="ident" id="3309731">rr</span>&nbsp;<span class="op" id="3309734">*</span><span class="ident" id="3309735">dnsRR_MX</span><span class="op" id="3309743">)</span>&nbsp;<span class="ident" id="3309745">Walk</span><span class="op" id="3309749">(</span><span class="ident" id="3309750">f</span>&nbsp;<span class="keyword" id="3309752">func</span><span class="op" id="3309756">(</span><span class="ident" id="3309757">v</span>&nbsp;<span class="keyword" id="3309759">interface</span><span class="op" id="3309768">{</span><span class="op" id="3309769">}</span><span class="op" id="3309770">,</span>&nbsp;<span class="ident" id="3309772">name</span><span class="op" id="3309776">,</span>&nbsp;<span class="ident" id="3309778">tag</span>&nbsp;<span class="builtintype" id="3309782">string</span><span class="op" id="3309788">)</span>&nbsp;<span class="builtintype" id="3309790">bool</span><span class="op" id="3309794">)</span>&nbsp;<span class="builtintype" id="3309796">bool</span>&nbsp;<span class="op" id="3309801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309804">return</span>&nbsp;<span class="ident" id="3309811">rr</span><span class="op" id="3309813">.</span><span class="ident" id="3309814">Hdr</span><span class="op" id="3309817">.</span><span class="ident" id="3309818">Walk</span><span class="op" id="3309822">(</span><span class="ident" id="3309823">f</span><span class="op" id="3309824">)</span>&nbsp;<span class="op" id="3309826">&amp;&amp;</span>&nbsp;<span class="ident" id="3309829">f</span><span class="op" id="3309830">(</span><span class="op" id="3309831">&amp;</span><span class="ident" id="3309832">rr</span><span class="op" id="3309834">.</span><span class="ident" id="3309835">Pref</span><span class="op" id="3309839">,</span>&nbsp;<span class="string" id="3309841">&#34;Pref&#34;</span><span class="op" id="3309847">,</span>&nbsp;<span class="string" id="3309849">&#34;&#34;</span><span class="op" id="3309851">)</span>&nbsp;<span class="op" id="3309853">&amp;&amp;</span>&nbsp;<span class="ident" id="3309856">f</span><span class="op" id="3309857">(</span><span class="op" id="3309858">&amp;</span><span class="ident" id="3309859">rr</span><span class="op" id="3309861">.</span><span class="ident" id="3309862">Mx</span><span class="op" id="3309864">,</span>&nbsp;<span class="string" id="3309866">&#34;Mx&#34;</span><span class="op" id="3309870">,</span>&nbsp;<span class="string" id="3309872">&#34;domain&#34;</span><span class="op" id="3309880">)</span><br>
<span class="lineno">245</span><span class="op" id="3309882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309885">type</span>&nbsp;<span class="ident" id="3309890">dnsRR_NS</span>&nbsp;<span class="keyword" id="3309899">struct</span>&nbsp;<span class="op" id="3309906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309909">Hdr</span>&nbsp;<span class="ident" id="3309913">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309927">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3309931">string</span>&nbsp;<span class="string" id="3309938">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3309958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309961">func</span>&nbsp;<span class="op" id="3309966">(</span><span class="ident" id="3309967">rr</span>&nbsp;<span class="op" id="3309970">*</span><span class="ident" id="3309971">dnsRR_NS</span><span class="op" id="3309979">)</span>&nbsp;<span class="ident" id="3309981">Header</span><span class="op" id="3309987">(</span><span class="op" id="3309988">)</span>&nbsp;<span class="op" id="3309990">*</span><span class="ident" id="3309991">dnsRR_Header</span>&nbsp;<span class="op" id="3310004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310007">return</span>&nbsp;<span class="op" id="3310014">&amp;</span><span class="ident" id="3310015">rr</span><span class="op" id="3310017">.</span><span class="ident" id="3310018">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3310022">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3310025">func</span>&nbsp;<span class="op" id="3310030">(</span><span class="ident" id="3310031">rr</span>&nbsp;<span class="op" id="3310034">*</span><span class="ident" id="3310035">dnsRR_NS</span><span class="op" id="3310043">)</span>&nbsp;<span class="ident" id="3310045">Walk</span><span class="op" id="3310049">(</span><span class="ident" id="3310050">f</span>&nbsp;<span class="keyword" id="3310052">func</span><span class="op" id="3310056">(</span><span class="ident" id="3310057">v</span>&nbsp;<span class="keyword" id="3310059">interface</span><span class="op" id="3310068">{</span><span class="op" id="3310069">}</span><span class="op" id="3310070">,</span>&nbsp;<span class="ident" id="3310072">name</span><span class="op" id="3310076">,</span>&nbsp;<span class="ident" id="3310078">tag</span>&nbsp;<span class="builtintype" id="3310082">string</span><span class="op" id="3310088">)</span>&nbsp;<span class="builtintype" id="3310090">bool</span><span class="op" id="3310094">)</span>&nbsp;<span class="builtintype" id="3310096">bool</span>&nbsp;<span class="op" id="3310101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310104">return</span>&nbsp;<span class="ident" id="3310111">rr</span><span class="op" id="3310113">.</span><span class="ident" id="3310114">Hdr</span><span class="op" id="3310117">.</span><span class="ident" id="3310118">Walk</span><span class="op" id="3310122">(</span><span class="ident" id="3310123">f</span><span class="op" id="3310124">)</span>&nbsp;<span class="op" id="3310126">&amp;&amp;</span>&nbsp;<span class="ident" id="3310129">f</span><span class="op" id="3310130">(</span><span class="op" id="3310131">&amp;</span><span class="ident" id="3310132">rr</span><span class="op" id="3310134">.</span><span class="ident" id="3310135">Ns</span><span class="op" id="3310137">,</span>&nbsp;<span class="string" id="3310139">&#34;Ns&#34;</span><span class="op" id="3310143">,</span>&nbsp;<span class="string" id="3310145">&#34;domain&#34;</span><span class="op" id="3310153">)</span><br>
<span class="lineno"></span><span class="op" id="3310155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3310158">type</span>&nbsp;<span class="ident" id="3310163">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3310173">struct</span>&nbsp;<span class="op" id="3310180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310183">Hdr</span>&nbsp;<span class="ident" id="3310187">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310201">Ptr</span>&nbsp;<span class="builtintype" id="3310205">string</span>&nbsp;<span class="string" id="3310212">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3310232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3310235">func</span>&nbsp;<span class="op" id="3310240">(</span><span class="ident" id="3310241">rr</span>&nbsp;<span class="op" id="3310244">*</span><span class="ident" id="3310245">dnsRR_PTR</span><span class="op" id="3310254">)</span>&nbsp;<span class="ident" id="3310256">Header</span><span class="op" id="3310262">(</span><span class="op" id="3310263">)</span>&nbsp;<span class="op" id="3310265">*</span><span class="ident" id="3310266">dnsRR_Header</span>&nbsp;<span class="op" id="3310279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310282">return</span>&nbsp;<span class="op" id="3310289">&amp;</span><span class="ident" id="3310290">rr</span><span class="op" id="3310292">.</span><span class="ident" id="3310293">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3310297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310300">func</span>&nbsp;<span class="op" id="3310305">(</span><span class="ident" id="3310306">rr</span>&nbsp;<span class="op" id="3310309">*</span><span class="ident" id="3310310">dnsRR_PTR</span><span class="op" id="3310319">)</span>&nbsp;<span class="ident" id="3310321">Walk</span><span class="op" id="3310325">(</span><span class="ident" id="3310326">f</span>&nbsp;<span class="keyword" id="3310328">func</span><span class="op" id="3310332">(</span><span class="ident" id="3310333">v</span>&nbsp;<span class="keyword" id="3310335">interface</span><span class="op" id="3310344">{</span><span class="op" id="3310345">}</span><span class="op" id="3310346">,</span>&nbsp;<span class="ident" id="3310348">name</span><span class="op" id="3310352">,</span>&nbsp;<span class="ident" id="3310354">tag</span>&nbsp;<span class="builtintype" id="3310358">string</span><span class="op" id="3310364">)</span>&nbsp;<span class="builtintype" id="3310366">bool</span><span class="op" id="3310370">)</span>&nbsp;<span class="builtintype" id="3310372">bool</span>&nbsp;<span class="op" id="3310377">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310380">return</span>&nbsp;<span class="ident" id="3310387">rr</span><span class="op" id="3310389">.</span><span class="ident" id="3310390">Hdr</span><span class="op" id="3310393">.</span><span class="ident" id="3310394">Walk</span><span class="op" id="3310398">(</span><span class="ident" id="3310399">f</span><span class="op" id="3310400">)</span>&nbsp;<span class="op" id="3310402">&amp;&amp;</span>&nbsp;<span class="ident" id="3310405">f</span><span class="op" id="3310406">(</span><span class="op" id="3310407">&amp;</span><span class="ident" id="3310408">rr</span><span class="op" id="3310410">.</span><span class="ident" id="3310411">Ptr</span><span class="op" id="3310414">,</span>&nbsp;<span class="string" id="3310416">&#34;Ptr&#34;</span><span class="op" id="3310421">,</span>&nbsp;<span class="string" id="3310423">&#34;domain&#34;</span><span class="op" id="3310431">)</span><br>
<span class="lineno"></span><span class="op" id="3310433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310436">type</span>&nbsp;<span class="ident" id="3310441">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3310451">struct</span>&nbsp;<span class="op" id="3310458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310461">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3310469">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310483">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3310491">string</span>&nbsp;<span class="string" id="3310498">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310519">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3310527">string</span>&nbsp;<span class="string" id="3310534">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310555">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3310563">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310571">Refresh</span>&nbsp;<span class="builtintype" id="3310579">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310587">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3310595">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310603">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3310611">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310619">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3310627">uint32</span><br>
<span class="lineno"></span><span class="op" id="3310634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310637">func</span>&nbsp;<span class="op" id="3310642">(</span><span class="ident" id="3310643">rr</span>&nbsp;<span class="op" id="3310646">*</span><span class="ident" id="3310647">dnsRR_SOA</span><span class="op" id="3310656">)</span>&nbsp;<span class="ident" id="3310658">Header</span><span class="op" id="3310664">(</span><span class="op" id="3310665">)</span>&nbsp;<span class="op" id="3310667">*</span><span class="ident" id="3310668">dnsRR_Header</span>&nbsp;<span class="op" id="3310681">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310684">return</span>&nbsp;<span class="op" id="3310691">&amp;</span><span class="ident" id="3310692">rr</span><span class="op" id="3310694">.</span><span class="ident" id="3310695">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3310699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310702">func</span>&nbsp;<span class="op" id="3310707">(</span><span class="ident" id="3310708">rr</span>&nbsp;<span class="op" id="3310711">*</span><span class="ident" id="3310712">dnsRR_SOA</span><span class="op" id="3310721">)</span>&nbsp;<span class="ident" id="3310723">Walk</span><span class="op" id="3310727">(</span><span class="ident" id="3310728">f</span>&nbsp;<span class="keyword" id="3310730">func</span><span class="op" id="3310734">(</span><span class="ident" id="3310735">v</span>&nbsp;<span class="keyword" id="3310737">interface</span><span class="op" id="3310746">{</span><span class="op" id="3310747">}</span><span class="op" id="3310748">,</span>&nbsp;<span class="ident" id="3310750">name</span><span class="op" id="3310754">,</span>&nbsp;<span class="ident" id="3310756">tag</span>&nbsp;<span class="builtintype" id="3310760">string</span><span class="op" id="3310766">)</span>&nbsp;<span class="builtintype" id="3310768">bool</span><span class="op" id="3310772">)</span>&nbsp;<span class="builtintype" id="3310774">bool</span>&nbsp;<span class="op" id="3310779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310782">return</span>&nbsp;<span class="ident" id="3310789">rr</span><span class="op" id="3310791">.</span><span class="ident" id="3310792">Hdr</span><span class="op" id="3310795">.</span><span class="ident" id="3310796">Walk</span><span class="op" id="3310800">(</span><span class="ident" id="3310801">f</span><span class="op" id="3310802">)</span>&nbsp;<span class="op" id="3310804">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310809">f</span><span class="op" id="3310810">(</span><span class="op" id="3310811">&amp;</span><span class="ident" id="3310812">rr</span><span class="op" id="3310814">.</span><span class="ident" id="3310815">Ns</span><span class="op" id="3310817">,</span>&nbsp;<span class="string" id="3310819">&#34;Ns&#34;</span><span class="op" id="3310823">,</span>&nbsp;<span class="string" id="3310825">&#34;domain&#34;</span><span class="op" id="3310833">)</span>&nbsp;<span class="op" id="3310835">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310840">f</span><span class="op" id="3310841">(</span><span class="op" id="3310842">&amp;</span><span class="ident" id="3310843">rr</span><span class="op" id="3310845">.</span><span class="ident" id="3310846">Mbox</span><span class="op" id="3310850">,</span>&nbsp;<span class="string" id="3310852">&#34;Mbox&#34;</span><span class="op" id="3310858">,</span>&nbsp;<span class="string" id="3310860">&#34;domain&#34;</span><span class="op" id="3310868">)</span>&nbsp;<span class="op" id="3310870">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310875">f</span><span class="op" id="3310876">(</span><span class="op" id="3310877">&amp;</span><span class="ident" id="3310878">rr</span><span class="op" id="3310880">.</span><span class="ident" id="3310881">Serial</span><span class="op" id="3310887">,</span>&nbsp;<span class="string" id="3310889">&#34;Serial&#34;</span><span class="op" id="3310897">,</span>&nbsp;<span class="string" id="3310899">&#34;&#34;</span><span class="op" id="3310901">)</span>&nbsp;<span class="op" id="3310903">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310908">f</span><span class="op" id="3310909">(</span><span class="op" id="3310910">&amp;</span><span class="ident" id="3310911">rr</span><span class="op" id="3310913">.</span><span class="ident" id="3310914">Refresh</span><span class="op" id="3310921">,</span>&nbsp;<span class="string" id="3310923">&#34;Refresh&#34;</span><span class="op" id="3310932">,</span>&nbsp;<span class="string" id="3310934">&#34;&#34;</span><span class="op" id="3310936">)</span>&nbsp;<span class="op" id="3310938">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310943">f</span><span class="op" id="3310944">(</span><span class="op" id="3310945">&amp;</span><span class="ident" id="3310946">rr</span><span class="op" id="3310948">.</span><span class="ident" id="3310949">Retry</span><span class="op" id="3310954">,</span>&nbsp;<span class="string" id="3310956">&#34;Retry&#34;</span><span class="op" id="3310963">,</span>&nbsp;<span class="string" id="3310965">&#34;&#34;</span><span class="op" id="3310967">)</span>&nbsp;<span class="op" id="3310969">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310974">f</span><span class="op" id="3310975">(</span><span class="op" id="3310976">&amp;</span><span class="ident" id="3310977">rr</span><span class="op" id="3310979">.</span><span class="ident" id="3310980">Expire</span><span class="op" id="3310986">,</span>&nbsp;<span class="string" id="3310988">&#34;Expire&#34;</span><span class="op" id="3310996">,</span>&nbsp;<span class="string" id="3310998">&#34;&#34;</span><span class="op" id="3311000">)</span>&nbsp;<span class="op" id="3311002">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311007">f</span><span class="op" id="3311008">(</span><span class="op" id="3311009">&amp;</span><span class="ident" id="3311010">rr</span><span class="op" id="3311012">.</span><span class="ident" id="3311013">Minttl</span><span class="op" id="3311019">,</span>&nbsp;<span class="string" id="3311021">&#34;Minttl&#34;</span><span class="op" id="3311029">,</span>&nbsp;<span class="string" id="3311031">&#34;&#34;</span><span class="op" id="3311033">)</span><br>
<span class="lineno"></span><span class="op" id="3311035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311038">type</span>&nbsp;<span class="ident" id="3311043">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3311053">struct</span>&nbsp;<span class="op" id="3311060">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311063">Hdr</span>&nbsp;<span class="ident" id="3311067">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311081">Txt</span>&nbsp;<span class="builtintype" id="3311085">string</span>&nbsp;<span class="comment" id="3311092">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3311111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311114">func</span>&nbsp;<span class="op" id="3311119">(</span><span class="ident" id="3311120">rr</span>&nbsp;<span class="op" id="3311123">*</span><span class="ident" id="3311124">dnsRR_TXT</span><span class="op" id="3311133">)</span>&nbsp;<span class="ident" id="3311135">Header</span><span class="op" id="3311141">(</span><span class="op" id="3311142">)</span>&nbsp;<span class="op" id="3311144">*</span><span class="ident" id="3311145">dnsRR_Header</span>&nbsp;<span class="op" id="3311158">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311161">return</span>&nbsp;<span class="op" id="3311168">&amp;</span><span class="ident" id="3311169">rr</span><span class="op" id="3311171">.</span><span class="ident" id="3311172">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3311176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311179">func</span>&nbsp;<span class="op" id="3311184">(</span><span class="ident" id="3311185">rr</span>&nbsp;<span class="op" id="3311188">*</span><span class="ident" id="3311189">dnsRR_TXT</span><span class="op" id="3311198">)</span>&nbsp;<span class="ident" id="3311200">Walk</span><span class="op" id="3311204">(</span><span class="ident" id="3311205">f</span>&nbsp;<span class="keyword" id="3311207">func</span><span class="op" id="3311211">(</span><span class="ident" id="3311212">v</span>&nbsp;<span class="keyword" id="3311214">interface</span><span class="op" id="3311223">{</span><span class="op" id="3311224">}</span><span class="op" id="3311225">,</span>&nbsp;<span class="ident" id="3311227">name</span><span class="op" id="3311231">,</span>&nbsp;<span class="ident" id="3311233">tag</span>&nbsp;<span class="builtintype" id="3311237">string</span><span class="op" id="3311243">)</span>&nbsp;<span class="builtintype" id="3311245">bool</span><span class="op" id="3311249">)</span>&nbsp;<span class="builtintype" id="3311251">bool</span>&nbsp;<span class="op" id="3311256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311259">return</span>&nbsp;<span class="ident" id="3311266">rr</span><span class="op" id="3311268">.</span><span class="ident" id="3311269">Hdr</span><span class="op" id="3311272">.</span><span class="ident" id="3311273">Walk</span><span class="op" id="3311277">(</span><span class="ident" id="3311278">f</span><span class="op" id="3311279">)</span>&nbsp;<span class="op" id="3311281">&amp;&amp;</span>&nbsp;<span class="ident" id="3311284">f</span><span class="op" id="3311285">(</span><span class="op" id="3311286">&amp;</span><span class="ident" id="3311287">rr</span><span class="op" id="3311289">.</span><span class="ident" id="3311290">Txt</span><span class="op" id="3311293">,</span>&nbsp;<span class="string" id="3311295">&#34;Txt&#34;</span><span class="op" id="3311300">,</span>&nbsp;<span class="string" id="3311302">&#34;&#34;</span><span class="op" id="3311304">)</span><br>
<span class="lineno">310</span><span class="op" id="3311306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311309">type</span>&nbsp;<span class="ident" id="3311314">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3311324">struct</span>&nbsp;<span class="op" id="3311331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311334">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3311343">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311357">Priority</span>&nbsp;<span class="builtintype" id="3311366">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311374">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3311383">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311391">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3311400">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311408">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3311417">string</span>&nbsp;<span class="string" id="3311424">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3311444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3311447">func</span>&nbsp;<span class="op" id="3311452">(</span><span class="ident" id="3311453">rr</span>&nbsp;<span class="op" id="3311456">*</span><span class="ident" id="3311457">dnsRR_SRV</span><span class="op" id="3311466">)</span>&nbsp;<span class="ident" id="3311468">Header</span><span class="op" id="3311474">(</span><span class="op" id="3311475">)</span>&nbsp;<span class="op" id="3311477">*</span><span class="ident" id="3311478">dnsRR_Header</span>&nbsp;<span class="op" id="3311491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311494">return</span>&nbsp;<span class="op" id="3311501">&amp;</span><span class="ident" id="3311502">rr</span><span class="op" id="3311504">.</span><span class="ident" id="3311505">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3311509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311512">func</span>&nbsp;<span class="op" id="3311517">(</span><span class="ident" id="3311518">rr</span>&nbsp;<span class="op" id="3311521">*</span><span class="ident" id="3311522">dnsRR_SRV</span><span class="op" id="3311531">)</span>&nbsp;<span class="ident" id="3311533">Walk</span><span class="op" id="3311537">(</span><span class="ident" id="3311538">f</span>&nbsp;<span class="keyword" id="3311540">func</span><span class="op" id="3311544">(</span><span class="ident" id="3311545">v</span>&nbsp;<span class="keyword" id="3311547">interface</span><span class="op" id="3311556">{</span><span class="op" id="3311557">}</span><span class="op" id="3311558">,</span>&nbsp;<span class="ident" id="3311560">name</span><span class="op" id="3311564">,</span>&nbsp;<span class="ident" id="3311566">tag</span>&nbsp;<span class="builtintype" id="3311570">string</span><span class="op" id="3311576">)</span>&nbsp;<span class="builtintype" id="3311578">bool</span><span class="op" id="3311582">)</span>&nbsp;<span class="builtintype" id="3311584">bool</span>&nbsp;<span class="op" id="3311589">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311592">return</span>&nbsp;<span class="ident" id="3311599">rr</span><span class="op" id="3311601">.</span><span class="ident" id="3311602">Hdr</span><span class="op" id="3311605">.</span><span class="ident" id="3311606">Walk</span><span class="op" id="3311610">(</span><span class="ident" id="3311611">f</span><span class="op" id="3311612">)</span>&nbsp;<span class="op" id="3311614">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311619">f</span><span class="op" id="3311620">(</span><span class="op" id="3311621">&amp;</span><span class="ident" id="3311622">rr</span><span class="op" id="3311624">.</span><span class="ident" id="3311625">Priority</span><span class="op" id="3311633">,</span>&nbsp;<span class="string" id="3311635">&#34;Priority&#34;</span><span class="op" id="3311645">,</span>&nbsp;<span class="string" id="3311647">&#34;&#34;</span><span class="op" id="3311649">)</span>&nbsp;<span class="op" id="3311651">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311656">f</span><span class="op" id="3311657">(</span><span class="op" id="3311658">&amp;</span><span class="ident" id="3311659">rr</span><span class="op" id="3311661">.</span><span class="ident" id="3311662">Weight</span><span class="op" id="3311668">,</span>&nbsp;<span class="string" id="3311670">&#34;Weight&#34;</span><span class="op" id="3311678">,</span>&nbsp;<span class="string" id="3311680">&#34;&#34;</span><span class="op" id="3311682">)</span>&nbsp;<span class="op" id="3311684">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311689">f</span><span class="op" id="3311690">(</span><span class="op" id="3311691">&amp;</span><span class="ident" id="3311692">rr</span><span class="op" id="3311694">.</span><span class="ident" id="3311695">Port</span><span class="op" id="3311699">,</span>&nbsp;<span class="string" id="3311701">&#34;Port&#34;</span><span class="op" id="3311707">,</span>&nbsp;<span class="string" id="3311709">&#34;&#34;</span><span class="op" id="3311711">)</span>&nbsp;<span class="op" id="3311713">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311718">f</span><span class="op" id="3311719">(</span><span class="op" id="3311720">&amp;</span><span class="ident" id="3311721">rr</span><span class="op" id="3311723">.</span><span class="ident" id="3311724">Target</span><span class="op" id="3311730">,</span>&nbsp;<span class="string" id="3311732">&#34;Target&#34;</span><span class="op" id="3311740">,</span>&nbsp;<span class="string" id="3311742">&#34;domain&#34;</span><span class="op" id="3311750">)</span><br>
<span class="lineno">330</span><span class="op" id="3311752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311755">type</span>&nbsp;<span class="ident" id="3311760">dnsRR_A</span>&nbsp;<span class="keyword" id="3311768">struct</span>&nbsp;<span class="op" id="3311775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311778">Hdr</span>&nbsp;<span class="ident" id="3311782">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311796">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3311800">uint32</span>&nbsp;<span class="string" id="3311807">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3311820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3311823">func</span>&nbsp;<span class="op" id="3311828">(</span><span class="ident" id="3311829">rr</span>&nbsp;<span class="op" id="3311832">*</span><span class="ident" id="3311833">dnsRR_A</span><span class="op" id="3311840">)</span>&nbsp;<span class="ident" id="3311842">Header</span><span class="op" id="3311848">(</span><span class="op" id="3311849">)</span>&nbsp;<span class="op" id="3311851">*</span><span class="ident" id="3311852">dnsRR_Header</span>&nbsp;<span class="op" id="3311865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311868">return</span>&nbsp;<span class="op" id="3311875">&amp;</span><span class="ident" id="3311876">rr</span><span class="op" id="3311878">.</span><span class="ident" id="3311879">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3311883">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3311886">func</span>&nbsp;<span class="op" id="3311891">(</span><span class="ident" id="3311892">rr</span>&nbsp;<span class="op" id="3311895">*</span><span class="ident" id="3311896">dnsRR_A</span><span class="op" id="3311903">)</span>&nbsp;<span class="ident" id="3311905">Walk</span><span class="op" id="3311909">(</span><span class="ident" id="3311910">f</span>&nbsp;<span class="keyword" id="3311912">func</span><span class="op" id="3311916">(</span><span class="ident" id="3311917">v</span>&nbsp;<span class="keyword" id="3311919">interface</span><span class="op" id="3311928">{</span><span class="op" id="3311929">}</span><span class="op" id="3311930">,</span>&nbsp;<span class="ident" id="3311932">name</span><span class="op" id="3311936">,</span>&nbsp;<span class="ident" id="3311938">tag</span>&nbsp;<span class="builtintype" id="3311942">string</span><span class="op" id="3311948">)</span>&nbsp;<span class="builtintype" id="3311950">bool</span><span class="op" id="3311954">)</span>&nbsp;<span class="builtintype" id="3311956">bool</span>&nbsp;<span class="op" id="3311961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311964">return</span>&nbsp;<span class="ident" id="3311971">rr</span><span class="op" id="3311973">.</span><span class="ident" id="3311974">Hdr</span><span class="op" id="3311977">.</span><span class="ident" id="3311978">Walk</span><span class="op" id="3311982">(</span><span class="ident" id="3311983">f</span><span class="op" id="3311984">)</span>&nbsp;<span class="op" id="3311986">&amp;&amp;</span>&nbsp;<span class="ident" id="3311989">f</span><span class="op" id="3311990">(</span><span class="op" id="3311991">&amp;</span><span class="ident" id="3311992">rr</span><span class="op" id="3311994">.</span><span class="ident" id="3311995">A</span><span class="op" id="3311996">,</span>&nbsp;<span class="string" id="3311998">&#34;A&#34;</span><span class="op" id="3312001">,</span>&nbsp;<span class="string" id="3312003">&#34;ipv4&#34;</span><span class="op" id="3312009">)</span><br>
<span class="lineno"></span><span class="op" id="3312011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3312014">type</span>&nbsp;<span class="ident" id="3312019">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3312030">struct</span>&nbsp;<span class="op" id="3312037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312040">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3312045">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312059">AAAA</span>&nbsp;<span class="op" id="3312064">[</span><span class="num" id="3312065">16</span><span class="op" id="3312067">]</span><span class="builtintype" id="3312068">byte</span>&nbsp;<span class="string" id="3312073">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3312086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3312089">func</span>&nbsp;<span class="op" id="3312094">(</span><span class="ident" id="3312095">rr</span>&nbsp;<span class="op" id="3312098">*</span><span class="ident" id="3312099">dnsRR_AAAA</span><span class="op" id="3312109">)</span>&nbsp;<span class="ident" id="3312111">Header</span><span class="op" id="3312117">(</span><span class="op" id="3312118">)</span>&nbsp;<span class="op" id="3312120">*</span><span class="ident" id="3312121">dnsRR_Header</span>&nbsp;<span class="op" id="3312134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312137">return</span>&nbsp;<span class="op" id="3312144">&amp;</span><span class="ident" id="3312145">rr</span><span class="op" id="3312147">.</span><span class="ident" id="3312148">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3312152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3312155">func</span>&nbsp;<span class="op" id="3312160">(</span><span class="ident" id="3312161">rr</span>&nbsp;<span class="op" id="3312164">*</span><span class="ident" id="3312165">dnsRR_AAAA</span><span class="op" id="3312175">)</span>&nbsp;<span class="ident" id="3312177">Walk</span><span class="op" id="3312181">(</span><span class="ident" id="3312182">f</span>&nbsp;<span class="keyword" id="3312184">func</span><span class="op" id="3312188">(</span><span class="ident" id="3312189">v</span>&nbsp;<span class="keyword" id="3312191">interface</span><span class="op" id="3312200">{</span><span class="op" id="3312201">}</span><span class="op" id="3312202">,</span>&nbsp;<span class="ident" id="3312204">name</span><span class="op" id="3312208">,</span>&nbsp;<span class="ident" id="3312210">tag</span>&nbsp;<span class="builtintype" id="3312214">string</span><span class="op" id="3312220">)</span>&nbsp;<span class="builtintype" id="3312222">bool</span><span class="op" id="3312226">)</span>&nbsp;<span class="builtintype" id="3312228">bool</span>&nbsp;<span class="op" id="3312233">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312236">return</span>&nbsp;<span class="ident" id="3312243">rr</span><span class="op" id="3312245">.</span><span class="ident" id="3312246">Hdr</span><span class="op" id="3312249">.</span><span class="ident" id="3312250">Walk</span><span class="op" id="3312254">(</span><span class="ident" id="3312255">f</span><span class="op" id="3312256">)</span>&nbsp;<span class="op" id="3312258">&amp;&amp;</span>&nbsp;<span class="ident" id="3312261">f</span><span class="op" id="3312262">(</span><span class="ident" id="3312263">rr</span><span class="op" id="3312265">.</span><span class="ident" id="3312266">AAAA</span><span class="op" id="3312270">[</span><span class="op" id="3312271">:</span><span class="op" id="3312272">]</span><span class="op" id="3312273">,</span>&nbsp;<span class="string" id="3312275">&#34;AAAA&#34;</span><span class="op" id="3312281">,</span>&nbsp;<span class="string" id="3312283">&#34;ipv6&#34;</span><span class="op" id="3312289">)</span><br>
<span class="lineno"></span><span class="op" id="3312291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3312294">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3312320">//</span><br>
<span class="lineno">360</span><span class="comment" id="3312323">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3312385">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3312452">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3312514">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3312580">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3312602">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3312648">var</span>&nbsp;<span class="ident" id="3312652">rr_mk</span>&nbsp;<span class="op" id="3312658">=</span>&nbsp;<span class="keyword" id="3312660">map</span><span class="op" id="3312663">[</span><span class="builtintype" id="3312664">int</span><span class="op" id="3312667">]</span><span class="keyword" id="3312668">func</span><span class="op" id="3312672">(</span><span class="op" id="3312673">)</span>&nbsp;<span class="ident" id="3312675">dnsRR</span><span class="op" id="3312680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312683">dnsTypeCNAME</span><span class="op" id="3312695">:</span>&nbsp;<span class="keyword" id="3312697">func</span><span class="op" id="3312701">(</span><span class="op" id="3312702">)</span>&nbsp;<span class="ident" id="3312704">dnsRR</span>&nbsp;<span class="op" id="3312710">{</span>&nbsp;<span class="keyword" id="3312712">return</span>&nbsp;<span class="builtinfunc" id="3312719">new</span><span class="op" id="3312722">(</span><span class="ident" id="3312723">dnsRR_CNAME</span><span class="op" id="3312734">)</span>&nbsp;<span class="op" id="3312736">}</span><span class="op" id="3312737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312740">dnsTypeHINFO</span><span class="op" id="3312752">:</span>&nbsp;<span class="keyword" id="3312754">func</span><span class="op" id="3312758">(</span><span class="op" id="3312759">)</span>&nbsp;<span class="ident" id="3312761">dnsRR</span>&nbsp;<span class="op" id="3312767">{</span>&nbsp;<span class="keyword" id="3312769">return</span>&nbsp;<span class="builtinfunc" id="3312776">new</span><span class="op" id="3312779">(</span><span class="ident" id="3312780">dnsRR_HINFO</span><span class="op" id="3312791">)</span>&nbsp;<span class="op" id="3312793">}</span><span class="op" id="3312794">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312797">dnsTypeMB</span><span class="op" id="3312806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3312811">func</span><span class="op" id="3312815">(</span><span class="op" id="3312816">)</span>&nbsp;<span class="ident" id="3312818">dnsRR</span>&nbsp;<span class="op" id="3312824">{</span>&nbsp;<span class="keyword" id="3312826">return</span>&nbsp;<span class="builtinfunc" id="3312833">new</span><span class="op" id="3312836">(</span><span class="ident" id="3312837">dnsRR_MB</span><span class="op" id="3312845">)</span>&nbsp;<span class="op" id="3312847">}</span><span class="op" id="3312848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312851">dnsTypeMG</span><span class="op" id="3312860">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3312865">func</span><span class="op" id="3312869">(</span><span class="op" id="3312870">)</span>&nbsp;<span class="ident" id="3312872">dnsRR</span>&nbsp;<span class="op" id="3312878">{</span>&nbsp;<span class="keyword" id="3312880">return</span>&nbsp;<span class="builtinfunc" id="3312887">new</span><span class="op" id="3312890">(</span><span class="ident" id="3312891">dnsRR_MG</span><span class="op" id="3312899">)</span>&nbsp;<span class="op" id="3312901">}</span><span class="op" id="3312902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312905">dnsTypeMINFO</span><span class="op" id="3312917">:</span>&nbsp;<span class="keyword" id="3312919">func</span><span class="op" id="3312923">(</span><span class="op" id="3312924">)</span>&nbsp;<span class="ident" id="3312926">dnsRR</span>&nbsp;<span class="op" id="3312932">{</span>&nbsp;<span class="keyword" id="3312934">return</span>&nbsp;<span class="builtinfunc" id="3312941">new</span><span class="op" id="3312944">(</span><span class="ident" id="3312945">dnsRR_MINFO</span><span class="op" id="3312956">)</span>&nbsp;<span class="op" id="3312958">}</span><span class="op" id="3312959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312962">dnsTypeMR</span><span class="op" id="3312971">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3312976">func</span><span class="op" id="3312980">(</span><span class="op" id="3312981">)</span>&nbsp;<span class="ident" id="3312983">dnsRR</span>&nbsp;<span class="op" id="3312989">{</span>&nbsp;<span class="keyword" id="3312991">return</span>&nbsp;<span class="builtinfunc" id="3312998">new</span><span class="op" id="3313001">(</span><span class="ident" id="3313002">dnsRR_MR</span><span class="op" id="3313010">)</span>&nbsp;<span class="op" id="3313012">}</span><span class="op" id="3313013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313016">dnsTypeMX</span><span class="op" id="3313025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313030">func</span><span class="op" id="3313034">(</span><span class="op" id="3313035">)</span>&nbsp;<span class="ident" id="3313037">dnsRR</span>&nbsp;<span class="op" id="3313043">{</span>&nbsp;<span class="keyword" id="3313045">return</span>&nbsp;<span class="builtinfunc" id="3313052">new</span><span class="op" id="3313055">(</span><span class="ident" id="3313056">dnsRR_MX</span><span class="op" id="3313064">)</span>&nbsp;<span class="op" id="3313066">}</span><span class="op" id="3313067">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313070">dnsTypeNS</span><span class="op" id="3313079">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313084">func</span><span class="op" id="3313088">(</span><span class="op" id="3313089">)</span>&nbsp;<span class="ident" id="3313091">dnsRR</span>&nbsp;<span class="op" id="3313097">{</span>&nbsp;<span class="keyword" id="3313099">return</span>&nbsp;<span class="builtinfunc" id="3313106">new</span><span class="op" id="3313109">(</span><span class="ident" id="3313110">dnsRR_NS</span><span class="op" id="3313118">)</span>&nbsp;<span class="op" id="3313120">}</span><span class="op" id="3313121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313124">dnsTypePTR</span><span class="op" id="3313134">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313138">func</span><span class="op" id="3313142">(</span><span class="op" id="3313143">)</span>&nbsp;<span class="ident" id="3313145">dnsRR</span>&nbsp;<span class="op" id="3313151">{</span>&nbsp;<span class="keyword" id="3313153">return</span>&nbsp;<span class="builtinfunc" id="3313160">new</span><span class="op" id="3313163">(</span><span class="ident" id="3313164">dnsRR_PTR</span><span class="op" id="3313173">)</span>&nbsp;<span class="op" id="3313175">}</span><span class="op" id="3313176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313179">dnsTypeSOA</span><span class="op" id="3313189">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313193">func</span><span class="op" id="3313197">(</span><span class="op" id="3313198">)</span>&nbsp;<span class="ident" id="3313200">dnsRR</span>&nbsp;<span class="op" id="3313206">{</span>&nbsp;<span class="keyword" id="3313208">return</span>&nbsp;<span class="builtinfunc" id="3313215">new</span><span class="op" id="3313218">(</span><span class="ident" id="3313219">dnsRR_SOA</span><span class="op" id="3313228">)</span>&nbsp;<span class="op" id="3313230">}</span><span class="op" id="3313231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313234">dnsTypeTXT</span><span class="op" id="3313244">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313248">func</span><span class="op" id="3313252">(</span><span class="op" id="3313253">)</span>&nbsp;<span class="ident" id="3313255">dnsRR</span>&nbsp;<span class="op" id="3313261">{</span>&nbsp;<span class="keyword" id="3313263">return</span>&nbsp;<span class="builtinfunc" id="3313270">new</span><span class="op" id="3313273">(</span><span class="ident" id="3313274">dnsRR_TXT</span><span class="op" id="3313283">)</span>&nbsp;<span class="op" id="3313285">}</span><span class="op" id="3313286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313289">dnsTypeSRV</span><span class="op" id="3313299">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313303">func</span><span class="op" id="3313307">(</span><span class="op" id="3313308">)</span>&nbsp;<span class="ident" id="3313310">dnsRR</span>&nbsp;<span class="op" id="3313316">{</span>&nbsp;<span class="keyword" id="3313318">return</span>&nbsp;<span class="builtinfunc" id="3313325">new</span><span class="op" id="3313328">(</span><span class="ident" id="3313329">dnsRR_SRV</span><span class="op" id="3313338">)</span>&nbsp;<span class="op" id="3313340">}</span><span class="op" id="3313341">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313344">dnsTypeA</span><span class="op" id="3313352">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3313358">func</span><span class="op" id="3313362">(</span><span class="op" id="3313363">)</span>&nbsp;<span class="ident" id="3313365">dnsRR</span>&nbsp;<span class="op" id="3313371">{</span>&nbsp;<span class="keyword" id="3313373">return</span>&nbsp;<span class="builtinfunc" id="3313380">new</span><span class="op" id="3313383">(</span><span class="ident" id="3313384">dnsRR_A</span><span class="op" id="3313391">)</span>&nbsp;<span class="op" id="3313393">}</span><span class="op" id="3313394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313397">dnsTypeAAAA</span><span class="op" id="3313408">:</span>&nbsp;&nbsp;<span class="keyword" id="3313411">func</span><span class="op" id="3313415">(</span><span class="op" id="3313416">)</span>&nbsp;<span class="ident" id="3313418">dnsRR</span>&nbsp;<span class="op" id="3313424">{</span>&nbsp;<span class="keyword" id="3313426">return</span>&nbsp;<span class="builtinfunc" id="3313433">new</span><span class="op" id="3313436">(</span><span class="ident" id="3313437">dnsRR_AAAA</span><span class="op" id="3313447">)</span>&nbsp;<span class="op" id="3313449">}</span><span class="op" id="3313450">,</span><br>
<span class="lineno"></span><span class="op" id="3313452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3313455">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3313495">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3313545">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3313604">func</span>&nbsp;<span class="ident" id="3313609">packDomainName</span><span class="op" id="3313623">(</span><span class="ident" id="3313624">s</span>&nbsp;<span class="builtintype" id="3313626">string</span><span class="op" id="3313632">,</span>&nbsp;<span class="ident" id="3313634">msg</span>&nbsp;<span class="op" id="3313638">[</span><span class="op" id="3313639">]</span><span class="builtintype" id="3313640">byte</span><span class="op" id="3313644">,</span>&nbsp;<span class="ident" id="3313646">off</span>&nbsp;<span class="builtintype" id="3313650">int</span><span class="op" id="3313653">)</span>&nbsp;<span class="op" id="3313655">(</span><span class="ident" id="3313656">off1</span>&nbsp;<span class="builtintype" id="3313661">int</span><span class="op" id="3313664">,</span>&nbsp;<span class="ident" id="3313666">ok</span>&nbsp;<span class="builtintype" id="3313669">bool</span><span class="op" id="3313673">)</span>&nbsp;<span class="op" id="3313675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313678">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313721">if</span>&nbsp;<span class="ident" id="3313724">n</span>&nbsp;<span class="op" id="3313726">:=</span>&nbsp;<span class="builtinfunc" id="3313729">len</span><span class="op" id="3313732">(</span><span class="ident" id="3313733">s</span><span class="op" id="3313734">)</span><span class="op" id="3313735">;</span>&nbsp;<span class="ident" id="3313737">n</span>&nbsp;<span class="op" id="3313739">==</span>&nbsp;<span class="num" id="3313742">0</span>&nbsp;<span class="op" id="3313744">||</span>&nbsp;<span class="ident" id="3313747">s</span><span class="op" id="3313748">[</span><span class="ident" id="3313749">n</span><span class="op" id="3313750">-</span><span class="num" id="3313751">1</span><span class="op" id="3313752">]</span>&nbsp;<span class="op" id="3313754">!=</span>&nbsp;<span class="string" id="3313757">&#39;.&#39;</span>&nbsp;<span class="op" id="3313761">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313765">s</span>&nbsp;<span class="op" id="3313767">+=</span>&nbsp;<span class="string" id="3313770">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313779">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313820">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313866">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313901">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313947">tot</span>&nbsp;<span class="op" id="3313951">:=</span>&nbsp;<span class="builtinfunc" id="3313954">len</span><span class="op" id="3313957">(</span><span class="ident" id="3313958">s</span><span class="op" id="3313959">)</span>&nbsp;<span class="op" id="3313961">+</span>&nbsp;<span class="num" id="3313963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313966">if</span>&nbsp;<span class="ident" id="3313969">off</span><span class="op" id="3313972">+</span><span class="ident" id="3313973">tot</span>&nbsp;<span class="op" id="3313977">&gt;</span>&nbsp;<span class="builtinfunc" id="3313979">len</span><span class="op" id="3313982">(</span><span class="ident" id="3313983">msg</span><span class="op" id="3313986">)</span>&nbsp;<span class="op" id="3313988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313992">return</span>&nbsp;<span class="builtinfunc" id="3313999">len</span><span class="op" id="3314002">(</span><span class="ident" id="3314003">msg</span><span class="op" id="3314006">)</span><span class="op" id="3314007">,</span>&nbsp;<span class="ident" id="3314009">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314020">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314076">begin</span>&nbsp;<span class="op" id="3314082">:=</span>&nbsp;<span class="num" id="3314085">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314088">for</span>&nbsp;<span class="ident" id="3314092">i</span>&nbsp;<span class="op" id="3314094">:=</span>&nbsp;<span class="num" id="3314097">0</span><span class="op" id="3314098">;</span>&nbsp;<span class="ident" id="3314100">i</span>&nbsp;<span class="op" id="3314102">&lt;</span>&nbsp;<span class="builtinfunc" id="3314104">len</span><span class="op" id="3314107">(</span><span class="ident" id="3314108">s</span><span class="op" id="3314109">)</span><span class="op" id="3314110">;</span>&nbsp;<span class="ident" id="3314112">i</span><span class="op" id="3314113">++</span>&nbsp;<span class="op" id="3314116">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314120">if</span>&nbsp;<span class="ident" id="3314123">s</span><span class="op" id="3314124">[</span><span class="ident" id="3314125">i</span><span class="op" id="3314126">]</span>&nbsp;<span class="op" id="3314128">==</span>&nbsp;<span class="string" id="3314131">&#39;.&#39;</span>&nbsp;<span class="op" id="3314135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314140">if</span>&nbsp;<span class="ident" id="3314143">i</span><span class="op" id="3314144">-</span><span class="ident" id="3314145">begin</span>&nbsp;<span class="op" id="3314151">&gt;=</span>&nbsp;<span class="num" id="3314154">1</span><span class="op" id="3314155">&lt;&lt;</span><span class="num" id="3314157">6</span>&nbsp;<span class="op" id="3314159">{</span>&nbsp;<span class="comment" id="3314161">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314205">return</span>&nbsp;<span class="builtinfunc" id="3314212">len</span><span class="op" id="3314215">(</span><span class="ident" id="3314216">msg</span><span class="op" id="3314219">)</span><span class="op" id="3314220">,</span>&nbsp;<span class="ident" id="3314222">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314236">msg</span><span class="op" id="3314239">[</span><span class="ident" id="3314240">off</span><span class="op" id="3314243">]</span>&nbsp;<span class="op" id="3314245">=</span>&nbsp;<span class="builtintype" id="3314247">byte</span><span class="op" id="3314251">(</span><span class="ident" id="3314252">i</span>&nbsp;<span class="op" id="3314254">-</span>&nbsp;<span class="ident" id="3314256">begin</span><span class="op" id="3314261">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314266">off</span><span class="op" id="3314269">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314275">for</span>&nbsp;<span class="ident" id="3314279">j</span>&nbsp;<span class="op" id="3314281">:=</span>&nbsp;<span class="ident" id="3314284">begin</span><span class="op" id="3314289">;</span>&nbsp;<span class="ident" id="3314291">j</span>&nbsp;<span class="op" id="3314293">&lt;</span>&nbsp;<span class="ident" id="3314295">i</span><span class="op" id="3314296">;</span>&nbsp;<span class="ident" id="3314298">j</span><span class="op" id="3314299">++</span>&nbsp;<span class="op" id="3314302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314308">msg</span><span class="op" id="3314311">[</span><span class="ident" id="3314312">off</span><span class="op" id="3314315">]</span>&nbsp;<span class="op" id="3314317">=</span>&nbsp;<span class="ident" id="3314319">s</span><span class="op" id="3314320">[</span><span class="ident" id="3314321">j</span><span class="op" id="3314322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314328">off</span><span class="op" id="3314331">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314337">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314342">begin</span>&nbsp;<span class="op" id="3314348">=</span>&nbsp;<span class="ident" id="3314350">i</span>&nbsp;<span class="op" id="3314352">+</span>&nbsp;<span class="num" id="3314354">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314364">msg</span><span class="op" id="3314367">[</span><span class="ident" id="3314368">off</span><span class="op" id="3314371">]</span>&nbsp;<span class="op" id="3314373">=</span>&nbsp;<span class="num" id="3314375">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314378">off</span><span class="op" id="3314381">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314385">return</span>&nbsp;<span class="ident" id="3314392">off</span><span class="op" id="3314395">,</span>&nbsp;<span class="ident" id="3314397">true</span><br>
<span class="lineno"></span><span class="op" id="3314402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3314405">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3314430">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3314495">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3314560">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3314621">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3314682">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3314745">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3314814">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3314852">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3314901">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3314967">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3315013">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3315075">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3315136">func</span>&nbsp;<span class="ident" id="3315141">unpackDomainName</span><span class="op" id="3315157">(</span><span class="ident" id="3315158">msg</span>&nbsp;<span class="op" id="3315162">[</span><span class="op" id="3315163">]</span><span class="builtintype" id="3315164">byte</span><span class="op" id="3315168">,</span>&nbsp;<span class="ident" id="3315170">off</span>&nbsp;<span class="builtintype" id="3315174">int</span><span class="op" id="3315177">)</span>&nbsp;<span class="op" id="3315179">(</span><span class="ident" id="3315180">s</span>&nbsp;<span class="builtintype" id="3315182">string</span><span class="op" id="3315188">,</span>&nbsp;<span class="ident" id="3315190">off1</span>&nbsp;<span class="builtintype" id="3315195">int</span><span class="op" id="3315198">,</span>&nbsp;<span class="ident" id="3315200">ok</span>&nbsp;<span class="builtintype" id="3315203">bool</span><span class="op" id="3315207">)</span>&nbsp;<span class="op" id="3315209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315212">s</span>&nbsp;<span class="op" id="3315214">=</span>&nbsp;<span class="string" id="3315216">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315220">ptr</span>&nbsp;<span class="op" id="3315224">:=</span>&nbsp;<span class="num" id="3315227">0</span>&nbsp;<span class="comment" id="3315229">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3315260">Loop</span><span class="op" id="3315264">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315267">for</span>&nbsp;<span class="op" id="3315271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315275">if</span>&nbsp;<span class="ident" id="3315278">off</span>&nbsp;<span class="op" id="3315282">&gt;=</span>&nbsp;<span class="builtinfunc" id="3315285">len</span><span class="op" id="3315288">(</span><span class="ident" id="3315289">msg</span><span class="op" id="3315292">)</span>&nbsp;<span class="op" id="3315294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315299">return</span>&nbsp;<span class="string" id="3315306">&#34;&#34;</span><span class="op" id="3315308">,</span>&nbsp;<span class="builtinfunc" id="3315310">len</span><span class="op" id="3315313">(</span><span class="ident" id="3315314">msg</span><span class="op" id="3315317">)</span><span class="op" id="3315318">,</span>&nbsp;<span class="ident" id="3315320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315332">c</span>&nbsp;<span class="op" id="3315334">:=</span>&nbsp;<span class="builtintype" id="3315337">int</span><span class="op" id="3315340">(</span><span class="ident" id="3315341">msg</span><span class="op" id="3315344">[</span><span class="ident" id="3315345">off</span><span class="op" id="3315348">]</span><span class="op" id="3315349">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315353">off</span><span class="op" id="3315356">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315361">switch</span>&nbsp;<span class="ident" id="3315368">c</span>&nbsp;<span class="op" id="3315370">&amp;</span>&nbsp;<span class="num" id="3315372">0xC0</span>&nbsp;<span class="op" id="3315377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315381">case</span>&nbsp;<span class="num" id="3315386">0x00</span><span class="op" id="3315390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315395">if</span>&nbsp;<span class="ident" id="3315398">c</span>&nbsp;<span class="op" id="3315400">==</span>&nbsp;<span class="num" id="3315403">0x00</span>&nbsp;<span class="op" id="3315408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315414">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315433">break</span>&nbsp;<span class="ident" id="3315439">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315452">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315473">if</span>&nbsp;<span class="ident" id="3315476">off</span><span class="op" id="3315479">+</span><span class="ident" id="3315480">c</span>&nbsp;<span class="op" id="3315482">&gt;</span>&nbsp;<span class="builtinfunc" id="3315484">len</span><span class="op" id="3315487">(</span><span class="ident" id="3315488">msg</span><span class="op" id="3315491">)</span>&nbsp;<span class="op" id="3315493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315499">return</span>&nbsp;<span class="string" id="3315506">&#34;&#34;</span><span class="op" id="3315508">,</span>&nbsp;<span class="builtinfunc" id="3315510">len</span><span class="op" id="3315513">(</span><span class="ident" id="3315514">msg</span><span class="op" id="3315517">)</span><span class="op" id="3315518">,</span>&nbsp;<span class="ident" id="3315520">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315534">s</span>&nbsp;<span class="op" id="3315536">+=</span>&nbsp;<span class="builtintype" id="3315539">string</span><span class="op" id="3315545">(</span><span class="ident" id="3315546">msg</span><span class="op" id="3315549">[</span><span class="ident" id="3315550">off</span><span class="op" id="3315553">:</span><span class="ident" id="3315554">off</span><span class="op" id="3315557">+</span><span class="ident" id="3315558">c</span><span class="op" id="3315559">]</span><span class="op" id="3315560">)</span>&nbsp;<span class="op" id="3315562">+</span>&nbsp;<span class="string" id="3315564">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315571">off</span>&nbsp;<span class="op" id="3315575">+=</span>&nbsp;<span class="ident" id="3315578">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315582">case</span>&nbsp;<span class="num" id="3315587">0xC0</span><span class="op" id="3315591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315596">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315636">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315677">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315724">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3315770">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315798">if</span>&nbsp;<span class="ident" id="3315801">off</span>&nbsp;<span class="op" id="3315805">&gt;=</span>&nbsp;<span class="builtinfunc" id="3315808">len</span><span class="op" id="3315811">(</span><span class="ident" id="3315812">msg</span><span class="op" id="3315815">)</span>&nbsp;<span class="op" id="3315817">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315823">return</span>&nbsp;<span class="string" id="3315830">&#34;&#34;</span><span class="op" id="3315832">,</span>&nbsp;<span class="builtinfunc" id="3315834">len</span><span class="op" id="3315837">(</span><span class="ident" id="3315838">msg</span><span class="op" id="3315841">)</span><span class="op" id="3315842">,</span>&nbsp;<span class="ident" id="3315844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315858">c1</span>&nbsp;<span class="op" id="3315861">:=</span>&nbsp;<span class="ident" id="3315864">msg</span><span class="op" id="3315867">[</span><span class="ident" id="3315868">off</span><span class="op" id="3315871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315876">off</span><span class="op" id="3315879">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315885">if</span>&nbsp;<span class="ident" id="3315888">ptr</span>&nbsp;<span class="op" id="3315892">==</span>&nbsp;<span class="num" id="3315895">0</span>&nbsp;<span class="op" id="3315897">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315903">off1</span>&nbsp;<span class="op" id="3315908">=</span>&nbsp;<span class="ident" id="3315910">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315922">if</span>&nbsp;<span class="ident" id="3315925">ptr</span><span class="op" id="3315928">++</span><span class="op" id="3315930">;</span>&nbsp;<span class="ident" id="3315932">ptr</span>&nbsp;<span class="op" id="3315936">&gt;</span>&nbsp;<span class="num" id="3315938">10</span>&nbsp;<span class="op" id="3315941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315947">return</span>&nbsp;<span class="string" id="3315954">&#34;&#34;</span><span class="op" id="3315956">,</span>&nbsp;<span class="builtinfunc" id="3315958">len</span><span class="op" id="3315961">(</span><span class="ident" id="3315962">msg</span><span class="op" id="3315965">)</span><span class="op" id="3315966">,</span>&nbsp;<span class="ident" id="3315968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315977">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315982">off</span>&nbsp;<span class="op" id="3315986">=</span>&nbsp;<span class="op" id="3315988">(</span><span class="ident" id="3315989">c</span><span class="op" id="3315990">^</span><span class="num" id="3315991">0xC0</span><span class="op" id="3315995">)</span><span class="op" id="3315996">&lt;&lt;</span><span class="num" id="3315998">8</span>&nbsp;<span class="op" id="3316000">|</span>&nbsp;<span class="builtintype" id="3316002">int</span><span class="op" id="3316005">(</span><span class="ident" id="3316006">c1</span><span class="op" id="3316008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316012">default</span><span class="op" id="3316019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3316024">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316057">return</span>&nbsp;<span class="string" id="3316064">&#34;&#34;</span><span class="op" id="3316066">,</span>&nbsp;<span class="builtinfunc" id="3316068">len</span><span class="op" id="3316071">(</span><span class="ident" id="3316072">msg</span><span class="op" id="3316075">)</span><span class="op" id="3316076">,</span>&nbsp;<span class="ident" id="3316078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316086">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316092">if</span>&nbsp;<span class="ident" id="3316095">ptr</span>&nbsp;<span class="op" id="3316099">==</span>&nbsp;<span class="num" id="3316102">0</span>&nbsp;<span class="op" id="3316104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316108">off1</span>&nbsp;<span class="op" id="3316113">=</span>&nbsp;<span class="ident" id="3316115">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316123">return</span>&nbsp;<span class="ident" id="3316130">s</span><span class="op" id="3316131">,</span>&nbsp;<span class="ident" id="3316133">off1</span><span class="op" id="3316137">,</span>&nbsp;<span class="ident" id="3316139">true</span><br>
<span class="lineno">485</span><span class="op" id="3316144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3316147">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3316217">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3316278">func</span>&nbsp;<span class="ident" id="3316283">packStruct</span><span class="op" id="3316293">(</span><span class="ident" id="3316294">any</span>&nbsp;<span class="ident" id="3316298">dnsStruct</span><span class="op" id="3316307">,</span>&nbsp;<span class="ident" id="3316309">msg</span>&nbsp;<span class="op" id="3316313">[</span><span class="op" id="3316314">]</span><span class="builtintype" id="3316315">byte</span><span class="op" id="3316319">,</span>&nbsp;<span class="ident" id="3316321">off</span>&nbsp;<span class="builtintype" id="3316325">int</span><span class="op" id="3316328">)</span>&nbsp;<span class="op" id="3316330">(</span><span class="ident" id="3316331">off1</span>&nbsp;<span class="builtintype" id="3316336">int</span><span class="op" id="3316339">,</span>&nbsp;<span class="ident" id="3316341">ok</span>&nbsp;<span class="builtintype" id="3316344">bool</span><span class="op" id="3316348">)</span>&nbsp;<span class="op" id="3316350">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316353">ok</span>&nbsp;<span class="op" id="3316356">=</span>&nbsp;<span class="ident" id="3316358">any</span><span class="op" id="3316361">.</span><span class="ident" id="3316362">Walk</span><span class="op" id="3316366">(</span><span class="keyword" id="3316367">func</span><span class="op" id="3316371">(</span><span class="ident" id="3316372">field</span>&nbsp;<span class="keyword" id="3316378">interface</span><span class="op" id="3316387">{</span><span class="op" id="3316388">}</span><span class="op" id="3316389">,</span>&nbsp;<span class="ident" id="3316391">name</span><span class="op" id="3316395">,</span>&nbsp;<span class="ident" id="3316397">tag</span>&nbsp;<span class="builtintype" id="3316401">string</span><span class="op" id="3316407">)</span>&nbsp;<span class="builtintype" id="3316409">bool</span>&nbsp;<span class="op" id="3316414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316418">switch</span>&nbsp;<span class="ident" id="3316425">fv</span>&nbsp;<span class="op" id="3316428">:=</span>&nbsp;<span class="ident" id="3316431">field</span><span class="op" id="3316436">.</span><span class="op" id="3316437">(</span><span class="keyword" id="3316438">type</span><span class="op" id="3316442">)</span>&nbsp;<span class="op" id="3316444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316448">default</span><span class="op" id="3316455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3316460">println</span><span class="op" id="3316467">(</span><span class="string" id="3316468">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3316500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316505">return</span>&nbsp;<span class="ident" id="3316512">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316520">case</span>&nbsp;<span class="op" id="3316525">*</span><span class="builtintype" id="3316526">uint16</span><span class="op" id="3316532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316537">i</span>&nbsp;<span class="op" id="3316539">:=</span>&nbsp;<span class="op" id="3316542">*</span><span class="ident" id="3316543">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316549">if</span>&nbsp;<span class="ident" id="3316552">off</span><span class="op" id="3316555">+</span><span class="num" id="3316556">2</span>&nbsp;<span class="op" id="3316558">&gt;</span>&nbsp;<span class="builtinfunc" id="3316560">len</span><span class="op" id="3316563">(</span><span class="ident" id="3316564">msg</span><span class="op" id="3316567">)</span>&nbsp;<span class="op" id="3316569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316575">return</span>&nbsp;<span class="ident" id="3316582">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316591">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316596">msg</span><span class="op" id="3316599">[</span><span class="ident" id="3316600">off</span><span class="op" id="3316603">]</span>&nbsp;<span class="op" id="3316605">=</span>&nbsp;<span class="builtintype" id="3316607">byte</span><span class="op" id="3316611">(</span><span class="ident" id="3316612">i</span>&nbsp;<span class="op" id="3316614">&gt;&gt;</span>&nbsp;<span class="num" id="3316617">8</span><span class="op" id="3316618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316623">msg</span><span class="op" id="3316626">[</span><span class="ident" id="3316627">off</span><span class="op" id="3316630">+</span><span class="num" id="3316631">1</span><span class="op" id="3316632">]</span>&nbsp;<span class="op" id="3316634">=</span>&nbsp;<span class="builtintype" id="3316636">byte</span><span class="op" id="3316640">(</span><span class="ident" id="3316641">i</span><span class="op" id="3316642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316647">off</span>&nbsp;<span class="op" id="3316651">+=</span>&nbsp;<span class="num" id="3316654">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316658">case</span>&nbsp;<span class="op" id="3316663">*</span><span class="builtintype" id="3316664">uint32</span><span class="op" id="3316670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316675">i</span>&nbsp;<span class="op" id="3316677">:=</span>&nbsp;<span class="op" id="3316680">*</span><span class="ident" id="3316681">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316687">msg</span><span class="op" id="3316690">[</span><span class="ident" id="3316691">off</span><span class="op" id="3316694">]</span>&nbsp;<span class="op" id="3316696">=</span>&nbsp;<span class="builtintype" id="3316698">byte</span><span class="op" id="3316702">(</span><span class="ident" id="3316703">i</span>&nbsp;<span class="op" id="3316705">&gt;&gt;</span>&nbsp;<span class="num" id="3316708">24</span><span class="op" id="3316710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316715">msg</span><span class="op" id="3316718">[</span><span class="ident" id="3316719">off</span><span class="op" id="3316722">+</span><span class="num" id="3316723">1</span><span class="op" id="3316724">]</span>&nbsp;<span class="op" id="3316726">=</span>&nbsp;<span class="builtintype" id="3316728">byte</span><span class="op" id="3316732">(</span><span class="ident" id="3316733">i</span>&nbsp;<span class="op" id="3316735">&gt;&gt;</span>&nbsp;<span class="num" id="3316738">16</span><span class="op" id="3316740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316745">msg</span><span class="op" id="3316748">[</span><span class="ident" id="3316749">off</span><span class="op" id="3316752">+</span><span class="num" id="3316753">2</span><span class="op" id="3316754">]</span>&nbsp;<span class="op" id="3316756">=</span>&nbsp;<span class="builtintype" id="3316758">byte</span><span class="op" id="3316762">(</span><span class="ident" id="3316763">i</span>&nbsp;<span class="op" id="3316765">&gt;&gt;</span>&nbsp;<span class="num" id="3316768">8</span><span class="op" id="3316769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316774">msg</span><span class="op" id="3316777">[</span><span class="ident" id="3316778">off</span><span class="op" id="3316781">+</span><span class="num" id="3316782">3</span><span class="op" id="3316783">]</span>&nbsp;<span class="op" id="3316785">=</span>&nbsp;<span class="builtintype" id="3316787">byte</span><span class="op" id="3316791">(</span><span class="ident" id="3316792">i</span><span class="op" id="3316793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316798">off</span>&nbsp;<span class="op" id="3316802">+=</span>&nbsp;<span class="num" id="3316805">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316809">case</span>&nbsp;<span class="op" id="3316814">[</span><span class="op" id="3316815">]</span><span class="builtintype" id="3316816">byte</span><span class="op" id="3316820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316825">n</span>&nbsp;<span class="op" id="3316827">:=</span>&nbsp;<span class="builtinfunc" id="3316830">len</span><span class="op" id="3316833">(</span><span class="ident" id="3316834">fv</span><span class="op" id="3316836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316841">if</span>&nbsp;<span class="ident" id="3316844">off</span><span class="op" id="3316847">+</span><span class="ident" id="3316848">n</span>&nbsp;<span class="op" id="3316850">&gt;</span>&nbsp;<span class="builtinfunc" id="3316852">len</span><span class="op" id="3316855">(</span><span class="ident" id="3316856">msg</span><span class="op" id="3316859">)</span>&nbsp;<span class="op" id="3316861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316867">return</span>&nbsp;<span class="ident" id="3316874">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316883">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3316888">copy</span><span class="op" id="3316892">(</span><span class="ident" id="3316893">msg</span><span class="op" id="3316896">[</span><span class="ident" id="3316897">off</span><span class="op" id="3316900">:</span><span class="ident" id="3316901">off</span><span class="op" id="3316904">+</span><span class="ident" id="3316905">n</span><span class="op" id="3316906">]</span><span class="op" id="3316907">,</span>&nbsp;<span class="ident" id="3316909">fv</span><span class="op" id="3316911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316916">off</span>&nbsp;<span class="op" id="3316920">+=</span>&nbsp;<span class="ident" id="3316923">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316927">case</span>&nbsp;<span class="op" id="3316932">*</span><span class="builtintype" id="3316933">string</span><span class="op" id="3316939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3316944">s</span>&nbsp;<span class="op" id="3316946">:=</span>&nbsp;<span class="op" id="3316949">*</span><span class="ident" id="3316950">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316956">switch</span>&nbsp;<span class="ident" id="3316963">tag</span>&nbsp;<span class="op" id="3316967">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316972">default</span><span class="op" id="3316979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3316985">println</span><span class="op" id="3316992">(</span><span class="string" id="3316993">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3317023">,</span>&nbsp;<span class="ident" id="3317025">tag</span><span class="op" id="3317028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317034">return</span>&nbsp;<span class="ident" id="3317041">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317050">case</span>&nbsp;<span class="string" id="3317055">&#34;domain&#34;</span><span class="op" id="3317063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317069">off</span><span class="op" id="3317072">,</span>&nbsp;<span class="ident" id="3317074">ok</span>&nbsp;<span class="op" id="3317077">=</span>&nbsp;<span class="ident" id="3317079">packDomainName</span><span class="op" id="3317093">(</span><span class="ident" id="3317094">s</span><span class="op" id="3317095">,</span>&nbsp;<span class="ident" id="3317097">msg</span><span class="op" id="3317100">,</span>&nbsp;<span class="ident" id="3317102">off</span><span class="op" id="3317105">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317111">if</span>&nbsp;<span class="op" id="3317114">!</span><span class="ident" id="3317115">ok</span>&nbsp;<span class="op" id="3317118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317125">return</span>&nbsp;<span class="ident" id="3317132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317147">case</span>&nbsp;<span class="string" id="3317152">&#34;&#34;</span><span class="op" id="3317154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317160">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317198">if</span>&nbsp;<span class="builtinfunc" id="3317201">len</span><span class="op" id="3317204">(</span><span class="ident" id="3317205">s</span><span class="op" id="3317206">)</span>&nbsp;<span class="op" id="3317208">&gt;</span>&nbsp;<span class="num" id="3317210">255</span>&nbsp;<span class="op" id="3317214">||</span>&nbsp;<span class="ident" id="3317217">off</span><span class="op" id="3317220">+</span><span class="num" id="3317221">1</span><span class="op" id="3317222">+</span><span class="builtinfunc" id="3317223">len</span><span class="op" id="3317226">(</span><span class="ident" id="3317227">s</span><span class="op" id="3317228">)</span>&nbsp;<span class="op" id="3317230">&gt;</span>&nbsp;<span class="builtinfunc" id="3317232">len</span><span class="op" id="3317235">(</span><span class="ident" id="3317236">msg</span><span class="op" id="3317239">)</span>&nbsp;<span class="op" id="3317241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317248">return</span>&nbsp;<span class="ident" id="3317255">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317271">msg</span><span class="op" id="3317274">[</span><span class="ident" id="3317275">off</span><span class="op" id="3317278">]</span>&nbsp;<span class="op" id="3317280">=</span>&nbsp;<span class="builtintype" id="3317282">byte</span><span class="op" id="3317286">(</span><span class="builtinfunc" id="3317287">len</span><span class="op" id="3317290">(</span><span class="ident" id="3317291">s</span><span class="op" id="3317292">)</span><span class="op" id="3317293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317299">off</span><span class="op" id="3317302">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317309">off</span>&nbsp;<span class="op" id="3317313">+=</span>&nbsp;<span class="builtinfunc" id="3317316">copy</span><span class="op" id="3317320">(</span><span class="ident" id="3317321">msg</span><span class="op" id="3317324">[</span><span class="ident" id="3317325">off</span><span class="op" id="3317328">:</span><span class="op" id="3317329">]</span><span class="op" id="3317330">,</span>&nbsp;<span class="ident" id="3317332">s</span><span class="op" id="3317333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317346">return</span>&nbsp;<span class="ident" id="3317353">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317359">}</span><span class="op" id="3317360">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317363">if</span>&nbsp;<span class="op" id="3317366">!</span><span class="ident" id="3317367">ok</span>&nbsp;<span class="op" id="3317370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317374">return</span>&nbsp;<span class="builtinfunc" id="3317381">len</span><span class="op" id="3317384">(</span><span class="ident" id="3317385">msg</span><span class="op" id="3317388">)</span><span class="op" id="3317389">,</span>&nbsp;<span class="ident" id="3317391">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317401">return</span>&nbsp;<span class="ident" id="3317408">off</span><span class="op" id="3317411">,</span>&nbsp;<span class="ident" id="3317413">true</span><br>
<span class="lineno"></span><span class="op" id="3317418">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3317421">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3317486">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3317547">func</span>&nbsp;<span class="ident" id="3317552">unpackStruct</span><span class="op" id="3317564">(</span><span class="ident" id="3317565">any</span>&nbsp;<span class="ident" id="3317569">dnsStruct</span><span class="op" id="3317578">,</span>&nbsp;<span class="ident" id="3317580">msg</span>&nbsp;<span class="op" id="3317584">[</span><span class="op" id="3317585">]</span><span class="builtintype" id="3317586">byte</span><span class="op" id="3317590">,</span>&nbsp;<span class="ident" id="3317592">off</span>&nbsp;<span class="builtintype" id="3317596">int</span><span class="op" id="3317599">)</span>&nbsp;<span class="op" id="3317601">(</span><span class="ident" id="3317602">off1</span>&nbsp;<span class="builtintype" id="3317607">int</span><span class="op" id="3317610">,</span>&nbsp;<span class="ident" id="3317612">ok</span>&nbsp;<span class="builtintype" id="3317615">bool</span><span class="op" id="3317619">)</span>&nbsp;<span class="op" id="3317621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317624">ok</span>&nbsp;<span class="op" id="3317627">=</span>&nbsp;<span class="ident" id="3317629">any</span><span class="op" id="3317632">.</span><span class="ident" id="3317633">Walk</span><span class="op" id="3317637">(</span><span class="keyword" id="3317638">func</span><span class="op" id="3317642">(</span><span class="ident" id="3317643">field</span>&nbsp;<span class="keyword" id="3317649">interface</span><span class="op" id="3317658">{</span><span class="op" id="3317659">}</span><span class="op" id="3317660">,</span>&nbsp;<span class="ident" id="3317662">name</span><span class="op" id="3317666">,</span>&nbsp;<span class="ident" id="3317668">tag</span>&nbsp;<span class="builtintype" id="3317672">string</span><span class="op" id="3317678">)</span>&nbsp;<span class="builtintype" id="3317680">bool</span>&nbsp;<span class="op" id="3317685">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317689">switch</span>&nbsp;<span class="ident" id="3317696">fv</span>&nbsp;<span class="op" id="3317699">:=</span>&nbsp;<span class="ident" id="3317702">field</span><span class="op" id="3317707">.</span><span class="op" id="3317708">(</span><span class="keyword" id="3317709">type</span><span class="op" id="3317713">)</span>&nbsp;<span class="op" id="3317715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317719">default</span><span class="op" id="3317726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3317731">println</span><span class="op" id="3317738">(</span><span class="string" id="3317739">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3317771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317776">return</span>&nbsp;<span class="ident" id="3317783">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317791">case</span>&nbsp;<span class="op" id="3317796">*</span><span class="builtintype" id="3317797">uint16</span><span class="op" id="3317803">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317808">if</span>&nbsp;<span class="ident" id="3317811">off</span><span class="op" id="3317814">+</span><span class="num" id="3317815">2</span>&nbsp;<span class="op" id="3317817">&gt;</span>&nbsp;<span class="builtinfunc" id="3317819">len</span><span class="op" id="3317822">(</span><span class="ident" id="3317823">msg</span><span class="op" id="3317826">)</span>&nbsp;<span class="op" id="3317828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317834">return</span>&nbsp;<span class="ident" id="3317841">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317855">*</span><span class="ident" id="3317856">fv</span>&nbsp;<span class="op" id="3317859">=</span>&nbsp;<span class="builtintype" id="3317861">uint16</span><span class="op" id="3317867">(</span><span class="ident" id="3317868">msg</span><span class="op" id="3317871">[</span><span class="ident" id="3317872">off</span><span class="op" id="3317875">]</span><span class="op" id="3317876">)</span><span class="op" id="3317877">&lt;&lt;</span><span class="num" id="3317879">8</span>&nbsp;<span class="op" id="3317881">|</span>&nbsp;<span class="builtintype" id="3317883">uint16</span><span class="op" id="3317889">(</span><span class="ident" id="3317890">msg</span><span class="op" id="3317893">[</span><span class="ident" id="3317894">off</span><span class="op" id="3317897">+</span><span class="num" id="3317898">1</span><span class="op" id="3317899">]</span><span class="op" id="3317900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317905">off</span>&nbsp;<span class="op" id="3317909">+=</span>&nbsp;<span class="num" id="3317912">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317916">case</span>&nbsp;<span class="op" id="3317921">*</span><span class="builtintype" id="3317922">uint32</span><span class="op" id="3317928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317933">if</span>&nbsp;<span class="ident" id="3317936">off</span><span class="op" id="3317939">+</span><span class="num" id="3317940">4</span>&nbsp;<span class="op" id="3317942">&gt;</span>&nbsp;<span class="builtinfunc" id="3317944">len</span><span class="op" id="3317947">(</span><span class="ident" id="3317948">msg</span><span class="op" id="3317951">)</span>&nbsp;<span class="op" id="3317953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317959">return</span>&nbsp;<span class="ident" id="3317966">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317980">*</span><span class="ident" id="3317981">fv</span>&nbsp;<span class="op" id="3317984">=</span>&nbsp;<span class="builtintype" id="3317986">uint32</span><span class="op" id="3317992">(</span><span class="ident" id="3317993">msg</span><span class="op" id="3317996">[</span><span class="ident" id="3317997">off</span><span class="op" id="3318000">]</span><span class="op" id="3318001">)</span><span class="op" id="3318002">&lt;&lt;</span><span class="num" id="3318004">24</span>&nbsp;<span class="op" id="3318007">|</span>&nbsp;<span class="builtintype" id="3318009">uint32</span><span class="op" id="3318015">(</span><span class="ident" id="3318016">msg</span><span class="op" id="3318019">[</span><span class="ident" id="3318020">off</span><span class="op" id="3318023">+</span><span class="num" id="3318024">1</span><span class="op" id="3318025">]</span><span class="op" id="3318026">)</span><span class="op" id="3318027">&lt;&lt;</span><span class="num" id="3318029">16</span>&nbsp;<span class="op" id="3318032">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3318038">uint32</span><span class="op" id="3318044">(</span><span class="ident" id="3318045">msg</span><span class="op" id="3318048">[</span><span class="ident" id="3318049">off</span><span class="op" id="3318052">+</span><span class="num" id="3318053">2</span><span class="op" id="3318054">]</span><span class="op" id="3318055">)</span><span class="op" id="3318056">&lt;&lt;</span><span class="num" id="3318058">8</span>&nbsp;<span class="op" id="3318060">|</span>&nbsp;<span class="builtintype" id="3318062">uint32</span><span class="op" id="3318068">(</span><span class="ident" id="3318069">msg</span><span class="op" id="3318072">[</span><span class="ident" id="3318073">off</span><span class="op" id="3318076">+</span><span class="num" id="3318077">3</span><span class="op" id="3318078">]</span><span class="op" id="3318079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318084">off</span>&nbsp;<span class="op" id="3318088">+=</span>&nbsp;<span class="num" id="3318091">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318095">case</span>&nbsp;<span class="op" id="3318100">[</span><span class="op" id="3318101">]</span><span class="builtintype" id="3318102">byte</span><span class="op" id="3318106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318111">n</span>&nbsp;<span class="op" id="3318113">:=</span>&nbsp;<span class="builtinfunc" id="3318116">len</span><span class="op" id="3318119">(</span><span class="ident" id="3318120">fv</span><span class="op" id="3318122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318127">if</span>&nbsp;<span class="ident" id="3318130">off</span><span class="op" id="3318133">+</span><span class="ident" id="3318134">n</span>&nbsp;<span class="op" id="3318136">&gt;</span>&nbsp;<span class="builtinfunc" id="3318138">len</span><span class="op" id="3318141">(</span><span class="ident" id="3318142">msg</span><span class="op" id="3318145">)</span>&nbsp;<span class="op" id="3318147">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318153">return</span>&nbsp;<span class="ident" id="3318160">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3318174">copy</span><span class="op" id="3318178">(</span><span class="ident" id="3318179">fv</span><span class="op" id="3318181">,</span>&nbsp;<span class="ident" id="3318183">msg</span><span class="op" id="3318186">[</span><span class="ident" id="3318187">off</span><span class="op" id="3318190">:</span><span class="ident" id="3318191">off</span><span class="op" id="3318194">+</span><span class="ident" id="3318195">n</span><span class="op" id="3318196">]</span><span class="op" id="3318197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318202">off</span>&nbsp;<span class="op" id="3318206">+=</span>&nbsp;<span class="ident" id="3318209">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318213">case</span>&nbsp;<span class="op" id="3318218">*</span><span class="builtintype" id="3318219">string</span><span class="op" id="3318225">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318230">var</span>&nbsp;<span class="ident" id="3318234">s</span>&nbsp;<span class="builtintype" id="3318236">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318246">switch</span>&nbsp;<span class="ident" id="3318253">tag</span>&nbsp;<span class="op" id="3318257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318262">default</span><span class="op" id="3318269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3318275">println</span><span class="op" id="3318282">(</span><span class="string" id="3318283">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3318313">,</span>&nbsp;<span class="ident" id="3318315">tag</span><span class="op" id="3318318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318324">return</span>&nbsp;<span class="ident" id="3318331">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318340">case</span>&nbsp;<span class="string" id="3318345">&#34;domain&#34;</span><span class="op" id="3318353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318359">s</span><span class="op" id="3318360">,</span>&nbsp;<span class="ident" id="3318362">off</span><span class="op" id="3318365">,</span>&nbsp;<span class="ident" id="3318367">ok</span>&nbsp;<span class="op" id="3318370">=</span>&nbsp;<span class="ident" id="3318372">unpackDomainName</span><span class="op" id="3318388">(</span><span class="ident" id="3318389">msg</span><span class="op" id="3318392">,</span>&nbsp;<span class="ident" id="3318394">off</span><span class="op" id="3318397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318403">if</span>&nbsp;<span class="op" id="3318406">!</span><span class="ident" id="3318407">ok</span>&nbsp;<span class="op" id="3318410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318417">return</span>&nbsp;<span class="ident" id="3318424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318434">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318439">case</span>&nbsp;<span class="string" id="3318444">&#34;&#34;</span><span class="op" id="3318446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318452">if</span>&nbsp;<span class="ident" id="3318455">off</span>&nbsp;<span class="op" id="3318459">&gt;=</span>&nbsp;<span class="builtinfunc" id="3318462">len</span><span class="op" id="3318465">(</span><span class="ident" id="3318466">msg</span><span class="op" id="3318469">)</span>&nbsp;<span class="op" id="3318471">||</span>&nbsp;<span class="ident" id="3318474">off</span><span class="op" id="3318477">+</span><span class="num" id="3318478">1</span><span class="op" id="3318479">+</span><span class="builtintype" id="3318480">int</span><span class="op" id="3318483">(</span><span class="ident" id="3318484">msg</span><span class="op" id="3318487">[</span><span class="ident" id="3318488">off</span><span class="op" id="3318491">]</span><span class="op" id="3318492">)</span>&nbsp;<span class="op" id="3318494">&gt;</span>&nbsp;<span class="builtinfunc" id="3318496">len</span><span class="op" id="3318499">(</span><span class="ident" id="3318500">msg</span><span class="op" id="3318503">)</span>&nbsp;<span class="op" id="3318505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318512">return</span>&nbsp;<span class="ident" id="3318519">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318535">n</span>&nbsp;<span class="op" id="3318537">:=</span>&nbsp;<span class="builtintype" id="3318540">int</span><span class="op" id="3318543">(</span><span class="ident" id="3318544">msg</span><span class="op" id="3318547">[</span><span class="ident" id="3318548">off</span><span class="op" id="3318551">]</span><span class="op" id="3318552">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318558">off</span><span class="op" id="3318561">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318568">b</span>&nbsp;<span class="op" id="3318570">:=</span>&nbsp;<span class="builtinfunc" id="3318573">make</span><span class="op" id="3318577">(</span><span class="op" id="3318578">[</span><span class="op" id="3318579">]</span><span class="builtintype" id="3318580">byte</span><span class="op" id="3318584">,</span>&nbsp;<span class="ident" id="3318586">n</span><span class="op" id="3318587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318593">for</span>&nbsp;<span class="ident" id="3318597">i</span>&nbsp;<span class="op" id="3318599">:=</span>&nbsp;<span class="num" id="3318602">0</span><span class="op" id="3318603">;</span>&nbsp;<span class="ident" id="3318605">i</span>&nbsp;<span class="op" id="3318607">&lt;</span>&nbsp;<span class="ident" id="3318609">n</span><span class="op" id="3318610">;</span>&nbsp;<span class="ident" id="3318612">i</span><span class="op" id="3318613">++</span>&nbsp;<span class="op" id="3318616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318623">b</span><span class="op" id="3318624">[</span><span class="ident" id="3318625">i</span><span class="op" id="3318626">]</span>&nbsp;<span class="op" id="3318628">=</span>&nbsp;<span class="ident" id="3318630">msg</span><span class="op" id="3318633">[</span><span class="ident" id="3318634">off</span><span class="op" id="3318637">+</span><span class="ident" id="3318638">i</span><span class="op" id="3318639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318645">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318651">off</span>&nbsp;<span class="op" id="3318655">+=</span>&nbsp;<span class="ident" id="3318658">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318664">s</span>&nbsp;<span class="op" id="3318666">=</span>&nbsp;<span class="builtintype" id="3318668">string</span><span class="op" id="3318674">(</span><span class="ident" id="3318675">b</span><span class="op" id="3318676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318686">*</span><span class="ident" id="3318687">fv</span>&nbsp;<span class="op" id="3318690">=</span>&nbsp;<span class="ident" id="3318692">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318696">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318700">return</span>&nbsp;<span class="ident" id="3318707">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318713">}</span><span class="op" id="3318714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318717">if</span>&nbsp;<span class="op" id="3318720">!</span><span class="ident" id="3318721">ok</span>&nbsp;<span class="op" id="3318724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318728">return</span>&nbsp;<span class="builtinfunc" id="3318735">len</span><span class="op" id="3318738">(</span><span class="ident" id="3318739">msg</span><span class="op" id="3318742">)</span><span class="op" id="3318743">,</span>&nbsp;<span class="ident" id="3318745">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318752">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318755">return</span>&nbsp;<span class="ident" id="3318762">off</span><span class="op" id="3318765">,</span>&nbsp;<span class="ident" id="3318767">true</span><br>
<span class="lineno"></span><span class="op" id="3318772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3318775">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3318842">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3318862">func</span>&nbsp;<span class="ident" id="3318867">printStruct</span><span class="op" id="3318878">(</span><span class="ident" id="3318879">any</span>&nbsp;<span class="ident" id="3318883">dnsStruct</span><span class="op" id="3318892">)</span>&nbsp;<span class="builtintype" id="3318894">string</span>&nbsp;<span class="op" id="3318901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318904">s</span>&nbsp;<span class="op" id="3318906">:=</span>&nbsp;<span class="string" id="3318909">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318914">i</span>&nbsp;<span class="op" id="3318916">:=</span>&nbsp;<span class="num" id="3318919">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318922">any</span><span class="op" id="3318925">.</span><span class="ident" id="3318926">Walk</span><span class="op" id="3318930">(</span><span class="keyword" id="3318931">func</span><span class="op" id="3318935">(</span><span class="ident" id="3318936">val</span>&nbsp;<span class="keyword" id="3318940">interface</span><span class="op" id="3318949">{</span><span class="op" id="3318950">}</span><span class="op" id="3318951">,</span>&nbsp;<span class="ident" id="3318953">name</span><span class="op" id="3318957">,</span>&nbsp;<span class="ident" id="3318959">tag</span>&nbsp;<span class="builtintype" id="3318963">string</span><span class="op" id="3318969">)</span>&nbsp;<span class="builtintype" id="3318971">bool</span>&nbsp;<span class="op" id="3318976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318980">i</span><span class="op" id="3318981">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318986">if</span>&nbsp;<span class="ident" id="3318989">i</span>&nbsp;<span class="op" id="3318991">&gt;</span>&nbsp;<span class="num" id="3318993">1</span>&nbsp;<span class="op" id="3318995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319000">s</span>&nbsp;<span class="op" id="3319002">+=</span>&nbsp;<span class="string" id="3319005">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319016">s</span>&nbsp;<span class="op" id="3319018">+=</span>&nbsp;<span class="ident" id="3319021">name</span>&nbsp;<span class="op" id="3319026">+</span>&nbsp;<span class="string" id="3319028">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319034">switch</span>&nbsp;<span class="ident" id="3319041">tag</span>&nbsp;<span class="op" id="3319045">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319049">case</span>&nbsp;<span class="string" id="3319054">&#34;ipv4&#34;</span><span class="op" id="3319060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319065">i</span>&nbsp;<span class="op" id="3319067">:=</span>&nbsp;<span class="op" id="3319070">*</span><span class="ident" id="3319071">val</span><span class="op" id="3319074">.</span><span class="op" id="3319075">(</span><span class="op" id="3319076">*</span><span class="builtintype" id="3319077">uint32</span><span class="op" id="3319083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319088">s</span>&nbsp;<span class="op" id="3319090">+=</span>&nbsp;<span class="ident" id="3319093">IPv4</span><span class="op" id="3319097">(</span><span class="builtintype" id="3319098">byte</span><span class="op" id="3319102">(</span><span class="ident" id="3319103">i</span><span class="op" id="3319104">&gt;&gt;</span><span class="num" id="3319106">24</span><span class="op" id="3319108">)</span><span class="op" id="3319109">,</span>&nbsp;<span class="builtintype" id="3319111">byte</span><span class="op" id="3319115">(</span><span class="ident" id="3319116">i</span><span class="op" id="3319117">&gt;&gt;</span><span class="num" id="3319119">16</span><span class="op" id="3319121">)</span><span class="op" id="3319122">,</span>&nbsp;<span class="builtintype" id="3319124">byte</span><span class="op" id="3319128">(</span><span class="ident" id="3319129">i</span><span class="op" id="3319130">&gt;&gt;</span><span class="num" id="3319132">8</span><span class="op" id="3319133">)</span><span class="op" id="3319134">,</span>&nbsp;<span class="builtintype" id="3319136">byte</span><span class="op" id="3319140">(</span><span class="ident" id="3319141">i</span><span class="op" id="3319142">)</span><span class="op" id="3319143">)</span><span class="op" id="3319144">.</span><span class="ident" id="3319145">String</span><span class="op" id="3319151">(</span><span class="op" id="3319152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319156">case</span>&nbsp;<span class="string" id="3319161">&#34;ipv6&#34;</span><span class="op" id="3319167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319172">i</span>&nbsp;<span class="op" id="3319174">:=</span>&nbsp;<span class="ident" id="3319177">val</span><span class="op" id="3319180">.</span><span class="op" id="3319181">(</span><span class="op" id="3319182">[</span><span class="op" id="3319183">]</span><span class="builtintype" id="3319184">byte</span><span class="op" id="3319188">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319193">s</span>&nbsp;<span class="op" id="3319195">+=</span>&nbsp;<span class="ident" id="3319198">IP</span><span class="op" id="3319200">(</span><span class="ident" id="3319201">i</span><span class="op" id="3319202">)</span><span class="op" id="3319203">.</span><span class="ident" id="3319204">String</span><span class="op" id="3319210">(</span><span class="op" id="3319211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319215">default</span><span class="op" id="3319222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319227">var</span>&nbsp;<span class="ident" id="3319231">i</span>&nbsp;<span class="ident" id="3319233">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319242">switch</span>&nbsp;<span class="ident" id="3319249">v</span>&nbsp;<span class="op" id="3319251">:=</span>&nbsp;<span class="ident" id="3319254">val</span><span class="op" id="3319257">.</span><span class="op" id="3319258">(</span><span class="keyword" id="3319259">type</span><span class="op" id="3319263">)</span>&nbsp;<span class="op" id="3319265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319270">default</span><span class="op" id="3319277">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319283">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319311">s</span>&nbsp;<span class="op" id="3319313">+=</span>&nbsp;<span class="string" id="3319316">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319337">return</span>&nbsp;<span class="ident" id="3319344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319352">case</span>&nbsp;<span class="op" id="3319357">*</span><span class="builtintype" id="3319358">string</span><span class="op" id="3319364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319370">s</span>&nbsp;<span class="op" id="3319372">+=</span>&nbsp;<span class="op" id="3319375">*</span><span class="ident" id="3319376">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319382">return</span>&nbsp;<span class="ident" id="3319389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319397">case</span>&nbsp;<span class="op" id="3319402">[</span><span class="op" id="3319403">]</span><span class="builtintype" id="3319404">byte</span><span class="op" id="3319408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319414">s</span>&nbsp;<span class="op" id="3319416">+=</span>&nbsp;<span class="builtintype" id="3319419">string</span><span class="op" id="3319425">(</span><span class="ident" id="3319426">v</span><span class="op" id="3319427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319433">return</span>&nbsp;<span class="ident" id="3319440">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319448">case</span>&nbsp;<span class="op" id="3319453">*</span><span class="builtintype" id="3319454">bool</span><span class="op" id="3319458">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319464">if</span>&nbsp;<span class="op" id="3319467">*</span><span class="ident" id="3319468">v</span>&nbsp;<span class="op" id="3319470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319477">s</span>&nbsp;<span class="op" id="3319479">+=</span>&nbsp;<span class="string" id="3319482">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319493">}</span>&nbsp;<span class="keyword" id="3319495">else</span>&nbsp;<span class="op" id="3319500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319507">s</span>&nbsp;<span class="op" id="3319509">+=</span>&nbsp;<span class="string" id="3319512">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319524">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319530">return</span>&nbsp;<span class="ident" id="3319537">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319545">case</span>&nbsp;<span class="op" id="3319550">*</span><span class="builtintype" id="3319551">int</span><span class="op" id="3319554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319560">i</span>&nbsp;<span class="op" id="3319562">=</span>&nbsp;<span class="ident" id="3319564">int64</span><span class="op" id="3319569">(</span><span class="op" id="3319570">*</span><span class="ident" id="3319571">v</span><span class="op" id="3319572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319577">case</span>&nbsp;<span class="op" id="3319582">*</span><span class="builtintype" id="3319583">uint</span><span class="op" id="3319587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319593">i</span>&nbsp;<span class="op" id="3319595">=</span>&nbsp;<span class="ident" id="3319597">int64</span><span class="op" id="3319602">(</span><span class="op" id="3319603">*</span><span class="ident" id="3319604">v</span><span class="op" id="3319605">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319610">case</span>&nbsp;<span class="op" id="3319615">*</span><span class="builtintype" id="3319616">uint8</span><span class="op" id="3319621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319627">i</span>&nbsp;<span class="op" id="3319629">=</span>&nbsp;<span class="ident" id="3319631">int64</span><span class="op" id="3319636">(</span><span class="op" id="3319637">*</span><span class="ident" id="3319638">v</span><span class="op" id="3319639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319644">case</span>&nbsp;<span class="op" id="3319649">*</span><span class="builtintype" id="3319650">uint16</span><span class="op" id="3319656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319662">i</span>&nbsp;<span class="op" id="3319664">=</span>&nbsp;<span class="ident" id="3319666">int64</span><span class="op" id="3319671">(</span><span class="op" id="3319672">*</span><span class="ident" id="3319673">v</span><span class="op" id="3319674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319679">case</span>&nbsp;<span class="op" id="3319684">*</span><span class="builtintype" id="3319685">uint32</span><span class="op" id="3319691">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319697">i</span>&nbsp;<span class="op" id="3319699">=</span>&nbsp;<span class="ident" id="3319701">int64</span><span class="op" id="3319706">(</span><span class="op" id="3319707">*</span><span class="ident" id="3319708">v</span><span class="op" id="3319709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319714">case</span>&nbsp;<span class="op" id="3319719">*</span><span class="ident" id="3319720">uint64</span><span class="op" id="3319726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319732">i</span>&nbsp;<span class="op" id="3319734">=</span>&nbsp;<span class="ident" id="3319736">int64</span><span class="op" id="3319741">(</span><span class="op" id="3319742">*</span><span class="ident" id="3319743">v</span><span class="op" id="3319744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319749">case</span>&nbsp;<span class="op" id="3319754">*</span><span class="builtintype" id="3319755">uintptr</span><span class="op" id="3319762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319768">i</span>&nbsp;<span class="op" id="3319770">=</span>&nbsp;<span class="ident" id="3319772">int64</span><span class="op" id="3319777">(</span><span class="op" id="3319778">*</span><span class="ident" id="3319779">v</span><span class="op" id="3319780">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319790">s</span>&nbsp;<span class="op" id="3319792">+=</span>&nbsp;<span class="ident" id="3319795">itoa</span><span class="op" id="3319799">(</span><span class="builtintype" id="3319800">int</span><span class="op" id="3319803">(</span><span class="ident" id="3319804">i</span><span class="op" id="3319805">)</span><span class="op" id="3319806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319814">return</span>&nbsp;<span class="ident" id="3319821">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3319827">}</span><span class="op" id="3319828">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3319831">s</span>&nbsp;<span class="op" id="3319833">+=</span>&nbsp;<span class="string" id="3319836">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319841">return</span>&nbsp;<span class="ident" id="3319848">s</span><br>
<span class="lineno"></span><span class="op" id="3319850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3319853">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3319880">func</span>&nbsp;<span class="ident" id="3319885">packRR</span><span class="op" id="3319891">(</span><span class="ident" id="3319892">rr</span>&nbsp;<span class="ident" id="3319895">dnsRR</span><span class="op" id="3319900">,</span>&nbsp;<span class="ident" id="3319902">msg</span>&nbsp;<span class="op" id="3319906">[</span><span class="op" id="3319907">]</span><span class="builtintype" id="3319908">byte</span><span class="op" id="3319912">,</span>&nbsp;<span class="ident" id="3319914">off</span>&nbsp;<span class="builtintype" id="3319918">int</span><span class="op" id="3319921">)</span>&nbsp;<span class="op" id="3319923">(</span><span class="ident" id="3319924">off2</span>&nbsp;<span class="builtintype" id="3319929">int</span><span class="op" id="3319932">,</span>&nbsp;<span class="ident" id="3319934">ok</span>&nbsp;<span class="builtintype" id="3319937">bool</span><span class="op" id="3319941">)</span>&nbsp;<span class="op" id="3319943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319946">var</span>&nbsp;<span class="ident" id="3319950">off1</span>&nbsp;<span class="builtintype" id="3319955">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3319960">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320003">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320040">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320096">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320122">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320144">off1</span><span class="op" id="3320148">,</span>&nbsp;<span class="ident" id="3320150">ok</span>&nbsp;<span class="op" id="3320153">=</span>&nbsp;<span class="ident" id="3320155">packStruct</span><span class="op" id="3320165">(</span><span class="ident" id="3320166">rr</span><span class="op" id="3320168">.</span><span class="ident" id="3320169">Header</span><span class="op" id="3320175">(</span><span class="op" id="3320176">)</span><span class="op" id="3320177">,</span>&nbsp;<span class="ident" id="3320179">msg</span><span class="op" id="3320182">,</span>&nbsp;<span class="ident" id="3320184">off</span><span class="op" id="3320187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320190">off2</span><span class="op" id="3320194">,</span>&nbsp;<span class="ident" id="3320196">ok</span>&nbsp;<span class="op" id="3320199">=</span>&nbsp;<span class="ident" id="3320201">packStruct</span><span class="op" id="3320211">(</span><span class="ident" id="3320212">rr</span><span class="op" id="3320214">,</span>&nbsp;<span class="ident" id="3320216">msg</span><span class="op" id="3320219">,</span>&nbsp;<span class="ident" id="3320221">off</span><span class="op" id="3320224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320227">if</span>&nbsp;<span class="op" id="3320230">!</span><span class="ident" id="3320231">ok</span>&nbsp;<span class="op" id="3320234">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320238">return</span>&nbsp;<span class="builtinfunc" id="3320245">len</span><span class="op" id="3320248">(</span><span class="ident" id="3320249">msg</span><span class="op" id="3320252">)</span><span class="op" id="3320253">,</span>&nbsp;<span class="ident" id="3320255">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320265">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320325">rr</span><span class="op" id="3320327">.</span><span class="ident" id="3320328">Header</span><span class="op" id="3320334">(</span><span class="op" id="3320335">)</span><span class="op" id="3320336">.</span><span class="ident" id="3320337">Rdlength</span>&nbsp;<span class="op" id="3320346">=</span>&nbsp;<span class="builtintype" id="3320348">uint16</span><span class="op" id="3320354">(</span><span class="ident" id="3320355">off2</span>&nbsp;<span class="op" id="3320360">-</span>&nbsp;<span class="ident" id="3320362">off1</span><span class="op" id="3320366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320369">packStruct</span><span class="op" id="3320379">(</span><span class="ident" id="3320380">rr</span><span class="op" id="3320382">.</span><span class="ident" id="3320383">Header</span><span class="op" id="3320389">(</span><span class="op" id="3320390">)</span><span class="op" id="3320391">,</span>&nbsp;<span class="ident" id="3320393">msg</span><span class="op" id="3320396">,</span>&nbsp;<span class="ident" id="3320398">off</span><span class="op" id="3320401">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320404">return</span>&nbsp;<span class="ident" id="3320411">off2</span><span class="op" id="3320415">,</span>&nbsp;<span class="ident" id="3320417">true</span><br>
<span class="lineno"></span><span class="op" id="3320422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3320425">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3320454">func</span>&nbsp;<span class="ident" id="3320459">unpackRR</span><span class="op" id="3320467">(</span><span class="ident" id="3320468">msg</span>&nbsp;<span class="op" id="3320472">[</span><span class="op" id="3320473">]</span><span class="builtintype" id="3320474">byte</span><span class="op" id="3320478">,</span>&nbsp;<span class="ident" id="3320480">off</span>&nbsp;<span class="builtintype" id="3320484">int</span><span class="op" id="3320487">)</span>&nbsp;<span class="op" id="3320489">(</span><span class="ident" id="3320490">rr</span>&nbsp;<span class="ident" id="3320493">dnsRR</span><span class="op" id="3320498">,</span>&nbsp;<span class="ident" id="3320500">off1</span>&nbsp;<span class="builtintype" id="3320505">int</span><span class="op" id="3320508">,</span>&nbsp;<span class="ident" id="3320510">ok</span>&nbsp;<span class="builtintype" id="3320513">bool</span><span class="op" id="3320517">)</span>&nbsp;<span class="op" id="3320519">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320522">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320581">var</span>&nbsp;<span class="ident" id="3320585">h</span>&nbsp;<span class="ident" id="3320587">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320601">off0</span>&nbsp;<span class="op" id="3320606">:=</span>&nbsp;<span class="ident" id="3320609">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320614">if</span>&nbsp;<span class="ident" id="3320617">off</span><span class="op" id="3320620">,</span>&nbsp;<span class="ident" id="3320622">ok</span>&nbsp;<span class="op" id="3320625">=</span>&nbsp;<span class="ident" id="3320627">unpackStruct</span><span class="op" id="3320639">(</span><span class="op" id="3320640">&amp;</span><span class="ident" id="3320641">h</span><span class="op" id="3320642">,</span>&nbsp;<span class="ident" id="3320644">msg</span><span class="op" id="3320647">,</span>&nbsp;<span class="ident" id="3320649">off</span><span class="op" id="3320652">)</span><span class="op" id="3320653">;</span>&nbsp;<span class="op" id="3320655">!</span><span class="ident" id="3320656">ok</span>&nbsp;<span class="op" id="3320659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320663">return</span>&nbsp;<span class="ident" id="3320670">nil</span><span class="op" id="3320673">,</span>&nbsp;<span class="builtinfunc" id="3320675">len</span><span class="op" id="3320678">(</span><span class="ident" id="3320679">msg</span><span class="op" id="3320682">)</span><span class="op" id="3320683">,</span>&nbsp;<span class="ident" id="3320685">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320695">end</span>&nbsp;<span class="op" id="3320699">:=</span>&nbsp;<span class="ident" id="3320702">off</span>&nbsp;<span class="op" id="3320706">+</span>&nbsp;<span class="builtintype" id="3320708">int</span><span class="op" id="3320711">(</span><span class="ident" id="3320712">h</span><span class="op" id="3320713">.</span><span class="ident" id="3320714">Rdlength</span><span class="op" id="3320722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320726">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3320769">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320820">mk</span><span class="op" id="3320822">,</span>&nbsp;<span class="ident" id="3320824">known</span>&nbsp;<span class="op" id="3320830">:=</span>&nbsp;<span class="ident" id="3320833">rr_mk</span><span class="op" id="3320838">[</span><span class="builtintype" id="3320839">int</span><span class="op" id="3320842">(</span><span class="ident" id="3320843">h</span><span class="op" id="3320844">.</span><span class="ident" id="3320845">Rrtype</span><span class="op" id="3320851">)</span><span class="op" id="3320852">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320855">if</span>&nbsp;<span class="op" id="3320858">!</span><span class="ident" id="3320859">known</span>&nbsp;<span class="op" id="3320865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320869">return</span>&nbsp;<span class="op" id="3320876">&amp;</span><span class="ident" id="3320877">h</span><span class="op" id="3320878">,</span>&nbsp;<span class="ident" id="3320880">end</span><span class="op" id="3320883">,</span>&nbsp;<span class="ident" id="3320885">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320894">rr</span>&nbsp;<span class="op" id="3320897">=</span>&nbsp;<span class="ident" id="3320899">mk</span><span class="op" id="3320901">(</span><span class="op" id="3320902">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320905">off</span><span class="op" id="3320908">,</span>&nbsp;<span class="ident" id="3320910">ok</span>&nbsp;<span class="op" id="3320913">=</span>&nbsp;<span class="ident" id="3320915">unpackStruct</span><span class="op" id="3320927">(</span><span class="ident" id="3320928">rr</span><span class="op" id="3320930">,</span>&nbsp;<span class="ident" id="3320932">msg</span><span class="op" id="3320935">,</span>&nbsp;<span class="ident" id="3320937">off0</span><span class="op" id="3320941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320944">if</span>&nbsp;<span class="ident" id="3320947">off</span>&nbsp;<span class="op" id="3320951">!=</span>&nbsp;<span class="ident" id="3320954">end</span>&nbsp;<span class="op" id="3320958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320962">return</span>&nbsp;<span class="op" id="3320969">&amp;</span><span class="ident" id="3320970">h</span><span class="op" id="3320971">,</span>&nbsp;<span class="ident" id="3320973">end</span><span class="op" id="3320976">,</span>&nbsp;<span class="ident" id="3320978">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320987">return</span>&nbsp;<span class="ident" id="3320994">rr</span><span class="op" id="3320996">,</span>&nbsp;<span class="ident" id="3320998">off</span><span class="op" id="3321001">,</span>&nbsp;<span class="ident" id="3321003">ok</span><br>
<span class="lineno">710</span><span class="op" id="3321006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3321009">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3321052">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3321098">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3321146">type</span>&nbsp;<span class="ident" id="3321151">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3321161">struct</span>&nbsp;<span class="op" id="3321168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321171">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321191">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321199">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321219">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321225">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321245">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321250">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321270">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321276">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321296">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321302">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321322">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321328">recursion_available</span>&nbsp;<span class="builtintype" id="3321348">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321354">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3321374">int</span><br>
<span class="lineno">725</span><span class="op" id="3321378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3321381">func</span>&nbsp;<span class="op" id="3321386">(</span><span class="ident" id="3321387">h</span>&nbsp;<span class="op" id="3321389">*</span><span class="ident" id="3321390">dnsMsgHdr</span><span class="op" id="3321399">)</span>&nbsp;<span class="ident" id="3321401">Walk</span><span class="op" id="3321405">(</span><span class="ident" id="3321406">f</span>&nbsp;<span class="keyword" id="3321408">func</span><span class="op" id="3321412">(</span><span class="ident" id="3321413">v</span>&nbsp;<span class="keyword" id="3321415">interface</span><span class="op" id="3321424">{</span><span class="op" id="3321425">}</span><span class="op" id="3321426">,</span>&nbsp;<span class="ident" id="3321428">name</span><span class="op" id="3321432">,</span>&nbsp;<span class="ident" id="3321434">tag</span>&nbsp;<span class="builtintype" id="3321438">string</span><span class="op" id="3321444">)</span>&nbsp;<span class="builtintype" id="3321446">bool</span><span class="op" id="3321450">)</span>&nbsp;<span class="builtintype" id="3321452">bool</span>&nbsp;<span class="op" id="3321457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321460">return</span>&nbsp;<span class="ident" id="3321467">f</span><span class="op" id="3321468">(</span><span class="op" id="3321469">&amp;</span><span class="ident" id="3321470">h</span><span class="op" id="3321471">.</span><span class="ident" id="3321472">id</span><span class="op" id="3321474">,</span>&nbsp;<span class="string" id="3321476">&#34;id&#34;</span><span class="op" id="3321480">,</span>&nbsp;<span class="string" id="3321482">&#34;&#34;</span><span class="op" id="3321484">)</span>&nbsp;<span class="op" id="3321486">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321491">f</span><span class="op" id="3321492">(</span><span class="op" id="3321493">&amp;</span><span class="ident" id="3321494">h</span><span class="op" id="3321495">.</span><span class="ident" id="3321496">response</span><span class="op" id="3321504">,</span>&nbsp;<span class="string" id="3321506">&#34;response&#34;</span><span class="op" id="3321516">,</span>&nbsp;<span class="string" id="3321518">&#34;&#34;</span><span class="op" id="3321520">)</span>&nbsp;<span class="op" id="3321522">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321527">f</span><span class="op" id="3321528">(</span><span class="op" id="3321529">&amp;</span><span class="ident" id="3321530">h</span><span class="op" id="3321531">.</span><span class="ident" id="3321532">opcode</span><span class="op" id="3321538">,</span>&nbsp;<span class="string" id="3321540">&#34;opcode&#34;</span><span class="op" id="3321548">,</span>&nbsp;<span class="string" id="3321550">&#34;&#34;</span><span class="op" id="3321552">)</span>&nbsp;<span class="op" id="3321554">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321559">f</span><span class="op" id="3321560">(</span><span class="op" id="3321561">&amp;</span><span class="ident" id="3321562">h</span><span class="op" id="3321563">.</span><span class="ident" id="3321564">authoritative</span><span class="op" id="3321577">,</span>&nbsp;<span class="string" id="3321579">&#34;authoritative&#34;</span><span class="op" id="3321594">,</span>&nbsp;<span class="string" id="3321596">&#34;&#34;</span><span class="op" id="3321598">)</span>&nbsp;<span class="op" id="3321600">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321605">f</span><span class="op" id="3321606">(</span><span class="op" id="3321607">&amp;</span><span class="ident" id="3321608">h</span><span class="op" id="3321609">.</span><span class="ident" id="3321610">truncated</span><span class="op" id="3321619">,</span>&nbsp;<span class="string" id="3321621">&#34;truncated&#34;</span><span class="op" id="3321632">,</span>&nbsp;<span class="string" id="3321634">&#34;&#34;</span><span class="op" id="3321636">)</span>&nbsp;<span class="op" id="3321638">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321643">f</span><span class="op" id="3321644">(</span><span class="op" id="3321645">&amp;</span><span class="ident" id="3321646">h</span><span class="op" id="3321647">.</span><span class="ident" id="3321648">recursion_desired</span><span class="op" id="3321665">,</span>&nbsp;<span class="string" id="3321667">&#34;recursion_desired&#34;</span><span class="op" id="3321686">,</span>&nbsp;<span class="string" id="3321688">&#34;&#34;</span><span class="op" id="3321690">)</span>&nbsp;<span class="op" id="3321692">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321697">f</span><span class="op" id="3321698">(</span><span class="op" id="3321699">&amp;</span><span class="ident" id="3321700">h</span><span class="op" id="3321701">.</span><span class="ident" id="3321702">recursion_available</span><span class="op" id="3321721">,</span>&nbsp;<span class="string" id="3321723">&#34;recursion_available&#34;</span><span class="op" id="3321744">,</span>&nbsp;<span class="string" id="3321746">&#34;&#34;</span><span class="op" id="3321748">)</span>&nbsp;<span class="op" id="3321750">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321755">f</span><span class="op" id="3321756">(</span><span class="op" id="3321757">&amp;</span><span class="ident" id="3321758">h</span><span class="op" id="3321759">.</span><span class="ident" id="3321760">rcode</span><span class="op" id="3321765">,</span>&nbsp;<span class="string" id="3321767">&#34;rcode&#34;</span><span class="op" id="3321774">,</span>&nbsp;<span class="string" id="3321776">&#34;&#34;</span><span class="op" id="3321778">)</span><br>
<span class="lineno"></span><span class="op" id="3321780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3321783">type</span>&nbsp;<span class="ident" id="3321788">dnsMsg</span>&nbsp;<span class="keyword" id="3321795">struct</span>&nbsp;<span class="op" id="3321802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321805">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321816">question</span>&nbsp;<span class="op" id="3321825">[</span><span class="op" id="3321826">]</span><span class="ident" id="3321827">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321840">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3321849">[</span><span class="op" id="3321850">]</span><span class="ident" id="3321851">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321858">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321867">[</span><span class="op" id="3321868">]</span><span class="ident" id="3321869">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321876">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321885">[</span><span class="op" id="3321886">]</span><span class="ident" id="3321887">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3321893">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3321896">func</span>&nbsp;<span class="op" id="3321901">(</span><span class="ident" id="3321902">dns</span>&nbsp;<span class="op" id="3321906">*</span><span class="ident" id="3321907">dnsMsg</span><span class="op" id="3321913">)</span>&nbsp;<span class="ident" id="3321915">Pack</span><span class="op" id="3321919">(</span><span class="op" id="3321920">)</span>&nbsp;<span class="op" id="3321922">(</span><span class="ident" id="3321923">msg</span>&nbsp;<span class="op" id="3321927">[</span><span class="op" id="3321928">]</span><span class="builtintype" id="3321929">byte</span><span class="op" id="3321933">,</span>&nbsp;<span class="ident" id="3321935">ok</span>&nbsp;<span class="builtintype" id="3321938">bool</span><span class="op" id="3321942">)</span>&nbsp;<span class="op" id="3321944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321947">var</span>&nbsp;<span class="ident" id="3321951">dh</span>&nbsp;<span class="ident" id="3321954">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3321966">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322022">dh</span><span class="op" id="3322024">.</span><span class="ident" id="3322025">Id</span>&nbsp;<span class="op" id="3322028">=</span>&nbsp;<span class="ident" id="3322030">dns</span><span class="op" id="3322033">.</span><span class="ident" id="3322034">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322038">dh</span><span class="op" id="3322040">.</span><span class="ident" id="3322041">Bits</span>&nbsp;<span class="op" id="3322046">=</span>&nbsp;<span class="builtintype" id="3322048">uint16</span><span class="op" id="3322054">(</span><span class="ident" id="3322055">dns</span><span class="op" id="3322058">.</span><span class="ident" id="3322059">opcode</span><span class="op" id="3322065">)</span><span class="op" id="3322066">&lt;&lt;</span><span class="num" id="3322068">11</span>&nbsp;<span class="op" id="3322071">|</span>&nbsp;<span class="builtintype" id="3322073">uint16</span><span class="op" id="3322079">(</span><span class="ident" id="3322080">dns</span><span class="op" id="3322083">.</span><span class="ident" id="3322084">rcode</span><span class="op" id="3322089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322092">if</span>&nbsp;<span class="ident" id="3322095">dns</span><span class="op" id="3322098">.</span><span class="ident" id="3322099">recursion_available</span>&nbsp;<span class="op" id="3322119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322123">dh</span><span class="op" id="3322125">.</span><span class="ident" id="3322126">Bits</span>&nbsp;<span class="op" id="3322131">|=</span>&nbsp;<span class="ident" id="3322134">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322139">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322142">if</span>&nbsp;<span class="ident" id="3322145">dns</span><span class="op" id="3322148">.</span><span class="ident" id="3322149">recursion_desired</span>&nbsp;<span class="op" id="3322167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322171">dh</span><span class="op" id="3322173">.</span><span class="ident" id="3322174">Bits</span>&nbsp;<span class="op" id="3322179">|=</span>&nbsp;<span class="ident" id="3322182">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322190">if</span>&nbsp;<span class="ident" id="3322193">dns</span><span class="op" id="3322196">.</span><span class="ident" id="3322197">truncated</span>&nbsp;<span class="op" id="3322207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322211">dh</span><span class="op" id="3322213">.</span><span class="ident" id="3322214">Bits</span>&nbsp;<span class="op" id="3322219">|=</span>&nbsp;<span class="ident" id="3322222">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322230">if</span>&nbsp;<span class="ident" id="3322233">dns</span><span class="op" id="3322236">.</span><span class="ident" id="3322237">authoritative</span>&nbsp;<span class="op" id="3322251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322255">dh</span><span class="op" id="3322257">.</span><span class="ident" id="3322258">Bits</span>&nbsp;<span class="op" id="3322263">|=</span>&nbsp;<span class="ident" id="3322266">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322274">if</span>&nbsp;<span class="ident" id="3322277">dns</span><span class="op" id="3322280">.</span><span class="ident" id="3322281">response</span>&nbsp;<span class="op" id="3322290">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322294">dh</span><span class="op" id="3322296">.</span><span class="ident" id="3322297">Bits</span>&nbsp;<span class="op" id="3322302">|=</span>&nbsp;<span class="ident" id="3322305">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322314">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322349">question</span>&nbsp;<span class="op" id="3322358">:=</span>&nbsp;<span class="ident" id="3322361">dns</span><span class="op" id="3322364">.</span><span class="ident" id="3322365">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322375">answer</span>&nbsp;<span class="op" id="3322382">:=</span>&nbsp;<span class="ident" id="3322385">dns</span><span class="op" id="3322388">.</span><span class="ident" id="3322389">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322397">ns</span>&nbsp;<span class="op" id="3322400">:=</span>&nbsp;<span class="ident" id="3322403">dns</span><span class="op" id="3322406">.</span><span class="ident" id="3322407">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322411">extra</span>&nbsp;<span class="op" id="3322417">:=</span>&nbsp;<span class="ident" id="3322420">dns</span><span class="op" id="3322423">.</span><span class="ident" id="3322424">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322432">dh</span><span class="op" id="3322434">.</span><span class="ident" id="3322435">Qdcount</span>&nbsp;<span class="op" id="3322443">=</span>&nbsp;<span class="builtintype" id="3322445">uint16</span><span class="op" id="3322451">(</span><span class="builtinfunc" id="3322452">len</span><span class="op" id="3322455">(</span><span class="ident" id="3322456">question</span><span class="op" id="3322464">)</span><span class="op" id="3322465">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322468">dh</span><span class="op" id="3322470">.</span><span class="ident" id="3322471">Ancount</span>&nbsp;<span class="op" id="3322479">=</span>&nbsp;<span class="builtintype" id="3322481">uint16</span><span class="op" id="3322487">(</span><span class="builtinfunc" id="3322488">len</span><span class="op" id="3322491">(</span><span class="ident" id="3322492">answer</span><span class="op" id="3322498">)</span><span class="op" id="3322499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322502">dh</span><span class="op" id="3322504">.</span><span class="ident" id="3322505">Nscount</span>&nbsp;<span class="op" id="3322513">=</span>&nbsp;<span class="builtintype" id="3322515">uint16</span><span class="op" id="3322521">(</span><span class="builtinfunc" id="3322522">len</span><span class="op" id="3322525">(</span><span class="ident" id="3322526">ns</span><span class="op" id="3322528">)</span><span class="op" id="3322529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322532">dh</span><span class="op" id="3322534">.</span><span class="ident" id="3322535">Arcount</span>&nbsp;<span class="op" id="3322543">=</span>&nbsp;<span class="builtintype" id="3322545">uint16</span><span class="op" id="3322551">(</span><span class="builtinfunc" id="3322552">len</span><span class="op" id="3322555">(</span><span class="ident" id="3322556">extra</span><span class="op" id="3322561">)</span><span class="op" id="3322562">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322566">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322615">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322661">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322699">msg</span>&nbsp;<span class="op" id="3322703">=</span>&nbsp;<span class="builtinfunc" id="3322705">make</span><span class="op" id="3322709">(</span><span class="op" id="3322710">[</span><span class="op" id="3322711">]</span><span class="builtintype" id="3322712">byte</span><span class="op" id="3322716">,</span>&nbsp;<span class="num" id="3322718">2000</span><span class="op" id="3322722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322726">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322770">off</span>&nbsp;<span class="op" id="3322774">:=</span>&nbsp;<span class="num" id="3322777">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322780">off</span><span class="op" id="3322783">,</span>&nbsp;<span class="ident" id="3322785">ok</span>&nbsp;<span class="op" id="3322788">=</span>&nbsp;<span class="ident" id="3322790">packStruct</span><span class="op" id="3322800">(</span><span class="op" id="3322801">&amp;</span><span class="ident" id="3322802">dh</span><span class="op" id="3322804">,</span>&nbsp;<span class="ident" id="3322806">msg</span><span class="op" id="3322809">,</span>&nbsp;<span class="ident" id="3322811">off</span><span class="op" id="3322814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322817">for</span>&nbsp;<span class="ident" id="3322821">i</span>&nbsp;<span class="op" id="3322823">:=</span>&nbsp;<span class="num" id="3322826">0</span><span class="op" id="3322827">;</span>&nbsp;<span class="ident" id="3322829">i</span>&nbsp;<span class="op" id="3322831">&lt;</span>&nbsp;<span class="builtinfunc" id="3322833">len</span><span class="op" id="3322836">(</span><span class="ident" id="3322837">question</span><span class="op" id="3322845">)</span><span class="op" id="3322846">;</span>&nbsp;<span class="ident" id="3322848">i</span><span class="op" id="3322849">++</span>&nbsp;<span class="op" id="3322852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322856">off</span><span class="op" id="3322859">,</span>&nbsp;<span class="ident" id="3322861">ok</span>&nbsp;<span class="op" id="3322864">=</span>&nbsp;<span class="ident" id="3322866">packStruct</span><span class="op" id="3322876">(</span><span class="op" id="3322877">&amp;</span><span class="ident" id="3322878">question</span><span class="op" id="3322886">[</span><span class="ident" id="3322887">i</span><span class="op" id="3322888">]</span><span class="op" id="3322889">,</span>&nbsp;<span class="ident" id="3322891">msg</span><span class="op" id="3322894">,</span>&nbsp;<span class="ident" id="3322896">off</span><span class="op" id="3322899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322902">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322905">for</span>&nbsp;<span class="ident" id="3322909">i</span>&nbsp;<span class="op" id="3322911">:=</span>&nbsp;<span class="num" id="3322914">0</span><span class="op" id="3322915">;</span>&nbsp;<span class="ident" id="3322917">i</span>&nbsp;<span class="op" id="3322919">&lt;</span>&nbsp;<span class="builtinfunc" id="3322921">len</span><span class="op" id="3322924">(</span><span class="ident" id="3322925">answer</span><span class="op" id="3322931">)</span><span class="op" id="3322932">;</span>&nbsp;<span class="ident" id="3322934">i</span><span class="op" id="3322935">++</span>&nbsp;<span class="op" id="3322938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322942">off</span><span class="op" id="3322945">,</span>&nbsp;<span class="ident" id="3322947">ok</span>&nbsp;<span class="op" id="3322950">=</span>&nbsp;<span class="ident" id="3322952">packRR</span><span class="op" id="3322958">(</span><span class="ident" id="3322959">answer</span><span class="op" id="3322965">[</span><span class="ident" id="3322966">i</span><span class="op" id="3322967">]</span><span class="op" id="3322968">,</span>&nbsp;<span class="ident" id="3322970">msg</span><span class="op" id="3322973">,</span>&nbsp;<span class="ident" id="3322975">off</span><span class="op" id="3322978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322984">for</span>&nbsp;<span class="ident" id="3322988">i</span>&nbsp;<span class="op" id="3322990">:=</span>&nbsp;<span class="num" id="3322993">0</span><span class="op" id="3322994">;</span>&nbsp;<span class="ident" id="3322996">i</span>&nbsp;<span class="op" id="3322998">&lt;</span>&nbsp;<span class="builtinfunc" id="3323000">len</span><span class="op" id="3323003">(</span><span class="ident" id="3323004">ns</span><span class="op" id="3323006">)</span><span class="op" id="3323007">;</span>&nbsp;<span class="ident" id="3323009">i</span><span class="op" id="3323010">++</span>&nbsp;<span class="op" id="3323013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323017">off</span><span class="op" id="3323020">,</span>&nbsp;<span class="ident" id="3323022">ok</span>&nbsp;<span class="op" id="3323025">=</span>&nbsp;<span class="ident" id="3323027">packRR</span><span class="op" id="3323033">(</span><span class="ident" id="3323034">ns</span><span class="op" id="3323036">[</span><span class="ident" id="3323037">i</span><span class="op" id="3323038">]</span><span class="op" id="3323039">,</span>&nbsp;<span class="ident" id="3323041">msg</span><span class="op" id="3323044">,</span>&nbsp;<span class="ident" id="3323046">off</span><span class="op" id="3323049">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323055">for</span>&nbsp;<span class="ident" id="3323059">i</span>&nbsp;<span class="op" id="3323061">:=</span>&nbsp;<span class="num" id="3323064">0</span><span class="op" id="3323065">;</span>&nbsp;<span class="ident" id="3323067">i</span>&nbsp;<span class="op" id="3323069">&lt;</span>&nbsp;<span class="builtinfunc" id="3323071">len</span><span class="op" id="3323074">(</span><span class="ident" id="3323075">extra</span><span class="op" id="3323080">)</span><span class="op" id="3323081">;</span>&nbsp;<span class="ident" id="3323083">i</span><span class="op" id="3323084">++</span>&nbsp;<span class="op" id="3323087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323091">off</span><span class="op" id="3323094">,</span>&nbsp;<span class="ident" id="3323096">ok</span>&nbsp;<span class="op" id="3323099">=</span>&nbsp;<span class="ident" id="3323101">packRR</span><span class="op" id="3323107">(</span><span class="ident" id="3323108">extra</span><span class="op" id="3323113">[</span><span class="ident" id="3323114">i</span><span class="op" id="3323115">]</span><span class="op" id="3323116">,</span>&nbsp;<span class="ident" id="3323118">msg</span><span class="op" id="3323121">,</span>&nbsp;<span class="ident" id="3323123">off</span><span class="op" id="3323126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323132">if</span>&nbsp;<span class="op" id="3323135">!</span><span class="ident" id="3323136">ok</span>&nbsp;<span class="op" id="3323139">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323143">return</span>&nbsp;<span class="ident" id="3323150">nil</span><span class="op" id="3323153">,</span>&nbsp;<span class="ident" id="3323155">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323165">return</span>&nbsp;<span class="ident" id="3323172">msg</span><span class="op" id="3323175">[</span><span class="num" id="3323176">0</span><span class="op" id="3323177">:</span><span class="ident" id="3323178">off</span><span class="op" id="3323181">]</span><span class="op" id="3323182">,</span>&nbsp;<span class="ident" id="3323184">true</span><br>
<span class="lineno"></span><span class="op" id="3323189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3323192">func</span>&nbsp;<span class="op" id="3323197">(</span><span class="ident" id="3323198">dns</span>&nbsp;<span class="op" id="3323202">*</span><span class="ident" id="3323203">dnsMsg</span><span class="op" id="3323209">)</span>&nbsp;<span class="ident" id="3323211">Unpack</span><span class="op" id="3323217">(</span><span class="ident" id="3323218">msg</span>&nbsp;<span class="op" id="3323222">[</span><span class="op" id="3323223">]</span><span class="builtintype" id="3323224">byte</span><span class="op" id="3323228">)</span>&nbsp;<span class="builtintype" id="3323230">bool</span>&nbsp;<span class="op" id="3323235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323238">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323250">var</span>&nbsp;<span class="ident" id="3323254">dh</span>&nbsp;<span class="ident" id="3323257">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323268">off</span>&nbsp;<span class="op" id="3323272">:=</span>&nbsp;<span class="num" id="3323275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323278">var</span>&nbsp;<span class="ident" id="3323282">ok</span>&nbsp;<span class="builtintype" id="3323285">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323291">if</span>&nbsp;<span class="ident" id="3323294">off</span><span class="op" id="3323297">,</span>&nbsp;<span class="ident" id="3323299">ok</span>&nbsp;<span class="op" id="3323302">=</span>&nbsp;<span class="ident" id="3323304">unpackStruct</span><span class="op" id="3323316">(</span><span class="op" id="3323317">&amp;</span><span class="ident" id="3323318">dh</span><span class="op" id="3323320">,</span>&nbsp;<span class="ident" id="3323322">msg</span><span class="op" id="3323325">,</span>&nbsp;<span class="ident" id="3323327">off</span><span class="op" id="3323330">)</span><span class="op" id="3323331">;</span>&nbsp;<span class="op" id="3323333">!</span><span class="ident" id="3323334">ok</span>&nbsp;<span class="op" id="3323337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323341">return</span>&nbsp;<span class="ident" id="3323348">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323358">dns</span><span class="op" id="3323361">.</span><span class="ident" id="3323362">id</span>&nbsp;<span class="op" id="3323365">=</span>&nbsp;<span class="ident" id="3323367">dh</span><span class="op" id="3323369">.</span><span class="ident" id="3323370">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323374">dns</span><span class="op" id="3323377">.</span><span class="ident" id="3323378">response</span>&nbsp;<span class="op" id="3323387">=</span>&nbsp;<span class="op" id="3323389">(</span><span class="ident" id="3323390">dh</span><span class="op" id="3323392">.</span><span class="ident" id="3323393">Bits</span>&nbsp;<span class="op" id="3323398">&amp;</span>&nbsp;<span class="ident" id="3323400">_QR</span><span class="op" id="3323403">)</span>&nbsp;<span class="op" id="3323405">!=</span>&nbsp;<span class="num" id="3323408">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323411">dns</span><span class="op" id="3323414">.</span><span class="ident" id="3323415">opcode</span>&nbsp;<span class="op" id="3323422">=</span>&nbsp;<span class="builtintype" id="3323424">int</span><span class="op" id="3323427">(</span><span class="ident" id="3323428">dh</span><span class="op" id="3323430">.</span><span class="ident" id="3323431">Bits</span><span class="op" id="3323435">&gt;&gt;</span><span class="num" id="3323437">11</span><span class="op" id="3323439">)</span>&nbsp;<span class="op" id="3323441">&amp;</span>&nbsp;<span class="num" id="3323443">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323448">dns</span><span class="op" id="3323451">.</span><span class="ident" id="3323452">authoritative</span>&nbsp;<span class="op" id="3323466">=</span>&nbsp;<span class="op" id="3323468">(</span><span class="ident" id="3323469">dh</span><span class="op" id="3323471">.</span><span class="ident" id="3323472">Bits</span>&nbsp;<span class="op" id="3323477">&amp;</span>&nbsp;<span class="ident" id="3323479">_AA</span><span class="op" id="3323482">)</span>&nbsp;<span class="op" id="3323484">!=</span>&nbsp;<span class="num" id="3323487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323490">dns</span><span class="op" id="3323493">.</span><span class="ident" id="3323494">truncated</span>&nbsp;<span class="op" id="3323504">=</span>&nbsp;<span class="op" id="3323506">(</span><span class="ident" id="3323507">dh</span><span class="op" id="3323509">.</span><span class="ident" id="3323510">Bits</span>&nbsp;<span class="op" id="3323515">&amp;</span>&nbsp;<span class="ident" id="3323517">_TC</span><span class="op" id="3323520">)</span>&nbsp;<span class="op" id="3323522">!=</span>&nbsp;<span class="num" id="3323525">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323528">dns</span><span class="op" id="3323531">.</span><span class="ident" id="3323532">recursion_desired</span>&nbsp;<span class="op" id="3323550">=</span>&nbsp;<span class="op" id="3323552">(</span><span class="ident" id="3323553">dh</span><span class="op" id="3323555">.</span><span class="ident" id="3323556">Bits</span>&nbsp;<span class="op" id="3323561">&amp;</span>&nbsp;<span class="ident" id="3323563">_RD</span><span class="op" id="3323566">)</span>&nbsp;<span class="op" id="3323568">!=</span>&nbsp;<span class="num" id="3323571">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323574">dns</span><span class="op" id="3323577">.</span><span class="ident" id="3323578">recursion_available</span>&nbsp;<span class="op" id="3323598">=</span>&nbsp;<span class="op" id="3323600">(</span><span class="ident" id="3323601">dh</span><span class="op" id="3323603">.</span><span class="ident" id="3323604">Bits</span>&nbsp;<span class="op" id="3323609">&amp;</span>&nbsp;<span class="ident" id="3323611">_RA</span><span class="op" id="3323614">)</span>&nbsp;<span class="op" id="3323616">!=</span>&nbsp;<span class="num" id="3323619">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323622">dns</span><span class="op" id="3323625">.</span><span class="ident" id="3323626">rcode</span>&nbsp;<span class="op" id="3323632">=</span>&nbsp;<span class="builtintype" id="3323634">int</span><span class="op" id="3323637">(</span><span class="ident" id="3323638">dh</span><span class="op" id="3323640">.</span><span class="ident" id="3323641">Bits</span>&nbsp;<span class="op" id="3323646">&amp;</span>&nbsp;<span class="num" id="3323648">0xF</span><span class="op" id="3323651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3323655">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323667">dns</span><span class="op" id="3323670">.</span><span class="ident" id="3323671">question</span>&nbsp;<span class="op" id="3323680">=</span>&nbsp;<span class="builtinfunc" id="3323682">make</span><span class="op" id="3323686">(</span><span class="op" id="3323687">[</span><span class="op" id="3323688">]</span><span class="ident" id="3323689">dnsQuestion</span><span class="op" id="3323700">,</span>&nbsp;<span class="ident" id="3323702">dh</span><span class="op" id="3323704">.</span><span class="ident" id="3323705">Qdcount</span><span class="op" id="3323712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323715">dns</span><span class="op" id="3323718">.</span><span class="ident" id="3323719">answer</span>&nbsp;<span class="op" id="3323726">=</span>&nbsp;<span class="builtinfunc" id="3323728">make</span><span class="op" id="3323732">(</span><span class="op" id="3323733">[</span><span class="op" id="3323734">]</span><span class="ident" id="3323735">dnsRR</span><span class="op" id="3323740">,</span>&nbsp;<span class="num" id="3323742">0</span><span class="op" id="3323743">,</span>&nbsp;<span class="ident" id="3323745">dh</span><span class="op" id="3323747">.</span><span class="ident" id="3323748">Ancount</span><span class="op" id="3323755">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323758">dns</span><span class="op" id="3323761">.</span><span class="ident" id="3323762">ns</span>&nbsp;<span class="op" id="3323765">=</span>&nbsp;<span class="builtinfunc" id="3323767">make</span><span class="op" id="3323771">(</span><span class="op" id="3323772">[</span><span class="op" id="3323773">]</span><span class="ident" id="3323774">dnsRR</span><span class="op" id="3323779">,</span>&nbsp;<span class="num" id="3323781">0</span><span class="op" id="3323782">,</span>&nbsp;<span class="ident" id="3323784">dh</span><span class="op" id="3323786">.</span><span class="ident" id="3323787">Nscount</span><span class="op" id="3323794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323797">dns</span><span class="op" id="3323800">.</span><span class="ident" id="3323801">extra</span>&nbsp;<span class="op" id="3323807">=</span>&nbsp;<span class="builtinfunc" id="3323809">make</span><span class="op" id="3323813">(</span><span class="op" id="3323814">[</span><span class="op" id="3323815">]</span><span class="ident" id="3323816">dnsRR</span><span class="op" id="3323821">,</span>&nbsp;<span class="num" id="3323823">0</span><span class="op" id="3323824">,</span>&nbsp;<span class="ident" id="3323826">dh</span><span class="op" id="3323828">.</span><span class="ident" id="3323829">Arcount</span><span class="op" id="3323836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323840">var</span>&nbsp;<span class="ident" id="3323844">rec</span>&nbsp;<span class="ident" id="3323848">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323856">for</span>&nbsp;<span class="ident" id="3323860">i</span>&nbsp;<span class="op" id="3323862">:=</span>&nbsp;<span class="num" id="3323865">0</span><span class="op" id="3323866">;</span>&nbsp;<span class="ident" id="3323868">i</span>&nbsp;<span class="op" id="3323870">&lt;</span>&nbsp;<span class="builtinfunc" id="3323872">len</span><span class="op" id="3323875">(</span><span class="ident" id="3323876">dns</span><span class="op" id="3323879">.</span><span class="ident" id="3323880">question</span><span class="op" id="3323888">)</span><span class="op" id="3323889">;</span>&nbsp;<span class="ident" id="3323891">i</span><span class="op" id="3323892">++</span>&nbsp;<span class="op" id="3323895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323899">off</span><span class="op" id="3323902">,</span>&nbsp;<span class="ident" id="3323904">ok</span>&nbsp;<span class="op" id="3323907">=</span>&nbsp;<span class="ident" id="3323909">unpackStruct</span><span class="op" id="3323921">(</span><span class="op" id="3323922">&amp;</span><span class="ident" id="3323923">dns</span><span class="op" id="3323926">.</span><span class="ident" id="3323927">question</span><span class="op" id="3323935">[</span><span class="ident" id="3323936">i</span><span class="op" id="3323937">]</span><span class="op" id="3323938">,</span>&nbsp;<span class="ident" id="3323940">msg</span><span class="op" id="3323943">,</span>&nbsp;<span class="ident" id="3323945">off</span><span class="op" id="3323948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323954">for</span>&nbsp;<span class="ident" id="3323958">i</span>&nbsp;<span class="op" id="3323960">:=</span>&nbsp;<span class="num" id="3323963">0</span><span class="op" id="3323964">;</span>&nbsp;<span class="ident" id="3323966">i</span>&nbsp;<span class="op" id="3323968">&lt;</span>&nbsp;<span class="builtintype" id="3323970">int</span><span class="op" id="3323973">(</span><span class="ident" id="3323974">dh</span><span class="op" id="3323976">.</span><span class="ident" id="3323977">Ancount</span><span class="op" id="3323984">)</span><span class="op" id="3323985">;</span>&nbsp;<span class="ident" id="3323987">i</span><span class="op" id="3323988">++</span>&nbsp;<span class="op" id="3323991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323995">rec</span><span class="op" id="3323998">,</span>&nbsp;<span class="ident" id="3324000">off</span><span class="op" id="3324003">,</span>&nbsp;<span class="ident" id="3324005">ok</span>&nbsp;<span class="op" id="3324008">=</span>&nbsp;<span class="ident" id="3324010">unpackRR</span><span class="op" id="3324018">(</span><span class="ident" id="3324019">msg</span><span class="op" id="3324022">,</span>&nbsp;<span class="ident" id="3324024">off</span><span class="op" id="3324027">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324031">if</span>&nbsp;<span class="op" id="3324034">!</span><span class="ident" id="3324035">ok</span>&nbsp;<span class="op" id="3324038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324043">return</span>&nbsp;<span class="ident" id="3324050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324062">dns</span><span class="op" id="3324065">.</span><span class="ident" id="3324066">answer</span>&nbsp;<span class="op" id="3324073">=</span>&nbsp;<span class="builtinfunc" id="3324075">append</span><span class="op" id="3324081">(</span><span class="ident" id="3324082">dns</span><span class="op" id="3324085">.</span><span class="ident" id="3324086">answer</span><span class="op" id="3324092">,</span>&nbsp;<span class="ident" id="3324094">rec</span><span class="op" id="3324097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324100">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324103">for</span>&nbsp;<span class="ident" id="3324107">i</span>&nbsp;<span class="op" id="3324109">:=</span>&nbsp;<span class="num" id="3324112">0</span><span class="op" id="3324113">;</span>&nbsp;<span class="ident" id="3324115">i</span>&nbsp;<span class="op" id="3324117">&lt;</span>&nbsp;<span class="builtintype" id="3324119">int</span><span class="op" id="3324122">(</span><span class="ident" id="3324123">dh</span><span class="op" id="3324125">.</span><span class="ident" id="3324126">Nscount</span><span class="op" id="3324133">)</span><span class="op" id="3324134">;</span>&nbsp;<span class="ident" id="3324136">i</span><span class="op" id="3324137">++</span>&nbsp;<span class="op" id="3324140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324144">rec</span><span class="op" id="3324147">,</span>&nbsp;<span class="ident" id="3324149">off</span><span class="op" id="3324152">,</span>&nbsp;<span class="ident" id="3324154">ok</span>&nbsp;<span class="op" id="3324157">=</span>&nbsp;<span class="ident" id="3324159">unpackRR</span><span class="op" id="3324167">(</span><span class="ident" id="3324168">msg</span><span class="op" id="3324171">,</span>&nbsp;<span class="ident" id="3324173">off</span><span class="op" id="3324176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324180">if</span>&nbsp;<span class="op" id="3324183">!</span><span class="ident" id="3324184">ok</span>&nbsp;<span class="op" id="3324187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324192">return</span>&nbsp;<span class="ident" id="3324199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324207">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324211">dns</span><span class="op" id="3324214">.</span><span class="ident" id="3324215">ns</span>&nbsp;<span class="op" id="3324218">=</span>&nbsp;<span class="builtinfunc" id="3324220">append</span><span class="op" id="3324226">(</span><span class="ident" id="3324227">dns</span><span class="op" id="3324230">.</span><span class="ident" id="3324231">ns</span><span class="op" id="3324233">,</span>&nbsp;<span class="ident" id="3324235">rec</span><span class="op" id="3324238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324244">for</span>&nbsp;<span class="ident" id="3324248">i</span>&nbsp;<span class="op" id="3324250">:=</span>&nbsp;<span class="num" id="3324253">0</span><span class="op" id="3324254">;</span>&nbsp;<span class="ident" id="3324256">i</span>&nbsp;<span class="op" id="3324258">&lt;</span>&nbsp;<span class="builtintype" id="3324260">int</span><span class="op" id="3324263">(</span><span class="ident" id="3324264">dh</span><span class="op" id="3324266">.</span><span class="ident" id="3324267">Arcount</span><span class="op" id="3324274">)</span><span class="op" id="3324275">;</span>&nbsp;<span class="ident" id="3324277">i</span><span class="op" id="3324278">++</span>&nbsp;<span class="op" id="3324281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324285">rec</span><span class="op" id="3324288">,</span>&nbsp;<span class="ident" id="3324290">off</span><span class="op" id="3324293">,</span>&nbsp;<span class="ident" id="3324295">ok</span>&nbsp;<span class="op" id="3324298">=</span>&nbsp;<span class="ident" id="3324300">unpackRR</span><span class="op" id="3324308">(</span><span class="ident" id="3324309">msg</span><span class="op" id="3324312">,</span>&nbsp;<span class="ident" id="3324314">off</span><span class="op" id="3324317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324321">if</span>&nbsp;<span class="op" id="3324324">!</span><span class="ident" id="3324325">ok</span>&nbsp;<span class="op" id="3324328">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324333">return</span>&nbsp;<span class="ident" id="3324340">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324352">dns</span><span class="op" id="3324355">.</span><span class="ident" id="3324356">extra</span>&nbsp;<span class="op" id="3324362">=</span>&nbsp;<span class="builtinfunc" id="3324364">append</span><span class="op" id="3324370">(</span><span class="ident" id="3324371">dns</span><span class="op" id="3324374">.</span><span class="ident" id="3324375">extra</span><span class="op" id="3324380">,</span>&nbsp;<span class="ident" id="3324382">rec</span><span class="op" id="3324385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324391">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324416">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324479">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324485">return</span>&nbsp;<span class="ident" id="3324492">true</span><br>
<span class="lineno"></span><span class="op" id="3324497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3324500">func</span>&nbsp;<span class="op" id="3324505">(</span><span class="ident" id="3324506">dns</span>&nbsp;<span class="op" id="3324510">*</span><span class="ident" id="3324511">dnsMsg</span><span class="op" id="3324517">)</span>&nbsp;<span class="ident" id="3324519">String</span><span class="op" id="3324525">(</span><span class="op" id="3324526">)</span>&nbsp;<span class="builtintype" id="3324528">string</span>&nbsp;<span class="op" id="3324535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324538">s</span>&nbsp;<span class="op" id="3324540">:=</span>&nbsp;<span class="string" id="3324543">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3324551">+</span>&nbsp;<span class="ident" id="3324553">printStruct</span><span class="op" id="3324564">(</span><span class="op" id="3324565">&amp;</span><span class="ident" id="3324566">dns</span><span class="op" id="3324569">.</span><span class="ident" id="3324570">dnsMsgHdr</span><span class="op" id="3324579">)</span>&nbsp;<span class="op" id="3324581">+</span>&nbsp;<span class="string" id="3324583">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324589">if</span>&nbsp;<span class="builtinfunc" id="3324592">len</span><span class="op" id="3324595">(</span><span class="ident" id="3324596">dns</span><span class="op" id="3324599">.</span><span class="ident" id="3324600">question</span><span class="op" id="3324608">)</span>&nbsp;<span class="op" id="3324610">&gt;</span>&nbsp;<span class="num" id="3324612">0</span>&nbsp;<span class="op" id="3324614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324618">s</span>&nbsp;<span class="op" id="3324620">+=</span>&nbsp;<span class="string" id="3324623">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324642">for</span>&nbsp;<span class="ident" id="3324646">i</span>&nbsp;<span class="op" id="3324648">:=</span>&nbsp;<span class="num" id="3324651">0</span><span class="op" id="3324652">;</span>&nbsp;<span class="ident" id="3324654">i</span>&nbsp;<span class="op" id="3324656">&lt;</span>&nbsp;<span class="builtinfunc" id="3324658">len</span><span class="op" id="3324661">(</span><span class="ident" id="3324662">dns</span><span class="op" id="3324665">.</span><span class="ident" id="3324666">question</span><span class="op" id="3324674">)</span><span class="op" id="3324675">;</span>&nbsp;<span class="ident" id="3324677">i</span><span class="op" id="3324678">++</span>&nbsp;<span class="op" id="3324681">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324686">s</span>&nbsp;<span class="op" id="3324688">+=</span>&nbsp;<span class="ident" id="3324691">printStruct</span><span class="op" id="3324702">(</span><span class="op" id="3324703">&amp;</span><span class="ident" id="3324704">dns</span><span class="op" id="3324707">.</span><span class="ident" id="3324708">question</span><span class="op" id="3324716">[</span><span class="ident" id="3324717">i</span><span class="op" id="3324718">]</span><span class="op" id="3324719">)</span>&nbsp;<span class="op" id="3324721">+</span>&nbsp;<span class="string" id="3324723">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324736">if</span>&nbsp;<span class="builtinfunc" id="3324739">len</span><span class="op" id="3324742">(</span><span class="ident" id="3324743">dns</span><span class="op" id="3324746">.</span><span class="ident" id="3324747">answer</span><span class="op" id="3324753">)</span>&nbsp;<span class="op" id="3324755">&gt;</span>&nbsp;<span class="num" id="3324757">0</span>&nbsp;<span class="op" id="3324759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324763">s</span>&nbsp;<span class="op" id="3324765">+=</span>&nbsp;<span class="string" id="3324768">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324785">for</span>&nbsp;<span class="ident" id="3324789">i</span>&nbsp;<span class="op" id="3324791">:=</span>&nbsp;<span class="num" id="3324794">0</span><span class="op" id="3324795">;</span>&nbsp;<span class="ident" id="3324797">i</span>&nbsp;<span class="op" id="3324799">&lt;</span>&nbsp;<span class="builtinfunc" id="3324801">len</span><span class="op" id="3324804">(</span><span class="ident" id="3324805">dns</span><span class="op" id="3324808">.</span><span class="ident" id="3324809">answer</span><span class="op" id="3324815">)</span><span class="op" id="3324816">;</span>&nbsp;<span class="ident" id="3324818">i</span><span class="op" id="3324819">++</span>&nbsp;<span class="op" id="3324822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324827">s</span>&nbsp;<span class="op" id="3324829">+=</span>&nbsp;<span class="ident" id="3324832">printStruct</span><span class="op" id="3324843">(</span><span class="ident" id="3324844">dns</span><span class="op" id="3324847">.</span><span class="ident" id="3324848">answer</span><span class="op" id="3324854">[</span><span class="ident" id="3324855">i</span><span class="op" id="3324856">]</span><span class="op" id="3324857">)</span>&nbsp;<span class="op" id="3324859">+</span>&nbsp;<span class="string" id="3324861">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324874">if</span>&nbsp;<span class="builtinfunc" id="3324877">len</span><span class="op" id="3324880">(</span><span class="ident" id="3324881">dns</span><span class="op" id="3324884">.</span><span class="ident" id="3324885">ns</span><span class="op" id="3324887">)</span>&nbsp;<span class="op" id="3324889">&gt;</span>&nbsp;<span class="num" id="3324891">0</span>&nbsp;<span class="op" id="3324893">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324897">s</span>&nbsp;<span class="op" id="3324899">+=</span>&nbsp;<span class="string" id="3324902">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324924">for</span>&nbsp;<span class="ident" id="3324928">i</span>&nbsp;<span class="op" id="3324930">:=</span>&nbsp;<span class="num" id="3324933">0</span><span class="op" id="3324934">;</span>&nbsp;<span class="ident" id="3324936">i</span>&nbsp;<span class="op" id="3324938">&lt;</span>&nbsp;<span class="builtinfunc" id="3324940">len</span><span class="op" id="3324943">(</span><span class="ident" id="3324944">dns</span><span class="op" id="3324947">.</span><span class="ident" id="3324948">ns</span><span class="op" id="3324950">)</span><span class="op" id="3324951">;</span>&nbsp;<span class="ident" id="3324953">i</span><span class="op" id="3324954">++</span>&nbsp;<span class="op" id="3324957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324962">s</span>&nbsp;<span class="op" id="3324964">+=</span>&nbsp;<span class="ident" id="3324967">printStruct</span><span class="op" id="3324978">(</span><span class="ident" id="3324979">dns</span><span class="op" id="3324982">.</span><span class="ident" id="3324983">ns</span><span class="op" id="3324985">[</span><span class="ident" id="3324986">i</span><span class="op" id="3324987">]</span><span class="op" id="3324988">)</span>&nbsp;<span class="op" id="3324990">+</span>&nbsp;<span class="string" id="3324992">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3324999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325002">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325005">if</span>&nbsp;<span class="builtinfunc" id="3325008">len</span><span class="op" id="3325011">(</span><span class="ident" id="3325012">dns</span><span class="op" id="3325015">.</span><span class="ident" id="3325016">extra</span><span class="op" id="3325021">)</span>&nbsp;<span class="op" id="3325023">&gt;</span>&nbsp;<span class="num" id="3325025">0</span>&nbsp;<span class="op" id="3325027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325031">s</span>&nbsp;<span class="op" id="3325033">+=</span>&nbsp;<span class="string" id="3325036">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325051">for</span>&nbsp;<span class="ident" id="3325055">i</span>&nbsp;<span class="op" id="3325057">:=</span>&nbsp;<span class="num" id="3325060">0</span><span class="op" id="3325061">;</span>&nbsp;<span class="ident" id="3325063">i</span>&nbsp;<span class="op" id="3325065">&lt;</span>&nbsp;<span class="builtinfunc" id="3325067">len</span><span class="op" id="3325070">(</span><span class="ident" id="3325071">dns</span><span class="op" id="3325074">.</span><span class="ident" id="3325075">extra</span><span class="op" id="3325080">)</span><span class="op" id="3325081">;</span>&nbsp;<span class="ident" id="3325083">i</span><span class="op" id="3325084">++</span>&nbsp;<span class="op" id="3325087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325092">s</span>&nbsp;<span class="op" id="3325094">+=</span>&nbsp;<span class="ident" id="3325097">printStruct</span><span class="op" id="3325108">(</span><span class="ident" id="3325109">dns</span><span class="op" id="3325112">.</span><span class="ident" id="3325113">extra</span><span class="op" id="3325118">[</span><span class="ident" id="3325119">i</span><span class="op" id="3325120">]</span><span class="op" id="3325121">)</span>&nbsp;<span class="op" id="3325123">+</span>&nbsp;<span class="string" id="3325125">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325132">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325138">return</span>&nbsp;<span class="ident" id="3325145">s</span><br>
<span class="lineno"></span><span class="op" id="3325147">}</span>
</div>
</body>
</html>
