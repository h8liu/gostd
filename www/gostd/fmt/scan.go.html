<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html" class="current">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2381602">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2381657">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2381711">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2381762">package</span>&nbsp;<span class="ident" id="2381770">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2381775">import</span>&nbsp;<span class="op" id="2381782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381785">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381795">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381801">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381809">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381815">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381826">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381837">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2381845">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2381860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2381863">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2381932">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2381999">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2382069">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2382104">type</span>&nbsp;<span class="ident" id="2382109">runeUnreader</span>&nbsp;<span class="keyword" id="2382122">interface</span>&nbsp;<span class="op" id="2382132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2382135">UnreadRune</span><span class="op" id="2382145">(</span><span class="op" id="2382146">)</span>&nbsp;<span class="builtintype" id="2382148">error</span><br>
<span class="lineno"></span><span class="op" id="2382154">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2382157">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2382226">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2382290">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2382337">type</span>&nbsp;<span class="ident" id="2382342">ScanState</span>&nbsp;<span class="keyword" id="2382352">interface</span>&nbsp;<span class="op" id="2382362">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382365">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382435">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382502">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382571">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2382596">ReadRune</span><span class="op" id="2382604">(</span><span class="op" id="2382605">)</span>&nbsp;<span class="op" id="2382607">(</span><span class="ident" id="2382608">r</span>&nbsp;<span class="builtintype" id="2382610">rune</span><span class="op" id="2382614">,</span>&nbsp;<span class="ident" id="2382616">size</span>&nbsp;<span class="builtintype" id="2382621">int</span><span class="op" id="2382624">,</span>&nbsp;<span class="ident" id="2382626">err</span>&nbsp;<span class="builtintype" id="2382630">error</span><span class="op" id="2382635">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382638">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2382711">UnreadRune</span><span class="op" id="2382721">(</span><span class="op" id="2382722">)</span>&nbsp;<span class="builtintype" id="2382724">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382731">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382801">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382876">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2382909">SkipSpace</span><span class="op" id="2382918">(</span><span class="op" id="2382919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382922">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2382996">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383060">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383132">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383205">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383278">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383353">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383430">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383485">Token</span><span class="op" id="2383490">(</span><span class="ident" id="2383491">skipSpace</span>&nbsp;<span class="builtintype" id="2383501">bool</span><span class="op" id="2383505">,</span>&nbsp;<span class="ident" id="2383507">f</span>&nbsp;<span class="keyword" id="2383509">func</span><span class="op" id="2383513">(</span><span class="builtintype" id="2383514">rune</span><span class="op" id="2383518">)</span>&nbsp;<span class="builtintype" id="2383520">bool</span><span class="op" id="2383524">)</span>&nbsp;<span class="op" id="2383526">(</span><span class="ident" id="2383527">token</span>&nbsp;<span class="op" id="2383533">[</span><span class="op" id="2383534">]</span><span class="builtintype" id="2383535">byte</span><span class="op" id="2383539">,</span>&nbsp;<span class="ident" id="2383541">err</span>&nbsp;<span class="builtintype" id="2383545">error</span><span class="op" id="2383550">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383553">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383630">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383667">Width</span><span class="op" id="2383672">(</span><span class="op" id="2383673">)</span>&nbsp;<span class="op" id="2383675">(</span><span class="ident" id="2383676">wid</span>&nbsp;<span class="builtintype" id="2383680">int</span><span class="op" id="2383683">,</span>&nbsp;<span class="ident" id="2383685">ok</span>&nbsp;<span class="builtintype" id="2383688">bool</span><span class="op" id="2383692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383695">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383770">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383836">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383898">Read</span><span class="op" id="2383902">(</span><span class="ident" id="2383903">buf</span>&nbsp;<span class="op" id="2383907">[</span><span class="op" id="2383908">]</span><span class="builtintype" id="2383909">byte</span><span class="op" id="2383913">)</span>&nbsp;<span class="op" id="2383915">(</span><span class="ident" id="2383916">n</span>&nbsp;<span class="builtintype" id="2383918">int</span><span class="op" id="2383921">,</span>&nbsp;<span class="ident" id="2383923">err</span>&nbsp;<span class="builtintype" id="2383927">error</span><span class="op" id="2383932">)</span><br>
<span class="lineno"></span><span class="op" id="2383934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2383937">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2384012">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2384088">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2384166">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2384232">type</span>&nbsp;<span class="ident" id="2384237">Scanner</span>&nbsp;<span class="keyword" id="2384245">interface</span>&nbsp;<span class="op" id="2384255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384258">Scan</span><span class="op" id="2384262">(</span><span class="ident" id="2384263">state</span>&nbsp;<span class="ident" id="2384269">ScanState</span><span class="op" id="2384278">,</span>&nbsp;<span class="ident" id="2384280">verb</span>&nbsp;<span class="builtintype" id="2384285">rune</span><span class="op" id="2384289">)</span>&nbsp;<span class="builtintype" id="2384291">error</span><br>
<span class="lineno">65</span><span class="op" id="2384297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2384300">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2384364">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2384433">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2384500">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2384570">func</span>&nbsp;<span class="ident" id="2384575">Scan</span><span class="op" id="2384579">(</span><span class="ident" id="2384580">a</span>&nbsp;<span class="op" id="2384582">...</span><span class="keyword" id="2384585">interface</span><span class="op" id="2384594">{</span><span class="op" id="2384595">}</span><span class="op" id="2384596">)</span>&nbsp;<span class="op" id="2384598">(</span><span class="ident" id="2384599">n</span>&nbsp;<span class="builtintype" id="2384601">int</span><span class="op" id="2384604">,</span>&nbsp;<span class="ident" id="2384606">err</span>&nbsp;<span class="builtintype" id="2384610">error</span><span class="op" id="2384615">)</span>&nbsp;<span class="op" id="2384617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2384620">return</span>&nbsp;<span class="ident" id="2384627">Fscan</span><span class="op" id="2384632">(</span><span class="ident" id="2384633">os</span><span class="op" id="2384635">.</span><span class="ident" id="2384636">Stdin</span><span class="op" id="2384641">,</span>&nbsp;<span class="ident" id="2384643">a</span><span class="op" id="2384644">...</span><span class="op" id="2384647">)</span><br>
<span class="lineno"></span><span class="op" id="2384649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2384652">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2384718">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2384774">func</span>&nbsp;<span class="ident" id="2384779">Scanln</span><span class="op" id="2384785">(</span><span class="ident" id="2384786">a</span>&nbsp;<span class="op" id="2384788">...</span><span class="keyword" id="2384791">interface</span><span class="op" id="2384800">{</span><span class="op" id="2384801">}</span><span class="op" id="2384802">)</span>&nbsp;<span class="op" id="2384804">(</span><span class="ident" id="2384805">n</span>&nbsp;<span class="builtintype" id="2384807">int</span><span class="op" id="2384810">,</span>&nbsp;<span class="ident" id="2384812">err</span>&nbsp;<span class="builtintype" id="2384816">error</span><span class="op" id="2384821">)</span>&nbsp;<span class="op" id="2384823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2384826">return</span>&nbsp;<span class="ident" id="2384833">Fscanln</span><span class="op" id="2384840">(</span><span class="ident" id="2384841">os</span><span class="op" id="2384843">.</span><span class="ident" id="2384844">Stdin</span><span class="op" id="2384849">,</span>&nbsp;<span class="ident" id="2384851">a</span><span class="op" id="2384852">...</span><span class="op" id="2384855">)</span><br>
<span class="lineno"></span><span class="op" id="2384857">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2384860">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2384925">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2384994">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2385063">func</span>&nbsp;<span class="ident" id="2385068">Scanf</span><span class="op" id="2385073">(</span><span class="ident" id="2385074">format</span>&nbsp;<span class="builtintype" id="2385081">string</span><span class="op" id="2385087">,</span>&nbsp;<span class="ident" id="2385089">a</span>&nbsp;<span class="op" id="2385091">...</span><span class="keyword" id="2385094">interface</span><span class="op" id="2385103">{</span><span class="op" id="2385104">}</span><span class="op" id="2385105">)</span>&nbsp;<span class="op" id="2385107">(</span><span class="ident" id="2385108">n</span>&nbsp;<span class="builtintype" id="2385110">int</span><span class="op" id="2385113">,</span>&nbsp;<span class="ident" id="2385115">err</span>&nbsp;<span class="builtintype" id="2385119">error</span><span class="op" id="2385124">)</span>&nbsp;<span class="op" id="2385126">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385129">return</span>&nbsp;<span class="ident" id="2385136">Fscanf</span><span class="op" id="2385142">(</span><span class="ident" id="2385143">os</span><span class="op" id="2385145">.</span><span class="ident" id="2385146">Stdin</span><span class="op" id="2385151">,</span>&nbsp;<span class="ident" id="2385153">format</span><span class="op" id="2385159">,</span>&nbsp;<span class="ident" id="2385161">a</span><span class="op" id="2385162">...</span><span class="op" id="2385165">)</span><br>
<span class="lineno"></span><span class="op" id="2385167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2385170">type</span>&nbsp;<span class="ident" id="2385175">stringReader</span>&nbsp;<span class="builtintype" id="2385188">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2385196">func</span>&nbsp;<span class="op" id="2385201">(</span><span class="ident" id="2385202">r</span>&nbsp;<span class="op" id="2385204">*</span><span class="ident" id="2385205">stringReader</span><span class="op" id="2385217">)</span>&nbsp;<span class="ident" id="2385219">Read</span><span class="op" id="2385223">(</span><span class="ident" id="2385224">b</span>&nbsp;<span class="op" id="2385226">[</span><span class="op" id="2385227">]</span><span class="builtintype" id="2385228">byte</span><span class="op" id="2385232">)</span>&nbsp;<span class="op" id="2385234">(</span><span class="ident" id="2385235">n</span>&nbsp;<span class="builtintype" id="2385237">int</span><span class="op" id="2385240">,</span>&nbsp;<span class="ident" id="2385242">err</span>&nbsp;<span class="builtintype" id="2385246">error</span><span class="op" id="2385251">)</span>&nbsp;<span class="op" id="2385253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385256">n</span>&nbsp;<span class="op" id="2385258">=</span>&nbsp;<span class="builtinfunc" id="2385260">copy</span><span class="op" id="2385264">(</span><span class="ident" id="2385265">b</span><span class="op" id="2385266">,</span>&nbsp;<span class="op" id="2385268">*</span><span class="ident" id="2385269">r</span><span class="op" id="2385270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385273">*</span><span class="ident" id="2385274">r</span>&nbsp;<span class="op" id="2385276">=</span>&nbsp;<span class="op" id="2385278">(</span><span class="op" id="2385279">*</span><span class="ident" id="2385280">r</span><span class="op" id="2385281">)</span><span class="op" id="2385282">[</span><span class="ident" id="2385283">n</span><span class="op" id="2385284">:</span><span class="op" id="2385285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385288">if</span>&nbsp;<span class="ident" id="2385291">n</span>&nbsp;<span class="op" id="2385293">==</span>&nbsp;<span class="num" id="2385296">0</span>&nbsp;<span class="op" id="2385298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385302">err</span>&nbsp;<span class="op" id="2385306">=</span>&nbsp;<span class="ident" id="2385308">io</span><span class="op" id="2385310">.</span><span class="ident" id="2385311">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385319">return</span><br>
<span class="lineno"></span><span class="op" id="2385326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385329">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2385400">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2385467">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2385537">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2385591">func</span>&nbsp;<span class="ident" id="2385596">Sscan</span><span class="op" id="2385601">(</span><span class="ident" id="2385602">str</span>&nbsp;<span class="builtintype" id="2385606">string</span><span class="op" id="2385612">,</span>&nbsp;<span class="ident" id="2385614">a</span>&nbsp;<span class="op" id="2385616">...</span><span class="keyword" id="2385619">interface</span><span class="op" id="2385628">{</span><span class="op" id="2385629">}</span><span class="op" id="2385630">)</span>&nbsp;<span class="op" id="2385632">(</span><span class="ident" id="2385633">n</span>&nbsp;<span class="builtintype" id="2385635">int</span><span class="op" id="2385638">,</span>&nbsp;<span class="ident" id="2385640">err</span>&nbsp;<span class="builtintype" id="2385644">error</span><span class="op" id="2385649">)</span>&nbsp;<span class="op" id="2385651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385654">return</span>&nbsp;<span class="ident" id="2385661">Fscan</span><span class="op" id="2385666">(</span><span class="op" id="2385667">(</span><span class="op" id="2385668">*</span><span class="ident" id="2385669">stringReader</span><span class="op" id="2385681">)</span><span class="op" id="2385682">(</span><span class="op" id="2385683">&amp;</span><span class="ident" id="2385684">str</span><span class="op" id="2385687">)</span><span class="op" id="2385688">,</span>&nbsp;<span class="ident" id="2385690">a</span><span class="op" id="2385691">...</span><span class="op" id="2385694">)</span><br>
<span class="lineno">105</span><span class="op" id="2385696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385699">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2385767">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2385823">func</span>&nbsp;<span class="ident" id="2385828">Sscanln</span><span class="op" id="2385835">(</span><span class="ident" id="2385836">str</span>&nbsp;<span class="builtintype" id="2385840">string</span><span class="op" id="2385846">,</span>&nbsp;<span class="ident" id="2385848">a</span>&nbsp;<span class="op" id="2385850">...</span><span class="keyword" id="2385853">interface</span><span class="op" id="2385862">{</span><span class="op" id="2385863">}</span><span class="op" id="2385864">)</span>&nbsp;<span class="op" id="2385866">(</span><span class="ident" id="2385867">n</span>&nbsp;<span class="builtintype" id="2385869">int</span><span class="op" id="2385872">,</span>&nbsp;<span class="ident" id="2385874">err</span>&nbsp;<span class="builtintype" id="2385878">error</span><span class="op" id="2385883">)</span>&nbsp;<span class="op" id="2385885">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385888">return</span>&nbsp;<span class="ident" id="2385895">Fscanln</span><span class="op" id="2385902">(</span><span class="op" id="2385903">(</span><span class="op" id="2385904">*</span><span class="ident" id="2385905">stringReader</span><span class="op" id="2385917">)</span><span class="op" id="2385918">(</span><span class="op" id="2385919">&amp;</span><span class="ident" id="2385920">str</span><span class="op" id="2385923">)</span><span class="op" id="2385924">,</span>&nbsp;<span class="ident" id="2385926">a</span><span class="op" id="2385927">...</span><span class="op" id="2385930">)</span><br>
<span class="lineno"></span><span class="op" id="2385932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385935">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2386007">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2386076">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2386128">func</span>&nbsp;<span class="ident" id="2386133">Sscanf</span><span class="op" id="2386139">(</span><span class="ident" id="2386140">str</span>&nbsp;<span class="builtintype" id="2386144">string</span><span class="op" id="2386150">,</span>&nbsp;<span class="ident" id="2386152">format</span>&nbsp;<span class="builtintype" id="2386159">string</span><span class="op" id="2386165">,</span>&nbsp;<span class="ident" id="2386167">a</span>&nbsp;<span class="op" id="2386169">...</span><span class="keyword" id="2386172">interface</span><span class="op" id="2386181">{</span><span class="op" id="2386182">}</span><span class="op" id="2386183">)</span>&nbsp;<span class="op" id="2386185">(</span><span class="ident" id="2386186">n</span>&nbsp;<span class="builtintype" id="2386188">int</span><span class="op" id="2386191">,</span>&nbsp;<span class="ident" id="2386193">err</span>&nbsp;<span class="builtintype" id="2386197">error</span><span class="op" id="2386202">)</span>&nbsp;<span class="op" id="2386204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386207">return</span>&nbsp;<span class="ident" id="2386214">Fscanf</span><span class="op" id="2386220">(</span><span class="op" id="2386221">(</span><span class="op" id="2386222">*</span><span class="ident" id="2386223">stringReader</span><span class="op" id="2386235">)</span><span class="op" id="2386236">(</span><span class="op" id="2386237">&amp;</span><span class="ident" id="2386238">str</span><span class="op" id="2386241">)</span><span class="op" id="2386242">,</span>&nbsp;<span class="ident" id="2386244">format</span><span class="op" id="2386250">,</span>&nbsp;<span class="ident" id="2386252">a</span><span class="op" id="2386253">...</span><span class="op" id="2386256">)</span><br>
<span class="lineno"></span><span class="op" id="2386258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2386261">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2386329">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2386396">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2386466">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2386520">func</span>&nbsp;<span class="ident" id="2386525">Fscan</span><span class="op" id="2386530">(</span><span class="ident" id="2386531">r</span>&nbsp;<span class="ident" id="2386533">io</span><span class="op" id="2386535">.</span><span class="ident" id="2386536">Reader</span><span class="op" id="2386542">,</span>&nbsp;<span class="ident" id="2386544">a</span>&nbsp;<span class="op" id="2386546">...</span><span class="keyword" id="2386549">interface</span><span class="op" id="2386558">{</span><span class="op" id="2386559">}</span><span class="op" id="2386560">)</span>&nbsp;<span class="op" id="2386562">(</span><span class="ident" id="2386563">n</span>&nbsp;<span class="builtintype" id="2386565">int</span><span class="op" id="2386568">,</span>&nbsp;<span class="ident" id="2386570">err</span>&nbsp;<span class="builtintype" id="2386574">error</span><span class="op" id="2386579">)</span>&nbsp;<span class="op" id="2386581">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386584">s</span><span class="op" id="2386585">,</span>&nbsp;<span class="ident" id="2386587">old</span>&nbsp;<span class="op" id="2386591">:=</span>&nbsp;<span class="ident" id="2386594">newScanState</span><span class="op" id="2386606">(</span><span class="ident" id="2386607">r</span><span class="op" id="2386608">,</span>&nbsp;<span class="builtintype" id="2386610">true</span><span class="op" id="2386614">,</span>&nbsp;<span class="builtintype" id="2386616">false</span><span class="op" id="2386621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386624">n</span><span class="op" id="2386625">,</span>&nbsp;<span class="ident" id="2386627">err</span>&nbsp;<span class="op" id="2386631">=</span>&nbsp;<span class="ident" id="2386633">s</span><span class="op" id="2386634">.</span><span class="ident" id="2386635">doScan</span><span class="op" id="2386641">(</span><span class="ident" id="2386642">a</span><span class="op" id="2386643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386646">s</span><span class="op" id="2386647">.</span><span class="ident" id="2386648">free</span><span class="op" id="2386652">(</span><span class="ident" id="2386653">old</span><span class="op" id="2386656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386659">return</span><br>
<span class="lineno"></span><span class="op" id="2386666">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2386669">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2386737">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2386793">func</span>&nbsp;<span class="ident" id="2386798">Fscanln</span><span class="op" id="2386805">(</span><span class="ident" id="2386806">r</span>&nbsp;<span class="ident" id="2386808">io</span><span class="op" id="2386810">.</span><span class="ident" id="2386811">Reader</span><span class="op" id="2386817">,</span>&nbsp;<span class="ident" id="2386819">a</span>&nbsp;<span class="op" id="2386821">...</span><span class="keyword" id="2386824">interface</span><span class="op" id="2386833">{</span><span class="op" id="2386834">}</span><span class="op" id="2386835">)</span>&nbsp;<span class="op" id="2386837">(</span><span class="ident" id="2386838">n</span>&nbsp;<span class="builtintype" id="2386840">int</span><span class="op" id="2386843">,</span>&nbsp;<span class="ident" id="2386845">err</span>&nbsp;<span class="builtintype" id="2386849">error</span><span class="op" id="2386854">)</span>&nbsp;<span class="op" id="2386856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386859">s</span><span class="op" id="2386860">,</span>&nbsp;<span class="ident" id="2386862">old</span>&nbsp;<span class="op" id="2386866">:=</span>&nbsp;<span class="ident" id="2386869">newScanState</span><span class="op" id="2386881">(</span><span class="ident" id="2386882">r</span><span class="op" id="2386883">,</span>&nbsp;<span class="builtintype" id="2386885">false</span><span class="op" id="2386890">,</span>&nbsp;<span class="builtintype" id="2386892">true</span><span class="op" id="2386896">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386899">n</span><span class="op" id="2386900">,</span>&nbsp;<span class="ident" id="2386902">err</span>&nbsp;<span class="op" id="2386906">=</span>&nbsp;<span class="ident" id="2386908">s</span><span class="op" id="2386909">.</span><span class="ident" id="2386910">doScan</span><span class="op" id="2386916">(</span><span class="ident" id="2386917">a</span><span class="op" id="2386918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386921">s</span><span class="op" id="2386922">.</span><span class="ident" id="2386923">free</span><span class="op" id="2386927">(</span><span class="ident" id="2386928">old</span><span class="op" id="2386931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386934">return</span><br>
<span class="lineno"></span><span class="op" id="2386941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2386944">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2387013">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2387082">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2387134">func</span>&nbsp;<span class="ident" id="2387139">Fscanf</span><span class="op" id="2387145">(</span><span class="ident" id="2387146">r</span>&nbsp;<span class="ident" id="2387148">io</span><span class="op" id="2387150">.</span><span class="ident" id="2387151">Reader</span><span class="op" id="2387157">,</span>&nbsp;<span class="ident" id="2387159">format</span>&nbsp;<span class="builtintype" id="2387166">string</span><span class="op" id="2387172">,</span>&nbsp;<span class="ident" id="2387174">a</span>&nbsp;<span class="op" id="2387176">...</span><span class="keyword" id="2387179">interface</span><span class="op" id="2387188">{</span><span class="op" id="2387189">}</span><span class="op" id="2387190">)</span>&nbsp;<span class="op" id="2387192">(</span><span class="ident" id="2387193">n</span>&nbsp;<span class="builtintype" id="2387195">int</span><span class="op" id="2387198">,</span>&nbsp;<span class="ident" id="2387200">err</span>&nbsp;<span class="builtintype" id="2387204">error</span><span class="op" id="2387209">)</span>&nbsp;<span class="op" id="2387211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387214">s</span><span class="op" id="2387215">,</span>&nbsp;<span class="ident" id="2387217">old</span>&nbsp;<span class="op" id="2387221">:=</span>&nbsp;<span class="ident" id="2387224">newScanState</span><span class="op" id="2387236">(</span><span class="ident" id="2387237">r</span><span class="op" id="2387238">,</span>&nbsp;<span class="builtintype" id="2387240">false</span><span class="op" id="2387245">,</span>&nbsp;<span class="builtintype" id="2387247">false</span><span class="op" id="2387252">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387255">n</span><span class="op" id="2387256">,</span>&nbsp;<span class="ident" id="2387258">err</span>&nbsp;<span class="op" id="2387262">=</span>&nbsp;<span class="ident" id="2387264">s</span><span class="op" id="2387265">.</span><span class="ident" id="2387266">doScanf</span><span class="op" id="2387273">(</span><span class="ident" id="2387274">format</span><span class="op" id="2387280">,</span>&nbsp;<span class="ident" id="2387282">a</span><span class="op" id="2387283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387286">s</span><span class="op" id="2387287">.</span><span class="ident" id="2387288">free</span><span class="op" id="2387292">(</span><span class="ident" id="2387293">old</span><span class="op" id="2387296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387299">return</span><br>
<span class="lineno"></span><span class="op" id="2387306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2387309">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2387378">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2387454">type</span>&nbsp;<span class="ident" id="2387459">scanError</span>&nbsp;<span class="keyword" id="2387469">struct</span>&nbsp;<span class="op" id="2387476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387479">err</span>&nbsp;<span class="builtintype" id="2387483">error</span><br>
<span class="lineno"></span><span class="op" id="2387489">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2387492">const</span>&nbsp;<span class="ident" id="2387498">eof</span>&nbsp;<span class="op" id="2387502">=</span>&nbsp;<span class="op" id="2387504">-</span><span class="num" id="2387505">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2387508">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2387559">type</span>&nbsp;<span class="ident" id="2387564">ss</span>&nbsp;<span class="keyword" id="2387567">struct</span>&nbsp;<span class="op" id="2387574">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387577">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387586">io</span><span class="op" id="2387588">.</span><span class="ident" id="2387589">RuneReader</span>&nbsp;<span class="comment" id="2387600">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387624">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387633">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387647">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387669">peekRune</span>&nbsp;<span class="builtintype" id="2387678">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387692">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387715">prevRune</span>&nbsp;<span class="builtintype" id="2387724">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387738">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387773">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2387782">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387796">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387823">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2387832">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387846">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387867">ssave</span><br>
<span class="lineno"></span><span class="op" id="2387873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2387876">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2387923">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2387965">type</span>&nbsp;<span class="ident" id="2387970">ssave</span>&nbsp;<span class="keyword" id="2387976">struct</span>&nbsp;<span class="op" id="2387983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387986">validSave</span>&nbsp;<span class="builtintype" id="2387996">bool</span>&nbsp;<span class="comment" id="2388001">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388039">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2388049">bool</span>&nbsp;<span class="comment" id="2388054">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388090">nlIsSpace</span>&nbsp;<span class="builtintype" id="2388100">bool</span>&nbsp;<span class="comment" id="2388105">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388147">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2388157">int</span>&nbsp;&nbsp;<span class="comment" id="2388162">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388220">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2388230">int</span>&nbsp;&nbsp;<span class="comment" id="2388235">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388262">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2388272">int</span>&nbsp;&nbsp;<span class="comment" id="2388277">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2388299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2388302">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2388360">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2388421">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2388480">func</span>&nbsp;<span class="op" id="2388485">(</span><span class="ident" id="2388486">s</span>&nbsp;<span class="op" id="2388488">*</span><span class="ident" id="2388489">ss</span><span class="op" id="2388491">)</span>&nbsp;<span class="ident" id="2388493">Read</span><span class="op" id="2388497">(</span><span class="ident" id="2388498">buf</span>&nbsp;<span class="op" id="2388502">[</span><span class="op" id="2388503">]</span><span class="builtintype" id="2388504">byte</span><span class="op" id="2388508">)</span>&nbsp;<span class="op" id="2388510">(</span><span class="ident" id="2388511">n</span>&nbsp;<span class="builtintype" id="2388513">int</span><span class="op" id="2388516">,</span>&nbsp;<span class="ident" id="2388518">err</span>&nbsp;<span class="builtintype" id="2388522">error</span><span class="op" id="2388527">)</span>&nbsp;<span class="op" id="2388529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388532">return</span>&nbsp;<span class="num" id="2388539">0</span><span class="op" id="2388540">,</span>&nbsp;<span class="ident" id="2388542">errors</span><span class="op" id="2388548">.</span><span class="ident" id="2388549">New</span><span class="op" id="2388552">(</span><span class="string" id="2388553">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2388606">)</span><br>
<span class="lineno">185</span><span class="op" id="2388608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2388611">func</span>&nbsp;<span class="op" id="2388616">(</span><span class="ident" id="2388617">s</span>&nbsp;<span class="op" id="2388619">*</span><span class="ident" id="2388620">ss</span><span class="op" id="2388622">)</span>&nbsp;<span class="ident" id="2388624">ReadRune</span><span class="op" id="2388632">(</span><span class="op" id="2388633">)</span>&nbsp;<span class="op" id="2388635">(</span><span class="ident" id="2388636">r</span>&nbsp;<span class="builtintype" id="2388638">rune</span><span class="op" id="2388642">,</span>&nbsp;<span class="ident" id="2388644">size</span>&nbsp;<span class="builtintype" id="2388649">int</span><span class="op" id="2388652">,</span>&nbsp;<span class="ident" id="2388654">err</span>&nbsp;<span class="builtintype" id="2388658">error</span><span class="op" id="2388663">)</span>&nbsp;<span class="op" id="2388665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388668">if</span>&nbsp;<span class="ident" id="2388671">s</span><span class="op" id="2388672">.</span><span class="ident" id="2388673">peekRune</span>&nbsp;<span class="op" id="2388682">&gt;=</span>&nbsp;<span class="num" id="2388685">0</span>&nbsp;<span class="op" id="2388687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388691">s</span><span class="op" id="2388692">.</span><span class="ident" id="2388693">count</span><span class="op" id="2388698">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388703">r</span>&nbsp;<span class="op" id="2388705">=</span>&nbsp;<span class="ident" id="2388707">s</span><span class="op" id="2388708">.</span><span class="ident" id="2388709">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388720">size</span>&nbsp;<span class="op" id="2388725">=</span>&nbsp;<span class="ident" id="2388727">utf8</span><span class="op" id="2388731">.</span><span class="ident" id="2388732">RuneLen</span><span class="op" id="2388739">(</span><span class="ident" id="2388740">r</span><span class="op" id="2388741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388745">s</span><span class="op" id="2388746">.</span><span class="ident" id="2388747">prevRune</span>&nbsp;<span class="op" id="2388756">=</span>&nbsp;<span class="ident" id="2388758">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388762">s</span><span class="op" id="2388763">.</span><span class="ident" id="2388764">peekRune</span>&nbsp;<span class="op" id="2388773">=</span>&nbsp;<span class="op" id="2388775">-</span><span class="num" id="2388776">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388780">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388791">if</span>&nbsp;<span class="ident" id="2388794">s</span><span class="op" id="2388795">.</span><span class="ident" id="2388796">atEOF</span>&nbsp;<span class="op" id="2388802">||</span>&nbsp;<span class="ident" id="2388805">s</span><span class="op" id="2388806">.</span><span class="ident" id="2388807">nlIsEnd</span>&nbsp;<span class="op" id="2388815">&amp;&amp;</span>&nbsp;<span class="ident" id="2388818">s</span><span class="op" id="2388819">.</span><span class="ident" id="2388820">prevRune</span>&nbsp;<span class="op" id="2388829">==</span>&nbsp;<span class="string" id="2388832">&#39;\n&#39;</span>&nbsp;<span class="op" id="2388837">||</span>&nbsp;<span class="ident" id="2388840">s</span><span class="op" id="2388841">.</span><span class="ident" id="2388842">count</span>&nbsp;<span class="op" id="2388848">&gt;=</span>&nbsp;<span class="ident" id="2388851">s</span><span class="op" id="2388852">.</span><span class="ident" id="2388853">argLimit</span>&nbsp;<span class="op" id="2388862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388866">err</span>&nbsp;<span class="op" id="2388870">=</span>&nbsp;<span class="ident" id="2388872">io</span><span class="op" id="2388874">.</span><span class="ident" id="2388875">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388881">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388889">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388893">r</span><span class="op" id="2388894">,</span>&nbsp;<span class="ident" id="2388896">size</span><span class="op" id="2388900">,</span>&nbsp;<span class="ident" id="2388902">err</span>&nbsp;<span class="op" id="2388906">=</span>&nbsp;<span class="ident" id="2388908">s</span><span class="op" id="2388909">.</span><span class="ident" id="2388910">rr</span><span class="op" id="2388912">.</span><span class="ident" id="2388913">ReadRune</span><span class="op" id="2388921">(</span><span class="op" id="2388922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388925">if</span>&nbsp;<span class="ident" id="2388928">err</span>&nbsp;<span class="op" id="2388932">==</span>&nbsp;<span class="builtintype" id="2388935">nil</span>&nbsp;<span class="op" id="2388939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388943">s</span><span class="op" id="2388944">.</span><span class="ident" id="2388945">count</span><span class="op" id="2388950">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388955">s</span><span class="op" id="2388956">.</span><span class="ident" id="2388957">prevRune</span>&nbsp;<span class="op" id="2388966">=</span>&nbsp;<span class="ident" id="2388968">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388971">}</span>&nbsp;<span class="keyword" id="2388973">else</span>&nbsp;<span class="keyword" id="2388978">if</span>&nbsp;<span class="ident" id="2388981">err</span>&nbsp;<span class="op" id="2388985">==</span>&nbsp;<span class="ident" id="2388988">io</span><span class="op" id="2388990">.</span><span class="ident" id="2388991">EOF</span>&nbsp;<span class="op" id="2388995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388999">s</span><span class="op" id="2389000">.</span><span class="ident" id="2389001">atEOF</span>&nbsp;<span class="op" id="2389007">=</span>&nbsp;<span class="builtintype" id="2389009">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389018">return</span><br>
<span class="lineno"></span><span class="op" id="2389025">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2389028">func</span>&nbsp;<span class="op" id="2389033">(</span><span class="ident" id="2389034">s</span>&nbsp;<span class="op" id="2389036">*</span><span class="ident" id="2389037">ss</span><span class="op" id="2389039">)</span>&nbsp;<span class="ident" id="2389041">Width</span><span class="op" id="2389046">(</span><span class="op" id="2389047">)</span>&nbsp;<span class="op" id="2389049">(</span><span class="ident" id="2389050">wid</span>&nbsp;<span class="builtintype" id="2389054">int</span><span class="op" id="2389057">,</span>&nbsp;<span class="ident" id="2389059">ok</span>&nbsp;<span class="builtintype" id="2389062">bool</span><span class="op" id="2389066">)</span>&nbsp;<span class="op" id="2389068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389071">if</span>&nbsp;<span class="ident" id="2389074">s</span><span class="op" id="2389075">.</span><span class="ident" id="2389076">maxWid</span>&nbsp;<span class="op" id="2389083">==</span>&nbsp;<span class="ident" id="2389086">hugeWid</span>&nbsp;<span class="op" id="2389094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389098">return</span>&nbsp;<span class="num" id="2389105">0</span><span class="op" id="2389106">,</span>&nbsp;<span class="builtintype" id="2389108">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389115">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389118">return</span>&nbsp;<span class="ident" id="2389125">s</span><span class="op" id="2389126">.</span><span class="ident" id="2389127">maxWid</span><span class="op" id="2389133">,</span>&nbsp;<span class="builtintype" id="2389135">true</span><br>
<span class="lineno"></span><span class="op" id="2389140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389143">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2389207">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2389264">func</span>&nbsp;<span class="op" id="2389269">(</span><span class="ident" id="2389270">s</span>&nbsp;<span class="op" id="2389272">*</span><span class="ident" id="2389273">ss</span><span class="op" id="2389275">)</span>&nbsp;<span class="ident" id="2389277">getRune</span><span class="op" id="2389284">(</span><span class="op" id="2389285">)</span>&nbsp;<span class="op" id="2389287">(</span><span class="ident" id="2389288">r</span>&nbsp;<span class="builtintype" id="2389290">rune</span><span class="op" id="2389294">)</span>&nbsp;<span class="op" id="2389296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389299">r</span><span class="op" id="2389300">,</span>&nbsp;<span class="ident" id="2389302">_</span><span class="op" id="2389303">,</span>&nbsp;<span class="ident" id="2389305">err</span>&nbsp;<span class="op" id="2389309">:=</span>&nbsp;<span class="ident" id="2389312">s</span><span class="op" id="2389313">.</span><span class="ident" id="2389314">ReadRune</span><span class="op" id="2389322">(</span><span class="op" id="2389323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389326">if</span>&nbsp;<span class="ident" id="2389329">err</span>&nbsp;<span class="op" id="2389333">!=</span>&nbsp;<span class="builtintype" id="2389336">nil</span>&nbsp;<span class="op" id="2389340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389344">if</span>&nbsp;<span class="ident" id="2389347">err</span>&nbsp;<span class="op" id="2389351">==</span>&nbsp;<span class="ident" id="2389354">io</span><span class="op" id="2389356">.</span><span class="ident" id="2389357">EOF</span>&nbsp;<span class="op" id="2389361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389366">return</span>&nbsp;<span class="ident" id="2389373">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389383">s</span><span class="op" id="2389384">.</span><span class="builtintype" id="2389385">error</span><span class="op" id="2389390">(</span><span class="ident" id="2389391">err</span><span class="op" id="2389394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389400">return</span><br>
<span class="lineno"></span><span class="op" id="2389407">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2389410">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2389474">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2389541">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2389558">func</span>&nbsp;<span class="op" id="2389563">(</span><span class="ident" id="2389564">s</span>&nbsp;<span class="op" id="2389566">*</span><span class="ident" id="2389567">ss</span><span class="op" id="2389569">)</span>&nbsp;<span class="ident" id="2389571">mustReadRune</span><span class="op" id="2389583">(</span><span class="op" id="2389584">)</span>&nbsp;<span class="op" id="2389586">(</span><span class="ident" id="2389587">r</span>&nbsp;<span class="builtintype" id="2389589">rune</span><span class="op" id="2389593">)</span>&nbsp;<span class="op" id="2389595">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389598">r</span>&nbsp;<span class="op" id="2389600">=</span>&nbsp;<span class="ident" id="2389602">s</span><span class="op" id="2389603">.</span><span class="ident" id="2389604">getRune</span><span class="op" id="2389611">(</span><span class="op" id="2389612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389615">if</span>&nbsp;<span class="ident" id="2389618">r</span>&nbsp;<span class="op" id="2389620">==</span>&nbsp;<span class="ident" id="2389623">eof</span>&nbsp;<span class="op" id="2389627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389631">s</span><span class="op" id="2389632">.</span><span class="builtintype" id="2389633">error</span><span class="op" id="2389638">(</span><span class="ident" id="2389639">io</span><span class="op" id="2389641">.</span><span class="ident" id="2389642">ErrUnexpectedEOF</span><span class="op" id="2389658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389664">return</span><br>
<span class="lineno">240</span><span class="op" id="2389671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2389674">func</span>&nbsp;<span class="op" id="2389679">(</span><span class="ident" id="2389680">s</span>&nbsp;<span class="op" id="2389682">*</span><span class="ident" id="2389683">ss</span><span class="op" id="2389685">)</span>&nbsp;<span class="ident" id="2389687">UnreadRune</span><span class="op" id="2389697">(</span><span class="op" id="2389698">)</span>&nbsp;<span class="builtintype" id="2389700">error</span>&nbsp;<span class="op" id="2389706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389709">if</span>&nbsp;<span class="ident" id="2389712">u</span><span class="op" id="2389713">,</span>&nbsp;<span class="ident" id="2389715">ok</span>&nbsp;<span class="op" id="2389718">:=</span>&nbsp;<span class="ident" id="2389721">s</span><span class="op" id="2389722">.</span><span class="ident" id="2389723">rr</span><span class="op" id="2389725">.</span><span class="op" id="2389726">(</span><span class="ident" id="2389727">runeUnreader</span><span class="op" id="2389739">)</span><span class="op" id="2389740">;</span>&nbsp;<span class="ident" id="2389742">ok</span>&nbsp;<span class="op" id="2389745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389749">u</span><span class="op" id="2389750">.</span><span class="ident" id="2389751">UnreadRune</span><span class="op" id="2389761">(</span><span class="op" id="2389762">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389765">}</span>&nbsp;<span class="keyword" id="2389767">else</span>&nbsp;<span class="op" id="2389772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389776">s</span><span class="op" id="2389777">.</span><span class="ident" id="2389778">peekRune</span>&nbsp;<span class="op" id="2389787">=</span>&nbsp;<span class="ident" id="2389789">s</span><span class="op" id="2389790">.</span><span class="ident" id="2389791">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389804">s</span><span class="op" id="2389805">.</span><span class="ident" id="2389806">prevRune</span>&nbsp;<span class="op" id="2389815">=</span>&nbsp;<span class="op" id="2389817">-</span><span class="num" id="2389818">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389821">s</span><span class="op" id="2389822">.</span><span class="ident" id="2389823">count</span><span class="op" id="2389828">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389832">return</span>&nbsp;<span class="builtintype" id="2389839">nil</span><br>
<span class="lineno"></span><span class="op" id="2389843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2389846">func</span>&nbsp;<span class="op" id="2389851">(</span><span class="ident" id="2389852">s</span>&nbsp;<span class="op" id="2389854">*</span><span class="ident" id="2389855">ss</span><span class="op" id="2389857">)</span>&nbsp;<span class="builtintype" id="2389859">error</span><span class="op" id="2389864">(</span><span class="ident" id="2389865">err</span>&nbsp;<span class="builtintype" id="2389869">error</span><span class="op" id="2389874">)</span>&nbsp;<span class="op" id="2389876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2389879">panic</span><span class="op" id="2389884">(</span><span class="ident" id="2389885">scanError</span><span class="op" id="2389894">{</span><span class="ident" id="2389895">err</span><span class="op" id="2389898">}</span><span class="op" id="2389899">)</span><br>
<span class="lineno">255</span><span class="op" id="2389901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2389904">func</span>&nbsp;<span class="op" id="2389909">(</span><span class="ident" id="2389910">s</span>&nbsp;<span class="op" id="2389912">*</span><span class="ident" id="2389913">ss</span><span class="op" id="2389915">)</span>&nbsp;<span class="ident" id="2389917">errorString</span><span class="op" id="2389928">(</span><span class="ident" id="2389929">err</span>&nbsp;<span class="builtintype" id="2389933">string</span><span class="op" id="2389939">)</span>&nbsp;<span class="op" id="2389941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2389944">panic</span><span class="op" id="2389949">(</span><span class="ident" id="2389950">scanError</span><span class="op" id="2389959">{</span><span class="ident" id="2389960">errors</span><span class="op" id="2389966">.</span><span class="ident" id="2389967">New</span><span class="op" id="2389970">(</span><span class="ident" id="2389971">err</span><span class="op" id="2389974">)</span><span class="op" id="2389975">}</span><span class="op" id="2389976">)</span><br>
<span class="lineno"></span><span class="op" id="2389978">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2389981">func</span>&nbsp;<span class="op" id="2389986">(</span><span class="ident" id="2389987">s</span>&nbsp;<span class="op" id="2389989">*</span><span class="ident" id="2389990">ss</span><span class="op" id="2389992">)</span>&nbsp;<span class="ident" id="2389994">Token</span><span class="op" id="2389999">(</span><span class="ident" id="2390000">skipSpace</span>&nbsp;<span class="builtintype" id="2390010">bool</span><span class="op" id="2390014">,</span>&nbsp;<span class="ident" id="2390016">f</span>&nbsp;<span class="keyword" id="2390018">func</span><span class="op" id="2390022">(</span><span class="builtintype" id="2390023">rune</span><span class="op" id="2390027">)</span>&nbsp;<span class="builtintype" id="2390029">bool</span><span class="op" id="2390033">)</span>&nbsp;<span class="op" id="2390035">(</span><span class="ident" id="2390036">tok</span>&nbsp;<span class="op" id="2390040">[</span><span class="op" id="2390041">]</span><span class="builtintype" id="2390042">byte</span><span class="op" id="2390046">,</span>&nbsp;<span class="ident" id="2390048">err</span>&nbsp;<span class="builtintype" id="2390052">error</span><span class="op" id="2390057">)</span>&nbsp;<span class="op" id="2390059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390062">defer</span>&nbsp;<span class="keyword" id="2390068">func</span><span class="op" id="2390072">(</span><span class="op" id="2390073">)</span>&nbsp;<span class="op" id="2390075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390079">if</span>&nbsp;<span class="ident" id="2390082">e</span>&nbsp;<span class="op" id="2390084">:=</span>&nbsp;<span class="builtinfunc" id="2390087">recover</span><span class="op" id="2390094">(</span><span class="op" id="2390095">)</span><span class="op" id="2390096">;</span>&nbsp;<span class="ident" id="2390098">e</span>&nbsp;<span class="op" id="2390100">!=</span>&nbsp;<span class="builtintype" id="2390103">nil</span>&nbsp;<span class="op" id="2390107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390112">if</span>&nbsp;<span class="ident" id="2390115">se</span><span class="op" id="2390117">,</span>&nbsp;<span class="ident" id="2390119">ok</span>&nbsp;<span class="op" id="2390122">:=</span>&nbsp;<span class="ident" id="2390125">e</span><span class="op" id="2390126">.</span><span class="op" id="2390127">(</span><span class="ident" id="2390128">scanError</span><span class="op" id="2390137">)</span><span class="op" id="2390138">;</span>&nbsp;<span class="ident" id="2390140">ok</span>&nbsp;<span class="op" id="2390143">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390149">err</span>&nbsp;<span class="op" id="2390153">=</span>&nbsp;<span class="ident" id="2390155">se</span><span class="op" id="2390157">.</span><span class="ident" id="2390158">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390165">}</span>&nbsp;<span class="keyword" id="2390167">else</span>&nbsp;<span class="op" id="2390172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2390178">panic</span><span class="op" id="2390183">(</span><span class="ident" id="2390184">e</span><span class="op" id="2390185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390194">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390197">}</span><span class="op" id="2390198">(</span><span class="op" id="2390199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390202">if</span>&nbsp;<span class="ident" id="2390205">f</span>&nbsp;<span class="op" id="2390207">==</span>&nbsp;<span class="builtintype" id="2390210">nil</span>&nbsp;<span class="op" id="2390214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390218">f</span>&nbsp;<span class="op" id="2390220">=</span>&nbsp;<span class="ident" id="2390222">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390235">s</span><span class="op" id="2390236">.</span><span class="ident" id="2390237">buf</span>&nbsp;<span class="op" id="2390241">=</span>&nbsp;<span class="ident" id="2390243">s</span><span class="op" id="2390244">.</span><span class="ident" id="2390245">buf</span><span class="op" id="2390248">[</span><span class="op" id="2390249">:</span><span class="num" id="2390250">0</span><span class="op" id="2390251">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390254">tok</span>&nbsp;<span class="op" id="2390258">=</span>&nbsp;<span class="ident" id="2390260">s</span><span class="op" id="2390261">.</span><span class="ident" id="2390262">token</span><span class="op" id="2390267">(</span><span class="ident" id="2390268">skipSpace</span><span class="op" id="2390277">,</span>&nbsp;<span class="ident" id="2390279">f</span><span class="op" id="2390280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390283">return</span><br>
<span class="lineno"></span><span class="op" id="2390290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390293">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2390347">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2390389">var</span>&nbsp;<span class="ident" id="2390393">space</span>&nbsp;<span class="op" id="2390399">=</span>&nbsp;<span class="op" id="2390401">[</span><span class="op" id="2390402">]</span><span class="op" id="2390403">[</span><span class="num" id="2390404">2</span><span class="op" id="2390405">]</span><span class="builtintype" id="2390406">uint16</span><span class="op" id="2390412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390415">{</span><span class="num" id="2390416">0x0009</span><span class="op" id="2390422">,</span>&nbsp;<span class="num" id="2390424">0x000d</span><span class="op" id="2390430">}</span><span class="op" id="2390431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390434">{</span><span class="num" id="2390435">0x0020</span><span class="op" id="2390441">,</span>&nbsp;<span class="num" id="2390443">0x0020</span><span class="op" id="2390449">}</span><span class="op" id="2390450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390453">{</span><span class="num" id="2390454">0x0085</span><span class="op" id="2390460">,</span>&nbsp;<span class="num" id="2390462">0x0085</span><span class="op" id="2390468">}</span><span class="op" id="2390469">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390472">{</span><span class="num" id="2390473">0x00a0</span><span class="op" id="2390479">,</span>&nbsp;<span class="num" id="2390481">0x00a0</span><span class="op" id="2390487">}</span><span class="op" id="2390488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390491">{</span><span class="num" id="2390492">0x1680</span><span class="op" id="2390498">,</span>&nbsp;<span class="num" id="2390500">0x1680</span><span class="op" id="2390506">}</span><span class="op" id="2390507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390510">{</span><span class="num" id="2390511">0x2000</span><span class="op" id="2390517">,</span>&nbsp;<span class="num" id="2390519">0x200a</span><span class="op" id="2390525">}</span><span class="op" id="2390526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390529">{</span><span class="num" id="2390530">0x2028</span><span class="op" id="2390536">,</span>&nbsp;<span class="num" id="2390538">0x2029</span><span class="op" id="2390544">}</span><span class="op" id="2390545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390548">{</span><span class="num" id="2390549">0x202f</span><span class="op" id="2390555">,</span>&nbsp;<span class="num" id="2390557">0x202f</span><span class="op" id="2390563">}</span><span class="op" id="2390564">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390567">{</span><span class="num" id="2390568">0x205f</span><span class="op" id="2390574">,</span>&nbsp;<span class="num" id="2390576">0x205f</span><span class="op" id="2390582">}</span><span class="op" id="2390583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390586">{</span><span class="num" id="2390587">0x3000</span><span class="op" id="2390593">,</span>&nbsp;<span class="num" id="2390595">0x3000</span><span class="op" id="2390601">}</span><span class="op" id="2390602">,</span><br>
<span class="lineno"></span><span class="op" id="2390604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2390607">func</span>&nbsp;<span class="ident" id="2390612">isSpace</span><span class="op" id="2390619">(</span><span class="ident" id="2390620">r</span>&nbsp;<span class="builtintype" id="2390622">rune</span><span class="op" id="2390626">)</span>&nbsp;<span class="builtintype" id="2390628">bool</span>&nbsp;<span class="op" id="2390633">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390636">if</span>&nbsp;<span class="ident" id="2390639">r</span>&nbsp;<span class="op" id="2390641">&gt;=</span>&nbsp;<span class="num" id="2390644">1</span><span class="op" id="2390645">&lt;&lt;</span><span class="num" id="2390647">16</span>&nbsp;<span class="op" id="2390650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390654">return</span>&nbsp;<span class="builtintype" id="2390661">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390671">rx</span>&nbsp;<span class="op" id="2390674">:=</span>&nbsp;<span class="builtintype" id="2390677">uint16</span><span class="op" id="2390683">(</span><span class="ident" id="2390684">r</span><span class="op" id="2390685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390688">for</span>&nbsp;<span class="ident" id="2390692">_</span><span class="op" id="2390693">,</span>&nbsp;<span class="ident" id="2390695">rng</span>&nbsp;<span class="op" id="2390699">:=</span>&nbsp;<span class="keyword" id="2390702">range</span>&nbsp;<span class="ident" id="2390708">space</span>&nbsp;<span class="op" id="2390714">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390718">if</span>&nbsp;<span class="ident" id="2390721">rx</span>&nbsp;<span class="op" id="2390724">&lt;</span>&nbsp;<span class="ident" id="2390726">rng</span><span class="op" id="2390729">[</span><span class="num" id="2390730">0</span><span class="op" id="2390731">]</span>&nbsp;<span class="op" id="2390733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390738">return</span>&nbsp;<span class="builtintype" id="2390745">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390757">if</span>&nbsp;<span class="ident" id="2390760">rx</span>&nbsp;<span class="op" id="2390763">&lt;=</span>&nbsp;<span class="ident" id="2390766">rng</span><span class="op" id="2390769">[</span><span class="num" id="2390770">1</span><span class="op" id="2390771">]</span>&nbsp;<span class="op" id="2390773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390778">return</span>&nbsp;<span class="builtintype" id="2390785">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390798">return</span>&nbsp;<span class="builtintype" id="2390805">false</span><br>
<span class="lineno"></span><span class="op" id="2390811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2390814">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2390874">func</span>&nbsp;<span class="ident" id="2390879">notSpace</span><span class="op" id="2390887">(</span><span class="ident" id="2390888">r</span>&nbsp;<span class="builtintype" id="2390890">rune</span><span class="op" id="2390894">)</span>&nbsp;<span class="builtintype" id="2390896">bool</span>&nbsp;<span class="op" id="2390901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390904">return</span>&nbsp;<span class="op" id="2390911">!</span><span class="ident" id="2390912">isSpace</span><span class="op" id="2390919">(</span><span class="ident" id="2390920">r</span><span class="op" id="2390921">)</span><br>
<span class="lineno"></span><span class="op" id="2390923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2390926">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2390999">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2391077">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2391097">func</span>&nbsp;<span class="op" id="2391102">(</span><span class="ident" id="2391103">s</span>&nbsp;<span class="op" id="2391105">*</span><span class="ident" id="2391106">ss</span><span class="op" id="2391108">)</span>&nbsp;<span class="ident" id="2391110">SkipSpace</span><span class="op" id="2391119">(</span><span class="op" id="2391120">)</span>&nbsp;<span class="op" id="2391122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391125">s</span><span class="op" id="2391126">.</span><span class="ident" id="2391127">skipSpace</span><span class="op" id="2391136">(</span><span class="builtintype" id="2391137">false</span><span class="op" id="2391142">)</span><br>
<span class="lineno">320</span><span class="op" id="2391144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2391147">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2391218">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2391292">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2391332">type</span>&nbsp;<span class="ident" id="2391337">readRune</span>&nbsp;<span class="keyword" id="2391346">struct</span>&nbsp;<span class="op" id="2391353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391356">reader</span>&nbsp;&nbsp;<span class="ident" id="2391364">io</span><span class="op" id="2391366">.</span><span class="ident" id="2391367">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391375">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391383">[</span><span class="ident" id="2391384">utf8</span><span class="op" id="2391388">.</span><span class="ident" id="2391389">UTFMax</span><span class="op" id="2391395">]</span><span class="builtintype" id="2391396">byte</span>&nbsp;<span class="comment" id="2391401">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391431">pending</span>&nbsp;<span class="builtintype" id="2391439">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2391457">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391511">pendBuf</span>&nbsp;<span class="op" id="2391519">[</span><span class="ident" id="2391520">utf8</span><span class="op" id="2391524">.</span><span class="ident" id="2391525">UTFMax</span><span class="op" id="2391531">]</span><span class="builtintype" id="2391532">byte</span>&nbsp;<span class="comment" id="2391537">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2391556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2391559">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2391622">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2391685">func</span>&nbsp;<span class="op" id="2391690">(</span><span class="ident" id="2391691">r</span>&nbsp;<span class="op" id="2391693">*</span><span class="ident" id="2391694">readRune</span><span class="op" id="2391702">)</span>&nbsp;<span class="ident" id="2391704">readByte</span><span class="op" id="2391712">(</span><span class="op" id="2391713">)</span>&nbsp;<span class="op" id="2391715">(</span><span class="ident" id="2391716">b</span>&nbsp;<span class="builtintype" id="2391718">byte</span><span class="op" id="2391722">,</span>&nbsp;<span class="ident" id="2391724">err</span>&nbsp;<span class="builtintype" id="2391728">error</span><span class="op" id="2391733">)</span>&nbsp;<span class="op" id="2391735">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391738">if</span>&nbsp;<span class="ident" id="2391741">r</span><span class="op" id="2391742">.</span><span class="ident" id="2391743">pending</span>&nbsp;<span class="op" id="2391751">&gt;</span>&nbsp;<span class="num" id="2391753">0</span>&nbsp;<span class="op" id="2391755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391759">b</span>&nbsp;<span class="op" id="2391761">=</span>&nbsp;<span class="ident" id="2391763">r</span><span class="op" id="2391764">.</span><span class="ident" id="2391765">pendBuf</span><span class="op" id="2391772">[</span><span class="num" id="2391773">0</span><span class="op" id="2391774">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2391778">copy</span><span class="op" id="2391782">(</span><span class="ident" id="2391783">r</span><span class="op" id="2391784">.</span><span class="ident" id="2391785">pendBuf</span><span class="op" id="2391792">[</span><span class="num" id="2391793">0</span><span class="op" id="2391794">:</span><span class="op" id="2391795">]</span><span class="op" id="2391796">,</span>&nbsp;<span class="ident" id="2391798">r</span><span class="op" id="2391799">.</span><span class="ident" id="2391800">pendBuf</span><span class="op" id="2391807">[</span><span class="num" id="2391808">1</span><span class="op" id="2391809">:</span><span class="op" id="2391810">]</span><span class="op" id="2391811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391815">r</span><span class="op" id="2391816">.</span><span class="ident" id="2391817">pending</span><span class="op" id="2391824">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391829">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391840">n</span><span class="op" id="2391841">,</span>&nbsp;<span class="ident" id="2391843">err</span>&nbsp;<span class="op" id="2391847">:=</span>&nbsp;<span class="ident" id="2391850">io</span><span class="op" id="2391852">.</span><span class="ident" id="2391853">ReadFull</span><span class="op" id="2391861">(</span><span class="ident" id="2391862">r</span><span class="op" id="2391863">.</span><span class="ident" id="2391864">reader</span><span class="op" id="2391870">,</span>&nbsp;<span class="ident" id="2391872">r</span><span class="op" id="2391873">.</span><span class="ident" id="2391874">pendBuf</span><span class="op" id="2391881">[</span><span class="num" id="2391882">0</span><span class="op" id="2391883">:</span><span class="num" id="2391884">1</span><span class="op" id="2391885">]</span><span class="op" id="2391886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391889">if</span>&nbsp;<span class="ident" id="2391892">n</span>&nbsp;<span class="op" id="2391894">!=</span>&nbsp;<span class="num" id="2391897">1</span>&nbsp;<span class="op" id="2391899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391903">return</span>&nbsp;<span class="num" id="2391910">0</span><span class="op" id="2391911">,</span>&nbsp;<span class="ident" id="2391913">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391918">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391921">return</span>&nbsp;<span class="ident" id="2391928">r</span><span class="op" id="2391929">.</span><span class="ident" id="2391930">pendBuf</span><span class="op" id="2391937">[</span><span class="num" id="2391938">0</span><span class="op" id="2391939">]</span><span class="op" id="2391940">,</span>&nbsp;<span class="ident" id="2391942">err</span><br>
<span class="lineno"></span><span class="op" id="2391946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2391949">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2391994">func</span>&nbsp;<span class="op" id="2391999">(</span><span class="ident" id="2392000">r</span>&nbsp;<span class="op" id="2392002">*</span><span class="ident" id="2392003">readRune</span><span class="op" id="2392011">)</span>&nbsp;<span class="ident" id="2392013">unread</span><span class="op" id="2392019">(</span><span class="ident" id="2392020">buf</span>&nbsp;<span class="op" id="2392024">[</span><span class="op" id="2392025">]</span><span class="builtintype" id="2392026">byte</span><span class="op" id="2392030">)</span>&nbsp;<span class="op" id="2392032">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2392035">copy</span><span class="op" id="2392039">(</span><span class="ident" id="2392040">r</span><span class="op" id="2392041">.</span><span class="ident" id="2392042">pendBuf</span><span class="op" id="2392049">[</span><span class="ident" id="2392050">r</span><span class="op" id="2392051">.</span><span class="ident" id="2392052">pending</span><span class="op" id="2392059">:</span><span class="op" id="2392060">]</span><span class="op" id="2392061">,</span>&nbsp;<span class="ident" id="2392063">buf</span><span class="op" id="2392066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392069">r</span><span class="op" id="2392070">.</span><span class="ident" id="2392071">pending</span>&nbsp;<span class="op" id="2392079">+=</span>&nbsp;<span class="builtinfunc" id="2392082">len</span><span class="op" id="2392085">(</span><span class="ident" id="2392086">buf</span><span class="op" id="2392089">)</span><br>
<span class="lineno"></span><span class="op" id="2392091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2392094">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2392157">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2392180">func</span>&nbsp;<span class="op" id="2392185">(</span><span class="ident" id="2392186">r</span>&nbsp;<span class="op" id="2392188">*</span><span class="ident" id="2392189">readRune</span><span class="op" id="2392197">)</span>&nbsp;<span class="ident" id="2392199">ReadRune</span><span class="op" id="2392207">(</span><span class="op" id="2392208">)</span>&nbsp;<span class="op" id="2392210">(</span><span class="ident" id="2392211">rr</span>&nbsp;<span class="builtintype" id="2392214">rune</span><span class="op" id="2392218">,</span>&nbsp;<span class="ident" id="2392220">size</span>&nbsp;<span class="builtintype" id="2392225">int</span><span class="op" id="2392228">,</span>&nbsp;<span class="ident" id="2392230">err</span>&nbsp;<span class="builtintype" id="2392234">error</span><span class="op" id="2392239">)</span>&nbsp;<span class="op" id="2392241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392244">r</span><span class="op" id="2392245">.</span><span class="ident" id="2392246">buf</span><span class="op" id="2392249">[</span><span class="num" id="2392250">0</span><span class="op" id="2392251">]</span><span class="op" id="2392252">,</span>&nbsp;<span class="ident" id="2392254">err</span>&nbsp;<span class="op" id="2392258">=</span>&nbsp;<span class="ident" id="2392260">r</span><span class="op" id="2392261">.</span><span class="ident" id="2392262">readByte</span><span class="op" id="2392270">(</span><span class="op" id="2392271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392274">if</span>&nbsp;<span class="ident" id="2392277">err</span>&nbsp;<span class="op" id="2392281">!=</span>&nbsp;<span class="builtintype" id="2392284">nil</span>&nbsp;<span class="op" id="2392288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392292">return</span>&nbsp;<span class="num" id="2392299">0</span><span class="op" id="2392300">,</span>&nbsp;<span class="num" id="2392302">0</span><span class="op" id="2392303">,</span>&nbsp;<span class="ident" id="2392305">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392313">if</span>&nbsp;<span class="ident" id="2392316">r</span><span class="op" id="2392317">.</span><span class="ident" id="2392318">buf</span><span class="op" id="2392321">[</span><span class="num" id="2392322">0</span><span class="op" id="2392323">]</span>&nbsp;<span class="op" id="2392325">&lt;</span>&nbsp;<span class="ident" id="2392327">utf8</span><span class="op" id="2392331">.</span><span class="ident" id="2392332">RuneSelf</span>&nbsp;<span class="op" id="2392341">{</span>&nbsp;<span class="comment" id="2392343">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392381">rr</span>&nbsp;<span class="op" id="2392384">=</span>&nbsp;<span class="builtintype" id="2392386">rune</span><span class="op" id="2392390">(</span><span class="ident" id="2392391">r</span><span class="op" id="2392392">.</span><span class="ident" id="2392393">buf</span><span class="op" id="2392396">[</span><span class="num" id="2392397">0</span><span class="op" id="2392398">]</span><span class="op" id="2392399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392403">size</span>&nbsp;<span class="op" id="2392408">=</span>&nbsp;<span class="num" id="2392410">1</span>&nbsp;<span class="comment" id="2392412">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392432">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392443">var</span>&nbsp;<span class="ident" id="2392447">n</span>&nbsp;<span class="builtintype" id="2392449">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392454">for</span>&nbsp;<span class="ident" id="2392458">n</span>&nbsp;<span class="op" id="2392460">=</span>&nbsp;<span class="num" id="2392462">1</span><span class="op" id="2392463">;</span>&nbsp;<span class="op" id="2392465">!</span><span class="ident" id="2392466">utf8</span><span class="op" id="2392470">.</span><span class="ident" id="2392471">FullRune</span><span class="op" id="2392479">(</span><span class="ident" id="2392480">r</span><span class="op" id="2392481">.</span><span class="ident" id="2392482">buf</span><span class="op" id="2392485">[</span><span class="num" id="2392486">0</span><span class="op" id="2392487">:</span><span class="ident" id="2392488">n</span><span class="op" id="2392489">]</span><span class="op" id="2392490">)</span><span class="op" id="2392491">;</span>&nbsp;<span class="ident" id="2392493">n</span><span class="op" id="2392494">++</span>&nbsp;<span class="op" id="2392497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392501">r</span><span class="op" id="2392502">.</span><span class="ident" id="2392503">buf</span><span class="op" id="2392506">[</span><span class="ident" id="2392507">n</span><span class="op" id="2392508">]</span><span class="op" id="2392509">,</span>&nbsp;<span class="ident" id="2392511">err</span>&nbsp;<span class="op" id="2392515">=</span>&nbsp;<span class="ident" id="2392517">r</span><span class="op" id="2392518">.</span><span class="ident" id="2392519">readByte</span><span class="op" id="2392527">(</span><span class="op" id="2392528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392532">if</span>&nbsp;<span class="ident" id="2392535">err</span>&nbsp;<span class="op" id="2392539">!=</span>&nbsp;<span class="builtintype" id="2392542">nil</span>&nbsp;<span class="op" id="2392546">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392551">if</span>&nbsp;<span class="ident" id="2392554">err</span>&nbsp;<span class="op" id="2392558">==</span>&nbsp;<span class="ident" id="2392561">io</span><span class="op" id="2392563">.</span><span class="ident" id="2392564">EOF</span>&nbsp;<span class="op" id="2392568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392574">err</span>&nbsp;<span class="op" id="2392578">=</span>&nbsp;<span class="builtintype" id="2392580">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392588">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392602">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392617">rr</span><span class="op" id="2392619">,</span>&nbsp;<span class="ident" id="2392621">size</span>&nbsp;<span class="op" id="2392626">=</span>&nbsp;<span class="ident" id="2392628">utf8</span><span class="op" id="2392632">.</span><span class="ident" id="2392633">DecodeRune</span><span class="op" id="2392643">(</span><span class="ident" id="2392644">r</span><span class="op" id="2392645">.</span><span class="ident" id="2392646">buf</span><span class="op" id="2392649">[</span><span class="num" id="2392650">0</span><span class="op" id="2392651">:</span><span class="ident" id="2392652">n</span><span class="op" id="2392653">]</span><span class="op" id="2392654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392657">if</span>&nbsp;<span class="ident" id="2392660">size</span>&nbsp;<span class="op" id="2392665">&lt;</span>&nbsp;<span class="ident" id="2392667">n</span>&nbsp;<span class="op" id="2392669">{</span>&nbsp;<span class="comment" id="2392671">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392685">r</span><span class="op" id="2392686">.</span><span class="ident" id="2392687">unread</span><span class="op" id="2392693">(</span><span class="ident" id="2392694">r</span><span class="op" id="2392695">.</span><span class="ident" id="2392696">buf</span><span class="op" id="2392699">[</span><span class="ident" id="2392700">size</span><span class="op" id="2392704">:</span><span class="ident" id="2392705">n</span><span class="op" id="2392706">]</span><span class="op" id="2392707">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392713">return</span><br>
<span class="lineno"></span><span class="op" id="2392720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2392723">var</span>&nbsp;<span class="ident" id="2392727">ssFree</span>&nbsp;<span class="op" id="2392734">=</span>&nbsp;<span class="ident" id="2392736">sync</span><span class="op" id="2392740">.</span><span class="ident" id="2392741">Pool</span><span class="op" id="2392745">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392748">New</span><span class="op" id="2392751">:</span>&nbsp;<span class="keyword" id="2392753">func</span><span class="op" id="2392757">(</span><span class="op" id="2392758">)</span>&nbsp;<span class="keyword" id="2392760">interface</span><span class="op" id="2392769">{</span><span class="op" id="2392770">}</span>&nbsp;<span class="op" id="2392772">{</span>&nbsp;<span class="keyword" id="2392774">return</span>&nbsp;<span class="builtinfunc" id="2392781">new</span><span class="op" id="2392784">(</span><span class="ident" id="2392785">ss</span><span class="op" id="2392787">)</span>&nbsp;<span class="op" id="2392789">}</span><span class="op" id="2392790">,</span><br>
<span class="lineno"></span><span class="op" id="2392792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2392795">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2392859">func</span>&nbsp;<span class="ident" id="2392864">newScanState</span><span class="op" id="2392876">(</span><span class="ident" id="2392877">r</span>&nbsp;<span class="ident" id="2392879">io</span><span class="op" id="2392881">.</span><span class="ident" id="2392882">Reader</span><span class="op" id="2392888">,</span>&nbsp;<span class="ident" id="2392890">nlIsSpace</span><span class="op" id="2392899">,</span>&nbsp;<span class="ident" id="2392901">nlIsEnd</span>&nbsp;<span class="builtintype" id="2392909">bool</span><span class="op" id="2392913">)</span>&nbsp;<span class="op" id="2392915">(</span><span class="ident" id="2392916">s</span>&nbsp;<span class="op" id="2392918">*</span><span class="ident" id="2392919">ss</span><span class="op" id="2392921">,</span>&nbsp;<span class="ident" id="2392923">old</span>&nbsp;<span class="ident" id="2392927">ssave</span><span class="op" id="2392932">)</span>&nbsp;<span class="op" id="2392934">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392937">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392992">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393036">s</span><span class="op" id="2393037">,</span>&nbsp;<span class="ident" id="2393039">ok</span>&nbsp;<span class="op" id="2393042">:=</span>&nbsp;<span class="ident" id="2393045">r</span><span class="op" id="2393046">.</span><span class="op" id="2393047">(</span><span class="op" id="2393048">*</span><span class="ident" id="2393049">ss</span><span class="op" id="2393051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393054">if</span>&nbsp;<span class="ident" id="2393057">ok</span>&nbsp;<span class="op" id="2393060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393064">old</span>&nbsp;<span class="op" id="2393068">=</span>&nbsp;<span class="ident" id="2393070">s</span><span class="op" id="2393071">.</span><span class="ident" id="2393072">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393080">s</span><span class="op" id="2393081">.</span><span class="ident" id="2393082">limit</span>&nbsp;<span class="op" id="2393088">=</span>&nbsp;<span class="ident" id="2393090">s</span><span class="op" id="2393091">.</span><span class="ident" id="2393092">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393103">s</span><span class="op" id="2393104">.</span><span class="ident" id="2393105">nlIsEnd</span>&nbsp;<span class="op" id="2393113">=</span>&nbsp;<span class="ident" id="2393115">nlIsEnd</span>&nbsp;<span class="op" id="2393123">||</span>&nbsp;<span class="ident" id="2393126">s</span><span class="op" id="2393127">.</span><span class="ident" id="2393128">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393138">s</span><span class="op" id="2393139">.</span><span class="ident" id="2393140">nlIsSpace</span>&nbsp;<span class="op" id="2393150">=</span>&nbsp;<span class="ident" id="2393152">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393164">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393172">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393176">s</span>&nbsp;<span class="op" id="2393178">=</span>&nbsp;<span class="ident" id="2393180">ssFree</span><span class="op" id="2393186">.</span><span class="ident" id="2393187">Get</span><span class="op" id="2393190">(</span><span class="op" id="2393191">)</span><span class="op" id="2393192">.</span><span class="op" id="2393193">(</span><span class="op" id="2393194">*</span><span class="ident" id="2393195">ss</span><span class="op" id="2393197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393200">if</span>&nbsp;<span class="ident" id="2393203">rr</span><span class="op" id="2393205">,</span>&nbsp;<span class="ident" id="2393207">ok</span>&nbsp;<span class="op" id="2393210">:=</span>&nbsp;<span class="ident" id="2393213">r</span><span class="op" id="2393214">.</span><span class="op" id="2393215">(</span><span class="ident" id="2393216">io</span><span class="op" id="2393218">.</span><span class="ident" id="2393219">RuneReader</span><span class="op" id="2393229">)</span><span class="op" id="2393230">;</span>&nbsp;<span class="ident" id="2393232">ok</span>&nbsp;<span class="op" id="2393235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393239">s</span><span class="op" id="2393240">.</span><span class="ident" id="2393241">rr</span>&nbsp;<span class="op" id="2393244">=</span>&nbsp;<span class="ident" id="2393246">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393250">}</span>&nbsp;<span class="keyword" id="2393252">else</span>&nbsp;<span class="op" id="2393257">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393261">s</span><span class="op" id="2393262">.</span><span class="ident" id="2393263">rr</span>&nbsp;<span class="op" id="2393266">=</span>&nbsp;<span class="op" id="2393268">&amp;</span><span class="ident" id="2393269">readRune</span><span class="op" id="2393277">{</span><span class="ident" id="2393278">reader</span><span class="op" id="2393284">:</span>&nbsp;<span class="ident" id="2393286">r</span><span class="op" id="2393287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393293">s</span><span class="op" id="2393294">.</span><span class="ident" id="2393295">nlIsSpace</span>&nbsp;<span class="op" id="2393305">=</span>&nbsp;<span class="ident" id="2393307">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393318">s</span><span class="op" id="2393319">.</span><span class="ident" id="2393320">nlIsEnd</span>&nbsp;<span class="op" id="2393328">=</span>&nbsp;<span class="ident" id="2393330">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393339">s</span><span class="op" id="2393340">.</span><span class="ident" id="2393341">prevRune</span>&nbsp;<span class="op" id="2393350">=</span>&nbsp;<span class="op" id="2393352">-</span><span class="num" id="2393353">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393356">s</span><span class="op" id="2393357">.</span><span class="ident" id="2393358">peekRune</span>&nbsp;<span class="op" id="2393367">=</span>&nbsp;<span class="op" id="2393369">-</span><span class="num" id="2393370">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393373">s</span><span class="op" id="2393374">.</span><span class="ident" id="2393375">atEOF</span>&nbsp;<span class="op" id="2393381">=</span>&nbsp;<span class="builtintype" id="2393383">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393390">s</span><span class="op" id="2393391">.</span><span class="ident" id="2393392">limit</span>&nbsp;<span class="op" id="2393398">=</span>&nbsp;<span class="ident" id="2393400">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393409">s</span><span class="op" id="2393410">.</span><span class="ident" id="2393411">argLimit</span>&nbsp;<span class="op" id="2393420">=</span>&nbsp;<span class="ident" id="2393422">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393431">s</span><span class="op" id="2393432">.</span><span class="ident" id="2393433">maxWid</span>&nbsp;<span class="op" id="2393440">=</span>&nbsp;<span class="ident" id="2393442">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393451">s</span><span class="op" id="2393452">.</span><span class="ident" id="2393453">validSave</span>&nbsp;<span class="op" id="2393463">=</span>&nbsp;<span class="builtintype" id="2393465">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393471">s</span><span class="op" id="2393472">.</span><span class="ident" id="2393473">count</span>&nbsp;<span class="op" id="2393479">=</span>&nbsp;<span class="num" id="2393481">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393484">return</span><br>
<span class="lineno"></span><span class="op" id="2393491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2393494">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2393571">func</span>&nbsp;<span class="op" id="2393576">(</span><span class="ident" id="2393577">s</span>&nbsp;<span class="op" id="2393579">*</span><span class="ident" id="2393580">ss</span><span class="op" id="2393582">)</span>&nbsp;<span class="ident" id="2393584">free</span><span class="op" id="2393588">(</span><span class="ident" id="2393589">old</span>&nbsp;<span class="ident" id="2393593">ssave</span><span class="op" id="2393598">)</span>&nbsp;<span class="op" id="2393600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2393603">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393663">if</span>&nbsp;<span class="ident" id="2393666">old</span><span class="op" id="2393669">.</span><span class="ident" id="2393670">validSave</span>&nbsp;<span class="op" id="2393680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393684">s</span><span class="op" id="2393685">.</span><span class="ident" id="2393686">ssave</span>&nbsp;<span class="op" id="2393692">=</span>&nbsp;<span class="ident" id="2393694">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393700">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2393711">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393763">if</span>&nbsp;<span class="builtinfunc" id="2393766">cap</span><span class="op" id="2393769">(</span><span class="ident" id="2393770">s</span><span class="op" id="2393771">.</span><span class="ident" id="2393772">buf</span><span class="op" id="2393775">)</span>&nbsp;<span class="op" id="2393777">&gt;</span>&nbsp;<span class="num" id="2393779">1024</span>&nbsp;<span class="op" id="2393784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393788">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393799">s</span><span class="op" id="2393800">.</span><span class="ident" id="2393801">buf</span>&nbsp;<span class="op" id="2393805">=</span>&nbsp;<span class="ident" id="2393807">s</span><span class="op" id="2393808">.</span><span class="ident" id="2393809">buf</span><span class="op" id="2393812">[</span><span class="op" id="2393813">:</span><span class="num" id="2393814">0</span><span class="op" id="2393815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393818">s</span><span class="op" id="2393819">.</span><span class="ident" id="2393820">rr</span>&nbsp;<span class="op" id="2393823">=</span>&nbsp;<span class="builtintype" id="2393825">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393830">ssFree</span><span class="op" id="2393836">.</span><span class="ident" id="2393837">Put</span><span class="op" id="2393840">(</span><span class="ident" id="2393841">s</span><span class="op" id="2393842">)</span><br>
<span class="lineno"></span><span class="op" id="2393844">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2393847">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2393893">func</span>&nbsp;<span class="op" id="2393898">(</span><span class="ident" id="2393899">s</span>&nbsp;<span class="op" id="2393901">*</span><span class="ident" id="2393902">ss</span><span class="op" id="2393904">)</span>&nbsp;<span class="ident" id="2393906">skipSpace</span><span class="op" id="2393915">(</span><span class="ident" id="2393916">stopAtNewline</span>&nbsp;<span class="builtintype" id="2393930">bool</span><span class="op" id="2393934">)</span>&nbsp;<span class="op" id="2393936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393939">for</span>&nbsp;<span class="op" id="2393943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393947">r</span>&nbsp;<span class="op" id="2393949">:=</span>&nbsp;<span class="ident" id="2393952">s</span><span class="op" id="2393953">.</span><span class="ident" id="2393954">getRune</span><span class="op" id="2393961">(</span><span class="op" id="2393962">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393966">if</span>&nbsp;<span class="ident" id="2393969">r</span>&nbsp;<span class="op" id="2393971">==</span>&nbsp;<span class="ident" id="2393974">eof</span>&nbsp;<span class="op" id="2393978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393983">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393996">if</span>&nbsp;<span class="ident" id="2393999">r</span>&nbsp;<span class="op" id="2394001">==</span>&nbsp;<span class="string" id="2394004">&#39;\r&#39;</span>&nbsp;<span class="op" id="2394009">&amp;&amp;</span>&nbsp;<span class="ident" id="2394012">s</span><span class="op" id="2394013">.</span><span class="ident" id="2394014">peek</span><span class="op" id="2394018">(</span><span class="string" id="2394019">&#34;\n&#34;</span><span class="op" id="2394023">)</span>&nbsp;<span class="op" id="2394025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394030">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394045">if</span>&nbsp;<span class="ident" id="2394048">r</span>&nbsp;<span class="op" id="2394050">==</span>&nbsp;<span class="string" id="2394053">&#39;\n&#39;</span>&nbsp;<span class="op" id="2394058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394063">if</span>&nbsp;<span class="ident" id="2394066">stopAtNewline</span>&nbsp;<span class="op" id="2394080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394086">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394095">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394100">if</span>&nbsp;<span class="ident" id="2394103">s</span><span class="op" id="2394104">.</span><span class="ident" id="2394105">nlIsSpace</span>&nbsp;<span class="op" id="2394115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394121">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394138">s</span><span class="op" id="2394139">.</span><span class="ident" id="2394140">errorString</span><span class="op" id="2394151">(</span><span class="string" id="2394152">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2394172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394177">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394190">if</span>&nbsp;<span class="op" id="2394193">!</span><span class="ident" id="2394194">isSpace</span><span class="op" id="2394201">(</span><span class="ident" id="2394202">r</span><span class="op" id="2394203">)</span>&nbsp;<span class="op" id="2394205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394210">s</span><span class="op" id="2394211">.</span><span class="ident" id="2394212">UnreadRune</span><span class="op" id="2394222">(</span><span class="op" id="2394223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394228">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394236">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394239">}</span><br>
<span class="lineno"></span><span class="op" id="2394241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2394244">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2394313">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2394381">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2394416">func</span>&nbsp;<span class="op" id="2394421">(</span><span class="ident" id="2394422">s</span>&nbsp;<span class="op" id="2394424">*</span><span class="ident" id="2394425">ss</span><span class="op" id="2394427">)</span>&nbsp;<span class="ident" id="2394429">token</span><span class="op" id="2394434">(</span><span class="ident" id="2394435">skipSpace</span>&nbsp;<span class="builtintype" id="2394445">bool</span><span class="op" id="2394449">,</span>&nbsp;<span class="ident" id="2394451">f</span>&nbsp;<span class="keyword" id="2394453">func</span><span class="op" id="2394457">(</span><span class="builtintype" id="2394458">rune</span><span class="op" id="2394462">)</span>&nbsp;<span class="builtintype" id="2394464">bool</span><span class="op" id="2394468">)</span>&nbsp;<span class="op" id="2394470">[</span><span class="op" id="2394471">]</span><span class="builtintype" id="2394472">byte</span>&nbsp;<span class="op" id="2394477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394480">if</span>&nbsp;<span class="ident" id="2394483">skipSpace</span>&nbsp;<span class="op" id="2394493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394497">s</span><span class="op" id="2394498">.</span><span class="ident" id="2394499">skipSpace</span><span class="op" id="2394508">(</span><span class="builtintype" id="2394509">false</span><span class="op" id="2394514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394517">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2394520">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394558">for</span>&nbsp;<span class="op" id="2394562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394566">r</span>&nbsp;<span class="op" id="2394568">:=</span>&nbsp;<span class="ident" id="2394571">s</span><span class="op" id="2394572">.</span><span class="ident" id="2394573">getRune</span><span class="op" id="2394580">(</span><span class="op" id="2394581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394585">if</span>&nbsp;<span class="ident" id="2394588">r</span>&nbsp;<span class="op" id="2394590">==</span>&nbsp;<span class="ident" id="2394593">eof</span>&nbsp;<span class="op" id="2394597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394602">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394614">if</span>&nbsp;<span class="op" id="2394617">!</span><span class="ident" id="2394618">f</span><span class="op" id="2394619">(</span><span class="ident" id="2394620">r</span><span class="op" id="2394621">)</span>&nbsp;<span class="op" id="2394623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394628">s</span><span class="op" id="2394629">.</span><span class="ident" id="2394630">UnreadRune</span><span class="op" id="2394640">(</span><span class="op" id="2394641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394646">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394654">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394658">s</span><span class="op" id="2394659">.</span><span class="ident" id="2394660">buf</span><span class="op" id="2394663">.</span><span class="ident" id="2394664">WriteRune</span><span class="op" id="2394673">(</span><span class="ident" id="2394674">r</span><span class="op" id="2394675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394681">return</span>&nbsp;<span class="ident" id="2394688">s</span><span class="op" id="2394689">.</span><span class="ident" id="2394690">buf</span><br>
<span class="lineno"></span><span class="op" id="2394694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2394697">var</span>&nbsp;<span class="ident" id="2394701">complexError</span>&nbsp;<span class="op" id="2394714">=</span>&nbsp;<span class="ident" id="2394716">errors</span><span class="op" id="2394722">.</span><span class="ident" id="2394723">New</span><span class="op" id="2394726">(</span><span class="string" id="2394727">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2394765">)</span><br>
<span class="lineno"></span><span class="keyword" id="2394767">var</span>&nbsp;<span class="ident" id="2394771">boolError</span>&nbsp;<span class="op" id="2394781">=</span>&nbsp;<span class="ident" id="2394783">errors</span><span class="op" id="2394789">.</span><span class="ident" id="2394790">New</span><span class="op" id="2394793">(</span><span class="string" id="2394794">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2394825">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2394828">func</span>&nbsp;<span class="ident" id="2394833">indexRune</span><span class="op" id="2394842">(</span><span class="ident" id="2394843">s</span>&nbsp;<span class="builtintype" id="2394845">string</span><span class="op" id="2394851">,</span>&nbsp;<span class="ident" id="2394853">r</span>&nbsp;<span class="builtintype" id="2394855">rune</span><span class="op" id="2394859">)</span>&nbsp;<span class="builtintype" id="2394861">int</span>&nbsp;<span class="op" id="2394865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394868">for</span>&nbsp;<span class="ident" id="2394872">i</span><span class="op" id="2394873">,</span>&nbsp;<span class="ident" id="2394875">c</span>&nbsp;<span class="op" id="2394877">:=</span>&nbsp;<span class="keyword" id="2394880">range</span>&nbsp;<span class="ident" id="2394886">s</span>&nbsp;<span class="op" id="2394888">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394892">if</span>&nbsp;<span class="ident" id="2394895">c</span>&nbsp;<span class="op" id="2394897">==</span>&nbsp;<span class="ident" id="2394900">r</span>&nbsp;<span class="op" id="2394902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394907">return</span>&nbsp;<span class="ident" id="2394914">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394924">return</span>&nbsp;<span class="op" id="2394931">-</span><span class="num" id="2394932">1</span><br>
<span class="lineno">495</span><span class="op" id="2394934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2394937">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2395025">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2395091">func</span>&nbsp;<span class="op" id="2395096">(</span><span class="ident" id="2395097">s</span>&nbsp;<span class="op" id="2395099">*</span><span class="ident" id="2395100">ss</span><span class="op" id="2395102">)</span>&nbsp;<span class="ident" id="2395104">consume</span><span class="op" id="2395111">(</span><span class="ident" id="2395112">ok</span>&nbsp;<span class="builtintype" id="2395115">string</span><span class="op" id="2395121">,</span>&nbsp;<span class="ident" id="2395123">accept</span>&nbsp;<span class="builtintype" id="2395130">bool</span><span class="op" id="2395134">)</span>&nbsp;<span class="builtintype" id="2395136">bool</span>&nbsp;<span class="op" id="2395141">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395144">r</span>&nbsp;<span class="op" id="2395146">:=</span>&nbsp;<span class="ident" id="2395149">s</span><span class="op" id="2395150">.</span><span class="ident" id="2395151">getRune</span><span class="op" id="2395158">(</span><span class="op" id="2395159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395162">if</span>&nbsp;<span class="ident" id="2395165">r</span>&nbsp;<span class="op" id="2395167">==</span>&nbsp;<span class="ident" id="2395170">eof</span>&nbsp;<span class="op" id="2395174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395178">return</span>&nbsp;<span class="builtintype" id="2395185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395195">if</span>&nbsp;<span class="ident" id="2395198">indexRune</span><span class="op" id="2395207">(</span><span class="ident" id="2395208">ok</span><span class="op" id="2395210">,</span>&nbsp;<span class="ident" id="2395212">r</span><span class="op" id="2395213">)</span>&nbsp;<span class="op" id="2395215">&gt;=</span>&nbsp;<span class="num" id="2395218">0</span>&nbsp;<span class="op" id="2395220">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395224">if</span>&nbsp;<span class="ident" id="2395227">accept</span>&nbsp;<span class="op" id="2395234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395239">s</span><span class="op" id="2395240">.</span><span class="ident" id="2395241">buf</span><span class="op" id="2395244">.</span><span class="ident" id="2395245">WriteRune</span><span class="op" id="2395254">(</span><span class="ident" id="2395255">r</span><span class="op" id="2395256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395264">return</span>&nbsp;<span class="builtintype" id="2395271">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395277">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395280">if</span>&nbsp;<span class="ident" id="2395283">r</span>&nbsp;<span class="op" id="2395285">!=</span>&nbsp;<span class="ident" id="2395288">eof</span>&nbsp;<span class="op" id="2395292">&amp;&amp;</span>&nbsp;<span class="ident" id="2395295">accept</span>&nbsp;<span class="op" id="2395302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395306">s</span><span class="op" id="2395307">.</span><span class="ident" id="2395308">UnreadRune</span><span class="op" id="2395318">(</span><span class="op" id="2395319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395325">return</span>&nbsp;<span class="builtintype" id="2395332">false</span><br>
<span class="lineno"></span><span class="op" id="2395338">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2395341">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2395427">func</span>&nbsp;<span class="op" id="2395432">(</span><span class="ident" id="2395433">s</span>&nbsp;<span class="op" id="2395435">*</span><span class="ident" id="2395436">ss</span><span class="op" id="2395438">)</span>&nbsp;<span class="ident" id="2395440">peek</span><span class="op" id="2395444">(</span><span class="ident" id="2395445">ok</span>&nbsp;<span class="builtintype" id="2395448">string</span><span class="op" id="2395454">)</span>&nbsp;<span class="builtintype" id="2395456">bool</span>&nbsp;<span class="op" id="2395461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395464">r</span>&nbsp;<span class="op" id="2395466">:=</span>&nbsp;<span class="ident" id="2395469">s</span><span class="op" id="2395470">.</span><span class="ident" id="2395471">getRune</span><span class="op" id="2395478">(</span><span class="op" id="2395479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395482">if</span>&nbsp;<span class="ident" id="2395485">r</span>&nbsp;<span class="op" id="2395487">!=</span>&nbsp;<span class="ident" id="2395490">eof</span>&nbsp;<span class="op" id="2395494">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395498">s</span><span class="op" id="2395499">.</span><span class="ident" id="2395500">UnreadRune</span><span class="op" id="2395510">(</span><span class="op" id="2395511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395517">return</span>&nbsp;<span class="ident" id="2395524">indexRune</span><span class="op" id="2395533">(</span><span class="ident" id="2395534">ok</span><span class="op" id="2395536">,</span>&nbsp;<span class="ident" id="2395538">r</span><span class="op" id="2395539">)</span>&nbsp;<span class="op" id="2395541">&gt;=</span>&nbsp;<span class="num" id="2395544">0</span><br>
<span class="lineno"></span><span class="op" id="2395546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2395549">func</span>&nbsp;<span class="op" id="2395554">(</span><span class="ident" id="2395555">s</span>&nbsp;<span class="op" id="2395557">*</span><span class="ident" id="2395558">ss</span><span class="op" id="2395560">)</span>&nbsp;<span class="ident" id="2395562">notEOF</span><span class="op" id="2395568">(</span><span class="op" id="2395569">)</span>&nbsp;<span class="op" id="2395571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2395574">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395614">if</span>&nbsp;<span class="ident" id="2395617">r</span>&nbsp;<span class="op" id="2395619">:=</span>&nbsp;<span class="ident" id="2395622">s</span><span class="op" id="2395623">.</span><span class="ident" id="2395624">getRune</span><span class="op" id="2395631">(</span><span class="op" id="2395632">)</span><span class="op" id="2395633">;</span>&nbsp;<span class="ident" id="2395635">r</span>&nbsp;<span class="op" id="2395637">==</span>&nbsp;<span class="ident" id="2395640">eof</span>&nbsp;<span class="op" id="2395644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2395648">panic</span><span class="op" id="2395653">(</span><span class="ident" id="2395654">io</span><span class="op" id="2395656">.</span><span class="ident" id="2395657">EOF</span><span class="op" id="2395660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395663">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395666">s</span><span class="op" id="2395667">.</span><span class="ident" id="2395668">UnreadRune</span><span class="op" id="2395678">(</span><span class="op" id="2395679">)</span><br>
<span class="lineno"></span><span class="op" id="2395681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2395684">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2395784">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2395839">func</span>&nbsp;<span class="op" id="2395844">(</span><span class="ident" id="2395845">s</span>&nbsp;<span class="op" id="2395847">*</span><span class="ident" id="2395848">ss</span><span class="op" id="2395850">)</span>&nbsp;<span class="ident" id="2395852">accept</span><span class="op" id="2395858">(</span><span class="ident" id="2395859">ok</span>&nbsp;<span class="builtintype" id="2395862">string</span><span class="op" id="2395868">)</span>&nbsp;<span class="builtintype" id="2395870">bool</span>&nbsp;<span class="op" id="2395875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395878">return</span>&nbsp;<span class="ident" id="2395885">s</span><span class="op" id="2395886">.</span><span class="ident" id="2395887">consume</span><span class="op" id="2395894">(</span><span class="ident" id="2395895">ok</span><span class="op" id="2395897">,</span>&nbsp;<span class="builtintype" id="2395899">true</span><span class="op" id="2395903">)</span><br>
<span class="lineno"></span><span class="op" id="2395905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2395908">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2396001">func</span>&nbsp;<span class="op" id="2396006">(</span><span class="ident" id="2396007">s</span>&nbsp;<span class="op" id="2396009">*</span><span class="ident" id="2396010">ss</span><span class="op" id="2396012">)</span>&nbsp;<span class="ident" id="2396014">okVerb</span><span class="op" id="2396020">(</span><span class="ident" id="2396021">verb</span>&nbsp;<span class="builtintype" id="2396026">rune</span><span class="op" id="2396030">,</span>&nbsp;<span class="ident" id="2396032">okVerbs</span><span class="op" id="2396039">,</span>&nbsp;<span class="ident" id="2396041">typ</span>&nbsp;<span class="builtintype" id="2396045">string</span><span class="op" id="2396051">)</span>&nbsp;<span class="builtintype" id="2396053">bool</span>&nbsp;<span class="op" id="2396058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396061">for</span>&nbsp;<span class="ident" id="2396065">_</span><span class="op" id="2396066">,</span>&nbsp;<span class="ident" id="2396068">v</span>&nbsp;<span class="op" id="2396070">:=</span>&nbsp;<span class="keyword" id="2396073">range</span>&nbsp;<span class="ident" id="2396079">okVerbs</span>&nbsp;<span class="op" id="2396087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396091">if</span>&nbsp;<span class="ident" id="2396094">v</span>&nbsp;<span class="op" id="2396096">==</span>&nbsp;<span class="ident" id="2396099">verb</span>&nbsp;<span class="op" id="2396104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396109">return</span>&nbsp;<span class="builtintype" id="2396116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396123">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396129">s</span><span class="op" id="2396130">.</span><span class="ident" id="2396131">errorString</span><span class="op" id="2396142">(</span><span class="string" id="2396143">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2396156">+</span>&nbsp;<span class="builtintype" id="2396158">string</span><span class="op" id="2396164">(</span><span class="ident" id="2396165">verb</span><span class="op" id="2396169">)</span>&nbsp;<span class="op" id="2396171">+</span>&nbsp;<span class="string" id="2396173">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2396181">+</span>&nbsp;<span class="ident" id="2396183">typ</span><span class="op" id="2396186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396189">return</span>&nbsp;<span class="builtintype" id="2396196">false</span><br>
<span class="lineno"></span><span class="op" id="2396202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2396205">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2396281">func</span>&nbsp;<span class="op" id="2396286">(</span><span class="ident" id="2396287">s</span>&nbsp;<span class="op" id="2396289">*</span><span class="ident" id="2396290">ss</span><span class="op" id="2396292">)</span>&nbsp;<span class="ident" id="2396294">scanBool</span><span class="op" id="2396302">(</span><span class="ident" id="2396303">verb</span>&nbsp;<span class="builtintype" id="2396308">rune</span><span class="op" id="2396312">)</span>&nbsp;<span class="builtintype" id="2396314">bool</span>&nbsp;<span class="op" id="2396319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396322">s</span><span class="op" id="2396323">.</span><span class="ident" id="2396324">skipSpace</span><span class="op" id="2396333">(</span><span class="builtintype" id="2396334">false</span><span class="op" id="2396339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396342">s</span><span class="op" id="2396343">.</span><span class="ident" id="2396344">notEOF</span><span class="op" id="2396350">(</span><span class="op" id="2396351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396354">if</span>&nbsp;<span class="op" id="2396357">!</span><span class="ident" id="2396358">s</span><span class="op" id="2396359">.</span><span class="ident" id="2396360">okVerb</span><span class="op" id="2396366">(</span><span class="ident" id="2396367">verb</span><span class="op" id="2396371">,</span>&nbsp;<span class="string" id="2396373">&#34;tv&#34;</span><span class="op" id="2396377">,</span>&nbsp;<span class="string" id="2396379">&#34;boolean&#34;</span><span class="op" id="2396388">)</span>&nbsp;<span class="op" id="2396390">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396394">return</span>&nbsp;<span class="builtintype" id="2396401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2396411">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396488">switch</span>&nbsp;<span class="ident" id="2396495">s</span><span class="op" id="2396496">.</span><span class="ident" id="2396497">getRune</span><span class="op" id="2396504">(</span><span class="op" id="2396505">)</span>&nbsp;<span class="op" id="2396507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396510">case</span>&nbsp;<span class="string" id="2396515">&#39;0&#39;</span><span class="op" id="2396518">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396522">return</span>&nbsp;<span class="builtintype" id="2396529">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396536">case</span>&nbsp;<span class="string" id="2396541">&#39;1&#39;</span><span class="op" id="2396544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396548">return</span>&nbsp;<span class="builtintype" id="2396555">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396561">case</span>&nbsp;<span class="string" id="2396566">&#39;t&#39;</span><span class="op" id="2396569">,</span>&nbsp;<span class="string" id="2396571">&#39;T&#39;</span><span class="op" id="2396574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396578">if</span>&nbsp;<span class="ident" id="2396581">s</span><span class="op" id="2396582">.</span><span class="ident" id="2396583">accept</span><span class="op" id="2396589">(</span><span class="string" id="2396590">&#34;rR&#34;</span><span class="op" id="2396594">)</span>&nbsp;<span class="op" id="2396596">&amp;&amp;</span>&nbsp;<span class="op" id="2396599">(</span><span class="op" id="2396600">!</span><span class="ident" id="2396601">s</span><span class="op" id="2396602">.</span><span class="ident" id="2396603">accept</span><span class="op" id="2396609">(</span><span class="string" id="2396610">&#34;uU&#34;</span><span class="op" id="2396614">)</span>&nbsp;<span class="op" id="2396616">||</span>&nbsp;<span class="op" id="2396619">!</span><span class="ident" id="2396620">s</span><span class="op" id="2396621">.</span><span class="ident" id="2396622">accept</span><span class="op" id="2396628">(</span><span class="string" id="2396629">&#34;eE&#34;</span><span class="op" id="2396633">)</span><span class="op" id="2396634">)</span>&nbsp;<span class="op" id="2396636">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396641">s</span><span class="op" id="2396642">.</span><span class="builtintype" id="2396643">error</span><span class="op" id="2396648">(</span><span class="ident" id="2396649">boolError</span><span class="op" id="2396658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396666">return</span>&nbsp;<span class="builtintype" id="2396673">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396679">case</span>&nbsp;<span class="string" id="2396684">&#39;f&#39;</span><span class="op" id="2396687">,</span>&nbsp;<span class="string" id="2396689">&#39;F&#39;</span><span class="op" id="2396692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396696">if</span>&nbsp;<span class="ident" id="2396699">s</span><span class="op" id="2396700">.</span><span class="ident" id="2396701">accept</span><span class="op" id="2396707">(</span><span class="string" id="2396708">&#34;aA&#34;</span><span class="op" id="2396712">)</span>&nbsp;<span class="op" id="2396714">&amp;&amp;</span>&nbsp;<span class="op" id="2396717">(</span><span class="op" id="2396718">!</span><span class="ident" id="2396719">s</span><span class="op" id="2396720">.</span><span class="ident" id="2396721">accept</span><span class="op" id="2396727">(</span><span class="string" id="2396728">&#34;lL&#34;</span><span class="op" id="2396732">)</span>&nbsp;<span class="op" id="2396734">||</span>&nbsp;<span class="op" id="2396737">!</span><span class="ident" id="2396738">s</span><span class="op" id="2396739">.</span><span class="ident" id="2396740">accept</span><span class="op" id="2396746">(</span><span class="string" id="2396747">&#34;sS&#34;</span><span class="op" id="2396751">)</span>&nbsp;<span class="op" id="2396753">||</span>&nbsp;<span class="op" id="2396756">!</span><span class="ident" id="2396757">s</span><span class="op" id="2396758">.</span><span class="ident" id="2396759">accept</span><span class="op" id="2396765">(</span><span class="string" id="2396766">&#34;eE&#34;</span><span class="op" id="2396770">)</span><span class="op" id="2396771">)</span>&nbsp;<span class="op" id="2396773">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396778">s</span><span class="op" id="2396779">.</span><span class="builtintype" id="2396780">error</span><span class="op" id="2396785">(</span><span class="ident" id="2396786">boolError</span><span class="op" id="2396795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396803">return</span>&nbsp;<span class="builtintype" id="2396810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396820">return</span>&nbsp;<span class="builtintype" id="2396827">false</span><br>
<span class="lineno">575</span><span class="op" id="2396833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2396836">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2396858">const</span>&nbsp;<span class="op" id="2396864">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396867">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396885">=</span>&nbsp;<span class="string" id="2396887">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396893">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396911">=</span>&nbsp;<span class="string" id="2396913">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396925">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396943">=</span>&nbsp;<span class="string" id="2396945">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396959">hexadecimalDigits</span>&nbsp;<span class="op" id="2396977">=</span>&nbsp;<span class="string" id="2396979">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397005">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397023">=</span>&nbsp;<span class="string" id="2397025">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397031">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397049">=</span>&nbsp;<span class="string" id="2397051">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397056">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397074">=</span>&nbsp;<span class="string" id="2397076">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2397082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2397085">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2397167">func</span>&nbsp;<span class="op" id="2397172">(</span><span class="ident" id="2397173">s</span>&nbsp;<span class="op" id="2397175">*</span><span class="ident" id="2397176">ss</span><span class="op" id="2397178">)</span>&nbsp;<span class="ident" id="2397180">getBase</span><span class="op" id="2397187">(</span><span class="ident" id="2397188">verb</span>&nbsp;<span class="builtintype" id="2397193">rune</span><span class="op" id="2397197">)</span>&nbsp;<span class="op" id="2397199">(</span><span class="ident" id="2397200">base</span>&nbsp;<span class="builtintype" id="2397205">int</span><span class="op" id="2397208">,</span>&nbsp;<span class="ident" id="2397210">digits</span>&nbsp;<span class="builtintype" id="2397217">string</span><span class="op" id="2397223">)</span>&nbsp;<span class="op" id="2397225">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397228">s</span><span class="op" id="2397229">.</span><span class="ident" id="2397230">okVerb</span><span class="op" id="2397236">(</span><span class="ident" id="2397237">verb</span><span class="op" id="2397241">,</span>&nbsp;<span class="string" id="2397243">&#34;bdoUxXv&#34;</span><span class="op" id="2397252">,</span>&nbsp;<span class="string" id="2397254">&#34;integer&#34;</span><span class="op" id="2397263">)</span>&nbsp;<span class="comment" id="2397265">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397280">base</span>&nbsp;<span class="op" id="2397285">=</span>&nbsp;<span class="num" id="2397287">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397291">digits</span>&nbsp;<span class="op" id="2397298">=</span>&nbsp;<span class="ident" id="2397300">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397315">switch</span>&nbsp;<span class="ident" id="2397322">verb</span>&nbsp;<span class="op" id="2397327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397330">case</span>&nbsp;<span class="string" id="2397335">&#39;b&#39;</span><span class="op" id="2397338">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397342">base</span>&nbsp;<span class="op" id="2397347">=</span>&nbsp;<span class="num" id="2397349">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397353">digits</span>&nbsp;<span class="op" id="2397360">=</span>&nbsp;<span class="ident" id="2397362">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397376">case</span>&nbsp;<span class="string" id="2397381">&#39;o&#39;</span><span class="op" id="2397384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397388">base</span>&nbsp;<span class="op" id="2397393">=</span>&nbsp;<span class="num" id="2397395">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397399">digits</span>&nbsp;<span class="op" id="2397406">=</span>&nbsp;<span class="ident" id="2397408">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397421">case</span>&nbsp;<span class="string" id="2397426">&#39;x&#39;</span><span class="op" id="2397429">,</span>&nbsp;<span class="string" id="2397431">&#39;X&#39;</span><span class="op" id="2397434">,</span>&nbsp;<span class="string" id="2397436">&#39;U&#39;</span><span class="op" id="2397439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397443">base</span>&nbsp;<span class="op" id="2397448">=</span>&nbsp;<span class="num" id="2397450">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397455">digits</span>&nbsp;<span class="op" id="2397462">=</span>&nbsp;<span class="ident" id="2397464">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397486">return</span><br>
<span class="lineno">605</span><span class="op" id="2397493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2397496">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2397576">func</span>&nbsp;<span class="op" id="2397581">(</span><span class="ident" id="2397582">s</span>&nbsp;<span class="op" id="2397584">*</span><span class="ident" id="2397585">ss</span><span class="op" id="2397587">)</span>&nbsp;<span class="ident" id="2397589">scanNumber</span><span class="op" id="2397599">(</span><span class="ident" id="2397600">digits</span>&nbsp;<span class="builtintype" id="2397607">string</span><span class="op" id="2397613">,</span>&nbsp;<span class="ident" id="2397615">haveDigits</span>&nbsp;<span class="builtintype" id="2397626">bool</span><span class="op" id="2397630">)</span>&nbsp;<span class="builtintype" id="2397632">string</span>&nbsp;<span class="op" id="2397639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397642">if</span>&nbsp;<span class="op" id="2397645">!</span><span class="ident" id="2397646">haveDigits</span>&nbsp;<span class="op" id="2397657">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397661">s</span><span class="op" id="2397662">.</span><span class="ident" id="2397663">notEOF</span><span class="op" id="2397669">(</span><span class="op" id="2397670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397674">if</span>&nbsp;<span class="op" id="2397677">!</span><span class="ident" id="2397678">s</span><span class="op" id="2397679">.</span><span class="ident" id="2397680">accept</span><span class="op" id="2397686">(</span><span class="ident" id="2397687">digits</span><span class="op" id="2397693">)</span>&nbsp;<span class="op" id="2397695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397700">s</span><span class="op" id="2397701">.</span><span class="ident" id="2397702">errorString</span><span class="op" id="2397713">(</span><span class="string" id="2397714">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2397732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397739">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397742">for</span>&nbsp;<span class="ident" id="2397746">s</span><span class="op" id="2397747">.</span><span class="ident" id="2397748">accept</span><span class="op" id="2397754">(</span><span class="ident" id="2397755">digits</span><span class="op" id="2397761">)</span>&nbsp;<span class="op" id="2397763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397769">return</span>&nbsp;<span class="builtintype" id="2397776">string</span><span class="op" id="2397782">(</span><span class="ident" id="2397783">s</span><span class="op" id="2397784">.</span><span class="ident" id="2397785">buf</span><span class="op" id="2397788">)</span><br>
<span class="lineno"></span><span class="op" id="2397790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2397793">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2397847">func</span>&nbsp;<span class="op" id="2397852">(</span><span class="ident" id="2397853">s</span>&nbsp;<span class="op" id="2397855">*</span><span class="ident" id="2397856">ss</span><span class="op" id="2397858">)</span>&nbsp;<span class="ident" id="2397860">scanRune</span><span class="op" id="2397868">(</span><span class="ident" id="2397869">bitSize</span>&nbsp;<span class="builtintype" id="2397877">int</span><span class="op" id="2397880">)</span>&nbsp;<span class="ident" id="2397882">int64</span>&nbsp;<span class="op" id="2397888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397891">s</span><span class="op" id="2397892">.</span><span class="ident" id="2397893">notEOF</span><span class="op" id="2397899">(</span><span class="op" id="2397900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397903">r</span>&nbsp;<span class="op" id="2397905">:=</span>&nbsp;<span class="ident" id="2397908">int64</span><span class="op" id="2397913">(</span><span class="ident" id="2397914">s</span><span class="op" id="2397915">.</span><span class="ident" id="2397916">getRune</span><span class="op" id="2397923">(</span><span class="op" id="2397924">)</span><span class="op" id="2397925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397928">n</span>&nbsp;<span class="op" id="2397930">:=</span>&nbsp;<span class="builtintype" id="2397933">uint</span><span class="op" id="2397937">(</span><span class="ident" id="2397938">bitSize</span><span class="op" id="2397945">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397948">x</span>&nbsp;<span class="op" id="2397950">:=</span>&nbsp;<span class="op" id="2397953">(</span><span class="ident" id="2397954">r</span>&nbsp;<span class="op" id="2397956">&lt;&lt;</span>&nbsp;<span class="op" id="2397959">(</span><span class="num" id="2397960">64</span>&nbsp;<span class="op" id="2397963">-</span>&nbsp;<span class="ident" id="2397965">n</span><span class="op" id="2397966">)</span><span class="op" id="2397967">)</span>&nbsp;<span class="op" id="2397969">&gt;&gt;</span>&nbsp;<span class="op" id="2397972">(</span><span class="num" id="2397973">64</span>&nbsp;<span class="op" id="2397976">-</span>&nbsp;<span class="ident" id="2397978">n</span><span class="op" id="2397979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397982">if</span>&nbsp;<span class="ident" id="2397985">x</span>&nbsp;<span class="op" id="2397987">!=</span>&nbsp;<span class="ident" id="2397990">r</span>&nbsp;<span class="op" id="2397992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397996">s</span><span class="op" id="2397997">.</span><span class="ident" id="2397998">errorString</span><span class="op" id="2398009">(</span><span class="string" id="2398010">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2398041">+</span>&nbsp;<span class="builtintype" id="2398043">string</span><span class="op" id="2398049">(</span><span class="ident" id="2398050">r</span><span class="op" id="2398051">)</span><span class="op" id="2398052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2398055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398058">return</span>&nbsp;<span class="ident" id="2398065">r</span><br>
<span class="lineno">630</span><span class="op" id="2398067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2398070">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2398139">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2398208">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2398248">func</span>&nbsp;<span class="op" id="2398253">(</span><span class="ident" id="2398254">s</span>&nbsp;<span class="op" id="2398256">*</span><span class="ident" id="2398257">ss</span><span class="op" id="2398259">)</span>&nbsp;<span class="ident" id="2398261">scanBasePrefix</span><span class="op" id="2398275">(</span><span class="op" id="2398276">)</span>&nbsp;<span class="op" id="2398278">(</span><span class="ident" id="2398279">base</span>&nbsp;<span class="builtintype" id="2398284">int</span><span class="op" id="2398287">,</span>&nbsp;<span class="ident" id="2398289">digits</span>&nbsp;<span class="builtintype" id="2398296">string</span><span class="op" id="2398302">,</span>&nbsp;<span class="ident" id="2398304">found</span>&nbsp;<span class="builtintype" id="2398310">bool</span><span class="op" id="2398314">)</span>&nbsp;<span class="op" id="2398316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398319">if</span>&nbsp;<span class="op" id="2398322">!</span><span class="ident" id="2398323">s</span><span class="op" id="2398324">.</span><span class="ident" id="2398325">peek</span><span class="op" id="2398329">(</span><span class="string" id="2398330">&#34;0&#34;</span><span class="op" id="2398333">)</span>&nbsp;<span class="op" id="2398335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398339">return</span>&nbsp;<span class="num" id="2398346">10</span><span class="op" id="2398348">,</span>&nbsp;<span class="ident" id="2398350">decimalDigits</span><span class="op" id="2398363">,</span>&nbsp;<span class="builtintype" id="2398365">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2398372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398375">s</span><span class="op" id="2398376">.</span><span class="ident" id="2398377">accept</span><span class="op" id="2398383">(</span><span class="string" id="2398384">&#34;0&#34;</span><span class="op" id="2398387">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398390">found</span>&nbsp;<span class="op" id="2398396">=</span>&nbsp;<span class="builtintype" id="2398398">true</span>&nbsp;<span class="comment" id="2398403">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2398448">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398482">base</span><span class="op" id="2398486">,</span>&nbsp;<span class="ident" id="2398488">digits</span>&nbsp;<span class="op" id="2398495">=</span>&nbsp;<span class="num" id="2398497">8</span><span class="op" id="2398498">,</span>&nbsp;<span class="ident" id="2398500">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398513">if</span>&nbsp;<span class="ident" id="2398516">s</span><span class="op" id="2398517">.</span><span class="ident" id="2398518">peek</span><span class="op" id="2398522">(</span><span class="string" id="2398523">&#34;xX&#34;</span><span class="op" id="2398527">)</span>&nbsp;<span class="op" id="2398529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398533">s</span><span class="op" id="2398534">.</span><span class="ident" id="2398535">consume</span><span class="op" id="2398542">(</span><span class="string" id="2398543">&#34;xX&#34;</span><span class="op" id="2398547">,</span>&nbsp;<span class="builtintype" id="2398549">false</span><span class="op" id="2398554">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398558">base</span><span class="op" id="2398562">,</span>&nbsp;<span class="ident" id="2398564">digits</span>&nbsp;<span class="op" id="2398571">=</span>&nbsp;<span class="num" id="2398573">16</span><span class="op" id="2398575">,</span>&nbsp;<span class="ident" id="2398577">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2398596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398599">return</span><br>
<span class="lineno"></span><span class="op" id="2398606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2398609">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2398677">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2398741">func</span>&nbsp;<span class="op" id="2398746">(</span><span class="ident" id="2398747">s</span>&nbsp;<span class="op" id="2398749">*</span><span class="ident" id="2398750">ss</span><span class="op" id="2398752">)</span>&nbsp;<span class="ident" id="2398754">scanInt</span><span class="op" id="2398761">(</span><span class="ident" id="2398762">verb</span>&nbsp;<span class="builtintype" id="2398767">rune</span><span class="op" id="2398771">,</span>&nbsp;<span class="ident" id="2398773">bitSize</span>&nbsp;<span class="builtintype" id="2398781">int</span><span class="op" id="2398784">)</span>&nbsp;<span class="ident" id="2398786">int64</span>&nbsp;<span class="op" id="2398792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398795">if</span>&nbsp;<span class="ident" id="2398798">verb</span>&nbsp;<span class="op" id="2398803">==</span>&nbsp;<span class="string" id="2398806">&#39;c&#39;</span>&nbsp;<span class="op" id="2398810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398814">return</span>&nbsp;<span class="ident" id="2398821">s</span><span class="op" id="2398822">.</span><span class="ident" id="2398823">scanRune</span><span class="op" id="2398831">(</span><span class="ident" id="2398832">bitSize</span><span class="op" id="2398839">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2398842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398845">s</span><span class="op" id="2398846">.</span><span class="ident" id="2398847">skipSpace</span><span class="op" id="2398856">(</span><span class="builtintype" id="2398857">false</span><span class="op" id="2398862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398865">s</span><span class="op" id="2398866">.</span><span class="ident" id="2398867">notEOF</span><span class="op" id="2398873">(</span><span class="op" id="2398874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398877">base</span><span class="op" id="2398881">,</span>&nbsp;<span class="ident" id="2398883">digits</span>&nbsp;<span class="op" id="2398890">:=</span>&nbsp;<span class="ident" id="2398893">s</span><span class="op" id="2398894">.</span><span class="ident" id="2398895">getBase</span><span class="op" id="2398902">(</span><span class="ident" id="2398903">verb</span><span class="op" id="2398907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2398910">haveDigits</span>&nbsp;<span class="op" id="2398921">:=</span>&nbsp;<span class="builtintype" id="2398924">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398931">if</span>&nbsp;<span class="ident" id="2398934">verb</span>&nbsp;<span class="op" id="2398939">==</span>&nbsp;<span class="string" id="2398942">&#39;U&#39;</span>&nbsp;<span class="op" id="2398946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2398950">if</span>&nbsp;<span class="op" id="2398953">!</span><span class="ident" id="2398954">s</span><span class="op" id="2398955">.</span><span class="ident" id="2398956">consume</span><span class="op" id="2398963">(</span><span class="string" id="2398964">&#34;U&#34;</span><span class="op" id="2398967">,</span>&nbsp;<span class="builtintype" id="2398969">false</span><span class="op" id="2398974">)</span>&nbsp;<span class="op" id="2398976">||</span>&nbsp;<span class="op" id="2398979">!</span><span class="ident" id="2398980">s</span><span class="op" id="2398981">.</span><span class="ident" id="2398982">consume</span><span class="op" id="2398989">(</span><span class="string" id="2398990">&#34;+&#34;</span><span class="op" id="2398993">,</span>&nbsp;<span class="builtintype" id="2398995">false</span><span class="op" id="2399000">)</span>&nbsp;<span class="op" id="2399002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399007">s</span><span class="op" id="2399008">.</span><span class="ident" id="2399009">errorString</span><span class="op" id="2399020">(</span><span class="string" id="2399021">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2399042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399049">}</span>&nbsp;<span class="keyword" id="2399051">else</span>&nbsp;<span class="op" id="2399056">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399060">s</span><span class="op" id="2399061">.</span><span class="ident" id="2399062">accept</span><span class="op" id="2399068">(</span><span class="ident" id="2399069">sign</span><span class="op" id="2399073">)</span>&nbsp;<span class="comment" id="2399075">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399136">if</span>&nbsp;<span class="ident" id="2399139">verb</span>&nbsp;<span class="op" id="2399144">==</span>&nbsp;<span class="string" id="2399147">&#39;v&#39;</span>&nbsp;<span class="op" id="2399151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399156">base</span><span class="op" id="2399160">,</span>&nbsp;<span class="ident" id="2399162">digits</span><span class="op" id="2399168">,</span>&nbsp;<span class="ident" id="2399170">haveDigits</span>&nbsp;<span class="op" id="2399181">=</span>&nbsp;<span class="ident" id="2399183">s</span><span class="op" id="2399184">.</span><span class="ident" id="2399185">scanBasePrefix</span><span class="op" id="2399199">(</span><span class="op" id="2399200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399207">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399210">tok</span>&nbsp;<span class="op" id="2399214">:=</span>&nbsp;<span class="ident" id="2399217">s</span><span class="op" id="2399218">.</span><span class="ident" id="2399219">scanNumber</span><span class="op" id="2399229">(</span><span class="ident" id="2399230">digits</span><span class="op" id="2399236">,</span>&nbsp;<span class="ident" id="2399238">haveDigits</span><span class="op" id="2399248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399251">i</span><span class="op" id="2399252">,</span>&nbsp;<span class="ident" id="2399254">err</span>&nbsp;<span class="op" id="2399258">:=</span>&nbsp;<span class="ident" id="2399261">strconv</span><span class="op" id="2399268">.</span><span class="ident" id="2399269">ParseInt</span><span class="op" id="2399277">(</span><span class="ident" id="2399278">tok</span><span class="op" id="2399281">,</span>&nbsp;<span class="ident" id="2399283">base</span><span class="op" id="2399287">,</span>&nbsp;<span class="num" id="2399289">64</span><span class="op" id="2399291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399294">if</span>&nbsp;<span class="ident" id="2399297">err</span>&nbsp;<span class="op" id="2399301">!=</span>&nbsp;<span class="builtintype" id="2399304">nil</span>&nbsp;<span class="op" id="2399308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399312">s</span><span class="op" id="2399313">.</span><span class="builtintype" id="2399314">error</span><span class="op" id="2399319">(</span><span class="ident" id="2399320">err</span><span class="op" id="2399323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399326">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399329">n</span>&nbsp;<span class="op" id="2399331">:=</span>&nbsp;<span class="builtintype" id="2399334">uint</span><span class="op" id="2399338">(</span><span class="ident" id="2399339">bitSize</span><span class="op" id="2399346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399349">x</span>&nbsp;<span class="op" id="2399351">:=</span>&nbsp;<span class="op" id="2399354">(</span><span class="ident" id="2399355">i</span>&nbsp;<span class="op" id="2399357">&lt;&lt;</span>&nbsp;<span class="op" id="2399360">(</span><span class="num" id="2399361">64</span>&nbsp;<span class="op" id="2399364">-</span>&nbsp;<span class="ident" id="2399366">n</span><span class="op" id="2399367">)</span><span class="op" id="2399368">)</span>&nbsp;<span class="op" id="2399370">&gt;&gt;</span>&nbsp;<span class="op" id="2399373">(</span><span class="num" id="2399374">64</span>&nbsp;<span class="op" id="2399377">-</span>&nbsp;<span class="ident" id="2399379">n</span><span class="op" id="2399380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399383">if</span>&nbsp;<span class="ident" id="2399386">x</span>&nbsp;<span class="op" id="2399388">!=</span>&nbsp;<span class="ident" id="2399391">i</span>&nbsp;<span class="op" id="2399393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399397">s</span><span class="op" id="2399398">.</span><span class="ident" id="2399399">errorString</span><span class="op" id="2399410">(</span><span class="string" id="2399411">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2399440">+</span>&nbsp;<span class="ident" id="2399442">tok</span><span class="op" id="2399445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399448">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399451">return</span>&nbsp;<span class="ident" id="2399458">i</span><br>
<span class="lineno"></span><span class="op" id="2399460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2399463">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2399529">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2399605">func</span>&nbsp;<span class="op" id="2399610">(</span><span class="ident" id="2399611">s</span>&nbsp;<span class="op" id="2399613">*</span><span class="ident" id="2399614">ss</span><span class="op" id="2399616">)</span>&nbsp;<span class="ident" id="2399618">scanUint</span><span class="op" id="2399626">(</span><span class="ident" id="2399627">verb</span>&nbsp;<span class="builtintype" id="2399632">rune</span><span class="op" id="2399636">,</span>&nbsp;<span class="ident" id="2399638">bitSize</span>&nbsp;<span class="builtintype" id="2399646">int</span><span class="op" id="2399649">)</span>&nbsp;<span class="ident" id="2399651">uint64</span>&nbsp;<span class="op" id="2399658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399661">if</span>&nbsp;<span class="ident" id="2399664">verb</span>&nbsp;<span class="op" id="2399669">==</span>&nbsp;<span class="string" id="2399672">&#39;c&#39;</span>&nbsp;<span class="op" id="2399676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399680">return</span>&nbsp;<span class="ident" id="2399687">uint64</span><span class="op" id="2399693">(</span><span class="ident" id="2399694">s</span><span class="op" id="2399695">.</span><span class="ident" id="2399696">scanRune</span><span class="op" id="2399704">(</span><span class="ident" id="2399705">bitSize</span><span class="op" id="2399712">)</span><span class="op" id="2399713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399719">s</span><span class="op" id="2399720">.</span><span class="ident" id="2399721">skipSpace</span><span class="op" id="2399730">(</span><span class="builtintype" id="2399731">false</span><span class="op" id="2399736">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399739">s</span><span class="op" id="2399740">.</span><span class="ident" id="2399741">notEOF</span><span class="op" id="2399747">(</span><span class="op" id="2399748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399751">base</span><span class="op" id="2399755">,</span>&nbsp;<span class="ident" id="2399757">digits</span>&nbsp;<span class="op" id="2399764">:=</span>&nbsp;<span class="ident" id="2399767">s</span><span class="op" id="2399768">.</span><span class="ident" id="2399769">getBase</span><span class="op" id="2399776">(</span><span class="ident" id="2399777">verb</span><span class="op" id="2399781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399784">haveDigits</span>&nbsp;<span class="op" id="2399795">:=</span>&nbsp;<span class="builtintype" id="2399798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399805">if</span>&nbsp;<span class="ident" id="2399808">verb</span>&nbsp;<span class="op" id="2399813">==</span>&nbsp;<span class="string" id="2399816">&#39;U&#39;</span>&nbsp;<span class="op" id="2399820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2399824">if</span>&nbsp;<span class="op" id="2399827">!</span><span class="ident" id="2399828">s</span><span class="op" id="2399829">.</span><span class="ident" id="2399830">consume</span><span class="op" id="2399837">(</span><span class="string" id="2399838">&#34;U&#34;</span><span class="op" id="2399841">,</span>&nbsp;<span class="builtintype" id="2399843">false</span><span class="op" id="2399848">)</span>&nbsp;<span class="op" id="2399850">||</span>&nbsp;<span class="op" id="2399853">!</span><span class="ident" id="2399854">s</span><span class="op" id="2399855">.</span><span class="ident" id="2399856">consume</span><span class="op" id="2399863">(</span><span class="string" id="2399864">&#34;+&#34;</span><span class="op" id="2399867">,</span>&nbsp;<span class="builtintype" id="2399869">false</span><span class="op" id="2399874">)</span>&nbsp;<span class="op" id="2399876">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399881">s</span><span class="op" id="2399882">.</span><span class="ident" id="2399883">errorString</span><span class="op" id="2399894">(</span><span class="string" id="2399895">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2399916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399923">}</span>&nbsp;<span class="keyword" id="2399925">else</span>&nbsp;<span class="keyword" id="2399930">if</span>&nbsp;<span class="ident" id="2399933">verb</span>&nbsp;<span class="op" id="2399938">==</span>&nbsp;<span class="string" id="2399941">&#39;v&#39;</span>&nbsp;<span class="op" id="2399945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399949">base</span><span class="op" id="2399953">,</span>&nbsp;<span class="ident" id="2399955">digits</span><span class="op" id="2399961">,</span>&nbsp;<span class="ident" id="2399963">haveDigits</span>&nbsp;<span class="op" id="2399974">=</span>&nbsp;<span class="ident" id="2399976">s</span><span class="op" id="2399977">.</span><span class="ident" id="2399978">scanBasePrefix</span><span class="op" id="2399992">(</span><span class="op" id="2399993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2399996">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2399999">tok</span>&nbsp;<span class="op" id="2400003">:=</span>&nbsp;<span class="ident" id="2400006">s</span><span class="op" id="2400007">.</span><span class="ident" id="2400008">scanNumber</span><span class="op" id="2400018">(</span><span class="ident" id="2400019">digits</span><span class="op" id="2400025">,</span>&nbsp;<span class="ident" id="2400027">haveDigits</span><span class="op" id="2400037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400040">i</span><span class="op" id="2400041">,</span>&nbsp;<span class="ident" id="2400043">err</span>&nbsp;<span class="op" id="2400047">:=</span>&nbsp;<span class="ident" id="2400050">strconv</span><span class="op" id="2400057">.</span><span class="ident" id="2400058">ParseUint</span><span class="op" id="2400067">(</span><span class="ident" id="2400068">tok</span><span class="op" id="2400071">,</span>&nbsp;<span class="ident" id="2400073">base</span><span class="op" id="2400077">,</span>&nbsp;<span class="num" id="2400079">64</span><span class="op" id="2400081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400084">if</span>&nbsp;<span class="ident" id="2400087">err</span>&nbsp;<span class="op" id="2400091">!=</span>&nbsp;<span class="builtintype" id="2400094">nil</span>&nbsp;<span class="op" id="2400098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400102">s</span><span class="op" id="2400103">.</span><span class="builtintype" id="2400104">error</span><span class="op" id="2400109">(</span><span class="ident" id="2400110">err</span><span class="op" id="2400113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400116">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400119">n</span>&nbsp;<span class="op" id="2400121">:=</span>&nbsp;<span class="builtintype" id="2400124">uint</span><span class="op" id="2400128">(</span><span class="ident" id="2400129">bitSize</span><span class="op" id="2400136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400139">x</span>&nbsp;<span class="op" id="2400141">:=</span>&nbsp;<span class="op" id="2400144">(</span><span class="ident" id="2400145">i</span>&nbsp;<span class="op" id="2400147">&lt;&lt;</span>&nbsp;<span class="op" id="2400150">(</span><span class="num" id="2400151">64</span>&nbsp;<span class="op" id="2400154">-</span>&nbsp;<span class="ident" id="2400156">n</span><span class="op" id="2400157">)</span><span class="op" id="2400158">)</span>&nbsp;<span class="op" id="2400160">&gt;&gt;</span>&nbsp;<span class="op" id="2400163">(</span><span class="num" id="2400164">64</span>&nbsp;<span class="op" id="2400167">-</span>&nbsp;<span class="ident" id="2400169">n</span><span class="op" id="2400170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400173">if</span>&nbsp;<span class="ident" id="2400176">x</span>&nbsp;<span class="op" id="2400178">!=</span>&nbsp;<span class="ident" id="2400181">i</span>&nbsp;<span class="op" id="2400183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400187">s</span><span class="op" id="2400188">.</span><span class="ident" id="2400189">errorString</span><span class="op" id="2400200">(</span><span class="string" id="2400201">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2400239">+</span>&nbsp;<span class="ident" id="2400241">tok</span><span class="op" id="2400244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400247">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400250">return</span>&nbsp;<span class="ident" id="2400257">i</span><br>
<span class="lineno"></span><span class="op" id="2400259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2400262">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2400345">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2400436">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2400492">func</span>&nbsp;<span class="op" id="2400497">(</span><span class="ident" id="2400498">s</span>&nbsp;<span class="op" id="2400500">*</span><span class="ident" id="2400501">ss</span><span class="op" id="2400503">)</span>&nbsp;<span class="ident" id="2400505">floatToken</span><span class="op" id="2400515">(</span><span class="op" id="2400516">)</span>&nbsp;<span class="builtintype" id="2400518">string</span>&nbsp;<span class="op" id="2400525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400528">s</span><span class="op" id="2400529">.</span><span class="ident" id="2400530">buf</span>&nbsp;<span class="op" id="2400534">=</span>&nbsp;<span class="ident" id="2400536">s</span><span class="op" id="2400537">.</span><span class="ident" id="2400538">buf</span><span class="op" id="2400541">[</span><span class="op" id="2400542">:</span><span class="num" id="2400543">0</span><span class="op" id="2400544">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400547">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400556">if</span>&nbsp;<span class="ident" id="2400559">s</span><span class="op" id="2400560">.</span><span class="ident" id="2400561">accept</span><span class="op" id="2400567">(</span><span class="string" id="2400568">&#34;nN&#34;</span><span class="op" id="2400572">)</span>&nbsp;<span class="op" id="2400574">&amp;&amp;</span>&nbsp;<span class="ident" id="2400577">s</span><span class="op" id="2400578">.</span><span class="ident" id="2400579">accept</span><span class="op" id="2400585">(</span><span class="string" id="2400586">&#34;aA&#34;</span><span class="op" id="2400590">)</span>&nbsp;<span class="op" id="2400592">&amp;&amp;</span>&nbsp;<span class="ident" id="2400595">s</span><span class="op" id="2400596">.</span><span class="ident" id="2400597">accept</span><span class="op" id="2400603">(</span><span class="string" id="2400604">&#34;nN&#34;</span><span class="op" id="2400608">)</span>&nbsp;<span class="op" id="2400610">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400614">return</span>&nbsp;<span class="builtintype" id="2400621">string</span><span class="op" id="2400627">(</span><span class="ident" id="2400628">s</span><span class="op" id="2400629">.</span><span class="ident" id="2400630">buf</span><span class="op" id="2400633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400639">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400657">s</span><span class="op" id="2400658">.</span><span class="ident" id="2400659">accept</span><span class="op" id="2400665">(</span><span class="ident" id="2400666">sign</span><span class="op" id="2400670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400673">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400682">if</span>&nbsp;<span class="ident" id="2400685">s</span><span class="op" id="2400686">.</span><span class="ident" id="2400687">accept</span><span class="op" id="2400693">(</span><span class="string" id="2400694">&#34;iI&#34;</span><span class="op" id="2400698">)</span>&nbsp;<span class="op" id="2400700">&amp;&amp;</span>&nbsp;<span class="ident" id="2400703">s</span><span class="op" id="2400704">.</span><span class="ident" id="2400705">accept</span><span class="op" id="2400711">(</span><span class="string" id="2400712">&#34;nN&#34;</span><span class="op" id="2400716">)</span>&nbsp;<span class="op" id="2400718">&amp;&amp;</span>&nbsp;<span class="ident" id="2400721">s</span><span class="op" id="2400722">.</span><span class="ident" id="2400723">accept</span><span class="op" id="2400729">(</span><span class="string" id="2400730">&#34;fF&#34;</span><span class="op" id="2400734">)</span>&nbsp;<span class="op" id="2400736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400740">return</span>&nbsp;<span class="builtintype" id="2400747">string</span><span class="op" id="2400753">(</span><span class="ident" id="2400754">s</span><span class="op" id="2400755">.</span><span class="ident" id="2400756">buf</span><span class="op" id="2400759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400765">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400777">for</span>&nbsp;<span class="ident" id="2400781">s</span><span class="op" id="2400782">.</span><span class="ident" id="2400783">accept</span><span class="op" id="2400789">(</span><span class="ident" id="2400790">decimalDigits</span><span class="op" id="2400803">)</span>&nbsp;<span class="op" id="2400805">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400811">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400830">if</span>&nbsp;<span class="ident" id="2400833">s</span><span class="op" id="2400834">.</span><span class="ident" id="2400835">accept</span><span class="op" id="2400841">(</span><span class="ident" id="2400842">period</span><span class="op" id="2400848">)</span>&nbsp;<span class="op" id="2400850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400854">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400869">for</span>&nbsp;<span class="ident" id="2400873">s</span><span class="op" id="2400874">.</span><span class="ident" id="2400875">accept</span><span class="op" id="2400881">(</span><span class="ident" id="2400882">decimalDigits</span><span class="op" id="2400895">)</span>&nbsp;<span class="op" id="2400897">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2400904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400907">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400921">if</span>&nbsp;<span class="ident" id="2400924">s</span><span class="op" id="2400925">.</span><span class="ident" id="2400926">accept</span><span class="op" id="2400932">(</span><span class="ident" id="2400933">exponent</span><span class="op" id="2400941">)</span>&nbsp;<span class="op" id="2400943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400947">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2400966">s</span><span class="op" id="2400967">.</span><span class="ident" id="2400968">accept</span><span class="op" id="2400974">(</span><span class="ident" id="2400975">sign</span><span class="op" id="2400979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2400983">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2400996">for</span>&nbsp;<span class="ident" id="2401000">s</span><span class="op" id="2401001">.</span><span class="ident" id="2401002">accept</span><span class="op" id="2401008">(</span><span class="ident" id="2401009">decimalDigits</span><span class="op" id="2401022">)</span>&nbsp;<span class="op" id="2401024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401031">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401034">return</span>&nbsp;<span class="builtintype" id="2401041">string</span><span class="op" id="2401047">(</span><span class="ident" id="2401048">s</span><span class="op" id="2401049">.</span><span class="ident" id="2401050">buf</span><span class="op" id="2401053">)</span><br>
<span class="lineno"></span><span class="op" id="2401055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2401058">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2401149">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2401240">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2401282">func</span>&nbsp;<span class="op" id="2401287">(</span><span class="ident" id="2401288">s</span>&nbsp;<span class="op" id="2401290">*</span><span class="ident" id="2401291">ss</span><span class="op" id="2401293">)</span>&nbsp;<span class="ident" id="2401295">complexTokens</span><span class="op" id="2401308">(</span><span class="op" id="2401309">)</span>&nbsp;<span class="op" id="2401311">(</span><span class="builtinfunc" id="2401312">real</span><span class="op" id="2401316">,</span>&nbsp;<span class="builtinfunc" id="2401318">imag</span>&nbsp;<span class="builtintype" id="2401323">string</span><span class="op" id="2401329">)</span>&nbsp;<span class="op" id="2401331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2401334">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401375">parens</span>&nbsp;<span class="op" id="2401382">:=</span>&nbsp;<span class="ident" id="2401385">s</span><span class="op" id="2401386">.</span><span class="ident" id="2401387">accept</span><span class="op" id="2401393">(</span><span class="string" id="2401394">&#34;(&#34;</span><span class="op" id="2401397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2401400">real</span>&nbsp;<span class="op" id="2401405">=</span>&nbsp;<span class="ident" id="2401407">s</span><span class="op" id="2401408">.</span><span class="ident" id="2401409">floatToken</span><span class="op" id="2401419">(</span><span class="op" id="2401420">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401423">s</span><span class="op" id="2401424">.</span><span class="ident" id="2401425">buf</span>&nbsp;<span class="op" id="2401429">=</span>&nbsp;<span class="ident" id="2401431">s</span><span class="op" id="2401432">.</span><span class="ident" id="2401433">buf</span><span class="op" id="2401436">[</span><span class="op" id="2401437">:</span><span class="num" id="2401438">0</span><span class="op" id="2401439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2401442">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401468">if</span>&nbsp;<span class="op" id="2401471">!</span><span class="ident" id="2401472">s</span><span class="op" id="2401473">.</span><span class="ident" id="2401474">accept</span><span class="op" id="2401480">(</span><span class="string" id="2401481">&#34;+-&#34;</span><span class="op" id="2401485">)</span>&nbsp;<span class="op" id="2401487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401491">s</span><span class="op" id="2401492">.</span><span class="builtintype" id="2401493">error</span><span class="op" id="2401498">(</span><span class="ident" id="2401499">complexError</span><span class="op" id="2401511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401514">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2401517">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401543">imagSign</span>&nbsp;<span class="op" id="2401552">:=</span>&nbsp;<span class="builtintype" id="2401555">string</span><span class="op" id="2401561">(</span><span class="ident" id="2401562">s</span><span class="op" id="2401563">.</span><span class="ident" id="2401564">buf</span><span class="op" id="2401567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2401570">imag</span>&nbsp;<span class="op" id="2401575">=</span>&nbsp;<span class="ident" id="2401577">s</span><span class="op" id="2401578">.</span><span class="ident" id="2401579">floatToken</span><span class="op" id="2401589">(</span><span class="op" id="2401590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401593">if</span>&nbsp;<span class="op" id="2401596">!</span><span class="ident" id="2401597">s</span><span class="op" id="2401598">.</span><span class="ident" id="2401599">accept</span><span class="op" id="2401605">(</span><span class="string" id="2401606">&#34;i&#34;</span><span class="op" id="2401609">)</span>&nbsp;<span class="op" id="2401611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401615">s</span><span class="op" id="2401616">.</span><span class="builtintype" id="2401617">error</span><span class="op" id="2401622">(</span><span class="ident" id="2401623">complexError</span><span class="op" id="2401635">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401641">if</span>&nbsp;<span class="ident" id="2401644">parens</span>&nbsp;<span class="op" id="2401651">&amp;&amp;</span>&nbsp;<span class="op" id="2401654">!</span><span class="ident" id="2401655">s</span><span class="op" id="2401656">.</span><span class="ident" id="2401657">accept</span><span class="op" id="2401663">(</span><span class="string" id="2401664">&#34;)&#34;</span><span class="op" id="2401667">)</span>&nbsp;<span class="op" id="2401669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401673">s</span><span class="op" id="2401674">.</span><span class="builtintype" id="2401675">error</span><span class="op" id="2401680">(</span><span class="ident" id="2401681">complexError</span><span class="op" id="2401693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2401696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401699">return</span>&nbsp;<span class="builtinfunc" id="2401706">real</span><span class="op" id="2401710">,</span>&nbsp;<span class="ident" id="2401712">imagSign</span>&nbsp;<span class="op" id="2401721">+</span>&nbsp;<span class="builtinfunc" id="2401723">imag</span><br>
<span class="lineno">770</span><span class="op" id="2401728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2401731">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2401786">func</span>&nbsp;<span class="op" id="2401791">(</span><span class="ident" id="2401792">s</span>&nbsp;<span class="op" id="2401794">*</span><span class="ident" id="2401795">ss</span><span class="op" id="2401797">)</span>&nbsp;<span class="ident" id="2401799">convertFloat</span><span class="op" id="2401811">(</span><span class="ident" id="2401812">str</span>&nbsp;<span class="builtintype" id="2401816">string</span><span class="op" id="2401822">,</span>&nbsp;<span class="ident" id="2401824">n</span>&nbsp;<span class="builtintype" id="2401826">int</span><span class="op" id="2401829">)</span>&nbsp;<span class="builtintype" id="2401831">float64</span>&nbsp;<span class="op" id="2401839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2401842">if</span>&nbsp;<span class="ident" id="2401845">p</span>&nbsp;<span class="op" id="2401847">:=</span>&nbsp;<span class="ident" id="2401850">indexRune</span><span class="op" id="2401859">(</span><span class="ident" id="2401860">str</span><span class="op" id="2401863">,</span>&nbsp;<span class="string" id="2401865">&#39;p&#39;</span><span class="op" id="2401868">)</span><span class="op" id="2401869">;</span>&nbsp;<span class="ident" id="2401871">p</span>&nbsp;<span class="op" id="2401873">&gt;=</span>&nbsp;<span class="num" id="2401876">0</span>&nbsp;<span class="op" id="2401878">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2401882">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2401929">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2401964">f</span><span class="op" id="2401965">,</span>&nbsp;<span class="ident" id="2401967">err</span>&nbsp;<span class="op" id="2401971">:=</span>&nbsp;<span class="ident" id="2401974">strconv</span><span class="op" id="2401981">.</span><span class="ident" id="2401982">ParseFloat</span><span class="op" id="2401992">(</span><span class="ident" id="2401993">str</span><span class="op" id="2401996">[</span><span class="op" id="2401997">:</span><span class="ident" id="2401998">p</span><span class="op" id="2401999">]</span><span class="op" id="2402000">,</span>&nbsp;<span class="ident" id="2402002">n</span><span class="op" id="2402003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402007">if</span>&nbsp;<span class="ident" id="2402010">err</span>&nbsp;<span class="op" id="2402014">!=</span>&nbsp;<span class="builtintype" id="2402017">nil</span>&nbsp;<span class="op" id="2402021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2402026">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402060">if</span>&nbsp;<span class="ident" id="2402063">e</span><span class="op" id="2402064">,</span>&nbsp;<span class="ident" id="2402066">ok</span>&nbsp;<span class="op" id="2402069">:=</span>&nbsp;<span class="ident" id="2402072">err</span><span class="op" id="2402075">.</span><span class="op" id="2402076">(</span><span class="op" id="2402077">*</span><span class="ident" id="2402078">strconv</span><span class="op" id="2402085">.</span><span class="ident" id="2402086">NumError</span><span class="op" id="2402094">)</span><span class="op" id="2402095">;</span>&nbsp;<span class="ident" id="2402097">ok</span>&nbsp;<span class="op" id="2402100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402106">e</span><span class="op" id="2402107">.</span><span class="ident" id="2402108">Num</span>&nbsp;<span class="op" id="2402112">=</span>&nbsp;<span class="ident" id="2402114">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402126">s</span><span class="op" id="2402127">.</span><span class="builtintype" id="2402128">error</span><span class="op" id="2402133">(</span><span class="ident" id="2402134">err</span><span class="op" id="2402137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402141">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402145">m</span><span class="op" id="2402146">,</span>&nbsp;<span class="ident" id="2402148">err</span>&nbsp;<span class="op" id="2402152">:=</span>&nbsp;<span class="ident" id="2402155">strconv</span><span class="op" id="2402162">.</span><span class="ident" id="2402163">Atoi</span><span class="op" id="2402167">(</span><span class="ident" id="2402168">str</span><span class="op" id="2402171">[</span><span class="ident" id="2402172">p</span><span class="op" id="2402173">+</span><span class="num" id="2402174">1</span><span class="op" id="2402175">:</span><span class="op" id="2402176">]</span><span class="op" id="2402177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402181">if</span>&nbsp;<span class="ident" id="2402184">err</span>&nbsp;<span class="op" id="2402188">!=</span>&nbsp;<span class="builtintype" id="2402191">nil</span>&nbsp;<span class="op" id="2402195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2402200">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402234">if</span>&nbsp;<span class="ident" id="2402237">e</span><span class="op" id="2402238">,</span>&nbsp;<span class="ident" id="2402240">ok</span>&nbsp;<span class="op" id="2402243">:=</span>&nbsp;<span class="ident" id="2402246">err</span><span class="op" id="2402249">.</span><span class="op" id="2402250">(</span><span class="op" id="2402251">*</span><span class="ident" id="2402252">strconv</span><span class="op" id="2402259">.</span><span class="ident" id="2402260">NumError</span><span class="op" id="2402268">)</span><span class="op" id="2402269">;</span>&nbsp;<span class="ident" id="2402271">ok</span>&nbsp;<span class="op" id="2402274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402280">e</span><span class="op" id="2402281">.</span><span class="ident" id="2402282">Num</span>&nbsp;<span class="op" id="2402286">=</span>&nbsp;<span class="ident" id="2402288">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402300">s</span><span class="op" id="2402301">.</span><span class="builtintype" id="2402302">error</span><span class="op" id="2402307">(</span><span class="ident" id="2402308">err</span><span class="op" id="2402311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402319">return</span>&nbsp;<span class="ident" id="2402326">math</span><span class="op" id="2402330">.</span><span class="ident" id="2402331">Ldexp</span><span class="op" id="2402336">(</span><span class="ident" id="2402337">f</span><span class="op" id="2402338">,</span>&nbsp;<span class="ident" id="2402340">m</span><span class="op" id="2402341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402344">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402347">f</span><span class="op" id="2402348">,</span>&nbsp;<span class="ident" id="2402350">err</span>&nbsp;<span class="op" id="2402354">:=</span>&nbsp;<span class="ident" id="2402357">strconv</span><span class="op" id="2402364">.</span><span class="ident" id="2402365">ParseFloat</span><span class="op" id="2402375">(</span><span class="ident" id="2402376">str</span><span class="op" id="2402379">,</span>&nbsp;<span class="ident" id="2402381">n</span><span class="op" id="2402382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402385">if</span>&nbsp;<span class="ident" id="2402388">err</span>&nbsp;<span class="op" id="2402392">!=</span>&nbsp;<span class="builtintype" id="2402395">nil</span>&nbsp;<span class="op" id="2402399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402403">s</span><span class="op" id="2402404">.</span><span class="builtintype" id="2402405">error</span><span class="op" id="2402410">(</span><span class="ident" id="2402411">err</span><span class="op" id="2402414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402420">return</span>&nbsp;<span class="ident" id="2402427">f</span><br>
<span class="lineno">800</span><span class="op" id="2402429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2402432">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2402497">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2402569">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2402642">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2402712">func</span>&nbsp;<span class="op" id="2402717">(</span><span class="ident" id="2402718">s</span>&nbsp;<span class="op" id="2402720">*</span><span class="ident" id="2402721">ss</span><span class="op" id="2402723">)</span>&nbsp;<span class="ident" id="2402725">scanComplex</span><span class="op" id="2402736">(</span><span class="ident" id="2402737">verb</span>&nbsp;<span class="builtintype" id="2402742">rune</span><span class="op" id="2402746">,</span>&nbsp;<span class="ident" id="2402748">n</span>&nbsp;<span class="builtintype" id="2402750">int</span><span class="op" id="2402753">)</span>&nbsp;<span class="builtintype" id="2402755">complex128</span>&nbsp;<span class="op" id="2402766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402769">if</span>&nbsp;<span class="op" id="2402772">!</span><span class="ident" id="2402773">s</span><span class="op" id="2402774">.</span><span class="ident" id="2402775">okVerb</span><span class="op" id="2402781">(</span><span class="ident" id="2402782">verb</span><span class="op" id="2402786">,</span>&nbsp;<span class="ident" id="2402788">floatVerbs</span><span class="op" id="2402798">,</span>&nbsp;<span class="string" id="2402800">&#34;complex&#34;</span><span class="op" id="2402809">)</span>&nbsp;<span class="op" id="2402811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402815">return</span>&nbsp;<span class="num" id="2402822">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2402825">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402828">s</span><span class="op" id="2402829">.</span><span class="ident" id="2402830">skipSpace</span><span class="op" id="2402839">(</span><span class="builtintype" id="2402840">false</span><span class="op" id="2402845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402848">s</span><span class="op" id="2402849">.</span><span class="ident" id="2402850">notEOF</span><span class="op" id="2402856">(</span><span class="op" id="2402857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2402860">sreal</span><span class="op" id="2402865">,</span>&nbsp;<span class="ident" id="2402867">simag</span>&nbsp;<span class="op" id="2402873">:=</span>&nbsp;<span class="ident" id="2402876">s</span><span class="op" id="2402877">.</span><span class="ident" id="2402878">complexTokens</span><span class="op" id="2402891">(</span><span class="op" id="2402892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2402895">real</span>&nbsp;<span class="op" id="2402900">:=</span>&nbsp;<span class="ident" id="2402903">s</span><span class="op" id="2402904">.</span><span class="ident" id="2402905">convertFloat</span><span class="op" id="2402917">(</span><span class="ident" id="2402918">sreal</span><span class="op" id="2402923">,</span>&nbsp;<span class="ident" id="2402925">n</span><span class="op" id="2402926">/</span><span class="num" id="2402927">2</span><span class="op" id="2402928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2402931">imag</span>&nbsp;<span class="op" id="2402936">:=</span>&nbsp;<span class="ident" id="2402939">s</span><span class="op" id="2402940">.</span><span class="ident" id="2402941">convertFloat</span><span class="op" id="2402953">(</span><span class="ident" id="2402954">simag</span><span class="op" id="2402959">,</span>&nbsp;<span class="ident" id="2402961">n</span><span class="op" id="2402962">/</span><span class="num" id="2402963">2</span><span class="op" id="2402964">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2402967">return</span>&nbsp;<span class="builtinfunc" id="2402974">complex</span><span class="op" id="2402981">(</span><span class="builtinfunc" id="2402982">real</span><span class="op" id="2402986">,</span>&nbsp;<span class="builtinfunc" id="2402988">imag</span><span class="op" id="2402992">)</span><br>
<span class="lineno"></span><span class="op" id="2402994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2402997">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2403075">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2403129">func</span>&nbsp;<span class="op" id="2403134">(</span><span class="ident" id="2403135">s</span>&nbsp;<span class="op" id="2403137">*</span><span class="ident" id="2403138">ss</span><span class="op" id="2403140">)</span>&nbsp;<span class="ident" id="2403142">convertString</span><span class="op" id="2403155">(</span><span class="ident" id="2403156">verb</span>&nbsp;<span class="builtintype" id="2403161">rune</span><span class="op" id="2403165">)</span>&nbsp;<span class="op" id="2403167">(</span><span class="ident" id="2403168">str</span>&nbsp;<span class="builtintype" id="2403172">string</span><span class="op" id="2403178">)</span>&nbsp;<span class="op" id="2403180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403183">if</span>&nbsp;<span class="op" id="2403186">!</span><span class="ident" id="2403187">s</span><span class="op" id="2403188">.</span><span class="ident" id="2403189">okVerb</span><span class="op" id="2403195">(</span><span class="ident" id="2403196">verb</span><span class="op" id="2403200">,</span>&nbsp;<span class="string" id="2403202">&#34;svqx&#34;</span><span class="op" id="2403208">,</span>&nbsp;<span class="string" id="2403210">&#34;string&#34;</span><span class="op" id="2403218">)</span>&nbsp;<span class="op" id="2403220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403224">return</span>&nbsp;<span class="string" id="2403231">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2403235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403238">s</span><span class="op" id="2403239">.</span><span class="ident" id="2403240">skipSpace</span><span class="op" id="2403249">(</span><span class="builtintype" id="2403250">false</span><span class="op" id="2403255">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403258">s</span><span class="op" id="2403259">.</span><span class="ident" id="2403260">notEOF</span><span class="op" id="2403266">(</span><span class="op" id="2403267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403270">switch</span>&nbsp;<span class="ident" id="2403277">verb</span>&nbsp;<span class="op" id="2403282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403285">case</span>&nbsp;<span class="string" id="2403290">&#39;q&#39;</span><span class="op" id="2403293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403297">str</span>&nbsp;<span class="op" id="2403301">=</span>&nbsp;<span class="ident" id="2403303">s</span><span class="op" id="2403304">.</span><span class="ident" id="2403305">quotedString</span><span class="op" id="2403317">(</span><span class="op" id="2403318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403321">case</span>&nbsp;<span class="string" id="2403326">&#39;x&#39;</span><span class="op" id="2403329">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403333">str</span>&nbsp;<span class="op" id="2403337">=</span>&nbsp;<span class="ident" id="2403339">s</span><span class="op" id="2403340">.</span><span class="ident" id="2403341">hexString</span><span class="op" id="2403350">(</span><span class="op" id="2403351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403354">default</span><span class="op" id="2403361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403365">str</span>&nbsp;<span class="op" id="2403369">=</span>&nbsp;<span class="builtintype" id="2403371">string</span><span class="op" id="2403377">(</span><span class="ident" id="2403378">s</span><span class="op" id="2403379">.</span><span class="ident" id="2403380">token</span><span class="op" id="2403385">(</span><span class="builtintype" id="2403386">true</span><span class="op" id="2403390">,</span>&nbsp;<span class="ident" id="2403392">notSpace</span><span class="op" id="2403400">)</span><span class="op" id="2403401">)</span>&nbsp;<span class="comment" id="2403403">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2403443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403446">return</span><br>
<span class="lineno">835</span><span class="op" id="2403453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2403456">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2403556">func</span>&nbsp;<span class="op" id="2403561">(</span><span class="ident" id="2403562">s</span>&nbsp;<span class="op" id="2403564">*</span><span class="ident" id="2403565">ss</span><span class="op" id="2403567">)</span>&nbsp;<span class="ident" id="2403569">quotedString</span><span class="op" id="2403581">(</span><span class="op" id="2403582">)</span>&nbsp;<span class="builtintype" id="2403584">string</span>&nbsp;<span class="op" id="2403591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403594">s</span><span class="op" id="2403595">.</span><span class="ident" id="2403596">notEOF</span><span class="op" id="2403602">(</span><span class="op" id="2403603">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403606">quote</span>&nbsp;<span class="op" id="2403612">:=</span>&nbsp;<span class="ident" id="2403615">s</span><span class="op" id="2403616">.</span><span class="ident" id="2403617">getRune</span><span class="op" id="2403624">(</span><span class="op" id="2403625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403628">switch</span>&nbsp;<span class="ident" id="2403635">quote</span>&nbsp;<span class="op" id="2403641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403644">case</span>&nbsp;<span class="string" id="2403649">&#39;`&#39;</span><span class="op" id="2403652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2403656">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403713">for</span>&nbsp;<span class="op" id="2403717">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403722">r</span>&nbsp;<span class="op" id="2403724">:=</span>&nbsp;<span class="ident" id="2403727">s</span><span class="op" id="2403728">.</span><span class="ident" id="2403729">mustReadRune</span><span class="op" id="2403741">(</span><span class="op" id="2403742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403747">if</span>&nbsp;<span class="ident" id="2403750">r</span>&nbsp;<span class="op" id="2403752">==</span>&nbsp;<span class="ident" id="2403755">quote</span>&nbsp;<span class="op" id="2403761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403767">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2403776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403781">s</span><span class="op" id="2403782">.</span><span class="ident" id="2403783">buf</span><span class="op" id="2403786">.</span><span class="ident" id="2403787">WriteRune</span><span class="op" id="2403796">(</span><span class="ident" id="2403797">r</span><span class="op" id="2403798">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2403802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403806">return</span>&nbsp;<span class="builtintype" id="2403813">string</span><span class="op" id="2403819">(</span><span class="ident" id="2403820">s</span><span class="op" id="2403821">.</span><span class="ident" id="2403822">buf</span><span class="op" id="2403825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403828">case</span>&nbsp;<span class="string" id="2403833">&#39;&#34;&#39;</span><span class="op" id="2403836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2403840">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403929">s</span><span class="op" id="2403930">.</span><span class="ident" id="2403931">buf</span><span class="op" id="2403934">.</span><span class="ident" id="2403935">WriteRune</span><span class="op" id="2403944">(</span><span class="ident" id="2403945">quote</span><span class="op" id="2403950">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2403954">for</span>&nbsp;<span class="op" id="2403958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403963">r</span>&nbsp;<span class="op" id="2403965">:=</span>&nbsp;<span class="ident" id="2403968">s</span><span class="op" id="2403969">.</span><span class="ident" id="2403970">mustReadRune</span><span class="op" id="2403982">(</span><span class="op" id="2403983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2403988">s</span><span class="op" id="2403989">.</span><span class="ident" id="2403990">buf</span><span class="op" id="2403993">.</span><span class="ident" id="2403994">WriteRune</span><span class="op" id="2404003">(</span><span class="ident" id="2404004">r</span><span class="op" id="2404005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404010">if</span>&nbsp;<span class="ident" id="2404013">r</span>&nbsp;<span class="op" id="2404015">==</span>&nbsp;<span class="string" id="2404018">&#39;\\&#39;</span>&nbsp;<span class="op" id="2404023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2404029">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2404104">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2404176">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404253">s</span><span class="op" id="2404254">.</span><span class="ident" id="2404255">buf</span><span class="op" id="2404258">.</span><span class="ident" id="2404259">WriteRune</span><span class="op" id="2404268">(</span><span class="ident" id="2404269">s</span><span class="op" id="2404270">.</span><span class="ident" id="2404271">mustReadRune</span><span class="op" id="2404283">(</span><span class="op" id="2404284">)</span><span class="op" id="2404285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404290">}</span>&nbsp;<span class="keyword" id="2404292">else</span>&nbsp;<span class="keyword" id="2404297">if</span>&nbsp;<span class="ident" id="2404300">r</span>&nbsp;<span class="op" id="2404302">==</span>&nbsp;<span class="string" id="2404305">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2404309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404315">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404332">result</span><span class="op" id="2404338">,</span>&nbsp;<span class="ident" id="2404340">err</span>&nbsp;<span class="op" id="2404344">:=</span>&nbsp;<span class="ident" id="2404347">strconv</span><span class="op" id="2404354">.</span><span class="ident" id="2404355">Unquote</span><span class="op" id="2404362">(</span><span class="builtintype" id="2404363">string</span><span class="op" id="2404369">(</span><span class="ident" id="2404370">s</span><span class="op" id="2404371">.</span><span class="ident" id="2404372">buf</span><span class="op" id="2404375">)</span><span class="op" id="2404376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404380">if</span>&nbsp;<span class="ident" id="2404383">err</span>&nbsp;<span class="op" id="2404387">!=</span>&nbsp;<span class="builtintype" id="2404390">nil</span>&nbsp;<span class="op" id="2404394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404399">s</span><span class="op" id="2404400">.</span><span class="builtintype" id="2404401">error</span><span class="op" id="2404406">(</span><span class="ident" id="2404407">err</span><span class="op" id="2404410">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404418">return</span>&nbsp;<span class="ident" id="2404425">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404433">default</span><span class="op" id="2404440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404444">s</span><span class="op" id="2404445">.</span><span class="ident" id="2404446">errorString</span><span class="op" id="2404457">(</span><span class="string" id="2404458">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2404482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404485">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404488">return</span>&nbsp;<span class="string" id="2404495">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2404498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2404501">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2404556">func</span>&nbsp;<span class="op" id="2404561">(</span><span class="ident" id="2404562">s</span>&nbsp;<span class="op" id="2404564">*</span><span class="ident" id="2404565">ss</span><span class="op" id="2404567">)</span>&nbsp;<span class="ident" id="2404569">hexDigit</span><span class="op" id="2404577">(</span><span class="ident" id="2404578">d</span>&nbsp;<span class="builtintype" id="2404580">rune</span><span class="op" id="2404584">)</span>&nbsp;<span class="builtintype" id="2404586">int</span>&nbsp;<span class="op" id="2404590">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404593">digit</span>&nbsp;<span class="op" id="2404599">:=</span>&nbsp;<span class="builtintype" id="2404602">int</span><span class="op" id="2404605">(</span><span class="ident" id="2404606">d</span><span class="op" id="2404607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404610">switch</span>&nbsp;<span class="ident" id="2404617">digit</span>&nbsp;<span class="op" id="2404623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404626">case</span>&nbsp;<span class="string" id="2404631">&#39;0&#39;</span><span class="op" id="2404634">,</span>&nbsp;<span class="string" id="2404636">&#39;1&#39;</span><span class="op" id="2404639">,</span>&nbsp;<span class="string" id="2404641">&#39;2&#39;</span><span class="op" id="2404644">,</span>&nbsp;<span class="string" id="2404646">&#39;3&#39;</span><span class="op" id="2404649">,</span>&nbsp;<span class="string" id="2404651">&#39;4&#39;</span><span class="op" id="2404654">,</span>&nbsp;<span class="string" id="2404656">&#39;5&#39;</span><span class="op" id="2404659">,</span>&nbsp;<span class="string" id="2404661">&#39;6&#39;</span><span class="op" id="2404664">,</span>&nbsp;<span class="string" id="2404666">&#39;7&#39;</span><span class="op" id="2404669">,</span>&nbsp;<span class="string" id="2404671">&#39;8&#39;</span><span class="op" id="2404674">,</span>&nbsp;<span class="string" id="2404676">&#39;9&#39;</span><span class="op" id="2404679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404683">return</span>&nbsp;<span class="ident" id="2404690">digit</span>&nbsp;<span class="op" id="2404696">-</span>&nbsp;<span class="string" id="2404698">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404703">case</span>&nbsp;<span class="string" id="2404708">&#39;a&#39;</span><span class="op" id="2404711">,</span>&nbsp;<span class="string" id="2404713">&#39;b&#39;</span><span class="op" id="2404716">,</span>&nbsp;<span class="string" id="2404718">&#39;c&#39;</span><span class="op" id="2404721">,</span>&nbsp;<span class="string" id="2404723">&#39;d&#39;</span><span class="op" id="2404726">,</span>&nbsp;<span class="string" id="2404728">&#39;e&#39;</span><span class="op" id="2404731">,</span>&nbsp;<span class="string" id="2404733">&#39;f&#39;</span><span class="op" id="2404736">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404740">return</span>&nbsp;<span class="num" id="2404747">10</span>&nbsp;<span class="op" id="2404750">+</span>&nbsp;<span class="ident" id="2404752">digit</span>&nbsp;<span class="op" id="2404758">-</span>&nbsp;<span class="string" id="2404760">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404765">case</span>&nbsp;<span class="string" id="2404770">&#39;A&#39;</span><span class="op" id="2404773">,</span>&nbsp;<span class="string" id="2404775">&#39;B&#39;</span><span class="op" id="2404778">,</span>&nbsp;<span class="string" id="2404780">&#39;C&#39;</span><span class="op" id="2404783">,</span>&nbsp;<span class="string" id="2404785">&#39;D&#39;</span><span class="op" id="2404788">,</span>&nbsp;<span class="string" id="2404790">&#39;E&#39;</span><span class="op" id="2404793">,</span>&nbsp;<span class="string" id="2404795">&#39;F&#39;</span><span class="op" id="2404798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404802">return</span>&nbsp;<span class="num" id="2404809">10</span>&nbsp;<span class="op" id="2404812">+</span>&nbsp;<span class="ident" id="2404814">digit</span>&nbsp;<span class="op" id="2404820">-</span>&nbsp;<span class="string" id="2404822">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2404827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2404830">s</span><span class="op" id="2404831">.</span><span class="ident" id="2404832">errorString</span><span class="op" id="2404843">(</span><span class="string" id="2404844">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2404863">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2404866">return</span>&nbsp;<span class="num" id="2404873">0</span><br>
<span class="lineno"></span><span class="op" id="2404875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2404878">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2404955">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2405037">func</span>&nbsp;<span class="op" id="2405042">(</span><span class="ident" id="2405043">s</span>&nbsp;<span class="op" id="2405045">*</span><span class="ident" id="2405046">ss</span><span class="op" id="2405048">)</span>&nbsp;<span class="ident" id="2405050">hexByte</span><span class="op" id="2405057">(</span><span class="op" id="2405058">)</span>&nbsp;<span class="op" id="2405060">(</span><span class="ident" id="2405061">b</span>&nbsp;<span class="builtintype" id="2405063">byte</span><span class="op" id="2405067">,</span>&nbsp;<span class="ident" id="2405069">ok</span>&nbsp;<span class="builtintype" id="2405072">bool</span><span class="op" id="2405076">)</span>&nbsp;<span class="op" id="2405078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405081">rune1</span>&nbsp;<span class="op" id="2405087">:=</span>&nbsp;<span class="ident" id="2405090">s</span><span class="op" id="2405091">.</span><span class="ident" id="2405092">getRune</span><span class="op" id="2405099">(</span><span class="op" id="2405100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405103">if</span>&nbsp;<span class="ident" id="2405106">rune1</span>&nbsp;<span class="op" id="2405112">==</span>&nbsp;<span class="ident" id="2405115">eof</span>&nbsp;<span class="op" id="2405119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405123">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405131">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405134">if</span>&nbsp;<span class="ident" id="2405137">isSpace</span><span class="op" id="2405144">(</span><span class="ident" id="2405145">rune1</span><span class="op" id="2405150">)</span>&nbsp;<span class="op" id="2405152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405156">s</span><span class="op" id="2405157">.</span><span class="ident" id="2405158">UnreadRune</span><span class="op" id="2405168">(</span><span class="op" id="2405169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405173">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405184">rune2</span>&nbsp;<span class="op" id="2405190">:=</span>&nbsp;<span class="ident" id="2405193">s</span><span class="op" id="2405194">.</span><span class="ident" id="2405195">mustReadRune</span><span class="op" id="2405207">(</span><span class="op" id="2405208">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405211">return</span>&nbsp;<span class="builtintype" id="2405218">byte</span><span class="op" id="2405222">(</span><span class="ident" id="2405223">s</span><span class="op" id="2405224">.</span><span class="ident" id="2405225">hexDigit</span><span class="op" id="2405233">(</span><span class="ident" id="2405234">rune1</span><span class="op" id="2405239">)</span><span class="op" id="2405240">&lt;&lt;</span><span class="num" id="2405242">4</span>&nbsp;<span class="op" id="2405244">|</span>&nbsp;<span class="ident" id="2405246">s</span><span class="op" id="2405247">.</span><span class="ident" id="2405248">hexDigit</span><span class="op" id="2405256">(</span><span class="ident" id="2405257">rune2</span><span class="op" id="2405262">)</span><span class="op" id="2405263">)</span><span class="op" id="2405264">,</span>&nbsp;<span class="builtintype" id="2405266">true</span><br>
<span class="lineno"></span><span class="op" id="2405271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2405274">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2405339">func</span>&nbsp;<span class="op" id="2405344">(</span><span class="ident" id="2405345">s</span>&nbsp;<span class="op" id="2405347">*</span><span class="ident" id="2405348">ss</span><span class="op" id="2405350">)</span>&nbsp;<span class="ident" id="2405352">hexString</span><span class="op" id="2405361">(</span><span class="op" id="2405362">)</span>&nbsp;<span class="builtintype" id="2405364">string</span>&nbsp;<span class="op" id="2405371">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405374">s</span><span class="op" id="2405375">.</span><span class="ident" id="2405376">notEOF</span><span class="op" id="2405382">(</span><span class="op" id="2405383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405386">for</span>&nbsp;<span class="op" id="2405390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405394">b</span><span class="op" id="2405395">,</span>&nbsp;<span class="ident" id="2405397">ok</span>&nbsp;<span class="op" id="2405400">:=</span>&nbsp;<span class="ident" id="2405403">s</span><span class="op" id="2405404">.</span><span class="ident" id="2405405">hexByte</span><span class="op" id="2405412">(</span><span class="op" id="2405413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405417">if</span>&nbsp;<span class="op" id="2405420">!</span><span class="ident" id="2405421">ok</span>&nbsp;<span class="op" id="2405424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405429">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405441">s</span><span class="op" id="2405442">.</span><span class="ident" id="2405443">buf</span><span class="op" id="2405446">.</span><span class="ident" id="2405447">WriteByte</span><span class="op" id="2405456">(</span><span class="ident" id="2405457">b</span><span class="op" id="2405458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405464">if</span>&nbsp;<span class="builtinfunc" id="2405467">len</span><span class="op" id="2405470">(</span><span class="ident" id="2405471">s</span><span class="op" id="2405472">.</span><span class="ident" id="2405473">buf</span><span class="op" id="2405476">)</span>&nbsp;<span class="op" id="2405478">==</span>&nbsp;<span class="num" id="2405481">0</span>&nbsp;<span class="op" id="2405483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405487">s</span><span class="op" id="2405488">.</span><span class="ident" id="2405489">errorString</span><span class="op" id="2405500">(</span><span class="string" id="2405501">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2405528">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405532">return</span>&nbsp;<span class="string" id="2405539">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405546">return</span>&nbsp;<span class="builtintype" id="2405553">string</span><span class="op" id="2405559">(</span><span class="ident" id="2405560">s</span><span class="op" id="2405561">.</span><span class="ident" id="2405562">buf</span><span class="op" id="2405565">)</span><br>
<span class="lineno"></span><span class="op" id="2405567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2405570">const</span>&nbsp;<span class="ident" id="2405576">floatVerbs</span>&nbsp;<span class="op" id="2405587">=</span>&nbsp;<span class="string" id="2405589">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2405601">const</span>&nbsp;<span class="ident" id="2405607">hugeWid</span>&nbsp;<span class="op" id="2405615">=</span>&nbsp;<span class="num" id="2405617">1</span>&nbsp;<span class="op" id="2405619">&lt;&lt;</span>&nbsp;<span class="num" id="2405622">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2405626">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2405711">func</span>&nbsp;<span class="op" id="2405716">(</span><span class="ident" id="2405717">s</span>&nbsp;<span class="op" id="2405719">*</span><span class="ident" id="2405720">ss</span><span class="op" id="2405722">)</span>&nbsp;<span class="ident" id="2405724">scanOne</span><span class="op" id="2405731">(</span><span class="ident" id="2405732">verb</span>&nbsp;<span class="builtintype" id="2405737">rune</span><span class="op" id="2405741">,</span>&nbsp;<span class="ident" id="2405743">arg</span>&nbsp;<span class="keyword" id="2405747">interface</span><span class="op" id="2405756">{</span><span class="op" id="2405757">}</span><span class="op" id="2405758">)</span>&nbsp;<span class="op" id="2405760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405763">s</span><span class="op" id="2405764">.</span><span class="ident" id="2405765">buf</span>&nbsp;<span class="op" id="2405769">=</span>&nbsp;<span class="ident" id="2405771">s</span><span class="op" id="2405772">.</span><span class="ident" id="2405773">buf</span><span class="op" id="2405776">[</span><span class="op" id="2405777">:</span><span class="num" id="2405778">0</span><span class="op" id="2405779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405782">var</span>&nbsp;<span class="ident" id="2405786">err</span>&nbsp;<span class="builtintype" id="2405790">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2405797">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405853">if</span>&nbsp;<span class="ident" id="2405856">v</span><span class="op" id="2405857">,</span>&nbsp;<span class="ident" id="2405859">ok</span>&nbsp;<span class="op" id="2405862">:=</span>&nbsp;<span class="ident" id="2405865">arg</span><span class="op" id="2405868">.</span><span class="op" id="2405869">(</span><span class="ident" id="2405870">Scanner</span><span class="op" id="2405877">)</span><span class="op" id="2405878">;</span>&nbsp;<span class="ident" id="2405880">ok</span>&nbsp;<span class="op" id="2405883">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405887">err</span>&nbsp;<span class="op" id="2405891">=</span>&nbsp;<span class="ident" id="2405893">v</span><span class="op" id="2405894">.</span><span class="ident" id="2405895">Scan</span><span class="op" id="2405899">(</span><span class="ident" id="2405900">s</span><span class="op" id="2405901">,</span>&nbsp;<span class="ident" id="2405903">verb</span><span class="op" id="2405907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405911">if</span>&nbsp;<span class="ident" id="2405914">err</span>&nbsp;<span class="op" id="2405918">!=</span>&nbsp;<span class="builtintype" id="2405921">nil</span>&nbsp;<span class="op" id="2405925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2405930">if</span>&nbsp;<span class="ident" id="2405933">err</span>&nbsp;<span class="op" id="2405937">==</span>&nbsp;<span class="ident" id="2405940">io</span><span class="op" id="2405942">.</span><span class="ident" id="2405943">EOF</span>&nbsp;<span class="op" id="2405947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405953">err</span>&nbsp;<span class="op" id="2405957">=</span>&nbsp;<span class="ident" id="2405959">io</span><span class="op" id="2405961">.</span><span class="ident" id="2405962">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2405982">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2405987">s</span><span class="op" id="2405988">.</span><span class="builtintype" id="2405989">error</span><span class="op" id="2405994">(</span><span class="ident" id="2405995">err</span><span class="op" id="2405998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406006">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406018">switch</span>&nbsp;<span class="ident" id="2406025">v</span>&nbsp;<span class="op" id="2406027">:=</span>&nbsp;<span class="ident" id="2406030">arg</span><span class="op" id="2406033">.</span><span class="op" id="2406034">(</span><span class="keyword" id="2406035">type</span><span class="op" id="2406039">)</span>&nbsp;<span class="op" id="2406041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406044">case</span>&nbsp;<span class="op" id="2406049">*</span><span class="builtintype" id="2406050">bool</span><span class="op" id="2406054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406058">*</span><span class="ident" id="2406059">v</span>&nbsp;<span class="op" id="2406061">=</span>&nbsp;<span class="ident" id="2406063">s</span><span class="op" id="2406064">.</span><span class="ident" id="2406065">scanBool</span><span class="op" id="2406073">(</span><span class="ident" id="2406074">verb</span><span class="op" id="2406078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406081">case</span>&nbsp;<span class="op" id="2406086">*</span><span class="builtintype" id="2406087">complex64</span><span class="op" id="2406096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406100">*</span><span class="ident" id="2406101">v</span>&nbsp;<span class="op" id="2406103">=</span>&nbsp;<span class="builtintype" id="2406105">complex64</span><span class="op" id="2406114">(</span><span class="ident" id="2406115">s</span><span class="op" id="2406116">.</span><span class="ident" id="2406117">scanComplex</span><span class="op" id="2406128">(</span><span class="ident" id="2406129">verb</span><span class="op" id="2406133">,</span>&nbsp;<span class="num" id="2406135">64</span><span class="op" id="2406137">)</span><span class="op" id="2406138">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406141">case</span>&nbsp;<span class="op" id="2406146">*</span><span class="builtintype" id="2406147">complex128</span><span class="op" id="2406157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406161">*</span><span class="ident" id="2406162">v</span>&nbsp;<span class="op" id="2406164">=</span>&nbsp;<span class="ident" id="2406166">s</span><span class="op" id="2406167">.</span><span class="ident" id="2406168">scanComplex</span><span class="op" id="2406179">(</span><span class="ident" id="2406180">verb</span><span class="op" id="2406184">,</span>&nbsp;<span class="num" id="2406186">128</span><span class="op" id="2406189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406192">case</span>&nbsp;<span class="op" id="2406197">*</span><span class="builtintype" id="2406198">int</span><span class="op" id="2406201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406205">*</span><span class="ident" id="2406206">v</span>&nbsp;<span class="op" id="2406208">=</span>&nbsp;<span class="builtintype" id="2406210">int</span><span class="op" id="2406213">(</span><span class="ident" id="2406214">s</span><span class="op" id="2406215">.</span><span class="ident" id="2406216">scanInt</span><span class="op" id="2406223">(</span><span class="ident" id="2406224">verb</span><span class="op" id="2406228">,</span>&nbsp;<span class="ident" id="2406230">intBits</span><span class="op" id="2406237">)</span><span class="op" id="2406238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406241">case</span>&nbsp;<span class="op" id="2406246">*</span><span class="builtintype" id="2406247">int8</span><span class="op" id="2406251">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406255">*</span><span class="ident" id="2406256">v</span>&nbsp;<span class="op" id="2406258">=</span>&nbsp;<span class="builtintype" id="2406260">int8</span><span class="op" id="2406264">(</span><span class="ident" id="2406265">s</span><span class="op" id="2406266">.</span><span class="ident" id="2406267">scanInt</span><span class="op" id="2406274">(</span><span class="ident" id="2406275">verb</span><span class="op" id="2406279">,</span>&nbsp;<span class="num" id="2406281">8</span><span class="op" id="2406282">)</span><span class="op" id="2406283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406286">case</span>&nbsp;<span class="op" id="2406291">*</span><span class="builtintype" id="2406292">int16</span><span class="op" id="2406297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406301">*</span><span class="ident" id="2406302">v</span>&nbsp;<span class="op" id="2406304">=</span>&nbsp;<span class="builtintype" id="2406306">int16</span><span class="op" id="2406311">(</span><span class="ident" id="2406312">s</span><span class="op" id="2406313">.</span><span class="ident" id="2406314">scanInt</span><span class="op" id="2406321">(</span><span class="ident" id="2406322">verb</span><span class="op" id="2406326">,</span>&nbsp;<span class="num" id="2406328">16</span><span class="op" id="2406330">)</span><span class="op" id="2406331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406334">case</span>&nbsp;<span class="op" id="2406339">*</span><span class="builtintype" id="2406340">int32</span><span class="op" id="2406345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406349">*</span><span class="ident" id="2406350">v</span>&nbsp;<span class="op" id="2406352">=</span>&nbsp;<span class="builtintype" id="2406354">int32</span><span class="op" id="2406359">(</span><span class="ident" id="2406360">s</span><span class="op" id="2406361">.</span><span class="ident" id="2406362">scanInt</span><span class="op" id="2406369">(</span><span class="ident" id="2406370">verb</span><span class="op" id="2406374">,</span>&nbsp;<span class="num" id="2406376">32</span><span class="op" id="2406378">)</span><span class="op" id="2406379">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406382">case</span>&nbsp;<span class="op" id="2406387">*</span><span class="ident" id="2406388">int64</span><span class="op" id="2406393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406397">*</span><span class="ident" id="2406398">v</span>&nbsp;<span class="op" id="2406400">=</span>&nbsp;<span class="ident" id="2406402">s</span><span class="op" id="2406403">.</span><span class="ident" id="2406404">scanInt</span><span class="op" id="2406411">(</span><span class="ident" id="2406412">verb</span><span class="op" id="2406416">,</span>&nbsp;<span class="num" id="2406418">64</span><span class="op" id="2406420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406423">case</span>&nbsp;<span class="op" id="2406428">*</span><span class="builtintype" id="2406429">uint</span><span class="op" id="2406433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406437">*</span><span class="ident" id="2406438">v</span>&nbsp;<span class="op" id="2406440">=</span>&nbsp;<span class="builtintype" id="2406442">uint</span><span class="op" id="2406446">(</span><span class="ident" id="2406447">s</span><span class="op" id="2406448">.</span><span class="ident" id="2406449">scanUint</span><span class="op" id="2406457">(</span><span class="ident" id="2406458">verb</span><span class="op" id="2406462">,</span>&nbsp;<span class="ident" id="2406464">intBits</span><span class="op" id="2406471">)</span><span class="op" id="2406472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406475">case</span>&nbsp;<span class="op" id="2406480">*</span><span class="builtintype" id="2406481">uint8</span><span class="op" id="2406486">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406490">*</span><span class="ident" id="2406491">v</span>&nbsp;<span class="op" id="2406493">=</span>&nbsp;<span class="builtintype" id="2406495">uint8</span><span class="op" id="2406500">(</span><span class="ident" id="2406501">s</span><span class="op" id="2406502">.</span><span class="ident" id="2406503">scanUint</span><span class="op" id="2406511">(</span><span class="ident" id="2406512">verb</span><span class="op" id="2406516">,</span>&nbsp;<span class="num" id="2406518">8</span><span class="op" id="2406519">)</span><span class="op" id="2406520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406523">case</span>&nbsp;<span class="op" id="2406528">*</span><span class="builtintype" id="2406529">uint16</span><span class="op" id="2406535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406539">*</span><span class="ident" id="2406540">v</span>&nbsp;<span class="op" id="2406542">=</span>&nbsp;<span class="builtintype" id="2406544">uint16</span><span class="op" id="2406550">(</span><span class="ident" id="2406551">s</span><span class="op" id="2406552">.</span><span class="ident" id="2406553">scanUint</span><span class="op" id="2406561">(</span><span class="ident" id="2406562">verb</span><span class="op" id="2406566">,</span>&nbsp;<span class="num" id="2406568">16</span><span class="op" id="2406570">)</span><span class="op" id="2406571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406574">case</span>&nbsp;<span class="op" id="2406579">*</span><span class="builtintype" id="2406580">uint32</span><span class="op" id="2406586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406590">*</span><span class="ident" id="2406591">v</span>&nbsp;<span class="op" id="2406593">=</span>&nbsp;<span class="builtintype" id="2406595">uint32</span><span class="op" id="2406601">(</span><span class="ident" id="2406602">s</span><span class="op" id="2406603">.</span><span class="ident" id="2406604">scanUint</span><span class="op" id="2406612">(</span><span class="ident" id="2406613">verb</span><span class="op" id="2406617">,</span>&nbsp;<span class="num" id="2406619">32</span><span class="op" id="2406621">)</span><span class="op" id="2406622">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406625">case</span>&nbsp;<span class="op" id="2406630">*</span><span class="ident" id="2406631">uint64</span><span class="op" id="2406637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406641">*</span><span class="ident" id="2406642">v</span>&nbsp;<span class="op" id="2406644">=</span>&nbsp;<span class="ident" id="2406646">s</span><span class="op" id="2406647">.</span><span class="ident" id="2406648">scanUint</span><span class="op" id="2406656">(</span><span class="ident" id="2406657">verb</span><span class="op" id="2406661">,</span>&nbsp;<span class="num" id="2406663">64</span><span class="op" id="2406665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406668">case</span>&nbsp;<span class="op" id="2406673">*</span><span class="builtintype" id="2406674">uintptr</span><span class="op" id="2406681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406685">*</span><span class="ident" id="2406686">v</span>&nbsp;<span class="op" id="2406688">=</span>&nbsp;<span class="builtintype" id="2406690">uintptr</span><span class="op" id="2406697">(</span><span class="ident" id="2406698">s</span><span class="op" id="2406699">.</span><span class="ident" id="2406700">scanUint</span><span class="op" id="2406708">(</span><span class="ident" id="2406709">verb</span><span class="op" id="2406713">,</span>&nbsp;<span class="ident" id="2406715">uintptrBits</span><span class="op" id="2406726">)</span><span class="op" id="2406727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406730">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2406813">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406903">case</span>&nbsp;<span class="op" id="2406908">*</span><span class="builtintype" id="2406909">float32</span><span class="op" id="2406916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406920">if</span>&nbsp;<span class="ident" id="2406923">s</span><span class="op" id="2406924">.</span><span class="ident" id="2406925">okVerb</span><span class="op" id="2406931">(</span><span class="ident" id="2406932">verb</span><span class="op" id="2406936">,</span>&nbsp;<span class="ident" id="2406938">floatVerbs</span><span class="op" id="2406948">,</span>&nbsp;<span class="string" id="2406950">&#34;float32&#34;</span><span class="op" id="2406959">)</span>&nbsp;<span class="op" id="2406961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406966">s</span><span class="op" id="2406967">.</span><span class="ident" id="2406968">skipSpace</span><span class="op" id="2406977">(</span><span class="builtintype" id="2406978">false</span><span class="op" id="2406983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406988">s</span><span class="op" id="2406989">.</span><span class="ident" id="2406990">notEOF</span><span class="op" id="2406996">(</span><span class="op" id="2406997">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407002">*</span><span class="ident" id="2407003">v</span>&nbsp;<span class="op" id="2407005">=</span>&nbsp;<span class="builtintype" id="2407007">float32</span><span class="op" id="2407014">(</span><span class="ident" id="2407015">s</span><span class="op" id="2407016">.</span><span class="ident" id="2407017">convertFloat</span><span class="op" id="2407029">(</span><span class="ident" id="2407030">s</span><span class="op" id="2407031">.</span><span class="ident" id="2407032">floatToken</span><span class="op" id="2407042">(</span><span class="op" id="2407043">)</span><span class="op" id="2407044">,</span>&nbsp;<span class="num" id="2407046">32</span><span class="op" id="2407048">)</span><span class="op" id="2407049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407056">case</span>&nbsp;<span class="op" id="2407061">*</span><span class="builtintype" id="2407062">float64</span><span class="op" id="2407069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407073">if</span>&nbsp;<span class="ident" id="2407076">s</span><span class="op" id="2407077">.</span><span class="ident" id="2407078">okVerb</span><span class="op" id="2407084">(</span><span class="ident" id="2407085">verb</span><span class="op" id="2407089">,</span>&nbsp;<span class="ident" id="2407091">floatVerbs</span><span class="op" id="2407101">,</span>&nbsp;<span class="string" id="2407103">&#34;float64&#34;</span><span class="op" id="2407112">)</span>&nbsp;<span class="op" id="2407114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407119">s</span><span class="op" id="2407120">.</span><span class="ident" id="2407121">skipSpace</span><span class="op" id="2407130">(</span><span class="builtintype" id="2407131">false</span><span class="op" id="2407136">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407141">s</span><span class="op" id="2407142">.</span><span class="ident" id="2407143">notEOF</span><span class="op" id="2407149">(</span><span class="op" id="2407150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407155">*</span><span class="ident" id="2407156">v</span>&nbsp;<span class="op" id="2407158">=</span>&nbsp;<span class="ident" id="2407160">s</span><span class="op" id="2407161">.</span><span class="ident" id="2407162">convertFloat</span><span class="op" id="2407174">(</span><span class="ident" id="2407175">s</span><span class="op" id="2407176">.</span><span class="ident" id="2407177">floatToken</span><span class="op" id="2407187">(</span><span class="op" id="2407188">)</span><span class="op" id="2407189">,</span>&nbsp;<span class="num" id="2407191">64</span><span class="op" id="2407193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407200">case</span>&nbsp;<span class="op" id="2407205">*</span><span class="builtintype" id="2407206">string</span><span class="op" id="2407212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407216">*</span><span class="ident" id="2407217">v</span>&nbsp;<span class="op" id="2407219">=</span>&nbsp;<span class="ident" id="2407221">s</span><span class="op" id="2407222">.</span><span class="ident" id="2407223">convertString</span><span class="op" id="2407236">(</span><span class="ident" id="2407237">verb</span><span class="op" id="2407241">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407244">case</span>&nbsp;<span class="op" id="2407249">*</span><span class="op" id="2407250">[</span><span class="op" id="2407251">]</span><span class="builtintype" id="2407252">byte</span><span class="op" id="2407256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2407260">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2407325">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407391">*</span><span class="ident" id="2407392">v</span>&nbsp;<span class="op" id="2407394">=</span>&nbsp;<span class="op" id="2407396">[</span><span class="op" id="2407397">]</span><span class="builtintype" id="2407398">byte</span><span class="op" id="2407402">(</span><span class="ident" id="2407403">s</span><span class="op" id="2407404">.</span><span class="ident" id="2407405">convertString</span><span class="op" id="2407418">(</span><span class="ident" id="2407419">verb</span><span class="op" id="2407423">)</span><span class="op" id="2407424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407427">default</span><span class="op" id="2407434">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407438">val</span>&nbsp;<span class="op" id="2407442">:=</span>&nbsp;<span class="ident" id="2407445">reflect</span><span class="op" id="2407452">.</span><span class="ident" id="2407453">ValueOf</span><span class="op" id="2407460">(</span><span class="ident" id="2407461">v</span><span class="op" id="2407462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407466">ptr</span>&nbsp;<span class="op" id="2407470">:=</span>&nbsp;<span class="ident" id="2407473">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407479">if</span>&nbsp;<span class="ident" id="2407482">ptr</span><span class="op" id="2407485">.</span><span class="ident" id="2407486">Kind</span><span class="op" id="2407490">(</span><span class="op" id="2407491">)</span>&nbsp;<span class="op" id="2407493">!=</span>&nbsp;<span class="ident" id="2407496">reflect</span><span class="op" id="2407503">.</span><span class="ident" id="2407504">Ptr</span>&nbsp;<span class="op" id="2407508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407513">s</span><span class="op" id="2407514">.</span><span class="ident" id="2407515">errorString</span><span class="op" id="2407526">(</span><span class="string" id="2407527">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2407550">+</span>&nbsp;<span class="ident" id="2407552">val</span><span class="op" id="2407555">.</span><span class="ident" id="2407556">Type</span><span class="op" id="2407560">(</span><span class="op" id="2407561">)</span><span class="op" id="2407562">.</span><span class="ident" id="2407563">String</span><span class="op" id="2407569">(</span><span class="op" id="2407570">)</span><span class="op" id="2407571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407576">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407589">switch</span>&nbsp;<span class="ident" id="2407596">v</span>&nbsp;<span class="op" id="2407598">:=</span>&nbsp;<span class="ident" id="2407601">ptr</span><span class="op" id="2407604">.</span><span class="ident" id="2407605">Elem</span><span class="op" id="2407609">(</span><span class="op" id="2407610">)</span><span class="op" id="2407611">;</span>&nbsp;<span class="ident" id="2407613">v</span><span class="op" id="2407614">.</span><span class="ident" id="2407615">Kind</span><span class="op" id="2407619">(</span><span class="op" id="2407620">)</span>&nbsp;<span class="op" id="2407622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407626">case</span>&nbsp;<span class="ident" id="2407631">reflect</span><span class="op" id="2407638">.</span><span class="ident" id="2407639">Bool</span><span class="op" id="2407643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407648">v</span><span class="op" id="2407649">.</span><span class="ident" id="2407650">SetBool</span><span class="op" id="2407657">(</span><span class="ident" id="2407658">s</span><span class="op" id="2407659">.</span><span class="ident" id="2407660">scanBool</span><span class="op" id="2407668">(</span><span class="ident" id="2407669">verb</span><span class="op" id="2407673">)</span><span class="op" id="2407674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407678">case</span>&nbsp;<span class="ident" id="2407683">reflect</span><span class="op" id="2407690">.</span><span class="ident" id="2407691">Int</span><span class="op" id="2407694">,</span>&nbsp;<span class="ident" id="2407696">reflect</span><span class="op" id="2407703">.</span><span class="ident" id="2407704">Int8</span><span class="op" id="2407708">,</span>&nbsp;<span class="ident" id="2407710">reflect</span><span class="op" id="2407717">.</span><span class="ident" id="2407718">Int16</span><span class="op" id="2407723">,</span>&nbsp;<span class="ident" id="2407725">reflect</span><span class="op" id="2407732">.</span><span class="ident" id="2407733">Int32</span><span class="op" id="2407738">,</span>&nbsp;<span class="ident" id="2407740">reflect</span><span class="op" id="2407747">.</span><span class="ident" id="2407748">Int64</span><span class="op" id="2407753">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407758">v</span><span class="op" id="2407759">.</span><span class="ident" id="2407760">SetInt</span><span class="op" id="2407766">(</span><span class="ident" id="2407767">s</span><span class="op" id="2407768">.</span><span class="ident" id="2407769">scanInt</span><span class="op" id="2407776">(</span><span class="ident" id="2407777">verb</span><span class="op" id="2407781">,</span>&nbsp;<span class="ident" id="2407783">v</span><span class="op" id="2407784">.</span><span class="ident" id="2407785">Type</span><span class="op" id="2407789">(</span><span class="op" id="2407790">)</span><span class="op" id="2407791">.</span><span class="ident" id="2407792">Bits</span><span class="op" id="2407796">(</span><span class="op" id="2407797">)</span><span class="op" id="2407798">)</span><span class="op" id="2407799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407803">case</span>&nbsp;<span class="ident" id="2407808">reflect</span><span class="op" id="2407815">.</span><span class="ident" id="2407816">Uint</span><span class="op" id="2407820">,</span>&nbsp;<span class="ident" id="2407822">reflect</span><span class="op" id="2407829">.</span><span class="ident" id="2407830">Uint8</span><span class="op" id="2407835">,</span>&nbsp;<span class="ident" id="2407837">reflect</span><span class="op" id="2407844">.</span><span class="ident" id="2407845">Uint16</span><span class="op" id="2407851">,</span>&nbsp;<span class="ident" id="2407853">reflect</span><span class="op" id="2407860">.</span><span class="ident" id="2407861">Uint32</span><span class="op" id="2407867">,</span>&nbsp;<span class="ident" id="2407869">reflect</span><span class="op" id="2407876">.</span><span class="ident" id="2407877">Uint64</span><span class="op" id="2407883">,</span>&nbsp;<span class="ident" id="2407885">reflect</span><span class="op" id="2407892">.</span><span class="ident" id="2407893">Uintptr</span><span class="op" id="2407900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407905">v</span><span class="op" id="2407906">.</span><span class="ident" id="2407907">SetUint</span><span class="op" id="2407914">(</span><span class="ident" id="2407915">s</span><span class="op" id="2407916">.</span><span class="ident" id="2407917">scanUint</span><span class="op" id="2407925">(</span><span class="ident" id="2407926">verb</span><span class="op" id="2407930">,</span>&nbsp;<span class="ident" id="2407932">v</span><span class="op" id="2407933">.</span><span class="ident" id="2407934">Type</span><span class="op" id="2407938">(</span><span class="op" id="2407939">)</span><span class="op" id="2407940">.</span><span class="ident" id="2407941">Bits</span><span class="op" id="2407945">(</span><span class="op" id="2407946">)</span><span class="op" id="2407947">)</span><span class="op" id="2407948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407952">case</span>&nbsp;<span class="ident" id="2407957">reflect</span><span class="op" id="2407964">.</span><span class="ident" id="2407965">String</span><span class="op" id="2407971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407976">v</span><span class="op" id="2407977">.</span><span class="ident" id="2407978">SetString</span><span class="op" id="2407987">(</span><span class="ident" id="2407988">s</span><span class="op" id="2407989">.</span><span class="ident" id="2407990">convertString</span><span class="op" id="2408003">(</span><span class="ident" id="2408004">verb</span><span class="op" id="2408008">)</span><span class="op" id="2408009">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408013">case</span>&nbsp;<span class="ident" id="2408018">reflect</span><span class="op" id="2408025">.</span><span class="ident" id="2408026">Slice</span><span class="op" id="2408031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408036">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408085">typ</span>&nbsp;<span class="op" id="2408089">:=</span>&nbsp;<span class="ident" id="2408092">v</span><span class="op" id="2408093">.</span><span class="ident" id="2408094">Type</span><span class="op" id="2408098">(</span><span class="op" id="2408099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408104">if</span>&nbsp;<span class="ident" id="2408107">typ</span><span class="op" id="2408110">.</span><span class="ident" id="2408111">Elem</span><span class="op" id="2408115">(</span><span class="op" id="2408116">)</span><span class="op" id="2408117">.</span><span class="ident" id="2408118">Kind</span><span class="op" id="2408122">(</span><span class="op" id="2408123">)</span>&nbsp;<span class="op" id="2408125">!=</span>&nbsp;<span class="ident" id="2408128">reflect</span><span class="op" id="2408135">.</span><span class="ident" id="2408136">Uint8</span>&nbsp;<span class="op" id="2408142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408148">s</span><span class="op" id="2408149">.</span><span class="ident" id="2408150">errorString</span><span class="op" id="2408161">(</span><span class="string" id="2408162">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2408182">+</span>&nbsp;<span class="ident" id="2408184">val</span><span class="op" id="2408187">.</span><span class="ident" id="2408188">Type</span><span class="op" id="2408192">(</span><span class="op" id="2408193">)</span><span class="op" id="2408194">.</span><span class="ident" id="2408195">String</span><span class="op" id="2408201">(</span><span class="op" id="2408202">)</span><span class="op" id="2408203">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408213">str</span>&nbsp;<span class="op" id="2408217">:=</span>&nbsp;<span class="ident" id="2408220">s</span><span class="op" id="2408221">.</span><span class="ident" id="2408222">convertString</span><span class="op" id="2408235">(</span><span class="ident" id="2408236">verb</span><span class="op" id="2408240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408245">v</span><span class="op" id="2408246">.</span><span class="ident" id="2408247">Set</span><span class="op" id="2408250">(</span><span class="ident" id="2408251">reflect</span><span class="op" id="2408258">.</span><span class="ident" id="2408259">MakeSlice</span><span class="op" id="2408268">(</span><span class="ident" id="2408269">typ</span><span class="op" id="2408272">,</span>&nbsp;<span class="builtinfunc" id="2408274">len</span><span class="op" id="2408277">(</span><span class="ident" id="2408278">str</span><span class="op" id="2408281">)</span><span class="op" id="2408282">,</span>&nbsp;<span class="builtinfunc" id="2408284">len</span><span class="op" id="2408287">(</span><span class="ident" id="2408288">str</span><span class="op" id="2408291">)</span><span class="op" id="2408292">)</span><span class="op" id="2408293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408298">for</span>&nbsp;<span class="ident" id="2408302">i</span>&nbsp;<span class="op" id="2408304">:=</span>&nbsp;<span class="num" id="2408307">0</span><span class="op" id="2408308">;</span>&nbsp;<span class="ident" id="2408310">i</span>&nbsp;<span class="op" id="2408312">&lt;</span>&nbsp;<span class="builtinfunc" id="2408314">len</span><span class="op" id="2408317">(</span><span class="ident" id="2408318">str</span><span class="op" id="2408321">)</span><span class="op" id="2408322">;</span>&nbsp;<span class="ident" id="2408324">i</span><span class="op" id="2408325">++</span>&nbsp;<span class="op" id="2408328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408334">v</span><span class="op" id="2408335">.</span><span class="ident" id="2408336">Index</span><span class="op" id="2408341">(</span><span class="ident" id="2408342">i</span><span class="op" id="2408343">)</span><span class="op" id="2408344">.</span><span class="ident" id="2408345">SetUint</span><span class="op" id="2408352">(</span><span class="ident" id="2408353">uint64</span><span class="op" id="2408359">(</span><span class="ident" id="2408360">str</span><span class="op" id="2408363">[</span><span class="ident" id="2408364">i</span><span class="op" id="2408365">]</span><span class="op" id="2408366">)</span><span class="op" id="2408367">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408376">case</span>&nbsp;<span class="ident" id="2408381">reflect</span><span class="op" id="2408388">.</span><span class="ident" id="2408389">Float32</span><span class="op" id="2408396">,</span>&nbsp;<span class="ident" id="2408398">reflect</span><span class="op" id="2408405">.</span><span class="ident" id="2408406">Float64</span><span class="op" id="2408413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408418">s</span><span class="op" id="2408419">.</span><span class="ident" id="2408420">skipSpace</span><span class="op" id="2408429">(</span><span class="builtintype" id="2408430">false</span><span class="op" id="2408435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408440">s</span><span class="op" id="2408441">.</span><span class="ident" id="2408442">notEOF</span><span class="op" id="2408448">(</span><span class="op" id="2408449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408454">v</span><span class="op" id="2408455">.</span><span class="ident" id="2408456">SetFloat</span><span class="op" id="2408464">(</span><span class="ident" id="2408465">s</span><span class="op" id="2408466">.</span><span class="ident" id="2408467">convertFloat</span><span class="op" id="2408479">(</span><span class="ident" id="2408480">s</span><span class="op" id="2408481">.</span><span class="ident" id="2408482">floatToken</span><span class="op" id="2408492">(</span><span class="op" id="2408493">)</span><span class="op" id="2408494">,</span>&nbsp;<span class="ident" id="2408496">v</span><span class="op" id="2408497">.</span><span class="ident" id="2408498">Type</span><span class="op" id="2408502">(</span><span class="op" id="2408503">)</span><span class="op" id="2408504">.</span><span class="ident" id="2408505">Bits</span><span class="op" id="2408509">(</span><span class="op" id="2408510">)</span><span class="op" id="2408511">)</span><span class="op" id="2408512">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408516">case</span>&nbsp;<span class="ident" id="2408521">reflect</span><span class="op" id="2408528">.</span><span class="ident" id="2408529">Complex64</span><span class="op" id="2408538">,</span>&nbsp;<span class="ident" id="2408540">reflect</span><span class="op" id="2408547">.</span><span class="ident" id="2408548">Complex128</span><span class="op" id="2408558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408563">v</span><span class="op" id="2408564">.</span><span class="ident" id="2408565">SetComplex</span><span class="op" id="2408575">(</span><span class="ident" id="2408576">s</span><span class="op" id="2408577">.</span><span class="ident" id="2408578">scanComplex</span><span class="op" id="2408589">(</span><span class="ident" id="2408590">verb</span><span class="op" id="2408594">,</span>&nbsp;<span class="ident" id="2408596">v</span><span class="op" id="2408597">.</span><span class="ident" id="2408598">Type</span><span class="op" id="2408602">(</span><span class="op" id="2408603">)</span><span class="op" id="2408604">.</span><span class="ident" id="2408605">Bits</span><span class="op" id="2408609">(</span><span class="op" id="2408610">)</span><span class="op" id="2408611">)</span><span class="op" id="2408612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408616">default</span><span class="op" id="2408623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408628">s</span><span class="op" id="2408629">.</span><span class="ident" id="2408630">errorString</span><span class="op" id="2408641">(</span><span class="string" id="2408642">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2408662">+</span>&nbsp;<span class="ident" id="2408664">val</span><span class="op" id="2408667">.</span><span class="ident" id="2408668">Type</span><span class="op" id="2408672">(</span><span class="op" id="2408673">)</span><span class="op" id="2408674">.</span><span class="ident" id="2408675">String</span><span class="op" id="2408681">(</span><span class="op" id="2408682">)</span><span class="op" id="2408683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408687">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408690">}</span><br>
<span class="lineno"></span><span class="op" id="2408692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2408695">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2408750">func</span>&nbsp;<span class="ident" id="2408755">errorHandler</span><span class="op" id="2408767">(</span><span class="ident" id="2408768">errp</span>&nbsp;<span class="op" id="2408773">*</span><span class="builtintype" id="2408774">error</span><span class="op" id="2408779">)</span>&nbsp;<span class="op" id="2408781">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408784">if</span>&nbsp;<span class="ident" id="2408787">e</span>&nbsp;<span class="op" id="2408789">:=</span>&nbsp;<span class="builtinfunc" id="2408792">recover</span><span class="op" id="2408799">(</span><span class="op" id="2408800">)</span><span class="op" id="2408801">;</span>&nbsp;<span class="ident" id="2408803">e</span>&nbsp;<span class="op" id="2408805">!=</span>&nbsp;<span class="builtintype" id="2408808">nil</span>&nbsp;<span class="op" id="2408812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408816">if</span>&nbsp;<span class="ident" id="2408819">se</span><span class="op" id="2408821">,</span>&nbsp;<span class="ident" id="2408823">ok</span>&nbsp;<span class="op" id="2408826">:=</span>&nbsp;<span class="ident" id="2408829">e</span><span class="op" id="2408830">.</span><span class="op" id="2408831">(</span><span class="ident" id="2408832">scanError</span><span class="op" id="2408841">)</span><span class="op" id="2408842">;</span>&nbsp;<span class="ident" id="2408844">ok</span>&nbsp;<span class="op" id="2408847">{</span>&nbsp;<span class="comment" id="2408849">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408873">*</span><span class="ident" id="2408874">errp</span>&nbsp;<span class="op" id="2408879">=</span>&nbsp;<span class="ident" id="2408881">se</span><span class="op" id="2408883">.</span><span class="ident" id="2408884">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408890">}</span>&nbsp;<span class="keyword" id="2408892">else</span>&nbsp;<span class="keyword" id="2408897">if</span>&nbsp;<span class="ident" id="2408900">eof</span><span class="op" id="2408903">,</span>&nbsp;<span class="ident" id="2408905">ok</span>&nbsp;<span class="op" id="2408908">:=</span>&nbsp;<span class="ident" id="2408911">e</span><span class="op" id="2408912">.</span><span class="op" id="2408913">(</span><span class="builtintype" id="2408914">error</span><span class="op" id="2408919">)</span><span class="op" id="2408920">;</span>&nbsp;<span class="ident" id="2408922">ok</span>&nbsp;<span class="op" id="2408925">&amp;&amp;</span>&nbsp;<span class="ident" id="2408928">eof</span>&nbsp;<span class="op" id="2408932">==</span>&nbsp;<span class="ident" id="2408935">io</span><span class="op" id="2408937">.</span><span class="ident" id="2408938">EOF</span>&nbsp;<span class="op" id="2408942">{</span>&nbsp;<span class="comment" id="2408944">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408963">*</span><span class="ident" id="2408964">errp</span>&nbsp;<span class="op" id="2408969">=</span>&nbsp;<span class="ident" id="2408971">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408977">}</span>&nbsp;<span class="keyword" id="2408979">else</span>&nbsp;<span class="op" id="2408984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2408989">panic</span><span class="op" id="2408994">(</span><span class="ident" id="2408995">e</span><span class="op" id="2408996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409003">}</span><br>
<span class="lineno"></span><span class="op" id="2409005">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2409008">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2409075">func</span>&nbsp;<span class="op" id="2409080">(</span><span class="ident" id="2409081">s</span>&nbsp;<span class="op" id="2409083">*</span><span class="ident" id="2409084">ss</span><span class="op" id="2409086">)</span>&nbsp;<span class="ident" id="2409088">doScan</span><span class="op" id="2409094">(</span><span class="ident" id="2409095">a</span>&nbsp;<span class="op" id="2409097">[</span><span class="op" id="2409098">]</span><span class="keyword" id="2409099">interface</span><span class="op" id="2409108">{</span><span class="op" id="2409109">}</span><span class="op" id="2409110">)</span>&nbsp;<span class="op" id="2409112">(</span><span class="ident" id="2409113">numProcessed</span>&nbsp;<span class="builtintype" id="2409126">int</span><span class="op" id="2409129">,</span>&nbsp;<span class="ident" id="2409131">err</span>&nbsp;<span class="builtintype" id="2409135">error</span><span class="op" id="2409140">)</span>&nbsp;<span class="op" id="2409142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409145">defer</span>&nbsp;<span class="ident" id="2409151">errorHandler</span><span class="op" id="2409163">(</span><span class="op" id="2409164">&amp;</span><span class="ident" id="2409165">err</span><span class="op" id="2409168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409171">for</span>&nbsp;<span class="ident" id="2409175">_</span><span class="op" id="2409176">,</span>&nbsp;<span class="ident" id="2409178">arg</span>&nbsp;<span class="op" id="2409182">:=</span>&nbsp;<span class="keyword" id="2409185">range</span>&nbsp;<span class="ident" id="2409191">a</span>&nbsp;<span class="op" id="2409193">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409197">s</span><span class="op" id="2409198">.</span><span class="ident" id="2409199">scanOne</span><span class="op" id="2409206">(</span><span class="string" id="2409207">&#39;v&#39;</span><span class="op" id="2409210">,</span>&nbsp;<span class="ident" id="2409212">arg</span><span class="op" id="2409215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409219">numProcessed</span><span class="op" id="2409231">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2409238">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409273">if</span>&nbsp;<span class="op" id="2409276">!</span><span class="ident" id="2409277">s</span><span class="op" id="2409278">.</span><span class="ident" id="2409279">nlIsSpace</span>&nbsp;<span class="op" id="2409289">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409293">for</span>&nbsp;<span class="op" id="2409297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409302">r</span>&nbsp;<span class="op" id="2409304">:=</span>&nbsp;<span class="ident" id="2409307">s</span><span class="op" id="2409308">.</span><span class="ident" id="2409309">getRune</span><span class="op" id="2409316">(</span><span class="op" id="2409317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409322">if</span>&nbsp;<span class="ident" id="2409325">r</span>&nbsp;<span class="op" id="2409327">==</span>&nbsp;<span class="string" id="2409330">&#39;\n&#39;</span>&nbsp;<span class="op" id="2409335">||</span>&nbsp;<span class="ident" id="2409338">r</span>&nbsp;<span class="op" id="2409340">==</span>&nbsp;<span class="ident" id="2409343">eof</span>&nbsp;<span class="op" id="2409347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409353">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409362">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409367">if</span>&nbsp;<span class="op" id="2409370">!</span><span class="ident" id="2409371">isSpace</span><span class="op" id="2409378">(</span><span class="ident" id="2409379">r</span><span class="op" id="2409380">)</span>&nbsp;<span class="op" id="2409382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409388">s</span><span class="op" id="2409389">.</span><span class="ident" id="2409390">errorString</span><span class="op" id="2409401">(</span><span class="string" id="2409402">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2409420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409426">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409439">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409445">return</span><br>
<span class="lineno"></span><span class="op" id="2409452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2409455">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2409524">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2409595">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2409664">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2409734">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2409802">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2409866">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2409924">func</span>&nbsp;<span class="op" id="2409929">(</span><span class="ident" id="2409930">s</span>&nbsp;<span class="op" id="2409932">*</span><span class="ident" id="2409933">ss</span><span class="op" id="2409935">)</span>&nbsp;<span class="ident" id="2409937">advance</span><span class="op" id="2409944">(</span><span class="ident" id="2409945">format</span>&nbsp;<span class="builtintype" id="2409952">string</span><span class="op" id="2409958">)</span>&nbsp;<span class="op" id="2409960">(</span><span class="ident" id="2409961">i</span>&nbsp;<span class="builtintype" id="2409963">int</span><span class="op" id="2409966">)</span>&nbsp;<span class="op" id="2409968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409971">for</span>&nbsp;<span class="ident" id="2409975">i</span>&nbsp;<span class="op" id="2409977">&lt;</span>&nbsp;<span class="builtinfunc" id="2409979">len</span><span class="op" id="2409982">(</span><span class="ident" id="2409983">format</span><span class="op" id="2409989">)</span>&nbsp;<span class="op" id="2409991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409995">fmtc</span><span class="op" id="2409999">,</span>&nbsp;<span class="ident" id="2410001">w</span>&nbsp;<span class="op" id="2410003">:=</span>&nbsp;<span class="ident" id="2410006">utf8</span><span class="op" id="2410010">.</span><span class="ident" id="2410011">DecodeRuneInString</span><span class="op" id="2410029">(</span><span class="ident" id="2410030">format</span><span class="op" id="2410036">[</span><span class="ident" id="2410037">i</span><span class="op" id="2410038">:</span><span class="op" id="2410039">]</span><span class="op" id="2410040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410044">if</span>&nbsp;<span class="ident" id="2410047">fmtc</span>&nbsp;<span class="op" id="2410052">==</span>&nbsp;<span class="string" id="2410055">&#39;%&#39;</span>&nbsp;<span class="op" id="2410059">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410064">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410098">nextc</span><span class="op" id="2410103">,</span>&nbsp;<span class="ident" id="2410105">_</span>&nbsp;<span class="op" id="2410107">:=</span>&nbsp;<span class="ident" id="2410110">utf8</span><span class="op" id="2410114">.</span><span class="ident" id="2410115">DecodeRuneInString</span><span class="op" id="2410133">(</span><span class="ident" id="2410134">format</span><span class="op" id="2410140">[</span><span class="ident" id="2410141">i</span><span class="op" id="2410142">+</span><span class="ident" id="2410143">w</span><span class="op" id="2410144">:</span><span class="op" id="2410145">]</span><span class="op" id="2410146">)</span>&nbsp;<span class="comment" id="2410148">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410190">if</span>&nbsp;<span class="ident" id="2410193">nextc</span>&nbsp;<span class="op" id="2410199">!=</span>&nbsp;<span class="string" id="2410202">&#39;%&#39;</span>&nbsp;<span class="op" id="2410206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410222">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410227">i</span>&nbsp;<span class="op" id="2410229">+=</span>&nbsp;<span class="ident" id="2410232">w</span>&nbsp;<span class="comment" id="2410234">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410260">sawSpace</span>&nbsp;<span class="op" id="2410269">:=</span>&nbsp;<span class="builtintype" id="2410272">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410280">for</span>&nbsp;<span class="ident" id="2410284">isSpace</span><span class="op" id="2410291">(</span><span class="ident" id="2410292">fmtc</span><span class="op" id="2410296">)</span>&nbsp;<span class="op" id="2410298">&amp;&amp;</span>&nbsp;<span class="ident" id="2410301">i</span>&nbsp;<span class="op" id="2410303">&lt;</span>&nbsp;<span class="builtinfunc" id="2410305">len</span><span class="op" id="2410308">(</span><span class="ident" id="2410309">format</span><span class="op" id="2410315">)</span>&nbsp;<span class="op" id="2410317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410322">sawSpace</span>&nbsp;<span class="op" id="2410331">=</span>&nbsp;<span class="builtintype" id="2410333">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410341">i</span>&nbsp;<span class="op" id="2410343">+=</span>&nbsp;<span class="ident" id="2410346">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410351">fmtc</span><span class="op" id="2410355">,</span>&nbsp;<span class="ident" id="2410357">w</span>&nbsp;<span class="op" id="2410359">=</span>&nbsp;<span class="ident" id="2410361">utf8</span><span class="op" id="2410365">.</span><span class="ident" id="2410366">DecodeRuneInString</span><span class="op" id="2410384">(</span><span class="ident" id="2410385">format</span><span class="op" id="2410391">[</span><span class="ident" id="2410392">i</span><span class="op" id="2410393">:</span><span class="op" id="2410394">]</span><span class="op" id="2410395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410403">if</span>&nbsp;<span class="ident" id="2410406">sawSpace</span>&nbsp;<span class="op" id="2410415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410420">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410488">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410508">inputc</span>&nbsp;<span class="op" id="2410515">:=</span>&nbsp;<span class="ident" id="2410518">s</span><span class="op" id="2410519">.</span><span class="ident" id="2410520">getRune</span><span class="op" id="2410527">(</span><span class="op" id="2410528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410533">if</span>&nbsp;<span class="ident" id="2410536">inputc</span>&nbsp;<span class="op" id="2410543">==</span>&nbsp;<span class="ident" id="2410546">eof</span>&nbsp;<span class="op" id="2410550">||</span>&nbsp;<span class="ident" id="2410553">inputc</span>&nbsp;<span class="op" id="2410560">==</span>&nbsp;<span class="string" id="2410563">&#39;\n&#39;</span>&nbsp;<span class="op" id="2410568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410574">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410637">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410652">if</span>&nbsp;<span class="op" id="2410655">!</span><span class="ident" id="2410656">isSpace</span><span class="op" id="2410663">(</span><span class="ident" id="2410664">inputc</span><span class="op" id="2410670">)</span>&nbsp;<span class="op" id="2410672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2410678">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410725">s</span><span class="op" id="2410726">.</span><span class="ident" id="2410727">errorString</span><span class="op" id="2410738">(</span><span class="string" id="2410739">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2410780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410785">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410790">s</span><span class="op" id="2410791">.</span><span class="ident" id="2410792">skipSpace</span><span class="op" id="2410801">(</span><span class="builtintype" id="2410802">true</span><span class="op" id="2410806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410811">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410826">inputc</span>&nbsp;<span class="op" id="2410833">:=</span>&nbsp;<span class="ident" id="2410836">s</span><span class="op" id="2410837">.</span><span class="ident" id="2410838">mustReadRune</span><span class="op" id="2410850">(</span><span class="op" id="2410851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410855">if</span>&nbsp;<span class="ident" id="2410858">fmtc</span>&nbsp;<span class="op" id="2410863">!=</span>&nbsp;<span class="ident" id="2410866">inputc</span>&nbsp;<span class="op" id="2410873">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410878">s</span><span class="op" id="2410879">.</span><span class="ident" id="2410880">UnreadRune</span><span class="op" id="2410890">(</span><span class="op" id="2410891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410896">return</span>&nbsp;<span class="op" id="2410903">-</span><span class="num" id="2410904">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410912">i</span>&nbsp;<span class="op" id="2410914">+=</span>&nbsp;<span class="ident" id="2410917">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410920">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410923">return</span><br>
<span class="lineno"></span><span class="op" id="2410930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2410933">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2410999">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2411059">func</span>&nbsp;<span class="op" id="2411064">(</span><span class="ident" id="2411065">s</span>&nbsp;<span class="op" id="2411067">*</span><span class="ident" id="2411068">ss</span><span class="op" id="2411070">)</span>&nbsp;<span class="ident" id="2411072">doScanf</span><span class="op" id="2411079">(</span><span class="ident" id="2411080">format</span>&nbsp;<span class="builtintype" id="2411087">string</span><span class="op" id="2411093">,</span>&nbsp;<span class="ident" id="2411095">a</span>&nbsp;<span class="op" id="2411097">[</span><span class="op" id="2411098">]</span><span class="keyword" id="2411099">interface</span><span class="op" id="2411108">{</span><span class="op" id="2411109">}</span><span class="op" id="2411110">)</span>&nbsp;<span class="op" id="2411112">(</span><span class="ident" id="2411113">numProcessed</span>&nbsp;<span class="builtintype" id="2411126">int</span><span class="op" id="2411129">,</span>&nbsp;<span class="ident" id="2411131">err</span>&nbsp;<span class="builtintype" id="2411135">error</span><span class="op" id="2411140">)</span>&nbsp;<span class="op" id="2411142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411145">defer</span>&nbsp;<span class="ident" id="2411151">errorHandler</span><span class="op" id="2411163">(</span><span class="op" id="2411164">&amp;</span><span class="ident" id="2411165">err</span><span class="op" id="2411168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411171">end</span>&nbsp;<span class="op" id="2411175">:=</span>&nbsp;<span class="builtinfunc" id="2411178">len</span><span class="op" id="2411181">(</span><span class="ident" id="2411182">format</span><span class="op" id="2411188">)</span>&nbsp;<span class="op" id="2411190">-</span>&nbsp;<span class="num" id="2411192">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411195">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411242">for</span>&nbsp;<span class="ident" id="2411246">i</span>&nbsp;<span class="op" id="2411248">:=</span>&nbsp;<span class="num" id="2411251">0</span><span class="op" id="2411252">;</span>&nbsp;<span class="ident" id="2411254">i</span>&nbsp;<span class="op" id="2411256">&lt;=</span>&nbsp;<span class="ident" id="2411259">end</span><span class="op" id="2411262">;</span>&nbsp;<span class="op" id="2411264">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411268">w</span>&nbsp;<span class="op" id="2411270">:=</span>&nbsp;<span class="ident" id="2411273">s</span><span class="op" id="2411274">.</span><span class="ident" id="2411275">advance</span><span class="op" id="2411282">(</span><span class="ident" id="2411283">format</span><span class="op" id="2411289">[</span><span class="ident" id="2411290">i</span><span class="op" id="2411291">:</span><span class="op" id="2411292">]</span><span class="op" id="2411293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411297">if</span>&nbsp;<span class="ident" id="2411300">w</span>&nbsp;<span class="op" id="2411302">&gt;</span>&nbsp;<span class="num" id="2411304">0</span>&nbsp;<span class="op" id="2411306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411311">i</span>&nbsp;<span class="op" id="2411313">+=</span>&nbsp;<span class="ident" id="2411316">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411321">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411332">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411336">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411423">if</span>&nbsp;<span class="ident" id="2411426">format</span><span class="op" id="2411432">[</span><span class="ident" id="2411433">i</span><span class="op" id="2411434">]</span>&nbsp;<span class="op" id="2411436">!=</span>&nbsp;<span class="string" id="2411439">&#39;%&#39;</span>&nbsp;<span class="op" id="2411443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411448">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411486">if</span>&nbsp;<span class="ident" id="2411489">w</span>&nbsp;<span class="op" id="2411491">&lt;</span>&nbsp;<span class="num" id="2411493">0</span>&nbsp;<span class="op" id="2411495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411501">s</span><span class="op" id="2411502">.</span><span class="ident" id="2411503">errorString</span><span class="op" id="2411514">(</span><span class="string" id="2411515">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2411544">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411554">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411618">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411630">i</span><span class="op" id="2411631">++</span>&nbsp;<span class="comment" id="2411634">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2411654">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411682">var</span>&nbsp;<span class="ident" id="2411686">widPresent</span>&nbsp;<span class="builtintype" id="2411697">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411704">s</span><span class="op" id="2411705">.</span><span class="ident" id="2411706">maxWid</span><span class="op" id="2411712">,</span>&nbsp;<span class="ident" id="2411714">widPresent</span><span class="op" id="2411724">,</span>&nbsp;<span class="ident" id="2411726">i</span>&nbsp;<span class="op" id="2411728">=</span>&nbsp;<span class="ident" id="2411730">parsenum</span><span class="op" id="2411738">(</span><span class="ident" id="2411739">format</span><span class="op" id="2411745">,</span>&nbsp;<span class="ident" id="2411747">i</span><span class="op" id="2411748">,</span>&nbsp;<span class="ident" id="2411750">end</span><span class="op" id="2411753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411757">if</span>&nbsp;<span class="op" id="2411760">!</span><span class="ident" id="2411761">widPresent</span>&nbsp;<span class="op" id="2411772">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411777">s</span><span class="op" id="2411778">.</span><span class="ident" id="2411779">maxWid</span>&nbsp;<span class="op" id="2411786">=</span>&nbsp;<span class="ident" id="2411788">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411802">s</span><span class="op" id="2411803">.</span><span class="ident" id="2411804">argLimit</span>&nbsp;<span class="op" id="2411813">=</span>&nbsp;<span class="ident" id="2411815">s</span><span class="op" id="2411816">.</span><span class="ident" id="2411817">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411825">if</span>&nbsp;<span class="ident" id="2411828">f</span>&nbsp;<span class="op" id="2411830">:=</span>&nbsp;<span class="ident" id="2411833">s</span><span class="op" id="2411834">.</span><span class="ident" id="2411835">count</span>&nbsp;<span class="op" id="2411841">+</span>&nbsp;<span class="ident" id="2411843">s</span><span class="op" id="2411844">.</span><span class="ident" id="2411845">maxWid</span><span class="op" id="2411851">;</span>&nbsp;<span class="ident" id="2411853">f</span>&nbsp;<span class="op" id="2411855">&lt;</span>&nbsp;<span class="ident" id="2411857">s</span><span class="op" id="2411858">.</span><span class="ident" id="2411859">argLimit</span>&nbsp;<span class="op" id="2411868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411873">s</span><span class="op" id="2411874">.</span><span class="ident" id="2411875">argLimit</span>&nbsp;<span class="op" id="2411884">=</span>&nbsp;<span class="ident" id="2411886">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411895">c</span><span class="op" id="2411896">,</span>&nbsp;<span class="ident" id="2411898">w</span>&nbsp;<span class="op" id="2411900">:=</span>&nbsp;<span class="ident" id="2411903">utf8</span><span class="op" id="2411907">.</span><span class="ident" id="2411908">DecodeRuneInString</span><span class="op" id="2411926">(</span><span class="ident" id="2411927">format</span><span class="op" id="2411933">[</span><span class="ident" id="2411934">i</span><span class="op" id="2411935">:</span><span class="op" id="2411936">]</span><span class="op" id="2411937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411941">i</span>&nbsp;<span class="op" id="2411943">+=</span>&nbsp;<span class="ident" id="2411946">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411951">if</span>&nbsp;<span class="ident" id="2411954">numProcessed</span>&nbsp;<span class="op" id="2411967">&gt;=</span>&nbsp;<span class="builtinfunc" id="2411970">len</span><span class="op" id="2411973">(</span><span class="ident" id="2411974">a</span><span class="op" id="2411975">)</span>&nbsp;<span class="op" id="2411977">{</span>&nbsp;<span class="comment" id="2411979">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412001">s</span><span class="op" id="2412002">.</span><span class="ident" id="2412003">errorString</span><span class="op" id="2412014">(</span><span class="string" id="2412015">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2412047">+</span>&nbsp;<span class="ident" id="2412049">format</span><span class="op" id="2412055">[</span><span class="ident" id="2412056">i</span><span class="op" id="2412057">-</span><span class="ident" id="2412058">w</span><span class="op" id="2412059">:</span><span class="op" id="2412060">]</span><span class="op" id="2412061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412066">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412078">arg</span>&nbsp;<span class="op" id="2412082">:=</span>&nbsp;<span class="ident" id="2412085">a</span><span class="op" id="2412086">[</span><span class="ident" id="2412087">numProcessed</span><span class="op" id="2412099">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412104">s</span><span class="op" id="2412105">.</span><span class="ident" id="2412106">scanOne</span><span class="op" id="2412113">(</span><span class="ident" id="2412114">c</span><span class="op" id="2412115">,</span>&nbsp;<span class="ident" id="2412117">arg</span><span class="op" id="2412120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412124">numProcessed</span><span class="op" id="2412136">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412141">s</span><span class="op" id="2412142">.</span><span class="ident" id="2412143">argLimit</span>&nbsp;<span class="op" id="2412152">=</span>&nbsp;<span class="ident" id="2412154">s</span><span class="op" id="2412155">.</span><span class="ident" id="2412156">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412163">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412166">if</span>&nbsp;<span class="ident" id="2412169">numProcessed</span>&nbsp;<span class="op" id="2412182">&lt;</span>&nbsp;<span class="builtinfunc" id="2412184">len</span><span class="op" id="2412187">(</span><span class="ident" id="2412188">a</span><span class="op" id="2412189">)</span>&nbsp;<span class="op" id="2412191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412195">s</span><span class="op" id="2412196">.</span><span class="ident" id="2412197">errorString</span><span class="op" id="2412208">(</span><span class="string" id="2412209">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2412228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412234">return</span><br>
<span class="lineno"></span><span class="op" id="2412241">}</span>
</div>
</body>
</html>
