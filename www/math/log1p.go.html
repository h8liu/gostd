<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2343017">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2343072">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2343126">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2343177">package</span>&nbsp;<span class="ident" id="2343185">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2343191">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2343251">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_log1p.c</span><br>
<span class="lineno"></span><span class="comment" id="2343311">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="2343370">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="2343400">//</span><br>
<span class="lineno"></span><span class="comment" id="2343403">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2343459">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2343528">//</span><br>
<span class="lineno">15</span><span class="comment" id="2343531">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="2343590">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2343646">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2343703">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2343720">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="2343776">//</span><br>
<span class="lineno"></span><span class="comment" id="2343779">//</span><br>
<span class="lineno"></span><span class="comment" id="2343782">//&nbsp;double&nbsp;log1p(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2343808">//</span><br>
<span class="lineno"></span><span class="comment" id="2343811">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno">25</span><span class="comment" id="2343823">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction:&nbsp;find&nbsp;k&nbsp;and&nbsp;f&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2343874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+x&nbsp;=&nbsp;2**k&nbsp;*&nbsp;(1+f),</span><br>
<span class="lineno"></span><span class="comment" id="2343918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;sqrt(2)/2&nbsp;&lt;&nbsp;1+f&nbsp;&lt;&nbsp;sqrt(2)&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="2343964">//</span><br>
<span class="lineno"></span><span class="comment" id="2343967">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;If&nbsp;k=0,&nbsp;then&nbsp;f=x&nbsp;is&nbsp;exact.&nbsp;However,&nbsp;if&nbsp;k!=0,&nbsp;then&nbsp;f</span><br>
<span class="lineno">30</span><span class="comment" id="2344033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;not&nbsp;be&nbsp;representable&nbsp;exactly.&nbsp;In&nbsp;that&nbsp;case,&nbsp;a&nbsp;correction</span><br>
<span class="lineno"></span><span class="comment" id="2344102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term&nbsp;is&nbsp;need.&nbsp;Let&nbsp;u=1+x&nbsp;rounded.&nbsp;Let&nbsp;c&nbsp;=&nbsp;(1+x)-u,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="2344165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(1+x)&nbsp;-&nbsp;log(u)&nbsp;~&nbsp;c/u.&nbsp;Thus,&nbsp;we&nbsp;proceed&nbsp;to&nbsp;compute&nbsp;log(u),</span><br>
<span class="lineno"></span><span class="comment" id="2344234">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;add&nbsp;back&nbsp;the&nbsp;correction&nbsp;term&nbsp;c/u.</span><br>
<span class="lineno"></span><span class="comment" id="2344280">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;when&nbsp;x&nbsp;&gt;&nbsp;2**53,&nbsp;one&nbsp;can&nbsp;simply&nbsp;return&nbsp;log(x))</span><br>
<span class="lineno">35</span><span class="comment" id="2344341">//</span><br>
<span class="lineno"></span><span class="comment" id="2344344">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="2344379">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s&nbsp;=&nbsp;f/(2+f)&nbsp;;&nbsp;based&nbsp;on&nbsp;log(1+f)&nbsp;=&nbsp;log(1+s)&nbsp;-&nbsp;log(1-s)</span><br>
<span class="lineno"></span><span class="comment" id="2344445">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;2/3&nbsp;s**3&nbsp;+&nbsp;2/5&nbsp;s**5&nbsp;+&nbsp;.....,</span><br>
<span class="lineno"></span><span class="comment" id="2344498">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;s*R</span><br>
<span class="lineno">40</span><span class="comment" id="2344526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Reme&nbsp;algorithm&nbsp;on&nbsp;[0,0.1716]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2344592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;14&nbsp;to&nbsp;approximate&nbsp;R&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2344661">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-58.45.&nbsp;In</span><br>
<span class="lineno"></span><span class="comment" id="2344730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2344751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</span><br>
<span class="lineno">45</span><span class="comment" id="2344822">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;Lp1*s&nbsp;+Lp2*s&nbsp;+Lp3*s&nbsp;+Lp4*s&nbsp;+Lp5*s&nbsp;&nbsp;+Lp6*s&nbsp;&nbsp;+Lp7*s</span><br>
<span class="lineno"></span><span class="comment" id="2344891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the&nbsp;values&nbsp;of&nbsp;Lp1&nbsp;to&nbsp;Lp7&nbsp;are&nbsp;listed&nbsp;in&nbsp;the&nbsp;program)</span><br>
<span class="lineno"></span><span class="comment" id="2344952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2344964">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-58.45</span><br>
<span class="lineno"></span><span class="comment" id="2345019">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Lp1*s&nbsp;+...+Lp7*s&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno">50</span><span class="comment" id="2345068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2345112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;2s&nbsp;=&nbsp;f&nbsp;-&nbsp;s*f&nbsp;=&nbsp;f&nbsp;-&nbsp;hfsq&nbsp;+&nbsp;s*hfsq,&nbsp;where&nbsp;hfsq&nbsp;=&nbsp;f*f/2.</span><br>
<span class="lineno"></span><span class="comment" id="2345184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;guarantee&nbsp;error&nbsp;in&nbsp;log&nbsp;below&nbsp;1ulp,&nbsp;we&nbsp;compute&nbsp;log</span><br>
<span class="lineno"></span><span class="comment" id="2345254">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2345265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(f)&nbsp;=&nbsp;f&nbsp;-&nbsp;(hfsq&nbsp;-&nbsp;s*(hfsq+R)).</span><br>
<span class="lineno">55</span><span class="comment" id="2345317">//</span><br>
<span class="lineno"></span><span class="comment" id="2345320">//&nbsp;&nbsp;&nbsp;3.&nbsp;Finally,&nbsp;log1p(x)&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="2345366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span><br>
<span class="lineno"></span><span class="comment" id="2345436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;ln2&nbsp;is&nbsp;split&nbsp;into&nbsp;two&nbsp;floating&nbsp;point&nbsp;number:</span><br>
<span class="lineno"></span><span class="comment" id="2345494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ln2_hi&nbsp;+&nbsp;ln2_lo,</span><br>
<span class="lineno">60</span><span class="comment" id="2345532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;n*ln2_hi&nbsp;is&nbsp;always&nbsp;exact&nbsp;for&nbsp;|n|&nbsp;&lt;&nbsp;2000.</span><br>
<span class="lineno"></span><span class="comment" id="2345587">//</span><br>
<span class="lineno"></span><span class="comment" id="2345590">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2345608">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(x)&nbsp;is&nbsp;NaN&nbsp;with&nbsp;signal&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-1&nbsp;(including&nbsp;-INF)&nbsp;;</span><br>
<span class="lineno"></span><span class="comment" id="2345673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(+INF)&nbsp;is&nbsp;+INF;&nbsp;log1p(-1)&nbsp;is&nbsp;-INF&nbsp;with&nbsp;signal;</span><br>
<span class="lineno">65</span><span class="comment" id="2345733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2345780">//</span><br>
<span class="lineno"></span><span class="comment" id="2345783">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2345796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2345866">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">70</span><span class="comment" id="2345906">//</span><br>
<span class="lineno"></span><span class="comment" id="2345909">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2345923">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2345989">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2346053">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">75</span><span class="comment" id="2346119">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><span class="comment" id="2346163">//</span><br>
<span class="lineno"></span><span class="comment" id="2346166">//&nbsp;Note:&nbsp;Assuming&nbsp;log()&nbsp;return&nbsp;accurate&nbsp;answer,&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2346228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;algorithm&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;compute&nbsp;log1p(x)&nbsp;to&nbsp;within&nbsp;a&nbsp;few&nbsp;ULP:</span><br>
<span class="lineno"></span><span class="comment" id="2346300">//</span><br>
<span class="lineno">80</span><span class="comment" id="2346303">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;1+x;</span><br>
<span class="lineno"></span><span class="comment" id="2346328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(u==1.0)&nbsp;return&nbsp;x&nbsp;;&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2346371">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log(u)*(x/(u-1.0));</span><br>
<span class="lineno"></span><span class="comment" id="2346425">//</span><br>
<span class="lineno"></span><span class="comment" id="2346428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;HP-15C&nbsp;Advanced&nbsp;Functions&nbsp;Handbook,&nbsp;p.193.</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="2346485">//&nbsp;Log1p&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;of&nbsp;1&nbsp;plus&nbsp;its&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2346550">//&nbsp;It&nbsp;is&nbsp;more&nbsp;accurate&nbsp;than&nbsp;Log(1&nbsp;+&nbsp;x)&nbsp;when&nbsp;x&nbsp;is&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="2346610">//</span><br>
<span class="lineno"></span><span class="comment" id="2346613">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">90</span><span class="comment" id="2346635">//&nbsp;&nbsp;&nbsp;&nbspLog1p(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2346657">//&nbsp;&nbsp;&nbsp;&nbspLog1p(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2346677">//&nbsp;&nbsp;&nbsp;&nbspLog1p(-1)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2346697">//&nbsp;&nbsp;&nbsp;&nbspLog1p(x&nbsp;&lt;&nbsp;-1)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2346720">//&nbsp;&nbsp;&nbsp;&nbspLog1p(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">95</span><span class="keyword" id="2346740">func</span>&nbsp;<span class="ident" id="2346745">Log1p</span><span class="op" id="2346750">(</span><span class="ident" id="2346751">x</span>&nbsp;<span class="builtintype" id="2346753">float64</span><span class="op" id="2346760">)</span>&nbsp;<span class="builtintype" id="2346762">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2346771">func</span>&nbsp;<span class="ident" id="2346776">log1p</span><span class="op" id="2346781">(</span><span class="ident" id="2346782">x</span>&nbsp;<span class="builtintype" id="2346784">float64</span><span class="op" id="2346791">)</span>&nbsp;<span class="builtintype" id="2346793">float64</span>&nbsp;<span class="op" id="2346801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2346804">const</span>&nbsp;<span class="op" id="2346810">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2346814">Sqrt2M1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346826">=</span>&nbsp;<span class="num" id="2346828">4.142135623730950488017e-01</span>&nbsp;&nbsp;<span class="comment" id="2346857">//&nbsp;Sqrt(2)-1&nbsp;=&nbsp;0x3fda827999fcef34</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2346893">Sqrt2HalfM1</span>&nbsp;<span class="op" id="2346905">=</span>&nbsp;<span class="op" id="2346907">-</span><span class="num" id="2346908">2.928932188134524755992e-01</span>&nbsp;<span class="comment" id="2346936">//&nbsp;Sqrt(2)/2-1&nbsp;=&nbsp;0xbfd2bec333018866</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2346974">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346986">=</span>&nbsp;<span class="num" id="2346988">1.0</span>&nbsp;<span class="op" id="2346992">/</span>&nbsp;<span class="op" id="2346994">(</span><span class="num" id="2346995">1</span>&nbsp;<span class="op" id="2346997">&lt;&lt;</span>&nbsp;<span class="num" id="2347000">29</span><span class="op" id="2347002">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347017">//&nbsp;2**-29&nbsp;=&nbsp;0x3e20000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347050">Tiny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347062">=</span>&nbsp;<span class="num" id="2347064">1.0</span>&nbsp;<span class="op" id="2347068">/</span>&nbsp;<span class="op" id="2347070">(</span><span class="num" id="2347071">1</span>&nbsp;<span class="op" id="2347073">&lt;&lt;</span>&nbsp;<span class="num" id="2347076">54</span><span class="op" id="2347078">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347093">//&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347105">Two53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347117">=</span>&nbsp;<span class="num" id="2347119">1</span>&nbsp;<span class="op" id="2347121">&lt;&lt;</span>&nbsp;<span class="num" id="2347124">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347148">//&nbsp;2**53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347159">Ln2Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347171">=</span>&nbsp;<span class="num" id="2347173">6.93147180369123816490e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2347202">//&nbsp;3fe62e42fee00000</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347224">Ln2Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347236">=</span>&nbsp;<span class="num" id="2347238">1.90821492927058770002e-10</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2347267">//&nbsp;3dea39ef35793c76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347289">Lp1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347301">=</span>&nbsp;<span class="num" id="2347303">6.666666666666735130e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347332">//&nbsp;3FE5555555555593</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347354">Lp2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347366">=</span>&nbsp;<span class="num" id="2347368">3.999999999940941908e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347397">//&nbsp;3FD999999997FA04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347419">Lp3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347431">=</span>&nbsp;<span class="num" id="2347433">2.857142874366239149e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347462">//&nbsp;3FD2492494229359</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347484">Lp4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347496">=</span>&nbsp;<span class="num" id="2347498">2.222219843214978396e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347527">//&nbsp;3FCC71C51D8E78AF</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347549">Lp5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347561">=</span>&nbsp;<span class="num" id="2347563">1.818357216161805012e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347592">//&nbsp;3FC7466496CB03DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347614">Lp6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347626">=</span>&nbsp;<span class="num" id="2347628">1.531383769920937332e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347657">//&nbsp;3FC39A09D078C69F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347679">Lp7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347691">=</span>&nbsp;<span class="num" id="2347693">1.479819860511658591e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347722">//&nbsp;3FC2F112DF3E5244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2347743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2347747">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347765">switch</span>&nbsp;<span class="op" id="2347772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347775">case</span>&nbsp;<span class="ident" id="2347780"><a href="/math/log1p.go.html#2346782">x</a></span>&nbsp;<span class="op" id="2347782">&lt;</span>&nbsp;<span class="op" id="2347784">-</span><span class="num" id="2347785">1</span>&nbsp;<span class="op" id="2347787">||</span>&nbsp;<span class="ident" id="2347790"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2347795">(</span><span class="ident" id="2347796"><a href="/math/log1p.go.html#2346782">x</a></span><span class="op" id="2347797">)</span><span class="op" id="2347798">:</span>&nbsp;<span class="comment" id="2347800">//&nbsp;includes&nbsp;-Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347819">return</span>&nbsp;<span class="ident" id="2347826"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2347829">(</span><span class="op" id="2347830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347833">case</span>&nbsp;<span class="ident" id="2347838"><a href="/math/log1p.go.html#2346782">x</a></span>&nbsp;<span class="op" id="2347840">==</span>&nbsp;<span class="op" id="2347843">-</span><span class="num" id="2347844">1</span><span class="op" id="2347845">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347849">return</span>&nbsp;<span class="ident" id="2347856"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2347859">(</span><span class="op" id="2347860">-</span><span class="num" id="2347861">1</span><span class="op" id="2347862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347865">case</span>&nbsp;<span class="ident" id="2347870"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2347875">(</span><span class="ident" id="2347876"><a href="/math/log1p.go.html#2346782">x</a></span><span class="op" id="2347877">,</span>&nbsp;<span class="num" id="2347879">1</span><span class="op" id="2347880">)</span><span class="op" id="2347881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347885">return</span>&nbsp;<span class="ident" id="2347892"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2347895">(</span><span class="num" id="2347896">1</span><span class="op" id="2347897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2347900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347904">absx</span>&nbsp;<span class="op" id="2347909">:=</span>&nbsp;<span class="ident" id="2347912"><a href="/math/log1p.go.html#2346782">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347915">if</span>&nbsp;<span class="ident" id="2347918"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2347923">&lt;</span>&nbsp;<span class="num" id="2347925">0</span>&nbsp;<span class="op" id="2347927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347931"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2347936">=</span>&nbsp;<span class="op" id="2347938">-</span><span class="ident" id="2347939"><a href="/math/log1p.go.html#2347904">absx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2347945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347949">var</span>&nbsp;<span class="ident" id="2347953">f</span>&nbsp;<span class="builtintype" id="2347955">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347964">var</span>&nbsp;<span class="ident" id="2347968">iu</span>&nbsp;<span class="ident" id="2347971">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2347979">k</span>&nbsp;<span class="op" id="2347981">:=</span>&nbsp;<span class="num" id="2347984">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2347987">if</span>&nbsp;<span class="ident" id="2347990"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2347995">&lt;</span>&nbsp;<span class="ident" id="2347997"><a href="/math/log1p.go.html#2346814">Sqrt2M1</a></span>&nbsp;<span class="op" id="2348005">{</span>&nbsp;<span class="comment" id="2348007">//&nbsp;&nbsp;|x|&nbsp;&lt;&nbsp;Sqrt(2)-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348029">if</span>&nbsp;<span class="ident" id="2348032"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2348037">&lt;</span>&nbsp;<span class="ident" id="2348039"><a href="/math/log1p.go.html#2346974">Small</a></span>&nbsp;<span class="op" id="2348045">{</span>&nbsp;<span class="comment" id="2348047">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348066">if</span>&nbsp;<span class="ident" id="2348069"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2348074">&lt;</span>&nbsp;<span class="ident" id="2348076"><a href="/math/log1p.go.html#2347050">Tiny</a></span>&nbsp;<span class="op" id="2348081">{</span>&nbsp;<span class="comment" id="2348083">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348103">return</span>&nbsp;<span class="ident" id="2348110"><a href="/math/log1p.go.html#2346782">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348120">return</span>&nbsp;<span class="ident" id="2348127"><a href="/math/log1p.go.html#2346782">x</a></span>&nbsp;<span class="op" id="2348129">-</span>&nbsp;<span class="ident" id="2348131"><a href="/math/log1p.go.html#2346782">x</a></span><span class="op" id="2348132">*</span><span class="ident" id="2348133"><a href="/math/log1p.go.html#2346782">x</a></span><span class="op" id="2348134">*</span><span class="num" id="2348135">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348141">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348145">if</span>&nbsp;<span class="ident" id="2348148"><a href="/math/log1p.go.html#2346782">x</a></span>&nbsp;<span class="op" id="2348150">&gt;</span>&nbsp;<span class="ident" id="2348152"><a href="/math/log1p.go.html#2346893">Sqrt2HalfM1</a></span>&nbsp;<span class="op" id="2348164">{</span>&nbsp;<span class="comment" id="2348166">//&nbsp;Sqrt(2)/2-1&nbsp;&lt;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2348188">//&nbsp;(Sqrt(2)/2-1)&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;(Sqrt(2)-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348226"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348228">=</span>&nbsp;<span class="num" id="2348230">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348235"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2348237">=</span>&nbsp;<span class="ident" id="2348239"><a href="/math/log1p.go.html#2346782">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348244"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348247">=</span>&nbsp;<span class="num" id="2348249">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348259">var</span>&nbsp;<span class="ident" id="2348263">c</span>&nbsp;<span class="builtintype" id="2348265">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348274">if</span>&nbsp;<span class="ident" id="2348277"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348279">!=</span>&nbsp;<span class="num" id="2348282">0</span>&nbsp;<span class="op" id="2348284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348288">var</span>&nbsp;<span class="ident" id="2348292">u</span>&nbsp;<span class="builtintype" id="2348294">float64</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348304">if</span>&nbsp;<span class="ident" id="2348307"><a href="/math/log1p.go.html#2347904">absx</a></span>&nbsp;<span class="op" id="2348312">&lt;</span>&nbsp;<span class="ident" id="2348314"><a href="/math/log1p.go.html#2347105">Two53</a></span>&nbsp;<span class="op" id="2348320">{</span>&nbsp;<span class="comment" id="2348322">//&nbsp;1&lt;&lt;53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348334"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348336">=</span>&nbsp;<span class="num" id="2348338">1.0</span>&nbsp;<span class="op" id="2348342">+</span>&nbsp;<span class="ident" id="2348344"><a href="/math/log1p.go.html#2346782">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348349"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348352">=</span>&nbsp;<span class="ident" id="2348354"><a href="/math/unsafe.go.html#2380703">Float64bits</a></span><span class="op" id="2348365">(</span><span class="ident" id="2348366"><a href="/math/log1p.go.html#2348292">u</a></span><span class="op" id="2348367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348372"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348374">=</span>&nbsp;<span class="builtintype" id="2348376">int</span><span class="op" id="2348379">(</span><span class="op" id="2348380">(</span><span class="ident" id="2348381"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348384">&gt;&gt;</span>&nbsp;<span class="num" id="2348387">52</span><span class="op" id="2348389">)</span>&nbsp;<span class="op" id="2348391">-</span>&nbsp;<span class="num" id="2348393">1023</span><span class="op" id="2348397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348402">if</span>&nbsp;<span class="ident" id="2348405"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348407">&gt;</span>&nbsp;<span class="num" id="2348409">0</span>&nbsp;<span class="op" id="2348411">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348417"><a href="/math/log1p.go.html#2348263">c</a></span>&nbsp;<span class="op" id="2348419">=</span>&nbsp;<span class="num" id="2348421">1.0</span>&nbsp;<span class="op" id="2348425">-</span>&nbsp;<span class="op" id="2348427">(</span><span class="ident" id="2348428"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348430">-</span>&nbsp;<span class="ident" id="2348432"><a href="/math/log1p.go.html#2346782">x</a></span><span class="op" id="2348433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348438">}</span>&nbsp;<span class="keyword" id="2348440">else</span>&nbsp;<span class="op" id="2348445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348451"><a href="/math/log1p.go.html#2348263">c</a></span>&nbsp;<span class="op" id="2348453">=</span>&nbsp;<span class="ident" id="2348455"><a href="/math/log1p.go.html#2346782">x</a></span>&nbsp;<span class="op" id="2348457">-</span>&nbsp;<span class="op" id="2348459">(</span><span class="ident" id="2348460"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348462">-</span>&nbsp;<span class="num" id="2348464">1.0</span><span class="op" id="2348467">)</span>&nbsp;<span class="comment" id="2348469">//&nbsp;correction&nbsp;term</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348492"><a href="/math/log1p.go.html#2348263">c</a></span>&nbsp;<span class="op" id="2348494">/=</span>&nbsp;<span class="ident" id="2348497"><a href="/math/log1p.go.html#2348292">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348502">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348506">}</span>&nbsp;<span class="keyword" id="2348508">else</span>&nbsp;<span class="op" id="2348513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348518"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348520">=</span>&nbsp;<span class="ident" id="2348522"><a href="/math/log1p.go.html#2346782">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348527"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348530">=</span>&nbsp;<span class="ident" id="2348532"><a href="/math/unsafe.go.html#2380703">Float64bits</a></span><span class="op" id="2348543">(</span><span class="ident" id="2348544"><a href="/math/log1p.go.html#2348292">u</a></span><span class="op" id="2348545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348550"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348552">=</span>&nbsp;<span class="builtintype" id="2348554">int</span><span class="op" id="2348557">(</span><span class="op" id="2348558">(</span><span class="ident" id="2348559"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348562">&gt;&gt;</span>&nbsp;<span class="num" id="2348565">52</span><span class="op" id="2348567">)</span>&nbsp;<span class="op" id="2348569">-</span>&nbsp;<span class="num" id="2348571">1023</span><span class="op" id="2348575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348580"><a href="/math/log1p.go.html#2348263">c</a></span>&nbsp;<span class="op" id="2348582">=</span>&nbsp;<span class="num" id="2348584">0</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348592"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348595">&amp;=</span>&nbsp;<span class="num" id="2348598">0x000fffffffffffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348619">if</span>&nbsp;<span class="ident" id="2348622"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348625">&lt;</span>&nbsp;<span class="num" id="2348627">0x0006a09e667f3bcd</span>&nbsp;<span class="op" id="2348646">{</span>&nbsp;<span class="comment" id="2348648">//&nbsp;mantissa&nbsp;of&nbsp;Sqrt(2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348674"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348676">=</span>&nbsp;<span class="ident" id="2348678"><a href="/math/unsafe.go.html#2380889">Float64frombits</a></span><span class="op" id="2348693">(</span><span class="ident" id="2348694"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348697">|</span>&nbsp;<span class="num" id="2348699">0x3ff0000000000000</span><span class="op" id="2348717">)</span>&nbsp;<span class="comment" id="2348719">//&nbsp;normalize&nbsp;u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348736">}</span>&nbsp;<span class="keyword" id="2348738">else</span>&nbsp;<span class="op" id="2348743">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348748"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2348750">+=</span>&nbsp;<span class="num" id="2348753">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348758"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348760">=</span>&nbsp;<span class="ident" id="2348762"><a href="/math/unsafe.go.html#2380889">Float64frombits</a></span><span class="op" id="2348777">(</span><span class="ident" id="2348778"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348781">|</span>&nbsp;<span class="num" id="2348783">0x3fe0000000000000</span><span class="op" id="2348801">)</span>&nbsp;<span class="comment" id="2348803">//&nbsp;normalize&nbsp;u/2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348823"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348826">=</span>&nbsp;<span class="op" id="2348828">(</span><span class="num" id="2348829">0x0010000000000000</span>&nbsp;<span class="op" id="2348848">-</span>&nbsp;<span class="ident" id="2348850"><a href="/math/log1p.go.html#2347968">iu</a></span><span class="op" id="2348852">)</span>&nbsp;<span class="op" id="2348854">&gt;&gt;</span>&nbsp;<span class="num" id="2348857">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348865"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2348867">=</span>&nbsp;<span class="ident" id="2348869"><a href="/math/log1p.go.html#2348292">u</a></span>&nbsp;<span class="op" id="2348871">-</span>&nbsp;<span class="num" id="2348873">1.0</span>&nbsp;<span class="comment" id="2348877">//&nbsp;Sqrt(2)/2&nbsp;&lt;&nbsp;u&nbsp;&lt;&nbsp;Sqrt(2)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2348905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2348908">hfsq</span>&nbsp;<span class="op" id="2348913">:=</span>&nbsp;<span class="num" id="2348916">0.5</span>&nbsp;<span class="op" id="2348920">*</span>&nbsp;<span class="ident" id="2348922"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2348924">*</span>&nbsp;<span class="ident" id="2348926"><a href="/math/log1p.go.html#2347953">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348929">var</span>&nbsp;<span class="ident" id="2348933">s</span><span class="op" id="2348934">,</span>&nbsp;<span class="ident" id="2348936">R</span><span class="op" id="2348937">,</span>&nbsp;<span class="ident" id="2348939">z</span>&nbsp;<span class="builtintype" id="2348941">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348950">if</span>&nbsp;<span class="ident" id="2348953"><a href="/math/log1p.go.html#2347968">iu</a></span>&nbsp;<span class="op" id="2348956">==</span>&nbsp;<span class="num" id="2348959">0</span>&nbsp;<span class="op" id="2348961">{</span>&nbsp;<span class="comment" id="2348963">//&nbsp;|f|&nbsp;&lt;&nbsp;2**-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348981">if</span>&nbsp;<span class="ident" id="2348984"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2348986">==</span>&nbsp;<span class="num" id="2348989">0</span>&nbsp;<span class="op" id="2348991">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2348996">if</span>&nbsp;<span class="ident" id="2348999"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2349001">==</span>&nbsp;<span class="num" id="2349004">0</span>&nbsp;<span class="op" id="2349006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349012">return</span>&nbsp;<span class="num" id="2349019">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349024">}</span>&nbsp;<span class="keyword" id="2349026">else</span>&nbsp;<span class="op" id="2349031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349037"><a href="/math/log1p.go.html#2348263">c</a></span>&nbsp;<span class="op" id="2349039">+=</span>&nbsp;<span class="builtintype" id="2349042">float64</span><span class="op" id="2349049">(</span><span class="ident" id="2349050"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349051">)</span>&nbsp;<span class="op" id="2349053">*</span>&nbsp;<span class="ident" id="2349055"><a href="/math/log1p.go.html#2347224">Ln2Lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349065">return</span>&nbsp;<span class="builtintype" id="2349072">float64</span><span class="op" id="2349079">(</span><span class="ident" id="2349080"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349081">)</span><span class="op" id="2349082">*</span><span class="ident" id="2349083"><a href="/math/log1p.go.html#2347159">Ln2Hi</a></span>&nbsp;<span class="op" id="2349089">+</span>&nbsp;<span class="ident" id="2349091"><a href="/math/log1p.go.html#2348263">c</a></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349104"><a href="/math/log1p.go.html#2348936">R</a></span>&nbsp;<span class="op" id="2349106">=</span>&nbsp;<span class="ident" id="2349108"><a href="/math/log1p.go.html#2348908">hfsq</a></span>&nbsp;<span class="op" id="2349113">*</span>&nbsp;<span class="op" id="2349115">(</span><span class="num" id="2349116">1.0</span>&nbsp;<span class="op" id="2349120">-</span>&nbsp;<span class="num" id="2349122">0.66666666666666666</span><span class="op" id="2349141">*</span><span class="ident" id="2349142"><a href="/math/log1p.go.html#2347953">f</a></span><span class="op" id="2349143">)</span>&nbsp;<span class="comment" id="2349145">//&nbsp;avoid&nbsp;division</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349165">if</span>&nbsp;<span class="ident" id="2349168"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2349170">==</span>&nbsp;<span class="num" id="2349173">0</span>&nbsp;<span class="op" id="2349175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349180">return</span>&nbsp;<span class="ident" id="2349187"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2349189">-</span>&nbsp;<span class="ident" id="2349191"><a href="/math/log1p.go.html#2348936">R</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349199">return</span>&nbsp;<span class="builtintype" id="2349206">float64</span><span class="op" id="2349213">(</span><span class="ident" id="2349214"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349215">)</span><span class="op" id="2349216">*</span><span class="ident" id="2349217"><a href="/math/log1p.go.html#2347159">Ln2Hi</a></span>&nbsp;<span class="op" id="2349223">-</span>&nbsp;<span class="op" id="2349225">(</span><span class="op" id="2349226">(</span><span class="ident" id="2349227"><a href="/math/log1p.go.html#2348936">R</a></span>&nbsp;<span class="op" id="2349229">-</span>&nbsp;<span class="op" id="2349231">(</span><span class="builtintype" id="2349232">float64</span><span class="op" id="2349239">(</span><span class="ident" id="2349240"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349241">)</span><span class="op" id="2349242">*</span><span class="ident" id="2349243"><a href="/math/log1p.go.html#2347224">Ln2Lo</a></span>&nbsp;<span class="op" id="2349249">+</span>&nbsp;<span class="ident" id="2349251"><a href="/math/log1p.go.html#2348263">c</a></span><span class="op" id="2349252">)</span><span class="op" id="2349253">)</span>&nbsp;<span class="op" id="2349255">-</span>&nbsp;<span class="ident" id="2349257"><a href="/math/log1p.go.html#2347953">f</a></span><span class="op" id="2349258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349264"><a href="/math/log1p.go.html#2348933">s</a></span>&nbsp;<span class="op" id="2349266">=</span>&nbsp;<span class="ident" id="2349268"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2349270">/</span>&nbsp;<span class="op" id="2349272">(</span><span class="num" id="2349273">2.0</span>&nbsp;<span class="op" id="2349277">+</span>&nbsp;<span class="ident" id="2349279"><a href="/math/log1p.go.html#2347953">f</a></span><span class="op" id="2349280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349283"><a href="/math/log1p.go.html#2348939">z</a></span>&nbsp;<span class="op" id="2349285">=</span>&nbsp;<span class="ident" id="2349287"><a href="/math/log1p.go.html#2348933">s</a></span>&nbsp;<span class="op" id="2349289">*</span>&nbsp;<span class="ident" id="2349291"><a href="/math/log1p.go.html#2348933">s</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349294"><a href="/math/log1p.go.html#2348936">R</a></span>&nbsp;<span class="op" id="2349296">=</span>&nbsp;<span class="ident" id="2349298"><a href="/math/log1p.go.html#2348939">z</a></span>&nbsp;<span class="op" id="2349300">*</span>&nbsp;<span class="op" id="2349302">(</span><span class="ident" id="2349303"><a href="/math/log1p.go.html#2347289">Lp1</a></span>&nbsp;<span class="op" id="2349307">+</span>&nbsp;<span class="ident" id="2349309"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349310">*</span><span class="op" id="2349311">(</span><span class="ident" id="2349312"><a href="/math/log1p.go.html#2347354">Lp2</a></span><span class="op" id="2349315">+</span><span class="ident" id="2349316"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349317">*</span><span class="op" id="2349318">(</span><span class="ident" id="2349319"><a href="/math/log1p.go.html#2347419">Lp3</a></span><span class="op" id="2349322">+</span><span class="ident" id="2349323"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349324">*</span><span class="op" id="2349325">(</span><span class="ident" id="2349326"><a href="/math/log1p.go.html#2347484">Lp4</a></span><span class="op" id="2349329">+</span><span class="ident" id="2349330"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349331">*</span><span class="op" id="2349332">(</span><span class="ident" id="2349333"><a href="/math/log1p.go.html#2347549">Lp5</a></span><span class="op" id="2349336">+</span><span class="ident" id="2349337"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349338">*</span><span class="op" id="2349339">(</span><span class="ident" id="2349340"><a href="/math/log1p.go.html#2347614">Lp6</a></span><span class="op" id="2349343">+</span><span class="ident" id="2349344"><a href="/math/log1p.go.html#2348939">z</a></span><span class="op" id="2349345">*</span><span class="ident" id="2349346"><a href="/math/log1p.go.html#2347679">Lp7</a></span><span class="op" id="2349349">)</span><span class="op" id="2349350">)</span><span class="op" id="2349351">)</span><span class="op" id="2349352">)</span><span class="op" id="2349353">)</span><span class="op" id="2349354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349357">if</span>&nbsp;<span class="ident" id="2349360"><a href="/math/log1p.go.html#2347979">k</a></span>&nbsp;<span class="op" id="2349362">==</span>&nbsp;<span class="num" id="2349365">0</span>&nbsp;<span class="op" id="2349367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349371">return</span>&nbsp;<span class="ident" id="2349378"><a href="/math/log1p.go.html#2347953">f</a></span>&nbsp;<span class="op" id="2349380">-</span>&nbsp;<span class="op" id="2349382">(</span><span class="ident" id="2349383"><a href="/math/log1p.go.html#2348908">hfsq</a></span>&nbsp;<span class="op" id="2349388">-</span>&nbsp;<span class="ident" id="2349390"><a href="/math/log1p.go.html#2348933">s</a></span><span class="op" id="2349391">*</span><span class="op" id="2349392">(</span><span class="ident" id="2349393"><a href="/math/log1p.go.html#2348908">hfsq</a></span><span class="op" id="2349397">+</span><span class="ident" id="2349398"><a href="/math/log1p.go.html#2348936">R</a></span><span class="op" id="2349399">)</span><span class="op" id="2349400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349406">return</span>&nbsp;<span class="builtintype" id="2349413">float64</span><span class="op" id="2349420">(</span><span class="ident" id="2349421"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349422">)</span><span class="op" id="2349423">*</span><span class="ident" id="2349424"><a href="/math/log1p.go.html#2347159">Ln2Hi</a></span>&nbsp;<span class="op" id="2349430">-</span>&nbsp;<span class="op" id="2349432">(</span><span class="op" id="2349433">(</span><span class="ident" id="2349434"><a href="/math/log1p.go.html#2348908">hfsq</a></span>&nbsp;<span class="op" id="2349439">-</span>&nbsp;<span class="op" id="2349441">(</span><span class="ident" id="2349442"><a href="/math/log1p.go.html#2348933">s</a></span><span class="op" id="2349443">*</span><span class="op" id="2349444">(</span><span class="ident" id="2349445"><a href="/math/log1p.go.html#2348908">hfsq</a></span><span class="op" id="2349449">+</span><span class="ident" id="2349450"><a href="/math/log1p.go.html#2348936">R</a></span><span class="op" id="2349451">)</span>&nbsp;<span class="op" id="2349453">+</span>&nbsp;<span class="op" id="2349455">(</span><span class="builtintype" id="2349456">float64</span><span class="op" id="2349463">(</span><span class="ident" id="2349464"><a href="/math/log1p.go.html#2347979">k</a></span><span class="op" id="2349465">)</span><span class="op" id="2349466">*</span><span class="ident" id="2349467"><a href="/math/log1p.go.html#2347224">Ln2Lo</a></span>&nbsp;<span class="op" id="2349473">+</span>&nbsp;<span class="ident" id="2349475"><a href="/math/log1p.go.html#2348263">c</a></span><span class="op" id="2349476">)</span><span class="op" id="2349477">)</span><span class="op" id="2349478">)</span>&nbsp;<span class="op" id="2349480">-</span>&nbsp;<span class="ident" id="2349482"><a href="/math/log1p.go.html#2347953">f</a></span><span class="op" id="2349483">)</span><br>
<span class="lineno">200</span><span class="op" id="2349485">}</span>
</div>
</body>
</html>
