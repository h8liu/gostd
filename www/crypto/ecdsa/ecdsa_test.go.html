<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6864727">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6864782">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6864836">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6864887">package</span>&nbsp;<span class="ident" id="6864895">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6864902">import</span>&nbsp;<span class="op" id="6864909">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864912">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864921">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864939">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864958">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864973">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6864988">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865005">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865022">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865038">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865046">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865052">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865064">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865070">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6865081">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6865091">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6865094">func</span>&nbsp;<span class="ident" id="6865099">testKeyGeneration</span><span class="op" id="6865116">(</span><span class="ident" id="6865117">t</span>&nbsp;<span class="op" id="6865119">*</span><span class="ident" id="6865120">testing</span><span class="op" id="6865127">.</span><span class="ident" id="6865128">T</span><span class="op" id="6865129">,</span>&nbsp;<span class="ident" id="6865131">c</span>&nbsp;<span class="ident" id="6865133">elliptic</span><span class="op" id="6865141">.</span><span class="ident" id="6865142">Curve</span><span class="op" id="6865147">,</span>&nbsp;<span class="ident" id="6865149">tag</span>&nbsp;<span class="builtintype" id="6865153">string</span><span class="op" id="6865159">)</span>&nbsp;<span class="op" id="6865161">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865164">priv</span><span class="op" id="6865168">,</span>&nbsp;<span class="ident" id="6865170">err</span>&nbsp;<span class="op" id="6865174">:=</span>&nbsp;<span class="ident" id="6865177">GenerateKey</span><span class="op" id="6865188">(</span><span class="ident" id="6865189">c</span><span class="op" id="6865190">,</span>&nbsp;<span class="ident" id="6865192">rand</span><span class="op" id="6865196">.</span><span class="ident" id="6865197">Reader</span><span class="op" id="6865203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865206">if</span>&nbsp;<span class="ident" id="6865209">err</span>&nbsp;<span class="op" id="6865213">!=</span>&nbsp;<span class="ident" id="6865216">nil</span>&nbsp;<span class="op" id="6865220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865224">t</span><span class="op" id="6865225">.</span><span class="ident" id="6865226">Errorf</span><span class="op" id="6865232">(</span><span class="string" id="6865233">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6865248">,</span>&nbsp;<span class="ident" id="6865250">tag</span><span class="op" id="6865253">,</span>&nbsp;<span class="ident" id="6865255">err</span><span class="op" id="6865258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865262">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865270">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865273">if</span>&nbsp;<span class="op" id="6865276">!</span><span class="ident" id="6865277">c</span><span class="op" id="6865278">.</span><span class="ident" id="6865279">IsOnCurve</span><span class="op" id="6865288">(</span><span class="ident" id="6865289">priv</span><span class="op" id="6865293">.</span><span class="ident" id="6865294">PublicKey</span><span class="op" id="6865303">.</span><span class="ident" id="6865304">X</span><span class="op" id="6865305">,</span>&nbsp;<span class="ident" id="6865307">priv</span><span class="op" id="6865311">.</span><span class="ident" id="6865312">PublicKey</span><span class="op" id="6865321">.</span><span class="ident" id="6865322">Y</span><span class="op" id="6865323">)</span>&nbsp;<span class="op" id="6865325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865329">t</span><span class="op" id="6865330">.</span><span class="ident" id="6865331">Errorf</span><span class="op" id="6865337">(</span><span class="string" id="6865338">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="6865366">,</span>&nbsp;<span class="ident" id="6865368">tag</span><span class="op" id="6865371">,</span>&nbsp;<span class="ident" id="6865373">err</span><span class="op" id="6865376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865379">}</span><br>
<span class="lineno"></span><span class="op" id="6865381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6865384">func</span>&nbsp;<span class="ident" id="6865389">TestKeyGeneration</span><span class="op" id="6865406">(</span><span class="ident" id="6865407">t</span>&nbsp;<span class="op" id="6865409">*</span><span class="ident" id="6865410">testing</span><span class="op" id="6865417">.</span><span class="ident" id="6865418">T</span><span class="op" id="6865419">)</span>&nbsp;<span class="op" id="6865421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865424">testKeyGeneration</span><span class="op" id="6865441">(</span><span class="ident" id="6865442">t</span><span class="op" id="6865443">,</span>&nbsp;<span class="ident" id="6865445">elliptic</span><span class="op" id="6865453">.</span><span class="ident" id="6865454">P224</span><span class="op" id="6865458">(</span><span class="op" id="6865459">)</span><span class="op" id="6865460">,</span>&nbsp;<span class="string" id="6865462">&#34;p224&#34;</span><span class="op" id="6865468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865471">if</span>&nbsp;<span class="ident" id="6865474">testing</span><span class="op" id="6865481">.</span><span class="ident" id="6865482">Short</span><span class="op" id="6865487">(</span><span class="op" id="6865488">)</span>&nbsp;<span class="op" id="6865490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865494">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865502">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865505">testKeyGeneration</span><span class="op" id="6865522">(</span><span class="ident" id="6865523">t</span><span class="op" id="6865524">,</span>&nbsp;<span class="ident" id="6865526">elliptic</span><span class="op" id="6865534">.</span><span class="ident" id="6865535">P256</span><span class="op" id="6865539">(</span><span class="op" id="6865540">)</span><span class="op" id="6865541">,</span>&nbsp;<span class="string" id="6865543">&#34;p256&#34;</span><span class="op" id="6865549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865552">testKeyGeneration</span><span class="op" id="6865569">(</span><span class="ident" id="6865570">t</span><span class="op" id="6865571">,</span>&nbsp;<span class="ident" id="6865573">elliptic</span><span class="op" id="6865581">.</span><span class="ident" id="6865582">P384</span><span class="op" id="6865586">(</span><span class="op" id="6865587">)</span><span class="op" id="6865588">,</span>&nbsp;<span class="string" id="6865590">&#34;p384&#34;</span><span class="op" id="6865596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865599">testKeyGeneration</span><span class="op" id="6865616">(</span><span class="ident" id="6865617">t</span><span class="op" id="6865618">,</span>&nbsp;<span class="ident" id="6865620">elliptic</span><span class="op" id="6865628">.</span><span class="ident" id="6865629">P521</span><span class="op" id="6865633">(</span><span class="op" id="6865634">)</span><span class="op" id="6865635">,</span>&nbsp;<span class="string" id="6865637">&#34;p521&#34;</span><span class="op" id="6865643">)</span><br>
<span class="lineno"></span><span class="op" id="6865645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6865648">func</span>&nbsp;<span class="ident" id="6865653">testSignAndVerify</span><span class="op" id="6865670">(</span><span class="ident" id="6865671">t</span>&nbsp;<span class="op" id="6865673">*</span><span class="ident" id="6865674">testing</span><span class="op" id="6865681">.</span><span class="ident" id="6865682">T</span><span class="op" id="6865683">,</span>&nbsp;<span class="ident" id="6865685">c</span>&nbsp;<span class="ident" id="6865687">elliptic</span><span class="op" id="6865695">.</span><span class="ident" id="6865696">Curve</span><span class="op" id="6865701">,</span>&nbsp;<span class="ident" id="6865703">tag</span>&nbsp;<span class="builtintype" id="6865707">string</span><span class="op" id="6865713">)</span>&nbsp;<span class="op" id="6865715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865718">priv</span><span class="op" id="6865722">,</span>&nbsp;<span class="ident" id="6865724">_</span>&nbsp;<span class="op" id="6865726">:=</span>&nbsp;<span class="ident" id="6865729">GenerateKey</span><span class="op" id="6865740">(</span><span class="ident" id="6865741">c</span><span class="op" id="6865742">,</span>&nbsp;<span class="ident" id="6865744">rand</span><span class="op" id="6865748">.</span><span class="ident" id="6865749">Reader</span><span class="op" id="6865755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865759">hashed</span>&nbsp;<span class="op" id="6865766">:=</span>&nbsp;<span class="op" id="6865769">[</span><span class="op" id="6865770">]</span><span class="builtintype" id="6865771">byte</span><span class="op" id="6865775">(</span><span class="string" id="6865776">&#34;testing&#34;</span><span class="op" id="6865785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865788">r</span><span class="op" id="6865789">,</span>&nbsp;<span class="ident" id="6865791">s</span><span class="op" id="6865792">,</span>&nbsp;<span class="ident" id="6865794">err</span>&nbsp;<span class="op" id="6865798">:=</span>&nbsp;<span class="ident" id="6865801">Sign</span><span class="op" id="6865805">(</span><span class="ident" id="6865806">rand</span><span class="op" id="6865810">.</span><span class="ident" id="6865811">Reader</span><span class="op" id="6865817">,</span>&nbsp;<span class="ident" id="6865819">priv</span><span class="op" id="6865823">,</span>&nbsp;<span class="ident" id="6865825">hashed</span><span class="op" id="6865831">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865834">if</span>&nbsp;<span class="ident" id="6865837">err</span>&nbsp;<span class="op" id="6865841">!=</span>&nbsp;<span class="ident" id="6865844">nil</span>&nbsp;<span class="op" id="6865848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865852">t</span><span class="op" id="6865853">.</span><span class="ident" id="6865854">Errorf</span><span class="op" id="6865860">(</span><span class="string" id="6865861">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6865884">,</span>&nbsp;<span class="ident" id="6865886">tag</span><span class="op" id="6865889">,</span>&nbsp;<span class="ident" id="6865891">err</span><span class="op" id="6865894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865898">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865910">if</span>&nbsp;<span class="op" id="6865913">!</span><span class="ident" id="6865914">Verify</span><span class="op" id="6865920">(</span><span class="op" id="6865921">&amp;</span><span class="ident" id="6865922">priv</span><span class="op" id="6865926">.</span><span class="ident" id="6865927">PublicKey</span><span class="op" id="6865936">,</span>&nbsp;<span class="ident" id="6865938">hashed</span><span class="op" id="6865944">,</span>&nbsp;<span class="ident" id="6865946">r</span><span class="op" id="6865947">,</span>&nbsp;<span class="ident" id="6865949">s</span><span class="op" id="6865950">)</span>&nbsp;<span class="op" id="6865952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865956">t</span><span class="op" id="6865957">.</span><span class="ident" id="6865958">Errorf</span><span class="op" id="6865964">(</span><span class="string" id="6865965">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6865984">,</span>&nbsp;<span class="ident" id="6865986">tag</span><span class="op" id="6865989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865996">hashed</span><span class="op" id="6866002">[</span><span class="num" id="6866003">0</span><span class="op" id="6866004">]</span>&nbsp;<span class="op" id="6866006">^=</span>&nbsp;<span class="num" id="6866009">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866015">if</span>&nbsp;<span class="ident" id="6866018">Verify</span><span class="op" id="6866024">(</span><span class="op" id="6866025">&amp;</span><span class="ident" id="6866026">priv</span><span class="op" id="6866030">.</span><span class="ident" id="6866031">PublicKey</span><span class="op" id="6866040">,</span>&nbsp;<span class="ident" id="6866042">hashed</span><span class="op" id="6866048">,</span>&nbsp;<span class="ident" id="6866050">r</span><span class="op" id="6866051">,</span>&nbsp;<span class="ident" id="6866053">s</span><span class="op" id="6866054">)</span>&nbsp;<span class="op" id="6866056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866060">t</span><span class="op" id="6866061">.</span><span class="ident" id="6866062">Errorf</span><span class="op" id="6866068">(</span><span class="string" id="6866069">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="6866095">,</span>&nbsp;<span class="ident" id="6866097">tag</span><span class="op" id="6866100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866103">}</span><br>
<span class="lineno"></span><span class="op" id="6866105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6866108">func</span>&nbsp;<span class="ident" id="6866113">TestSignAndVerify</span><span class="op" id="6866130">(</span><span class="ident" id="6866131">t</span>&nbsp;<span class="op" id="6866133">*</span><span class="ident" id="6866134">testing</span><span class="op" id="6866141">.</span><span class="ident" id="6866142">T</span><span class="op" id="6866143">)</span>&nbsp;<span class="op" id="6866145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866148">testSignAndVerify</span><span class="op" id="6866165">(</span><span class="ident" id="6866166">t</span><span class="op" id="6866167">,</span>&nbsp;<span class="ident" id="6866169">elliptic</span><span class="op" id="6866177">.</span><span class="ident" id="6866178">P224</span><span class="op" id="6866182">(</span><span class="op" id="6866183">)</span><span class="op" id="6866184">,</span>&nbsp;<span class="string" id="6866186">&#34;p224&#34;</span><span class="op" id="6866192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866195">if</span>&nbsp;<span class="ident" id="6866198">testing</span><span class="op" id="6866205">.</span><span class="ident" id="6866206">Short</span><span class="op" id="6866211">(</span><span class="op" id="6866212">)</span>&nbsp;<span class="op" id="6866214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866218">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866226">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866229">testSignAndVerify</span><span class="op" id="6866246">(</span><span class="ident" id="6866247">t</span><span class="op" id="6866248">,</span>&nbsp;<span class="ident" id="6866250">elliptic</span><span class="op" id="6866258">.</span><span class="ident" id="6866259">P256</span><span class="op" id="6866263">(</span><span class="op" id="6866264">)</span><span class="op" id="6866265">,</span>&nbsp;<span class="string" id="6866267">&#34;p256&#34;</span><span class="op" id="6866273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866276">testSignAndVerify</span><span class="op" id="6866293">(</span><span class="ident" id="6866294">t</span><span class="op" id="6866295">,</span>&nbsp;<span class="ident" id="6866297">elliptic</span><span class="op" id="6866305">.</span><span class="ident" id="6866306">P384</span><span class="op" id="6866310">(</span><span class="op" id="6866311">)</span><span class="op" id="6866312">,</span>&nbsp;<span class="string" id="6866314">&#34;p384&#34;</span><span class="op" id="6866320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866323">testSignAndVerify</span><span class="op" id="6866340">(</span><span class="ident" id="6866341">t</span><span class="op" id="6866342">,</span>&nbsp;<span class="ident" id="6866344">elliptic</span><span class="op" id="6866352">.</span><span class="ident" id="6866353">P521</span><span class="op" id="6866357">(</span><span class="op" id="6866358">)</span><span class="op" id="6866359">,</span>&nbsp;<span class="string" id="6866361">&#34;p521&#34;</span><span class="op" id="6866367">)</span><br>
<span class="lineno"></span><span class="op" id="6866369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6866372">func</span>&nbsp;<span class="ident" id="6866377">fromHex</span><span class="op" id="6866384">(</span><span class="ident" id="6866385">s</span>&nbsp;<span class="builtintype" id="6866387">string</span><span class="op" id="6866393">)</span>&nbsp;<span class="op" id="6866395">*</span><span class="ident" id="6866396">big</span><span class="op" id="6866399">.</span><span class="ident" id="6866400">Int</span>&nbsp;<span class="op" id="6866404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866407">r</span><span class="op" id="6866408">,</span>&nbsp;<span class="ident" id="6866410">ok</span>&nbsp;<span class="op" id="6866413">:=</span>&nbsp;<span class="builtinfunc" id="6866416">new</span><span class="op" id="6866419">(</span><span class="ident" id="6866420">big</span><span class="op" id="6866423">.</span><span class="ident" id="6866424">Int</span><span class="op" id="6866427">)</span><span class="op" id="6866428">.</span><span class="ident" id="6866429">SetString</span><span class="op" id="6866438">(</span><span class="ident" id="6866439">s</span><span class="op" id="6866440">,</span>&nbsp;<span class="num" id="6866442">16</span><span class="op" id="6866444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866447">if</span>&nbsp;<span class="op" id="6866450">!</span><span class="ident" id="6866451">ok</span>&nbsp;<span class="op" id="6866454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6866458">panic</span><span class="op" id="6866463">(</span><span class="string" id="6866464">&#34;bad&nbsp;hex&#34;</span><span class="op" id="6866473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866476">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866479">return</span>&nbsp;<span class="ident" id="6866486">r</span><br>
<span class="lineno"></span><span class="op" id="6866488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6866491">func</span>&nbsp;<span class="ident" id="6866496">TestVectors</span><span class="op" id="6866507">(</span><span class="ident" id="6866508">t</span>&nbsp;<span class="op" id="6866510">*</span><span class="ident" id="6866511">testing</span><span class="op" id="6866518">.</span><span class="ident" id="6866519">T</span><span class="op" id="6866520">)</span>&nbsp;<span class="op" id="6866522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866525">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866583">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866664">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866668">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6866735">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866788">if</span>&nbsp;<span class="ident" id="6866791">testing</span><span class="op" id="6866798">.</span><span class="ident" id="6866799">Short</span><span class="op" id="6866804">(</span><span class="op" id="6866805">)</span>&nbsp;<span class="op" id="6866807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866823">f</span><span class="op" id="6866824">,</span>&nbsp;<span class="ident" id="6866826">err</span>&nbsp;<span class="op" id="6866830">:=</span>&nbsp;<span class="ident" id="6866833">os</span><span class="op" id="6866835">.</span><span class="ident" id="6866836">Open</span><span class="op" id="6866840">(</span><span class="string" id="6866841">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="6866866">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866869">if</span>&nbsp;<span class="ident" id="6866872">err</span>&nbsp;<span class="op" id="6866876">!=</span>&nbsp;<span class="ident" id="6866879">nil</span>&nbsp;<span class="op" id="6866883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866887">t</span><span class="op" id="6866888">.</span><span class="ident" id="6866889">Fatal</span><span class="op" id="6866894">(</span><span class="ident" id="6866895">err</span><span class="op" id="6866898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866905">buf</span>&nbsp;<span class="op" id="6866909">:=</span>&nbsp;<span class="ident" id="6866912">bufio</span><span class="op" id="6866917">.</span><span class="ident" id="6866918">NewReader</span><span class="op" id="6866927">(</span><span class="ident" id="6866928">bzip2</span><span class="op" id="6866933">.</span><span class="ident" id="6866934">NewReader</span><span class="op" id="6866943">(</span><span class="ident" id="6866944">f</span><span class="op" id="6866945">)</span><span class="op" id="6866946">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866950">lineNo</span>&nbsp;<span class="op" id="6866957">:=</span>&nbsp;<span class="num" id="6866960">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866963">var</span>&nbsp;<span class="ident" id="6866967">h</span>&nbsp;<span class="ident" id="6866969">hash</span><span class="op" id="6866973">.</span><span class="ident" id="6866974">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866980">var</span>&nbsp;<span class="ident" id="6866984">msg</span>&nbsp;<span class="op" id="6866988">[</span><span class="op" id="6866989">]</span><span class="builtintype" id="6866990">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6866996">var</span>&nbsp;<span class="ident" id="6867000">hashed</span>&nbsp;<span class="op" id="6867007">[</span><span class="op" id="6867008">]</span><span class="builtintype" id="6867009">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867015">var</span>&nbsp;<span class="ident" id="6867019">r</span><span class="op" id="6867020">,</span>&nbsp;<span class="ident" id="6867022">s</span>&nbsp;<span class="op" id="6867024">*</span><span class="ident" id="6867025">big</span><span class="op" id="6867028">.</span><span class="ident" id="6867029">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867034">pub</span>&nbsp;<span class="op" id="6867038">:=</span>&nbsp;<span class="builtinfunc" id="6867041">new</span><span class="op" id="6867044">(</span><span class="ident" id="6867045">PublicKey</span><span class="op" id="6867054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867058">for</span>&nbsp;<span class="op" id="6867062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867066">line</span><span class="op" id="6867070">,</span>&nbsp;<span class="ident" id="6867072">err</span>&nbsp;<span class="op" id="6867076">:=</span>&nbsp;<span class="ident" id="6867079">buf</span><span class="op" id="6867082">.</span><span class="ident" id="6867083">ReadString</span><span class="op" id="6867093">(</span><span class="string" id="6867094">&#39;\n&#39;</span><span class="op" id="6867098">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867102">if</span>&nbsp;<span class="builtinfunc" id="6867105">len</span><span class="op" id="6867108">(</span><span class="ident" id="6867109">line</span><span class="op" id="6867113">)</span>&nbsp;<span class="op" id="6867115">==</span>&nbsp;<span class="num" id="6867118">0</span>&nbsp;<span class="op" id="6867120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867125">if</span>&nbsp;<span class="ident" id="6867128">err</span>&nbsp;<span class="op" id="6867132">==</span>&nbsp;<span class="ident" id="6867135">io</span><span class="op" id="6867137">.</span><span class="ident" id="6867138">EOF</span>&nbsp;<span class="op" id="6867142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867148">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867162">t</span><span class="op" id="6867163">.</span><span class="ident" id="6867164">Fatalf</span><span class="op" id="6867170">(</span><span class="string" id="6867171">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="6867201">,</span>&nbsp;<span class="ident" id="6867203">err</span><span class="op" id="6867206">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867214">lineNo</span><span class="op" id="6867220">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6867225">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867276">if</span>&nbsp;<span class="op" id="6867279">!</span><span class="ident" id="6867280">strings</span><span class="op" id="6867287">.</span><span class="ident" id="6867288">HasSuffix</span><span class="op" id="6867297">(</span><span class="ident" id="6867298">line</span><span class="op" id="6867302">,</span>&nbsp;<span class="string" id="6867304">&#34;\r\n&#34;</span><span class="op" id="6867310">)</span>&nbsp;<span class="op" id="6867312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867317">t</span><span class="op" id="6867318">.</span><span class="ident" id="6867319">Fatalf</span><span class="op" id="6867325">(</span><span class="string" id="6867326">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6867372">,</span>&nbsp;<span class="ident" id="6867374">lineNo</span><span class="op" id="6867380">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867388">line</span>&nbsp;<span class="op" id="6867393">=</span>&nbsp;<span class="ident" id="6867395">line</span><span class="op" id="6867399">[</span><span class="op" id="6867400">:</span><span class="builtinfunc" id="6867401">len</span><span class="op" id="6867404">(</span><span class="ident" id="6867405">line</span><span class="op" id="6867409">)</span><span class="op" id="6867410">-</span><span class="num" id="6867411">2</span><span class="op" id="6867412">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867417">if</span>&nbsp;<span class="builtinfunc" id="6867420">len</span><span class="op" id="6867423">(</span><span class="ident" id="6867424">line</span><span class="op" id="6867428">)</span>&nbsp;<span class="op" id="6867430">==</span>&nbsp;<span class="num" id="6867433">0</span>&nbsp;<span class="op" id="6867435">||</span>&nbsp;<span class="ident" id="6867438">line</span><span class="op" id="6867442">[</span><span class="num" id="6867443">0</span><span class="op" id="6867444">]</span>&nbsp;<span class="op" id="6867446">==</span>&nbsp;<span class="string" id="6867449">&#39;#&#39;</span>&nbsp;<span class="op" id="6867453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867458">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867474">if</span>&nbsp;<span class="ident" id="6867477">line</span><span class="op" id="6867481">[</span><span class="num" id="6867482">0</span><span class="op" id="6867483">]</span>&nbsp;<span class="op" id="6867485">==</span>&nbsp;<span class="string" id="6867488">&#39;[&#39;</span>&nbsp;<span class="op" id="6867492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867497">line</span>&nbsp;<span class="op" id="6867502">=</span>&nbsp;<span class="ident" id="6867504">line</span><span class="op" id="6867508">[</span><span class="num" id="6867509">1</span>&nbsp;<span class="op" id="6867511">:</span>&nbsp;<span class="builtinfunc" id="6867513">len</span><span class="op" id="6867516">(</span><span class="ident" id="6867517">line</span><span class="op" id="6867521">)</span><span class="op" id="6867522">-</span><span class="num" id="6867523">1</span><span class="op" id="6867524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867529">parts</span>&nbsp;<span class="op" id="6867535">:=</span>&nbsp;<span class="ident" id="6867538">strings</span><span class="op" id="6867545">.</span><span class="ident" id="6867546">SplitN</span><span class="op" id="6867552">(</span><span class="ident" id="6867553">line</span><span class="op" id="6867557">,</span>&nbsp;<span class="string" id="6867559">&#34;,&#34;</span><span class="op" id="6867562">,</span>&nbsp;<span class="num" id="6867564">2</span><span class="op" id="6867565">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867571">switch</span>&nbsp;<span class="ident" id="6867578">parts</span><span class="op" id="6867583">[</span><span class="num" id="6867584">0</span><span class="op" id="6867585">]</span>&nbsp;<span class="op" id="6867587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867592">case</span>&nbsp;<span class="string" id="6867597">&#34;P-224&#34;</span><span class="op" id="6867604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867610">pub</span><span class="op" id="6867613">.</span><span class="ident" id="6867614">Curve</span>&nbsp;<span class="op" id="6867620">=</span>&nbsp;<span class="ident" id="6867622">elliptic</span><span class="op" id="6867630">.</span><span class="ident" id="6867631">P224</span><span class="op" id="6867635">(</span><span class="op" id="6867636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867641">case</span>&nbsp;<span class="string" id="6867646">&#34;P-256&#34;</span><span class="op" id="6867653">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867659">pub</span><span class="op" id="6867662">.</span><span class="ident" id="6867663">Curve</span>&nbsp;<span class="op" id="6867669">=</span>&nbsp;<span class="ident" id="6867671">elliptic</span><span class="op" id="6867679">.</span><span class="ident" id="6867680">P256</span><span class="op" id="6867684">(</span><span class="op" id="6867685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867690">case</span>&nbsp;<span class="string" id="6867695">&#34;P-384&#34;</span><span class="op" id="6867702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867708">pub</span><span class="op" id="6867711">.</span><span class="ident" id="6867712">Curve</span>&nbsp;<span class="op" id="6867718">=</span>&nbsp;<span class="ident" id="6867720">elliptic</span><span class="op" id="6867728">.</span><span class="ident" id="6867729">P384</span><span class="op" id="6867733">(</span><span class="op" id="6867734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867739">case</span>&nbsp;<span class="string" id="6867744">&#34;P-521&#34;</span><span class="op" id="6867751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867757">pub</span><span class="op" id="6867760">.</span><span class="ident" id="6867761">Curve</span>&nbsp;<span class="op" id="6867767">=</span>&nbsp;<span class="ident" id="6867769">elliptic</span><span class="op" id="6867777">.</span><span class="ident" id="6867778">P521</span><span class="op" id="6867782">(</span><span class="op" id="6867783">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867788">default</span><span class="op" id="6867795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867801">pub</span><span class="op" id="6867804">.</span><span class="ident" id="6867805">Curve</span>&nbsp;<span class="op" id="6867811">=</span>&nbsp;<span class="ident" id="6867813">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867826">switch</span>&nbsp;<span class="ident" id="6867833">parts</span><span class="op" id="6867838">[</span><span class="num" id="6867839">1</span><span class="op" id="6867840">]</span>&nbsp;<span class="op" id="6867842">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867847">case</span>&nbsp;<span class="string" id="6867852">&#34;SHA-1&#34;</span><span class="op" id="6867859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867865">h</span>&nbsp;<span class="op" id="6867867">=</span>&nbsp;<span class="ident" id="6867869">sha1</span><span class="op" id="6867873">.</span><span class="ident" id="6867874">New</span><span class="op" id="6867877">(</span><span class="op" id="6867878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867883">case</span>&nbsp;<span class="string" id="6867888">&#34;SHA-224&#34;</span><span class="op" id="6867897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867903">h</span>&nbsp;<span class="op" id="6867905">=</span>&nbsp;<span class="ident" id="6867907">sha256</span><span class="op" id="6867913">.</span><span class="ident" id="6867914">New224</span><span class="op" id="6867920">(</span><span class="op" id="6867921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867926">case</span>&nbsp;<span class="string" id="6867931">&#34;SHA-256&#34;</span><span class="op" id="6867940">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867946">h</span>&nbsp;<span class="op" id="6867948">=</span>&nbsp;<span class="ident" id="6867950">sha256</span><span class="op" id="6867956">.</span><span class="ident" id="6867957">New</span><span class="op" id="6867960">(</span><span class="op" id="6867961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867966">case</span>&nbsp;<span class="string" id="6867971">&#34;SHA-384&#34;</span><span class="op" id="6867980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867986">h</span>&nbsp;<span class="op" id="6867988">=</span>&nbsp;<span class="ident" id="6867990">sha512</span><span class="op" id="6867996">.</span><span class="ident" id="6867997">New384</span><span class="op" id="6868003">(</span><span class="op" id="6868004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868009">case</span>&nbsp;<span class="string" id="6868014">&#34;SHA-512&#34;</span><span class="op" id="6868023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868029">h</span>&nbsp;<span class="op" id="6868031">=</span>&nbsp;<span class="ident" id="6868033">sha512</span><span class="op" id="6868039">.</span><span class="ident" id="6868040">New</span><span class="op" id="6868043">(</span><span class="op" id="6868044">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868049">default</span><span class="op" id="6868056">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868062">h</span>&nbsp;<span class="op" id="6868064">=</span>&nbsp;<span class="ident" id="6868066">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868079">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868095">if</span>&nbsp;<span class="ident" id="6868098">h</span>&nbsp;<span class="op" id="6868100">==</span>&nbsp;<span class="ident" id="6868103">nil</span>&nbsp;<span class="op" id="6868107">||</span>&nbsp;<span class="ident" id="6868110">pub</span><span class="op" id="6868113">.</span><span class="ident" id="6868114">Curve</span>&nbsp;<span class="op" id="6868120">==</span>&nbsp;<span class="ident" id="6868123">nil</span>&nbsp;<span class="op" id="6868127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868132">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868143">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868148">switch</span>&nbsp;<span class="op" id="6868155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868159">case</span>&nbsp;<span class="ident" id="6868164">strings</span><span class="op" id="6868171">.</span><span class="ident" id="6868172">HasPrefix</span><span class="op" id="6868181">(</span><span class="ident" id="6868182">line</span><span class="op" id="6868186">,</span>&nbsp;<span class="string" id="6868188">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="6868196">)</span><span class="op" id="6868197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868202">if</span>&nbsp;<span class="ident" id="6868205">msg</span><span class="op" id="6868208">,</span>&nbsp;<span class="ident" id="6868210">err</span>&nbsp;<span class="op" id="6868214">=</span>&nbsp;<span class="ident" id="6868216">hex</span><span class="op" id="6868219">.</span><span class="ident" id="6868220">DecodeString</span><span class="op" id="6868232">(</span><span class="ident" id="6868233">line</span><span class="op" id="6868237">[</span><span class="num" id="6868238">6</span><span class="op" id="6868239">:</span><span class="op" id="6868240">]</span><span class="op" id="6868241">)</span><span class="op" id="6868242">;</span>&nbsp;<span class="ident" id="6868244">err</span>&nbsp;<span class="op" id="6868248">!=</span>&nbsp;<span class="ident" id="6868251">nil</span>&nbsp;<span class="op" id="6868255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868261">t</span><span class="op" id="6868262">.</span><span class="ident" id="6868263">Fatalf</span><span class="op" id="6868269">(</span><span class="string" id="6868270">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6868311">,</span>&nbsp;<span class="ident" id="6868313">lineNo</span><span class="op" id="6868319">,</span>&nbsp;<span class="ident" id="6868321">err</span><span class="op" id="6868324">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868333">case</span>&nbsp;<span class="ident" id="6868338">strings</span><span class="op" id="6868345">.</span><span class="ident" id="6868346">HasPrefix</span><span class="op" id="6868355">(</span><span class="ident" id="6868356">line</span><span class="op" id="6868360">,</span>&nbsp;<span class="string" id="6868362">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="6868369">)</span><span class="op" id="6868370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868375">pub</span><span class="op" id="6868378">.</span><span class="ident" id="6868379">X</span>&nbsp;<span class="op" id="6868381">=</span>&nbsp;<span class="ident" id="6868383">fromHex</span><span class="op" id="6868390">(</span><span class="ident" id="6868391">line</span><span class="op" id="6868395">[</span><span class="num" id="6868396">5</span><span class="op" id="6868397">:</span><span class="op" id="6868398">]</span><span class="op" id="6868399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868403">case</span>&nbsp;<span class="ident" id="6868408">strings</span><span class="op" id="6868415">.</span><span class="ident" id="6868416">HasPrefix</span><span class="op" id="6868425">(</span><span class="ident" id="6868426">line</span><span class="op" id="6868430">,</span>&nbsp;<span class="string" id="6868432">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="6868439">)</span><span class="op" id="6868440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868445">pub</span><span class="op" id="6868448">.</span><span class="ident" id="6868449">Y</span>&nbsp;<span class="op" id="6868451">=</span>&nbsp;<span class="ident" id="6868453">fromHex</span><span class="op" id="6868460">(</span><span class="ident" id="6868461">line</span><span class="op" id="6868465">[</span><span class="num" id="6868466">5</span><span class="op" id="6868467">:</span><span class="op" id="6868468">]</span><span class="op" id="6868469">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868473">case</span>&nbsp;<span class="ident" id="6868478">strings</span><span class="op" id="6868485">.</span><span class="ident" id="6868486">HasPrefix</span><span class="op" id="6868495">(</span><span class="ident" id="6868496">line</span><span class="op" id="6868500">,</span>&nbsp;<span class="string" id="6868502">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="6868508">)</span><span class="op" id="6868509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868514">r</span>&nbsp;<span class="op" id="6868516">=</span>&nbsp;<span class="ident" id="6868518">fromHex</span><span class="op" id="6868525">(</span><span class="ident" id="6868526">line</span><span class="op" id="6868530">[</span><span class="num" id="6868531">4</span><span class="op" id="6868532">:</span><span class="op" id="6868533">]</span><span class="op" id="6868534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868538">case</span>&nbsp;<span class="ident" id="6868543">strings</span><span class="op" id="6868550">.</span><span class="ident" id="6868551">HasPrefix</span><span class="op" id="6868560">(</span><span class="ident" id="6868561">line</span><span class="op" id="6868565">,</span>&nbsp;<span class="string" id="6868567">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="6868573">)</span><span class="op" id="6868574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868579">s</span>&nbsp;<span class="op" id="6868581">=</span>&nbsp;<span class="ident" id="6868583">fromHex</span><span class="op" id="6868590">(</span><span class="ident" id="6868591">line</span><span class="op" id="6868595">[</span><span class="num" id="6868596">4</span><span class="op" id="6868597">:</span><span class="op" id="6868598">]</span><span class="op" id="6868599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868603">case</span>&nbsp;<span class="ident" id="6868608">strings</span><span class="op" id="6868615">.</span><span class="ident" id="6868616">HasPrefix</span><span class="op" id="6868625">(</span><span class="ident" id="6868626">line</span><span class="op" id="6868630">,</span>&nbsp;<span class="string" id="6868632">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="6868643">)</span><span class="op" id="6868644">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868649">expected</span>&nbsp;<span class="op" id="6868658">:=</span>&nbsp;<span class="ident" id="6868661">line</span><span class="op" id="6868665">[</span><span class="num" id="6868666">9</span><span class="op" id="6868667">]</span>&nbsp;<span class="op" id="6868669">==</span>&nbsp;<span class="string" id="6868672">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868679">h</span><span class="op" id="6868680">.</span><span class="ident" id="6868681">Reset</span><span class="op" id="6868686">(</span><span class="op" id="6868687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868692">h</span><span class="op" id="6868693">.</span><span class="ident" id="6868694">Write</span><span class="op" id="6868699">(</span><span class="ident" id="6868700">msg</span><span class="op" id="6868703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868708">hashed</span>&nbsp;<span class="op" id="6868715">:=</span>&nbsp;<span class="ident" id="6868718">h</span><span class="op" id="6868719">.</span><span class="ident" id="6868720">Sum</span><span class="op" id="6868723">(</span><span class="ident" id="6868724">hashed</span><span class="op" id="6868730">[</span><span class="op" id="6868731">:</span><span class="num" id="6868732">0</span><span class="op" id="6868733">]</span><span class="op" id="6868734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868739">if</span>&nbsp;<span class="ident" id="6868742">Verify</span><span class="op" id="6868748">(</span><span class="ident" id="6868749">pub</span><span class="op" id="6868752">,</span>&nbsp;<span class="ident" id="6868754">hashed</span><span class="op" id="6868760">,</span>&nbsp;<span class="ident" id="6868762">r</span><span class="op" id="6868763">,</span>&nbsp;<span class="ident" id="6868765">s</span><span class="op" id="6868766">)</span>&nbsp;<span class="op" id="6868768">!=</span>&nbsp;<span class="ident" id="6868771">expected</span>&nbsp;<span class="op" id="6868780">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868786">t</span><span class="op" id="6868787">.</span><span class="ident" id="6868788">Fatalf</span><span class="op" id="6868794">(</span><span class="string" id="6868795">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6868824">,</span>&nbsp;<span class="ident" id="6868826">lineNo</span><span class="op" id="6868832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868841">default</span><span class="op" id="6868848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868853">t</span><span class="op" id="6868854">.</span><span class="ident" id="6868855">Fatalf</span><span class="op" id="6868861">(</span><span class="string" id="6868862">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6868895">,</span>&nbsp;<span class="ident" id="6868897">lineNo</span><span class="op" id="6868903">,</span>&nbsp;<span class="ident" id="6868905">line</span><span class="op" id="6868909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868913">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868916">}</span><br>
<span class="lineno"></span><span class="op" id="6868918">}</span>
</div>
</body>
</html>
