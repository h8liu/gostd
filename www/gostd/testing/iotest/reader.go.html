<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4625839">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4625894">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4625948">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4625999">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="4626075">package</span>&nbsp;<span class="ident" id="4626083">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626091">import</span>&nbsp;<span class="op" id="4626098">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4626101">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4626111">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4626116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626119">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="4626169">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="4626220">func</span>&nbsp;<span class="ident" id="4626225">OneByteReader</span><span class="op" id="4626238">(</span><span class="ident" id="4626239">r</span>&nbsp;<span class="ident" id="4626241">io</span><span class="op" id="4626243">.</span><span class="ident" id="4626244">Reader</span><span class="op" id="4626250">)</span>&nbsp;<span class="ident" id="4626252">io</span><span class="op" id="4626254">.</span><span class="ident" id="4626255">Reader</span>&nbsp;<span class="op" id="4626262">{</span>&nbsp;<span class="keyword" id="4626264">return</span>&nbsp;<span class="op" id="4626271">&amp;</span><span class="ident" id="4626272">oneByteReader</span><span class="op" id="4626285">{</span><span class="ident" id="4626286">r</span><span class="op" id="4626287">}</span>&nbsp;<span class="op" id="4626289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626292">type</span>&nbsp;<span class="ident" id="4626297">oneByteReader</span>&nbsp;<span class="keyword" id="4626311">struct</span>&nbsp;<span class="op" id="4626318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626321">r</span>&nbsp;<span class="ident" id="4626323">io</span><span class="op" id="4626325">.</span><span class="ident" id="4626326">Reader</span><br>
<span class="lineno"></span><span class="op" id="4626333">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4626336">func</span>&nbsp;<span class="op" id="4626341">(</span><span class="ident" id="4626342">r</span>&nbsp;<span class="op" id="4626344">*</span><span class="ident" id="4626345">oneByteReader</span><span class="op" id="4626358">)</span>&nbsp;<span class="ident" id="4626360">Read</span><span class="op" id="4626364">(</span><span class="ident" id="4626365">p</span>&nbsp;<span class="op" id="4626367">[</span><span class="op" id="4626368">]</span><span class="builtintype" id="4626369">byte</span><span class="op" id="4626373">)</span>&nbsp;<span class="op" id="4626375">(</span><span class="builtintype" id="4626376">int</span><span class="op" id="4626379">,</span>&nbsp;<span class="builtintype" id="4626381">error</span><span class="op" id="4626386">)</span>&nbsp;<span class="op" id="4626388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626391">if</span>&nbsp;<span class="builtinfunc" id="4626394">len</span><span class="op" id="4626397">(</span><span class="ident" id="4626398">p</span><span class="op" id="4626399">)</span>&nbsp;<span class="op" id="4626401">==</span>&nbsp;<span class="num" id="4626404">0</span>&nbsp;<span class="op" id="4626406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626410">return</span>&nbsp;<span class="num" id="4626417">0</span><span class="op" id="4626418">,</span>&nbsp;<span class="ident" id="4626420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626425">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626428">return</span>&nbsp;<span class="ident" id="4626435">r</span><span class="op" id="4626436">.</span><span class="ident" id="4626437">r</span><span class="op" id="4626438">.</span><span class="ident" id="4626439">Read</span><span class="op" id="4626443">(</span><span class="ident" id="4626444">p</span><span class="op" id="4626445">[</span><span class="num" id="4626446">0</span><span class="op" id="4626447">:</span><span class="num" id="4626448">1</span><span class="op" id="4626449">]</span><span class="op" id="4626450">)</span><br>
<span class="lineno"></span><span class="op" id="4626452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626455">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="4626507">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="4626558">func</span>&nbsp;<span class="ident" id="4626563">HalfReader</span><span class="op" id="4626573">(</span><span class="ident" id="4626574">r</span>&nbsp;<span class="ident" id="4626576">io</span><span class="op" id="4626578">.</span><span class="ident" id="4626579">Reader</span><span class="op" id="4626585">)</span>&nbsp;<span class="ident" id="4626587">io</span><span class="op" id="4626589">.</span><span class="ident" id="4626590">Reader</span>&nbsp;<span class="op" id="4626597">{</span>&nbsp;<span class="keyword" id="4626599">return</span>&nbsp;<span class="op" id="4626606">&amp;</span><span class="ident" id="4626607">halfReader</span><span class="op" id="4626617">{</span><span class="ident" id="4626618">r</span><span class="op" id="4626619">}</span>&nbsp;<span class="op" id="4626621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4626624">type</span>&nbsp;<span class="ident" id="4626629">halfReader</span>&nbsp;<span class="keyword" id="4626640">struct</span>&nbsp;<span class="op" id="4626647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626650">r</span>&nbsp;<span class="ident" id="4626652">io</span><span class="op" id="4626654">.</span><span class="ident" id="4626655">Reader</span><br>
<span class="lineno"></span><span class="op" id="4626662">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4626665">func</span>&nbsp;<span class="op" id="4626670">(</span><span class="ident" id="4626671">r</span>&nbsp;<span class="op" id="4626673">*</span><span class="ident" id="4626674">halfReader</span><span class="op" id="4626684">)</span>&nbsp;<span class="ident" id="4626686">Read</span><span class="op" id="4626690">(</span><span class="ident" id="4626691">p</span>&nbsp;<span class="op" id="4626693">[</span><span class="op" id="4626694">]</span><span class="builtintype" id="4626695">byte</span><span class="op" id="4626699">)</span>&nbsp;<span class="op" id="4626701">(</span><span class="builtintype" id="4626702">int</span><span class="op" id="4626705">,</span>&nbsp;<span class="builtintype" id="4626707">error</span><span class="op" id="4626712">)</span>&nbsp;<span class="op" id="4626714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626717">return</span>&nbsp;<span class="ident" id="4626724">r</span><span class="op" id="4626725">.</span><span class="ident" id="4626726">r</span><span class="op" id="4626727">.</span><span class="ident" id="4626728">Read</span><span class="op" id="4626732">(</span><span class="ident" id="4626733">p</span><span class="op" id="4626734">[</span><span class="num" id="4626735">0</span>&nbsp;<span class="op" id="4626737">:</span>&nbsp;<span class="op" id="4626739">(</span><span class="builtinfunc" id="4626740">len</span><span class="op" id="4626743">(</span><span class="ident" id="4626744">p</span><span class="op" id="4626745">)</span><span class="op" id="4626746">+</span><span class="num" id="4626747">1</span><span class="op" id="4626748">)</span><span class="op" id="4626749">/</span><span class="num" id="4626750">2</span><span class="op" id="4626751">]</span><span class="op" id="4626752">)</span><br>
<span class="lineno"></span><span class="op" id="4626754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4626757">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4626834">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4626912">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4626988">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="4627066">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="4627112">func</span>&nbsp;<span class="ident" id="4627117">DataErrReader</span><span class="op" id="4627130">(</span><span class="ident" id="4627131">r</span>&nbsp;<span class="ident" id="4627133">io</span><span class="op" id="4627135">.</span><span class="ident" id="4627136">Reader</span><span class="op" id="4627142">)</span>&nbsp;<span class="ident" id="4627144">io</span><span class="op" id="4627146">.</span><span class="ident" id="4627147">Reader</span>&nbsp;<span class="op" id="4627154">{</span>&nbsp;<span class="keyword" id="4627156">return</span>&nbsp;<span class="op" id="4627163">&amp;</span><span class="ident" id="4627164">dataErrReader</span><span class="op" id="4627177">{</span><span class="ident" id="4627178">r</span><span class="op" id="4627179">,</span>&nbsp;<span class="ident" id="4627181">nil</span><span class="op" id="4627184">,</span>&nbsp;<span class="builtinfunc" id="4627186">make</span><span class="op" id="4627190">(</span><span class="op" id="4627191">[</span><span class="op" id="4627192">]</span><span class="builtintype" id="4627193">byte</span><span class="op" id="4627197">,</span>&nbsp;<span class="num" id="4627199">1024</span><span class="op" id="4627203">)</span><span class="op" id="4627204">}</span>&nbsp;<span class="op" id="4627206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627209">type</span>&nbsp;<span class="ident" id="4627214">dataErrReader</span>&nbsp;<span class="keyword" id="4627228">struct</span>&nbsp;<span class="op" id="4627235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627238">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627245">io</span><span class="op" id="4627247">.</span><span class="ident" id="4627248">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627256">unread</span>&nbsp;<span class="op" id="4627263">[</span><span class="op" id="4627264">]</span><span class="builtintype" id="4627265">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627271">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4627278">[</span><span class="op" id="4627279">]</span><span class="builtintype" id="4627280">byte</span><br>
<span class="lineno"></span><span class="op" id="4627285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627288">func</span>&nbsp;<span class="op" id="4627293">(</span><span class="ident" id="4627294">r</span>&nbsp;<span class="op" id="4627296">*</span><span class="ident" id="4627297">dataErrReader</span><span class="op" id="4627310">)</span>&nbsp;<span class="ident" id="4627312">Read</span><span class="op" id="4627316">(</span><span class="ident" id="4627317">p</span>&nbsp;<span class="op" id="4627319">[</span><span class="op" id="4627320">]</span><span class="builtintype" id="4627321">byte</span><span class="op" id="4627325">)</span>&nbsp;<span class="op" id="4627327">(</span><span class="ident" id="4627328">n</span>&nbsp;<span class="builtintype" id="4627330">int</span><span class="op" id="4627333">,</span>&nbsp;<span class="ident" id="4627335">err</span>&nbsp;<span class="builtintype" id="4627339">error</span><span class="op" id="4627344">)</span>&nbsp;<span class="op" id="4627346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4627349">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4627394">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627449">for</span>&nbsp;<span class="op" id="4627453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627457">if</span>&nbsp;<span class="builtinfunc" id="4627460">len</span><span class="op" id="4627463">(</span><span class="ident" id="4627464">r</span><span class="op" id="4627465">.</span><span class="ident" id="4627466">unread</span><span class="op" id="4627472">)</span>&nbsp;<span class="op" id="4627474">==</span>&nbsp;<span class="num" id="4627477">0</span>&nbsp;<span class="op" id="4627479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627484">n1</span><span class="op" id="4627486">,</span>&nbsp;<span class="ident" id="4627488">err1</span>&nbsp;<span class="op" id="4627493">:=</span>&nbsp;<span class="ident" id="4627496">r</span><span class="op" id="4627497">.</span><span class="ident" id="4627498">r</span><span class="op" id="4627499">.</span><span class="ident" id="4627500">Read</span><span class="op" id="4627504">(</span><span class="ident" id="4627505">r</span><span class="op" id="4627506">.</span><span class="ident" id="4627507">data</span><span class="op" id="4627511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627516">r</span><span class="op" id="4627517">.</span><span class="ident" id="4627518">unread</span>&nbsp;<span class="op" id="4627525">=</span>&nbsp;<span class="ident" id="4627527">r</span><span class="op" id="4627528">.</span><span class="ident" id="4627529">data</span><span class="op" id="4627533">[</span><span class="num" id="4627534">0</span><span class="op" id="4627535">:</span><span class="ident" id="4627536">n1</span><span class="op" id="4627538">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627543">err</span>&nbsp;<span class="op" id="4627547">=</span>&nbsp;<span class="ident" id="4627549">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627560">if</span>&nbsp;<span class="ident" id="4627563">n</span>&nbsp;<span class="op" id="4627565">&gt;</span>&nbsp;<span class="num" id="4627567">0</span>&nbsp;<span class="op" id="4627569">||</span>&nbsp;<span class="ident" id="4627572">err</span>&nbsp;<span class="op" id="4627576">!=</span>&nbsp;<span class="ident" id="4627579">nil</span>&nbsp;<span class="op" id="4627583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627588">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627596">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627600">n</span>&nbsp;<span class="op" id="4627602">=</span>&nbsp;<span class="builtinfunc" id="4627604">copy</span><span class="op" id="4627608">(</span><span class="ident" id="4627609">p</span><span class="op" id="4627610">,</span>&nbsp;<span class="ident" id="4627612">r</span><span class="op" id="4627613">.</span><span class="ident" id="4627614">unread</span><span class="op" id="4627620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627624">r</span><span class="op" id="4627625">.</span><span class="ident" id="4627626">unread</span>&nbsp;<span class="op" id="4627633">=</span>&nbsp;<span class="ident" id="4627635">r</span><span class="op" id="4627636">.</span><span class="ident" id="4627637">unread</span><span class="op" id="4627643">[</span><span class="ident" id="4627644">n</span><span class="op" id="4627645">:</span><span class="op" id="4627646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627652">return</span><br>
<span class="lineno"></span><span class="op" id="4627659">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4627662">var</span>&nbsp;<span class="ident" id="4627666">ErrTimeout</span>&nbsp;<span class="op" id="4627677">=</span>&nbsp;<span class="ident" id="4627679">errors</span><span class="op" id="4627685">.</span><span class="ident" id="4627686">New</span><span class="op" id="4627689">(</span><span class="string" id="4627690">&#34;timeout&#34;</span><span class="op" id="4627699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4627702">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="4627757">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="4627809">func</span>&nbsp;<span class="ident" id="4627814">TimeoutReader</span><span class="op" id="4627827">(</span><span class="ident" id="4627828">r</span>&nbsp;<span class="ident" id="4627830">io</span><span class="op" id="4627832">.</span><span class="ident" id="4627833">Reader</span><span class="op" id="4627839">)</span>&nbsp;<span class="ident" id="4627841">io</span><span class="op" id="4627843">.</span><span class="ident" id="4627844">Reader</span>&nbsp;<span class="op" id="4627851">{</span>&nbsp;<span class="keyword" id="4627853">return</span>&nbsp;<span class="op" id="4627860">&amp;</span><span class="ident" id="4627861">timeoutReader</span><span class="op" id="4627874">{</span><span class="ident" id="4627875">r</span><span class="op" id="4627876">,</span>&nbsp;<span class="num" id="4627878">0</span><span class="op" id="4627879">}</span>&nbsp;<span class="op" id="4627881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627884">type</span>&nbsp;<span class="ident" id="4627889">timeoutReader</span>&nbsp;<span class="keyword" id="4627903">struct</span>&nbsp;<span class="op" id="4627910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627913">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627919">io</span><span class="op" id="4627921">.</span><span class="ident" id="4627922">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627930">count</span>&nbsp;<span class="builtintype" id="4627936">int</span><br>
<span class="lineno">80</span><span class="op" id="4627940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4627943">func</span>&nbsp;<span class="op" id="4627948">(</span><span class="ident" id="4627949">r</span>&nbsp;<span class="op" id="4627951">*</span><span class="ident" id="4627952">timeoutReader</span><span class="op" id="4627965">)</span>&nbsp;<span class="ident" id="4627967">Read</span><span class="op" id="4627971">(</span><span class="ident" id="4627972">p</span>&nbsp;<span class="op" id="4627974">[</span><span class="op" id="4627975">]</span><span class="builtintype" id="4627976">byte</span><span class="op" id="4627980">)</span>&nbsp;<span class="op" id="4627982">(</span><span class="builtintype" id="4627983">int</span><span class="op" id="4627986">,</span>&nbsp;<span class="builtintype" id="4627988">error</span><span class="op" id="4627993">)</span>&nbsp;<span class="op" id="4627995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627998">r</span><span class="op" id="4627999">.</span><span class="ident" id="4628000">count</span><span class="op" id="4628005">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628009">if</span>&nbsp;<span class="ident" id="4628012">r</span><span class="op" id="4628013">.</span><span class="ident" id="4628014">count</span>&nbsp;<span class="op" id="4628020">==</span>&nbsp;<span class="num" id="4628023">2</span>&nbsp;<span class="op" id="4628025">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628029">return</span>&nbsp;<span class="num" id="4628036">0</span><span class="op" id="4628037">,</span>&nbsp;<span class="ident" id="4628039">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628054">return</span>&nbsp;<span class="ident" id="4628061">r</span><span class="op" id="4628062">.</span><span class="ident" id="4628063">r</span><span class="op" id="4628064">.</span><span class="ident" id="4628065">Read</span><span class="op" id="4628069">(</span><span class="ident" id="4628070">p</span><span class="op" id="4628071">)</span><br>
<span class="lineno"></span><span class="op" id="4628073">}</span>
</div>
</body>
</html>
