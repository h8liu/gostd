<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2008801">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2008856">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2008910">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2008961">package</span>&nbsp;<span class="ident" id="2008969">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2008974">import</span>&nbsp;<span class="op" id="2008981">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2008984">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2008992">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2009003">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2009018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2009021">const</span>&nbsp;<span class="op" id="2009027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009030">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009063">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009110">nByte</span>&nbsp;<span class="op" id="2009116">=</span>&nbsp;<span class="num" id="2009118">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009123">ldigits</span>&nbsp;<span class="op" id="2009131">=</span>&nbsp;<span class="string" id="2009133">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009153">udigits</span>&nbsp;<span class="op" id="2009161">=</span>&nbsp;<span class="string" id="2009163">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2009182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2009185">const</span>&nbsp;<span class="op" id="2009191">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009194">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2009203">=</span>&nbsp;<span class="builtintype" id="2009205">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009211">unsigned</span>&nbsp;<span class="op" id="2009220">=</span>&nbsp;<span class="builtintype" id="2009222">false</span><br>
<span class="lineno">25</span><span class="op" id="2009228">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2009231">var</span>&nbsp;<span class="ident" id="2009235">padZeroBytes</span>&nbsp;<span class="op" id="2009248">=</span>&nbsp;<span class="builtinfunc" id="2009250">make</span><span class="op" id="2009254">(</span><span class="op" id="2009255">[</span><span class="op" id="2009256">]</span><span class="builtintype" id="2009257">byte</span><span class="op" id="2009261">,</span>&nbsp;<span class="ident" id="2009263">nByte</span><span class="op" id="2009268">)</span><br>
<span class="lineno"></span><span class="keyword" id="2009270">var</span>&nbsp;<span class="ident" id="2009274">padSpaceBytes</span>&nbsp;<span class="op" id="2009288">=</span>&nbsp;<span class="builtinfunc" id="2009290">make</span><span class="op" id="2009294">(</span><span class="op" id="2009295">[</span><span class="op" id="2009296">]</span><span class="builtintype" id="2009297">byte</span><span class="op" id="2009301">,</span>&nbsp;<span class="ident" id="2009303">nByte</span><span class="op" id="2009308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2009311">func</span>&nbsp;<span class="ident" id="2009316">init</span><span class="op" id="2009320">(</span><span class="op" id="2009321">)</span>&nbsp;<span class="op" id="2009323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009326">for</span>&nbsp;<span class="ident" id="2009330">i</span>&nbsp;<span class="op" id="2009332">:=</span>&nbsp;<span class="num" id="2009335">0</span><span class="op" id="2009336">;</span>&nbsp;<span class="ident" id="2009338">i</span>&nbsp;<span class="op" id="2009340">&lt;</span>&nbsp;<span class="ident" id="2009342">nByte</span><span class="op" id="2009347">;</span>&nbsp;<span class="ident" id="2009349">i</span><span class="op" id="2009350">++</span>&nbsp;<span class="op" id="2009353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009357">padZeroBytes</span><span class="op" id="2009369">[</span><span class="ident" id="2009370">i</span><span class="op" id="2009371">]</span>&nbsp;<span class="op" id="2009373">=</span>&nbsp;<span class="string" id="2009375">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009381">padSpaceBytes</span><span class="op" id="2009394">[</span><span class="ident" id="2009395">i</span><span class="op" id="2009396">]</span>&nbsp;<span class="op" id="2009398">=</span>&nbsp;<span class="string" id="2009400">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009405">}</span><br>
<span class="lineno">35</span><span class="op" id="2009407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2009410">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2009466">type</span>&nbsp;<span class="ident" id="2009471">fmtFlags</span>&nbsp;<span class="keyword" id="2009480">struct</span>&nbsp;<span class="op" id="2009487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009490">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2009502">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009508">precPresent</span>&nbsp;<span class="builtintype" id="2009520">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009526">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009538">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009544">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009556">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009562">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009574">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009580">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009592">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009598">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009610">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009616">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009628">bool</span>&nbsp;<span class="comment" id="2009633">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009674">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2009686">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009693">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009752">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2009819">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009873">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2009880">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009886">sharpV</span>&nbsp;<span class="builtintype" id="2009893">bool</span><br>
<span class="lineno"></span><span class="op" id="2009898">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2009901">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2009951">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2010010">type</span>&nbsp;<span class="ident" id="2010015">fmt</span>&nbsp;<span class="keyword" id="2010019">struct</span>&nbsp;<span class="op" id="2010026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010029">intbuf</span>&nbsp;<span class="op" id="2010036">[</span><span class="ident" id="2010037">nByte</span><span class="op" id="2010042">]</span><span class="builtintype" id="2010043">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010049">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2010056">*</span><span class="ident" id="2010057">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010065">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010086">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2010091">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010096">prec</span>&nbsp;<span class="builtintype" id="2010101">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010106">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2010115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2010118">func</span>&nbsp;<span class="op" id="2010123">(</span><span class="ident" id="2010124">f</span>&nbsp;<span class="op" id="2010126">*</span><span class="ident" id="2010127">fmt</span><span class="op" id="2010130">)</span>&nbsp;<span class="ident" id="2010132">clearflags</span><span class="op" id="2010142">(</span><span class="op" id="2010143">)</span>&nbsp;<span class="op" id="2010145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010148">f</span><span class="op" id="2010149">.</span><span class="ident" id="2010150">fmtFlags</span>&nbsp;<span class="op" id="2010159">=</span>&nbsp;<span class="ident" id="2010161">fmtFlags</span><span class="op" id="2010169">{</span><span class="op" id="2010170">}</span><br>
<span class="lineno"></span><span class="op" id="2010172">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2010175">func</span>&nbsp;<span class="op" id="2010180">(</span><span class="ident" id="2010181">f</span>&nbsp;<span class="op" id="2010183">*</span><span class="ident" id="2010184">fmt</span><span class="op" id="2010187">)</span>&nbsp;<span class="ident" id="2010189">init</span><span class="op" id="2010193">(</span><span class="ident" id="2010194">buf</span>&nbsp;<span class="op" id="2010198">*</span><span class="ident" id="2010199">buffer</span><span class="op" id="2010205">)</span>&nbsp;<span class="op" id="2010207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010210">f</span><span class="op" id="2010211">.</span><span class="ident" id="2010212">buf</span>&nbsp;<span class="op" id="2010216">=</span>&nbsp;<span class="ident" id="2010218">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010223">f</span><span class="op" id="2010224">.</span><span class="ident" id="2010225">clearflags</span><span class="op" id="2010235">(</span><span class="op" id="2010236">)</span><br>
<span class="lineno"></span><span class="op" id="2010238">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2010241">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2010327">func</span>&nbsp;<span class="op" id="2010332">(</span><span class="ident" id="2010333">f</span>&nbsp;<span class="op" id="2010335">*</span><span class="ident" id="2010336">fmt</span><span class="op" id="2010339">)</span>&nbsp;<span class="ident" id="2010341">computePadding</span><span class="op" id="2010355">(</span><span class="ident" id="2010356">width</span>&nbsp;<span class="builtintype" id="2010362">int</span><span class="op" id="2010365">)</span>&nbsp;<span class="op" id="2010367">(</span><span class="ident" id="2010368">padding</span>&nbsp;<span class="op" id="2010376">[</span><span class="op" id="2010377">]</span><span class="builtintype" id="2010378">byte</span><span class="op" id="2010382">,</span>&nbsp;<span class="ident" id="2010384">leftWidth</span><span class="op" id="2010393">,</span>&nbsp;<span class="ident" id="2010395">rightWidth</span>&nbsp;<span class="builtintype" id="2010406">int</span><span class="op" id="2010409">)</span>&nbsp;<span class="op" id="2010411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010414">left</span>&nbsp;<span class="op" id="2010419">:=</span>&nbsp;<span class="op" id="2010422">!</span><span class="ident" id="2010423">f</span><span class="op" id="2010424">.</span><span class="ident" id="2010425">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010432">w</span>&nbsp;<span class="op" id="2010434">:=</span>&nbsp;<span class="ident" id="2010437">f</span><span class="op" id="2010438">.</span><span class="ident" id="2010439">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010444">if</span>&nbsp;<span class="ident" id="2010447">w</span>&nbsp;<span class="op" id="2010449">&lt;</span>&nbsp;<span class="num" id="2010451">0</span>&nbsp;<span class="op" id="2010453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010457">left</span>&nbsp;<span class="op" id="2010462">=</span>&nbsp;<span class="builtintype" id="2010464">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010472">w</span>&nbsp;<span class="op" id="2010474">=</span>&nbsp;<span class="op" id="2010476">-</span><span class="ident" id="2010477">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010483">w</span>&nbsp;<span class="op" id="2010485">-=</span>&nbsp;<span class="ident" id="2010488">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010495">if</span>&nbsp;<span class="ident" id="2010498">w</span>&nbsp;<span class="op" id="2010500">&gt;</span>&nbsp;<span class="num" id="2010502">0</span>&nbsp;<span class="op" id="2010504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010508">if</span>&nbsp;<span class="ident" id="2010511">left</span>&nbsp;<span class="op" id="2010516">&amp;&amp;</span>&nbsp;<span class="ident" id="2010519">f</span><span class="op" id="2010520">.</span><span class="ident" id="2010521">zero</span>&nbsp;<span class="op" id="2010526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010531">return</span>&nbsp;<span class="ident" id="2010538">padZeroBytes</span><span class="op" id="2010550">,</span>&nbsp;<span class="ident" id="2010552">w</span><span class="op" id="2010553">,</span>&nbsp;<span class="num" id="2010555">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010563">if</span>&nbsp;<span class="ident" id="2010566">left</span>&nbsp;<span class="op" id="2010571">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010576">return</span>&nbsp;<span class="ident" id="2010583">padSpaceBytes</span><span class="op" id="2010596">,</span>&nbsp;<span class="ident" id="2010598">w</span><span class="op" id="2010599">,</span>&nbsp;<span class="num" id="2010601">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010605">}</span>&nbsp;<span class="keyword" id="2010607">else</span>&nbsp;<span class="op" id="2010612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010617">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010658">return</span>&nbsp;<span class="ident" id="2010665">padSpaceBytes</span><span class="op" id="2010678">,</span>&nbsp;<span class="num" id="2010680">0</span><span class="op" id="2010681">,</span>&nbsp;<span class="ident" id="2010683">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010687">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010693">return</span><br>
<span class="lineno"></span><span class="op" id="2010700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2010703">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2010749">func</span>&nbsp;<span class="op" id="2010754">(</span><span class="ident" id="2010755">f</span>&nbsp;<span class="op" id="2010757">*</span><span class="ident" id="2010758">fmt</span><span class="op" id="2010761">)</span>&nbsp;<span class="ident" id="2010763">writePadding</span><span class="op" id="2010775">(</span><span class="ident" id="2010776">n</span>&nbsp;<span class="builtintype" id="2010778">int</span><span class="op" id="2010781">,</span>&nbsp;<span class="ident" id="2010783">padding</span>&nbsp;<span class="op" id="2010791">[</span><span class="op" id="2010792">]</span><span class="builtintype" id="2010793">byte</span><span class="op" id="2010797">)</span>&nbsp;<span class="op" id="2010799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010802">for</span>&nbsp;<span class="ident" id="2010806">n</span>&nbsp;<span class="op" id="2010808">&gt;</span>&nbsp;<span class="num" id="2010810">0</span>&nbsp;<span class="op" id="2010812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010816">m</span>&nbsp;<span class="op" id="2010818">:=</span>&nbsp;<span class="ident" id="2010821">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010825">if</span>&nbsp;<span class="ident" id="2010828">m</span>&nbsp;<span class="op" id="2010830">&gt;</span>&nbsp;<span class="ident" id="2010832">nByte</span>&nbsp;<span class="op" id="2010838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010843">m</span>&nbsp;<span class="op" id="2010845">=</span>&nbsp;<span class="ident" id="2010847">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010859">f</span><span class="op" id="2010860">.</span><span class="ident" id="2010861">buf</span><span class="op" id="2010864">.</span><span class="ident" id="2010865">Write</span><span class="op" id="2010870">(</span><span class="ident" id="2010871">padding</span><span class="op" id="2010878">[</span><span class="num" id="2010879">0</span><span class="op" id="2010880">:</span><span class="ident" id="2010881">m</span><span class="op" id="2010882">]</span><span class="op" id="2010883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010887">n</span>&nbsp;<span class="op" id="2010889">-=</span>&nbsp;<span class="ident" id="2010892">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010895">}</span><br>
<span class="lineno"></span><span class="op" id="2010897">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2010900">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2010979">func</span>&nbsp;<span class="op" id="2010984">(</span><span class="ident" id="2010985">f</span>&nbsp;<span class="op" id="2010987">*</span><span class="ident" id="2010988">fmt</span><span class="op" id="2010991">)</span>&nbsp;<span class="ident" id="2010993">pad</span><span class="op" id="2010996">(</span><span class="ident" id="2010997">b</span>&nbsp;<span class="op" id="2010999">[</span><span class="op" id="2011000">]</span><span class="builtintype" id="2011001">byte</span><span class="op" id="2011005">)</span>&nbsp;<span class="op" id="2011007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011010">if</span>&nbsp;<span class="op" id="2011013">!</span><span class="ident" id="2011014">f</span><span class="op" id="2011015">.</span><span class="ident" id="2011016">widPresent</span>&nbsp;<span class="op" id="2011027">||</span>&nbsp;<span class="ident" id="2011030">f</span><span class="op" id="2011031">.</span><span class="ident" id="2011032">wid</span>&nbsp;<span class="op" id="2011036">==</span>&nbsp;<span class="num" id="2011039">0</span>&nbsp;<span class="op" id="2011041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011045">f</span><span class="op" id="2011046">.</span><span class="ident" id="2011047">buf</span><span class="op" id="2011050">.</span><span class="ident" id="2011051">Write</span><span class="op" id="2011056">(</span><span class="ident" id="2011057">b</span><span class="op" id="2011058">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011073">padding</span><span class="op" id="2011080">,</span>&nbsp;<span class="ident" id="2011082">left</span><span class="op" id="2011086">,</span>&nbsp;<span class="ident" id="2011088">right</span>&nbsp;<span class="op" id="2011094">:=</span>&nbsp;<span class="ident" id="2011097">f</span><span class="op" id="2011098">.</span><span class="ident" id="2011099">computePadding</span><span class="op" id="2011113">(</span><span class="ident" id="2011114">utf8</span><span class="op" id="2011118">.</span><span class="ident" id="2011119">RuneCount</span><span class="op" id="2011128">(</span><span class="ident" id="2011129">b</span><span class="op" id="2011130">)</span><span class="op" id="2011131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011134">if</span>&nbsp;<span class="ident" id="2011137">left</span>&nbsp;<span class="op" id="2011142">&gt;</span>&nbsp;<span class="num" id="2011144">0</span>&nbsp;<span class="op" id="2011146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011150">f</span><span class="op" id="2011151">.</span><span class="ident" id="2011152">writePadding</span><span class="op" id="2011164">(</span><span class="ident" id="2011165">left</span><span class="op" id="2011169">,</span>&nbsp;<span class="ident" id="2011171">padding</span><span class="op" id="2011178">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011184">f</span><span class="op" id="2011185">.</span><span class="ident" id="2011186">buf</span><span class="op" id="2011189">.</span><span class="ident" id="2011190">Write</span><span class="op" id="2011195">(</span><span class="ident" id="2011196">b</span><span class="op" id="2011197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011200">if</span>&nbsp;<span class="ident" id="2011203">right</span>&nbsp;<span class="op" id="2011209">&gt;</span>&nbsp;<span class="num" id="2011211">0</span>&nbsp;<span class="op" id="2011213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011217">f</span><span class="op" id="2011218">.</span><span class="ident" id="2011219">writePadding</span><span class="op" id="2011231">(</span><span class="ident" id="2011232">right</span><span class="op" id="2011237">,</span>&nbsp;<span class="ident" id="2011239">padding</span><span class="op" id="2011246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011249">}</span><br>
<span class="lineno">125</span><span class="op" id="2011251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2011254">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2011337">func</span>&nbsp;<span class="op" id="2011342">(</span><span class="ident" id="2011343">f</span>&nbsp;<span class="op" id="2011345">*</span><span class="ident" id="2011346">fmt</span><span class="op" id="2011349">)</span>&nbsp;<span class="ident" id="2011351">padString</span><span class="op" id="2011360">(</span><span class="ident" id="2011361">s</span>&nbsp;<span class="builtintype" id="2011363">string</span><span class="op" id="2011369">)</span>&nbsp;<span class="op" id="2011371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011374">if</span>&nbsp;<span class="op" id="2011377">!</span><span class="ident" id="2011378">f</span><span class="op" id="2011379">.</span><span class="ident" id="2011380">widPresent</span>&nbsp;<span class="op" id="2011391">||</span>&nbsp;<span class="ident" id="2011394">f</span><span class="op" id="2011395">.</span><span class="ident" id="2011396">wid</span>&nbsp;<span class="op" id="2011400">==</span>&nbsp;<span class="num" id="2011403">0</span>&nbsp;<span class="op" id="2011405">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011409">f</span><span class="op" id="2011410">.</span><span class="ident" id="2011411">buf</span><span class="op" id="2011414">.</span><span class="ident" id="2011415">WriteString</span><span class="op" id="2011426">(</span><span class="ident" id="2011427">s</span><span class="op" id="2011428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011432">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011443">padding</span><span class="op" id="2011450">,</span>&nbsp;<span class="ident" id="2011452">left</span><span class="op" id="2011456">,</span>&nbsp;<span class="ident" id="2011458">right</span>&nbsp;<span class="op" id="2011464">:=</span>&nbsp;<span class="ident" id="2011467">f</span><span class="op" id="2011468">.</span><span class="ident" id="2011469">computePadding</span><span class="op" id="2011483">(</span><span class="ident" id="2011484">utf8</span><span class="op" id="2011488">.</span><span class="ident" id="2011489">RuneCountInString</span><span class="op" id="2011506">(</span><span class="ident" id="2011507">s</span><span class="op" id="2011508">)</span><span class="op" id="2011509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011512">if</span>&nbsp;<span class="ident" id="2011515">left</span>&nbsp;<span class="op" id="2011520">&gt;</span>&nbsp;<span class="num" id="2011522">0</span>&nbsp;<span class="op" id="2011524">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011528">f</span><span class="op" id="2011529">.</span><span class="ident" id="2011530">writePadding</span><span class="op" id="2011542">(</span><span class="ident" id="2011543">left</span><span class="op" id="2011547">,</span>&nbsp;<span class="ident" id="2011549">padding</span><span class="op" id="2011556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011562">f</span><span class="op" id="2011563">.</span><span class="ident" id="2011564">buf</span><span class="op" id="2011567">.</span><span class="ident" id="2011568">WriteString</span><span class="op" id="2011579">(</span><span class="ident" id="2011580">s</span><span class="op" id="2011581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011584">if</span>&nbsp;<span class="ident" id="2011587">right</span>&nbsp;<span class="op" id="2011593">&gt;</span>&nbsp;<span class="num" id="2011595">0</span>&nbsp;<span class="op" id="2011597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011601">f</span><span class="op" id="2011602">.</span><span class="ident" id="2011603">writePadding</span><span class="op" id="2011615">(</span><span class="ident" id="2011616">right</span><span class="op" id="2011621">,</span>&nbsp;<span class="ident" id="2011623">padding</span><span class="op" id="2011630">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011633">}</span><br>
<span class="lineno"></span><span class="op" id="2011635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2011638">var</span>&nbsp;<span class="op" id="2011642">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011645">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2011656">=</span>&nbsp;<span class="op" id="2011658">[</span><span class="op" id="2011659">]</span><span class="builtintype" id="2011660">byte</span><span class="op" id="2011664">(</span><span class="string" id="2011665">&#34;true&#34;</span><span class="op" id="2011671">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011674">falseBytes</span>&nbsp;<span class="op" id="2011685">=</span>&nbsp;<span class="op" id="2011687">[</span><span class="op" id="2011688">]</span><span class="builtintype" id="2011689">byte</span><span class="op" id="2011693">(</span><span class="string" id="2011694">&#34;false&#34;</span><span class="op" id="2011701">)</span><br>
<span class="lineno"></span><span class="op" id="2011703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2011706">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2011740">func</span>&nbsp;<span class="op" id="2011745">(</span><span class="ident" id="2011746">f</span>&nbsp;<span class="op" id="2011748">*</span><span class="ident" id="2011749">fmt</span><span class="op" id="2011752">)</span>&nbsp;<span class="ident" id="2011754">fmt_boolean</span><span class="op" id="2011765">(</span><span class="ident" id="2011766">v</span>&nbsp;<span class="builtintype" id="2011768">bool</span><span class="op" id="2011772">)</span>&nbsp;<span class="op" id="2011774">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011777">if</span>&nbsp;<span class="ident" id="2011780">v</span>&nbsp;<span class="op" id="2011782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011786">f</span><span class="op" id="2011787">.</span><span class="ident" id="2011788">pad</span><span class="op" id="2011791">(</span><span class="ident" id="2011792">trueBytes</span><span class="op" id="2011801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011804">}</span>&nbsp;<span class="keyword" id="2011806">else</span>&nbsp;<span class="op" id="2011811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011815">f</span><span class="op" id="2011816">.</span><span class="ident" id="2011817">pad</span><span class="op" id="2011820">(</span><span class="ident" id="2011821">falseBytes</span><span class="op" id="2011831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011834">}</span><br>
<span class="lineno">155</span><span class="op" id="2011836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2011839">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2011921">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2011952">func</span>&nbsp;<span class="op" id="2011957">(</span><span class="ident" id="2011958">f</span>&nbsp;<span class="op" id="2011960">*</span><span class="ident" id="2011961">fmt</span><span class="op" id="2011964">)</span>&nbsp;<span class="ident" id="2011966">integer</span><span class="op" id="2011973">(</span><span class="ident" id="2011974">a</span>&nbsp;<span class="ident" id="2011976">int64</span><span class="op" id="2011981">,</span>&nbsp;<span class="ident" id="2011983">base</span>&nbsp;<span class="ident" id="2011988">uint64</span><span class="op" id="2011994">,</span>&nbsp;<span class="ident" id="2011996">signedness</span>&nbsp;<span class="builtintype" id="2012007">bool</span><span class="op" id="2012011">,</span>&nbsp;<span class="ident" id="2012013">digits</span>&nbsp;<span class="builtintype" id="2012020">string</span><span class="op" id="2012026">)</span>&nbsp;<span class="op" id="2012028">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012031">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012087">if</span>&nbsp;<span class="ident" id="2012090">f</span><span class="op" id="2012091">.</span><span class="ident" id="2012092">precPresent</span>&nbsp;<span class="op" id="2012104">&amp;&amp;</span>&nbsp;<span class="ident" id="2012107">f</span><span class="op" id="2012108">.</span><span class="ident" id="2012109">prec</span>&nbsp;<span class="op" id="2012114">==</span>&nbsp;<span class="num" id="2012117">0</span>&nbsp;<span class="op" id="2012119">&amp;&amp;</span>&nbsp;<span class="ident" id="2012122">a</span>&nbsp;<span class="op" id="2012124">==</span>&nbsp;<span class="num" id="2012127">0</span>&nbsp;<span class="op" id="2012129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012133">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012145">var</span>&nbsp;<span class="ident" id="2012149">buf</span>&nbsp;<span class="op" id="2012153">[</span><span class="op" id="2012154">]</span><span class="builtintype" id="2012155">byte</span>&nbsp;<span class="op" id="2012160">=</span>&nbsp;<span class="ident" id="2012162">f</span><span class="op" id="2012163">.</span><span class="ident" id="2012164">intbuf</span><span class="op" id="2012170">[</span><span class="num" id="2012171">0</span><span class="op" id="2012172">:</span><span class="op" id="2012173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012176">if</span>&nbsp;<span class="ident" id="2012179">f</span><span class="op" id="2012180">.</span><span class="ident" id="2012181">widPresent</span>&nbsp;<span class="op" id="2012192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012196">width</span>&nbsp;<span class="op" id="2012202">:=</span>&nbsp;<span class="ident" id="2012205">f</span><span class="op" id="2012206">.</span><span class="ident" id="2012207">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012213">if</span>&nbsp;<span class="ident" id="2012216">base</span>&nbsp;<span class="op" id="2012221">==</span>&nbsp;<span class="num" id="2012224">16</span>&nbsp;<span class="op" id="2012227">&amp;&amp;</span>&nbsp;<span class="ident" id="2012230">f</span><span class="op" id="2012231">.</span><span class="ident" id="2012232">sharp</span>&nbsp;<span class="op" id="2012238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012243">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012265">width</span>&nbsp;<span class="op" id="2012271">+=</span>&nbsp;<span class="num" id="2012274">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012282">if</span>&nbsp;<span class="ident" id="2012285">width</span>&nbsp;<span class="op" id="2012291">&gt;</span>&nbsp;<span class="ident" id="2012293">nByte</span>&nbsp;<span class="op" id="2012299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012304">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012345">buf</span>&nbsp;<span class="op" id="2012349">=</span>&nbsp;<span class="builtinfunc" id="2012351">make</span><span class="op" id="2012355">(</span><span class="op" id="2012356">[</span><span class="op" id="2012357">]</span><span class="builtintype" id="2012358">byte</span><span class="op" id="2012362">,</span>&nbsp;<span class="ident" id="2012364">width</span><span class="op" id="2012369">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012380">negative</span>&nbsp;<span class="op" id="2012389">:=</span>&nbsp;<span class="ident" id="2012392">signedness</span>&nbsp;<span class="op" id="2012403">==</span>&nbsp;<span class="ident" id="2012406">signed</span>&nbsp;<span class="op" id="2012413">&amp;&amp;</span>&nbsp;<span class="ident" id="2012416">a</span>&nbsp;<span class="op" id="2012418">&lt;</span>&nbsp;<span class="num" id="2012420">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012423">if</span>&nbsp;<span class="ident" id="2012426">negative</span>&nbsp;<span class="op" id="2012435">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012439">a</span>&nbsp;<span class="op" id="2012441">=</span>&nbsp;<span class="op" id="2012443">-</span><span class="ident" id="2012444">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012451">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012516">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012561">prec</span>&nbsp;<span class="op" id="2012566">:=</span>&nbsp;<span class="num" id="2012569">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012572">if</span>&nbsp;<span class="ident" id="2012575">f</span><span class="op" id="2012576">.</span><span class="ident" id="2012577">precPresent</span>&nbsp;<span class="op" id="2012589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012593">prec</span>&nbsp;<span class="op" id="2012598">=</span>&nbsp;<span class="ident" id="2012600">f</span><span class="op" id="2012601">.</span><span class="ident" id="2012602">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012609">f</span><span class="op" id="2012610">.</span><span class="ident" id="2012611">zero</span>&nbsp;<span class="op" id="2012616">=</span>&nbsp;<span class="builtintype" id="2012618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012625">}</span>&nbsp;<span class="keyword" id="2012627">else</span>&nbsp;<span class="keyword" id="2012632">if</span>&nbsp;<span class="ident" id="2012635">f</span><span class="op" id="2012636">.</span><span class="ident" id="2012637">zero</span>&nbsp;<span class="op" id="2012642">&amp;&amp;</span>&nbsp;<span class="ident" id="2012645">f</span><span class="op" id="2012646">.</span><span class="ident" id="2012647">widPresent</span>&nbsp;<span class="op" id="2012658">&amp;&amp;</span>&nbsp;<span class="op" id="2012661">!</span><span class="ident" id="2012662">f</span><span class="op" id="2012663">.</span><span class="ident" id="2012664">minus</span>&nbsp;<span class="op" id="2012670">&amp;&amp;</span>&nbsp;<span class="ident" id="2012673">f</span><span class="op" id="2012674">.</span><span class="ident" id="2012675">wid</span>&nbsp;<span class="op" id="2012679">&gt;</span>&nbsp;<span class="num" id="2012681">0</span>&nbsp;<span class="op" id="2012683">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012687">prec</span>&nbsp;<span class="op" id="2012692">=</span>&nbsp;<span class="ident" id="2012694">f</span><span class="op" id="2012695">.</span><span class="ident" id="2012696">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2012702">if</span>&nbsp;<span class="ident" id="2012705">negative</span>&nbsp;<span class="op" id="2012714">||</span>&nbsp;<span class="ident" id="2012717">f</span><span class="op" id="2012718">.</span><span class="ident" id="2012719">plus</span>&nbsp;<span class="op" id="2012724">||</span>&nbsp;<span class="ident" id="2012727">f</span><span class="op" id="2012728">.</span><span class="ident" id="2012729">space</span>&nbsp;<span class="op" id="2012735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2012740">prec</span><span class="op" id="2012744">--</span>&nbsp;<span class="comment" id="2012747">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2012775">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012779">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012857">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012911">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2012982">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013047">i</span>&nbsp;<span class="op" id="2013049">:=</span>&nbsp;<span class="builtinfunc" id="2013052">len</span><span class="op" id="2013055">(</span><span class="ident" id="2013056">buf</span><span class="op" id="2013059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013062">ua</span>&nbsp;<span class="op" id="2013065">:=</span>&nbsp;<span class="ident" id="2013068">uint64</span><span class="op" id="2013074">(</span><span class="ident" id="2013075">a</span><span class="op" id="2013076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2013079">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2013150">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013190">switch</span>&nbsp;<span class="ident" id="2013197">base</span>&nbsp;<span class="op" id="2013202">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013205">case</span>&nbsp;<span class="num" id="2013210">10</span><span class="op" id="2013212">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013216">for</span>&nbsp;<span class="ident" id="2013220">ua</span>&nbsp;<span class="op" id="2013223">&gt;=</span>&nbsp;<span class="num" id="2013226">10</span>&nbsp;<span class="op" id="2013229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013234">i</span><span class="op" id="2013235">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013241">next</span>&nbsp;<span class="op" id="2013246">:=</span>&nbsp;<span class="ident" id="2013249">ua</span>&nbsp;<span class="op" id="2013252">/</span>&nbsp;<span class="num" id="2013254">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013260">buf</span><span class="op" id="2013263">[</span><span class="ident" id="2013264">i</span><span class="op" id="2013265">]</span>&nbsp;<span class="op" id="2013267">=</span>&nbsp;<span class="builtintype" id="2013269">byte</span><span class="op" id="2013273">(</span><span class="string" id="2013274">&#39;0&#39;</span>&nbsp;<span class="op" id="2013278">+</span>&nbsp;<span class="ident" id="2013280">ua</span>&nbsp;<span class="op" id="2013283">-</span>&nbsp;<span class="ident" id="2013285">next</span><span class="op" id="2013289">*</span><span class="num" id="2013290">10</span><span class="op" id="2013292">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013297">ua</span>&nbsp;<span class="op" id="2013300">=</span>&nbsp;<span class="ident" id="2013302">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013312">case</span>&nbsp;<span class="num" id="2013317">16</span><span class="op" id="2013319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013323">for</span>&nbsp;<span class="ident" id="2013327">ua</span>&nbsp;<span class="op" id="2013330">&gt;=</span>&nbsp;<span class="num" id="2013333">16</span>&nbsp;<span class="op" id="2013336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013341">i</span><span class="op" id="2013342">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013348">buf</span><span class="op" id="2013351">[</span><span class="ident" id="2013352">i</span><span class="op" id="2013353">]</span>&nbsp;<span class="op" id="2013355">=</span>&nbsp;<span class="ident" id="2013357">digits</span><span class="op" id="2013363">[</span><span class="ident" id="2013364">ua</span><span class="op" id="2013366">&amp;</span><span class="num" id="2013367">0xF</span><span class="op" id="2013370">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013375">ua</span>&nbsp;<span class="op" id="2013378">&gt;&gt;=</span>&nbsp;<span class="num" id="2013382">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013389">case</span>&nbsp;<span class="num" id="2013394">8</span><span class="op" id="2013395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013399">for</span>&nbsp;<span class="ident" id="2013403">ua</span>&nbsp;<span class="op" id="2013406">&gt;=</span>&nbsp;<span class="num" id="2013409">8</span>&nbsp;<span class="op" id="2013411">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013416">i</span><span class="op" id="2013417">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013423">buf</span><span class="op" id="2013426">[</span><span class="ident" id="2013427">i</span><span class="op" id="2013428">]</span>&nbsp;<span class="op" id="2013430">=</span>&nbsp;<span class="builtintype" id="2013432">byte</span><span class="op" id="2013436">(</span><span class="string" id="2013437">&#39;0&#39;</span>&nbsp;<span class="op" id="2013441">+</span>&nbsp;<span class="ident" id="2013443">ua</span><span class="op" id="2013445">&amp;</span><span class="num" id="2013446">7</span><span class="op" id="2013447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013452">ua</span>&nbsp;<span class="op" id="2013455">&gt;&gt;=</span>&nbsp;<span class="num" id="2013459">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013466">case</span>&nbsp;<span class="num" id="2013471">2</span><span class="op" id="2013472">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013476">for</span>&nbsp;<span class="ident" id="2013480">ua</span>&nbsp;<span class="op" id="2013483">&gt;=</span>&nbsp;<span class="num" id="2013486">2</span>&nbsp;<span class="op" id="2013488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013493">i</span><span class="op" id="2013494">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013500">buf</span><span class="op" id="2013503">[</span><span class="ident" id="2013504">i</span><span class="op" id="2013505">]</span>&nbsp;<span class="op" id="2013507">=</span>&nbsp;<span class="builtintype" id="2013509">byte</span><span class="op" id="2013513">(</span><span class="string" id="2013514">&#39;0&#39;</span>&nbsp;<span class="op" id="2013518">+</span>&nbsp;<span class="ident" id="2013520">ua</span><span class="op" id="2013522">&amp;</span><span class="num" id="2013523">1</span><span class="op" id="2013524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013529">ua</span>&nbsp;<span class="op" id="2013532">&gt;&gt;=</span>&nbsp;<span class="num" id="2013536">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013540">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013543">default</span><span class="op" id="2013550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2013554">panic</span><span class="op" id="2013559">(</span><span class="string" id="2013560">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2013593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013599">i</span><span class="op" id="2013600">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013604">buf</span><span class="op" id="2013607">[</span><span class="ident" id="2013608">i</span><span class="op" id="2013609">]</span>&nbsp;<span class="op" id="2013611">=</span>&nbsp;<span class="ident" id="2013613">digits</span><span class="op" id="2013619">[</span><span class="ident" id="2013620">ua</span><span class="op" id="2013622">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013625">for</span>&nbsp;<span class="ident" id="2013629">i</span>&nbsp;<span class="op" id="2013631">&gt;</span>&nbsp;<span class="num" id="2013633">0</span>&nbsp;<span class="op" id="2013635">&amp;&amp;</span>&nbsp;<span class="ident" id="2013638">prec</span>&nbsp;<span class="op" id="2013643">&gt;</span>&nbsp;<span class="builtinfunc" id="2013645">len</span><span class="op" id="2013648">(</span><span class="ident" id="2013649">buf</span><span class="op" id="2013652">)</span><span class="op" id="2013653">-</span><span class="ident" id="2013654">i</span>&nbsp;<span class="op" id="2013656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013660">i</span><span class="op" id="2013661">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013666">buf</span><span class="op" id="2013669">[</span><span class="ident" id="2013670">i</span><span class="op" id="2013671">]</span>&nbsp;<span class="op" id="2013673">=</span>&nbsp;<span class="string" id="2013675">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2013684">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013718">if</span>&nbsp;<span class="ident" id="2013721">f</span><span class="op" id="2013722">.</span><span class="ident" id="2013723">sharp</span>&nbsp;<span class="op" id="2013729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013733">switch</span>&nbsp;<span class="ident" id="2013740">base</span>&nbsp;<span class="op" id="2013745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013749">case</span>&nbsp;<span class="num" id="2013754">8</span><span class="op" id="2013755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013760">if</span>&nbsp;<span class="ident" id="2013763">buf</span><span class="op" id="2013766">[</span><span class="ident" id="2013767">i</span><span class="op" id="2013768">]</span>&nbsp;<span class="op" id="2013770">!=</span>&nbsp;<span class="string" id="2013773">&#39;0&#39;</span>&nbsp;<span class="op" id="2013777">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013783">i</span><span class="op" id="2013784">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013791">buf</span><span class="op" id="2013794">[</span><span class="ident" id="2013795">i</span><span class="op" id="2013796">]</span>&nbsp;<span class="op" id="2013798">=</span>&nbsp;<span class="string" id="2013800">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013811">case</span>&nbsp;<span class="num" id="2013816">16</span><span class="op" id="2013818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013823">i</span><span class="op" id="2013824">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013830">buf</span><span class="op" id="2013833">[</span><span class="ident" id="2013834">i</span><span class="op" id="2013835">]</span>&nbsp;<span class="op" id="2013837">=</span>&nbsp;<span class="string" id="2013839">&#39;x&#39;</span>&nbsp;<span class="op" id="2013843">+</span>&nbsp;<span class="ident" id="2013845">digits</span><span class="op" id="2013851">[</span><span class="num" id="2013852">10</span><span class="op" id="2013854">]</span>&nbsp;<span class="op" id="2013856">-</span>&nbsp;<span class="string" id="2013858">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013865">i</span><span class="op" id="2013866">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013872">buf</span><span class="op" id="2013875">[</span><span class="ident" id="2013876">i</span><span class="op" id="2013877">]</span>&nbsp;<span class="op" id="2013879">=</span>&nbsp;<span class="string" id="2013881">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013890">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013893">if</span>&nbsp;<span class="ident" id="2013896">f</span><span class="op" id="2013897">.</span><span class="ident" id="2013898">unicode</span>&nbsp;<span class="op" id="2013906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013910">i</span><span class="op" id="2013911">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013916">buf</span><span class="op" id="2013919">[</span><span class="ident" id="2013920">i</span><span class="op" id="2013921">]</span>&nbsp;<span class="op" id="2013923">=</span>&nbsp;<span class="string" id="2013925">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013931">i</span><span class="op" id="2013932">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013937">buf</span><span class="op" id="2013940">[</span><span class="ident" id="2013941">i</span><span class="op" id="2013942">]</span>&nbsp;<span class="op" id="2013944">=</span>&nbsp;<span class="string" id="2013946">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2013955">if</span>&nbsp;<span class="ident" id="2013958">negative</span>&nbsp;<span class="op" id="2013967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013971">i</span><span class="op" id="2013972">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2013977">buf</span><span class="op" id="2013980">[</span><span class="ident" id="2013981">i</span><span class="op" id="2013982">]</span>&nbsp;<span class="op" id="2013984">=</span>&nbsp;<span class="string" id="2013986">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2013991">}</span>&nbsp;<span class="keyword" id="2013993">else</span>&nbsp;<span class="keyword" id="2013998">if</span>&nbsp;<span class="ident" id="2014001">f</span><span class="op" id="2014002">.</span><span class="ident" id="2014003">plus</span>&nbsp;<span class="op" id="2014008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014012">i</span><span class="op" id="2014013">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014018">buf</span><span class="op" id="2014021">[</span><span class="ident" id="2014022">i</span><span class="op" id="2014023">]</span>&nbsp;<span class="op" id="2014025">=</span>&nbsp;<span class="string" id="2014027">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014032">}</span>&nbsp;<span class="keyword" id="2014034">else</span>&nbsp;<span class="keyword" id="2014039">if</span>&nbsp;<span class="ident" id="2014042">f</span><span class="op" id="2014043">.</span><span class="ident" id="2014044">space</span>&nbsp;<span class="op" id="2014050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014054">i</span><span class="op" id="2014055">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014060">buf</span><span class="op" id="2014063">[</span><span class="ident" id="2014064">i</span><span class="op" id="2014065">]</span>&nbsp;<span class="op" id="2014067">=</span>&nbsp;<span class="string" id="2014069">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2014078">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014147">if</span>&nbsp;<span class="ident" id="2014150">f</span><span class="op" id="2014151">.</span><span class="ident" id="2014152">unicode</span>&nbsp;<span class="op" id="2014160">&amp;&amp;</span>&nbsp;<span class="ident" id="2014163">f</span><span class="op" id="2014164">.</span><span class="ident" id="2014165">uniQuote</span>&nbsp;<span class="op" id="2014174">&amp;&amp;</span>&nbsp;<span class="ident" id="2014177">a</span>&nbsp;<span class="op" id="2014179">&gt;=</span>&nbsp;<span class="num" id="2014182">0</span>&nbsp;<span class="op" id="2014184">&amp;&amp;</span>&nbsp;<span class="ident" id="2014187">a</span>&nbsp;<span class="op" id="2014189">&lt;=</span>&nbsp;<span class="ident" id="2014192">utf8</span><span class="op" id="2014196">.</span><span class="ident" id="2014197">MaxRune</span>&nbsp;<span class="op" id="2014205">&amp;&amp;</span>&nbsp;<span class="ident" id="2014208">strconv</span><span class="op" id="2014215">.</span><span class="ident" id="2014216">IsPrint</span><span class="op" id="2014223">(</span><span class="builtintype" id="2014224">rune</span><span class="op" id="2014228">(</span><span class="ident" id="2014229">a</span><span class="op" id="2014230">)</span><span class="op" id="2014231">)</span>&nbsp;<span class="op" id="2014233">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014237">runeWidth</span>&nbsp;<span class="op" id="2014247">:=</span>&nbsp;<span class="ident" id="2014250">utf8</span><span class="op" id="2014254">.</span><span class="ident" id="2014255">RuneLen</span><span class="op" id="2014262">(</span><span class="builtintype" id="2014263">rune</span><span class="op" id="2014267">(</span><span class="ident" id="2014268">a</span><span class="op" id="2014269">)</span><span class="op" id="2014270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014274">width</span>&nbsp;<span class="op" id="2014280">:=</span>&nbsp;<span class="num" id="2014283">1</span>&nbsp;<span class="op" id="2014285">+</span>&nbsp;<span class="num" id="2014287">1</span>&nbsp;<span class="op" id="2014289">+</span>&nbsp;<span class="ident" id="2014291">runeWidth</span>&nbsp;<span class="op" id="2014301">+</span>&nbsp;<span class="num" id="2014303">1</span>&nbsp;<span class="comment" id="2014305">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2014336">copy</span><span class="op" id="2014340">(</span><span class="ident" id="2014341">buf</span><span class="op" id="2014344">[</span><span class="ident" id="2014345">i</span><span class="op" id="2014346">-</span><span class="ident" id="2014347">width</span><span class="op" id="2014352">:</span><span class="op" id="2014353">]</span><span class="op" id="2014354">,</span>&nbsp;<span class="ident" id="2014356">buf</span><span class="op" id="2014359">[</span><span class="ident" id="2014360">i</span><span class="op" id="2014361">:</span><span class="op" id="2014362">]</span><span class="op" id="2014363">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2014367">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014404">i</span>&nbsp;<span class="op" id="2014406">-=</span>&nbsp;<span class="ident" id="2014409">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2014417">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014449">j</span>&nbsp;<span class="op" id="2014451">:=</span>&nbsp;<span class="builtinfunc" id="2014454">len</span><span class="op" id="2014457">(</span><span class="ident" id="2014458">buf</span><span class="op" id="2014461">)</span>&nbsp;<span class="op" id="2014463">-</span>&nbsp;<span class="ident" id="2014465">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014473">buf</span><span class="op" id="2014476">[</span><span class="ident" id="2014477">j</span><span class="op" id="2014478">]</span>&nbsp;<span class="op" id="2014480">=</span>&nbsp;<span class="string" id="2014482">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014488">j</span><span class="op" id="2014489">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014494">buf</span><span class="op" id="2014497">[</span><span class="ident" id="2014498">j</span><span class="op" id="2014499">]</span>&nbsp;<span class="op" id="2014501">=</span>&nbsp;<span class="string" id="2014503">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014510">j</span><span class="op" id="2014511">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014516">utf8</span><span class="op" id="2014520">.</span><span class="ident" id="2014521">EncodeRune</span><span class="op" id="2014531">(</span><span class="ident" id="2014532">buf</span><span class="op" id="2014535">[</span><span class="ident" id="2014536">j</span><span class="op" id="2014537">:</span><span class="op" id="2014538">]</span><span class="op" id="2014539">,</span>&nbsp;<span class="builtintype" id="2014541">rune</span><span class="op" id="2014545">(</span><span class="ident" id="2014546">a</span><span class="op" id="2014547">)</span><span class="op" id="2014548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014552">j</span>&nbsp;<span class="op" id="2014554">+=</span>&nbsp;<span class="ident" id="2014557">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014569">buf</span><span class="op" id="2014572">[</span><span class="ident" id="2014573">j</span><span class="op" id="2014574">]</span>&nbsp;<span class="op" id="2014576">=</span>&nbsp;<span class="string" id="2014578">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014588">f</span><span class="op" id="2014589">.</span><span class="ident" id="2014590">pad</span><span class="op" id="2014593">(</span><span class="ident" id="2014594">buf</span><span class="op" id="2014597">[</span><span class="ident" id="2014598">i</span><span class="op" id="2014599">:</span><span class="op" id="2014600">]</span><span class="op" id="2014601">)</span><br>
<span class="lineno"></span><span class="op" id="2014603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2014606">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2014679">func</span>&nbsp;<span class="op" id="2014684">(</span><span class="ident" id="2014685">f</span>&nbsp;<span class="op" id="2014687">*</span><span class="ident" id="2014688">fmt</span><span class="op" id="2014691">)</span>&nbsp;<span class="ident" id="2014693">truncate</span><span class="op" id="2014701">(</span><span class="ident" id="2014702">s</span>&nbsp;<span class="builtintype" id="2014704">string</span><span class="op" id="2014710">)</span>&nbsp;<span class="builtintype" id="2014712">string</span>&nbsp;<span class="op" id="2014719">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014722">if</span>&nbsp;<span class="ident" id="2014725">f</span><span class="op" id="2014726">.</span><span class="ident" id="2014727">precPresent</span>&nbsp;<span class="op" id="2014739">&amp;&amp;</span>&nbsp;<span class="ident" id="2014742">f</span><span class="op" id="2014743">.</span><span class="ident" id="2014744">prec</span>&nbsp;<span class="op" id="2014749">&lt;</span>&nbsp;<span class="ident" id="2014751">utf8</span><span class="op" id="2014755">.</span><span class="ident" id="2014756">RuneCountInString</span><span class="op" id="2014773">(</span><span class="ident" id="2014774">s</span><span class="op" id="2014775">)</span>&nbsp;<span class="op" id="2014777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014781">n</span>&nbsp;<span class="op" id="2014783">:=</span>&nbsp;<span class="ident" id="2014786">f</span><span class="op" id="2014787">.</span><span class="ident" id="2014788">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014795">for</span>&nbsp;<span class="ident" id="2014799">i</span>&nbsp;<span class="op" id="2014801">:=</span>&nbsp;<span class="keyword" id="2014804">range</span>&nbsp;<span class="ident" id="2014810">s</span>&nbsp;<span class="op" id="2014812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014817">if</span>&nbsp;<span class="ident" id="2014820">n</span>&nbsp;<span class="op" id="2014822">==</span>&nbsp;<span class="num" id="2014825">0</span>&nbsp;<span class="op" id="2014827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014833">s</span>&nbsp;<span class="op" id="2014835">=</span>&nbsp;<span class="ident" id="2014837">s</span><span class="op" id="2014838">[</span><span class="op" id="2014839">:</span><span class="ident" id="2014840">i</span><span class="op" id="2014841">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014847">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014861">n</span><span class="op" id="2014862">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2014870">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2014873">return</span>&nbsp;<span class="ident" id="2014880">s</span><br>
<span class="lineno"></span><span class="op" id="2014882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2014885">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2014912">func</span>&nbsp;<span class="op" id="2014917">(</span><span class="ident" id="2014918">f</span>&nbsp;<span class="op" id="2014920">*</span><span class="ident" id="2014921">fmt</span><span class="op" id="2014924">)</span>&nbsp;<span class="ident" id="2014926">fmt_s</span><span class="op" id="2014931">(</span><span class="ident" id="2014932">s</span>&nbsp;<span class="builtintype" id="2014934">string</span><span class="op" id="2014940">)</span>&nbsp;<span class="op" id="2014942">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014945">s</span>&nbsp;<span class="op" id="2014947">=</span>&nbsp;<span class="ident" id="2014949">f</span><span class="op" id="2014950">.</span><span class="ident" id="2014951">truncate</span><span class="op" id="2014959">(</span><span class="ident" id="2014960">s</span><span class="op" id="2014961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2014964">f</span><span class="op" id="2014965">.</span><span class="ident" id="2014966">padString</span><span class="op" id="2014975">(</span><span class="ident" id="2014976">s</span><span class="op" id="2014977">)</span><br>
<span class="lineno"></span><span class="op" id="2014979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2014982">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2015064">func</span>&nbsp;<span class="op" id="2015069">(</span><span class="ident" id="2015070">f</span>&nbsp;<span class="op" id="2015072">*</span><span class="ident" id="2015073">fmt</span><span class="op" id="2015076">)</span>&nbsp;<span class="ident" id="2015078">fmt_sbx</span><span class="op" id="2015085">(</span><span class="ident" id="2015086">s</span>&nbsp;<span class="builtintype" id="2015088">string</span><span class="op" id="2015094">,</span>&nbsp;<span class="ident" id="2015096">b</span>&nbsp;<span class="op" id="2015098">[</span><span class="op" id="2015099">]</span><span class="builtintype" id="2015100">byte</span><span class="op" id="2015104">,</span>&nbsp;<span class="ident" id="2015106">digits</span>&nbsp;<span class="builtintype" id="2015113">string</span><span class="op" id="2015119">)</span>&nbsp;<span class="op" id="2015121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015124">n</span>&nbsp;<span class="op" id="2015126">:=</span>&nbsp;<span class="builtinfunc" id="2015129">len</span><span class="op" id="2015132">(</span><span class="ident" id="2015133">b</span><span class="op" id="2015134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015137">if</span>&nbsp;<span class="ident" id="2015140">b</span>&nbsp;<span class="op" id="2015142">==</span>&nbsp;<span class="ident" id="2015145">nil</span>&nbsp;<span class="op" id="2015149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015153">n</span>&nbsp;<span class="op" id="2015155">=</span>&nbsp;<span class="builtinfunc" id="2015157">len</span><span class="op" id="2015160">(</span><span class="ident" id="2015161">s</span><span class="op" id="2015162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015165">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015168">x</span>&nbsp;<span class="op" id="2015170">:=</span>&nbsp;<span class="ident" id="2015173">digits</span><span class="op" id="2015179">[</span><span class="num" id="2015180">10</span><span class="op" id="2015182">]</span>&nbsp;<span class="op" id="2015184">-</span>&nbsp;<span class="string" id="2015186">&#39;a&#39;</span>&nbsp;<span class="op" id="2015190">+</span>&nbsp;<span class="string" id="2015192">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2015197">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015236">var</span>&nbsp;<span class="ident" id="2015240">buf</span>&nbsp;<span class="op" id="2015244">[</span><span class="op" id="2015245">]</span><span class="builtintype" id="2015246">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015252">for</span>&nbsp;<span class="ident" id="2015256">i</span>&nbsp;<span class="op" id="2015258">:=</span>&nbsp;<span class="num" id="2015261">0</span><span class="op" id="2015262">;</span>&nbsp;<span class="ident" id="2015264">i</span>&nbsp;<span class="op" id="2015266">&lt;</span>&nbsp;<span class="ident" id="2015268">n</span><span class="op" id="2015269">;</span>&nbsp;<span class="ident" id="2015271">i</span><span class="op" id="2015272">++</span>&nbsp;<span class="op" id="2015275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015279">if</span>&nbsp;<span class="ident" id="2015282">i</span>&nbsp;<span class="op" id="2015284">&gt;</span>&nbsp;<span class="num" id="2015286">0</span>&nbsp;<span class="op" id="2015288">&amp;&amp;</span>&nbsp;<span class="ident" id="2015291">f</span><span class="op" id="2015292">.</span><span class="ident" id="2015293">space</span>&nbsp;<span class="op" id="2015299">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015304">buf</span>&nbsp;<span class="op" id="2015308">=</span>&nbsp;<span class="builtinfunc" id="2015310">append</span><span class="op" id="2015316">(</span><span class="ident" id="2015317">buf</span><span class="op" id="2015320">,</span>&nbsp;<span class="string" id="2015322">&#39;&nbsp;&#39;</span><span class="op" id="2015325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015333">if</span>&nbsp;<span class="ident" id="2015336">f</span><span class="op" id="2015337">.</span><span class="ident" id="2015338">sharp</span>&nbsp;<span class="op" id="2015344">&amp;&amp;</span>&nbsp;<span class="op" id="2015347">(</span><span class="ident" id="2015348">f</span><span class="op" id="2015349">.</span><span class="ident" id="2015350">space</span>&nbsp;<span class="op" id="2015356">||</span>&nbsp;<span class="ident" id="2015359">i</span>&nbsp;<span class="op" id="2015361">==</span>&nbsp;<span class="num" id="2015364">0</span><span class="op" id="2015365">)</span>&nbsp;<span class="op" id="2015367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015372">buf</span>&nbsp;<span class="op" id="2015376">=</span>&nbsp;<span class="builtinfunc" id="2015378">append</span><span class="op" id="2015384">(</span><span class="ident" id="2015385">buf</span><span class="op" id="2015388">,</span>&nbsp;<span class="string" id="2015390">&#39;0&#39;</span><span class="op" id="2015393">,</span>&nbsp;<span class="ident" id="2015395">x</span><span class="op" id="2015396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015400">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015404">var</span>&nbsp;<span class="ident" id="2015408">c</span>&nbsp;<span class="builtintype" id="2015410">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015417">if</span>&nbsp;<span class="ident" id="2015420">b</span>&nbsp;<span class="op" id="2015422">==</span>&nbsp;<span class="ident" id="2015425">nil</span>&nbsp;<span class="op" id="2015429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015434">c</span>&nbsp;<span class="op" id="2015436">=</span>&nbsp;<span class="ident" id="2015438">s</span><span class="op" id="2015439">[</span><span class="ident" id="2015440">i</span><span class="op" id="2015441">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015445">}</span>&nbsp;<span class="keyword" id="2015447">else</span>&nbsp;<span class="op" id="2015452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015457">c</span>&nbsp;<span class="op" id="2015459">=</span>&nbsp;<span class="ident" id="2015461">b</span><span class="op" id="2015462">[</span><span class="ident" id="2015463">i</span><span class="op" id="2015464">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015472">buf</span>&nbsp;<span class="op" id="2015476">=</span>&nbsp;<span class="builtinfunc" id="2015478">append</span><span class="op" id="2015484">(</span><span class="ident" id="2015485">buf</span><span class="op" id="2015488">,</span>&nbsp;<span class="ident" id="2015490">digits</span><span class="op" id="2015496">[</span><span class="ident" id="2015497">c</span><span class="op" id="2015498">&gt;&gt;</span><span class="num" id="2015500">4</span><span class="op" id="2015501">]</span><span class="op" id="2015502">,</span>&nbsp;<span class="ident" id="2015504">digits</span><span class="op" id="2015510">[</span><span class="ident" id="2015511">c</span><span class="op" id="2015512">&amp;</span><span class="num" id="2015513">0xF</span><span class="op" id="2015516">]</span><span class="op" id="2015517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015523">f</span><span class="op" id="2015524">.</span><span class="ident" id="2015525">pad</span><span class="op" id="2015528">(</span><span class="ident" id="2015529">buf</span><span class="op" id="2015532">)</span><br>
<span class="lineno"></span><span class="op" id="2015534">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2015537">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2015604">func</span>&nbsp;<span class="op" id="2015609">(</span><span class="ident" id="2015610">f</span>&nbsp;<span class="op" id="2015612">*</span><span class="ident" id="2015613">fmt</span><span class="op" id="2015616">)</span>&nbsp;<span class="ident" id="2015618">fmt_sx</span><span class="op" id="2015624">(</span><span class="ident" id="2015625">s</span><span class="op" id="2015626">,</span>&nbsp;<span class="ident" id="2015628">digits</span>&nbsp;<span class="builtintype" id="2015635">string</span><span class="op" id="2015641">)</span>&nbsp;<span class="op" id="2015643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015646">if</span>&nbsp;<span class="ident" id="2015649">f</span><span class="op" id="2015650">.</span><span class="ident" id="2015651">precPresent</span>&nbsp;<span class="op" id="2015663">&amp;&amp;</span>&nbsp;<span class="ident" id="2015666">f</span><span class="op" id="2015667">.</span><span class="ident" id="2015668">prec</span>&nbsp;<span class="op" id="2015673">&lt;</span>&nbsp;<span class="builtinfunc" id="2015675">len</span><span class="op" id="2015678">(</span><span class="ident" id="2015679">s</span><span class="op" id="2015680">)</span>&nbsp;<span class="op" id="2015682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015686">s</span>&nbsp;<span class="op" id="2015688">=</span>&nbsp;<span class="ident" id="2015690">s</span><span class="op" id="2015691">[</span><span class="op" id="2015692">:</span><span class="ident" id="2015693">f</span><span class="op" id="2015694">.</span><span class="ident" id="2015695">prec</span><span class="op" id="2015699">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015705">f</span><span class="op" id="2015706">.</span><span class="ident" id="2015707">fmt_sbx</span><span class="op" id="2015714">(</span><span class="ident" id="2015715">s</span><span class="op" id="2015716">,</span>&nbsp;<span class="ident" id="2015718">nil</span><span class="op" id="2015721">,</span>&nbsp;<span class="ident" id="2015723">digits</span><span class="op" id="2015729">)</span><br>
<span class="lineno"></span><span class="op" id="2015731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2015734">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2015805">func</span>&nbsp;<span class="op" id="2015810">(</span><span class="ident" id="2015811">f</span>&nbsp;<span class="op" id="2015813">*</span><span class="ident" id="2015814">fmt</span><span class="op" id="2015817">)</span>&nbsp;<span class="ident" id="2015819">fmt_bx</span><span class="op" id="2015825">(</span><span class="ident" id="2015826">b</span>&nbsp;<span class="op" id="2015828">[</span><span class="op" id="2015829">]</span><span class="builtintype" id="2015830">byte</span><span class="op" id="2015834">,</span>&nbsp;<span class="ident" id="2015836">digits</span>&nbsp;<span class="builtintype" id="2015843">string</span><span class="op" id="2015849">)</span>&nbsp;<span class="op" id="2015851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2015854">if</span>&nbsp;<span class="ident" id="2015857">f</span><span class="op" id="2015858">.</span><span class="ident" id="2015859">precPresent</span>&nbsp;<span class="op" id="2015871">&amp;&amp;</span>&nbsp;<span class="ident" id="2015874">f</span><span class="op" id="2015875">.</span><span class="ident" id="2015876">prec</span>&nbsp;<span class="op" id="2015881">&lt;</span>&nbsp;<span class="builtinfunc" id="2015883">len</span><span class="op" id="2015886">(</span><span class="ident" id="2015887">b</span><span class="op" id="2015888">)</span>&nbsp;<span class="op" id="2015890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015894">b</span>&nbsp;<span class="op" id="2015896">=</span>&nbsp;<span class="ident" id="2015898">b</span><span class="op" id="2015899">[</span><span class="op" id="2015900">:</span><span class="ident" id="2015901">f</span><span class="op" id="2015902">.</span><span class="ident" id="2015903">prec</span><span class="op" id="2015907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2015910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2015913">f</span><span class="op" id="2015914">.</span><span class="ident" id="2015915">fmt_sbx</span><span class="op" id="2015922">(</span><span class="string" id="2015923">&#34;&#34;</span><span class="op" id="2015925">,</span>&nbsp;<span class="ident" id="2015927">b</span><span class="op" id="2015928">,</span>&nbsp;<span class="ident" id="2015930">digits</span><span class="op" id="2015936">)</span><br>
<span class="lineno">355</span><span class="op" id="2015938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2015941">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2016015">func</span>&nbsp;<span class="op" id="2016020">(</span><span class="ident" id="2016021">f</span>&nbsp;<span class="op" id="2016023">*</span><span class="ident" id="2016024">fmt</span><span class="op" id="2016027">)</span>&nbsp;<span class="ident" id="2016029">fmt_q</span><span class="op" id="2016034">(</span><span class="ident" id="2016035">s</span>&nbsp;<span class="builtintype" id="2016037">string</span><span class="op" id="2016043">)</span>&nbsp;<span class="op" id="2016045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016048">s</span>&nbsp;<span class="op" id="2016050">=</span>&nbsp;<span class="ident" id="2016052">f</span><span class="op" id="2016053">.</span><span class="ident" id="2016054">truncate</span><span class="op" id="2016062">(</span><span class="ident" id="2016063">s</span><span class="op" id="2016064">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016067">var</span>&nbsp;<span class="ident" id="2016071">quoted</span>&nbsp;<span class="builtintype" id="2016078">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016086">if</span>&nbsp;<span class="ident" id="2016089">f</span><span class="op" id="2016090">.</span><span class="ident" id="2016091">sharp</span>&nbsp;<span class="op" id="2016097">&amp;&amp;</span>&nbsp;<span class="ident" id="2016100">strconv</span><span class="op" id="2016107">.</span><span class="ident" id="2016108">CanBackquote</span><span class="op" id="2016120">(</span><span class="ident" id="2016121">s</span><span class="op" id="2016122">)</span>&nbsp;<span class="op" id="2016124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016128">quoted</span>&nbsp;<span class="op" id="2016135">=</span>&nbsp;<span class="string" id="2016137">&#34;`&#34;</span>&nbsp;<span class="op" id="2016141">+</span>&nbsp;<span class="ident" id="2016143">s</span>&nbsp;<span class="op" id="2016145">+</span>&nbsp;<span class="string" id="2016147">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016152">}</span>&nbsp;<span class="keyword" id="2016154">else</span>&nbsp;<span class="op" id="2016159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016163">if</span>&nbsp;<span class="ident" id="2016166">f</span><span class="op" id="2016167">.</span><span class="ident" id="2016168">plus</span>&nbsp;<span class="op" id="2016173">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016178">quoted</span>&nbsp;<span class="op" id="2016185">=</span>&nbsp;<span class="ident" id="2016187">strconv</span><span class="op" id="2016194">.</span><span class="ident" id="2016195">QuoteToASCII</span><span class="op" id="2016207">(</span><span class="ident" id="2016208">s</span><span class="op" id="2016209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016213">}</span>&nbsp;<span class="keyword" id="2016215">else</span>&nbsp;<span class="op" id="2016220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016225">quoted</span>&nbsp;<span class="op" id="2016232">=</span>&nbsp;<span class="ident" id="2016234">strconv</span><span class="op" id="2016241">.</span><span class="ident" id="2016242">Quote</span><span class="op" id="2016247">(</span><span class="ident" id="2016248">s</span><span class="op" id="2016249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016256">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016259">f</span><span class="op" id="2016260">.</span><span class="ident" id="2016261">padString</span><span class="op" id="2016270">(</span><span class="ident" id="2016271">quoted</span><span class="op" id="2016277">)</span><br>
<span class="lineno"></span><span class="op" id="2016279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2016282">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2016363">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2016429">func</span>&nbsp;<span class="op" id="2016434">(</span><span class="ident" id="2016435">f</span>&nbsp;<span class="op" id="2016437">*</span><span class="ident" id="2016438">fmt</span><span class="op" id="2016441">)</span>&nbsp;<span class="ident" id="2016443">fmt_qc</span><span class="op" id="2016449">(</span><span class="ident" id="2016450">c</span>&nbsp;<span class="ident" id="2016452">int64</span><span class="op" id="2016457">)</span>&nbsp;<span class="op" id="2016459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016462">var</span>&nbsp;<span class="ident" id="2016466">quoted</span>&nbsp;<span class="op" id="2016473">[</span><span class="op" id="2016474">]</span><span class="builtintype" id="2016475">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016481">if</span>&nbsp;<span class="ident" id="2016484">f</span><span class="op" id="2016485">.</span><span class="ident" id="2016486">plus</span>&nbsp;<span class="op" id="2016491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016495">quoted</span>&nbsp;<span class="op" id="2016502">=</span>&nbsp;<span class="ident" id="2016504">strconv</span><span class="op" id="2016511">.</span><span class="ident" id="2016512">AppendQuoteRuneToASCII</span><span class="op" id="2016534">(</span><span class="ident" id="2016535">f</span><span class="op" id="2016536">.</span><span class="ident" id="2016537">intbuf</span><span class="op" id="2016543">[</span><span class="num" id="2016544">0</span><span class="op" id="2016545">:</span><span class="num" id="2016546">0</span><span class="op" id="2016547">]</span><span class="op" id="2016548">,</span>&nbsp;<span class="builtintype" id="2016550">rune</span><span class="op" id="2016554">(</span><span class="ident" id="2016555">c</span><span class="op" id="2016556">)</span><span class="op" id="2016557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016560">}</span>&nbsp;<span class="keyword" id="2016562">else</span>&nbsp;<span class="op" id="2016567">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016571">quoted</span>&nbsp;<span class="op" id="2016578">=</span>&nbsp;<span class="ident" id="2016580">strconv</span><span class="op" id="2016587">.</span><span class="ident" id="2016588">AppendQuoteRune</span><span class="op" id="2016603">(</span><span class="ident" id="2016604">f</span><span class="op" id="2016605">.</span><span class="ident" id="2016606">intbuf</span><span class="op" id="2016612">[</span><span class="num" id="2016613">0</span><span class="op" id="2016614">:</span><span class="num" id="2016615">0</span><span class="op" id="2016616">]</span><span class="op" id="2016617">,</span>&nbsp;<span class="builtintype" id="2016619">rune</span><span class="op" id="2016623">(</span><span class="ident" id="2016624">c</span><span class="op" id="2016625">)</span><span class="op" id="2016626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016632">f</span><span class="op" id="2016633">.</span><span class="ident" id="2016634">pad</span><span class="op" id="2016637">(</span><span class="ident" id="2016638">quoted</span><span class="op" id="2016644">)</span><br>
<span class="lineno"></span><span class="op" id="2016646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2016649">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2016668">func</span>&nbsp;<span class="ident" id="2016673">doPrec</span><span class="op" id="2016679">(</span><span class="ident" id="2016680">f</span>&nbsp;<span class="op" id="2016682">*</span><span class="ident" id="2016683">fmt</span><span class="op" id="2016686">,</span>&nbsp;<span class="ident" id="2016688">def</span>&nbsp;<span class="builtintype" id="2016692">int</span><span class="op" id="2016695">)</span>&nbsp;<span class="builtintype" id="2016697">int</span>&nbsp;<span class="op" id="2016701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016704">if</span>&nbsp;<span class="ident" id="2016707">f</span><span class="op" id="2016708">.</span><span class="ident" id="2016709">precPresent</span>&nbsp;<span class="op" id="2016721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016725">return</span>&nbsp;<span class="ident" id="2016732">f</span><span class="op" id="2016733">.</span><span class="ident" id="2016734">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2016740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2016743">return</span>&nbsp;<span class="ident" id="2016750">def</span><br>
<span class="lineno"></span><span class="op" id="2016754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2016757">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2016858">func</span>&nbsp;<span class="op" id="2016863">(</span><span class="ident" id="2016864">f</span>&nbsp;<span class="op" id="2016866">*</span><span class="ident" id="2016867">fmt</span><span class="op" id="2016870">)</span>&nbsp;<span class="ident" id="2016872">formatFloat</span><span class="op" id="2016883">(</span><span class="ident" id="2016884">v</span>&nbsp;<span class="builtintype" id="2016886">float64</span><span class="op" id="2016893">,</span>&nbsp;<span class="ident" id="2016895">verb</span>&nbsp;<span class="builtintype" id="2016900">byte</span><span class="op" id="2016904">,</span>&nbsp;<span class="ident" id="2016906">prec</span><span class="op" id="2016910">,</span>&nbsp;<span class="ident" id="2016912">n</span>&nbsp;<span class="builtintype" id="2016914">int</span><span class="op" id="2016917">)</span>&nbsp;<span class="op" id="2016919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2016922">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2016987">num</span>&nbsp;<span class="op" id="2016991">:=</span>&nbsp;<span class="ident" id="2016994">strconv</span><span class="op" id="2017001">.</span><span class="ident" id="2017002">AppendFloat</span><span class="op" id="2017013">(</span><span class="ident" id="2017014">f</span><span class="op" id="2017015">.</span><span class="ident" id="2017016">intbuf</span><span class="op" id="2017022">[</span><span class="num" id="2017023">0</span><span class="op" id="2017024">:</span><span class="num" id="2017025">1</span><span class="op" id="2017026">]</span><span class="op" id="2017027">,</span>&nbsp;<span class="ident" id="2017029">v</span><span class="op" id="2017030">,</span>&nbsp;<span class="ident" id="2017032">verb</span><span class="op" id="2017036">,</span>&nbsp;<span class="ident" id="2017038">prec</span><span class="op" id="2017042">,</span>&nbsp;<span class="ident" id="2017044">n</span><span class="op" id="2017045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017048">if</span>&nbsp;<span class="ident" id="2017051">num</span><span class="op" id="2017054">[</span><span class="num" id="2017055">1</span><span class="op" id="2017056">]</span>&nbsp;<span class="op" id="2017058">==</span>&nbsp;<span class="string" id="2017061">&#39;-&#39;</span>&nbsp;<span class="op" id="2017065">||</span>&nbsp;<span class="ident" id="2017068">num</span><span class="op" id="2017071">[</span><span class="num" id="2017072">1</span><span class="op" id="2017073">]</span>&nbsp;<span class="op" id="2017075">==</span>&nbsp;<span class="string" id="2017078">&#39;+&#39;</span>&nbsp;<span class="op" id="2017082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017086">num</span>&nbsp;<span class="op" id="2017090">=</span>&nbsp;<span class="ident" id="2017092">num</span><span class="op" id="2017095">[</span><span class="num" id="2017096">1</span><span class="op" id="2017097">:</span><span class="op" id="2017098">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017101">}</span>&nbsp;<span class="keyword" id="2017103">else</span>&nbsp;<span class="op" id="2017108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017112">num</span><span class="op" id="2017115">[</span><span class="num" id="2017116">0</span><span class="op" id="2017117">]</span>&nbsp;<span class="op" id="2017119">=</span>&nbsp;<span class="string" id="2017121">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017129">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017232">if</span>&nbsp;<span class="ident" id="2017235">math</span><span class="op" id="2017239">.</span><span class="ident" id="2017240">IsInf</span><span class="op" id="2017245">(</span><span class="ident" id="2017246">v</span><span class="op" id="2017247">,</span>&nbsp;<span class="num" id="2017249">0</span><span class="op" id="2017250">)</span>&nbsp;<span class="op" id="2017252">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017256">if</span>&nbsp;<span class="ident" id="2017259">f</span><span class="op" id="2017260">.</span><span class="ident" id="2017261">zero</span>&nbsp;<span class="op" id="2017266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017271">defer</span>&nbsp;<span class="keyword" id="2017277">func</span><span class="op" id="2017281">(</span><span class="op" id="2017282">)</span>&nbsp;<span class="op" id="2017284">{</span>&nbsp;<span class="ident" id="2017286">f</span><span class="op" id="2017287">.</span><span class="ident" id="2017288">zero</span>&nbsp;<span class="op" id="2017293">=</span>&nbsp;<span class="builtintype" id="2017295">true</span>&nbsp;<span class="op" id="2017300">}</span><span class="op" id="2017301">(</span><span class="op" id="2017302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017307">f</span><span class="op" id="2017308">.</span><span class="ident" id="2017309">zero</span>&nbsp;<span class="op" id="2017314">=</span>&nbsp;<span class="builtintype" id="2017316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017327">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017330">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017377">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017444">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017523">if</span>&nbsp;<span class="ident" id="2017526">f</span><span class="op" id="2017527">.</span><span class="ident" id="2017528">zero</span>&nbsp;<span class="op" id="2017533">&amp;&amp;</span>&nbsp;<span class="ident" id="2017536">f</span><span class="op" id="2017537">.</span><span class="ident" id="2017538">widPresent</span>&nbsp;<span class="op" id="2017549">&amp;&amp;</span>&nbsp;<span class="ident" id="2017552">f</span><span class="op" id="2017553">.</span><span class="ident" id="2017554">wid</span>&nbsp;<span class="op" id="2017558">&gt;</span>&nbsp;<span class="builtinfunc" id="2017560">len</span><span class="op" id="2017563">(</span><span class="ident" id="2017564">num</span><span class="op" id="2017567">)</span>&nbsp;<span class="op" id="2017569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017573">if</span>&nbsp;<span class="ident" id="2017576">f</span><span class="op" id="2017577">.</span><span class="ident" id="2017578">space</span>&nbsp;<span class="op" id="2017584">&amp;&amp;</span>&nbsp;<span class="ident" id="2017587">v</span>&nbsp;<span class="op" id="2017589">&gt;=</span>&nbsp;<span class="num" id="2017592">0</span>&nbsp;<span class="op" id="2017594">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017599">f</span><span class="op" id="2017600">.</span><span class="ident" id="2017601">buf</span><span class="op" id="2017604">.</span><span class="ident" id="2017605">WriteByte</span><span class="op" id="2017614">(</span><span class="string" id="2017615">&#39;&nbsp;&#39;</span><span class="op" id="2017618">)</span>&nbsp;<span class="comment" id="2017620">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017684">f</span><span class="op" id="2017685">.</span><span class="ident" id="2017686">wid</span><span class="op" id="2017689">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017694">}</span>&nbsp;<span class="keyword" id="2017696">else</span>&nbsp;<span class="keyword" id="2017701">if</span>&nbsp;<span class="ident" id="2017704">f</span><span class="op" id="2017705">.</span><span class="ident" id="2017706">plus</span>&nbsp;<span class="op" id="2017711">||</span>&nbsp;<span class="ident" id="2017714">v</span>&nbsp;<span class="op" id="2017716">&lt;</span>&nbsp;<span class="num" id="2017718">0</span>&nbsp;<span class="op" id="2017720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017725">f</span><span class="op" id="2017726">.</span><span class="ident" id="2017727">buf</span><span class="op" id="2017730">.</span><span class="ident" id="2017731">WriteByte</span><span class="op" id="2017740">(</span><span class="ident" id="2017741">num</span><span class="op" id="2017744">[</span><span class="num" id="2017745">0</span><span class="op" id="2017746">]</span><span class="op" id="2017747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017752">f</span><span class="op" id="2017753">.</span><span class="ident" id="2017754">wid</span><span class="op" id="2017757">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017766">f</span><span class="op" id="2017767">.</span><span class="ident" id="2017768">pad</span><span class="op" id="2017771">(</span><span class="ident" id="2017772">num</span><span class="op" id="2017775">[</span><span class="num" id="2017776">1</span><span class="op" id="2017777">:</span><span class="op" id="2017778">]</span><span class="op" id="2017779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017783">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017794">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017848">if</span>&nbsp;<span class="ident" id="2017851">f</span><span class="op" id="2017852">.</span><span class="ident" id="2017853">space</span>&nbsp;<span class="op" id="2017859">&amp;&amp;</span>&nbsp;<span class="ident" id="2017862">num</span><span class="op" id="2017865">[</span><span class="num" id="2017866">0</span><span class="op" id="2017867">]</span>&nbsp;<span class="op" id="2017869">==</span>&nbsp;<span class="string" id="2017872">&#39;+&#39;</span>&nbsp;<span class="op" id="2017876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017880">num</span><span class="op" id="2017883">[</span><span class="num" id="2017884">0</span><span class="op" id="2017885">]</span>&nbsp;<span class="op" id="2017887">=</span>&nbsp;<span class="string" id="2017889">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2017895">f</span><span class="op" id="2017896">.</span><span class="ident" id="2017897">pad</span><span class="op" id="2017900">(</span><span class="ident" id="2017901">num</span><span class="op" id="2017904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2017908">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2017916">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017919">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2017999">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018087">if</span>&nbsp;<span class="ident" id="2018090">f</span><span class="op" id="2018091">.</span><span class="ident" id="2018092">plus</span>&nbsp;<span class="op" id="2018097">||</span>&nbsp;<span class="ident" id="2018100">num</span><span class="op" id="2018103">[</span><span class="num" id="2018104">0</span><span class="op" id="2018105">]</span>&nbsp;<span class="op" id="2018107">==</span>&nbsp;<span class="string" id="2018110">&#39;-&#39;</span>&nbsp;<span class="op" id="2018114">||</span>&nbsp;<span class="ident" id="2018117">math</span><span class="op" id="2018121">.</span><span class="ident" id="2018122">IsInf</span><span class="op" id="2018127">(</span><span class="ident" id="2018128">v</span><span class="op" id="2018129">,</span>&nbsp;<span class="num" id="2018131">0</span><span class="op" id="2018132">)</span>&nbsp;<span class="op" id="2018134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018138">f</span><span class="op" id="2018139">.</span><span class="ident" id="2018140">pad</span><span class="op" id="2018143">(</span><span class="ident" id="2018144">num</span><span class="op" id="2018147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2018151">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2018159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2018162">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2018242">f</span><span class="op" id="2018243">.</span><span class="ident" id="2018244">pad</span><span class="op" id="2018247">(</span><span class="ident" id="2018248">num</span><span class="op" id="2018251">[</span><span class="num" id="2018252">1</span><span class="op" id="2018253">:</span><span class="op" id="2018254">]</span><span class="op" id="2018255">)</span><br>
<span class="lineno"></span><span class="op" id="2018257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2018260">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2018312">func</span>&nbsp;<span class="op" id="2018317">(</span><span class="ident" id="2018318">f</span>&nbsp;<span class="op" id="2018320">*</span><span class="ident" id="2018321">fmt</span><span class="op" id="2018324">)</span>&nbsp;<span class="ident" id="2018326">fmt_e64</span><span class="op" id="2018333">(</span><span class="ident" id="2018334">v</span>&nbsp;<span class="builtintype" id="2018336">float64</span><span class="op" id="2018343">)</span>&nbsp;<span class="op" id="2018345">{</span>&nbsp;<span class="ident" id="2018347">f</span><span class="op" id="2018348">.</span><span class="ident" id="2018349">formatFloat</span><span class="op" id="2018360">(</span><span class="ident" id="2018361">v</span><span class="op" id="2018362">,</span>&nbsp;<span class="string" id="2018364">&#39;e&#39;</span><span class="op" id="2018367">,</span>&nbsp;<span class="ident" id="2018369">doPrec</span><span class="op" id="2018375">(</span><span class="ident" id="2018376">f</span><span class="op" id="2018377">,</span>&nbsp;<span class="num" id="2018379">6</span><span class="op" id="2018380">)</span><span class="op" id="2018381">,</span>&nbsp;<span class="num" id="2018383">64</span><span class="op" id="2018385">)</span>&nbsp;<span class="op" id="2018387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018390">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2018442">func</span>&nbsp;<span class="op" id="2018447">(</span><span class="ident" id="2018448">f</span>&nbsp;<span class="op" id="2018450">*</span><span class="ident" id="2018451">fmt</span><span class="op" id="2018454">)</span>&nbsp;<span class="ident" id="2018456">fmt_E64</span><span class="op" id="2018463">(</span><span class="ident" id="2018464">v</span>&nbsp;<span class="builtintype" id="2018466">float64</span><span class="op" id="2018473">)</span>&nbsp;<span class="op" id="2018475">{</span>&nbsp;<span class="ident" id="2018477">f</span><span class="op" id="2018478">.</span><span class="ident" id="2018479">formatFloat</span><span class="op" id="2018490">(</span><span class="ident" id="2018491">v</span><span class="op" id="2018492">,</span>&nbsp;<span class="string" id="2018494">&#39;E&#39;</span><span class="op" id="2018497">,</span>&nbsp;<span class="ident" id="2018499">doPrec</span><span class="op" id="2018505">(</span><span class="ident" id="2018506">f</span><span class="op" id="2018507">,</span>&nbsp;<span class="num" id="2018509">6</span><span class="op" id="2018510">)</span><span class="op" id="2018511">,</span>&nbsp;<span class="num" id="2018513">64</span><span class="op" id="2018515">)</span>&nbsp;<span class="op" id="2018517">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2018520">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2018568">func</span>&nbsp;<span class="op" id="2018573">(</span><span class="ident" id="2018574">f</span>&nbsp;<span class="op" id="2018576">*</span><span class="ident" id="2018577">fmt</span><span class="op" id="2018580">)</span>&nbsp;<span class="ident" id="2018582">fmt_f64</span><span class="op" id="2018589">(</span><span class="ident" id="2018590">v</span>&nbsp;<span class="builtintype" id="2018592">float64</span><span class="op" id="2018599">)</span>&nbsp;<span class="op" id="2018601">{</span>&nbsp;<span class="ident" id="2018603">f</span><span class="op" id="2018604">.</span><span class="ident" id="2018605">formatFloat</span><span class="op" id="2018616">(</span><span class="ident" id="2018617">v</span><span class="op" id="2018618">,</span>&nbsp;<span class="string" id="2018620">&#39;f&#39;</span><span class="op" id="2018623">,</span>&nbsp;<span class="ident" id="2018625">doPrec</span><span class="op" id="2018631">(</span><span class="ident" id="2018632">f</span><span class="op" id="2018633">,</span>&nbsp;<span class="num" id="2018635">6</span><span class="op" id="2018636">)</span><span class="op" id="2018637">,</span>&nbsp;<span class="num" id="2018639">64</span><span class="op" id="2018641">)</span>&nbsp;<span class="op" id="2018643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018646">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2018717">func</span>&nbsp;<span class="op" id="2018722">(</span><span class="ident" id="2018723">f</span>&nbsp;<span class="op" id="2018725">*</span><span class="ident" id="2018726">fmt</span><span class="op" id="2018729">)</span>&nbsp;<span class="ident" id="2018731">fmt_g64</span><span class="op" id="2018738">(</span><span class="ident" id="2018739">v</span>&nbsp;<span class="builtintype" id="2018741">float64</span><span class="op" id="2018748">)</span>&nbsp;<span class="op" id="2018750">{</span>&nbsp;<span class="ident" id="2018752">f</span><span class="op" id="2018753">.</span><span class="ident" id="2018754">formatFloat</span><span class="op" id="2018765">(</span><span class="ident" id="2018766">v</span><span class="op" id="2018767">,</span>&nbsp;<span class="string" id="2018769">&#39;g&#39;</span><span class="op" id="2018772">,</span>&nbsp;<span class="ident" id="2018774">doPrec</span><span class="op" id="2018780">(</span><span class="ident" id="2018781">f</span><span class="op" id="2018782">,</span>&nbsp;<span class="op" id="2018784">-</span><span class="num" id="2018785">1</span><span class="op" id="2018786">)</span><span class="op" id="2018787">,</span>&nbsp;<span class="num" id="2018789">64</span><span class="op" id="2018791">)</span>&nbsp;<span class="op" id="2018793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2018796">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2018867">func</span>&nbsp;<span class="op" id="2018872">(</span><span class="ident" id="2018873">f</span>&nbsp;<span class="op" id="2018875">*</span><span class="ident" id="2018876">fmt</span><span class="op" id="2018879">)</span>&nbsp;<span class="ident" id="2018881">fmt_G64</span><span class="op" id="2018888">(</span><span class="ident" id="2018889">v</span>&nbsp;<span class="builtintype" id="2018891">float64</span><span class="op" id="2018898">)</span>&nbsp;<span class="op" id="2018900">{</span>&nbsp;<span class="ident" id="2018902">f</span><span class="op" id="2018903">.</span><span class="ident" id="2018904">formatFloat</span><span class="op" id="2018915">(</span><span class="ident" id="2018916">v</span><span class="op" id="2018917">,</span>&nbsp;<span class="string" id="2018919">&#39;G&#39;</span><span class="op" id="2018922">,</span>&nbsp;<span class="ident" id="2018924">doPrec</span><span class="op" id="2018930">(</span><span class="ident" id="2018931">f</span><span class="op" id="2018932">,</span>&nbsp;<span class="op" id="2018934">-</span><span class="num" id="2018935">1</span><span class="op" id="2018936">)</span><span class="op" id="2018937">,</span>&nbsp;<span class="num" id="2018939">64</span><span class="op" id="2018941">)</span>&nbsp;<span class="op" id="2018943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2018946">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2019021">func</span>&nbsp;<span class="op" id="2019026">(</span><span class="ident" id="2019027">f</span>&nbsp;<span class="op" id="2019029">*</span><span class="ident" id="2019030">fmt</span><span class="op" id="2019033">)</span>&nbsp;<span class="ident" id="2019035">fmt_fb64</span><span class="op" id="2019043">(</span><span class="ident" id="2019044">v</span>&nbsp;<span class="builtintype" id="2019046">float64</span><span class="op" id="2019053">)</span>&nbsp;<span class="op" id="2019055">{</span>&nbsp;<span class="ident" id="2019057">f</span><span class="op" id="2019058">.</span><span class="ident" id="2019059">formatFloat</span><span class="op" id="2019070">(</span><span class="ident" id="2019071">v</span><span class="op" id="2019072">,</span>&nbsp;<span class="string" id="2019074">&#39;b&#39;</span><span class="op" id="2019077">,</span>&nbsp;<span class="num" id="2019079">0</span><span class="op" id="2019080">,</span>&nbsp;<span class="num" id="2019082">64</span><span class="op" id="2019084">)</span>&nbsp;<span class="op" id="2019086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2019089">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2019100">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2019136">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2019192">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2019244">func</span>&nbsp;<span class="op" id="2019249">(</span><span class="ident" id="2019250">f</span>&nbsp;<span class="op" id="2019252">*</span><span class="ident" id="2019253">fmt</span><span class="op" id="2019256">)</span>&nbsp;<span class="ident" id="2019258">fmt_e32</span><span class="op" id="2019265">(</span><span class="ident" id="2019266">v</span>&nbsp;<span class="builtintype" id="2019268">float32</span><span class="op" id="2019275">)</span>&nbsp;<span class="op" id="2019277">{</span>&nbsp;<span class="ident" id="2019279">f</span><span class="op" id="2019280">.</span><span class="ident" id="2019281">formatFloat</span><span class="op" id="2019292">(</span><span class="builtintype" id="2019293">float64</span><span class="op" id="2019300">(</span><span class="ident" id="2019301">v</span><span class="op" id="2019302">)</span><span class="op" id="2019303">,</span>&nbsp;<span class="string" id="2019305">&#39;e&#39;</span><span class="op" id="2019308">,</span>&nbsp;<span class="ident" id="2019310">doPrec</span><span class="op" id="2019316">(</span><span class="ident" id="2019317">f</span><span class="op" id="2019318">,</span>&nbsp;<span class="num" id="2019320">6</span><span class="op" id="2019321">)</span><span class="op" id="2019322">,</span>&nbsp;<span class="num" id="2019324">32</span><span class="op" id="2019326">)</span>&nbsp;<span class="op" id="2019328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2019331">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2019383">func</span>&nbsp;<span class="op" id="2019388">(</span><span class="ident" id="2019389">f</span>&nbsp;<span class="op" id="2019391">*</span><span class="ident" id="2019392">fmt</span><span class="op" id="2019395">)</span>&nbsp;<span class="ident" id="2019397">fmt_E32</span><span class="op" id="2019404">(</span><span class="ident" id="2019405">v</span>&nbsp;<span class="builtintype" id="2019407">float32</span><span class="op" id="2019414">)</span>&nbsp;<span class="op" id="2019416">{</span>&nbsp;<span class="ident" id="2019418">f</span><span class="op" id="2019419">.</span><span class="ident" id="2019420">formatFloat</span><span class="op" id="2019431">(</span><span class="builtintype" id="2019432">float64</span><span class="op" id="2019439">(</span><span class="ident" id="2019440">v</span><span class="op" id="2019441">)</span><span class="op" id="2019442">,</span>&nbsp;<span class="string" id="2019444">&#39;E&#39;</span><span class="op" id="2019447">,</span>&nbsp;<span class="ident" id="2019449">doPrec</span><span class="op" id="2019455">(</span><span class="ident" id="2019456">f</span><span class="op" id="2019457">,</span>&nbsp;<span class="num" id="2019459">6</span><span class="op" id="2019460">)</span><span class="op" id="2019461">,</span>&nbsp;<span class="num" id="2019463">32</span><span class="op" id="2019465">)</span>&nbsp;<span class="op" id="2019467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2019470">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2019518">func</span>&nbsp;<span class="op" id="2019523">(</span><span class="ident" id="2019524">f</span>&nbsp;<span class="op" id="2019526">*</span><span class="ident" id="2019527">fmt</span><span class="op" id="2019530">)</span>&nbsp;<span class="ident" id="2019532">fmt_f32</span><span class="op" id="2019539">(</span><span class="ident" id="2019540">v</span>&nbsp;<span class="builtintype" id="2019542">float32</span><span class="op" id="2019549">)</span>&nbsp;<span class="op" id="2019551">{</span>&nbsp;<span class="ident" id="2019553">f</span><span class="op" id="2019554">.</span><span class="ident" id="2019555">formatFloat</span><span class="op" id="2019566">(</span><span class="builtintype" id="2019567">float64</span><span class="op" id="2019574">(</span><span class="ident" id="2019575">v</span><span class="op" id="2019576">)</span><span class="op" id="2019577">,</span>&nbsp;<span class="string" id="2019579">&#39;f&#39;</span><span class="op" id="2019582">,</span>&nbsp;<span class="ident" id="2019584">doPrec</span><span class="op" id="2019590">(</span><span class="ident" id="2019591">f</span><span class="op" id="2019592">,</span>&nbsp;<span class="num" id="2019594">6</span><span class="op" id="2019595">)</span><span class="op" id="2019596">,</span>&nbsp;<span class="num" id="2019598">32</span><span class="op" id="2019600">)</span>&nbsp;<span class="op" id="2019602">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2019605">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2019676">func</span>&nbsp;<span class="op" id="2019681">(</span><span class="ident" id="2019682">f</span>&nbsp;<span class="op" id="2019684">*</span><span class="ident" id="2019685">fmt</span><span class="op" id="2019688">)</span>&nbsp;<span class="ident" id="2019690">fmt_g32</span><span class="op" id="2019697">(</span><span class="ident" id="2019698">v</span>&nbsp;<span class="builtintype" id="2019700">float32</span><span class="op" id="2019707">)</span>&nbsp;<span class="op" id="2019709">{</span>&nbsp;<span class="ident" id="2019711">f</span><span class="op" id="2019712">.</span><span class="ident" id="2019713">formatFloat</span><span class="op" id="2019724">(</span><span class="builtintype" id="2019725">float64</span><span class="op" id="2019732">(</span><span class="ident" id="2019733">v</span><span class="op" id="2019734">)</span><span class="op" id="2019735">,</span>&nbsp;<span class="string" id="2019737">&#39;g&#39;</span><span class="op" id="2019740">,</span>&nbsp;<span class="ident" id="2019742">doPrec</span><span class="op" id="2019748">(</span><span class="ident" id="2019749">f</span><span class="op" id="2019750">,</span>&nbsp;<span class="op" id="2019752">-</span><span class="num" id="2019753">1</span><span class="op" id="2019754">)</span><span class="op" id="2019755">,</span>&nbsp;<span class="num" id="2019757">32</span><span class="op" id="2019759">)</span>&nbsp;<span class="op" id="2019761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2019764">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2019835">func</span>&nbsp;<span class="op" id="2019840">(</span><span class="ident" id="2019841">f</span>&nbsp;<span class="op" id="2019843">*</span><span class="ident" id="2019844">fmt</span><span class="op" id="2019847">)</span>&nbsp;<span class="ident" id="2019849">fmt_G32</span><span class="op" id="2019856">(</span><span class="ident" id="2019857">v</span>&nbsp;<span class="builtintype" id="2019859">float32</span><span class="op" id="2019866">)</span>&nbsp;<span class="op" id="2019868">{</span>&nbsp;<span class="ident" id="2019870">f</span><span class="op" id="2019871">.</span><span class="ident" id="2019872">formatFloat</span><span class="op" id="2019883">(</span><span class="builtintype" id="2019884">float64</span><span class="op" id="2019891">(</span><span class="ident" id="2019892">v</span><span class="op" id="2019893">)</span><span class="op" id="2019894">,</span>&nbsp;<span class="string" id="2019896">&#39;G&#39;</span><span class="op" id="2019899">,</span>&nbsp;<span class="ident" id="2019901">doPrec</span><span class="op" id="2019907">(</span><span class="ident" id="2019908">f</span><span class="op" id="2019909">,</span>&nbsp;<span class="op" id="2019911">-</span><span class="num" id="2019912">1</span><span class="op" id="2019913">)</span><span class="op" id="2019914">,</span>&nbsp;<span class="num" id="2019916">32</span><span class="op" id="2019918">)</span>&nbsp;<span class="op" id="2019920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2019923">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2019998">func</span>&nbsp;<span class="op" id="2020003">(</span><span class="ident" id="2020004">f</span>&nbsp;<span class="op" id="2020006">*</span><span class="ident" id="2020007">fmt</span><span class="op" id="2020010">)</span>&nbsp;<span class="ident" id="2020012">fmt_fb32</span><span class="op" id="2020020">(</span><span class="ident" id="2020021">v</span>&nbsp;<span class="builtintype" id="2020023">float32</span><span class="op" id="2020030">)</span>&nbsp;<span class="op" id="2020032">{</span>&nbsp;<span class="ident" id="2020034">f</span><span class="op" id="2020035">.</span><span class="ident" id="2020036">formatFloat</span><span class="op" id="2020047">(</span><span class="builtintype" id="2020048">float64</span><span class="op" id="2020055">(</span><span class="ident" id="2020056">v</span><span class="op" id="2020057">)</span><span class="op" id="2020058">,</span>&nbsp;<span class="string" id="2020060">&#39;b&#39;</span><span class="op" id="2020063">,</span>&nbsp;<span class="num" id="2020065">0</span><span class="op" id="2020066">,</span>&nbsp;<span class="num" id="2020068">32</span><span class="op" id="2020070">)</span>&nbsp;<span class="op" id="2020072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2020075">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2020129">func</span>&nbsp;<span class="op" id="2020134">(</span><span class="ident" id="2020135">f</span>&nbsp;<span class="op" id="2020137">*</span><span class="ident" id="2020138">fmt</span><span class="op" id="2020141">)</span>&nbsp;<span class="ident" id="2020143">fmt_c64</span><span class="op" id="2020150">(</span><span class="ident" id="2020151">v</span>&nbsp;<span class="builtintype" id="2020153">complex64</span><span class="op" id="2020162">,</span>&nbsp;<span class="ident" id="2020164">verb</span>&nbsp;<span class="builtintype" id="2020169">rune</span><span class="op" id="2020173">)</span>&nbsp;<span class="op" id="2020175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020178">f</span><span class="op" id="2020179">.</span><span class="ident" id="2020180">fmt_complex</span><span class="op" id="2020191">(</span><span class="builtintype" id="2020192">float64</span><span class="op" id="2020199">(</span><span class="builtinfunc" id="2020200">real</span><span class="op" id="2020204">(</span><span class="ident" id="2020205">v</span><span class="op" id="2020206">)</span><span class="op" id="2020207">)</span><span class="op" id="2020208">,</span>&nbsp;<span class="builtintype" id="2020210">float64</span><span class="op" id="2020217">(</span><span class="builtinfunc" id="2020218">imag</span><span class="op" id="2020222">(</span><span class="ident" id="2020223">v</span><span class="op" id="2020224">)</span><span class="op" id="2020225">)</span><span class="op" id="2020226">,</span>&nbsp;<span class="num" id="2020228">32</span><span class="op" id="2020230">,</span>&nbsp;<span class="ident" id="2020232">verb</span><span class="op" id="2020236">)</span><br>
<span class="lineno"></span><span class="op" id="2020238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2020241">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2020297">func</span>&nbsp;<span class="op" id="2020302">(</span><span class="ident" id="2020303">f</span>&nbsp;<span class="op" id="2020305">*</span><span class="ident" id="2020306">fmt</span><span class="op" id="2020309">)</span>&nbsp;<span class="ident" id="2020311">fmt_c128</span><span class="op" id="2020319">(</span><span class="ident" id="2020320">v</span>&nbsp;<span class="builtintype" id="2020322">complex128</span><span class="op" id="2020332">,</span>&nbsp;<span class="ident" id="2020334">verb</span>&nbsp;<span class="builtintype" id="2020339">rune</span><span class="op" id="2020343">)</span>&nbsp;<span class="op" id="2020345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020348">f</span><span class="op" id="2020349">.</span><span class="ident" id="2020350">fmt_complex</span><span class="op" id="2020361">(</span><span class="builtinfunc" id="2020362">real</span><span class="op" id="2020366">(</span><span class="ident" id="2020367">v</span><span class="op" id="2020368">)</span><span class="op" id="2020369">,</span>&nbsp;<span class="builtinfunc" id="2020371">imag</span><span class="op" id="2020375">(</span><span class="ident" id="2020376">v</span><span class="op" id="2020377">)</span><span class="op" id="2020378">,</span>&nbsp;<span class="num" id="2020380">64</span><span class="op" id="2020382">,</span>&nbsp;<span class="ident" id="2020384">verb</span><span class="op" id="2020388">)</span><br>
<span class="lineno"></span><span class="op" id="2020390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2020393">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2020444">func</span>&nbsp;<span class="op" id="2020449">(</span><span class="ident" id="2020450">f</span>&nbsp;<span class="op" id="2020452">*</span><span class="ident" id="2020453">fmt</span><span class="op" id="2020456">)</span>&nbsp;<span class="ident" id="2020458">fmt_complex</span><span class="op" id="2020469">(</span><span class="ident" id="2020470">r</span><span class="op" id="2020471">,</span>&nbsp;<span class="ident" id="2020473">j</span>&nbsp;<span class="builtintype" id="2020475">float64</span><span class="op" id="2020482">,</span>&nbsp;<span class="ident" id="2020484">size</span>&nbsp;<span class="builtintype" id="2020489">int</span><span class="op" id="2020492">,</span>&nbsp;<span class="ident" id="2020494">verb</span>&nbsp;<span class="builtintype" id="2020499">rune</span><span class="op" id="2020503">)</span>&nbsp;<span class="op" id="2020505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020508">f</span><span class="op" id="2020509">.</span><span class="ident" id="2020510">buf</span><span class="op" id="2020513">.</span><span class="ident" id="2020514">WriteByte</span><span class="op" id="2020523">(</span><span class="string" id="2020524">&#39;(&#39;</span><span class="op" id="2020527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020530">oldPlus</span>&nbsp;<span class="op" id="2020538">:=</span>&nbsp;<span class="ident" id="2020541">f</span><span class="op" id="2020542">.</span><span class="ident" id="2020543">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020549">oldSpace</span>&nbsp;<span class="op" id="2020558">:=</span>&nbsp;<span class="ident" id="2020561">f</span><span class="op" id="2020562">.</span><span class="ident" id="2020563">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020570">oldWid</span>&nbsp;<span class="op" id="2020577">:=</span>&nbsp;<span class="ident" id="2020580">f</span><span class="op" id="2020581">.</span><span class="ident" id="2020582">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020587">for</span>&nbsp;<span class="ident" id="2020591">i</span>&nbsp;<span class="op" id="2020593">:=</span>&nbsp;<span class="num" id="2020596">0</span><span class="op" id="2020597">;</span>&nbsp;<span class="op" id="2020599">;</span>&nbsp;<span class="ident" id="2020601">i</span><span class="op" id="2020602">++</span>&nbsp;<span class="op" id="2020605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020609">switch</span>&nbsp;<span class="ident" id="2020616">verb</span>&nbsp;<span class="op" id="2020621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020625">case</span>&nbsp;<span class="string" id="2020630">&#39;b&#39;</span><span class="op" id="2020633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020638">f</span><span class="op" id="2020639">.</span><span class="ident" id="2020640">formatFloat</span><span class="op" id="2020651">(</span><span class="ident" id="2020652">r</span><span class="op" id="2020653">,</span>&nbsp;<span class="string" id="2020655">&#39;b&#39;</span><span class="op" id="2020658">,</span>&nbsp;<span class="num" id="2020660">0</span><span class="op" id="2020661">,</span>&nbsp;<span class="ident" id="2020663">size</span><span class="op" id="2020667">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020671">case</span>&nbsp;<span class="string" id="2020676">&#39;e&#39;</span><span class="op" id="2020679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020684">f</span><span class="op" id="2020685">.</span><span class="ident" id="2020686">formatFloat</span><span class="op" id="2020697">(</span><span class="ident" id="2020698">r</span><span class="op" id="2020699">,</span>&nbsp;<span class="string" id="2020701">&#39;e&#39;</span><span class="op" id="2020704">,</span>&nbsp;<span class="ident" id="2020706">doPrec</span><span class="op" id="2020712">(</span><span class="ident" id="2020713">f</span><span class="op" id="2020714">,</span>&nbsp;<span class="num" id="2020716">6</span><span class="op" id="2020717">)</span><span class="op" id="2020718">,</span>&nbsp;<span class="ident" id="2020720">size</span><span class="op" id="2020724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020728">case</span>&nbsp;<span class="string" id="2020733">&#39;E&#39;</span><span class="op" id="2020736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020741">f</span><span class="op" id="2020742">.</span><span class="ident" id="2020743">formatFloat</span><span class="op" id="2020754">(</span><span class="ident" id="2020755">r</span><span class="op" id="2020756">,</span>&nbsp;<span class="string" id="2020758">&#39;E&#39;</span><span class="op" id="2020761">,</span>&nbsp;<span class="ident" id="2020763">doPrec</span><span class="op" id="2020769">(</span><span class="ident" id="2020770">f</span><span class="op" id="2020771">,</span>&nbsp;<span class="num" id="2020773">6</span><span class="op" id="2020774">)</span><span class="op" id="2020775">,</span>&nbsp;<span class="ident" id="2020777">size</span><span class="op" id="2020781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020785">case</span>&nbsp;<span class="string" id="2020790">&#39;f&#39;</span><span class="op" id="2020793">,</span>&nbsp;<span class="string" id="2020795">&#39;F&#39;</span><span class="op" id="2020798">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020803">f</span><span class="op" id="2020804">.</span><span class="ident" id="2020805">formatFloat</span><span class="op" id="2020816">(</span><span class="ident" id="2020817">r</span><span class="op" id="2020818">,</span>&nbsp;<span class="string" id="2020820">&#39;f&#39;</span><span class="op" id="2020823">,</span>&nbsp;<span class="ident" id="2020825">doPrec</span><span class="op" id="2020831">(</span><span class="ident" id="2020832">f</span><span class="op" id="2020833">,</span>&nbsp;<span class="num" id="2020835">6</span><span class="op" id="2020836">)</span><span class="op" id="2020837">,</span>&nbsp;<span class="ident" id="2020839">size</span><span class="op" id="2020843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020847">case</span>&nbsp;<span class="string" id="2020852">&#39;g&#39;</span><span class="op" id="2020855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020860">f</span><span class="op" id="2020861">.</span><span class="ident" id="2020862">formatFloat</span><span class="op" id="2020873">(</span><span class="ident" id="2020874">r</span><span class="op" id="2020875">,</span>&nbsp;<span class="string" id="2020877">&#39;g&#39;</span><span class="op" id="2020880">,</span>&nbsp;<span class="ident" id="2020882">doPrec</span><span class="op" id="2020888">(</span><span class="ident" id="2020889">f</span><span class="op" id="2020890">,</span>&nbsp;<span class="op" id="2020892">-</span><span class="num" id="2020893">1</span><span class="op" id="2020894">)</span><span class="op" id="2020895">,</span>&nbsp;<span class="ident" id="2020897">size</span><span class="op" id="2020901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020905">case</span>&nbsp;<span class="string" id="2020910">&#39;G&#39;</span><span class="op" id="2020913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2020918">f</span><span class="op" id="2020919">.</span><span class="ident" id="2020920">formatFloat</span><span class="op" id="2020931">(</span><span class="ident" id="2020932">r</span><span class="op" id="2020933">,</span>&nbsp;<span class="string" id="2020935">&#39;G&#39;</span><span class="op" id="2020938">,</span>&nbsp;<span class="ident" id="2020940">doPrec</span><span class="op" id="2020946">(</span><span class="ident" id="2020947">f</span><span class="op" id="2020948">,</span>&nbsp;<span class="op" id="2020950">-</span><span class="num" id="2020951">1</span><span class="op" id="2020952">)</span><span class="op" id="2020953">,</span>&nbsp;<span class="ident" id="2020955">size</span><span class="op" id="2020959">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020967">if</span>&nbsp;<span class="ident" id="2020970">i</span>&nbsp;<span class="op" id="2020972">!=</span>&nbsp;<span class="num" id="2020975">0</span>&nbsp;<span class="op" id="2020977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2020982">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2020990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2020994">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021033">f</span><span class="op" id="2021034">.</span><span class="ident" id="2021035">plus</span>&nbsp;<span class="op" id="2021040">=</span>&nbsp;<span class="builtintype" id="2021042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021049">f</span><span class="op" id="2021050">.</span><span class="ident" id="2021051">space</span>&nbsp;<span class="op" id="2021057">=</span>&nbsp;<span class="builtintype" id="2021059">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021067">f</span><span class="op" id="2021068">.</span><span class="ident" id="2021069">wid</span>&nbsp;<span class="op" id="2021073">=</span>&nbsp;<span class="ident" id="2021075">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021084">r</span>&nbsp;<span class="op" id="2021086">=</span>&nbsp;<span class="ident" id="2021088">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2021091">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021094">f</span><span class="op" id="2021095">.</span><span class="ident" id="2021096">space</span>&nbsp;<span class="op" id="2021102">=</span>&nbsp;<span class="ident" id="2021104">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021114">f</span><span class="op" id="2021115">.</span><span class="ident" id="2021116">plus</span>&nbsp;<span class="op" id="2021121">=</span>&nbsp;<span class="ident" id="2021123">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021132">f</span><span class="op" id="2021133">.</span><span class="ident" id="2021134">wid</span>&nbsp;<span class="op" id="2021138">=</span>&nbsp;<span class="ident" id="2021140">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2021148">f</span><span class="op" id="2021149">.</span><span class="ident" id="2021150">buf</span><span class="op" id="2021153">.</span><span class="ident" id="2021154">Write</span><span class="op" id="2021159">(</span><span class="ident" id="2021160">irparenBytes</span><span class="op" id="2021172">)</span><br>
<span class="lineno"></span><span class="op" id="2021174">}</span>
</div>
</body>
</html>
