<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2336798">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2336853">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2336907">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2336958">package</span>&nbsp;<span class="ident" id="2336966">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2336972">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2337038">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2337092">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2337143">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2337198">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2337228">//</span><br>
<span class="lineno"></span><span class="comment" id="2337231">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2337287">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2337356">//</span><br>
<span class="lineno"></span><span class="comment" id="2337359">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2337418">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2337474">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2337531">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2337548">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2337604">//</span><br>
<span class="lineno">25</span><span class="comment" id="2337607">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2337649">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2337709">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2337723">//</span><br>
<span class="lineno"></span><span class="comment" id="2337726">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2337744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2337809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2337872">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2337906">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2337940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2337974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2338026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2338066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2338121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2338176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2338233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2338286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2338340">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2338374">//</span><br>
<span class="lineno"></span><span class="comment" id="2338377">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2338428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2338475">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2338499">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2338560">//</span><br>
<span class="lineno">50</span><span class="comment" id="2338563">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2338585">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2338605">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2338625">func</span>&nbsp;<span class="ident" id="2338630">Jn</span><span class="op" id="2338632">(</span><span class="ident" id="2338633">n</span>&nbsp;<span class="builtintype" id="2338635">int</span><span class="op" id="2338638">,</span>&nbsp;<span class="ident" id="2338640">x</span>&nbsp;<span class="builtintype" id="2338642">float64</span><span class="op" id="2338649">)</span>&nbsp;<span class="builtintype" id="2338651">float64</span>&nbsp;<span class="op" id="2338659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338662">const</span>&nbsp;<span class="op" id="2338668">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2338672">TwoM29</span>&nbsp;<span class="op" id="2338679">=</span>&nbsp;<span class="num" id="2338681">1.0</span>&nbsp;<span class="op" id="2338685">/</span>&nbsp;<span class="op" id="2338687">(</span><span class="num" id="2338688">1</span>&nbsp;<span class="op" id="2338690">&lt;&lt;</span>&nbsp;<span class="num" id="2338693">29</span><span class="op" id="2338695">)</span>&nbsp;<span class="comment" id="2338697">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2338728">Two302</span>&nbsp;<span class="op" id="2338735">=</span>&nbsp;<span class="num" id="2338737">1</span>&nbsp;<span class="op" id="2338739">&lt;&lt;</span>&nbsp;<span class="num" id="2338742">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2338753">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2338783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2338786">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338804">switch</span>&nbsp;<span class="op" id="2338811">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338814">case</span>&nbsp;<span class="ident" id="2338819">IsNaN</span><span class="op" id="2338824">(</span><span class="ident" id="2338825">x</span><span class="op" id="2338826">)</span><span class="op" id="2338827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338831">return</span>&nbsp;<span class="ident" id="2338838">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338841">case</span>&nbsp;<span class="ident" id="2338846">IsInf</span><span class="op" id="2338851">(</span><span class="ident" id="2338852">x</span><span class="op" id="2338853">,</span>&nbsp;<span class="num" id="2338855">0</span><span class="op" id="2338856">)</span><span class="op" id="2338857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338861">return</span>&nbsp;<span class="num" id="2338868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2338871">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2338874">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2338937">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338968">if</span>&nbsp;<span class="ident" id="2338971">n</span>&nbsp;<span class="op" id="2338973">==</span>&nbsp;<span class="num" id="2338976">0</span>&nbsp;<span class="op" id="2338978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338982">return</span>&nbsp;<span class="ident" id="2338989">J0</span><span class="op" id="2338991">(</span><span class="ident" id="2338992">x</span><span class="op" id="2338993">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2338996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2338999">if</span>&nbsp;<span class="ident" id="2339002">x</span>&nbsp;<span class="op" id="2339004">==</span>&nbsp;<span class="num" id="2339007">0</span>&nbsp;<span class="op" id="2339009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339013">return</span>&nbsp;<span class="num" id="2339020">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2339023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339026">if</span>&nbsp;<span class="ident" id="2339029">n</span>&nbsp;<span class="op" id="2339031">&lt;</span>&nbsp;<span class="num" id="2339033">0</span>&nbsp;<span class="op" id="2339035">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339039">n</span><span class="op" id="2339040">,</span>&nbsp;<span class="ident" id="2339042">x</span>&nbsp;<span class="op" id="2339044">=</span>&nbsp;<span class="op" id="2339046">-</span><span class="ident" id="2339047">n</span><span class="op" id="2339048">,</span>&nbsp;<span class="op" id="2339050">-</span><span class="ident" id="2339051">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2339054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339057">if</span>&nbsp;<span class="ident" id="2339060">n</span>&nbsp;<span class="op" id="2339062">==</span>&nbsp;<span class="num" id="2339065">1</span>&nbsp;<span class="op" id="2339067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339071">return</span>&nbsp;<span class="ident" id="2339078">J1</span><span class="op" id="2339080">(</span><span class="ident" id="2339081">x</span><span class="op" id="2339082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2339085">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339088">sign</span>&nbsp;<span class="op" id="2339093">:=</span>&nbsp;<span class="builtintype" id="2339096">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339103">if</span>&nbsp;<span class="ident" id="2339106">x</span>&nbsp;<span class="op" id="2339108">&lt;</span>&nbsp;<span class="num" id="2339110">0</span>&nbsp;<span class="op" id="2339112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339116">x</span>&nbsp;<span class="op" id="2339118">=</span>&nbsp;<span class="op" id="2339120">-</span><span class="ident" id="2339121">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339125">if</span>&nbsp;<span class="ident" id="2339128">n</span><span class="op" id="2339129">&amp;</span><span class="num" id="2339130">1</span>&nbsp;<span class="op" id="2339132">==</span>&nbsp;<span class="num" id="2339135">1</span>&nbsp;<span class="op" id="2339137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339142">sign</span>&nbsp;<span class="op" id="2339147">=</span>&nbsp;<span class="builtintype" id="2339149">true</span>&nbsp;<span class="comment" id="2339154">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2339180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2339183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339186">var</span>&nbsp;<span class="ident" id="2339190">b</span>&nbsp;<span class="builtintype" id="2339192">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339201">if</span>&nbsp;<span class="builtintype" id="2339204">float64</span><span class="op" id="2339211">(</span><span class="ident" id="2339212">n</span><span class="op" id="2339213">)</span>&nbsp;<span class="op" id="2339215">&lt;=</span>&nbsp;<span class="ident" id="2339218">x</span>&nbsp;<span class="op" id="2339220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339224">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339272">if</span>&nbsp;<span class="ident" id="2339275">x</span>&nbsp;<span class="op" id="2339277">&gt;=</span>&nbsp;<span class="ident" id="2339280">Two302</span>&nbsp;<span class="op" id="2339287">{</span>&nbsp;<span class="comment" id="2339289">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339307">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339325">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339531">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339593">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339743">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2339791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339840">var</span>&nbsp;<span class="ident" id="2339844">temp</span>&nbsp;<span class="builtintype" id="2339849">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339860">switch</span>&nbsp;<span class="ident" id="2339867">n</span>&nbsp;<span class="op" id="2339869">&amp;</span>&nbsp;<span class="num" id="2339871">3</span>&nbsp;<span class="op" id="2339873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339878">case</span>&nbsp;<span class="num" id="2339883">0</span><span class="op" id="2339884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339890">temp</span>&nbsp;<span class="op" id="2339895">=</span>&nbsp;<span class="ident" id="2339897">Cos</span><span class="op" id="2339900">(</span><span class="ident" id="2339901">x</span><span class="op" id="2339902">)</span>&nbsp;<span class="op" id="2339904">+</span>&nbsp;<span class="ident" id="2339906">Sin</span><span class="op" id="2339909">(</span><span class="ident" id="2339910">x</span><span class="op" id="2339911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339916">case</span>&nbsp;<span class="num" id="2339921">1</span><span class="op" id="2339922">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339928">temp</span>&nbsp;<span class="op" id="2339933">=</span>&nbsp;<span class="op" id="2339935">-</span><span class="ident" id="2339936">Cos</span><span class="op" id="2339939">(</span><span class="ident" id="2339940">x</span><span class="op" id="2339941">)</span>&nbsp;<span class="op" id="2339943">+</span>&nbsp;<span class="ident" id="2339945">Sin</span><span class="op" id="2339948">(</span><span class="ident" id="2339949">x</span><span class="op" id="2339950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339955">case</span>&nbsp;<span class="num" id="2339960">2</span><span class="op" id="2339961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2339967">temp</span>&nbsp;<span class="op" id="2339972">=</span>&nbsp;<span class="op" id="2339974">-</span><span class="ident" id="2339975">Cos</span><span class="op" id="2339978">(</span><span class="ident" id="2339979">x</span><span class="op" id="2339980">)</span>&nbsp;<span class="op" id="2339982">-</span>&nbsp;<span class="ident" id="2339984">Sin</span><span class="op" id="2339987">(</span><span class="ident" id="2339988">x</span><span class="op" id="2339989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2339994">case</span>&nbsp;<span class="num" id="2339999">3</span><span class="op" id="2340000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340006">temp</span>&nbsp;<span class="op" id="2340011">=</span>&nbsp;<span class="ident" id="2340013">Cos</span><span class="op" id="2340016">(</span><span class="ident" id="2340017">x</span><span class="op" id="2340018">)</span>&nbsp;<span class="op" id="2340020">-</span>&nbsp;<span class="ident" id="2340022">Sin</span><span class="op" id="2340025">(</span><span class="ident" id="2340026">x</span><span class="op" id="2340027">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340037">b</span>&nbsp;<span class="op" id="2340039">=</span>&nbsp;<span class="op" id="2340041">(</span><span class="num" id="2340042">1</span>&nbsp;<span class="op" id="2340044">/</span>&nbsp;<span class="ident" id="2340046">SqrtPi</span><span class="op" id="2340052">)</span>&nbsp;<span class="op" id="2340054">*</span>&nbsp;<span class="ident" id="2340056">temp</span>&nbsp;<span class="op" id="2340061">/</span>&nbsp;<span class="ident" id="2340063">Sqrt</span><span class="op" id="2340067">(</span><span class="ident" id="2340068">x</span><span class="op" id="2340069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340073">}</span>&nbsp;<span class="keyword" id="2340075">else</span>&nbsp;<span class="op" id="2340080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340085">b</span>&nbsp;<span class="op" id="2340087">=</span>&nbsp;<span class="ident" id="2340089">J1</span><span class="op" id="2340091">(</span><span class="ident" id="2340092">x</span><span class="op" id="2340093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2340098">for</span>&nbsp;<span class="ident" id="2340102">i</span><span class="op" id="2340103">,</span>&nbsp;<span class="ident" id="2340105">a</span>&nbsp;<span class="op" id="2340107">:=</span>&nbsp;<span class="num" id="2340110">1</span><span class="op" id="2340111">,</span>&nbsp;<span class="ident" id="2340113">J0</span><span class="op" id="2340115">(</span><span class="ident" id="2340116">x</span><span class="op" id="2340117">)</span><span class="op" id="2340118">;</span>&nbsp;<span class="ident" id="2340120">i</span>&nbsp;<span class="op" id="2340122">&lt;</span>&nbsp;<span class="ident" id="2340124">n</span><span class="op" id="2340125">;</span>&nbsp;<span class="ident" id="2340127">i</span><span class="op" id="2340128">++</span>&nbsp;<span class="op" id="2340131">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340137">a</span><span class="op" id="2340138">,</span>&nbsp;<span class="ident" id="2340140">b</span>&nbsp;<span class="op" id="2340142">=</span>&nbsp;<span class="ident" id="2340144">b</span><span class="op" id="2340145">,</span>&nbsp;<span class="ident" id="2340147">b</span><span class="op" id="2340148">*</span><span class="op" id="2340149">(</span><span class="builtintype" id="2340150">float64</span><span class="op" id="2340157">(</span><span class="ident" id="2340158">i</span><span class="op" id="2340159">+</span><span class="ident" id="2340160">i</span><span class="op" id="2340161">)</span><span class="op" id="2340162">/</span><span class="ident" id="2340163">x</span><span class="op" id="2340164">)</span><span class="op" id="2340165">-</span><span class="ident" id="2340166">a</span>&nbsp;<span class="comment" id="2340168">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340197">}</span>&nbsp;<span class="keyword" id="2340199">else</span>&nbsp;<span class="op" id="2340204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2340208">if</span>&nbsp;<span class="ident" id="2340211">x</span>&nbsp;<span class="op" id="2340213">&lt;</span>&nbsp;<span class="ident" id="2340215">TwoM29</span>&nbsp;<span class="op" id="2340222">{</span>&nbsp;<span class="comment" id="2340224">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340241">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340302">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2340339">if</span>&nbsp;<span class="ident" id="2340342">n</span>&nbsp;<span class="op" id="2340344">&gt;</span>&nbsp;<span class="num" id="2340346">33</span>&nbsp;<span class="op" id="2340349">{</span>&nbsp;<span class="comment" id="2340351">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340368">b</span>&nbsp;<span class="op" id="2340370">=</span>&nbsp;<span class="num" id="2340372">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340377">}</span>&nbsp;<span class="keyword" id="2340379">else</span>&nbsp;<span class="op" id="2340384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340390">temp</span>&nbsp;<span class="op" id="2340395">:=</span>&nbsp;<span class="ident" id="2340398">x</span>&nbsp;<span class="op" id="2340400">*</span>&nbsp;<span class="num" id="2340402">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340410">b</span>&nbsp;<span class="op" id="2340412">=</span>&nbsp;<span class="ident" id="2340414">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340423">a</span>&nbsp;<span class="op" id="2340425">:=</span>&nbsp;<span class="num" id="2340428">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2340436">for</span>&nbsp;<span class="ident" id="2340440">i</span>&nbsp;<span class="op" id="2340442">:=</span>&nbsp;<span class="num" id="2340445">2</span><span class="op" id="2340446">;</span>&nbsp;<span class="ident" id="2340448">i</span>&nbsp;<span class="op" id="2340450">&lt;=</span>&nbsp;<span class="ident" id="2340453">n</span><span class="op" id="2340454">;</span>&nbsp;<span class="ident" id="2340456">i</span><span class="op" id="2340457">++</span>&nbsp;<span class="op" id="2340460">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340467">a</span>&nbsp;<span class="op" id="2340469">*=</span>&nbsp;<span class="builtintype" id="2340472">float64</span><span class="op" id="2340479">(</span><span class="ident" id="2340480">i</span><span class="op" id="2340481">)</span>&nbsp;<span class="comment" id="2340483">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340498">b</span>&nbsp;<span class="op" id="2340500">*=</span>&nbsp;<span class="ident" id="2340503">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2340514">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2340540">b</span>&nbsp;<span class="op" id="2340542">/=</span>&nbsp;<span class="ident" id="2340545">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340550">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2340554">}</span>&nbsp;<span class="keyword" id="2340556">else</span>&nbsp;<span class="op" id="2340561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340566">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340645">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340751">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340757">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340802">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340858">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340906">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2340956">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341002">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341008">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341062">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341129">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341194">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341261">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341333">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341339">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341385">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341420">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341458">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341496">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341534">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341577">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341595">w</span>&nbsp;<span class="op" id="2341597">:=</span>&nbsp;<span class="builtintype" id="2341600">float64</span><span class="op" id="2341607">(</span><span class="ident" id="2341608">n</span><span class="op" id="2341609">+</span><span class="ident" id="2341610">n</span><span class="op" id="2341611">)</span>&nbsp;<span class="op" id="2341613">/</span>&nbsp;<span class="ident" id="2341615">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341620">h</span>&nbsp;<span class="op" id="2341622">:=</span>&nbsp;<span class="num" id="2341625">2</span>&nbsp;<span class="op" id="2341627">/</span>&nbsp;<span class="ident" id="2341629">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341634">q0</span>&nbsp;<span class="op" id="2341637">:=</span>&nbsp;<span class="ident" id="2341640">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341645">z</span>&nbsp;<span class="op" id="2341647">:=</span>&nbsp;<span class="ident" id="2341650">w</span>&nbsp;<span class="op" id="2341652">+</span>&nbsp;<span class="ident" id="2341654">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341659">q1</span>&nbsp;<span class="op" id="2341662">:=</span>&nbsp;<span class="ident" id="2341665">w</span><span class="op" id="2341666">*</span><span class="ident" id="2341667">z</span>&nbsp;<span class="op" id="2341669">-</span>&nbsp;<span class="num" id="2341671">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341676">k</span>&nbsp;<span class="op" id="2341678">:=</span>&nbsp;<span class="num" id="2341681">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2341686">for</span>&nbsp;<span class="ident" id="2341690">q1</span>&nbsp;<span class="op" id="2341693">&lt;</span>&nbsp;<span class="num" id="2341695">1e9</span>&nbsp;<span class="op" id="2341699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341705">k</span>&nbsp;<span class="op" id="2341707">+=</span>&nbsp;<span class="num" id="2341710">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341716">z</span>&nbsp;<span class="op" id="2341718">+=</span>&nbsp;<span class="ident" id="2341721">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341727">q0</span><span class="op" id="2341729">,</span>&nbsp;<span class="ident" id="2341731">q1</span>&nbsp;<span class="op" id="2341734">=</span>&nbsp;<span class="ident" id="2341736">q1</span><span class="op" id="2341738">,</span>&nbsp;<span class="ident" id="2341740">z</span><span class="op" id="2341741">*</span><span class="ident" id="2341742">q1</span><span class="op" id="2341744">-</span><span class="ident" id="2341745">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2341751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341756">m</span>&nbsp;<span class="op" id="2341758">:=</span>&nbsp;<span class="ident" id="2341761">n</span>&nbsp;<span class="op" id="2341763">+</span>&nbsp;<span class="ident" id="2341765">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341770">t</span>&nbsp;<span class="op" id="2341772">:=</span>&nbsp;<span class="num" id="2341775">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2341782">for</span>&nbsp;<span class="ident" id="2341786">i</span>&nbsp;<span class="op" id="2341788">:=</span>&nbsp;<span class="num" id="2341791">2</span>&nbsp;<span class="op" id="2341793">*</span>&nbsp;<span class="op" id="2341795">(</span><span class="ident" id="2341796">n</span>&nbsp;<span class="op" id="2341798">+</span>&nbsp;<span class="ident" id="2341800">k</span><span class="op" id="2341801">)</span><span class="op" id="2341802">;</span>&nbsp;<span class="ident" id="2341804">i</span>&nbsp;<span class="op" id="2341806">&gt;=</span>&nbsp;<span class="ident" id="2341809">m</span><span class="op" id="2341810">;</span>&nbsp;<span class="ident" id="2341812">i</span>&nbsp;<span class="op" id="2341814">-=</span>&nbsp;<span class="num" id="2341817">2</span>&nbsp;<span class="op" id="2341819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341825">t</span>&nbsp;<span class="op" id="2341827">=</span>&nbsp;<span class="num" id="2341829">1</span>&nbsp;<span class="op" id="2341831">/</span>&nbsp;<span class="op" id="2341833">(</span><span class="builtintype" id="2341834">float64</span><span class="op" id="2341841">(</span><span class="ident" id="2341842">i</span><span class="op" id="2341843">)</span><span class="op" id="2341844">/</span><span class="ident" id="2341845">x</span>&nbsp;<span class="op" id="2341847">-</span>&nbsp;<span class="ident" id="2341849">t</span><span class="op" id="2341850">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2341855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341860">a</span>&nbsp;<span class="op" id="2341862">:=</span>&nbsp;<span class="ident" id="2341865">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2341870">b</span>&nbsp;<span class="op" id="2341872">=</span>&nbsp;<span class="num" id="2341874">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341879">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341933">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2341970">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2342001">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2342042">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2342108">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2342167">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342200">tmp</span>&nbsp;<span class="op" id="2342204">:=</span>&nbsp;<span class="builtintype" id="2342207">float64</span><span class="op" id="2342214">(</span><span class="ident" id="2342215">n</span><span class="op" id="2342216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342221">v</span>&nbsp;<span class="op" id="2342223">:=</span>&nbsp;<span class="num" id="2342226">2</span>&nbsp;<span class="op" id="2342228">/</span>&nbsp;<span class="ident" id="2342230">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342235">tmp</span>&nbsp;<span class="op" id="2342239">=</span>&nbsp;<span class="ident" id="2342241">tmp</span>&nbsp;<span class="op" id="2342245">*</span>&nbsp;<span class="ident" id="2342247">Log</span><span class="op" id="2342250">(</span><span class="ident" id="2342251">Abs</span><span class="op" id="2342254">(</span><span class="ident" id="2342255">v</span><span class="op" id="2342256">*</span><span class="ident" id="2342257">tmp</span><span class="op" id="2342260">)</span><span class="op" id="2342261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342266">if</span>&nbsp;<span class="ident" id="2342269">tmp</span>&nbsp;<span class="op" id="2342273">&lt;</span>&nbsp;<span class="num" id="2342275">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2342302">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342308">for</span>&nbsp;<span class="ident" id="2342312">i</span>&nbsp;<span class="op" id="2342314">:=</span>&nbsp;<span class="ident" id="2342317">n</span>&nbsp;<span class="op" id="2342319">-</span>&nbsp;<span class="num" id="2342321">1</span><span class="op" id="2342322">;</span>&nbsp;<span class="ident" id="2342324">i</span>&nbsp;<span class="op" id="2342326">&gt;</span>&nbsp;<span class="num" id="2342328">0</span><span class="op" id="2342329">;</span>&nbsp;<span class="ident" id="2342331">i</span><span class="op" id="2342332">--</span>&nbsp;<span class="op" id="2342335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342342">di</span>&nbsp;<span class="op" id="2342345">:=</span>&nbsp;<span class="builtintype" id="2342348">float64</span><span class="op" id="2342355">(</span><span class="ident" id="2342356">i</span>&nbsp;<span class="op" id="2342358">+</span>&nbsp;<span class="ident" id="2342360">i</span><span class="op" id="2342361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342368">a</span><span class="op" id="2342369">,</span>&nbsp;<span class="ident" id="2342371">b</span>&nbsp;<span class="op" id="2342373">=</span>&nbsp;<span class="ident" id="2342375">b</span><span class="op" id="2342376">,</span>&nbsp;<span class="ident" id="2342378">b</span><span class="op" id="2342379">*</span><span class="ident" id="2342380">di</span><span class="op" id="2342382">/</span><span class="ident" id="2342383">x</span><span class="op" id="2342384">-</span><span class="ident" id="2342385">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342392">di</span>&nbsp;<span class="op" id="2342395">-=</span>&nbsp;<span class="num" id="2342398">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342404">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342409">}</span>&nbsp;<span class="keyword" id="2342411">else</span>&nbsp;<span class="op" id="2342416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342422">for</span>&nbsp;<span class="ident" id="2342426">i</span>&nbsp;<span class="op" id="2342428">:=</span>&nbsp;<span class="ident" id="2342431">n</span>&nbsp;<span class="op" id="2342433">-</span>&nbsp;<span class="num" id="2342435">1</span><span class="op" id="2342436">;</span>&nbsp;<span class="ident" id="2342438">i</span>&nbsp;<span class="op" id="2342440">&gt;</span>&nbsp;<span class="num" id="2342442">0</span><span class="op" id="2342443">;</span>&nbsp;<span class="ident" id="2342445">i</span><span class="op" id="2342446">--</span>&nbsp;<span class="op" id="2342449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342456">di</span>&nbsp;<span class="op" id="2342459">:=</span>&nbsp;<span class="builtintype" id="2342462">float64</span><span class="op" id="2342469">(</span><span class="ident" id="2342470">i</span>&nbsp;<span class="op" id="2342472">+</span>&nbsp;<span class="ident" id="2342474">i</span><span class="op" id="2342475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342482">a</span><span class="op" id="2342483">,</span>&nbsp;<span class="ident" id="2342485">b</span>&nbsp;<span class="op" id="2342487">=</span>&nbsp;<span class="ident" id="2342489">b</span><span class="op" id="2342490">,</span>&nbsp;<span class="ident" id="2342492">b</span><span class="op" id="2342493">*</span><span class="ident" id="2342494">di</span><span class="op" id="2342496">/</span><span class="ident" id="2342497">x</span><span class="op" id="2342498">-</span><span class="ident" id="2342499">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342506">di</span>&nbsp;<span class="op" id="2342509">-=</span>&nbsp;<span class="num" id="2342512">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2342519">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342562">if</span>&nbsp;<span class="ident" id="2342565">b</span>&nbsp;<span class="op" id="2342567">&gt;</span>&nbsp;<span class="num" id="2342569">1e100</span>&nbsp;<span class="op" id="2342575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342583">a</span>&nbsp;<span class="op" id="2342585">/=</span>&nbsp;<span class="ident" id="2342588">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342596">t</span>&nbsp;<span class="op" id="2342598">/=</span>&nbsp;<span class="ident" id="2342601">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342609">b</span>&nbsp;<span class="op" id="2342611">=</span>&nbsp;<span class="num" id="2342613">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2342636">b</span>&nbsp;<span class="op" id="2342638">=</span>&nbsp;<span class="ident" id="2342640">t</span>&nbsp;<span class="op" id="2342642">*</span>&nbsp;<span class="ident" id="2342644">J0</span><span class="op" id="2342646">(</span><span class="ident" id="2342647">x</span><span class="op" id="2342648">)</span>&nbsp;<span class="op" id="2342650">/</span>&nbsp;<span class="ident" id="2342652">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342656">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342662">if</span>&nbsp;<span class="ident" id="2342665">sign</span>&nbsp;<span class="op" id="2342670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342674">return</span>&nbsp;<span class="op" id="2342681">-</span><span class="ident" id="2342682">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2342685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342688">return</span>&nbsp;<span class="ident" id="2342695">b</span><br>
<span class="lineno">225</span><span class="op" id="2342697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2342700">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2342762">//</span><br>
<span class="lineno"></span><span class="comment" id="2342765">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2342787">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2342806">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2342829">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2342883">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2342905">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2342925">func</span>&nbsp;<span class="ident" id="2342930">Yn</span><span class="op" id="2342932">(</span><span class="ident" id="2342933">n</span>&nbsp;<span class="builtintype" id="2342935">int</span><span class="op" id="2342938">,</span>&nbsp;<span class="ident" id="2342940">x</span>&nbsp;<span class="builtintype" id="2342942">float64</span><span class="op" id="2342949">)</span>&nbsp;<span class="builtintype" id="2342951">float64</span>&nbsp;<span class="op" id="2342959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2342962">const</span>&nbsp;<span class="ident" id="2342968">Two302</span>&nbsp;<span class="op" id="2342975">=</span>&nbsp;<span class="num" id="2342977">1</span>&nbsp;<span class="op" id="2342979">&lt;&lt;</span>&nbsp;<span class="num" id="2342982">302</span>&nbsp;<span class="comment" id="2342986">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343016">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343034">switch</span>&nbsp;<span class="op" id="2343041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343044">case</span>&nbsp;<span class="ident" id="2343049">x</span>&nbsp;<span class="op" id="2343051">&lt;</span>&nbsp;<span class="num" id="2343053">0</span>&nbsp;<span class="op" id="2343055">||</span>&nbsp;<span class="ident" id="2343058">IsNaN</span><span class="op" id="2343063">(</span><span class="ident" id="2343064">x</span><span class="op" id="2343065">)</span><span class="op" id="2343066">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343070">return</span>&nbsp;<span class="ident" id="2343077">NaN</span><span class="op" id="2343080">(</span><span class="op" id="2343081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343084">case</span>&nbsp;<span class="ident" id="2343089">IsInf</span><span class="op" id="2343094">(</span><span class="ident" id="2343095">x</span><span class="op" id="2343096">,</span>&nbsp;<span class="num" id="2343098">1</span><span class="op" id="2343099">)</span><span class="op" id="2343100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343104">return</span>&nbsp;<span class="num" id="2343111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343118">if</span>&nbsp;<span class="ident" id="2343121">n</span>&nbsp;<span class="op" id="2343123">==</span>&nbsp;<span class="num" id="2343126">0</span>&nbsp;<span class="op" id="2343128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343132">return</span>&nbsp;<span class="ident" id="2343139">Y0</span><span class="op" id="2343141">(</span><span class="ident" id="2343142">x</span><span class="op" id="2343143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343149">if</span>&nbsp;<span class="ident" id="2343152">x</span>&nbsp;<span class="op" id="2343154">==</span>&nbsp;<span class="num" id="2343157">0</span>&nbsp;<span class="op" id="2343159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343163">if</span>&nbsp;<span class="ident" id="2343166">n</span>&nbsp;<span class="op" id="2343168">&lt;</span>&nbsp;<span class="num" id="2343170">0</span>&nbsp;<span class="op" id="2343172">&amp;&amp;</span>&nbsp;<span class="ident" id="2343175">n</span><span class="op" id="2343176">&amp;</span><span class="num" id="2343177">1</span>&nbsp;<span class="op" id="2343179">==</span>&nbsp;<span class="num" id="2343182">1</span>&nbsp;<span class="op" id="2343184">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343189">return</span>&nbsp;<span class="ident" id="2343196">Inf</span><span class="op" id="2343199">(</span><span class="num" id="2343200">1</span><span class="op" id="2343201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343209">return</span>&nbsp;<span class="ident" id="2343216">Inf</span><span class="op" id="2343219">(</span><span class="op" id="2343220">-</span><span class="num" id="2343221">1</span><span class="op" id="2343222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343228">sign</span>&nbsp;<span class="op" id="2343233">:=</span>&nbsp;<span class="builtintype" id="2343236">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343243">if</span>&nbsp;<span class="ident" id="2343246">n</span>&nbsp;<span class="op" id="2343248">&lt;</span>&nbsp;<span class="num" id="2343250">0</span>&nbsp;<span class="op" id="2343252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343256">n</span>&nbsp;<span class="op" id="2343258">=</span>&nbsp;<span class="op" id="2343260">-</span><span class="ident" id="2343261">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343265">if</span>&nbsp;<span class="ident" id="2343268">n</span><span class="op" id="2343269">&amp;</span><span class="num" id="2343270">1</span>&nbsp;<span class="op" id="2343272">==</span>&nbsp;<span class="num" id="2343275">1</span>&nbsp;<span class="op" id="2343277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343282">sign</span>&nbsp;<span class="op" id="2343287">=</span>&nbsp;<span class="builtintype" id="2343289">true</span>&nbsp;<span class="comment" id="2343294">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343329">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343335">if</span>&nbsp;<span class="ident" id="2343338">n</span>&nbsp;<span class="op" id="2343340">==</span>&nbsp;<span class="num" id="2343343">1</span>&nbsp;<span class="op" id="2343345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343349">if</span>&nbsp;<span class="ident" id="2343352">sign</span>&nbsp;<span class="op" id="2343357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343362">return</span>&nbsp;<span class="op" id="2343369">-</span><span class="ident" id="2343370">Y1</span><span class="op" id="2343372">(</span><span class="ident" id="2343373">x</span><span class="op" id="2343374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343378">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343382">return</span>&nbsp;<span class="ident" id="2343389">Y1</span><span class="op" id="2343391">(</span><span class="ident" id="2343392">x</span><span class="op" id="2343393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343399">var</span>&nbsp;<span class="ident" id="2343403">b</span>&nbsp;<span class="builtintype" id="2343405">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343414">if</span>&nbsp;<span class="ident" id="2343417">x</span>&nbsp;<span class="op" id="2343419">&gt;=</span>&nbsp;<span class="ident" id="2343422">Two302</span>&nbsp;<span class="op" id="2343429">{</span>&nbsp;<span class="comment" id="2343431">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343447">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343464">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343513">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343562">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343595">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343639">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343644">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343681">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343722">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343744">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343767">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2343789">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343812">var</span>&nbsp;<span class="ident" id="2343816">temp</span>&nbsp;<span class="builtintype" id="2343821">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343831">switch</span>&nbsp;<span class="ident" id="2343838">n</span>&nbsp;<span class="op" id="2343840">&amp;</span>&nbsp;<span class="num" id="2343842">3</span>&nbsp;<span class="op" id="2343844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343848">case</span>&nbsp;<span class="num" id="2343853">0</span><span class="op" id="2343854">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343859">temp</span>&nbsp;<span class="op" id="2343864">=</span>&nbsp;<span class="ident" id="2343866">Sin</span><span class="op" id="2343869">(</span><span class="ident" id="2343870">x</span><span class="op" id="2343871">)</span>&nbsp;<span class="op" id="2343873">-</span>&nbsp;<span class="ident" id="2343875">Cos</span><span class="op" id="2343878">(</span><span class="ident" id="2343879">x</span><span class="op" id="2343880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343884">case</span>&nbsp;<span class="num" id="2343889">1</span><span class="op" id="2343890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343895">temp</span>&nbsp;<span class="op" id="2343900">=</span>&nbsp;<span class="op" id="2343902">-</span><span class="ident" id="2343903">Sin</span><span class="op" id="2343906">(</span><span class="ident" id="2343907">x</span><span class="op" id="2343908">)</span>&nbsp;<span class="op" id="2343910">-</span>&nbsp;<span class="ident" id="2343912">Cos</span><span class="op" id="2343915">(</span><span class="ident" id="2343916">x</span><span class="op" id="2343917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343921">case</span>&nbsp;<span class="num" id="2343926">2</span><span class="op" id="2343927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343932">temp</span>&nbsp;<span class="op" id="2343937">=</span>&nbsp;<span class="op" id="2343939">-</span><span class="ident" id="2343940">Sin</span><span class="op" id="2343943">(</span><span class="ident" id="2343944">x</span><span class="op" id="2343945">)</span>&nbsp;<span class="op" id="2343947">+</span>&nbsp;<span class="ident" id="2343949">Cos</span><span class="op" id="2343952">(</span><span class="ident" id="2343953">x</span><span class="op" id="2343954">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2343958">case</span>&nbsp;<span class="num" id="2343963">3</span><span class="op" id="2343964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343969">temp</span>&nbsp;<span class="op" id="2343974">=</span>&nbsp;<span class="ident" id="2343976">Sin</span><span class="op" id="2343979">(</span><span class="ident" id="2343980">x</span><span class="op" id="2343981">)</span>&nbsp;<span class="op" id="2343983">+</span>&nbsp;<span class="ident" id="2343985">Cos</span><span class="op" id="2343988">(</span><span class="ident" id="2343989">x</span><span class="op" id="2343990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2343994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2343998">b</span>&nbsp;<span class="op" id="2344000">=</span>&nbsp;<span class="op" id="2344002">(</span><span class="num" id="2344003">1</span>&nbsp;<span class="op" id="2344005">/</span>&nbsp;<span class="ident" id="2344007">SqrtPi</span><span class="op" id="2344013">)</span>&nbsp;<span class="op" id="2344015">*</span>&nbsp;<span class="ident" id="2344017">temp</span>&nbsp;<span class="op" id="2344022">/</span>&nbsp;<span class="ident" id="2344024">Sqrt</span><span class="op" id="2344028">(</span><span class="ident" id="2344029">x</span><span class="op" id="2344030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2344033">}</span>&nbsp;<span class="keyword" id="2344035">else</span>&nbsp;<span class="op" id="2344040">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2344044">a</span>&nbsp;<span class="op" id="2344046">:=</span>&nbsp;<span class="ident" id="2344049">Y0</span><span class="op" id="2344051">(</span><span class="ident" id="2344052">x</span><span class="op" id="2344053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2344057">b</span>&nbsp;<span class="op" id="2344059">=</span>&nbsp;<span class="ident" id="2344061">Y1</span><span class="op" id="2344063">(</span><span class="ident" id="2344064">x</span><span class="op" id="2344065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2344069">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2344092">for</span>&nbsp;<span class="ident" id="2344096">i</span>&nbsp;<span class="op" id="2344098">:=</span>&nbsp;<span class="num" id="2344101">1</span><span class="op" id="2344102">;</span>&nbsp;<span class="ident" id="2344104">i</span>&nbsp;<span class="op" id="2344106">&lt;</span>&nbsp;<span class="ident" id="2344108">n</span>&nbsp;<span class="op" id="2344110">&amp;&amp;</span>&nbsp;<span class="op" id="2344113">!</span><span class="ident" id="2344114">IsInf</span><span class="op" id="2344119">(</span><span class="ident" id="2344120">b</span><span class="op" id="2344121">,</span>&nbsp;<span class="op" id="2344123">-</span><span class="num" id="2344124">1</span><span class="op" id="2344125">)</span><span class="op" id="2344126">;</span>&nbsp;<span class="ident" id="2344128">i</span><span class="op" id="2344129">++</span>&nbsp;<span class="op" id="2344132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2344137">a</span><span class="op" id="2344138">,</span>&nbsp;<span class="ident" id="2344140">b</span>&nbsp;<span class="op" id="2344142">=</span>&nbsp;<span class="ident" id="2344144">b</span><span class="op" id="2344145">,</span>&nbsp;<span class="op" id="2344147">(</span><span class="builtintype" id="2344148">float64</span><span class="op" id="2344155">(</span><span class="ident" id="2344156">i</span><span class="op" id="2344157">+</span><span class="ident" id="2344158">i</span><span class="op" id="2344159">)</span><span class="op" id="2344160">/</span><span class="ident" id="2344161">x</span><span class="op" id="2344162">)</span><span class="op" id="2344163">*</span><span class="ident" id="2344164">b</span><span class="op" id="2344165">-</span><span class="ident" id="2344166">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2344170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2344173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2344176">if</span>&nbsp;<span class="ident" id="2344179">sign</span>&nbsp;<span class="op" id="2344184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2344188">return</span>&nbsp;<span class="op" id="2344195">-</span><span class="ident" id="2344196">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2344199">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2344202">return</span>&nbsp;<span class="ident" id="2344209">b</span><br>
<span class="lineno"></span><span class="op" id="2344211">}</span>
</div>
</body>
</html>
