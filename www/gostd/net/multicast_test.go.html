<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6653940">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6653995">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6654049">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6654100">package</span>&nbsp;<span class="ident" id="6654108">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6654113">import</span>&nbsp;<span class="op" id="6654120">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6654123">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6654130">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6654136">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6654147">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6654157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6654160">var</span>&nbsp;<span class="ident" id="6654164">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="6654191">=</span>&nbsp;<span class="op" id="6654193">[</span><span class="op" id="6654194">]</span><span class="keyword" id="6654195">struct</span>&nbsp;<span class="op" id="6654202">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654205">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6654211">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654219">gaddr</span>&nbsp;<span class="op" id="6654225">*</span><span class="ident" id="6654226">UDPAddr</span>&nbsp;<span class="comment" id="6654234">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6654250">}</span><span class="op" id="6654251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654254">{</span><span class="string" id="6654255">&#34;udp&#34;</span><span class="op" id="6654260">,</span>&nbsp;<span class="op" id="6654262">&amp;</span><span class="ident" id="6654263">UDPAddr</span><span class="op" id="6654270">{</span><span class="ident" id="6654271">IP</span><span class="op" id="6654273">:</span>&nbsp;<span class="ident" id="6654275">IPv4</span><span class="op" id="6654279">(</span><span class="num" id="6654280">224</span><span class="op" id="6654283">,</span>&nbsp;<span class="num" id="6654285">0</span><span class="op" id="6654286">,</span>&nbsp;<span class="num" id="6654288">0</span><span class="op" id="6654289">,</span>&nbsp;<span class="num" id="6654291">254</span><span class="op" id="6654294">)</span><span class="op" id="6654295">,</span>&nbsp;<span class="ident" id="6654297">Port</span><span class="op" id="6654301">:</span>&nbsp;<span class="num" id="6654303">12345</span><span class="op" id="6654308">}</span><span class="op" id="6654309">}</span><span class="op" id="6654310">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654314">{</span><span class="string" id="6654315">&#34;udp4&#34;</span><span class="op" id="6654321">,</span>&nbsp;<span class="op" id="6654323">&amp;</span><span class="ident" id="6654324">UDPAddr</span><span class="op" id="6654331">{</span><span class="ident" id="6654332">IP</span><span class="op" id="6654334">:</span>&nbsp;<span class="ident" id="6654336">IPv4</span><span class="op" id="6654340">(</span><span class="num" id="6654341">224</span><span class="op" id="6654344">,</span>&nbsp;<span class="num" id="6654346">0</span><span class="op" id="6654347">,</span>&nbsp;<span class="num" id="6654349">0</span><span class="op" id="6654350">,</span>&nbsp;<span class="num" id="6654352">254</span><span class="op" id="6654355">)</span><span class="op" id="6654356">,</span>&nbsp;<span class="ident" id="6654358">Port</span><span class="op" id="6654362">:</span>&nbsp;<span class="num" id="6654364">12345</span><span class="op" id="6654369">}</span><span class="op" id="6654370">}</span><span class="op" id="6654371">,</span><br>
<span class="lineno"></span><span class="op" id="6654373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6654376">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6654446">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="6654517">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6654526">func</span>&nbsp;<span class="ident" id="6654531">TestIPv4MulticastListener</span><span class="op" id="6654556">(</span><span class="ident" id="6654557">t</span>&nbsp;<span class="op" id="6654559">*</span><span class="ident" id="6654560">testing</span><span class="op" id="6654567">.</span><span class="ident" id="6654568">T</span><span class="op" id="6654569">)</span>&nbsp;<span class="op" id="6654571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654574">switch</span>&nbsp;<span class="ident" id="6654581">runtime</span><span class="op" id="6654588">.</span><span class="ident" id="6654589">GOOS</span>&nbsp;<span class="op" id="6654594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654597">case</span>&nbsp;<span class="string" id="6654602">&#34;android&#34;</span><span class="op" id="6654611">,</span>&nbsp;<span class="string" id="6654613">&#34;nacl&#34;</span><span class="op" id="6654619">,</span>&nbsp;<span class="string" id="6654621">&#34;plan9&#34;</span><span class="op" id="6654628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654632">t</span><span class="op" id="6654633">.</span><span class="ident" id="6654634">Skipf</span><span class="op" id="6654639">(</span><span class="string" id="6654640">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6654661">,</span>&nbsp;<span class="ident" id="6654663">runtime</span><span class="op" id="6654670">.</span><span class="ident" id="6654671">GOOS</span><span class="op" id="6654675">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654678">case</span>&nbsp;<span class="string" id="6654683">&#34;solaris&#34;</span><span class="op" id="6654692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654696">t</span><span class="op" id="6654697">.</span><span class="ident" id="6654698">Skipf</span><span class="op" id="6654703">(</span><span class="string" id="6654704">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6654746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654753">closer</span>&nbsp;<span class="op" id="6654760">:=</span>&nbsp;<span class="keyword" id="6654763">func</span><span class="op" id="6654767">(</span><span class="ident" id="6654768">cs</span>&nbsp;<span class="op" id="6654771">[</span><span class="op" id="6654772">]</span><span class="op" id="6654773">*</span><span class="ident" id="6654774">UDPConn</span><span class="op" id="6654781">)</span>&nbsp;<span class="op" id="6654783">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654787">for</span>&nbsp;<span class="ident" id="6654791">_</span><span class="op" id="6654792">,</span>&nbsp;<span class="ident" id="6654794">c</span>&nbsp;<span class="op" id="6654796">:=</span>&nbsp;<span class="keyword" id="6654799">range</span>&nbsp;<span class="ident" id="6654805">cs</span>&nbsp;<span class="op" id="6654808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654813">if</span>&nbsp;<span class="ident" id="6654816">c</span>&nbsp;<span class="op" id="6654818">!=</span>&nbsp;<span class="ident" id="6654821">nil</span>&nbsp;<span class="op" id="6654825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654831">c</span><span class="op" id="6654832">.</span><span class="ident" id="6654833">Close</span><span class="op" id="6654838">(</span><span class="op" id="6654839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654848">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654855">for</span>&nbsp;<span class="ident" id="6654859">_</span><span class="op" id="6654860">,</span>&nbsp;<span class="ident" id="6654862">ifi</span>&nbsp;<span class="op" id="6654866">:=</span>&nbsp;<span class="keyword" id="6654869">range</span>&nbsp;<span class="op" id="6654875">[</span><span class="op" id="6654876">]</span><span class="op" id="6654877">*</span><span class="ident" id="6654878">Interface</span><span class="op" id="6654887">{</span><span class="ident" id="6654888">loopbackInterface</span><span class="op" id="6654905">(</span><span class="op" id="6654906">)</span><span class="op" id="6654907">,</span>&nbsp;<span class="ident" id="6654909">nil</span><span class="op" id="6654912">}</span>&nbsp;<span class="op" id="6654914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6654918">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6654974">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6655027">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6655077">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6655129">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655147">if</span>&nbsp;<span class="ident" id="6655150">ifi</span>&nbsp;<span class="op" id="6655154">==</span>&nbsp;<span class="ident" id="6655157">nil</span>&nbsp;<span class="op" id="6655161">&amp;&amp;</span>&nbsp;<span class="op" id="6655164">!</span><span class="op" id="6655165">*</span><span class="ident" id="6655166">testExternal</span>&nbsp;<span class="op" id="6655179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655184">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655199">for</span>&nbsp;<span class="ident" id="6655203">_</span><span class="op" id="6655204">,</span>&nbsp;<span class="ident" id="6655206">tt</span>&nbsp;<span class="op" id="6655209">:=</span>&nbsp;<span class="keyword" id="6655212">range</span>&nbsp;<span class="ident" id="6655218">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="6655245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655250">var</span>&nbsp;<span class="ident" id="6655254">err</span>&nbsp;<span class="builtintype" id="6655258">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655267">cs</span>&nbsp;<span class="op" id="6655270">:=</span>&nbsp;<span class="builtinfunc" id="6655273">make</span><span class="op" id="6655277">(</span><span class="op" id="6655278">[</span><span class="op" id="6655279">]</span><span class="op" id="6655280">*</span><span class="ident" id="6655281">UDPConn</span><span class="op" id="6655288">,</span>&nbsp;<span class="num" id="6655290">2</span><span class="op" id="6655291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655296">if</span>&nbsp;<span class="ident" id="6655299">cs</span><span class="op" id="6655301">[</span><span class="num" id="6655302">0</span><span class="op" id="6655303">]</span><span class="op" id="6655304">,</span>&nbsp;<span class="ident" id="6655306">err</span>&nbsp;<span class="op" id="6655310">=</span>&nbsp;<span class="ident" id="6655312">ListenMulticastUDP</span><span class="op" id="6655330">(</span><span class="ident" id="6655331">tt</span><span class="op" id="6655333">.</span><span class="ident" id="6655334">net</span><span class="op" id="6655337">,</span>&nbsp;<span class="ident" id="6655339">ifi</span><span class="op" id="6655342">,</span>&nbsp;<span class="ident" id="6655344">tt</span><span class="op" id="6655346">.</span><span class="ident" id="6655347">gaddr</span><span class="op" id="6655352">)</span><span class="op" id="6655353">;</span>&nbsp;<span class="ident" id="6655355">err</span>&nbsp;<span class="op" id="6655359">!=</span>&nbsp;<span class="ident" id="6655362">nil</span>&nbsp;<span class="op" id="6655366">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655372">t</span><span class="op" id="6655373">.</span><span class="ident" id="6655374">Fatalf</span><span class="op" id="6655380">(</span><span class="string" id="6655381">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6655424">,</span>&nbsp;<span class="ident" id="6655426">ifi</span><span class="op" id="6655429">,</span>&nbsp;<span class="ident" id="6655431">err</span><span class="op" id="6655434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655444">if</span>&nbsp;<span class="ident" id="6655447">err</span>&nbsp;<span class="op" id="6655451">:=</span>&nbsp;<span class="ident" id="6655454">checkMulticastListener</span><span class="op" id="6655476">(</span><span class="ident" id="6655477">cs</span><span class="op" id="6655479">[</span><span class="num" id="6655480">0</span><span class="op" id="6655481">]</span><span class="op" id="6655482">,</span>&nbsp;<span class="ident" id="6655484">tt</span><span class="op" id="6655486">.</span><span class="ident" id="6655487">gaddr</span><span class="op" id="6655492">.</span><span class="ident" id="6655493">IP</span><span class="op" id="6655495">)</span><span class="op" id="6655496">;</span>&nbsp;<span class="ident" id="6655498">err</span>&nbsp;<span class="op" id="6655502">!=</span>&nbsp;<span class="ident" id="6655505">nil</span>&nbsp;<span class="op" id="6655509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655515">closer</span><span class="op" id="6655521">(</span><span class="ident" id="6655522">cs</span><span class="op" id="6655524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655530">t</span><span class="op" id="6655531">.</span><span class="ident" id="6655532">Fatal</span><span class="op" id="6655537">(</span><span class="ident" id="6655538">err</span><span class="op" id="6655541">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655551">if</span>&nbsp;<span class="ident" id="6655554">cs</span><span class="op" id="6655556">[</span><span class="num" id="6655557">1</span><span class="op" id="6655558">]</span><span class="op" id="6655559">,</span>&nbsp;<span class="ident" id="6655561">err</span>&nbsp;<span class="op" id="6655565">=</span>&nbsp;<span class="ident" id="6655567">ListenMulticastUDP</span><span class="op" id="6655585">(</span><span class="ident" id="6655586">tt</span><span class="op" id="6655588">.</span><span class="ident" id="6655589">net</span><span class="op" id="6655592">,</span>&nbsp;<span class="ident" id="6655594">ifi</span><span class="op" id="6655597">,</span>&nbsp;<span class="ident" id="6655599">tt</span><span class="op" id="6655601">.</span><span class="ident" id="6655602">gaddr</span><span class="op" id="6655607">)</span><span class="op" id="6655608">;</span>&nbsp;<span class="ident" id="6655610">err</span>&nbsp;<span class="op" id="6655614">!=</span>&nbsp;<span class="ident" id="6655617">nil</span>&nbsp;<span class="op" id="6655621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655627">closer</span><span class="op" id="6655633">(</span><span class="ident" id="6655634">cs</span><span class="op" id="6655636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655642">t</span><span class="op" id="6655643">.</span><span class="ident" id="6655644">Fatalf</span><span class="op" id="6655650">(</span><span class="string" id="6655651">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6655695">,</span>&nbsp;<span class="ident" id="6655697">ifi</span><span class="op" id="6655700">,</span>&nbsp;<span class="ident" id="6655702">err</span><span class="op" id="6655705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655710">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655715">if</span>&nbsp;<span class="ident" id="6655718">err</span>&nbsp;<span class="op" id="6655722">:=</span>&nbsp;<span class="ident" id="6655725">checkMulticastListener</span><span class="op" id="6655747">(</span><span class="ident" id="6655748">cs</span><span class="op" id="6655750">[</span><span class="num" id="6655751">1</span><span class="op" id="6655752">]</span><span class="op" id="6655753">,</span>&nbsp;<span class="ident" id="6655755">tt</span><span class="op" id="6655757">.</span><span class="ident" id="6655758">gaddr</span><span class="op" id="6655763">.</span><span class="ident" id="6655764">IP</span><span class="op" id="6655766">)</span><span class="op" id="6655767">;</span>&nbsp;<span class="ident" id="6655769">err</span>&nbsp;<span class="op" id="6655773">!=</span>&nbsp;<span class="ident" id="6655776">nil</span>&nbsp;<span class="op" id="6655780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655786">closer</span><span class="op" id="6655792">(</span><span class="ident" id="6655793">cs</span><span class="op" id="6655795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655801">t</span><span class="op" id="6655802">.</span><span class="ident" id="6655803">Fatal</span><span class="op" id="6655808">(</span><span class="ident" id="6655809">err</span><span class="op" id="6655812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655822">closer</span><span class="op" id="6655828">(</span><span class="ident" id="6655829">cs</span><span class="op" id="6655831">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655838">}</span><br>
<span class="lineno"></span><span class="op" id="6655840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6655843">var</span>&nbsp;<span class="ident" id="6655847">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="6655874">=</span>&nbsp;<span class="op" id="6655876">[</span><span class="op" id="6655877">]</span><span class="keyword" id="6655878">struct</span>&nbsp;<span class="op" id="6655885">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655888">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6655894">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655902">gaddr</span>&nbsp;<span class="op" id="6655908">*</span><span class="ident" id="6655909">UDPAddr</span>&nbsp;<span class="comment" id="6655917">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="6655933">}</span><span class="op" id="6655934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655937">{</span><span class="string" id="6655938">&#34;udp&#34;</span><span class="op" id="6655943">,</span>&nbsp;<span class="op" id="6655945">&amp;</span><span class="ident" id="6655946">UDPAddr</span><span class="op" id="6655953">{</span><span class="ident" id="6655954">IP</span><span class="op" id="6655956">:</span>&nbsp;<span class="ident" id="6655958">ParseIP</span><span class="op" id="6655965">(</span><span class="string" id="6655966">&#34;ff01::114&#34;</span><span class="op" id="6655977">)</span><span class="op" id="6655978">,</span>&nbsp;<span class="ident" id="6655980">Port</span><span class="op" id="6655984">:</span>&nbsp;<span class="num" id="6655986">12345</span><span class="op" id="6655991">}</span><span class="op" id="6655992">}</span><span class="op" id="6655993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655996">{</span><span class="string" id="6655997">&#34;udp&#34;</span><span class="op" id="6656002">,</span>&nbsp;<span class="op" id="6656004">&amp;</span><span class="ident" id="6656005">UDPAddr</span><span class="op" id="6656012">{</span><span class="ident" id="6656013">IP</span><span class="op" id="6656015">:</span>&nbsp;<span class="ident" id="6656017">ParseIP</span><span class="op" id="6656024">(</span><span class="string" id="6656025">&#34;ff02::114&#34;</span><span class="op" id="6656036">)</span><span class="op" id="6656037">,</span>&nbsp;<span class="ident" id="6656039">Port</span><span class="op" id="6656043">:</span>&nbsp;<span class="num" id="6656045">12345</span><span class="op" id="6656050">}</span><span class="op" id="6656051">}</span><span class="op" id="6656052">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656055">{</span><span class="string" id="6656056">&#34;udp&#34;</span><span class="op" id="6656061">,</span>&nbsp;<span class="op" id="6656063">&amp;</span><span class="ident" id="6656064">UDPAddr</span><span class="op" id="6656071">{</span><span class="ident" id="6656072">IP</span><span class="op" id="6656074">:</span>&nbsp;<span class="ident" id="6656076">ParseIP</span><span class="op" id="6656083">(</span><span class="string" id="6656084">&#34;ff04::114&#34;</span><span class="op" id="6656095">)</span><span class="op" id="6656096">,</span>&nbsp;<span class="ident" id="6656098">Port</span><span class="op" id="6656102">:</span>&nbsp;<span class="num" id="6656104">12345</span><span class="op" id="6656109">}</span><span class="op" id="6656110">}</span><span class="op" id="6656111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656114">{</span><span class="string" id="6656115">&#34;udp&#34;</span><span class="op" id="6656120">,</span>&nbsp;<span class="op" id="6656122">&amp;</span><span class="ident" id="6656123">UDPAddr</span><span class="op" id="6656130">{</span><span class="ident" id="6656131">IP</span><span class="op" id="6656133">:</span>&nbsp;<span class="ident" id="6656135">ParseIP</span><span class="op" id="6656142">(</span><span class="string" id="6656143">&#34;ff05::114&#34;</span><span class="op" id="6656154">)</span><span class="op" id="6656155">,</span>&nbsp;<span class="ident" id="6656157">Port</span><span class="op" id="6656161">:</span>&nbsp;<span class="num" id="6656163">12345</span><span class="op" id="6656168">}</span><span class="op" id="6656169">}</span><span class="op" id="6656170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656173">{</span><span class="string" id="6656174">&#34;udp&#34;</span><span class="op" id="6656179">,</span>&nbsp;<span class="op" id="6656181">&amp;</span><span class="ident" id="6656182">UDPAddr</span><span class="op" id="6656189">{</span><span class="ident" id="6656190">IP</span><span class="op" id="6656192">:</span>&nbsp;<span class="ident" id="6656194">ParseIP</span><span class="op" id="6656201">(</span><span class="string" id="6656202">&#34;ff08::114&#34;</span><span class="op" id="6656213">)</span><span class="op" id="6656214">,</span>&nbsp;<span class="ident" id="6656216">Port</span><span class="op" id="6656220">:</span>&nbsp;<span class="num" id="6656222">12345</span><span class="op" id="6656227">}</span><span class="op" id="6656228">}</span><span class="op" id="6656229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656232">{</span><span class="string" id="6656233">&#34;udp&#34;</span><span class="op" id="6656238">,</span>&nbsp;<span class="op" id="6656240">&amp;</span><span class="ident" id="6656241">UDPAddr</span><span class="op" id="6656248">{</span><span class="ident" id="6656249">IP</span><span class="op" id="6656251">:</span>&nbsp;<span class="ident" id="6656253">ParseIP</span><span class="op" id="6656260">(</span><span class="string" id="6656261">&#34;ff0e::114&#34;</span><span class="op" id="6656272">)</span><span class="op" id="6656273">,</span>&nbsp;<span class="ident" id="6656275">Port</span><span class="op" id="6656279">:</span>&nbsp;<span class="num" id="6656281">12345</span><span class="op" id="6656286">}</span><span class="op" id="6656287">}</span><span class="op" id="6656288">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656292">{</span><span class="string" id="6656293">&#34;udp6&#34;</span><span class="op" id="6656299">,</span>&nbsp;<span class="op" id="6656301">&amp;</span><span class="ident" id="6656302">UDPAddr</span><span class="op" id="6656309">{</span><span class="ident" id="6656310">IP</span><span class="op" id="6656312">:</span>&nbsp;<span class="ident" id="6656314">ParseIP</span><span class="op" id="6656321">(</span><span class="string" id="6656322">&#34;ff01::114&#34;</span><span class="op" id="6656333">)</span><span class="op" id="6656334">,</span>&nbsp;<span class="ident" id="6656336">Port</span><span class="op" id="6656340">:</span>&nbsp;<span class="num" id="6656342">12345</span><span class="op" id="6656347">}</span><span class="op" id="6656348">}</span><span class="op" id="6656349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656352">{</span><span class="string" id="6656353">&#34;udp6&#34;</span><span class="op" id="6656359">,</span>&nbsp;<span class="op" id="6656361">&amp;</span><span class="ident" id="6656362">UDPAddr</span><span class="op" id="6656369">{</span><span class="ident" id="6656370">IP</span><span class="op" id="6656372">:</span>&nbsp;<span class="ident" id="6656374">ParseIP</span><span class="op" id="6656381">(</span><span class="string" id="6656382">&#34;ff02::114&#34;</span><span class="op" id="6656393">)</span><span class="op" id="6656394">,</span>&nbsp;<span class="ident" id="6656396">Port</span><span class="op" id="6656400">:</span>&nbsp;<span class="num" id="6656402">12345</span><span class="op" id="6656407">}</span><span class="op" id="6656408">}</span><span class="op" id="6656409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656412">{</span><span class="string" id="6656413">&#34;udp6&#34;</span><span class="op" id="6656419">,</span>&nbsp;<span class="op" id="6656421">&amp;</span><span class="ident" id="6656422">UDPAddr</span><span class="op" id="6656429">{</span><span class="ident" id="6656430">IP</span><span class="op" id="6656432">:</span>&nbsp;<span class="ident" id="6656434">ParseIP</span><span class="op" id="6656441">(</span><span class="string" id="6656442">&#34;ff04::114&#34;</span><span class="op" id="6656453">)</span><span class="op" id="6656454">,</span>&nbsp;<span class="ident" id="6656456">Port</span><span class="op" id="6656460">:</span>&nbsp;<span class="num" id="6656462">12345</span><span class="op" id="6656467">}</span><span class="op" id="6656468">}</span><span class="op" id="6656469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656472">{</span><span class="string" id="6656473">&#34;udp6&#34;</span><span class="op" id="6656479">,</span>&nbsp;<span class="op" id="6656481">&amp;</span><span class="ident" id="6656482">UDPAddr</span><span class="op" id="6656489">{</span><span class="ident" id="6656490">IP</span><span class="op" id="6656492">:</span>&nbsp;<span class="ident" id="6656494">ParseIP</span><span class="op" id="6656501">(</span><span class="string" id="6656502">&#34;ff05::114&#34;</span><span class="op" id="6656513">)</span><span class="op" id="6656514">,</span>&nbsp;<span class="ident" id="6656516">Port</span><span class="op" id="6656520">:</span>&nbsp;<span class="num" id="6656522">12345</span><span class="op" id="6656527">}</span><span class="op" id="6656528">}</span><span class="op" id="6656529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656532">{</span><span class="string" id="6656533">&#34;udp6&#34;</span><span class="op" id="6656539">,</span>&nbsp;<span class="op" id="6656541">&amp;</span><span class="ident" id="6656542">UDPAddr</span><span class="op" id="6656549">{</span><span class="ident" id="6656550">IP</span><span class="op" id="6656552">:</span>&nbsp;<span class="ident" id="6656554">ParseIP</span><span class="op" id="6656561">(</span><span class="string" id="6656562">&#34;ff08::114&#34;</span><span class="op" id="6656573">)</span><span class="op" id="6656574">,</span>&nbsp;<span class="ident" id="6656576">Port</span><span class="op" id="6656580">:</span>&nbsp;<span class="num" id="6656582">12345</span><span class="op" id="6656587">}</span><span class="op" id="6656588">}</span><span class="op" id="6656589">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656592">{</span><span class="string" id="6656593">&#34;udp6&#34;</span><span class="op" id="6656599">,</span>&nbsp;<span class="op" id="6656601">&amp;</span><span class="ident" id="6656602">UDPAddr</span><span class="op" id="6656609">{</span><span class="ident" id="6656610">IP</span><span class="op" id="6656612">:</span>&nbsp;<span class="ident" id="6656614">ParseIP</span><span class="op" id="6656621">(</span><span class="string" id="6656622">&#34;ff0e::114&#34;</span><span class="op" id="6656633">)</span><span class="op" id="6656634">,</span>&nbsp;<span class="ident" id="6656636">Port</span><span class="op" id="6656640">:</span>&nbsp;<span class="num" id="6656642">12345</span><span class="op" id="6656647">}</span><span class="op" id="6656648">}</span><span class="op" id="6656649">,</span><br>
<span class="lineno"></span><span class="op" id="6656651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6656654">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6656724">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="6656795">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6656804">func</span>&nbsp;<span class="ident" id="6656809">TestIPv6MulticastListener</span><span class="op" id="6656834">(</span><span class="ident" id="6656835">t</span>&nbsp;<span class="op" id="6656837">*</span><span class="ident" id="6656838">testing</span><span class="op" id="6656845">.</span><span class="ident" id="6656846">T</span><span class="op" id="6656847">)</span>&nbsp;<span class="op" id="6656849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656852">switch</span>&nbsp;<span class="ident" id="6656859">runtime</span><span class="op" id="6656866">.</span><span class="ident" id="6656867">GOOS</span>&nbsp;<span class="op" id="6656872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656875">case</span>&nbsp;<span class="string" id="6656880">&#34;plan9&#34;</span><span class="op" id="6656887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656891">t</span><span class="op" id="6656892">.</span><span class="ident" id="6656893">Skipf</span><span class="op" id="6656898">(</span><span class="string" id="6656899">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6656920">,</span>&nbsp;<span class="ident" id="6656922">runtime</span><span class="op" id="6656929">.</span><span class="ident" id="6656930">GOOS</span><span class="op" id="6656934">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656937">case</span>&nbsp;<span class="string" id="6656942">&#34;solaris&#34;</span><span class="op" id="6656951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656955">t</span><span class="op" id="6656956">.</span><span class="ident" id="6656957">Skipf</span><span class="op" id="6656962">(</span><span class="string" id="6656963">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="6657005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657011">if</span>&nbsp;<span class="op" id="6657014">!</span><span class="ident" id="6657015">supportsIPv6</span>&nbsp;<span class="op" id="6657028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657032">t</span><span class="op" id="6657033">.</span><span class="ident" id="6657034">Skip</span><span class="op" id="6657038">(</span><span class="string" id="6657039">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6657062">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657068">if</span>&nbsp;<span class="ident" id="6657071">os</span><span class="op" id="6657073">.</span><span class="ident" id="6657074">Getuid</span><span class="op" id="6657080">(</span><span class="op" id="6657081">)</span>&nbsp;<span class="op" id="6657083">!=</span>&nbsp;<span class="num" id="6657086">0</span>&nbsp;<span class="op" id="6657088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657092">t</span><span class="op" id="6657093">.</span><span class="ident" id="6657094">Skip</span><span class="op" id="6657098">(</span><span class="string" id="6657099">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6657128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657135">closer</span>&nbsp;<span class="op" id="6657142">:=</span>&nbsp;<span class="keyword" id="6657145">func</span><span class="op" id="6657149">(</span><span class="ident" id="6657150">cs</span>&nbsp;<span class="op" id="6657153">[</span><span class="op" id="6657154">]</span><span class="op" id="6657155">*</span><span class="ident" id="6657156">UDPConn</span><span class="op" id="6657163">)</span>&nbsp;<span class="op" id="6657165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657169">for</span>&nbsp;<span class="ident" id="6657173">_</span><span class="op" id="6657174">,</span>&nbsp;<span class="ident" id="6657176">c</span>&nbsp;<span class="op" id="6657178">:=</span>&nbsp;<span class="keyword" id="6657181">range</span>&nbsp;<span class="ident" id="6657187">cs</span>&nbsp;<span class="op" id="6657190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657195">if</span>&nbsp;<span class="ident" id="6657198">c</span>&nbsp;<span class="op" id="6657200">!=</span>&nbsp;<span class="ident" id="6657203">nil</span>&nbsp;<span class="op" id="6657207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657213">c</span><span class="op" id="6657214">.</span><span class="ident" id="6657215">Close</span><span class="op" id="6657220">(</span><span class="op" id="6657221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657226">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657237">for</span>&nbsp;<span class="ident" id="6657241">_</span><span class="op" id="6657242">,</span>&nbsp;<span class="ident" id="6657244">ifi</span>&nbsp;<span class="op" id="6657248">:=</span>&nbsp;<span class="keyword" id="6657251">range</span>&nbsp;<span class="op" id="6657257">[</span><span class="op" id="6657258">]</span><span class="op" id="6657259">*</span><span class="ident" id="6657260">Interface</span><span class="op" id="6657269">{</span><span class="ident" id="6657270">loopbackInterface</span><span class="op" id="6657287">(</span><span class="op" id="6657288">)</span><span class="op" id="6657289">,</span>&nbsp;<span class="ident" id="6657291">nil</span><span class="op" id="6657294">}</span>&nbsp;<span class="op" id="6657296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6657300">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6657356">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6657409">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6657459">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6657511">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657529">if</span>&nbsp;<span class="ident" id="6657532">ifi</span>&nbsp;<span class="op" id="6657536">==</span>&nbsp;<span class="ident" id="6657539">nil</span>&nbsp;<span class="op" id="6657543">&amp;&amp;</span>&nbsp;<span class="op" id="6657546">(</span><span class="op" id="6657547">!</span><span class="op" id="6657548">*</span><span class="ident" id="6657549">testExternal</span>&nbsp;<span class="op" id="6657562">||</span>&nbsp;<span class="op" id="6657565">!</span><span class="op" id="6657566">*</span><span class="ident" id="6657567">testIPv6</span><span class="op" id="6657575">)</span>&nbsp;<span class="op" id="6657577">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657582">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657597">for</span>&nbsp;<span class="ident" id="6657601">_</span><span class="op" id="6657602">,</span>&nbsp;<span class="ident" id="6657604">tt</span>&nbsp;<span class="op" id="6657607">:=</span>&nbsp;<span class="keyword" id="6657610">range</span>&nbsp;<span class="ident" id="6657616">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="6657643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657648">var</span>&nbsp;<span class="ident" id="6657652">err</span>&nbsp;<span class="builtintype" id="6657656">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657665">cs</span>&nbsp;<span class="op" id="6657668">:=</span>&nbsp;<span class="builtinfunc" id="6657671">make</span><span class="op" id="6657675">(</span><span class="op" id="6657676">[</span><span class="op" id="6657677">]</span><span class="op" id="6657678">*</span><span class="ident" id="6657679">UDPConn</span><span class="op" id="6657686">,</span>&nbsp;<span class="num" id="6657688">2</span><span class="op" id="6657689">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657694">if</span>&nbsp;<span class="ident" id="6657697">cs</span><span class="op" id="6657699">[</span><span class="num" id="6657700">0</span><span class="op" id="6657701">]</span><span class="op" id="6657702">,</span>&nbsp;<span class="ident" id="6657704">err</span>&nbsp;<span class="op" id="6657708">=</span>&nbsp;<span class="ident" id="6657710">ListenMulticastUDP</span><span class="op" id="6657728">(</span><span class="ident" id="6657729">tt</span><span class="op" id="6657731">.</span><span class="ident" id="6657732">net</span><span class="op" id="6657735">,</span>&nbsp;<span class="ident" id="6657737">ifi</span><span class="op" id="6657740">,</span>&nbsp;<span class="ident" id="6657742">tt</span><span class="op" id="6657744">.</span><span class="ident" id="6657745">gaddr</span><span class="op" id="6657750">)</span><span class="op" id="6657751">;</span>&nbsp;<span class="ident" id="6657753">err</span>&nbsp;<span class="op" id="6657757">!=</span>&nbsp;<span class="ident" id="6657760">nil</span>&nbsp;<span class="op" id="6657764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657770">t</span><span class="op" id="6657771">.</span><span class="ident" id="6657772">Fatalf</span><span class="op" id="6657778">(</span><span class="string" id="6657779">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6657822">,</span>&nbsp;<span class="ident" id="6657824">ifi</span><span class="op" id="6657827">,</span>&nbsp;<span class="ident" id="6657829">err</span><span class="op" id="6657832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657842">if</span>&nbsp;<span class="ident" id="6657845">err</span>&nbsp;<span class="op" id="6657849">:=</span>&nbsp;<span class="ident" id="6657852">checkMulticastListener</span><span class="op" id="6657874">(</span><span class="ident" id="6657875">cs</span><span class="op" id="6657877">[</span><span class="num" id="6657878">0</span><span class="op" id="6657879">]</span><span class="op" id="6657880">,</span>&nbsp;<span class="ident" id="6657882">tt</span><span class="op" id="6657884">.</span><span class="ident" id="6657885">gaddr</span><span class="op" id="6657890">.</span><span class="ident" id="6657891">IP</span><span class="op" id="6657893">)</span><span class="op" id="6657894">;</span>&nbsp;<span class="ident" id="6657896">err</span>&nbsp;<span class="op" id="6657900">!=</span>&nbsp;<span class="ident" id="6657903">nil</span>&nbsp;<span class="op" id="6657907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657913">closer</span><span class="op" id="6657919">(</span><span class="ident" id="6657920">cs</span><span class="op" id="6657922">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657928">t</span><span class="op" id="6657929">.</span><span class="ident" id="6657930">Fatal</span><span class="op" id="6657935">(</span><span class="ident" id="6657936">err</span><span class="op" id="6657939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657949">if</span>&nbsp;<span class="ident" id="6657952">cs</span><span class="op" id="6657954">[</span><span class="num" id="6657955">1</span><span class="op" id="6657956">]</span><span class="op" id="6657957">,</span>&nbsp;<span class="ident" id="6657959">err</span>&nbsp;<span class="op" id="6657963">=</span>&nbsp;<span class="ident" id="6657965">ListenMulticastUDP</span><span class="op" id="6657983">(</span><span class="ident" id="6657984">tt</span><span class="op" id="6657986">.</span><span class="ident" id="6657987">net</span><span class="op" id="6657990">,</span>&nbsp;<span class="ident" id="6657992">ifi</span><span class="op" id="6657995">,</span>&nbsp;<span class="ident" id="6657997">tt</span><span class="op" id="6657999">.</span><span class="ident" id="6658000">gaddr</span><span class="op" id="6658005">)</span><span class="op" id="6658006">;</span>&nbsp;<span class="ident" id="6658008">err</span>&nbsp;<span class="op" id="6658012">!=</span>&nbsp;<span class="ident" id="6658015">nil</span>&nbsp;<span class="op" id="6658019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658025">closer</span><span class="op" id="6658031">(</span><span class="ident" id="6658032">cs</span><span class="op" id="6658034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658040">t</span><span class="op" id="6658041">.</span><span class="ident" id="6658042">Fatalf</span><span class="op" id="6658048">(</span><span class="string" id="6658049">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6658093">,</span>&nbsp;<span class="ident" id="6658095">ifi</span><span class="op" id="6658098">,</span>&nbsp;<span class="ident" id="6658100">err</span><span class="op" id="6658103">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658113">if</span>&nbsp;<span class="ident" id="6658116">err</span>&nbsp;<span class="op" id="6658120">:=</span>&nbsp;<span class="ident" id="6658123">checkMulticastListener</span><span class="op" id="6658145">(</span><span class="ident" id="6658146">cs</span><span class="op" id="6658148">[</span><span class="num" id="6658149">1</span><span class="op" id="6658150">]</span><span class="op" id="6658151">,</span>&nbsp;<span class="ident" id="6658153">tt</span><span class="op" id="6658155">.</span><span class="ident" id="6658156">gaddr</span><span class="op" id="6658161">.</span><span class="ident" id="6658162">IP</span><span class="op" id="6658164">)</span><span class="op" id="6658165">;</span>&nbsp;<span class="ident" id="6658167">err</span>&nbsp;<span class="op" id="6658171">!=</span>&nbsp;<span class="ident" id="6658174">nil</span>&nbsp;<span class="op" id="6658178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658184">closer</span><span class="op" id="6658190">(</span><span class="ident" id="6658191">cs</span><span class="op" id="6658193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658199">t</span><span class="op" id="6658200">.</span><span class="ident" id="6658201">Fatal</span><span class="op" id="6658206">(</span><span class="ident" id="6658207">err</span><span class="op" id="6658210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658215">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658220">closer</span><span class="op" id="6658226">(</span><span class="ident" id="6658227">cs</span><span class="op" id="6658229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658236">}</span><br>
<span class="lineno"></span><span class="op" id="6658238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6658241">func</span>&nbsp;<span class="ident" id="6658246">checkMulticastListener</span><span class="op" id="6658268">(</span><span class="ident" id="6658269">c</span>&nbsp;<span class="op" id="6658271">*</span><span class="ident" id="6658272">UDPConn</span><span class="op" id="6658279">,</span>&nbsp;<span class="ident" id="6658281">ip</span>&nbsp;<span class="ident" id="6658284">IP</span><span class="op" id="6658286">)</span>&nbsp;<span class="builtintype" id="6658288">error</span>&nbsp;<span class="op" id="6658294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658297">if</span>&nbsp;<span class="ident" id="6658300">ok</span><span class="op" id="6658302">,</span>&nbsp;<span class="ident" id="6658304">err</span>&nbsp;<span class="op" id="6658308">:=</span>&nbsp;<span class="ident" id="6658311">multicastRIBContains</span><span class="op" id="6658331">(</span><span class="ident" id="6658332">ip</span><span class="op" id="6658334">)</span><span class="op" id="6658335">;</span>&nbsp;<span class="ident" id="6658337">err</span>&nbsp;<span class="op" id="6658341">!=</span>&nbsp;<span class="ident" id="6658344">nil</span>&nbsp;<span class="op" id="6658348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658352">return</span>&nbsp;<span class="ident" id="6658359">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658364">}</span>&nbsp;<span class="keyword" id="6658366">else</span>&nbsp;<span class="keyword" id="6658371">if</span>&nbsp;<span class="op" id="6658374">!</span><span class="ident" id="6658375">ok</span>&nbsp;<span class="op" id="6658378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658382">return</span>&nbsp;<span class="ident" id="6658389">fmt</span><span class="op" id="6658392">.</span><span class="ident" id="6658393">Errorf</span><span class="op" id="6658399">(</span><span class="string" id="6658400">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="6658431">,</span>&nbsp;<span class="ident" id="6658433">ip</span><span class="op" id="6658435">.</span><span class="ident" id="6658436">String</span><span class="op" id="6658442">(</span><span class="op" id="6658443">)</span><span class="op" id="6658444">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658450">la</span>&nbsp;<span class="op" id="6658453">:=</span>&nbsp;<span class="ident" id="6658456">c</span><span class="op" id="6658457">.</span><span class="ident" id="6658458">LocalAddr</span><span class="op" id="6658467">(</span><span class="op" id="6658468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658471">if</span>&nbsp;<span class="ident" id="6658474">la</span><span class="op" id="6658476">,</span>&nbsp;<span class="ident" id="6658478">ok</span>&nbsp;<span class="op" id="6658481">:=</span>&nbsp;<span class="ident" id="6658484">la</span><span class="op" id="6658486">.</span><span class="op" id="6658487">(</span><span class="op" id="6658488">*</span><span class="ident" id="6658489">UDPAddr</span><span class="op" id="6658496">)</span><span class="op" id="6658497">;</span>&nbsp;<span class="op" id="6658499">!</span><span class="ident" id="6658500">ok</span>&nbsp;<span class="op" id="6658503">||</span>&nbsp;<span class="ident" id="6658506">la</span><span class="op" id="6658508">.</span><span class="ident" id="6658509">Port</span>&nbsp;<span class="op" id="6658514">==</span>&nbsp;<span class="num" id="6658517">0</span>&nbsp;<span class="op" id="6658519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658523">return</span>&nbsp;<span class="ident" id="6658530">fmt</span><span class="op" id="6658533">.</span><span class="ident" id="6658534">Errorf</span><span class="op" id="6658540">(</span><span class="string" id="6658541">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6658602">,</span>&nbsp;<span class="ident" id="6658604">la</span><span class="op" id="6658606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658609">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658612">return</span>&nbsp;<span class="ident" id="6658619">nil</span><br>
<span class="lineno"></span><span class="op" id="6658623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658626">func</span>&nbsp;<span class="ident" id="6658631">multicastRIBContains</span><span class="op" id="6658651">(</span><span class="ident" id="6658652">ip</span>&nbsp;<span class="ident" id="6658655">IP</span><span class="op" id="6658657">)</span>&nbsp;<span class="op" id="6658659">(</span><span class="builtintype" id="6658660">bool</span><span class="op" id="6658664">,</span>&nbsp;<span class="builtintype" id="6658666">error</span><span class="op" id="6658671">)</span>&nbsp;<span class="op" id="6658673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658676">switch</span>&nbsp;<span class="ident" id="6658683">runtime</span><span class="op" id="6658690">.</span><span class="ident" id="6658691">GOOS</span>&nbsp;<span class="op" id="6658696">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658699">case</span>&nbsp;<span class="string" id="6658704">&#34;dragonfly&#34;</span><span class="op" id="6658715">,</span>&nbsp;<span class="string" id="6658717">&#34;netbsd&#34;</span><span class="op" id="6658725">,</span>&nbsp;<span class="string" id="6658727">&#34;openbsd&#34;</span><span class="op" id="6658736">,</span>&nbsp;<span class="string" id="6658738">&#34;plan9&#34;</span><span class="op" id="6658745">,</span>&nbsp;<span class="string" id="6658747">&#34;solaris&#34;</span><span class="op" id="6658756">,</span>&nbsp;<span class="string" id="6658758">&#34;windows&#34;</span><span class="op" id="6658767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658771">return</span>&nbsp;<span class="builtintype" id="6658778">true</span><span class="op" id="6658782">,</span>&nbsp;<span class="ident" id="6658784">nil</span>&nbsp;<span class="comment" id="6658788">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658812">case</span>&nbsp;<span class="string" id="6658817">&#34;linux&#34;</span><span class="op" id="6658824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658828">if</span>&nbsp;<span class="ident" id="6658831">runtime</span><span class="op" id="6658838">.</span><span class="ident" id="6658839">GOARCH</span>&nbsp;<span class="op" id="6658846">==</span>&nbsp;<span class="string" id="6658849">&#34;arm&#34;</span>&nbsp;<span class="op" id="6658855">||</span>&nbsp;<span class="ident" id="6658858">runtime</span><span class="op" id="6658865">.</span><span class="ident" id="6658866">GOARCH</span>&nbsp;<span class="op" id="6658873">==</span>&nbsp;<span class="string" id="6658876">&#34;alpha&#34;</span>&nbsp;<span class="op" id="6658884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658889">return</span>&nbsp;<span class="builtintype" id="6658896">true</span><span class="op" id="6658900">,</span>&nbsp;<span class="ident" id="6658902">nil</span>&nbsp;<span class="comment" id="6658906">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658937">ift</span><span class="op" id="6658940">,</span>&nbsp;<span class="ident" id="6658942">err</span>&nbsp;<span class="op" id="6658946">:=</span>&nbsp;<span class="ident" id="6658949">Interfaces</span><span class="op" id="6658959">(</span><span class="op" id="6658960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658963">if</span>&nbsp;<span class="ident" id="6658966">err</span>&nbsp;<span class="op" id="6658970">!=</span>&nbsp;<span class="ident" id="6658973">nil</span>&nbsp;<span class="op" id="6658977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658981">return</span>&nbsp;<span class="builtintype" id="6658988">false</span><span class="op" id="6658993">,</span>&nbsp;<span class="ident" id="6658995">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659003">for</span>&nbsp;<span class="ident" id="6659007">_</span><span class="op" id="6659008">,</span>&nbsp;<span class="ident" id="6659010">ifi</span>&nbsp;<span class="op" id="6659014">:=</span>&nbsp;<span class="keyword" id="6659017">range</span>&nbsp;<span class="ident" id="6659023">ift</span>&nbsp;<span class="op" id="6659027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659031">ifmat</span><span class="op" id="6659036">,</span>&nbsp;<span class="ident" id="6659038">err</span>&nbsp;<span class="op" id="6659042">:=</span>&nbsp;<span class="ident" id="6659045">ifi</span><span class="op" id="6659048">.</span><span class="ident" id="6659049">MulticastAddrs</span><span class="op" id="6659063">(</span><span class="op" id="6659064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659068">if</span>&nbsp;<span class="ident" id="6659071">err</span>&nbsp;<span class="op" id="6659075">!=</span>&nbsp;<span class="ident" id="6659078">nil</span>&nbsp;<span class="op" id="6659082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659087">return</span>&nbsp;<span class="builtintype" id="6659094">false</span><span class="op" id="6659099">,</span>&nbsp;<span class="ident" id="6659101">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659111">for</span>&nbsp;<span class="ident" id="6659115">_</span><span class="op" id="6659116">,</span>&nbsp;<span class="ident" id="6659118">ifma</span>&nbsp;<span class="op" id="6659123">:=</span>&nbsp;<span class="keyword" id="6659126">range</span>&nbsp;<span class="ident" id="6659132">ifmat</span>&nbsp;<span class="op" id="6659138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659143">if</span>&nbsp;<span class="ident" id="6659146">ifma</span><span class="op" id="6659150">.</span><span class="op" id="6659151">(</span><span class="op" id="6659152">*</span><span class="ident" id="6659153">IPAddr</span><span class="op" id="6659159">)</span><span class="op" id="6659160">.</span><span class="ident" id="6659161">IP</span><span class="op" id="6659163">.</span><span class="ident" id="6659164">Equal</span><span class="op" id="6659169">(</span><span class="ident" id="6659170">ip</span><span class="op" id="6659172">)</span>&nbsp;<span class="op" id="6659174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659180">return</span>&nbsp;<span class="builtintype" id="6659187">true</span><span class="op" id="6659191">,</span>&nbsp;<span class="ident" id="6659193">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659200">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659210">return</span>&nbsp;<span class="builtintype" id="6659217">false</span><span class="op" id="6659222">,</span>&nbsp;<span class="ident" id="6659224">nil</span><br>
<span class="lineno"></span><span class="op" id="6659228">}</span>
</div>
</body>
</html>
