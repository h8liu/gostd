<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4091241">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4091296">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4091350">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4091401">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4091461">package</span>&nbsp;<span class="ident" id="4091469">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091475">import</span>&nbsp;<span class="op" id="4091482">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091485">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091494">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091504">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091518">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091534">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091553">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091567">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091582">_</span>&nbsp;<span class="string" id="4091584">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091601">_</span>&nbsp;<span class="string" id="4091603">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091620">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091640">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091657">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091673">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091683">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091689">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091701">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091708">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091719">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4091726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091729">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4091809">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4091825">type</span>&nbsp;<span class="ident" id="4091830">pkixPublicKey</span>&nbsp;<span class="keyword" id="4091844">struct</span>&nbsp;<span class="op" id="4091851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091854">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091864">pkix</span><span class="op" id="4091868">.</span><span class="ident" id="4091869">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091890">BitString</span>&nbsp;<span class="ident" id="4091900">asn1</span><span class="op" id="4091904">.</span><span class="ident" id="4091905">BitString</span><br>
<span class="lineno"></span><span class="op" id="4091915">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4091918">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4091990">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4092048">func</span>&nbsp;<span class="ident" id="4092053">ParsePKIXPublicKey</span><span class="op" id="4092071">(</span><span class="ident" id="4092072">derBytes</span>&nbsp;<span class="op" id="4092081">[</span><span class="op" id="4092082">]</span><span class="builtintype" id="4092083">byte</span><span class="op" id="4092087">)</span>&nbsp;<span class="op" id="4092089">(</span><span class="ident" id="4092090">pub</span>&nbsp;<span class="keyword" id="4092094">interface</span><span class="op" id="4092103">{</span><span class="op" id="4092104">}</span><span class="op" id="4092105">,</span>&nbsp;<span class="ident" id="4092107">err</span>&nbsp;<span class="builtintype" id="4092111">error</span><span class="op" id="4092116">)</span>&nbsp;<span class="op" id="4092118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092121">var</span>&nbsp;<span class="ident" id="4092125">pki</span>&nbsp;<span class="ident" id="4092129">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092144">if</span>&nbsp;<span class="ident" id="4092147">_</span><span class="op" id="4092148">,</span>&nbsp;<span class="ident" id="4092150">err</span>&nbsp;<span class="op" id="4092154">=</span>&nbsp;<span class="ident" id="4092156">asn1</span><span class="op" id="4092160">.</span><span class="ident" id="4092161">Unmarshal</span><span class="op" id="4092170">(</span><span class="ident" id="4092171">derBytes</span><span class="op" id="4092179">,</span>&nbsp;<span class="op" id="4092181">&amp;</span><span class="ident" id="4092182">pki</span><span class="op" id="4092185">)</span><span class="op" id="4092186">;</span>&nbsp;<span class="ident" id="4092188">err</span>&nbsp;<span class="op" id="4092192">!=</span>&nbsp;<span class="ident" id="4092195">nil</span>&nbsp;<span class="op" id="4092199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092203">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092214">algo</span>&nbsp;<span class="op" id="4092219">:=</span>&nbsp;<span class="ident" id="4092222">getPublicKeyAlgorithmFromOID</span><span class="op" id="4092250">(</span><span class="ident" id="4092251">pki</span><span class="op" id="4092254">.</span><span class="ident" id="4092255">Algorithm</span><span class="op" id="4092264">.</span><span class="ident" id="4092265">Algorithm</span><span class="op" id="4092274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092277">if</span>&nbsp;<span class="ident" id="4092280">algo</span>&nbsp;<span class="op" id="4092285">==</span>&nbsp;<span class="ident" id="4092288">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4092314">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092318">return</span>&nbsp;<span class="ident" id="4092325">nil</span><span class="op" id="4092328">,</span>&nbsp;<span class="ident" id="4092330">errors</span><span class="op" id="4092336">.</span><span class="ident" id="4092337">New</span><span class="op" id="4092340">(</span><span class="string" id="4092341">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4092377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092383">return</span>&nbsp;<span class="ident" id="4092390">parsePublicKey</span><span class="op" id="4092404">(</span><span class="ident" id="4092405">algo</span><span class="op" id="4092409">,</span>&nbsp;<span class="op" id="4092411">&amp;</span><span class="ident" id="4092412">pki</span><span class="op" id="4092415">)</span><br>
<span class="lineno"></span><span class="op" id="4092417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4092420">func</span>&nbsp;<span class="ident" id="4092425">marshalPublicKey</span><span class="op" id="4092441">(</span><span class="ident" id="4092442">pub</span>&nbsp;<span class="keyword" id="4092446">interface</span><span class="op" id="4092455">{</span><span class="op" id="4092456">}</span><span class="op" id="4092457">)</span>&nbsp;<span class="op" id="4092459">(</span><span class="ident" id="4092460">publicKeyBytes</span>&nbsp;<span class="op" id="4092475">[</span><span class="op" id="4092476">]</span><span class="builtintype" id="4092477">byte</span><span class="op" id="4092481">,</span>&nbsp;<span class="ident" id="4092483">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4092502">pkix</span><span class="op" id="4092506">.</span><span class="ident" id="4092507">AlgorithmIdentifier</span><span class="op" id="4092526">,</span>&nbsp;<span class="ident" id="4092528">err</span>&nbsp;<span class="builtintype" id="4092532">error</span><span class="op" id="4092537">)</span>&nbsp;<span class="op" id="4092539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092542">switch</span>&nbsp;<span class="ident" id="4092549">pub</span>&nbsp;<span class="op" id="4092553">:=</span>&nbsp;<span class="ident" id="4092556">pub</span><span class="op" id="4092559">.</span><span class="op" id="4092560">(</span><span class="keyword" id="4092561">type</span><span class="op" id="4092565">)</span>&nbsp;<span class="op" id="4092567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092570">case</span>&nbsp;<span class="op" id="4092575">*</span><span class="ident" id="4092576">rsa</span><span class="op" id="4092579">.</span><span class="ident" id="4092580">PublicKey</span><span class="op" id="4092589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092593">publicKeyBytes</span><span class="op" id="4092607">,</span>&nbsp;<span class="ident" id="4092609">err</span>&nbsp;<span class="op" id="4092613">=</span>&nbsp;<span class="ident" id="4092615">asn1</span><span class="op" id="4092619">.</span><span class="ident" id="4092620">Marshal</span><span class="op" id="4092627">(</span><span class="ident" id="4092628">rsaPublicKey</span><span class="op" id="4092640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092645">N</span><span class="op" id="4092646">:</span>&nbsp;<span class="ident" id="4092648">pub</span><span class="op" id="4092651">.</span><span class="ident" id="4092652">N</span><span class="op" id="4092653">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092658">E</span><span class="op" id="4092659">:</span>&nbsp;<span class="ident" id="4092661">pub</span><span class="op" id="4092664">.</span><span class="ident" id="4092665">E</span><span class="op" id="4092666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092670">}</span><span class="op" id="4092671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092675">publicKeyAlgorithm</span><span class="op" id="4092693">.</span><span class="ident" id="4092694">Algorithm</span>&nbsp;<span class="op" id="4092704">=</span>&nbsp;<span class="ident" id="4092706">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092724">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092782">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092840">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092891">publicKeyAlgorithm</span><span class="op" id="4092909">.</span><span class="ident" id="4092910">Parameters</span>&nbsp;<span class="op" id="4092921">=</span>&nbsp;<span class="ident" id="4092923">asn1</span><span class="op" id="4092927">.</span><span class="ident" id="4092928">RawValue</span><span class="op" id="4092936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092941">Tag</span><span class="op" id="4092944">:</span>&nbsp;<span class="num" id="4092946">5</span><span class="op" id="4092947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092954">case</span>&nbsp;<span class="op" id="4092959">*</span><span class="ident" id="4092960">ecdsa</span><span class="op" id="4092965">.</span><span class="ident" id="4092966">PublicKey</span><span class="op" id="4092975">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092979">publicKeyBytes</span>&nbsp;<span class="op" id="4092994">=</span>&nbsp;<span class="ident" id="4092996">elliptic</span><span class="op" id="4093004">.</span><span class="ident" id="4093005">Marshal</span><span class="op" id="4093012">(</span><span class="ident" id="4093013">pub</span><span class="op" id="4093016">.</span><span class="ident" id="4093017">Curve</span><span class="op" id="4093022">,</span>&nbsp;<span class="ident" id="4093024">pub</span><span class="op" id="4093027">.</span><span class="ident" id="4093028">X</span><span class="op" id="4093029">,</span>&nbsp;<span class="ident" id="4093031">pub</span><span class="op" id="4093034">.</span><span class="ident" id="4093035">Y</span><span class="op" id="4093036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093040">oid</span><span class="op" id="4093043">,</span>&nbsp;<span class="ident" id="4093045">ok</span>&nbsp;<span class="op" id="4093048">:=</span>&nbsp;<span class="ident" id="4093051">oidFromNamedCurve</span><span class="op" id="4093068">(</span><span class="ident" id="4093069">pub</span><span class="op" id="4093072">.</span><span class="ident" id="4093073">Curve</span><span class="op" id="4093078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093082">if</span>&nbsp;<span class="op" id="4093085">!</span><span class="ident" id="4093086">ok</span>&nbsp;<span class="op" id="4093089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093094">return</span>&nbsp;<span class="ident" id="4093101">nil</span><span class="op" id="4093104">,</span>&nbsp;<span class="ident" id="4093106">pkix</span><span class="op" id="4093110">.</span><span class="ident" id="4093111">AlgorithmIdentifier</span><span class="op" id="4093130">{</span><span class="op" id="4093131">}</span><span class="op" id="4093132">,</span>&nbsp;<span class="ident" id="4093134">errors</span><span class="op" id="4093140">.</span><span class="ident" id="4093141">New</span><span class="op" id="4093144">(</span><span class="string" id="4093145">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4093179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093183">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093187">publicKeyAlgorithm</span><span class="op" id="4093205">.</span><span class="ident" id="4093206">Algorithm</span>&nbsp;<span class="op" id="4093216">=</span>&nbsp;<span class="ident" id="4093218">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093238">var</span>&nbsp;<span class="ident" id="4093242">paramBytes</span>&nbsp;<span class="op" id="4093253">[</span><span class="op" id="4093254">]</span><span class="builtintype" id="4093255">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093262">paramBytes</span><span class="op" id="4093272">,</span>&nbsp;<span class="ident" id="4093274">err</span>&nbsp;<span class="op" id="4093278">=</span>&nbsp;<span class="ident" id="4093280">asn1</span><span class="op" id="4093284">.</span><span class="ident" id="4093285">Marshal</span><span class="op" id="4093292">(</span><span class="ident" id="4093293">oid</span><span class="op" id="4093296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093300">if</span>&nbsp;<span class="ident" id="4093303">err</span>&nbsp;<span class="op" id="4093307">!=</span>&nbsp;<span class="ident" id="4093310">nil</span>&nbsp;<span class="op" id="4093314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093319">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093332">publicKeyAlgorithm</span><span class="op" id="4093350">.</span><span class="ident" id="4093351">Parameters</span><span class="op" id="4093361">.</span><span class="ident" id="4093362">FullBytes</span>&nbsp;<span class="op" id="4093372">=</span>&nbsp;<span class="ident" id="4093374">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093386">default</span><span class="op" id="4093393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093397">return</span>&nbsp;<span class="ident" id="4093404">nil</span><span class="op" id="4093407">,</span>&nbsp;<span class="ident" id="4093409">pkix</span><span class="op" id="4093413">.</span><span class="ident" id="4093414">AlgorithmIdentifier</span><span class="op" id="4093433">{</span><span class="op" id="4093434">}</span><span class="op" id="4093435">,</span>&nbsp;<span class="ident" id="4093437">errors</span><span class="op" id="4093443">.</span><span class="ident" id="4093444">New</span><span class="op" id="4093447">(</span><span class="string" id="4093448">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4093496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093499">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093503">return</span>&nbsp;<span class="ident" id="4093510">publicKeyBytes</span><span class="op" id="4093524">,</span>&nbsp;<span class="ident" id="4093526">publicKeyAlgorithm</span><span class="op" id="4093544">,</span>&nbsp;<span class="ident" id="4093546">nil</span><br>
<span class="lineno"></span><span class="op" id="4093550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093553">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4093629">func</span>&nbsp;<span class="ident" id="4093634">MarshalPKIXPublicKey</span><span class="op" id="4093654">(</span><span class="ident" id="4093655">pub</span>&nbsp;<span class="keyword" id="4093659">interface</span><span class="op" id="4093668">{</span><span class="op" id="4093669">}</span><span class="op" id="4093670">)</span>&nbsp;<span class="op" id="4093672">(</span><span class="op" id="4093673">[</span><span class="op" id="4093674">]</span><span class="builtintype" id="4093675">byte</span><span class="op" id="4093679">,</span>&nbsp;<span class="builtintype" id="4093681">error</span><span class="op" id="4093686">)</span>&nbsp;<span class="op" id="4093688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093691">var</span>&nbsp;<span class="ident" id="4093695">publicKeyBytes</span>&nbsp;<span class="op" id="4093710">[</span><span class="op" id="4093711">]</span><span class="builtintype" id="4093712">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093718">var</span>&nbsp;<span class="ident" id="4093722">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4093741">pkix</span><span class="op" id="4093745">.</span><span class="ident" id="4093746">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093767">var</span>&nbsp;<span class="ident" id="4093771">err</span>&nbsp;<span class="builtintype" id="4093775">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093783">if</span>&nbsp;<span class="ident" id="4093786">publicKeyBytes</span><span class="op" id="4093800">,</span>&nbsp;<span class="ident" id="4093802">publicKeyAlgorithm</span><span class="op" id="4093820">,</span>&nbsp;<span class="ident" id="4093822">err</span>&nbsp;<span class="op" id="4093826">=</span>&nbsp;<span class="ident" id="4093828">marshalPublicKey</span><span class="op" id="4093844">(</span><span class="ident" id="4093845">pub</span><span class="op" id="4093848">)</span><span class="op" id="4093849">;</span>&nbsp;<span class="ident" id="4093851">err</span>&nbsp;<span class="op" id="4093855">!=</span>&nbsp;<span class="ident" id="4093858">nil</span>&nbsp;<span class="op" id="4093862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093866">return</span>&nbsp;<span class="ident" id="4093873">nil</span><span class="op" id="4093876">,</span>&nbsp;<span class="ident" id="4093878">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093887">pkix</span>&nbsp;<span class="op" id="4093892">:=</span>&nbsp;<span class="ident" id="4093895">pkixPublicKey</span><span class="op" id="4093908">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093912">Algo</span><span class="op" id="4093916">:</span>&nbsp;<span class="ident" id="4093918">publicKeyAlgorithm</span><span class="op" id="4093936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093940">BitString</span><span class="op" id="4093949">:</span>&nbsp;<span class="ident" id="4093951">asn1</span><span class="op" id="4093955">.</span><span class="ident" id="4093956">BitString</span><span class="op" id="4093965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093970">Bytes</span><span class="op" id="4093975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093981">publicKeyBytes</span><span class="op" id="4093995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094000">BitLength</span><span class="op" id="4094009">:</span>&nbsp;<span class="num" id="4094011">8</span>&nbsp;<span class="op" id="4094013">*</span>&nbsp;<span class="builtinfunc" id="4094015">len</span><span class="op" id="4094018">(</span><span class="ident" id="4094019">publicKeyBytes</span><span class="op" id="4094033">)</span><span class="op" id="4094034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094038">}</span><span class="op" id="4094039">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094046">ret</span><span class="op" id="4094049">,</span>&nbsp;<span class="ident" id="4094051">_</span>&nbsp;<span class="op" id="4094053">:=</span>&nbsp;<span class="ident" id="4094056">asn1</span><span class="op" id="4094060">.</span><span class="ident" id="4094061">Marshal</span><span class="op" id="4094068">(</span><span class="ident" id="4094069">pkix</span><span class="op" id="4094073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094076">return</span>&nbsp;<span class="ident" id="4094083">ret</span><span class="op" id="4094086">,</span>&nbsp;<span class="ident" id="4094088">nil</span><br>
<span class="lineno"></span><span class="op" id="4094092">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4094095">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094168">type</span>&nbsp;<span class="ident" id="4094173">certificate</span>&nbsp;<span class="keyword" id="4094185">struct</span>&nbsp;<span class="op" id="4094192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094195">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094214">asn1</span><span class="op" id="4094218">.</span><span class="ident" id="4094219">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094231">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094250">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094266">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4094285">pkix</span><span class="op" id="4094289">.</span><span class="ident" id="4094290">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094311">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094330">asn1</span><span class="op" id="4094334">.</span><span class="ident" id="4094335">BitString</span><br>
<span class="lineno"></span><span class="op" id="4094345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4094348">type</span>&nbsp;<span class="ident" id="4094353">tbsCertificate</span>&nbsp;<span class="keyword" id="4094368">struct</span>&nbsp;<span class="op" id="4094375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094378">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094397">asn1</span><span class="op" id="4094401">.</span><span class="ident" id="4094402">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094414">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4094433">int</span>&nbsp;<span class="string" id="4094437">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094481">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094500">*</span><span class="ident" id="4094501">big</span><span class="op" id="4094504">.</span><span class="ident" id="4094505">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094510">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4094529">pkix</span><span class="op" id="4094533">.</span><span class="ident" id="4094534">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094555">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094574">asn1</span><span class="op" id="4094578">.</span><span class="ident" id="4094579">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094589">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094608">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094618">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094637">asn1</span><span class="op" id="4094641">.</span><span class="ident" id="4094642">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094652">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094671">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094686">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094705">asn1</span><span class="op" id="4094709">.</span><span class="ident" id="4094710">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4094722">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094747">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094766">asn1</span><span class="op" id="4094770">.</span><span class="ident" id="4094771">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4094783">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094808">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094827">[</span><span class="op" id="4094828">]</span><span class="ident" id="4094829">pkix</span><span class="op" id="4094833">.</span><span class="ident" id="4094834">Extension</span>&nbsp;<span class="string" id="4094844">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4094877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094880">type</span>&nbsp;<span class="ident" id="4094885">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4094908">struct</span>&nbsp;<span class="op" id="4094915">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094918">P</span><span class="op" id="4094919">,</span>&nbsp;<span class="ident" id="4094921">Q</span><span class="op" id="4094922">,</span>&nbsp;<span class="ident" id="4094924">G</span>&nbsp;<span class="op" id="4094926">*</span><span class="ident" id="4094927">big</span><span class="op" id="4094930">.</span><span class="ident" id="4094931">Int</span><br>
<span class="lineno"></span><span class="op" id="4094935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094938">type</span>&nbsp;<span class="ident" id="4094943">dsaSignature</span>&nbsp;<span class="keyword" id="4094956">struct</span>&nbsp;<span class="op" id="4094963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094966">R</span><span class="op" id="4094967">,</span>&nbsp;<span class="ident" id="4094969">S</span>&nbsp;<span class="op" id="4094971">*</span><span class="ident" id="4094972">big</span><span class="op" id="4094975">.</span><span class="ident" id="4094976">Int</span><br>
<span class="lineno">135</span><span class="op" id="4094980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094983">type</span>&nbsp;<span class="ident" id="4094988">ecdsaSignature</span>&nbsp;<span class="ident" id="4095003">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095017">type</span>&nbsp;<span class="ident" id="4095022">validity</span>&nbsp;<span class="keyword" id="4095031">struct</span>&nbsp;<span class="op" id="4095038">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095041">NotBefore</span><span class="op" id="4095050">,</span>&nbsp;<span class="ident" id="4095052">NotAfter</span>&nbsp;<span class="ident" id="4095061">time</span><span class="op" id="4095065">.</span><span class="ident" id="4095066">Time</span><br>
<span class="lineno"></span><span class="op" id="4095071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095074">type</span>&nbsp;<span class="ident" id="4095079">publicKeyInfo</span>&nbsp;<span class="keyword" id="4095093">struct</span>&nbsp;<span class="op" id="4095100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095103">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095113">asn1</span><span class="op" id="4095117">.</span><span class="ident" id="4095118">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095130">Algorithm</span>&nbsp;<span class="ident" id="4095140">pkix</span><span class="op" id="4095144">.</span><span class="ident" id="4095145">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095166">PublicKey</span>&nbsp;<span class="ident" id="4095176">asn1</span><span class="op" id="4095180">.</span><span class="ident" id="4095181">BitString</span><br>
<span class="lineno"></span><span class="op" id="4095191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095194">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4095216">type</span>&nbsp;<span class="ident" id="4095221">authKeyId</span>&nbsp;<span class="keyword" id="4095231">struct</span>&nbsp;<span class="op" id="4095238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095241">Id</span>&nbsp;<span class="op" id="4095244">[</span><span class="op" id="4095245">]</span><span class="builtintype" id="4095246">byte</span>&nbsp;<span class="string" id="4095251">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4095275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095278">type</span>&nbsp;<span class="ident" id="4095283">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4095302">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4095307">const</span>&nbsp;<span class="op" id="4095313">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095316">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4095342">SignatureAlgorithm</span>&nbsp;<span class="op" id="4095361">=</span>&nbsp;<span class="ident" id="4095363">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095369">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095381">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095393">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095406">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095421">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095436">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095451">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095464">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095479">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095494">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095511">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095528">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4095544">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095547">type</span>&nbsp;<span class="ident" id="4095552">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4095571">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095576">const</span>&nbsp;<span class="op" id="4095582">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095585">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4095611">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4095630">=</span>&nbsp;<span class="ident" id="4095632">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095638">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095643">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095648">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4095654">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4095657">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4095690">//</span><br>
<span class="lineno"></span><span class="comment" id="4095693">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4095727">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4095790">//</span><br>
<span class="lineno"></span><span class="comment" id="4095793">//</span><br>
<span class="lineno"></span><span class="comment" id="4095796">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4095839">//</span><br>
<span class="lineno"></span><span class="comment" id="4095842">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4095901">//</span><br>
<span class="lineno"></span><span class="comment" id="4095904">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4095963">//</span><br>
<span class="lineno"></span><span class="comment" id="4095966">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4096027">//</span><br>
<span class="lineno">195</span><span class="comment" id="4096030">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4096069">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4096130">//</span><br>
<span class="lineno"></span><span class="comment" id="4096133">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4096177">//</span><br>
<span class="lineno">200</span><span class="comment" id="4096180">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4096223">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4096276">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4096316">//</span><br>
<span class="lineno"></span><span class="comment" id="4096319">//</span><br>
<span class="lineno">205</span><span class="comment" id="4096322">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4096356">//</span><br>
<span class="lineno"></span><span class="comment" id="4096359">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4096422">//</span><br>
<span class="lineno"></span><span class="comment" id="4096425">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4096488">//</span><br>
<span class="lineno"></span><span class="comment" id="4096491">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4096554">//</span><br>
<span class="lineno"></span><span class="comment" id="4096557">//</span><br>
<span class="lineno"></span><span class="comment" id="4096560">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4096601">//</span><br>
<span class="lineno"></span><span class="comment" id="4096604">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4096645">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4096715">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4096766">//</span><br>
<span class="lineno">220</span><span class="comment" id="4096769">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4096811">//</span><br>
<span class="lineno"></span><span class="comment" id="4096814">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4096881">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4096950">//</span><br>
<span class="lineno">225</span><span class="comment" id="4096953">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4097020">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4097089">//</span><br>
<span class="lineno"></span><span class="comment" id="4097092">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4097159">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4097229">var</span>&nbsp;<span class="op" id="4097233">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097236">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097264">=</span>&nbsp;<span class="ident" id="4097266">asn1</span><span class="op" id="4097270">.</span><span class="ident" id="4097271">ObjectIdentifier</span><span class="op" id="4097287">{</span><span class="num" id="4097288">1</span><span class="op" id="4097289">,</span>&nbsp;<span class="num" id="4097291">2</span><span class="op" id="4097292">,</span>&nbsp;<span class="num" id="4097294">840</span><span class="op" id="4097297">,</span>&nbsp;<span class="num" id="4097299">113549</span><span class="op" id="4097305">,</span>&nbsp;<span class="num" id="4097307">1</span><span class="op" id="4097308">,</span>&nbsp;<span class="num" id="4097310">1</span><span class="op" id="4097311">,</span>&nbsp;<span class="num" id="4097313">2</span><span class="op" id="4097314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097317">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097345">=</span>&nbsp;<span class="ident" id="4097347">asn1</span><span class="op" id="4097351">.</span><span class="ident" id="4097352">ObjectIdentifier</span><span class="op" id="4097368">{</span><span class="num" id="4097369">1</span><span class="op" id="4097370">,</span>&nbsp;<span class="num" id="4097372">2</span><span class="op" id="4097373">,</span>&nbsp;<span class="num" id="4097375">840</span><span class="op" id="4097378">,</span>&nbsp;<span class="num" id="4097380">113549</span><span class="op" id="4097386">,</span>&nbsp;<span class="num" id="4097388">1</span><span class="op" id="4097389">,</span>&nbsp;<span class="num" id="4097391">1</span><span class="op" id="4097392">,</span>&nbsp;<span class="num" id="4097394">4</span><span class="op" id="4097395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097398">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097426">=</span>&nbsp;<span class="ident" id="4097428">asn1</span><span class="op" id="4097432">.</span><span class="ident" id="4097433">ObjectIdentifier</span><span class="op" id="4097449">{</span><span class="num" id="4097450">1</span><span class="op" id="4097451">,</span>&nbsp;<span class="num" id="4097453">2</span><span class="op" id="4097454">,</span>&nbsp;<span class="num" id="4097456">840</span><span class="op" id="4097459">,</span>&nbsp;<span class="num" id="4097461">113549</span><span class="op" id="4097467">,</span>&nbsp;<span class="num" id="4097469">1</span><span class="op" id="4097470">,</span>&nbsp;<span class="num" id="4097472">1</span><span class="op" id="4097473">,</span>&nbsp;<span class="num" id="4097475">5</span><span class="op" id="4097476">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097479">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4097507">=</span>&nbsp;<span class="ident" id="4097509">asn1</span><span class="op" id="4097513">.</span><span class="ident" id="4097514">ObjectIdentifier</span><span class="op" id="4097530">{</span><span class="num" id="4097531">1</span><span class="op" id="4097532">,</span>&nbsp;<span class="num" id="4097534">2</span><span class="op" id="4097535">,</span>&nbsp;<span class="num" id="4097537">840</span><span class="op" id="4097540">,</span>&nbsp;<span class="num" id="4097542">113549</span><span class="op" id="4097548">,</span>&nbsp;<span class="num" id="4097550">1</span><span class="op" id="4097551">,</span>&nbsp;<span class="num" id="4097553">1</span><span class="op" id="4097554">,</span>&nbsp;<span class="num" id="4097556">11</span><span class="op" id="4097558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097561">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4097589">=</span>&nbsp;<span class="ident" id="4097591">asn1</span><span class="op" id="4097595">.</span><span class="ident" id="4097596">ObjectIdentifier</span><span class="op" id="4097612">{</span><span class="num" id="4097613">1</span><span class="op" id="4097614">,</span>&nbsp;<span class="num" id="4097616">2</span><span class="op" id="4097617">,</span>&nbsp;<span class="num" id="4097619">840</span><span class="op" id="4097622">,</span>&nbsp;<span class="num" id="4097624">113549</span><span class="op" id="4097630">,</span>&nbsp;<span class="num" id="4097632">1</span><span class="op" id="4097633">,</span>&nbsp;<span class="num" id="4097635">1</span><span class="op" id="4097636">,</span>&nbsp;<span class="num" id="4097638">12</span><span class="op" id="4097640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097643">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4097671">=</span>&nbsp;<span class="ident" id="4097673">asn1</span><span class="op" id="4097677">.</span><span class="ident" id="4097678">ObjectIdentifier</span><span class="op" id="4097694">{</span><span class="num" id="4097695">1</span><span class="op" id="4097696">,</span>&nbsp;<span class="num" id="4097698">2</span><span class="op" id="4097699">,</span>&nbsp;<span class="num" id="4097701">840</span><span class="op" id="4097704">,</span>&nbsp;<span class="num" id="4097706">113549</span><span class="op" id="4097712">,</span>&nbsp;<span class="num" id="4097714">1</span><span class="op" id="4097715">,</span>&nbsp;<span class="num" id="4097717">1</span><span class="op" id="4097718">,</span>&nbsp;<span class="num" id="4097720">13</span><span class="op" id="4097722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097725">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097753">=</span>&nbsp;<span class="ident" id="4097755">asn1</span><span class="op" id="4097759">.</span><span class="ident" id="4097760">ObjectIdentifier</span><span class="op" id="4097776">{</span><span class="num" id="4097777">1</span><span class="op" id="4097778">,</span>&nbsp;<span class="num" id="4097780">2</span><span class="op" id="4097781">,</span>&nbsp;<span class="num" id="4097783">840</span><span class="op" id="4097786">,</span>&nbsp;<span class="num" id="4097788">10040</span><span class="op" id="4097793">,</span>&nbsp;<span class="num" id="4097795">4</span><span class="op" id="4097796">,</span>&nbsp;<span class="num" id="4097798">3</span><span class="op" id="4097799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097802">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4097830">=</span>&nbsp;<span class="ident" id="4097832">asn1</span><span class="op" id="4097836">.</span><span class="ident" id="4097837">ObjectIdentifier</span><span class="op" id="4097853">{</span><span class="num" id="4097854">2</span><span class="op" id="4097855">,</span>&nbsp;<span class="num" id="4097857">16</span><span class="op" id="4097859">,</span>&nbsp;<span class="num" id="4097861">840</span><span class="op" id="4097864">,</span>&nbsp;<span class="num" id="4097866">1</span><span class="op" id="4097867">,</span>&nbsp;<span class="num" id="4097869">101</span><span class="op" id="4097872">,</span>&nbsp;<span class="num" id="4097874">4</span><span class="op" id="4097875">,</span>&nbsp;<span class="num" id="4097877">3</span><span class="op" id="4097878">,</span>&nbsp;<span class="num" id="4097880">2</span><span class="op" id="4097881">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097884">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4097912">=</span>&nbsp;<span class="ident" id="4097914">asn1</span><span class="op" id="4097918">.</span><span class="ident" id="4097919">ObjectIdentifier</span><span class="op" id="4097935">{</span><span class="num" id="4097936">1</span><span class="op" id="4097937">,</span>&nbsp;<span class="num" id="4097939">2</span><span class="op" id="4097940">,</span>&nbsp;<span class="num" id="4097942">840</span><span class="op" id="4097945">,</span>&nbsp;<span class="num" id="4097947">10045</span><span class="op" id="4097952">,</span>&nbsp;<span class="num" id="4097954">4</span><span class="op" id="4097955">,</span>&nbsp;<span class="num" id="4097957">1</span><span class="op" id="4097958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097961">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4097989">=</span>&nbsp;<span class="ident" id="4097991">asn1</span><span class="op" id="4097995">.</span><span class="ident" id="4097996">ObjectIdentifier</span><span class="op" id="4098012">{</span><span class="num" id="4098013">1</span><span class="op" id="4098014">,</span>&nbsp;<span class="num" id="4098016">2</span><span class="op" id="4098017">,</span>&nbsp;<span class="num" id="4098019">840</span><span class="op" id="4098022">,</span>&nbsp;<span class="num" id="4098024">10045</span><span class="op" id="4098029">,</span>&nbsp;<span class="num" id="4098031">4</span><span class="op" id="4098032">,</span>&nbsp;<span class="num" id="4098034">3</span><span class="op" id="4098035">,</span>&nbsp;<span class="num" id="4098037">2</span><span class="op" id="4098038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098041">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4098069">=</span>&nbsp;<span class="ident" id="4098071">asn1</span><span class="op" id="4098075">.</span><span class="ident" id="4098076">ObjectIdentifier</span><span class="op" id="4098092">{</span><span class="num" id="4098093">1</span><span class="op" id="4098094">,</span>&nbsp;<span class="num" id="4098096">2</span><span class="op" id="4098097">,</span>&nbsp;<span class="num" id="4098099">840</span><span class="op" id="4098102">,</span>&nbsp;<span class="num" id="4098104">10045</span><span class="op" id="4098109">,</span>&nbsp;<span class="num" id="4098111">4</span><span class="op" id="4098112">,</span>&nbsp;<span class="num" id="4098114">3</span><span class="op" id="4098115">,</span>&nbsp;<span class="num" id="4098117">3</span><span class="op" id="4098118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098121">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4098149">=</span>&nbsp;<span class="ident" id="4098151">asn1</span><span class="op" id="4098155">.</span><span class="ident" id="4098156">ObjectIdentifier</span><span class="op" id="4098172">{</span><span class="num" id="4098173">1</span><span class="op" id="4098174">,</span>&nbsp;<span class="num" id="4098176">2</span><span class="op" id="4098177">,</span>&nbsp;<span class="num" id="4098179">840</span><span class="op" id="4098182">,</span>&nbsp;<span class="num" id="4098184">10045</span><span class="op" id="4098189">,</span>&nbsp;<span class="num" id="4098191">4</span><span class="op" id="4098192">,</span>&nbsp;<span class="num" id="4098194">3</span><span class="op" id="4098195">,</span>&nbsp;<span class="num" id="4098197">4</span><span class="op" id="4098198">}</span><br>
<span class="lineno"></span><span class="op" id="4098200">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4098203">var</span>&nbsp;<span class="ident" id="4098207">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4098233">=</span>&nbsp;<span class="op" id="4098235">[</span><span class="op" id="4098236">]</span><span class="keyword" id="4098237">struct</span>&nbsp;<span class="op" id="4098244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098247">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098258">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098278">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098289">asn1</span><span class="op" id="4098293">.</span><span class="ident" id="4098294">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098312">pubKeyAlgo</span>&nbsp;<span class="ident" id="4098323">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098343">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098354">crypto</span><span class="op" id="4098360">.</span><span class="ident" id="4098361">Hash</span><br>
<span class="lineno"></span><span class="op" id="4098366">}</span><span class="op" id="4098367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098370">{</span><span class="ident" id="4098371">MD2WithRSA</span><span class="op" id="4098381">,</span>&nbsp;<span class="ident" id="4098383">oidSignatureMD2WithRSA</span><span class="op" id="4098405">,</span>&nbsp;<span class="ident" id="4098407">RSA</span><span class="op" id="4098410">,</span>&nbsp;<span class="ident" id="4098412">crypto</span><span class="op" id="4098418">.</span><span class="ident" id="4098419">Hash</span><span class="op" id="4098423">(</span><span class="num" id="4098424">0</span><span class="op" id="4098425">)</span>&nbsp;<span class="comment" id="4098427">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4098449">}</span><span class="op" id="4098450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098453">{</span><span class="ident" id="4098454">MD5WithRSA</span><span class="op" id="4098464">,</span>&nbsp;<span class="ident" id="4098466">oidSignatureMD5WithRSA</span><span class="op" id="4098488">,</span>&nbsp;<span class="ident" id="4098490">RSA</span><span class="op" id="4098493">,</span>&nbsp;<span class="ident" id="4098495">crypto</span><span class="op" id="4098501">.</span><span class="ident" id="4098502">MD5</span><span class="op" id="4098505">}</span><span class="op" id="4098506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098509">{</span><span class="ident" id="4098510">SHA1WithRSA</span><span class="op" id="4098521">,</span>&nbsp;<span class="ident" id="4098523">oidSignatureSHA1WithRSA</span><span class="op" id="4098546">,</span>&nbsp;<span class="ident" id="4098548">RSA</span><span class="op" id="4098551">,</span>&nbsp;<span class="ident" id="4098553">crypto</span><span class="op" id="4098559">.</span><span class="ident" id="4098560">SHA1</span><span class="op" id="4098564">}</span><span class="op" id="4098565">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098568">{</span><span class="ident" id="4098569">SHA256WithRSA</span><span class="op" id="4098582">,</span>&nbsp;<span class="ident" id="4098584">oidSignatureSHA256WithRSA</span><span class="op" id="4098609">,</span>&nbsp;<span class="ident" id="4098611">RSA</span><span class="op" id="4098614">,</span>&nbsp;<span class="ident" id="4098616">crypto</span><span class="op" id="4098622">.</span><span class="ident" id="4098623">SHA256</span><span class="op" id="4098629">}</span><span class="op" id="4098630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098633">{</span><span class="ident" id="4098634">SHA384WithRSA</span><span class="op" id="4098647">,</span>&nbsp;<span class="ident" id="4098649">oidSignatureSHA384WithRSA</span><span class="op" id="4098674">,</span>&nbsp;<span class="ident" id="4098676">RSA</span><span class="op" id="4098679">,</span>&nbsp;<span class="ident" id="4098681">crypto</span><span class="op" id="4098687">.</span><span class="ident" id="4098688">SHA384</span><span class="op" id="4098694">}</span><span class="op" id="4098695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098698">{</span><span class="ident" id="4098699">SHA512WithRSA</span><span class="op" id="4098712">,</span>&nbsp;<span class="ident" id="4098714">oidSignatureSHA512WithRSA</span><span class="op" id="4098739">,</span>&nbsp;<span class="ident" id="4098741">RSA</span><span class="op" id="4098744">,</span>&nbsp;<span class="ident" id="4098746">crypto</span><span class="op" id="4098752">.</span><span class="ident" id="4098753">SHA512</span><span class="op" id="4098759">}</span><span class="op" id="4098760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098763">{</span><span class="ident" id="4098764">DSAWithSHA1</span><span class="op" id="4098775">,</span>&nbsp;<span class="ident" id="4098777">oidSignatureDSAWithSHA1</span><span class="op" id="4098800">,</span>&nbsp;<span class="ident" id="4098802">DSA</span><span class="op" id="4098805">,</span>&nbsp;<span class="ident" id="4098807">crypto</span><span class="op" id="4098813">.</span><span class="ident" id="4098814">SHA1</span><span class="op" id="4098818">}</span><span class="op" id="4098819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098822">{</span><span class="ident" id="4098823">DSAWithSHA256</span><span class="op" id="4098836">,</span>&nbsp;<span class="ident" id="4098838">oidSignatureDSAWithSHA256</span><span class="op" id="4098863">,</span>&nbsp;<span class="ident" id="4098865">DSA</span><span class="op" id="4098868">,</span>&nbsp;<span class="ident" id="4098870">crypto</span><span class="op" id="4098876">.</span><span class="ident" id="4098877">SHA256</span><span class="op" id="4098883">}</span><span class="op" id="4098884">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098887">{</span><span class="ident" id="4098888">ECDSAWithSHA1</span><span class="op" id="4098901">,</span>&nbsp;<span class="ident" id="4098903">oidSignatureECDSAWithSHA1</span><span class="op" id="4098928">,</span>&nbsp;<span class="ident" id="4098930">ECDSA</span><span class="op" id="4098935">,</span>&nbsp;<span class="ident" id="4098937">crypto</span><span class="op" id="4098943">.</span><span class="ident" id="4098944">SHA1</span><span class="op" id="4098948">}</span><span class="op" id="4098949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098952">{</span><span class="ident" id="4098953">ECDSAWithSHA256</span><span class="op" id="4098968">,</span>&nbsp;<span class="ident" id="4098970">oidSignatureECDSAWithSHA256</span><span class="op" id="4098997">,</span>&nbsp;<span class="ident" id="4098999">ECDSA</span><span class="op" id="4099004">,</span>&nbsp;<span class="ident" id="4099006">crypto</span><span class="op" id="4099012">.</span><span class="ident" id="4099013">SHA256</span><span class="op" id="4099019">}</span><span class="op" id="4099020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099023">{</span><span class="ident" id="4099024">ECDSAWithSHA384</span><span class="op" id="4099039">,</span>&nbsp;<span class="ident" id="4099041">oidSignatureECDSAWithSHA384</span><span class="op" id="4099068">,</span>&nbsp;<span class="ident" id="4099070">ECDSA</span><span class="op" id="4099075">,</span>&nbsp;<span class="ident" id="4099077">crypto</span><span class="op" id="4099083">.</span><span class="ident" id="4099084">SHA384</span><span class="op" id="4099090">}</span><span class="op" id="4099091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099094">{</span><span class="ident" id="4099095">ECDSAWithSHA512</span><span class="op" id="4099110">,</span>&nbsp;<span class="ident" id="4099112">oidSignatureECDSAWithSHA512</span><span class="op" id="4099139">,</span>&nbsp;<span class="ident" id="4099141">ECDSA</span><span class="op" id="4099146">,</span>&nbsp;<span class="ident" id="4099148">crypto</span><span class="op" id="4099154">.</span><span class="ident" id="4099155">SHA512</span><span class="op" id="4099161">}</span><span class="op" id="4099162">,</span><br>
<span class="lineno"></span><span class="op" id="4099164">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4099167">func</span>&nbsp;<span class="ident" id="4099172">getSignatureAlgorithmFromOID</span><span class="op" id="4099200">(</span><span class="ident" id="4099201">oid</span>&nbsp;<span class="ident" id="4099205">asn1</span><span class="op" id="4099209">.</span><span class="ident" id="4099210">ObjectIdentifier</span><span class="op" id="4099226">)</span>&nbsp;<span class="ident" id="4099228">SignatureAlgorithm</span>&nbsp;<span class="op" id="4099247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099250">for</span>&nbsp;<span class="ident" id="4099254">_</span><span class="op" id="4099255">,</span>&nbsp;<span class="ident" id="4099257">details</span>&nbsp;<span class="op" id="4099265">:=</span>&nbsp;<span class="keyword" id="4099268">range</span>&nbsp;<span class="ident" id="4099274">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4099300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099304">if</span>&nbsp;<span class="ident" id="4099307">oid</span><span class="op" id="4099310">.</span><span class="ident" id="4099311">Equal</span><span class="op" id="4099316">(</span><span class="ident" id="4099317">details</span><span class="op" id="4099324">.</span><span class="ident" id="4099325">oid</span><span class="op" id="4099328">)</span>&nbsp;<span class="op" id="4099330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099335">return</span>&nbsp;<span class="ident" id="4099342">details</span><span class="op" id="4099349">.</span><span class="ident" id="4099350">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099363">return</span>&nbsp;<span class="ident" id="4099370">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4099396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4099399">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4099438">//</span><br>
<span class="lineno"></span><span class="comment" id="4099441">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4099506">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4099539">//</span><br>
<span class="lineno">280</span><span class="comment" id="4099542">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4099596">//</span><br>
<span class="lineno"></span><span class="comment" id="4099599">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4099664">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4099695">//</span><br>
<span class="lineno">285</span><span class="comment" id="4099698">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4099766">//</span><br>
<span class="lineno"></span><span class="comment" id="4099769">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4099811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4099883">var</span>&nbsp;<span class="op" id="4099887">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099890">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4099908">=</span>&nbsp;<span class="ident" id="4099910">asn1</span><span class="op" id="4099914">.</span><span class="ident" id="4099915">ObjectIdentifier</span><span class="op" id="4099931">{</span><span class="num" id="4099932">1</span><span class="op" id="4099933">,</span>&nbsp;<span class="num" id="4099935">2</span><span class="op" id="4099936">,</span>&nbsp;<span class="num" id="4099938">840</span><span class="op" id="4099941">,</span>&nbsp;<span class="num" id="4099943">113549</span><span class="op" id="4099949">,</span>&nbsp;<span class="num" id="4099951">1</span><span class="op" id="4099952">,</span>&nbsp;<span class="num" id="4099954">1</span><span class="op" id="4099955">,</span>&nbsp;<span class="num" id="4099957">1</span><span class="op" id="4099958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099961">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4099979">=</span>&nbsp;<span class="ident" id="4099981">asn1</span><span class="op" id="4099985">.</span><span class="ident" id="4099986">ObjectIdentifier</span><span class="op" id="4100002">{</span><span class="num" id="4100003">1</span><span class="op" id="4100004">,</span>&nbsp;<span class="num" id="4100006">2</span><span class="op" id="4100007">,</span>&nbsp;<span class="num" id="4100009">840</span><span class="op" id="4100012">,</span>&nbsp;<span class="num" id="4100014">10040</span><span class="op" id="4100019">,</span>&nbsp;<span class="num" id="4100021">4</span><span class="op" id="4100022">,</span>&nbsp;<span class="num" id="4100024">1</span><span class="op" id="4100025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100028">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4100046">=</span>&nbsp;<span class="ident" id="4100048">asn1</span><span class="op" id="4100052">.</span><span class="ident" id="4100053">ObjectIdentifier</span><span class="op" id="4100069">{</span><span class="num" id="4100070">1</span><span class="op" id="4100071">,</span>&nbsp;<span class="num" id="4100073">2</span><span class="op" id="4100074">,</span>&nbsp;<span class="num" id="4100076">840</span><span class="op" id="4100079">,</span>&nbsp;<span class="num" id="4100081">10045</span><span class="op" id="4100086">,</span>&nbsp;<span class="num" id="4100088">2</span><span class="op" id="4100089">,</span>&nbsp;<span class="num" id="4100091">1</span><span class="op" id="4100092">}</span><br>
<span class="lineno"></span><span class="op" id="4100094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4100097">func</span>&nbsp;<span class="ident" id="4100102">getPublicKeyAlgorithmFromOID</span><span class="op" id="4100130">(</span><span class="ident" id="4100131">oid</span>&nbsp;<span class="ident" id="4100135">asn1</span><span class="op" id="4100139">.</span><span class="ident" id="4100140">ObjectIdentifier</span><span class="op" id="4100156">)</span>&nbsp;<span class="ident" id="4100158">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4100177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100180">switch</span>&nbsp;<span class="op" id="4100187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100190">case</span>&nbsp;<span class="ident" id="4100195">oid</span><span class="op" id="4100198">.</span><span class="ident" id="4100199">Equal</span><span class="op" id="4100204">(</span><span class="ident" id="4100205">oidPublicKeyRSA</span><span class="op" id="4100220">)</span><span class="op" id="4100221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100225">return</span>&nbsp;<span class="ident" id="4100232">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100237">case</span>&nbsp;<span class="ident" id="4100242">oid</span><span class="op" id="4100245">.</span><span class="ident" id="4100246">Equal</span><span class="op" id="4100251">(</span><span class="ident" id="4100252">oidPublicKeyDSA</span><span class="op" id="4100267">)</span><span class="op" id="4100268">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100272">return</span>&nbsp;<span class="ident" id="4100279">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100284">case</span>&nbsp;<span class="ident" id="4100289">oid</span><span class="op" id="4100292">.</span><span class="ident" id="4100293">Equal</span><span class="op" id="4100298">(</span><span class="ident" id="4100299">oidPublicKeyECDSA</span><span class="op" id="4100316">)</span><span class="op" id="4100317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100321">return</span>&nbsp;<span class="ident" id="4100328">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100338">return</span>&nbsp;<span class="ident" id="4100345">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4100371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4100374">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4100408">//</span><br>
<span class="lineno"></span><span class="comment" id="4100411">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4100448">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4100515">//</span><br>
<span class="lineno"></span><span class="comment" id="4100518">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4100555">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4100618">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4100636">//</span><br>
<span class="lineno"></span><span class="comment" id="4100639">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4100676">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4100743">//</span><br>
<span class="lineno"></span><span class="comment" id="4100746">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4100783">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4100850">//</span><br>
<span class="lineno"></span><span class="comment" id="4100853">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4100898">var</span>&nbsp;<span class="op" id="4100902">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100905">oidNamedCurveP224</span>&nbsp;<span class="op" id="4100923">=</span>&nbsp;<span class="ident" id="4100925">asn1</span><span class="op" id="4100929">.</span><span class="ident" id="4100930">ObjectIdentifier</span><span class="op" id="4100946">{</span><span class="num" id="4100947">1</span><span class="op" id="4100948">,</span>&nbsp;<span class="num" id="4100950">3</span><span class="op" id="4100951">,</span>&nbsp;<span class="num" id="4100953">132</span><span class="op" id="4100956">,</span>&nbsp;<span class="num" id="4100958">0</span><span class="op" id="4100959">,</span>&nbsp;<span class="num" id="4100961">33</span><span class="op" id="4100963">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100966">oidNamedCurveP256</span>&nbsp;<span class="op" id="4100984">=</span>&nbsp;<span class="ident" id="4100986">asn1</span><span class="op" id="4100990">.</span><span class="ident" id="4100991">ObjectIdentifier</span><span class="op" id="4101007">{</span><span class="num" id="4101008">1</span><span class="op" id="4101009">,</span>&nbsp;<span class="num" id="4101011">2</span><span class="op" id="4101012">,</span>&nbsp;<span class="num" id="4101014">840</span><span class="op" id="4101017">,</span>&nbsp;<span class="num" id="4101019">10045</span><span class="op" id="4101024">,</span>&nbsp;<span class="num" id="4101026">3</span><span class="op" id="4101027">,</span>&nbsp;<span class="num" id="4101029">1</span><span class="op" id="4101030">,</span>&nbsp;<span class="num" id="4101032">7</span><span class="op" id="4101033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101036">oidNamedCurveP384</span>&nbsp;<span class="op" id="4101054">=</span>&nbsp;<span class="ident" id="4101056">asn1</span><span class="op" id="4101060">.</span><span class="ident" id="4101061">ObjectIdentifier</span><span class="op" id="4101077">{</span><span class="num" id="4101078">1</span><span class="op" id="4101079">,</span>&nbsp;<span class="num" id="4101081">3</span><span class="op" id="4101082">,</span>&nbsp;<span class="num" id="4101084">132</span><span class="op" id="4101087">,</span>&nbsp;<span class="num" id="4101089">0</span><span class="op" id="4101090">,</span>&nbsp;<span class="num" id="4101092">34</span><span class="op" id="4101094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101097">oidNamedCurveP521</span>&nbsp;<span class="op" id="4101115">=</span>&nbsp;<span class="ident" id="4101117">asn1</span><span class="op" id="4101121">.</span><span class="ident" id="4101122">ObjectIdentifier</span><span class="op" id="4101138">{</span><span class="num" id="4101139">1</span><span class="op" id="4101140">,</span>&nbsp;<span class="num" id="4101142">3</span><span class="op" id="4101143">,</span>&nbsp;<span class="num" id="4101145">132</span><span class="op" id="4101148">,</span>&nbsp;<span class="num" id="4101150">0</span><span class="op" id="4101151">,</span>&nbsp;<span class="num" id="4101153">35</span><span class="op" id="4101155">}</span><br>
<span class="lineno"></span><span class="op" id="4101157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4101160">func</span>&nbsp;<span class="ident" id="4101165">namedCurveFromOID</span><span class="op" id="4101182">(</span><span class="ident" id="4101183">oid</span>&nbsp;<span class="ident" id="4101187">asn1</span><span class="op" id="4101191">.</span><span class="ident" id="4101192">ObjectIdentifier</span><span class="op" id="4101208">)</span>&nbsp;<span class="ident" id="4101210">elliptic</span><span class="op" id="4101218">.</span><span class="ident" id="4101219">Curve</span>&nbsp;<span class="op" id="4101225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101228">switch</span>&nbsp;<span class="op" id="4101235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101238">case</span>&nbsp;<span class="ident" id="4101243">oid</span><span class="op" id="4101246">.</span><span class="ident" id="4101247">Equal</span><span class="op" id="4101252">(</span><span class="ident" id="4101253">oidNamedCurveP224</span><span class="op" id="4101270">)</span><span class="op" id="4101271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101275">return</span>&nbsp;<span class="ident" id="4101282">elliptic</span><span class="op" id="4101290">.</span><span class="ident" id="4101291">P224</span><span class="op" id="4101295">(</span><span class="op" id="4101296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101299">case</span>&nbsp;<span class="ident" id="4101304">oid</span><span class="op" id="4101307">.</span><span class="ident" id="4101308">Equal</span><span class="op" id="4101313">(</span><span class="ident" id="4101314">oidNamedCurveP256</span><span class="op" id="4101331">)</span><span class="op" id="4101332">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101336">return</span>&nbsp;<span class="ident" id="4101343">elliptic</span><span class="op" id="4101351">.</span><span class="ident" id="4101352">P256</span><span class="op" id="4101356">(</span><span class="op" id="4101357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101360">case</span>&nbsp;<span class="ident" id="4101365">oid</span><span class="op" id="4101368">.</span><span class="ident" id="4101369">Equal</span><span class="op" id="4101374">(</span><span class="ident" id="4101375">oidNamedCurveP384</span><span class="op" id="4101392">)</span><span class="op" id="4101393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101397">return</span>&nbsp;<span class="ident" id="4101404">elliptic</span><span class="op" id="4101412">.</span><span class="ident" id="4101413">P384</span><span class="op" id="4101417">(</span><span class="op" id="4101418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101421">case</span>&nbsp;<span class="ident" id="4101426">oid</span><span class="op" id="4101429">.</span><span class="ident" id="4101430">Equal</span><span class="op" id="4101435">(</span><span class="ident" id="4101436">oidNamedCurveP521</span><span class="op" id="4101453">)</span><span class="op" id="4101454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101458">return</span>&nbsp;<span class="ident" id="4101465">elliptic</span><span class="op" id="4101473">.</span><span class="ident" id="4101474">P521</span><span class="op" id="4101478">(</span><span class="op" id="4101479">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101485">return</span>&nbsp;<span class="ident" id="4101492">nil</span><br>
<span class="lineno"></span><span class="op" id="4101496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4101499">func</span>&nbsp;<span class="ident" id="4101504">oidFromNamedCurve</span><span class="op" id="4101521">(</span><span class="ident" id="4101522">curve</span>&nbsp;<span class="ident" id="4101528">elliptic</span><span class="op" id="4101536">.</span><span class="ident" id="4101537">Curve</span><span class="op" id="4101542">)</span>&nbsp;<span class="op" id="4101544">(</span><span class="ident" id="4101545">asn1</span><span class="op" id="4101549">.</span><span class="ident" id="4101550">ObjectIdentifier</span><span class="op" id="4101566">,</span>&nbsp;<span class="builtintype" id="4101568">bool</span><span class="op" id="4101572">)</span>&nbsp;<span class="op" id="4101574">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101577">switch</span>&nbsp;<span class="ident" id="4101584">curve</span>&nbsp;<span class="op" id="4101590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101593">case</span>&nbsp;<span class="ident" id="4101598">elliptic</span><span class="op" id="4101606">.</span><span class="ident" id="4101607">P224</span><span class="op" id="4101611">(</span><span class="op" id="4101612">)</span><span class="op" id="4101613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101617">return</span>&nbsp;<span class="ident" id="4101624">oidNamedCurveP224</span><span class="op" id="4101641">,</span>&nbsp;<span class="ident" id="4101643">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101649">case</span>&nbsp;<span class="ident" id="4101654">elliptic</span><span class="op" id="4101662">.</span><span class="ident" id="4101663">P256</span><span class="op" id="4101667">(</span><span class="op" id="4101668">)</span><span class="op" id="4101669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101673">return</span>&nbsp;<span class="ident" id="4101680">oidNamedCurveP256</span><span class="op" id="4101697">,</span>&nbsp;<span class="ident" id="4101699">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101705">case</span>&nbsp;<span class="ident" id="4101710">elliptic</span><span class="op" id="4101718">.</span><span class="ident" id="4101719">P384</span><span class="op" id="4101723">(</span><span class="op" id="4101724">)</span><span class="op" id="4101725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101729">return</span>&nbsp;<span class="ident" id="4101736">oidNamedCurveP384</span><span class="op" id="4101753">,</span>&nbsp;<span class="ident" id="4101755">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101761">case</span>&nbsp;<span class="ident" id="4101766">elliptic</span><span class="op" id="4101774">.</span><span class="ident" id="4101775">P521</span><span class="op" id="4101779">(</span><span class="op" id="4101780">)</span><span class="op" id="4101781">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101785">return</span>&nbsp;<span class="ident" id="4101792">oidNamedCurveP521</span><span class="op" id="4101809">,</span>&nbsp;<span class="ident" id="4101811">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101817">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101821">return</span>&nbsp;<span class="ident" id="4101828">nil</span><span class="op" id="4101831">,</span>&nbsp;<span class="ident" id="4101833">false</span><br>
<span class="lineno"></span><span class="op" id="4101839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4101842">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4101921">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4101961">type</span>&nbsp;<span class="ident" id="4101966">KeyUsage</span>&nbsp;<span class="builtintype" id="4101975">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4101980">const</span>&nbsp;<span class="op" id="4101986">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101989">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4102014">KeyUsage</span>&nbsp;<span class="op" id="4102023">=</span>&nbsp;<span class="num" id="4102025">1</span>&nbsp;<span class="op" id="4102027">&lt;&lt;</span>&nbsp;<span class="ident" id="4102030">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102036">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102063">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102088">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102114">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102136">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102154">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102171">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102193">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4102214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4102217">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4102259">//</span><br>
<span class="lineno"></span><span class="comment" id="4102262">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4102331">//</span><br>
<span class="lineno"></span><span class="comment" id="4102334">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4102379">//</span><br>
<span class="lineno"></span><span class="comment" id="4102382">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4102448">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4102514">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4102580">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4102646">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4102712">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4102778">var</span>&nbsp;<span class="op" id="4102782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102785">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102826">=</span>&nbsp;<span class="ident" id="4102828">asn1</span><span class="op" id="4102832">.</span><span class="ident" id="4102833">ObjectIdentifier</span><span class="op" id="4102849">{</span><span class="num" id="4102850">2</span><span class="op" id="4102851">,</span>&nbsp;<span class="num" id="4102853">5</span><span class="op" id="4102854">,</span>&nbsp;<span class="num" id="4102856">29</span><span class="op" id="4102858">,</span>&nbsp;<span class="num" id="4102860">37</span><span class="op" id="4102862">,</span>&nbsp;<span class="num" id="4102864">0</span><span class="op" id="4102865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102868">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102909">=</span>&nbsp;<span class="ident" id="4102911">asn1</span><span class="op" id="4102915">.</span><span class="ident" id="4102916">ObjectIdentifier</span><span class="op" id="4102932">{</span><span class="num" id="4102933">1</span><span class="op" id="4102934">,</span>&nbsp;<span class="num" id="4102936">3</span><span class="op" id="4102937">,</span>&nbsp;<span class="num" id="4102939">6</span><span class="op" id="4102940">,</span>&nbsp;<span class="num" id="4102942">1</span><span class="op" id="4102943">,</span>&nbsp;<span class="num" id="4102945">5</span><span class="op" id="4102946">,</span>&nbsp;<span class="num" id="4102948">5</span><span class="op" id="4102949">,</span>&nbsp;<span class="num" id="4102951">7</span><span class="op" id="4102952">,</span>&nbsp;<span class="num" id="4102954">3</span><span class="op" id="4102955">,</span>&nbsp;<span class="num" id="4102957">1</span><span class="op" id="4102958">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102961">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103002">=</span>&nbsp;<span class="ident" id="4103004">asn1</span><span class="op" id="4103008">.</span><span class="ident" id="4103009">ObjectIdentifier</span><span class="op" id="4103025">{</span><span class="num" id="4103026">1</span><span class="op" id="4103027">,</span>&nbsp;<span class="num" id="4103029">3</span><span class="op" id="4103030">,</span>&nbsp;<span class="num" id="4103032">6</span><span class="op" id="4103033">,</span>&nbsp;<span class="num" id="4103035">1</span><span class="op" id="4103036">,</span>&nbsp;<span class="num" id="4103038">5</span><span class="op" id="4103039">,</span>&nbsp;<span class="num" id="4103041">5</span><span class="op" id="4103042">,</span>&nbsp;<span class="num" id="4103044">7</span><span class="op" id="4103045">,</span>&nbsp;<span class="num" id="4103047">3</span><span class="op" id="4103048">,</span>&nbsp;<span class="num" id="4103050">2</span><span class="op" id="4103051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103054">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103095">=</span>&nbsp;<span class="ident" id="4103097">asn1</span><span class="op" id="4103101">.</span><span class="ident" id="4103102">ObjectIdentifier</span><span class="op" id="4103118">{</span><span class="num" id="4103119">1</span><span class="op" id="4103120">,</span>&nbsp;<span class="num" id="4103122">3</span><span class="op" id="4103123">,</span>&nbsp;<span class="num" id="4103125">6</span><span class="op" id="4103126">,</span>&nbsp;<span class="num" id="4103128">1</span><span class="op" id="4103129">,</span>&nbsp;<span class="num" id="4103131">5</span><span class="op" id="4103132">,</span>&nbsp;<span class="num" id="4103134">5</span><span class="op" id="4103135">,</span>&nbsp;<span class="num" id="4103137">7</span><span class="op" id="4103138">,</span>&nbsp;<span class="num" id="4103140">3</span><span class="op" id="4103141">,</span>&nbsp;<span class="num" id="4103143">3</span><span class="op" id="4103144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103147">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103188">=</span>&nbsp;<span class="ident" id="4103190">asn1</span><span class="op" id="4103194">.</span><span class="ident" id="4103195">ObjectIdentifier</span><span class="op" id="4103211">{</span><span class="num" id="4103212">1</span><span class="op" id="4103213">,</span>&nbsp;<span class="num" id="4103215">3</span><span class="op" id="4103216">,</span>&nbsp;<span class="num" id="4103218">6</span><span class="op" id="4103219">,</span>&nbsp;<span class="num" id="4103221">1</span><span class="op" id="4103222">,</span>&nbsp;<span class="num" id="4103224">5</span><span class="op" id="4103225">,</span>&nbsp;<span class="num" id="4103227">5</span><span class="op" id="4103228">,</span>&nbsp;<span class="num" id="4103230">7</span><span class="op" id="4103231">,</span>&nbsp;<span class="num" id="4103233">3</span><span class="op" id="4103234">,</span>&nbsp;<span class="num" id="4103236">4</span><span class="op" id="4103237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103240">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103281">=</span>&nbsp;<span class="ident" id="4103283">asn1</span><span class="op" id="4103287">.</span><span class="ident" id="4103288">ObjectIdentifier</span><span class="op" id="4103304">{</span><span class="num" id="4103305">1</span><span class="op" id="4103306">,</span>&nbsp;<span class="num" id="4103308">3</span><span class="op" id="4103309">,</span>&nbsp;<span class="num" id="4103311">6</span><span class="op" id="4103312">,</span>&nbsp;<span class="num" id="4103314">1</span><span class="op" id="4103315">,</span>&nbsp;<span class="num" id="4103317">5</span><span class="op" id="4103318">,</span>&nbsp;<span class="num" id="4103320">5</span><span class="op" id="4103321">,</span>&nbsp;<span class="num" id="4103323">7</span><span class="op" id="4103324">,</span>&nbsp;<span class="num" id="4103326">3</span><span class="op" id="4103327">,</span>&nbsp;<span class="num" id="4103329">5</span><span class="op" id="4103330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103333">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103374">=</span>&nbsp;<span class="ident" id="4103376">asn1</span><span class="op" id="4103380">.</span><span class="ident" id="4103381">ObjectIdentifier</span><span class="op" id="4103397">{</span><span class="num" id="4103398">1</span><span class="op" id="4103399">,</span>&nbsp;<span class="num" id="4103401">3</span><span class="op" id="4103402">,</span>&nbsp;<span class="num" id="4103404">6</span><span class="op" id="4103405">,</span>&nbsp;<span class="num" id="4103407">1</span><span class="op" id="4103408">,</span>&nbsp;<span class="num" id="4103410">5</span><span class="op" id="4103411">,</span>&nbsp;<span class="num" id="4103413">5</span><span class="op" id="4103414">,</span>&nbsp;<span class="num" id="4103416">7</span><span class="op" id="4103417">,</span>&nbsp;<span class="num" id="4103419">3</span><span class="op" id="4103420">,</span>&nbsp;<span class="num" id="4103422">6</span><span class="op" id="4103423">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103426">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103467">=</span>&nbsp;<span class="ident" id="4103469">asn1</span><span class="op" id="4103473">.</span><span class="ident" id="4103474">ObjectIdentifier</span><span class="op" id="4103490">{</span><span class="num" id="4103491">1</span><span class="op" id="4103492">,</span>&nbsp;<span class="num" id="4103494">3</span><span class="op" id="4103495">,</span>&nbsp;<span class="num" id="4103497">6</span><span class="op" id="4103498">,</span>&nbsp;<span class="num" id="4103500">1</span><span class="op" id="4103501">,</span>&nbsp;<span class="num" id="4103503">5</span><span class="op" id="4103504">,</span>&nbsp;<span class="num" id="4103506">5</span><span class="op" id="4103507">,</span>&nbsp;<span class="num" id="4103509">7</span><span class="op" id="4103510">,</span>&nbsp;<span class="num" id="4103512">3</span><span class="op" id="4103513">,</span>&nbsp;<span class="num" id="4103515">7</span><span class="op" id="4103516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103519">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103560">=</span>&nbsp;<span class="ident" id="4103562">asn1</span><span class="op" id="4103566">.</span><span class="ident" id="4103567">ObjectIdentifier</span><span class="op" id="4103583">{</span><span class="num" id="4103584">1</span><span class="op" id="4103585">,</span>&nbsp;<span class="num" id="4103587">3</span><span class="op" id="4103588">,</span>&nbsp;<span class="num" id="4103590">6</span><span class="op" id="4103591">,</span>&nbsp;<span class="num" id="4103593">1</span><span class="op" id="4103594">,</span>&nbsp;<span class="num" id="4103596">5</span><span class="op" id="4103597">,</span>&nbsp;<span class="num" id="4103599">5</span><span class="op" id="4103600">,</span>&nbsp;<span class="num" id="4103602">7</span><span class="op" id="4103603">,</span>&nbsp;<span class="num" id="4103605">3</span><span class="op" id="4103606">,</span>&nbsp;<span class="num" id="4103608">8</span><span class="op" id="4103609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103612">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103653">=</span>&nbsp;<span class="ident" id="4103655">asn1</span><span class="op" id="4103659">.</span><span class="ident" id="4103660">ObjectIdentifier</span><span class="op" id="4103676">{</span><span class="num" id="4103677">1</span><span class="op" id="4103678">,</span>&nbsp;<span class="num" id="4103680">3</span><span class="op" id="4103681">,</span>&nbsp;<span class="num" id="4103683">6</span><span class="op" id="4103684">,</span>&nbsp;<span class="num" id="4103686">1</span><span class="op" id="4103687">,</span>&nbsp;<span class="num" id="4103689">5</span><span class="op" id="4103690">,</span>&nbsp;<span class="num" id="4103692">5</span><span class="op" id="4103693">,</span>&nbsp;<span class="num" id="4103695">7</span><span class="op" id="4103696">,</span>&nbsp;<span class="num" id="4103698">3</span><span class="op" id="4103699">,</span>&nbsp;<span class="num" id="4103701">9</span><span class="op" id="4103702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103705">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4103746">=</span>&nbsp;<span class="ident" id="4103748">asn1</span><span class="op" id="4103752">.</span><span class="ident" id="4103753">ObjectIdentifier</span><span class="op" id="4103769">{</span><span class="num" id="4103770">1</span><span class="op" id="4103771">,</span>&nbsp;<span class="num" id="4103773">3</span><span class="op" id="4103774">,</span>&nbsp;<span class="num" id="4103776">6</span><span class="op" id="4103777">,</span>&nbsp;<span class="num" id="4103779">1</span><span class="op" id="4103780">,</span>&nbsp;<span class="num" id="4103782">4</span><span class="op" id="4103783">,</span>&nbsp;<span class="num" id="4103785">1</span><span class="op" id="4103786">,</span>&nbsp;<span class="num" id="4103788">311</span><span class="op" id="4103791">,</span>&nbsp;<span class="num" id="4103793">10</span><span class="op" id="4103795">,</span>&nbsp;<span class="num" id="4103797">3</span><span class="op" id="4103798">,</span>&nbsp;<span class="num" id="4103800">3</span><span class="op" id="4103801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103804">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4103845">=</span>&nbsp;<span class="ident" id="4103847">asn1</span><span class="op" id="4103851">.</span><span class="ident" id="4103852">ObjectIdentifier</span><span class="op" id="4103868">{</span><span class="num" id="4103869">2</span><span class="op" id="4103870">,</span>&nbsp;<span class="num" id="4103872">16</span><span class="op" id="4103874">,</span>&nbsp;<span class="num" id="4103876">840</span><span class="op" id="4103879">,</span>&nbsp;<span class="num" id="4103881">1</span><span class="op" id="4103882">,</span>&nbsp;<span class="num" id="4103884">113730</span><span class="op" id="4103890">,</span>&nbsp;<span class="num" id="4103892">4</span><span class="op" id="4103893">,</span>&nbsp;<span class="num" id="4103895">1</span><span class="op" id="4103896">}</span><br>
<span class="lineno">400</span><span class="op" id="4103898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4103901">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4103986">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4104048">type</span>&nbsp;<span class="ident" id="4104053">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4104065">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4104070">const</span>&nbsp;<span class="op" id="4104076">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104079">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4104094">ExtKeyUsage</span>&nbsp;<span class="op" id="4104106">=</span>&nbsp;<span class="ident" id="4104108">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104114">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104137">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104160">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104184">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104212">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104239">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104263">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104285">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104310">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104334">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104373">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4104410">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4104413">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4104489">var</span>&nbsp;<span class="ident" id="4104493">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4104509">=</span>&nbsp;<span class="op" id="4104511">[</span><span class="op" id="4104512">]</span><span class="keyword" id="4104513">struct</span>&nbsp;<span class="op" id="4104520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104523">extKeyUsage</span>&nbsp;<span class="ident" id="4104535">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104548">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104560">asn1</span><span class="op" id="4104564">.</span><span class="ident" id="4104565">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4104582">}</span><span class="op" id="4104583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104586">{</span><span class="ident" id="4104587">ExtKeyUsageAny</span><span class="op" id="4104601">,</span>&nbsp;<span class="ident" id="4104603">oidExtKeyUsageAny</span><span class="op" id="4104620">}</span><span class="op" id="4104621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104624">{</span><span class="ident" id="4104625">ExtKeyUsageServerAuth</span><span class="op" id="4104646">,</span>&nbsp;<span class="ident" id="4104648">oidExtKeyUsageServerAuth</span><span class="op" id="4104672">}</span><span class="op" id="4104673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104676">{</span><span class="ident" id="4104677">ExtKeyUsageClientAuth</span><span class="op" id="4104698">,</span>&nbsp;<span class="ident" id="4104700">oidExtKeyUsageClientAuth</span><span class="op" id="4104724">}</span><span class="op" id="4104725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104728">{</span><span class="ident" id="4104729">ExtKeyUsageCodeSigning</span><span class="op" id="4104751">,</span>&nbsp;<span class="ident" id="4104753">oidExtKeyUsageCodeSigning</span><span class="op" id="4104778">}</span><span class="op" id="4104779">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104782">{</span><span class="ident" id="4104783">ExtKeyUsageEmailProtection</span><span class="op" id="4104809">,</span>&nbsp;<span class="ident" id="4104811">oidExtKeyUsageEmailProtection</span><span class="op" id="4104840">}</span><span class="op" id="4104841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104844">{</span><span class="ident" id="4104845">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4104870">,</span>&nbsp;<span class="ident" id="4104872">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4104900">}</span><span class="op" id="4104901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104904">{</span><span class="ident" id="4104905">ExtKeyUsageIPSECTunnel</span><span class="op" id="4104927">,</span>&nbsp;<span class="ident" id="4104929">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4104954">}</span><span class="op" id="4104955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104958">{</span><span class="ident" id="4104959">ExtKeyUsageIPSECUser</span><span class="op" id="4104979">,</span>&nbsp;<span class="ident" id="4104981">oidExtKeyUsageIPSECUser</span><span class="op" id="4105004">}</span><span class="op" id="4105005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105008">{</span><span class="ident" id="4105009">ExtKeyUsageTimeStamping</span><span class="op" id="4105032">,</span>&nbsp;<span class="ident" id="4105034">oidExtKeyUsageTimeStamping</span><span class="op" id="4105060">}</span><span class="op" id="4105061">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105064">{</span><span class="ident" id="4105065">ExtKeyUsageOCSPSigning</span><span class="op" id="4105087">,</span>&nbsp;<span class="ident" id="4105089">oidExtKeyUsageOCSPSigning</span><span class="op" id="4105114">}</span><span class="op" id="4105115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105118">{</span><span class="ident" id="4105119">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4105156">,</span>&nbsp;<span class="ident" id="4105158">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4105198">}</span><span class="op" id="4105199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105202">{</span><span class="ident" id="4105203">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4105239">,</span>&nbsp;<span class="ident" id="4105241">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4105280">}</span><span class="op" id="4105281">,</span><br>
<span class="lineno"></span><span class="op" id="4105283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4105286">func</span>&nbsp;<span class="ident" id="4105291">extKeyUsageFromOID</span><span class="op" id="4105309">(</span><span class="ident" id="4105310">oid</span>&nbsp;<span class="ident" id="4105314">asn1</span><span class="op" id="4105318">.</span><span class="ident" id="4105319">ObjectIdentifier</span><span class="op" id="4105335">)</span>&nbsp;<span class="op" id="4105337">(</span><span class="ident" id="4105338">eku</span>&nbsp;<span class="ident" id="4105342">ExtKeyUsage</span><span class="op" id="4105353">,</span>&nbsp;<span class="ident" id="4105355">ok</span>&nbsp;<span class="builtintype" id="4105358">bool</span><span class="op" id="4105362">)</span>&nbsp;<span class="op" id="4105364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105367">for</span>&nbsp;<span class="ident" id="4105371">_</span><span class="op" id="4105372">,</span>&nbsp;<span class="ident" id="4105374">pair</span>&nbsp;<span class="op" id="4105379">:=</span>&nbsp;<span class="keyword" id="4105382">range</span>&nbsp;<span class="ident" id="4105388">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4105404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105408">if</span>&nbsp;<span class="ident" id="4105411">oid</span><span class="op" id="4105414">.</span><span class="ident" id="4105415">Equal</span><span class="op" id="4105420">(</span><span class="ident" id="4105421">pair</span><span class="op" id="4105425">.</span><span class="ident" id="4105426">oid</span><span class="op" id="4105429">)</span>&nbsp;<span class="op" id="4105431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105436">return</span>&nbsp;<span class="ident" id="4105443">pair</span><span class="op" id="4105447">.</span><span class="ident" id="4105448">extKeyUsage</span><span class="op" id="4105459">,</span>&nbsp;<span class="ident" id="4105461">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105468">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105474">return</span><br>
<span class="lineno"></span><span class="op" id="4105481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4105484">func</span>&nbsp;<span class="ident" id="4105489">oidFromExtKeyUsage</span><span class="op" id="4105507">(</span><span class="ident" id="4105508">eku</span>&nbsp;<span class="ident" id="4105512">ExtKeyUsage</span><span class="op" id="4105523">)</span>&nbsp;<span class="op" id="4105525">(</span><span class="ident" id="4105526">oid</span>&nbsp;<span class="ident" id="4105530">asn1</span><span class="op" id="4105534">.</span><span class="ident" id="4105535">ObjectIdentifier</span><span class="op" id="4105551">,</span>&nbsp;<span class="ident" id="4105553">ok</span>&nbsp;<span class="builtintype" id="4105556">bool</span><span class="op" id="4105560">)</span>&nbsp;<span class="op" id="4105562">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105565">for</span>&nbsp;<span class="ident" id="4105569">_</span><span class="op" id="4105570">,</span>&nbsp;<span class="ident" id="4105572">pair</span>&nbsp;<span class="op" id="4105577">:=</span>&nbsp;<span class="keyword" id="4105580">range</span>&nbsp;<span class="ident" id="4105586">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4105602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105606">if</span>&nbsp;<span class="ident" id="4105609">eku</span>&nbsp;<span class="op" id="4105613">==</span>&nbsp;<span class="ident" id="4105616">pair</span><span class="op" id="4105620">.</span><span class="ident" id="4105621">extKeyUsage</span>&nbsp;<span class="op" id="4105633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105638">return</span>&nbsp;<span class="ident" id="4105645">pair</span><span class="op" id="4105649">.</span><span class="ident" id="4105650">oid</span><span class="op" id="4105653">,</span>&nbsp;<span class="ident" id="4105655">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105665">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105668">return</span><br>
<span class="lineno"></span><span class="op" id="4105675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4105678">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4105728">type</span>&nbsp;<span class="ident" id="4105733">Certificate</span>&nbsp;<span class="keyword" id="4105745">struct</span>&nbsp;<span class="op" id="4105752">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105755">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105779">[</span><span class="op" id="4105780">]</span><span class="builtintype" id="4105781">byte</span>&nbsp;<span class="comment" id="4105786">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105867">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105891">[</span><span class="op" id="4105892">]</span><span class="builtintype" id="4105893">byte</span>&nbsp;<span class="comment" id="4105898">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105945">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4105969">[</span><span class="op" id="4105970">]</span><span class="builtintype" id="4105971">byte</span>&nbsp;<span class="comment" id="4105976">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106014">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106038">[</span><span class="op" id="4106039">]</span><span class="builtintype" id="4106040">byte</span>&nbsp;<span class="comment" id="4106045">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106069">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106093">[</span><span class="op" id="4106094">]</span><span class="builtintype" id="4106095">byte</span>&nbsp;<span class="comment" id="4106100">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106124">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106143">[</span><span class="op" id="4106144">]</span><span class="builtintype" id="4106145">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106151">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4106170">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106191">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4106210">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106230">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106249">interface</span><span class="op" id="4106258">{</span><span class="op" id="4106259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106263">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4106283">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106288">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106308">*</span><span class="ident" id="4106309">big</span><span class="op" id="4106312">.</span><span class="ident" id="4106313">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106318">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106338">pkix</span><span class="op" id="4106342">.</span><span class="ident" id="4106343">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106349">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106369">pkix</span><span class="op" id="4106373">.</span><span class="ident" id="4106374">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106380">NotBefore</span><span class="op" id="4106389">,</span>&nbsp;<span class="ident" id="4106391">NotAfter</span>&nbsp;<span class="ident" id="4106400">time</span><span class="op" id="4106404">.</span><span class="ident" id="4106405">Time</span>&nbsp;<span class="comment" id="4106410">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106431">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106451">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106462">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106535">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106604">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106677">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106720">Extensions</span>&nbsp;<span class="op" id="4106731">[</span><span class="op" id="4106732">]</span><span class="ident" id="4106733">pkix</span><span class="op" id="4106737">.</span><span class="ident" id="4106738">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106750">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106818">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106888">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106961">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107031">ExtraExtensions</span>&nbsp;<span class="op" id="4107047">[</span><span class="op" id="4107048">]</span><span class="ident" id="4107049">pkix</span><span class="op" id="4107053">.</span><span class="ident" id="4107054">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107066">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107085">[</span><span class="op" id="4107086">]</span><span class="ident" id="4107087">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4107109">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107146">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4107165">[</span><span class="op" id="4107166">]</span><span class="ident" id="4107167">asn1</span><span class="op" id="4107171">.</span><span class="ident" id="4107172">ObjectIdentifier</span>&nbsp;<span class="comment" id="4107189">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107251">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4107273">bool</span>&nbsp;<span class="comment" id="4107278">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107326">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107348">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107354">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107376">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107381">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107447">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107520">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107590">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107609">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4107624">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107631">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4107646">[</span><span class="op" id="4107647">]</span><span class="builtintype" id="4107648">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107654">AuthorityKeyId</span>&nbsp;<span class="op" id="4107669">[</span><span class="op" id="4107670">]</span><span class="builtintype" id="4107671">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107678">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107731">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107753">[</span><span class="op" id="4107754">]</span><span class="builtintype" id="4107755">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107763">IssuingCertificateURL</span>&nbsp;<span class="op" id="4107785">[</span><span class="op" id="4107786">]</span><span class="builtintype" id="4107787">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107796">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107830">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107845">[</span><span class="op" id="4107846">]</span><span class="builtintype" id="4107847">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107855">EmailAddresses</span>&nbsp;<span class="op" id="4107870">[</span><span class="op" id="4107871">]</span><span class="builtintype" id="4107872">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107880">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107895">[</span><span class="op" id="4107896">]</span><span class="ident" id="4107897">net</span><span class="op" id="4107900">.</span><span class="ident" id="4107901">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107906">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107927">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4107955">bool</span>&nbsp;<span class="comment" id="4107960">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108019">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108047">[</span><span class="op" id="4108048">]</span><span class="builtintype" id="4108049">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4108058">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108086">CRLDistributionPoints</span>&nbsp;<span class="op" id="4108108">[</span><span class="op" id="4108109">]</span><span class="builtintype" id="4108110">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4108119">PolicyIdentifiers</span>&nbsp;<span class="op" id="4108137">[</span><span class="op" id="4108138">]</span><span class="ident" id="4108139">asn1</span><span class="op" id="4108143">.</span><span class="ident" id="4108144">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4108161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4108164">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4108244">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4108303">var</span>&nbsp;<span class="ident" id="4108307">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4108331">=</span>&nbsp;<span class="ident" id="4108333">errors</span><span class="op" id="4108339">.</span><span class="ident" id="4108340">New</span><span class="op" id="4108343">(</span><span class="string" id="4108344">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4108400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4108403">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4108482">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4108562">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4108590">type</span>&nbsp;<span class="ident" id="4108595">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4108620">struct</span><span class="op" id="4108626">{</span><span class="op" id="4108627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4108630">func</span>&nbsp;<span class="op" id="4108635">(</span><span class="ident" id="4108636">ConstraintViolationError</span><span class="op" id="4108660">)</span>&nbsp;<span class="ident" id="4108662">Error</span><span class="op" id="4108667">(</span><span class="op" id="4108668">)</span>&nbsp;<span class="builtintype" id="4108670">string</span>&nbsp;<span class="op" id="4108677">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4108680">return</span>&nbsp;<span class="string" id="4108687">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4108770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4108773">func</span>&nbsp;<span class="op" id="4108778">(</span><span class="ident" id="4108779">c</span>&nbsp;<span class="op" id="4108781">*</span><span class="ident" id="4108782">Certificate</span><span class="op" id="4108793">)</span>&nbsp;<span class="ident" id="4108795">Equal</span><span class="op" id="4108800">(</span><span class="ident" id="4108801">other</span>&nbsp;<span class="op" id="4108807">*</span><span class="ident" id="4108808">Certificate</span><span class="op" id="4108819">)</span>&nbsp;<span class="builtintype" id="4108821">bool</span>&nbsp;<span class="op" id="4108826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4108829">return</span>&nbsp;<span class="ident" id="4108836">bytes</span><span class="op" id="4108841">.</span><span class="ident" id="4108842">Equal</span><span class="op" id="4108847">(</span><span class="ident" id="4108848">c</span><span class="op" id="4108849">.</span><span class="ident" id="4108850">Raw</span><span class="op" id="4108853">,</span>&nbsp;<span class="ident" id="4108855">other</span><span class="op" id="4108860">.</span><span class="ident" id="4108861">Raw</span><span class="op" id="4108864">)</span><br>
<span class="lineno">540</span><span class="op" id="4108866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4108869">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4108941">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4109021">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4109043">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4109118">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4109161">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4109227">//</span><br>
<span class="lineno"></span><span class="comment" id="4109230">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4109302">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4109317">var</span>&nbsp;<span class="ident" id="4109321">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4109339">=</span>&nbsp;<span class="op" id="4109341">[</span><span class="op" id="4109342">]</span><span class="builtintype" id="4109343">byte</span><span class="op" id="4109347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109350">0x30</span><span class="op" id="4109354">,</span>&nbsp;<span class="num" id="4109356">0x82</span><span class="op" id="4109360">,</span>&nbsp;<span class="num" id="4109362">0x01</span><span class="op" id="4109366">,</span>&nbsp;<span class="num" id="4109368">0x22</span><span class="op" id="4109372">,</span>&nbsp;<span class="num" id="4109374">0x30</span><span class="op" id="4109378">,</span>&nbsp;<span class="num" id="4109380">0x0d</span><span class="op" id="4109384">,</span>&nbsp;<span class="num" id="4109386">0x06</span><span class="op" id="4109390">,</span>&nbsp;<span class="num" id="4109392">0x09</span><span class="op" id="4109396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109399">0x2a</span><span class="op" id="4109403">,</span>&nbsp;<span class="num" id="4109405">0x86</span><span class="op" id="4109409">,</span>&nbsp;<span class="num" id="4109411">0x48</span><span class="op" id="4109415">,</span>&nbsp;<span class="num" id="4109417">0x86</span><span class="op" id="4109421">,</span>&nbsp;<span class="num" id="4109423">0xf7</span><span class="op" id="4109427">,</span>&nbsp;<span class="num" id="4109429">0x0d</span><span class="op" id="4109433">,</span>&nbsp;<span class="num" id="4109435">0x01</span><span class="op" id="4109439">,</span>&nbsp;<span class="num" id="4109441">0x01</span><span class="op" id="4109445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109448">0x01</span><span class="op" id="4109452">,</span>&nbsp;<span class="num" id="4109454">0x05</span><span class="op" id="4109458">,</span>&nbsp;<span class="num" id="4109460">0x00</span><span class="op" id="4109464">,</span>&nbsp;<span class="num" id="4109466">0x03</span><span class="op" id="4109470">,</span>&nbsp;<span class="num" id="4109472">0x82</span><span class="op" id="4109476">,</span>&nbsp;<span class="num" id="4109478">0x01</span><span class="op" id="4109482">,</span>&nbsp;<span class="num" id="4109484">0x0f</span><span class="op" id="4109488">,</span>&nbsp;<span class="num" id="4109490">0x00</span><span class="op" id="4109494">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109497">0x30</span><span class="op" id="4109501">,</span>&nbsp;<span class="num" id="4109503">0x82</span><span class="op" id="4109507">,</span>&nbsp;<span class="num" id="4109509">0x01</span><span class="op" id="4109513">,</span>&nbsp;<span class="num" id="4109515">0x0a</span><span class="op" id="4109519">,</span>&nbsp;<span class="num" id="4109521">0x02</span><span class="op" id="4109525">,</span>&nbsp;<span class="num" id="4109527">0x82</span><span class="op" id="4109531">,</span>&nbsp;<span class="num" id="4109533">0x01</span><span class="op" id="4109537">,</span>&nbsp;<span class="num" id="4109539">0x01</span><span class="op" id="4109543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109546">0x00</span><span class="op" id="4109550">,</span>&nbsp;<span class="num" id="4109552">0x97</span><span class="op" id="4109556">,</span>&nbsp;<span class="num" id="4109558">0xa3</span><span class="op" id="4109562">,</span>&nbsp;<span class="num" id="4109564">0x2d</span><span class="op" id="4109568">,</span>&nbsp;<span class="num" id="4109570">0x3c</span><span class="op" id="4109574">,</span>&nbsp;<span class="num" id="4109576">0x9e</span><span class="op" id="4109580">,</span>&nbsp;<span class="num" id="4109582">0xde</span><span class="op" id="4109586">,</span>&nbsp;<span class="num" id="4109588">0x05</span><span class="op" id="4109592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109595">0xda</span><span class="op" id="4109599">,</span>&nbsp;<span class="num" id="4109601">0x13</span><span class="op" id="4109605">,</span>&nbsp;<span class="num" id="4109607">0xc2</span><span class="op" id="4109611">,</span>&nbsp;<span class="num" id="4109613">0x11</span><span class="op" id="4109617">,</span>&nbsp;<span class="num" id="4109619">0x8d</span><span class="op" id="4109623">,</span>&nbsp;<span class="num" id="4109625">0x9d</span><span class="op" id="4109629">,</span>&nbsp;<span class="num" id="4109631">0x8e</span><span class="op" id="4109635">,</span>&nbsp;<span class="num" id="4109637">0xe3</span><span class="op" id="4109641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109644">0x7f</span><span class="op" id="4109648">,</span>&nbsp;<span class="num" id="4109650">0xc7</span><span class="op" id="4109654">,</span>&nbsp;<span class="num" id="4109656">0x4b</span><span class="op" id="4109660">,</span>&nbsp;<span class="num" id="4109662">0x7e</span><span class="op" id="4109666">,</span>&nbsp;<span class="num" id="4109668">0x5a</span><span class="op" id="4109672">,</span>&nbsp;<span class="num" id="4109674">0x9f</span><span class="op" id="4109678">,</span>&nbsp;<span class="num" id="4109680">0xb3</span><span class="op" id="4109684">,</span>&nbsp;<span class="num" id="4109686">0xff</span><span class="op" id="4109690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109693">0x62</span><span class="op" id="4109697">,</span>&nbsp;<span class="num" id="4109699">0xab</span><span class="op" id="4109703">,</span>&nbsp;<span class="num" id="4109705">0x73</span><span class="op" id="4109709">,</span>&nbsp;<span class="num" id="4109711">0xc8</span><span class="op" id="4109715">,</span>&nbsp;<span class="num" id="4109717">0x28</span><span class="op" id="4109721">,</span>&nbsp;<span class="num" id="4109723">0x6b</span><span class="op" id="4109727">,</span>&nbsp;<span class="num" id="4109729">0xba</span><span class="op" id="4109733">,</span>&nbsp;<span class="num" id="4109735">0x10</span><span class="op" id="4109739">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109742">0x64</span><span class="op" id="4109746">,</span>&nbsp;<span class="num" id="4109748">0x82</span><span class="op" id="4109752">,</span>&nbsp;<span class="num" id="4109754">0x87</span><span class="op" id="4109758">,</span>&nbsp;<span class="num" id="4109760">0x13</span><span class="op" id="4109764">,</span>&nbsp;<span class="num" id="4109766">0xcd</span><span class="op" id="4109770">,</span>&nbsp;<span class="num" id="4109772">0x57</span><span class="op" id="4109776">,</span>&nbsp;<span class="num" id="4109778">0x18</span><span class="op" id="4109782">,</span>&nbsp;<span class="num" id="4109784">0xff</span><span class="op" id="4109788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109791">0x28</span><span class="op" id="4109795">,</span>&nbsp;<span class="num" id="4109797">0xce</span><span class="op" id="4109801">,</span>&nbsp;<span class="num" id="4109803">0xc0</span><span class="op" id="4109807">,</span>&nbsp;<span class="num" id="4109809">0xe6</span><span class="op" id="4109813">,</span>&nbsp;<span class="num" id="4109815">0x0e</span><span class="op" id="4109819">,</span>&nbsp;<span class="num" id="4109821">0x06</span><span class="op" id="4109825">,</span>&nbsp;<span class="num" id="4109827">0x91</span><span class="op" id="4109831">,</span>&nbsp;<span class="num" id="4109833">0x50</span><span class="op" id="4109837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109840">0x29</span><span class="op" id="4109844">,</span>&nbsp;<span class="num" id="4109846">0x83</span><span class="op" id="4109850">,</span>&nbsp;<span class="num" id="4109852">0xd1</span><span class="op" id="4109856">,</span>&nbsp;<span class="num" id="4109858">0xf2</span><span class="op" id="4109862">,</span>&nbsp;<span class="num" id="4109864">0xc3</span><span class="op" id="4109868">,</span>&nbsp;<span class="num" id="4109870">0x2a</span><span class="op" id="4109874">,</span>&nbsp;<span class="num" id="4109876">0xdb</span><span class="op" id="4109880">,</span>&nbsp;<span class="num" id="4109882">0xd8</span><span class="op" id="4109886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109889">0xdb</span><span class="op" id="4109893">,</span>&nbsp;<span class="num" id="4109895">0x4e</span><span class="op" id="4109899">,</span>&nbsp;<span class="num" id="4109901">0x04</span><span class="op" id="4109905">,</span>&nbsp;<span class="num" id="4109907">0xcc</span><span class="op" id="4109911">,</span>&nbsp;<span class="num" id="4109913">0x00</span><span class="op" id="4109917">,</span>&nbsp;<span class="num" id="4109919">0xeb</span><span class="op" id="4109923">,</span>&nbsp;<span class="num" id="4109925">0x8b</span><span class="op" id="4109929">,</span>&nbsp;<span class="num" id="4109931">0xb6</span><span class="op" id="4109935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109938">0x96</span><span class="op" id="4109942">,</span>&nbsp;<span class="num" id="4109944">0xdc</span><span class="op" id="4109948">,</span>&nbsp;<span class="num" id="4109950">0xbc</span><span class="op" id="4109954">,</span>&nbsp;<span class="num" id="4109956">0xaa</span><span class="op" id="4109960">,</span>&nbsp;<span class="num" id="4109962">0xfa</span><span class="op" id="4109966">,</span>&nbsp;<span class="num" id="4109968">0x52</span><span class="op" id="4109972">,</span>&nbsp;<span class="num" id="4109974">0x77</span><span class="op" id="4109978">,</span>&nbsp;<span class="num" id="4109980">0x04</span><span class="op" id="4109984">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4109987">0xc1</span><span class="op" id="4109991">,</span>&nbsp;<span class="num" id="4109993">0xdb</span><span class="op" id="4109997">,</span>&nbsp;<span class="num" id="4109999">0x19</span><span class="op" id="4110003">,</span>&nbsp;<span class="num" id="4110005">0xe4</span><span class="op" id="4110009">,</span>&nbsp;<span class="num" id="4110011">0xae</span><span class="op" id="4110015">,</span>&nbsp;<span class="num" id="4110017">0x9c</span><span class="op" id="4110021">,</span>&nbsp;<span class="num" id="4110023">0xfd</span><span class="op" id="4110027">,</span>&nbsp;<span class="num" id="4110029">0x3c</span><span class="op" id="4110033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110036">0x8b</span><span class="op" id="4110040">,</span>&nbsp;<span class="num" id="4110042">0x03</span><span class="op" id="4110046">,</span>&nbsp;<span class="num" id="4110048">0xef</span><span class="op" id="4110052">,</span>&nbsp;<span class="num" id="4110054">0x4d</span><span class="op" id="4110058">,</span>&nbsp;<span class="num" id="4110060">0xbc</span><span class="op" id="4110064">,</span>&nbsp;<span class="num" id="4110066">0x1a</span><span class="op" id="4110070">,</span>&nbsp;<span class="num" id="4110072">0x03</span><span class="op" id="4110076">,</span>&nbsp;<span class="num" id="4110078">0x65</span><span class="op" id="4110082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110085">0xf9</span><span class="op" id="4110089">,</span>&nbsp;<span class="num" id="4110091">0xc1</span><span class="op" id="4110095">,</span>&nbsp;<span class="num" id="4110097">0xb1</span><span class="op" id="4110101">,</span>&nbsp;<span class="num" id="4110103">0x3f</span><span class="op" id="4110107">,</span>&nbsp;<span class="num" id="4110109">0x72</span><span class="op" id="4110113">,</span>&nbsp;<span class="num" id="4110115">0x86</span><span class="op" id="4110119">,</span>&nbsp;<span class="num" id="4110121">0xf2</span><span class="op" id="4110125">,</span>&nbsp;<span class="num" id="4110127">0x38</span><span class="op" id="4110131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110134">0xaa</span><span class="op" id="4110138">,</span>&nbsp;<span class="num" id="4110140">0x19</span><span class="op" id="4110144">,</span>&nbsp;<span class="num" id="4110146">0xae</span><span class="op" id="4110150">,</span>&nbsp;<span class="num" id="4110152">0x10</span><span class="op" id="4110156">,</span>&nbsp;<span class="num" id="4110158">0x88</span><span class="op" id="4110162">,</span>&nbsp;<span class="num" id="4110164">0x78</span><span class="op" id="4110168">,</span>&nbsp;<span class="num" id="4110170">0x28</span><span class="op" id="4110174">,</span>&nbsp;<span class="num" id="4110176">0xda</span><span class="op" id="4110180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110183">0x75</span><span class="op" id="4110187">,</span>&nbsp;<span class="num" id="4110189">0xc3</span><span class="op" id="4110193">,</span>&nbsp;<span class="num" id="4110195">0x3d</span><span class="op" id="4110199">,</span>&nbsp;<span class="num" id="4110201">0x02</span><span class="op" id="4110205">,</span>&nbsp;<span class="num" id="4110207">0x82</span><span class="op" id="4110211">,</span>&nbsp;<span class="num" id="4110213">0x02</span><span class="op" id="4110217">,</span>&nbsp;<span class="num" id="4110219">0x9c</span><span class="op" id="4110223">,</span>&nbsp;<span class="num" id="4110225">0xb9</span><span class="op" id="4110229">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110232">0xc1</span><span class="op" id="4110236">,</span>&nbsp;<span class="num" id="4110238">0x65</span><span class="op" id="4110242">,</span>&nbsp;<span class="num" id="4110244">0x77</span><span class="op" id="4110248">,</span>&nbsp;<span class="num" id="4110250">0x76</span><span class="op" id="4110254">,</span>&nbsp;<span class="num" id="4110256">0x24</span><span class="op" id="4110260">,</span>&nbsp;<span class="num" id="4110262">0x4c</span><span class="op" id="4110266">,</span>&nbsp;<span class="num" id="4110268">0x98</span><span class="op" id="4110272">,</span>&nbsp;<span class="num" id="4110274">0xf7</span><span class="op" id="4110278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110281">0x6d</span><span class="op" id="4110285">,</span>&nbsp;<span class="num" id="4110287">0x31</span><span class="op" id="4110291">,</span>&nbsp;<span class="num" id="4110293">0x38</span><span class="op" id="4110297">,</span>&nbsp;<span class="num" id="4110299">0xfb</span><span class="op" id="4110303">,</span>&nbsp;<span class="num" id="4110305">0xdb</span><span class="op" id="4110309">,</span>&nbsp;<span class="num" id="4110311">0xfe</span><span class="op" id="4110315">,</span>&nbsp;<span class="num" id="4110317">0xdb</span><span class="op" id="4110321">,</span>&nbsp;<span class="num" id="4110323">0x37</span><span class="op" id="4110327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110330">0x02</span><span class="op" id="4110334">,</span>&nbsp;<span class="num" id="4110336">0x76</span><span class="op" id="4110340">,</span>&nbsp;<span class="num" id="4110342">0xa1</span><span class="op" id="4110346">,</span>&nbsp;<span class="num" id="4110348">0x18</span><span class="op" id="4110352">,</span>&nbsp;<span class="num" id="4110354">0x97</span><span class="op" id="4110358">,</span>&nbsp;<span class="num" id="4110360">0xa6</span><span class="op" id="4110364">,</span>&nbsp;<span class="num" id="4110366">0xcc</span><span class="op" id="4110370">,</span>&nbsp;<span class="num" id="4110372">0xde</span><span class="op" id="4110376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110379">0x20</span><span class="op" id="4110383">,</span>&nbsp;<span class="num" id="4110385">0x09</span><span class="op" id="4110389">,</span>&nbsp;<span class="num" id="4110391">0x49</span><span class="op" id="4110395">,</span>&nbsp;<span class="num" id="4110397">0x36</span><span class="op" id="4110401">,</span>&nbsp;<span class="num" id="4110403">0x24</span><span class="op" id="4110407">,</span>&nbsp;<span class="num" id="4110409">0x69</span><span class="op" id="4110413">,</span>&nbsp;<span class="num" id="4110415">0x42</span><span class="op" id="4110419">,</span>&nbsp;<span class="num" id="4110421">0xf6</span><span class="op" id="4110425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110428">0xe4</span><span class="op" id="4110432">,</span>&nbsp;<span class="num" id="4110434">0x37</span><span class="op" id="4110438">,</span>&nbsp;<span class="num" id="4110440">0x62</span><span class="op" id="4110444">,</span>&nbsp;<span class="num" id="4110446">0xf1</span><span class="op" id="4110450">,</span>&nbsp;<span class="num" id="4110452">0x59</span><span class="op" id="4110456">,</span>&nbsp;<span class="num" id="4110458">0x6d</span><span class="op" id="4110462">,</span>&nbsp;<span class="num" id="4110464">0xa9</span><span class="op" id="4110468">,</span>&nbsp;<span class="num" id="4110470">0x3c</span><span class="op" id="4110474">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110477">0xed</span><span class="op" id="4110481">,</span>&nbsp;<span class="num" id="4110483">0x34</span><span class="op" id="4110487">,</span>&nbsp;<span class="num" id="4110489">0x9c</span><span class="op" id="4110493">,</span>&nbsp;<span class="num" id="4110495">0xa3</span><span class="op" id="4110499">,</span>&nbsp;<span class="num" id="4110501">0x8e</span><span class="op" id="4110505">,</span>&nbsp;<span class="num" id="4110507">0xdb</span><span class="op" id="4110511">,</span>&nbsp;<span class="num" id="4110513">0xdc</span><span class="op" id="4110517">,</span>&nbsp;<span class="num" id="4110519">0x3a</span><span class="op" id="4110523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110526">0xd7</span><span class="op" id="4110530">,</span>&nbsp;<span class="num" id="4110532">0xf7</span><span class="op" id="4110536">,</span>&nbsp;<span class="num" id="4110538">0x0a</span><span class="op" id="4110542">,</span>&nbsp;<span class="num" id="4110544">0x6f</span><span class="op" id="4110548">,</span>&nbsp;<span class="num" id="4110550">0xef</span><span class="op" id="4110554">,</span>&nbsp;<span class="num" id="4110556">0x2e</span><span class="op" id="4110560">,</span>&nbsp;<span class="num" id="4110562">0xd8</span><span class="op" id="4110566">,</span>&nbsp;<span class="num" id="4110568">0xd5</span><span class="op" id="4110572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110575">0x93</span><span class="op" id="4110579">,</span>&nbsp;<span class="num" id="4110581">0x5a</span><span class="op" id="4110585">,</span>&nbsp;<span class="num" id="4110587">0x7a</span><span class="op" id="4110591">,</span>&nbsp;<span class="num" id="4110593">0xed</span><span class="op" id="4110597">,</span>&nbsp;<span class="num" id="4110599">0x08</span><span class="op" id="4110603">,</span>&nbsp;<span class="num" id="4110605">0x49</span><span class="op" id="4110609">,</span>&nbsp;<span class="num" id="4110611">0x68</span><span class="op" id="4110615">,</span>&nbsp;<span class="num" id="4110617">0xe2</span><span class="op" id="4110621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110624">0x41</span><span class="op" id="4110628">,</span>&nbsp;<span class="num" id="4110630">0xe3</span><span class="op" id="4110634">,</span>&nbsp;<span class="num" id="4110636">0x5a</span><span class="op" id="4110640">,</span>&nbsp;<span class="num" id="4110642">0x90</span><span class="op" id="4110646">,</span>&nbsp;<span class="num" id="4110648">0xc1</span><span class="op" id="4110652">,</span>&nbsp;<span class="num" id="4110654">0x86</span><span class="op" id="4110658">,</span>&nbsp;<span class="num" id="4110660">0x55</span><span class="op" id="4110664">,</span>&nbsp;<span class="num" id="4110666">0xfc</span><span class="op" id="4110670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110673">0x51</span><span class="op" id="4110677">,</span>&nbsp;<span class="num" id="4110679">0x43</span><span class="op" id="4110683">,</span>&nbsp;<span class="num" id="4110685">0x9d</span><span class="op" id="4110689">,</span>&nbsp;<span class="num" id="4110691">0xe0</span><span class="op" id="4110695">,</span>&nbsp;<span class="num" id="4110697">0xb2</span><span class="op" id="4110701">,</span>&nbsp;<span class="num" id="4110703">0xc4</span><span class="op" id="4110707">,</span>&nbsp;<span class="num" id="4110709">0x67</span><span class="op" id="4110713">,</span>&nbsp;<span class="num" id="4110715">0xb4</span><span class="op" id="4110719">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110722">0xcb</span><span class="op" id="4110726">,</span>&nbsp;<span class="num" id="4110728">0x32</span><span class="op" id="4110732">,</span>&nbsp;<span class="num" id="4110734">0x31</span><span class="op" id="4110738">,</span>&nbsp;<span class="num" id="4110740">0x25</span><span class="op" id="4110744">,</span>&nbsp;<span class="num" id="4110746">0xf0</span><span class="op" id="4110750">,</span>&nbsp;<span class="num" id="4110752">0x54</span><span class="op" id="4110756">,</span>&nbsp;<span class="num" id="4110758">0x9f</span><span class="op" id="4110762">,</span>&nbsp;<span class="num" id="4110764">0x4b</span><span class="op" id="4110768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110771">0xd1</span><span class="op" id="4110775">,</span>&nbsp;<span class="num" id="4110777">0x6f</span><span class="op" id="4110781">,</span>&nbsp;<span class="num" id="4110783">0xdb</span><span class="op" id="4110787">,</span>&nbsp;<span class="num" id="4110789">0xd4</span><span class="op" id="4110793">,</span>&nbsp;<span class="num" id="4110795">0xdd</span><span class="op" id="4110799">,</span>&nbsp;<span class="num" id="4110801">0xfc</span><span class="op" id="4110805">,</span>&nbsp;<span class="num" id="4110807">0xaf</span><span class="op" id="4110811">,</span>&nbsp;<span class="num" id="4110813">0x5e</span><span class="op" id="4110817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110820">0x6c</span><span class="op" id="4110824">,</span>&nbsp;<span class="num" id="4110826">0x78</span><span class="op" id="4110830">,</span>&nbsp;<span class="num" id="4110832">0x90</span><span class="op" id="4110836">,</span>&nbsp;<span class="num" id="4110838">0x95</span><span class="op" id="4110842">,</span>&nbsp;<span class="num" id="4110844">0xde</span><span class="op" id="4110848">,</span>&nbsp;<span class="num" id="4110850">0xca</span><span class="op" id="4110854">,</span>&nbsp;<span class="num" id="4110856">0x3a</span><span class="op" id="4110860">,</span>&nbsp;<span class="num" id="4110862">0x48</span><span class="op" id="4110866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110869">0xb9</span><span class="op" id="4110873">,</span>&nbsp;<span class="num" id="4110875">0x79</span><span class="op" id="4110879">,</span>&nbsp;<span class="num" id="4110881">0x3c</span><span class="op" id="4110885">,</span>&nbsp;<span class="num" id="4110887">0x9b</span><span class="op" id="4110891">,</span>&nbsp;<span class="num" id="4110893">0x19</span><span class="op" id="4110897">,</span>&nbsp;<span class="num" id="4110899">0xd6</span><span class="op" id="4110903">,</span>&nbsp;<span class="num" id="4110905">0x75</span><span class="op" id="4110909">,</span>&nbsp;<span class="num" id="4110911">0x05</span><span class="op" id="4110915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110918">0xa0</span><span class="op" id="4110922">,</span>&nbsp;<span class="num" id="4110924">0xf9</span><span class="op" id="4110928">,</span>&nbsp;<span class="num" id="4110930">0x88</span><span class="op" id="4110934">,</span>&nbsp;<span class="num" id="4110936">0xd7</span><span class="op" id="4110940">,</span>&nbsp;<span class="num" id="4110942">0xc1</span><span class="op" id="4110946">,</span>&nbsp;<span class="num" id="4110948">0xe8</span><span class="op" id="4110952">,</span>&nbsp;<span class="num" id="4110954">0xa5</span><span class="op" id="4110958">,</span>&nbsp;<span class="num" id="4110960">0x09</span><span class="op" id="4110964">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4110967">0xe4</span><span class="op" id="4110971">,</span>&nbsp;<span class="num" id="4110973">0x1a</span><span class="op" id="4110977">,</span>&nbsp;<span class="num" id="4110979">0x15</span><span class="op" id="4110983">,</span>&nbsp;<span class="num" id="4110985">0xdc</span><span class="op" id="4110989">,</span>&nbsp;<span class="num" id="4110991">0x87</span><span class="op" id="4110995">,</span>&nbsp;<span class="num" id="4110997">0x23</span><span class="op" id="4111001">,</span>&nbsp;<span class="num" id="4111003">0xaa</span><span class="op" id="4111007">,</span>&nbsp;<span class="num" id="4111009">0xb2</span><span class="op" id="4111013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4111016">0x75</span><span class="op" id="4111020">,</span>&nbsp;<span class="num" id="4111022">0x8c</span><span class="op" id="4111026">,</span>&nbsp;<span class="num" id="4111028">0x63</span><span class="op" id="4111032">,</span>&nbsp;<span class="num" id="4111034">0x25</span><span class="op" id="4111038">,</span>&nbsp;<span class="num" id="4111040">0x87</span><span class="op" id="4111044">,</span>&nbsp;<span class="num" id="4111046">0xd8</span><span class="op" id="4111050">,</span>&nbsp;<span class="num" id="4111052">0xf8</span><span class="op" id="4111056">,</span>&nbsp;<span class="num" id="4111058">0x3d</span><span class="op" id="4111062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4111065">0xa6</span><span class="op" id="4111069">,</span>&nbsp;<span class="num" id="4111071">0xc2</span><span class="op" id="4111075">,</span>&nbsp;<span class="num" id="4111077">0xcc</span><span class="op" id="4111081">,</span>&nbsp;<span class="num" id="4111083">0x66</span><span class="op" id="4111087">,</span>&nbsp;<span class="num" id="4111089">0xff</span><span class="op" id="4111093">,</span>&nbsp;<span class="num" id="4111095">0xa5</span><span class="op" id="4111099">,</span>&nbsp;<span class="num" id="4111101">0x66</span><span class="op" id="4111105">,</span>&nbsp;<span class="num" id="4111107">0x68</span><span class="op" id="4111111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4111114">0x55</span><span class="op" id="4111118">,</span>&nbsp;<span class="num" id="4111120">0x02</span><span class="op" id="4111124">,</span>&nbsp;<span class="num" id="4111126">0x03</span><span class="op" id="4111130">,</span>&nbsp;<span class="num" id="4111132">0x01</span><span class="op" id="4111136">,</span>&nbsp;<span class="num" id="4111138">0x00</span><span class="op" id="4111142">,</span>&nbsp;<span class="num" id="4111144">0x01</span><span class="op" id="4111148">,</span><br>
<span class="lineno"></span><span class="op" id="4111150">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4111153">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4111229">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4111245">func</span>&nbsp;<span class="op" id="4111250">(</span><span class="ident" id="4111251">c</span>&nbsp;<span class="op" id="4111253">*</span><span class="ident" id="4111254">Certificate</span><span class="op" id="4111265">)</span>&nbsp;<span class="ident" id="4111267">CheckSignatureFrom</span><span class="op" id="4111285">(</span><span class="ident" id="4111286">parent</span>&nbsp;<span class="op" id="4111293">*</span><span class="ident" id="4111294">Certificate</span><span class="op" id="4111305">)</span>&nbsp;<span class="op" id="4111307">(</span><span class="ident" id="4111308">err</span>&nbsp;<span class="builtintype" id="4111312">error</span><span class="op" id="4111317">)</span>&nbsp;<span class="op" id="4111319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111322">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111345">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111415">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111486">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111557">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4111586">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4111648">if</span>&nbsp;<span class="op" id="4111651">(</span><span class="ident" id="4111652">parent</span><span class="op" id="4111658">.</span><span class="ident" id="4111659">Version</span>&nbsp;<span class="op" id="4111667">==</span>&nbsp;<span class="num" id="4111670">3</span>&nbsp;<span class="op" id="4111672">&amp;&amp;</span>&nbsp;<span class="op" id="4111675">!</span><span class="ident" id="4111676">parent</span><span class="op" id="4111682">.</span><span class="ident" id="4111683">BasicConstraintsValid</span>&nbsp;<span class="op" id="4111705">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4111710">parent</span><span class="op" id="4111716">.</span><span class="ident" id="4111717">BasicConstraintsValid</span>&nbsp;<span class="op" id="4111739">&amp;&amp;</span>&nbsp;<span class="op" id="4111742">!</span><span class="ident" id="4111743">parent</span><span class="op" id="4111749">.</span><span class="ident" id="4111750">IsCA</span><span class="op" id="4111754">)</span>&nbsp;<span class="op" id="4111756">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111761">!</span><span class="ident" id="4111762">bytes</span><span class="op" id="4111767">.</span><span class="ident" id="4111768">Equal</span><span class="op" id="4111773">(</span><span class="ident" id="4111774">c</span><span class="op" id="4111775">.</span><span class="ident" id="4111776">RawSubjectPublicKeyInfo</span><span class="op" id="4111799">,</span>&nbsp;<span class="ident" id="4111801">entrustBrokenSPKI</span><span class="op" id="4111818">)</span>&nbsp;<span class="op" id="4111820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4111824">return</span>&nbsp;<span class="ident" id="4111831">ConstraintViolationError</span><span class="op" id="4111855">{</span><span class="op" id="4111856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111859">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4111863">if</span>&nbsp;<span class="ident" id="4111866">parent</span><span class="op" id="4111872">.</span><span class="ident" id="4111873">KeyUsage</span>&nbsp;<span class="op" id="4111882">!=</span>&nbsp;<span class="num" id="4111885">0</span>&nbsp;<span class="op" id="4111887">&amp;&amp;</span>&nbsp;<span class="ident" id="4111890">parent</span><span class="op" id="4111896">.</span><span class="ident" id="4111897">KeyUsage</span><span class="op" id="4111905">&amp;</span><span class="ident" id="4111906">KeyUsageCertSign</span>&nbsp;<span class="op" id="4111923">==</span>&nbsp;<span class="num" id="4111926">0</span>&nbsp;<span class="op" id="4111928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4111932">return</span>&nbsp;<span class="ident" id="4111939">ConstraintViolationError</span><span class="op" id="4111963">{</span><span class="op" id="4111964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4111967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4111971">if</span>&nbsp;<span class="ident" id="4111974">parent</span><span class="op" id="4111980">.</span><span class="ident" id="4111981">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4112000">==</span>&nbsp;<span class="ident" id="4112003">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4112029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112033">return</span>&nbsp;<span class="ident" id="4112040">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4112065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4112069">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112126">return</span>&nbsp;<span class="ident" id="4112133">parent</span><span class="op" id="4112139">.</span><span class="ident" id="4112140">CheckSignature</span><span class="op" id="4112154">(</span><span class="ident" id="4112155">c</span><span class="op" id="4112156">.</span><span class="ident" id="4112157">SignatureAlgorithm</span><span class="op" id="4112175">,</span>&nbsp;<span class="ident" id="4112177">c</span><span class="op" id="4112178">.</span><span class="ident" id="4112179">RawTBSCertificate</span><span class="op" id="4112196">,</span>&nbsp;<span class="ident" id="4112198">c</span><span class="op" id="4112199">.</span><span class="ident" id="4112200">Signature</span><span class="op" id="4112209">)</span><br>
<span class="lineno"></span><span class="op" id="4112211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112214">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4112294">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4112313">func</span>&nbsp;<span class="op" id="4112318">(</span><span class="ident" id="4112319">c</span>&nbsp;<span class="op" id="4112321">*</span><span class="ident" id="4112322">Certificate</span><span class="op" id="4112333">)</span>&nbsp;<span class="ident" id="4112335">CheckSignature</span><span class="op" id="4112349">(</span><span class="ident" id="4112350">algo</span>&nbsp;<span class="ident" id="4112355">SignatureAlgorithm</span><span class="op" id="4112373">,</span>&nbsp;<span class="ident" id="4112375">signed</span><span class="op" id="4112381">,</span>&nbsp;<span class="ident" id="4112383">signature</span>&nbsp;<span class="op" id="4112393">[</span><span class="op" id="4112394">]</span><span class="builtintype" id="4112395">byte</span><span class="op" id="4112399">)</span>&nbsp;<span class="op" id="4112401">(</span><span class="ident" id="4112402">err</span>&nbsp;<span class="builtintype" id="4112406">error</span><span class="op" id="4112411">)</span>&nbsp;<span class="op" id="4112413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112416">var</span>&nbsp;<span class="ident" id="4112420">hashType</span>&nbsp;<span class="ident" id="4112429">crypto</span><span class="op" id="4112435">.</span><span class="ident" id="4112436">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112443">switch</span>&nbsp;<span class="ident" id="4112450">algo</span>&nbsp;<span class="op" id="4112455">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112458">case</span>&nbsp;<span class="ident" id="4112463">SHA1WithRSA</span><span class="op" id="4112474">,</span>&nbsp;<span class="ident" id="4112476">DSAWithSHA1</span><span class="op" id="4112487">,</span>&nbsp;<span class="ident" id="4112489">ECDSAWithSHA1</span><span class="op" id="4112502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112506">hashType</span>&nbsp;<span class="op" id="4112515">=</span>&nbsp;<span class="ident" id="4112517">crypto</span><span class="op" id="4112523">.</span><span class="ident" id="4112524">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112530">case</span>&nbsp;<span class="ident" id="4112535">SHA256WithRSA</span><span class="op" id="4112548">,</span>&nbsp;<span class="ident" id="4112550">DSAWithSHA256</span><span class="op" id="4112563">,</span>&nbsp;<span class="ident" id="4112565">ECDSAWithSHA256</span><span class="op" id="4112580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112584">hashType</span>&nbsp;<span class="op" id="4112593">=</span>&nbsp;<span class="ident" id="4112595">crypto</span><span class="op" id="4112601">.</span><span class="ident" id="4112602">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112610">case</span>&nbsp;<span class="ident" id="4112615">SHA384WithRSA</span><span class="op" id="4112628">,</span>&nbsp;<span class="ident" id="4112630">ECDSAWithSHA384</span><span class="op" id="4112645">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112649">hashType</span>&nbsp;<span class="op" id="4112658">=</span>&nbsp;<span class="ident" id="4112660">crypto</span><span class="op" id="4112666">.</span><span class="ident" id="4112667">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112675">case</span>&nbsp;<span class="ident" id="4112680">SHA512WithRSA</span><span class="op" id="4112693">,</span>&nbsp;<span class="ident" id="4112695">ECDSAWithSHA512</span><span class="op" id="4112710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112714">hashType</span>&nbsp;<span class="op" id="4112723">=</span>&nbsp;<span class="ident" id="4112725">crypto</span><span class="op" id="4112731">.</span><span class="ident" id="4112732">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112740">default</span><span class="op" id="4112747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112751">return</span>&nbsp;<span class="ident" id="4112758">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4112783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112787">if</span>&nbsp;<span class="op" id="4112790">!</span><span class="ident" id="4112791">hashType</span><span class="op" id="4112799">.</span><span class="ident" id="4112800">Available</span><span class="op" id="4112809">(</span><span class="op" id="4112810">)</span>&nbsp;<span class="op" id="4112812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112816">return</span>&nbsp;<span class="ident" id="4112823">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4112848">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112851">h</span>&nbsp;<span class="op" id="4112853">:=</span>&nbsp;<span class="ident" id="4112856">hashType</span><span class="op" id="4112864">.</span><span class="ident" id="4112865">New</span><span class="op" id="4112868">(</span><span class="op" id="4112869">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112873">h</span><span class="op" id="4112874">.</span><span class="ident" id="4112875">Write</span><span class="op" id="4112880">(</span><span class="ident" id="4112881">signed</span><span class="op" id="4112887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4112890">digest</span>&nbsp;<span class="op" id="4112897">:=</span>&nbsp;<span class="ident" id="4112900">h</span><span class="op" id="4112901">.</span><span class="ident" id="4112902">Sum</span><span class="op" id="4112905">(</span><span class="ident" id="4112906">nil</span><span class="op" id="4112909">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112913">switch</span>&nbsp;<span class="ident" id="4112920">pub</span>&nbsp;<span class="op" id="4112924">:=</span>&nbsp;<span class="ident" id="4112927">c</span><span class="op" id="4112928">.</span><span class="ident" id="4112929">PublicKey</span><span class="op" id="4112938">.</span><span class="op" id="4112939">(</span><span class="keyword" id="4112940">type</span><span class="op" id="4112944">)</span>&nbsp;<span class="op" id="4112946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112949">case</span>&nbsp;<span class="op" id="4112954">*</span><span class="ident" id="4112955">rsa</span><span class="op" id="4112958">.</span><span class="ident" id="4112959">PublicKey</span><span class="op" id="4112968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4112972">return</span>&nbsp;<span class="ident" id="4112979">rsa</span><span class="op" id="4112982">.</span><span class="ident" id="4112983">VerifyPKCS1v15</span><span class="op" id="4112997">(</span><span class="ident" id="4112998">pub</span><span class="op" id="4113001">,</span>&nbsp;<span class="ident" id="4113003">hashType</span><span class="op" id="4113011">,</span>&nbsp;<span class="ident" id="4113013">digest</span><span class="op" id="4113019">,</span>&nbsp;<span class="ident" id="4113021">signature</span><span class="op" id="4113030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113033">case</span>&nbsp;<span class="op" id="4113038">*</span><span class="ident" id="4113039">dsa</span><span class="op" id="4113042">.</span><span class="ident" id="4113043">PublicKey</span><span class="op" id="4113052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113056">dsaSig</span>&nbsp;<span class="op" id="4113063">:=</span>&nbsp;<span class="builtinfunc" id="4113066">new</span><span class="op" id="4113069">(</span><span class="ident" id="4113070">dsaSignature</span><span class="op" id="4113082">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113086">if</span>&nbsp;<span class="ident" id="4113089">_</span><span class="op" id="4113090">,</span>&nbsp;<span class="ident" id="4113092">err</span>&nbsp;<span class="op" id="4113096">:=</span>&nbsp;<span class="ident" id="4113099">asn1</span><span class="op" id="4113103">.</span><span class="ident" id="4113104">Unmarshal</span><span class="op" id="4113113">(</span><span class="ident" id="4113114">signature</span><span class="op" id="4113123">,</span>&nbsp;<span class="ident" id="4113125">dsaSig</span><span class="op" id="4113131">)</span><span class="op" id="4113132">;</span>&nbsp;<span class="ident" id="4113134">err</span>&nbsp;<span class="op" id="4113138">!=</span>&nbsp;<span class="ident" id="4113141">nil</span>&nbsp;<span class="op" id="4113145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113150">return</span>&nbsp;<span class="ident" id="4113157">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113167">if</span>&nbsp;<span class="ident" id="4113170">dsaSig</span><span class="op" id="4113176">.</span><span class="ident" id="4113177">R</span><span class="op" id="4113178">.</span><span class="ident" id="4113179">Sign</span><span class="op" id="4113183">(</span><span class="op" id="4113184">)</span>&nbsp;<span class="op" id="4113186">&lt;=</span>&nbsp;<span class="num" id="4113189">0</span>&nbsp;<span class="op" id="4113191">||</span>&nbsp;<span class="ident" id="4113194">dsaSig</span><span class="op" id="4113200">.</span><span class="ident" id="4113201">S</span><span class="op" id="4113202">.</span><span class="ident" id="4113203">Sign</span><span class="op" id="4113207">(</span><span class="op" id="4113208">)</span>&nbsp;<span class="op" id="4113210">&lt;=</span>&nbsp;<span class="num" id="4113213">0</span>&nbsp;<span class="op" id="4113215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113220">return</span>&nbsp;<span class="ident" id="4113227">errors</span><span class="op" id="4113233">.</span><span class="ident" id="4113234">New</span><span class="op" id="4113237">(</span><span class="string" id="4113238">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4113293">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113301">if</span>&nbsp;<span class="op" id="4113304">!</span><span class="ident" id="4113305">dsa</span><span class="op" id="4113308">.</span><span class="ident" id="4113309">Verify</span><span class="op" id="4113315">(</span><span class="ident" id="4113316">pub</span><span class="op" id="4113319">,</span>&nbsp;<span class="ident" id="4113321">digest</span><span class="op" id="4113327">,</span>&nbsp;<span class="ident" id="4113329">dsaSig</span><span class="op" id="4113335">.</span><span class="ident" id="4113336">R</span><span class="op" id="4113337">,</span>&nbsp;<span class="ident" id="4113339">dsaSig</span><span class="op" id="4113345">.</span><span class="ident" id="4113346">S</span><span class="op" id="4113347">)</span>&nbsp;<span class="op" id="4113349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113354">return</span>&nbsp;<span class="ident" id="4113361">errors</span><span class="op" id="4113367">.</span><span class="ident" id="4113368">New</span><span class="op" id="4113371">(</span><span class="string" id="4113372">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4113404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113412">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113420">case</span>&nbsp;<span class="op" id="4113425">*</span><span class="ident" id="4113426">ecdsa</span><span class="op" id="4113431">.</span><span class="ident" id="4113432">PublicKey</span><span class="op" id="4113441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4113445">ecdsaSig</span>&nbsp;<span class="op" id="4113454">:=</span>&nbsp;<span class="builtinfunc" id="4113457">new</span><span class="op" id="4113460">(</span><span class="ident" id="4113461">ecdsaSignature</span><span class="op" id="4113475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113479">if</span>&nbsp;<span class="ident" id="4113482">_</span><span class="op" id="4113483">,</span>&nbsp;<span class="ident" id="4113485">err</span>&nbsp;<span class="op" id="4113489">:=</span>&nbsp;<span class="ident" id="4113492">asn1</span><span class="op" id="4113496">.</span><span class="ident" id="4113497">Unmarshal</span><span class="op" id="4113506">(</span><span class="ident" id="4113507">signature</span><span class="op" id="4113516">,</span>&nbsp;<span class="ident" id="4113518">ecdsaSig</span><span class="op" id="4113526">)</span><span class="op" id="4113527">;</span>&nbsp;<span class="ident" id="4113529">err</span>&nbsp;<span class="op" id="4113533">!=</span>&nbsp;<span class="ident" id="4113536">nil</span>&nbsp;<span class="op" id="4113540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113545">return</span>&nbsp;<span class="ident" id="4113552">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113558">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113562">if</span>&nbsp;<span class="ident" id="4113565">ecdsaSig</span><span class="op" id="4113573">.</span><span class="ident" id="4113574">R</span><span class="op" id="4113575">.</span><span class="ident" id="4113576">Sign</span><span class="op" id="4113580">(</span><span class="op" id="4113581">)</span>&nbsp;<span class="op" id="4113583">&lt;=</span>&nbsp;<span class="num" id="4113586">0</span>&nbsp;<span class="op" id="4113588">||</span>&nbsp;<span class="ident" id="4113591">ecdsaSig</span><span class="op" id="4113599">.</span><span class="ident" id="4113600">S</span><span class="op" id="4113601">.</span><span class="ident" id="4113602">Sign</span><span class="op" id="4113606">(</span><span class="op" id="4113607">)</span>&nbsp;<span class="op" id="4113609">&lt;=</span>&nbsp;<span class="num" id="4113612">0</span>&nbsp;<span class="op" id="4113614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113619">return</span>&nbsp;<span class="ident" id="4113626">errors</span><span class="op" id="4113632">.</span><span class="ident" id="4113633">New</span><span class="op" id="4113636">(</span><span class="string" id="4113637">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4113694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113702">if</span>&nbsp;<span class="op" id="4113705">!</span><span class="ident" id="4113706">ecdsa</span><span class="op" id="4113711">.</span><span class="ident" id="4113712">Verify</span><span class="op" id="4113718">(</span><span class="ident" id="4113719">pub</span><span class="op" id="4113722">,</span>&nbsp;<span class="ident" id="4113724">digest</span><span class="op" id="4113730">,</span>&nbsp;<span class="ident" id="4113732">ecdsaSig</span><span class="op" id="4113740">.</span><span class="ident" id="4113741">R</span><span class="op" id="4113742">,</span>&nbsp;<span class="ident" id="4113744">ecdsaSig</span><span class="op" id="4113752">.</span><span class="ident" id="4113753">S</span><span class="op" id="4113754">)</span>&nbsp;<span class="op" id="4113756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113761">return</span>&nbsp;<span class="ident" id="4113768">errors</span><span class="op" id="4113774">.</span><span class="ident" id="4113775">New</span><span class="op" id="4113778">(</span><span class="string" id="4113779">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4113813">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4113829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4113832">return</span>&nbsp;<span class="ident" id="4113839">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4113863">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4113866">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4113931">func</span>&nbsp;<span class="op" id="4113936">(</span><span class="ident" id="4113937">c</span>&nbsp;<span class="op" id="4113939">*</span><span class="ident" id="4113940">Certificate</span><span class="op" id="4113951">)</span>&nbsp;<span class="ident" id="4113953">CheckCRLSignature</span><span class="op" id="4113970">(</span><span class="ident" id="4113971">crl</span>&nbsp;<span class="op" id="4113975">*</span><span class="ident" id="4113976">pkix</span><span class="op" id="4113980">.</span><span class="ident" id="4113981">CertificateList</span><span class="op" id="4113996">)</span>&nbsp;<span class="op" id="4113998">(</span><span class="ident" id="4113999">err</span>&nbsp;<span class="builtintype" id="4114003">error</span><span class="op" id="4114008">)</span>&nbsp;<span class="op" id="4114010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114013">algo</span>&nbsp;<span class="op" id="4114018">:=</span>&nbsp;<span class="ident" id="4114021">getSignatureAlgorithmFromOID</span><span class="op" id="4114049">(</span><span class="ident" id="4114050">crl</span><span class="op" id="4114053">.</span><span class="ident" id="4114054">SignatureAlgorithm</span><span class="op" id="4114072">.</span><span class="ident" id="4114073">Algorithm</span><span class="op" id="4114082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4114085">return</span>&nbsp;<span class="ident" id="4114092">c</span><span class="op" id="4114093">.</span><span class="ident" id="4114094">CheckSignature</span><span class="op" id="4114108">(</span><span class="ident" id="4114109">algo</span><span class="op" id="4114113">,</span>&nbsp;<span class="ident" id="4114115">crl</span><span class="op" id="4114118">.</span><span class="ident" id="4114119">TBSCertList</span><span class="op" id="4114130">.</span><span class="ident" id="4114131">Raw</span><span class="op" id="4114134">,</span>&nbsp;<span class="ident" id="4114136">crl</span><span class="op" id="4114139">.</span><span class="ident" id="4114140">SignatureValue</span><span class="op" id="4114154">.</span><span class="ident" id="4114155">RightAlign</span><span class="op" id="4114165">(</span><span class="op" id="4114166">)</span><span class="op" id="4114167">)</span><br>
<span class="lineno">680</span><span class="op" id="4114169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114172">type</span>&nbsp;<span class="ident" id="4114177">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4114204">struct</span><span class="op" id="4114210">{</span><span class="op" id="4114211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114214">func</span>&nbsp;<span class="op" id="4114219">(</span><span class="ident" id="4114220">h</span>&nbsp;<span class="ident" id="4114222">UnhandledCriticalExtension</span><span class="op" id="4114248">)</span>&nbsp;<span class="ident" id="4114250">Error</span><span class="op" id="4114255">(</span><span class="op" id="4114256">)</span>&nbsp;<span class="builtintype" id="4114258">string</span>&nbsp;<span class="op" id="4114265">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4114268">return</span>&nbsp;<span class="string" id="4114275">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4114312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114315">type</span>&nbsp;<span class="ident" id="4114320">basicConstraints</span>&nbsp;<span class="keyword" id="4114337">struct</span>&nbsp;<span class="op" id="4114344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114347">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4114358">bool</span>&nbsp;<span class="string" id="4114363">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114382">MaxPathLen</span>&nbsp;<span class="builtintype" id="4114393">int</span>&nbsp;&nbsp;<span class="string" id="4114398">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4114427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4114430">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4114450">type</span>&nbsp;<span class="ident" id="4114455">policyInformation</span>&nbsp;<span class="keyword" id="4114473">struct</span>&nbsp;<span class="op" id="4114480">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114483">Policy</span>&nbsp;<span class="ident" id="4114490">asn1</span><span class="op" id="4114494">.</span><span class="ident" id="4114495">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4114513">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4114541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4114544">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4114566">type</span>&nbsp;<span class="ident" id="4114571">nameConstraints</span>&nbsp;<span class="keyword" id="4114587">struct</span>&nbsp;<span class="op" id="4114594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114597">Permitted</span>&nbsp;<span class="op" id="4114607">[</span><span class="op" id="4114608">]</span><span class="ident" id="4114609">generalSubtree</span>&nbsp;<span class="string" id="4114624">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114649">Excluded</span>&nbsp;&nbsp;<span class="op" id="4114659">[</span><span class="op" id="4114660">]</span><span class="ident" id="4114661">generalSubtree</span>&nbsp;<span class="string" id="4114676">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4114700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4114703">type</span>&nbsp;<span class="ident" id="4114708">generalSubtree</span>&nbsp;<span class="keyword" id="4114723">struct</span>&nbsp;<span class="op" id="4114730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114733">Name</span>&nbsp;<span class="builtintype" id="4114738">string</span>&nbsp;<span class="string" id="4114745">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4114773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4114776">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4114797">type</span>&nbsp;<span class="ident" id="4114802">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4114822">struct</span>&nbsp;<span class="op" id="4114829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114832">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4114841">asn1</span><span class="op" id="4114845">.</span><span class="ident" id="4114846">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114864">Location</span>&nbsp;<span class="ident" id="4114873">asn1</span><span class="op" id="4114877">.</span><span class="ident" id="4114878">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4114887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4114890">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4114912">type</span>&nbsp;<span class="ident" id="4114917">distributionPoint</span>&nbsp;<span class="keyword" id="4114935">struct</span>&nbsp;<span class="op" id="4114942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4114945">DistributionPoint</span>&nbsp;<span class="ident" id="4114963">distributionPointName</span>&nbsp;<span class="string" id="4114985">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115010">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115028">asn1</span><span class="op" id="4115032">.</span><span class="ident" id="4115033">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4115050">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115075">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115093">asn1</span><span class="op" id="4115097">.</span><span class="ident" id="4115098">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4115115">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4115139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4115142">type</span>&nbsp;<span class="ident" id="4115147">distributionPointName</span>&nbsp;<span class="keyword" id="4115169">struct</span>&nbsp;<span class="op" id="4115176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115179">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115192">asn1</span><span class="op" id="4115196">.</span><span class="ident" id="4115197">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4115209">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115234">RelativeName</span>&nbsp;<span class="ident" id="4115247">pkix</span><span class="op" id="4115251">.</span><span class="ident" id="4115252">RDNSequence</span>&nbsp;<span class="string" id="4115264">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4115288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4115291">func</span>&nbsp;<span class="ident" id="4115296">parsePublicKey</span><span class="op" id="4115310">(</span><span class="ident" id="4115311">algo</span>&nbsp;<span class="ident" id="4115316">PublicKeyAlgorithm</span><span class="op" id="4115334">,</span>&nbsp;<span class="ident" id="4115336">keyData</span>&nbsp;<span class="op" id="4115344">*</span><span class="ident" id="4115345">publicKeyInfo</span><span class="op" id="4115358">)</span>&nbsp;<span class="op" id="4115360">(</span><span class="keyword" id="4115361">interface</span><span class="op" id="4115370">{</span><span class="op" id="4115371">}</span><span class="op" id="4115372">,</span>&nbsp;<span class="builtintype" id="4115374">error</span><span class="op" id="4115379">)</span>&nbsp;<span class="op" id="4115381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115384">asn1Data</span>&nbsp;<span class="op" id="4115393">:=</span>&nbsp;<span class="ident" id="4115396">keyData</span><span class="op" id="4115403">.</span><span class="ident" id="4115404">PublicKey</span><span class="op" id="4115413">.</span><span class="ident" id="4115414">RightAlign</span><span class="op" id="4115424">(</span><span class="op" id="4115425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115428">switch</span>&nbsp;<span class="ident" id="4115435">algo</span>&nbsp;<span class="op" id="4115440">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115443">case</span>&nbsp;<span class="ident" id="4115448">RSA</span><span class="op" id="4115451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115455">p</span>&nbsp;<span class="op" id="4115457">:=</span>&nbsp;<span class="builtinfunc" id="4115460">new</span><span class="op" id="4115463">(</span><span class="ident" id="4115464">rsaPublicKey</span><span class="op" id="4115476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115480">_</span><span class="op" id="4115481">,</span>&nbsp;<span class="ident" id="4115483">err</span>&nbsp;<span class="op" id="4115487">:=</span>&nbsp;<span class="ident" id="4115490">asn1</span><span class="op" id="4115494">.</span><span class="ident" id="4115495">Unmarshal</span><span class="op" id="4115504">(</span><span class="ident" id="4115505">asn1Data</span><span class="op" id="4115513">,</span>&nbsp;<span class="ident" id="4115515">p</span><span class="op" id="4115516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115520">if</span>&nbsp;<span class="ident" id="4115523">err</span>&nbsp;<span class="op" id="4115527">!=</span>&nbsp;<span class="ident" id="4115530">nil</span>&nbsp;<span class="op" id="4115534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115539">return</span>&nbsp;<span class="ident" id="4115546">nil</span><span class="op" id="4115549">,</span>&nbsp;<span class="ident" id="4115551">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4115557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115562">if</span>&nbsp;<span class="ident" id="4115565">p</span><span class="op" id="4115566">.</span><span class="ident" id="4115567">N</span><span class="op" id="4115568">.</span><span class="ident" id="4115569">Sign</span><span class="op" id="4115573">(</span><span class="op" id="4115574">)</span>&nbsp;<span class="op" id="4115576">&lt;=</span>&nbsp;<span class="num" id="4115579">0</span>&nbsp;<span class="op" id="4115581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115586">return</span>&nbsp;<span class="ident" id="4115593">nil</span><span class="op" id="4115596">,</span>&nbsp;<span class="ident" id="4115598">errors</span><span class="op" id="4115604">.</span><span class="ident" id="4115605">New</span><span class="op" id="4115608">(</span><span class="string" id="4115609">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4115653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4115657">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115661">if</span>&nbsp;<span class="ident" id="4115664">p</span><span class="op" id="4115665">.</span><span class="ident" id="4115666">E</span>&nbsp;<span class="op" id="4115668">&lt;=</span>&nbsp;<span class="num" id="4115671">0</span>&nbsp;<span class="op" id="4115673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115678">return</span>&nbsp;<span class="ident" id="4115685">nil</span><span class="op" id="4115688">,</span>&nbsp;<span class="ident" id="4115690">errors</span><span class="op" id="4115696">.</span><span class="ident" id="4115697">New</span><span class="op" id="4115700">(</span><span class="string" id="4115701">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4115753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4115757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115762">pub</span>&nbsp;<span class="op" id="4115766">:=</span>&nbsp;<span class="op" id="4115769">&amp;</span><span class="ident" id="4115770">rsa</span><span class="op" id="4115773">.</span><span class="ident" id="4115774">PublicKey</span><span class="op" id="4115783">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115788">E</span><span class="op" id="4115789">:</span>&nbsp;<span class="ident" id="4115791">p</span><span class="op" id="4115792">.</span><span class="ident" id="4115793">E</span><span class="op" id="4115794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115799">N</span><span class="op" id="4115800">:</span>&nbsp;<span class="ident" id="4115802">p</span><span class="op" id="4115803">.</span><span class="ident" id="4115804">N</span><span class="op" id="4115805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4115809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115813">return</span>&nbsp;<span class="ident" id="4115820">pub</span><span class="op" id="4115823">,</span>&nbsp;<span class="ident" id="4115825">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115830">case</span>&nbsp;<span class="ident" id="4115835">DSA</span><span class="op" id="4115838">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115842">var</span>&nbsp;<span class="ident" id="4115846">p</span>&nbsp;<span class="op" id="4115848">*</span><span class="ident" id="4115849">big</span><span class="op" id="4115852">.</span><span class="ident" id="4115853">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115859">_</span><span class="op" id="4115860">,</span>&nbsp;<span class="ident" id="4115862">err</span>&nbsp;<span class="op" id="4115866">:=</span>&nbsp;<span class="ident" id="4115869">asn1</span><span class="op" id="4115873">.</span><span class="ident" id="4115874">Unmarshal</span><span class="op" id="4115883">(</span><span class="ident" id="4115884">asn1Data</span><span class="op" id="4115892">,</span>&nbsp;<span class="op" id="4115894">&amp;</span><span class="ident" id="4115895">p</span><span class="op" id="4115896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115900">if</span>&nbsp;<span class="ident" id="4115903">err</span>&nbsp;<span class="op" id="4115907">!=</span>&nbsp;<span class="ident" id="4115910">nil</span>&nbsp;<span class="op" id="4115914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4115919">return</span>&nbsp;<span class="ident" id="4115926">nil</span><span class="op" id="4115929">,</span>&nbsp;<span class="ident" id="4115931">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4115937">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115941">paramsData</span>&nbsp;<span class="op" id="4115952">:=</span>&nbsp;<span class="ident" id="4115955">keyData</span><span class="op" id="4115962">.</span><span class="ident" id="4115963">Algorithm</span><span class="op" id="4115972">.</span><span class="ident" id="4115973">Parameters</span><span class="op" id="4115983">.</span><span class="ident" id="4115984">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4115996">params</span>&nbsp;<span class="op" id="4116003">:=</span>&nbsp;<span class="builtinfunc" id="4116006">new</span><span class="op" id="4116009">(</span><span class="ident" id="4116010">dsaAlgorithmParameters</span><span class="op" id="4116032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116036">_</span><span class="op" id="4116037">,</span>&nbsp;<span class="ident" id="4116039">err</span>&nbsp;<span class="op" id="4116043">=</span>&nbsp;<span class="ident" id="4116045">asn1</span><span class="op" id="4116049">.</span><span class="ident" id="4116050">Unmarshal</span><span class="op" id="4116059">(</span><span class="ident" id="4116060">paramsData</span><span class="op" id="4116070">,</span>&nbsp;<span class="ident" id="4116072">params</span><span class="op" id="4116078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116082">if</span>&nbsp;<span class="ident" id="4116085">err</span>&nbsp;<span class="op" id="4116089">!=</span>&nbsp;<span class="ident" id="4116092">nil</span>&nbsp;<span class="op" id="4116096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116101">return</span>&nbsp;<span class="ident" id="4116108">nil</span><span class="op" id="4116111">,</span>&nbsp;<span class="ident" id="4116113">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116123">if</span>&nbsp;<span class="ident" id="4116126">p</span><span class="op" id="4116127">.</span><span class="ident" id="4116128">Sign</span><span class="op" id="4116132">(</span><span class="op" id="4116133">)</span>&nbsp;<span class="op" id="4116135">&lt;=</span>&nbsp;<span class="num" id="4116138">0</span>&nbsp;<span class="op" id="4116140">||</span>&nbsp;<span class="ident" id="4116143">params</span><span class="op" id="4116149">.</span><span class="ident" id="4116150">P</span><span class="op" id="4116151">.</span><span class="ident" id="4116152">Sign</span><span class="op" id="4116156">(</span><span class="op" id="4116157">)</span>&nbsp;<span class="op" id="4116159">&lt;=</span>&nbsp;<span class="num" id="4116162">0</span>&nbsp;<span class="op" id="4116164">||</span>&nbsp;<span class="ident" id="4116167">params</span><span class="op" id="4116173">.</span><span class="ident" id="4116174">Q</span><span class="op" id="4116175">.</span><span class="ident" id="4116176">Sign</span><span class="op" id="4116180">(</span><span class="op" id="4116181">)</span>&nbsp;<span class="op" id="4116183">&lt;=</span>&nbsp;<span class="num" id="4116186">0</span>&nbsp;<span class="op" id="4116188">||</span>&nbsp;<span class="ident" id="4116191">params</span><span class="op" id="4116197">.</span><span class="ident" id="4116198">G</span><span class="op" id="4116199">.</span><span class="ident" id="4116200">Sign</span><span class="op" id="4116204">(</span><span class="op" id="4116205">)</span>&nbsp;<span class="op" id="4116207">&lt;=</span>&nbsp;<span class="num" id="4116210">0</span>&nbsp;<span class="op" id="4116212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116217">return</span>&nbsp;<span class="ident" id="4116224">nil</span><span class="op" id="4116227">,</span>&nbsp;<span class="ident" id="4116229">errors</span><span class="op" id="4116235">.</span><span class="ident" id="4116236">New</span><span class="op" id="4116239">(</span><span class="string" id="4116240">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4116278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116286">pub</span>&nbsp;<span class="op" id="4116290">:=</span>&nbsp;<span class="op" id="4116293">&amp;</span><span class="ident" id="4116294">dsa</span><span class="op" id="4116297">.</span><span class="ident" id="4116298">PublicKey</span><span class="op" id="4116307">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116312">Parameters</span><span class="op" id="4116322">:</span>&nbsp;<span class="ident" id="4116324">dsa</span><span class="op" id="4116327">.</span><span class="ident" id="4116328">Parameters</span><span class="op" id="4116338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116344">P</span><span class="op" id="4116345">:</span>&nbsp;<span class="ident" id="4116347">params</span><span class="op" id="4116353">.</span><span class="ident" id="4116354">P</span><span class="op" id="4116355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116361">Q</span><span class="op" id="4116362">:</span>&nbsp;<span class="ident" id="4116364">params</span><span class="op" id="4116370">.</span><span class="ident" id="4116371">Q</span><span class="op" id="4116372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116378">G</span><span class="op" id="4116379">:</span>&nbsp;<span class="ident" id="4116381">params</span><span class="op" id="4116387">.</span><span class="ident" id="4116388">G</span><span class="op" id="4116389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116394">}</span><span class="op" id="4116395">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116400">Y</span><span class="op" id="4116401">:</span>&nbsp;<span class="ident" id="4116403">p</span><span class="op" id="4116404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116412">return</span>&nbsp;<span class="ident" id="4116419">pub</span><span class="op" id="4116422">,</span>&nbsp;<span class="ident" id="4116424">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116429">case</span>&nbsp;<span class="ident" id="4116434">ECDSA</span><span class="op" id="4116439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116443">paramsData</span>&nbsp;<span class="op" id="4116454">:=</span>&nbsp;<span class="ident" id="4116457">keyData</span><span class="op" id="4116464">.</span><span class="ident" id="4116465">Algorithm</span><span class="op" id="4116474">.</span><span class="ident" id="4116475">Parameters</span><span class="op" id="4116485">.</span><span class="ident" id="4116486">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116498">namedCurveOID</span>&nbsp;<span class="op" id="4116512">:=</span>&nbsp;<span class="builtinfunc" id="4116515">new</span><span class="op" id="4116518">(</span><span class="ident" id="4116519">asn1</span><span class="op" id="4116523">.</span><span class="ident" id="4116524">ObjectIdentifier</span><span class="op" id="4116540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116544">_</span><span class="op" id="4116545">,</span>&nbsp;<span class="ident" id="4116547">err</span>&nbsp;<span class="op" id="4116551">:=</span>&nbsp;<span class="ident" id="4116554">asn1</span><span class="op" id="4116558">.</span><span class="ident" id="4116559">Unmarshal</span><span class="op" id="4116568">(</span><span class="ident" id="4116569">paramsData</span><span class="op" id="4116579">,</span>&nbsp;<span class="ident" id="4116581">namedCurveOID</span><span class="op" id="4116594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116598">if</span>&nbsp;<span class="ident" id="4116601">err</span>&nbsp;<span class="op" id="4116605">!=</span>&nbsp;<span class="ident" id="4116608">nil</span>&nbsp;<span class="op" id="4116612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116617">return</span>&nbsp;<span class="ident" id="4116624">nil</span><span class="op" id="4116627">,</span>&nbsp;<span class="ident" id="4116629">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116635">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116639">namedCurve</span>&nbsp;<span class="op" id="4116650">:=</span>&nbsp;<span class="ident" id="4116653">namedCurveFromOID</span><span class="op" id="4116670">(</span><span class="op" id="4116671">*</span><span class="ident" id="4116672">namedCurveOID</span><span class="op" id="4116685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116689">if</span>&nbsp;<span class="ident" id="4116692">namedCurve</span>&nbsp;<span class="op" id="4116703">==</span>&nbsp;<span class="ident" id="4116706">nil</span>&nbsp;<span class="op" id="4116710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116715">return</span>&nbsp;<span class="ident" id="4116722">nil</span><span class="op" id="4116725">,</span>&nbsp;<span class="ident" id="4116727">errors</span><span class="op" id="4116733">.</span><span class="ident" id="4116734">New</span><span class="op" id="4116737">(</span><span class="string" id="4116738">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4116772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116780">x</span><span class="op" id="4116781">,</span>&nbsp;<span class="ident" id="4116783">y</span>&nbsp;<span class="op" id="4116785">:=</span>&nbsp;<span class="ident" id="4116788">elliptic</span><span class="op" id="4116796">.</span><span class="ident" id="4116797">Unmarshal</span><span class="op" id="4116806">(</span><span class="ident" id="4116807">namedCurve</span><span class="op" id="4116817">,</span>&nbsp;<span class="ident" id="4116819">asn1Data</span><span class="op" id="4116827">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116831">if</span>&nbsp;<span class="ident" id="4116834">x</span>&nbsp;<span class="op" id="4116836">==</span>&nbsp;<span class="ident" id="4116839">nil</span>&nbsp;<span class="op" id="4116843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4116848">return</span>&nbsp;<span class="ident" id="4116855">nil</span><span class="op" id="4116858">,</span>&nbsp;<span class="ident" id="4116860">errors</span><span class="op" id="4116866">.</span><span class="ident" id="4116867">New</span><span class="op" id="4116870">(</span><span class="string" id="4116871">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4116919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4116923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116927">pub</span>&nbsp;<span class="op" id="4116931">:=</span>&nbsp;<span class="op" id="4116934">&amp;</span><span class="ident" id="4116935">ecdsa</span><span class="op" id="4116940">.</span><span class="ident" id="4116941">PublicKey</span><span class="op" id="4116950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116955">Curve</span><span class="op" id="4116960">:</span>&nbsp;<span class="ident" id="4116962">namedCurve</span><span class="op" id="4116972">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116977">X</span><span class="op" id="4116978">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116984">x</span><span class="op" id="4116985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4116990">Y</span><span class="op" id="4116991">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116997">y</span><span class="op" id="4116998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4117002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117006">return</span>&nbsp;<span class="ident" id="4117013">pub</span><span class="op" id="4117016">,</span>&nbsp;<span class="ident" id="4117018">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117023">default</span><span class="op" id="4117030">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117034">return</span>&nbsp;<span class="ident" id="4117041">nil</span><span class="op" id="4117044">,</span>&nbsp;<span class="ident" id="4117046">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4117051">}</span><br>
<span class="lineno"></span><span class="op" id="4117053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4117056">func</span>&nbsp;<span class="ident" id="4117061">parseSANExtension</span><span class="op" id="4117078">(</span><span class="ident" id="4117079">value</span>&nbsp;<span class="op" id="4117085">[</span><span class="op" id="4117086">]</span><span class="builtintype" id="4117087">byte</span><span class="op" id="4117091">)</span>&nbsp;<span class="op" id="4117093">(</span><span class="ident" id="4117094">dnsNames</span><span class="op" id="4117102">,</span>&nbsp;<span class="ident" id="4117104">emailAddresses</span>&nbsp;<span class="op" id="4117119">[</span><span class="op" id="4117120">]</span><span class="builtintype" id="4117121">string</span><span class="op" id="4117127">,</span>&nbsp;<span class="ident" id="4117129">ipAddresses</span>&nbsp;<span class="op" id="4117141">[</span><span class="op" id="4117142">]</span><span class="ident" id="4117143">net</span><span class="op" id="4117146">.</span><span class="ident" id="4117147">IP</span><span class="op" id="4117149">,</span>&nbsp;<span class="ident" id="4117151">err</span>&nbsp;<span class="builtintype" id="4117155">error</span><span class="op" id="4117160">)</span>&nbsp;<span class="op" id="4117162">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117165">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117188">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117224">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117228">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117287">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117291">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117560">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117615">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117738">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4117801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117870">var</span>&nbsp;<span class="ident" id="4117874">seq</span>&nbsp;<span class="ident" id="4117878">asn1</span><span class="op" id="4117882">.</span><span class="ident" id="4117883">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117893">if</span>&nbsp;<span class="ident" id="4117896">_</span><span class="op" id="4117897">,</span>&nbsp;<span class="ident" id="4117899">err</span>&nbsp;<span class="op" id="4117903">=</span>&nbsp;<span class="ident" id="4117905">asn1</span><span class="op" id="4117909">.</span><span class="ident" id="4117910">Unmarshal</span><span class="op" id="4117919">(</span><span class="ident" id="4117920">value</span><span class="op" id="4117925">,</span>&nbsp;<span class="op" id="4117927">&amp;</span><span class="ident" id="4117928">seq</span><span class="op" id="4117931">)</span><span class="op" id="4117932">;</span>&nbsp;<span class="ident" id="4117934">err</span>&nbsp;<span class="op" id="4117938">!=</span>&nbsp;<span class="ident" id="4117941">nil</span>&nbsp;<span class="op" id="4117945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117949">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4117957">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4117960">if</span>&nbsp;<span class="op" id="4117963">!</span><span class="ident" id="4117964">seq</span><span class="op" id="4117967">.</span><span class="ident" id="4117968">IsCompound</span>&nbsp;<span class="op" id="4117979">||</span>&nbsp;<span class="ident" id="4117982">seq</span><span class="op" id="4117985">.</span><span class="ident" id="4117986">Tag</span>&nbsp;<span class="op" id="4117990">!=</span>&nbsp;<span class="num" id="4117993">16</span>&nbsp;<span class="op" id="4117996">||</span>&nbsp;<span class="ident" id="4117999">seq</span><span class="op" id="4118002">.</span><span class="ident" id="4118003">Class</span>&nbsp;<span class="op" id="4118009">!=</span>&nbsp;<span class="num" id="4118012">0</span>&nbsp;<span class="op" id="4118014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118018">err</span>&nbsp;<span class="op" id="4118022">=</span>&nbsp;<span class="ident" id="4118024">asn1</span><span class="op" id="4118028">.</span><span class="ident" id="4118029">StructuralError</span><span class="op" id="4118044">{</span><span class="ident" id="4118045">Msg</span><span class="op" id="4118048">:</span>&nbsp;<span class="string" id="4118050">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4118068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4118080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118084">rest</span>&nbsp;<span class="op" id="4118089">:=</span>&nbsp;<span class="ident" id="4118092">seq</span><span class="op" id="4118095">.</span><span class="ident" id="4118096">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118103">for</span>&nbsp;<span class="builtinfunc" id="4118107">len</span><span class="op" id="4118110">(</span><span class="ident" id="4118111">rest</span><span class="op" id="4118115">)</span>&nbsp;<span class="op" id="4118117">&gt;</span>&nbsp;<span class="num" id="4118119">0</span>&nbsp;<span class="op" id="4118121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118125">var</span>&nbsp;<span class="ident" id="4118129">v</span>&nbsp;<span class="ident" id="4118131">asn1</span><span class="op" id="4118135">.</span><span class="ident" id="4118136">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118147">rest</span><span class="op" id="4118151">,</span>&nbsp;<span class="ident" id="4118153">err</span>&nbsp;<span class="op" id="4118157">=</span>&nbsp;<span class="ident" id="4118159">asn1</span><span class="op" id="4118163">.</span><span class="ident" id="4118164">Unmarshal</span><span class="op" id="4118173">(</span><span class="ident" id="4118174">rest</span><span class="op" id="4118178">,</span>&nbsp;<span class="op" id="4118180">&amp;</span><span class="ident" id="4118181">v</span><span class="op" id="4118182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118186">if</span>&nbsp;<span class="ident" id="4118189">err</span>&nbsp;<span class="op" id="4118193">!=</span>&nbsp;<span class="ident" id="4118196">nil</span>&nbsp;<span class="op" id="4118200">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118205">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4118214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118218">switch</span>&nbsp;<span class="ident" id="4118225">v</span><span class="op" id="4118226">.</span><span class="ident" id="4118227">Tag</span>&nbsp;<span class="op" id="4118231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118235">case</span>&nbsp;<span class="num" id="4118240">1</span><span class="op" id="4118241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118246">emailAddresses</span>&nbsp;<span class="op" id="4118261">=</span>&nbsp;<span class="builtinfunc" id="4118263">append</span><span class="op" id="4118269">(</span><span class="ident" id="4118270">emailAddresses</span><span class="op" id="4118284">,</span>&nbsp;<span class="builtintype" id="4118286">string</span><span class="op" id="4118292">(</span><span class="ident" id="4118293">v</span><span class="op" id="4118294">.</span><span class="ident" id="4118295">Bytes</span><span class="op" id="4118300">)</span><span class="op" id="4118301">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118305">case</span>&nbsp;<span class="num" id="4118310">2</span><span class="op" id="4118311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118316">dnsNames</span>&nbsp;<span class="op" id="4118325">=</span>&nbsp;<span class="builtinfunc" id="4118327">append</span><span class="op" id="4118333">(</span><span class="ident" id="4118334">dnsNames</span><span class="op" id="4118342">,</span>&nbsp;<span class="builtintype" id="4118344">string</span><span class="op" id="4118350">(</span><span class="ident" id="4118351">v</span><span class="op" id="4118352">.</span><span class="ident" id="4118353">Bytes</span><span class="op" id="4118358">)</span><span class="op" id="4118359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118363">case</span>&nbsp;<span class="num" id="4118368">7</span><span class="op" id="4118369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118374">switch</span>&nbsp;<span class="builtinfunc" id="4118381">len</span><span class="op" id="4118384">(</span><span class="ident" id="4118385">v</span><span class="op" id="4118386">.</span><span class="ident" id="4118387">Bytes</span><span class="op" id="4118392">)</span>&nbsp;<span class="op" id="4118394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118399">case</span>&nbsp;<span class="ident" id="4118404">net</span><span class="op" id="4118407">.</span><span class="ident" id="4118408">IPv4len</span><span class="op" id="4118415">,</span>&nbsp;<span class="ident" id="4118417">net</span><span class="op" id="4118420">.</span><span class="ident" id="4118421">IPv6len</span><span class="op" id="4118428">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118434">ipAddresses</span>&nbsp;<span class="op" id="4118446">=</span>&nbsp;<span class="builtinfunc" id="4118448">append</span><span class="op" id="4118454">(</span><span class="ident" id="4118455">ipAddresses</span><span class="op" id="4118466">,</span>&nbsp;<span class="ident" id="4118468">v</span><span class="op" id="4118469">.</span><span class="ident" id="4118470">Bytes</span><span class="op" id="4118475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118480">default</span><span class="op" id="4118487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118493">err</span>&nbsp;<span class="op" id="4118497">=</span>&nbsp;<span class="ident" id="4118499">errors</span><span class="op" id="4118505">.</span><span class="ident" id="4118506">New</span><span class="op" id="4118509">(</span><span class="string" id="4118510">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4118562">+</span>&nbsp;<span class="ident" id="4118564">strconv</span><span class="op" id="4118571">.</span><span class="ident" id="4118572">Itoa</span><span class="op" id="4118576">(</span><span class="builtinfunc" id="4118577">len</span><span class="op" id="4118580">(</span><span class="ident" id="4118581">v</span><span class="op" id="4118582">.</span><span class="ident" id="4118583">Bytes</span><span class="op" id="4118588">)</span><span class="op" id="4118589">)</span><span class="op" id="4118590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118596">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4118606">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4118610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4118613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4118617">return</span><br>
<span class="lineno"></span><span class="op" id="4118624">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4118627">func</span>&nbsp;<span class="ident" id="4118632">parseCertificate</span><span class="op" id="4118648">(</span><span class="ident" id="4118649">in</span>&nbsp;<span class="op" id="4118652">*</span><span class="ident" id="4118653">certificate</span><span class="op" id="4118664">)</span>&nbsp;<span class="op" id="4118666">(</span><span class="op" id="4118667">*</span><span class="ident" id="4118668">Certificate</span><span class="op" id="4118679">,</span>&nbsp;<span class="builtintype" id="4118681">error</span><span class="op" id="4118686">)</span>&nbsp;<span class="op" id="4118688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118691">out</span>&nbsp;<span class="op" id="4118695">:=</span>&nbsp;<span class="builtinfunc" id="4118698">new</span><span class="op" id="4118701">(</span><span class="ident" id="4118702">Certificate</span><span class="op" id="4118713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118716">out</span><span class="op" id="4118719">.</span><span class="ident" id="4118720">Raw</span>&nbsp;<span class="op" id="4118724">=</span>&nbsp;<span class="ident" id="4118726">in</span><span class="op" id="4118728">.</span><span class="ident" id="4118729">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118734">out</span><span class="op" id="4118737">.</span><span class="ident" id="4118738">RawTBSCertificate</span>&nbsp;<span class="op" id="4118756">=</span>&nbsp;<span class="ident" id="4118758">in</span><span class="op" id="4118760">.</span><span class="ident" id="4118761">TBSCertificate</span><span class="op" id="4118775">.</span><span class="ident" id="4118776">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118781">out</span><span class="op" id="4118784">.</span><span class="ident" id="4118785">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4118809">=</span>&nbsp;<span class="ident" id="4118811">in</span><span class="op" id="4118813">.</span><span class="ident" id="4118814">TBSCertificate</span><span class="op" id="4118828">.</span><span class="ident" id="4118829">PublicKey</span><span class="op" id="4118838">.</span><span class="ident" id="4118839">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118844">out</span><span class="op" id="4118847">.</span><span class="ident" id="4118848">RawSubject</span>&nbsp;<span class="op" id="4118859">=</span>&nbsp;<span class="ident" id="4118861">in</span><span class="op" id="4118863">.</span><span class="ident" id="4118864">TBSCertificate</span><span class="op" id="4118878">.</span><span class="ident" id="4118879">Subject</span><span class="op" id="4118886">.</span><span class="ident" id="4118887">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118898">out</span><span class="op" id="4118901">.</span><span class="ident" id="4118902">RawIssuer</span>&nbsp;<span class="op" id="4118912">=</span>&nbsp;<span class="ident" id="4118914">in</span><span class="op" id="4118916">.</span><span class="ident" id="4118917">TBSCertificate</span><span class="op" id="4118931">.</span><span class="ident" id="4118932">Issuer</span><span class="op" id="4118938">.</span><span class="ident" id="4118939">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118951">out</span><span class="op" id="4118954">.</span><span class="ident" id="4118955">Signature</span>&nbsp;<span class="op" id="4118965">=</span>&nbsp;<span class="ident" id="4118967">in</span><span class="op" id="4118969">.</span><span class="ident" id="4118970">SignatureValue</span><span class="op" id="4118984">.</span><span class="ident" id="4118985">RightAlign</span><span class="op" id="4118995">(</span><span class="op" id="4118996">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118999">out</span><span class="op" id="4119002">.</span><span class="ident" id="4119003">SignatureAlgorithm</span>&nbsp;<span class="op" id="4119022">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119026">getSignatureAlgorithmFromOID</span><span class="op" id="4119054">(</span><span class="ident" id="4119055">in</span><span class="op" id="4119057">.</span><span class="ident" id="4119058">TBSCertificate</span><span class="op" id="4119072">.</span><span class="ident" id="4119073">SignatureAlgorithm</span><span class="op" id="4119091">.</span><span class="ident" id="4119092">Algorithm</span><span class="op" id="4119101">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119105">out</span><span class="op" id="4119108">.</span><span class="ident" id="4119109">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4119128">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119132">getPublicKeyAlgorithmFromOID</span><span class="op" id="4119160">(</span><span class="ident" id="4119161">in</span><span class="op" id="4119163">.</span><span class="ident" id="4119164">TBSCertificate</span><span class="op" id="4119178">.</span><span class="ident" id="4119179">PublicKey</span><span class="op" id="4119188">.</span><span class="ident" id="4119189">Algorithm</span><span class="op" id="4119198">.</span><span class="ident" id="4119199">Algorithm</span><span class="op" id="4119208">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119211">var</span>&nbsp;<span class="ident" id="4119215">err</span>&nbsp;<span class="builtintype" id="4119219">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119226">out</span><span class="op" id="4119229">.</span><span class="ident" id="4119230">PublicKey</span><span class="op" id="4119239">,</span>&nbsp;<span class="ident" id="4119241">err</span>&nbsp;<span class="op" id="4119245">=</span>&nbsp;<span class="ident" id="4119247">parsePublicKey</span><span class="op" id="4119261">(</span><span class="ident" id="4119262">out</span><span class="op" id="4119265">.</span><span class="ident" id="4119266">PublicKeyAlgorithm</span><span class="op" id="4119284">,</span>&nbsp;<span class="op" id="4119286">&amp;</span><span class="ident" id="4119287">in</span><span class="op" id="4119289">.</span><span class="ident" id="4119290">TBSCertificate</span><span class="op" id="4119304">.</span><span class="ident" id="4119305">PublicKey</span><span class="op" id="4119314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119317">if</span>&nbsp;<span class="ident" id="4119320">err</span>&nbsp;<span class="op" id="4119324">!=</span>&nbsp;<span class="ident" id="4119327">nil</span>&nbsp;<span class="op" id="4119331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119335">return</span>&nbsp;<span class="ident" id="4119342">nil</span><span class="op" id="4119345">,</span>&nbsp;<span class="ident" id="4119347">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119352">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119356">if</span>&nbsp;<span class="ident" id="4119359">in</span><span class="op" id="4119361">.</span><span class="ident" id="4119362">TBSCertificate</span><span class="op" id="4119376">.</span><span class="ident" id="4119377">SerialNumber</span><span class="op" id="4119389">.</span><span class="ident" id="4119390">Sign</span><span class="op" id="4119394">(</span><span class="op" id="4119395">)</span>&nbsp;<span class="op" id="4119397">&lt;</span>&nbsp;<span class="num" id="4119399">0</span>&nbsp;<span class="op" id="4119401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119405">return</span>&nbsp;<span class="ident" id="4119412">nil</span><span class="op" id="4119415">,</span>&nbsp;<span class="ident" id="4119417">errors</span><span class="op" id="4119423">.</span><span class="ident" id="4119424">New</span><span class="op" id="4119427">(</span><span class="string" id="4119428">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4119458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119465">out</span><span class="op" id="4119468">.</span><span class="ident" id="4119469">Version</span>&nbsp;<span class="op" id="4119477">=</span>&nbsp;<span class="ident" id="4119479">in</span><span class="op" id="4119481">.</span><span class="ident" id="4119482">TBSCertificate</span><span class="op" id="4119496">.</span><span class="ident" id="4119497">Version</span>&nbsp;<span class="op" id="4119505">+</span>&nbsp;<span class="num" id="4119507">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119510">out</span><span class="op" id="4119513">.</span><span class="ident" id="4119514">SerialNumber</span>&nbsp;<span class="op" id="4119527">=</span>&nbsp;<span class="ident" id="4119529">in</span><span class="op" id="4119531">.</span><span class="ident" id="4119532">TBSCertificate</span><span class="op" id="4119546">.</span><span class="ident" id="4119547">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119562">var</span>&nbsp;<span class="ident" id="4119566">issuer</span><span class="op" id="4119572">,</span>&nbsp;<span class="ident" id="4119574">subject</span>&nbsp;<span class="ident" id="4119582">pkix</span><span class="op" id="4119586">.</span><span class="ident" id="4119587">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119600">if</span>&nbsp;<span class="ident" id="4119603">_</span><span class="op" id="4119604">,</span>&nbsp;<span class="ident" id="4119606">err</span>&nbsp;<span class="op" id="4119610">:=</span>&nbsp;<span class="ident" id="4119613">asn1</span><span class="op" id="4119617">.</span><span class="ident" id="4119618">Unmarshal</span><span class="op" id="4119627">(</span><span class="ident" id="4119628">in</span><span class="op" id="4119630">.</span><span class="ident" id="4119631">TBSCertificate</span><span class="op" id="4119645">.</span><span class="ident" id="4119646">Subject</span><span class="op" id="4119653">.</span><span class="ident" id="4119654">FullBytes</span><span class="op" id="4119663">,</span>&nbsp;<span class="op" id="4119665">&amp;</span><span class="ident" id="4119666">subject</span><span class="op" id="4119673">)</span><span class="op" id="4119674">;</span>&nbsp;<span class="ident" id="4119676">err</span>&nbsp;<span class="op" id="4119680">!=</span>&nbsp;<span class="ident" id="4119683">nil</span>&nbsp;<span class="op" id="4119687">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119691">return</span>&nbsp;<span class="ident" id="4119698">nil</span><span class="op" id="4119701">,</span>&nbsp;<span class="ident" id="4119703">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119711">if</span>&nbsp;<span class="ident" id="4119714">_</span><span class="op" id="4119715">,</span>&nbsp;<span class="ident" id="4119717">err</span>&nbsp;<span class="op" id="4119721">:=</span>&nbsp;<span class="ident" id="4119724">asn1</span><span class="op" id="4119728">.</span><span class="ident" id="4119729">Unmarshal</span><span class="op" id="4119738">(</span><span class="ident" id="4119739">in</span><span class="op" id="4119741">.</span><span class="ident" id="4119742">TBSCertificate</span><span class="op" id="4119756">.</span><span class="ident" id="4119757">Issuer</span><span class="op" id="4119763">.</span><span class="ident" id="4119764">FullBytes</span><span class="op" id="4119773">,</span>&nbsp;<span class="op" id="4119775">&amp;</span><span class="ident" id="4119776">issuer</span><span class="op" id="4119782">)</span><span class="op" id="4119783">;</span>&nbsp;<span class="ident" id="4119785">err</span>&nbsp;<span class="op" id="4119789">!=</span>&nbsp;<span class="ident" id="4119792">nil</span>&nbsp;<span class="op" id="4119796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119800">return</span>&nbsp;<span class="ident" id="4119807">nil</span><span class="op" id="4119810">,</span>&nbsp;<span class="ident" id="4119812">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119817">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119821">out</span><span class="op" id="4119824">.</span><span class="ident" id="4119825">Issuer</span><span class="op" id="4119831">.</span><span class="ident" id="4119832">FillFromRDNSequence</span><span class="op" id="4119851">(</span><span class="op" id="4119852">&amp;</span><span class="ident" id="4119853">issuer</span><span class="op" id="4119859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119862">out</span><span class="op" id="4119865">.</span><span class="ident" id="4119866">Subject</span><span class="op" id="4119873">.</span><span class="ident" id="4119874">FillFromRDNSequence</span><span class="op" id="4119893">(</span><span class="op" id="4119894">&amp;</span><span class="ident" id="4119895">subject</span><span class="op" id="4119902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119906">out</span><span class="op" id="4119909">.</span><span class="ident" id="4119910">NotBefore</span>&nbsp;<span class="op" id="4119920">=</span>&nbsp;<span class="ident" id="4119922">in</span><span class="op" id="4119924">.</span><span class="ident" id="4119925">TBSCertificate</span><span class="op" id="4119939">.</span><span class="ident" id="4119940">Validity</span><span class="op" id="4119948">.</span><span class="ident" id="4119949">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119960">out</span><span class="op" id="4119963">.</span><span class="ident" id="4119964">NotAfter</span>&nbsp;<span class="op" id="4119973">=</span>&nbsp;<span class="ident" id="4119975">in</span><span class="op" id="4119977">.</span><span class="ident" id="4119978">TBSCertificate</span><span class="op" id="4119992">.</span><span class="ident" id="4119993">Validity</span><span class="op" id="4120001">.</span><span class="ident" id="4120002">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120013">for</span>&nbsp;<span class="ident" id="4120017">_</span><span class="op" id="4120018">,</span>&nbsp;<span class="ident" id="4120020">e</span>&nbsp;<span class="op" id="4120022">:=</span>&nbsp;<span class="keyword" id="4120025">range</span>&nbsp;<span class="ident" id="4120031">in</span><span class="op" id="4120033">.</span><span class="ident" id="4120034">TBSCertificate</span><span class="op" id="4120048">.</span><span class="ident" id="4120049">Extensions</span>&nbsp;<span class="op" id="4120060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120064">out</span><span class="op" id="4120067">.</span><span class="ident" id="4120068">Extensions</span>&nbsp;<span class="op" id="4120079">=</span>&nbsp;<span class="builtinfunc" id="4120081">append</span><span class="op" id="4120087">(</span><span class="ident" id="4120088">out</span><span class="op" id="4120091">.</span><span class="ident" id="4120092">Extensions</span><span class="op" id="4120102">,</span>&nbsp;<span class="ident" id="4120104">e</span><span class="op" id="4120105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120110">if</span>&nbsp;<span class="builtinfunc" id="4120113">len</span><span class="op" id="4120116">(</span><span class="ident" id="4120117">e</span><span class="op" id="4120118">.</span><span class="ident" id="4120119">Id</span><span class="op" id="4120121">)</span>&nbsp;<span class="op" id="4120123">==</span>&nbsp;<span class="num" id="4120126">4</span>&nbsp;<span class="op" id="4120128">&amp;&amp;</span>&nbsp;<span class="ident" id="4120131">e</span><span class="op" id="4120132">.</span><span class="ident" id="4120133">Id</span><span class="op" id="4120135">[</span><span class="num" id="4120136">0</span><span class="op" id="4120137">]</span>&nbsp;<span class="op" id="4120139">==</span>&nbsp;<span class="num" id="4120142">2</span>&nbsp;<span class="op" id="4120144">&amp;&amp;</span>&nbsp;<span class="ident" id="4120147">e</span><span class="op" id="4120148">.</span><span class="ident" id="4120149">Id</span><span class="op" id="4120151">[</span><span class="num" id="4120152">1</span><span class="op" id="4120153">]</span>&nbsp;<span class="op" id="4120155">==</span>&nbsp;<span class="num" id="4120158">5</span>&nbsp;<span class="op" id="4120160">&amp;&amp;</span>&nbsp;<span class="ident" id="4120163">e</span><span class="op" id="4120164">.</span><span class="ident" id="4120165">Id</span><span class="op" id="4120167">[</span><span class="num" id="4120168">2</span><span class="op" id="4120169">]</span>&nbsp;<span class="op" id="4120171">==</span>&nbsp;<span class="num" id="4120174">29</span>&nbsp;<span class="op" id="4120177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120182">switch</span>&nbsp;<span class="ident" id="4120189">e</span><span class="op" id="4120190">.</span><span class="ident" id="4120191">Id</span><span class="op" id="4120193">[</span><span class="num" id="4120194">3</span><span class="op" id="4120195">]</span>&nbsp;<span class="op" id="4120197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120202">case</span>&nbsp;<span class="num" id="4120207">15</span><span class="op" id="4120209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120215">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120240">var</span>&nbsp;<span class="ident" id="4120244">usageBits</span>&nbsp;<span class="ident" id="4120254">asn1</span><span class="op" id="4120258">.</span><span class="ident" id="4120259">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120273">_</span><span class="op" id="4120274">,</span>&nbsp;<span class="ident" id="4120276">err</span>&nbsp;<span class="op" id="4120280">:=</span>&nbsp;<span class="ident" id="4120283">asn1</span><span class="op" id="4120287">.</span><span class="ident" id="4120288">Unmarshal</span><span class="op" id="4120297">(</span><span class="ident" id="4120298">e</span><span class="op" id="4120299">.</span><span class="ident" id="4120300">Value</span><span class="op" id="4120305">,</span>&nbsp;<span class="op" id="4120307">&amp;</span><span class="ident" id="4120308">usageBits</span><span class="op" id="4120317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120324">if</span>&nbsp;<span class="ident" id="4120327">err</span>&nbsp;<span class="op" id="4120331">==</span>&nbsp;<span class="ident" id="4120334">nil</span>&nbsp;<span class="op" id="4120338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120345">var</span>&nbsp;<span class="ident" id="4120349">usage</span>&nbsp;<span class="builtintype" id="4120355">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120364">for</span>&nbsp;<span class="ident" id="4120368">i</span>&nbsp;<span class="op" id="4120370">:=</span>&nbsp;<span class="num" id="4120373">0</span><span class="op" id="4120374">;</span>&nbsp;<span class="ident" id="4120376">i</span>&nbsp;<span class="op" id="4120378">&lt;</span>&nbsp;<span class="num" id="4120380">9</span><span class="op" id="4120381">;</span>&nbsp;<span class="ident" id="4120383">i</span><span class="op" id="4120384">++</span>&nbsp;<span class="op" id="4120387">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120395">if</span>&nbsp;<span class="ident" id="4120398">usageBits</span><span class="op" id="4120407">.</span><span class="ident" id="4120408">At</span><span class="op" id="4120410">(</span><span class="ident" id="4120411">i</span><span class="op" id="4120412">)</span>&nbsp;<span class="op" id="4120414">!=</span>&nbsp;<span class="num" id="4120417">0</span>&nbsp;<span class="op" id="4120419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120428">usage</span>&nbsp;<span class="op" id="4120434">|=</span>&nbsp;<span class="num" id="4120437">1</span>&nbsp;<span class="op" id="4120439">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4120442">uint</span><span class="op" id="4120446">(</span><span class="ident" id="4120447">i</span><span class="op" id="4120448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120470">out</span><span class="op" id="4120473">.</span><span class="ident" id="4120474">KeyUsage</span>&nbsp;<span class="op" id="4120483">=</span>&nbsp;<span class="ident" id="4120485">KeyUsage</span><span class="op" id="4120493">(</span><span class="ident" id="4120494">usage</span><span class="op" id="4120499">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120506">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120524">case</span>&nbsp;<span class="num" id="4120529">19</span><span class="op" id="4120531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120537">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120562">var</span>&nbsp;<span class="ident" id="4120566">constraints</span>&nbsp;<span class="ident" id="4120578">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120599">_</span><span class="op" id="4120600">,</span>&nbsp;<span class="ident" id="4120602">err</span>&nbsp;<span class="op" id="4120606">:=</span>&nbsp;<span class="ident" id="4120609">asn1</span><span class="op" id="4120613">.</span><span class="ident" id="4120614">Unmarshal</span><span class="op" id="4120623">(</span><span class="ident" id="4120624">e</span><span class="op" id="4120625">.</span><span class="ident" id="4120626">Value</span><span class="op" id="4120631">,</span>&nbsp;<span class="op" id="4120633">&amp;</span><span class="ident" id="4120634">constraints</span><span class="op" id="4120645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120652">if</span>&nbsp;<span class="ident" id="4120655">err</span>&nbsp;<span class="op" id="4120659">==</span>&nbsp;<span class="ident" id="4120662">nil</span>&nbsp;<span class="op" id="4120666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120673">out</span><span class="op" id="4120676">.</span><span class="ident" id="4120677">BasicConstraintsValid</span>&nbsp;<span class="op" id="4120699">=</span>&nbsp;<span class="ident" id="4120701">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120711">out</span><span class="op" id="4120714">.</span><span class="ident" id="4120715">IsCA</span>&nbsp;<span class="op" id="4120720">=</span>&nbsp;<span class="ident" id="4120722">constraints</span><span class="op" id="4120733">.</span><span class="ident" id="4120734">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120744">out</span><span class="op" id="4120747">.</span><span class="ident" id="4120748">MaxPathLen</span>&nbsp;<span class="op" id="4120759">=</span>&nbsp;<span class="ident" id="4120761">constraints</span><span class="op" id="4120772">.</span><span class="ident" id="4120773">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120789">out</span><span class="op" id="4120792">.</span><span class="ident" id="4120793">MaxPathLenZero</span>&nbsp;<span class="op" id="4120808">=</span>&nbsp;<span class="ident" id="4120810">out</span><span class="op" id="4120813">.</span><span class="ident" id="4120814">MaxPathLen</span>&nbsp;<span class="op" id="4120825">==</span>&nbsp;<span class="num" id="4120828">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120835">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120853">case</span>&nbsp;<span class="num" id="4120858">17</span><span class="op" id="4120860">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120866">out</span><span class="op" id="4120869">.</span><span class="ident" id="4120870">DNSNames</span><span class="op" id="4120878">,</span>&nbsp;<span class="ident" id="4120880">out</span><span class="op" id="4120883">.</span><span class="ident" id="4120884">EmailAddresses</span><span class="op" id="4120898">,</span>&nbsp;<span class="ident" id="4120900">out</span><span class="op" id="4120903">.</span><span class="ident" id="4120904">IPAddresses</span><span class="op" id="4120915">,</span>&nbsp;<span class="ident" id="4120917">err</span>&nbsp;<span class="op" id="4120921">=</span>&nbsp;<span class="ident" id="4120923">parseSANExtension</span><span class="op" id="4120940">(</span><span class="ident" id="4120941">e</span><span class="op" id="4120942">.</span><span class="ident" id="4120943">Value</span><span class="op" id="4120948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120954">if</span>&nbsp;<span class="ident" id="4120957">err</span>&nbsp;<span class="op" id="4120961">!=</span>&nbsp;<span class="ident" id="4120964">nil</span>&nbsp;<span class="op" id="4120968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120975">return</span>&nbsp;<span class="ident" id="4120982">nil</span><span class="op" id="4120985">,</span>&nbsp;<span class="ident" id="4120987">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121002">if</span>&nbsp;<span class="builtinfunc" id="4121005">len</span><span class="op" id="4121008">(</span><span class="ident" id="4121009">out</span><span class="op" id="4121012">.</span><span class="ident" id="4121013">DNSNames</span><span class="op" id="4121021">)</span>&nbsp;<span class="op" id="4121023">&gt;</span>&nbsp;<span class="num" id="4121025">0</span>&nbsp;<span class="op" id="4121027">||</span>&nbsp;<span class="builtinfunc" id="4121030">len</span><span class="op" id="4121033">(</span><span class="ident" id="4121034">out</span><span class="op" id="4121037">.</span><span class="ident" id="4121038">EmailAddresses</span><span class="op" id="4121052">)</span>&nbsp;<span class="op" id="4121054">&gt;</span>&nbsp;<span class="num" id="4121056">0</span>&nbsp;<span class="op" id="4121058">||</span>&nbsp;<span class="builtinfunc" id="4121061">len</span><span class="op" id="4121064">(</span><span class="ident" id="4121065">out</span><span class="op" id="4121068">.</span><span class="ident" id="4121069">IPAddresses</span><span class="op" id="4121080">)</span>&nbsp;<span class="op" id="4121082">&gt;</span>&nbsp;<span class="num" id="4121084">0</span>&nbsp;<span class="op" id="4121086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121093">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121112">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121163">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121212">case</span>&nbsp;<span class="num" id="4121217">30</span><span class="op" id="4121219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121225">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121252">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121290">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121431">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121438">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121506">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121513">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121550">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121599">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121659">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121719">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121726">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121768">var</span>&nbsp;<span class="ident" id="4121772">constraints</span>&nbsp;<span class="ident" id="4121784">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121804">_</span><span class="op" id="4121805">,</span>&nbsp;<span class="ident" id="4121807">err</span>&nbsp;<span class="op" id="4121811">:=</span>&nbsp;<span class="ident" id="4121814">asn1</span><span class="op" id="4121818">.</span><span class="ident" id="4121819">Unmarshal</span><span class="op" id="4121828">(</span><span class="ident" id="4121829">e</span><span class="op" id="4121830">.</span><span class="ident" id="4121831">Value</span><span class="op" id="4121836">,</span>&nbsp;<span class="op" id="4121838">&amp;</span><span class="ident" id="4121839">constraints</span><span class="op" id="4121850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121856">if</span>&nbsp;<span class="ident" id="4121859">err</span>&nbsp;<span class="op" id="4121863">!=</span>&nbsp;<span class="ident" id="4121866">nil</span>&nbsp;<span class="op" id="4121870">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121877">return</span>&nbsp;<span class="ident" id="4121884">nil</span><span class="op" id="4121887">,</span>&nbsp;<span class="ident" id="4121889">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121904">if</span>&nbsp;<span class="builtinfunc" id="4121907">len</span><span class="op" id="4121910">(</span><span class="ident" id="4121911">constraints</span><span class="op" id="4121922">.</span><span class="ident" id="4121923">Excluded</span><span class="op" id="4121931">)</span>&nbsp;<span class="op" id="4121933">&gt;</span>&nbsp;<span class="num" id="4121935">0</span>&nbsp;<span class="op" id="4121937">&amp;&amp;</span>&nbsp;<span class="ident" id="4121940">e</span><span class="op" id="4121941">.</span><span class="ident" id="4121942">Critical</span>&nbsp;<span class="op" id="4121951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121958">return</span>&nbsp;<span class="ident" id="4121965">out</span><span class="op" id="4121968">,</span>&nbsp;<span class="ident" id="4121970">UnhandledCriticalExtension</span><span class="op" id="4121996">{</span><span class="op" id="4121997">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122010">for</span>&nbsp;<span class="ident" id="4122014">_</span><span class="op" id="4122015">,</span>&nbsp;<span class="ident" id="4122017">subtree</span>&nbsp;<span class="op" id="4122025">:=</span>&nbsp;<span class="keyword" id="4122028">range</span>&nbsp;<span class="ident" id="4122034">constraints</span><span class="op" id="4122045">.</span><span class="ident" id="4122046">Permitted</span>&nbsp;<span class="op" id="4122056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122063">if</span>&nbsp;<span class="builtinfunc" id="4122066">len</span><span class="op" id="4122069">(</span><span class="ident" id="4122070">subtree</span><span class="op" id="4122077">.</span><span class="ident" id="4122078">Name</span><span class="op" id="4122082">)</span>&nbsp;<span class="op" id="4122084">==</span>&nbsp;<span class="num" id="4122087">0</span>&nbsp;<span class="op" id="4122089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122097">if</span>&nbsp;<span class="ident" id="4122100">e</span><span class="op" id="4122101">.</span><span class="ident" id="4122102">Critical</span>&nbsp;<span class="op" id="4122111">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122120">return</span>&nbsp;<span class="ident" id="4122127">out</span><span class="op" id="4122130">,</span>&nbsp;<span class="ident" id="4122132">UnhandledCriticalExtension</span><span class="op" id="4122158">{</span><span class="op" id="4122159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122175">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122196">out</span><span class="op" id="4122199">.</span><span class="ident" id="4122200">PermittedDNSDomains</span>&nbsp;<span class="op" id="4122220">=</span>&nbsp;<span class="builtinfunc" id="4122222">append</span><span class="op" id="4122228">(</span><span class="ident" id="4122229">out</span><span class="op" id="4122232">.</span><span class="ident" id="4122233">PermittedDNSDomains</span><span class="op" id="4122252">,</span>&nbsp;<span class="ident" id="4122254">subtree</span><span class="op" id="4122261">.</span><span class="ident" id="4122262">Name</span><span class="op" id="4122266">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122278">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122291">case</span>&nbsp;<span class="num" id="4122296">31</span><span class="op" id="4122298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122304">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122331">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122408">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122415">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122455">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122662">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122669">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122768">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122840">var</span>&nbsp;<span class="ident" id="4122844">cdp</span>&nbsp;<span class="op" id="4122848">[</span><span class="op" id="4122849">]</span><span class="ident" id="4122850">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122872">_</span><span class="op" id="4122873">,</span>&nbsp;<span class="ident" id="4122875">err</span>&nbsp;<span class="op" id="4122879">:=</span>&nbsp;<span class="ident" id="4122882">asn1</span><span class="op" id="4122886">.</span><span class="ident" id="4122887">Unmarshal</span><span class="op" id="4122896">(</span><span class="ident" id="4122897">e</span><span class="op" id="4122898">.</span><span class="ident" id="4122899">Value</span><span class="op" id="4122904">,</span>&nbsp;<span class="op" id="4122906">&amp;</span><span class="ident" id="4122907">cdp</span><span class="op" id="4122910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122916">if</span>&nbsp;<span class="ident" id="4122919">err</span>&nbsp;<span class="op" id="4122923">!=</span>&nbsp;<span class="ident" id="4122926">nil</span>&nbsp;<span class="op" id="4122930">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122937">return</span>&nbsp;<span class="ident" id="4122944">nil</span><span class="op" id="4122947">,</span>&nbsp;<span class="ident" id="4122949">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122964">for</span>&nbsp;<span class="ident" id="4122968">_</span><span class="op" id="4122969">,</span>&nbsp;<span class="ident" id="4122971">dp</span>&nbsp;<span class="op" id="4122974">:=</span>&nbsp;<span class="keyword" id="4122977">range</span>&nbsp;<span class="ident" id="4122983">cdp</span>&nbsp;<span class="op" id="4122987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122994">var</span>&nbsp;<span class="ident" id="4122998">n</span>&nbsp;<span class="ident" id="4123000">asn1</span><span class="op" id="4123004">.</span><span class="ident" id="4123005">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123019">_</span><span class="op" id="4123020">,</span>&nbsp;<span class="ident" id="4123022">err</span>&nbsp;<span class="op" id="4123026">=</span>&nbsp;<span class="ident" id="4123028">asn1</span><span class="op" id="4123032">.</span><span class="ident" id="4123033">Unmarshal</span><span class="op" id="4123042">(</span><span class="ident" id="4123043">dp</span><span class="op" id="4123045">.</span><span class="ident" id="4123046">DistributionPoint</span><span class="op" id="4123063">.</span><span class="ident" id="4123064">FullName</span><span class="op" id="4123072">.</span><span class="ident" id="4123073">Bytes</span><span class="op" id="4123078">,</span>&nbsp;<span class="op" id="4123080">&amp;</span><span class="ident" id="4123081">n</span><span class="op" id="4123082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123089">if</span>&nbsp;<span class="ident" id="4123092">err</span>&nbsp;<span class="op" id="4123096">!=</span>&nbsp;<span class="ident" id="4123099">nil</span>&nbsp;<span class="op" id="4123103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123111">return</span>&nbsp;<span class="ident" id="4123118">nil</span><span class="op" id="4123121">,</span>&nbsp;<span class="ident" id="4123123">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123140">if</span>&nbsp;<span class="ident" id="4123143">n</span><span class="op" id="4123144">.</span><span class="ident" id="4123145">Tag</span>&nbsp;<span class="op" id="4123149">==</span>&nbsp;<span class="num" id="4123152">6</span>&nbsp;<span class="op" id="4123154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123162">out</span><span class="op" id="4123165">.</span><span class="ident" id="4123166">CRLDistributionPoints</span>&nbsp;<span class="op" id="4123188">=</span>&nbsp;<span class="builtinfunc" id="4123190">append</span><span class="op" id="4123196">(</span><span class="ident" id="4123197">out</span><span class="op" id="4123200">.</span><span class="ident" id="4123201">CRLDistributionPoints</span><span class="op" id="4123222">,</span>&nbsp;<span class="builtintype" id="4123224">string</span><span class="op" id="4123230">(</span><span class="ident" id="4123231">n</span><span class="op" id="4123232">.</span><span class="ident" id="4123233">Bytes</span><span class="op" id="4123238">)</span><span class="op" id="4123239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123258">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123271">case</span>&nbsp;<span class="num" id="4123276">35</span><span class="op" id="4123278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123284">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123309">var</span>&nbsp;<span class="ident" id="4123313">a</span>&nbsp;<span class="ident" id="4123315">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123329">_</span><span class="op" id="4123330">,</span>&nbsp;<span class="ident" id="4123332">err</span>&nbsp;<span class="op" id="4123336">=</span>&nbsp;<span class="ident" id="4123338">asn1</span><span class="op" id="4123342">.</span><span class="ident" id="4123343">Unmarshal</span><span class="op" id="4123352">(</span><span class="ident" id="4123353">e</span><span class="op" id="4123354">.</span><span class="ident" id="4123355">Value</span><span class="op" id="4123360">,</span>&nbsp;<span class="op" id="4123362">&amp;</span><span class="ident" id="4123363">a</span><span class="op" id="4123364">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123370">if</span>&nbsp;<span class="ident" id="4123373">err</span>&nbsp;<span class="op" id="4123377">!=</span>&nbsp;<span class="ident" id="4123380">nil</span>&nbsp;<span class="op" id="4123384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123391">return</span>&nbsp;<span class="ident" id="4123398">nil</span><span class="op" id="4123401">,</span>&nbsp;<span class="ident" id="4123403">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123417">out</span><span class="op" id="4123420">.</span><span class="ident" id="4123421">AuthorityKeyId</span>&nbsp;<span class="op" id="4123436">=</span>&nbsp;<span class="ident" id="4123438">a</span><span class="op" id="4123439">.</span><span class="ident" id="4123440">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123447">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123460">case</span>&nbsp;<span class="num" id="4123465">37</span><span class="op" id="4123467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123473">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123521">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123581">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123588">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123656">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123663">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123706">var</span>&nbsp;<span class="ident" id="4123710">keyUsage</span>&nbsp;<span class="op" id="4123719">[</span><span class="op" id="4123720">]</span><span class="ident" id="4123721">asn1</span><span class="op" id="4123725">.</span><span class="ident" id="4123726">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123747">_</span><span class="op" id="4123748">,</span>&nbsp;<span class="ident" id="4123750">err</span>&nbsp;<span class="op" id="4123754">=</span>&nbsp;<span class="ident" id="4123756">asn1</span><span class="op" id="4123760">.</span><span class="ident" id="4123761">Unmarshal</span><span class="op" id="4123770">(</span><span class="ident" id="4123771">e</span><span class="op" id="4123772">.</span><span class="ident" id="4123773">Value</span><span class="op" id="4123778">,</span>&nbsp;<span class="op" id="4123780">&amp;</span><span class="ident" id="4123781">keyUsage</span><span class="op" id="4123789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123795">if</span>&nbsp;<span class="ident" id="4123798">err</span>&nbsp;<span class="op" id="4123802">!=</span>&nbsp;<span class="ident" id="4123805">nil</span>&nbsp;<span class="op" id="4123809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123816">return</span>&nbsp;<span class="ident" id="4123823">nil</span><span class="op" id="4123826">,</span>&nbsp;<span class="ident" id="4123828">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123836">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123843">for</span>&nbsp;<span class="ident" id="4123847">_</span><span class="op" id="4123848">,</span>&nbsp;<span class="ident" id="4123850">u</span>&nbsp;<span class="op" id="4123852">:=</span>&nbsp;<span class="keyword" id="4123855">range</span>&nbsp;<span class="ident" id="4123861">keyUsage</span>&nbsp;<span class="op" id="4123870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123877">if</span>&nbsp;<span class="ident" id="4123880">extKeyUsage</span><span class="op" id="4123891">,</span>&nbsp;<span class="ident" id="4123893">ok</span>&nbsp;<span class="op" id="4123896">:=</span>&nbsp;<span class="ident" id="4123899">extKeyUsageFromOID</span><span class="op" id="4123917">(</span><span class="ident" id="4123918">u</span><span class="op" id="4123919">)</span><span class="op" id="4123920">;</span>&nbsp;<span class="ident" id="4123922">ok</span>&nbsp;<span class="op" id="4123925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123933">out</span><span class="op" id="4123936">.</span><span class="ident" id="4123937">ExtKeyUsage</span>&nbsp;<span class="op" id="4123949">=</span>&nbsp;<span class="builtinfunc" id="4123951">append</span><span class="op" id="4123957">(</span><span class="ident" id="4123958">out</span><span class="op" id="4123961">.</span><span class="ident" id="4123962">ExtKeyUsage</span><span class="op" id="4123973">,</span>&nbsp;<span class="ident" id="4123975">extKeyUsage</span><span class="op" id="4123986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123993">}</span>&nbsp;<span class="keyword" id="4123995">else</span>&nbsp;<span class="op" id="4124000">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124008">out</span><span class="op" id="4124011">.</span><span class="ident" id="4124012">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4124031">=</span>&nbsp;<span class="builtinfunc" id="4124033">append</span><span class="op" id="4124039">(</span><span class="ident" id="4124040">out</span><span class="op" id="4124043">.</span><span class="ident" id="4124044">UnknownExtKeyUsage</span><span class="op" id="4124062">,</span>&nbsp;<span class="ident" id="4124064">u</span><span class="op" id="4124065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124085">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124098">case</span>&nbsp;<span class="num" id="4124103">14</span><span class="op" id="4124105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124111">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124136">var</span>&nbsp;<span class="ident" id="4124140">keyid</span>&nbsp;<span class="op" id="4124146">[</span><span class="op" id="4124147">]</span><span class="builtintype" id="4124148">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124157">_</span><span class="op" id="4124158">,</span>&nbsp;<span class="ident" id="4124160">err</span>&nbsp;<span class="op" id="4124164">=</span>&nbsp;<span class="ident" id="4124166">asn1</span><span class="op" id="4124170">.</span><span class="ident" id="4124171">Unmarshal</span><span class="op" id="4124180">(</span><span class="ident" id="4124181">e</span><span class="op" id="4124182">.</span><span class="ident" id="4124183">Value</span><span class="op" id="4124188">,</span>&nbsp;<span class="op" id="4124190">&amp;</span><span class="ident" id="4124191">keyid</span><span class="op" id="4124196">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124202">if</span>&nbsp;<span class="ident" id="4124205">err</span>&nbsp;<span class="op" id="4124209">!=</span>&nbsp;<span class="ident" id="4124212">nil</span>&nbsp;<span class="op" id="4124216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124223">return</span>&nbsp;<span class="ident" id="4124230">nil</span><span class="op" id="4124233">,</span>&nbsp;<span class="ident" id="4124235">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124249">out</span><span class="op" id="4124252">.</span><span class="ident" id="4124253">SubjectKeyId</span>&nbsp;<span class="op" id="4124266">=</span>&nbsp;<span class="ident" id="4124268">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124278">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124291">case</span>&nbsp;<span class="num" id="4124296">32</span><span class="op" id="4124298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124304">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124350">var</span>&nbsp;<span class="ident" id="4124354">policies</span>&nbsp;<span class="op" id="4124363">[</span><span class="op" id="4124364">]</span><span class="ident" id="4124365">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124387">if</span>&nbsp;<span class="ident" id="4124390">_</span><span class="op" id="4124391">,</span>&nbsp;<span class="ident" id="4124393">err</span>&nbsp;<span class="op" id="4124397">=</span>&nbsp;<span class="ident" id="4124399">asn1</span><span class="op" id="4124403">.</span><span class="ident" id="4124404">Unmarshal</span><span class="op" id="4124413">(</span><span class="ident" id="4124414">e</span><span class="op" id="4124415">.</span><span class="ident" id="4124416">Value</span><span class="op" id="4124421">,</span>&nbsp;<span class="op" id="4124423">&amp;</span><span class="ident" id="4124424">policies</span><span class="op" id="4124432">)</span><span class="op" id="4124433">;</span>&nbsp;<span class="ident" id="4124435">err</span>&nbsp;<span class="op" id="4124439">!=</span>&nbsp;<span class="ident" id="4124442">nil</span>&nbsp;<span class="op" id="4124446">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124453">return</span>&nbsp;<span class="ident" id="4124460">nil</span><span class="op" id="4124463">,</span>&nbsp;<span class="ident" id="4124465">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124479">out</span><span class="op" id="4124482">.</span><span class="ident" id="4124483">PolicyIdentifiers</span>&nbsp;<span class="op" id="4124501">=</span>&nbsp;<span class="builtinfunc" id="4124503">make</span><span class="op" id="4124507">(</span><span class="op" id="4124508">[</span><span class="op" id="4124509">]</span><span class="ident" id="4124510">asn1</span><span class="op" id="4124514">.</span><span class="ident" id="4124515">ObjectIdentifier</span><span class="op" id="4124531">,</span>&nbsp;<span class="builtinfunc" id="4124533">len</span><span class="op" id="4124536">(</span><span class="ident" id="4124537">policies</span><span class="op" id="4124545">)</span><span class="op" id="4124546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124552">for</span>&nbsp;<span class="ident" id="4124556">i</span><span class="op" id="4124557">,</span>&nbsp;<span class="ident" id="4124559">policy</span>&nbsp;<span class="op" id="4124566">:=</span>&nbsp;<span class="keyword" id="4124569">range</span>&nbsp;<span class="ident" id="4124575">policies</span>&nbsp;<span class="op" id="4124584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124591">out</span><span class="op" id="4124594">.</span><span class="ident" id="4124595">PolicyIdentifiers</span><span class="op" id="4124612">[</span><span class="ident" id="4124613">i</span><span class="op" id="4124614">]</span>&nbsp;<span class="op" id="4124616">=</span>&nbsp;<span class="ident" id="4124618">policy</span><span class="op" id="4124624">.</span><span class="ident" id="4124625">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124645">}</span>&nbsp;<span class="keyword" id="4124647">else</span>&nbsp;<span class="keyword" id="4124652">if</span>&nbsp;<span class="ident" id="4124655">e</span><span class="op" id="4124656">.</span><span class="ident" id="4124657">Id</span><span class="op" id="4124659">.</span><span class="ident" id="4124660">Equal</span><span class="op" id="4124665">(</span><span class="ident" id="4124666">oidExtensionAuthorityInfoAccess</span><span class="op" id="4124697">)</span>&nbsp;<span class="op" id="4124699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124704">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124757">var</span>&nbsp;<span class="ident" id="4124761">aia</span>&nbsp;<span class="op" id="4124765">[</span><span class="op" id="4124766">]</span><span class="ident" id="4124767">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124790">if</span>&nbsp;<span class="ident" id="4124793">_</span><span class="op" id="4124794">,</span>&nbsp;<span class="ident" id="4124796">err</span>&nbsp;<span class="op" id="4124800">=</span>&nbsp;<span class="ident" id="4124802">asn1</span><span class="op" id="4124806">.</span><span class="ident" id="4124807">Unmarshal</span><span class="op" id="4124816">(</span><span class="ident" id="4124817">e</span><span class="op" id="4124818">.</span><span class="ident" id="4124819">Value</span><span class="op" id="4124824">,</span>&nbsp;<span class="op" id="4124826">&amp;</span><span class="ident" id="4124827">aia</span><span class="op" id="4124830">)</span><span class="op" id="4124831">;</span>&nbsp;<span class="ident" id="4124833">err</span>&nbsp;<span class="op" id="4124837">!=</span>&nbsp;<span class="ident" id="4124840">nil</span>&nbsp;<span class="op" id="4124844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124850">return</span>&nbsp;<span class="ident" id="4124857">nil</span><span class="op" id="4124860">,</span>&nbsp;<span class="ident" id="4124862">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4124869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124875">for</span>&nbsp;<span class="ident" id="4124879">_</span><span class="op" id="4124880">,</span>&nbsp;<span class="ident" id="4124882">v</span>&nbsp;<span class="op" id="4124884">:=</span>&nbsp;<span class="keyword" id="4124887">range</span>&nbsp;<span class="ident" id="4124893">aia</span>&nbsp;<span class="op" id="4124897">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124903">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124963">if</span>&nbsp;<span class="ident" id="4124966">v</span><span class="op" id="4124967">.</span><span class="ident" id="4124968">Location</span><span class="op" id="4124976">.</span><span class="ident" id="4124977">Tag</span>&nbsp;<span class="op" id="4124981">!=</span>&nbsp;<span class="num" id="4124984">6</span>&nbsp;<span class="op" id="4124986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124993">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125012">if</span>&nbsp;<span class="ident" id="4125015">v</span><span class="op" id="4125016">.</span><span class="ident" id="4125017">Method</span><span class="op" id="4125023">.</span><span class="ident" id="4125024">Equal</span><span class="op" id="4125029">(</span><span class="ident" id="4125030">oidAuthorityInfoAccessOcsp</span><span class="op" id="4125056">)</span>&nbsp;<span class="op" id="4125058">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125065">out</span><span class="op" id="4125068">.</span><span class="ident" id="4125069">OCSPServer</span>&nbsp;<span class="op" id="4125080">=</span>&nbsp;<span class="builtinfunc" id="4125082">append</span><span class="op" id="4125088">(</span><span class="ident" id="4125089">out</span><span class="op" id="4125092">.</span><span class="ident" id="4125093">OCSPServer</span><span class="op" id="4125103">,</span>&nbsp;<span class="builtintype" id="4125105">string</span><span class="op" id="4125111">(</span><span class="ident" id="4125112">v</span><span class="op" id="4125113">.</span><span class="ident" id="4125114">Location</span><span class="op" id="4125122">.</span><span class="ident" id="4125123">Bytes</span><span class="op" id="4125128">)</span><span class="op" id="4125129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125135">}</span>&nbsp;<span class="keyword" id="4125137">else</span>&nbsp;<span class="keyword" id="4125142">if</span>&nbsp;<span class="ident" id="4125145">v</span><span class="op" id="4125146">.</span><span class="ident" id="4125147">Method</span><span class="op" id="4125153">.</span><span class="ident" id="4125154">Equal</span><span class="op" id="4125159">(</span><span class="ident" id="4125160">oidAuthorityInfoAccessIssuers</span><span class="op" id="4125189">)</span>&nbsp;<span class="op" id="4125191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125198">out</span><span class="op" id="4125201">.</span><span class="ident" id="4125202">IssuingCertificateURL</span>&nbsp;<span class="op" id="4125224">=</span>&nbsp;<span class="builtinfunc" id="4125226">append</span><span class="op" id="4125232">(</span><span class="ident" id="4125233">out</span><span class="op" id="4125236">.</span><span class="ident" id="4125237">IssuingCertificateURL</span><span class="op" id="4125258">,</span>&nbsp;<span class="builtintype" id="4125260">string</span><span class="op" id="4125266">(</span><span class="ident" id="4125267">v</span><span class="op" id="4125268">.</span><span class="ident" id="4125269">Location</span><span class="op" id="4125277">.</span><span class="ident" id="4125278">Bytes</span><span class="op" id="4125283">)</span><span class="op" id="4125284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125295">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125304">if</span>&nbsp;<span class="ident" id="4125307">e</span><span class="op" id="4125308">.</span><span class="ident" id="4125309">Critical</span>&nbsp;<span class="op" id="4125318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125323">return</span>&nbsp;<span class="ident" id="4125330">out</span><span class="op" id="4125333">,</span>&nbsp;<span class="ident" id="4125335">UnhandledCriticalExtension</span><span class="op" id="4125361">{</span><span class="op" id="4125362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125366">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125373">return</span>&nbsp;<span class="ident" id="4125380">out</span><span class="op" id="4125383">,</span>&nbsp;<span class="ident" id="4125385">nil</span><br>
<span class="lineno"></span><span class="op" id="4125389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4125392">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4125471">func</span>&nbsp;<span class="ident" id="4125476">ParseCertificate</span><span class="op" id="4125492">(</span><span class="ident" id="4125493">asn1Data</span>&nbsp;<span class="op" id="4125502">[</span><span class="op" id="4125503">]</span><span class="builtintype" id="4125504">byte</span><span class="op" id="4125508">)</span>&nbsp;<span class="op" id="4125510">(</span><span class="op" id="4125511">*</span><span class="ident" id="4125512">Certificate</span><span class="op" id="4125523">,</span>&nbsp;<span class="builtintype" id="4125525">error</span><span class="op" id="4125530">)</span>&nbsp;<span class="op" id="4125532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125535">var</span>&nbsp;<span class="ident" id="4125539">cert</span>&nbsp;<span class="ident" id="4125544">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125557">rest</span><span class="op" id="4125561">,</span>&nbsp;<span class="ident" id="4125563">err</span>&nbsp;<span class="op" id="4125567">:=</span>&nbsp;<span class="ident" id="4125570">asn1</span><span class="op" id="4125574">.</span><span class="ident" id="4125575">Unmarshal</span><span class="op" id="4125584">(</span><span class="ident" id="4125585">asn1Data</span><span class="op" id="4125593">,</span>&nbsp;<span class="op" id="4125595">&amp;</span><span class="ident" id="4125596">cert</span><span class="op" id="4125600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125603">if</span>&nbsp;<span class="ident" id="4125606">err</span>&nbsp;<span class="op" id="4125610">!=</span>&nbsp;<span class="ident" id="4125613">nil</span>&nbsp;<span class="op" id="4125617">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125621">return</span>&nbsp;<span class="ident" id="4125628">nil</span><span class="op" id="4125631">,</span>&nbsp;<span class="ident" id="4125633">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125641">if</span>&nbsp;<span class="builtinfunc" id="4125644">len</span><span class="op" id="4125647">(</span><span class="ident" id="4125648">rest</span><span class="op" id="4125652">)</span>&nbsp;<span class="op" id="4125654">&gt;</span>&nbsp;<span class="num" id="4125656">0</span>&nbsp;<span class="op" id="4125658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125662">return</span>&nbsp;<span class="ident" id="4125669">nil</span><span class="op" id="4125672">,</span>&nbsp;<span class="ident" id="4125674">asn1</span><span class="op" id="4125678">.</span><span class="ident" id="4125679">SyntaxError</span><span class="op" id="4125690">{</span><span class="ident" id="4125691">Msg</span><span class="op" id="4125694">:</span>&nbsp;<span class="string" id="4125696">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4125711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125714">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125718">return</span>&nbsp;<span class="ident" id="4125725">parseCertificate</span><span class="op" id="4125741">(</span><span class="op" id="4125742">&amp;</span><span class="ident" id="4125743">cert</span><span class="op" id="4125747">)</span><br>
<span class="lineno"></span><span class="op" id="4125749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125752">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4125830">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4125907">func</span>&nbsp;<span class="ident" id="4125912">ParseCertificates</span><span class="op" id="4125929">(</span><span class="ident" id="4125930">asn1Data</span>&nbsp;<span class="op" id="4125939">[</span><span class="op" id="4125940">]</span><span class="builtintype" id="4125941">byte</span><span class="op" id="4125945">)</span>&nbsp;<span class="op" id="4125947">(</span><span class="op" id="4125948">[</span><span class="op" id="4125949">]</span><span class="op" id="4125950">*</span><span class="ident" id="4125951">Certificate</span><span class="op" id="4125962">,</span>&nbsp;<span class="builtintype" id="4125964">error</span><span class="op" id="4125969">)</span>&nbsp;<span class="op" id="4125971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125974">var</span>&nbsp;<span class="ident" id="4125978">v</span>&nbsp;<span class="op" id="4125980">[</span><span class="op" id="4125981">]</span><span class="op" id="4125982">*</span><span class="ident" id="4125983">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125997">for</span>&nbsp;<span class="builtinfunc" id="4126001">len</span><span class="op" id="4126004">(</span><span class="ident" id="4126005">asn1Data</span><span class="op" id="4126013">)</span>&nbsp;<span class="op" id="4126015">&gt;</span>&nbsp;<span class="num" id="4126017">0</span>&nbsp;<span class="op" id="4126019">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126023">cert</span>&nbsp;<span class="op" id="4126028">:=</span>&nbsp;<span class="builtinfunc" id="4126031">new</span><span class="op" id="4126034">(</span><span class="ident" id="4126035">certificate</span><span class="op" id="4126046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126050">var</span>&nbsp;<span class="ident" id="4126054">err</span>&nbsp;<span class="builtintype" id="4126058">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126066">asn1Data</span><span class="op" id="4126074">,</span>&nbsp;<span class="ident" id="4126076">err</span>&nbsp;<span class="op" id="4126080">=</span>&nbsp;<span class="ident" id="4126082">asn1</span><span class="op" id="4126086">.</span><span class="ident" id="4126087">Unmarshal</span><span class="op" id="4126096">(</span><span class="ident" id="4126097">asn1Data</span><span class="op" id="4126105">,</span>&nbsp;<span class="ident" id="4126107">cert</span><span class="op" id="4126111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126115">if</span>&nbsp;<span class="ident" id="4126118">err</span>&nbsp;<span class="op" id="4126122">!=</span>&nbsp;<span class="ident" id="4126125">nil</span>&nbsp;<span class="op" id="4126129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126134">return</span>&nbsp;<span class="ident" id="4126141">nil</span><span class="op" id="4126144">,</span>&nbsp;<span class="ident" id="4126146">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126156">v</span>&nbsp;<span class="op" id="4126158">=</span>&nbsp;<span class="builtinfunc" id="4126160">append</span><span class="op" id="4126166">(</span><span class="ident" id="4126167">v</span><span class="op" id="4126168">,</span>&nbsp;<span class="ident" id="4126170">cert</span><span class="op" id="4126174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126181">ret</span>&nbsp;<span class="op" id="4126185">:=</span>&nbsp;<span class="builtinfunc" id="4126188">make</span><span class="op" id="4126192">(</span><span class="op" id="4126193">[</span><span class="op" id="4126194">]</span><span class="op" id="4126195">*</span><span class="ident" id="4126196">Certificate</span><span class="op" id="4126207">,</span>&nbsp;<span class="builtinfunc" id="4126209">len</span><span class="op" id="4126212">(</span><span class="ident" id="4126213">v</span><span class="op" id="4126214">)</span><span class="op" id="4126215">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126218">for</span>&nbsp;<span class="ident" id="4126222">i</span><span class="op" id="4126223">,</span>&nbsp;<span class="ident" id="4126225">ci</span>&nbsp;<span class="op" id="4126228">:=</span>&nbsp;<span class="keyword" id="4126231">range</span>&nbsp;<span class="ident" id="4126237">v</span>&nbsp;<span class="op" id="4126239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126243">cert</span><span class="op" id="4126247">,</span>&nbsp;<span class="ident" id="4126249">err</span>&nbsp;<span class="op" id="4126253">:=</span>&nbsp;<span class="ident" id="4126256">parseCertificate</span><span class="op" id="4126272">(</span><span class="ident" id="4126273">ci</span><span class="op" id="4126275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126279">if</span>&nbsp;<span class="ident" id="4126282">err</span>&nbsp;<span class="op" id="4126286">!=</span>&nbsp;<span class="ident" id="4126289">nil</span>&nbsp;<span class="op" id="4126293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126298">return</span>&nbsp;<span class="ident" id="4126305">nil</span><span class="op" id="4126308">,</span>&nbsp;<span class="ident" id="4126310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126316">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126320">ret</span><span class="op" id="4126323">[</span><span class="ident" id="4126324">i</span><span class="op" id="4126325">]</span>&nbsp;<span class="op" id="4126327">=</span>&nbsp;<span class="ident" id="4126329">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126339">return</span>&nbsp;<span class="ident" id="4126346">ret</span><span class="op" id="4126349">,</span>&nbsp;<span class="ident" id="4126351">nil</span><br>
<span class="lineno"></span><span class="op" id="4126355">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4126358">func</span>&nbsp;<span class="ident" id="4126363">reverseBitsInAByte</span><span class="op" id="4126381">(</span><span class="ident" id="4126382">in</span>&nbsp;<span class="builtintype" id="4126385">byte</span><span class="op" id="4126389">)</span>&nbsp;<span class="builtintype" id="4126391">byte</span>&nbsp;<span class="op" id="4126396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126399">b1</span>&nbsp;<span class="op" id="4126402">:=</span>&nbsp;<span class="ident" id="4126405">in</span><span class="op" id="4126407">&gt;&gt;</span><span class="num" id="4126409">4</span>&nbsp;<span class="op" id="4126411">|</span>&nbsp;<span class="ident" id="4126413">in</span><span class="op" id="4126415">&lt;&lt;</span><span class="num" id="4126417">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126420">b2</span>&nbsp;<span class="op" id="4126423">:=</span>&nbsp;<span class="ident" id="4126426">b1</span><span class="op" id="4126428">&gt;&gt;</span><span class="num" id="4126430">2</span><span class="op" id="4126431">&amp;</span><span class="num" id="4126432">0x33</span>&nbsp;<span class="op" id="4126437">|</span>&nbsp;<span class="ident" id="4126439">b1</span><span class="op" id="4126441">&lt;&lt;</span><span class="num" id="4126443">2</span><span class="op" id="4126444">&amp;</span><span class="num" id="4126445">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126451">b3</span>&nbsp;<span class="op" id="4126454">:=</span>&nbsp;<span class="ident" id="4126457">b2</span><span class="op" id="4126459">&gt;&gt;</span><span class="num" id="4126461">1</span><span class="op" id="4126462">&amp;</span><span class="num" id="4126463">0x55</span>&nbsp;<span class="op" id="4126468">|</span>&nbsp;<span class="ident" id="4126470">b2</span><span class="op" id="4126472">&lt;&lt;</span><span class="num" id="4126474">1</span><span class="op" id="4126475">&amp;</span><span class="num" id="4126476">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126482">return</span>&nbsp;<span class="ident" id="4126489">b3</span><br>
<span class="lineno"></span><span class="op" id="4126492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4126495">var</span>&nbsp;<span class="op" id="4126499">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126502">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126536">=</span>&nbsp;<span class="op" id="4126538">[</span><span class="op" id="4126539">]</span><span class="builtintype" id="4126540">int</span><span class="op" id="4126543">{</span><span class="num" id="4126544">2</span><span class="op" id="4126545">,</span>&nbsp;<span class="num" id="4126547">5</span><span class="op" id="4126548">,</span>&nbsp;<span class="num" id="4126550">29</span><span class="op" id="4126552">,</span>&nbsp;<span class="num" id="4126554">14</span><span class="op" id="4126556">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126559">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126593">=</span>&nbsp;<span class="op" id="4126595">[</span><span class="op" id="4126596">]</span><span class="builtintype" id="4126597">int</span><span class="op" id="4126600">{</span><span class="num" id="4126601">2</span><span class="op" id="4126602">,</span>&nbsp;<span class="num" id="4126604">5</span><span class="op" id="4126605">,</span>&nbsp;<span class="num" id="4126607">29</span><span class="op" id="4126609">,</span>&nbsp;<span class="num" id="4126611">15</span><span class="op" id="4126613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126616">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126650">=</span>&nbsp;<span class="op" id="4126652">[</span><span class="op" id="4126653">]</span><span class="builtintype" id="4126654">int</span><span class="op" id="4126657">{</span><span class="num" id="4126658">2</span><span class="op" id="4126659">,</span>&nbsp;<span class="num" id="4126661">5</span><span class="op" id="4126662">,</span>&nbsp;<span class="num" id="4126664">29</span><span class="op" id="4126666">,</span>&nbsp;<span class="num" id="4126668">37</span><span class="op" id="4126670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126673">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126707">=</span>&nbsp;<span class="op" id="4126709">[</span><span class="op" id="4126710">]</span><span class="builtintype" id="4126711">int</span><span class="op" id="4126714">{</span><span class="num" id="4126715">2</span><span class="op" id="4126716">,</span>&nbsp;<span class="num" id="4126718">5</span><span class="op" id="4126719">,</span>&nbsp;<span class="num" id="4126721">29</span><span class="op" id="4126723">,</span>&nbsp;<span class="num" id="4126725">35</span><span class="op" id="4126727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126730">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126764">=</span>&nbsp;<span class="op" id="4126766">[</span><span class="op" id="4126767">]</span><span class="builtintype" id="4126768">int</span><span class="op" id="4126771">{</span><span class="num" id="4126772">2</span><span class="op" id="4126773">,</span>&nbsp;<span class="num" id="4126775">5</span><span class="op" id="4126776">,</span>&nbsp;<span class="num" id="4126778">29</span><span class="op" id="4126780">,</span>&nbsp;<span class="num" id="4126782">19</span><span class="op" id="4126784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126787">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126821">=</span>&nbsp;<span class="op" id="4126823">[</span><span class="op" id="4126824">]</span><span class="builtintype" id="4126825">int</span><span class="op" id="4126828">{</span><span class="num" id="4126829">2</span><span class="op" id="4126830">,</span>&nbsp;<span class="num" id="4126832">5</span><span class="op" id="4126833">,</span>&nbsp;<span class="num" id="4126835">29</span><span class="op" id="4126837">,</span>&nbsp;<span class="num" id="4126839">17</span><span class="op" id="4126841">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126844">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4126878">=</span>&nbsp;<span class="op" id="4126880">[</span><span class="op" id="4126881">]</span><span class="builtintype" id="4126882">int</span><span class="op" id="4126885">{</span><span class="num" id="4126886">2</span><span class="op" id="4126887">,</span>&nbsp;<span class="num" id="4126889">5</span><span class="op" id="4126890">,</span>&nbsp;<span class="num" id="4126892">29</span><span class="op" id="4126894">,</span>&nbsp;<span class="num" id="4126896">32</span><span class="op" id="4126898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126901">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126935">=</span>&nbsp;<span class="op" id="4126937">[</span><span class="op" id="4126938">]</span><span class="builtintype" id="4126939">int</span><span class="op" id="4126942">{</span><span class="num" id="4126943">2</span><span class="op" id="4126944">,</span>&nbsp;<span class="num" id="4126946">5</span><span class="op" id="4126947">,</span>&nbsp;<span class="num" id="4126949">29</span><span class="op" id="4126951">,</span>&nbsp;<span class="num" id="4126953">30</span><span class="op" id="4126955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126958">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4126992">=</span>&nbsp;<span class="op" id="4126994">[</span><span class="op" id="4126995">]</span><span class="builtintype" id="4126996">int</span><span class="op" id="4126999">{</span><span class="num" id="4127000">2</span><span class="op" id="4127001">,</span>&nbsp;<span class="num" id="4127003">5</span><span class="op" id="4127004">,</span>&nbsp;<span class="num" id="4127006">29</span><span class="op" id="4127008">,</span>&nbsp;<span class="num" id="4127010">31</span><span class="op" id="4127012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127015">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4127049">=</span>&nbsp;<span class="op" id="4127051">[</span><span class="op" id="4127052">]</span><span class="builtintype" id="4127053">int</span><span class="op" id="4127056">{</span><span class="num" id="4127057">1</span><span class="op" id="4127058">,</span>&nbsp;<span class="num" id="4127060">3</span><span class="op" id="4127061">,</span>&nbsp;<span class="num" id="4127063">6</span><span class="op" id="4127064">,</span>&nbsp;<span class="num" id="4127066">1</span><span class="op" id="4127067">,</span>&nbsp;<span class="num" id="4127069">5</span><span class="op" id="4127070">,</span>&nbsp;<span class="num" id="4127072">5</span><span class="op" id="4127073">,</span>&nbsp;<span class="num" id="4127075">7</span><span class="op" id="4127076">,</span>&nbsp;<span class="num" id="4127078">1</span><span class="op" id="4127079">,</span>&nbsp;<span class="num" id="4127081">1</span><span class="op" id="4127082">}</span><br>
<span class="lineno"></span><span class="op" id="4127084">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4127087">var</span>&nbsp;<span class="op" id="4127091">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127094">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127124">=</span>&nbsp;<span class="ident" id="4127126">asn1</span><span class="op" id="4127130">.</span><span class="ident" id="4127131">ObjectIdentifier</span><span class="op" id="4127147">{</span><span class="num" id="4127148">1</span><span class="op" id="4127149">,</span>&nbsp;<span class="num" id="4127151">3</span><span class="op" id="4127152">,</span>&nbsp;<span class="num" id="4127154">6</span><span class="op" id="4127155">,</span>&nbsp;<span class="num" id="4127157">1</span><span class="op" id="4127158">,</span>&nbsp;<span class="num" id="4127160">5</span><span class="op" id="4127161">,</span>&nbsp;<span class="num" id="4127163">5</span><span class="op" id="4127164">,</span>&nbsp;<span class="num" id="4127166">7</span><span class="op" id="4127167">,</span>&nbsp;<span class="num" id="4127169">48</span><span class="op" id="4127171">,</span>&nbsp;<span class="num" id="4127173">1</span><span class="op" id="4127174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127177">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4127207">=</span>&nbsp;<span class="ident" id="4127209">asn1</span><span class="op" id="4127213">.</span><span class="ident" id="4127214">ObjectIdentifier</span><span class="op" id="4127230">{</span><span class="num" id="4127231">1</span><span class="op" id="4127232">,</span>&nbsp;<span class="num" id="4127234">3</span><span class="op" id="4127235">,</span>&nbsp;<span class="num" id="4127237">6</span><span class="op" id="4127238">,</span>&nbsp;<span class="num" id="4127240">1</span><span class="op" id="4127241">,</span>&nbsp;<span class="num" id="4127243">5</span><span class="op" id="4127244">,</span>&nbsp;<span class="num" id="4127246">5</span><span class="op" id="4127247">,</span>&nbsp;<span class="num" id="4127249">7</span><span class="op" id="4127250">,</span>&nbsp;<span class="num" id="4127252">48</span><span class="op" id="4127254">,</span>&nbsp;<span class="num" id="4127256">2</span><span class="op" id="4127257">}</span><br>
<span class="lineno"></span><span class="op" id="4127259">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4127262">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4127342">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4127357">func</span>&nbsp;<span class="ident" id="4127362">oidInExtensions</span><span class="op" id="4127377">(</span><span class="ident" id="4127378">oid</span>&nbsp;<span class="ident" id="4127382">asn1</span><span class="op" id="4127386">.</span><span class="ident" id="4127387">ObjectIdentifier</span><span class="op" id="4127403">,</span>&nbsp;<span class="ident" id="4127405">extensions</span>&nbsp;<span class="op" id="4127416">[</span><span class="op" id="4127417">]</span><span class="ident" id="4127418">pkix</span><span class="op" id="4127422">.</span><span class="ident" id="4127423">Extension</span><span class="op" id="4127432">)</span>&nbsp;<span class="builtintype" id="4127434">bool</span>&nbsp;<span class="op" id="4127439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127442">for</span>&nbsp;<span class="ident" id="4127446">_</span><span class="op" id="4127447">,</span>&nbsp;<span class="ident" id="4127449">e</span>&nbsp;<span class="op" id="4127451">:=</span>&nbsp;<span class="keyword" id="4127454">range</span>&nbsp;<span class="ident" id="4127460">extensions</span>&nbsp;<span class="op" id="4127471">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127475">if</span>&nbsp;<span class="ident" id="4127478">e</span><span class="op" id="4127479">.</span><span class="ident" id="4127480">Id</span><span class="op" id="4127482">.</span><span class="ident" id="4127483">Equal</span><span class="op" id="4127488">(</span><span class="ident" id="4127489">oid</span><span class="op" id="4127492">)</span>&nbsp;<span class="op" id="4127494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127499">return</span>&nbsp;<span class="ident" id="4127506">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127519">return</span>&nbsp;<span class="ident" id="4127526">false</span><br>
<span class="lineno">1165</span><span class="op" id="4127532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4127535">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4127611">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4127648">func</span>&nbsp;<span class="ident" id="4127653">marshalSANs</span><span class="op" id="4127664">(</span><span class="ident" id="4127665">dnsNames</span><span class="op" id="4127673">,</span>&nbsp;<span class="ident" id="4127675">emailAddresses</span>&nbsp;<span class="op" id="4127690">[</span><span class="op" id="4127691">]</span><span class="builtintype" id="4127692">string</span><span class="op" id="4127698">,</span>&nbsp;<span class="ident" id="4127700">ipAddresses</span>&nbsp;<span class="op" id="4127712">[</span><span class="op" id="4127713">]</span><span class="ident" id="4127714">net</span><span class="op" id="4127717">.</span><span class="ident" id="4127718">IP</span><span class="op" id="4127720">)</span>&nbsp;<span class="op" id="4127722">(</span><span class="ident" id="4127723">derBytes</span>&nbsp;<span class="op" id="4127732">[</span><span class="op" id="4127733">]</span><span class="builtintype" id="4127734">byte</span><span class="op" id="4127738">,</span>&nbsp;<span class="ident" id="4127740">err</span>&nbsp;<span class="builtintype" id="4127744">error</span><span class="op" id="4127749">)</span>&nbsp;<span class="op" id="4127751">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127754">var</span>&nbsp;<span class="ident" id="4127758">rawValues</span>&nbsp;<span class="op" id="4127768">[</span><span class="op" id="4127769">]</span><span class="ident" id="4127770">asn1</span><span class="op" id="4127774">.</span><span class="ident" id="4127775">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127785">for</span>&nbsp;<span class="ident" id="4127789">_</span><span class="op" id="4127790">,</span>&nbsp;<span class="ident" id="4127792">name</span>&nbsp;<span class="op" id="4127797">:=</span>&nbsp;<span class="keyword" id="4127800">range</span>&nbsp;<span class="ident" id="4127806">dnsNames</span>&nbsp;<span class="op" id="4127815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127819">rawValues</span>&nbsp;<span class="op" id="4127829">=</span>&nbsp;<span class="builtinfunc" id="4127831">append</span><span class="op" id="4127837">(</span><span class="ident" id="4127838">rawValues</span><span class="op" id="4127847">,</span>&nbsp;<span class="ident" id="4127849">asn1</span><span class="op" id="4127853">.</span><span class="ident" id="4127854">RawValue</span><span class="op" id="4127862">{</span><span class="ident" id="4127863">Tag</span><span class="op" id="4127866">:</span>&nbsp;<span class="num" id="4127868">2</span><span class="op" id="4127869">,</span>&nbsp;<span class="ident" id="4127871">Class</span><span class="op" id="4127876">:</span>&nbsp;<span class="num" id="4127878">2</span><span class="op" id="4127879">,</span>&nbsp;<span class="ident" id="4127881">Bytes</span><span class="op" id="4127886">:</span>&nbsp;<span class="op" id="4127888">[</span><span class="op" id="4127889">]</span><span class="builtintype" id="4127890">byte</span><span class="op" id="4127894">(</span><span class="ident" id="4127895">name</span><span class="op" id="4127899">)</span><span class="op" id="4127900">}</span><span class="op" id="4127901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127907">for</span>&nbsp;<span class="ident" id="4127911">_</span><span class="op" id="4127912">,</span>&nbsp;<span class="ident" id="4127914">email</span>&nbsp;<span class="op" id="4127920">:=</span>&nbsp;<span class="keyword" id="4127923">range</span>&nbsp;<span class="ident" id="4127929">emailAddresses</span>&nbsp;<span class="op" id="4127944">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127948">rawValues</span>&nbsp;<span class="op" id="4127958">=</span>&nbsp;<span class="builtinfunc" id="4127960">append</span><span class="op" id="4127966">(</span><span class="ident" id="4127967">rawValues</span><span class="op" id="4127976">,</span>&nbsp;<span class="ident" id="4127978">asn1</span><span class="op" id="4127982">.</span><span class="ident" id="4127983">RawValue</span><span class="op" id="4127991">{</span><span class="ident" id="4127992">Tag</span><span class="op" id="4127995">:</span>&nbsp;<span class="num" id="4127997">1</span><span class="op" id="4127998">,</span>&nbsp;<span class="ident" id="4128000">Class</span><span class="op" id="4128005">:</span>&nbsp;<span class="num" id="4128007">2</span><span class="op" id="4128008">,</span>&nbsp;<span class="ident" id="4128010">Bytes</span><span class="op" id="4128015">:</span>&nbsp;<span class="op" id="4128017">[</span><span class="op" id="4128018">]</span><span class="builtintype" id="4128019">byte</span><span class="op" id="4128023">(</span><span class="ident" id="4128024">email</span><span class="op" id="4128029">)</span><span class="op" id="4128030">}</span><span class="op" id="4128031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128037">for</span>&nbsp;<span class="ident" id="4128041">_</span><span class="op" id="4128042">,</span>&nbsp;<span class="ident" id="4128044">rawIP</span>&nbsp;<span class="op" id="4128050">:=</span>&nbsp;<span class="keyword" id="4128053">range</span>&nbsp;<span class="ident" id="4128059">ipAddresses</span>&nbsp;<span class="op" id="4128071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4128075">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128145">ip</span>&nbsp;<span class="op" id="4128148">:=</span>&nbsp;<span class="ident" id="4128151">rawIP</span><span class="op" id="4128156">.</span><span class="ident" id="4128157">To4</span><span class="op" id="4128160">(</span><span class="op" id="4128161">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128165">if</span>&nbsp;<span class="ident" id="4128168">ip</span>&nbsp;<span class="op" id="4128171">==</span>&nbsp;<span class="ident" id="4128174">nil</span>&nbsp;<span class="op" id="4128178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128183">ip</span>&nbsp;<span class="op" id="4128186">=</span>&nbsp;<span class="ident" id="4128188">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128200">rawValues</span>&nbsp;<span class="op" id="4128210">=</span>&nbsp;<span class="builtinfunc" id="4128212">append</span><span class="op" id="4128218">(</span><span class="ident" id="4128219">rawValues</span><span class="op" id="4128228">,</span>&nbsp;<span class="ident" id="4128230">asn1</span><span class="op" id="4128234">.</span><span class="ident" id="4128235">RawValue</span><span class="op" id="4128243">{</span><span class="ident" id="4128244">Tag</span><span class="op" id="4128247">:</span>&nbsp;<span class="num" id="4128249">7</span><span class="op" id="4128250">,</span>&nbsp;<span class="ident" id="4128252">Class</span><span class="op" id="4128257">:</span>&nbsp;<span class="num" id="4128259">2</span><span class="op" id="4128260">,</span>&nbsp;<span class="ident" id="4128262">Bytes</span><span class="op" id="4128267">:</span>&nbsp;<span class="ident" id="4128269">ip</span><span class="op" id="4128271">}</span><span class="op" id="4128272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128275">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128278">return</span>&nbsp;<span class="ident" id="4128285">asn1</span><span class="op" id="4128289">.</span><span class="ident" id="4128290">Marshal</span><span class="op" id="4128297">(</span><span class="ident" id="4128298">rawValues</span><span class="op" id="4128307">)</span><br>
<span class="lineno"></span><span class="op" id="4128309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4128312">func</span>&nbsp;<span class="ident" id="4128317">buildExtensions</span><span class="op" id="4128332">(</span><span class="ident" id="4128333">template</span>&nbsp;<span class="op" id="4128342">*</span><span class="ident" id="4128343">Certificate</span><span class="op" id="4128354">)</span>&nbsp;<span class="op" id="4128356">(</span><span class="ident" id="4128357">ret</span>&nbsp;<span class="op" id="4128361">[</span><span class="op" id="4128362">]</span><span class="ident" id="4128363">pkix</span><span class="op" id="4128367">.</span><span class="ident" id="4128368">Extension</span><span class="op" id="4128377">,</span>&nbsp;<span class="ident" id="4128379">err</span>&nbsp;<span class="builtintype" id="4128383">error</span><span class="op" id="4128388">)</span>&nbsp;<span class="op" id="4128390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128393">ret</span>&nbsp;<span class="op" id="4128397">=</span>&nbsp;<span class="builtinfunc" id="4128399">make</span><span class="op" id="4128403">(</span><span class="op" id="4128404">[</span><span class="op" id="4128405">]</span><span class="ident" id="4128406">pkix</span><span class="op" id="4128410">.</span><span class="ident" id="4128411">Extension</span><span class="op" id="4128420">,</span>&nbsp;<span class="num" id="4128422">10</span>&nbsp;<span class="comment" id="4128425">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4128458">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128461">n</span>&nbsp;<span class="op" id="4128463">:=</span>&nbsp;<span class="num" id="4128466">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128470">if</span>&nbsp;<span class="ident" id="4128473">template</span><span class="op" id="4128481">.</span><span class="ident" id="4128482">KeyUsage</span>&nbsp;<span class="op" id="4128491">!=</span>&nbsp;<span class="num" id="4128494">0</span>&nbsp;<span class="op" id="4128496">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128501">!</span><span class="ident" id="4128502">oidInExtensions</span><span class="op" id="4128517">(</span><span class="ident" id="4128518">oidExtensionKeyUsage</span><span class="op" id="4128538">,</span>&nbsp;<span class="ident" id="4128540">template</span><span class="op" id="4128548">.</span><span class="ident" id="4128549">ExtraExtensions</span><span class="op" id="4128564">)</span>&nbsp;<span class="op" id="4128566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128570">ret</span><span class="op" id="4128573">[</span><span class="ident" id="4128574">n</span><span class="op" id="4128575">]</span><span class="op" id="4128576">.</span><span class="ident" id="4128577">Id</span>&nbsp;<span class="op" id="4128580">=</span>&nbsp;<span class="ident" id="4128582">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128605">ret</span><span class="op" id="4128608">[</span><span class="ident" id="4128609">n</span><span class="op" id="4128610">]</span><span class="op" id="4128611">.</span><span class="ident" id="4128612">Critical</span>&nbsp;<span class="op" id="4128621">=</span>&nbsp;<span class="ident" id="4128623">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128631">var</span>&nbsp;<span class="ident" id="4128635">a</span>&nbsp;<span class="op" id="4128637">[</span><span class="num" id="4128638">2</span><span class="op" id="4128639">]</span><span class="builtintype" id="4128640">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128647">a</span><span class="op" id="4128648">[</span><span class="num" id="4128649">0</span><span class="op" id="4128650">]</span>&nbsp;<span class="op" id="4128652">=</span>&nbsp;<span class="ident" id="4128654">reverseBitsInAByte</span><span class="op" id="4128672">(</span><span class="builtintype" id="4128673">byte</span><span class="op" id="4128677">(</span><span class="ident" id="4128678">template</span><span class="op" id="4128686">.</span><span class="ident" id="4128687">KeyUsage</span><span class="op" id="4128695">)</span><span class="op" id="4128696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128700">a</span><span class="op" id="4128701">[</span><span class="num" id="4128702">1</span><span class="op" id="4128703">]</span>&nbsp;<span class="op" id="4128705">=</span>&nbsp;<span class="ident" id="4128707">reverseBitsInAByte</span><span class="op" id="4128725">(</span><span class="builtintype" id="4128726">byte</span><span class="op" id="4128730">(</span><span class="ident" id="4128731">template</span><span class="op" id="4128739">.</span><span class="ident" id="4128740">KeyUsage</span>&nbsp;<span class="op" id="4128749">&gt;&gt;</span>&nbsp;<span class="num" id="4128752">8</span><span class="op" id="4128753">)</span><span class="op" id="4128754">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128759">l</span>&nbsp;<span class="op" id="4128761">:=</span>&nbsp;<span class="num" id="4128764">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128768">if</span>&nbsp;<span class="ident" id="4128771">a</span><span class="op" id="4128772">[</span><span class="num" id="4128773">1</span><span class="op" id="4128774">]</span>&nbsp;<span class="op" id="4128776">!=</span>&nbsp;<span class="num" id="4128779">0</span>&nbsp;<span class="op" id="4128781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128786">l</span>&nbsp;<span class="op" id="4128788">=</span>&nbsp;<span class="num" id="4128790">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128794">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128799">ret</span><span class="op" id="4128802">[</span><span class="ident" id="4128803">n</span><span class="op" id="4128804">]</span><span class="op" id="4128805">.</span><span class="ident" id="4128806">Value</span><span class="op" id="4128811">,</span>&nbsp;<span class="ident" id="4128813">err</span>&nbsp;<span class="op" id="4128817">=</span>&nbsp;<span class="ident" id="4128819">asn1</span><span class="op" id="4128823">.</span><span class="ident" id="4128824">Marshal</span><span class="op" id="4128831">(</span><span class="ident" id="4128832">asn1</span><span class="op" id="4128836">.</span><span class="ident" id="4128837">BitString</span><span class="op" id="4128846">{</span><span class="ident" id="4128847">Bytes</span><span class="op" id="4128852">:</span>&nbsp;<span class="ident" id="4128854">a</span><span class="op" id="4128855">[</span><span class="num" id="4128856">0</span><span class="op" id="4128857">:</span><span class="ident" id="4128858">l</span><span class="op" id="4128859">]</span><span class="op" id="4128860">,</span>&nbsp;<span class="ident" id="4128862">BitLength</span><span class="op" id="4128871">:</span>&nbsp;<span class="ident" id="4128873">l</span>&nbsp;<span class="op" id="4128875">*</span>&nbsp;<span class="num" id="4128877">8</span><span class="op" id="4128878">}</span><span class="op" id="4128879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128883">if</span>&nbsp;<span class="ident" id="4128886">err</span>&nbsp;<span class="op" id="4128890">!=</span>&nbsp;<span class="ident" id="4128893">nil</span>&nbsp;<span class="op" id="4128897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128902">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128911">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4128915">n</span><span class="op" id="4128916">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128924">if</span>&nbsp;<span class="op" id="4128927">(</span><span class="builtinfunc" id="4128928">len</span><span class="op" id="4128931">(</span><span class="ident" id="4128932">template</span><span class="op" id="4128940">.</span><span class="ident" id="4128941">ExtKeyUsage</span><span class="op" id="4128952">)</span>&nbsp;<span class="op" id="4128954">&gt;</span>&nbsp;<span class="num" id="4128956">0</span>&nbsp;<span class="op" id="4128958">||</span>&nbsp;<span class="builtinfunc" id="4128961">len</span><span class="op" id="4128964">(</span><span class="ident" id="4128965">template</span><span class="op" id="4128973">.</span><span class="ident" id="4128974">UnknownExtKeyUsage</span><span class="op" id="4128992">)</span>&nbsp;<span class="op" id="4128994">&gt;</span>&nbsp;<span class="num" id="4128996">0</span><span class="op" id="4128997">)</span>&nbsp;<span class="op" id="4128999">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129004">!</span><span class="ident" id="4129005">oidInExtensions</span><span class="op" id="4129020">(</span><span class="ident" id="4129021">oidExtensionExtendedKeyUsage</span><span class="op" id="4129049">,</span>&nbsp;<span class="ident" id="4129051">template</span><span class="op" id="4129059">.</span><span class="ident" id="4129060">ExtraExtensions</span><span class="op" id="4129075">)</span>&nbsp;<span class="op" id="4129077">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129081">ret</span><span class="op" id="4129084">[</span><span class="ident" id="4129085">n</span><span class="op" id="4129086">]</span><span class="op" id="4129087">.</span><span class="ident" id="4129088">Id</span>&nbsp;<span class="op" id="4129091">=</span>&nbsp;<span class="ident" id="4129093">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129125">var</span>&nbsp;<span class="ident" id="4129129">oids</span>&nbsp;<span class="op" id="4129134">[</span><span class="op" id="4129135">]</span><span class="ident" id="4129136">asn1</span><span class="op" id="4129140">.</span><span class="ident" id="4129141">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129160">for</span>&nbsp;<span class="ident" id="4129164">_</span><span class="op" id="4129165">,</span>&nbsp;<span class="ident" id="4129167">u</span>&nbsp;<span class="op" id="4129169">:=</span>&nbsp;<span class="keyword" id="4129172">range</span>&nbsp;<span class="ident" id="4129178">template</span><span class="op" id="4129186">.</span><span class="ident" id="4129187">ExtKeyUsage</span>&nbsp;<span class="op" id="4129199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129204">if</span>&nbsp;<span class="ident" id="4129207">oid</span><span class="op" id="4129210">,</span>&nbsp;<span class="ident" id="4129212">ok</span>&nbsp;<span class="op" id="4129215">:=</span>&nbsp;<span class="ident" id="4129218">oidFromExtKeyUsage</span><span class="op" id="4129236">(</span><span class="ident" id="4129237">u</span><span class="op" id="4129238">)</span><span class="op" id="4129239">;</span>&nbsp;<span class="ident" id="4129241">ok</span>&nbsp;<span class="op" id="4129244">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129250">oids</span>&nbsp;<span class="op" id="4129255">=</span>&nbsp;<span class="builtinfunc" id="4129257">append</span><span class="op" id="4129263">(</span><span class="ident" id="4129264">oids</span><span class="op" id="4129268">,</span>&nbsp;<span class="ident" id="4129270">oid</span><span class="op" id="4129273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129278">}</span>&nbsp;<span class="keyword" id="4129280">else</span>&nbsp;<span class="op" id="4129285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4129291">panic</span><span class="op" id="4129296">(</span><span class="string" id="4129297">&#34;internal&nbsp;error&#34;</span><span class="op" id="4129313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129322">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129327">oids</span>&nbsp;<span class="op" id="4129332">=</span>&nbsp;<span class="builtinfunc" id="4129334">append</span><span class="op" id="4129340">(</span><span class="ident" id="4129341">oids</span><span class="op" id="4129345">,</span>&nbsp;<span class="ident" id="4129347">template</span><span class="op" id="4129355">.</span><span class="ident" id="4129356">UnknownExtKeyUsage</span><span class="op" id="4129374">...</span><span class="op" id="4129377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129382">ret</span><span class="op" id="4129385">[</span><span class="ident" id="4129386">n</span><span class="op" id="4129387">]</span><span class="op" id="4129388">.</span><span class="ident" id="4129389">Value</span><span class="op" id="4129394">,</span>&nbsp;<span class="ident" id="4129396">err</span>&nbsp;<span class="op" id="4129400">=</span>&nbsp;<span class="ident" id="4129402">asn1</span><span class="op" id="4129406">.</span><span class="ident" id="4129407">Marshal</span><span class="op" id="4129414">(</span><span class="ident" id="4129415">oids</span><span class="op" id="4129419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129423">if</span>&nbsp;<span class="ident" id="4129426">err</span>&nbsp;<span class="op" id="4129430">!=</span>&nbsp;<span class="ident" id="4129433">nil</span>&nbsp;<span class="op" id="4129437">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129442">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129455">n</span><span class="op" id="4129456">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129464">if</span>&nbsp;<span class="ident" id="4129467">template</span><span class="op" id="4129475">.</span><span class="ident" id="4129476">BasicConstraintsValid</span>&nbsp;<span class="op" id="4129498">&amp;&amp;</span>&nbsp;<span class="op" id="4129501">!</span><span class="ident" id="4129502">oidInExtensions</span><span class="op" id="4129517">(</span><span class="ident" id="4129518">oidExtensionBasicConstraints</span><span class="op" id="4129546">,</span>&nbsp;<span class="ident" id="4129548">template</span><span class="op" id="4129556">.</span><span class="ident" id="4129557">ExtraExtensions</span><span class="op" id="4129572">)</span>&nbsp;<span class="op" id="4129574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4129578">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4129641">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4129706">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129765">maxPathLen</span>&nbsp;<span class="op" id="4129776">:=</span>&nbsp;<span class="ident" id="4129779">template</span><span class="op" id="4129787">.</span><span class="ident" id="4129788">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129801">if</span>&nbsp;<span class="ident" id="4129804">maxPathLen</span>&nbsp;<span class="op" id="4129815">==</span>&nbsp;<span class="num" id="4129818">0</span>&nbsp;<span class="op" id="4129820">&amp;&amp;</span>&nbsp;<span class="op" id="4129823">!</span><span class="ident" id="4129824">template</span><span class="op" id="4129832">.</span><span class="ident" id="4129833">MaxPathLenZero</span>&nbsp;<span class="op" id="4129848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129853">maxPathLen</span>&nbsp;<span class="op" id="4129864">=</span>&nbsp;<span class="op" id="4129866">-</span><span class="num" id="4129867">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129875">ret</span><span class="op" id="4129878">[</span><span class="ident" id="4129879">n</span><span class="op" id="4129880">]</span><span class="op" id="4129881">.</span><span class="ident" id="4129882">Id</span>&nbsp;<span class="op" id="4129885">=</span>&nbsp;<span class="ident" id="4129887">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129918">ret</span><span class="op" id="4129921">[</span><span class="ident" id="4129922">n</span><span class="op" id="4129923">]</span><span class="op" id="4129924">.</span><span class="ident" id="4129925">Value</span><span class="op" id="4129930">,</span>&nbsp;<span class="ident" id="4129932">err</span>&nbsp;<span class="op" id="4129936">=</span>&nbsp;<span class="ident" id="4129938">asn1</span><span class="op" id="4129942">.</span><span class="ident" id="4129943">Marshal</span><span class="op" id="4129950">(</span><span class="ident" id="4129951">basicConstraints</span><span class="op" id="4129967">{</span><span class="ident" id="4129968">template</span><span class="op" id="4129976">.</span><span class="ident" id="4129977">IsCA</span><span class="op" id="4129981">,</span>&nbsp;<span class="ident" id="4129983">maxPathLen</span><span class="op" id="4129993">}</span><span class="op" id="4129994">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129998">ret</span><span class="op" id="4130001">[</span><span class="ident" id="4130002">n</span><span class="op" id="4130003">]</span><span class="op" id="4130004">.</span><span class="ident" id="4130005">Critical</span>&nbsp;<span class="op" id="4130014">=</span>&nbsp;<span class="ident" id="4130016">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130023">if</span>&nbsp;<span class="ident" id="4130026">err</span>&nbsp;<span class="op" id="4130030">!=</span>&nbsp;<span class="ident" id="4130033">nil</span>&nbsp;<span class="op" id="4130037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130042">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130055">n</span><span class="op" id="4130056">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130064">if</span>&nbsp;<span class="builtinfunc" id="4130067">len</span><span class="op" id="4130070">(</span><span class="ident" id="4130071">template</span><span class="op" id="4130079">.</span><span class="ident" id="4130080">SubjectKeyId</span><span class="op" id="4130092">)</span>&nbsp;<span class="op" id="4130094">&gt;</span>&nbsp;<span class="num" id="4130096">0</span>&nbsp;<span class="op" id="4130098">&amp;&amp;</span>&nbsp;<span class="op" id="4130101">!</span><span class="ident" id="4130102">oidInExtensions</span><span class="op" id="4130117">(</span><span class="ident" id="4130118">oidExtensionSubjectKeyId</span><span class="op" id="4130142">,</span>&nbsp;<span class="ident" id="4130144">template</span><span class="op" id="4130152">.</span><span class="ident" id="4130153">ExtraExtensions</span><span class="op" id="4130168">)</span>&nbsp;<span class="op" id="4130170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130174">ret</span><span class="op" id="4130177">[</span><span class="ident" id="4130178">n</span><span class="op" id="4130179">]</span><span class="op" id="4130180">.</span><span class="ident" id="4130181">Id</span>&nbsp;<span class="op" id="4130184">=</span>&nbsp;<span class="ident" id="4130186">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130213">ret</span><span class="op" id="4130216">[</span><span class="ident" id="4130217">n</span><span class="op" id="4130218">]</span><span class="op" id="4130219">.</span><span class="ident" id="4130220">Value</span><span class="op" id="4130225">,</span>&nbsp;<span class="ident" id="4130227">err</span>&nbsp;<span class="op" id="4130231">=</span>&nbsp;<span class="ident" id="4130233">asn1</span><span class="op" id="4130237">.</span><span class="ident" id="4130238">Marshal</span><span class="op" id="4130245">(</span><span class="ident" id="4130246">template</span><span class="op" id="4130254">.</span><span class="ident" id="4130255">SubjectKeyId</span><span class="op" id="4130267">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130271">if</span>&nbsp;<span class="ident" id="4130274">err</span>&nbsp;<span class="op" id="4130278">!=</span>&nbsp;<span class="ident" id="4130281">nil</span>&nbsp;<span class="op" id="4130285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130290">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130303">n</span><span class="op" id="4130304">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130308">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130312">if</span>&nbsp;<span class="builtinfunc" id="4130315">len</span><span class="op" id="4130318">(</span><span class="ident" id="4130319">template</span><span class="op" id="4130327">.</span><span class="ident" id="4130328">AuthorityKeyId</span><span class="op" id="4130342">)</span>&nbsp;<span class="op" id="4130344">&gt;</span>&nbsp;<span class="num" id="4130346">0</span>&nbsp;<span class="op" id="4130348">&amp;&amp;</span>&nbsp;<span class="op" id="4130351">!</span><span class="ident" id="4130352">oidInExtensions</span><span class="op" id="4130367">(</span><span class="ident" id="4130368">oidExtensionAuthorityKeyId</span><span class="op" id="4130394">,</span>&nbsp;<span class="ident" id="4130396">template</span><span class="op" id="4130404">.</span><span class="ident" id="4130405">ExtraExtensions</span><span class="op" id="4130420">)</span>&nbsp;<span class="op" id="4130422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130426">ret</span><span class="op" id="4130429">[</span><span class="ident" id="4130430">n</span><span class="op" id="4130431">]</span><span class="op" id="4130432">.</span><span class="ident" id="4130433">Id</span>&nbsp;<span class="op" id="4130436">=</span>&nbsp;<span class="ident" id="4130438">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130467">ret</span><span class="op" id="4130470">[</span><span class="ident" id="4130471">n</span><span class="op" id="4130472">]</span><span class="op" id="4130473">.</span><span class="ident" id="4130474">Value</span><span class="op" id="4130479">,</span>&nbsp;<span class="ident" id="4130481">err</span>&nbsp;<span class="op" id="4130485">=</span>&nbsp;<span class="ident" id="4130487">asn1</span><span class="op" id="4130491">.</span><span class="ident" id="4130492">Marshal</span><span class="op" id="4130499">(</span><span class="ident" id="4130500">authKeyId</span><span class="op" id="4130509">{</span><span class="ident" id="4130510">template</span><span class="op" id="4130518">.</span><span class="ident" id="4130519">AuthorityKeyId</span><span class="op" id="4130533">}</span><span class="op" id="4130534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130538">if</span>&nbsp;<span class="ident" id="4130541">err</span>&nbsp;<span class="op" id="4130545">!=</span>&nbsp;<span class="ident" id="4130548">nil</span>&nbsp;<span class="op" id="4130552">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130557">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130570">n</span><span class="op" id="4130571">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130579">if</span>&nbsp;<span class="op" id="4130582">(</span><span class="builtinfunc" id="4130583">len</span><span class="op" id="4130586">(</span><span class="ident" id="4130587">template</span><span class="op" id="4130595">.</span><span class="ident" id="4130596">OCSPServer</span><span class="op" id="4130606">)</span>&nbsp;<span class="op" id="4130608">&gt;</span>&nbsp;<span class="num" id="4130610">0</span>&nbsp;<span class="op" id="4130612">||</span>&nbsp;<span class="builtinfunc" id="4130615">len</span><span class="op" id="4130618">(</span><span class="ident" id="4130619">template</span><span class="op" id="4130627">.</span><span class="ident" id="4130628">IssuingCertificateURL</span><span class="op" id="4130649">)</span>&nbsp;<span class="op" id="4130651">&gt;</span>&nbsp;<span class="num" id="4130653">0</span><span class="op" id="4130654">)</span>&nbsp;<span class="op" id="4130656">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130661">!</span><span class="ident" id="4130662">oidInExtensions</span><span class="op" id="4130677">(</span><span class="ident" id="4130678">oidExtensionAuthorityInfoAccess</span><span class="op" id="4130709">,</span>&nbsp;<span class="ident" id="4130711">template</span><span class="op" id="4130719">.</span><span class="ident" id="4130720">ExtraExtensions</span><span class="op" id="4130735">)</span>&nbsp;<span class="op" id="4130737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130741">ret</span><span class="op" id="4130744">[</span><span class="ident" id="4130745">n</span><span class="op" id="4130746">]</span><span class="op" id="4130747">.</span><span class="ident" id="4130748">Id</span>&nbsp;<span class="op" id="4130751">=</span>&nbsp;<span class="ident" id="4130753">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130787">var</span>&nbsp;<span class="ident" id="4130791">aiaValues</span>&nbsp;<span class="op" id="4130801">[</span><span class="op" id="4130802">]</span><span class="ident" id="4130803">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130825">for</span>&nbsp;<span class="ident" id="4130829">_</span><span class="op" id="4130830">,</span>&nbsp;<span class="ident" id="4130832">name</span>&nbsp;<span class="op" id="4130837">:=</span>&nbsp;<span class="keyword" id="4130840">range</span>&nbsp;<span class="ident" id="4130846">template</span><span class="op" id="4130854">.</span><span class="ident" id="4130855">OCSPServer</span>&nbsp;<span class="op" id="4130866">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130871">aiaValues</span>&nbsp;<span class="op" id="4130881">=</span>&nbsp;<span class="builtinfunc" id="4130883">append</span><span class="op" id="4130889">(</span><span class="ident" id="4130890">aiaValues</span><span class="op" id="4130899">,</span>&nbsp;<span class="ident" id="4130901">authorityInfoAccess</span><span class="op" id="4130920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130926">Method</span><span class="op" id="4130932">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4130936">oidAuthorityInfoAccessOcsp</span><span class="op" id="4130962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130968">Location</span><span class="op" id="4130976">:</span>&nbsp;<span class="ident" id="4130978">asn1</span><span class="op" id="4130982">.</span><span class="ident" id="4130983">RawValue</span><span class="op" id="4130991">{</span><span class="ident" id="4130992">Tag</span><span class="op" id="4130995">:</span>&nbsp;<span class="num" id="4130997">6</span><span class="op" id="4130998">,</span>&nbsp;<span class="ident" id="4131000">Class</span><span class="op" id="4131005">:</span>&nbsp;<span class="num" id="4131007">2</span><span class="op" id="4131008">,</span>&nbsp;<span class="ident" id="4131010">Bytes</span><span class="op" id="4131015">:</span>&nbsp;<span class="op" id="4131017">[</span><span class="op" id="4131018">]</span><span class="builtintype" id="4131019">byte</span><span class="op" id="4131023">(</span><span class="ident" id="4131024">name</span><span class="op" id="4131028">)</span><span class="op" id="4131029">}</span><span class="op" id="4131030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131035">}</span><span class="op" id="4131036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131040">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131044">for</span>&nbsp;<span class="ident" id="4131048">_</span><span class="op" id="4131049">,</span>&nbsp;<span class="ident" id="4131051">name</span>&nbsp;<span class="op" id="4131056">:=</span>&nbsp;<span class="keyword" id="4131059">range</span>&nbsp;<span class="ident" id="4131065">template</span><span class="op" id="4131073">.</span><span class="ident" id="4131074">IssuingCertificateURL</span>&nbsp;<span class="op" id="4131096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131101">aiaValues</span>&nbsp;<span class="op" id="4131111">=</span>&nbsp;<span class="builtinfunc" id="4131113">append</span><span class="op" id="4131119">(</span><span class="ident" id="4131120">aiaValues</span><span class="op" id="4131129">,</span>&nbsp;<span class="ident" id="4131131">authorityInfoAccess</span><span class="op" id="4131150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131156">Method</span><span class="op" id="4131162">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4131166">oidAuthorityInfoAccessIssuers</span><span class="op" id="4131195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131201">Location</span><span class="op" id="4131209">:</span>&nbsp;<span class="ident" id="4131211">asn1</span><span class="op" id="4131215">.</span><span class="ident" id="4131216">RawValue</span><span class="op" id="4131224">{</span><span class="ident" id="4131225">Tag</span><span class="op" id="4131228">:</span>&nbsp;<span class="num" id="4131230">6</span><span class="op" id="4131231">,</span>&nbsp;<span class="ident" id="4131233">Class</span><span class="op" id="4131238">:</span>&nbsp;<span class="num" id="4131240">2</span><span class="op" id="4131241">,</span>&nbsp;<span class="ident" id="4131243">Bytes</span><span class="op" id="4131248">:</span>&nbsp;<span class="op" id="4131250">[</span><span class="op" id="4131251">]</span><span class="builtintype" id="4131252">byte</span><span class="op" id="4131256">(</span><span class="ident" id="4131257">name</span><span class="op" id="4131261">)</span><span class="op" id="4131262">}</span><span class="op" id="4131263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131268">}</span><span class="op" id="4131269">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131277">ret</span><span class="op" id="4131280">[</span><span class="ident" id="4131281">n</span><span class="op" id="4131282">]</span><span class="op" id="4131283">.</span><span class="ident" id="4131284">Value</span><span class="op" id="4131289">,</span>&nbsp;<span class="ident" id="4131291">err</span>&nbsp;<span class="op" id="4131295">=</span>&nbsp;<span class="ident" id="4131297">asn1</span><span class="op" id="4131301">.</span><span class="ident" id="4131302">Marshal</span><span class="op" id="4131309">(</span><span class="ident" id="4131310">aiaValues</span><span class="op" id="4131319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131323">if</span>&nbsp;<span class="ident" id="4131326">err</span>&nbsp;<span class="op" id="4131330">!=</span>&nbsp;<span class="ident" id="4131333">nil</span>&nbsp;<span class="op" id="4131337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131342">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131351">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131355">n</span><span class="op" id="4131356">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131364">if</span>&nbsp;<span class="op" id="4131367">(</span><span class="builtinfunc" id="4131368">len</span><span class="op" id="4131371">(</span><span class="ident" id="4131372">template</span><span class="op" id="4131380">.</span><span class="ident" id="4131381">DNSNames</span><span class="op" id="4131389">)</span>&nbsp;<span class="op" id="4131391">&gt;</span>&nbsp;<span class="num" id="4131393">0</span>&nbsp;<span class="op" id="4131395">||</span>&nbsp;<span class="builtinfunc" id="4131398">len</span><span class="op" id="4131401">(</span><span class="ident" id="4131402">template</span><span class="op" id="4131410">.</span><span class="ident" id="4131411">EmailAddresses</span><span class="op" id="4131425">)</span>&nbsp;<span class="op" id="4131427">&gt;</span>&nbsp;<span class="num" id="4131429">0</span>&nbsp;<span class="op" id="4131431">||</span>&nbsp;<span class="builtinfunc" id="4131434">len</span><span class="op" id="4131437">(</span><span class="ident" id="4131438">template</span><span class="op" id="4131446">.</span><span class="ident" id="4131447">IPAddresses</span><span class="op" id="4131458">)</span>&nbsp;<span class="op" id="4131460">&gt;</span>&nbsp;<span class="num" id="4131462">0</span><span class="op" id="4131463">)</span>&nbsp;<span class="op" id="4131465">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131470">!</span><span class="ident" id="4131471">oidInExtensions</span><span class="op" id="4131486">(</span><span class="ident" id="4131487">oidExtensionSubjectAltName</span><span class="op" id="4131513">,</span>&nbsp;<span class="ident" id="4131515">template</span><span class="op" id="4131523">.</span><span class="ident" id="4131524">ExtraExtensions</span><span class="op" id="4131539">)</span>&nbsp;<span class="op" id="4131541">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131545">ret</span><span class="op" id="4131548">[</span><span class="ident" id="4131549">n</span><span class="op" id="4131550">]</span><span class="op" id="4131551">.</span><span class="ident" id="4131552">Id</span>&nbsp;<span class="op" id="4131555">=</span>&nbsp;<span class="ident" id="4131557">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131586">ret</span><span class="op" id="4131589">[</span><span class="ident" id="4131590">n</span><span class="op" id="4131591">]</span><span class="op" id="4131592">.</span><span class="ident" id="4131593">Value</span><span class="op" id="4131598">,</span>&nbsp;<span class="ident" id="4131600">err</span>&nbsp;<span class="op" id="4131604">=</span>&nbsp;<span class="ident" id="4131606">marshalSANs</span><span class="op" id="4131617">(</span><span class="ident" id="4131618">template</span><span class="op" id="4131626">.</span><span class="ident" id="4131627">DNSNames</span><span class="op" id="4131635">,</span>&nbsp;<span class="ident" id="4131637">template</span><span class="op" id="4131645">.</span><span class="ident" id="4131646">EmailAddresses</span><span class="op" id="4131660">,</span>&nbsp;<span class="ident" id="4131662">template</span><span class="op" id="4131670">.</span><span class="ident" id="4131671">IPAddresses</span><span class="op" id="4131682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131686">if</span>&nbsp;<span class="ident" id="4131689">err</span>&nbsp;<span class="op" id="4131693">!=</span>&nbsp;<span class="ident" id="4131696">nil</span>&nbsp;<span class="op" id="4131700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131705">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131714">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131718">n</span><span class="op" id="4131719">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131727">if</span>&nbsp;<span class="builtinfunc" id="4131730">len</span><span class="op" id="4131733">(</span><span class="ident" id="4131734">template</span><span class="op" id="4131742">.</span><span class="ident" id="4131743">PolicyIdentifiers</span><span class="op" id="4131760">)</span>&nbsp;<span class="op" id="4131762">&gt;</span>&nbsp;<span class="num" id="4131764">0</span>&nbsp;<span class="op" id="4131766">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131771">!</span><span class="ident" id="4131772">oidInExtensions</span><span class="op" id="4131787">(</span><span class="ident" id="4131788">oidExtensionCertificatePolicies</span><span class="op" id="4131819">,</span>&nbsp;<span class="ident" id="4131821">template</span><span class="op" id="4131829">.</span><span class="ident" id="4131830">ExtraExtensions</span><span class="op" id="4131845">)</span>&nbsp;<span class="op" id="4131847">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131851">ret</span><span class="op" id="4131854">[</span><span class="ident" id="4131855">n</span><span class="op" id="4131856">]</span><span class="op" id="4131857">.</span><span class="ident" id="4131858">Id</span>&nbsp;<span class="op" id="4131861">=</span>&nbsp;<span class="ident" id="4131863">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131897">policies</span>&nbsp;<span class="op" id="4131906">:=</span>&nbsp;<span class="builtinfunc" id="4131909">make</span><span class="op" id="4131913">(</span><span class="op" id="4131914">[</span><span class="op" id="4131915">]</span><span class="ident" id="4131916">policyInformation</span><span class="op" id="4131933">,</span>&nbsp;<span class="builtinfunc" id="4131935">len</span><span class="op" id="4131938">(</span><span class="ident" id="4131939">template</span><span class="op" id="4131947">.</span><span class="ident" id="4131948">PolicyIdentifiers</span><span class="op" id="4131965">)</span><span class="op" id="4131966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131970">for</span>&nbsp;<span class="ident" id="4131974">i</span><span class="op" id="4131975">,</span>&nbsp;<span class="ident" id="4131977">policy</span>&nbsp;<span class="op" id="4131984">:=</span>&nbsp;<span class="keyword" id="4131987">range</span>&nbsp;<span class="ident" id="4131993">template</span><span class="op" id="4132001">.</span><span class="ident" id="4132002">PolicyIdentifiers</span>&nbsp;<span class="op" id="4132020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132025">policies</span><span class="op" id="4132033">[</span><span class="ident" id="4132034">i</span><span class="op" id="4132035">]</span><span class="op" id="4132036">.</span><span class="ident" id="4132037">Policy</span>&nbsp;<span class="op" id="4132044">=</span>&nbsp;<span class="ident" id="4132046">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132055">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132059">ret</span><span class="op" id="4132062">[</span><span class="ident" id="4132063">n</span><span class="op" id="4132064">]</span><span class="op" id="4132065">.</span><span class="ident" id="4132066">Value</span><span class="op" id="4132071">,</span>&nbsp;<span class="ident" id="4132073">err</span>&nbsp;<span class="op" id="4132077">=</span>&nbsp;<span class="ident" id="4132079">asn1</span><span class="op" id="4132083">.</span><span class="ident" id="4132084">Marshal</span><span class="op" id="4132091">(</span><span class="ident" id="4132092">policies</span><span class="op" id="4132100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132104">if</span>&nbsp;<span class="ident" id="4132107">err</span>&nbsp;<span class="op" id="4132111">!=</span>&nbsp;<span class="ident" id="4132114">nil</span>&nbsp;<span class="op" id="4132118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132123">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132136">n</span><span class="op" id="4132137">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132145">if</span>&nbsp;<span class="builtinfunc" id="4132148">len</span><span class="op" id="4132151">(</span><span class="ident" id="4132152">template</span><span class="op" id="4132160">.</span><span class="ident" id="4132161">PermittedDNSDomains</span><span class="op" id="4132180">)</span>&nbsp;<span class="op" id="4132182">&gt;</span>&nbsp;<span class="num" id="4132184">0</span>&nbsp;<span class="op" id="4132186">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132191">!</span><span class="ident" id="4132192">oidInExtensions</span><span class="op" id="4132207">(</span><span class="ident" id="4132208">oidExtensionNameConstraints</span><span class="op" id="4132235">,</span>&nbsp;<span class="ident" id="4132237">template</span><span class="op" id="4132245">.</span><span class="ident" id="4132246">ExtraExtensions</span><span class="op" id="4132261">)</span>&nbsp;<span class="op" id="4132263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132267">ret</span><span class="op" id="4132270">[</span><span class="ident" id="4132271">n</span><span class="op" id="4132272">]</span><span class="op" id="4132273">.</span><span class="ident" id="4132274">Id</span>&nbsp;<span class="op" id="4132277">=</span>&nbsp;<span class="ident" id="4132279">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132309">ret</span><span class="op" id="4132312">[</span><span class="ident" id="4132313">n</span><span class="op" id="4132314">]</span><span class="op" id="4132315">.</span><span class="ident" id="4132316">Critical</span>&nbsp;<span class="op" id="4132325">=</span>&nbsp;<span class="ident" id="4132327">template</span><span class="op" id="4132335">.</span><span class="ident" id="4132336">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132367">var</span>&nbsp;<span class="ident" id="4132371">out</span>&nbsp;<span class="ident" id="4132375">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132393">out</span><span class="op" id="4132396">.</span><span class="ident" id="4132397">Permitted</span>&nbsp;<span class="op" id="4132407">=</span>&nbsp;<span class="builtinfunc" id="4132409">make</span><span class="op" id="4132413">(</span><span class="op" id="4132414">[</span><span class="op" id="4132415">]</span><span class="ident" id="4132416">generalSubtree</span><span class="op" id="4132430">,</span>&nbsp;<span class="builtinfunc" id="4132432">len</span><span class="op" id="4132435">(</span><span class="ident" id="4132436">template</span><span class="op" id="4132444">.</span><span class="ident" id="4132445">PermittedDNSDomains</span><span class="op" id="4132464">)</span><span class="op" id="4132465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132469">for</span>&nbsp;<span class="ident" id="4132473">i</span><span class="op" id="4132474">,</span>&nbsp;<span class="ident" id="4132476">permitted</span>&nbsp;<span class="op" id="4132486">:=</span>&nbsp;<span class="keyword" id="4132489">range</span>&nbsp;<span class="ident" id="4132495">template</span><span class="op" id="4132503">.</span><span class="ident" id="4132504">PermittedDNSDomains</span>&nbsp;<span class="op" id="4132524">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132529">out</span><span class="op" id="4132532">.</span><span class="ident" id="4132533">Permitted</span><span class="op" id="4132542">[</span><span class="ident" id="4132543">i</span><span class="op" id="4132544">]</span>&nbsp;<span class="op" id="4132546">=</span>&nbsp;<span class="ident" id="4132548">generalSubtree</span><span class="op" id="4132562">{</span><span class="ident" id="4132563">Name</span><span class="op" id="4132567">:</span>&nbsp;<span class="ident" id="4132569">permitted</span><span class="op" id="4132578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132586">ret</span><span class="op" id="4132589">[</span><span class="ident" id="4132590">n</span><span class="op" id="4132591">]</span><span class="op" id="4132592">.</span><span class="ident" id="4132593">Value</span><span class="op" id="4132598">,</span>&nbsp;<span class="ident" id="4132600">err</span>&nbsp;<span class="op" id="4132604">=</span>&nbsp;<span class="ident" id="4132606">asn1</span><span class="op" id="4132610">.</span><span class="ident" id="4132611">Marshal</span><span class="op" id="4132618">(</span><span class="ident" id="4132619">out</span><span class="op" id="4132622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132626">if</span>&nbsp;<span class="ident" id="4132629">err</span>&nbsp;<span class="op" id="4132633">!=</span>&nbsp;<span class="ident" id="4132636">nil</span>&nbsp;<span class="op" id="4132640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132645">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132658">n</span><span class="op" id="4132659">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132667">if</span>&nbsp;<span class="builtinfunc" id="4132670">len</span><span class="op" id="4132673">(</span><span class="ident" id="4132674">template</span><span class="op" id="4132682">.</span><span class="ident" id="4132683">CRLDistributionPoints</span><span class="op" id="4132704">)</span>&nbsp;<span class="op" id="4132706">&gt;</span>&nbsp;<span class="num" id="4132708">0</span>&nbsp;<span class="op" id="4132710">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132715">!</span><span class="ident" id="4132716">oidInExtensions</span><span class="op" id="4132731">(</span><span class="ident" id="4132732">oidExtensionCRLDistributionPoints</span><span class="op" id="4132765">,</span>&nbsp;<span class="ident" id="4132767">template</span><span class="op" id="4132775">.</span><span class="ident" id="4132776">ExtraExtensions</span><span class="op" id="4132791">)</span>&nbsp;<span class="op" id="4132793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132797">ret</span><span class="op" id="4132800">[</span><span class="ident" id="4132801">n</span><span class="op" id="4132802">]</span><span class="op" id="4132803">.</span><span class="ident" id="4132804">Id</span>&nbsp;<span class="op" id="4132807">=</span>&nbsp;<span class="ident" id="4132809">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132846">var</span>&nbsp;<span class="ident" id="4132850">crlDp</span>&nbsp;<span class="op" id="4132856">[</span><span class="op" id="4132857">]</span><span class="ident" id="4132858">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132878">for</span>&nbsp;<span class="ident" id="4132882">_</span><span class="op" id="4132883">,</span>&nbsp;<span class="ident" id="4132885">name</span>&nbsp;<span class="op" id="4132890">:=</span>&nbsp;<span class="keyword" id="4132893">range</span>&nbsp;<span class="ident" id="4132899">template</span><span class="op" id="4132907">.</span><span class="ident" id="4132908">CRLDistributionPoints</span>&nbsp;<span class="op" id="4132930">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132935">rawFullName</span><span class="op" id="4132946">,</span>&nbsp;<span class="ident" id="4132948">_</span>&nbsp;<span class="op" id="4132950">:=</span>&nbsp;<span class="ident" id="4132953">asn1</span><span class="op" id="4132957">.</span><span class="ident" id="4132958">Marshal</span><span class="op" id="4132965">(</span><span class="ident" id="4132966">asn1</span><span class="op" id="4132970">.</span><span class="ident" id="4132971">RawValue</span><span class="op" id="4132979">{</span><span class="ident" id="4132980">Tag</span><span class="op" id="4132983">:</span>&nbsp;<span class="num" id="4132985">6</span><span class="op" id="4132986">,</span>&nbsp;<span class="ident" id="4132988">Class</span><span class="op" id="4132993">:</span>&nbsp;<span class="num" id="4132995">2</span><span class="op" id="4132996">,</span>&nbsp;<span class="ident" id="4132998">Bytes</span><span class="op" id="4133003">:</span>&nbsp;<span class="op" id="4133005">[</span><span class="op" id="4133006">]</span><span class="builtintype" id="4133007">byte</span><span class="op" id="4133011">(</span><span class="ident" id="4133012">name</span><span class="op" id="4133016">)</span><span class="op" id="4133017">}</span><span class="op" id="4133018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133024">dp</span>&nbsp;<span class="op" id="4133027">:=</span>&nbsp;<span class="ident" id="4133030">distributionPoint</span><span class="op" id="4133047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133053">DistributionPoint</span><span class="op" id="4133070">:</span>&nbsp;<span class="ident" id="4133072">distributionPointName</span><span class="op" id="4133093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133100">FullName</span><span class="op" id="4133108">:</span>&nbsp;<span class="ident" id="4133110">asn1</span><span class="op" id="4133114">.</span><span class="ident" id="4133115">RawValue</span><span class="op" id="4133123">{</span><span class="ident" id="4133124">Tag</span><span class="op" id="4133127">:</span>&nbsp;<span class="num" id="4133129">0</span><span class="op" id="4133130">,</span>&nbsp;<span class="ident" id="4133132">Class</span><span class="op" id="4133137">:</span>&nbsp;<span class="num" id="4133139">2</span><span class="op" id="4133140">,</span>&nbsp;<span class="ident" id="4133142">IsCompound</span><span class="op" id="4133152">:</span>&nbsp;<span class="ident" id="4133154">true</span><span class="op" id="4133158">,</span>&nbsp;<span class="ident" id="4133160">Bytes</span><span class="op" id="4133165">:</span>&nbsp;<span class="ident" id="4133167">rawFullName</span><span class="op" id="4133178">}</span><span class="op" id="4133179">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133185">}</span><span class="op" id="4133186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133196">crlDp</span>&nbsp;<span class="op" id="4133202">=</span>&nbsp;<span class="builtinfunc" id="4133204">append</span><span class="op" id="4133210">(</span><span class="ident" id="4133211">crlDp</span><span class="op" id="4133216">,</span>&nbsp;<span class="ident" id="4133218">dp</span><span class="op" id="4133220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133229">ret</span><span class="op" id="4133232">[</span><span class="ident" id="4133233">n</span><span class="op" id="4133234">]</span><span class="op" id="4133235">.</span><span class="ident" id="4133236">Value</span><span class="op" id="4133241">,</span>&nbsp;<span class="ident" id="4133243">err</span>&nbsp;<span class="op" id="4133247">=</span>&nbsp;<span class="ident" id="4133249">asn1</span><span class="op" id="4133253">.</span><span class="ident" id="4133254">Marshal</span><span class="op" id="4133261">(</span><span class="ident" id="4133262">crlDp</span><span class="op" id="4133267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133271">if</span>&nbsp;<span class="ident" id="4133274">err</span>&nbsp;<span class="op" id="4133278">!=</span>&nbsp;<span class="ident" id="4133281">nil</span>&nbsp;<span class="op" id="4133285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133290">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133303">n</span><span class="op" id="4133304">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133312">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133385">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133444">return</span>&nbsp;<span class="builtinfunc" id="4133451">append</span><span class="op" id="4133457">(</span><span class="ident" id="4133458">ret</span><span class="op" id="4133461">[</span><span class="op" id="4133462">:</span><span class="ident" id="4133463">n</span><span class="op" id="4133464">]</span><span class="op" id="4133465">,</span>&nbsp;<span class="ident" id="4133467">template</span><span class="op" id="4133475">.</span><span class="ident" id="4133476">ExtraExtensions</span><span class="op" id="4133491">...</span><span class="op" id="4133494">)</span><span class="op" id="4133495">,</span>&nbsp;<span class="ident" id="4133497">nil</span><br>
<span class="lineno"></span><span class="op" id="4133501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133504">func</span>&nbsp;<span class="ident" id="4133509">subjectBytes</span><span class="op" id="4133521">(</span><span class="ident" id="4133522">cert</span>&nbsp;<span class="op" id="4133527">*</span><span class="ident" id="4133528">Certificate</span><span class="op" id="4133539">)</span>&nbsp;<span class="op" id="4133541">(</span><span class="op" id="4133542">[</span><span class="op" id="4133543">]</span><span class="builtintype" id="4133544">byte</span><span class="op" id="4133548">,</span>&nbsp;<span class="builtintype" id="4133550">error</span><span class="op" id="4133555">)</span>&nbsp;<span class="op" id="4133557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133560">if</span>&nbsp;<span class="builtinfunc" id="4133563">len</span><span class="op" id="4133566">(</span><span class="ident" id="4133567">cert</span><span class="op" id="4133571">.</span><span class="ident" id="4133572">RawSubject</span><span class="op" id="4133582">)</span>&nbsp;<span class="op" id="4133584">&gt;</span>&nbsp;<span class="num" id="4133586">0</span>&nbsp;<span class="op" id="4133588">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133592">return</span>&nbsp;<span class="ident" id="4133599">cert</span><span class="op" id="4133603">.</span><span class="ident" id="4133604">RawSubject</span><span class="op" id="4133614">,</span>&nbsp;<span class="ident" id="4133616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133625">return</span>&nbsp;<span class="ident" id="4133632">asn1</span><span class="op" id="4133636">.</span><span class="ident" id="4133637">Marshal</span><span class="op" id="4133644">(</span><span class="ident" id="4133645">cert</span><span class="op" id="4133649">.</span><span class="ident" id="4133650">Subject</span><span class="op" id="4133657">.</span><span class="ident" id="4133658">ToRDNSequence</span><span class="op" id="4133671">(</span><span class="op" id="4133672">)</span><span class="op" id="4133673">)</span><br>
<span class="lineno"></span><span class="op" id="4133675">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4133678">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4133755">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4133826">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4133850">func</span>&nbsp;<span class="ident" id="4133855">signingParamsForPrivateKey</span><span class="op" id="4133881">(</span><span class="ident" id="4133882">priv</span>&nbsp;<span class="keyword" id="4133887">interface</span><span class="op" id="4133896">{</span><span class="op" id="4133897">}</span><span class="op" id="4133898">,</span>&nbsp;<span class="ident" id="4133900">requestedSigAlgo</span>&nbsp;<span class="ident" id="4133917">SignatureAlgorithm</span><span class="op" id="4133935">)</span>&nbsp;<span class="op" id="4133937">(</span><span class="ident" id="4133938">hashFunc</span>&nbsp;<span class="ident" id="4133947">crypto</span><span class="op" id="4133953">.</span><span class="ident" id="4133954">Hash</span><span class="op" id="4133958">,</span>&nbsp;<span class="ident" id="4133960">sigAlgo</span>&nbsp;<span class="ident" id="4133968">pkix</span><span class="op" id="4133972">.</span><span class="ident" id="4133973">AlgorithmIdentifier</span><span class="op" id="4133992">,</span>&nbsp;<span class="ident" id="4133994">err</span>&nbsp;<span class="builtintype" id="4133998">error</span><span class="op" id="4134003">)</span>&nbsp;<span class="op" id="4134005">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134008">var</span>&nbsp;<span class="ident" id="4134012">pubType</span>&nbsp;<span class="ident" id="4134020">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134041">switch</span>&nbsp;<span class="ident" id="4134048">priv</span>&nbsp;<span class="op" id="4134053">:=</span>&nbsp;<span class="ident" id="4134056">priv</span><span class="op" id="4134060">.</span><span class="op" id="4134061">(</span><span class="keyword" id="4134062">type</span><span class="op" id="4134066">)</span>&nbsp;<span class="op" id="4134068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134071">case</span>&nbsp;<span class="op" id="4134076">*</span><span class="ident" id="4134077">rsa</span><span class="op" id="4134080">.</span><span class="ident" id="4134081">PrivateKey</span><span class="op" id="4134091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134095">pubType</span>&nbsp;<span class="op" id="4134103">=</span>&nbsp;<span class="ident" id="4134105">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134111">sigAlgo</span><span class="op" id="4134118">.</span><span class="ident" id="4134119">Algorithm</span>&nbsp;<span class="op" id="4134129">=</span>&nbsp;<span class="ident" id="4134131">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134159">hashFunc</span>&nbsp;<span class="op" id="4134168">=</span>&nbsp;<span class="ident" id="4134170">crypto</span><span class="op" id="4134176">.</span><span class="ident" id="4134177">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134186">case</span>&nbsp;<span class="op" id="4134191">*</span><span class="ident" id="4134192">ecdsa</span><span class="op" id="4134197">.</span><span class="ident" id="4134198">PrivateKey</span><span class="op" id="4134208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134212">pubType</span>&nbsp;<span class="op" id="4134220">=</span>&nbsp;<span class="ident" id="4134222">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134231">switch</span>&nbsp;<span class="ident" id="4134238">priv</span><span class="op" id="4134242">.</span><span class="ident" id="4134243">Curve</span>&nbsp;<span class="op" id="4134249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134253">case</span>&nbsp;<span class="ident" id="4134258">elliptic</span><span class="op" id="4134266">.</span><span class="ident" id="4134267">P224</span><span class="op" id="4134271">(</span><span class="op" id="4134272">)</span><span class="op" id="4134273">,</span>&nbsp;<span class="ident" id="4134275">elliptic</span><span class="op" id="4134283">.</span><span class="ident" id="4134284">P256</span><span class="op" id="4134288">(</span><span class="op" id="4134289">)</span><span class="op" id="4134290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134295">hashFunc</span>&nbsp;<span class="op" id="4134304">=</span>&nbsp;<span class="ident" id="4134306">crypto</span><span class="op" id="4134312">.</span><span class="ident" id="4134313">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134323">sigAlgo</span><span class="op" id="4134330">.</span><span class="ident" id="4134331">Algorithm</span>&nbsp;<span class="op" id="4134341">=</span>&nbsp;<span class="ident" id="4134343">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134373">case</span>&nbsp;<span class="ident" id="4134378">elliptic</span><span class="op" id="4134386">.</span><span class="ident" id="4134387">P384</span><span class="op" id="4134391">(</span><span class="op" id="4134392">)</span><span class="op" id="4134393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134398">hashFunc</span>&nbsp;<span class="op" id="4134407">=</span>&nbsp;<span class="ident" id="4134409">crypto</span><span class="op" id="4134415">.</span><span class="ident" id="4134416">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134426">sigAlgo</span><span class="op" id="4134433">.</span><span class="ident" id="4134434">Algorithm</span>&nbsp;<span class="op" id="4134444">=</span>&nbsp;<span class="ident" id="4134446">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134476">case</span>&nbsp;<span class="ident" id="4134481">elliptic</span><span class="op" id="4134489">.</span><span class="ident" id="4134490">P521</span><span class="op" id="4134494">(</span><span class="op" id="4134495">)</span><span class="op" id="4134496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134501">hashFunc</span>&nbsp;<span class="op" id="4134510">=</span>&nbsp;<span class="ident" id="4134512">crypto</span><span class="op" id="4134518">.</span><span class="ident" id="4134519">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134529">sigAlgo</span><span class="op" id="4134536">.</span><span class="ident" id="4134537">Algorithm</span>&nbsp;<span class="op" id="4134547">=</span>&nbsp;<span class="ident" id="4134549">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134579">default</span><span class="op" id="4134586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134591">err</span>&nbsp;<span class="op" id="4134595">=</span>&nbsp;<span class="ident" id="4134597">errors</span><span class="op" id="4134603">.</span><span class="ident" id="4134604">New</span><span class="op" id="4134607">(</span><span class="string" id="4134608">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4134638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134646">default</span><span class="op" id="4134653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134657">err</span>&nbsp;<span class="op" id="4134661">=</span>&nbsp;<span class="ident" id="4134663">errors</span><span class="op" id="4134669">.</span><span class="ident" id="4134670">New</span><span class="op" id="4134673">(</span><span class="string" id="4134674">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4134723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134730">if</span>&nbsp;<span class="ident" id="4134733">err</span>&nbsp;<span class="op" id="4134737">!=</span>&nbsp;<span class="ident" id="4134740">nil</span>&nbsp;<span class="op" id="4134744">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134748">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134760">if</span>&nbsp;<span class="ident" id="4134763">requestedSigAlgo</span>&nbsp;<span class="op" id="4134780">==</span>&nbsp;<span class="num" id="4134783">0</span>&nbsp;<span class="op" id="4134785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134789">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134801">found</span>&nbsp;<span class="op" id="4134807">:=</span>&nbsp;<span class="ident" id="4134810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134817">for</span>&nbsp;<span class="ident" id="4134821">_</span><span class="op" id="4134822">,</span>&nbsp;<span class="ident" id="4134824">details</span>&nbsp;<span class="op" id="4134832">:=</span>&nbsp;<span class="keyword" id="4134835">range</span>&nbsp;<span class="ident" id="4134841">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4134867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134871">if</span>&nbsp;<span class="ident" id="4134874">details</span><span class="op" id="4134881">.</span><span class="ident" id="4134882">algo</span>&nbsp;<span class="op" id="4134887">==</span>&nbsp;<span class="ident" id="4134890">requestedSigAlgo</span>&nbsp;<span class="op" id="4134907">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134912">if</span>&nbsp;<span class="ident" id="4134915">details</span><span class="op" id="4134922">.</span><span class="ident" id="4134923">pubKeyAlgo</span>&nbsp;<span class="op" id="4134934">!=</span>&nbsp;<span class="ident" id="4134937">pubType</span>&nbsp;<span class="op" id="4134945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134951">err</span>&nbsp;<span class="op" id="4134955">=</span>&nbsp;<span class="ident" id="4134957">errors</span><span class="op" id="4134963">.</span><span class="ident" id="4134964">New</span><span class="op" id="4134967">(</span><span class="string" id="4134968">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4135036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135042">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4135052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135057">sigAlgo</span><span class="op" id="4135064">.</span><span class="ident" id="4135065">Algorithm</span><span class="op" id="4135074">,</span>&nbsp;<span class="ident" id="4135076">hashFunc</span>&nbsp;<span class="op" id="4135085">=</span>&nbsp;<span class="ident" id="4135087">details</span><span class="op" id="4135094">.</span><span class="ident" id="4135095">oid</span><span class="op" id="4135098">,</span>&nbsp;<span class="ident" id="4135100">details</span><span class="op" id="4135107">.</span><span class="ident" id="4135108">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135116">if</span>&nbsp;<span class="ident" id="4135119">hashFunc</span>&nbsp;<span class="op" id="4135128">==</span>&nbsp;<span class="num" id="4135131">0</span>&nbsp;<span class="op" id="4135133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135139">err</span>&nbsp;<span class="op" id="4135143">=</span>&nbsp;<span class="ident" id="4135145">errors</span><span class="op" id="4135151">.</span><span class="ident" id="4135152">New</span><span class="op" id="4135155">(</span><span class="string" id="4135156">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4135204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135210">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4135220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135225">found</span>&nbsp;<span class="op" id="4135231">=</span>&nbsp;<span class="ident" id="4135233">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135241">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4135249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4135252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135256">if</span>&nbsp;<span class="op" id="4135259">!</span><span class="ident" id="4135260">found</span>&nbsp;<span class="op" id="4135266">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135270">err</span>&nbsp;<span class="op" id="4135274">=</span>&nbsp;<span class="ident" id="4135276">errors</span><span class="op" id="4135282">.</span><span class="ident" id="4135283">New</span><span class="op" id="4135286">(</span><span class="string" id="4135287">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4135321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4135324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135328">return</span><br>
<span class="lineno"></span><span class="op" id="4135335">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4135338">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4135410">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4135487">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4135566">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4135640">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4135684">//</span><br>
<span class="lineno"></span><span class="comment" id="4135687">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4135767">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4135841">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4135894">//</span><br>
<span class="lineno"></span><span class="comment" id="4135897">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4135955">//</span><br>
<span class="lineno"></span><span class="comment" id="4135958">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4136027">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4136104">func</span>&nbsp;<span class="ident" id="4136109">CreateCertificate</span><span class="op" id="4136126">(</span><span class="ident" id="4136127">rand</span>&nbsp;<span class="ident" id="4136132">io</span><span class="op" id="4136134">.</span><span class="ident" id="4136135">Reader</span><span class="op" id="4136141">,</span>&nbsp;<span class="ident" id="4136143">template</span><span class="op" id="4136151">,</span>&nbsp;<span class="ident" id="4136153">parent</span>&nbsp;<span class="op" id="4136160">*</span><span class="ident" id="4136161">Certificate</span><span class="op" id="4136172">,</span>&nbsp;<span class="ident" id="4136174">pub</span>&nbsp;<span class="keyword" id="4136178">interface</span><span class="op" id="4136187">{</span><span class="op" id="4136188">}</span><span class="op" id="4136189">,</span>&nbsp;<span class="ident" id="4136191">priv</span>&nbsp;<span class="keyword" id="4136196">interface</span><span class="op" id="4136205">{</span><span class="op" id="4136206">}</span><span class="op" id="4136207">)</span>&nbsp;<span class="op" id="4136209">(</span><span class="ident" id="4136210">cert</span>&nbsp;<span class="op" id="4136215">[</span><span class="op" id="4136216">]</span><span class="builtintype" id="4136217">byte</span><span class="op" id="4136221">,</span>&nbsp;<span class="ident" id="4136223">err</span>&nbsp;<span class="builtintype" id="4136227">error</span><span class="op" id="4136232">)</span>&nbsp;<span class="op" id="4136234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136237">hashFunc</span><span class="op" id="4136245">,</span>&nbsp;<span class="ident" id="4136247">signatureAlgorithm</span><span class="op" id="4136265">,</span>&nbsp;<span class="ident" id="4136267">err</span>&nbsp;<span class="op" id="4136271">:=</span>&nbsp;<span class="ident" id="4136274">signingParamsForPrivateKey</span><span class="op" id="4136300">(</span><span class="ident" id="4136301">priv</span><span class="op" id="4136305">,</span>&nbsp;<span class="ident" id="4136307">template</span><span class="op" id="4136315">.</span><span class="ident" id="4136316">SignatureAlgorithm</span><span class="op" id="4136334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136337">if</span>&nbsp;<span class="ident" id="4136340">err</span>&nbsp;<span class="op" id="4136344">!=</span>&nbsp;<span class="ident" id="4136347">nil</span>&nbsp;<span class="op" id="4136351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136355">return</span>&nbsp;<span class="ident" id="4136362">nil</span><span class="op" id="4136365">,</span>&nbsp;<span class="ident" id="4136367">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136372">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136376">publicKeyBytes</span><span class="op" id="4136390">,</span>&nbsp;<span class="ident" id="4136392">publicKeyAlgorithm</span><span class="op" id="4136410">,</span>&nbsp;<span class="ident" id="4136412">err</span>&nbsp;<span class="op" id="4136416">:=</span>&nbsp;<span class="ident" id="4136419">marshalPublicKey</span><span class="op" id="4136435">(</span><span class="ident" id="4136436">pub</span><span class="op" id="4136439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136442">if</span>&nbsp;<span class="ident" id="4136445">err</span>&nbsp;<span class="op" id="4136449">!=</span>&nbsp;<span class="ident" id="4136452">nil</span>&nbsp;<span class="op" id="4136456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136460">return</span>&nbsp;<span class="ident" id="4136467">nil</span><span class="op" id="4136470">,</span>&nbsp;<span class="ident" id="4136472">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136477">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136481">if</span>&nbsp;<span class="ident" id="4136484">err</span>&nbsp;<span class="op" id="4136488">!=</span>&nbsp;<span class="ident" id="4136491">nil</span>&nbsp;<span class="op" id="4136495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136511">if</span>&nbsp;<span class="builtinfunc" id="4136514">len</span><span class="op" id="4136517">(</span><span class="ident" id="4136518">parent</span><span class="op" id="4136524">.</span><span class="ident" id="4136525">SubjectKeyId</span><span class="op" id="4136537">)</span>&nbsp;<span class="op" id="4136539">&gt;</span>&nbsp;<span class="num" id="4136541">0</span>&nbsp;<span class="op" id="4136543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136547">template</span><span class="op" id="4136555">.</span><span class="ident" id="4136556">AuthorityKeyId</span>&nbsp;<span class="op" id="4136571">=</span>&nbsp;<span class="ident" id="4136573">parent</span><span class="op" id="4136579">.</span><span class="ident" id="4136580">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136598">extensions</span><span class="op" id="4136608">,</span>&nbsp;<span class="ident" id="4136610">err</span>&nbsp;<span class="op" id="4136614">:=</span>&nbsp;<span class="ident" id="4136617">buildExtensions</span><span class="op" id="4136632">(</span><span class="ident" id="4136633">template</span><span class="op" id="4136641">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136644">if</span>&nbsp;<span class="ident" id="4136647">err</span>&nbsp;<span class="op" id="4136651">!=</span>&nbsp;<span class="ident" id="4136654">nil</span>&nbsp;<span class="op" id="4136658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136662">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136674">asn1Issuer</span><span class="op" id="4136684">,</span>&nbsp;<span class="ident" id="4136686">err</span>&nbsp;<span class="op" id="4136690">:=</span>&nbsp;<span class="ident" id="4136693">subjectBytes</span><span class="op" id="4136705">(</span><span class="ident" id="4136706">parent</span><span class="op" id="4136712">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136715">if</span>&nbsp;<span class="ident" id="4136718">err</span>&nbsp;<span class="op" id="4136722">!=</span>&nbsp;<span class="ident" id="4136725">nil</span>&nbsp;<span class="op" id="4136729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136733">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136745">asn1Subject</span><span class="op" id="4136756">,</span>&nbsp;<span class="ident" id="4136758">err</span>&nbsp;<span class="op" id="4136762">:=</span>&nbsp;<span class="ident" id="4136765">subjectBytes</span><span class="op" id="4136777">(</span><span class="ident" id="4136778">template</span><span class="op" id="4136786">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136789">if</span>&nbsp;<span class="ident" id="4136792">err</span>&nbsp;<span class="op" id="4136796">!=</span>&nbsp;<span class="ident" id="4136799">nil</span>&nbsp;<span class="op" id="4136803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136819">encodedPublicKey</span>&nbsp;<span class="op" id="4136836">:=</span>&nbsp;<span class="ident" id="4136839">asn1</span><span class="op" id="4136843">.</span><span class="ident" id="4136844">BitString</span><span class="op" id="4136853">{</span><span class="ident" id="4136854">BitLength</span><span class="op" id="4136863">:</span>&nbsp;<span class="builtinfunc" id="4136865">len</span><span class="op" id="4136868">(</span><span class="ident" id="4136869">publicKeyBytes</span><span class="op" id="4136883">)</span>&nbsp;<span class="op" id="4136885">*</span>&nbsp;<span class="num" id="4136887">8</span><span class="op" id="4136888">,</span>&nbsp;<span class="ident" id="4136890">Bytes</span><span class="op" id="4136895">:</span>&nbsp;<span class="ident" id="4136897">publicKeyBytes</span><span class="op" id="4136911">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136914">c</span>&nbsp;<span class="op" id="4136916">:=</span>&nbsp;<span class="ident" id="4136919">tbsCertificate</span><span class="op" id="4136933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136937">Version</span><span class="op" id="4136944">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4136957">2</span><span class="op" id="4136958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136962">SerialNumber</span><span class="op" id="4136974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4136982">template</span><span class="op" id="4136990">.</span><span class="ident" id="4136991">SerialNumber</span><span class="op" id="4137003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137007">SignatureAlgorithm</span><span class="op" id="4137025">:</span>&nbsp;<span class="ident" id="4137027">signatureAlgorithm</span><span class="op" id="4137045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137049">Issuer</span><span class="op" id="4137055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4137069">asn1</span><span class="op" id="4137073">.</span><span class="ident" id="4137074">RawValue</span><span class="op" id="4137082">{</span><span class="ident" id="4137083">FullBytes</span><span class="op" id="4137092">:</span>&nbsp;<span class="ident" id="4137094">asn1Issuer</span><span class="op" id="4137104">}</span><span class="op" id="4137105">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137109">Validity</span><span class="op" id="4137117">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4137129">validity</span><span class="op" id="4137137">{</span><span class="ident" id="4137138">template</span><span class="op" id="4137146">.</span><span class="ident" id="4137147">NotBefore</span><span class="op" id="4137156">.</span><span class="ident" id="4137157">UTC</span><span class="op" id="4137160">(</span><span class="op" id="4137161">)</span><span class="op" id="4137162">,</span>&nbsp;<span class="ident" id="4137164">template</span><span class="op" id="4137172">.</span><span class="ident" id="4137173">NotAfter</span><span class="op" id="4137181">.</span><span class="ident" id="4137182">UTC</span><span class="op" id="4137185">(</span><span class="op" id="4137186">)</span><span class="op" id="4137187">}</span><span class="op" id="4137188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137192">Subject</span><span class="op" id="4137199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4137212">asn1</span><span class="op" id="4137216">.</span><span class="ident" id="4137217">RawValue</span><span class="op" id="4137225">{</span><span class="ident" id="4137226">FullBytes</span><span class="op" id="4137235">:</span>&nbsp;<span class="ident" id="4137237">asn1Subject</span><span class="op" id="4137248">}</span><span class="op" id="4137249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137253">PublicKey</span><span class="op" id="4137262">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4137273">publicKeyInfo</span><span class="op" id="4137286">{</span><span class="ident" id="4137287">nil</span><span class="op" id="4137290">,</span>&nbsp;<span class="ident" id="4137292">publicKeyAlgorithm</span><span class="op" id="4137310">,</span>&nbsp;<span class="ident" id="4137312">encodedPublicKey</span><span class="op" id="4137328">}</span><span class="op" id="4137329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137333">Extensions</span><span class="op" id="4137343">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4137353">extensions</span><span class="op" id="4137363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137366">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137370">tbsCertContents</span><span class="op" id="4137385">,</span>&nbsp;<span class="ident" id="4137387">err</span>&nbsp;<span class="op" id="4137391">:=</span>&nbsp;<span class="ident" id="4137394">asn1</span><span class="op" id="4137398">.</span><span class="ident" id="4137399">Marshal</span><span class="op" id="4137406">(</span><span class="ident" id="4137407">c</span><span class="op" id="4137408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137411">if</span>&nbsp;<span class="ident" id="4137414">err</span>&nbsp;<span class="op" id="4137418">!=</span>&nbsp;<span class="ident" id="4137421">nil</span>&nbsp;<span class="op" id="4137425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137429">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137437">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137441">c</span><span class="op" id="4137442">.</span><span class="ident" id="4137443">Raw</span>&nbsp;<span class="op" id="4137447">=</span>&nbsp;<span class="ident" id="4137449">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137467">h</span>&nbsp;<span class="op" id="4137469">:=</span>&nbsp;<span class="ident" id="4137472">hashFunc</span><span class="op" id="4137480">.</span><span class="ident" id="4137481">New</span><span class="op" id="4137484">(</span><span class="op" id="4137485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137488">h</span><span class="op" id="4137489">.</span><span class="ident" id="4137490">Write</span><span class="op" id="4137495">(</span><span class="ident" id="4137496">tbsCertContents</span><span class="op" id="4137511">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137514">digest</span>&nbsp;<span class="op" id="4137521">:=</span>&nbsp;<span class="ident" id="4137524">h</span><span class="op" id="4137525">.</span><span class="ident" id="4137526">Sum</span><span class="op" id="4137529">(</span><span class="ident" id="4137530">nil</span><span class="op" id="4137533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137537">var</span>&nbsp;<span class="ident" id="4137541">signature</span>&nbsp;<span class="op" id="4137551">[</span><span class="op" id="4137552">]</span><span class="builtintype" id="4137553">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137560">switch</span>&nbsp;<span class="ident" id="4137567">priv</span>&nbsp;<span class="op" id="4137572">:=</span>&nbsp;<span class="ident" id="4137575">priv</span><span class="op" id="4137579">.</span><span class="op" id="4137580">(</span><span class="keyword" id="4137581">type</span><span class="op" id="4137585">)</span>&nbsp;<span class="op" id="4137587">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137590">case</span>&nbsp;<span class="op" id="4137595">*</span><span class="ident" id="4137596">rsa</span><span class="op" id="4137599">.</span><span class="ident" id="4137600">PrivateKey</span><span class="op" id="4137610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137614">signature</span><span class="op" id="4137623">,</span>&nbsp;<span class="ident" id="4137625">err</span>&nbsp;<span class="op" id="4137629">=</span>&nbsp;<span class="ident" id="4137631">rsa</span><span class="op" id="4137634">.</span><span class="ident" id="4137635">SignPKCS1v15</span><span class="op" id="4137647">(</span><span class="ident" id="4137648">rand</span><span class="op" id="4137652">,</span>&nbsp;<span class="ident" id="4137654">priv</span><span class="op" id="4137658">,</span>&nbsp;<span class="ident" id="4137660">hashFunc</span><span class="op" id="4137668">,</span>&nbsp;<span class="ident" id="4137670">digest</span><span class="op" id="4137676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137679">case</span>&nbsp;<span class="op" id="4137684">*</span><span class="ident" id="4137685">ecdsa</span><span class="op" id="4137690">.</span><span class="ident" id="4137691">PrivateKey</span><span class="op" id="4137701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137705">var</span>&nbsp;<span class="ident" id="4137709">r</span><span class="op" id="4137710">,</span>&nbsp;<span class="ident" id="4137712">s</span>&nbsp;<span class="op" id="4137714">*</span><span class="ident" id="4137715">big</span><span class="op" id="4137718">.</span><span class="ident" id="4137719">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137725">if</span>&nbsp;<span class="ident" id="4137728">r</span><span class="op" id="4137729">,</span>&nbsp;<span class="ident" id="4137731">s</span><span class="op" id="4137732">,</span>&nbsp;<span class="ident" id="4137734">err</span>&nbsp;<span class="op" id="4137738">=</span>&nbsp;<span class="ident" id="4137740">ecdsa</span><span class="op" id="4137745">.</span><span class="ident" id="4137746">Sign</span><span class="op" id="4137750">(</span><span class="ident" id="4137751">rand</span><span class="op" id="4137755">,</span>&nbsp;<span class="ident" id="4137757">priv</span><span class="op" id="4137761">,</span>&nbsp;<span class="ident" id="4137763">digest</span><span class="op" id="4137769">)</span><span class="op" id="4137770">;</span>&nbsp;<span class="ident" id="4137772">err</span>&nbsp;<span class="op" id="4137776">==</span>&nbsp;<span class="ident" id="4137779">nil</span>&nbsp;<span class="op" id="4137783">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137788">signature</span><span class="op" id="4137797">,</span>&nbsp;<span class="ident" id="4137799">err</span>&nbsp;<span class="op" id="4137803">=</span>&nbsp;<span class="ident" id="4137805">asn1</span><span class="op" id="4137809">.</span><span class="ident" id="4137810">Marshal</span><span class="op" id="4137817">(</span><span class="ident" id="4137818">ecdsaSignature</span><span class="op" id="4137832">{</span><span class="ident" id="4137833">r</span><span class="op" id="4137834">,</span>&nbsp;<span class="ident" id="4137836">s</span><span class="op" id="4137837">}</span><span class="op" id="4137838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137845">default</span><span class="op" id="4137852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4137856">panic</span><span class="op" id="4137861">(</span><span class="string" id="4137862">&#34;internal&nbsp;error&#34;</span><span class="op" id="4137878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137881">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137885">if</span>&nbsp;<span class="ident" id="4137888">err</span>&nbsp;<span class="op" id="4137892">!=</span>&nbsp;<span class="ident" id="4137895">nil</span>&nbsp;<span class="op" id="4137899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137915">cert</span><span class="op" id="4137919">,</span>&nbsp;<span class="ident" id="4137921">err</span>&nbsp;<span class="op" id="4137925">=</span>&nbsp;<span class="ident" id="4137927">asn1</span><span class="op" id="4137931">.</span><span class="ident" id="4137932">Marshal</span><span class="op" id="4137939">(</span><span class="ident" id="4137940">certificate</span><span class="op" id="4137951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137955">nil</span><span class="op" id="4137958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137962">c</span><span class="op" id="4137963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137967">signatureAlgorithm</span><span class="op" id="4137985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137989">asn1</span><span class="op" id="4137993">.</span><span class="ident" id="4137994">BitString</span><span class="op" id="4138003">{</span><span class="ident" id="4138004">Bytes</span><span class="op" id="4138009">:</span>&nbsp;<span class="ident" id="4138011">signature</span><span class="op" id="4138020">,</span>&nbsp;<span class="ident" id="4138022">BitLength</span><span class="op" id="4138031">:</span>&nbsp;<span class="builtinfunc" id="4138033">len</span><span class="op" id="4138036">(</span><span class="ident" id="4138037">signature</span><span class="op" id="4138046">)</span>&nbsp;<span class="op" id="4138048">*</span>&nbsp;<span class="num" id="4138050">8</span><span class="op" id="4138051">}</span><span class="op" id="4138052">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138055">}</span><span class="op" id="4138056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138059">return</span><br>
<span class="lineno"></span><span class="op" id="4138066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4138069">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4138147">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4138155">var</span>&nbsp;<span class="ident" id="4138159">pemCRLPrefix</span>&nbsp;<span class="op" id="4138172">=</span>&nbsp;<span class="op" id="4138174">[</span><span class="op" id="4138175">]</span><span class="builtintype" id="4138176">byte</span><span class="op" id="4138180">(</span><span class="string" id="4138181">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4138202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4138205">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4138250">var</span>&nbsp;<span class="ident" id="4138254">pemType</span>&nbsp;<span class="op" id="4138262">=</span>&nbsp;<span class="string" id="4138264">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4138276">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4138352">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4138431">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4138508">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4138520">func</span>&nbsp;<span class="ident" id="4138525">ParseCRL</span><span class="op" id="4138533">(</span><span class="ident" id="4138534">crlBytes</span>&nbsp;<span class="op" id="4138543">[</span><span class="op" id="4138544">]</span><span class="builtintype" id="4138545">byte</span><span class="op" id="4138549">)</span>&nbsp;<span class="op" id="4138551">(</span><span class="ident" id="4138552">certList</span>&nbsp;<span class="op" id="4138561">*</span><span class="ident" id="4138562">pkix</span><span class="op" id="4138566">.</span><span class="ident" id="4138567">CertificateList</span><span class="op" id="4138582">,</span>&nbsp;<span class="ident" id="4138584">err</span>&nbsp;<span class="builtintype" id="4138588">error</span><span class="op" id="4138593">)</span>&nbsp;<span class="op" id="4138595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138598">if</span>&nbsp;<span class="ident" id="4138601">bytes</span><span class="op" id="4138606">.</span><span class="ident" id="4138607">HasPrefix</span><span class="op" id="4138616">(</span><span class="ident" id="4138617">crlBytes</span><span class="op" id="4138625">,</span>&nbsp;<span class="ident" id="4138627">pemCRLPrefix</span><span class="op" id="4138639">)</span>&nbsp;<span class="op" id="4138641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138645">block</span><span class="op" id="4138650">,</span>&nbsp;<span class="ident" id="4138652">_</span>&nbsp;<span class="op" id="4138654">:=</span>&nbsp;<span class="ident" id="4138657">pem</span><span class="op" id="4138660">.</span><span class="ident" id="4138661">Decode</span><span class="op" id="4138667">(</span><span class="ident" id="4138668">crlBytes</span><span class="op" id="4138676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138680">if</span>&nbsp;<span class="ident" id="4138683">block</span>&nbsp;<span class="op" id="4138689">!=</span>&nbsp;<span class="ident" id="4138692">nil</span>&nbsp;<span class="op" id="4138696">&amp;&amp;</span>&nbsp;<span class="ident" id="4138699">block</span><span class="op" id="4138704">.</span><span class="ident" id="4138705">Type</span>&nbsp;<span class="op" id="4138710">==</span>&nbsp;<span class="ident" id="4138713">pemType</span>&nbsp;<span class="op" id="4138721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138726">crlBytes</span>&nbsp;<span class="op" id="4138735">=</span>&nbsp;<span class="ident" id="4138737">block</span><span class="op" id="4138742">.</span><span class="ident" id="4138743">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138757">return</span>&nbsp;<span class="ident" id="4138764">ParseDERCRL</span><span class="op" id="4138775">(</span><span class="ident" id="4138776">crlBytes</span><span class="op" id="4138784">)</span><br>
<span class="lineno"></span><span class="op" id="4138786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4138789">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4138851">func</span>&nbsp;<span class="ident" id="4138856">ParseDERCRL</span><span class="op" id="4138867">(</span><span class="ident" id="4138868">derBytes</span>&nbsp;<span class="op" id="4138877">[</span><span class="op" id="4138878">]</span><span class="builtintype" id="4138879">byte</span><span class="op" id="4138883">)</span>&nbsp;<span class="op" id="4138885">(</span><span class="ident" id="4138886">certList</span>&nbsp;<span class="op" id="4138895">*</span><span class="ident" id="4138896">pkix</span><span class="op" id="4138900">.</span><span class="ident" id="4138901">CertificateList</span><span class="op" id="4138916">,</span>&nbsp;<span class="ident" id="4138918">err</span>&nbsp;<span class="builtintype" id="4138922">error</span><span class="op" id="4138927">)</span>&nbsp;<span class="op" id="4138929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138932">certList</span>&nbsp;<span class="op" id="4138941">=</span>&nbsp;<span class="builtinfunc" id="4138943">new</span><span class="op" id="4138946">(</span><span class="ident" id="4138947">pkix</span><span class="op" id="4138951">.</span><span class="ident" id="4138952">CertificateList</span><span class="op" id="4138967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138970">_</span><span class="op" id="4138971">,</span>&nbsp;<span class="ident" id="4138973">err</span>&nbsp;<span class="op" id="4138977">=</span>&nbsp;<span class="ident" id="4138979">asn1</span><span class="op" id="4138983">.</span><span class="ident" id="4138984">Unmarshal</span><span class="op" id="4138993">(</span><span class="ident" id="4138994">derBytes</span><span class="op" id="4139002">,</span>&nbsp;<span class="ident" id="4139004">certList</span><span class="op" id="4139012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139015">if</span>&nbsp;<span class="ident" id="4139018">err</span>&nbsp;<span class="op" id="4139022">!=</span>&nbsp;<span class="ident" id="4139025">nil</span>&nbsp;<span class="op" id="4139029">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139033">certList</span>&nbsp;<span class="op" id="4139042">=</span>&nbsp;<span class="ident" id="4139044">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139052">return</span><br>
<span class="lineno"></span><span class="op" id="4139059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4139062">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4139135">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4139187">//</span><br>
<span class="lineno"></span><span class="comment" id="4139190">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4139256">func</span>&nbsp;<span class="op" id="4139261">(</span><span class="ident" id="4139262">c</span>&nbsp;<span class="op" id="4139264">*</span><span class="ident" id="4139265">Certificate</span><span class="op" id="4139276">)</span>&nbsp;<span class="ident" id="4139278">CreateCRL</span><span class="op" id="4139287">(</span><span class="ident" id="4139288">rand</span>&nbsp;<span class="ident" id="4139293">io</span><span class="op" id="4139295">.</span><span class="ident" id="4139296">Reader</span><span class="op" id="4139302">,</span>&nbsp;<span class="ident" id="4139304">priv</span>&nbsp;<span class="keyword" id="4139309">interface</span><span class="op" id="4139318">{</span><span class="op" id="4139319">}</span><span class="op" id="4139320">,</span>&nbsp;<span class="ident" id="4139322">revokedCerts</span>&nbsp;<span class="op" id="4139335">[</span><span class="op" id="4139336">]</span><span class="ident" id="4139337">pkix</span><span class="op" id="4139341">.</span><span class="ident" id="4139342">RevokedCertificate</span><span class="op" id="4139360">,</span>&nbsp;<span class="ident" id="4139362">now</span><span class="op" id="4139365">,</span>&nbsp;<span class="ident" id="4139367">expiry</span>&nbsp;<span class="ident" id="4139374">time</span><span class="op" id="4139378">.</span><span class="ident" id="4139379">Time</span><span class="op" id="4139383">)</span>&nbsp;<span class="op" id="4139385">(</span><span class="ident" id="4139386">crlBytes</span>&nbsp;<span class="op" id="4139395">[</span><span class="op" id="4139396">]</span><span class="builtintype" id="4139397">byte</span><span class="op" id="4139401">,</span>&nbsp;<span class="ident" id="4139403">err</span>&nbsp;<span class="builtintype" id="4139407">error</span><span class="op" id="4139412">)</span>&nbsp;<span class="op" id="4139414">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139417">rsaPriv</span><span class="op" id="4139424">,</span>&nbsp;<span class="ident" id="4139426">ok</span>&nbsp;<span class="op" id="4139429">:=</span>&nbsp;<span class="ident" id="4139432">priv</span><span class="op" id="4139436">.</span><span class="op" id="4139437">(</span><span class="op" id="4139438">*</span><span class="ident" id="4139439">rsa</span><span class="op" id="4139442">.</span><span class="ident" id="4139443">PrivateKey</span><span class="op" id="4139453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139456">if</span>&nbsp;<span class="op" id="4139459">!</span><span class="ident" id="4139460">ok</span>&nbsp;<span class="op" id="4139463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139467">return</span>&nbsp;<span class="ident" id="4139474">nil</span><span class="op" id="4139477">,</span>&nbsp;<span class="ident" id="4139479">errors</span><span class="op" id="4139485">.</span><span class="ident" id="4139486">New</span><span class="op" id="4139489">(</span><span class="string" id="4139490">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4139532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139538">tbsCertList</span>&nbsp;<span class="op" id="4139550">:=</span>&nbsp;<span class="ident" id="4139553">pkix</span><span class="op" id="4139557">.</span><span class="ident" id="4139558">TBSCertificateList</span><span class="op" id="4139576">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139580">Version</span><span class="op" id="4139587">:</span>&nbsp;<span class="num" id="4139589">2</span><span class="op" id="4139590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139594">Signature</span><span class="op" id="4139603">:</span>&nbsp;<span class="ident" id="4139605">pkix</span><span class="op" id="4139609">.</span><span class="ident" id="4139610">AlgorithmIdentifier</span><span class="op" id="4139629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139634">Algorithm</span><span class="op" id="4139643">:</span>&nbsp;<span class="ident" id="4139645">oidSignatureSHA1WithRSA</span><span class="op" id="4139668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139672">}</span><span class="op" id="4139673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139677">Issuer</span><span class="op" id="4139683">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4139698">c</span><span class="op" id="4139699">.</span><span class="ident" id="4139700">Subject</span><span class="op" id="4139707">.</span><span class="ident" id="4139708">ToRDNSequence</span><span class="op" id="4139721">(</span><span class="op" id="4139722">)</span><span class="op" id="4139723">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139727">ThisUpdate</span><span class="op" id="4139737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4139748">now</span><span class="op" id="4139751">.</span><span class="ident" id="4139752">UTC</span><span class="op" id="4139755">(</span><span class="op" id="4139756">)</span><span class="op" id="4139757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139761">NextUpdate</span><span class="op" id="4139771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4139782">expiry</span><span class="op" id="4139788">.</span><span class="ident" id="4139789">UTC</span><span class="op" id="4139792">(</span><span class="op" id="4139793">)</span><span class="op" id="4139794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139798">RevokedCertificates</span><span class="op" id="4139817">:</span>&nbsp;<span class="ident" id="4139819">revokedCerts</span><span class="op" id="4139831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139838">tbsCertListContents</span><span class="op" id="4139857">,</span>&nbsp;<span class="ident" id="4139859">err</span>&nbsp;<span class="op" id="4139863">:=</span>&nbsp;<span class="ident" id="4139866">asn1</span><span class="op" id="4139870">.</span><span class="ident" id="4139871">Marshal</span><span class="op" id="4139878">(</span><span class="ident" id="4139879">tbsCertList</span><span class="op" id="4139890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139893">if</span>&nbsp;<span class="ident" id="4139896">err</span>&nbsp;<span class="op" id="4139900">!=</span>&nbsp;<span class="ident" id="4139903">nil</span>&nbsp;<span class="op" id="4139907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139911">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139923">h</span>&nbsp;<span class="op" id="4139925">:=</span>&nbsp;<span class="ident" id="4139928">sha1</span><span class="op" id="4139932">.</span><span class="ident" id="4139933">New</span><span class="op" id="4139936">(</span><span class="op" id="4139937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139940">h</span><span class="op" id="4139941">.</span><span class="ident" id="4139942">Write</span><span class="op" id="4139947">(</span><span class="ident" id="4139948">tbsCertListContents</span><span class="op" id="4139967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139970">digest</span>&nbsp;<span class="op" id="4139977">:=</span>&nbsp;<span class="ident" id="4139980">h</span><span class="op" id="4139981">.</span><span class="ident" id="4139982">Sum</span><span class="op" id="4139985">(</span><span class="ident" id="4139986">nil</span><span class="op" id="4139989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139993">signature</span><span class="op" id="4140002">,</span>&nbsp;<span class="ident" id="4140004">err</span>&nbsp;<span class="op" id="4140008">:=</span>&nbsp;<span class="ident" id="4140011">rsa</span><span class="op" id="4140014">.</span><span class="ident" id="4140015">SignPKCS1v15</span><span class="op" id="4140027">(</span><span class="ident" id="4140028">rand</span><span class="op" id="4140032">,</span>&nbsp;<span class="ident" id="4140034">rsaPriv</span><span class="op" id="4140041">,</span>&nbsp;<span class="ident" id="4140043">crypto</span><span class="op" id="4140049">.</span><span class="ident" id="4140050">SHA1</span><span class="op" id="4140054">,</span>&nbsp;<span class="ident" id="4140056">digest</span><span class="op" id="4140062">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140065">if</span>&nbsp;<span class="ident" id="4140068">err</span>&nbsp;<span class="op" id="4140072">!=</span>&nbsp;<span class="ident" id="4140075">nil</span>&nbsp;<span class="op" id="4140079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140083">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140095">return</span>&nbsp;<span class="ident" id="4140102">asn1</span><span class="op" id="4140106">.</span><span class="ident" id="4140107">Marshal</span><span class="op" id="4140114">(</span><span class="ident" id="4140115">pkix</span><span class="op" id="4140119">.</span><span class="ident" id="4140120">CertificateList</span><span class="op" id="4140135">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140139">TBSCertList</span><span class="op" id="4140150">:</span>&nbsp;<span class="ident" id="4140152">tbsCertList</span><span class="op" id="4140163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140167">SignatureAlgorithm</span><span class="op" id="4140185">:</span>&nbsp;<span class="ident" id="4140187">pkix</span><span class="op" id="4140191">.</span><span class="ident" id="4140192">AlgorithmIdentifier</span><span class="op" id="4140211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140216">Algorithm</span><span class="op" id="4140225">:</span>&nbsp;<span class="ident" id="4140227">oidSignatureSHA1WithRSA</span><span class="op" id="4140250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140254">}</span><span class="op" id="4140255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140259">SignatureValue</span><span class="op" id="4140273">:</span>&nbsp;<span class="ident" id="4140275">asn1</span><span class="op" id="4140279">.</span><span class="ident" id="4140280">BitString</span><span class="op" id="4140289">{</span><span class="ident" id="4140290">Bytes</span><span class="op" id="4140295">:</span>&nbsp;<span class="ident" id="4140297">signature</span><span class="op" id="4140306">,</span>&nbsp;<span class="ident" id="4140308">BitLength</span><span class="op" id="4140317">:</span>&nbsp;<span class="builtinfunc" id="4140319">len</span><span class="op" id="4140322">(</span><span class="ident" id="4140323">signature</span><span class="op" id="4140332">)</span>&nbsp;<span class="op" id="4140334">*</span>&nbsp;<span class="num" id="4140336">8</span><span class="op" id="4140337">}</span><span class="op" id="4140338">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140341">}</span><span class="op" id="4140342">)</span><br>
<span class="lineno"></span><span class="op" id="4140344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4140347">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4140423">type</span>&nbsp;<span class="ident" id="4140428">CertificateRequest</span>&nbsp;<span class="keyword" id="4140447">struct</span>&nbsp;<span class="op" id="4140454">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140457">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140482">[</span><span class="op" id="4140483">]</span><span class="builtintype" id="4140484">byte</span>&nbsp;<span class="comment" id="4140489">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140562">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4140587">[</span><span class="op" id="4140588">]</span><span class="builtintype" id="4140589">byte</span>&nbsp;<span class="comment" id="4140594">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140654">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4140679">[</span><span class="op" id="4140680">]</span><span class="builtintype" id="4140681">byte</span>&nbsp;<span class="comment" id="4140686">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140724">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140749">[</span><span class="op" id="4140750">]</span><span class="builtintype" id="4140751">byte</span>&nbsp;<span class="comment" id="4140756">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140782">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4140801">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140806">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140825">[</span><span class="op" id="4140826">]</span><span class="builtintype" id="4140827">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140833">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4140852">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140873">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4140892">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140912">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4140931">interface</span><span class="op" id="4140940">{</span><span class="op" id="4140941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140945">Subject</span>&nbsp;<span class="ident" id="4140953">pkix</span><span class="op" id="4140957">.</span><span class="ident" id="4140958">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140965">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141020">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141085">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141115">Attributes</span>&nbsp;<span class="op" id="4141126">[</span><span class="op" id="4141127">]</span><span class="ident" id="4141128">pkix</span><span class="op" id="4141132">.</span><span class="ident" id="4141133">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141160">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141230">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141296">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141309">Extensions</span>&nbsp;<span class="op" id="4141320">[</span><span class="op" id="4141321">]</span><span class="ident" id="4141322">pkix</span><span class="op" id="4141326">.</span><span class="ident" id="4141327">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141339">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141407">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141478">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141546">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141586">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141590">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141660">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141676">ExtraExtensions</span>&nbsp;<span class="op" id="4141692">[</span><span class="op" id="4141693">]</span><span class="ident" id="4141694">pkix</span><span class="op" id="4141698">.</span><span class="ident" id="4141699">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141711">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141746">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4141761">[</span><span class="op" id="4141762">]</span><span class="builtintype" id="4141763">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141771">EmailAddresses</span>&nbsp;<span class="op" id="4141786">[</span><span class="op" id="4141787">]</span><span class="builtintype" id="4141788">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141796">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4141811">[</span><span class="op" id="4141812">]</span><span class="ident" id="4141813">net</span><span class="op" id="4141816">.</span><span class="ident" id="4141817">IP</span><br>
<span class="lineno"></span><span class="op" id="4141820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141823">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4141892">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4141931">type</span>&nbsp;<span class="ident" id="4141936">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4141958">struct</span>&nbsp;<span class="op" id="4141965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141968">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4141979">asn1</span><span class="op" id="4141983">.</span><span class="ident" id="4141984">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141996">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4142007">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142012">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4142023">asn1</span><span class="op" id="4142027">.</span><span class="ident" id="4142028">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142038">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4142049">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142064">Attributes</span>&nbsp;<span class="op" id="4142075">[</span><span class="op" id="4142076">]</span><span class="ident" id="4142077">pkix</span><span class="op" id="4142081">.</span><span class="ident" id="4142082">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4142107">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4142122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4142125">type</span>&nbsp;<span class="ident" id="4142130">certificateRequest</span>&nbsp;<span class="keyword" id="4142149">struct</span>&nbsp;<span class="op" id="4142156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142159">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4142178">asn1</span><span class="op" id="4142182">.</span><span class="ident" id="4142183">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142195">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4142214">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142237">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4142256">pkix</span><span class="op" id="4142260">.</span><span class="ident" id="4142261">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142282">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4142301">asn1</span><span class="op" id="4142305">.</span><span class="ident" id="4142306">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4142316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4142319">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4142397">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4142421">var</span>&nbsp;<span class="ident" id="4142425">oidExtensionRequest</span>&nbsp;<span class="op" id="4142445">=</span>&nbsp;<span class="ident" id="4142447">asn1</span><span class="op" id="4142451">.</span><span class="ident" id="4142452">ObjectIdentifier</span><span class="op" id="4142468">{</span><span class="num" id="4142469">1</span><span class="op" id="4142470">,</span>&nbsp;<span class="num" id="4142472">2</span><span class="op" id="4142473">,</span>&nbsp;<span class="num" id="4142475">840</span><span class="op" id="4142478">,</span>&nbsp;<span class="num" id="4142480">113549</span><span class="op" id="4142486">,</span>&nbsp;<span class="num" id="4142488">1</span><span class="op" id="4142489">,</span>&nbsp;<span class="num" id="4142491">9</span><span class="op" id="4142492">,</span>&nbsp;<span class="num" id="4142494">14</span><span class="op" id="4142496">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4142499">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4142578">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4142642">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4142720">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4142773">//</span><br>
<span class="lineno"></span><span class="comment" id="4142776">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4142842">//</span><br>
<span class="lineno"></span><span class="comment" id="4142845">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4142913">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4142937">func</span>&nbsp;<span class="ident" id="4142942">CreateCertificateRequest</span><span class="op" id="4142966">(</span><span class="ident" id="4142967">rand</span>&nbsp;<span class="ident" id="4142972">io</span><span class="op" id="4142974">.</span><span class="ident" id="4142975">Reader</span><span class="op" id="4142981">,</span>&nbsp;<span class="ident" id="4142983">template</span>&nbsp;<span class="op" id="4142992">*</span><span class="ident" id="4142993">CertificateRequest</span><span class="op" id="4143011">,</span>&nbsp;<span class="ident" id="4143013">priv</span>&nbsp;<span class="keyword" id="4143018">interface</span><span class="op" id="4143027">{</span><span class="op" id="4143028">}</span><span class="op" id="4143029">)</span>&nbsp;<span class="op" id="4143031">(</span><span class="ident" id="4143032">csr</span>&nbsp;<span class="op" id="4143036">[</span><span class="op" id="4143037">]</span><span class="builtintype" id="4143038">byte</span><span class="op" id="4143042">,</span>&nbsp;<span class="ident" id="4143044">err</span>&nbsp;<span class="builtintype" id="4143048">error</span><span class="op" id="4143053">)</span>&nbsp;<span class="op" id="4143055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143058">hashFunc</span><span class="op" id="4143066">,</span>&nbsp;<span class="ident" id="4143068">sigAlgo</span><span class="op" id="4143075">,</span>&nbsp;<span class="ident" id="4143077">err</span>&nbsp;<span class="op" id="4143081">:=</span>&nbsp;<span class="ident" id="4143084">signingParamsForPrivateKey</span><span class="op" id="4143110">(</span><span class="ident" id="4143111">priv</span><span class="op" id="4143115">,</span>&nbsp;<span class="ident" id="4143117">template</span><span class="op" id="4143125">.</span><span class="ident" id="4143126">SignatureAlgorithm</span><span class="op" id="4143144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143147">if</span>&nbsp;<span class="ident" id="4143150">err</span>&nbsp;<span class="op" id="4143154">!=</span>&nbsp;<span class="ident" id="4143157">nil</span>&nbsp;<span class="op" id="4143161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143165">return</span>&nbsp;<span class="ident" id="4143172">nil</span><span class="op" id="4143175">,</span>&nbsp;<span class="ident" id="4143177">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143182">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143186">var</span>&nbsp;<span class="ident" id="4143190">publicKeyBytes</span>&nbsp;<span class="op" id="4143205">[</span><span class="op" id="4143206">]</span><span class="builtintype" id="4143207">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143213">var</span>&nbsp;<span class="ident" id="4143217">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4143236">pkix</span><span class="op" id="4143240">.</span><span class="ident" id="4143241">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143263">switch</span>&nbsp;<span class="ident" id="4143270">priv</span>&nbsp;<span class="op" id="4143275">:=</span>&nbsp;<span class="ident" id="4143278">priv</span><span class="op" id="4143282">.</span><span class="op" id="4143283">(</span><span class="keyword" id="4143284">type</span><span class="op" id="4143288">)</span>&nbsp;<span class="op" id="4143290">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143293">case</span>&nbsp;<span class="op" id="4143298">*</span><span class="ident" id="4143299">rsa</span><span class="op" id="4143302">.</span><span class="ident" id="4143303">PrivateKey</span><span class="op" id="4143313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143317">publicKeyBytes</span><span class="op" id="4143331">,</span>&nbsp;<span class="ident" id="4143333">publicKeyAlgorithm</span><span class="op" id="4143351">,</span>&nbsp;<span class="ident" id="4143353">err</span>&nbsp;<span class="op" id="4143357">=</span>&nbsp;<span class="ident" id="4143359">marshalPublicKey</span><span class="op" id="4143375">(</span><span class="op" id="4143376">&amp;</span><span class="ident" id="4143377">priv</span><span class="op" id="4143381">.</span><span class="ident" id="4143382">PublicKey</span><span class="op" id="4143391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143394">case</span>&nbsp;<span class="op" id="4143399">*</span><span class="ident" id="4143400">ecdsa</span><span class="op" id="4143405">.</span><span class="ident" id="4143406">PrivateKey</span><span class="op" id="4143416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143420">publicKeyBytes</span><span class="op" id="4143434">,</span>&nbsp;<span class="ident" id="4143436">publicKeyAlgorithm</span><span class="op" id="4143454">,</span>&nbsp;<span class="ident" id="4143456">err</span>&nbsp;<span class="op" id="4143460">=</span>&nbsp;<span class="ident" id="4143462">marshalPublicKey</span><span class="op" id="4143478">(</span><span class="op" id="4143479">&amp;</span><span class="ident" id="4143480">priv</span><span class="op" id="4143484">.</span><span class="ident" id="4143485">PublicKey</span><span class="op" id="4143494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143497">default</span><span class="op" id="4143504">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4143508">panic</span><span class="op" id="4143513">(</span><span class="string" id="4143514">&#34;internal&nbsp;error&#34;</span><span class="op" id="4143530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143537">if</span>&nbsp;<span class="ident" id="4143540">err</span>&nbsp;<span class="op" id="4143544">!=</span>&nbsp;<span class="ident" id="4143547">nil</span>&nbsp;<span class="op" id="4143551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143555">return</span>&nbsp;<span class="ident" id="4143562">nil</span><span class="op" id="4143565">,</span>&nbsp;<span class="ident" id="4143567">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143576">var</span>&nbsp;<span class="ident" id="4143580">extensions</span>&nbsp;<span class="op" id="4143591">[</span><span class="op" id="4143592">]</span><span class="ident" id="4143593">pkix</span><span class="op" id="4143597">.</span><span class="ident" id="4143598">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143610">if</span>&nbsp;<span class="op" id="4143613">(</span><span class="builtinfunc" id="4143614">len</span><span class="op" id="4143617">(</span><span class="ident" id="4143618">template</span><span class="op" id="4143626">.</span><span class="ident" id="4143627">DNSNames</span><span class="op" id="4143635">)</span>&nbsp;<span class="op" id="4143637">&gt;</span>&nbsp;<span class="num" id="4143639">0</span>&nbsp;<span class="op" id="4143641">||</span>&nbsp;<span class="builtinfunc" id="4143644">len</span><span class="op" id="4143647">(</span><span class="ident" id="4143648">template</span><span class="op" id="4143656">.</span><span class="ident" id="4143657">EmailAddresses</span><span class="op" id="4143671">)</span>&nbsp;<span class="op" id="4143673">&gt;</span>&nbsp;<span class="num" id="4143675">0</span>&nbsp;<span class="op" id="4143677">||</span>&nbsp;<span class="builtinfunc" id="4143680">len</span><span class="op" id="4143683">(</span><span class="ident" id="4143684">template</span><span class="op" id="4143692">.</span><span class="ident" id="4143693">IPAddresses</span><span class="op" id="4143704">)</span>&nbsp;<span class="op" id="4143706">&gt;</span>&nbsp;<span class="num" id="4143708">0</span><span class="op" id="4143709">)</span>&nbsp;<span class="op" id="4143711">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143716">!</span><span class="ident" id="4143717">oidInExtensions</span><span class="op" id="4143732">(</span><span class="ident" id="4143733">oidExtensionSubjectAltName</span><span class="op" id="4143759">,</span>&nbsp;<span class="ident" id="4143761">template</span><span class="op" id="4143769">.</span><span class="ident" id="4143770">ExtraExtensions</span><span class="op" id="4143785">)</span>&nbsp;<span class="op" id="4143787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143791">sanBytes</span><span class="op" id="4143799">,</span>&nbsp;<span class="ident" id="4143801">err</span>&nbsp;<span class="op" id="4143805">:=</span>&nbsp;<span class="ident" id="4143808">marshalSANs</span><span class="op" id="4143819">(</span><span class="ident" id="4143820">template</span><span class="op" id="4143828">.</span><span class="ident" id="4143829">DNSNames</span><span class="op" id="4143837">,</span>&nbsp;<span class="ident" id="4143839">template</span><span class="op" id="4143847">.</span><span class="ident" id="4143848">EmailAddresses</span><span class="op" id="4143862">,</span>&nbsp;<span class="ident" id="4143864">template</span><span class="op" id="4143872">.</span><span class="ident" id="4143873">IPAddresses</span><span class="op" id="4143884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143888">if</span>&nbsp;<span class="ident" id="4143891">err</span>&nbsp;<span class="op" id="4143895">!=</span>&nbsp;<span class="ident" id="4143898">nil</span>&nbsp;<span class="op" id="4143902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143907">return</span>&nbsp;<span class="ident" id="4143914">nil</span><span class="op" id="4143917">,</span>&nbsp;<span class="ident" id="4143919">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143925">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143930">extensions</span>&nbsp;<span class="op" id="4143941">=</span>&nbsp;<span class="builtinfunc" id="4143943">append</span><span class="op" id="4143949">(</span><span class="ident" id="4143950">extensions</span><span class="op" id="4143960">,</span>&nbsp;<span class="ident" id="4143962">pkix</span><span class="op" id="4143966">.</span><span class="ident" id="4143967">Extension</span><span class="op" id="4143976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143981">Id</span><span class="op" id="4143983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4143988">oidExtensionSubjectAltName</span><span class="op" id="4144014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144019">Value</span><span class="op" id="4144024">:</span>&nbsp;<span class="ident" id="4144026">sanBytes</span><span class="op" id="4144034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144038">}</span><span class="op" id="4144039">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144046">extensions</span>&nbsp;<span class="op" id="4144057">=</span>&nbsp;<span class="builtinfunc" id="4144059">append</span><span class="op" id="4144065">(</span><span class="ident" id="4144066">extensions</span><span class="op" id="4144076">,</span>&nbsp;<span class="ident" id="4144078">template</span><span class="op" id="4144086">.</span><span class="ident" id="4144087">ExtraExtensions</span><span class="op" id="4144102">...</span><span class="op" id="4144105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144109">var</span>&nbsp;<span class="ident" id="4144113">attributes</span>&nbsp;<span class="op" id="4144124">[</span><span class="op" id="4144125">]</span><span class="ident" id="4144126">pkix</span><span class="op" id="4144130">.</span><span class="ident" id="4144131">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144157">attributes</span>&nbsp;<span class="op" id="4144168">=</span>&nbsp;<span class="builtinfunc" id="4144170">append</span><span class="op" id="4144176">(</span><span class="ident" id="4144177">attributes</span><span class="op" id="4144187">,</span>&nbsp;<span class="ident" id="4144189">template</span><span class="op" id="4144197">.</span><span class="ident" id="4144198">Attributes</span><span class="op" id="4144208">...</span><span class="op" id="4144211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144215">if</span>&nbsp;<span class="builtinfunc" id="4144218">len</span><span class="op" id="4144221">(</span><span class="ident" id="4144222">extensions</span><span class="op" id="4144232">)</span>&nbsp;<span class="op" id="4144234">&gt;</span>&nbsp;<span class="num" id="4144236">0</span>&nbsp;<span class="op" id="4144238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144242">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144303">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144349">specifiedExtensions</span>&nbsp;<span class="op" id="4144369">:=</span>&nbsp;<span class="builtinfunc" id="4144372">make</span><span class="op" id="4144376">(</span><span class="keyword" id="4144377">map</span><span class="op" id="4144380">[</span><span class="builtintype" id="4144381">string</span><span class="op" id="4144387">]</span><span class="builtintype" id="4144388">bool</span><span class="op" id="4144392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144397">for</span>&nbsp;<span class="ident" id="4144401">_</span><span class="op" id="4144402">,</span>&nbsp;<span class="ident" id="4144404">atvSet</span>&nbsp;<span class="op" id="4144411">:=</span>&nbsp;<span class="keyword" id="4144414">range</span>&nbsp;<span class="ident" id="4144420">template</span><span class="op" id="4144428">.</span><span class="ident" id="4144429">Attributes</span>&nbsp;<span class="op" id="4144440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144445">if</span>&nbsp;<span class="op" id="4144448">!</span><span class="ident" id="4144449">atvSet</span><span class="op" id="4144455">.</span><span class="ident" id="4144456">Type</span><span class="op" id="4144460">.</span><span class="ident" id="4144461">Equal</span><span class="op" id="4144466">(</span><span class="ident" id="4144467">oidExtensionRequest</span><span class="op" id="4144486">)</span>&nbsp;<span class="op" id="4144488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144494">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144512">for</span>&nbsp;<span class="ident" id="4144516">_</span><span class="op" id="4144517">,</span>&nbsp;<span class="ident" id="4144519">atvs</span>&nbsp;<span class="op" id="4144524">:=</span>&nbsp;<span class="keyword" id="4144527">range</span>&nbsp;<span class="ident" id="4144533">atvSet</span><span class="op" id="4144539">.</span><span class="ident" id="4144540">Value</span>&nbsp;<span class="op" id="4144546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144552">for</span>&nbsp;<span class="ident" id="4144556">_</span><span class="op" id="4144557">,</span>&nbsp;<span class="ident" id="4144559">atv</span>&nbsp;<span class="op" id="4144563">:=</span>&nbsp;<span class="keyword" id="4144566">range</span>&nbsp;<span class="ident" id="4144572">atvs</span>&nbsp;<span class="op" id="4144577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144584">specifiedExtensions</span><span class="op" id="4144603">[</span><span class="ident" id="4144604">atv</span><span class="op" id="4144607">.</span><span class="ident" id="4144608">Type</span><span class="op" id="4144612">.</span><span class="ident" id="4144613">String</span><span class="op" id="4144619">(</span><span class="op" id="4144620">)</span><span class="op" id="4144621">]</span>&nbsp;<span class="op" id="4144623">=</span>&nbsp;<span class="ident" id="4144625">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144648">atvs</span>&nbsp;<span class="op" id="4144653">:=</span>&nbsp;<span class="builtinfunc" id="4144656">make</span><span class="op" id="4144660">(</span><span class="op" id="4144661">[</span><span class="op" id="4144662">]</span><span class="ident" id="4144663">pkix</span><span class="op" id="4144667">.</span><span class="ident" id="4144668">AttributeTypeAndValue</span><span class="op" id="4144689">,</span>&nbsp;<span class="num" id="4144691">0</span><span class="op" id="4144692">,</span>&nbsp;<span class="builtinfunc" id="4144694">len</span><span class="op" id="4144697">(</span><span class="ident" id="4144698">extensions</span><span class="op" id="4144708">)</span><span class="op" id="4144709">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144713">for</span>&nbsp;<span class="ident" id="4144717">_</span><span class="op" id="4144718">,</span>&nbsp;<span class="ident" id="4144720">e</span>&nbsp;<span class="op" id="4144722">:=</span>&nbsp;<span class="keyword" id="4144725">range</span>&nbsp;<span class="ident" id="4144731">extensions</span>&nbsp;<span class="op" id="4144742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144747">if</span>&nbsp;<span class="ident" id="4144750">specifiedExtensions</span><span class="op" id="4144769">[</span><span class="ident" id="4144770">e</span><span class="op" id="4144771">.</span><span class="ident" id="4144772">Id</span><span class="op" id="4144774">.</span><span class="ident" id="4144775">String</span><span class="op" id="4144781">(</span><span class="op" id="4144782">)</span><span class="op" id="4144783">]</span>&nbsp;<span class="op" id="4144785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144791">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144839">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144884">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144902">atvs</span>&nbsp;<span class="op" id="4144907">=</span>&nbsp;<span class="builtinfunc" id="4144909">append</span><span class="op" id="4144915">(</span><span class="ident" id="4144916">atvs</span><span class="op" id="4144920">,</span>&nbsp;<span class="ident" id="4144922">pkix</span><span class="op" id="4144926">.</span><span class="ident" id="4144927">AttributeTypeAndValue</span><span class="op" id="4144948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144954">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145011">Type</span><span class="op" id="4145015">:</span>&nbsp;&nbsp;<span class="ident" id="4145018">e</span><span class="op" id="4145019">.</span><span class="ident" id="4145020">Id</span><span class="op" id="4145022">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145028">Value</span><span class="op" id="4145033">:</span>&nbsp;<span class="ident" id="4145035">e</span><span class="op" id="4145036">.</span><span class="ident" id="4145037">Value</span><span class="op" id="4145042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145047">}</span><span class="op" id="4145048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145057">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145122">appended</span>&nbsp;<span class="op" id="4145131">:=</span>&nbsp;<span class="ident" id="4145134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145142">for</span>&nbsp;<span class="ident" id="4145146">_</span><span class="op" id="4145147">,</span>&nbsp;<span class="ident" id="4145149">atvSet</span>&nbsp;<span class="op" id="4145156">:=</span>&nbsp;<span class="keyword" id="4145159">range</span>&nbsp;<span class="ident" id="4145165">attributes</span>&nbsp;<span class="op" id="4145176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145181">if</span>&nbsp;<span class="op" id="4145184">!</span><span class="ident" id="4145185">atvSet</span><span class="op" id="4145191">.</span><span class="ident" id="4145192">Type</span><span class="op" id="4145196">.</span><span class="ident" id="4145197">Equal</span><span class="op" id="4145202">(</span><span class="ident" id="4145203">oidExtensionRequest</span><span class="op" id="4145222">)</span>&nbsp;<span class="op" id="4145224">||</span>&nbsp;<span class="builtinfunc" id="4145227">len</span><span class="op" id="4145230">(</span><span class="ident" id="4145231">atvSet</span><span class="op" id="4145237">.</span><span class="ident" id="4145238">Value</span><span class="op" id="4145243">)</span>&nbsp;<span class="op" id="4145245">==</span>&nbsp;<span class="num" id="4145248">0</span>&nbsp;<span class="op" id="4145250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145256">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145268">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145274">atvSet</span><span class="op" id="4145280">.</span><span class="ident" id="4145281">Value</span><span class="op" id="4145286">[</span><span class="num" id="4145287">0</span><span class="op" id="4145288">]</span>&nbsp;<span class="op" id="4145290">=</span>&nbsp;<span class="builtinfunc" id="4145292">append</span><span class="op" id="4145298">(</span><span class="ident" id="4145299">atvSet</span><span class="op" id="4145305">.</span><span class="ident" id="4145306">Value</span><span class="op" id="4145311">[</span><span class="num" id="4145312">0</span><span class="op" id="4145313">]</span><span class="op" id="4145314">,</span>&nbsp;<span class="ident" id="4145316">atvs</span><span class="op" id="4145320">...</span><span class="op" id="4145323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145328">appended</span>&nbsp;<span class="op" id="4145337">=</span>&nbsp;<span class="ident" id="4145339">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145347">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145355">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145360">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145416">if</span>&nbsp;<span class="op" id="4145419">!</span><span class="ident" id="4145420">appended</span>&nbsp;<span class="op" id="4145429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145434">attributes</span>&nbsp;<span class="op" id="4145445">=</span>&nbsp;<span class="builtinfunc" id="4145447">append</span><span class="op" id="4145453">(</span><span class="ident" id="4145454">attributes</span><span class="op" id="4145464">,</span>&nbsp;<span class="ident" id="4145466">pkix</span><span class="op" id="4145470">.</span><span class="ident" id="4145471">AttributeTypeAndValueSET</span><span class="op" id="4145495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145501">Type</span><span class="op" id="4145505">:</span>&nbsp;<span class="ident" id="4145507">oidExtensionRequest</span><span class="op" id="4145526">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145532">Value</span><span class="op" id="4145537">:</span>&nbsp;<span class="op" id="4145539">[</span><span class="op" id="4145540">]</span><span class="op" id="4145541">[</span><span class="op" id="4145542">]</span><span class="ident" id="4145543">pkix</span><span class="op" id="4145547">.</span><span class="ident" id="4145548">AttributeTypeAndValue</span><span class="op" id="4145569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145576">atvs</span><span class="op" id="4145580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145586">}</span><span class="op" id="4145587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145592">}</span><span class="op" id="4145593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145597">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145604">asn1Subject</span>&nbsp;<span class="op" id="4145616">:=</span>&nbsp;<span class="ident" id="4145619">template</span><span class="op" id="4145627">.</span><span class="ident" id="4145628">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145640">if</span>&nbsp;<span class="builtinfunc" id="4145643">len</span><span class="op" id="4145646">(</span><span class="ident" id="4145647">asn1Subject</span><span class="op" id="4145658">)</span>&nbsp;<span class="op" id="4145660">==</span>&nbsp;<span class="num" id="4145663">0</span>&nbsp;<span class="op" id="4145665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145669">asn1Subject</span><span class="op" id="4145680">,</span>&nbsp;<span class="ident" id="4145682">err</span>&nbsp;<span class="op" id="4145686">=</span>&nbsp;<span class="ident" id="4145688">asn1</span><span class="op" id="4145692">.</span><span class="ident" id="4145693">Marshal</span><span class="op" id="4145700">(</span><span class="ident" id="4145701">template</span><span class="op" id="4145709">.</span><span class="ident" id="4145710">Subject</span><span class="op" id="4145717">.</span><span class="ident" id="4145718">ToRDNSequence</span><span class="op" id="4145731">(</span><span class="op" id="4145732">)</span><span class="op" id="4145733">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145737">if</span>&nbsp;<span class="ident" id="4145740">err</span>&nbsp;<span class="op" id="4145744">!=</span>&nbsp;<span class="ident" id="4145747">nil</span>&nbsp;<span class="op" id="4145751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145756">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145772">tbsCSR</span>&nbsp;<span class="op" id="4145779">:=</span>&nbsp;<span class="ident" id="4145782">tbsCertificateRequest</span><span class="op" id="4145803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145807">Version</span><span class="op" id="4145814">:</span>&nbsp;<span class="num" id="4145816">0</span><span class="op" id="4145817">,</span>&nbsp;<span class="comment" id="4145819">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145843">Subject</span><span class="op" id="4145850">:</span>&nbsp;<span class="ident" id="4145852">asn1</span><span class="op" id="4145856">.</span><span class="ident" id="4145857">RawValue</span><span class="op" id="4145865">{</span><span class="ident" id="4145866">FullBytes</span><span class="op" id="4145875">:</span>&nbsp;<span class="ident" id="4145877">asn1Subject</span><span class="op" id="4145888">}</span><span class="op" id="4145889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145893">PublicKey</span><span class="op" id="4145902">:</span>&nbsp;<span class="ident" id="4145904">publicKeyInfo</span><span class="op" id="4145917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145922">Algorithm</span><span class="op" id="4145931">:</span>&nbsp;<span class="ident" id="4145933">publicKeyAlgorithm</span><span class="op" id="4145951">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145956">PublicKey</span><span class="op" id="4145965">:</span>&nbsp;<span class="ident" id="4145967">asn1</span><span class="op" id="4145971">.</span><span class="ident" id="4145972">BitString</span><span class="op" id="4145981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145987">Bytes</span><span class="op" id="4145992">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4145998">publicKeyBytes</span><span class="op" id="4146012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146018">BitLength</span><span class="op" id="4146027">:</span>&nbsp;<span class="builtinfunc" id="4146029">len</span><span class="op" id="4146032">(</span><span class="ident" id="4146033">publicKeyBytes</span><span class="op" id="4146047">)</span>&nbsp;<span class="op" id="4146049">*</span>&nbsp;<span class="num" id="4146051">8</span><span class="op" id="4146052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146057">}</span><span class="op" id="4146058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146062">}</span><span class="op" id="4146063">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146067">Attributes</span><span class="op" id="4146077">:</span>&nbsp;<span class="ident" id="4146079">attributes</span><span class="op" id="4146089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146096">tbsCSRContents</span><span class="op" id="4146110">,</span>&nbsp;<span class="ident" id="4146112">err</span>&nbsp;<span class="op" id="4146116">:=</span>&nbsp;<span class="ident" id="4146119">asn1</span><span class="op" id="4146123">.</span><span class="ident" id="4146124">Marshal</span><span class="op" id="4146131">(</span><span class="ident" id="4146132">tbsCSR</span><span class="op" id="4146138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146141">if</span>&nbsp;<span class="ident" id="4146144">err</span>&nbsp;<span class="op" id="4146148">!=</span>&nbsp;<span class="ident" id="4146151">nil</span>&nbsp;<span class="op" id="4146155">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146159">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146170">tbsCSR</span><span class="op" id="4146176">.</span><span class="ident" id="4146177">Raw</span>&nbsp;<span class="op" id="4146181">=</span>&nbsp;<span class="ident" id="4146183">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146200">h</span>&nbsp;<span class="op" id="4146202">:=</span>&nbsp;<span class="ident" id="4146205">hashFunc</span><span class="op" id="4146213">.</span><span class="ident" id="4146214">New</span><span class="op" id="4146217">(</span><span class="op" id="4146218">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146221">h</span><span class="op" id="4146222">.</span><span class="ident" id="4146223">Write</span><span class="op" id="4146228">(</span><span class="ident" id="4146229">tbsCSRContents</span><span class="op" id="4146243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146246">digest</span>&nbsp;<span class="op" id="4146253">:=</span>&nbsp;<span class="ident" id="4146256">h</span><span class="op" id="4146257">.</span><span class="ident" id="4146258">Sum</span><span class="op" id="4146261">(</span><span class="ident" id="4146262">nil</span><span class="op" id="4146265">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146269">var</span>&nbsp;<span class="ident" id="4146273">signature</span>&nbsp;<span class="op" id="4146283">[</span><span class="op" id="4146284">]</span><span class="builtintype" id="4146285">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146291">switch</span>&nbsp;<span class="ident" id="4146298">priv</span>&nbsp;<span class="op" id="4146303">:=</span>&nbsp;<span class="ident" id="4146306">priv</span><span class="op" id="4146310">.</span><span class="op" id="4146311">(</span><span class="keyword" id="4146312">type</span><span class="op" id="4146316">)</span>&nbsp;<span class="op" id="4146318">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146321">case</span>&nbsp;<span class="op" id="4146326">*</span><span class="ident" id="4146327">rsa</span><span class="op" id="4146330">.</span><span class="ident" id="4146331">PrivateKey</span><span class="op" id="4146341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146345">signature</span><span class="op" id="4146354">,</span>&nbsp;<span class="ident" id="4146356">err</span>&nbsp;<span class="op" id="4146360">=</span>&nbsp;<span class="ident" id="4146362">rsa</span><span class="op" id="4146365">.</span><span class="ident" id="4146366">SignPKCS1v15</span><span class="op" id="4146378">(</span><span class="ident" id="4146379">rand</span><span class="op" id="4146383">,</span>&nbsp;<span class="ident" id="4146385">priv</span><span class="op" id="4146389">,</span>&nbsp;<span class="ident" id="4146391">hashFunc</span><span class="op" id="4146399">,</span>&nbsp;<span class="ident" id="4146401">digest</span><span class="op" id="4146407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146410">case</span>&nbsp;<span class="op" id="4146415">*</span><span class="ident" id="4146416">ecdsa</span><span class="op" id="4146421">.</span><span class="ident" id="4146422">PrivateKey</span><span class="op" id="4146432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146436">var</span>&nbsp;<span class="ident" id="4146440">r</span><span class="op" id="4146441">,</span>&nbsp;<span class="ident" id="4146443">s</span>&nbsp;<span class="op" id="4146445">*</span><span class="ident" id="4146446">big</span><span class="op" id="4146449">.</span><span class="ident" id="4146450">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146456">if</span>&nbsp;<span class="ident" id="4146459">r</span><span class="op" id="4146460">,</span>&nbsp;<span class="ident" id="4146462">s</span><span class="op" id="4146463">,</span>&nbsp;<span class="ident" id="4146465">err</span>&nbsp;<span class="op" id="4146469">=</span>&nbsp;<span class="ident" id="4146471">ecdsa</span><span class="op" id="4146476">.</span><span class="ident" id="4146477">Sign</span><span class="op" id="4146481">(</span><span class="ident" id="4146482">rand</span><span class="op" id="4146486">,</span>&nbsp;<span class="ident" id="4146488">priv</span><span class="op" id="4146492">,</span>&nbsp;<span class="ident" id="4146494">digest</span><span class="op" id="4146500">)</span><span class="op" id="4146501">;</span>&nbsp;<span class="ident" id="4146503">err</span>&nbsp;<span class="op" id="4146507">==</span>&nbsp;<span class="ident" id="4146510">nil</span>&nbsp;<span class="op" id="4146514">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146519">signature</span><span class="op" id="4146528">,</span>&nbsp;<span class="ident" id="4146530">err</span>&nbsp;<span class="op" id="4146534">=</span>&nbsp;<span class="ident" id="4146536">asn1</span><span class="op" id="4146540">.</span><span class="ident" id="4146541">Marshal</span><span class="op" id="4146548">(</span><span class="ident" id="4146549">ecdsaSignature</span><span class="op" id="4146563">{</span><span class="ident" id="4146564">r</span><span class="op" id="4146565">,</span>&nbsp;<span class="ident" id="4146567">s</span><span class="op" id="4146568">}</span><span class="op" id="4146569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146576">default</span><span class="op" id="4146583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4146587">panic</span><span class="op" id="4146592">(</span><span class="string" id="4146593">&#34;internal&nbsp;error&#34;</span><span class="op" id="4146609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146612">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146616">if</span>&nbsp;<span class="ident" id="4146619">err</span>&nbsp;<span class="op" id="4146623">!=</span>&nbsp;<span class="ident" id="4146626">nil</span>&nbsp;<span class="op" id="4146630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146634">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146646">return</span>&nbsp;<span class="ident" id="4146653">asn1</span><span class="op" id="4146657">.</span><span class="ident" id="4146658">Marshal</span><span class="op" id="4146665">(</span><span class="ident" id="4146666">certificateRequest</span><span class="op" id="4146684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146688">TBSCSR</span><span class="op" id="4146694">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4146708">tbsCSR</span><span class="op" id="4146714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146718">SignatureAlgorithm</span><span class="op" id="4146736">:</span>&nbsp;<span class="ident" id="4146738">sigAlgo</span><span class="op" id="4146745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146749">SignatureValue</span><span class="op" id="4146763">:</span>&nbsp;<span class="ident" id="4146765">asn1</span><span class="op" id="4146769">.</span><span class="ident" id="4146770">BitString</span><span class="op" id="4146779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146784">Bytes</span><span class="op" id="4146789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4146795">signature</span><span class="op" id="4146804">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146809">BitLength</span><span class="op" id="4146818">:</span>&nbsp;<span class="builtinfunc" id="4146820">len</span><span class="op" id="4146823">(</span><span class="ident" id="4146824">signature</span><span class="op" id="4146833">)</span>&nbsp;<span class="op" id="4146835">*</span>&nbsp;<span class="num" id="4146837">8</span><span class="op" id="4146838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146842">}</span><span class="op" id="4146843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146846">}</span><span class="op" id="4146847">)</span><br>
<span class="lineno"></span><span class="op" id="4146849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4146852">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4146924">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4146949">func</span>&nbsp;<span class="ident" id="4146954">ParseCertificateRequest</span><span class="op" id="4146977">(</span><span class="ident" id="4146978">asn1Data</span>&nbsp;<span class="op" id="4146987">[</span><span class="op" id="4146988">]</span><span class="builtintype" id="4146989">byte</span><span class="op" id="4146993">)</span>&nbsp;<span class="op" id="4146995">(</span><span class="op" id="4146996">*</span><span class="ident" id="4146997">CertificateRequest</span><span class="op" id="4147015">,</span>&nbsp;<span class="builtintype" id="4147017">error</span><span class="op" id="4147022">)</span>&nbsp;<span class="op" id="4147024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147027">var</span>&nbsp;<span class="ident" id="4147031">csr</span>&nbsp;<span class="ident" id="4147035">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147056">rest</span><span class="op" id="4147060">,</span>&nbsp;<span class="ident" id="4147062">err</span>&nbsp;<span class="op" id="4147066">:=</span>&nbsp;<span class="ident" id="4147069">asn1</span><span class="op" id="4147073">.</span><span class="ident" id="4147074">Unmarshal</span><span class="op" id="4147083">(</span><span class="ident" id="4147084">asn1Data</span><span class="op" id="4147092">,</span>&nbsp;<span class="op" id="4147094">&amp;</span><span class="ident" id="4147095">csr</span><span class="op" id="4147098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147101">if</span>&nbsp;<span class="ident" id="4147104">err</span>&nbsp;<span class="op" id="4147108">!=</span>&nbsp;<span class="ident" id="4147111">nil</span>&nbsp;<span class="op" id="4147115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147119">return</span>&nbsp;<span class="ident" id="4147126">nil</span><span class="op" id="4147129">,</span>&nbsp;<span class="ident" id="4147131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147136">}</span>&nbsp;<span class="keyword" id="4147138">else</span>&nbsp;<span class="keyword" id="4147143">if</span>&nbsp;<span class="builtinfunc" id="4147146">len</span><span class="op" id="4147149">(</span><span class="ident" id="4147150">rest</span><span class="op" id="4147154">)</span>&nbsp;<span class="op" id="4147156">!=</span>&nbsp;<span class="num" id="4147159">0</span>&nbsp;<span class="op" id="4147161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147165">return</span>&nbsp;<span class="ident" id="4147172">nil</span><span class="op" id="4147175">,</span>&nbsp;<span class="ident" id="4147177">asn1</span><span class="op" id="4147181">.</span><span class="ident" id="4147182">SyntaxError</span><span class="op" id="4147193">{</span><span class="ident" id="4147194">Msg</span><span class="op" id="4147197">:</span>&nbsp;<span class="string" id="4147199">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4147214">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147221">return</span>&nbsp;<span class="ident" id="4147228">parseCertificateRequest</span><span class="op" id="4147251">(</span><span class="op" id="4147252">&amp;</span><span class="ident" id="4147253">csr</span><span class="op" id="4147256">)</span><br>
<span class="lineno"></span><span class="op" id="4147258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4147261">func</span>&nbsp;<span class="ident" id="4147266">parseCertificateRequest</span><span class="op" id="4147289">(</span><span class="ident" id="4147290">in</span>&nbsp;<span class="op" id="4147293">*</span><span class="ident" id="4147294">certificateRequest</span><span class="op" id="4147312">)</span>&nbsp;<span class="op" id="4147314">(</span><span class="op" id="4147315">*</span><span class="ident" id="4147316">CertificateRequest</span><span class="op" id="4147334">,</span>&nbsp;<span class="builtintype" id="4147336">error</span><span class="op" id="4147341">)</span>&nbsp;<span class="op" id="4147343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147346">out</span>&nbsp;<span class="op" id="4147350">:=</span>&nbsp;<span class="op" id="4147353">&amp;</span><span class="ident" id="4147354">CertificateRequest</span><span class="op" id="4147372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147376">Raw</span><span class="op" id="4147379">:</span>&nbsp;<span class="ident" id="4147381">in</span><span class="op" id="4147383">.</span><span class="ident" id="4147384">Raw</span><span class="op" id="4147387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147391">RawTBSCertificateRequest</span><span class="op" id="4147415">:</span>&nbsp;<span class="ident" id="4147417">in</span><span class="op" id="4147419">.</span><span class="ident" id="4147420">TBSCSR</span><span class="op" id="4147426">.</span><span class="ident" id="4147427">Raw</span><span class="op" id="4147430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147434">RawSubjectPublicKeyInfo</span><span class="op" id="4147457">:</span>&nbsp;&nbsp;<span class="ident" id="4147460">in</span><span class="op" id="4147462">.</span><span class="ident" id="4147463">TBSCSR</span><span class="op" id="4147469">.</span><span class="ident" id="4147470">PublicKey</span><span class="op" id="4147479">.</span><span class="ident" id="4147480">Raw</span><span class="op" id="4147483">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147487">RawSubject</span><span class="op" id="4147497">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4147513">in</span><span class="op" id="4147515">.</span><span class="ident" id="4147516">TBSCSR</span><span class="op" id="4147522">.</span><span class="ident" id="4147523">Subject</span><span class="op" id="4147530">.</span><span class="ident" id="4147531">FullBytes</span><span class="op" id="4147540">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147545">Signature</span><span class="op" id="4147554">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4147565">in</span><span class="op" id="4147567">.</span><span class="ident" id="4147568">SignatureValue</span><span class="op" id="4147582">.</span><span class="ident" id="4147583">RightAlign</span><span class="op" id="4147593">(</span><span class="op" id="4147594">)</span><span class="op" id="4147595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147599">SignatureAlgorithm</span><span class="op" id="4147617">:</span>&nbsp;<span class="ident" id="4147619">getSignatureAlgorithmFromOID</span><span class="op" id="4147647">(</span><span class="ident" id="4147648">in</span><span class="op" id="4147650">.</span><span class="ident" id="4147651">SignatureAlgorithm</span><span class="op" id="4147669">.</span><span class="ident" id="4147670">Algorithm</span><span class="op" id="4147679">)</span><span class="op" id="4147680">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147685">PublicKeyAlgorithm</span><span class="op" id="4147703">:</span>&nbsp;<span class="ident" id="4147705">getPublicKeyAlgorithmFromOID</span><span class="op" id="4147733">(</span><span class="ident" id="4147734">in</span><span class="op" id="4147736">.</span><span class="ident" id="4147737">TBSCSR</span><span class="op" id="4147743">.</span><span class="ident" id="4147744">PublicKey</span><span class="op" id="4147753">.</span><span class="ident" id="4147754">Algorithm</span><span class="op" id="4147763">.</span><span class="ident" id="4147764">Algorithm</span><span class="op" id="4147773">)</span><span class="op" id="4147774">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147779">Version</span><span class="op" id="4147786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4147791">in</span><span class="op" id="4147793">.</span><span class="ident" id="4147794">TBSCSR</span><span class="op" id="4147800">.</span><span class="ident" id="4147801">Version</span><span class="op" id="4147808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147812">Attributes</span><span class="op" id="4147822">:</span>&nbsp;<span class="ident" id="4147824">in</span><span class="op" id="4147826">.</span><span class="ident" id="4147827">TBSCSR</span><span class="op" id="4147833">.</span><span class="ident" id="4147834">Attributes</span><span class="op" id="4147844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147847">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147851">var</span>&nbsp;<span class="ident" id="4147855">err</span>&nbsp;<span class="builtintype" id="4147859">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147866">out</span><span class="op" id="4147869">.</span><span class="ident" id="4147870">PublicKey</span><span class="op" id="4147879">,</span>&nbsp;<span class="ident" id="4147881">err</span>&nbsp;<span class="op" id="4147885">=</span>&nbsp;<span class="ident" id="4147887">parsePublicKey</span><span class="op" id="4147901">(</span><span class="ident" id="4147902">out</span><span class="op" id="4147905">.</span><span class="ident" id="4147906">PublicKeyAlgorithm</span><span class="op" id="4147924">,</span>&nbsp;<span class="op" id="4147926">&amp;</span><span class="ident" id="4147927">in</span><span class="op" id="4147929">.</span><span class="ident" id="4147930">TBSCSR</span><span class="op" id="4147936">.</span><span class="ident" id="4147937">PublicKey</span><span class="op" id="4147946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147949">if</span>&nbsp;<span class="ident" id="4147952">err</span>&nbsp;<span class="op" id="4147956">!=</span>&nbsp;<span class="ident" id="4147959">nil</span>&nbsp;<span class="op" id="4147963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147967">return</span>&nbsp;<span class="ident" id="4147974">nil</span><span class="op" id="4147977">,</span>&nbsp;<span class="ident" id="4147979">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147988">var</span>&nbsp;<span class="ident" id="4147992">subject</span>&nbsp;<span class="ident" id="4148000">pkix</span><span class="op" id="4148004">.</span><span class="ident" id="4148005">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148018">if</span>&nbsp;<span class="ident" id="4148021">_</span><span class="op" id="4148022">,</span>&nbsp;<span class="ident" id="4148024">err</span>&nbsp;<span class="op" id="4148028">:=</span>&nbsp;<span class="ident" id="4148031">asn1</span><span class="op" id="4148035">.</span><span class="ident" id="4148036">Unmarshal</span><span class="op" id="4148045">(</span><span class="ident" id="4148046">in</span><span class="op" id="4148048">.</span><span class="ident" id="4148049">TBSCSR</span><span class="op" id="4148055">.</span><span class="ident" id="4148056">Subject</span><span class="op" id="4148063">.</span><span class="ident" id="4148064">FullBytes</span><span class="op" id="4148073">,</span>&nbsp;<span class="op" id="4148075">&amp;</span><span class="ident" id="4148076">subject</span><span class="op" id="4148083">)</span><span class="op" id="4148084">;</span>&nbsp;<span class="ident" id="4148086">err</span>&nbsp;<span class="op" id="4148090">!=</span>&nbsp;<span class="ident" id="4148093">nil</span>&nbsp;<span class="op" id="4148097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148101">return</span>&nbsp;<span class="ident" id="4148108">nil</span><span class="op" id="4148111">,</span>&nbsp;<span class="ident" id="4148113">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148122">out</span><span class="op" id="4148125">.</span><span class="ident" id="4148126">Subject</span><span class="op" id="4148133">.</span><span class="ident" id="4148134">FillFromRDNSequence</span><span class="op" id="4148153">(</span><span class="op" id="4148154">&amp;</span><span class="ident" id="4148155">subject</span><span class="op" id="4148162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148166">var</span>&nbsp;<span class="ident" id="4148170">extensions</span>&nbsp;<span class="op" id="4148181">[</span><span class="op" id="4148182">]</span><span class="ident" id="4148183">pkix</span><span class="op" id="4148187">.</span><span class="ident" id="4148188">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148212">for</span>&nbsp;<span class="ident" id="4148216">_</span><span class="op" id="4148217">,</span>&nbsp;<span class="ident" id="4148219">atvSet</span>&nbsp;<span class="op" id="4148226">:=</span>&nbsp;<span class="keyword" id="4148229">range</span>&nbsp;<span class="ident" id="4148235">in</span><span class="op" id="4148237">.</span><span class="ident" id="4148238">TBSCSR</span><span class="op" id="4148244">.</span><span class="ident" id="4148245">Attributes</span>&nbsp;<span class="op" id="4148256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148260">if</span>&nbsp;<span class="op" id="4148263">!</span><span class="ident" id="4148264">atvSet</span><span class="op" id="4148270">.</span><span class="ident" id="4148271">Type</span><span class="op" id="4148275">.</span><span class="ident" id="4148276">Equal</span><span class="op" id="4148281">(</span><span class="ident" id="4148282">oidExtensionRequest</span><span class="op" id="4148301">)</span>&nbsp;<span class="op" id="4148303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148308">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148319">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148324">for</span>&nbsp;<span class="ident" id="4148328">_</span><span class="op" id="4148329">,</span>&nbsp;<span class="ident" id="4148331">atvs</span>&nbsp;<span class="op" id="4148336">:=</span>&nbsp;<span class="keyword" id="4148339">range</span>&nbsp;<span class="ident" id="4148345">atvSet</span><span class="op" id="4148351">.</span><span class="ident" id="4148352">Value</span>&nbsp;<span class="op" id="4148358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148363">extensions</span>&nbsp;<span class="op" id="4148374">=</span>&nbsp;<span class="builtinfunc" id="4148376">append</span><span class="op" id="4148382">(</span><span class="ident" id="4148383">extensions</span><span class="op" id="4148393">,</span>&nbsp;<span class="ident" id="4148395">atvs</span><span class="op" id="4148399">...</span><span class="op" id="4148402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148409">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148413">out</span><span class="op" id="4148416">.</span><span class="ident" id="4148417">Extensions</span>&nbsp;<span class="op" id="4148428">=</span>&nbsp;<span class="builtinfunc" id="4148430">make</span><span class="op" id="4148434">(</span><span class="op" id="4148435">[</span><span class="op" id="4148436">]</span><span class="ident" id="4148437">pkix</span><span class="op" id="4148441">.</span><span class="ident" id="4148442">Extension</span><span class="op" id="4148451">,</span>&nbsp;<span class="num" id="4148453">0</span><span class="op" id="4148454">,</span>&nbsp;<span class="builtinfunc" id="4148456">len</span><span class="op" id="4148459">(</span><span class="ident" id="4148460">extensions</span><span class="op" id="4148470">)</span><span class="op" id="4148471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148475">for</span>&nbsp;<span class="ident" id="4148479">_</span><span class="op" id="4148480">,</span>&nbsp;<span class="ident" id="4148482">e</span>&nbsp;<span class="op" id="4148484">:=</span>&nbsp;<span class="keyword" id="4148487">range</span>&nbsp;<span class="ident" id="4148493">extensions</span>&nbsp;<span class="op" id="4148504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148508">value</span><span class="op" id="4148513">,</span>&nbsp;<span class="ident" id="4148515">ok</span>&nbsp;<span class="op" id="4148518">:=</span>&nbsp;<span class="ident" id="4148521">e</span><span class="op" id="4148522">.</span><span class="ident" id="4148523">Value</span><span class="op" id="4148528">.</span><span class="op" id="4148529">(</span><span class="op" id="4148530">[</span><span class="op" id="4148531">]</span><span class="builtintype" id="4148532">byte</span><span class="op" id="4148536">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148540">if</span>&nbsp;<span class="op" id="4148543">!</span><span class="ident" id="4148544">ok</span>&nbsp;<span class="op" id="4148547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148552">return</span>&nbsp;<span class="ident" id="4148559">nil</span><span class="op" id="4148562">,</span>&nbsp;<span class="ident" id="4148564">errors</span><span class="op" id="4148570">.</span><span class="ident" id="4148571">New</span><span class="op" id="4148574">(</span><span class="string" id="4148575">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4148634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148643">out</span><span class="op" id="4148646">.</span><span class="ident" id="4148647">Extensions</span>&nbsp;<span class="op" id="4148658">=</span>&nbsp;<span class="builtinfunc" id="4148660">append</span><span class="op" id="4148666">(</span><span class="ident" id="4148667">out</span><span class="op" id="4148670">.</span><span class="ident" id="4148671">Extensions</span><span class="op" id="4148681">,</span>&nbsp;<span class="ident" id="4148683">pkix</span><span class="op" id="4148687">.</span><span class="ident" id="4148688">Extension</span><span class="op" id="4148697">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148702">Id</span><span class="op" id="4148704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4148709">e</span><span class="op" id="4148710">.</span><span class="ident" id="4148711">Type</span><span class="op" id="4148715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148720">Value</span><span class="op" id="4148725">:</span>&nbsp;<span class="ident" id="4148727">value</span><span class="op" id="4148732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148736">}</span><span class="op" id="4148737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148742">if</span>&nbsp;<span class="builtinfunc" id="4148745">len</span><span class="op" id="4148748">(</span><span class="ident" id="4148749">e</span><span class="op" id="4148750">.</span><span class="ident" id="4148751">Type</span><span class="op" id="4148755">)</span>&nbsp;<span class="op" id="4148757">==</span>&nbsp;<span class="num" id="4148760">4</span>&nbsp;<span class="op" id="4148762">&amp;&amp;</span>&nbsp;<span class="ident" id="4148765">e</span><span class="op" id="4148766">.</span><span class="ident" id="4148767">Type</span><span class="op" id="4148771">[</span><span class="num" id="4148772">0</span><span class="op" id="4148773">]</span>&nbsp;<span class="op" id="4148775">==</span>&nbsp;<span class="num" id="4148778">2</span>&nbsp;<span class="op" id="4148780">&amp;&amp;</span>&nbsp;<span class="ident" id="4148783">e</span><span class="op" id="4148784">.</span><span class="ident" id="4148785">Type</span><span class="op" id="4148789">[</span><span class="num" id="4148790">1</span><span class="op" id="4148791">]</span>&nbsp;<span class="op" id="4148793">==</span>&nbsp;<span class="num" id="4148796">5</span>&nbsp;<span class="op" id="4148798">&amp;&amp;</span>&nbsp;<span class="ident" id="4148801">e</span><span class="op" id="4148802">.</span><span class="ident" id="4148803">Type</span><span class="op" id="4148807">[</span><span class="num" id="4148808">2</span><span class="op" id="4148809">]</span>&nbsp;<span class="op" id="4148811">==</span>&nbsp;<span class="num" id="4148814">29</span>&nbsp;<span class="op" id="4148817">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148822">switch</span>&nbsp;<span class="ident" id="4148829">e</span><span class="op" id="4148830">.</span><span class="ident" id="4148831">Type</span><span class="op" id="4148835">[</span><span class="num" id="4148836">3</span><span class="op" id="4148837">]</span>&nbsp;<span class="op" id="4148839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148844">case</span>&nbsp;<span class="num" id="4148849">17</span><span class="op" id="4148851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148857">out</span><span class="op" id="4148860">.</span><span class="ident" id="4148861">DNSNames</span><span class="op" id="4148869">,</span>&nbsp;<span class="ident" id="4148871">out</span><span class="op" id="4148874">.</span><span class="ident" id="4148875">EmailAddresses</span><span class="op" id="4148889">,</span>&nbsp;<span class="ident" id="4148891">out</span><span class="op" id="4148894">.</span><span class="ident" id="4148895">IPAddresses</span><span class="op" id="4148906">,</span>&nbsp;<span class="ident" id="4148908">err</span>&nbsp;<span class="op" id="4148912">=</span>&nbsp;<span class="ident" id="4148914">parseSANExtension</span><span class="op" id="4148931">(</span><span class="ident" id="4148932">value</span><span class="op" id="4148937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148943">if</span>&nbsp;<span class="ident" id="4148946">err</span>&nbsp;<span class="op" id="4148950">!=</span>&nbsp;<span class="ident" id="4148953">nil</span>&nbsp;<span class="op" id="4148957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148964">return</span>&nbsp;<span class="ident" id="4148971">nil</span><span class="op" id="4148974">,</span>&nbsp;<span class="ident" id="4148976">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149000">return</span>&nbsp;<span class="ident" id="4149007">out</span><span class="op" id="4149010">,</span>&nbsp;<span class="ident" id="4149012">nil</span><br>
<span class="lineno"></span><span class="op" id="4149016">}</span>
</div>
</body>
</html>
