<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5483289">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5483344">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5483398">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5483449">package</span>&nbsp;<span class="ident" id="5483457">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5483467">import</span>&nbsp;<span class="op" id="5483474">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483477">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483484">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483490">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483503">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483520">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483528">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483545">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5483567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5483570">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5483650">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5483677">type</span>&nbsp;<span class="ident" id="5483682">Template</span>&nbsp;<span class="keyword" id="5483691">struct</span>&nbsp;<span class="op" id="5483698">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5483701">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483737">escapeErr</span>&nbsp;<span class="builtintype" id="5483747">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5483754">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5483828">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5483897">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483921">text</span>&nbsp;<span class="op" id="5483926">*</span><span class="ident" id="5483927">template</span><span class="op" id="5483935">.</span><span class="ident" id="5483936">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5483946">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484013">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5484024">*</span><span class="ident" id="5484025">parse</span><span class="op" id="5484030">.</span><span class="ident" id="5484031">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5484037">*</span><span class="ident" id="5484038">nameSpace</span>&nbsp;<span class="comment" id="5484048">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5484086">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5484089">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5484154">var</span>&nbsp;<span class="ident" id="5484158">escapeOK</span>&nbsp;<span class="op" id="5484167">=</span>&nbsp;<span class="ident" id="5484169">fmt</span><span class="op" id="5484172">.</span><span class="ident" id="5484173">Errorf</span><span class="op" id="5484179">(</span><span class="string" id="5484180">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5484208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5484211">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5484289">type</span>&nbsp;<span class="ident" id="5484294">nameSpace</span>&nbsp;<span class="keyword" id="5484304">struct</span>&nbsp;<span class="op" id="5484311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484314">mu</span>&nbsp;&nbsp;<span class="ident" id="5484318">sync</span><span class="op" id="5484322">.</span><span class="ident" id="5484323">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484330">set</span>&nbsp;<span class="keyword" id="5484334">map</span><span class="op" id="5484337">[</span><span class="builtintype" id="5484338">string</span><span class="op" id="5484344">]</span><span class="op" id="5484345">*</span><span class="ident" id="5484346">Template</span><br>
<span class="lineno"></span><span class="op" id="5484355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5484358">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5484435">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5484446">func</span>&nbsp;<span class="op" id="5484451">(</span><span class="ident" id="5484452">t</span>&nbsp;<span class="op" id="5484454">*</span><span class="ident" id="5484455">Template</span><span class="op" id="5484463">)</span>&nbsp;<span class="ident" id="5484465">Templates</span><span class="op" id="5484474">(</span><span class="op" id="5484475">)</span>&nbsp;<span class="op" id="5484477">[</span><span class="op" id="5484478">]</span><span class="op" id="5484479">*</span><span class="ident" id="5484480">Template</span>&nbsp;<span class="op" id="5484489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484492">ns</span>&nbsp;<span class="op" id="5484495">:=</span>&nbsp;<span class="ident" id="5484498">t</span><span class="op" id="5484499">.</span><span class="ident" id="5484500">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484511">ns</span><span class="op" id="5484513">.</span><span class="ident" id="5484514">mu</span><span class="op" id="5484516">.</span><span class="ident" id="5484517">Lock</span><span class="op" id="5484521">(</span><span class="op" id="5484522">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484525">defer</span>&nbsp;<span class="ident" id="5484531">ns</span><span class="op" id="5484533">.</span><span class="ident" id="5484534">mu</span><span class="op" id="5484536">.</span><span class="ident" id="5484537">Unlock</span><span class="op" id="5484543">(</span><span class="op" id="5484544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484547">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484594">m</span>&nbsp;<span class="op" id="5484596">:=</span>&nbsp;<span class="builtinfunc" id="5484599">make</span><span class="op" id="5484603">(</span><span class="op" id="5484604">[</span><span class="op" id="5484605">]</span><span class="op" id="5484606">*</span><span class="ident" id="5484607">Template</span><span class="op" id="5484615">,</span>&nbsp;<span class="num" id="5484617">0</span><span class="op" id="5484618">,</span>&nbsp;<span class="builtinfunc" id="5484620">len</span><span class="op" id="5484623">(</span><span class="ident" id="5484624">ns</span><span class="op" id="5484626">.</span><span class="ident" id="5484627">set</span><span class="op" id="5484630">)</span><span class="op" id="5484631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484634">for</span>&nbsp;<span class="ident" id="5484638">_</span><span class="op" id="5484639">,</span>&nbsp;<span class="ident" id="5484641">v</span>&nbsp;<span class="op" id="5484643">:=</span>&nbsp;<span class="keyword" id="5484646">range</span>&nbsp;<span class="ident" id="5484652">ns</span><span class="op" id="5484654">.</span><span class="ident" id="5484655">set</span>&nbsp;<span class="op" id="5484659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484663">m</span>&nbsp;<span class="op" id="5484665">=</span>&nbsp;<span class="builtinfunc" id="5484667">append</span><span class="op" id="5484673">(</span><span class="ident" id="5484674">m</span><span class="op" id="5484675">,</span>&nbsp;<span class="ident" id="5484677">v</span><span class="op" id="5484678">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5484681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484684">return</span>&nbsp;<span class="ident" id="5484691">m</span><br>
<span class="lineno"></span><span class="op" id="5484693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5484696">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5484740">func</span>&nbsp;<span class="op" id="5484745">(</span><span class="ident" id="5484746">t</span>&nbsp;<span class="op" id="5484748">*</span><span class="ident" id="5484749">Template</span><span class="op" id="5484757">)</span>&nbsp;<span class="ident" id="5484759">escape</span><span class="op" id="5484765">(</span><span class="op" id="5484766">)</span>&nbsp;<span class="builtintype" id="5484768">error</span>&nbsp;<span class="op" id="5484774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484777">t</span><span class="op" id="5484778">.</span><span class="ident" id="5484779">nameSpace</span><span class="op" id="5484788">.</span><span class="ident" id="5484789">mu</span><span class="op" id="5484791">.</span><span class="ident" id="5484792">Lock</span><span class="op" id="5484796">(</span><span class="op" id="5484797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484800">defer</span>&nbsp;<span class="ident" id="5484806">t</span><span class="op" id="5484807">.</span><span class="ident" id="5484808">nameSpace</span><span class="op" id="5484817">.</span><span class="ident" id="5484818">mu</span><span class="op" id="5484820">.</span><span class="ident" id="5484821">Unlock</span><span class="op" id="5484827">(</span><span class="op" id="5484828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484831">if</span>&nbsp;<span class="ident" id="5484834">t</span><span class="op" id="5484835">.</span><span class="ident" id="5484836">escapeErr</span>&nbsp;<span class="op" id="5484846">==</span>&nbsp;<span class="ident" id="5484849">nil</span>&nbsp;<span class="op" id="5484853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484857">if</span>&nbsp;<span class="ident" id="5484860">err</span>&nbsp;<span class="op" id="5484864">:=</span>&nbsp;<span class="ident" id="5484867">escapeTemplate</span><span class="op" id="5484881">(</span><span class="ident" id="5484882">t</span><span class="op" id="5484883">,</span>&nbsp;<span class="ident" id="5484885">t</span><span class="op" id="5484886">.</span><span class="ident" id="5484887">text</span><span class="op" id="5484891">.</span><span class="ident" id="5484892">Root</span><span class="op" id="5484896">,</span>&nbsp;<span class="ident" id="5484898">t</span><span class="op" id="5484899">.</span><span class="ident" id="5484900">Name</span><span class="op" id="5484904">(</span><span class="op" id="5484905">)</span><span class="op" id="5484906">)</span><span class="op" id="5484907">;</span>&nbsp;<span class="ident" id="5484909">err</span>&nbsp;<span class="op" id="5484913">!=</span>&nbsp;<span class="ident" id="5484916">nil</span>&nbsp;<span class="op" id="5484920">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484925">return</span>&nbsp;<span class="ident" id="5484932">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5484938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5484941">}</span>&nbsp;<span class="keyword" id="5484943">else</span>&nbsp;<span class="keyword" id="5484948">if</span>&nbsp;<span class="ident" id="5484951">t</span><span class="op" id="5484952">.</span><span class="ident" id="5484953">escapeErr</span>&nbsp;<span class="op" id="5484963">!=</span>&nbsp;<span class="ident" id="5484966">escapeOK</span>&nbsp;<span class="op" id="5484975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484979">return</span>&nbsp;<span class="ident" id="5484986">t</span><span class="op" id="5484987">.</span><span class="ident" id="5484988">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5484999">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485002">return</span>&nbsp;<span class="ident" id="5485009">nil</span><br>
<span class="lineno"></span><span class="op" id="5485013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5485016">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5485083">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5485112">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5485180">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5485253">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5485275">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5485325">func</span>&nbsp;<span class="op" id="5485330">(</span><span class="ident" id="5485331">t</span>&nbsp;<span class="op" id="5485333">*</span><span class="ident" id="5485334">Template</span><span class="op" id="5485342">)</span>&nbsp;<span class="ident" id="5485344">Execute</span><span class="op" id="5485351">(</span><span class="ident" id="5485352">wr</span>&nbsp;<span class="ident" id="5485355">io</span><span class="op" id="5485357">.</span><span class="ident" id="5485358">Writer</span><span class="op" id="5485364">,</span>&nbsp;<span class="ident" id="5485366">data</span>&nbsp;<span class="keyword" id="5485371">interface</span><span class="op" id="5485380">{</span><span class="op" id="5485381">}</span><span class="op" id="5485382">)</span>&nbsp;<span class="builtintype" id="5485384">error</span>&nbsp;<span class="op" id="5485390">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485393">if</span>&nbsp;<span class="ident" id="5485396">err</span>&nbsp;<span class="op" id="5485400">:=</span>&nbsp;<span class="ident" id="5485403">t</span><span class="op" id="5485404">.</span><span class="ident" id="5485405">escape</span><span class="op" id="5485411">(</span><span class="op" id="5485412">)</span><span class="op" id="5485413">;</span>&nbsp;<span class="ident" id="5485415">err</span>&nbsp;<span class="op" id="5485419">!=</span>&nbsp;<span class="ident" id="5485422">nil</span>&nbsp;<span class="op" id="5485426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485430">return</span>&nbsp;<span class="ident" id="5485437">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485445">return</span>&nbsp;<span class="ident" id="5485452">t</span><span class="op" id="5485453">.</span><span class="ident" id="5485454">text</span><span class="op" id="5485458">.</span><span class="ident" id="5485459">Execute</span><span class="op" id="5485466">(</span><span class="ident" id="5485467">wr</span><span class="op" id="5485469">,</span>&nbsp;<span class="ident" id="5485471">data</span><span class="op" id="5485475">)</span><br>
<span class="lineno"></span><span class="op" id="5485477">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5485480">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5485557">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5485623">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5485691">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5485764">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5485786">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5485836">func</span>&nbsp;<span class="op" id="5485841">(</span><span class="ident" id="5485842">t</span>&nbsp;<span class="op" id="5485844">*</span><span class="ident" id="5485845">Template</span><span class="op" id="5485853">)</span>&nbsp;<span class="ident" id="5485855">ExecuteTemplate</span><span class="op" id="5485870">(</span><span class="ident" id="5485871">wr</span>&nbsp;<span class="ident" id="5485874">io</span><span class="op" id="5485876">.</span><span class="ident" id="5485877">Writer</span><span class="op" id="5485883">,</span>&nbsp;<span class="ident" id="5485885">name</span>&nbsp;<span class="builtintype" id="5485890">string</span><span class="op" id="5485896">,</span>&nbsp;<span class="ident" id="5485898">data</span>&nbsp;<span class="keyword" id="5485903">interface</span><span class="op" id="5485912">{</span><span class="op" id="5485913">}</span><span class="op" id="5485914">)</span>&nbsp;<span class="builtintype" id="5485916">error</span>&nbsp;<span class="op" id="5485922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485925">tmpl</span><span class="op" id="5485929">,</span>&nbsp;<span class="ident" id="5485931">err</span>&nbsp;<span class="op" id="5485935">:=</span>&nbsp;<span class="ident" id="5485938">t</span><span class="op" id="5485939">.</span><span class="ident" id="5485940">lookupAndEscapeTemplate</span><span class="op" id="5485963">(</span><span class="ident" id="5485964">name</span><span class="op" id="5485968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485971">if</span>&nbsp;<span class="ident" id="5485974">err</span>&nbsp;<span class="op" id="5485978">!=</span>&nbsp;<span class="ident" id="5485981">nil</span>&nbsp;<span class="op" id="5485985">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485989">return</span>&nbsp;<span class="ident" id="5485996">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486004">return</span>&nbsp;<span class="ident" id="5486011">tmpl</span><span class="op" id="5486015">.</span><span class="ident" id="5486016">text</span><span class="op" id="5486020">.</span><span class="ident" id="5486021">Execute</span><span class="op" id="5486028">(</span><span class="ident" id="5486029">wr</span><span class="op" id="5486031">,</span>&nbsp;<span class="ident" id="5486033">data</span><span class="op" id="5486037">)</span><br>
<span class="lineno"></span><span class="op" id="5486039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5486042">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5486118">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5486191">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5486204">func</span>&nbsp;<span class="op" id="5486209">(</span><span class="ident" id="5486210">t</span>&nbsp;<span class="op" id="5486212">*</span><span class="ident" id="5486213">Template</span><span class="op" id="5486221">)</span>&nbsp;<span class="ident" id="5486223">lookupAndEscapeTemplate</span><span class="op" id="5486246">(</span><span class="ident" id="5486247">name</span>&nbsp;<span class="builtintype" id="5486252">string</span><span class="op" id="5486258">)</span>&nbsp;<span class="op" id="5486260">(</span><span class="ident" id="5486261">tmpl</span>&nbsp;<span class="op" id="5486266">*</span><span class="ident" id="5486267">Template</span><span class="op" id="5486275">,</span>&nbsp;<span class="ident" id="5486277">err</span>&nbsp;<span class="builtintype" id="5486281">error</span><span class="op" id="5486286">)</span>&nbsp;<span class="op" id="5486288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486291">t</span><span class="op" id="5486292">.</span><span class="ident" id="5486293">nameSpace</span><span class="op" id="5486302">.</span><span class="ident" id="5486303">mu</span><span class="op" id="5486305">.</span><span class="ident" id="5486306">Lock</span><span class="op" id="5486310">(</span><span class="op" id="5486311">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486314">defer</span>&nbsp;<span class="ident" id="5486320">t</span><span class="op" id="5486321">.</span><span class="ident" id="5486322">nameSpace</span><span class="op" id="5486331">.</span><span class="ident" id="5486332">mu</span><span class="op" id="5486334">.</span><span class="ident" id="5486335">Unlock</span><span class="op" id="5486341">(</span><span class="op" id="5486342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486345">tmpl</span>&nbsp;<span class="op" id="5486350">=</span>&nbsp;<span class="ident" id="5486352">t</span><span class="op" id="5486353">.</span><span class="ident" id="5486354">set</span><span class="op" id="5486357">[</span><span class="ident" id="5486358">name</span><span class="op" id="5486362">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486365">if</span>&nbsp;<span class="ident" id="5486368">tmpl</span>&nbsp;<span class="op" id="5486373">==</span>&nbsp;<span class="ident" id="5486376">nil</span>&nbsp;<span class="op" id="5486380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486384">return</span>&nbsp;<span class="ident" id="5486391">nil</span><span class="op" id="5486394">,</span>&nbsp;<span class="ident" id="5486396">fmt</span><span class="op" id="5486399">.</span><span class="ident" id="5486400">Errorf</span><span class="op" id="5486406">(</span><span class="string" id="5486407">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5486439">,</span>&nbsp;<span class="ident" id="5486441">name</span><span class="op" id="5486445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486448">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486451">if</span>&nbsp;<span class="ident" id="5486454">tmpl</span><span class="op" id="5486458">.</span><span class="ident" id="5486459">escapeErr</span>&nbsp;<span class="op" id="5486469">!=</span>&nbsp;<span class="ident" id="5486472">nil</span>&nbsp;<span class="op" id="5486476">&amp;&amp;</span>&nbsp;<span class="ident" id="5486479">tmpl</span><span class="op" id="5486483">.</span><span class="ident" id="5486484">escapeErr</span>&nbsp;<span class="op" id="5486494">!=</span>&nbsp;<span class="ident" id="5486497">escapeOK</span>&nbsp;<span class="op" id="5486506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486510">return</span>&nbsp;<span class="ident" id="5486517">nil</span><span class="op" id="5486520">,</span>&nbsp;<span class="ident" id="5486522">tmpl</span><span class="op" id="5486526">.</span><span class="ident" id="5486527">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486541">if</span>&nbsp;<span class="ident" id="5486544">tmpl</span><span class="op" id="5486548">.</span><span class="ident" id="5486549">text</span><span class="op" id="5486553">.</span><span class="ident" id="5486554">Tree</span>&nbsp;<span class="op" id="5486559">==</span>&nbsp;<span class="ident" id="5486562">nil</span>&nbsp;<span class="op" id="5486566">||</span>&nbsp;<span class="ident" id="5486569">tmpl</span><span class="op" id="5486573">.</span><span class="ident" id="5486574">text</span><span class="op" id="5486578">.</span><span class="ident" id="5486579">Root</span>&nbsp;<span class="op" id="5486584">==</span>&nbsp;<span class="ident" id="5486587">nil</span>&nbsp;<span class="op" id="5486591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486595">return</span>&nbsp;<span class="ident" id="5486602">nil</span><span class="op" id="5486605">,</span>&nbsp;<span class="ident" id="5486607">fmt</span><span class="op" id="5486610">.</span><span class="ident" id="5486611">Errorf</span><span class="op" id="5486617">(</span><span class="string" id="5486618">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5486663">,</span>&nbsp;<span class="ident" id="5486665">name</span><span class="op" id="5486669">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486675">if</span>&nbsp;<span class="ident" id="5486678">t</span><span class="op" id="5486679">.</span><span class="ident" id="5486680">text</span><span class="op" id="5486684">.</span><span class="ident" id="5486685">Lookup</span><span class="op" id="5486691">(</span><span class="ident" id="5486692">name</span><span class="op" id="5486696">)</span>&nbsp;<span class="op" id="5486698">==</span>&nbsp;<span class="ident" id="5486701">nil</span>&nbsp;<span class="op" id="5486705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5486709">panic</span><span class="op" id="5486714">(</span><span class="string" id="5486715">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5486776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486782">if</span>&nbsp;<span class="ident" id="5486785">tmpl</span><span class="op" id="5486789">.</span><span class="ident" id="5486790">escapeErr</span>&nbsp;<span class="op" id="5486800">==</span>&nbsp;<span class="ident" id="5486803">nil</span>&nbsp;<span class="op" id="5486807">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486811">err</span>&nbsp;<span class="op" id="5486815">=</span>&nbsp;<span class="ident" id="5486817">escapeTemplate</span><span class="op" id="5486831">(</span><span class="ident" id="5486832">tmpl</span><span class="op" id="5486836">,</span>&nbsp;<span class="ident" id="5486838">tmpl</span><span class="op" id="5486842">.</span><span class="ident" id="5486843">text</span><span class="op" id="5486847">.</span><span class="ident" id="5486848">Root</span><span class="op" id="5486852">,</span>&nbsp;<span class="ident" id="5486854">name</span><span class="op" id="5486858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486864">return</span>&nbsp;<span class="ident" id="5486871">tmpl</span><span class="op" id="5486875">,</span>&nbsp;<span class="ident" id="5486877">err</span><br>
<span class="lineno"></span><span class="op" id="5486881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5486884">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5486954">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5487020">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5487092">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5487165">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5487229">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5487300">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5487367">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5487425">func</span>&nbsp;<span class="op" id="5487430">(</span><span class="ident" id="5487431">t</span>&nbsp;<span class="op" id="5487433">*</span><span class="ident" id="5487434">Template</span><span class="op" id="5487442">)</span>&nbsp;<span class="ident" id="5487444">Parse</span><span class="op" id="5487449">(</span><span class="ident" id="5487450">src</span>&nbsp;<span class="builtintype" id="5487454">string</span><span class="op" id="5487460">)</span>&nbsp;<span class="op" id="5487462">(</span><span class="op" id="5487463">*</span><span class="ident" id="5487464">Template</span><span class="op" id="5487472">,</span>&nbsp;<span class="builtintype" id="5487474">error</span><span class="op" id="5487479">)</span>&nbsp;<span class="op" id="5487481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487484">t</span><span class="op" id="5487485">.</span><span class="ident" id="5487486">nameSpace</span><span class="op" id="5487495">.</span><span class="ident" id="5487496">mu</span><span class="op" id="5487498">.</span><span class="ident" id="5487499">Lock</span><span class="op" id="5487503">(</span><span class="op" id="5487504">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487507">t</span><span class="op" id="5487508">.</span><span class="ident" id="5487509">escapeErr</span>&nbsp;<span class="op" id="5487519">=</span>&nbsp;<span class="ident" id="5487521">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487526">t</span><span class="op" id="5487527">.</span><span class="ident" id="5487528">nameSpace</span><span class="op" id="5487537">.</span><span class="ident" id="5487538">mu</span><span class="op" id="5487540">.</span><span class="ident" id="5487541">Unlock</span><span class="op" id="5487547">(</span><span class="op" id="5487548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487551">ret</span><span class="op" id="5487554">,</span>&nbsp;<span class="ident" id="5487556">err</span>&nbsp;<span class="op" id="5487560">:=</span>&nbsp;<span class="ident" id="5487563">t</span><span class="op" id="5487564">.</span><span class="ident" id="5487565">text</span><span class="op" id="5487569">.</span><span class="ident" id="5487570">Parse</span><span class="op" id="5487575">(</span><span class="ident" id="5487576">src</span><span class="op" id="5487579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487582">if</span>&nbsp;<span class="ident" id="5487585">err</span>&nbsp;<span class="op" id="5487589">!=</span>&nbsp;<span class="ident" id="5487592">nil</span>&nbsp;<span class="op" id="5487596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487600">return</span>&nbsp;<span class="ident" id="5487607">nil</span><span class="op" id="5487610">,</span>&nbsp;<span class="ident" id="5487612">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487620">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487690">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487743">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487804">t</span><span class="op" id="5487805">.</span><span class="ident" id="5487806">nameSpace</span><span class="op" id="5487815">.</span><span class="ident" id="5487816">mu</span><span class="op" id="5487818">.</span><span class="ident" id="5487819">Lock</span><span class="op" id="5487823">(</span><span class="op" id="5487824">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487827">defer</span>&nbsp;<span class="ident" id="5487833">t</span><span class="op" id="5487834">.</span><span class="ident" id="5487835">nameSpace</span><span class="op" id="5487844">.</span><span class="ident" id="5487845">mu</span><span class="op" id="5487847">.</span><span class="ident" id="5487848">Unlock</span><span class="op" id="5487854">(</span><span class="op" id="5487855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487858">for</span>&nbsp;<span class="ident" id="5487862">_</span><span class="op" id="5487863">,</span>&nbsp;<span class="ident" id="5487865">v</span>&nbsp;<span class="op" id="5487867">:=</span>&nbsp;<span class="keyword" id="5487870">range</span>&nbsp;<span class="ident" id="5487876">ret</span><span class="op" id="5487879">.</span><span class="ident" id="5487880">Templates</span><span class="op" id="5487889">(</span><span class="op" id="5487890">)</span>&nbsp;<span class="op" id="5487892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487896">name</span>&nbsp;<span class="op" id="5487901">:=</span>&nbsp;<span class="ident" id="5487904">v</span><span class="op" id="5487905">.</span><span class="ident" id="5487906">Name</span><span class="op" id="5487910">(</span><span class="op" id="5487911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487915">tmpl</span>&nbsp;<span class="op" id="5487920">:=</span>&nbsp;<span class="ident" id="5487923">t</span><span class="op" id="5487924">.</span><span class="ident" id="5487925">set</span><span class="op" id="5487928">[</span><span class="ident" id="5487929">name</span><span class="op" id="5487933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487937">if</span>&nbsp;<span class="ident" id="5487940">tmpl</span>&nbsp;<span class="op" id="5487945">==</span>&nbsp;<span class="ident" id="5487948">nil</span>&nbsp;<span class="op" id="5487952">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487957">tmpl</span>&nbsp;<span class="op" id="5487962">=</span>&nbsp;<span class="ident" id="5487964">t</span><span class="op" id="5487965">.</span><span class="builtinfunc" id="5487966">new</span><span class="op" id="5487969">(</span><span class="ident" id="5487970">name</span><span class="op" id="5487974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487982">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488061">tmpl</span><span class="op" id="5488065">.</span><span class="ident" id="5488066">escapeErr</span>&nbsp;<span class="op" id="5488076">=</span>&nbsp;<span class="ident" id="5488078">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488084">tmpl</span><span class="op" id="5488088">.</span><span class="ident" id="5488089">text</span>&nbsp;<span class="op" id="5488094">=</span>&nbsp;<span class="ident" id="5488096">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488100">tmpl</span><span class="op" id="5488104">.</span><span class="ident" id="5488105">Tree</span>&nbsp;<span class="op" id="5488110">=</span>&nbsp;<span class="ident" id="5488112">v</span><span class="op" id="5488113">.</span><span class="ident" id="5488114">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488123">return</span>&nbsp;<span class="ident" id="5488130">t</span><span class="op" id="5488131">,</span>&nbsp;<span class="ident" id="5488133">nil</span><br>
<span class="lineno"></span><span class="op" id="5488137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5488140">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5488208">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5488237">//</span><br>
<span class="lineno"></span><span class="comment" id="5488240">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5488295">func</span>&nbsp;<span class="op" id="5488300">(</span><span class="ident" id="5488301">t</span>&nbsp;<span class="op" id="5488303">*</span><span class="ident" id="5488304">Template</span><span class="op" id="5488312">)</span>&nbsp;<span class="ident" id="5488314">AddParseTree</span><span class="op" id="5488326">(</span><span class="ident" id="5488327">name</span>&nbsp;<span class="builtintype" id="5488332">string</span><span class="op" id="5488338">,</span>&nbsp;<span class="ident" id="5488340">tree</span>&nbsp;<span class="op" id="5488345">*</span><span class="ident" id="5488346">parse</span><span class="op" id="5488351">.</span><span class="ident" id="5488352">Tree</span><span class="op" id="5488356">)</span>&nbsp;<span class="op" id="5488358">(</span><span class="op" id="5488359">*</span><span class="ident" id="5488360">Template</span><span class="op" id="5488368">,</span>&nbsp;<span class="builtintype" id="5488370">error</span><span class="op" id="5488375">)</span>&nbsp;<span class="op" id="5488377">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488380">t</span><span class="op" id="5488381">.</span><span class="ident" id="5488382">nameSpace</span><span class="op" id="5488391">.</span><span class="ident" id="5488392">mu</span><span class="op" id="5488394">.</span><span class="ident" id="5488395">Lock</span><span class="op" id="5488399">(</span><span class="op" id="5488400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488403">defer</span>&nbsp;<span class="ident" id="5488409">t</span><span class="op" id="5488410">.</span><span class="ident" id="5488411">nameSpace</span><span class="op" id="5488420">.</span><span class="ident" id="5488421">mu</span><span class="op" id="5488423">.</span><span class="ident" id="5488424">Unlock</span><span class="op" id="5488430">(</span><span class="op" id="5488431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488434">if</span>&nbsp;<span class="ident" id="5488437">t</span><span class="op" id="5488438">.</span><span class="ident" id="5488439">escapeErr</span>&nbsp;<span class="op" id="5488449">!=</span>&nbsp;<span class="ident" id="5488452">nil</span>&nbsp;<span class="op" id="5488456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488460">return</span>&nbsp;<span class="ident" id="5488467">nil</span><span class="op" id="5488470">,</span>&nbsp;<span class="ident" id="5488472">fmt</span><span class="op" id="5488475">.</span><span class="ident" id="5488476">Errorf</span><span class="op" id="5488482">(</span><span class="string" id="5488483">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5488547">,</span>&nbsp;<span class="ident" id="5488549">t</span><span class="op" id="5488550">.</span><span class="ident" id="5488551">Name</span><span class="op" id="5488555">(</span><span class="op" id="5488556">)</span><span class="op" id="5488557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488560">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488563">text</span><span class="op" id="5488567">,</span>&nbsp;<span class="ident" id="5488569">err</span>&nbsp;<span class="op" id="5488573">:=</span>&nbsp;<span class="ident" id="5488576">t</span><span class="op" id="5488577">.</span><span class="ident" id="5488578">text</span><span class="op" id="5488582">.</span><span class="ident" id="5488583">AddParseTree</span><span class="op" id="5488595">(</span><span class="ident" id="5488596">name</span><span class="op" id="5488600">,</span>&nbsp;<span class="ident" id="5488602">tree</span><span class="op" id="5488606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488609">if</span>&nbsp;<span class="ident" id="5488612">err</span>&nbsp;<span class="op" id="5488616">!=</span>&nbsp;<span class="ident" id="5488619">nil</span>&nbsp;<span class="op" id="5488623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488627">return</span>&nbsp;<span class="ident" id="5488634">nil</span><span class="op" id="5488637">,</span>&nbsp;<span class="ident" id="5488639">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488647">ret</span>&nbsp;<span class="op" id="5488651">:=</span>&nbsp;<span class="op" id="5488654">&amp;</span><span class="ident" id="5488655">Template</span><span class="op" id="5488663">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488667">nil</span><span class="op" id="5488670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488674">text</span><span class="op" id="5488678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488682">text</span><span class="op" id="5488686">.</span><span class="ident" id="5488687">Tree</span><span class="op" id="5488691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488695">t</span><span class="op" id="5488696">.</span><span class="ident" id="5488697">nameSpace</span><span class="op" id="5488706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488709">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488712">t</span><span class="op" id="5488713">.</span><span class="ident" id="5488714">set</span><span class="op" id="5488717">[</span><span class="ident" id="5488718">name</span><span class="op" id="5488722">]</span>&nbsp;<span class="op" id="5488724">=</span>&nbsp;<span class="ident" id="5488726">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488731">return</span>&nbsp;<span class="ident" id="5488738">ret</span><span class="op" id="5488741">,</span>&nbsp;<span class="ident" id="5488743">nil</span><br>
<span class="lineno"></span><span class="op" id="5488747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5488750">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5488821">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5488898">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5488973">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5489052">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5489130">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5489181">//</span><br>
<span class="lineno"></span><span class="comment" id="5489184">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5489239">func</span>&nbsp;<span class="op" id="5489244">(</span><span class="ident" id="5489245">t</span>&nbsp;<span class="op" id="5489247">*</span><span class="ident" id="5489248">Template</span><span class="op" id="5489256">)</span>&nbsp;<span class="ident" id="5489258">Clone</span><span class="op" id="5489263">(</span><span class="op" id="5489264">)</span>&nbsp;<span class="op" id="5489266">(</span><span class="op" id="5489267">*</span><span class="ident" id="5489268">Template</span><span class="op" id="5489276">,</span>&nbsp;<span class="builtintype" id="5489278">error</span><span class="op" id="5489283">)</span>&nbsp;<span class="op" id="5489285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489288">t</span><span class="op" id="5489289">.</span><span class="ident" id="5489290">nameSpace</span><span class="op" id="5489299">.</span><span class="ident" id="5489300">mu</span><span class="op" id="5489302">.</span><span class="ident" id="5489303">Lock</span><span class="op" id="5489307">(</span><span class="op" id="5489308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489311">defer</span>&nbsp;<span class="ident" id="5489317">t</span><span class="op" id="5489318">.</span><span class="ident" id="5489319">nameSpace</span><span class="op" id="5489328">.</span><span class="ident" id="5489329">mu</span><span class="op" id="5489331">.</span><span class="ident" id="5489332">Unlock</span><span class="op" id="5489338">(</span><span class="op" id="5489339">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489342">if</span>&nbsp;<span class="ident" id="5489345">t</span><span class="op" id="5489346">.</span><span class="ident" id="5489347">escapeErr</span>&nbsp;<span class="op" id="5489357">!=</span>&nbsp;<span class="ident" id="5489360">nil</span>&nbsp;<span class="op" id="5489364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489368">return</span>&nbsp;<span class="ident" id="5489375">nil</span><span class="op" id="5489378">,</span>&nbsp;<span class="ident" id="5489380">fmt</span><span class="op" id="5489383">.</span><span class="ident" id="5489384">Errorf</span><span class="op" id="5489390">(</span><span class="string" id="5489391">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5489445">,</span>&nbsp;<span class="ident" id="5489447">t</span><span class="op" id="5489448">.</span><span class="ident" id="5489449">Name</span><span class="op" id="5489453">(</span><span class="op" id="5489454">)</span><span class="op" id="5489455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489461">textClone</span><span class="op" id="5489470">,</span>&nbsp;<span class="ident" id="5489472">err</span>&nbsp;<span class="op" id="5489476">:=</span>&nbsp;<span class="ident" id="5489479">t</span><span class="op" id="5489480">.</span><span class="ident" id="5489481">text</span><span class="op" id="5489485">.</span><span class="ident" id="5489486">Clone</span><span class="op" id="5489491">(</span><span class="op" id="5489492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489495">if</span>&nbsp;<span class="ident" id="5489498">err</span>&nbsp;<span class="op" id="5489502">!=</span>&nbsp;<span class="ident" id="5489505">nil</span>&nbsp;<span class="op" id="5489509">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489513">return</span>&nbsp;<span class="ident" id="5489520">nil</span><span class="op" id="5489523">,</span>&nbsp;<span class="ident" id="5489525">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489533">ret</span>&nbsp;<span class="op" id="5489537">:=</span>&nbsp;<span class="op" id="5489540">&amp;</span><span class="ident" id="5489541">Template</span><span class="op" id="5489549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489553">nil</span><span class="op" id="5489556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489560">textClone</span><span class="op" id="5489569">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489573">textClone</span><span class="op" id="5489582">.</span><span class="ident" id="5489583">Tree</span><span class="op" id="5489587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489591">&amp;</span><span class="ident" id="5489592">nameSpace</span><span class="op" id="5489601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489606">set</span><span class="op" id="5489609">:</span>&nbsp;<span class="builtinfunc" id="5489611">make</span><span class="op" id="5489615">(</span><span class="keyword" id="5489616">map</span><span class="op" id="5489619">[</span><span class="builtintype" id="5489620">string</span><span class="op" id="5489626">]</span><span class="op" id="5489627">*</span><span class="ident" id="5489628">Template</span><span class="op" id="5489636">)</span><span class="op" id="5489637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489641">}</span><span class="op" id="5489642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489645">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489648">for</span>&nbsp;<span class="ident" id="5489652">_</span><span class="op" id="5489653">,</span>&nbsp;<span class="ident" id="5489655">x</span>&nbsp;<span class="op" id="5489657">:=</span>&nbsp;<span class="keyword" id="5489660">range</span>&nbsp;<span class="ident" id="5489666">textClone</span><span class="op" id="5489675">.</span><span class="ident" id="5489676">Templates</span><span class="op" id="5489685">(</span><span class="op" id="5489686">)</span>&nbsp;<span class="op" id="5489688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489692">name</span>&nbsp;<span class="op" id="5489697">:=</span>&nbsp;<span class="ident" id="5489700">x</span><span class="op" id="5489701">.</span><span class="ident" id="5489702">Name</span><span class="op" id="5489706">(</span><span class="op" id="5489707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489711">src</span>&nbsp;<span class="op" id="5489715">:=</span>&nbsp;<span class="ident" id="5489718">t</span><span class="op" id="5489719">.</span><span class="ident" id="5489720">set</span><span class="op" id="5489723">[</span><span class="ident" id="5489724">name</span><span class="op" id="5489728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489732">if</span>&nbsp;<span class="ident" id="5489735">src</span>&nbsp;<span class="op" id="5489739">==</span>&nbsp;<span class="ident" id="5489742">nil</span>&nbsp;<span class="op" id="5489746">||</span>&nbsp;<span class="ident" id="5489749">src</span><span class="op" id="5489752">.</span><span class="ident" id="5489753">escapeErr</span>&nbsp;<span class="op" id="5489763">!=</span>&nbsp;<span class="ident" id="5489766">nil</span>&nbsp;<span class="op" id="5489770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489775">return</span>&nbsp;<span class="ident" id="5489782">nil</span><span class="op" id="5489785">,</span>&nbsp;<span class="ident" id="5489787">fmt</span><span class="op" id="5489790">.</span><span class="ident" id="5489791">Errorf</span><span class="op" id="5489797">(</span><span class="string" id="5489798">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5489852">,</span>&nbsp;<span class="ident" id="5489854">t</span><span class="op" id="5489855">.</span><span class="ident" id="5489856">Name</span><span class="op" id="5489860">(</span><span class="op" id="5489861">)</span><span class="op" id="5489862">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489870">x</span><span class="op" id="5489871">.</span><span class="ident" id="5489872">Tree</span>&nbsp;<span class="op" id="5489877">=</span>&nbsp;<span class="ident" id="5489879">x</span><span class="op" id="5489880">.</span><span class="ident" id="5489881">Tree</span><span class="op" id="5489885">.</span><span class="ident" id="5489886">Copy</span><span class="op" id="5489890">(</span><span class="op" id="5489891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489895">ret</span><span class="op" id="5489898">.</span><span class="ident" id="5489899">set</span><span class="op" id="5489902">[</span><span class="ident" id="5489903">name</span><span class="op" id="5489907">]</span>&nbsp;<span class="op" id="5489909">=</span>&nbsp;<span class="op" id="5489911">&amp;</span><span class="ident" id="5489912">Template</span><span class="op" id="5489920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489925">nil</span><span class="op" id="5489928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489933">x</span><span class="op" id="5489934">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489939">x</span><span class="op" id="5489940">.</span><span class="ident" id="5489941">Tree</span><span class="op" id="5489945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489950">ret</span><span class="op" id="5489953">.</span><span class="ident" id="5489954">nameSpace</span><span class="op" id="5489963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489973">return</span>&nbsp;<span class="ident" id="5489980">ret</span><span class="op" id="5489983">,</span>&nbsp;<span class="ident" id="5489985">nil</span><br>
<span class="lineno">220</span><span class="op" id="5489989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5489992">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5490050">func</span>&nbsp;<span class="ident" id="5490055">New</span><span class="op" id="5490058">(</span><span class="ident" id="5490059">name</span>&nbsp;<span class="builtintype" id="5490064">string</span><span class="op" id="5490070">)</span>&nbsp;<span class="op" id="5490072">*</span><span class="ident" id="5490073">Template</span>&nbsp;<span class="op" id="5490082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490085">tmpl</span>&nbsp;<span class="op" id="5490090">:=</span>&nbsp;<span class="op" id="5490093">&amp;</span><span class="ident" id="5490094">Template</span><span class="op" id="5490102">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490106">nil</span><span class="op" id="5490109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490113">template</span><span class="op" id="5490121">.</span><span class="ident" id="5490122">New</span><span class="op" id="5490125">(</span><span class="ident" id="5490126">name</span><span class="op" id="5490130">)</span><span class="op" id="5490131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490135">nil</span><span class="op" id="5490138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490142">&amp;</span><span class="ident" id="5490143">nameSpace</span><span class="op" id="5490152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490157">set</span><span class="op" id="5490160">:</span>&nbsp;<span class="builtinfunc" id="5490162">make</span><span class="op" id="5490166">(</span><span class="keyword" id="5490167">map</span><span class="op" id="5490170">[</span><span class="builtintype" id="5490171">string</span><span class="op" id="5490177">]</span><span class="op" id="5490178">*</span><span class="ident" id="5490179">Template</span><span class="op" id="5490187">)</span><span class="op" id="5490188">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490192">}</span><span class="op" id="5490193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490199">tmpl</span><span class="op" id="5490203">.</span><span class="ident" id="5490204">set</span><span class="op" id="5490207">[</span><span class="ident" id="5490208">name</span><span class="op" id="5490212">]</span>&nbsp;<span class="op" id="5490214">=</span>&nbsp;<span class="ident" id="5490216">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490222">return</span>&nbsp;<span class="ident" id="5490229">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5490234">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5490237">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5490304">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5490375">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5490444">func</span>&nbsp;<span class="op" id="5490449">(</span><span class="ident" id="5490450">t</span>&nbsp;<span class="op" id="5490452">*</span><span class="ident" id="5490453">Template</span><span class="op" id="5490461">)</span>&nbsp;<span class="ident" id="5490463">New</span><span class="op" id="5490466">(</span><span class="ident" id="5490467">name</span>&nbsp;<span class="builtintype" id="5490472">string</span><span class="op" id="5490478">)</span>&nbsp;<span class="op" id="5490480">*</span><span class="ident" id="5490481">Template</span>&nbsp;<span class="op" id="5490490">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490493">t</span><span class="op" id="5490494">.</span><span class="ident" id="5490495">nameSpace</span><span class="op" id="5490504">.</span><span class="ident" id="5490505">mu</span><span class="op" id="5490507">.</span><span class="ident" id="5490508">Lock</span><span class="op" id="5490512">(</span><span class="op" id="5490513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490516">defer</span>&nbsp;<span class="ident" id="5490522">t</span><span class="op" id="5490523">.</span><span class="ident" id="5490524">nameSpace</span><span class="op" id="5490533">.</span><span class="ident" id="5490534">mu</span><span class="op" id="5490536">.</span><span class="ident" id="5490537">Unlock</span><span class="op" id="5490543">(</span><span class="op" id="5490544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490547">return</span>&nbsp;<span class="ident" id="5490554">t</span><span class="op" id="5490555">.</span><span class="builtinfunc" id="5490556">new</span><span class="op" id="5490559">(</span><span class="ident" id="5490560">name</span><span class="op" id="5490564">)</span><br>
<span class="lineno"></span><span class="op" id="5490566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5490569">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5490624">func</span>&nbsp;<span class="op" id="5490629">(</span><span class="ident" id="5490630">t</span>&nbsp;<span class="op" id="5490632">*</span><span class="ident" id="5490633">Template</span><span class="op" id="5490641">)</span>&nbsp;<span class="builtinfunc" id="5490643">new</span><span class="op" id="5490646">(</span><span class="ident" id="5490647">name</span>&nbsp;<span class="builtintype" id="5490652">string</span><span class="op" id="5490658">)</span>&nbsp;<span class="op" id="5490660">*</span><span class="ident" id="5490661">Template</span>&nbsp;<span class="op" id="5490670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490673">tmpl</span>&nbsp;<span class="op" id="5490678">:=</span>&nbsp;<span class="op" id="5490681">&amp;</span><span class="ident" id="5490682">Template</span><span class="op" id="5490690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490694">nil</span><span class="op" id="5490697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490701">t</span><span class="op" id="5490702">.</span><span class="ident" id="5490703">text</span><span class="op" id="5490707">.</span><span class="ident" id="5490708">New</span><span class="op" id="5490711">(</span><span class="ident" id="5490712">name</span><span class="op" id="5490716">)</span><span class="op" id="5490717">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490721">nil</span><span class="op" id="5490724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490728">t</span><span class="op" id="5490729">.</span><span class="ident" id="5490730">nameSpace</span><span class="op" id="5490739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490745">tmpl</span><span class="op" id="5490749">.</span><span class="ident" id="5490750">set</span><span class="op" id="5490753">[</span><span class="ident" id="5490754">name</span><span class="op" id="5490758">]</span>&nbsp;<span class="op" id="5490760">=</span>&nbsp;<span class="ident" id="5490762">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490768">return</span>&nbsp;<span class="ident" id="5490775">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5490780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5490783">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5490825">func</span>&nbsp;<span class="op" id="5490830">(</span><span class="ident" id="5490831">t</span>&nbsp;<span class="op" id="5490833">*</span><span class="ident" id="5490834">Template</span><span class="op" id="5490842">)</span>&nbsp;<span class="ident" id="5490844">Name</span><span class="op" id="5490848">(</span><span class="op" id="5490849">)</span>&nbsp;<span class="builtintype" id="5490851">string</span>&nbsp;<span class="op" id="5490858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490861">return</span>&nbsp;<span class="ident" id="5490868">t</span><span class="op" id="5490869">.</span><span class="ident" id="5490870">text</span><span class="op" id="5490874">.</span><span class="ident" id="5490875">Name</span><span class="op" id="5490879">(</span><span class="op" id="5490880">)</span><br>
<span class="lineno">260</span><span class="op" id="5490882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5490885">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5490954">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5491029">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5491103">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5491179">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5491256">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5491329">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5491349">type</span>&nbsp;<span class="ident" id="5491354">FuncMap</span>&nbsp;<span class="keyword" id="5491362">map</span><span class="op" id="5491365">[</span><span class="builtintype" id="5491366">string</span><span class="op" id="5491372">]</span><span class="keyword" id="5491373">interface</span><span class="op" id="5491382">{</span><span class="op" id="5491383">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5491386">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5491465">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5491542">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5491617">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5491668">func</span>&nbsp;<span class="op" id="5491673">(</span><span class="ident" id="5491674">t</span>&nbsp;<span class="op" id="5491676">*</span><span class="ident" id="5491677">Template</span><span class="op" id="5491685">)</span>&nbsp;<span class="ident" id="5491687">Funcs</span><span class="op" id="5491692">(</span><span class="ident" id="5491693">funcMap</span>&nbsp;<span class="ident" id="5491701">FuncMap</span><span class="op" id="5491708">)</span>&nbsp;<span class="op" id="5491710">*</span><span class="ident" id="5491711">Template</span>&nbsp;<span class="op" id="5491720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491723">t</span><span class="op" id="5491724">.</span><span class="ident" id="5491725">text</span><span class="op" id="5491729">.</span><span class="ident" id="5491730">Funcs</span><span class="op" id="5491735">(</span><span class="ident" id="5491736">template</span><span class="op" id="5491744">.</span><span class="ident" id="5491745">FuncMap</span><span class="op" id="5491752">(</span><span class="ident" id="5491753">funcMap</span><span class="op" id="5491760">)</span><span class="op" id="5491761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491764">return</span>&nbsp;<span class="ident" id="5491771">t</span><br>
<span class="lineno"></span><span class="op" id="5491773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5491776">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5491853">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5491925">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5492001">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5492037">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5492099">func</span>&nbsp;<span class="op" id="5492104">(</span><span class="ident" id="5492105">t</span>&nbsp;<span class="op" id="5492107">*</span><span class="ident" id="5492108">Template</span><span class="op" id="5492116">)</span>&nbsp;<span class="ident" id="5492118">Delims</span><span class="op" id="5492124">(</span><span class="ident" id="5492125">left</span><span class="op" id="5492129">,</span>&nbsp;<span class="ident" id="5492131">right</span>&nbsp;<span class="builtintype" id="5492137">string</span><span class="op" id="5492143">)</span>&nbsp;<span class="op" id="5492145">*</span><span class="ident" id="5492146">Template</span>&nbsp;<span class="op" id="5492155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492158">t</span><span class="op" id="5492159">.</span><span class="ident" id="5492160">text</span><span class="op" id="5492164">.</span><span class="ident" id="5492165">Delims</span><span class="op" id="5492171">(</span><span class="ident" id="5492172">left</span><span class="op" id="5492176">,</span>&nbsp;<span class="ident" id="5492178">right</span><span class="op" id="5492183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492186">return</span>&nbsp;<span class="ident" id="5492193">t</span><br>
<span class="lineno"></span><span class="op" id="5492195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5492198">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5492276">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5492316">func</span>&nbsp;<span class="op" id="5492321">(</span><span class="ident" id="5492322">t</span>&nbsp;<span class="op" id="5492324">*</span><span class="ident" id="5492325">Template</span><span class="op" id="5492333">)</span>&nbsp;<span class="ident" id="5492335">Lookup</span><span class="op" id="5492341">(</span><span class="ident" id="5492342">name</span>&nbsp;<span class="builtintype" id="5492347">string</span><span class="op" id="5492353">)</span>&nbsp;<span class="op" id="5492355">*</span><span class="ident" id="5492356">Template</span>&nbsp;<span class="op" id="5492365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492368">t</span><span class="op" id="5492369">.</span><span class="ident" id="5492370">nameSpace</span><span class="op" id="5492379">.</span><span class="ident" id="5492380">mu</span><span class="op" id="5492382">.</span><span class="ident" id="5492383">Lock</span><span class="op" id="5492387">(</span><span class="op" id="5492388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492391">defer</span>&nbsp;<span class="ident" id="5492397">t</span><span class="op" id="5492398">.</span><span class="ident" id="5492399">nameSpace</span><span class="op" id="5492408">.</span><span class="ident" id="5492409">mu</span><span class="op" id="5492411">.</span><span class="ident" id="5492412">Unlock</span><span class="op" id="5492418">(</span><span class="op" id="5492419">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492422">return</span>&nbsp;<span class="ident" id="5492429">t</span><span class="op" id="5492430">.</span><span class="ident" id="5492431">set</span><span class="op" id="5492434">[</span><span class="ident" id="5492435">name</span><span class="op" id="5492439">]</span><br>
<span class="lineno"></span><span class="op" id="5492441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5492444">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5492525">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5492615">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5492626">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5492687">func</span>&nbsp;<span class="ident" id="5492692">Must</span><span class="op" id="5492696">(</span><span class="ident" id="5492697">t</span>&nbsp;<span class="op" id="5492699">*</span><span class="ident" id="5492700">Template</span><span class="op" id="5492708">,</span>&nbsp;<span class="ident" id="5492710">err</span>&nbsp;<span class="builtintype" id="5492714">error</span><span class="op" id="5492719">)</span>&nbsp;<span class="op" id="5492721">*</span><span class="ident" id="5492722">Template</span>&nbsp;<span class="op" id="5492731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492734">if</span>&nbsp;<span class="ident" id="5492737">err</span>&nbsp;<span class="op" id="5492741">!=</span>&nbsp;<span class="ident" id="5492744">nil</span>&nbsp;<span class="op" id="5492748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5492752">panic</span><span class="op" id="5492757">(</span><span class="ident" id="5492758">err</span><span class="op" id="5492761">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492767">return</span>&nbsp;<span class="ident" id="5492774">t</span><br>
<span class="lineno"></span><span class="op" id="5492776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5492779">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5492857">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5492936">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5493009">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5493081">func</span>&nbsp;<span class="ident" id="5493086">ParseFiles</span><span class="op" id="5493096">(</span><span class="ident" id="5493097">filenames</span>&nbsp;<span class="op" id="5493107">...</span><span class="builtintype" id="5493110">string</span><span class="op" id="5493116">)</span>&nbsp;<span class="op" id="5493118">(</span><span class="op" id="5493119">*</span><span class="ident" id="5493120">Template</span><span class="op" id="5493128">,</span>&nbsp;<span class="builtintype" id="5493130">error</span><span class="op" id="5493135">)</span>&nbsp;<span class="op" id="5493137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493140">return</span>&nbsp;<span class="ident" id="5493147">parseFiles</span><span class="op" id="5493157">(</span><span class="ident" id="5493158">nil</span><span class="op" id="5493161">,</span>&nbsp;<span class="ident" id="5493163">filenames</span><span class="op" id="5493172">...</span><span class="op" id="5493175">)</span><br>
<span class="lineno">315</span><span class="op" id="5493177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5493180">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5493261">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5493335">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5493390">func</span>&nbsp;<span class="op" id="5493395">(</span><span class="ident" id="5493396">t</span>&nbsp;<span class="op" id="5493398">*</span><span class="ident" id="5493399">Template</span><span class="op" id="5493407">)</span>&nbsp;<span class="ident" id="5493409">ParseFiles</span><span class="op" id="5493419">(</span><span class="ident" id="5493420">filenames</span>&nbsp;<span class="op" id="5493430">...</span><span class="builtintype" id="5493433">string</span><span class="op" id="5493439">)</span>&nbsp;<span class="op" id="5493441">(</span><span class="op" id="5493442">*</span><span class="ident" id="5493443">Template</span><span class="op" id="5493451">,</span>&nbsp;<span class="builtintype" id="5493453">error</span><span class="op" id="5493458">)</span>&nbsp;<span class="op" id="5493460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493463">return</span>&nbsp;<span class="ident" id="5493470">parseFiles</span><span class="op" id="5493480">(</span><span class="ident" id="5493481">t</span><span class="op" id="5493482">,</span>&nbsp;<span class="ident" id="5493484">filenames</span><span class="op" id="5493493">...</span><span class="op" id="5493496">)</span><br>
<span class="lineno"></span><span class="op" id="5493498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5493501">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5493574">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5493629">func</span>&nbsp;<span class="ident" id="5493634">parseFiles</span><span class="op" id="5493644">(</span><span class="ident" id="5493645">t</span>&nbsp;<span class="op" id="5493647">*</span><span class="ident" id="5493648">Template</span><span class="op" id="5493656">,</span>&nbsp;<span class="ident" id="5493658">filenames</span>&nbsp;<span class="op" id="5493668">...</span><span class="builtintype" id="5493671">string</span><span class="op" id="5493677">)</span>&nbsp;<span class="op" id="5493679">(</span><span class="op" id="5493680">*</span><span class="ident" id="5493681">Template</span><span class="op" id="5493689">,</span>&nbsp;<span class="builtintype" id="5493691">error</span><span class="op" id="5493696">)</span>&nbsp;<span class="op" id="5493698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493701">if</span>&nbsp;<span class="builtinfunc" id="5493704">len</span><span class="op" id="5493707">(</span><span class="ident" id="5493708">filenames</span><span class="op" id="5493717">)</span>&nbsp;<span class="op" id="5493719">==</span>&nbsp;<span class="num" id="5493722">0</span>&nbsp;<span class="op" id="5493724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5493728">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493774">return</span>&nbsp;<span class="ident" id="5493781">nil</span><span class="op" id="5493784">,</span>&nbsp;<span class="ident" id="5493786">fmt</span><span class="op" id="5493789">.</span><span class="ident" id="5493790">Errorf</span><span class="op" id="5493796">(</span><span class="string" id="5493797">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5493850">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493856">for</span>&nbsp;<span class="ident" id="5493860">_</span><span class="op" id="5493861">,</span>&nbsp;<span class="ident" id="5493863">filename</span>&nbsp;<span class="op" id="5493872">:=</span>&nbsp;<span class="keyword" id="5493875">range</span>&nbsp;<span class="ident" id="5493881">filenames</span>&nbsp;<span class="op" id="5493891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493895">b</span><span class="op" id="5493896">,</span>&nbsp;<span class="ident" id="5493898">err</span>&nbsp;<span class="op" id="5493902">:=</span>&nbsp;<span class="ident" id="5493905">ioutil</span><span class="op" id="5493911">.</span><span class="ident" id="5493912">ReadFile</span><span class="op" id="5493920">(</span><span class="ident" id="5493921">filename</span><span class="op" id="5493929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493933">if</span>&nbsp;<span class="ident" id="5493936">err</span>&nbsp;<span class="op" id="5493940">!=</span>&nbsp;<span class="ident" id="5493943">nil</span>&nbsp;<span class="op" id="5493947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493952">return</span>&nbsp;<span class="ident" id="5493959">nil</span><span class="op" id="5493962">,</span>&nbsp;<span class="ident" id="5493964">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493974">s</span>&nbsp;<span class="op" id="5493976">:=</span>&nbsp;<span class="builtintype" id="5493979">string</span><span class="op" id="5493985">(</span><span class="ident" id="5493986">b</span><span class="op" id="5493987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493991">name</span>&nbsp;<span class="op" id="5493996">:=</span>&nbsp;<span class="ident" id="5493999">filepath</span><span class="op" id="5494007">.</span><span class="ident" id="5494008">Base</span><span class="op" id="5494012">(</span><span class="ident" id="5494013">filename</span><span class="op" id="5494021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494025">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494090">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494153">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494223">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494274">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5494328">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494394">var</span>&nbsp;<span class="ident" id="5494398">tmpl</span>&nbsp;<span class="op" id="5494403">*</span><span class="ident" id="5494404">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494415">if</span>&nbsp;<span class="ident" id="5494418">t</span>&nbsp;<span class="op" id="5494420">==</span>&nbsp;<span class="ident" id="5494423">nil</span>&nbsp;<span class="op" id="5494427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5494432">t</span>&nbsp;<span class="op" id="5494434">=</span>&nbsp;<span class="ident" id="5494436">New</span><span class="op" id="5494439">(</span><span class="ident" id="5494440">name</span><span class="op" id="5494444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5494448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494452">if</span>&nbsp;<span class="ident" id="5494455">name</span>&nbsp;<span class="op" id="5494460">==</span>&nbsp;<span class="ident" id="5494463">t</span><span class="op" id="5494464">.</span><span class="ident" id="5494465">Name</span><span class="op" id="5494469">(</span><span class="op" id="5494470">)</span>&nbsp;<span class="op" id="5494472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5494477">tmpl</span>&nbsp;<span class="op" id="5494482">=</span>&nbsp;<span class="ident" id="5494484">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5494488">}</span>&nbsp;<span class="keyword" id="5494490">else</span>&nbsp;<span class="op" id="5494495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5494500">tmpl</span>&nbsp;<span class="op" id="5494505">=</span>&nbsp;<span class="ident" id="5494507">t</span><span class="op" id="5494508">.</span><span class="ident" id="5494509">New</span><span class="op" id="5494512">(</span><span class="ident" id="5494513">name</span><span class="op" id="5494517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5494521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5494525">_</span><span class="op" id="5494526">,</span>&nbsp;<span class="ident" id="5494528">err</span>&nbsp;<span class="op" id="5494532">=</span>&nbsp;<span class="ident" id="5494534">tmpl</span><span class="op" id="5494538">.</span><span class="ident" id="5494539">Parse</span><span class="op" id="5494544">(</span><span class="ident" id="5494545">s</span><span class="op" id="5494546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494550">if</span>&nbsp;<span class="ident" id="5494553">err</span>&nbsp;<span class="op" id="5494557">!=</span>&nbsp;<span class="ident" id="5494560">nil</span>&nbsp;<span class="op" id="5494564">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494569">return</span>&nbsp;<span class="ident" id="5494576">nil</span><span class="op" id="5494579">,</span>&nbsp;<span class="ident" id="5494581">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5494587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5494590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5494593">return</span>&nbsp;<span class="ident" id="5494600">t</span><span class="op" id="5494601">,</span>&nbsp;<span class="ident" id="5494603">nil</span><br>
<span class="lineno"></span><span class="op" id="5494607">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5494610">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5494691">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5494767">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5494843">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5494916">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5494977">func</span>&nbsp;<span class="ident" id="5494982">ParseGlob</span><span class="op" id="5494991">(</span><span class="ident" id="5494992">pattern</span>&nbsp;<span class="builtintype" id="5495000">string</span><span class="op" id="5495006">)</span>&nbsp;<span class="op" id="5495008">(</span><span class="op" id="5495009">*</span><span class="ident" id="5495010">Template</span><span class="op" id="5495018">,</span>&nbsp;<span class="builtintype" id="5495020">error</span><span class="op" id="5495025">)</span>&nbsp;<span class="op" id="5495027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495030">return</span>&nbsp;<span class="ident" id="5495037">parseGlob</span><span class="op" id="5495046">(</span><span class="ident" id="5495047">nil</span><span class="op" id="5495050">,</span>&nbsp;<span class="ident" id="5495052">pattern</span><span class="op" id="5495059">)</span><br>
<span class="lineno"></span><span class="op" id="5495061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5495064">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5495140">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5495213">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5495290">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5495366">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5495378">func</span>&nbsp;<span class="op" id="5495383">(</span><span class="ident" id="5495384">t</span>&nbsp;<span class="op" id="5495386">*</span><span class="ident" id="5495387">Template</span><span class="op" id="5495395">)</span>&nbsp;<span class="ident" id="5495397">ParseGlob</span><span class="op" id="5495406">(</span><span class="ident" id="5495407">pattern</span>&nbsp;<span class="builtintype" id="5495415">string</span><span class="op" id="5495421">)</span>&nbsp;<span class="op" id="5495423">(</span><span class="op" id="5495424">*</span><span class="ident" id="5495425">Template</span><span class="op" id="5495433">,</span>&nbsp;<span class="builtintype" id="5495435">error</span><span class="op" id="5495440">)</span>&nbsp;<span class="op" id="5495442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495445">return</span>&nbsp;<span class="ident" id="5495452">parseGlob</span><span class="op" id="5495461">(</span><span class="ident" id="5495462">t</span><span class="op" id="5495463">,</span>&nbsp;<span class="ident" id="5495465">pattern</span><span class="op" id="5495472">)</span><br>
<span class="lineno"></span><span class="op" id="5495474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5495477">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5495550">func</span>&nbsp;<span class="ident" id="5495555">parseGlob</span><span class="op" id="5495564">(</span><span class="ident" id="5495565">t</span>&nbsp;<span class="op" id="5495567">*</span><span class="ident" id="5495568">Template</span><span class="op" id="5495576">,</span>&nbsp;<span class="ident" id="5495578">pattern</span>&nbsp;<span class="builtintype" id="5495586">string</span><span class="op" id="5495592">)</span>&nbsp;<span class="op" id="5495594">(</span><span class="op" id="5495595">*</span><span class="ident" id="5495596">Template</span><span class="op" id="5495604">,</span>&nbsp;<span class="builtintype" id="5495606">error</span><span class="op" id="5495611">)</span>&nbsp;<span class="op" id="5495613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5495616">filenames</span><span class="op" id="5495625">,</span>&nbsp;<span class="ident" id="5495627">err</span>&nbsp;<span class="op" id="5495631">:=</span>&nbsp;<span class="ident" id="5495634">filepath</span><span class="op" id="5495642">.</span><span class="ident" id="5495643">Glob</span><span class="op" id="5495647">(</span><span class="ident" id="5495648">pattern</span><span class="op" id="5495655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495658">if</span>&nbsp;<span class="ident" id="5495661">err</span>&nbsp;<span class="op" id="5495665">!=</span>&nbsp;<span class="ident" id="5495668">nil</span>&nbsp;<span class="op" id="5495672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495676">return</span>&nbsp;<span class="ident" id="5495683">nil</span><span class="op" id="5495686">,</span>&nbsp;<span class="ident" id="5495688">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5495693">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495696">if</span>&nbsp;<span class="builtinfunc" id="5495699">len</span><span class="op" id="5495702">(</span><span class="ident" id="5495703">filenames</span><span class="op" id="5495712">)</span>&nbsp;<span class="op" id="5495714">==</span>&nbsp;<span class="num" id="5495717">0</span>&nbsp;<span class="op" id="5495719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495723">return</span>&nbsp;<span class="ident" id="5495730">nil</span><span class="op" id="5495733">,</span>&nbsp;<span class="ident" id="5495735">fmt</span><span class="op" id="5495738">.</span><span class="ident" id="5495739">Errorf</span><span class="op" id="5495745">(</span><span class="string" id="5495746">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5495792">,</span>&nbsp;<span class="ident" id="5495794">pattern</span><span class="op" id="5495801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5495804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5495807">return</span>&nbsp;<span class="ident" id="5495814">parseFiles</span><span class="op" id="5495824">(</span><span class="ident" id="5495825">t</span><span class="op" id="5495826">,</span>&nbsp;<span class="ident" id="5495828">filenames</span><span class="op" id="5495837">...</span><span class="op" id="5495840">)</span><br>
<span class="lineno"></span><span class="op" id="5495842">}</span>
</div>
</body>
</html>
