<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6248084">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6248140">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6248194">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6248245">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6248313">package</span>&nbsp;<span class="ident" id="6248321">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6248331">import</span>&nbsp;<span class="op" id="6248338">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6248341">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6248360">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6248370">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6248377">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6248383">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6248388">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6248391">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6248446">type</span>&nbsp;<span class="ident" id="6248451">FileHeader</span>&nbsp;<span class="keyword" id="6248462">struct</span>&nbsp;<span class="op" id="6248469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248472">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248484">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248492">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248504">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248512">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6248524">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248532">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248544">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248549">LoadAddress</span>&nbsp;<span class="ident" id="6248561">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248569">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6248581">uint64</span><br>
<span class="lineno"></span><span class="op" id="6248588">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6248591">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6248639">type</span>&nbsp;<span class="ident" id="6248644">File</span>&nbsp;<span class="keyword" id="6248649">struct</span>&nbsp;<span class="op" id="6248656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248659">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248671">Sections</span>&nbsp;<span class="op" id="6248680">[</span><span class="op" id="6248681">]</span><span class="op" id="6248682">*</span><span class="ident" id="6248683">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248692">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6248701">io</span><span class="op" id="6248703">.</span><span class="ident" id="6248704">Closer</span><br>
<span class="lineno"></span><span class="op" id="6248711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6248714">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6248782">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6248844">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6248872">type</span>&nbsp;<span class="ident" id="6248877">SectionHeader</span>&nbsp;<span class="keyword" id="6248891">struct</span>&nbsp;<span class="op" id="6248898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248901">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248908">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248916">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248923">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248931">Offset</span>&nbsp;<span class="builtintype" id="6248938">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6248945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6248948">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6249013">type</span>&nbsp;<span class="ident" id="6249018">Section</span>&nbsp;<span class="keyword" id="6249026">struct</span>&nbsp;<span class="op" id="6249033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249036">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249052">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249090">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249130">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249165">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249213">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249263">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249287">io</span><span class="op" id="6249289">.</span><span class="ident" id="6249290">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249300">sr</span>&nbsp;<span class="op" id="6249303">*</span><span class="ident" id="6249304">io</span><span class="op" id="6249306">.</span><span class="ident" id="6249307">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6249321">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6249324">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6249392">func</span>&nbsp;<span class="op" id="6249397">(</span><span class="ident" id="6249398">s</span>&nbsp;<span class="op" id="6249400">*</span><span class="ident" id="6249401">Section</span><span class="op" id="6249408">)</span>&nbsp;<span class="ident" id="6249410">Data</span><span class="op" id="6249414">(</span><span class="op" id="6249415">)</span>&nbsp;<span class="op" id="6249417">(</span><span class="op" id="6249418">[</span><span class="op" id="6249419">]</span><span class="builtintype" id="6249420">byte</span><span class="op" id="6249424">,</span>&nbsp;<span class="builtintype" id="6249426">error</span><span class="op" id="6249431">)</span>&nbsp;<span class="op" id="6249433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249436">dat</span>&nbsp;<span class="op" id="6249440">:=</span>&nbsp;<span class="builtinfunc" id="6249443">make</span><span class="op" id="6249447">(</span><span class="op" id="6249448">[</span><span class="op" id="6249449">]</span><span class="builtintype" id="6249450">byte</span><span class="op" id="6249454">,</span>&nbsp;<span class="ident" id="6249456">s</span><span class="op" id="6249457">.</span><span class="ident" id="6249458">sr</span><span class="op" id="6249460">.</span><span class="ident" id="6249461">Size</span><span class="op" id="6249465">(</span><span class="op" id="6249466">)</span><span class="op" id="6249467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249470">n</span><span class="op" id="6249471">,</span>&nbsp;<span class="ident" id="6249473">err</span>&nbsp;<span class="op" id="6249477">:=</span>&nbsp;<span class="ident" id="6249480">s</span><span class="op" id="6249481">.</span><span class="ident" id="6249482">sr</span><span class="op" id="6249484">.</span><span class="ident" id="6249485">ReadAt</span><span class="op" id="6249491">(</span><span class="ident" id="6249492">dat</span><span class="op" id="6249495">,</span>&nbsp;<span class="num" id="6249497">0</span><span class="op" id="6249498">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249501">if</span>&nbsp;<span class="ident" id="6249504">n</span>&nbsp;<span class="op" id="6249506">==</span>&nbsp;<span class="builtinfunc" id="6249509">len</span><span class="op" id="6249512">(</span><span class="ident" id="6249513">dat</span><span class="op" id="6249516">)</span>&nbsp;<span class="op" id="6249518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249522">err</span>&nbsp;<span class="op" id="6249526">=</span>&nbsp;<span class="ident" id="6249528">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249536">return</span>&nbsp;<span class="ident" id="6249543">dat</span><span class="op" id="6249546">[</span><span class="num" id="6249547">0</span><span class="op" id="6249548">:</span><span class="ident" id="6249549">n</span><span class="op" id="6249550">]</span><span class="op" id="6249551">,</span>&nbsp;<span class="ident" id="6249553">err</span><br>
<span class="lineno"></span><span class="op" id="6249557">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6249560">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6249627">func</span>&nbsp;<span class="op" id="6249632">(</span><span class="ident" id="6249633">s</span>&nbsp;<span class="op" id="6249635">*</span><span class="ident" id="6249636">Section</span><span class="op" id="6249643">)</span>&nbsp;<span class="ident" id="6249645">Open</span><span class="op" id="6249649">(</span><span class="op" id="6249650">)</span>&nbsp;<span class="ident" id="6249652">io</span><span class="op" id="6249654">.</span><span class="ident" id="6249655">ReadSeeker</span>&nbsp;<span class="op" id="6249666">{</span>&nbsp;<span class="keyword" id="6249668">return</span>&nbsp;<span class="ident" id="6249675">io</span><span class="op" id="6249677">.</span><span class="ident" id="6249678">NewSectionReader</span><span class="op" id="6249694">(</span><span class="ident" id="6249695">s</span><span class="op" id="6249696">.</span><span class="ident" id="6249697">sr</span><span class="op" id="6249699">,</span>&nbsp;<span class="num" id="6249701">0</span><span class="op" id="6249702">,</span>&nbsp;<span class="num" id="6249704">1</span><span class="op" id="6249705">&lt;&lt;</span><span class="num" id="6249707">63</span><span class="op" id="6249709">-</span><span class="num" id="6249710">1</span><span class="op" id="6249711">)</span>&nbsp;<span class="op" id="6249713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6249716">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6249788">type</span>&nbsp;<span class="ident" id="6249793">Sym</span>&nbsp;<span class="keyword" id="6249797">struct</span>&nbsp;<span class="op" id="6249804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249807">Value</span>&nbsp;<span class="ident" id="6249813">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249821">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6249827">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249833">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6249839">string</span><br>
<span class="lineno"></span><span class="op" id="6249846">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6249849">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6249880">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6249943">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6249994">type</span>&nbsp;<span class="ident" id="6249999">formatError</span>&nbsp;<span class="keyword" id="6250011">struct</span>&nbsp;<span class="op" id="6250018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250021">off</span>&nbsp;<span class="builtintype" id="6250025">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250030">msg</span>&nbsp;<span class="builtintype" id="6250034">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250042">val</span>&nbsp;<span class="keyword" id="6250046">interface</span><span class="op" id="6250055">{</span><span class="op" id="6250056">}</span><br>
<span class="lineno"></span><span class="op" id="6250058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6250061">func</span>&nbsp;<span class="op" id="6250066">(</span><span class="ident" id="6250067">e</span>&nbsp;<span class="op" id="6250069">*</span><span class="ident" id="6250070">formatError</span><span class="op" id="6250081">)</span>&nbsp;<span class="ident" id="6250083">Error</span><span class="op" id="6250088">(</span><span class="op" id="6250089">)</span>&nbsp;<span class="builtintype" id="6250091">string</span>&nbsp;<span class="op" id="6250098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250101">msg</span>&nbsp;<span class="op" id="6250105">:=</span>&nbsp;<span class="ident" id="6250108">e</span><span class="op" id="6250109">.</span><span class="ident" id="6250110">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250115">if</span>&nbsp;<span class="ident" id="6250118">e</span><span class="op" id="6250119">.</span><span class="ident" id="6250120">val</span>&nbsp;<span class="op" id="6250124">!=</span>&nbsp;<span class="ident" id="6250127">nil</span>&nbsp;<span class="op" id="6250131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250135">msg</span>&nbsp;<span class="op" id="6250139">+=</span>&nbsp;<span class="ident" id="6250142">fmt</span><span class="op" id="6250145">.</span><span class="ident" id="6250146">Sprintf</span><span class="op" id="6250153">(</span><span class="string" id="6250154">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6250161">,</span>&nbsp;<span class="ident" id="6250163">e</span><span class="op" id="6250164">.</span><span class="ident" id="6250165">val</span><span class="op" id="6250168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250174">msg</span>&nbsp;<span class="op" id="6250178">+=</span>&nbsp;<span class="ident" id="6250181">fmt</span><span class="op" id="6250184">.</span><span class="ident" id="6250185">Sprintf</span><span class="op" id="6250192">(</span><span class="string" id="6250193">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6250217">,</span>&nbsp;<span class="ident" id="6250219">e</span><span class="op" id="6250220">.</span><span class="ident" id="6250221">off</span><span class="op" id="6250224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250227">return</span>&nbsp;<span class="ident" id="6250234">msg</span><br>
<span class="lineno">95</span><span class="op" id="6250238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6250241">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6250334">func</span>&nbsp;<span class="ident" id="6250339">Open</span><span class="op" id="6250343">(</span><span class="ident" id="6250344">name</span>&nbsp;<span class="builtintype" id="6250349">string</span><span class="op" id="6250355">)</span>&nbsp;<span class="op" id="6250357">(</span><span class="op" id="6250358">*</span><span class="ident" id="6250359">File</span><span class="op" id="6250363">,</span>&nbsp;<span class="builtintype" id="6250365">error</span><span class="op" id="6250370">)</span>&nbsp;<span class="op" id="6250372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250375">f</span><span class="op" id="6250376">,</span>&nbsp;<span class="ident" id="6250378">err</span>&nbsp;<span class="op" id="6250382">:=</span>&nbsp;<span class="ident" id="6250385">os</span><span class="op" id="6250387">.</span><span class="ident" id="6250388">Open</span><span class="op" id="6250392">(</span><span class="ident" id="6250393">name</span><span class="op" id="6250397">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250400">if</span>&nbsp;<span class="ident" id="6250403">err</span>&nbsp;<span class="op" id="6250407">!=</span>&nbsp;<span class="ident" id="6250410">nil</span>&nbsp;<span class="op" id="6250414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250418">return</span>&nbsp;<span class="ident" id="6250425">nil</span><span class="op" id="6250428">,</span>&nbsp;<span class="ident" id="6250430">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250438">ff</span><span class="op" id="6250440">,</span>&nbsp;<span class="ident" id="6250442">err</span>&nbsp;<span class="op" id="6250446">:=</span>&nbsp;<span class="ident" id="6250449">NewFile</span><span class="op" id="6250456">(</span><span class="ident" id="6250457">f</span><span class="op" id="6250458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250461">if</span>&nbsp;<span class="ident" id="6250464">err</span>&nbsp;<span class="op" id="6250468">!=</span>&nbsp;<span class="ident" id="6250471">nil</span>&nbsp;<span class="op" id="6250475">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250479">f</span><span class="op" id="6250480">.</span><span class="ident" id="6250481">Close</span><span class="op" id="6250486">(</span><span class="op" id="6250487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250491">return</span>&nbsp;<span class="ident" id="6250498">nil</span><span class="op" id="6250501">,</span>&nbsp;<span class="ident" id="6250503">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250511">ff</span><span class="op" id="6250513">.</span><span class="ident" id="6250514">closer</span>&nbsp;<span class="op" id="6250521">=</span>&nbsp;<span class="ident" id="6250523">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250526">return</span>&nbsp;<span class="ident" id="6250533">ff</span><span class="op" id="6250535">,</span>&nbsp;<span class="ident" id="6250537">nil</span><br>
<span class="lineno">110</span><span class="op" id="6250541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6250544">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6250570">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6250637">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6250661">func</span>&nbsp;<span class="op" id="6250666">(</span><span class="ident" id="6250667">f</span>&nbsp;<span class="op" id="6250669">*</span><span class="ident" id="6250670">File</span><span class="op" id="6250674">)</span>&nbsp;<span class="ident" id="6250676">Close</span><span class="op" id="6250681">(</span><span class="op" id="6250682">)</span>&nbsp;<span class="builtintype" id="6250684">error</span>&nbsp;<span class="op" id="6250690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250693">var</span>&nbsp;<span class="ident" id="6250697">err</span>&nbsp;<span class="builtintype" id="6250701">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250708">if</span>&nbsp;<span class="ident" id="6250711">f</span><span class="op" id="6250712">.</span><span class="ident" id="6250713">closer</span>&nbsp;<span class="op" id="6250720">!=</span>&nbsp;<span class="ident" id="6250723">nil</span>&nbsp;<span class="op" id="6250727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250731">err</span>&nbsp;<span class="op" id="6250735">=</span>&nbsp;<span class="ident" id="6250737">f</span><span class="op" id="6250738">.</span><span class="ident" id="6250739">closer</span><span class="op" id="6250745">.</span><span class="ident" id="6250746">Close</span><span class="op" id="6250751">(</span><span class="op" id="6250752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250756">f</span><span class="op" id="6250757">.</span><span class="ident" id="6250758">closer</span>&nbsp;<span class="op" id="6250765">=</span>&nbsp;<span class="ident" id="6250767">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250775">return</span>&nbsp;<span class="ident" id="6250782">err</span><br>
<span class="lineno"></span><span class="op" id="6250786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6250789">func</span>&nbsp;<span class="ident" id="6250794">parseMagic</span><span class="op" id="6250804">(</span><span class="ident" id="6250805">magic</span>&nbsp;<span class="op" id="6250811">[</span><span class="op" id="6250812">]</span><span class="builtintype" id="6250813">byte</span><span class="op" id="6250817">)</span>&nbsp;<span class="op" id="6250819">(</span><span class="builtintype" id="6250820">uint32</span><span class="op" id="6250826">,</span>&nbsp;<span class="builtintype" id="6250828">error</span><span class="op" id="6250833">)</span>&nbsp;<span class="op" id="6250835">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250838">m</span>&nbsp;<span class="op" id="6250840">:=</span>&nbsp;<span class="ident" id="6250843">binary</span><span class="op" id="6250849">.</span><span class="ident" id="6250850">BigEndian</span><span class="op" id="6250859">.</span><span class="ident" id="6250860">Uint32</span><span class="op" id="6250866">(</span><span class="ident" id="6250867">magic</span><span class="op" id="6250872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250875">switch</span>&nbsp;<span class="ident" id="6250882">m</span>&nbsp;<span class="op" id="6250884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250887">case</span>&nbsp;<span class="ident" id="6250892">Magic386</span><span class="op" id="6250900">,</span>&nbsp;<span class="ident" id="6250902">MagicAMD64</span><span class="op" id="6250912">,</span>&nbsp;<span class="ident" id="6250914">MagicARM</span><span class="op" id="6250922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250926">return</span>&nbsp;<span class="ident" id="6250933">m</span><span class="op" id="6250934">,</span>&nbsp;<span class="ident" id="6250936">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250941">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250944">return</span>&nbsp;<span class="num" id="6250951">0</span><span class="op" id="6250952">,</span>&nbsp;<span class="op" id="6250954">&amp;</span><span class="ident" id="6250955">formatError</span><span class="op" id="6250966">{</span><span class="num" id="6250967">0</span><span class="op" id="6250968">,</span>&nbsp;<span class="string" id="6250970">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6250988">,</span>&nbsp;<span class="ident" id="6250990">magic</span><span class="op" id="6250995">}</span><br>
<span class="lineno"></span><span class="op" id="6250997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251000">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6251085">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6251158">func</span>&nbsp;<span class="ident" id="6251163">NewFile</span><span class="op" id="6251170">(</span><span class="ident" id="6251171">r</span>&nbsp;<span class="ident" id="6251173">io</span><span class="op" id="6251175">.</span><span class="ident" id="6251176">ReaderAt</span><span class="op" id="6251184">)</span>&nbsp;<span class="op" id="6251186">(</span><span class="op" id="6251187">*</span><span class="ident" id="6251188">File</span><span class="op" id="6251192">,</span>&nbsp;<span class="builtintype" id="6251194">error</span><span class="op" id="6251199">)</span>&nbsp;<span class="op" id="6251201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251204">sr</span>&nbsp;<span class="op" id="6251207">:=</span>&nbsp;<span class="ident" id="6251210">io</span><span class="op" id="6251212">.</span><span class="ident" id="6251213">NewSectionReader</span><span class="op" id="6251229">(</span><span class="ident" id="6251230">r</span><span class="op" id="6251231">,</span>&nbsp;<span class="num" id="6251233">0</span><span class="op" id="6251234">,</span>&nbsp;<span class="num" id="6251236">1</span><span class="op" id="6251237">&lt;&lt;</span><span class="num" id="6251239">63</span><span class="op" id="6251241">-</span><span class="num" id="6251242">1</span><span class="op" id="6251243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6251246">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251279">var</span>&nbsp;<span class="ident" id="6251283">magic</span>&nbsp;<span class="op" id="6251289">[</span><span class="num" id="6251290">4</span><span class="op" id="6251291">]</span><span class="builtintype" id="6251292">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251298">if</span>&nbsp;<span class="ident" id="6251301">_</span><span class="op" id="6251302">,</span>&nbsp;<span class="ident" id="6251304">err</span>&nbsp;<span class="op" id="6251308">:=</span>&nbsp;<span class="ident" id="6251311">r</span><span class="op" id="6251312">.</span><span class="ident" id="6251313">ReadAt</span><span class="op" id="6251319">(</span><span class="ident" id="6251320">magic</span><span class="op" id="6251325">[</span><span class="op" id="6251326">:</span><span class="op" id="6251327">]</span><span class="op" id="6251328">,</span>&nbsp;<span class="num" id="6251330">0</span><span class="op" id="6251331">)</span><span class="op" id="6251332">;</span>&nbsp;<span class="ident" id="6251334">err</span>&nbsp;<span class="op" id="6251338">!=</span>&nbsp;<span class="ident" id="6251341">nil</span>&nbsp;<span class="op" id="6251345">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251349">return</span>&nbsp;<span class="ident" id="6251356">nil</span><span class="op" id="6251359">,</span>&nbsp;<span class="ident" id="6251361">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251369">_</span><span class="op" id="6251370">,</span>&nbsp;<span class="ident" id="6251372">err</span>&nbsp;<span class="op" id="6251376">:=</span>&nbsp;<span class="ident" id="6251379">parseMagic</span><span class="op" id="6251389">(</span><span class="ident" id="6251390">magic</span><span class="op" id="6251395">[</span><span class="op" id="6251396">:</span><span class="op" id="6251397">]</span><span class="op" id="6251398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251401">if</span>&nbsp;<span class="ident" id="6251404">err</span>&nbsp;<span class="op" id="6251408">!=</span>&nbsp;<span class="ident" id="6251411">nil</span>&nbsp;<span class="op" id="6251415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251419">return</span>&nbsp;<span class="ident" id="6251426">nil</span><span class="op" id="6251429">,</span>&nbsp;<span class="ident" id="6251431">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251440">ph</span>&nbsp;<span class="op" id="6251443">:=</span>&nbsp;<span class="builtinfunc" id="6251446">new</span><span class="op" id="6251449">(</span><span class="ident" id="6251450">prog</span><span class="op" id="6251454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251457">if</span>&nbsp;<span class="ident" id="6251460">err</span>&nbsp;<span class="op" id="6251464">:=</span>&nbsp;<span class="ident" id="6251467">binary</span><span class="op" id="6251473">.</span><span class="ident" id="6251474">Read</span><span class="op" id="6251478">(</span><span class="ident" id="6251479">sr</span><span class="op" id="6251481">,</span>&nbsp;<span class="ident" id="6251483">binary</span><span class="op" id="6251489">.</span><span class="ident" id="6251490">BigEndian</span><span class="op" id="6251499">,</span>&nbsp;<span class="ident" id="6251501">ph</span><span class="op" id="6251503">)</span><span class="op" id="6251504">;</span>&nbsp;<span class="ident" id="6251506">err</span>&nbsp;<span class="op" id="6251510">!=</span>&nbsp;<span class="ident" id="6251513">nil</span>&nbsp;<span class="op" id="6251517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251521">return</span>&nbsp;<span class="ident" id="6251528">nil</span><span class="op" id="6251531">,</span>&nbsp;<span class="ident" id="6251533">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251542">f</span>&nbsp;<span class="op" id="6251544">:=</span>&nbsp;<span class="op" id="6251547">&amp;</span><span class="ident" id="6251548">File</span><span class="op" id="6251552">{</span><span class="ident" id="6251553">FileHeader</span><span class="op" id="6251563">:</span>&nbsp;<span class="ident" id="6251565">FileHeader</span><span class="op" id="6251575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251579">Magic</span><span class="op" id="6251584">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251592">ph</span><span class="op" id="6251594">.</span><span class="ident" id="6251595">Magic</span><span class="op" id="6251600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251604">Bss</span><span class="op" id="6251607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251617">ph</span><span class="op" id="6251619">.</span><span class="ident" id="6251620">Bss</span><span class="op" id="6251623">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251627">Entry</span><span class="op" id="6251632">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6251640">uint64</span><span class="op" id="6251646">(</span><span class="ident" id="6251647">ph</span><span class="op" id="6251649">.</span><span class="ident" id="6251650">Entry</span><span class="op" id="6251655">)</span><span class="op" id="6251656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251660">PtrSize</span><span class="op" id="6251667">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6251673">4</span><span class="op" id="6251674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251678">LoadAddress</span><span class="op" id="6251689">:</span>&nbsp;<span class="num" id="6251691">0x1000</span><span class="op" id="6251697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251701">HdrSize</span><span class="op" id="6251708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6251714">4</span>&nbsp;<span class="op" id="6251716">*</span>&nbsp;<span class="num" id="6251718">8</span><span class="op" id="6251719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251722">}</span><span class="op" id="6251723">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251727">if</span>&nbsp;<span class="ident" id="6251730">ph</span><span class="op" id="6251732">.</span><span class="ident" id="6251733">Magic</span><span class="op" id="6251738">&amp;</span><span class="ident" id="6251739">Magic64</span>&nbsp;<span class="op" id="6251747">!=</span>&nbsp;<span class="num" id="6251750">0</span>&nbsp;<span class="op" id="6251752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251756">if</span>&nbsp;<span class="ident" id="6251759">err</span>&nbsp;<span class="op" id="6251763">:=</span>&nbsp;<span class="ident" id="6251766">binary</span><span class="op" id="6251772">.</span><span class="ident" id="6251773">Read</span><span class="op" id="6251777">(</span><span class="ident" id="6251778">sr</span><span class="op" id="6251780">,</span>&nbsp;<span class="ident" id="6251782">binary</span><span class="op" id="6251788">.</span><span class="ident" id="6251789">BigEndian</span><span class="op" id="6251798">,</span>&nbsp;<span class="op" id="6251800">&amp;</span><span class="ident" id="6251801">f</span><span class="op" id="6251802">.</span><span class="ident" id="6251803">Entry</span><span class="op" id="6251808">)</span><span class="op" id="6251809">;</span>&nbsp;<span class="ident" id="6251811">err</span>&nbsp;<span class="op" id="6251815">!=</span>&nbsp;<span class="ident" id="6251818">nil</span>&nbsp;<span class="op" id="6251822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251827">return</span>&nbsp;<span class="ident" id="6251834">nil</span><span class="op" id="6251837">,</span>&nbsp;<span class="ident" id="6251839">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251845">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251849">f</span><span class="op" id="6251850">.</span><span class="ident" id="6251851">PtrSize</span>&nbsp;<span class="op" id="6251859">=</span>&nbsp;<span class="num" id="6251861">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251865">f</span><span class="op" id="6251866">.</span><span class="ident" id="6251867">LoadAddress</span>&nbsp;<span class="op" id="6251879">=</span>&nbsp;<span class="num" id="6251881">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251892">f</span><span class="op" id="6251893">.</span><span class="ident" id="6251894">HdrSize</span>&nbsp;<span class="op" id="6251902">+=</span>&nbsp;<span class="num" id="6251905">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251912">var</span>&nbsp;<span class="ident" id="6251916">sects</span>&nbsp;<span class="op" id="6251922">=</span>&nbsp;<span class="op" id="6251924">[</span><span class="op" id="6251925">]</span><span class="keyword" id="6251926">struct</span>&nbsp;<span class="op" id="6251933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251937">name</span>&nbsp;<span class="builtintype" id="6251942">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251951">size</span>&nbsp;<span class="builtintype" id="6251956">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251964">}</span><span class="op" id="6251965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251969">{</span><span class="string" id="6251970">&#34;text&#34;</span><span class="op" id="6251976">,</span>&nbsp;<span class="ident" id="6251978">ph</span><span class="op" id="6251980">.</span><span class="ident" id="6251981">Text</span><span class="op" id="6251985">}</span><span class="op" id="6251986">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251990">{</span><span class="string" id="6251991">&#34;data&#34;</span><span class="op" id="6251997">,</span>&nbsp;<span class="ident" id="6251999">ph</span><span class="op" id="6252001">.</span><span class="ident" id="6252002">Data</span><span class="op" id="6252006">}</span><span class="op" id="6252007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252011">{</span><span class="string" id="6252012">&#34;syms&#34;</span><span class="op" id="6252018">,</span>&nbsp;<span class="ident" id="6252020">ph</span><span class="op" id="6252022">.</span><span class="ident" id="6252023">Syms</span><span class="op" id="6252027">}</span><span class="op" id="6252028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252032">{</span><span class="string" id="6252033">&#34;spsz&#34;</span><span class="op" id="6252039">,</span>&nbsp;<span class="ident" id="6252041">ph</span><span class="op" id="6252043">.</span><span class="ident" id="6252044">Spsz</span><span class="op" id="6252048">}</span><span class="op" id="6252049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252053">{</span><span class="string" id="6252054">&#34;pcsz&#34;</span><span class="op" id="6252060">,</span>&nbsp;<span class="ident" id="6252062">ph</span><span class="op" id="6252064">.</span><span class="ident" id="6252065">Pcsz</span><span class="op" id="6252069">}</span><span class="op" id="6252070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252073">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252077">f</span><span class="op" id="6252078">.</span><span class="ident" id="6252079">Sections</span>&nbsp;<span class="op" id="6252088">=</span>&nbsp;<span class="builtinfunc" id="6252090">make</span><span class="op" id="6252094">(</span><span class="op" id="6252095">[</span><span class="op" id="6252096">]</span><span class="op" id="6252097">*</span><span class="ident" id="6252098">Section</span><span class="op" id="6252105">,</span>&nbsp;<span class="num" id="6252107">5</span><span class="op" id="6252108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252112">off</span>&nbsp;<span class="op" id="6252116">:=</span>&nbsp;<span class="builtintype" id="6252119">uint32</span><span class="op" id="6252125">(</span><span class="ident" id="6252126">f</span><span class="op" id="6252127">.</span><span class="ident" id="6252128">HdrSize</span><span class="op" id="6252135">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252139">for</span>&nbsp;<span class="ident" id="6252143">i</span><span class="op" id="6252144">,</span>&nbsp;<span class="ident" id="6252146">sect</span>&nbsp;<span class="op" id="6252151">:=</span>&nbsp;<span class="keyword" id="6252154">range</span>&nbsp;<span class="ident" id="6252160">sects</span>&nbsp;<span class="op" id="6252166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252170">s</span>&nbsp;<span class="op" id="6252172">:=</span>&nbsp;<span class="builtinfunc" id="6252175">new</span><span class="op" id="6252178">(</span><span class="ident" id="6252179">Section</span><span class="op" id="6252186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252190">s</span><span class="op" id="6252191">.</span><span class="ident" id="6252192">SectionHeader</span>&nbsp;<span class="op" id="6252206">=</span>&nbsp;<span class="ident" id="6252208">SectionHeader</span><span class="op" id="6252221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252226">Name</span><span class="op" id="6252230">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6252234">sect</span><span class="op" id="6252238">.</span><span class="ident" id="6252239">name</span><span class="op" id="6252243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252248">Size</span><span class="op" id="6252252">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6252256">sect</span><span class="op" id="6252260">.</span><span class="ident" id="6252261">size</span><span class="op" id="6252265">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252270">Offset</span><span class="op" id="6252276">:</span>&nbsp;<span class="ident" id="6252278">off</span><span class="op" id="6252281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252289">off</span>&nbsp;<span class="op" id="6252293">+=</span>&nbsp;<span class="ident" id="6252296">sect</span><span class="op" id="6252300">.</span><span class="ident" id="6252301">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252308">s</span><span class="op" id="6252309">.</span><span class="ident" id="6252310">sr</span>&nbsp;<span class="op" id="6252313">=</span>&nbsp;<span class="ident" id="6252315">io</span><span class="op" id="6252317">.</span><span class="ident" id="6252318">NewSectionReader</span><span class="op" id="6252334">(</span><span class="ident" id="6252335">r</span><span class="op" id="6252336">,</span>&nbsp;<span class="ident" id="6252338">int64</span><span class="op" id="6252343">(</span><span class="ident" id="6252344">s</span><span class="op" id="6252345">.</span><span class="ident" id="6252346">Offset</span><span class="op" id="6252352">)</span><span class="op" id="6252353">,</span>&nbsp;<span class="ident" id="6252355">int64</span><span class="op" id="6252360">(</span><span class="ident" id="6252361">s</span><span class="op" id="6252362">.</span><span class="ident" id="6252363">Size</span><span class="op" id="6252367">)</span><span class="op" id="6252368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252372">s</span><span class="op" id="6252373">.</span><span class="ident" id="6252374">ReaderAt</span>&nbsp;<span class="op" id="6252383">=</span>&nbsp;<span class="ident" id="6252385">s</span><span class="op" id="6252386">.</span><span class="ident" id="6252387">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252392">f</span><span class="op" id="6252393">.</span><span class="ident" id="6252394">Sections</span><span class="op" id="6252402">[</span><span class="ident" id="6252403">i</span><span class="op" id="6252404">]</span>&nbsp;<span class="op" id="6252406">=</span>&nbsp;<span class="ident" id="6252408">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252415">return</span>&nbsp;<span class="ident" id="6252422">f</span><span class="op" id="6252423">,</span>&nbsp;<span class="ident" id="6252425">nil</span><br>
<span class="lineno"></span><span class="op" id="6252429">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6252432">func</span>&nbsp;<span class="ident" id="6252437">walksymtab</span><span class="op" id="6252447">(</span><span class="ident" id="6252448">data</span>&nbsp;<span class="op" id="6252453">[</span><span class="op" id="6252454">]</span><span class="builtintype" id="6252455">byte</span><span class="op" id="6252459">,</span>&nbsp;<span class="ident" id="6252461">ptrsz</span>&nbsp;<span class="builtintype" id="6252467">int</span><span class="op" id="6252470">,</span>&nbsp;<span class="ident" id="6252472">fn</span>&nbsp;<span class="keyword" id="6252475">func</span><span class="op" id="6252479">(</span><span class="ident" id="6252480">sym</span><span class="op" id="6252483">)</span>&nbsp;<span class="builtintype" id="6252485">error</span><span class="op" id="6252490">)</span>&nbsp;<span class="builtintype" id="6252492">error</span>&nbsp;<span class="op" id="6252498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252501">var</span>&nbsp;<span class="ident" id="6252505">order</span>&nbsp;<span class="ident" id="6252511">binary</span><span class="op" id="6252517">.</span><span class="ident" id="6252518">ByteOrder</span>&nbsp;<span class="op" id="6252528">=</span>&nbsp;<span class="ident" id="6252530">binary</span><span class="op" id="6252536">.</span><span class="ident" id="6252537">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252548">var</span>&nbsp;<span class="ident" id="6252552">s</span>&nbsp;<span class="ident" id="6252554">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252559">p</span>&nbsp;<span class="op" id="6252561">:=</span>&nbsp;<span class="ident" id="6252564">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252570">for</span>&nbsp;<span class="builtinfunc" id="6252574">len</span><span class="op" id="6252577">(</span><span class="ident" id="6252578">p</span><span class="op" id="6252579">)</span>&nbsp;<span class="op" id="6252581">&gt;=</span>&nbsp;<span class="num" id="6252584">4</span>&nbsp;<span class="op" id="6252586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6252590">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252615">if</span>&nbsp;<span class="builtinfunc" id="6252618">len</span><span class="op" id="6252621">(</span><span class="ident" id="6252622">p</span><span class="op" id="6252623">)</span>&nbsp;<span class="op" id="6252625">&lt;</span>&nbsp;<span class="ident" id="6252627">ptrsz</span>&nbsp;<span class="op" id="6252633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252638">return</span>&nbsp;<span class="op" id="6252645">&amp;</span><span class="ident" id="6252646">formatError</span><span class="op" id="6252657">{</span><span class="builtinfunc" id="6252658">len</span><span class="op" id="6252661">(</span><span class="ident" id="6252662">data</span><span class="op" id="6252666">)</span><span class="op" id="6252667">,</span>&nbsp;<span class="string" id="6252669">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6252685">,</span>&nbsp;<span class="ident" id="6252687">nil</span><span class="op" id="6252690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252694">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6252698">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252721">if</span>&nbsp;<span class="ident" id="6252724">ptrsz</span>&nbsp;<span class="op" id="6252730">==</span>&nbsp;<span class="num" id="6252733">8</span>&nbsp;<span class="op" id="6252735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252740">s</span><span class="op" id="6252741">.</span><span class="ident" id="6252742">value</span>&nbsp;<span class="op" id="6252748">=</span>&nbsp;<span class="ident" id="6252750">order</span><span class="op" id="6252755">.</span><span class="ident" id="6252756">Uint64</span><span class="op" id="6252762">(</span><span class="ident" id="6252763">p</span><span class="op" id="6252764">[</span><span class="num" id="6252765">0</span><span class="op" id="6252766">:</span><span class="num" id="6252767">8</span><span class="op" id="6252768">]</span><span class="op" id="6252769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252774">p</span>&nbsp;<span class="op" id="6252776">=</span>&nbsp;<span class="ident" id="6252778">p</span><span class="op" id="6252779">[</span><span class="num" id="6252780">8</span><span class="op" id="6252781">:</span><span class="op" id="6252782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252786">}</span>&nbsp;<span class="keyword" id="6252788">else</span>&nbsp;<span class="op" id="6252793">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252798">s</span><span class="op" id="6252799">.</span><span class="ident" id="6252800">value</span>&nbsp;<span class="op" id="6252806">=</span>&nbsp;<span class="ident" id="6252808">uint64</span><span class="op" id="6252814">(</span><span class="ident" id="6252815">order</span><span class="op" id="6252820">.</span><span class="ident" id="6252821">Uint32</span><span class="op" id="6252827">(</span><span class="ident" id="6252828">p</span><span class="op" id="6252829">[</span><span class="num" id="6252830">0</span><span class="op" id="6252831">:</span><span class="num" id="6252832">4</span><span class="op" id="6252833">]</span><span class="op" id="6252834">)</span><span class="op" id="6252835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252840">p</span>&nbsp;<span class="op" id="6252842">=</span>&nbsp;<span class="ident" id="6252844">p</span><span class="op" id="6252845">[</span><span class="num" id="6252846">4</span><span class="op" id="6252847">:</span><span class="op" id="6252848">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252857">var</span>&nbsp;<span class="ident" id="6252861">typ</span>&nbsp;<span class="builtintype" id="6252865">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252872">typ</span>&nbsp;<span class="op" id="6252876">=</span>&nbsp;<span class="ident" id="6252878">p</span><span class="op" id="6252879">[</span><span class="num" id="6252880">0</span><span class="op" id="6252881">]</span>&nbsp;<span class="op" id="6252883">&amp;</span>&nbsp;<span class="num" id="6252885">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252892">s</span><span class="op" id="6252893">.</span><span class="ident" id="6252894">typ</span>&nbsp;<span class="op" id="6252898">=</span>&nbsp;<span class="ident" id="6252900">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252906">p</span>&nbsp;<span class="op" id="6252908">=</span>&nbsp;<span class="ident" id="6252910">p</span><span class="op" id="6252911">[</span><span class="num" id="6252912">1</span><span class="op" id="6252913">:</span><span class="op" id="6252914">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6252919">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252930">var</span>&nbsp;<span class="ident" id="6252934">i</span>&nbsp;<span class="builtintype" id="6252936">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252942">var</span>&nbsp;<span class="ident" id="6252946">nnul</span>&nbsp;<span class="builtintype" id="6252951">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252957">for</span>&nbsp;<span class="ident" id="6252961">i</span>&nbsp;<span class="op" id="6252963">=</span>&nbsp;<span class="num" id="6252965">0</span><span class="op" id="6252966">;</span>&nbsp;<span class="ident" id="6252968">i</span>&nbsp;<span class="op" id="6252970">&lt;</span>&nbsp;<span class="builtinfunc" id="6252972">len</span><span class="op" id="6252975">(</span><span class="ident" id="6252976">p</span><span class="op" id="6252977">)</span><span class="op" id="6252978">;</span>&nbsp;<span class="ident" id="6252980">i</span><span class="op" id="6252981">++</span>&nbsp;<span class="op" id="6252984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252989">if</span>&nbsp;<span class="ident" id="6252992">p</span><span class="op" id="6252993">[</span><span class="ident" id="6252994">i</span><span class="op" id="6252995">]</span>&nbsp;<span class="op" id="6252997">==</span>&nbsp;<span class="num" id="6253000">0</span>&nbsp;<span class="op" id="6253002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253008">nnul</span>&nbsp;<span class="op" id="6253013">=</span>&nbsp;<span class="num" id="6253015">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253021">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253038">switch</span>&nbsp;<span class="ident" id="6253045">typ</span>&nbsp;<span class="op" id="6253049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253053">case</span>&nbsp;<span class="string" id="6253058">&#39;z&#39;</span><span class="op" id="6253061">,</span>&nbsp;<span class="string" id="6253063">&#39;Z&#39;</span><span class="op" id="6253066">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253071">p</span>&nbsp;<span class="op" id="6253073">=</span>&nbsp;<span class="ident" id="6253075">p</span><span class="op" id="6253076">[</span><span class="ident" id="6253077">i</span><span class="op" id="6253078">+</span><span class="ident" id="6253079">nnul</span><span class="op" id="6253083">:</span><span class="op" id="6253084">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253089">for</span>&nbsp;<span class="ident" id="6253093">i</span>&nbsp;<span class="op" id="6253095">=</span>&nbsp;<span class="num" id="6253097">0</span><span class="op" id="6253098">;</span>&nbsp;<span class="ident" id="6253100">i</span><span class="op" id="6253101">+</span><span class="num" id="6253102">2</span>&nbsp;<span class="op" id="6253104">&lt;=</span>&nbsp;<span class="builtinfunc" id="6253107">len</span><span class="op" id="6253110">(</span><span class="ident" id="6253111">p</span><span class="op" id="6253112">)</span><span class="op" id="6253113">;</span>&nbsp;<span class="ident" id="6253115">i</span>&nbsp;<span class="op" id="6253117">+=</span>&nbsp;<span class="num" id="6253120">2</span>&nbsp;<span class="op" id="6253122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253128">if</span>&nbsp;<span class="ident" id="6253131">p</span><span class="op" id="6253132">[</span><span class="ident" id="6253133">i</span><span class="op" id="6253134">]</span>&nbsp;<span class="op" id="6253136">==</span>&nbsp;<span class="num" id="6253139">0</span>&nbsp;<span class="op" id="6253141">&amp;&amp;</span>&nbsp;<span class="ident" id="6253144">p</span><span class="op" id="6253145">[</span><span class="ident" id="6253146">i</span><span class="op" id="6253147">+</span><span class="num" id="6253148">1</span><span class="op" id="6253149">]</span>&nbsp;<span class="op" id="6253151">==</span>&nbsp;<span class="num" id="6253154">0</span>&nbsp;<span class="op" id="6253156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253163">nnul</span>&nbsp;<span class="op" id="6253168">=</span>&nbsp;<span class="num" id="6253170">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253177">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253200">if</span>&nbsp;<span class="builtinfunc" id="6253203">len</span><span class="op" id="6253206">(</span><span class="ident" id="6253207">p</span><span class="op" id="6253208">)</span>&nbsp;<span class="op" id="6253210">&lt;</span>&nbsp;<span class="ident" id="6253212">i</span><span class="op" id="6253213">+</span><span class="ident" id="6253214">nnul</span>&nbsp;<span class="op" id="6253219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253224">return</span>&nbsp;<span class="op" id="6253231">&amp;</span><span class="ident" id="6253232">formatError</span><span class="op" id="6253243">{</span><span class="builtinfunc" id="6253244">len</span><span class="op" id="6253247">(</span><span class="ident" id="6253248">data</span><span class="op" id="6253252">)</span><span class="op" id="6253253">,</span>&nbsp;<span class="string" id="6253255">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6253271">,</span>&nbsp;<span class="ident" id="6253273">nil</span><span class="op" id="6253276">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253284">s</span><span class="op" id="6253285">.</span><span class="ident" id="6253286">name</span>&nbsp;<span class="op" id="6253291">=</span>&nbsp;<span class="ident" id="6253293">p</span><span class="op" id="6253294">[</span><span class="num" id="6253295">0</span><span class="op" id="6253296">:</span><span class="ident" id="6253297">i</span><span class="op" id="6253298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253302">i</span>&nbsp;<span class="op" id="6253304">+=</span>&nbsp;<span class="ident" id="6253307">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253314">p</span>&nbsp;<span class="op" id="6253316">=</span>&nbsp;<span class="ident" id="6253318">p</span><span class="op" id="6253319">[</span><span class="ident" id="6253320">i</span><span class="op" id="6253321">:</span><span class="op" id="6253322">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253327">fn</span><span class="op" id="6253329">(</span><span class="ident" id="6253330">s</span><span class="op" id="6253331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253337">return</span>&nbsp;<span class="ident" id="6253344">nil</span><br>
<span class="lineno"></span><span class="op" id="6253348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6253351">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6253400">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6253442">func</span>&nbsp;<span class="ident" id="6253447">newTable</span><span class="op" id="6253455">(</span><span class="ident" id="6253456">symtab</span>&nbsp;<span class="op" id="6253463">[</span><span class="op" id="6253464">]</span><span class="builtintype" id="6253465">byte</span><span class="op" id="6253469">,</span>&nbsp;<span class="ident" id="6253471">ptrsz</span>&nbsp;<span class="builtintype" id="6253477">int</span><span class="op" id="6253480">)</span>&nbsp;<span class="op" id="6253482">(</span><span class="op" id="6253483">[</span><span class="op" id="6253484">]</span><span class="ident" id="6253485">Sym</span><span class="op" id="6253488">,</span>&nbsp;<span class="builtintype" id="6253490">error</span><span class="op" id="6253495">)</span>&nbsp;<span class="op" id="6253497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253500">var</span>&nbsp;<span class="ident" id="6253504">n</span>&nbsp;<span class="builtintype" id="6253506">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253511">err</span>&nbsp;<span class="op" id="6253515">:=</span>&nbsp;<span class="ident" id="6253518">walksymtab</span><span class="op" id="6253528">(</span><span class="ident" id="6253529">symtab</span><span class="op" id="6253535">,</span>&nbsp;<span class="ident" id="6253537">ptrsz</span><span class="op" id="6253542">,</span>&nbsp;<span class="keyword" id="6253544">func</span><span class="op" id="6253548">(</span><span class="ident" id="6253549">s</span>&nbsp;<span class="ident" id="6253551">sym</span><span class="op" id="6253554">)</span>&nbsp;<span class="builtintype" id="6253556">error</span>&nbsp;<span class="op" id="6253562">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253566">n</span><span class="op" id="6253567">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253572">return</span>&nbsp;<span class="ident" id="6253579">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253584">}</span><span class="op" id="6253585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253588">if</span>&nbsp;<span class="ident" id="6253591">err</span>&nbsp;<span class="op" id="6253595">!=</span>&nbsp;<span class="ident" id="6253598">nil</span>&nbsp;<span class="op" id="6253602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253606">return</span>&nbsp;<span class="ident" id="6253613">nil</span><span class="op" id="6253616">,</span>&nbsp;<span class="ident" id="6253618">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253627">fname</span>&nbsp;<span class="op" id="6253633">:=</span>&nbsp;<span class="builtinfunc" id="6253636">make</span><span class="op" id="6253640">(</span><span class="keyword" id="6253641">map</span><span class="op" id="6253644">[</span><span class="builtintype" id="6253645">uint16</span><span class="op" id="6253651">]</span><span class="builtintype" id="6253652">string</span><span class="op" id="6253658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253661">syms</span>&nbsp;<span class="op" id="6253666">:=</span>&nbsp;<span class="builtinfunc" id="6253669">make</span><span class="op" id="6253673">(</span><span class="op" id="6253674">[</span><span class="op" id="6253675">]</span><span class="ident" id="6253676">Sym</span><span class="op" id="6253679">,</span>&nbsp;<span class="num" id="6253681">0</span><span class="op" id="6253682">,</span>&nbsp;<span class="ident" id="6253684">n</span><span class="op" id="6253685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253688">err</span>&nbsp;<span class="op" id="6253692">=</span>&nbsp;<span class="ident" id="6253694">walksymtab</span><span class="op" id="6253704">(</span><span class="ident" id="6253705">symtab</span><span class="op" id="6253711">,</span>&nbsp;<span class="ident" id="6253713">ptrsz</span><span class="op" id="6253718">,</span>&nbsp;<span class="keyword" id="6253720">func</span><span class="op" id="6253724">(</span><span class="ident" id="6253725">s</span>&nbsp;<span class="ident" id="6253727">sym</span><span class="op" id="6253730">)</span>&nbsp;<span class="builtintype" id="6253732">error</span>&nbsp;<span class="op" id="6253738">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253742">n</span>&nbsp;<span class="op" id="6253744">:=</span>&nbsp;<span class="builtinfunc" id="6253747">len</span><span class="op" id="6253750">(</span><span class="ident" id="6253751">syms</span><span class="op" id="6253755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253759">syms</span>&nbsp;<span class="op" id="6253764">=</span>&nbsp;<span class="ident" id="6253766">syms</span><span class="op" id="6253770">[</span><span class="num" id="6253771">0</span>&nbsp;<span class="op" id="6253773">:</span>&nbsp;<span class="ident" id="6253775">n</span><span class="op" id="6253776">+</span><span class="num" id="6253777">1</span><span class="op" id="6253778">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253782">ts</span>&nbsp;<span class="op" id="6253785">:=</span>&nbsp;<span class="op" id="6253788">&amp;</span><span class="ident" id="6253789">syms</span><span class="op" id="6253793">[</span><span class="ident" id="6253794">n</span><span class="op" id="6253795">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253799">ts</span><span class="op" id="6253801">.</span><span class="ident" id="6253802">Type</span>&nbsp;<span class="op" id="6253807">=</span>&nbsp;<span class="builtintype" id="6253809">rune</span><span class="op" id="6253813">(</span><span class="ident" id="6253814">s</span><span class="op" id="6253815">.</span><span class="ident" id="6253816">typ</span><span class="op" id="6253819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253823">ts</span><span class="op" id="6253825">.</span><span class="ident" id="6253826">Value</span>&nbsp;<span class="op" id="6253832">=</span>&nbsp;<span class="ident" id="6253834">s</span><span class="op" id="6253835">.</span><span class="ident" id="6253836">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253844">switch</span>&nbsp;<span class="ident" id="6253851">s</span><span class="op" id="6253852">.</span><span class="ident" id="6253853">typ</span>&nbsp;<span class="op" id="6253857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253861">default</span><span class="op" id="6253868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253873">ts</span><span class="op" id="6253875">.</span><span class="ident" id="6253876">Name</span>&nbsp;<span class="op" id="6253881">=</span>&nbsp;<span class="builtintype" id="6253883">string</span><span class="op" id="6253889">(</span><span class="ident" id="6253890">s</span><span class="op" id="6253891">.</span><span class="ident" id="6253892">name</span><span class="op" id="6253896">[</span><span class="op" id="6253897">:</span><span class="op" id="6253898">]</span><span class="op" id="6253899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253903">case</span>&nbsp;<span class="string" id="6253908">&#39;z&#39;</span><span class="op" id="6253911">,</span>&nbsp;<span class="string" id="6253913">&#39;Z&#39;</span><span class="op" id="6253916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253921">for</span>&nbsp;<span class="ident" id="6253925">i</span>&nbsp;<span class="op" id="6253927">:=</span>&nbsp;<span class="num" id="6253930">0</span><span class="op" id="6253931">;</span>&nbsp;<span class="ident" id="6253933">i</span>&nbsp;<span class="op" id="6253935">&lt;</span>&nbsp;<span class="builtinfunc" id="6253937">len</span><span class="op" id="6253940">(</span><span class="ident" id="6253941">s</span><span class="op" id="6253942">.</span><span class="ident" id="6253943">name</span><span class="op" id="6253947">)</span><span class="op" id="6253948">;</span>&nbsp;<span class="ident" id="6253950">i</span>&nbsp;<span class="op" id="6253952">+=</span>&nbsp;<span class="num" id="6253955">2</span>&nbsp;<span class="op" id="6253957">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253963">eltIdx</span>&nbsp;<span class="op" id="6253970">:=</span>&nbsp;<span class="ident" id="6253973">binary</span><span class="op" id="6253979">.</span><span class="ident" id="6253980">BigEndian</span><span class="op" id="6253989">.</span><span class="ident" id="6253990">Uint16</span><span class="op" id="6253996">(</span><span class="ident" id="6253997">s</span><span class="op" id="6253998">.</span><span class="ident" id="6253999">name</span><span class="op" id="6254003">[</span><span class="ident" id="6254004">i</span>&nbsp;<span class="op" id="6254006">:</span>&nbsp;<span class="ident" id="6254008">i</span><span class="op" id="6254009">+</span><span class="num" id="6254010">2</span><span class="op" id="6254011">]</span><span class="op" id="6254012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254018">elt</span><span class="op" id="6254021">,</span>&nbsp;<span class="ident" id="6254023">ok</span>&nbsp;<span class="op" id="6254026">:=</span>&nbsp;<span class="ident" id="6254029">fname</span><span class="op" id="6254034">[</span><span class="ident" id="6254035">eltIdx</span><span class="op" id="6254041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254047">if</span>&nbsp;<span class="op" id="6254050">!</span><span class="ident" id="6254051">ok</span>&nbsp;<span class="op" id="6254054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254061">return</span>&nbsp;<span class="op" id="6254068">&amp;</span><span class="ident" id="6254069">formatError</span><span class="op" id="6254080">{</span><span class="op" id="6254081">-</span><span class="num" id="6254082">1</span><span class="op" id="6254083">,</span>&nbsp;<span class="string" id="6254085">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6254104">,</span>&nbsp;<span class="ident" id="6254106">eltIdx</span><span class="op" id="6254112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254118">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254124">if</span>&nbsp;<span class="ident" id="6254127">n</span>&nbsp;<span class="op" id="6254129">:=</span>&nbsp;<span class="builtinfunc" id="6254132">len</span><span class="op" id="6254135">(</span><span class="ident" id="6254136">ts</span><span class="op" id="6254138">.</span><span class="ident" id="6254139">Name</span><span class="op" id="6254143">)</span><span class="op" id="6254144">;</span>&nbsp;<span class="ident" id="6254146">n</span>&nbsp;<span class="op" id="6254148">&gt;</span>&nbsp;<span class="num" id="6254150">0</span>&nbsp;<span class="op" id="6254152">&amp;&amp;</span>&nbsp;<span class="ident" id="6254155">ts</span><span class="op" id="6254157">.</span><span class="ident" id="6254158">Name</span><span class="op" id="6254162">[</span><span class="ident" id="6254163">n</span><span class="op" id="6254164">-</span><span class="num" id="6254165">1</span><span class="op" id="6254166">]</span>&nbsp;<span class="op" id="6254168">!=</span>&nbsp;<span class="string" id="6254171">&#39;/&#39;</span>&nbsp;<span class="op" id="6254175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254182">ts</span><span class="op" id="6254184">.</span><span class="ident" id="6254185">Name</span>&nbsp;<span class="op" id="6254190">+=</span>&nbsp;<span class="string" id="6254193">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254207">ts</span><span class="op" id="6254209">.</span><span class="ident" id="6254210">Name</span>&nbsp;<span class="op" id="6254215">+=</span>&nbsp;<span class="ident" id="6254218">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254225">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254233">switch</span>&nbsp;<span class="ident" id="6254240">s</span><span class="op" id="6254241">.</span><span class="ident" id="6254242">typ</span>&nbsp;<span class="op" id="6254246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254250">case</span>&nbsp;<span class="string" id="6254255">&#39;f&#39;</span><span class="op" id="6254258">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254263">fname</span><span class="op" id="6254268">[</span><span class="builtintype" id="6254269">uint16</span><span class="op" id="6254275">(</span><span class="ident" id="6254276">s</span><span class="op" id="6254277">.</span><span class="ident" id="6254278">value</span><span class="op" id="6254283">)</span><span class="op" id="6254284">]</span>&nbsp;<span class="op" id="6254286">=</span>&nbsp;<span class="ident" id="6254288">ts</span><span class="op" id="6254290">.</span><span class="ident" id="6254291">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254298">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254302">return</span>&nbsp;<span class="ident" id="6254309">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254314">}</span><span class="op" id="6254315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254318">if</span>&nbsp;<span class="ident" id="6254321">err</span>&nbsp;<span class="op" id="6254325">!=</span>&nbsp;<span class="ident" id="6254328">nil</span>&nbsp;<span class="op" id="6254332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254336">return</span>&nbsp;<span class="ident" id="6254343">nil</span><span class="op" id="6254346">,</span>&nbsp;<span class="ident" id="6254348">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254353">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254357">return</span>&nbsp;<span class="ident" id="6254364">syms</span><span class="op" id="6254368">,</span>&nbsp;<span class="ident" id="6254370">nil</span><br>
<span class="lineno"></span><span class="op" id="6254374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6254377">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6254420">func</span>&nbsp;<span class="op" id="6254425">(</span><span class="ident" id="6254426">f</span>&nbsp;<span class="op" id="6254428">*</span><span class="ident" id="6254429">File</span><span class="op" id="6254433">)</span>&nbsp;<span class="ident" id="6254435">Symbols</span><span class="op" id="6254442">(</span><span class="op" id="6254443">)</span>&nbsp;<span class="op" id="6254445">(</span><span class="op" id="6254446">[</span><span class="op" id="6254447">]</span><span class="ident" id="6254448">Sym</span><span class="op" id="6254451">,</span>&nbsp;<span class="builtintype" id="6254453">error</span><span class="op" id="6254458">)</span>&nbsp;<span class="op" id="6254460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254463">symtabSection</span>&nbsp;<span class="op" id="6254477">:=</span>&nbsp;<span class="ident" id="6254480">f</span><span class="op" id="6254481">.</span><span class="ident" id="6254482">Section</span><span class="op" id="6254489">(</span><span class="string" id="6254490">&#34;syms&#34;</span><span class="op" id="6254496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254499">if</span>&nbsp;<span class="ident" id="6254502">symtabSection</span>&nbsp;<span class="op" id="6254516">==</span>&nbsp;<span class="ident" id="6254519">nil</span>&nbsp;<span class="op" id="6254523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254527">return</span>&nbsp;<span class="ident" id="6254534">nil</span><span class="op" id="6254537">,</span>&nbsp;<span class="ident" id="6254539">errors</span><span class="op" id="6254545">.</span><span class="ident" id="6254546">New</span><span class="op" id="6254549">(</span><span class="string" id="6254550">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6254569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254572">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254576">symtab</span><span class="op" id="6254582">,</span>&nbsp;<span class="ident" id="6254584">err</span>&nbsp;<span class="op" id="6254588">:=</span>&nbsp;<span class="ident" id="6254591">symtabSection</span><span class="op" id="6254604">.</span><span class="ident" id="6254605">Data</span><span class="op" id="6254609">(</span><span class="op" id="6254610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254613">if</span>&nbsp;<span class="ident" id="6254616">err</span>&nbsp;<span class="op" id="6254620">!=</span>&nbsp;<span class="ident" id="6254623">nil</span>&nbsp;<span class="op" id="6254627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254631">return</span>&nbsp;<span class="ident" id="6254638">nil</span><span class="op" id="6254641">,</span>&nbsp;<span class="ident" id="6254643">errors</span><span class="op" id="6254649">.</span><span class="ident" id="6254650">New</span><span class="op" id="6254653">(</span><span class="string" id="6254654">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6254682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254685">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254689">return</span>&nbsp;<span class="ident" id="6254696">newTable</span><span class="op" id="6254704">(</span><span class="ident" id="6254705">symtab</span><span class="op" id="6254711">,</span>&nbsp;<span class="ident" id="6254713">f</span><span class="op" id="6254714">.</span><span class="ident" id="6254715">PtrSize</span><span class="op" id="6254722">)</span><br>
<span class="lineno"></span><span class="op" id="6254724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6254727">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6254795">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6254814">func</span>&nbsp;<span class="op" id="6254819">(</span><span class="ident" id="6254820">f</span>&nbsp;<span class="op" id="6254822">*</span><span class="ident" id="6254823">File</span><span class="op" id="6254827">)</span>&nbsp;<span class="ident" id="6254829">Section</span><span class="op" id="6254836">(</span><span class="ident" id="6254837">name</span>&nbsp;<span class="builtintype" id="6254842">string</span><span class="op" id="6254848">)</span>&nbsp;<span class="op" id="6254850">*</span><span class="ident" id="6254851">Section</span>&nbsp;<span class="op" id="6254859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254862">for</span>&nbsp;<span class="ident" id="6254866">_</span><span class="op" id="6254867">,</span>&nbsp;<span class="ident" id="6254869">s</span>&nbsp;<span class="op" id="6254871">:=</span>&nbsp;<span class="keyword" id="6254874">range</span>&nbsp;<span class="ident" id="6254880">f</span><span class="op" id="6254881">.</span><span class="ident" id="6254882">Sections</span>&nbsp;<span class="op" id="6254891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254895">if</span>&nbsp;<span class="ident" id="6254898">s</span><span class="op" id="6254899">.</span><span class="ident" id="6254900">Name</span>&nbsp;<span class="op" id="6254905">==</span>&nbsp;<span class="ident" id="6254908">name</span>&nbsp;<span class="op" id="6254913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254918">return</span>&nbsp;<span class="ident" id="6254925">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254935">return</span>&nbsp;<span class="ident" id="6254942">nil</span><br>
<span class="lineno"></span><span class="op" id="6254946">}</span>
</div>
</body>
</html>
