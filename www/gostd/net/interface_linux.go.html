<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4069537">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4069593">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4069647">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4069698">package</span>&nbsp;<span class="ident" id="4069706">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069711">import</span>&nbsp;<span class="op" id="4069718">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4069721">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4069727">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4069738">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="4069747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4069750">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4069816">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="4069885">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4069899">func</span>&nbsp;<span class="ident" id="4069904">interfaceTable</span><span class="op" id="4069918">(</span><span class="ident" id="4069919">ifindex</span>&nbsp;<span class="builtintype" id="4069927">int</span><span class="op" id="4069930">)</span>&nbsp;<span class="op" id="4069932">(</span><span class="op" id="4069933">[</span><span class="op" id="4069934">]</span><span class="ident" id="4069935">Interface</span><span class="op" id="4069944">,</span>&nbsp;<span class="builtintype" id="4069946">error</span><span class="op" id="4069951">)</span>&nbsp;<span class="op" id="4069953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4069956">tab</span><span class="op" id="4069959">,</span>&nbsp;<span class="ident" id="4069961">err</span>&nbsp;<span class="op" id="4069965">:=</span>&nbsp;<span class="ident" id="4069968">syscall</span><span class="op" id="4069975">.</span><span class="ident" id="4069976">NetlinkRIB</span><span class="op" id="4069986">(</span><span class="ident" id="4069987">syscall</span><span class="op" id="4069994">.</span><span class="ident" id="4069995">RTM_GETLINK</span><span class="op" id="4070006">,</span>&nbsp;<span class="ident" id="4070008">syscall</span><span class="op" id="4070015">.</span><span class="ident" id="4070016">AF_UNSPEC</span><span class="op" id="4070025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070028">if</span>&nbsp;<span class="ident" id="4070031">err</span>&nbsp;<span class="op" id="4070035">!=</span>&nbsp;<span class="ident" id="4070038">nil</span>&nbsp;<span class="op" id="4070042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070046">return</span>&nbsp;<span class="ident" id="4070053">nil</span><span class="op" id="4070056">,</span>&nbsp;<span class="ident" id="4070058">os</span><span class="op" id="4070060">.</span><span class="ident" id="4070061">NewSyscallError</span><span class="op" id="4070076">(</span><span class="string" id="4070077">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="4070090">,</span>&nbsp;<span class="ident" id="4070092">err</span><span class="op" id="4070095">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070101">msgs</span><span class="op" id="4070105">,</span>&nbsp;<span class="ident" id="4070107">err</span>&nbsp;<span class="op" id="4070111">:=</span>&nbsp;<span class="ident" id="4070114">syscall</span><span class="op" id="4070121">.</span><span class="ident" id="4070122">ParseNetlinkMessage</span><span class="op" id="4070141">(</span><span class="ident" id="4070142">tab</span><span class="op" id="4070145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070148">if</span>&nbsp;<span class="ident" id="4070151">err</span>&nbsp;<span class="op" id="4070155">!=</span>&nbsp;<span class="ident" id="4070158">nil</span>&nbsp;<span class="op" id="4070162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070166">return</span>&nbsp;<span class="ident" id="4070173">nil</span><span class="op" id="4070176">,</span>&nbsp;<span class="ident" id="4070178">os</span><span class="op" id="4070180">.</span><span class="ident" id="4070181">NewSyscallError</span><span class="op" id="4070196">(</span><span class="string" id="4070197">&#34;netlink&nbsp;message&#34;</span><span class="op" id="4070214">,</span>&nbsp;<span class="ident" id="4070216">err</span><span class="op" id="4070219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070222">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070225">var</span>&nbsp;<span class="ident" id="4070229">ift</span>&nbsp;<span class="op" id="4070233">[</span><span class="op" id="4070234">]</span><span class="ident" id="4070235">Interface</span><br>
<span class="lineno"></span><span class="ident" id="4070245">loop</span><span class="op" id="4070249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070252">for</span>&nbsp;<span class="ident" id="4070256">_</span><span class="op" id="4070257">,</span>&nbsp;<span class="ident" id="4070259">m</span>&nbsp;<span class="op" id="4070261">:=</span>&nbsp;<span class="keyword" id="4070264">range</span>&nbsp;<span class="ident" id="4070270">msgs</span>&nbsp;<span class="op" id="4070275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070279">switch</span>&nbsp;<span class="ident" id="4070286">m</span><span class="op" id="4070287">.</span><span class="ident" id="4070288">Header</span><span class="op" id="4070294">.</span><span class="ident" id="4070295">Type</span>&nbsp;<span class="op" id="4070300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070304">case</span>&nbsp;<span class="ident" id="4070309">syscall</span><span class="op" id="4070316">.</span><span class="ident" id="4070317">NLMSG_DONE</span><span class="op" id="4070327">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070332">break</span>&nbsp;<span class="ident" id="4070338">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070345">case</span>&nbsp;<span class="ident" id="4070350">syscall</span><span class="op" id="4070357">.</span><span class="ident" id="4070358">RTM_NEWLINK</span><span class="op" id="4070369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070374">ifim</span>&nbsp;<span class="op" id="4070379">:=</span>&nbsp;<span class="op" id="4070382">(</span><span class="op" id="4070383">*</span><span class="ident" id="4070384">syscall</span><span class="op" id="4070391">.</span><span class="ident" id="4070392">IfInfomsg</span><span class="op" id="4070401">)</span><span class="op" id="4070402">(</span><span class="ident" id="4070403">unsafe</span><span class="op" id="4070409">.</span><span class="ident" id="4070410">Pointer</span><span class="op" id="4070417">(</span><span class="op" id="4070418">&amp;</span><span class="ident" id="4070419">m</span><span class="op" id="4070420">.</span><span class="ident" id="4070421">Data</span><span class="op" id="4070425">[</span><span class="num" id="4070426">0</span><span class="op" id="4070427">]</span><span class="op" id="4070428">)</span><span class="op" id="4070429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070434">if</span>&nbsp;<span class="ident" id="4070437">ifindex</span>&nbsp;<span class="op" id="4070445">==</span>&nbsp;<span class="num" id="4070448">0</span>&nbsp;<span class="op" id="4070450">||</span>&nbsp;<span class="ident" id="4070453">ifindex</span>&nbsp;<span class="op" id="4070461">==</span>&nbsp;<span class="builtintype" id="4070464">int</span><span class="op" id="4070467">(</span><span class="ident" id="4070468">ifim</span><span class="op" id="4070472">.</span><span class="ident" id="4070473">Index</span><span class="op" id="4070478">)</span>&nbsp;<span class="op" id="4070480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070486">attrs</span><span class="op" id="4070491">,</span>&nbsp;<span class="ident" id="4070493">err</span>&nbsp;<span class="op" id="4070497">:=</span>&nbsp;<span class="ident" id="4070500">syscall</span><span class="op" id="4070507">.</span><span class="ident" id="4070508">ParseNetlinkRouteAttr</span><span class="op" id="4070529">(</span><span class="op" id="4070530">&amp;</span><span class="ident" id="4070531">m</span><span class="op" id="4070532">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070538">if</span>&nbsp;<span class="ident" id="4070541">err</span>&nbsp;<span class="op" id="4070545">!=</span>&nbsp;<span class="ident" id="4070548">nil</span>&nbsp;<span class="op" id="4070552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070559">return</span>&nbsp;<span class="ident" id="4070566">nil</span><span class="op" id="4070569">,</span>&nbsp;<span class="ident" id="4070571">os</span><span class="op" id="4070573">.</span><span class="ident" id="4070574">NewSyscallError</span><span class="op" id="4070589">(</span><span class="string" id="4070590">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="4070609">,</span>&nbsp;<span class="ident" id="4070611">err</span><span class="op" id="4070614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070626">ift</span>&nbsp;<span class="op" id="4070630">=</span>&nbsp;<span class="builtinfunc" id="4070632">append</span><span class="op" id="4070638">(</span><span class="ident" id="4070639">ift</span><span class="op" id="4070642">,</span>&nbsp;<span class="op" id="4070644">*</span><span class="ident" id="4070645">newLink</span><span class="op" id="4070652">(</span><span class="ident" id="4070653">ifim</span><span class="op" id="4070657">,</span>&nbsp;<span class="ident" id="4070659">attrs</span><span class="op" id="4070664">)</span><span class="op" id="4070665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070671">if</span>&nbsp;<span class="ident" id="4070674">ifindex</span>&nbsp;<span class="op" id="4070682">==</span>&nbsp;<span class="builtintype" id="4070685">int</span><span class="op" id="4070688">(</span><span class="ident" id="4070689">ifim</span><span class="op" id="4070693">.</span><span class="ident" id="4070694">Index</span><span class="op" id="4070699">)</span>&nbsp;<span class="op" id="4070701">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070708">break</span>&nbsp;<span class="ident" id="4070714">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4070735">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4070738">return</span>&nbsp;<span class="ident" id="4070745">ift</span><span class="op" id="4070748">,</span>&nbsp;<span class="ident" id="4070750">nil</span><br>
<span class="lineno"></span><span class="op" id="4070754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070757">const</span>&nbsp;<span class="op" id="4070763">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070766">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4070790">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070852">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="4070875">=</span>&nbsp;<span class="num" id="4070877">768</span>&nbsp;<span class="comment" id="4070881">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070910">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="4070933">=</span>&nbsp;<span class="num" id="4070935">769</span>&nbsp;<span class="comment" id="4070939">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4070968">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="4070991">=</span>&nbsp;<span class="num" id="4070993">776</span>&nbsp;<span class="comment" id="4070997">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071026">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="4071049">=</span>&nbsp;<span class="num" id="4071051">778</span>&nbsp;<span class="comment" id="4071055">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071092">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="4071115">=</span>&nbsp;<span class="num" id="4071117">823</span>&nbsp;<span class="comment" id="4071121">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="4071157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4071160">func</span>&nbsp;<span class="ident" id="4071165">newLink</span><span class="op" id="4071172">(</span><span class="ident" id="4071173">ifim</span>&nbsp;<span class="op" id="4071178">*</span><span class="ident" id="4071179">syscall</span><span class="op" id="4071186">.</span><span class="ident" id="4071187">IfInfomsg</span><span class="op" id="4071196">,</span>&nbsp;<span class="ident" id="4071198">attrs</span>&nbsp;<span class="op" id="4071204">[</span><span class="op" id="4071205">]</span><span class="ident" id="4071206">syscall</span><span class="op" id="4071213">.</span><span class="ident" id="4071214">NetlinkRouteAttr</span><span class="op" id="4071230">)</span>&nbsp;<span class="op" id="4071232">*</span><span class="ident" id="4071233">Interface</span>&nbsp;<span class="op" id="4071243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071246">ifi</span>&nbsp;<span class="op" id="4071250">:=</span>&nbsp;<span class="op" id="4071253">&amp;</span><span class="ident" id="4071254">Interface</span><span class="op" id="4071263">{</span><span class="ident" id="4071264">Index</span><span class="op" id="4071269">:</span>&nbsp;<span class="builtintype" id="4071271">int</span><span class="op" id="4071274">(</span><span class="ident" id="4071275">ifim</span><span class="op" id="4071279">.</span><span class="ident" id="4071280">Index</span><span class="op" id="4071285">)</span><span class="op" id="4071286">,</span>&nbsp;<span class="ident" id="4071288">Flags</span><span class="op" id="4071293">:</span>&nbsp;<span class="ident" id="4071295">linkFlags</span><span class="op" id="4071304">(</span><span class="ident" id="4071305">ifim</span><span class="op" id="4071309">.</span><span class="ident" id="4071310">Flags</span><span class="op" id="4071315">)</span><span class="op" id="4071316">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071319">for</span>&nbsp;<span class="ident" id="4071323">_</span><span class="op" id="4071324">,</span>&nbsp;<span class="ident" id="4071326">a</span>&nbsp;<span class="op" id="4071328">:=</span>&nbsp;<span class="keyword" id="4071331">range</span>&nbsp;<span class="ident" id="4071337">attrs</span>&nbsp;<span class="op" id="4071343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071347">switch</span>&nbsp;<span class="ident" id="4071354">a</span><span class="op" id="4071355">.</span><span class="ident" id="4071356">Attr</span><span class="op" id="4071360">.</span><span class="ident" id="4071361">Type</span>&nbsp;<span class="op" id="4071366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071370">case</span>&nbsp;<span class="ident" id="4071375">syscall</span><span class="op" id="4071382">.</span><span class="ident" id="4071383">IFLA_ADDRESS</span><span class="op" id="4071395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071400">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071449">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4071496">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071520">switch</span>&nbsp;<span class="builtinfunc" id="4071527">len</span><span class="op" id="4071530">(</span><span class="ident" id="4071531">a</span><span class="op" id="4071532">.</span><span class="ident" id="4071533">Value</span><span class="op" id="4071538">)</span>&nbsp;<span class="op" id="4071540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071545">case</span>&nbsp;<span class="ident" id="4071550">IPv4len</span><span class="op" id="4071557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071563">switch</span>&nbsp;<span class="ident" id="4071570">ifim</span><span class="op" id="4071574">.</span><span class="ident" id="4071575">Type</span>&nbsp;<span class="op" id="4071580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071586">case</span>&nbsp;<span class="ident" id="4071591">sysARPHardwareIPv4IPv4</span><span class="op" id="4071613">,</span>&nbsp;<span class="ident" id="4071615">sysARPHardwareGREIPv4</span><span class="op" id="4071636">,</span>&nbsp;<span class="ident" id="4071638">sysARPHardwareIPv6IPv4</span><span class="op" id="4071660">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071667">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071685">case</span>&nbsp;<span class="ident" id="4071690">IPv6len</span><span class="op" id="4071697">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071703">switch</span>&nbsp;<span class="ident" id="4071710">ifim</span><span class="op" id="4071714">.</span><span class="ident" id="4071715">Type</span>&nbsp;<span class="op" id="4071720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071726">case</span>&nbsp;<span class="ident" id="4071731">sysARPHardwareIPv6IPv6</span><span class="op" id="4071753">,</span>&nbsp;<span class="ident" id="4071755">sysARPHardwareGREIPv6</span><span class="op" id="4071776">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071783">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071806">var</span>&nbsp;<span class="ident" id="4071810">nonzero</span>&nbsp;<span class="builtintype" id="4071818">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071826">for</span>&nbsp;<span class="ident" id="4071830">_</span><span class="op" id="4071831">,</span>&nbsp;<span class="ident" id="4071833">b</span>&nbsp;<span class="op" id="4071835">:=</span>&nbsp;<span class="keyword" id="4071838">range</span>&nbsp;<span class="ident" id="4071844">a</span><span class="op" id="4071845">.</span><span class="ident" id="4071846">Value</span>&nbsp;<span class="op" id="4071852">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071858">if</span>&nbsp;<span class="ident" id="4071861">b</span>&nbsp;<span class="op" id="4071863">!=</span>&nbsp;<span class="num" id="4071866">0</span>&nbsp;<span class="op" id="4071868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071875">nonzero</span>&nbsp;<span class="op" id="4071883">=</span>&nbsp;<span class="builtintype" id="4071885">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071895">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071910">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071915">if</span>&nbsp;<span class="ident" id="4071918">nonzero</span>&nbsp;<span class="op" id="4071926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071932">ifi</span><span class="op" id="4071935">.</span><span class="ident" id="4071936">HardwareAddr</span>&nbsp;<span class="op" id="4071949">=</span>&nbsp;<span class="ident" id="4071951">a</span><span class="op" id="4071952">.</span><span class="ident" id="4071953">Value</span><span class="op" id="4071958">[</span><span class="op" id="4071959">:</span><span class="op" id="4071960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4071965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4071969">case</span>&nbsp;<span class="ident" id="4071974">syscall</span><span class="op" id="4071981">.</span><span class="ident" id="4071982">IFLA_IFNAME</span><span class="op" id="4071993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4071998">ifi</span><span class="op" id="4072001">.</span><span class="ident" id="4072002">Name</span>&nbsp;<span class="op" id="4072007">=</span>&nbsp;<span class="builtintype" id="4072009">string</span><span class="op" id="4072015">(</span><span class="ident" id="4072016">a</span><span class="op" id="4072017">.</span><span class="ident" id="4072018">Value</span><span class="op" id="4072023">[</span><span class="op" id="4072024">:</span><span class="builtinfunc" id="4072025">len</span><span class="op" id="4072028">(</span><span class="ident" id="4072029">a</span><span class="op" id="4072030">.</span><span class="ident" id="4072031">Value</span><span class="op" id="4072036">)</span><span class="op" id="4072037">-</span><span class="num" id="4072038">1</span><span class="op" id="4072039">]</span><span class="op" id="4072040">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072044">case</span>&nbsp;<span class="ident" id="4072049">syscall</span><span class="op" id="4072056">.</span><span class="ident" id="4072057">IFLA_MTU</span><span class="op" id="4072065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072070">ifi</span><span class="op" id="4072073">.</span><span class="ident" id="4072074">MTU</span>&nbsp;<span class="op" id="4072078">=</span>&nbsp;<span class="builtintype" id="4072080">int</span><span class="op" id="4072083">(</span><span class="op" id="4072084">*</span><span class="op" id="4072085">(</span><span class="op" id="4072086">*</span><span class="builtintype" id="4072087">uint32</span><span class="op" id="4072093">)</span><span class="op" id="4072094">(</span><span class="ident" id="4072095">unsafe</span><span class="op" id="4072101">.</span><span class="ident" id="4072102">Pointer</span><span class="op" id="4072109">(</span><span class="op" id="4072110">&amp;</span><span class="ident" id="4072111">a</span><span class="op" id="4072112">.</span><span class="ident" id="4072113">Value</span><span class="op" id="4072118">[</span><span class="op" id="4072119">:</span><span class="num" id="4072120">4</span><span class="op" id="4072121">]</span><span class="op" id="4072122">[</span><span class="num" id="4072123">0</span><span class="op" id="4072124">]</span><span class="op" id="4072125">)</span><span class="op" id="4072126">)</span><span class="op" id="4072127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072137">return</span>&nbsp;<span class="ident" id="4072144">ifi</span><br>
<span class="lineno">95</span><span class="op" id="4072148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4072151">func</span>&nbsp;<span class="ident" id="4072156">linkFlags</span><span class="op" id="4072165">(</span><span class="ident" id="4072166">rawFlags</span>&nbsp;<span class="builtintype" id="4072175">uint32</span><span class="op" id="4072181">)</span>&nbsp;<span class="ident" id="4072183">Flags</span>&nbsp;<span class="op" id="4072189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072192">var</span>&nbsp;<span class="ident" id="4072196">f</span>&nbsp;<span class="ident" id="4072198">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072205">if</span>&nbsp;<span class="ident" id="4072208">rawFlags</span><span class="op" id="4072216">&amp;</span><span class="ident" id="4072217">syscall</span><span class="op" id="4072224">.</span><span class="ident" id="4072225">IFF_UP</span>&nbsp;<span class="op" id="4072232">!=</span>&nbsp;<span class="num" id="4072235">0</span>&nbsp;<span class="op" id="4072237">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072241">f</span>&nbsp;<span class="op" id="4072243">|=</span>&nbsp;<span class="ident" id="4072246">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072257">if</span>&nbsp;<span class="ident" id="4072260">rawFlags</span><span class="op" id="4072268">&amp;</span><span class="ident" id="4072269">syscall</span><span class="op" id="4072276">.</span><span class="ident" id="4072277">IFF_BROADCAST</span>&nbsp;<span class="op" id="4072291">!=</span>&nbsp;<span class="num" id="4072294">0</span>&nbsp;<span class="op" id="4072296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072300">f</span>&nbsp;<span class="op" id="4072302">|=</span>&nbsp;<span class="ident" id="4072305">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072320">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072323">if</span>&nbsp;<span class="ident" id="4072326">rawFlags</span><span class="op" id="4072334">&amp;</span><span class="ident" id="4072335">syscall</span><span class="op" id="4072342">.</span><span class="ident" id="4072343">IFF_LOOPBACK</span>&nbsp;<span class="op" id="4072356">!=</span>&nbsp;<span class="num" id="4072359">0</span>&nbsp;<span class="op" id="4072361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072365">f</span>&nbsp;<span class="op" id="4072367">|=</span>&nbsp;<span class="ident" id="4072370">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072387">if</span>&nbsp;<span class="ident" id="4072390">rawFlags</span><span class="op" id="4072398">&amp;</span><span class="ident" id="4072399">syscall</span><span class="op" id="4072406">.</span><span class="ident" id="4072407">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="4072423">!=</span>&nbsp;<span class="num" id="4072426">0</span>&nbsp;<span class="op" id="4072428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072432">f</span>&nbsp;<span class="op" id="4072434">|=</span>&nbsp;<span class="ident" id="4072437">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072458">if</span>&nbsp;<span class="ident" id="4072461">rawFlags</span><span class="op" id="4072469">&amp;</span><span class="ident" id="4072470">syscall</span><span class="op" id="4072477">.</span><span class="ident" id="4072478">IFF_MULTICAST</span>&nbsp;<span class="op" id="4072492">!=</span>&nbsp;<span class="num" id="4072495">0</span>&nbsp;<span class="op" id="4072497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072501">f</span>&nbsp;<span class="op" id="4072503">|=</span>&nbsp;<span class="ident" id="4072506">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072524">return</span>&nbsp;<span class="ident" id="4072531">f</span><br>
<span class="lineno">115</span><span class="op" id="4072533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4072536">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4072603">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="4072673">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="4072687">func</span>&nbsp;<span class="ident" id="4072692">interfaceAddrTable</span><span class="op" id="4072710">(</span><span class="ident" id="4072711">ifi</span>&nbsp;<span class="op" id="4072715">*</span><span class="ident" id="4072716">Interface</span><span class="op" id="4072725">)</span>&nbsp;<span class="op" id="4072727">(</span><span class="op" id="4072728">[</span><span class="op" id="4072729">]</span><span class="ident" id="4072730">Addr</span><span class="op" id="4072734">,</span>&nbsp;<span class="builtintype" id="4072736">error</span><span class="op" id="4072741">)</span>&nbsp;<span class="op" id="4072743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072746">tab</span><span class="op" id="4072749">,</span>&nbsp;<span class="ident" id="4072751">err</span>&nbsp;<span class="op" id="4072755">:=</span>&nbsp;<span class="ident" id="4072758">syscall</span><span class="op" id="4072765">.</span><span class="ident" id="4072766">NetlinkRIB</span><span class="op" id="4072776">(</span><span class="ident" id="4072777">syscall</span><span class="op" id="4072784">.</span><span class="ident" id="4072785">RTM_GETADDR</span><span class="op" id="4072796">,</span>&nbsp;<span class="ident" id="4072798">syscall</span><span class="op" id="4072805">.</span><span class="ident" id="4072806">AF_UNSPEC</span><span class="op" id="4072815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072818">if</span>&nbsp;<span class="ident" id="4072821">err</span>&nbsp;<span class="op" id="4072825">!=</span>&nbsp;<span class="ident" id="4072828">nil</span>&nbsp;<span class="op" id="4072832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072836">return</span>&nbsp;<span class="ident" id="4072843">nil</span><span class="op" id="4072846">,</span>&nbsp;<span class="ident" id="4072848">os</span><span class="op" id="4072850">.</span><span class="ident" id="4072851">NewSyscallError</span><span class="op" id="4072866">(</span><span class="string" id="4072867">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="4072880">,</span>&nbsp;<span class="ident" id="4072882">err</span><span class="op" id="4072885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4072888">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4072891">msgs</span><span class="op" id="4072895">,</span>&nbsp;<span class="ident" id="4072897">err</span>&nbsp;<span class="op" id="4072901">:=</span>&nbsp;<span class="ident" id="4072904">syscall</span><span class="op" id="4072911">.</span><span class="ident" id="4072912">ParseNetlinkMessage</span><span class="op" id="4072931">(</span><span class="ident" id="4072932">tab</span><span class="op" id="4072935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072938">if</span>&nbsp;<span class="ident" id="4072941">err</span>&nbsp;<span class="op" id="4072945">!=</span>&nbsp;<span class="ident" id="4072948">nil</span>&nbsp;<span class="op" id="4072952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4072956">return</span>&nbsp;<span class="ident" id="4072963">nil</span><span class="op" id="4072966">,</span>&nbsp;<span class="ident" id="4072968">os</span><span class="op" id="4072970">.</span><span class="ident" id="4072971">NewSyscallError</span><span class="op" id="4072986">(</span><span class="string" id="4072987">&#34;netlink&nbsp;message&#34;</span><span class="op" id="4073004">,</span>&nbsp;<span class="ident" id="4073006">err</span><span class="op" id="4073009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073015">var</span>&nbsp;<span class="ident" id="4073019">ift</span>&nbsp;<span class="op" id="4073023">[</span><span class="op" id="4073024">]</span><span class="ident" id="4073025">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073036">if</span>&nbsp;<span class="ident" id="4073039">ifi</span>&nbsp;<span class="op" id="4073043">==</span>&nbsp;<span class="ident" id="4073046">nil</span>&nbsp;<span class="op" id="4073050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073054">var</span>&nbsp;<span class="ident" id="4073058">err</span>&nbsp;<span class="builtintype" id="4073062">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073070">ift</span><span class="op" id="4073073">,</span>&nbsp;<span class="ident" id="4073075">err</span>&nbsp;<span class="op" id="4073079">=</span>&nbsp;<span class="ident" id="4073081">interfaceTable</span><span class="op" id="4073095">(</span><span class="num" id="4073096">0</span><span class="op" id="4073097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073101">if</span>&nbsp;<span class="ident" id="4073104">err</span>&nbsp;<span class="op" id="4073108">!=</span>&nbsp;<span class="ident" id="4073111">nil</span>&nbsp;<span class="op" id="4073115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073120">return</span>&nbsp;<span class="ident" id="4073127">nil</span><span class="op" id="4073130">,</span>&nbsp;<span class="ident" id="4073132">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073144">ifat</span><span class="op" id="4073148">,</span>&nbsp;<span class="ident" id="4073150">err</span>&nbsp;<span class="op" id="4073154">:=</span>&nbsp;<span class="ident" id="4073157">addrTable</span><span class="op" id="4073166">(</span><span class="ident" id="4073167">ift</span><span class="op" id="4073170">,</span>&nbsp;<span class="ident" id="4073172">ifi</span><span class="op" id="4073175">,</span>&nbsp;<span class="ident" id="4073177">msgs</span><span class="op" id="4073181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073184">if</span>&nbsp;<span class="ident" id="4073187">err</span>&nbsp;<span class="op" id="4073191">!=</span>&nbsp;<span class="ident" id="4073194">nil</span>&nbsp;<span class="op" id="4073198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073202">return</span>&nbsp;<span class="ident" id="4073209">nil</span><span class="op" id="4073212">,</span>&nbsp;<span class="ident" id="4073214">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073222">return</span>&nbsp;<span class="ident" id="4073229">ifat</span><span class="op" id="4073233">,</span>&nbsp;<span class="ident" id="4073235">nil</span><br>
<span class="lineno"></span><span class="op" id="4073239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4073242">func</span>&nbsp;<span class="ident" id="4073247">addrTable</span><span class="op" id="4073256">(</span><span class="ident" id="4073257">ift</span>&nbsp;<span class="op" id="4073261">[</span><span class="op" id="4073262">]</span><span class="ident" id="4073263">Interface</span><span class="op" id="4073272">,</span>&nbsp;<span class="ident" id="4073274">ifi</span>&nbsp;<span class="op" id="4073278">*</span><span class="ident" id="4073279">Interface</span><span class="op" id="4073288">,</span>&nbsp;<span class="ident" id="4073290">msgs</span>&nbsp;<span class="op" id="4073295">[</span><span class="op" id="4073296">]</span><span class="ident" id="4073297">syscall</span><span class="op" id="4073304">.</span><span class="ident" id="4073305">NetlinkMessage</span><span class="op" id="4073319">)</span>&nbsp;<span class="op" id="4073321">(</span><span class="op" id="4073322">[</span><span class="op" id="4073323">]</span><span class="ident" id="4073324">Addr</span><span class="op" id="4073328">,</span>&nbsp;<span class="builtintype" id="4073330">error</span><span class="op" id="4073335">)</span>&nbsp;<span class="op" id="4073337">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073340">var</span>&nbsp;<span class="ident" id="4073344">ifat</span>&nbsp;<span class="op" id="4073349">[</span><span class="op" id="4073350">]</span><span class="ident" id="4073351">Addr</span><br>
<span class="lineno"></span><span class="ident" id="4073356">loop</span><span class="op" id="4073360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073363">for</span>&nbsp;<span class="ident" id="4073367">_</span><span class="op" id="4073368">,</span>&nbsp;<span class="ident" id="4073370">m</span>&nbsp;<span class="op" id="4073372">:=</span>&nbsp;<span class="keyword" id="4073375">range</span>&nbsp;<span class="ident" id="4073381">msgs</span>&nbsp;<span class="op" id="4073386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073390">switch</span>&nbsp;<span class="ident" id="4073397">m</span><span class="op" id="4073398">.</span><span class="ident" id="4073399">Header</span><span class="op" id="4073405">.</span><span class="ident" id="4073406">Type</span>&nbsp;<span class="op" id="4073411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073415">case</span>&nbsp;<span class="ident" id="4073420">syscall</span><span class="op" id="4073427">.</span><span class="ident" id="4073428">NLMSG_DONE</span><span class="op" id="4073438">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073443">break</span>&nbsp;<span class="ident" id="4073449">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073456">case</span>&nbsp;<span class="ident" id="4073461">syscall</span><span class="op" id="4073468">.</span><span class="ident" id="4073469">RTM_NEWADDR</span><span class="op" id="4073480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073485">ifam</span>&nbsp;<span class="op" id="4073490">:=</span>&nbsp;<span class="op" id="4073493">(</span><span class="op" id="4073494">*</span><span class="ident" id="4073495">syscall</span><span class="op" id="4073502">.</span><span class="ident" id="4073503">IfAddrmsg</span><span class="op" id="4073512">)</span><span class="op" id="4073513">(</span><span class="ident" id="4073514">unsafe</span><span class="op" id="4073520">.</span><span class="ident" id="4073521">Pointer</span><span class="op" id="4073528">(</span><span class="op" id="4073529">&amp;</span><span class="ident" id="4073530">m</span><span class="op" id="4073531">.</span><span class="ident" id="4073532">Data</span><span class="op" id="4073536">[</span><span class="num" id="4073537">0</span><span class="op" id="4073538">]</span><span class="op" id="4073539">)</span><span class="op" id="4073540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073545">if</span>&nbsp;<span class="builtinfunc" id="4073548">len</span><span class="op" id="4073551">(</span><span class="ident" id="4073552">ift</span><span class="op" id="4073555">)</span>&nbsp;<span class="op" id="4073557">!=</span>&nbsp;<span class="num" id="4073560">0</span>&nbsp;<span class="op" id="4073562">||</span>&nbsp;<span class="ident" id="4073565">ifi</span><span class="op" id="4073568">.</span><span class="ident" id="4073569">Index</span>&nbsp;<span class="op" id="4073575">==</span>&nbsp;<span class="builtintype" id="4073578">int</span><span class="op" id="4073581">(</span><span class="ident" id="4073582">ifam</span><span class="op" id="4073586">.</span><span class="ident" id="4073587">Index</span><span class="op" id="4073592">)</span>&nbsp;<span class="op" id="4073594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073600">if</span>&nbsp;<span class="builtinfunc" id="4073603">len</span><span class="op" id="4073606">(</span><span class="ident" id="4073607">ift</span><span class="op" id="4073610">)</span>&nbsp;<span class="op" id="4073612">!=</span>&nbsp;<span class="num" id="4073615">0</span>&nbsp;<span class="op" id="4073617">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073624">var</span>&nbsp;<span class="ident" id="4073628">err</span>&nbsp;<span class="builtintype" id="4073632">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073643">ifi</span><span class="op" id="4073646">,</span>&nbsp;<span class="ident" id="4073648">err</span>&nbsp;<span class="op" id="4073652">=</span>&nbsp;<span class="ident" id="4073654">interfaceByIndex</span><span class="op" id="4073670">(</span><span class="ident" id="4073671">ift</span><span class="op" id="4073674">,</span>&nbsp;<span class="builtintype" id="4073676">int</span><span class="op" id="4073679">(</span><span class="ident" id="4073680">ifam</span><span class="op" id="4073684">.</span><span class="ident" id="4073685">Index</span><span class="op" id="4073690">)</span><span class="op" id="4073691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073698">if</span>&nbsp;<span class="ident" id="4073701">err</span>&nbsp;<span class="op" id="4073705">!=</span>&nbsp;<span class="ident" id="4073708">nil</span>&nbsp;<span class="op" id="4073712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073720">return</span>&nbsp;<span class="ident" id="4073727">nil</span><span class="op" id="4073730">,</span>&nbsp;<span class="ident" id="4073732">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073741">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073753">attrs</span><span class="op" id="4073758">,</span>&nbsp;<span class="ident" id="4073760">err</span>&nbsp;<span class="op" id="4073764">:=</span>&nbsp;<span class="ident" id="4073767">syscall</span><span class="op" id="4073774">.</span><span class="ident" id="4073775">ParseNetlinkRouteAttr</span><span class="op" id="4073796">(</span><span class="op" id="4073797">&amp;</span><span class="ident" id="4073798">m</span><span class="op" id="4073799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073805">if</span>&nbsp;<span class="ident" id="4073808">err</span>&nbsp;<span class="op" id="4073812">!=</span>&nbsp;<span class="ident" id="4073815">nil</span>&nbsp;<span class="op" id="4073819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073826">return</span>&nbsp;<span class="ident" id="4073833">nil</span><span class="op" id="4073836">,</span>&nbsp;<span class="ident" id="4073838">os</span><span class="op" id="4073840">.</span><span class="ident" id="4073841">NewSyscallError</span><span class="op" id="4073856">(</span><span class="string" id="4073857">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="4073876">,</span>&nbsp;<span class="ident" id="4073878">err</span><span class="op" id="4073881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073887">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073893">ifa</span>&nbsp;<span class="op" id="4073897">:=</span>&nbsp;<span class="ident" id="4073900">newAddr</span><span class="op" id="4073907">(</span><span class="ident" id="4073908">ifi</span><span class="op" id="4073911">,</span>&nbsp;<span class="ident" id="4073913">ifam</span><span class="op" id="4073917">,</span>&nbsp;<span class="ident" id="4073919">attrs</span><span class="op" id="4073924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073930">if</span>&nbsp;<span class="ident" id="4073933">ifa</span>&nbsp;<span class="op" id="4073937">!=</span>&nbsp;<span class="ident" id="4073940">nil</span>&nbsp;<span class="op" id="4073944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4073951">ifat</span>&nbsp;<span class="op" id="4073956">=</span>&nbsp;<span class="builtinfunc" id="4073958">append</span><span class="op" id="4073964">(</span><span class="ident" id="4073965">ifat</span><span class="op" id="4073969">,</span>&nbsp;<span class="ident" id="4073971">ifa</span><span class="op" id="4073974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073985">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4073992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4073995">return</span>&nbsp;<span class="ident" id="4074002">ifat</span><span class="op" id="4074006">,</span>&nbsp;<span class="ident" id="4074008">nil</span><br>
<span class="lineno"></span><span class="op" id="4074012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="4074015">func</span>&nbsp;<span class="ident" id="4074020">newAddr</span><span class="op" id="4074027">(</span><span class="ident" id="4074028">ifi</span>&nbsp;<span class="op" id="4074032">*</span><span class="ident" id="4074033">Interface</span><span class="op" id="4074042">,</span>&nbsp;<span class="ident" id="4074044">ifam</span>&nbsp;<span class="op" id="4074049">*</span><span class="ident" id="4074050">syscall</span><span class="op" id="4074057">.</span><span class="ident" id="4074058">IfAddrmsg</span><span class="op" id="4074067">,</span>&nbsp;<span class="ident" id="4074069">attrs</span>&nbsp;<span class="op" id="4074075">[</span><span class="op" id="4074076">]</span><span class="ident" id="4074077">syscall</span><span class="op" id="4074084">.</span><span class="ident" id="4074085">NetlinkRouteAttr</span><span class="op" id="4074101">)</span>&nbsp;<span class="ident" id="4074103">Addr</span>&nbsp;<span class="op" id="4074108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074111">var</span>&nbsp;<span class="ident" id="4074115">ipPointToPoint</span>&nbsp;<span class="builtintype" id="4074130">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074136">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074197">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4074260">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074315">if</span>&nbsp;<span class="ident" id="4074318">ifi</span><span class="op" id="4074321">.</span><span class="ident" id="4074322">Flags</span><span class="op" id="4074327">&amp;</span><span class="ident" id="4074328">FlagPointToPoint</span>&nbsp;<span class="op" id="4074345">!=</span>&nbsp;<span class="num" id="4074348">0</span>&nbsp;<span class="op" id="4074350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074354">for</span>&nbsp;<span class="ident" id="4074358">_</span><span class="op" id="4074359">,</span>&nbsp;<span class="ident" id="4074361">a</span>&nbsp;<span class="op" id="4074363">:=</span>&nbsp;<span class="keyword" id="4074366">range</span>&nbsp;<span class="ident" id="4074372">attrs</span>&nbsp;<span class="op" id="4074378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074383">if</span>&nbsp;<span class="ident" id="4074386">a</span><span class="op" id="4074387">.</span><span class="ident" id="4074388">Attr</span><span class="op" id="4074392">.</span><span class="ident" id="4074393">Type</span>&nbsp;<span class="op" id="4074398">==</span>&nbsp;<span class="ident" id="4074401">syscall</span><span class="op" id="4074408">.</span><span class="ident" id="4074409">IFA_LOCAL</span>&nbsp;<span class="op" id="4074419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074425">ipPointToPoint</span>&nbsp;<span class="op" id="4074440">=</span>&nbsp;<span class="builtintype" id="4074442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074451">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074470">for</span>&nbsp;<span class="ident" id="4074474">_</span><span class="op" id="4074475">,</span>&nbsp;<span class="ident" id="4074477">a</span>&nbsp;<span class="op" id="4074479">:=</span>&nbsp;<span class="keyword" id="4074482">range</span>&nbsp;<span class="ident" id="4074488">attrs</span>&nbsp;<span class="op" id="4074494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074498">if</span>&nbsp;<span class="ident" id="4074501">ipPointToPoint</span>&nbsp;<span class="op" id="4074516">&amp;&amp;</span>&nbsp;<span class="ident" id="4074519">a</span><span class="op" id="4074520">.</span><span class="ident" id="4074521">Attr</span><span class="op" id="4074525">.</span><span class="ident" id="4074526">Type</span>&nbsp;<span class="op" id="4074531">==</span>&nbsp;<span class="ident" id="4074534">syscall</span><span class="op" id="4074541">.</span><span class="ident" id="4074542">IFA_ADDRESS</span>&nbsp;<span class="op" id="4074554">||</span>&nbsp;<span class="op" id="4074557">!</span><span class="ident" id="4074558">ipPointToPoint</span>&nbsp;<span class="op" id="4074573">&amp;&amp;</span>&nbsp;<span class="ident" id="4074576">a</span><span class="op" id="4074577">.</span><span class="ident" id="4074578">Attr</span><span class="op" id="4074582">.</span><span class="ident" id="4074583">Type</span>&nbsp;<span class="op" id="4074588">==</span>&nbsp;<span class="ident" id="4074591">syscall</span><span class="op" id="4074598">.</span><span class="ident" id="4074599">IFA_LOCAL</span>&nbsp;<span class="op" id="4074609">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074614">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074629">switch</span>&nbsp;<span class="ident" id="4074636">ifam</span><span class="op" id="4074640">.</span><span class="ident" id="4074641">Family</span>&nbsp;<span class="op" id="4074648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074652">case</span>&nbsp;<span class="ident" id="4074657">syscall</span><span class="op" id="4074664">.</span><span class="ident" id="4074665">AF_INET</span><span class="op" id="4074672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074677">return</span>&nbsp;<span class="op" id="4074684">&amp;</span><span class="ident" id="4074685">IPNet</span><span class="op" id="4074690">{</span><span class="ident" id="4074691">IP</span><span class="op" id="4074693">:</span>&nbsp;<span class="ident" id="4074695">IPv4</span><span class="op" id="4074699">(</span><span class="ident" id="4074700">a</span><span class="op" id="4074701">.</span><span class="ident" id="4074702">Value</span><span class="op" id="4074707">[</span><span class="num" id="4074708">0</span><span class="op" id="4074709">]</span><span class="op" id="4074710">,</span>&nbsp;<span class="ident" id="4074712">a</span><span class="op" id="4074713">.</span><span class="ident" id="4074714">Value</span><span class="op" id="4074719">[</span><span class="num" id="4074720">1</span><span class="op" id="4074721">]</span><span class="op" id="4074722">,</span>&nbsp;<span class="ident" id="4074724">a</span><span class="op" id="4074725">.</span><span class="ident" id="4074726">Value</span><span class="op" id="4074731">[</span><span class="num" id="4074732">2</span><span class="op" id="4074733">]</span><span class="op" id="4074734">,</span>&nbsp;<span class="ident" id="4074736">a</span><span class="op" id="4074737">.</span><span class="ident" id="4074738">Value</span><span class="op" id="4074743">[</span><span class="num" id="4074744">3</span><span class="op" id="4074745">]</span><span class="op" id="4074746">)</span><span class="op" id="4074747">,</span>&nbsp;<span class="ident" id="4074749">Mask</span><span class="op" id="4074753">:</span>&nbsp;<span class="ident" id="4074755">CIDRMask</span><span class="op" id="4074763">(</span><span class="builtintype" id="4074764">int</span><span class="op" id="4074767">(</span><span class="ident" id="4074768">ifam</span><span class="op" id="4074772">.</span><span class="ident" id="4074773">Prefixlen</span><span class="op" id="4074782">)</span><span class="op" id="4074783">,</span>&nbsp;<span class="num" id="4074785">8</span><span class="op" id="4074786">*</span><span class="ident" id="4074787">IPv4len</span><span class="op" id="4074794">)</span><span class="op" id="4074795">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074799">case</span>&nbsp;<span class="ident" id="4074804">syscall</span><span class="op" id="4074811">.</span><span class="ident" id="4074812">AF_INET6</span><span class="op" id="4074820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4074825">ifa</span>&nbsp;<span class="op" id="4074829">:=</span>&nbsp;<span class="op" id="4074832">&amp;</span><span class="ident" id="4074833">IPNet</span><span class="op" id="4074838">{</span><span class="ident" id="4074839">IP</span><span class="op" id="4074841">:</span>&nbsp;<span class="builtinfunc" id="4074843">make</span><span class="op" id="4074847">(</span><span class="ident" id="4074848">IP</span><span class="op" id="4074850">,</span>&nbsp;<span class="ident" id="4074852">IPv6len</span><span class="op" id="4074859">)</span><span class="op" id="4074860">,</span>&nbsp;<span class="ident" id="4074862">Mask</span><span class="op" id="4074866">:</span>&nbsp;<span class="ident" id="4074868">CIDRMask</span><span class="op" id="4074876">(</span><span class="builtintype" id="4074877">int</span><span class="op" id="4074880">(</span><span class="ident" id="4074881">ifam</span><span class="op" id="4074885">.</span><span class="ident" id="4074886">Prefixlen</span><span class="op" id="4074895">)</span><span class="op" id="4074896">,</span>&nbsp;<span class="num" id="4074898">8</span><span class="op" id="4074899">*</span><span class="ident" id="4074900">IPv6len</span><span class="op" id="4074907">)</span><span class="op" id="4074908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4074913">copy</span><span class="op" id="4074917">(</span><span class="ident" id="4074918">ifa</span><span class="op" id="4074921">.</span><span class="ident" id="4074922">IP</span><span class="op" id="4074924">,</span>&nbsp;<span class="ident" id="4074926">a</span><span class="op" id="4074927">.</span><span class="ident" id="4074928">Value</span><span class="op" id="4074933">[</span><span class="op" id="4074934">:</span><span class="op" id="4074935">]</span><span class="op" id="4074936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074941">return</span>&nbsp;<span class="ident" id="4074948">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074954">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4074957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4074960">return</span>&nbsp;<span class="ident" id="4074967">nil</span><br>
<span class="lineno"></span><span class="op" id="4074971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4074974">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="4075038">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4075052">func</span>&nbsp;<span class="ident" id="4075057">interfaceMulticastAddrTable</span><span class="op" id="4075084">(</span><span class="ident" id="4075085">ifi</span>&nbsp;<span class="op" id="4075089">*</span><span class="ident" id="4075090">Interface</span><span class="op" id="4075099">)</span>&nbsp;<span class="op" id="4075101">(</span><span class="op" id="4075102">[</span><span class="op" id="4075103">]</span><span class="ident" id="4075104">Addr</span><span class="op" id="4075108">,</span>&nbsp;<span class="builtintype" id="4075110">error</span><span class="op" id="4075115">)</span>&nbsp;<span class="op" id="4075117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075120">ifmat4</span>&nbsp;<span class="op" id="4075127">:=</span>&nbsp;<span class="ident" id="4075130">parseProcNetIGMP</span><span class="op" id="4075146">(</span><span class="string" id="4075147">&#34;/proc/net/igmp&#34;</span><span class="op" id="4075163">,</span>&nbsp;<span class="ident" id="4075165">ifi</span><span class="op" id="4075168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075171">ifmat6</span>&nbsp;<span class="op" id="4075178">:=</span>&nbsp;<span class="ident" id="4075181">parseProcNetIGMP6</span><span class="op" id="4075198">(</span><span class="string" id="4075199">&#34;/proc/net/igmp6&#34;</span><span class="op" id="4075216">,</span>&nbsp;<span class="ident" id="4075218">ifi</span><span class="op" id="4075221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075224">return</span>&nbsp;<span class="builtinfunc" id="4075231">append</span><span class="op" id="4075237">(</span><span class="ident" id="4075238">ifmat4</span><span class="op" id="4075244">,</span>&nbsp;<span class="ident" id="4075246">ifmat6</span><span class="op" id="4075252">...</span><span class="op" id="4075255">)</span><span class="op" id="4075256">,</span>&nbsp;<span class="ident" id="4075258">nil</span><br>
<span class="lineno">210</span><span class="op" id="4075262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4075265">func</span>&nbsp;<span class="ident" id="4075270">parseProcNetIGMP</span><span class="op" id="4075286">(</span><span class="ident" id="4075287">path</span>&nbsp;<span class="builtintype" id="4075292">string</span><span class="op" id="4075298">,</span>&nbsp;<span class="ident" id="4075300">ifi</span>&nbsp;<span class="op" id="4075304">*</span><span class="ident" id="4075305">Interface</span><span class="op" id="4075314">)</span>&nbsp;<span class="op" id="4075316">[</span><span class="op" id="4075317">]</span><span class="ident" id="4075318">Addr</span>&nbsp;<span class="op" id="4075323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075326">fd</span><span class="op" id="4075328">,</span>&nbsp;<span class="ident" id="4075330">err</span>&nbsp;<span class="op" id="4075334">:=</span>&nbsp;<span class="ident" id="4075337">open</span><span class="op" id="4075341">(</span><span class="ident" id="4075342">path</span><span class="op" id="4075346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075349">if</span>&nbsp;<span class="ident" id="4075352">err</span>&nbsp;<span class="op" id="4075356">!=</span>&nbsp;<span class="ident" id="4075359">nil</span>&nbsp;<span class="op" id="4075363">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075367">return</span>&nbsp;<span class="ident" id="4075374">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075382">defer</span>&nbsp;<span class="ident" id="4075388">fd</span><span class="op" id="4075390">.</span><span class="builtinfunc" id="4075391">close</span><span class="op" id="4075396">(</span><span class="op" id="4075397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075400">var</span>&nbsp;<span class="op" id="4075404">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075408">ifmat</span>&nbsp;<span class="op" id="4075414">[</span><span class="op" id="4075415">]</span><span class="ident" id="4075416">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075423">name</span>&nbsp;&nbsp;<span class="builtintype" id="4075429">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075440">fd</span><span class="op" id="4075442">.</span><span class="ident" id="4075443">readLine</span><span class="op" id="4075451">(</span><span class="op" id="4075452">)</span>&nbsp;<span class="comment" id="4075454">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075474">b</span>&nbsp;<span class="op" id="4075476">:=</span>&nbsp;<span class="builtinfunc" id="4075479">make</span><span class="op" id="4075483">(</span><span class="op" id="4075484">[</span><span class="op" id="4075485">]</span><span class="builtintype" id="4075486">byte</span><span class="op" id="4075490">,</span>&nbsp;<span class="ident" id="4075492">IPv4len</span><span class="op" id="4075499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075502">for</span>&nbsp;<span class="ident" id="4075506">l</span><span class="op" id="4075507">,</span>&nbsp;<span class="ident" id="4075509">ok</span>&nbsp;<span class="op" id="4075512">:=</span>&nbsp;<span class="ident" id="4075515">fd</span><span class="op" id="4075517">.</span><span class="ident" id="4075518">readLine</span><span class="op" id="4075526">(</span><span class="op" id="4075527">)</span><span class="op" id="4075528">;</span>&nbsp;<span class="ident" id="4075530">ok</span><span class="op" id="4075532">;</span>&nbsp;<span class="ident" id="4075534">l</span><span class="op" id="4075535">,</span>&nbsp;<span class="ident" id="4075537">ok</span>&nbsp;<span class="op" id="4075540">=</span>&nbsp;<span class="ident" id="4075542">fd</span><span class="op" id="4075544">.</span><span class="ident" id="4075545">readLine</span><span class="op" id="4075553">(</span><span class="op" id="4075554">)</span>&nbsp;<span class="op" id="4075556">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075560">f</span>&nbsp;<span class="op" id="4075562">:=</span>&nbsp;<span class="ident" id="4075565">splitAtBytes</span><span class="op" id="4075577">(</span><span class="ident" id="4075578">l</span><span class="op" id="4075579">,</span>&nbsp;<span class="string" id="4075581">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="4075591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075595">if</span>&nbsp;<span class="builtinfunc" id="4075598">len</span><span class="op" id="4075601">(</span><span class="ident" id="4075602">f</span><span class="op" id="4075603">)</span>&nbsp;<span class="op" id="4075605">&lt;</span>&nbsp;<span class="num" id="4075607">4</span>&nbsp;<span class="op" id="4075609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075614">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075629">switch</span>&nbsp;<span class="op" id="4075636">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075640">case</span>&nbsp;<span class="ident" id="4075645">l</span><span class="op" id="4075646">[</span><span class="num" id="4075647">0</span><span class="op" id="4075648">]</span>&nbsp;<span class="op" id="4075650">!=</span>&nbsp;<span class="string" id="4075653">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4075657">&amp;&amp;</span>&nbsp;<span class="ident" id="4075660">l</span><span class="op" id="4075661">[</span><span class="num" id="4075662">0</span><span class="op" id="4075663">]</span>&nbsp;<span class="op" id="4075665">!=</span>&nbsp;<span class="string" id="4075668">&#39;\t&#39;</span><span class="op" id="4075672">:</span>&nbsp;<span class="comment" id="4075674">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075699">name</span>&nbsp;<span class="op" id="4075704">=</span>&nbsp;<span class="ident" id="4075706">f</span><span class="op" id="4075707">[</span><span class="num" id="4075708">1</span><span class="op" id="4075709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075713">case</span>&nbsp;<span class="builtinfunc" id="4075718">len</span><span class="op" id="4075721">(</span><span class="ident" id="4075722">f</span><span class="op" id="4075723">[</span><span class="num" id="4075724">0</span><span class="op" id="4075725">]</span><span class="op" id="4075726">)</span>&nbsp;<span class="op" id="4075728">==</span>&nbsp;<span class="num" id="4075731">8</span><span class="op" id="4075732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075737">if</span>&nbsp;<span class="ident" id="4075740">ifi</span>&nbsp;<span class="op" id="4075744">==</span>&nbsp;<span class="ident" id="4075747">nil</span>&nbsp;<span class="op" id="4075751">||</span>&nbsp;<span class="ident" id="4075754">name</span>&nbsp;<span class="op" id="4075759">==</span>&nbsp;<span class="ident" id="4075762">ifi</span><span class="op" id="4075765">.</span><span class="ident" id="4075766">Name</span>&nbsp;<span class="op" id="4075771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075777">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075813">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4075856">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075875">for</span>&nbsp;<span class="ident" id="4075879">i</span>&nbsp;<span class="op" id="4075881">:=</span>&nbsp;<span class="num" id="4075884">0</span><span class="op" id="4075885">;</span>&nbsp;<span class="ident" id="4075887">i</span><span class="op" id="4075888">+</span><span class="num" id="4075889">1</span>&nbsp;<span class="op" id="4075891">&lt;</span>&nbsp;<span class="builtinfunc" id="4075893">len</span><span class="op" id="4075896">(</span><span class="ident" id="4075897">f</span><span class="op" id="4075898">[</span><span class="num" id="4075899">0</span><span class="op" id="4075900">]</span><span class="op" id="4075901">)</span><span class="op" id="4075902">;</span>&nbsp;<span class="ident" id="4075904">i</span>&nbsp;<span class="op" id="4075906">+=</span>&nbsp;<span class="num" id="4075909">2</span>&nbsp;<span class="op" id="4075911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075918">b</span><span class="op" id="4075919">[</span><span class="ident" id="4075920">i</span><span class="op" id="4075921">/</span><span class="num" id="4075922">2</span><span class="op" id="4075923">]</span><span class="op" id="4075924">,</span>&nbsp;<span class="ident" id="4075926">_</span>&nbsp;<span class="op" id="4075928">=</span>&nbsp;<span class="ident" id="4075930">xtoi2</span><span class="op" id="4075935">(</span><span class="ident" id="4075936">f</span><span class="op" id="4075937">[</span><span class="num" id="4075938">0</span><span class="op" id="4075939">]</span><span class="op" id="4075940">[</span><span class="ident" id="4075941">i</span><span class="op" id="4075942">:</span><span class="ident" id="4075943">i</span><span class="op" id="4075944">+</span><span class="num" id="4075945">2</span><span class="op" id="4075946">]</span><span class="op" id="4075947">,</span>&nbsp;<span class="num" id="4075949">0</span><span class="op" id="4075950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4075956">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075962">i</span>&nbsp;<span class="op" id="4075964">:=</span>&nbsp;<span class="op" id="4075967">*</span><span class="op" id="4075968">(</span><span class="op" id="4075969">*</span><span class="builtintype" id="4075970">uint32</span><span class="op" id="4075976">)</span><span class="op" id="4075977">(</span><span class="ident" id="4075978">unsafe</span><span class="op" id="4075984">.</span><span class="ident" id="4075985">Pointer</span><span class="op" id="4075992">(</span><span class="op" id="4075993">&amp;</span><span class="ident" id="4075994">b</span><span class="op" id="4075995">[</span><span class="op" id="4075996">:</span><span class="num" id="4075997">4</span><span class="op" id="4075998">]</span><span class="op" id="4075999">[</span><span class="num" id="4076000">0</span><span class="op" id="4076001">]</span><span class="op" id="4076002">)</span><span class="op" id="4076003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076009">ifma</span>&nbsp;<span class="op" id="4076014">:=</span>&nbsp;<span class="ident" id="4076017">IPAddr</span><span class="op" id="4076023">{</span><span class="ident" id="4076024">IP</span><span class="op" id="4076026">:</span>&nbsp;<span class="ident" id="4076028">IPv4</span><span class="op" id="4076032">(</span><span class="builtintype" id="4076033">byte</span><span class="op" id="4076037">(</span><span class="ident" id="4076038">i</span><span class="op" id="4076039">&gt;&gt;</span><span class="num" id="4076041">24</span><span class="op" id="4076043">)</span><span class="op" id="4076044">,</span>&nbsp;<span class="builtintype" id="4076046">byte</span><span class="op" id="4076050">(</span><span class="ident" id="4076051">i</span><span class="op" id="4076052">&gt;&gt;</span><span class="num" id="4076054">16</span><span class="op" id="4076056">)</span><span class="op" id="4076057">,</span>&nbsp;<span class="builtintype" id="4076059">byte</span><span class="op" id="4076063">(</span><span class="ident" id="4076064">i</span><span class="op" id="4076065">&gt;&gt;</span><span class="num" id="4076067">8</span><span class="op" id="4076068">)</span><span class="op" id="4076069">,</span>&nbsp;<span class="builtintype" id="4076071">byte</span><span class="op" id="4076075">(</span><span class="ident" id="4076076">i</span><span class="op" id="4076077">)</span><span class="op" id="4076078">)</span><span class="op" id="4076079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076085">ifmat</span>&nbsp;<span class="op" id="4076091">=</span>&nbsp;<span class="builtinfunc" id="4076093">append</span><span class="op" id="4076099">(</span><span class="ident" id="4076100">ifmat</span><span class="op" id="4076105">,</span>&nbsp;<span class="ident" id="4076107">ifma</span><span class="op" id="4076111">.</span><span class="ident" id="4076112">toAddr</span><span class="op" id="4076118">(</span><span class="op" id="4076119">)</span><span class="op" id="4076120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076129">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076135">return</span>&nbsp;<span class="ident" id="4076142">ifmat</span><br>
<span class="lineno"></span><span class="op" id="4076148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4076151">func</span>&nbsp;<span class="ident" id="4076156">parseProcNetIGMP6</span><span class="op" id="4076173">(</span><span class="ident" id="4076174">path</span>&nbsp;<span class="builtintype" id="4076179">string</span><span class="op" id="4076185">,</span>&nbsp;<span class="ident" id="4076187">ifi</span>&nbsp;<span class="op" id="4076191">*</span><span class="ident" id="4076192">Interface</span><span class="op" id="4076201">)</span>&nbsp;<span class="op" id="4076203">[</span><span class="op" id="4076204">]</span><span class="ident" id="4076205">Addr</span>&nbsp;<span class="op" id="4076210">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076213">fd</span><span class="op" id="4076215">,</span>&nbsp;<span class="ident" id="4076217">err</span>&nbsp;<span class="op" id="4076221">:=</span>&nbsp;<span class="ident" id="4076224">open</span><span class="op" id="4076228">(</span><span class="ident" id="4076229">path</span><span class="op" id="4076233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076236">if</span>&nbsp;<span class="ident" id="4076239">err</span>&nbsp;<span class="op" id="4076243">!=</span>&nbsp;<span class="ident" id="4076246">nil</span>&nbsp;<span class="op" id="4076250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076254">return</span>&nbsp;<span class="ident" id="4076261">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076269">defer</span>&nbsp;<span class="ident" id="4076275">fd</span><span class="op" id="4076277">.</span><span class="builtinfunc" id="4076278">close</span><span class="op" id="4076283">(</span><span class="op" id="4076284">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076287">var</span>&nbsp;<span class="ident" id="4076291">ifmat</span>&nbsp;<span class="op" id="4076297">[</span><span class="op" id="4076298">]</span><span class="ident" id="4076299">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076305">b</span>&nbsp;<span class="op" id="4076307">:=</span>&nbsp;<span class="builtinfunc" id="4076310">make</span><span class="op" id="4076314">(</span><span class="op" id="4076315">[</span><span class="op" id="4076316">]</span><span class="builtintype" id="4076317">byte</span><span class="op" id="4076321">,</span>&nbsp;<span class="ident" id="4076323">IPv6len</span><span class="op" id="4076330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076333">for</span>&nbsp;<span class="ident" id="4076337">l</span><span class="op" id="4076338">,</span>&nbsp;<span class="ident" id="4076340">ok</span>&nbsp;<span class="op" id="4076343">:=</span>&nbsp;<span class="ident" id="4076346">fd</span><span class="op" id="4076348">.</span><span class="ident" id="4076349">readLine</span><span class="op" id="4076357">(</span><span class="op" id="4076358">)</span><span class="op" id="4076359">;</span>&nbsp;<span class="ident" id="4076361">ok</span><span class="op" id="4076363">;</span>&nbsp;<span class="ident" id="4076365">l</span><span class="op" id="4076366">,</span>&nbsp;<span class="ident" id="4076368">ok</span>&nbsp;<span class="op" id="4076371">=</span>&nbsp;<span class="ident" id="4076373">fd</span><span class="op" id="4076375">.</span><span class="ident" id="4076376">readLine</span><span class="op" id="4076384">(</span><span class="op" id="4076385">)</span>&nbsp;<span class="op" id="4076387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076391">f</span>&nbsp;<span class="op" id="4076393">:=</span>&nbsp;<span class="ident" id="4076396">splitAtBytes</span><span class="op" id="4076408">(</span><span class="ident" id="4076409">l</span><span class="op" id="4076410">,</span>&nbsp;<span class="string" id="4076412">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="4076421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076425">if</span>&nbsp;<span class="builtinfunc" id="4076428">len</span><span class="op" id="4076431">(</span><span class="ident" id="4076432">f</span><span class="op" id="4076433">)</span>&nbsp;<span class="op" id="4076435">&lt;</span>&nbsp;<span class="num" id="4076437">6</span>&nbsp;<span class="op" id="4076439">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076459">if</span>&nbsp;<span class="ident" id="4076462">ifi</span>&nbsp;<span class="op" id="4076466">==</span>&nbsp;<span class="ident" id="4076469">nil</span>&nbsp;<span class="op" id="4076473">||</span>&nbsp;<span class="ident" id="4076476">f</span><span class="op" id="4076477">[</span><span class="num" id="4076478">1</span><span class="op" id="4076479">]</span>&nbsp;<span class="op" id="4076481">==</span>&nbsp;<span class="ident" id="4076484">ifi</span><span class="op" id="4076487">.</span><span class="ident" id="4076488">Name</span>&nbsp;<span class="op" id="4076493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076498">for</span>&nbsp;<span class="ident" id="4076502">i</span>&nbsp;<span class="op" id="4076504">:=</span>&nbsp;<span class="num" id="4076507">0</span><span class="op" id="4076508">;</span>&nbsp;<span class="ident" id="4076510">i</span><span class="op" id="4076511">+</span><span class="num" id="4076512">1</span>&nbsp;<span class="op" id="4076514">&lt;</span>&nbsp;<span class="builtinfunc" id="4076516">len</span><span class="op" id="4076519">(</span><span class="ident" id="4076520">f</span><span class="op" id="4076521">[</span><span class="num" id="4076522">2</span><span class="op" id="4076523">]</span><span class="op" id="4076524">)</span><span class="op" id="4076525">;</span>&nbsp;<span class="ident" id="4076527">i</span>&nbsp;<span class="op" id="4076529">+=</span>&nbsp;<span class="num" id="4076532">2</span>&nbsp;<span class="op" id="4076534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076540">b</span><span class="op" id="4076541">[</span><span class="ident" id="4076542">i</span><span class="op" id="4076543">/</span><span class="num" id="4076544">2</span><span class="op" id="4076545">]</span><span class="op" id="4076546">,</span>&nbsp;<span class="ident" id="4076548">_</span>&nbsp;<span class="op" id="4076550">=</span>&nbsp;<span class="ident" id="4076552">xtoi2</span><span class="op" id="4076557">(</span><span class="ident" id="4076558">f</span><span class="op" id="4076559">[</span><span class="num" id="4076560">2</span><span class="op" id="4076561">]</span><span class="op" id="4076562">[</span><span class="ident" id="4076563">i</span><span class="op" id="4076564">:</span><span class="ident" id="4076565">i</span><span class="op" id="4076566">+</span><span class="num" id="4076567">2</span><span class="op" id="4076568">]</span><span class="op" id="4076569">,</span>&nbsp;<span class="num" id="4076571">0</span><span class="op" id="4076572">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076582">ifma</span>&nbsp;<span class="op" id="4076587">:=</span>&nbsp;<span class="ident" id="4076590">IPAddr</span><span class="op" id="4076596">{</span><span class="ident" id="4076597">IP</span><span class="op" id="4076599">:</span>&nbsp;<span class="ident" id="4076601">IP</span><span class="op" id="4076603">{</span><span class="ident" id="4076604">b</span><span class="op" id="4076605">[</span><span class="num" id="4076606">0</span><span class="op" id="4076607">]</span><span class="op" id="4076608">,</span>&nbsp;<span class="ident" id="4076610">b</span><span class="op" id="4076611">[</span><span class="num" id="4076612">1</span><span class="op" id="4076613">]</span><span class="op" id="4076614">,</span>&nbsp;<span class="ident" id="4076616">b</span><span class="op" id="4076617">[</span><span class="num" id="4076618">2</span><span class="op" id="4076619">]</span><span class="op" id="4076620">,</span>&nbsp;<span class="ident" id="4076622">b</span><span class="op" id="4076623">[</span><span class="num" id="4076624">3</span><span class="op" id="4076625">]</span><span class="op" id="4076626">,</span>&nbsp;<span class="ident" id="4076628">b</span><span class="op" id="4076629">[</span><span class="num" id="4076630">4</span><span class="op" id="4076631">]</span><span class="op" id="4076632">,</span>&nbsp;<span class="ident" id="4076634">b</span><span class="op" id="4076635">[</span><span class="num" id="4076636">5</span><span class="op" id="4076637">]</span><span class="op" id="4076638">,</span>&nbsp;<span class="ident" id="4076640">b</span><span class="op" id="4076641">[</span><span class="num" id="4076642">6</span><span class="op" id="4076643">]</span><span class="op" id="4076644">,</span>&nbsp;<span class="ident" id="4076646">b</span><span class="op" id="4076647">[</span><span class="num" id="4076648">7</span><span class="op" id="4076649">]</span><span class="op" id="4076650">,</span>&nbsp;<span class="ident" id="4076652">b</span><span class="op" id="4076653">[</span><span class="num" id="4076654">8</span><span class="op" id="4076655">]</span><span class="op" id="4076656">,</span>&nbsp;<span class="ident" id="4076658">b</span><span class="op" id="4076659">[</span><span class="num" id="4076660">9</span><span class="op" id="4076661">]</span><span class="op" id="4076662">,</span>&nbsp;<span class="ident" id="4076664">b</span><span class="op" id="4076665">[</span><span class="num" id="4076666">10</span><span class="op" id="4076668">]</span><span class="op" id="4076669">,</span>&nbsp;<span class="ident" id="4076671">b</span><span class="op" id="4076672">[</span><span class="num" id="4076673">11</span><span class="op" id="4076675">]</span><span class="op" id="4076676">,</span>&nbsp;<span class="ident" id="4076678">b</span><span class="op" id="4076679">[</span><span class="num" id="4076680">12</span><span class="op" id="4076682">]</span><span class="op" id="4076683">,</span>&nbsp;<span class="ident" id="4076685">b</span><span class="op" id="4076686">[</span><span class="num" id="4076687">13</span><span class="op" id="4076689">]</span><span class="op" id="4076690">,</span>&nbsp;<span class="ident" id="4076692">b</span><span class="op" id="4076693">[</span><span class="num" id="4076694">14</span><span class="op" id="4076696">]</span><span class="op" id="4076697">,</span>&nbsp;<span class="ident" id="4076699">b</span><span class="op" id="4076700">[</span><span class="num" id="4076701">15</span><span class="op" id="4076703">]</span><span class="op" id="4076704">}</span><span class="op" id="4076705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076710">ifmat</span>&nbsp;<span class="op" id="4076716">=</span>&nbsp;<span class="builtinfunc" id="4076718">append</span><span class="op" id="4076724">(</span><span class="ident" id="4076725">ifmat</span><span class="op" id="4076730">,</span>&nbsp;<span class="ident" id="4076732">ifma</span><span class="op" id="4076736">.</span><span class="ident" id="4076737">toAddr</span><span class="op" id="4076743">(</span><span class="op" id="4076744">)</span><span class="op" id="4076745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076752">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076755">return</span>&nbsp;<span class="ident" id="4076762">ifmat</span><br>
<span class="lineno"></span><span class="op" id="4076768">}</span>
</div>
</body>
</html>
