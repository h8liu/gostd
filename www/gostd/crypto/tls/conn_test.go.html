<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7054504">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7054559">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7054613">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7054664">package</span>&nbsp;<span class="ident" id="7054672">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7054677">import</span>&nbsp;<span class="op" id="7054684">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7054687">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7054697">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7054700">func</span>&nbsp;<span class="ident" id="7054705">TestRoundUp</span><span class="op" id="7054716">(</span><span class="ident" id="7054717">t</span>&nbsp;<span class="op" id="7054719">*</span><span class="ident" id="7054720">testing</span><span class="op" id="7054727">.</span><span class="ident" id="7054728">T</span><span class="op" id="7054729">)</span>&nbsp;<span class="op" id="7054731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7054734">if</span>&nbsp;<span class="ident" id="7054737">roundUp</span><span class="op" id="7054744">(</span><span class="num" id="7054745">0</span><span class="op" id="7054746">,</span>&nbsp;<span class="num" id="7054748">16</span><span class="op" id="7054750">)</span>&nbsp;<span class="op" id="7054752">!=</span>&nbsp;<span class="num" id="7054755">0</span>&nbsp;<span class="op" id="7054757">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054762">roundUp</span><span class="op" id="7054769">(</span><span class="num" id="7054770">1</span><span class="op" id="7054771">,</span>&nbsp;<span class="num" id="7054773">16</span><span class="op" id="7054775">)</span>&nbsp;<span class="op" id="7054777">!=</span>&nbsp;<span class="num" id="7054780">16</span>&nbsp;<span class="op" id="7054783">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054788">roundUp</span><span class="op" id="7054795">(</span><span class="num" id="7054796">15</span><span class="op" id="7054798">,</span>&nbsp;<span class="num" id="7054800">16</span><span class="op" id="7054802">)</span>&nbsp;<span class="op" id="7054804">!=</span>&nbsp;<span class="num" id="7054807">16</span>&nbsp;<span class="op" id="7054810">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054815">roundUp</span><span class="op" id="7054822">(</span><span class="num" id="7054823">16</span><span class="op" id="7054825">,</span>&nbsp;<span class="num" id="7054827">16</span><span class="op" id="7054829">)</span>&nbsp;<span class="op" id="7054831">!=</span>&nbsp;<span class="num" id="7054834">16</span>&nbsp;<span class="op" id="7054837">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054842">roundUp</span><span class="op" id="7054849">(</span><span class="num" id="7054850">17</span><span class="op" id="7054852">,</span>&nbsp;<span class="num" id="7054854">16</span><span class="op" id="7054856">)</span>&nbsp;<span class="op" id="7054858">!=</span>&nbsp;<span class="num" id="7054861">32</span>&nbsp;<span class="op" id="7054864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054868">t</span><span class="op" id="7054869">.</span><span class="ident" id="7054870">Error</span><span class="op" id="7054875">(</span><span class="string" id="7054876">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7054892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7054895">}</span><br>
<span class="lineno"></span><span class="op" id="7054897">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7054900">var</span>&nbsp;<span class="ident" id="7054904">paddingTests</span>&nbsp;<span class="op" id="7054917">=</span>&nbsp;<span class="op" id="7054919">[</span><span class="op" id="7054920">]</span><span class="keyword" id="7054921">struct</span>&nbsp;<span class="op" id="7054928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054931">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7054943">[</span><span class="op" id="7054944">]</span><span class="builtintype" id="7054945">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054951">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7054963">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7054969">expectedLen</span>&nbsp;<span class="builtintype" id="7054981">int</span><br>
<span class="lineno">25</span><span class="op" id="7054985">}</span><span class="op" id="7054986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7054989">{</span><span class="op" id="7054990">[</span><span class="op" id="7054991">]</span><span class="builtintype" id="7054992">byte</span><span class="op" id="7054996">{</span><span class="num" id="7054997">1</span><span class="op" id="7054998">,</span>&nbsp;<span class="num" id="7055000">2</span><span class="op" id="7055001">,</span>&nbsp;<span class="num" id="7055003">3</span><span class="op" id="7055004">,</span>&nbsp;<span class="num" id="7055006">4</span><span class="op" id="7055007">,</span>&nbsp;<span class="num" id="7055009">0</span><span class="op" id="7055010">}</span><span class="op" id="7055011">,</span>&nbsp;<span class="builtintype" id="7055013">true</span><span class="op" id="7055017">,</span>&nbsp;<span class="num" id="7055019">4</span><span class="op" id="7055020">}</span><span class="op" id="7055021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055024">{</span><span class="op" id="7055025">[</span><span class="op" id="7055026">]</span><span class="builtintype" id="7055027">byte</span><span class="op" id="7055031">{</span><span class="num" id="7055032">1</span><span class="op" id="7055033">,</span>&nbsp;<span class="num" id="7055035">2</span><span class="op" id="7055036">,</span>&nbsp;<span class="num" id="7055038">3</span><span class="op" id="7055039">,</span>&nbsp;<span class="num" id="7055041">4</span><span class="op" id="7055042">,</span>&nbsp;<span class="num" id="7055044">0</span><span class="op" id="7055045">,</span>&nbsp;<span class="num" id="7055047">1</span><span class="op" id="7055048">}</span><span class="op" id="7055049">,</span>&nbsp;<span class="builtintype" id="7055051">false</span><span class="op" id="7055056">,</span>&nbsp;<span class="num" id="7055058">0</span><span class="op" id="7055059">}</span><span class="op" id="7055060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055063">{</span><span class="op" id="7055064">[</span><span class="op" id="7055065">]</span><span class="builtintype" id="7055066">byte</span><span class="op" id="7055070">{</span><span class="num" id="7055071">1</span><span class="op" id="7055072">,</span>&nbsp;<span class="num" id="7055074">2</span><span class="op" id="7055075">,</span>&nbsp;<span class="num" id="7055077">3</span><span class="op" id="7055078">,</span>&nbsp;<span class="num" id="7055080">4</span><span class="op" id="7055081">,</span>&nbsp;<span class="num" id="7055083">99</span><span class="op" id="7055085">,</span>&nbsp;<span class="num" id="7055087">99</span><span class="op" id="7055089">}</span><span class="op" id="7055090">,</span>&nbsp;<span class="builtintype" id="7055092">false</span><span class="op" id="7055097">,</span>&nbsp;<span class="num" id="7055099">0</span><span class="op" id="7055100">}</span><span class="op" id="7055101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055104">{</span><span class="op" id="7055105">[</span><span class="op" id="7055106">]</span><span class="builtintype" id="7055107">byte</span><span class="op" id="7055111">{</span><span class="num" id="7055112">1</span><span class="op" id="7055113">,</span>&nbsp;<span class="num" id="7055115">2</span><span class="op" id="7055116">,</span>&nbsp;<span class="num" id="7055118">3</span><span class="op" id="7055119">,</span>&nbsp;<span class="num" id="7055121">4</span><span class="op" id="7055122">,</span>&nbsp;<span class="num" id="7055124">1</span><span class="op" id="7055125">,</span>&nbsp;<span class="num" id="7055127">1</span><span class="op" id="7055128">}</span><span class="op" id="7055129">,</span>&nbsp;<span class="builtintype" id="7055131">true</span><span class="op" id="7055135">,</span>&nbsp;<span class="num" id="7055137">4</span><span class="op" id="7055138">}</span><span class="op" id="7055139">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055142">{</span><span class="op" id="7055143">[</span><span class="op" id="7055144">]</span><span class="builtintype" id="7055145">byte</span><span class="op" id="7055149">{</span><span class="num" id="7055150">1</span><span class="op" id="7055151">,</span>&nbsp;<span class="num" id="7055153">2</span><span class="op" id="7055154">,</span>&nbsp;<span class="num" id="7055156">3</span><span class="op" id="7055157">,</span>&nbsp;<span class="num" id="7055159">2</span><span class="op" id="7055160">,</span>&nbsp;<span class="num" id="7055162">2</span><span class="op" id="7055163">,</span>&nbsp;<span class="num" id="7055165">2</span><span class="op" id="7055166">}</span><span class="op" id="7055167">,</span>&nbsp;<span class="builtintype" id="7055169">true</span><span class="op" id="7055173">,</span>&nbsp;<span class="num" id="7055175">3</span><span class="op" id="7055176">}</span><span class="op" id="7055177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055180">{</span><span class="op" id="7055181">[</span><span class="op" id="7055182">]</span><span class="builtintype" id="7055183">byte</span><span class="op" id="7055187">{</span><span class="num" id="7055188">1</span><span class="op" id="7055189">,</span>&nbsp;<span class="num" id="7055191">2</span><span class="op" id="7055192">,</span>&nbsp;<span class="num" id="7055194">3</span><span class="op" id="7055195">,</span>&nbsp;<span class="num" id="7055197">3</span><span class="op" id="7055198">,</span>&nbsp;<span class="num" id="7055200">3</span><span class="op" id="7055201">,</span>&nbsp;<span class="num" id="7055203">3</span><span class="op" id="7055204">}</span><span class="op" id="7055205">,</span>&nbsp;<span class="builtintype" id="7055207">true</span><span class="op" id="7055211">,</span>&nbsp;<span class="num" id="7055213">2</span><span class="op" id="7055214">}</span><span class="op" id="7055215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055218">{</span><span class="op" id="7055219">[</span><span class="op" id="7055220">]</span><span class="builtintype" id="7055221">byte</span><span class="op" id="7055225">{</span><span class="num" id="7055226">1</span><span class="op" id="7055227">,</span>&nbsp;<span class="num" id="7055229">2</span><span class="op" id="7055230">,</span>&nbsp;<span class="num" id="7055232">3</span><span class="op" id="7055233">,</span>&nbsp;<span class="num" id="7055235">4</span><span class="op" id="7055236">,</span>&nbsp;<span class="num" id="7055238">3</span><span class="op" id="7055239">,</span>&nbsp;<span class="num" id="7055241">3</span><span class="op" id="7055242">}</span><span class="op" id="7055243">,</span>&nbsp;<span class="builtintype" id="7055245">false</span><span class="op" id="7055250">,</span>&nbsp;<span class="num" id="7055252">0</span><span class="op" id="7055253">}</span><span class="op" id="7055254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055257">{</span><span class="op" id="7055258">[</span><span class="op" id="7055259">]</span><span class="builtintype" id="7055260">byte</span><span class="op" id="7055264">{</span><span class="num" id="7055265">1</span><span class="op" id="7055266">,</span>&nbsp;<span class="num" id="7055268">4</span><span class="op" id="7055269">,</span>&nbsp;<span class="num" id="7055271">4</span><span class="op" id="7055272">,</span>&nbsp;<span class="num" id="7055274">4</span><span class="op" id="7055275">,</span>&nbsp;<span class="num" id="7055277">4</span><span class="op" id="7055278">,</span>&nbsp;<span class="num" id="7055280">4</span><span class="op" id="7055281">}</span><span class="op" id="7055282">,</span>&nbsp;<span class="builtintype" id="7055284">true</span><span class="op" id="7055288">,</span>&nbsp;<span class="num" id="7055290">1</span><span class="op" id="7055291">}</span><span class="op" id="7055292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055295">{</span><span class="op" id="7055296">[</span><span class="op" id="7055297">]</span><span class="builtintype" id="7055298">byte</span><span class="op" id="7055302">{</span><span class="num" id="7055303">5</span><span class="op" id="7055304">,</span>&nbsp;<span class="num" id="7055306">5</span><span class="op" id="7055307">,</span>&nbsp;<span class="num" id="7055309">5</span><span class="op" id="7055310">,</span>&nbsp;<span class="num" id="7055312">5</span><span class="op" id="7055313">,</span>&nbsp;<span class="num" id="7055315">5</span><span class="op" id="7055316">,</span>&nbsp;<span class="num" id="7055318">5</span><span class="op" id="7055319">}</span><span class="op" id="7055320">,</span>&nbsp;<span class="builtintype" id="7055322">true</span><span class="op" id="7055326">,</span>&nbsp;<span class="num" id="7055328">0</span><span class="op" id="7055329">}</span><span class="op" id="7055330">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055333">{</span><span class="op" id="7055334">[</span><span class="op" id="7055335">]</span><span class="builtintype" id="7055336">byte</span><span class="op" id="7055340">{</span><span class="num" id="7055341">6</span><span class="op" id="7055342">,</span>&nbsp;<span class="num" id="7055344">6</span><span class="op" id="7055345">,</span>&nbsp;<span class="num" id="7055347">6</span><span class="op" id="7055348">,</span>&nbsp;<span class="num" id="7055350">6</span><span class="op" id="7055351">,</span>&nbsp;<span class="num" id="7055353">6</span><span class="op" id="7055354">,</span>&nbsp;<span class="num" id="7055356">6</span><span class="op" id="7055357">}</span><span class="op" id="7055358">,</span>&nbsp;<span class="builtintype" id="7055360">false</span><span class="op" id="7055365">,</span>&nbsp;<span class="num" id="7055367">0</span><span class="op" id="7055368">}</span><span class="op" id="7055369">,</span><br>
<span class="lineno"></span><span class="op" id="7055371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7055374">func</span>&nbsp;<span class="ident" id="7055379">TestRemovePadding</span><span class="op" id="7055396">(</span><span class="ident" id="7055397">t</span>&nbsp;<span class="op" id="7055399">*</span><span class="ident" id="7055400">testing</span><span class="op" id="7055407">.</span><span class="ident" id="7055408">T</span><span class="op" id="7055409">)</span>&nbsp;<span class="op" id="7055411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7055414">for</span>&nbsp;<span class="ident" id="7055418">i</span><span class="op" id="7055419">,</span>&nbsp;<span class="ident" id="7055421">test</span>&nbsp;<span class="op" id="7055426">:=</span>&nbsp;<span class="keyword" id="7055429">range</span>&nbsp;<span class="ident" id="7055435">paddingTests</span>&nbsp;<span class="op" id="7055448">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7055452">payload</span><span class="op" id="7055459">,</span>&nbsp;<span class="ident" id="7055461">good</span>&nbsp;<span class="op" id="7055466">:=</span>&nbsp;<span class="ident" id="7055469">removePadding</span><span class="op" id="7055482">(</span><span class="ident" id="7055483">test</span><span class="op" id="7055487">.</span><span class="ident" id="7055488">in</span><span class="op" id="7055490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7055494">expectedGood</span>&nbsp;<span class="op" id="7055507">:=</span>&nbsp;<span class="builtintype" id="7055510">byte</span><span class="op" id="7055514">(</span><span class="num" id="7055515">255</span><span class="op" id="7055518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7055522">if</span>&nbsp;<span class="op" id="7055525">!</span><span class="ident" id="7055526">test</span><span class="op" id="7055530">.</span><span class="ident" id="7055531">good</span>&nbsp;<span class="op" id="7055536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7055541">expectedGood</span>&nbsp;<span class="op" id="7055554">=</span>&nbsp;<span class="num" id="7055556">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055560">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7055564">if</span>&nbsp;<span class="ident" id="7055567">good</span>&nbsp;<span class="op" id="7055572">!=</span>&nbsp;<span class="ident" id="7055575">expectedGood</span>&nbsp;<span class="op" id="7055588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7055593">t</span><span class="op" id="7055594">.</span><span class="ident" id="7055595">Errorf</span><span class="op" id="7055601">(</span><span class="string" id="7055602">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7055639">,</span>&nbsp;<span class="ident" id="7055641">i</span><span class="op" id="7055642">,</span>&nbsp;<span class="ident" id="7055644">expectedGood</span><span class="op" id="7055656">,</span>&nbsp;<span class="ident" id="7055658">good</span><span class="op" id="7055662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7055670">if</span>&nbsp;<span class="ident" id="7055673">good</span>&nbsp;<span class="op" id="7055678">==</span>&nbsp;<span class="num" id="7055681">255</span>&nbsp;<span class="op" id="7055685">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7055688">len</span><span class="op" id="7055691">(</span><span class="ident" id="7055692">payload</span><span class="op" id="7055699">)</span>&nbsp;<span class="op" id="7055701">!=</span>&nbsp;<span class="ident" id="7055704">test</span><span class="op" id="7055708">.</span><span class="ident" id="7055709">expectedLen</span>&nbsp;<span class="op" id="7055721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7055726">t</span><span class="op" id="7055727">.</span><span class="ident" id="7055728">Errorf</span><span class="op" id="7055734">(</span><span class="string" id="7055735">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7055757">,</span>&nbsp;<span class="ident" id="7055759">i</span><span class="op" id="7055760">,</span>&nbsp;<span class="builtinfunc" id="7055762">len</span><span class="op" id="7055765">(</span><span class="ident" id="7055766">payload</span><span class="op" id="7055773">)</span><span class="op" id="7055774">,</span>&nbsp;<span class="ident" id="7055776">test</span><span class="op" id="7055780">.</span><span class="ident" id="7055781">expectedLen</span><span class="op" id="7055792">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7055799">}</span><br>
<span class="lineno"></span><span class="op" id="7055801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7055804">var</span>&nbsp;<span class="ident" id="7055808">certExampleCom</span>&nbsp;<span class="op" id="7055823">=</span>&nbsp;<span class="string" id="7055825">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7056477">var</span>&nbsp;<span class="ident" id="7056481">certWildcardExampleCom</span>&nbsp;<span class="op" id="7056504">=</span>&nbsp;<span class="string" id="7056506">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7057162">var</span>&nbsp;<span class="ident" id="7057166">certFooExampleCom</span>&nbsp;<span class="op" id="7057184">=</span>&nbsp;<span class="string" id="7057186">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7057846">var</span>&nbsp;<span class="ident" id="7057850">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7057879">=</span>&nbsp;<span class="string" id="7057881">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7058541">func</span>&nbsp;<span class="ident" id="7058546">TestCertificateSelection</span><span class="op" id="7058570">(</span><span class="ident" id="7058571">t</span>&nbsp;<span class="op" id="7058573">*</span><span class="ident" id="7058574">testing</span><span class="op" id="7058581">.</span><span class="ident" id="7058582">T</span><span class="op" id="7058583">)</span>&nbsp;<span class="op" id="7058585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058588">config</span>&nbsp;<span class="op" id="7058595">:=</span>&nbsp;<span class="ident" id="7058598">Config</span><span class="op" id="7058604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058608">Certificates</span><span class="op" id="7058620">:</span>&nbsp;<span class="op" id="7058622">[</span><span class="op" id="7058623">]</span><span class="ident" id="7058624">Certificate</span><span class="op" id="7058635">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058646">Certificate</span><span class="op" id="7058657">:</span>&nbsp;<span class="op" id="7058659">[</span><span class="op" id="7058660">]</span><span class="op" id="7058661">[</span><span class="op" id="7058662">]</span><span class="builtintype" id="7058663">byte</span><span class="op" id="7058667">{</span><span class="ident" id="7058668">fromHex</span><span class="op" id="7058675">(</span><span class="ident" id="7058676">certExampleCom</span><span class="op" id="7058690">)</span><span class="op" id="7058691">}</span><span class="op" id="7058692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058697">}</span><span class="op" id="7058698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058709">Certificate</span><span class="op" id="7058720">:</span>&nbsp;<span class="op" id="7058722">[</span><span class="op" id="7058723">]</span><span class="op" id="7058724">[</span><span class="op" id="7058725">]</span><span class="builtintype" id="7058726">byte</span><span class="op" id="7058730">{</span><span class="ident" id="7058731">fromHex</span><span class="op" id="7058738">(</span><span class="ident" id="7058739">certWildcardExampleCom</span><span class="op" id="7058761">)</span><span class="op" id="7058762">}</span><span class="op" id="7058763">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058768">}</span><span class="op" id="7058769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058780">Certificate</span><span class="op" id="7058791">:</span>&nbsp;<span class="op" id="7058793">[</span><span class="op" id="7058794">]</span><span class="op" id="7058795">[</span><span class="op" id="7058796">]</span><span class="builtintype" id="7058797">byte</span><span class="op" id="7058801">{</span><span class="ident" id="7058802">fromHex</span><span class="op" id="7058809">(</span><span class="ident" id="7058810">certFooExampleCom</span><span class="op" id="7058827">)</span><span class="op" id="7058828">}</span><span class="op" id="7058829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058834">}</span><span class="op" id="7058835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058840">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058846">Certificate</span><span class="op" id="7058857">:</span>&nbsp;<span class="op" id="7058859">[</span><span class="op" id="7058860">]</span><span class="op" id="7058861">[</span><span class="op" id="7058862">]</span><span class="builtintype" id="7058863">byte</span><span class="op" id="7058867">{</span><span class="ident" id="7058868">fromHex</span><span class="op" id="7058875">(</span><span class="ident" id="7058876">certDoubleWildcardExampleCom</span><span class="op" id="7058904">)</span><span class="op" id="7058905">}</span><span class="op" id="7058906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058911">}</span><span class="op" id="7058912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058916">}</span><span class="op" id="7058917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7058920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058924">config</span><span class="op" id="7058930">.</span><span class="ident" id="7058931">BuildNameToCertificate</span><span class="op" id="7058953">(</span><span class="op" id="7058954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7058958">pointerToIndex</span>&nbsp;<span class="op" id="7058973">:=</span>&nbsp;<span class="keyword" id="7058976">func</span><span class="op" id="7058980">(</span><span class="ident" id="7058981">c</span>&nbsp;<span class="op" id="7058983">*</span><span class="ident" id="7058984">Certificate</span><span class="op" id="7058995">)</span>&nbsp;<span class="builtintype" id="7058997">int</span>&nbsp;<span class="op" id="7059001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059005">for</span>&nbsp;<span class="ident" id="7059009">i</span>&nbsp;<span class="op" id="7059011">:=</span>&nbsp;<span class="keyword" id="7059014">range</span>&nbsp;<span class="ident" id="7059020">config</span><span class="op" id="7059026">.</span><span class="ident" id="7059027">Certificates</span>&nbsp;<span class="op" id="7059040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059045">if</span>&nbsp;<span class="ident" id="7059048">c</span>&nbsp;<span class="op" id="7059050">==</span>&nbsp;<span class="op" id="7059053">&amp;</span><span class="ident" id="7059054">config</span><span class="op" id="7059060">.</span><span class="ident" id="7059061">Certificates</span><span class="op" id="7059073">[</span><span class="ident" id="7059074">i</span><span class="op" id="7059075">]</span>&nbsp;<span class="op" id="7059077">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059083">return</span>&nbsp;<span class="ident" id="7059090">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059103">return</span>&nbsp;<span class="op" id="7059110">-</span><span class="num" id="7059111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059114">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059118">certificateForName</span>&nbsp;<span class="op" id="7059137">:=</span>&nbsp;<span class="keyword" id="7059140">func</span><span class="op" id="7059144">(</span><span class="ident" id="7059145">name</span>&nbsp;<span class="builtintype" id="7059150">string</span><span class="op" id="7059156">)</span>&nbsp;<span class="op" id="7059158">*</span><span class="ident" id="7059159">Certificate</span>&nbsp;<span class="op" id="7059171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059175">clientHello</span>&nbsp;<span class="op" id="7059187">:=</span>&nbsp;<span class="op" id="7059190">&amp;</span><span class="ident" id="7059191">ClientHelloInfo</span><span class="op" id="7059206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059211">ServerName</span><span class="op" id="7059221">:</span>&nbsp;<span class="ident" id="7059223">name</span><span class="op" id="7059227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059231">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059235">if</span>&nbsp;<span class="ident" id="7059238">cert</span><span class="op" id="7059242">,</span>&nbsp;<span class="ident" id="7059244">err</span>&nbsp;<span class="op" id="7059248">:=</span>&nbsp;<span class="ident" id="7059251">config</span><span class="op" id="7059257">.</span><span class="ident" id="7059258">getCertificate</span><span class="op" id="7059272">(</span><span class="ident" id="7059273">clientHello</span><span class="op" id="7059284">)</span><span class="op" id="7059285">;</span>&nbsp;<span class="ident" id="7059287">err</span>&nbsp;<span class="op" id="7059291">!=</span>&nbsp;<span class="builtintype" id="7059294">nil</span>&nbsp;<span class="op" id="7059298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059303">t</span><span class="op" id="7059304">.</span><span class="ident" id="7059305">Errorf</span><span class="op" id="7059311">(</span><span class="string" id="7059312">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7059357">,</span>&nbsp;<span class="ident" id="7059359">name</span><span class="op" id="7059363">,</span>&nbsp;<span class="ident" id="7059365">err</span><span class="op" id="7059368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059373">return</span>&nbsp;<span class="builtintype" id="7059380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059386">}</span>&nbsp;<span class="keyword" id="7059388">else</span>&nbsp;<span class="op" id="7059393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059398">return</span>&nbsp;<span class="ident" id="7059405">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059419">if</span>&nbsp;<span class="ident" id="7059422">n</span>&nbsp;<span class="op" id="7059424">:=</span>&nbsp;<span class="ident" id="7059427">pointerToIndex</span><span class="op" id="7059441">(</span><span class="ident" id="7059442">certificateForName</span><span class="op" id="7059460">(</span><span class="string" id="7059461">&#34;example.com&#34;</span><span class="op" id="7059474">)</span><span class="op" id="7059475">)</span><span class="op" id="7059476">;</span>&nbsp;<span class="ident" id="7059478">n</span>&nbsp;<span class="op" id="7059480">!=</span>&nbsp;<span class="num" id="7059483">0</span>&nbsp;<span class="op" id="7059485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059489">t</span><span class="op" id="7059490">.</span><span class="ident" id="7059491">Errorf</span><span class="op" id="7059497">(</span><span class="string" id="7059498">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7059542">,</span>&nbsp;<span class="ident" id="7059544">n</span><span class="op" id="7059545">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059551">if</span>&nbsp;<span class="ident" id="7059554">n</span>&nbsp;<span class="op" id="7059556">:=</span>&nbsp;<span class="ident" id="7059559">pointerToIndex</span><span class="op" id="7059573">(</span><span class="ident" id="7059574">certificateForName</span><span class="op" id="7059592">(</span><span class="string" id="7059593">&#34;bar.example.com&#34;</span><span class="op" id="7059610">)</span><span class="op" id="7059611">)</span><span class="op" id="7059612">;</span>&nbsp;<span class="ident" id="7059614">n</span>&nbsp;<span class="op" id="7059616">!=</span>&nbsp;<span class="num" id="7059619">1</span>&nbsp;<span class="op" id="7059621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059625">t</span><span class="op" id="7059626">.</span><span class="ident" id="7059627">Errorf</span><span class="op" id="7059633">(</span><span class="string" id="7059634">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7059682">,</span>&nbsp;<span class="ident" id="7059684">n</span><span class="op" id="7059685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059691">if</span>&nbsp;<span class="ident" id="7059694">n</span>&nbsp;<span class="op" id="7059696">:=</span>&nbsp;<span class="ident" id="7059699">pointerToIndex</span><span class="op" id="7059713">(</span><span class="ident" id="7059714">certificateForName</span><span class="op" id="7059732">(</span><span class="string" id="7059733">&#34;foo.example.com&#34;</span><span class="op" id="7059750">)</span><span class="op" id="7059751">)</span><span class="op" id="7059752">;</span>&nbsp;<span class="ident" id="7059754">n</span>&nbsp;<span class="op" id="7059756">!=</span>&nbsp;<span class="num" id="7059759">2</span>&nbsp;<span class="op" id="7059761">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059765">t</span><span class="op" id="7059766">.</span><span class="ident" id="7059767">Errorf</span><span class="op" id="7059773">(</span><span class="string" id="7059774">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7059822">,</span>&nbsp;<span class="ident" id="7059824">n</span><span class="op" id="7059825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059831">if</span>&nbsp;<span class="ident" id="7059834">n</span>&nbsp;<span class="op" id="7059836">:=</span>&nbsp;<span class="ident" id="7059839">pointerToIndex</span><span class="op" id="7059853">(</span><span class="ident" id="7059854">certificateForName</span><span class="op" id="7059872">(</span><span class="string" id="7059873">&#34;foo.bar.example.com&#34;</span><span class="op" id="7059894">)</span><span class="op" id="7059895">)</span><span class="op" id="7059896">;</span>&nbsp;<span class="ident" id="7059898">n</span>&nbsp;<span class="op" id="7059900">!=</span>&nbsp;<span class="num" id="7059903">3</span>&nbsp;<span class="op" id="7059905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7059909">t</span><span class="op" id="7059910">.</span><span class="ident" id="7059911">Errorf</span><span class="op" id="7059917">(</span><span class="string" id="7059918">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7059970">,</span>&nbsp;<span class="ident" id="7059972">n</span><span class="op" id="7059973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7059976">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7059979">if</span>&nbsp;<span class="ident" id="7059982">n</span>&nbsp;<span class="op" id="7059984">:=</span>&nbsp;<span class="ident" id="7059987">pointerToIndex</span><span class="op" id="7060001">(</span><span class="ident" id="7060002">certificateForName</span><span class="op" id="7060020">(</span><span class="string" id="7060021">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7060046">)</span><span class="op" id="7060047">)</span><span class="op" id="7060048">;</span>&nbsp;<span class="ident" id="7060050">n</span>&nbsp;<span class="op" id="7060052">!=</span>&nbsp;<span class="num" id="7060055">0</span>&nbsp;<span class="op" id="7060057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7060061">t</span><span class="op" id="7060062">.</span><span class="ident" id="7060063">Errorf</span><span class="op" id="7060069">(</span><span class="string" id="7060070">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7060126">,</span>&nbsp;<span class="ident" id="7060128">n</span><span class="op" id="7060129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7060132">}</span><br>
<span class="lineno"></span><span class="op" id="7060134">}</span>
</div>
</body>
</html>
