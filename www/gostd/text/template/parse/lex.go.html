<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html" class="current">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5129127">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5129182">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5129236">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5129287">package</span>&nbsp;<span class="ident" id="5129295">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5129302">import</span>&nbsp;<span class="op" id="5129309">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5129312">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5129319">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5129330">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5129341">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5129356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5129359">//&nbsp;item&nbsp;represents&nbsp;a&nbsp;token&nbsp;or&nbsp;text&nbsp;string&nbsp;returned&nbsp;from&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">15</span><span class="keyword" id="5129428">type</span>&nbsp;<span class="ident" id="5129433">item</span>&nbsp;<span class="keyword" id="5129438">struct</span>&nbsp;<span class="op" id="5129445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129448">typ</span>&nbsp;<span class="ident" id="5129452">itemType</span>&nbsp;<span class="comment" id="5129461">//&nbsp;The&nbsp;type&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129488">pos</span>&nbsp;<span class="ident" id="5129492">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129501">//&nbsp;The&nbsp;starting&nbsp;position,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;this&nbsp;item&nbsp;in&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129572">val</span>&nbsp;<span class="builtintype" id="5129576">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5129585">//&nbsp;The&nbsp;value&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span><span class="op" id="5129612">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5129615">func</span>&nbsp;<span class="op" id="5129620">(</span><span class="ident" id="5129621">i</span>&nbsp;<span class="ident" id="5129623">item</span><span class="op" id="5129627">)</span>&nbsp;<span class="ident" id="5129629">String</span><span class="op" id="5129635">(</span><span class="op" id="5129636">)</span>&nbsp;<span class="builtintype" id="5129638">string</span>&nbsp;<span class="op" id="5129645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129648">switch</span>&nbsp;<span class="op" id="5129655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129658">case</span>&nbsp;<span class="ident" id="5129663">i</span><span class="op" id="5129664">.</span><span class="ident" id="5129665">typ</span>&nbsp;<span class="op" id="5129669">==</span>&nbsp;<span class="ident" id="5129672">itemEOF</span><span class="op" id="5129679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129683">return</span>&nbsp;<span class="string" id="5129690">&#34;EOF&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129697">case</span>&nbsp;<span class="ident" id="5129702">i</span><span class="op" id="5129703">.</span><span class="ident" id="5129704">typ</span>&nbsp;<span class="op" id="5129708">==</span>&nbsp;<span class="ident" id="5129711">itemError</span><span class="op" id="5129720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129724">return</span>&nbsp;<span class="ident" id="5129731">i</span><span class="op" id="5129732">.</span><span class="ident" id="5129733">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129738">case</span>&nbsp;<span class="ident" id="5129743">i</span><span class="op" id="5129744">.</span><span class="ident" id="5129745">typ</span>&nbsp;<span class="op" id="5129749">&gt;</span>&nbsp;<span class="ident" id="5129751">itemKeyword</span><span class="op" id="5129762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129766">return</span>&nbsp;<span class="ident" id="5129773">fmt</span><span class="op" id="5129776">.</span><span class="ident" id="5129777">Sprintf</span><span class="op" id="5129784">(</span><span class="string" id="5129785">&#34;&lt;%s&gt;&#34;</span><span class="op" id="5129791">,</span>&nbsp;<span class="ident" id="5129793">i</span><span class="op" id="5129794">.</span><span class="ident" id="5129795">val</span><span class="op" id="5129798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129801">case</span>&nbsp;<span class="builtinfunc" id="5129806">len</span><span class="op" id="5129809">(</span><span class="ident" id="5129810">i</span><span class="op" id="5129811">.</span><span class="ident" id="5129812">val</span><span class="op" id="5129815">)</span>&nbsp;<span class="op" id="5129817">&gt;</span>&nbsp;<span class="num" id="5129819">10</span><span class="op" id="5129821">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129825">return</span>&nbsp;<span class="ident" id="5129832">fmt</span><span class="op" id="5129835">.</span><span class="ident" id="5129836">Sprintf</span><span class="op" id="5129843">(</span><span class="string" id="5129844">&#34;%.10q...&#34;</span><span class="op" id="5129854">,</span>&nbsp;<span class="ident" id="5129856">i</span><span class="op" id="5129857">.</span><span class="ident" id="5129858">val</span><span class="op" id="5129861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129867">return</span>&nbsp;<span class="ident" id="5129874">fmt</span><span class="op" id="5129877">.</span><span class="ident" id="5129878">Sprintf</span><span class="op" id="5129885">(</span><span class="string" id="5129886">&#34;%q&#34;</span><span class="op" id="5129890">,</span>&nbsp;<span class="ident" id="5129892">i</span><span class="op" id="5129893">.</span><span class="ident" id="5129894">val</span><span class="op" id="5129897">)</span><br>
<span class="lineno"></span><span class="op" id="5129899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5129902">//&nbsp;itemType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;lex&nbsp;items.</span><br>
<span class="lineno"></span><span class="keyword" id="5129948">type</span>&nbsp;<span class="ident" id="5129953">itemType</span>&nbsp;<span class="builtintype" id="5129962">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5129967">const</span>&nbsp;<span class="op" id="5129973">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129976">itemError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129993">itemType</span>&nbsp;<span class="op" id="5130002">=</span>&nbsp;<span class="ident" id="5130004">iota</span>&nbsp;<span class="comment" id="5130009">//&nbsp;error&nbsp;occurred;&nbsp;value&nbsp;is&nbsp;text&nbsp;of&nbsp;error</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130052">itemBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130085">//&nbsp;boolean&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130106">itemChar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130139">//&nbsp;printable&nbsp;ASCII&nbsp;character;&nbsp;grab&nbsp;bag&nbsp;for&nbsp;comma&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130194">itemCharConstant</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130227">//&nbsp;character&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130250">itemComplex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130283">//&nbsp;complex&nbsp;constant&nbsp;(1+2i);&nbsp;imaginary&nbsp;is&nbsp;just&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130339">itemColonEquals</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130372">//&nbsp;colon-equals&nbsp;(&#39;:=&#39;)&nbsp;introducing&nbsp;a&nbsp;declaration</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130422">itemEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130431">itemField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130446">//&nbsp;alphanumeric&nbsp;identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130492">itemIdentifier</span>&nbsp;<span class="comment" id="5130507">//&nbsp;alphanumeric&nbsp;identifier&nbsp;not&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130557">itemLeftDelim</span>&nbsp;&nbsp;<span class="comment" id="5130572">//&nbsp;left&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130598">itemLeftParen</span>&nbsp;&nbsp;<span class="comment" id="5130613">//&nbsp;&#39;(&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130635">itemNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130650">//&nbsp;simple&nbsp;number,&nbsp;including&nbsp;imaginary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130689">itemPipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130704">//&nbsp;pipe&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130720">itemRawString</span>&nbsp;&nbsp;<span class="comment" id="5130735">//&nbsp;raw&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130775">itemRightDelim</span>&nbsp;<span class="comment" id="5130790">//&nbsp;right&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130817">itemRightParen</span>&nbsp;<span class="comment" id="5130832">//&nbsp;&#39;)&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130854">itemSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130869">//&nbsp;run&nbsp;of&nbsp;spaces&nbsp;separating&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130908">itemString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130923">//&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130959">itemText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130974">//&nbsp;plain&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130989">itemVariable</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5131004">//&nbsp;variable&nbsp;starting&nbsp;with&nbsp;&#39;$&#39;,&nbsp;such&nbsp;as&nbsp;&#39;$&#39;&nbsp;or&nbsp;&nbsp;&#39;$1&#39;&nbsp;or&nbsp;&#39;$hello&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131069">//&nbsp;Keywords&nbsp;appear&nbsp;after&nbsp;all&nbsp;the&nbsp;rest.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131109">itemKeyword</span>&nbsp;&nbsp;<span class="comment" id="5131122">//&nbsp;used&nbsp;only&nbsp;to&nbsp;delimit&nbsp;the&nbsp;keywords</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131160">itemDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131173">//&nbsp;the&nbsp;cursor,&nbsp;spelled&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131201">itemDefine</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5131214">//&nbsp;define&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131233">itemElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131246">//&nbsp;else&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131263">itemEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131276">//&nbsp;end&nbsp;keyword</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131292">itemIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131305">//&nbsp;if&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131320">itemNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131333">//&nbsp;the&nbsp;untyped&nbsp;nil&nbsp;constant,&nbsp;easiest&nbsp;to&nbsp;treat&nbsp;as&nbsp;a&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131393">itemRange</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131406">//&nbsp;range&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131424">itemTemplate</span>&nbsp;<span class="comment" id="5131437">//&nbsp;template&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131458">itemWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131471">//&nbsp;with&nbsp;keyword</span><br>
<span class="lineno">70</span><span class="op" id="5131487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5131490">var</span>&nbsp;<span class="ident" id="5131494">key</span>&nbsp;<span class="op" id="5131498">=</span>&nbsp;<span class="keyword" id="5131500">map</span><span class="op" id="5131503">[</span><span class="builtintype" id="5131504">string</span><span class="op" id="5131510">]</span><span class="ident" id="5131511">itemType</span><span class="op" id="5131519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131522">&#34;.&#34;</span><span class="op" id="5131525">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131534">itemDot</span><span class="op" id="5131541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131544">&#34;define&#34;</span><span class="op" id="5131552">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5131556">itemDefine</span><span class="op" id="5131566">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131569">&#34;else&#34;</span><span class="op" id="5131575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131581">itemElse</span><span class="op" id="5131589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131592">&#34;end&#34;</span><span class="op" id="5131597">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131604">itemEnd</span><span class="op" id="5131611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131614">&#34;if&#34;</span><span class="op" id="5131618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131626">itemIf</span><span class="op" id="5131632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131635">&#34;range&#34;</span><span class="op" id="5131642">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131647">itemRange</span><span class="op" id="5131656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131659">&#34;nil&#34;</span><span class="op" id="5131664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131671">itemNil</span><span class="op" id="5131678">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131681">&#34;template&#34;</span><span class="op" id="5131691">:</span>&nbsp;<span class="ident" id="5131693">itemTemplate</span><span class="op" id="5131705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5131708">&#34;with&#34;</span><span class="op" id="5131714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131720">itemWith</span><span class="op" id="5131728">,</span><br>
<span class="lineno"></span><span class="op" id="5131730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5131733">const</span>&nbsp;<span class="ident" id="5131739">eof</span>&nbsp;<span class="op" id="5131743">=</span>&nbsp;<span class="op" id="5131745">-</span><span class="num" id="5131746">1</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="5131749">//&nbsp;stateFn&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner&nbsp;as&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;the&nbsp;next&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="5131839">type</span>&nbsp;<span class="ident" id="5131844">stateFn</span>&nbsp;<span class="keyword" id="5131852">func</span><span class="op" id="5131856">(</span><span class="op" id="5131857">*</span><span class="ident" id="5131858">lexer</span><span class="op" id="5131863">)</span>&nbsp;<span class="ident" id="5131865">stateFn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131874">//&nbsp;lexer&nbsp;holds&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">90</span><span class="keyword" id="5131915">type</span>&nbsp;<span class="ident" id="5131920">lexer</span>&nbsp;<span class="keyword" id="5131926">struct</span>&nbsp;<span class="op" id="5131933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131936">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5131947">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131957">//&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;input;&nbsp;used&nbsp;only&nbsp;for&nbsp;error&nbsp;reports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132012">input</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5132023">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132033">//&nbsp;the&nbsp;string&nbsp;being&nbsp;scanned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132062">leftDelim</span>&nbsp;&nbsp;<span class="builtintype" id="5132073">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132083">//&nbsp;start&nbsp;of&nbsp;action</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132103">rightDelim</span>&nbsp;<span class="builtintype" id="5132114">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132124">//&nbsp;end&nbsp;of&nbsp;action</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132142">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132153">stateFn</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5132163">//&nbsp;the&nbsp;next&nbsp;lexing&nbsp;function&nbsp;to&nbsp;enter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132201">pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132212">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132222">//&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132256">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132267">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132277">//&nbsp;start&nbsp;position&nbsp;of&nbsp;this&nbsp;item</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132309">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132320">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132330">//&nbsp;width&nbsp;of&nbsp;last&nbsp;rune&nbsp;read&nbsp;from&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132369">lastPos</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132380">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132390">//&nbsp;position&nbsp;of&nbsp;most&nbsp;recent&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132444">items</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132455">chan</span>&nbsp;<span class="ident" id="5132460">item</span>&nbsp;<span class="comment" id="5132465">//&nbsp;channel&nbsp;of&nbsp;scanned&nbsp;items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132494">parenDepth</span>&nbsp;<span class="builtintype" id="5132505">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132515">//&nbsp;nesting&nbsp;depth&nbsp;of&nbsp;(&nbsp;)&nbsp;exprs</span><br>
<span class="lineno"></span><span class="op" id="5132545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5132548">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">105</span><span class="keyword" id="5132592">func</span>&nbsp;<span class="op" id="5132597">(</span><span class="ident" id="5132598">l</span>&nbsp;<span class="op" id="5132600">*</span><span class="ident" id="5132601">lexer</span><span class="op" id="5132606">)</span>&nbsp;<span class="ident" id="5132608">next</span><span class="op" id="5132612">(</span><span class="op" id="5132613">)</span>&nbsp;<span class="builtintype" id="5132615">rune</span>&nbsp;<span class="op" id="5132620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132623">if</span>&nbsp;<span class="builtintype" id="5132626">int</span><span class="op" id="5132629">(</span><span class="ident" id="5132630">l</span><span class="op" id="5132631">.</span><span class="ident" id="5132632">pos</span><span class="op" id="5132635">)</span>&nbsp;<span class="op" id="5132637">&gt;=</span>&nbsp;<span class="builtinfunc" id="5132640">len</span><span class="op" id="5132643">(</span><span class="ident" id="5132644">l</span><span class="op" id="5132645">.</span><span class="ident" id="5132646">input</span><span class="op" id="5132651">)</span>&nbsp;<span class="op" id="5132653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132657">l</span><span class="op" id="5132658">.</span><span class="ident" id="5132659">width</span>&nbsp;<span class="op" id="5132665">=</span>&nbsp;<span class="num" id="5132667">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132671">return</span>&nbsp;<span class="ident" id="5132678">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132683">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132686">r</span><span class="op" id="5132687">,</span>&nbsp;<span class="ident" id="5132689">w</span>&nbsp;<span class="op" id="5132691">:=</span>&nbsp;<span class="ident" id="5132694">utf8</span><span class="op" id="5132698">.</span><span class="ident" id="5132699">DecodeRuneInString</span><span class="op" id="5132717">(</span><span class="ident" id="5132718">l</span><span class="op" id="5132719">.</span><span class="ident" id="5132720">input</span><span class="op" id="5132725">[</span><span class="ident" id="5132726">l</span><span class="op" id="5132727">.</span><span class="ident" id="5132728">pos</span><span class="op" id="5132731">:</span><span class="op" id="5132732">]</span><span class="op" id="5132733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132736">l</span><span class="op" id="5132737">.</span><span class="ident" id="5132738">width</span>&nbsp;<span class="op" id="5132744">=</span>&nbsp;<span class="ident" id="5132746">Pos</span><span class="op" id="5132749">(</span><span class="ident" id="5132750">w</span><span class="op" id="5132751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132754">l</span><span class="op" id="5132755">.</span><span class="ident" id="5132756">pos</span>&nbsp;<span class="op" id="5132760">+=</span>&nbsp;<span class="ident" id="5132763">l</span><span class="op" id="5132764">.</span><span class="ident" id="5132765">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132772">return</span>&nbsp;<span class="ident" id="5132779">r</span><br>
<span class="lineno"></span><span class="op" id="5132781">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5132784">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="5132849">func</span>&nbsp;<span class="op" id="5132854">(</span><span class="ident" id="5132855">l</span>&nbsp;<span class="op" id="5132857">*</span><span class="ident" id="5132858">lexer</span><span class="op" id="5132863">)</span>&nbsp;<span class="ident" id="5132865">peek</span><span class="op" id="5132869">(</span><span class="op" id="5132870">)</span>&nbsp;<span class="builtintype" id="5132872">rune</span>&nbsp;<span class="op" id="5132877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132880">r</span>&nbsp;<span class="op" id="5132882">:=</span>&nbsp;<span class="ident" id="5132885">l</span><span class="op" id="5132886">.</span><span class="ident" id="5132887">next</span><span class="op" id="5132891">(</span><span class="op" id="5132892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132895">l</span><span class="op" id="5132896">.</span><span class="ident" id="5132897">backup</span><span class="op" id="5132903">(</span><span class="op" id="5132904">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132907">return</span>&nbsp;<span class="ident" id="5132914">r</span><br>
<span class="lineno"></span><span class="op" id="5132916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5132919">//&nbsp;backup&nbsp;steps&nbsp;back&nbsp;one&nbsp;rune.&nbsp;Can&nbsp;only&nbsp;be&nbsp;called&nbsp;once&nbsp;per&nbsp;call&nbsp;of&nbsp;next.</span><br>
<span class="lineno"></span><span class="keyword" id="5132992">func</span>&nbsp;<span class="op" id="5132997">(</span><span class="ident" id="5132998">l</span>&nbsp;<span class="op" id="5133000">*</span><span class="ident" id="5133001">lexer</span><span class="op" id="5133006">)</span>&nbsp;<span class="ident" id="5133008">backup</span><span class="op" id="5133014">(</span><span class="op" id="5133015">)</span>&nbsp;<span class="op" id="5133017">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133020">l</span><span class="op" id="5133021">.</span><span class="ident" id="5133022">pos</span>&nbsp;<span class="op" id="5133026">-=</span>&nbsp;<span class="ident" id="5133029">l</span><span class="op" id="5133030">.</span><span class="ident" id="5133031">width</span><br>
<span class="lineno"></span><span class="op" id="5133037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5133040">//&nbsp;emit&nbsp;passes&nbsp;an&nbsp;item&nbsp;back&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="keyword" id="5133083">func</span>&nbsp;<span class="op" id="5133088">(</span><span class="ident" id="5133089">l</span>&nbsp;<span class="op" id="5133091">*</span><span class="ident" id="5133092">lexer</span><span class="op" id="5133097">)</span>&nbsp;<span class="ident" id="5133099">emit</span><span class="op" id="5133103">(</span><span class="ident" id="5133104">t</span>&nbsp;<span class="ident" id="5133106">itemType</span><span class="op" id="5133114">)</span>&nbsp;<span class="op" id="5133116">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133119">l</span><span class="op" id="5133120">.</span><span class="ident" id="5133121">items</span>&nbsp;<span class="op" id="5133127">&lt;-</span>&nbsp;<span class="ident" id="5133130">item</span><span class="op" id="5133134">{</span><span class="ident" id="5133135">t</span><span class="op" id="5133136">,</span>&nbsp;<span class="ident" id="5133138">l</span><span class="op" id="5133139">.</span><span class="ident" id="5133140">start</span><span class="op" id="5133145">,</span>&nbsp;<span class="ident" id="5133147">l</span><span class="op" id="5133148">.</span><span class="ident" id="5133149">input</span><span class="op" id="5133154">[</span><span class="ident" id="5133155">l</span><span class="op" id="5133156">.</span><span class="ident" id="5133157">start</span><span class="op" id="5133162">:</span><span class="ident" id="5133163">l</span><span class="op" id="5133164">.</span><span class="ident" id="5133165">pos</span><span class="op" id="5133168">]</span><span class="op" id="5133169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133172">l</span><span class="op" id="5133173">.</span><span class="ident" id="5133174">start</span>&nbsp;<span class="op" id="5133180">=</span>&nbsp;<span class="ident" id="5133182">l</span><span class="op" id="5133183">.</span><span class="ident" id="5133184">pos</span><br>
<span class="lineno"></span><span class="op" id="5133188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5133191">//&nbsp;ignore&nbsp;skips&nbsp;over&nbsp;the&nbsp;pending&nbsp;input&nbsp;before&nbsp;this&nbsp;point.</span><br>
<span class="lineno">135</span><span class="keyword" id="5133249">func</span>&nbsp;<span class="op" id="5133254">(</span><span class="ident" id="5133255">l</span>&nbsp;<span class="op" id="5133257">*</span><span class="ident" id="5133258">lexer</span><span class="op" id="5133263">)</span>&nbsp;<span class="ident" id="5133265">ignore</span><span class="op" id="5133271">(</span><span class="op" id="5133272">)</span>&nbsp;<span class="op" id="5133274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133277">l</span><span class="op" id="5133278">.</span><span class="ident" id="5133279">start</span>&nbsp;<span class="op" id="5133285">=</span>&nbsp;<span class="ident" id="5133287">l</span><span class="op" id="5133288">.</span><span class="ident" id="5133289">pos</span><br>
<span class="lineno"></span><span class="op" id="5133293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5133296">//&nbsp;accept&nbsp;consumes&nbsp;the&nbsp;next&nbsp;rune&nbsp;if&nbsp;it&#39;s&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno">140</span><span class="keyword" id="5133357">func</span>&nbsp;<span class="op" id="5133362">(</span><span class="ident" id="5133363">l</span>&nbsp;<span class="op" id="5133365">*</span><span class="ident" id="5133366">lexer</span><span class="op" id="5133371">)</span>&nbsp;<span class="ident" id="5133373">accept</span><span class="op" id="5133379">(</span><span class="ident" id="5133380">valid</span>&nbsp;<span class="builtintype" id="5133386">string</span><span class="op" id="5133392">)</span>&nbsp;<span class="builtintype" id="5133394">bool</span>&nbsp;<span class="op" id="5133399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5133402">if</span>&nbsp;<span class="ident" id="5133405">strings</span><span class="op" id="5133412">.</span><span class="ident" id="5133413">IndexRune</span><span class="op" id="5133422">(</span><span class="ident" id="5133423">valid</span><span class="op" id="5133428">,</span>&nbsp;<span class="ident" id="5133430">l</span><span class="op" id="5133431">.</span><span class="ident" id="5133432">next</span><span class="op" id="5133436">(</span><span class="op" id="5133437">)</span><span class="op" id="5133438">)</span>&nbsp;<span class="op" id="5133440">&gt;=</span>&nbsp;<span class="num" id="5133443">0</span>&nbsp;<span class="op" id="5133445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5133449">return</span>&nbsp;<span class="builtintype" id="5133456">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5133462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133465">l</span><span class="op" id="5133466">.</span><span class="ident" id="5133467">backup</span><span class="op" id="5133473">(</span><span class="op" id="5133474">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5133477">return</span>&nbsp;<span class="builtintype" id="5133484">false</span><br>
<span class="lineno"></span><span class="op" id="5133490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5133493">//&nbsp;acceptRun&nbsp;consumes&nbsp;a&nbsp;run&nbsp;of&nbsp;runes&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="5133550">func</span>&nbsp;<span class="op" id="5133555">(</span><span class="ident" id="5133556">l</span>&nbsp;<span class="op" id="5133558">*</span><span class="ident" id="5133559">lexer</span><span class="op" id="5133564">)</span>&nbsp;<span class="ident" id="5133566">acceptRun</span><span class="op" id="5133575">(</span><span class="ident" id="5133576">valid</span>&nbsp;<span class="builtintype" id="5133582">string</span><span class="op" id="5133588">)</span>&nbsp;<span class="op" id="5133590">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5133593">for</span>&nbsp;<span class="ident" id="5133597">strings</span><span class="op" id="5133604">.</span><span class="ident" id="5133605">IndexRune</span><span class="op" id="5133614">(</span><span class="ident" id="5133615">valid</span><span class="op" id="5133620">,</span>&nbsp;<span class="ident" id="5133622">l</span><span class="op" id="5133623">.</span><span class="ident" id="5133624">next</span><span class="op" id="5133628">(</span><span class="op" id="5133629">)</span><span class="op" id="5133630">)</span>&nbsp;<span class="op" id="5133632">&gt;=</span>&nbsp;<span class="num" id="5133635">0</span>&nbsp;<span class="op" id="5133637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5133640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5133643">l</span><span class="op" id="5133644">.</span><span class="ident" id="5133645">backup</span><span class="op" id="5133651">(</span><span class="op" id="5133652">)</span><br>
<span class="lineno"></span><span class="op" id="5133654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5133657">//&nbsp;lineNumber&nbsp;reports&nbsp;which&nbsp;line&nbsp;we&#39;re&nbsp;on,&nbsp;based&nbsp;on&nbsp;the&nbsp;position&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5133725">//&nbsp;the&nbsp;previous&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem.&nbsp;Doing&nbsp;it&nbsp;this&nbsp;way</span><br>
<span class="lineno"></span><span class="comment" id="5133786">//&nbsp;means&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;peek&nbsp;double&nbsp;counting.</span><br>
<span class="lineno"></span><span class="keyword" id="5133846">func</span>&nbsp;<span class="op" id="5133851">(</span><span class="ident" id="5133852">l</span>&nbsp;<span class="op" id="5133854">*</span><span class="ident" id="5133855">lexer</span><span class="op" id="5133860">)</span>&nbsp;<span class="ident" id="5133862">lineNumber</span><span class="op" id="5133872">(</span><span class="op" id="5133873">)</span>&nbsp;<span class="builtintype" id="5133875">int</span>&nbsp;<span class="op" id="5133879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5133882">return</span>&nbsp;<span class="num" id="5133889">1</span>&nbsp;<span class="op" id="5133891">+</span>&nbsp;<span class="ident" id="5133893">strings</span><span class="op" id="5133900">.</span><span class="ident" id="5133901">Count</span><span class="op" id="5133906">(</span><span class="ident" id="5133907">l</span><span class="op" id="5133908">.</span><span class="ident" id="5133909">input</span><span class="op" id="5133914">[</span><span class="op" id="5133915">:</span><span class="ident" id="5133916">l</span><span class="op" id="5133917">.</span><span class="ident" id="5133918">lastPos</span><span class="op" id="5133925">]</span><span class="op" id="5133926">,</span>&nbsp;<span class="string" id="5133928">&#34;\n&#34;</span><span class="op" id="5133932">)</span><br>
<span class="lineno">160</span><span class="op" id="5133934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5133937">//&nbsp;errorf&nbsp;returns&nbsp;an&nbsp;error&nbsp;token&nbsp;and&nbsp;terminates&nbsp;the&nbsp;scan&nbsp;by&nbsp;passing</span><br>
<span class="lineno"></span><span class="comment" id="5134005">//&nbsp;back&nbsp;a&nbsp;nil&nbsp;pointer&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;next&nbsp;state,&nbsp;terminating&nbsp;l.nextItem.</span><br>
<span class="lineno"></span><span class="keyword" id="5134080">func</span>&nbsp;<span class="op" id="5134085">(</span><span class="ident" id="5134086">l</span>&nbsp;<span class="op" id="5134088">*</span><span class="ident" id="5134089">lexer</span><span class="op" id="5134094">)</span>&nbsp;<span class="ident" id="5134096">errorf</span><span class="op" id="5134102">(</span><span class="ident" id="5134103">format</span>&nbsp;<span class="builtintype" id="5134110">string</span><span class="op" id="5134116">,</span>&nbsp;<span class="ident" id="5134118">args</span>&nbsp;<span class="op" id="5134123">...</span><span class="keyword" id="5134126">interface</span><span class="op" id="5134135">{</span><span class="op" id="5134136">}</span><span class="op" id="5134137">)</span>&nbsp;<span class="ident" id="5134139">stateFn</span>&nbsp;<span class="op" id="5134147">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134150">l</span><span class="op" id="5134151">.</span><span class="ident" id="5134152">items</span>&nbsp;<span class="op" id="5134158">&lt;-</span>&nbsp;<span class="ident" id="5134161">item</span><span class="op" id="5134165">{</span><span class="ident" id="5134166">itemError</span><span class="op" id="5134175">,</span>&nbsp;<span class="ident" id="5134177">l</span><span class="op" id="5134178">.</span><span class="ident" id="5134179">start</span><span class="op" id="5134184">,</span>&nbsp;<span class="ident" id="5134186">fmt</span><span class="op" id="5134189">.</span><span class="ident" id="5134190">Sprintf</span><span class="op" id="5134197">(</span><span class="ident" id="5134198">format</span><span class="op" id="5134204">,</span>&nbsp;<span class="ident" id="5134206">args</span><span class="op" id="5134210">...</span><span class="op" id="5134213">)</span><span class="op" id="5134214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134217">return</span>&nbsp;<span class="ident" id="5134224">nil</span><br>
<span class="lineno"></span><span class="op" id="5134228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5134231">//&nbsp;nextItem&nbsp;returns&nbsp;the&nbsp;next&nbsp;item&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">170</span><span class="keyword" id="5134281">func</span>&nbsp;<span class="op" id="5134286">(</span><span class="ident" id="5134287">l</span>&nbsp;<span class="op" id="5134289">*</span><span class="ident" id="5134290">lexer</span><span class="op" id="5134295">)</span>&nbsp;<span class="ident" id="5134297">nextItem</span><span class="op" id="5134305">(</span><span class="op" id="5134306">)</span>&nbsp;<span class="ident" id="5134308">item</span>&nbsp;<span class="op" id="5134313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134316">item</span>&nbsp;<span class="op" id="5134321">:=</span>&nbsp;<span class="op" id="5134324">&lt;-</span><span class="ident" id="5134326">l</span><span class="op" id="5134327">.</span><span class="ident" id="5134328">items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134335">l</span><span class="op" id="5134336">.</span><span class="ident" id="5134337">lastPos</span>&nbsp;<span class="op" id="5134345">=</span>&nbsp;<span class="ident" id="5134347">item</span><span class="op" id="5134351">.</span><span class="ident" id="5134352">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134357">return</span>&nbsp;<span class="ident" id="5134364">item</span><br>
<span class="lineno"></span><span class="op" id="5134369">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5134372">//&nbsp;lex&nbsp;creates&nbsp;a&nbsp;new&nbsp;scanner&nbsp;for&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5134423">func</span>&nbsp;<span class="ident" id="5134428">lex</span><span class="op" id="5134431">(</span><span class="ident" id="5134432">name</span><span class="op" id="5134436">,</span>&nbsp;<span class="ident" id="5134438">input</span><span class="op" id="5134443">,</span>&nbsp;<span class="ident" id="5134445">left</span><span class="op" id="5134449">,</span>&nbsp;<span class="ident" id="5134451">right</span>&nbsp;<span class="builtintype" id="5134457">string</span><span class="op" id="5134463">)</span>&nbsp;<span class="op" id="5134465">*</span><span class="ident" id="5134466">lexer</span>&nbsp;<span class="op" id="5134472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134475">if</span>&nbsp;<span class="ident" id="5134478">left</span>&nbsp;<span class="op" id="5134483">==</span>&nbsp;<span class="string" id="5134486">&#34;&#34;</span>&nbsp;<span class="op" id="5134489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134493">left</span>&nbsp;<span class="op" id="5134498">=</span>&nbsp;<span class="ident" id="5134500">leftDelim</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134514">if</span>&nbsp;<span class="ident" id="5134517">right</span>&nbsp;<span class="op" id="5134523">==</span>&nbsp;<span class="string" id="5134526">&#34;&#34;</span>&nbsp;<span class="op" id="5134529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134533">right</span>&nbsp;<span class="op" id="5134539">=</span>&nbsp;<span class="ident" id="5134541">rightDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134556">l</span>&nbsp;<span class="op" id="5134558">:=</span>&nbsp;<span class="op" id="5134561">&amp;</span><span class="ident" id="5134562">lexer</span><span class="op" id="5134567">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134571">name</span><span class="op" id="5134575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134583">name</span><span class="op" id="5134587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134591">input</span><span class="op" id="5134596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134603">input</span><span class="op" id="5134608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134612">leftDelim</span><span class="op" id="5134621">:</span>&nbsp;&nbsp;<span class="ident" id="5134624">left</span><span class="op" id="5134628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134632">rightDelim</span><span class="op" id="5134642">:</span>&nbsp;<span class="ident" id="5134644">right</span><span class="op" id="5134649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134653">items</span><span class="op" id="5134658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5134665">make</span><span class="op" id="5134669">(</span><span class="keyword" id="5134670">chan</span>&nbsp;<span class="ident" id="5134675">item</span><span class="op" id="5134679">)</span><span class="op" id="5134680">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134686">go</span>&nbsp;<span class="ident" id="5134689">l</span><span class="op" id="5134690">.</span><span class="ident" id="5134691">run</span><span class="op" id="5134694">(</span><span class="op" id="5134695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134698">return</span>&nbsp;<span class="ident" id="5134705">l</span><br>
<span class="lineno"></span><span class="op" id="5134707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="5134710">//&nbsp;run&nbsp;runs&nbsp;the&nbsp;state&nbsp;machine&nbsp;for&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="5134755">func</span>&nbsp;<span class="op" id="5134760">(</span><span class="ident" id="5134761">l</span>&nbsp;<span class="op" id="5134763">*</span><span class="ident" id="5134764">lexer</span><span class="op" id="5134769">)</span>&nbsp;<span class="ident" id="5134771">run</span><span class="op" id="5134774">(</span><span class="op" id="5134775">)</span>&nbsp;<span class="op" id="5134777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5134780">for</span>&nbsp;<span class="ident" id="5134784">l</span><span class="op" id="5134785">.</span><span class="ident" id="5134786">state</span>&nbsp;<span class="op" id="5134792">=</span>&nbsp;<span class="ident" id="5134794">lexText</span><span class="op" id="5134801">;</span>&nbsp;<span class="ident" id="5134803">l</span><span class="op" id="5134804">.</span><span class="ident" id="5134805">state</span>&nbsp;<span class="op" id="5134811">!=</span>&nbsp;<span class="ident" id="5134814">nil</span><span class="op" id="5134817">;</span>&nbsp;<span class="op" id="5134819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134823">l</span><span class="op" id="5134824">.</span><span class="ident" id="5134825">state</span>&nbsp;<span class="op" id="5134831">=</span>&nbsp;<span class="ident" id="5134833">l</span><span class="op" id="5134834">.</span><span class="ident" id="5134835">state</span><span class="op" id="5134840">(</span><span class="ident" id="5134841">l</span><span class="op" id="5134842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134845">}</span><br>
<span class="lineno">200</span><span class="op" id="5134847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5134850">//&nbsp;state&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5134870">const</span>&nbsp;<span class="op" id="5134876">(</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134879">leftDelim</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5134892">=</span>&nbsp;<span class="string" id="5134894">&#34;{{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134900">rightDelim</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5134913">=</span>&nbsp;<span class="string" id="5134915">&#34;}}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134921">leftComment</span>&nbsp;&nbsp;<span class="op" id="5134934">=</span>&nbsp;<span class="string" id="5134936">&#34;/*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5134942">rightComment</span>&nbsp;<span class="op" id="5134955">=</span>&nbsp;<span class="string" id="5134957">&#34;*/&#34;</span><br>
<span class="lineno"></span><span class="op" id="5134962">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5134965">//&nbsp;lexText&nbsp;scans&nbsp;until&nbsp;an&nbsp;opening&nbsp;action&nbsp;delimiter,&nbsp;&#34;{{&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5135023">func</span>&nbsp;<span class="ident" id="5135028">lexText</span><span class="op" id="5135035">(</span><span class="ident" id="5135036">l</span>&nbsp;<span class="op" id="5135038">*</span><span class="ident" id="5135039">lexer</span><span class="op" id="5135044">)</span>&nbsp;<span class="ident" id="5135046">stateFn</span>&nbsp;<span class="op" id="5135054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135057">for</span>&nbsp;<span class="op" id="5135061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135065">if</span>&nbsp;<span class="ident" id="5135068">strings</span><span class="op" id="5135075">.</span><span class="ident" id="5135076">HasPrefix</span><span class="op" id="5135085">(</span><span class="ident" id="5135086">l</span><span class="op" id="5135087">.</span><span class="ident" id="5135088">input</span><span class="op" id="5135093">[</span><span class="ident" id="5135094">l</span><span class="op" id="5135095">.</span><span class="ident" id="5135096">pos</span><span class="op" id="5135099">:</span><span class="op" id="5135100">]</span><span class="op" id="5135101">,</span>&nbsp;<span class="ident" id="5135103">l</span><span class="op" id="5135104">.</span><span class="ident" id="5135105">leftDelim</span><span class="op" id="5135114">)</span>&nbsp;<span class="op" id="5135116">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135121">if</span>&nbsp;<span class="ident" id="5135124">l</span><span class="op" id="5135125">.</span><span class="ident" id="5135126">pos</span>&nbsp;<span class="op" id="5135130">&gt;</span>&nbsp;<span class="ident" id="5135132">l</span><span class="op" id="5135133">.</span><span class="ident" id="5135134">start</span>&nbsp;<span class="op" id="5135140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135146">l</span><span class="op" id="5135147">.</span><span class="ident" id="5135148">emit</span><span class="op" id="5135152">(</span><span class="ident" id="5135153">itemText</span><span class="op" id="5135161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135171">return</span>&nbsp;<span class="ident" id="5135178">lexLeftDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135193">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135197">if</span>&nbsp;<span class="ident" id="5135200">l</span><span class="op" id="5135201">.</span><span class="ident" id="5135202">next</span><span class="op" id="5135206">(</span><span class="op" id="5135207">)</span>&nbsp;<span class="op" id="5135209">==</span>&nbsp;<span class="ident" id="5135212">eof</span>&nbsp;<span class="op" id="5135216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135221">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5135235">//&nbsp;Correctly&nbsp;reached&nbsp;EOF.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135262">if</span>&nbsp;<span class="ident" id="5135265">l</span><span class="op" id="5135266">.</span><span class="ident" id="5135267">pos</span>&nbsp;<span class="op" id="5135271">&gt;</span>&nbsp;<span class="ident" id="5135273">l</span><span class="op" id="5135274">.</span><span class="ident" id="5135275">start</span>&nbsp;<span class="op" id="5135281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135285">l</span><span class="op" id="5135286">.</span><span class="ident" id="5135287">emit</span><span class="op" id="5135291">(</span><span class="ident" id="5135292">itemText</span><span class="op" id="5135300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135306">l</span><span class="op" id="5135307">.</span><span class="ident" id="5135308">emit</span><span class="op" id="5135312">(</span><span class="ident" id="5135313">itemEOF</span><span class="op" id="5135320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135323">return</span>&nbsp;<span class="ident" id="5135330">nil</span><br>
<span class="lineno">230</span><span class="op" id="5135334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5135337">//&nbsp;lexLeftDelim&nbsp;scans&nbsp;the&nbsp;left&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="5135409">func</span>&nbsp;<span class="ident" id="5135414">lexLeftDelim</span><span class="op" id="5135426">(</span><span class="ident" id="5135427">l</span>&nbsp;<span class="op" id="5135429">*</span><span class="ident" id="5135430">lexer</span><span class="op" id="5135435">)</span>&nbsp;<span class="ident" id="5135437">stateFn</span>&nbsp;<span class="op" id="5135445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135448">l</span><span class="op" id="5135449">.</span><span class="ident" id="5135450">pos</span>&nbsp;<span class="op" id="5135454">+=</span>&nbsp;<span class="ident" id="5135457">Pos</span><span class="op" id="5135460">(</span><span class="builtinfunc" id="5135461">len</span><span class="op" id="5135464">(</span><span class="ident" id="5135465">l</span><span class="op" id="5135466">.</span><span class="ident" id="5135467">leftDelim</span><span class="op" id="5135476">)</span><span class="op" id="5135477">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135480">if</span>&nbsp;<span class="ident" id="5135483">strings</span><span class="op" id="5135490">.</span><span class="ident" id="5135491">HasPrefix</span><span class="op" id="5135500">(</span><span class="ident" id="5135501">l</span><span class="op" id="5135502">.</span><span class="ident" id="5135503">input</span><span class="op" id="5135508">[</span><span class="ident" id="5135509">l</span><span class="op" id="5135510">.</span><span class="ident" id="5135511">pos</span><span class="op" id="5135514">:</span><span class="op" id="5135515">]</span><span class="op" id="5135516">,</span>&nbsp;<span class="ident" id="5135518">leftComment</span><span class="op" id="5135529">)</span>&nbsp;<span class="op" id="5135531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135535">return</span>&nbsp;<span class="ident" id="5135542">lexComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135557">l</span><span class="op" id="5135558">.</span><span class="ident" id="5135559">emit</span><span class="op" id="5135563">(</span><span class="ident" id="5135564">itemLeftDelim</span><span class="op" id="5135577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135580">l</span><span class="op" id="5135581">.</span><span class="ident" id="5135582">parenDepth</span>&nbsp;<span class="op" id="5135593">=</span>&nbsp;<span class="num" id="5135595">0</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135598">return</span>&nbsp;<span class="ident" id="5135605">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5135621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5135624">//&nbsp;lexComment&nbsp;scans&nbsp;a&nbsp;comment.&nbsp;The&nbsp;left&nbsp;comment&nbsp;marker&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="5135703">func</span>&nbsp;<span class="ident" id="5135708">lexComment</span><span class="op" id="5135718">(</span><span class="ident" id="5135719">l</span>&nbsp;<span class="op" id="5135721">*</span><span class="ident" id="5135722">lexer</span><span class="op" id="5135727">)</span>&nbsp;<span class="ident" id="5135729">stateFn</span>&nbsp;<span class="op" id="5135737">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135740">l</span><span class="op" id="5135741">.</span><span class="ident" id="5135742">pos</span>&nbsp;<span class="op" id="5135746">+=</span>&nbsp;<span class="ident" id="5135749">Pos</span><span class="op" id="5135752">(</span><span class="builtinfunc" id="5135753">len</span><span class="op" id="5135756">(</span><span class="ident" id="5135757">leftComment</span><span class="op" id="5135768">)</span><span class="op" id="5135769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135772">i</span>&nbsp;<span class="op" id="5135774">:=</span>&nbsp;<span class="ident" id="5135777">strings</span><span class="op" id="5135784">.</span><span class="ident" id="5135785">Index</span><span class="op" id="5135790">(</span><span class="ident" id="5135791">l</span><span class="op" id="5135792">.</span><span class="ident" id="5135793">input</span><span class="op" id="5135798">[</span><span class="ident" id="5135799">l</span><span class="op" id="5135800">.</span><span class="ident" id="5135801">pos</span><span class="op" id="5135804">:</span><span class="op" id="5135805">]</span><span class="op" id="5135806">,</span>&nbsp;<span class="ident" id="5135808">rightComment</span><span class="op" id="5135820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135823">if</span>&nbsp;<span class="ident" id="5135826">i</span>&nbsp;<span class="op" id="5135828">&lt;</span>&nbsp;<span class="num" id="5135830">0</span>&nbsp;<span class="op" id="5135832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135836">return</span>&nbsp;<span class="ident" id="5135843">l</span><span class="op" id="5135844">.</span><span class="ident" id="5135845">errorf</span><span class="op" id="5135851">(</span><span class="string" id="5135852">&#34;unclosed&nbsp;comment&#34;</span><span class="op" id="5135870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5135873">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5135876">l</span><span class="op" id="5135877">.</span><span class="ident" id="5135878">pos</span>&nbsp;<span class="op" id="5135882">+=</span>&nbsp;<span class="ident" id="5135885">Pos</span><span class="op" id="5135888">(</span><span class="ident" id="5135889">i</span>&nbsp;<span class="op" id="5135891">+</span>&nbsp;<span class="builtinfunc" id="5135893">len</span><span class="op" id="5135896">(</span><span class="ident" id="5135897">rightComment</span><span class="op" id="5135909">)</span><span class="op" id="5135910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135913">if</span>&nbsp;<span class="op" id="5135916">!</span><span class="ident" id="5135917">strings</span><span class="op" id="5135924">.</span><span class="ident" id="5135925">HasPrefix</span><span class="op" id="5135934">(</span><span class="ident" id="5135935">l</span><span class="op" id="5135936">.</span><span class="ident" id="5135937">input</span><span class="op" id="5135942">[</span><span class="ident" id="5135943">l</span><span class="op" id="5135944">.</span><span class="ident" id="5135945">pos</span><span class="op" id="5135948">:</span><span class="op" id="5135949">]</span><span class="op" id="5135950">,</span>&nbsp;<span class="ident" id="5135952">l</span><span class="op" id="5135953">.</span><span class="ident" id="5135954">rightDelim</span><span class="op" id="5135964">)</span>&nbsp;<span class="op" id="5135966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5135970">return</span>&nbsp;<span class="ident" id="5135977">l</span><span class="op" id="5135978">.</span><span class="ident" id="5135979">errorf</span><span class="op" id="5135985">(</span><span class="string" id="5135986">&#34;comment&nbsp;ends&nbsp;before&nbsp;closing&nbsp;delimiter&#34;</span><span class="op" id="5136025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136029">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136032">l</span><span class="op" id="5136033">.</span><span class="ident" id="5136034">pos</span>&nbsp;<span class="op" id="5136038">+=</span>&nbsp;<span class="ident" id="5136041">Pos</span><span class="op" id="5136044">(</span><span class="builtinfunc" id="5136045">len</span><span class="op" id="5136048">(</span><span class="ident" id="5136049">l</span><span class="op" id="5136050">.</span><span class="ident" id="5136051">rightDelim</span><span class="op" id="5136061">)</span><span class="op" id="5136062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136065">l</span><span class="op" id="5136066">.</span><span class="ident" id="5136067">ignore</span><span class="op" id="5136073">(</span><span class="op" id="5136074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136077">return</span>&nbsp;<span class="ident" id="5136084">lexText</span><br>
<span class="lineno"></span><span class="op" id="5136092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="5136095">//&nbsp;lexRightDelim&nbsp;scans&nbsp;the&nbsp;right&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="5136169">func</span>&nbsp;<span class="ident" id="5136174">lexRightDelim</span><span class="op" id="5136187">(</span><span class="ident" id="5136188">l</span>&nbsp;<span class="op" id="5136190">*</span><span class="ident" id="5136191">lexer</span><span class="op" id="5136196">)</span>&nbsp;<span class="ident" id="5136198">stateFn</span>&nbsp;<span class="op" id="5136206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136209">l</span><span class="op" id="5136210">.</span><span class="ident" id="5136211">pos</span>&nbsp;<span class="op" id="5136215">+=</span>&nbsp;<span class="ident" id="5136218">Pos</span><span class="op" id="5136221">(</span><span class="builtinfunc" id="5136222">len</span><span class="op" id="5136225">(</span><span class="ident" id="5136226">l</span><span class="op" id="5136227">.</span><span class="ident" id="5136228">rightDelim</span><span class="op" id="5136238">)</span><span class="op" id="5136239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136242">l</span><span class="op" id="5136243">.</span><span class="ident" id="5136244">emit</span><span class="op" id="5136248">(</span><span class="ident" id="5136249">itemRightDelim</span><span class="op" id="5136263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136266">return</span>&nbsp;<span class="ident" id="5136273">lexText</span><br>
<span class="lineno">265</span><span class="op" id="5136281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5136284">//&nbsp;lexInsideAction&nbsp;scans&nbsp;the&nbsp;elements&nbsp;inside&nbsp;action&nbsp;delimiters.</span><br>
<span class="lineno"></span><span class="keyword" id="5136348">func</span>&nbsp;<span class="ident" id="5136353">lexInsideAction</span><span class="op" id="5136368">(</span><span class="ident" id="5136369">l</span>&nbsp;<span class="op" id="5136371">*</span><span class="ident" id="5136372">lexer</span><span class="op" id="5136377">)</span>&nbsp;<span class="ident" id="5136379">stateFn</span>&nbsp;<span class="op" id="5136387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5136390">//&nbsp;Either&nbsp;number,&nbsp;quoted&nbsp;string,&nbsp;or&nbsp;identifier.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5136439">//&nbsp;Spaces&nbsp;separate&nbsp;arguments;&nbsp;runs&nbsp;of&nbsp;spaces&nbsp;turn&nbsp;into&nbsp;itemSpace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5136506">//&nbsp;Pipe&nbsp;symbols&nbsp;separate&nbsp;and&nbsp;are&nbsp;emitted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136549">if</span>&nbsp;<span class="ident" id="5136552">strings</span><span class="op" id="5136559">.</span><span class="ident" id="5136560">HasPrefix</span><span class="op" id="5136569">(</span><span class="ident" id="5136570">l</span><span class="op" id="5136571">.</span><span class="ident" id="5136572">input</span><span class="op" id="5136577">[</span><span class="ident" id="5136578">l</span><span class="op" id="5136579">.</span><span class="ident" id="5136580">pos</span><span class="op" id="5136583">:</span><span class="op" id="5136584">]</span><span class="op" id="5136585">,</span>&nbsp;<span class="ident" id="5136587">l</span><span class="op" id="5136588">.</span><span class="ident" id="5136589">rightDelim</span><span class="op" id="5136599">)</span>&nbsp;<span class="op" id="5136601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136605">if</span>&nbsp;<span class="ident" id="5136608">l</span><span class="op" id="5136609">.</span><span class="ident" id="5136610">parenDepth</span>&nbsp;<span class="op" id="5136621">==</span>&nbsp;<span class="num" id="5136624">0</span>&nbsp;<span class="op" id="5136626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136631">return</span>&nbsp;<span class="ident" id="5136638">lexRightDelim</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136658">return</span>&nbsp;<span class="ident" id="5136665">l</span><span class="op" id="5136666">.</span><span class="ident" id="5136667">errorf</span><span class="op" id="5136673">(</span><span class="string" id="5136674">&#34;unclosed&nbsp;left&nbsp;paren&#34;</span><span class="op" id="5136695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136701">switch</span>&nbsp;<span class="ident" id="5136708">r</span>&nbsp;<span class="op" id="5136710">:=</span>&nbsp;<span class="ident" id="5136713">l</span><span class="op" id="5136714">.</span><span class="ident" id="5136715">next</span><span class="op" id="5136719">(</span><span class="op" id="5136720">)</span><span class="op" id="5136721">;</span>&nbsp;<span class="op" id="5136723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136726">case</span>&nbsp;<span class="ident" id="5136731">r</span>&nbsp;<span class="op" id="5136733">==</span>&nbsp;<span class="ident" id="5136736">eof</span>&nbsp;<span class="op" id="5136740">||</span>&nbsp;<span class="ident" id="5136743">isEndOfLine</span><span class="op" id="5136754">(</span><span class="ident" id="5136755">r</span><span class="op" id="5136756">)</span><span class="op" id="5136757">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136761">return</span>&nbsp;<span class="ident" id="5136768">l</span><span class="op" id="5136769">.</span><span class="ident" id="5136770">errorf</span><span class="op" id="5136776">(</span><span class="string" id="5136777">&#34;unclosed&nbsp;action&#34;</span><span class="op" id="5136794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136797">case</span>&nbsp;<span class="ident" id="5136802">isSpace</span><span class="op" id="5136809">(</span><span class="ident" id="5136810">r</span><span class="op" id="5136811">)</span><span class="op" id="5136812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136816">return</span>&nbsp;<span class="ident" id="5136823">lexSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136833">case</span>&nbsp;<span class="ident" id="5136838">r</span>&nbsp;<span class="op" id="5136840">==</span>&nbsp;<span class="string" id="5136843">&#39;:&#39;</span><span class="op" id="5136846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136850">if</span>&nbsp;<span class="ident" id="5136853">l</span><span class="op" id="5136854">.</span><span class="ident" id="5136855">next</span><span class="op" id="5136859">(</span><span class="op" id="5136860">)</span>&nbsp;<span class="op" id="5136862">!=</span>&nbsp;<span class="string" id="5136865">&#39;=&#39;</span>&nbsp;<span class="op" id="5136869">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136874">return</span>&nbsp;<span class="ident" id="5136881">l</span><span class="op" id="5136882">.</span><span class="ident" id="5136883">errorf</span><span class="op" id="5136889">(</span><span class="string" id="5136890">&#34;expected&nbsp;:=&#34;</span><span class="op" id="5136903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5136907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136911">l</span><span class="op" id="5136912">.</span><span class="ident" id="5136913">emit</span><span class="op" id="5136917">(</span><span class="ident" id="5136918">itemColonEquals</span><span class="op" id="5136933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136936">case</span>&nbsp;<span class="ident" id="5136941">r</span>&nbsp;<span class="op" id="5136943">==</span>&nbsp;<span class="string" id="5136946">&#39;|&#39;</span><span class="op" id="5136949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5136953">l</span><span class="op" id="5136954">.</span><span class="ident" id="5136955">emit</span><span class="op" id="5136959">(</span><span class="ident" id="5136960">itemPipe</span><span class="op" id="5136968">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136971">case</span>&nbsp;<span class="ident" id="5136976">r</span>&nbsp;<span class="op" id="5136978">==</span>&nbsp;<span class="string" id="5136981">&#39;&#34;&#39;</span><span class="op" id="5136984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5136988">return</span>&nbsp;<span class="ident" id="5136995">lexQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137005">case</span>&nbsp;<span class="ident" id="5137010">r</span>&nbsp;<span class="op" id="5137012">==</span>&nbsp;<span class="string" id="5137015">&#39;`&#39;</span><span class="op" id="5137018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137022">return</span>&nbsp;<span class="ident" id="5137029">lexRawQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137042">case</span>&nbsp;<span class="ident" id="5137047">r</span>&nbsp;<span class="op" id="5137049">==</span>&nbsp;<span class="string" id="5137052">&#39;$&#39;</span><span class="op" id="5137055">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137059">return</span>&nbsp;<span class="ident" id="5137066">lexVariable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137079">case</span>&nbsp;<span class="ident" id="5137084">r</span>&nbsp;<span class="op" id="5137086">==</span>&nbsp;<span class="string" id="5137089">&#39;\&#39;&#39;</span><span class="op" id="5137093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137097">return</span>&nbsp;<span class="ident" id="5137104">lexChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137113">case</span>&nbsp;<span class="ident" id="5137118">r</span>&nbsp;<span class="op" id="5137120">==</span>&nbsp;<span class="string" id="5137123">&#39;.&#39;</span><span class="op" id="5137126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5137130">//&nbsp;special&nbsp;look-ahead&nbsp;for&nbsp;&#34;.field&#34;&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;break&nbsp;l.backup().</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137197">if</span>&nbsp;<span class="ident" id="5137200">l</span><span class="op" id="5137201">.</span><span class="ident" id="5137202">pos</span>&nbsp;<span class="op" id="5137206">&lt;</span>&nbsp;<span class="ident" id="5137208">Pos</span><span class="op" id="5137211">(</span><span class="builtinfunc" id="5137212">len</span><span class="op" id="5137215">(</span><span class="ident" id="5137216">l</span><span class="op" id="5137217">.</span><span class="ident" id="5137218">input</span><span class="op" id="5137223">)</span><span class="op" id="5137224">)</span>&nbsp;<span class="op" id="5137226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137231">r</span>&nbsp;<span class="op" id="5137233">:=</span>&nbsp;<span class="ident" id="5137236">l</span><span class="op" id="5137237">.</span><span class="ident" id="5137238">input</span><span class="op" id="5137243">[</span><span class="ident" id="5137244">l</span><span class="op" id="5137245">.</span><span class="ident" id="5137246">pos</span><span class="op" id="5137249">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137254">if</span>&nbsp;<span class="ident" id="5137257">r</span>&nbsp;<span class="op" id="5137259">&lt;</span>&nbsp;<span class="string" id="5137261">&#39;0&#39;</span>&nbsp;<span class="op" id="5137265">||</span>&nbsp;<span class="string" id="5137268">&#39;9&#39;</span>&nbsp;<span class="op" id="5137272">&lt;</span>&nbsp;<span class="ident" id="5137274">r</span>&nbsp;<span class="op" id="5137276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137282">return</span>&nbsp;<span class="ident" id="5137289">lexField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137301">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137309">fallthrough</span>&nbsp;<span class="comment" id="5137321">//&nbsp;&#39;.&#39;&nbsp;can&nbsp;start&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137349">case</span>&nbsp;<span class="ident" id="5137354">r</span>&nbsp;<span class="op" id="5137356">==</span>&nbsp;<span class="string" id="5137359">&#39;+&#39;</span>&nbsp;<span class="op" id="5137363">||</span>&nbsp;<span class="ident" id="5137366">r</span>&nbsp;<span class="op" id="5137368">==</span>&nbsp;<span class="string" id="5137371">&#39;-&#39;</span>&nbsp;<span class="op" id="5137375">||</span>&nbsp;<span class="op" id="5137378">(</span><span class="string" id="5137379">&#39;0&#39;</span>&nbsp;<span class="op" id="5137383">&lt;=</span>&nbsp;<span class="ident" id="5137386">r</span>&nbsp;<span class="op" id="5137388">&amp;&amp;</span>&nbsp;<span class="ident" id="5137391">r</span>&nbsp;<span class="op" id="5137393">&lt;=</span>&nbsp;<span class="string" id="5137396">&#39;9&#39;</span><span class="op" id="5137399">)</span><span class="op" id="5137400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137404">l</span><span class="op" id="5137405">.</span><span class="ident" id="5137406">backup</span><span class="op" id="5137412">(</span><span class="op" id="5137413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137417">return</span>&nbsp;<span class="ident" id="5137424">lexNumber</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137435">case</span>&nbsp;<span class="ident" id="5137440">isAlphaNumeric</span><span class="op" id="5137454">(</span><span class="ident" id="5137455">r</span><span class="op" id="5137456">)</span><span class="op" id="5137457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137461">l</span><span class="op" id="5137462">.</span><span class="ident" id="5137463">backup</span><span class="op" id="5137469">(</span><span class="op" id="5137470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137474">return</span>&nbsp;<span class="ident" id="5137481">lexIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137496">case</span>&nbsp;<span class="ident" id="5137501">r</span>&nbsp;<span class="op" id="5137503">==</span>&nbsp;<span class="string" id="5137506">&#39;(&#39;</span><span class="op" id="5137509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137513">l</span><span class="op" id="5137514">.</span><span class="ident" id="5137515">emit</span><span class="op" id="5137519">(</span><span class="ident" id="5137520">itemLeftParen</span><span class="op" id="5137533">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137537">l</span><span class="op" id="5137538">.</span><span class="ident" id="5137539">parenDepth</span><span class="op" id="5137549">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137554">return</span>&nbsp;<span class="ident" id="5137561">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137578">case</span>&nbsp;<span class="ident" id="5137583">r</span>&nbsp;<span class="op" id="5137585">==</span>&nbsp;<span class="string" id="5137588">&#39;)&#39;</span><span class="op" id="5137591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137595">l</span><span class="op" id="5137596">.</span><span class="ident" id="5137597">emit</span><span class="op" id="5137601">(</span><span class="ident" id="5137602">itemRightParen</span><span class="op" id="5137616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137620">l</span><span class="op" id="5137621">.</span><span class="ident" id="5137622">parenDepth</span><span class="op" id="5137632">--</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137637">if</span>&nbsp;<span class="ident" id="5137640">l</span><span class="op" id="5137641">.</span><span class="ident" id="5137642">parenDepth</span>&nbsp;<span class="op" id="5137653">&lt;</span>&nbsp;<span class="num" id="5137655">0</span>&nbsp;<span class="op" id="5137657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137662">return</span>&nbsp;<span class="ident" id="5137669">l</span><span class="op" id="5137670">.</span><span class="ident" id="5137671">errorf</span><span class="op" id="5137677">(</span><span class="string" id="5137678">&#34;unexpected&nbsp;right&nbsp;paren&nbsp;%#U&#34;</span><span class="op" id="5137706">,</span>&nbsp;<span class="ident" id="5137708">r</span><span class="op" id="5137709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137717">return</span>&nbsp;<span class="ident" id="5137724">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137741">case</span>&nbsp;<span class="ident" id="5137746">r</span>&nbsp;<span class="op" id="5137748">&lt;=</span>&nbsp;<span class="ident" id="5137751">unicode</span><span class="op" id="5137758">.</span><span class="ident" id="5137759">MaxASCII</span>&nbsp;<span class="op" id="5137768">&amp;&amp;</span>&nbsp;<span class="ident" id="5137771">unicode</span><span class="op" id="5137778">.</span><span class="ident" id="5137779">IsPrint</span><span class="op" id="5137786">(</span><span class="ident" id="5137787">r</span><span class="op" id="5137788">)</span><span class="op" id="5137789">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5137793">l</span><span class="op" id="5137794">.</span><span class="ident" id="5137795">emit</span><span class="op" id="5137799">(</span><span class="ident" id="5137800">itemChar</span><span class="op" id="5137808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137812">return</span>&nbsp;<span class="ident" id="5137819">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137836">default</span><span class="op" id="5137843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137847">return</span>&nbsp;<span class="ident" id="5137854">l</span><span class="op" id="5137855">.</span><span class="ident" id="5137856">errorf</span><span class="op" id="5137862">(</span><span class="string" id="5137863">&#34;unrecognized&nbsp;character&nbsp;in&nbsp;action:&nbsp;%#U&#34;</span><span class="op" id="5137902">,</span>&nbsp;<span class="ident" id="5137904">r</span><span class="op" id="5137905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5137908">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5137911">return</span>&nbsp;<span class="ident" id="5137918">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5137934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5137937">//&nbsp;lexSpace&nbsp;scans&nbsp;a&nbsp;run&nbsp;of&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="5137982">//&nbsp;One&nbsp;space&nbsp;has&nbsp;already&nbsp;been&nbsp;seen.</span><br>
<span class="lineno">335</span><span class="keyword" id="5138018">func</span>&nbsp;<span class="ident" id="5138023">lexSpace</span><span class="op" id="5138031">(</span><span class="ident" id="5138032">l</span>&nbsp;<span class="op" id="5138034">*</span><span class="ident" id="5138035">lexer</span><span class="op" id="5138040">)</span>&nbsp;<span class="ident" id="5138042">stateFn</span>&nbsp;<span class="op" id="5138050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138053">for</span>&nbsp;<span class="ident" id="5138057">isSpace</span><span class="op" id="5138064">(</span><span class="ident" id="5138065">l</span><span class="op" id="5138066">.</span><span class="ident" id="5138067">peek</span><span class="op" id="5138071">(</span><span class="op" id="5138072">)</span><span class="op" id="5138073">)</span>&nbsp;<span class="op" id="5138075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138079">l</span><span class="op" id="5138080">.</span><span class="ident" id="5138081">next</span><span class="op" id="5138085">(</span><span class="op" id="5138086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138092">l</span><span class="op" id="5138093">.</span><span class="ident" id="5138094">emit</span><span class="op" id="5138098">(</span><span class="ident" id="5138099">itemSpace</span><span class="op" id="5138108">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138111">return</span>&nbsp;<span class="ident" id="5138118">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5138134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138137">//&nbsp;lexIdentifier&nbsp;scans&nbsp;an&nbsp;alphanumeric.</span><br>
<span class="lineno"></span><span class="keyword" id="5138177">func</span>&nbsp;<span class="ident" id="5138182">lexIdentifier</span><span class="op" id="5138195">(</span><span class="ident" id="5138196">l</span>&nbsp;<span class="op" id="5138198">*</span><span class="ident" id="5138199">lexer</span><span class="op" id="5138204">)</span>&nbsp;<span class="ident" id="5138206">stateFn</span>&nbsp;<span class="op" id="5138214">{</span><br>
<span class="lineno">345</span><span class="ident" id="5138216">Loop</span><span class="op" id="5138220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138223">for</span>&nbsp;<span class="op" id="5138227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138231">switch</span>&nbsp;<span class="ident" id="5138238">r</span>&nbsp;<span class="op" id="5138240">:=</span>&nbsp;<span class="ident" id="5138243">l</span><span class="op" id="5138244">.</span><span class="ident" id="5138245">next</span><span class="op" id="5138249">(</span><span class="op" id="5138250">)</span><span class="op" id="5138251">;</span>&nbsp;<span class="op" id="5138253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138257">case</span>&nbsp;<span class="ident" id="5138262">isAlphaNumeric</span><span class="op" id="5138276">(</span><span class="ident" id="5138277">r</span><span class="op" id="5138278">)</span><span class="op" id="5138279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138284">//&nbsp;absorb.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138297">default</span><span class="op" id="5138304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138309">l</span><span class="op" id="5138310">.</span><span class="ident" id="5138311">backup</span><span class="op" id="5138317">(</span><span class="op" id="5138318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138323">word</span>&nbsp;<span class="op" id="5138328">:=</span>&nbsp;<span class="ident" id="5138331">l</span><span class="op" id="5138332">.</span><span class="ident" id="5138333">input</span><span class="op" id="5138338">[</span><span class="ident" id="5138339">l</span><span class="op" id="5138340">.</span><span class="ident" id="5138341">start</span><span class="op" id="5138346">:</span><span class="ident" id="5138347">l</span><span class="op" id="5138348">.</span><span class="ident" id="5138349">pos</span><span class="op" id="5138352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138357">if</span>&nbsp;<span class="op" id="5138360">!</span><span class="ident" id="5138361">l</span><span class="op" id="5138362">.</span><span class="ident" id="5138363">atTerminator</span><span class="op" id="5138375">(</span><span class="op" id="5138376">)</span>&nbsp;<span class="op" id="5138378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138384">return</span>&nbsp;<span class="ident" id="5138391">l</span><span class="op" id="5138392">.</span><span class="ident" id="5138393">errorf</span><span class="op" id="5138399">(</span><span class="string" id="5138400">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="5138419">,</span>&nbsp;<span class="ident" id="5138421">r</span><span class="op" id="5138422">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138432">switch</span>&nbsp;<span class="op" id="5138439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138444">case</span>&nbsp;<span class="ident" id="5138449">key</span><span class="op" id="5138452">[</span><span class="ident" id="5138453">word</span><span class="op" id="5138457">]</span>&nbsp;<span class="op" id="5138459">&gt;</span>&nbsp;<span class="ident" id="5138461">itemKeyword</span><span class="op" id="5138472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138478">l</span><span class="op" id="5138479">.</span><span class="ident" id="5138480">emit</span><span class="op" id="5138484">(</span><span class="ident" id="5138485">key</span><span class="op" id="5138488">[</span><span class="ident" id="5138489">word</span><span class="op" id="5138493">]</span><span class="op" id="5138494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138499">case</span>&nbsp;<span class="ident" id="5138504">word</span><span class="op" id="5138508">[</span><span class="num" id="5138509">0</span><span class="op" id="5138510">]</span>&nbsp;<span class="op" id="5138512">==</span>&nbsp;<span class="string" id="5138515">&#39;.&#39;</span><span class="op" id="5138518">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138524">l</span><span class="op" id="5138525">.</span><span class="ident" id="5138526">emit</span><span class="op" id="5138530">(</span><span class="ident" id="5138531">itemField</span><span class="op" id="5138540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138545">case</span>&nbsp;<span class="ident" id="5138550">word</span>&nbsp;<span class="op" id="5138555">==</span>&nbsp;<span class="string" id="5138558">&#34;true&#34;</span><span class="op" id="5138564">,</span>&nbsp;<span class="ident" id="5138566">word</span>&nbsp;<span class="op" id="5138571">==</span>&nbsp;<span class="string" id="5138574">&#34;false&#34;</span><span class="op" id="5138581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138587">l</span><span class="op" id="5138588">.</span><span class="ident" id="5138589">emit</span><span class="op" id="5138593">(</span><span class="ident" id="5138594">itemBool</span><span class="op" id="5138602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138607">default</span><span class="op" id="5138614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138620">l</span><span class="op" id="5138621">.</span><span class="ident" id="5138622">emit</span><span class="op" id="5138626">(</span><span class="ident" id="5138627">itemIdentifier</span><span class="op" id="5138641">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138651">break</span>&nbsp;<span class="ident" id="5138657">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5138667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138670">return</span>&nbsp;<span class="ident" id="5138677">lexInsideAction</span><br>
<span class="lineno">370</span><span class="op" id="5138693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138696">//&nbsp;lexField&nbsp;scans&nbsp;a&nbsp;field:&nbsp;.Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="5138738">//&nbsp;The&nbsp;.&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="5138765">func</span>&nbsp;<span class="ident" id="5138770">lexField</span><span class="op" id="5138778">(</span><span class="ident" id="5138779">l</span>&nbsp;<span class="op" id="5138781">*</span><span class="ident" id="5138782">lexer</span><span class="op" id="5138787">)</span>&nbsp;<span class="ident" id="5138789">stateFn</span>&nbsp;<span class="op" id="5138797">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138800">return</span>&nbsp;<span class="ident" id="5138807">lexFieldOrVariable</span><span class="op" id="5138825">(</span><span class="ident" id="5138826">l</span><span class="op" id="5138827">,</span>&nbsp;<span class="ident" id="5138829">itemField</span><span class="op" id="5138838">)</span><br>
<span class="lineno"></span><span class="op" id="5138840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138843">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;Variable:&nbsp;$Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="5138891">//&nbsp;The&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">380</span><span class="keyword" id="5138918">func</span>&nbsp;<span class="ident" id="5138923">lexVariable</span><span class="op" id="5138934">(</span><span class="ident" id="5138935">l</span>&nbsp;<span class="op" id="5138937">*</span><span class="ident" id="5138938">lexer</span><span class="op" id="5138943">)</span>&nbsp;<span class="ident" id="5138945">stateFn</span>&nbsp;<span class="op" id="5138953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5138956">if</span>&nbsp;<span class="ident" id="5138959">l</span><span class="op" id="5138960">.</span><span class="ident" id="5138961">atTerminator</span><span class="op" id="5138973">(</span><span class="op" id="5138974">)</span>&nbsp;<span class="op" id="5138976">{</span>&nbsp;<span class="comment" id="5138978">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139019">l</span><span class="op" id="5139020">.</span><span class="ident" id="5139021">emit</span><span class="op" id="5139025">(</span><span class="ident" id="5139026">itemVariable</span><span class="op" id="5139038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139042">return</span>&nbsp;<span class="ident" id="5139049">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139066">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139069">return</span>&nbsp;<span class="ident" id="5139076">lexFieldOrVariable</span><span class="op" id="5139094">(</span><span class="ident" id="5139095">l</span><span class="op" id="5139096">,</span>&nbsp;<span class="ident" id="5139098">itemVariable</span><span class="op" id="5139110">)</span><br>
<span class="lineno"></span><span class="op" id="5139112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139115">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;field&nbsp;or&nbsp;variable:&nbsp;[.$]Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="5139175">//&nbsp;The&nbsp;.&nbsp;or&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">390</span><span class="keyword" id="5139207">func</span>&nbsp;<span class="ident" id="5139212">lexFieldOrVariable</span><span class="op" id="5139230">(</span><span class="ident" id="5139231">l</span>&nbsp;<span class="op" id="5139233">*</span><span class="ident" id="5139234">lexer</span><span class="op" id="5139239">,</span>&nbsp;<span class="ident" id="5139241">typ</span>&nbsp;<span class="ident" id="5139245">itemType</span><span class="op" id="5139253">)</span>&nbsp;<span class="ident" id="5139255">stateFn</span>&nbsp;<span class="op" id="5139263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139266">if</span>&nbsp;<span class="ident" id="5139269">l</span><span class="op" id="5139270">.</span><span class="ident" id="5139271">atTerminator</span><span class="op" id="5139283">(</span><span class="op" id="5139284">)</span>&nbsp;<span class="op" id="5139286">{</span>&nbsp;<span class="comment" id="5139288">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;.&#34;&nbsp;or&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139336">if</span>&nbsp;<span class="ident" id="5139339">typ</span>&nbsp;<span class="op" id="5139343">==</span>&nbsp;<span class="ident" id="5139346">itemVariable</span>&nbsp;<span class="op" id="5139359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139364">l</span><span class="op" id="5139365">.</span><span class="ident" id="5139366">emit</span><span class="op" id="5139370">(</span><span class="ident" id="5139371">itemVariable</span><span class="op" id="5139383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139387">}</span>&nbsp;<span class="keyword" id="5139389">else</span>&nbsp;<span class="op" id="5139394">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139399">l</span><span class="op" id="5139400">.</span><span class="ident" id="5139401">emit</span><span class="op" id="5139405">(</span><span class="ident" id="5139406">itemDot</span><span class="op" id="5139413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139421">return</span>&nbsp;<span class="ident" id="5139428">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139448">var</span>&nbsp;<span class="ident" id="5139452">r</span>&nbsp;<span class="builtintype" id="5139454">rune</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139460">for</span>&nbsp;<span class="op" id="5139464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139468">r</span>&nbsp;<span class="op" id="5139470">=</span>&nbsp;<span class="ident" id="5139472">l</span><span class="op" id="5139473">.</span><span class="ident" id="5139474">next</span><span class="op" id="5139478">(</span><span class="op" id="5139479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139483">if</span>&nbsp;<span class="op" id="5139486">!</span><span class="ident" id="5139487">isAlphaNumeric</span><span class="op" id="5139501">(</span><span class="ident" id="5139502">r</span><span class="op" id="5139503">)</span>&nbsp;<span class="op" id="5139505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139510">l</span><span class="op" id="5139511">.</span><span class="ident" id="5139512">backup</span><span class="op" id="5139518">(</span><span class="op" id="5139519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139524">break</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139538">if</span>&nbsp;<span class="op" id="5139541">!</span><span class="ident" id="5139542">l</span><span class="op" id="5139543">.</span><span class="ident" id="5139544">atTerminator</span><span class="op" id="5139556">(</span><span class="op" id="5139557">)</span>&nbsp;<span class="op" id="5139559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139563">return</span>&nbsp;<span class="ident" id="5139570">l</span><span class="op" id="5139571">.</span><span class="ident" id="5139572">errorf</span><span class="op" id="5139578">(</span><span class="string" id="5139579">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="5139598">,</span>&nbsp;<span class="ident" id="5139600">r</span><span class="op" id="5139601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139604">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139607">l</span><span class="op" id="5139608">.</span><span class="ident" id="5139609">emit</span><span class="op" id="5139613">(</span><span class="ident" id="5139614">typ</span><span class="op" id="5139617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139620">return</span>&nbsp;<span class="ident" id="5139627">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5139643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139646">//&nbsp;atTerminator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;valid&nbsp;termination&nbsp;character&nbsp;to</span><br>
<span class="lineno">415</span><span class="comment" id="5139725">//&nbsp;appear&nbsp;after&nbsp;an&nbsp;identifier.&nbsp;Breaks&nbsp;.X.Y&nbsp;into&nbsp;two&nbsp;pieces.&nbsp;Also&nbsp;catches&nbsp;cases</span><br>
<span class="lineno"></span><span class="comment" id="5139804">//&nbsp;like&nbsp;&#34;$x+2&#34;&nbsp;not&nbsp;being&nbsp;acceptable&nbsp;without&nbsp;a&nbsp;space,&nbsp;in&nbsp;case&nbsp;we&nbsp;decide&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5139879">//&nbsp;day&nbsp;to&nbsp;implement&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="keyword" id="5139911">func</span>&nbsp;<span class="op" id="5139916">(</span><span class="ident" id="5139917">l</span>&nbsp;<span class="op" id="5139919">*</span><span class="ident" id="5139920">lexer</span><span class="op" id="5139925">)</span>&nbsp;<span class="ident" id="5139927">atTerminator</span><span class="op" id="5139939">(</span><span class="op" id="5139940">)</span>&nbsp;<span class="builtintype" id="5139942">bool</span>&nbsp;<span class="op" id="5139947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5139950">r</span>&nbsp;<span class="op" id="5139952">:=</span>&nbsp;<span class="ident" id="5139955">l</span><span class="op" id="5139956">.</span><span class="ident" id="5139957">peek</span><span class="op" id="5139961">(</span><span class="op" id="5139962">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5139965">if</span>&nbsp;<span class="ident" id="5139968">isSpace</span><span class="op" id="5139975">(</span><span class="ident" id="5139976">r</span><span class="op" id="5139977">)</span>&nbsp;<span class="op" id="5139979">||</span>&nbsp;<span class="ident" id="5139982">isEndOfLine</span><span class="op" id="5139993">(</span><span class="ident" id="5139994">r</span><span class="op" id="5139995">)</span>&nbsp;<span class="op" id="5139997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140001">return</span>&nbsp;<span class="builtintype" id="5140008">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140017">switch</span>&nbsp;<span class="ident" id="5140024">r</span>&nbsp;<span class="op" id="5140026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140029">case</span>&nbsp;<span class="ident" id="5140034">eof</span><span class="op" id="5140037">,</span>&nbsp;<span class="string" id="5140039">&#39;.&#39;</span><span class="op" id="5140042">,</span>&nbsp;<span class="string" id="5140044">&#39;,&#39;</span><span class="op" id="5140047">,</span>&nbsp;<span class="string" id="5140049">&#39;|&#39;</span><span class="op" id="5140052">,</span>&nbsp;<span class="string" id="5140054">&#39;:&#39;</span><span class="op" id="5140057">,</span>&nbsp;<span class="string" id="5140059">&#39;)&#39;</span><span class="op" id="5140062">,</span>&nbsp;<span class="string" id="5140064">&#39;(&#39;</span><span class="op" id="5140067">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140071">return</span>&nbsp;<span class="builtintype" id="5140078">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5140087">//&nbsp;Does&nbsp;r&nbsp;start&nbsp;the&nbsp;delimiter?&nbsp;This&nbsp;can&nbsp;be&nbsp;ambiguous&nbsp;(with&nbsp;delim==&#34;//&#34;,&nbsp;$x/2&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5140170">//&nbsp;succeed&nbsp;but&nbsp;should&nbsp;fail)&nbsp;but&nbsp;only&nbsp;in&nbsp;extremely&nbsp;rare&nbsp;cases&nbsp;caused&nbsp;by&nbsp;willfully</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5140252">//&nbsp;bad&nbsp;choice&nbsp;of&nbsp;delimiter.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140281">if</span>&nbsp;<span class="ident" id="5140284">rd</span><span class="op" id="5140286">,</span>&nbsp;<span class="ident" id="5140288">_</span>&nbsp;<span class="op" id="5140290">:=</span>&nbsp;<span class="ident" id="5140293">utf8</span><span class="op" id="5140297">.</span><span class="ident" id="5140298">DecodeRuneInString</span><span class="op" id="5140316">(</span><span class="ident" id="5140317">l</span><span class="op" id="5140318">.</span><span class="ident" id="5140319">rightDelim</span><span class="op" id="5140329">)</span><span class="op" id="5140330">;</span>&nbsp;<span class="ident" id="5140332">rd</span>&nbsp;<span class="op" id="5140335">==</span>&nbsp;<span class="ident" id="5140338">r</span>&nbsp;<span class="op" id="5140340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140344">return</span>&nbsp;<span class="builtintype" id="5140351">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140360">return</span>&nbsp;<span class="builtintype" id="5140367">false</span><br>
<span class="lineno"></span><span class="op" id="5140373">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="5140376">//&nbsp;lexChar&nbsp;scans&nbsp;a&nbsp;character&nbsp;constant.&nbsp;The&nbsp;initial&nbsp;quote&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="5140444">//&nbsp;scanned.&nbsp;Syntax&nbsp;checking&nbsp;is&nbsp;done&nbsp;by&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="keyword" id="5140495">func</span>&nbsp;<span class="ident" id="5140500">lexChar</span><span class="op" id="5140507">(</span><span class="ident" id="5140508">l</span>&nbsp;<span class="op" id="5140510">*</span><span class="ident" id="5140511">lexer</span><span class="op" id="5140516">)</span>&nbsp;<span class="ident" id="5140518">stateFn</span>&nbsp;<span class="op" id="5140526">{</span><br>
<span class="lineno"></span><span class="ident" id="5140528">Loop</span><span class="op" id="5140532">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140535">for</span>&nbsp;<span class="op" id="5140539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140543">switch</span>&nbsp;<span class="ident" id="5140550">l</span><span class="op" id="5140551">.</span><span class="ident" id="5140552">next</span><span class="op" id="5140556">(</span><span class="op" id="5140557">)</span>&nbsp;<span class="op" id="5140559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140563">case</span>&nbsp;<span class="string" id="5140568">&#39;\\&#39;</span><span class="op" id="5140572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140577">if</span>&nbsp;<span class="ident" id="5140580">r</span>&nbsp;<span class="op" id="5140582">:=</span>&nbsp;<span class="ident" id="5140585">l</span><span class="op" id="5140586">.</span><span class="ident" id="5140587">next</span><span class="op" id="5140591">(</span><span class="op" id="5140592">)</span><span class="op" id="5140593">;</span>&nbsp;<span class="ident" id="5140595">r</span>&nbsp;<span class="op" id="5140597">!=</span>&nbsp;<span class="ident" id="5140600">eof</span>&nbsp;<span class="op" id="5140604">&amp;&amp;</span>&nbsp;<span class="ident" id="5140607">r</span>&nbsp;<span class="op" id="5140609">!=</span>&nbsp;<span class="string" id="5140612">&#39;\n&#39;</span>&nbsp;<span class="op" id="5140617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140623">break</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140637">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140651">case</span>&nbsp;<span class="ident" id="5140656">eof</span><span class="op" id="5140659">,</span>&nbsp;<span class="string" id="5140661">&#39;\n&#39;</span><span class="op" id="5140665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140670">return</span>&nbsp;<span class="ident" id="5140677">l</span><span class="op" id="5140678">.</span><span class="ident" id="5140679">errorf</span><span class="op" id="5140685">(</span><span class="string" id="5140686">&#34;unterminated&nbsp;character&nbsp;constant&#34;</span><span class="op" id="5140719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140723">case</span>&nbsp;<span class="string" id="5140728">&#39;\&#39;&#39;</span><span class="op" id="5140732">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140737">break</span>&nbsp;<span class="ident" id="5140743">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5140753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5140756">l</span><span class="op" id="5140757">.</span><span class="ident" id="5140758">emit</span><span class="op" id="5140762">(</span><span class="ident" id="5140763">itemCharConstant</span><span class="op" id="5140779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5140782">return</span>&nbsp;<span class="ident" id="5140789">lexInsideAction</span><br>
<span class="lineno">455</span><span class="op" id="5140805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5140808">//&nbsp;lexNumber&nbsp;scans&nbsp;a&nbsp;number:&nbsp;decimal,&nbsp;octal,&nbsp;hex,&nbsp;float,&nbsp;or&nbsp;imaginary.&nbsp;This</span><br>
<span class="lineno"></span><span class="comment" id="5140884">//&nbsp;isn&#39;t&nbsp;a&nbsp;perfect&nbsp;number&nbsp;scanner&nbsp;-&nbsp;for&nbsp;instance&nbsp;it&nbsp;accepts&nbsp;&#34;.&#34;&nbsp;and&nbsp;&#34;0x0.2&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5140960">//&nbsp;and&nbsp;&#34;089&#34;&nbsp;-&nbsp;but&nbsp;when&nbsp;it&#39;s&nbsp;wrong&nbsp;the&nbsp;input&nbsp;is&nbsp;invalid&nbsp;and&nbsp;the&nbsp;parser&nbsp;(via</span><br>
<span class="lineno">460</span><span class="comment" id="5141036">//&nbsp;strconv)&nbsp;will&nbsp;notice.</span><br>
<span class="lineno"></span><span class="keyword" id="5141061">func</span>&nbsp;<span class="ident" id="5141066">lexNumber</span><span class="op" id="5141075">(</span><span class="ident" id="5141076">l</span>&nbsp;<span class="op" id="5141078">*</span><span class="ident" id="5141079">lexer</span><span class="op" id="5141084">)</span>&nbsp;<span class="ident" id="5141086">stateFn</span>&nbsp;<span class="op" id="5141094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141097">if</span>&nbsp;<span class="op" id="5141100">!</span><span class="ident" id="5141101">l</span><span class="op" id="5141102">.</span><span class="ident" id="5141103">scanNumber</span><span class="op" id="5141113">(</span><span class="op" id="5141114">)</span>&nbsp;<span class="op" id="5141116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141120">return</span>&nbsp;<span class="ident" id="5141127">l</span><span class="op" id="5141128">.</span><span class="ident" id="5141129">errorf</span><span class="op" id="5141135">(</span><span class="string" id="5141136">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="5141159">,</span>&nbsp;<span class="ident" id="5141161">l</span><span class="op" id="5141162">.</span><span class="ident" id="5141163">input</span><span class="op" id="5141168">[</span><span class="ident" id="5141169">l</span><span class="op" id="5141170">.</span><span class="ident" id="5141171">start</span><span class="op" id="5141176">:</span><span class="ident" id="5141177">l</span><span class="op" id="5141178">.</span><span class="ident" id="5141179">pos</span><span class="op" id="5141182">]</span><span class="op" id="5141183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141186">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141189">if</span>&nbsp;<span class="ident" id="5141192">sign</span>&nbsp;<span class="op" id="5141197">:=</span>&nbsp;<span class="ident" id="5141200">l</span><span class="op" id="5141201">.</span><span class="ident" id="5141202">peek</span><span class="op" id="5141206">(</span><span class="op" id="5141207">)</span><span class="op" id="5141208">;</span>&nbsp;<span class="ident" id="5141210">sign</span>&nbsp;<span class="op" id="5141215">==</span>&nbsp;<span class="string" id="5141218">&#39;+&#39;</span>&nbsp;<span class="op" id="5141222">||</span>&nbsp;<span class="ident" id="5141225">sign</span>&nbsp;<span class="op" id="5141230">==</span>&nbsp;<span class="string" id="5141233">&#39;-&#39;</span>&nbsp;<span class="op" id="5141237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141241">//&nbsp;Complex:&nbsp;1+2i.&nbsp;No&nbsp;spaces,&nbsp;must&nbsp;end&nbsp;in&nbsp;&#39;i&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141289">if</span>&nbsp;<span class="op" id="5141292">!</span><span class="ident" id="5141293">l</span><span class="op" id="5141294">.</span><span class="ident" id="5141295">scanNumber</span><span class="op" id="5141305">(</span><span class="op" id="5141306">)</span>&nbsp;<span class="op" id="5141308">||</span>&nbsp;<span class="ident" id="5141311">l</span><span class="op" id="5141312">.</span><span class="ident" id="5141313">input</span><span class="op" id="5141318">[</span><span class="ident" id="5141319">l</span><span class="op" id="5141320">.</span><span class="ident" id="5141321">pos</span><span class="op" id="5141324">-</span><span class="num" id="5141325">1</span><span class="op" id="5141326">]</span>&nbsp;<span class="op" id="5141328">!=</span>&nbsp;<span class="string" id="5141331">&#39;i&#39;</span>&nbsp;<span class="op" id="5141335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141340">return</span>&nbsp;<span class="ident" id="5141347">l</span><span class="op" id="5141348">.</span><span class="ident" id="5141349">errorf</span><span class="op" id="5141355">(</span><span class="string" id="5141356">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="5141379">,</span>&nbsp;<span class="ident" id="5141381">l</span><span class="op" id="5141382">.</span><span class="ident" id="5141383">input</span><span class="op" id="5141388">[</span><span class="ident" id="5141389">l</span><span class="op" id="5141390">.</span><span class="ident" id="5141391">start</span><span class="op" id="5141396">:</span><span class="ident" id="5141397">l</span><span class="op" id="5141398">.</span><span class="ident" id="5141399">pos</span><span class="op" id="5141402">]</span><span class="op" id="5141403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141407">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141411">l</span><span class="op" id="5141412">.</span><span class="ident" id="5141413">emit</span><span class="op" id="5141417">(</span><span class="ident" id="5141418">itemComplex</span><span class="op" id="5141429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141432">}</span>&nbsp;<span class="keyword" id="5141434">else</span>&nbsp;<span class="op" id="5141439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141443">l</span><span class="op" id="5141444">.</span><span class="ident" id="5141445">emit</span><span class="op" id="5141449">(</span><span class="ident" id="5141450">itemNumber</span><span class="op" id="5141460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141466">return</span>&nbsp;<span class="ident" id="5141473">lexInsideAction</span><br>
<span class="lineno">475</span><span class="op" id="5141489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5141492">func</span>&nbsp;<span class="op" id="5141497">(</span><span class="ident" id="5141498">l</span>&nbsp;<span class="op" id="5141500">*</span><span class="ident" id="5141501">lexer</span><span class="op" id="5141506">)</span>&nbsp;<span class="ident" id="5141508">scanNumber</span><span class="op" id="5141518">(</span><span class="op" id="5141519">)</span>&nbsp;<span class="builtintype" id="5141521">bool</span>&nbsp;<span class="op" id="5141526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141529">//&nbsp;Optional&nbsp;leading&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141556">l</span><span class="op" id="5141557">.</span><span class="ident" id="5141558">accept</span><span class="op" id="5141564">(</span><span class="string" id="5141565">&#34;+-&#34;</span><span class="op" id="5141569">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141572">//&nbsp;Is&nbsp;it&nbsp;hex?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141587">digits</span>&nbsp;<span class="op" id="5141594">:=</span>&nbsp;<span class="string" id="5141597">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141611">if</span>&nbsp;<span class="ident" id="5141614">l</span><span class="op" id="5141615">.</span><span class="ident" id="5141616">accept</span><span class="op" id="5141622">(</span><span class="string" id="5141623">&#34;0&#34;</span><span class="op" id="5141626">)</span>&nbsp;<span class="op" id="5141628">&amp;&amp;</span>&nbsp;<span class="ident" id="5141631">l</span><span class="op" id="5141632">.</span><span class="ident" id="5141633">accept</span><span class="op" id="5141639">(</span><span class="string" id="5141640">&#34;xX&#34;</span><span class="op" id="5141644">)</span>&nbsp;<span class="op" id="5141646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141650">digits</span>&nbsp;<span class="op" id="5141657">=</span>&nbsp;<span class="string" id="5141659">&#34;0123456789abcdefABCDEF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141685">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141688">l</span><span class="op" id="5141689">.</span><span class="ident" id="5141690">acceptRun</span><span class="op" id="5141699">(</span><span class="ident" id="5141700">digits</span><span class="op" id="5141706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141709">if</span>&nbsp;<span class="ident" id="5141712">l</span><span class="op" id="5141713">.</span><span class="ident" id="5141714">accept</span><span class="op" id="5141720">(</span><span class="string" id="5141721">&#34;.&#34;</span><span class="op" id="5141724">)</span>&nbsp;<span class="op" id="5141726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141730">l</span><span class="op" id="5141731">.</span><span class="ident" id="5141732">acceptRun</span><span class="op" id="5141741">(</span><span class="ident" id="5141742">digits</span><span class="op" id="5141748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141754">if</span>&nbsp;<span class="ident" id="5141757">l</span><span class="op" id="5141758">.</span><span class="ident" id="5141759">accept</span><span class="op" id="5141765">(</span><span class="string" id="5141766">&#34;eE&#34;</span><span class="op" id="5141770">)</span>&nbsp;<span class="op" id="5141772">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141776">l</span><span class="op" id="5141777">.</span><span class="ident" id="5141778">accept</span><span class="op" id="5141784">(</span><span class="string" id="5141785">&#34;+-&#34;</span><span class="op" id="5141789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141793">l</span><span class="op" id="5141794">.</span><span class="ident" id="5141795">acceptRun</span><span class="op" id="5141804">(</span><span class="string" id="5141805">&#34;0123456789&#34;</span><span class="op" id="5141817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141823">//&nbsp;Is&nbsp;it&nbsp;imaginary?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141844">l</span><span class="op" id="5141845">.</span><span class="ident" id="5141846">accept</span><span class="op" id="5141852">(</span><span class="string" id="5141853">&#34;i&#34;</span><span class="op" id="5141856">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141859">//&nbsp;Next&nbsp;thing&nbsp;mustn&#39;t&nbsp;be&nbsp;alphanumeric.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141899">if</span>&nbsp;<span class="ident" id="5141902">isAlphaNumeric</span><span class="op" id="5141916">(</span><span class="ident" id="5141917">l</span><span class="op" id="5141918">.</span><span class="ident" id="5141919">peek</span><span class="op" id="5141923">(</span><span class="op" id="5141924">)</span><span class="op" id="5141925">)</span>&nbsp;<span class="op" id="5141927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5141931">l</span><span class="op" id="5141932">.</span><span class="ident" id="5141933">next</span><span class="op" id="5141937">(</span><span class="op" id="5141938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141942">return</span>&nbsp;<span class="builtintype" id="5141949">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141956">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5141959">return</span>&nbsp;<span class="builtintype" id="5141966">true</span><br>
<span class="lineno"></span><span class="op" id="5141971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5141974">//&nbsp;lexQuote&nbsp;scans&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5142009">func</span>&nbsp;<span class="ident" id="5142014">lexQuote</span><span class="op" id="5142022">(</span><span class="ident" id="5142023">l</span>&nbsp;<span class="op" id="5142025">*</span><span class="ident" id="5142026">lexer</span><span class="op" id="5142031">)</span>&nbsp;<span class="ident" id="5142033">stateFn</span>&nbsp;<span class="op" id="5142041">{</span><br>
<span class="lineno">505</span><span class="ident" id="5142043">Loop</span><span class="op" id="5142047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142050">for</span>&nbsp;<span class="op" id="5142054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142058">switch</span>&nbsp;<span class="ident" id="5142065">l</span><span class="op" id="5142066">.</span><span class="ident" id="5142067">next</span><span class="op" id="5142071">(</span><span class="op" id="5142072">)</span>&nbsp;<span class="op" id="5142074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142078">case</span>&nbsp;<span class="string" id="5142083">&#39;\\&#39;</span><span class="op" id="5142087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142092">if</span>&nbsp;<span class="ident" id="5142095">r</span>&nbsp;<span class="op" id="5142097">:=</span>&nbsp;<span class="ident" id="5142100">l</span><span class="op" id="5142101">.</span><span class="ident" id="5142102">next</span><span class="op" id="5142106">(</span><span class="op" id="5142107">)</span><span class="op" id="5142108">;</span>&nbsp;<span class="ident" id="5142110">r</span>&nbsp;<span class="op" id="5142112">!=</span>&nbsp;<span class="ident" id="5142115">eof</span>&nbsp;<span class="op" id="5142119">&amp;&amp;</span>&nbsp;<span class="ident" id="5142122">r</span>&nbsp;<span class="op" id="5142124">!=</span>&nbsp;<span class="string" id="5142127">&#39;\n&#39;</span>&nbsp;<span class="op" id="5142132">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142138">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142152">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142166">case</span>&nbsp;<span class="ident" id="5142171">eof</span><span class="op" id="5142174">,</span>&nbsp;<span class="string" id="5142176">&#39;\n&#39;</span><span class="op" id="5142180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142185">return</span>&nbsp;<span class="ident" id="5142192">l</span><span class="op" id="5142193">.</span><span class="ident" id="5142194">errorf</span><span class="op" id="5142200">(</span><span class="string" id="5142201">&#34;unterminated&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="5142229">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142233">case</span>&nbsp;<span class="string" id="5142238">&#39;&#34;&#39;</span><span class="op" id="5142241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142246">break</span>&nbsp;<span class="ident" id="5142252">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142265">l</span><span class="op" id="5142266">.</span><span class="ident" id="5142267">emit</span><span class="op" id="5142271">(</span><span class="ident" id="5142272">itemString</span><span class="op" id="5142282">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142285">return</span>&nbsp;<span class="ident" id="5142292">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5142308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142311">//&nbsp;lexRawQuote&nbsp;scans&nbsp;a&nbsp;raw&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5142353">func</span>&nbsp;<span class="ident" id="5142358">lexRawQuote</span><span class="op" id="5142369">(</span><span class="ident" id="5142370">l</span>&nbsp;<span class="op" id="5142372">*</span><span class="ident" id="5142373">lexer</span><span class="op" id="5142378">)</span>&nbsp;<span class="ident" id="5142380">stateFn</span>&nbsp;<span class="op" id="5142388">{</span><br>
<span class="lineno">525</span><span class="ident" id="5142390">Loop</span><span class="op" id="5142394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142397">for</span>&nbsp;<span class="op" id="5142401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142405">switch</span>&nbsp;<span class="ident" id="5142412">l</span><span class="op" id="5142413">.</span><span class="ident" id="5142414">next</span><span class="op" id="5142418">(</span><span class="op" id="5142419">)</span>&nbsp;<span class="op" id="5142421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142425">case</span>&nbsp;<span class="ident" id="5142430">eof</span><span class="op" id="5142433">,</span>&nbsp;<span class="string" id="5142435">&#39;\n&#39;</span><span class="op" id="5142439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142444">return</span>&nbsp;<span class="ident" id="5142451">l</span><span class="op" id="5142452">.</span><span class="ident" id="5142453">errorf</span><span class="op" id="5142459">(</span><span class="string" id="5142460">&#34;unterminated&nbsp;raw&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="5142492">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142496">case</span>&nbsp;<span class="string" id="5142501">&#39;`&#39;</span><span class="op" id="5142504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142509">break</span>&nbsp;<span class="ident" id="5142515">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5142528">l</span><span class="op" id="5142529">.</span><span class="ident" id="5142530">emit</span><span class="op" id="5142534">(</span><span class="ident" id="5142535">itemRawString</span><span class="op" id="5142548">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142551">return</span>&nbsp;<span class="ident" id="5142558">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="5142574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142577">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;a&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5142628">func</span>&nbsp;<span class="ident" id="5142633">isSpace</span><span class="op" id="5142640">(</span><span class="ident" id="5142641">r</span>&nbsp;<span class="builtintype" id="5142643">rune</span><span class="op" id="5142647">)</span>&nbsp;<span class="builtintype" id="5142649">bool</span>&nbsp;<span class="op" id="5142654">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142657">return</span>&nbsp;<span class="ident" id="5142664">r</span>&nbsp;<span class="op" id="5142666">==</span>&nbsp;<span class="string" id="5142669">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5142673">||</span>&nbsp;<span class="ident" id="5142676">r</span>&nbsp;<span class="op" id="5142678">==</span>&nbsp;<span class="string" id="5142681">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="5142686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142689">//&nbsp;isEndOfLine&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;end-of-line&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5142751">func</span>&nbsp;<span class="ident" id="5142756">isEndOfLine</span><span class="op" id="5142767">(</span><span class="ident" id="5142768">r</span>&nbsp;<span class="builtintype" id="5142770">rune</span><span class="op" id="5142774">)</span>&nbsp;<span class="builtintype" id="5142776">bool</span>&nbsp;<span class="op" id="5142781">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142784">return</span>&nbsp;<span class="ident" id="5142791">r</span>&nbsp;<span class="op" id="5142793">==</span>&nbsp;<span class="string" id="5142796">&#39;\r&#39;</span>&nbsp;<span class="op" id="5142801">||</span>&nbsp;<span class="ident" id="5142804">r</span>&nbsp;<span class="op" id="5142806">==</span>&nbsp;<span class="string" id="5142809">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="5142814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142817">//&nbsp;isAlphaNumeric&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;alphabetic,&nbsp;digit,&nbsp;or&nbsp;underscore.</span><br>
<span class="lineno"></span><span class="keyword" id="5142893">func</span>&nbsp;<span class="ident" id="5142898">isAlphaNumeric</span><span class="op" id="5142912">(</span><span class="ident" id="5142913">r</span>&nbsp;<span class="builtintype" id="5142915">rune</span><span class="op" id="5142919">)</span>&nbsp;<span class="builtintype" id="5142921">bool</span>&nbsp;<span class="op" id="5142926">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5142929">return</span>&nbsp;<span class="ident" id="5142936">r</span>&nbsp;<span class="op" id="5142938">==</span>&nbsp;<span class="string" id="5142941">&#39;_&#39;</span>&nbsp;<span class="op" id="5142945">||</span>&nbsp;<span class="ident" id="5142948">unicode</span><span class="op" id="5142955">.</span><span class="ident" id="5142956">IsLetter</span><span class="op" id="5142964">(</span><span class="ident" id="5142965">r</span><span class="op" id="5142966">)</span>&nbsp;<span class="op" id="5142968">||</span>&nbsp;<span class="ident" id="5142971">unicode</span><span class="op" id="5142978">.</span><span class="ident" id="5142979">IsDigit</span><span class="op" id="5142986">(</span><span class="ident" id="5142987">r</span><span class="op" id="5142988">)</span><br>
<span class="lineno"></span><span class="op" id="5142990">}</span>
</div>
</body>
</html>
