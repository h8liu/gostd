<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4208285">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4208340">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4208394">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4208445">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4208523">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4208541">package</span>&nbsp;<span class="ident" id="4208549">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4208557">import</span>&nbsp;<span class="op" id="4208564">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4208567">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4208577">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4208584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4208587">func</span>&nbsp;<span class="ident" id="4208592">init</span><span class="op" id="4208596">(</span><span class="op" id="4208597">)</span>&nbsp;<span class="op" id="4208599">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208602">crypto</span><span class="op" id="4208608">.</span><span class="ident" id="4208609">RegisterHash</span><span class="op" id="4208621">(</span><span class="ident" id="4208622">crypto</span><span class="op" id="4208628">.</span><span class="ident" id="4208629">SHA384</span><span class="op" id="4208635">,</span>&nbsp;<span class="ident" id="4208637">New384</span><span class="op" id="4208643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208646">crypto</span><span class="op" id="4208652">.</span><span class="ident" id="4208653">RegisterHash</span><span class="op" id="4208665">(</span><span class="ident" id="4208666">crypto</span><span class="op" id="4208672">.</span><span class="ident" id="4208673">SHA512</span><span class="op" id="4208679">,</span>&nbsp;<span class="ident" id="4208681">New</span><span class="op" id="4208684">)</span><br>
<span class="lineno"></span><span class="op" id="4208686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208689">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4208732">const</span>&nbsp;<span class="ident" id="4208738">Size</span>&nbsp;<span class="op" id="4208743">=</span>&nbsp;<span class="num" id="4208745">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208749">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4208792">const</span>&nbsp;<span class="ident" id="4208798">Size384</span>&nbsp;<span class="op" id="4208806">=</span>&nbsp;<span class="num" id="4208808">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4208812">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4208860">const</span>&nbsp;<span class="ident" id="4208866">BlockSize</span>&nbsp;<span class="op" id="4208876">=</span>&nbsp;<span class="num" id="4208878">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4208883">const</span>&nbsp;<span class="op" id="4208889">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208892">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4208902">=</span>&nbsp;<span class="num" id="4208904">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208909">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4208919">=</span>&nbsp;<span class="num" id="4208921">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208941">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4208951">=</span>&nbsp;<span class="num" id="4208953">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208973">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4208983">=</span>&nbsp;<span class="num" id="4208985">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209005">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209015">=</span>&nbsp;<span class="num" id="4209017">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209037">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209047">=</span>&nbsp;<span class="num" id="4209049">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209069">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209079">=</span>&nbsp;<span class="num" id="4209081">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209101">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209111">=</span>&nbsp;<span class="num" id="4209113">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209133">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209143">=</span>&nbsp;<span class="num" id="4209145">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209165">init0_384</span>&nbsp;<span class="op" id="4209175">=</span>&nbsp;<span class="num" id="4209177">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209197">init1_384</span>&nbsp;<span class="op" id="4209207">=</span>&nbsp;<span class="num" id="4209209">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209229">init2_384</span>&nbsp;<span class="op" id="4209239">=</span>&nbsp;<span class="num" id="4209241">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209261">init3_384</span>&nbsp;<span class="op" id="4209271">=</span>&nbsp;<span class="num" id="4209273">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209293">init4_384</span>&nbsp;<span class="op" id="4209303">=</span>&nbsp;<span class="num" id="4209305">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209325">init5_384</span>&nbsp;<span class="op" id="4209335">=</span>&nbsp;<span class="num" id="4209337">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209357">init6_384</span>&nbsp;<span class="op" id="4209367">=</span>&nbsp;<span class="num" id="4209369">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209389">init7_384</span>&nbsp;<span class="op" id="4209399">=</span>&nbsp;<span class="num" id="4209401">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4209420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209423">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4209482">type</span>&nbsp;<span class="ident" id="4209487">digest</span>&nbsp;<span class="keyword" id="4209494">struct</span>&nbsp;<span class="op" id="4209501">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209504">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209510">[</span><span class="num" id="4209511">8</span><span class="op" id="4209512">]</span><span class="ident" id="4209513">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209521">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4209527">[</span><span class="ident" id="4209528">chunk</span><span class="op" id="4209533">]</span><span class="builtintype" id="4209534">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209540">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4209546">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4209551">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4209557">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209565">is384</span>&nbsp;<span class="builtintype" id="4209571">bool</span>&nbsp;<span class="comment" id="4209576">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4209610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4209613">func</span>&nbsp;<span class="op" id="4209618">(</span><span class="ident" id="4209619">d</span>&nbsp;<span class="op" id="4209621">*</span><span class="ident" id="4209622">digest</span><span class="op" id="4209628">)</span>&nbsp;<span class="ident" id="4209630">Reset</span><span class="op" id="4209635">(</span><span class="op" id="4209636">)</span>&nbsp;<span class="op" id="4209638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209641">if</span>&nbsp;<span class="op" id="4209644">!</span><span class="ident" id="4209645">d</span><span class="op" id="4209646">.</span><span class="ident" id="4209647">is384</span>&nbsp;<span class="op" id="4209653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209657">d</span><span class="op" id="4209658">.</span><span class="ident" id="4209659">h</span><span class="op" id="4209660">[</span><span class="num" id="4209661">0</span><span class="op" id="4209662">]</span>&nbsp;<span class="op" id="4209664">=</span>&nbsp;<span class="ident" id="4209666">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209674">d</span><span class="op" id="4209675">.</span><span class="ident" id="4209676">h</span><span class="op" id="4209677">[</span><span class="num" id="4209678">1</span><span class="op" id="4209679">]</span>&nbsp;<span class="op" id="4209681">=</span>&nbsp;<span class="ident" id="4209683">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209691">d</span><span class="op" id="4209692">.</span><span class="ident" id="4209693">h</span><span class="op" id="4209694">[</span><span class="num" id="4209695">2</span><span class="op" id="4209696">]</span>&nbsp;<span class="op" id="4209698">=</span>&nbsp;<span class="ident" id="4209700">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209708">d</span><span class="op" id="4209709">.</span><span class="ident" id="4209710">h</span><span class="op" id="4209711">[</span><span class="num" id="4209712">3</span><span class="op" id="4209713">]</span>&nbsp;<span class="op" id="4209715">=</span>&nbsp;<span class="ident" id="4209717">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209725">d</span><span class="op" id="4209726">.</span><span class="ident" id="4209727">h</span><span class="op" id="4209728">[</span><span class="num" id="4209729">4</span><span class="op" id="4209730">]</span>&nbsp;<span class="op" id="4209732">=</span>&nbsp;<span class="ident" id="4209734">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209742">d</span><span class="op" id="4209743">.</span><span class="ident" id="4209744">h</span><span class="op" id="4209745">[</span><span class="num" id="4209746">5</span><span class="op" id="4209747">]</span>&nbsp;<span class="op" id="4209749">=</span>&nbsp;<span class="ident" id="4209751">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209759">d</span><span class="op" id="4209760">.</span><span class="ident" id="4209761">h</span><span class="op" id="4209762">[</span><span class="num" id="4209763">6</span><span class="op" id="4209764">]</span>&nbsp;<span class="op" id="4209766">=</span>&nbsp;<span class="ident" id="4209768">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209776">d</span><span class="op" id="4209777">.</span><span class="ident" id="4209778">h</span><span class="op" id="4209779">[</span><span class="num" id="4209780">7</span><span class="op" id="4209781">]</span>&nbsp;<span class="op" id="4209783">=</span>&nbsp;<span class="ident" id="4209785">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209792">}</span>&nbsp;<span class="keyword" id="4209794">else</span>&nbsp;<span class="op" id="4209799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209803">d</span><span class="op" id="4209804">.</span><span class="ident" id="4209805">h</span><span class="op" id="4209806">[</span><span class="num" id="4209807">0</span><span class="op" id="4209808">]</span>&nbsp;<span class="op" id="4209810">=</span>&nbsp;<span class="ident" id="4209812">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209824">d</span><span class="op" id="4209825">.</span><span class="ident" id="4209826">h</span><span class="op" id="4209827">[</span><span class="num" id="4209828">1</span><span class="op" id="4209829">]</span>&nbsp;<span class="op" id="4209831">=</span>&nbsp;<span class="ident" id="4209833">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209845">d</span><span class="op" id="4209846">.</span><span class="ident" id="4209847">h</span><span class="op" id="4209848">[</span><span class="num" id="4209849">2</span><span class="op" id="4209850">]</span>&nbsp;<span class="op" id="4209852">=</span>&nbsp;<span class="ident" id="4209854">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209866">d</span><span class="op" id="4209867">.</span><span class="ident" id="4209868">h</span><span class="op" id="4209869">[</span><span class="num" id="4209870">3</span><span class="op" id="4209871">]</span>&nbsp;<span class="op" id="4209873">=</span>&nbsp;<span class="ident" id="4209875">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209887">d</span><span class="op" id="4209888">.</span><span class="ident" id="4209889">h</span><span class="op" id="4209890">[</span><span class="num" id="4209891">4</span><span class="op" id="4209892">]</span>&nbsp;<span class="op" id="4209894">=</span>&nbsp;<span class="ident" id="4209896">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209908">d</span><span class="op" id="4209909">.</span><span class="ident" id="4209910">h</span><span class="op" id="4209911">[</span><span class="num" id="4209912">5</span><span class="op" id="4209913">]</span>&nbsp;<span class="op" id="4209915">=</span>&nbsp;<span class="ident" id="4209917">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209929">d</span><span class="op" id="4209930">.</span><span class="ident" id="4209931">h</span><span class="op" id="4209932">[</span><span class="num" id="4209933">6</span><span class="op" id="4209934">]</span>&nbsp;<span class="op" id="4209936">=</span>&nbsp;<span class="ident" id="4209938">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209950">d</span><span class="op" id="4209951">.</span><span class="ident" id="4209952">h</span><span class="op" id="4209953">[</span><span class="num" id="4209954">7</span><span class="op" id="4209955">]</span>&nbsp;<span class="op" id="4209957">=</span>&nbsp;<span class="ident" id="4209959">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209973">d</span><span class="op" id="4209974">.</span><span class="ident" id="4209975">nx</span>&nbsp;<span class="op" id="4209978">=</span>&nbsp;<span class="num" id="4209980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209983">d</span><span class="op" id="4209984">.</span><span class="builtinfunc" id="4209985">len</span>&nbsp;<span class="op" id="4209989">=</span>&nbsp;<span class="num" id="4209991">0</span><br>
<span class="lineno"></span><span class="op" id="4209993">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4209996">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4210058">func</span>&nbsp;<span class="ident" id="4210063">New</span><span class="op" id="4210066">(</span><span class="op" id="4210067">)</span>&nbsp;<span class="ident" id="4210069">hash</span><span class="op" id="4210073">.</span><span class="ident" id="4210074">Hash</span>&nbsp;<span class="op" id="4210079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210082">d</span>&nbsp;<span class="op" id="4210084">:=</span>&nbsp;<span class="builtinfunc" id="4210087">new</span><span class="op" id="4210090">(</span><span class="ident" id="4210091">digest</span><span class="op" id="4210097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210100">d</span><span class="op" id="4210101">.</span><span class="ident" id="4210102">Reset</span><span class="op" id="4210107">(</span><span class="op" id="4210108">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210111">return</span>&nbsp;<span class="ident" id="4210118">d</span><br>
<span class="lineno"></span><span class="op" id="4210120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4210123">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4210188">func</span>&nbsp;<span class="ident" id="4210193">New384</span><span class="op" id="4210199">(</span><span class="op" id="4210200">)</span>&nbsp;<span class="ident" id="4210202">hash</span><span class="op" id="4210206">.</span><span class="ident" id="4210207">Hash</span>&nbsp;<span class="op" id="4210212">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210215">d</span>&nbsp;<span class="op" id="4210217">:=</span>&nbsp;<span class="builtinfunc" id="4210220">new</span><span class="op" id="4210223">(</span><span class="ident" id="4210224">digest</span><span class="op" id="4210230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210233">d</span><span class="op" id="4210234">.</span><span class="ident" id="4210235">is384</span>&nbsp;<span class="op" id="4210241">=</span>&nbsp;<span class="builtintype" id="4210243">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210249">d</span><span class="op" id="4210250">.</span><span class="ident" id="4210251">Reset</span><span class="op" id="4210256">(</span><span class="op" id="4210257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210260">return</span>&nbsp;<span class="ident" id="4210267">d</span><br>
<span class="lineno"></span><span class="op" id="4210269">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4210272">func</span>&nbsp;<span class="op" id="4210277">(</span><span class="ident" id="4210278">d</span>&nbsp;<span class="op" id="4210280">*</span><span class="ident" id="4210281">digest</span><span class="op" id="4210287">)</span>&nbsp;<span class="ident" id="4210289">Size</span><span class="op" id="4210293">(</span><span class="op" id="4210294">)</span>&nbsp;<span class="builtintype" id="4210296">int</span>&nbsp;<span class="op" id="4210300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210303">if</span>&nbsp;<span class="op" id="4210306">!</span><span class="ident" id="4210307">d</span><span class="op" id="4210308">.</span><span class="ident" id="4210309">is384</span>&nbsp;<span class="op" id="4210315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210319">return</span>&nbsp;<span class="ident" id="4210326">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210332">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210335">return</span>&nbsp;<span class="ident" id="4210342">Size384</span><br>
<span class="lineno"></span><span class="op" id="4210350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4210353">func</span>&nbsp;<span class="op" id="4210358">(</span><span class="ident" id="4210359">d</span>&nbsp;<span class="op" id="4210361">*</span><span class="ident" id="4210362">digest</span><span class="op" id="4210368">)</span>&nbsp;<span class="ident" id="4210370">BlockSize</span><span class="op" id="4210379">(</span><span class="op" id="4210380">)</span>&nbsp;<span class="builtintype" id="4210382">int</span>&nbsp;<span class="op" id="4210386">{</span>&nbsp;<span class="keyword" id="4210388">return</span>&nbsp;<span class="ident" id="4210395">BlockSize</span>&nbsp;<span class="op" id="4210405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4210408">func</span>&nbsp;<span class="op" id="4210413">(</span><span class="ident" id="4210414">d</span>&nbsp;<span class="op" id="4210416">*</span><span class="ident" id="4210417">digest</span><span class="op" id="4210423">)</span>&nbsp;<span class="ident" id="4210425">Write</span><span class="op" id="4210430">(</span><span class="ident" id="4210431">p</span>&nbsp;<span class="op" id="4210433">[</span><span class="op" id="4210434">]</span><span class="builtintype" id="4210435">byte</span><span class="op" id="4210439">)</span>&nbsp;<span class="op" id="4210441">(</span><span class="ident" id="4210442">nn</span>&nbsp;<span class="builtintype" id="4210445">int</span><span class="op" id="4210448">,</span>&nbsp;<span class="ident" id="4210450">err</span>&nbsp;<span class="builtintype" id="4210454">error</span><span class="op" id="4210459">)</span>&nbsp;<span class="op" id="4210461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210464">nn</span>&nbsp;<span class="op" id="4210467">=</span>&nbsp;<span class="builtinfunc" id="4210469">len</span><span class="op" id="4210472">(</span><span class="ident" id="4210473">p</span><span class="op" id="4210474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210477">d</span><span class="op" id="4210478">.</span><span class="builtinfunc" id="4210479">len</span>&nbsp;<span class="op" id="4210483">+=</span>&nbsp;<span class="ident" id="4210486">uint64</span><span class="op" id="4210492">(</span><span class="ident" id="4210493">nn</span><span class="op" id="4210495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210498">if</span>&nbsp;<span class="ident" id="4210501">d</span><span class="op" id="4210502">.</span><span class="ident" id="4210503">nx</span>&nbsp;<span class="op" id="4210506">&gt;</span>&nbsp;<span class="num" id="4210508">0</span>&nbsp;<span class="op" id="4210510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210514">n</span>&nbsp;<span class="op" id="4210516">:=</span>&nbsp;<span class="builtinfunc" id="4210519">copy</span><span class="op" id="4210523">(</span><span class="ident" id="4210524">d</span><span class="op" id="4210525">.</span><span class="ident" id="4210526">x</span><span class="op" id="4210527">[</span><span class="ident" id="4210528">d</span><span class="op" id="4210529">.</span><span class="ident" id="4210530">nx</span><span class="op" id="4210532">:</span><span class="op" id="4210533">]</span><span class="op" id="4210534">,</span>&nbsp;<span class="ident" id="4210536">p</span><span class="op" id="4210537">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210541">d</span><span class="op" id="4210542">.</span><span class="ident" id="4210543">nx</span>&nbsp;<span class="op" id="4210546">+=</span>&nbsp;<span class="ident" id="4210549">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210553">if</span>&nbsp;<span class="ident" id="4210556">d</span><span class="op" id="4210557">.</span><span class="ident" id="4210558">nx</span>&nbsp;<span class="op" id="4210561">==</span>&nbsp;<span class="ident" id="4210564">chunk</span>&nbsp;<span class="op" id="4210570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210575">block</span><span class="op" id="4210580">(</span><span class="ident" id="4210581">d</span><span class="op" id="4210582">,</span>&nbsp;<span class="ident" id="4210584">d</span><span class="op" id="4210585">.</span><span class="ident" id="4210586">x</span><span class="op" id="4210587">[</span><span class="op" id="4210588">:</span><span class="op" id="4210589">]</span><span class="op" id="4210590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210595">d</span><span class="op" id="4210596">.</span><span class="ident" id="4210597">nx</span>&nbsp;<span class="op" id="4210600">=</span>&nbsp;<span class="num" id="4210602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210606">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210610">p</span>&nbsp;<span class="op" id="4210612">=</span>&nbsp;<span class="ident" id="4210614">p</span><span class="op" id="4210615">[</span><span class="ident" id="4210616">n</span><span class="op" id="4210617">:</span><span class="op" id="4210618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210624">if</span>&nbsp;<span class="builtinfunc" id="4210627">len</span><span class="op" id="4210630">(</span><span class="ident" id="4210631">p</span><span class="op" id="4210632">)</span>&nbsp;<span class="op" id="4210634">&gt;=</span>&nbsp;<span class="ident" id="4210637">chunk</span>&nbsp;<span class="op" id="4210643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210647">n</span>&nbsp;<span class="op" id="4210649">:=</span>&nbsp;<span class="builtinfunc" id="4210652">len</span><span class="op" id="4210655">(</span><span class="ident" id="4210656">p</span><span class="op" id="4210657">)</span>&nbsp;<span class="op" id="4210659">&amp;^</span>&nbsp;<span class="op" id="4210662">(</span><span class="ident" id="4210663">chunk</span>&nbsp;<span class="op" id="4210669">-</span>&nbsp;<span class="num" id="4210671">1</span><span class="op" id="4210672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210676">block</span><span class="op" id="4210681">(</span><span class="ident" id="4210682">d</span><span class="op" id="4210683">,</span>&nbsp;<span class="ident" id="4210685">p</span><span class="op" id="4210686">[</span><span class="op" id="4210687">:</span><span class="ident" id="4210688">n</span><span class="op" id="4210689">]</span><span class="op" id="4210690">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210694">p</span>&nbsp;<span class="op" id="4210696">=</span>&nbsp;<span class="ident" id="4210698">p</span><span class="op" id="4210699">[</span><span class="ident" id="4210700">n</span><span class="op" id="4210701">:</span><span class="op" id="4210702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210708">if</span>&nbsp;<span class="builtinfunc" id="4210711">len</span><span class="op" id="4210714">(</span><span class="ident" id="4210715">p</span><span class="op" id="4210716">)</span>&nbsp;<span class="op" id="4210718">&gt;</span>&nbsp;<span class="num" id="4210720">0</span>&nbsp;<span class="op" id="4210722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210726">d</span><span class="op" id="4210727">.</span><span class="ident" id="4210728">nx</span>&nbsp;<span class="op" id="4210731">=</span>&nbsp;<span class="builtinfunc" id="4210733">copy</span><span class="op" id="4210737">(</span><span class="ident" id="4210738">d</span><span class="op" id="4210739">.</span><span class="ident" id="4210740">x</span><span class="op" id="4210741">[</span><span class="op" id="4210742">:</span><span class="op" id="4210743">]</span><span class="op" id="4210744">,</span>&nbsp;<span class="ident" id="4210746">p</span><span class="op" id="4210747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210750">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210753">return</span><br>
<span class="lineno"></span><span class="op" id="4210760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4210763">func</span>&nbsp;<span class="op" id="4210768">(</span><span class="ident" id="4210769">d0</span>&nbsp;<span class="op" id="4210772">*</span><span class="ident" id="4210773">digest</span><span class="op" id="4210779">)</span>&nbsp;<span class="ident" id="4210781">Sum</span><span class="op" id="4210784">(</span><span class="ident" id="4210785">in</span>&nbsp;<span class="op" id="4210788">[</span><span class="op" id="4210789">]</span><span class="builtintype" id="4210790">byte</span><span class="op" id="4210794">)</span>&nbsp;<span class="op" id="4210796">[</span><span class="op" id="4210797">]</span><span class="builtintype" id="4210798">byte</span>&nbsp;<span class="op" id="4210803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210806">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210873">d</span>&nbsp;<span class="op" id="4210875">:=</span>&nbsp;<span class="builtinfunc" id="4210878">new</span><span class="op" id="4210881">(</span><span class="ident" id="4210882">digest</span><span class="op" id="4210888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210891">*</span><span class="ident" id="4210892">d</span>&nbsp;<span class="op" id="4210894">=</span>&nbsp;<span class="op" id="4210896">*</span><span class="ident" id="4210897">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210901">hash</span>&nbsp;<span class="op" id="4210906">:=</span>&nbsp;<span class="ident" id="4210909">d</span><span class="op" id="4210910">.</span><span class="ident" id="4210911">checkSum</span><span class="op" id="4210919">(</span><span class="op" id="4210920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210923">if</span>&nbsp;<span class="ident" id="4210926">d</span><span class="op" id="4210927">.</span><span class="ident" id="4210928">is384</span>&nbsp;<span class="op" id="4210934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210938">return</span>&nbsp;<span class="builtinfunc" id="4210945">append</span><span class="op" id="4210951">(</span><span class="ident" id="4210952">in</span><span class="op" id="4210954">,</span>&nbsp;<span class="ident" id="4210956">hash</span><span class="op" id="4210960">[</span><span class="op" id="4210961">:</span><span class="ident" id="4210962">Size384</span><span class="op" id="4210969">]</span><span class="op" id="4210970">...</span><span class="op" id="4210973">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210979">return</span>&nbsp;<span class="builtinfunc" id="4210986">append</span><span class="op" id="4210992">(</span><span class="ident" id="4210993">in</span><span class="op" id="4210995">,</span>&nbsp;<span class="ident" id="4210997">hash</span><span class="op" id="4211001">[</span><span class="op" id="4211002">:</span><span class="op" id="4211003">]</span><span class="op" id="4211004">...</span><span class="op" id="4211007">)</span><br>
<span class="lineno"></span><span class="op" id="4211009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4211012">func</span>&nbsp;<span class="op" id="4211017">(</span><span class="ident" id="4211018">d</span>&nbsp;<span class="op" id="4211020">*</span><span class="ident" id="4211021">digest</span><span class="op" id="4211027">)</span>&nbsp;<span class="ident" id="4211029">checkSum</span><span class="op" id="4211037">(</span><span class="op" id="4211038">)</span>&nbsp;<span class="op" id="4211040">[</span><span class="ident" id="4211041">Size</span><span class="op" id="4211045">]</span><span class="builtintype" id="4211046">byte</span>&nbsp;<span class="op" id="4211051">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4211054">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4211116">len</span>&nbsp;<span class="op" id="4211120">:=</span>&nbsp;<span class="ident" id="4211123">d</span><span class="op" id="4211124">.</span><span class="builtinfunc" id="4211125">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211130">var</span>&nbsp;<span class="ident" id="4211134">tmp</span>&nbsp;<span class="op" id="4211138">[</span><span class="num" id="4211139">128</span><span class="op" id="4211142">]</span><span class="builtintype" id="4211143">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211149">tmp</span><span class="op" id="4211152">[</span><span class="num" id="4211153">0</span><span class="op" id="4211154">]</span>&nbsp;<span class="op" id="4211156">=</span>&nbsp;<span class="num" id="4211158">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211164">if</span>&nbsp;<span class="builtinfunc" id="4211167">len</span><span class="op" id="4211170">%</span><span class="num" id="4211171">128</span>&nbsp;<span class="op" id="4211175">&lt;</span>&nbsp;<span class="num" id="4211177">112</span>&nbsp;<span class="op" id="4211181">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211185">d</span><span class="op" id="4211186">.</span><span class="ident" id="4211187">Write</span><span class="op" id="4211192">(</span><span class="ident" id="4211193">tmp</span><span class="op" id="4211196">[</span><span class="num" id="4211197">0</span>&nbsp;<span class="op" id="4211199">:</span>&nbsp;<span class="num" id="4211201">112</span><span class="op" id="4211204">-</span><span class="builtinfunc" id="4211205">len</span><span class="op" id="4211208">%</span><span class="num" id="4211209">128</span><span class="op" id="4211212">]</span><span class="op" id="4211213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211216">}</span>&nbsp;<span class="keyword" id="4211218">else</span>&nbsp;<span class="op" id="4211223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211227">d</span><span class="op" id="4211228">.</span><span class="ident" id="4211229">Write</span><span class="op" id="4211234">(</span><span class="ident" id="4211235">tmp</span><span class="op" id="4211238">[</span><span class="num" id="4211239">0</span>&nbsp;<span class="op" id="4211241">:</span>&nbsp;<span class="num" id="4211243">128</span><span class="op" id="4211246">+</span><span class="num" id="4211247">112</span><span class="op" id="4211250">-</span><span class="builtinfunc" id="4211251">len</span><span class="op" id="4211254">%</span><span class="num" id="4211255">128</span><span class="op" id="4211258">]</span><span class="op" id="4211259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4211266">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4211286">len</span>&nbsp;<span class="op" id="4211290">&lt;&lt;=</span>&nbsp;<span class="num" id="4211294">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211297">for</span>&nbsp;<span class="ident" id="4211301">i</span>&nbsp;<span class="op" id="4211303">:=</span>&nbsp;<span class="builtintype" id="4211306">uint</span><span class="op" id="4211310">(</span><span class="num" id="4211311">0</span><span class="op" id="4211312">)</span><span class="op" id="4211313">;</span>&nbsp;<span class="ident" id="4211315">i</span>&nbsp;<span class="op" id="4211317">&lt;</span>&nbsp;<span class="num" id="4211319">16</span><span class="op" id="4211321">;</span>&nbsp;<span class="ident" id="4211323">i</span><span class="op" id="4211324">++</span>&nbsp;<span class="op" id="4211327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211331">tmp</span><span class="op" id="4211334">[</span><span class="ident" id="4211335">i</span><span class="op" id="4211336">]</span>&nbsp;<span class="op" id="4211338">=</span>&nbsp;<span class="builtintype" id="4211340">byte</span><span class="op" id="4211344">(</span><span class="builtinfunc" id="4211345">len</span>&nbsp;<span class="op" id="4211349">&gt;&gt;</span>&nbsp;<span class="op" id="4211352">(</span><span class="num" id="4211353">120</span>&nbsp;<span class="op" id="4211357">-</span>&nbsp;<span class="num" id="4211359">8</span><span class="op" id="4211360">*</span><span class="ident" id="4211361">i</span><span class="op" id="4211362">)</span><span class="op" id="4211363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211366">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211369">d</span><span class="op" id="4211370">.</span><span class="ident" id="4211371">Write</span><span class="op" id="4211376">(</span><span class="ident" id="4211377">tmp</span><span class="op" id="4211380">[</span><span class="num" id="4211381">0</span><span class="op" id="4211382">:</span><span class="num" id="4211383">16</span><span class="op" id="4211385">]</span><span class="op" id="4211386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211390">if</span>&nbsp;<span class="ident" id="4211393">d</span><span class="op" id="4211394">.</span><span class="ident" id="4211395">nx</span>&nbsp;<span class="op" id="4211398">!=</span>&nbsp;<span class="num" id="4211401">0</span>&nbsp;<span class="op" id="4211403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4211407">panic</span><span class="op" id="4211412">(</span><span class="string" id="4211413">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4211424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211427">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211431">h</span>&nbsp;<span class="op" id="4211433">:=</span>&nbsp;<span class="ident" id="4211436">d</span><span class="op" id="4211437">.</span><span class="ident" id="4211438">h</span><span class="op" id="4211439">[</span><span class="op" id="4211440">:</span><span class="op" id="4211441">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211444">if</span>&nbsp;<span class="ident" id="4211447">d</span><span class="op" id="4211448">.</span><span class="ident" id="4211449">is384</span>&nbsp;<span class="op" id="4211455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211459">h</span>&nbsp;<span class="op" id="4211461">=</span>&nbsp;<span class="ident" id="4211463">d</span><span class="op" id="4211464">.</span><span class="ident" id="4211465">h</span><span class="op" id="4211466">[</span><span class="op" id="4211467">:</span><span class="num" id="4211468">6</span><span class="op" id="4211469">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211472">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211476">var</span>&nbsp;<span class="ident" id="4211480">digest</span>&nbsp;<span class="op" id="4211487">[</span><span class="ident" id="4211488">Size</span><span class="op" id="4211492">]</span><span class="builtintype" id="4211493">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211499">for</span>&nbsp;<span class="ident" id="4211503">i</span><span class="op" id="4211504">,</span>&nbsp;<span class="ident" id="4211506">s</span>&nbsp;<span class="op" id="4211508">:=</span>&nbsp;<span class="keyword" id="4211511">range</span>&nbsp;<span class="ident" id="4211517">h</span>&nbsp;<span class="op" id="4211519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211523">digest</span><span class="op" id="4211529">[</span><span class="ident" id="4211530">i</span><span class="op" id="4211531">*</span><span class="num" id="4211532">8</span><span class="op" id="4211533">]</span>&nbsp;<span class="op" id="4211535">=</span>&nbsp;<span class="builtintype" id="4211537">byte</span><span class="op" id="4211541">(</span><span class="ident" id="4211542">s</span>&nbsp;<span class="op" id="4211544">&gt;&gt;</span>&nbsp;<span class="num" id="4211547">56</span><span class="op" id="4211549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211553">digest</span><span class="op" id="4211559">[</span><span class="ident" id="4211560">i</span><span class="op" id="4211561">*</span><span class="num" id="4211562">8</span><span class="op" id="4211563">+</span><span class="num" id="4211564">1</span><span class="op" id="4211565">]</span>&nbsp;<span class="op" id="4211567">=</span>&nbsp;<span class="builtintype" id="4211569">byte</span><span class="op" id="4211573">(</span><span class="ident" id="4211574">s</span>&nbsp;<span class="op" id="4211576">&gt;&gt;</span>&nbsp;<span class="num" id="4211579">48</span><span class="op" id="4211581">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211585">digest</span><span class="op" id="4211591">[</span><span class="ident" id="4211592">i</span><span class="op" id="4211593">*</span><span class="num" id="4211594">8</span><span class="op" id="4211595">+</span><span class="num" id="4211596">2</span><span class="op" id="4211597">]</span>&nbsp;<span class="op" id="4211599">=</span>&nbsp;<span class="builtintype" id="4211601">byte</span><span class="op" id="4211605">(</span><span class="ident" id="4211606">s</span>&nbsp;<span class="op" id="4211608">&gt;&gt;</span>&nbsp;<span class="num" id="4211611">40</span><span class="op" id="4211613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211617">digest</span><span class="op" id="4211623">[</span><span class="ident" id="4211624">i</span><span class="op" id="4211625">*</span><span class="num" id="4211626">8</span><span class="op" id="4211627">+</span><span class="num" id="4211628">3</span><span class="op" id="4211629">]</span>&nbsp;<span class="op" id="4211631">=</span>&nbsp;<span class="builtintype" id="4211633">byte</span><span class="op" id="4211637">(</span><span class="ident" id="4211638">s</span>&nbsp;<span class="op" id="4211640">&gt;&gt;</span>&nbsp;<span class="num" id="4211643">32</span><span class="op" id="4211645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211649">digest</span><span class="op" id="4211655">[</span><span class="ident" id="4211656">i</span><span class="op" id="4211657">*</span><span class="num" id="4211658">8</span><span class="op" id="4211659">+</span><span class="num" id="4211660">4</span><span class="op" id="4211661">]</span>&nbsp;<span class="op" id="4211663">=</span>&nbsp;<span class="builtintype" id="4211665">byte</span><span class="op" id="4211669">(</span><span class="ident" id="4211670">s</span>&nbsp;<span class="op" id="4211672">&gt;&gt;</span>&nbsp;<span class="num" id="4211675">24</span><span class="op" id="4211677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211681">digest</span><span class="op" id="4211687">[</span><span class="ident" id="4211688">i</span><span class="op" id="4211689">*</span><span class="num" id="4211690">8</span><span class="op" id="4211691">+</span><span class="num" id="4211692">5</span><span class="op" id="4211693">]</span>&nbsp;<span class="op" id="4211695">=</span>&nbsp;<span class="builtintype" id="4211697">byte</span><span class="op" id="4211701">(</span><span class="ident" id="4211702">s</span>&nbsp;<span class="op" id="4211704">&gt;&gt;</span>&nbsp;<span class="num" id="4211707">16</span><span class="op" id="4211709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211713">digest</span><span class="op" id="4211719">[</span><span class="ident" id="4211720">i</span><span class="op" id="4211721">*</span><span class="num" id="4211722">8</span><span class="op" id="4211723">+</span><span class="num" id="4211724">6</span><span class="op" id="4211725">]</span>&nbsp;<span class="op" id="4211727">=</span>&nbsp;<span class="builtintype" id="4211729">byte</span><span class="op" id="4211733">(</span><span class="ident" id="4211734">s</span>&nbsp;<span class="op" id="4211736">&gt;&gt;</span>&nbsp;<span class="num" id="4211739">8</span><span class="op" id="4211740">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211744">digest</span><span class="op" id="4211750">[</span><span class="ident" id="4211751">i</span><span class="op" id="4211752">*</span><span class="num" id="4211753">8</span><span class="op" id="4211754">+</span><span class="num" id="4211755">7</span><span class="op" id="4211756">]</span>&nbsp;<span class="op" id="4211758">=</span>&nbsp;<span class="builtintype" id="4211760">byte</span><span class="op" id="4211764">(</span><span class="ident" id="4211765">s</span><span class="op" id="4211766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211773">return</span>&nbsp;<span class="ident" id="4211780">digest</span><br>
<span class="lineno"></span><span class="op" id="4211787">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4211790">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4211841">func</span>&nbsp;<span class="ident" id="4211846">Sum512</span><span class="op" id="4211852">(</span><span class="ident" id="4211853">data</span>&nbsp;<span class="op" id="4211858">[</span><span class="op" id="4211859">]</span><span class="builtintype" id="4211860">byte</span><span class="op" id="4211864">)</span>&nbsp;<span class="op" id="4211866">[</span><span class="ident" id="4211867">Size</span><span class="op" id="4211871">]</span><span class="builtintype" id="4211872">byte</span>&nbsp;<span class="op" id="4211877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211880">var</span>&nbsp;<span class="ident" id="4211884">d</span>&nbsp;<span class="ident" id="4211886">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211894">d</span><span class="op" id="4211895">.</span><span class="ident" id="4211896">Reset</span><span class="op" id="4211901">(</span><span class="op" id="4211902">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211905">d</span><span class="op" id="4211906">.</span><span class="ident" id="4211907">Write</span><span class="op" id="4211912">(</span><span class="ident" id="4211913">data</span><span class="op" id="4211917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211920">return</span>&nbsp;<span class="ident" id="4211927">d</span><span class="op" id="4211928">.</span><span class="ident" id="4211929">checkSum</span><span class="op" id="4211937">(</span><span class="op" id="4211938">)</span><br>
<span class="lineno"></span><span class="op" id="4211940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4211943">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4211994">func</span>&nbsp;<span class="ident" id="4211999">Sum384</span><span class="op" id="4212005">(</span><span class="ident" id="4212006">data</span>&nbsp;<span class="op" id="4212011">[</span><span class="op" id="4212012">]</span><span class="builtintype" id="4212013">byte</span><span class="op" id="4212017">)</span>&nbsp;<span class="op" id="4212019">(</span><span class="ident" id="4212020">sum384</span>&nbsp;<span class="op" id="4212027">[</span><span class="ident" id="4212028">Size384</span><span class="op" id="4212035">]</span><span class="builtintype" id="4212036">byte</span><span class="op" id="4212040">)</span>&nbsp;<span class="op" id="4212042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212045">var</span>&nbsp;<span class="ident" id="4212049">d</span>&nbsp;<span class="ident" id="4212051">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212059">d</span><span class="op" id="4212060">.</span><span class="ident" id="4212061">is384</span>&nbsp;<span class="op" id="4212067">=</span>&nbsp;<span class="builtintype" id="4212069">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212075">d</span><span class="op" id="4212076">.</span><span class="ident" id="4212077">Reset</span><span class="op" id="4212082">(</span><span class="op" id="4212083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212086">d</span><span class="op" id="4212087">.</span><span class="ident" id="4212088">Write</span><span class="op" id="4212093">(</span><span class="ident" id="4212094">data</span><span class="op" id="4212098">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212101">sum</span>&nbsp;<span class="op" id="4212105">:=</span>&nbsp;<span class="ident" id="4212108">d</span><span class="op" id="4212109">.</span><span class="ident" id="4212110">checkSum</span><span class="op" id="4212118">(</span><span class="op" id="4212119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4212122">copy</span><span class="op" id="4212126">(</span><span class="ident" id="4212127">sum384</span><span class="op" id="4212133">[</span><span class="op" id="4212134">:</span><span class="op" id="4212135">]</span><span class="op" id="4212136">,</span>&nbsp;<span class="ident" id="4212138">sum</span><span class="op" id="4212141">[</span><span class="op" id="4212142">:</span><span class="ident" id="4212143">Size384</span><span class="op" id="4212150">]</span><span class="op" id="4212151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212154">return</span><br>
<span class="lineno"></span><span class="op" id="4212161">}</span>
</div>
</body>
</html>
