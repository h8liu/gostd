<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5538526">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5538582">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5538636">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5538687">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5538772">package</span>&nbsp;<span class="ident" id="5538780">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5538784">import</span>&nbsp;<span class="op" id="5538791">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538794">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538809">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538828">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538838">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538845">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538851">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5538857">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5538867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5538870">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5538908">type</span>&nbsp;<span class="ident" id="5538913">File</span>&nbsp;<span class="keyword" id="5538918">struct</span>&nbsp;<span class="op" id="5538925">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538928">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538940">OptionalHeader</span>&nbsp;<span class="keyword" id="5538955">interface</span><span class="op" id="5538964">{</span><span class="op" id="5538965">}</span>&nbsp;<span class="comment" id="5538967">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539018">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5539033">[</span><span class="op" id="5539034">]</span><span class="op" id="5539035">*</span><span class="ident" id="5539036">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539045">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5539060">[</span><span class="op" id="5539061">]</span><span class="op" id="5539062">*</span><span class="ident" id="5539063">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539072">closer</span>&nbsp;<span class="ident" id="5539079">io</span><span class="op" id="5539081">.</span><span class="ident" id="5539082">Closer</span><br>
<span class="lineno"></span><span class="op" id="5539089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5539092">type</span>&nbsp;<span class="ident" id="5539097">SectionHeader</span>&nbsp;<span class="keyword" id="5539111">struct</span>&nbsp;<span class="op" id="5539118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539121">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539142">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539150">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539171">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539179">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539200">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539208">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539229">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539237">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539258">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539266">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5539287">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539295">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5539316">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539324">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5539345">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539353">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5539374">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539382">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539403">uint32</span><br>
<span class="lineno"></span><span class="op" id="5539410">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5539413">type</span>&nbsp;<span class="ident" id="5539418">Section</span>&nbsp;<span class="keyword" id="5539426">struct</span>&nbsp;<span class="op" id="5539433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539436">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539452">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539490">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539530">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539565">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539613">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5539663">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539687">io</span><span class="op" id="5539689">.</span><span class="ident" id="5539690">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539700">sr</span>&nbsp;<span class="op" id="5539703">*</span><span class="ident" id="5539704">io</span><span class="op" id="5539706">.</span><span class="ident" id="5539707">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5539721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5539724">type</span>&nbsp;<span class="ident" id="5539729">Symbol</span>&nbsp;<span class="keyword" id="5539736">struct</span>&nbsp;<span class="op" id="5539743">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539746">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539760">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539768">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539782">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539790">SectionNumber</span>&nbsp;<span class="builtintype" id="5539804">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539811">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539825">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539833">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5539847">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5539853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5539856">type</span>&nbsp;<span class="ident" id="5539861">ImportDirectory</span>&nbsp;<span class="keyword" id="5539877">struct</span>&nbsp;<span class="op" id="5539884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539887">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5539906">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539914">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539933">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539941">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539960">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539968">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539987">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539995">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5540014">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540023">dll</span>&nbsp;<span class="builtintype" id="5540027">string</span><br>
<span class="lineno">70</span><span class="op" id="5540034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5540037">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5540095">func</span>&nbsp;<span class="op" id="5540100">(</span><span class="ident" id="5540101">s</span>&nbsp;<span class="op" id="5540103">*</span><span class="ident" id="5540104">Section</span><span class="op" id="5540111">)</span>&nbsp;<span class="ident" id="5540113">Data</span><span class="op" id="5540117">(</span><span class="op" id="5540118">)</span>&nbsp;<span class="op" id="5540120">(</span><span class="op" id="5540121">[</span><span class="op" id="5540122">]</span><span class="builtintype" id="5540123">byte</span><span class="op" id="5540127">,</span>&nbsp;<span class="builtintype" id="5540129">error</span><span class="op" id="5540134">)</span>&nbsp;<span class="op" id="5540136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540139">dat</span>&nbsp;<span class="op" id="5540143">:=</span>&nbsp;<span class="builtinfunc" id="5540146">make</span><span class="op" id="5540150">(</span><span class="op" id="5540151">[</span><span class="op" id="5540152">]</span><span class="builtintype" id="5540153">byte</span><span class="op" id="5540157">,</span>&nbsp;<span class="ident" id="5540159">s</span><span class="op" id="5540160">.</span><span class="ident" id="5540161">sr</span><span class="op" id="5540163">.</span><span class="ident" id="5540164">Size</span><span class="op" id="5540168">(</span><span class="op" id="5540169">)</span><span class="op" id="5540170">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540173">n</span><span class="op" id="5540174">,</span>&nbsp;<span class="ident" id="5540176">err</span>&nbsp;<span class="op" id="5540180">:=</span>&nbsp;<span class="ident" id="5540183">s</span><span class="op" id="5540184">.</span><span class="ident" id="5540185">sr</span><span class="op" id="5540187">.</span><span class="ident" id="5540188">ReadAt</span><span class="op" id="5540194">(</span><span class="ident" id="5540195">dat</span><span class="op" id="5540198">,</span>&nbsp;<span class="num" id="5540200">0</span><span class="op" id="5540201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540204">if</span>&nbsp;<span class="ident" id="5540207">n</span>&nbsp;<span class="op" id="5540209">==</span>&nbsp;<span class="builtinfunc" id="5540212">len</span><span class="op" id="5540215">(</span><span class="ident" id="5540216">dat</span><span class="op" id="5540219">)</span>&nbsp;<span class="op" id="5540221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540225">err</span>&nbsp;<span class="op" id="5540229">=</span>&nbsp;<span class="ident" id="5540231">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540239">return</span>&nbsp;<span class="ident" id="5540246">dat</span><span class="op" id="5540249">[</span><span class="num" id="5540250">0</span><span class="op" id="5540251">:</span><span class="ident" id="5540252">n</span><span class="op" id="5540253">]</span><span class="op" id="5540254">,</span>&nbsp;<span class="ident" id="5540256">err</span><br>
<span class="lineno">80</span><span class="op" id="5540260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5540263">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5540320">func</span>&nbsp;<span class="op" id="5540325">(</span><span class="ident" id="5540326">s</span>&nbsp;<span class="op" id="5540328">*</span><span class="ident" id="5540329">Section</span><span class="op" id="5540336">)</span>&nbsp;<span class="ident" id="5540338">Open</span><span class="op" id="5540342">(</span><span class="op" id="5540343">)</span>&nbsp;<span class="ident" id="5540345">io</span><span class="op" id="5540347">.</span><span class="ident" id="5540348">ReadSeeker</span>&nbsp;<span class="op" id="5540359">{</span>&nbsp;<span class="keyword" id="5540361">return</span>&nbsp;<span class="ident" id="5540368">io</span><span class="op" id="5540370">.</span><span class="ident" id="5540371">NewSectionReader</span><span class="op" id="5540387">(</span><span class="ident" id="5540388">s</span><span class="op" id="5540389">.</span><span class="ident" id="5540390">sr</span><span class="op" id="5540392">,</span>&nbsp;<span class="num" id="5540394">0</span><span class="op" id="5540395">,</span>&nbsp;<span class="num" id="5540397">1</span><span class="op" id="5540398">&lt;&lt;</span><span class="num" id="5540400">63</span><span class="op" id="5540402">-</span><span class="num" id="5540403">1</span><span class="op" id="5540404">)</span>&nbsp;<span class="op" id="5540406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5540409">type</span>&nbsp;<span class="ident" id="5540414">FormatError</span>&nbsp;<span class="keyword" id="5540426">struct</span>&nbsp;<span class="op" id="5540433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540436">off</span>&nbsp;<span class="ident" id="5540440">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540447">msg</span>&nbsp;<span class="builtintype" id="5540451">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540459">val</span>&nbsp;<span class="keyword" id="5540463">interface</span><span class="op" id="5540472">{</span><span class="op" id="5540473">}</span><br>
<span class="lineno"></span><span class="op" id="5540475">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5540478">func</span>&nbsp;<span class="op" id="5540483">(</span><span class="ident" id="5540484">e</span>&nbsp;<span class="op" id="5540486">*</span><span class="ident" id="5540487">FormatError</span><span class="op" id="5540498">)</span>&nbsp;<span class="ident" id="5540500">Error</span><span class="op" id="5540505">(</span><span class="op" id="5540506">)</span>&nbsp;<span class="builtintype" id="5540508">string</span>&nbsp;<span class="op" id="5540515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540518">msg</span>&nbsp;<span class="op" id="5540522">:=</span>&nbsp;<span class="ident" id="5540525">e</span><span class="op" id="5540526">.</span><span class="ident" id="5540527">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540532">if</span>&nbsp;<span class="ident" id="5540535">e</span><span class="op" id="5540536">.</span><span class="ident" id="5540537">val</span>&nbsp;<span class="op" id="5540541">!=</span>&nbsp;<span class="ident" id="5540544">nil</span>&nbsp;<span class="op" id="5540548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540552">msg</span>&nbsp;<span class="op" id="5540556">+=</span>&nbsp;<span class="ident" id="5540559">fmt</span><span class="op" id="5540562">.</span><span class="ident" id="5540563">Sprintf</span><span class="op" id="5540570">(</span><span class="string" id="5540571">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5540578">,</span>&nbsp;<span class="ident" id="5540580">e</span><span class="op" id="5540581">.</span><span class="ident" id="5540582">val</span><span class="op" id="5540585">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540591">msg</span>&nbsp;<span class="op" id="5540595">+=</span>&nbsp;<span class="ident" id="5540598">fmt</span><span class="op" id="5540601">.</span><span class="ident" id="5540602">Sprintf</span><span class="op" id="5540609">(</span><span class="string" id="5540610">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5540634">,</span>&nbsp;<span class="ident" id="5540636">e</span><span class="op" id="5540637">.</span><span class="ident" id="5540638">off</span><span class="op" id="5540641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540644">return</span>&nbsp;<span class="ident" id="5540651">msg</span><br>
<span class="lineno"></span><span class="op" id="5540655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5540658">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5540741">func</span>&nbsp;<span class="ident" id="5540746">Open</span><span class="op" id="5540750">(</span><span class="ident" id="5540751">name</span>&nbsp;<span class="builtintype" id="5540756">string</span><span class="op" id="5540762">)</span>&nbsp;<span class="op" id="5540764">(</span><span class="op" id="5540765">*</span><span class="ident" id="5540766">File</span><span class="op" id="5540770">,</span>&nbsp;<span class="builtintype" id="5540772">error</span><span class="op" id="5540777">)</span>&nbsp;<span class="op" id="5540779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540782">f</span><span class="op" id="5540783">,</span>&nbsp;<span class="ident" id="5540785">err</span>&nbsp;<span class="op" id="5540789">:=</span>&nbsp;<span class="ident" id="5540792">os</span><span class="op" id="5540794">.</span><span class="ident" id="5540795">Open</span><span class="op" id="5540799">(</span><span class="ident" id="5540800">name</span><span class="op" id="5540804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540807">if</span>&nbsp;<span class="ident" id="5540810">err</span>&nbsp;<span class="op" id="5540814">!=</span>&nbsp;<span class="ident" id="5540817">nil</span>&nbsp;<span class="op" id="5540821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540825">return</span>&nbsp;<span class="ident" id="5540832">nil</span><span class="op" id="5540835">,</span>&nbsp;<span class="ident" id="5540837">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540845">ff</span><span class="op" id="5540847">,</span>&nbsp;<span class="ident" id="5540849">err</span>&nbsp;<span class="op" id="5540853">:=</span>&nbsp;<span class="ident" id="5540856">NewFile</span><span class="op" id="5540863">(</span><span class="ident" id="5540864">f</span><span class="op" id="5540865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540868">if</span>&nbsp;<span class="ident" id="5540871">err</span>&nbsp;<span class="op" id="5540875">!=</span>&nbsp;<span class="ident" id="5540878">nil</span>&nbsp;<span class="op" id="5540882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540886">f</span><span class="op" id="5540887">.</span><span class="ident" id="5540888">Close</span><span class="op" id="5540893">(</span><span class="op" id="5540894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540898">return</span>&nbsp;<span class="ident" id="5540905">nil</span><span class="op" id="5540908">,</span>&nbsp;<span class="ident" id="5540910">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540918">ff</span><span class="op" id="5540920">.</span><span class="ident" id="5540921">closer</span>&nbsp;<span class="op" id="5540928">=</span>&nbsp;<span class="ident" id="5540930">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540933">return</span>&nbsp;<span class="ident" id="5540940">ff</span><span class="op" id="5540942">,</span>&nbsp;<span class="ident" id="5540944">nil</span><br>
<span class="lineno"></span><span class="op" id="5540948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5540951">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5540977">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5541044">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5541068">func</span>&nbsp;<span class="op" id="5541073">(</span><span class="ident" id="5541074">f</span>&nbsp;<span class="op" id="5541076">*</span><span class="ident" id="5541077">File</span><span class="op" id="5541081">)</span>&nbsp;<span class="ident" id="5541083">Close</span><span class="op" id="5541088">(</span><span class="op" id="5541089">)</span>&nbsp;<span class="builtintype" id="5541091">error</span>&nbsp;<span class="op" id="5541097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541100">var</span>&nbsp;<span class="ident" id="5541104">err</span>&nbsp;<span class="builtintype" id="5541108">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541115">if</span>&nbsp;<span class="ident" id="5541118">f</span><span class="op" id="5541119">.</span><span class="ident" id="5541120">closer</span>&nbsp;<span class="op" id="5541127">!=</span>&nbsp;<span class="ident" id="5541130">nil</span>&nbsp;<span class="op" id="5541134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541138">err</span>&nbsp;<span class="op" id="5541142">=</span>&nbsp;<span class="ident" id="5541144">f</span><span class="op" id="5541145">.</span><span class="ident" id="5541146">closer</span><span class="op" id="5541152">.</span><span class="ident" id="5541153">Close</span><span class="op" id="5541158">(</span><span class="op" id="5541159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541163">f</span><span class="op" id="5541164">.</span><span class="ident" id="5541165">closer</span>&nbsp;<span class="op" id="5541172">=</span>&nbsp;<span class="ident" id="5541174">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541182">return</span>&nbsp;<span class="ident" id="5541189">err</span><br>
<span class="lineno">125</span><span class="op" id="5541193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541196">var</span>&nbsp;<span class="op" id="5541200">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541203">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5541226">=</span>&nbsp;<span class="builtintype" id="5541228">uint16</span><span class="op" id="5541234">(</span><span class="ident" id="5541235">binary</span><span class="op" id="5541241">.</span><span class="ident" id="5541242">Size</span><span class="op" id="5541246">(</span><span class="ident" id="5541247">OptionalHeader32</span><span class="op" id="5541263">{</span><span class="op" id="5541264">}</span><span class="op" id="5541265">)</span><span class="op" id="5541266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541269">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5541292">=</span>&nbsp;<span class="builtintype" id="5541294">uint16</span><span class="op" id="5541300">(</span><span class="ident" id="5541301">binary</span><span class="op" id="5541307">.</span><span class="ident" id="5541308">Size</span><span class="op" id="5541312">(</span><span class="ident" id="5541313">OptionalHeader64</span><span class="op" id="5541329">{</span><span class="op" id="5541330">}</span><span class="op" id="5541331">)</span><span class="op" id="5541332">)</span><br>
<span class="lineno">130</span><span class="op" id="5541334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5541337">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5541418">func</span>&nbsp;<span class="ident" id="5541423">NewFile</span><span class="op" id="5541430">(</span><span class="ident" id="5541431">r</span>&nbsp;<span class="ident" id="5541433">io</span><span class="op" id="5541435">.</span><span class="ident" id="5541436">ReaderAt</span><span class="op" id="5541444">)</span>&nbsp;<span class="op" id="5541446">(</span><span class="op" id="5541447">*</span><span class="ident" id="5541448">File</span><span class="op" id="5541452">,</span>&nbsp;<span class="builtintype" id="5541454">error</span><span class="op" id="5541459">)</span>&nbsp;<span class="op" id="5541461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541464">f</span>&nbsp;<span class="op" id="5541466">:=</span>&nbsp;<span class="builtinfunc" id="5541469">new</span><span class="op" id="5541472">(</span><span class="ident" id="5541473">File</span><span class="op" id="5541477">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541480">sr</span>&nbsp;<span class="op" id="5541483">:=</span>&nbsp;<span class="ident" id="5541486">io</span><span class="op" id="5541488">.</span><span class="ident" id="5541489">NewSectionReader</span><span class="op" id="5541505">(</span><span class="ident" id="5541506">r</span><span class="op" id="5541507">,</span>&nbsp;<span class="num" id="5541509">0</span><span class="op" id="5541510">,</span>&nbsp;<span class="num" id="5541512">1</span><span class="op" id="5541513">&lt;&lt;</span><span class="num" id="5541515">63</span><span class="op" id="5541517">-</span><span class="num" id="5541518">1</span><span class="op" id="5541519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541523">var</span>&nbsp;<span class="ident" id="5541527">dosheader</span>&nbsp;<span class="op" id="5541537">[</span><span class="num" id="5541538">96</span><span class="op" id="5541540">]</span><span class="builtintype" id="5541541">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541547">if</span>&nbsp;<span class="ident" id="5541550">_</span><span class="op" id="5541551">,</span>&nbsp;<span class="ident" id="5541553">err</span>&nbsp;<span class="op" id="5541557">:=</span>&nbsp;<span class="ident" id="5541560">r</span><span class="op" id="5541561">.</span><span class="ident" id="5541562">ReadAt</span><span class="op" id="5541568">(</span><span class="ident" id="5541569">dosheader</span><span class="op" id="5541578">[</span><span class="num" id="5541579">0</span><span class="op" id="5541580">:</span><span class="op" id="5541581">]</span><span class="op" id="5541582">,</span>&nbsp;<span class="num" id="5541584">0</span><span class="op" id="5541585">)</span><span class="op" id="5541586">;</span>&nbsp;<span class="ident" id="5541588">err</span>&nbsp;<span class="op" id="5541592">!=</span>&nbsp;<span class="ident" id="5541595">nil</span>&nbsp;<span class="op" id="5541599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541603">return</span>&nbsp;<span class="ident" id="5541610">nil</span><span class="op" id="5541613">,</span>&nbsp;<span class="ident" id="5541615">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541623">var</span>&nbsp;<span class="ident" id="5541627">base</span>&nbsp;<span class="ident" id="5541632">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541639">if</span>&nbsp;<span class="ident" id="5541642">dosheader</span><span class="op" id="5541651">[</span><span class="num" id="5541652">0</span><span class="op" id="5541653">]</span>&nbsp;<span class="op" id="5541655">==</span>&nbsp;<span class="string" id="5541658">&#39;M&#39;</span>&nbsp;<span class="op" id="5541662">&amp;&amp;</span>&nbsp;<span class="ident" id="5541665">dosheader</span><span class="op" id="5541674">[</span><span class="num" id="5541675">1</span><span class="op" id="5541676">]</span>&nbsp;<span class="op" id="5541678">==</span>&nbsp;<span class="string" id="5541681">&#39;Z&#39;</span>&nbsp;<span class="op" id="5541685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541689">signoff</span>&nbsp;<span class="op" id="5541697">:=</span>&nbsp;<span class="ident" id="5541700">int64</span><span class="op" id="5541705">(</span><span class="ident" id="5541706">binary</span><span class="op" id="5541712">.</span><span class="ident" id="5541713">LittleEndian</span><span class="op" id="5541725">.</span><span class="ident" id="5541726">Uint32</span><span class="op" id="5541732">(</span><span class="ident" id="5541733">dosheader</span><span class="op" id="5541742">[</span><span class="num" id="5541743">0x3c</span><span class="op" id="5541747">:</span><span class="op" id="5541748">]</span><span class="op" id="5541749">)</span><span class="op" id="5541750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541754">var</span>&nbsp;<span class="ident" id="5541758">sign</span>&nbsp;<span class="op" id="5541763">[</span><span class="num" id="5541764">4</span><span class="op" id="5541765">]</span><span class="builtintype" id="5541766">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541773">r</span><span class="op" id="5541774">.</span><span class="ident" id="5541775">ReadAt</span><span class="op" id="5541781">(</span><span class="ident" id="5541782">sign</span><span class="op" id="5541786">[</span><span class="op" id="5541787">:</span><span class="op" id="5541788">]</span><span class="op" id="5541789">,</span>&nbsp;<span class="ident" id="5541791">signoff</span><span class="op" id="5541798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541802">if</span>&nbsp;<span class="op" id="5541805">!</span><span class="op" id="5541806">(</span><span class="ident" id="5541807">sign</span><span class="op" id="5541811">[</span><span class="num" id="5541812">0</span><span class="op" id="5541813">]</span>&nbsp;<span class="op" id="5541815">==</span>&nbsp;<span class="string" id="5541818">&#39;P&#39;</span>&nbsp;<span class="op" id="5541822">&amp;&amp;</span>&nbsp;<span class="ident" id="5541825">sign</span><span class="op" id="5541829">[</span><span class="num" id="5541830">1</span><span class="op" id="5541831">]</span>&nbsp;<span class="op" id="5541833">==</span>&nbsp;<span class="string" id="5541836">&#39;E&#39;</span>&nbsp;<span class="op" id="5541840">&amp;&amp;</span>&nbsp;<span class="ident" id="5541843">sign</span><span class="op" id="5541847">[</span><span class="num" id="5541848">2</span><span class="op" id="5541849">]</span>&nbsp;<span class="op" id="5541851">==</span>&nbsp;<span class="num" id="5541854">0</span>&nbsp;<span class="op" id="5541856">&amp;&amp;</span>&nbsp;<span class="ident" id="5541859">sign</span><span class="op" id="5541863">[</span><span class="num" id="5541864">3</span><span class="op" id="5541865">]</span>&nbsp;<span class="op" id="5541867">==</span>&nbsp;<span class="num" id="5541870">0</span><span class="op" id="5541871">)</span>&nbsp;<span class="op" id="5541873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541878">return</span>&nbsp;<span class="ident" id="5541885">nil</span><span class="op" id="5541888">,</span>&nbsp;<span class="ident" id="5541890">errors</span><span class="op" id="5541896">.</span><span class="ident" id="5541897">New</span><span class="op" id="5541900">(</span><span class="string" id="5541901">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5541926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541934">base</span>&nbsp;<span class="op" id="5541939">=</span>&nbsp;<span class="ident" id="5541941">signoff</span>&nbsp;<span class="op" id="5541949">+</span>&nbsp;<span class="num" id="5541951">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541954">}</span>&nbsp;<span class="keyword" id="5541956">else</span>&nbsp;<span class="op" id="5541961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541965">base</span>&nbsp;<span class="op" id="5541970">=</span>&nbsp;<span class="ident" id="5541972">int64</span><span class="op" id="5541977">(</span><span class="num" id="5541978">0</span><span class="op" id="5541979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541985">sr</span><span class="op" id="5541987">.</span><span class="ident" id="5541988">Seek</span><span class="op" id="5541992">(</span><span class="ident" id="5541993">base</span><span class="op" id="5541997">,</span>&nbsp;<span class="ident" id="5541999">os</span><span class="op" id="5542001">.</span><span class="ident" id="5542002">SEEK_SET</span><span class="op" id="5542010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542013">if</span>&nbsp;<span class="ident" id="5542016">err</span>&nbsp;<span class="op" id="5542020">:=</span>&nbsp;<span class="ident" id="5542023">binary</span><span class="op" id="5542029">.</span><span class="ident" id="5542030">Read</span><span class="op" id="5542034">(</span><span class="ident" id="5542035">sr</span><span class="op" id="5542037">,</span>&nbsp;<span class="ident" id="5542039">binary</span><span class="op" id="5542045">.</span><span class="ident" id="5542046">LittleEndian</span><span class="op" id="5542058">,</span>&nbsp;<span class="op" id="5542060">&amp;</span><span class="ident" id="5542061">f</span><span class="op" id="5542062">.</span><span class="ident" id="5542063">FileHeader</span><span class="op" id="5542073">)</span><span class="op" id="5542074">;</span>&nbsp;<span class="ident" id="5542076">err</span>&nbsp;<span class="op" id="5542080">!=</span>&nbsp;<span class="ident" id="5542083">nil</span>&nbsp;<span class="op" id="5542087">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542091">return</span>&nbsp;<span class="ident" id="5542098">nil</span><span class="op" id="5542101">,</span>&nbsp;<span class="ident" id="5542103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542111">if</span>&nbsp;<span class="ident" id="5542114">f</span><span class="op" id="5542115">.</span><span class="ident" id="5542116">FileHeader</span><span class="op" id="5542126">.</span><span class="ident" id="5542127">Machine</span>&nbsp;<span class="op" id="5542135">!=</span>&nbsp;<span class="ident" id="5542138">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5542165">&amp;&amp;</span>&nbsp;<span class="ident" id="5542168">f</span><span class="op" id="5542169">.</span><span class="ident" id="5542170">FileHeader</span><span class="op" id="5542180">.</span><span class="ident" id="5542181">Machine</span>&nbsp;<span class="op" id="5542189">!=</span>&nbsp;<span class="ident" id="5542192">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5542217">&amp;&amp;</span>&nbsp;<span class="ident" id="5542220">f</span><span class="op" id="5542221">.</span><span class="ident" id="5542222">FileHeader</span><span class="op" id="5542232">.</span><span class="ident" id="5542233">Machine</span>&nbsp;<span class="op" id="5542241">!=</span>&nbsp;<span class="ident" id="5542244">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5542268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542272">return</span>&nbsp;<span class="ident" id="5542279">nil</span><span class="op" id="5542282">,</span>&nbsp;<span class="ident" id="5542284">errors</span><span class="op" id="5542290">.</span><span class="ident" id="5542291">New</span><span class="op" id="5542294">(</span><span class="string" id="5542295">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5542320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542323">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542327">var</span>&nbsp;<span class="ident" id="5542331">ss</span>&nbsp;<span class="op" id="5542334">[</span><span class="op" id="5542335">]</span><span class="builtintype" id="5542336">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542342">if</span>&nbsp;<span class="ident" id="5542345">f</span><span class="op" id="5542346">.</span><span class="ident" id="5542347">FileHeader</span><span class="op" id="5542357">.</span><span class="ident" id="5542358">NumberOfSymbols</span>&nbsp;<span class="op" id="5542374">&gt;</span>&nbsp;<span class="num" id="5542376">0</span>&nbsp;<span class="op" id="5542378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5542382">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542464">sr</span><span class="op" id="5542466">.</span><span class="ident" id="5542467">Seek</span><span class="op" id="5542471">(</span><span class="ident" id="5542472">int64</span><span class="op" id="5542477">(</span><span class="ident" id="5542478">f</span><span class="op" id="5542479">.</span><span class="ident" id="5542480">FileHeader</span><span class="op" id="5542490">.</span><span class="ident" id="5542491">PointerToSymbolTable</span><span class="op" id="5542511">+</span><span class="ident" id="5542512">COFFSymbolSize</span><span class="op" id="5542526">*</span><span class="ident" id="5542527">f</span><span class="op" id="5542528">.</span><span class="ident" id="5542529">FileHeader</span><span class="op" id="5542539">.</span><span class="ident" id="5542540">NumberOfSymbols</span><span class="op" id="5542555">)</span><span class="op" id="5542556">,</span>&nbsp;<span class="ident" id="5542558">os</span><span class="op" id="5542560">.</span><span class="ident" id="5542561">SEEK_SET</span><span class="op" id="5542569">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542573">var</span>&nbsp;<span class="ident" id="5542577">l</span>&nbsp;<span class="builtintype" id="5542579">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542588">if</span>&nbsp;<span class="ident" id="5542591">err</span>&nbsp;<span class="op" id="5542595">:=</span>&nbsp;<span class="ident" id="5542598">binary</span><span class="op" id="5542604">.</span><span class="ident" id="5542605">Read</span><span class="op" id="5542609">(</span><span class="ident" id="5542610">sr</span><span class="op" id="5542612">,</span>&nbsp;<span class="ident" id="5542614">binary</span><span class="op" id="5542620">.</span><span class="ident" id="5542621">LittleEndian</span><span class="op" id="5542633">,</span>&nbsp;<span class="op" id="5542635">&amp;</span><span class="ident" id="5542636">l</span><span class="op" id="5542637">)</span><span class="op" id="5542638">;</span>&nbsp;<span class="ident" id="5542640">err</span>&nbsp;<span class="op" id="5542644">!=</span>&nbsp;<span class="ident" id="5542647">nil</span>&nbsp;<span class="op" id="5542651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542656">return</span>&nbsp;<span class="ident" id="5542663">nil</span><span class="op" id="5542666">,</span>&nbsp;<span class="ident" id="5542668">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542678">ss</span>&nbsp;<span class="op" id="5542681">=</span>&nbsp;<span class="builtinfunc" id="5542683">make</span><span class="op" id="5542687">(</span><span class="op" id="5542688">[</span><span class="op" id="5542689">]</span><span class="builtintype" id="5542690">byte</span><span class="op" id="5542694">,</span>&nbsp;<span class="ident" id="5542696">l</span><span class="op" id="5542697">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542701">if</span>&nbsp;<span class="ident" id="5542704">_</span><span class="op" id="5542705">,</span>&nbsp;<span class="ident" id="5542707">err</span>&nbsp;<span class="op" id="5542711">:=</span>&nbsp;<span class="ident" id="5542714">r</span><span class="op" id="5542715">.</span><span class="ident" id="5542716">ReadAt</span><span class="op" id="5542722">(</span><span class="ident" id="5542723">ss</span><span class="op" id="5542725">,</span>&nbsp;<span class="ident" id="5542727">int64</span><span class="op" id="5542732">(</span><span class="ident" id="5542733">f</span><span class="op" id="5542734">.</span><span class="ident" id="5542735">FileHeader</span><span class="op" id="5542745">.</span><span class="ident" id="5542746">PointerToSymbolTable</span><span class="op" id="5542766">+</span><span class="ident" id="5542767">COFFSymbolSize</span><span class="op" id="5542781">*</span><span class="ident" id="5542782">f</span><span class="op" id="5542783">.</span><span class="ident" id="5542784">FileHeader</span><span class="op" id="5542794">.</span><span class="ident" id="5542795">NumberOfSymbols</span><span class="op" id="5542810">)</span><span class="op" id="5542811">)</span><span class="op" id="5542812">;</span>&nbsp;<span class="ident" id="5542814">err</span>&nbsp;<span class="op" id="5542818">!=</span>&nbsp;<span class="ident" id="5542821">nil</span>&nbsp;<span class="op" id="5542825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542830">return</span>&nbsp;<span class="ident" id="5542837">nil</span><span class="op" id="5542840">,</span>&nbsp;<span class="ident" id="5542842">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5542853">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542885">sr</span><span class="op" id="5542887">.</span><span class="ident" id="5542888">Seek</span><span class="op" id="5542892">(</span><span class="ident" id="5542893">int64</span><span class="op" id="5542898">(</span><span class="ident" id="5542899">f</span><span class="op" id="5542900">.</span><span class="ident" id="5542901">FileHeader</span><span class="op" id="5542911">.</span><span class="ident" id="5542912">PointerToSymbolTable</span><span class="op" id="5542932">)</span><span class="op" id="5542933">,</span>&nbsp;<span class="ident" id="5542935">os</span><span class="op" id="5542937">.</span><span class="ident" id="5542938">SEEK_SET</span><span class="op" id="5542946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542950">aux</span>&nbsp;<span class="op" id="5542954">:=</span>&nbsp;<span class="builtintype" id="5542957">uint8</span><span class="op" id="5542962">(</span><span class="num" id="5542963">0</span><span class="op" id="5542964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542968">for</span>&nbsp;<span class="ident" id="5542972">i</span>&nbsp;<span class="op" id="5542974">:=</span>&nbsp;<span class="num" id="5542977">0</span><span class="op" id="5542978">;</span>&nbsp;<span class="ident" id="5542980">i</span>&nbsp;<span class="op" id="5542982">&lt;</span>&nbsp;<span class="builtintype" id="5542984">int</span><span class="op" id="5542987">(</span><span class="ident" id="5542988">f</span><span class="op" id="5542989">.</span><span class="ident" id="5542990">FileHeader</span><span class="op" id="5543000">.</span><span class="ident" id="5543001">NumberOfSymbols</span><span class="op" id="5543016">)</span><span class="op" id="5543017">;</span>&nbsp;<span class="ident" id="5543019">i</span><span class="op" id="5543020">++</span>&nbsp;<span class="op" id="5543023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543028">cs</span>&nbsp;<span class="op" id="5543031">:=</span>&nbsp;<span class="builtinfunc" id="5543034">new</span><span class="op" id="5543037">(</span><span class="ident" id="5543038">COFFSymbol</span><span class="op" id="5543048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543053">if</span>&nbsp;<span class="ident" id="5543056">err</span>&nbsp;<span class="op" id="5543060">:=</span>&nbsp;<span class="ident" id="5543063">binary</span><span class="op" id="5543069">.</span><span class="ident" id="5543070">Read</span><span class="op" id="5543074">(</span><span class="ident" id="5543075">sr</span><span class="op" id="5543077">,</span>&nbsp;<span class="ident" id="5543079">binary</span><span class="op" id="5543085">.</span><span class="ident" id="5543086">LittleEndian</span><span class="op" id="5543098">,</span>&nbsp;<span class="ident" id="5543100">cs</span><span class="op" id="5543102">)</span><span class="op" id="5543103">;</span>&nbsp;<span class="ident" id="5543105">err</span>&nbsp;<span class="op" id="5543109">!=</span>&nbsp;<span class="ident" id="5543112">nil</span>&nbsp;<span class="op" id="5543116">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543122">return</span>&nbsp;<span class="ident" id="5543129">nil</span><span class="op" id="5543132">,</span>&nbsp;<span class="ident" id="5543134">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543146">if</span>&nbsp;<span class="ident" id="5543149">aux</span>&nbsp;<span class="op" id="5543153">&gt;</span>&nbsp;<span class="num" id="5543155">0</span>&nbsp;<span class="op" id="5543157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543163">aux</span><span class="op" id="5543166">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543173">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543190">var</span>&nbsp;<span class="ident" id="5543194">name</span>&nbsp;<span class="builtintype" id="5543199">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543209">if</span>&nbsp;<span class="ident" id="5543212">cs</span><span class="op" id="5543214">.</span><span class="ident" id="5543215">Name</span><span class="op" id="5543219">[</span><span class="num" id="5543220">0</span><span class="op" id="5543221">]</span>&nbsp;<span class="op" id="5543223">==</span>&nbsp;<span class="num" id="5543226">0</span>&nbsp;<span class="op" id="5543228">&amp;&amp;</span>&nbsp;<span class="ident" id="5543231">cs</span><span class="op" id="5543233">.</span><span class="ident" id="5543234">Name</span><span class="op" id="5543238">[</span><span class="num" id="5543239">1</span><span class="op" id="5543240">]</span>&nbsp;<span class="op" id="5543242">==</span>&nbsp;<span class="num" id="5543245">0</span>&nbsp;<span class="op" id="5543247">&amp;&amp;</span>&nbsp;<span class="ident" id="5543250">cs</span><span class="op" id="5543252">.</span><span class="ident" id="5543253">Name</span><span class="op" id="5543257">[</span><span class="num" id="5543258">2</span><span class="op" id="5543259">]</span>&nbsp;<span class="op" id="5543261">==</span>&nbsp;<span class="num" id="5543264">0</span>&nbsp;<span class="op" id="5543266">&amp;&amp;</span>&nbsp;<span class="ident" id="5543269">cs</span><span class="op" id="5543271">.</span><span class="ident" id="5543272">Name</span><span class="op" id="5543276">[</span><span class="num" id="5543277">3</span><span class="op" id="5543278">]</span>&nbsp;<span class="op" id="5543280">==</span>&nbsp;<span class="num" id="5543283">0</span>&nbsp;<span class="op" id="5543285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543291">si</span>&nbsp;<span class="op" id="5543294">:=</span>&nbsp;<span class="builtintype" id="5543297">int</span><span class="op" id="5543300">(</span><span class="ident" id="5543301">binary</span><span class="op" id="5543307">.</span><span class="ident" id="5543308">LittleEndian</span><span class="op" id="5543320">.</span><span class="ident" id="5543321">Uint32</span><span class="op" id="5543327">(</span><span class="ident" id="5543328">cs</span><span class="op" id="5543330">.</span><span class="ident" id="5543331">Name</span><span class="op" id="5543335">[</span><span class="num" id="5543336">4</span><span class="op" id="5543337">:</span><span class="op" id="5543338">]</span><span class="op" id="5543339">)</span><span class="op" id="5543340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543346">name</span><span class="op" id="5543350">,</span>&nbsp;<span class="ident" id="5543352">_</span>&nbsp;<span class="op" id="5543354">=</span>&nbsp;<span class="ident" id="5543356">getString</span><span class="op" id="5543365">(</span><span class="ident" id="5543366">ss</span><span class="op" id="5543368">,</span>&nbsp;<span class="ident" id="5543370">si</span><span class="op" id="5543372">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543377">}</span>&nbsp;<span class="keyword" id="5543379">else</span>&nbsp;<span class="op" id="5543384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543390">name</span>&nbsp;<span class="op" id="5543395">=</span>&nbsp;<span class="ident" id="5543397">cstring</span><span class="op" id="5543404">(</span><span class="ident" id="5543405">cs</span><span class="op" id="5543407">.</span><span class="ident" id="5543408">Name</span><span class="op" id="5543412">[</span><span class="op" id="5543413">:</span><span class="op" id="5543414">]</span><span class="op" id="5543415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543425">aux</span>&nbsp;<span class="op" id="5543429">=</span>&nbsp;<span class="ident" id="5543431">cs</span><span class="op" id="5543433">.</span><span class="ident" id="5543434">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543456">s</span>&nbsp;<span class="op" id="5543458">:=</span>&nbsp;<span class="op" id="5543461">&amp;</span><span class="ident" id="5543462">Symbol</span><span class="op" id="5543468">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543474">Name</span><span class="op" id="5543478">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543489">name</span><span class="op" id="5543493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543499">Value</span><span class="op" id="5543504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543514">cs</span><span class="op" id="5543516">.</span><span class="ident" id="5543517">Value</span><span class="op" id="5543522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543528">SectionNumber</span><span class="op" id="5543541">:</span>&nbsp;<span class="ident" id="5543543">cs</span><span class="op" id="5543545">.</span><span class="ident" id="5543546">SectionNumber</span><span class="op" id="5543559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543565">Type</span><span class="op" id="5543569">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543580">cs</span><span class="op" id="5543582">.</span><span class="ident" id="5543583">Type</span><span class="op" id="5543587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543593">StorageClass</span><span class="op" id="5543605">:</span>&nbsp;&nbsp;<span class="ident" id="5543608">cs</span><span class="op" id="5543610">.</span><span class="ident" id="5543611">StorageClass</span><span class="op" id="5543623">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543633">f</span><span class="op" id="5543634">.</span><span class="ident" id="5543635">Symbols</span>&nbsp;<span class="op" id="5543643">=</span>&nbsp;<span class="builtinfunc" id="5543645">append</span><span class="op" id="5543651">(</span><span class="ident" id="5543652">f</span><span class="op" id="5543653">.</span><span class="ident" id="5543654">Symbols</span><span class="op" id="5543661">,</span>&nbsp;<span class="ident" id="5543663">s</span><span class="op" id="5543664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5543675">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543701">sr</span><span class="op" id="5543703">.</span><span class="ident" id="5543704">Seek</span><span class="op" id="5543708">(</span><span class="ident" id="5543709">base</span><span class="op" id="5543713">,</span>&nbsp;<span class="ident" id="5543715">os</span><span class="op" id="5543717">.</span><span class="ident" id="5543718">SEEK_SET</span><span class="op" id="5543726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543729">if</span>&nbsp;<span class="ident" id="5543732">err</span>&nbsp;<span class="op" id="5543736">:=</span>&nbsp;<span class="ident" id="5543739">binary</span><span class="op" id="5543745">.</span><span class="ident" id="5543746">Read</span><span class="op" id="5543750">(</span><span class="ident" id="5543751">sr</span><span class="op" id="5543753">,</span>&nbsp;<span class="ident" id="5543755">binary</span><span class="op" id="5543761">.</span><span class="ident" id="5543762">LittleEndian</span><span class="op" id="5543774">,</span>&nbsp;<span class="op" id="5543776">&amp;</span><span class="ident" id="5543777">f</span><span class="op" id="5543778">.</span><span class="ident" id="5543779">FileHeader</span><span class="op" id="5543789">)</span><span class="op" id="5543790">;</span>&nbsp;<span class="ident" id="5543792">err</span>&nbsp;<span class="op" id="5543796">!=</span>&nbsp;<span class="ident" id="5543799">nil</span>&nbsp;<span class="op" id="5543803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543807">return</span>&nbsp;<span class="ident" id="5543814">nil</span><span class="op" id="5543817">,</span>&nbsp;<span class="ident" id="5543819">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543824">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543827">var</span>&nbsp;<span class="ident" id="5543831">oh32</span>&nbsp;<span class="ident" id="5543836">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543854">var</span>&nbsp;<span class="ident" id="5543858">oh64</span>&nbsp;<span class="ident" id="5543863">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543881">switch</span>&nbsp;<span class="ident" id="5543888">f</span><span class="op" id="5543889">.</span><span class="ident" id="5543890">FileHeader</span><span class="op" id="5543900">.</span><span class="ident" id="5543901">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5543922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543925">case</span>&nbsp;<span class="ident" id="5543930">sizeofOptionalHeader32</span><span class="op" id="5543952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543956">if</span>&nbsp;<span class="ident" id="5543959">err</span>&nbsp;<span class="op" id="5543963">:=</span>&nbsp;<span class="ident" id="5543966">binary</span><span class="op" id="5543972">.</span><span class="ident" id="5543973">Read</span><span class="op" id="5543977">(</span><span class="ident" id="5543978">sr</span><span class="op" id="5543980">,</span>&nbsp;<span class="ident" id="5543982">binary</span><span class="op" id="5543988">.</span><span class="ident" id="5543989">LittleEndian</span><span class="op" id="5544001">,</span>&nbsp;<span class="op" id="5544003">&amp;</span><span class="ident" id="5544004">oh32</span><span class="op" id="5544008">)</span><span class="op" id="5544009">;</span>&nbsp;<span class="ident" id="5544011">err</span>&nbsp;<span class="op" id="5544015">!=</span>&nbsp;<span class="ident" id="5544018">nil</span>&nbsp;<span class="op" id="5544022">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544027">return</span>&nbsp;<span class="ident" id="5544034">nil</span><span class="op" id="5544037">,</span>&nbsp;<span class="ident" id="5544039">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544049">if</span>&nbsp;<span class="ident" id="5544052">oh32</span><span class="op" id="5544056">.</span><span class="ident" id="5544057">Magic</span>&nbsp;<span class="op" id="5544063">!=</span>&nbsp;<span class="num" id="5544066">0x10b</span>&nbsp;<span class="op" id="5544072">{</span>&nbsp;<span class="comment" id="5544074">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544085">return</span>&nbsp;<span class="ident" id="5544092">nil</span><span class="op" id="5544095">,</span>&nbsp;<span class="ident" id="5544097">fmt</span><span class="op" id="5544100">.</span><span class="ident" id="5544101">Errorf</span><span class="op" id="5544107">(</span><span class="string" id="5544108">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5544159">,</span>&nbsp;<span class="ident" id="5544161">oh32</span><span class="op" id="5544165">.</span><span class="ident" id="5544166">Magic</span><span class="op" id="5544171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544175">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544179">f</span><span class="op" id="5544180">.</span><span class="ident" id="5544181">OptionalHeader</span>&nbsp;<span class="op" id="5544196">=</span>&nbsp;<span class="op" id="5544198">&amp;</span><span class="ident" id="5544199">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544205">case</span>&nbsp;<span class="ident" id="5544210">sizeofOptionalHeader64</span><span class="op" id="5544232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544236">if</span>&nbsp;<span class="ident" id="5544239">err</span>&nbsp;<span class="op" id="5544243">:=</span>&nbsp;<span class="ident" id="5544246">binary</span><span class="op" id="5544252">.</span><span class="ident" id="5544253">Read</span><span class="op" id="5544257">(</span><span class="ident" id="5544258">sr</span><span class="op" id="5544260">,</span>&nbsp;<span class="ident" id="5544262">binary</span><span class="op" id="5544268">.</span><span class="ident" id="5544269">LittleEndian</span><span class="op" id="5544281">,</span>&nbsp;<span class="op" id="5544283">&amp;</span><span class="ident" id="5544284">oh64</span><span class="op" id="5544288">)</span><span class="op" id="5544289">;</span>&nbsp;<span class="ident" id="5544291">err</span>&nbsp;<span class="op" id="5544295">!=</span>&nbsp;<span class="ident" id="5544298">nil</span>&nbsp;<span class="op" id="5544302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544307">return</span>&nbsp;<span class="ident" id="5544314">nil</span><span class="op" id="5544317">,</span>&nbsp;<span class="ident" id="5544319">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544325">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544329">if</span>&nbsp;<span class="ident" id="5544332">oh64</span><span class="op" id="5544336">.</span><span class="ident" id="5544337">Magic</span>&nbsp;<span class="op" id="5544343">!=</span>&nbsp;<span class="num" id="5544346">0x20b</span>&nbsp;<span class="op" id="5544352">{</span>&nbsp;<span class="comment" id="5544354">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544366">return</span>&nbsp;<span class="ident" id="5544373">nil</span><span class="op" id="5544376">,</span>&nbsp;<span class="ident" id="5544378">fmt</span><span class="op" id="5544381">.</span><span class="ident" id="5544382">Errorf</span><span class="op" id="5544388">(</span><span class="string" id="5544389">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5544441">,</span>&nbsp;<span class="ident" id="5544443">oh64</span><span class="op" id="5544447">.</span><span class="ident" id="5544448">Magic</span><span class="op" id="5544453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544461">f</span><span class="op" id="5544462">.</span><span class="ident" id="5544463">OptionalHeader</span>&nbsp;<span class="op" id="5544478">=</span>&nbsp;<span class="op" id="5544480">&amp;</span><span class="ident" id="5544481">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544487">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5544491">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544513">f</span><span class="op" id="5544514">.</span><span class="ident" id="5544515">Sections</span>&nbsp;<span class="op" id="5544524">=</span>&nbsp;<span class="builtinfunc" id="5544526">make</span><span class="op" id="5544530">(</span><span class="op" id="5544531">[</span><span class="op" id="5544532">]</span><span class="op" id="5544533">*</span><span class="ident" id="5544534">Section</span><span class="op" id="5544541">,</span>&nbsp;<span class="ident" id="5544543">f</span><span class="op" id="5544544">.</span><span class="ident" id="5544545">FileHeader</span><span class="op" id="5544555">.</span><span class="ident" id="5544556">NumberOfSections</span><span class="op" id="5544572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544575">for</span>&nbsp;<span class="ident" id="5544579">i</span>&nbsp;<span class="op" id="5544581">:=</span>&nbsp;<span class="num" id="5544584">0</span><span class="op" id="5544585">;</span>&nbsp;<span class="ident" id="5544587">i</span>&nbsp;<span class="op" id="5544589">&lt;</span>&nbsp;<span class="builtintype" id="5544591">int</span><span class="op" id="5544594">(</span><span class="ident" id="5544595">f</span><span class="op" id="5544596">.</span><span class="ident" id="5544597">FileHeader</span><span class="op" id="5544607">.</span><span class="ident" id="5544608">NumberOfSections</span><span class="op" id="5544624">)</span><span class="op" id="5544625">;</span>&nbsp;<span class="ident" id="5544627">i</span><span class="op" id="5544628">++</span>&nbsp;<span class="op" id="5544631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544635">sh</span>&nbsp;<span class="op" id="5544638">:=</span>&nbsp;<span class="builtinfunc" id="5544641">new</span><span class="op" id="5544644">(</span><span class="ident" id="5544645">SectionHeader32</span><span class="op" id="5544660">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544664">if</span>&nbsp;<span class="ident" id="5544667">err</span>&nbsp;<span class="op" id="5544671">:=</span>&nbsp;<span class="ident" id="5544674">binary</span><span class="op" id="5544680">.</span><span class="ident" id="5544681">Read</span><span class="op" id="5544685">(</span><span class="ident" id="5544686">sr</span><span class="op" id="5544688">,</span>&nbsp;<span class="ident" id="5544690">binary</span><span class="op" id="5544696">.</span><span class="ident" id="5544697">LittleEndian</span><span class="op" id="5544709">,</span>&nbsp;<span class="ident" id="5544711">sh</span><span class="op" id="5544713">)</span><span class="op" id="5544714">;</span>&nbsp;<span class="ident" id="5544716">err</span>&nbsp;<span class="op" id="5544720">!=</span>&nbsp;<span class="ident" id="5544723">nil</span>&nbsp;<span class="op" id="5544727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544732">return</span>&nbsp;<span class="ident" id="5544739">nil</span><span class="op" id="5544742">,</span>&nbsp;<span class="ident" id="5544744">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544754">var</span>&nbsp;<span class="ident" id="5544758">name</span>&nbsp;<span class="builtintype" id="5544763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544772">if</span>&nbsp;<span class="ident" id="5544775">sh</span><span class="op" id="5544777">.</span><span class="ident" id="5544778">Name</span><span class="op" id="5544782">[</span><span class="num" id="5544783">0</span><span class="op" id="5544784">]</span>&nbsp;<span class="op" id="5544786">==</span>&nbsp;<span class="string" id="5544789">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5544796">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544801">si</span><span class="op" id="5544803">,</span>&nbsp;<span class="ident" id="5544805">_</span>&nbsp;<span class="op" id="5544807">:=</span>&nbsp;<span class="ident" id="5544810">strconv</span><span class="op" id="5544817">.</span><span class="ident" id="5544818">Atoi</span><span class="op" id="5544822">(</span><span class="ident" id="5544823">cstring</span><span class="op" id="5544830">(</span><span class="ident" id="5544831">sh</span><span class="op" id="5544833">.</span><span class="ident" id="5544834">Name</span><span class="op" id="5544838">[</span><span class="num" id="5544839">1</span><span class="op" id="5544840">:</span><span class="op" id="5544841">]</span><span class="op" id="5544842">)</span><span class="op" id="5544843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544848">name</span><span class="op" id="5544852">,</span>&nbsp;<span class="ident" id="5544854">_</span>&nbsp;<span class="op" id="5544856">=</span>&nbsp;<span class="ident" id="5544858">getString</span><span class="op" id="5544867">(</span><span class="ident" id="5544868">ss</span><span class="op" id="5544870">,</span>&nbsp;<span class="ident" id="5544872">si</span><span class="op" id="5544874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544878">}</span>&nbsp;<span class="keyword" id="5544880">else</span>&nbsp;<span class="op" id="5544885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544890">name</span>&nbsp;<span class="op" id="5544895">=</span>&nbsp;<span class="ident" id="5544897">cstring</span><span class="op" id="5544904">(</span><span class="ident" id="5544905">sh</span><span class="op" id="5544907">.</span><span class="ident" id="5544908">Name</span><span class="op" id="5544912">[</span><span class="num" id="5544913">0</span><span class="op" id="5544914">:</span><span class="op" id="5544915">]</span><span class="op" id="5544916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5544920">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544924">s</span>&nbsp;<span class="op" id="5544926">:=</span>&nbsp;<span class="builtinfunc" id="5544929">new</span><span class="op" id="5544932">(</span><span class="ident" id="5544933">Section</span><span class="op" id="5544940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544944">s</span><span class="op" id="5544945">.</span><span class="ident" id="5544946">SectionHeader</span>&nbsp;<span class="op" id="5544960">=</span>&nbsp;<span class="ident" id="5544962">SectionHeader</span><span class="op" id="5544975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544980">Name</span><span class="op" id="5544984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545002">name</span><span class="op" id="5545006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545011">VirtualSize</span><span class="op" id="5545022">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545033">sh</span><span class="op" id="5545035">.</span><span class="ident" id="5545036">VirtualSize</span><span class="op" id="5545047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545052">VirtualAddress</span><span class="op" id="5545066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545074">sh</span><span class="op" id="5545076">.</span><span class="ident" id="5545077">VirtualAddress</span><span class="op" id="5545091">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545096">Size</span><span class="op" id="5545100">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545118">sh</span><span class="op" id="5545120">.</span><span class="ident" id="5545121">SizeOfRawData</span><span class="op" id="5545134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545139">Offset</span><span class="op" id="5545145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545161">sh</span><span class="op" id="5545163">.</span><span class="ident" id="5545164">PointerToRawData</span><span class="op" id="5545180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545185">PointerToRelocations</span><span class="op" id="5545205">:</span>&nbsp;<span class="ident" id="5545207">sh</span><span class="op" id="5545209">.</span><span class="ident" id="5545210">PointerToRelocations</span><span class="op" id="5545230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545235">PointerToLineNumbers</span><span class="op" id="5545255">:</span>&nbsp;<span class="ident" id="5545257">sh</span><span class="op" id="5545259">.</span><span class="ident" id="5545260">PointerToLineNumbers</span><span class="op" id="5545280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545285">NumberOfRelocations</span><span class="op" id="5545304">:</span>&nbsp;&nbsp;<span class="ident" id="5545307">sh</span><span class="op" id="5545309">.</span><span class="ident" id="5545310">NumberOfRelocations</span><span class="op" id="5545329">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545334">NumberOfLineNumbers</span><span class="op" id="5545353">:</span>&nbsp;&nbsp;<span class="ident" id="5545356">sh</span><span class="op" id="5545358">.</span><span class="ident" id="5545359">NumberOfLineNumbers</span><span class="op" id="5545378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545383">Characteristics</span><span class="op" id="5545398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5545405">sh</span><span class="op" id="5545407">.</span><span class="ident" id="5545408">Characteristics</span><span class="op" id="5545423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545431">s</span><span class="op" id="5545432">.</span><span class="ident" id="5545433">sr</span>&nbsp;<span class="op" id="5545436">=</span>&nbsp;<span class="ident" id="5545438">io</span><span class="op" id="5545440">.</span><span class="ident" id="5545441">NewSectionReader</span><span class="op" id="5545457">(</span><span class="ident" id="5545458">r</span><span class="op" id="5545459">,</span>&nbsp;<span class="ident" id="5545461">int64</span><span class="op" id="5545466">(</span><span class="ident" id="5545467">s</span><span class="op" id="5545468">.</span><span class="ident" id="5545469">SectionHeader</span><span class="op" id="5545482">.</span><span class="ident" id="5545483">Offset</span><span class="op" id="5545489">)</span><span class="op" id="5545490">,</span>&nbsp;<span class="ident" id="5545492">int64</span><span class="op" id="5545497">(</span><span class="ident" id="5545498">s</span><span class="op" id="5545499">.</span><span class="ident" id="5545500">SectionHeader</span><span class="op" id="5545513">.</span><span class="ident" id="5545514">Size</span><span class="op" id="5545518">)</span><span class="op" id="5545519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545523">s</span><span class="op" id="5545524">.</span><span class="ident" id="5545525">ReaderAt</span>&nbsp;<span class="op" id="5545534">=</span>&nbsp;<span class="ident" id="5545536">s</span><span class="op" id="5545537">.</span><span class="ident" id="5545538">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545543">f</span><span class="op" id="5545544">.</span><span class="ident" id="5545545">Sections</span><span class="op" id="5545553">[</span><span class="ident" id="5545554">i</span><span class="op" id="5545555">]</span>&nbsp;<span class="op" id="5545557">=</span>&nbsp;<span class="ident" id="5545559">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545565">return</span>&nbsp;<span class="ident" id="5545572">f</span><span class="op" id="5545573">,</span>&nbsp;<span class="ident" id="5545575">nil</span><br>
<span class="lineno"></span><span class="op" id="5545579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5545582">func</span>&nbsp;<span class="ident" id="5545587">cstring</span><span class="op" id="5545594">(</span><span class="ident" id="5545595">b</span>&nbsp;<span class="op" id="5545597">[</span><span class="op" id="5545598">]</span><span class="builtintype" id="5545599">byte</span><span class="op" id="5545603">)</span>&nbsp;<span class="builtintype" id="5545605">string</span>&nbsp;<span class="op" id="5545612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545615">var</span>&nbsp;<span class="ident" id="5545619">i</span>&nbsp;<span class="builtintype" id="5545621">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545626">for</span>&nbsp;<span class="ident" id="5545630">i</span>&nbsp;<span class="op" id="5545632">=</span>&nbsp;<span class="num" id="5545634">0</span><span class="op" id="5545635">;</span>&nbsp;<span class="ident" id="5545637">i</span>&nbsp;<span class="op" id="5545639">&lt;</span>&nbsp;<span class="builtinfunc" id="5545641">len</span><span class="op" id="5545644">(</span><span class="ident" id="5545645">b</span><span class="op" id="5545646">)</span>&nbsp;<span class="op" id="5545648">&amp;&amp;</span>&nbsp;<span class="ident" id="5545651">b</span><span class="op" id="5545652">[</span><span class="ident" id="5545653">i</span><span class="op" id="5545654">]</span>&nbsp;<span class="op" id="5545656">!=</span>&nbsp;<span class="num" id="5545659">0</span><span class="op" id="5545660">;</span>&nbsp;<span class="ident" id="5545662">i</span><span class="op" id="5545663">++</span>&nbsp;<span class="op" id="5545666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545672">return</span>&nbsp;<span class="builtintype" id="5545679">string</span><span class="op" id="5545685">(</span><span class="ident" id="5545686">b</span><span class="op" id="5545687">[</span><span class="num" id="5545688">0</span><span class="op" id="5545689">:</span><span class="ident" id="5545690">i</span><span class="op" id="5545691">]</span><span class="op" id="5545692">)</span><br>
<span class="lineno">270</span><span class="op" id="5545694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5545697">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5545754">func</span>&nbsp;<span class="ident" id="5545759">getString</span><span class="op" id="5545768">(</span><span class="ident" id="5545769">section</span>&nbsp;<span class="op" id="5545777">[</span><span class="op" id="5545778">]</span><span class="builtintype" id="5545779">byte</span><span class="op" id="5545783">,</span>&nbsp;<span class="ident" id="5545785">start</span>&nbsp;<span class="builtintype" id="5545791">int</span><span class="op" id="5545794">)</span>&nbsp;<span class="op" id="5545796">(</span><span class="builtintype" id="5545797">string</span><span class="op" id="5545803">,</span>&nbsp;<span class="builtintype" id="5545805">bool</span><span class="op" id="5545809">)</span>&nbsp;<span class="op" id="5545811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545814">if</span>&nbsp;<span class="ident" id="5545817">start</span>&nbsp;<span class="op" id="5545823">&lt;</span>&nbsp;<span class="num" id="5545825">0</span>&nbsp;<span class="op" id="5545827">||</span>&nbsp;<span class="ident" id="5545830">start</span>&nbsp;<span class="op" id="5545836">&gt;=</span>&nbsp;<span class="builtinfunc" id="5545839">len</span><span class="op" id="5545842">(</span><span class="ident" id="5545843">section</span><span class="op" id="5545850">)</span>&nbsp;<span class="op" id="5545852">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545856">return</span>&nbsp;<span class="string" id="5545863">&#34;&#34;</span><span class="op" id="5545865">,</span>&nbsp;<span class="builtintype" id="5545867">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545878">for</span>&nbsp;<span class="ident" id="5545882">end</span>&nbsp;<span class="op" id="5545886">:=</span>&nbsp;<span class="ident" id="5545889">start</span><span class="op" id="5545894">;</span>&nbsp;<span class="ident" id="5545896">end</span>&nbsp;<span class="op" id="5545900">&lt;</span>&nbsp;<span class="builtinfunc" id="5545902">len</span><span class="op" id="5545905">(</span><span class="ident" id="5545906">section</span><span class="op" id="5545913">)</span><span class="op" id="5545914">;</span>&nbsp;<span class="ident" id="5545916">end</span><span class="op" id="5545919">++</span>&nbsp;<span class="op" id="5545922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545926">if</span>&nbsp;<span class="ident" id="5545929">section</span><span class="op" id="5545936">[</span><span class="ident" id="5545937">end</span><span class="op" id="5545940">]</span>&nbsp;<span class="op" id="5545942">==</span>&nbsp;<span class="num" id="5545945">0</span>&nbsp;<span class="op" id="5545947">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545952">return</span>&nbsp;<span class="builtintype" id="5545959">string</span><span class="op" id="5545965">(</span><span class="ident" id="5545966">section</span><span class="op" id="5545973">[</span><span class="ident" id="5545974">start</span><span class="op" id="5545979">:</span><span class="ident" id="5545980">end</span><span class="op" id="5545983">]</span><span class="op" id="5545984">)</span><span class="op" id="5545985">,</span>&nbsp;<span class="builtintype" id="5545987">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546000">return</span>&nbsp;<span class="string" id="5546007">&#34;&#34;</span><span class="op" id="5546009">,</span>&nbsp;<span class="builtintype" id="5546011">false</span><br>
<span class="lineno"></span><span class="op" id="5546017">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5546020">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5546096">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5546115">func</span>&nbsp;<span class="op" id="5546120">(</span><span class="ident" id="5546121">f</span>&nbsp;<span class="op" id="5546123">*</span><span class="ident" id="5546124">File</span><span class="op" id="5546128">)</span>&nbsp;<span class="ident" id="5546130">Section</span><span class="op" id="5546137">(</span><span class="ident" id="5546138">name</span>&nbsp;<span class="builtintype" id="5546143">string</span><span class="op" id="5546149">)</span>&nbsp;<span class="op" id="5546151">*</span><span class="ident" id="5546152">Section</span>&nbsp;<span class="op" id="5546160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546163">for</span>&nbsp;<span class="ident" id="5546167">_</span><span class="op" id="5546168">,</span>&nbsp;<span class="ident" id="5546170">s</span>&nbsp;<span class="op" id="5546172">:=</span>&nbsp;<span class="keyword" id="5546175">range</span>&nbsp;<span class="ident" id="5546181">f</span><span class="op" id="5546182">.</span><span class="ident" id="5546183">Sections</span>&nbsp;<span class="op" id="5546192">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546196">if</span>&nbsp;<span class="ident" id="5546199">s</span><span class="op" id="5546200">.</span><span class="ident" id="5546201">Name</span>&nbsp;<span class="op" id="5546206">==</span>&nbsp;<span class="ident" id="5546209">name</span>&nbsp;<span class="op" id="5546214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546219">return</span>&nbsp;<span class="ident" id="5546226">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5546230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5546233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546236">return</span>&nbsp;<span class="ident" id="5546243">nil</span><br>
<span class="lineno">295</span><span class="op" id="5546247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5546250">func</span>&nbsp;<span class="op" id="5546255">(</span><span class="ident" id="5546256">f</span>&nbsp;<span class="op" id="5546258">*</span><span class="ident" id="5546259">File</span><span class="op" id="5546263">)</span>&nbsp;<span class="ident" id="5546265">DWARF</span><span class="op" id="5546270">(</span><span class="op" id="5546271">)</span>&nbsp;<span class="op" id="5546273">(</span><span class="op" id="5546274">*</span><span class="ident" id="5546275">dwarf</span><span class="op" id="5546280">.</span><span class="ident" id="5546281">Data</span><span class="op" id="5546285">,</span>&nbsp;<span class="builtintype" id="5546287">error</span><span class="op" id="5546292">)</span>&nbsp;<span class="op" id="5546294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5546297">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5546348">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5546403">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546462">var</span>&nbsp;<span class="ident" id="5546466">names</span>&nbsp;<span class="op" id="5546472">=</span>&nbsp;<span class="op" id="5546474">[</span><span class="op" id="5546475">...</span><span class="op" id="5546478">]</span><span class="builtintype" id="5546479">string</span><span class="op" id="5546485">{</span><span class="string" id="5546486">&#34;abbrev&#34;</span><span class="op" id="5546494">,</span>&nbsp;<span class="string" id="5546496">&#34;info&#34;</span><span class="op" id="5546502">,</span>&nbsp;<span class="string" id="5546504">&#34;str&#34;</span><span class="op" id="5546509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546512">var</span>&nbsp;<span class="ident" id="5546516">dat</span>&nbsp;<span class="op" id="5546520">[</span><span class="builtinfunc" id="5546521">len</span><span class="op" id="5546524">(</span><span class="ident" id="5546525">names</span><span class="op" id="5546530">)</span><span class="op" id="5546531">]</span><span class="op" id="5546532">[</span><span class="op" id="5546533">]</span><span class="builtintype" id="5546534">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546540">for</span>&nbsp;<span class="ident" id="5546544">i</span><span class="op" id="5546545">,</span>&nbsp;<span class="ident" id="5546547">name</span>&nbsp;<span class="op" id="5546552">:=</span>&nbsp;<span class="keyword" id="5546555">range</span>&nbsp;<span class="ident" id="5546561">names</span>&nbsp;<span class="op" id="5546567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546571">name</span>&nbsp;<span class="op" id="5546576">=</span>&nbsp;<span class="string" id="5546578">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5546588">+</span>&nbsp;<span class="ident" id="5546590">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546597">s</span>&nbsp;<span class="op" id="5546599">:=</span>&nbsp;<span class="ident" id="5546602">f</span><span class="op" id="5546603">.</span><span class="ident" id="5546604">Section</span><span class="op" id="5546611">(</span><span class="ident" id="5546612">name</span><span class="op" id="5546616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546620">if</span>&nbsp;<span class="ident" id="5546623">s</span>&nbsp;<span class="op" id="5546625">==</span>&nbsp;<span class="ident" id="5546628">nil</span>&nbsp;<span class="op" id="5546632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546637">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5546648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546652">b</span><span class="op" id="5546653">,</span>&nbsp;<span class="ident" id="5546655">err</span>&nbsp;<span class="op" id="5546659">:=</span>&nbsp;<span class="ident" id="5546662">s</span><span class="op" id="5546663">.</span><span class="ident" id="5546664">Data</span><span class="op" id="5546668">(</span><span class="op" id="5546669">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546673">if</span>&nbsp;<span class="ident" id="5546676">err</span>&nbsp;<span class="op" id="5546680">!=</span>&nbsp;<span class="ident" id="5546683">nil</span>&nbsp;<span class="op" id="5546687">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5546690">uint32</span><span class="op" id="5546696">(</span><span class="builtinfunc" id="5546697">len</span><span class="op" id="5546700">(</span><span class="ident" id="5546701">b</span><span class="op" id="5546702">)</span><span class="op" id="5546703">)</span>&nbsp;<span class="op" id="5546705">&lt;</span>&nbsp;<span class="ident" id="5546707">s</span><span class="op" id="5546708">.</span><span class="ident" id="5546709">Size</span>&nbsp;<span class="op" id="5546714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546719">return</span>&nbsp;<span class="ident" id="5546726">nil</span><span class="op" id="5546729">,</span>&nbsp;<span class="ident" id="5546731">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5546737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546741">dat</span><span class="op" id="5546744">[</span><span class="ident" id="5546745">i</span><span class="op" id="5546746">]</span>&nbsp;<span class="op" id="5546748">=</span>&nbsp;<span class="ident" id="5546750">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5546753">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546757">abbrev</span><span class="op" id="5546763">,</span>&nbsp;<span class="ident" id="5546765">info</span><span class="op" id="5546769">,</span>&nbsp;<span class="ident" id="5546771">str</span>&nbsp;<span class="op" id="5546775">:=</span>&nbsp;<span class="ident" id="5546778">dat</span><span class="op" id="5546781">[</span><span class="num" id="5546782">0</span><span class="op" id="5546783">]</span><span class="op" id="5546784">,</span>&nbsp;<span class="ident" id="5546786">dat</span><span class="op" id="5546789">[</span><span class="num" id="5546790">1</span><span class="op" id="5546791">]</span><span class="op" id="5546792">,</span>&nbsp;<span class="ident" id="5546794">dat</span><span class="op" id="5546797">[</span><span class="num" id="5546798">2</span><span class="op" id="5546799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546802">return</span>&nbsp;<span class="ident" id="5546809">dwarf</span><span class="op" id="5546814">.</span><span class="ident" id="5546815">New</span><span class="op" id="5546818">(</span><span class="ident" id="5546819">abbrev</span><span class="op" id="5546825">,</span>&nbsp;<span class="ident" id="5546827">nil</span><span class="op" id="5546830">,</span>&nbsp;<span class="ident" id="5546832">nil</span><span class="op" id="5546835">,</span>&nbsp;<span class="ident" id="5546837">info</span><span class="op" id="5546841">,</span>&nbsp;<span class="ident" id="5546843">nil</span><span class="op" id="5546846">,</span>&nbsp;<span class="ident" id="5546848">nil</span><span class="op" id="5546851">,</span>&nbsp;<span class="ident" id="5546853">nil</span><span class="op" id="5546856">,</span>&nbsp;<span class="ident" id="5546858">str</span><span class="op" id="5546861">)</span><br>
<span class="lineno"></span><span class="op" id="5546863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5546866">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5546918">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5546973">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5547027">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5547063">func</span>&nbsp;<span class="op" id="5547068">(</span><span class="ident" id="5547069">f</span>&nbsp;<span class="op" id="5547071">*</span><span class="ident" id="5547072">File</span><span class="op" id="5547076">)</span>&nbsp;<span class="ident" id="5547078">ImportedSymbols</span><span class="op" id="5547093">(</span><span class="op" id="5547094">)</span>&nbsp;<span class="op" id="5547096">(</span><span class="op" id="5547097">[</span><span class="op" id="5547098">]</span><span class="builtintype" id="5547099">string</span><span class="op" id="5547105">,</span>&nbsp;<span class="builtintype" id="5547107">error</span><span class="op" id="5547112">)</span>&nbsp;<span class="op" id="5547114">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547117">pe64</span>&nbsp;<span class="op" id="5547122">:=</span>&nbsp;<span class="ident" id="5547125">f</span><span class="op" id="5547126">.</span><span class="ident" id="5547127">Machine</span>&nbsp;<span class="op" id="5547135">==</span>&nbsp;<span class="ident" id="5547138">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547164">ds</span>&nbsp;<span class="op" id="5547167">:=</span>&nbsp;<span class="ident" id="5547170">f</span><span class="op" id="5547171">.</span><span class="ident" id="5547172">Section</span><span class="op" id="5547179">(</span><span class="string" id="5547180">&#34;.idata&#34;</span><span class="op" id="5547188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547191">if</span>&nbsp;<span class="ident" id="5547194">ds</span>&nbsp;<span class="op" id="5547197">==</span>&nbsp;<span class="ident" id="5547200">nil</span>&nbsp;<span class="op" id="5547204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5547208">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547242">return</span>&nbsp;<span class="ident" id="5547249">nil</span><span class="op" id="5547252">,</span>&nbsp;<span class="ident" id="5547254">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5547259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547262">d</span><span class="op" id="5547263">,</span>&nbsp;<span class="ident" id="5547265">err</span>&nbsp;<span class="op" id="5547269">:=</span>&nbsp;<span class="ident" id="5547272">ds</span><span class="op" id="5547274">.</span><span class="ident" id="5547275">Data</span><span class="op" id="5547279">(</span><span class="op" id="5547280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547283">if</span>&nbsp;<span class="ident" id="5547286">err</span>&nbsp;<span class="op" id="5547290">!=</span>&nbsp;<span class="ident" id="5547293">nil</span>&nbsp;<span class="op" id="5547297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547301">return</span>&nbsp;<span class="ident" id="5547308">nil</span><span class="op" id="5547311">,</span>&nbsp;<span class="ident" id="5547313">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5547318">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547321">var</span>&nbsp;<span class="ident" id="5547325">ida</span>&nbsp;<span class="op" id="5547329">[</span><span class="op" id="5547330">]</span><span class="ident" id="5547331">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547348">for</span>&nbsp;<span class="builtinfunc" id="5547352">len</span><span class="op" id="5547355">(</span><span class="ident" id="5547356">d</span><span class="op" id="5547357">)</span>&nbsp;<span class="op" id="5547359">&gt;</span>&nbsp;<span class="num" id="5547361">0</span>&nbsp;<span class="op" id="5547363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547367">var</span>&nbsp;<span class="ident" id="5547371">dt</span>&nbsp;<span class="ident" id="5547374">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547392">dt</span><span class="op" id="5547394">.</span><span class="ident" id="5547395">OriginalFirstThunk</span>&nbsp;<span class="op" id="5547414">=</span>&nbsp;<span class="ident" id="5547416">binary</span><span class="op" id="5547422">.</span><span class="ident" id="5547423">LittleEndian</span><span class="op" id="5547435">.</span><span class="ident" id="5547436">Uint32</span><span class="op" id="5547442">(</span><span class="ident" id="5547443">d</span><span class="op" id="5547444">[</span><span class="num" id="5547445">0</span><span class="op" id="5547446">:</span><span class="num" id="5547447">4</span><span class="op" id="5547448">]</span><span class="op" id="5547449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547453">dt</span><span class="op" id="5547455">.</span><span class="ident" id="5547456">Name</span>&nbsp;<span class="op" id="5547461">=</span>&nbsp;<span class="ident" id="5547463">binary</span><span class="op" id="5547469">.</span><span class="ident" id="5547470">LittleEndian</span><span class="op" id="5547482">.</span><span class="ident" id="5547483">Uint32</span><span class="op" id="5547489">(</span><span class="ident" id="5547490">d</span><span class="op" id="5547491">[</span><span class="num" id="5547492">12</span><span class="op" id="5547494">:</span><span class="num" id="5547495">16</span><span class="op" id="5547497">]</span><span class="op" id="5547498">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547502">dt</span><span class="op" id="5547504">.</span><span class="ident" id="5547505">FirstThunk</span>&nbsp;<span class="op" id="5547516">=</span>&nbsp;<span class="ident" id="5547518">binary</span><span class="op" id="5547524">.</span><span class="ident" id="5547525">LittleEndian</span><span class="op" id="5547537">.</span><span class="ident" id="5547538">Uint32</span><span class="op" id="5547544">(</span><span class="ident" id="5547545">d</span><span class="op" id="5547546">[</span><span class="num" id="5547547">16</span><span class="op" id="5547549">:</span><span class="num" id="5547550">20</span><span class="op" id="5547552">]</span><span class="op" id="5547553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547557">d</span>&nbsp;<span class="op" id="5547559">=</span>&nbsp;<span class="ident" id="5547561">d</span><span class="op" id="5547562">[</span><span class="num" id="5547563">20</span><span class="op" id="5547565">:</span><span class="op" id="5547566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547570">if</span>&nbsp;<span class="ident" id="5547573">dt</span><span class="op" id="5547575">.</span><span class="ident" id="5547576">OriginalFirstThunk</span>&nbsp;<span class="op" id="5547595">==</span>&nbsp;<span class="num" id="5547598">0</span>&nbsp;<span class="op" id="5547600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547605">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5547613">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547617">ida</span>&nbsp;<span class="op" id="5547621">=</span>&nbsp;<span class="builtinfunc" id="5547623">append</span><span class="op" id="5547629">(</span><span class="ident" id="5547630">ida</span><span class="op" id="5547633">,</span>&nbsp;<span class="ident" id="5547635">dt</span><span class="op" id="5547637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5547640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547643">names</span><span class="op" id="5547648">,</span>&nbsp;<span class="ident" id="5547650">_</span>&nbsp;<span class="op" id="5547652">:=</span>&nbsp;<span class="ident" id="5547655">ds</span><span class="op" id="5547657">.</span><span class="ident" id="5547658">Data</span><span class="op" id="5547662">(</span><span class="op" id="5547663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547666">var</span>&nbsp;<span class="ident" id="5547670">all</span>&nbsp;<span class="op" id="5547674">[</span><span class="op" id="5547675">]</span><span class="builtintype" id="5547676">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547684">for</span>&nbsp;<span class="ident" id="5547688">_</span><span class="op" id="5547689">,</span>&nbsp;<span class="ident" id="5547691">dt</span>&nbsp;<span class="op" id="5547694">:=</span>&nbsp;<span class="keyword" id="5547697">range</span>&nbsp;<span class="ident" id="5547703">ida</span>&nbsp;<span class="op" id="5547707">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547711">dt</span><span class="op" id="5547713">.</span><span class="ident" id="5547714">dll</span><span class="op" id="5547717">,</span>&nbsp;<span class="ident" id="5547719">_</span>&nbsp;<span class="op" id="5547721">=</span>&nbsp;<span class="ident" id="5547723">getString</span><span class="op" id="5547732">(</span><span class="ident" id="5547733">names</span><span class="op" id="5547738">,</span>&nbsp;<span class="builtintype" id="5547740">int</span><span class="op" id="5547743">(</span><span class="ident" id="5547744">dt</span><span class="op" id="5547746">.</span><span class="ident" id="5547747">Name</span><span class="op" id="5547751">-</span><span class="ident" id="5547752">ds</span><span class="op" id="5547754">.</span><span class="ident" id="5547755">VirtualAddress</span><span class="op" id="5547769">)</span><span class="op" id="5547770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547774">d</span><span class="op" id="5547775">,</span>&nbsp;<span class="ident" id="5547777">_</span>&nbsp;<span class="op" id="5547779">=</span>&nbsp;<span class="ident" id="5547781">ds</span><span class="op" id="5547783">.</span><span class="ident" id="5547784">Data</span><span class="op" id="5547788">(</span><span class="op" id="5547789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5547793">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547825">d</span>&nbsp;<span class="op" id="5547827">=</span>&nbsp;<span class="ident" id="5547829">d</span><span class="op" id="5547830">[</span><span class="ident" id="5547831">dt</span><span class="op" id="5547833">.</span><span class="ident" id="5547834">OriginalFirstThunk</span><span class="op" id="5547852">-</span><span class="ident" id="5547853">ds</span><span class="op" id="5547855">.</span><span class="ident" id="5547856">VirtualAddress</span><span class="op" id="5547870">:</span><span class="op" id="5547871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547875">for</span>&nbsp;<span class="builtinfunc" id="5547879">len</span><span class="op" id="5547882">(</span><span class="ident" id="5547883">d</span><span class="op" id="5547884">)</span>&nbsp;<span class="op" id="5547886">&gt;</span>&nbsp;<span class="num" id="5547888">0</span>&nbsp;<span class="op" id="5547890">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547895">if</span>&nbsp;<span class="ident" id="5547898">pe64</span>&nbsp;<span class="op" id="5547903">{</span>&nbsp;<span class="comment" id="5547905">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547918">va</span>&nbsp;<span class="op" id="5547921">:=</span>&nbsp;<span class="ident" id="5547924">binary</span><span class="op" id="5547930">.</span><span class="ident" id="5547931">LittleEndian</span><span class="op" id="5547943">.</span><span class="ident" id="5547944">Uint64</span><span class="op" id="5547950">(</span><span class="ident" id="5547951">d</span><span class="op" id="5547952">[</span><span class="num" id="5547953">0</span><span class="op" id="5547954">:</span><span class="num" id="5547955">8</span><span class="op" id="5547956">]</span><span class="op" id="5547957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547963">d</span>&nbsp;<span class="op" id="5547965">=</span>&nbsp;<span class="ident" id="5547967">d</span><span class="op" id="5547968">[</span><span class="num" id="5547969">8</span><span class="op" id="5547970">:</span><span class="op" id="5547971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547977">if</span>&nbsp;<span class="ident" id="5547980">va</span>&nbsp;<span class="op" id="5547983">==</span>&nbsp;<span class="num" id="5547986">0</span>&nbsp;<span class="op" id="5547988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547995">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548011">if</span>&nbsp;<span class="ident" id="5548014">va</span><span class="op" id="5548016">&amp;</span><span class="num" id="5548017">0x8000000000000000</span>&nbsp;<span class="op" id="5548036">&gt;</span>&nbsp;<span class="num" id="5548038">0</span>&nbsp;<span class="op" id="5548040">{</span>&nbsp;<span class="comment" id="5548042">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5548061">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548104">}</span>&nbsp;<span class="keyword" id="5548106">else</span>&nbsp;<span class="op" id="5548111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548118">fn</span><span class="op" id="5548120">,</span>&nbsp;<span class="ident" id="5548122">_</span>&nbsp;<span class="op" id="5548124">:=</span>&nbsp;<span class="ident" id="5548127">getString</span><span class="op" id="5548136">(</span><span class="ident" id="5548137">names</span><span class="op" id="5548142">,</span>&nbsp;<span class="builtintype" id="5548144">int</span><span class="op" id="5548147">(</span><span class="builtintype" id="5548148">uint32</span><span class="op" id="5548154">(</span><span class="ident" id="5548155">va</span><span class="op" id="5548157">)</span><span class="op" id="5548158">-</span><span class="ident" id="5548159">ds</span><span class="op" id="5548161">.</span><span class="ident" id="5548162">VirtualAddress</span><span class="op" id="5548176">+</span><span class="num" id="5548177">2</span><span class="op" id="5548178">)</span><span class="op" id="5548179">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548186">all</span>&nbsp;<span class="op" id="5548190">=</span>&nbsp;<span class="builtinfunc" id="5548192">append</span><span class="op" id="5548198">(</span><span class="ident" id="5548199">all</span><span class="op" id="5548202">,</span>&nbsp;<span class="ident" id="5548204">fn</span><span class="op" id="5548206">+</span><span class="string" id="5548207">&#34;:&#34;</span><span class="op" id="5548210">+</span><span class="ident" id="5548211">dt</span><span class="op" id="5548213">.</span><span class="ident" id="5548214">dll</span><span class="op" id="5548217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548228">}</span>&nbsp;<span class="keyword" id="5548230">else</span>&nbsp;<span class="op" id="5548235">{</span>&nbsp;<span class="comment" id="5548237">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548250">va</span>&nbsp;<span class="op" id="5548253">:=</span>&nbsp;<span class="ident" id="5548256">binary</span><span class="op" id="5548262">.</span><span class="ident" id="5548263">LittleEndian</span><span class="op" id="5548275">.</span><span class="ident" id="5548276">Uint32</span><span class="op" id="5548282">(</span><span class="ident" id="5548283">d</span><span class="op" id="5548284">[</span><span class="num" id="5548285">0</span><span class="op" id="5548286">:</span><span class="num" id="5548287">4</span><span class="op" id="5548288">]</span><span class="op" id="5548289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548295">d</span>&nbsp;<span class="op" id="5548297">=</span>&nbsp;<span class="ident" id="5548299">d</span><span class="op" id="5548300">[</span><span class="num" id="5548301">4</span><span class="op" id="5548302">:</span><span class="op" id="5548303">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548309">if</span>&nbsp;<span class="ident" id="5548312">va</span>&nbsp;<span class="op" id="5548315">==</span>&nbsp;<span class="num" id="5548318">0</span>&nbsp;<span class="op" id="5548320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548327">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548343">if</span>&nbsp;<span class="ident" id="5548346">va</span><span class="op" id="5548348">&amp;</span><span class="num" id="5548349">0x80000000</span>&nbsp;<span class="op" id="5548360">&gt;</span>&nbsp;<span class="num" id="5548362">0</span>&nbsp;<span class="op" id="5548364">{</span>&nbsp;<span class="comment" id="5548366">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5548385">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5548429">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548456">}</span>&nbsp;<span class="keyword" id="5548458">else</span>&nbsp;<span class="op" id="5548463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548470">fn</span><span class="op" id="5548472">,</span>&nbsp;<span class="ident" id="5548474">_</span>&nbsp;<span class="op" id="5548476">:=</span>&nbsp;<span class="ident" id="5548479">getString</span><span class="op" id="5548488">(</span><span class="ident" id="5548489">names</span><span class="op" id="5548494">,</span>&nbsp;<span class="builtintype" id="5548496">int</span><span class="op" id="5548499">(</span><span class="ident" id="5548500">va</span><span class="op" id="5548502">-</span><span class="ident" id="5548503">ds</span><span class="op" id="5548505">.</span><span class="ident" id="5548506">VirtualAddress</span><span class="op" id="5548520">+</span><span class="num" id="5548521">2</span><span class="op" id="5548522">)</span><span class="op" id="5548523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5548530">all</span>&nbsp;<span class="op" id="5548534">=</span>&nbsp;<span class="builtinfunc" id="5548536">append</span><span class="op" id="5548542">(</span><span class="ident" id="5548543">all</span><span class="op" id="5548546">,</span>&nbsp;<span class="ident" id="5548548">fn</span><span class="op" id="5548550">+</span><span class="string" id="5548551">&#34;:&#34;</span><span class="op" id="5548554">+</span><span class="ident" id="5548555">dt</span><span class="op" id="5548557">.</span><span class="ident" id="5548558">dll</span><span class="op" id="5548561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548567">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5548579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548583">return</span>&nbsp;<span class="ident" id="5548590">all</span><span class="op" id="5548593">,</span>&nbsp;<span class="ident" id="5548595">nil</span><br>
<span class="lineno">385</span><span class="op" id="5548599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5548602">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5548658">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5548713">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5548761">func</span>&nbsp;<span class="op" id="5548766">(</span><span class="ident" id="5548767">f</span>&nbsp;<span class="op" id="5548769">*</span><span class="ident" id="5548770">File</span><span class="op" id="5548774">)</span>&nbsp;<span class="ident" id="5548776">ImportedLibraries</span><span class="op" id="5548793">(</span><span class="op" id="5548794">)</span>&nbsp;<span class="op" id="5548796">(</span><span class="op" id="5548797">[</span><span class="op" id="5548798">]</span><span class="builtintype" id="5548799">string</span><span class="op" id="5548805">,</span>&nbsp;<span class="builtintype" id="5548807">error</span><span class="op" id="5548812">)</span>&nbsp;<span class="op" id="5548814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5548817">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5548826">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5548892">return</span>&nbsp;<span class="ident" id="5548899">nil</span><span class="op" id="5548902">,</span>&nbsp;<span class="ident" id="5548904">nil</span><br>
<span class="lineno"></span><span class="op" id="5548908">}</span>
</div>
</body>
</html>
