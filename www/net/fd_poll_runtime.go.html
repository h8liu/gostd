<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3329921">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3329976">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3330030">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3330081">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330154">package</span>&nbsp;<span class="ident" id="3330162">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330167">import</span>&nbsp;<span class="op" id="3330174">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3330177">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3330185">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3330196">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3330203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3330206">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="3330284">func</span>&nbsp;<span class="ident" id="3330289">runtimeNano</span><span class="op" id="3330300">(</span><span class="op" id="3330301">)</span>&nbsp;<span class="ident" id="3330303">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330310">func</span>&nbsp;<span class="ident" id="3330315">runtime_pollServerInit</span><span class="op" id="3330337">(</span><span class="op" id="3330338">)</span><br>
<span class="lineno"></span><span class="keyword" id="3330340">func</span>&nbsp;<span class="ident" id="3330345">runtime_pollOpen</span><span class="op" id="3330361">(</span><span class="ident" id="3330362">fd</span>&nbsp;<span class="builtintype" id="3330365">uintptr</span><span class="op" id="3330372">)</span>&nbsp;<span class="op" id="3330374">(</span><span class="builtintype" id="3330375">uintptr</span><span class="op" id="3330382">,</span>&nbsp;<span class="builtintype" id="3330384">int</span><span class="op" id="3330387">)</span><br>
<span class="lineno">20</span><span class="keyword" id="3330389">func</span>&nbsp;<span class="ident" id="3330394">runtime_pollClose</span><span class="op" id="3330411">(</span><span class="ident" id="3330412">ctx</span>&nbsp;<span class="builtintype" id="3330416">uintptr</span><span class="op" id="3330423">)</span><br>
<span class="lineno"></span><span class="keyword" id="3330425">func</span>&nbsp;<span class="ident" id="3330430">runtime_pollWait</span><span class="op" id="3330446">(</span><span class="ident" id="3330447">ctx</span>&nbsp;<span class="builtintype" id="3330451">uintptr</span><span class="op" id="3330458">,</span>&nbsp;<span class="ident" id="3330460">mode</span>&nbsp;<span class="builtintype" id="3330465">int</span><span class="op" id="3330468">)</span>&nbsp;<span class="builtintype" id="3330470">int</span><br>
<span class="lineno"></span><span class="keyword" id="3330474">func</span>&nbsp;<span class="ident" id="3330479">runtime_pollWaitCanceled</span><span class="op" id="3330503">(</span><span class="ident" id="3330504">ctx</span>&nbsp;<span class="builtintype" id="3330508">uintptr</span><span class="op" id="3330515">,</span>&nbsp;<span class="ident" id="3330517">mode</span>&nbsp;<span class="builtintype" id="3330522">int</span><span class="op" id="3330525">)</span>&nbsp;<span class="builtintype" id="3330527">int</span><br>
<span class="lineno"></span><span class="keyword" id="3330531">func</span>&nbsp;<span class="ident" id="3330536">runtime_pollReset</span><span class="op" id="3330553">(</span><span class="ident" id="3330554">ctx</span>&nbsp;<span class="builtintype" id="3330558">uintptr</span><span class="op" id="3330565">,</span>&nbsp;<span class="ident" id="3330567">mode</span>&nbsp;<span class="builtintype" id="3330572">int</span><span class="op" id="3330575">)</span>&nbsp;<span class="builtintype" id="3330577">int</span><br>
<span class="lineno"></span><span class="keyword" id="3330581">func</span>&nbsp;<span class="ident" id="3330586">runtime_pollSetDeadline</span><span class="op" id="3330609">(</span><span class="ident" id="3330610">ctx</span>&nbsp;<span class="builtintype" id="3330614">uintptr</span><span class="op" id="3330621">,</span>&nbsp;<span class="ident" id="3330623">d</span>&nbsp;<span class="ident" id="3330625">int64</span><span class="op" id="3330630">,</span>&nbsp;<span class="ident" id="3330632">mode</span>&nbsp;<span class="builtintype" id="3330637">int</span><span class="op" id="3330640">)</span><br>
<span class="lineno">25</span><span class="keyword" id="3330642">func</span>&nbsp;<span class="ident" id="3330647">runtime_pollUnblock</span><span class="op" id="3330666">(</span><span class="ident" id="3330667">ctx</span>&nbsp;<span class="builtintype" id="3330671">uintptr</span><span class="op" id="3330678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330681">type</span>&nbsp;<span class="ident" id="3330686">pollDesc</span>&nbsp;<span class="keyword" id="3330695">struct</span>&nbsp;<span class="op" id="3330702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330705">runtimeCtx</span>&nbsp;<span class="builtintype" id="3330716">uintptr</span><br>
<span class="lineno"></span><span class="op" id="3330724">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3330727">var</span>&nbsp;<span class="ident" id="3330731">serverInit</span>&nbsp;<span class="ident" id="3330742">sync</span><span class="op" id="3330746">.</span><span class="ident" id="3330747">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330753">func</span>&nbsp;<span class="op" id="3330758">(</span><span class="ident" id="3330759">pd</span>&nbsp;<span class="op" id="3330762">*</span><span class="ident" id="3330763">pollDesc</span><span class="op" id="3330771">)</span>&nbsp;<span class="ident" id="3330773">Init</span><span class="op" id="3330777">(</span><span class="ident" id="3330778">fd</span>&nbsp;<span class="op" id="3330781">*</span><span class="ident" id="3330782">netFD</span><span class="op" id="3330787">)</span>&nbsp;<span class="builtintype" id="3330789">error</span>&nbsp;<span class="op" id="3330795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330798">serverInit</span><span class="op" id="3330808">.</span><span class="ident" id="3330809">Do</span><span class="op" id="3330811">(</span><span class="ident" id="3330812">runtime_pollServerInit</span><span class="op" id="3330834">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330837">ctx</span><span class="op" id="3330840">,</span>&nbsp;<span class="ident" id="3330842">errno</span>&nbsp;<span class="op" id="3330848">:=</span>&nbsp;<span class="ident" id="3330851">runtime_pollOpen</span><span class="op" id="3330867">(</span><span class="builtintype" id="3330868">uintptr</span><span class="op" id="3330875">(</span><span class="ident" id="3330876">fd</span><span class="op" id="3330878">.</span><span class="ident" id="3330879">sysfd</span><span class="op" id="3330884">)</span><span class="op" id="3330885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330888">if</span>&nbsp;<span class="ident" id="3330891">errno</span>&nbsp;<span class="op" id="3330897">!=</span>&nbsp;<span class="num" id="3330900">0</span>&nbsp;<span class="op" id="3330902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330906">return</span>&nbsp;<span class="ident" id="3330913">syscall</span><span class="op" id="3330920">.</span><span class="ident" id="3330921">Errno</span><span class="op" id="3330926">(</span><span class="ident" id="3330927">errno</span><span class="op" id="3330932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330938">pd</span><span class="op" id="3330940">.</span><span class="ident" id="3330941">runtimeCtx</span>&nbsp;<span class="op" id="3330952">=</span>&nbsp;<span class="ident" id="3330954">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330959">return</span>&nbsp;<span class="ident" id="3330966">nil</span><br>
<span class="lineno"></span><span class="op" id="3330970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330973">func</span>&nbsp;<span class="op" id="3330978">(</span><span class="ident" id="3330979">pd</span>&nbsp;<span class="op" id="3330982">*</span><span class="ident" id="3330983">pollDesc</span><span class="op" id="3330991">)</span>&nbsp;<span class="ident" id="3330993">Close</span><span class="op" id="3330998">(</span><span class="op" id="3330999">)</span>&nbsp;<span class="op" id="3331001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331004">if</span>&nbsp;<span class="ident" id="3331007">pd</span><span class="op" id="3331009">.</span><span class="ident" id="3331010">runtimeCtx</span>&nbsp;<span class="op" id="3331021">==</span>&nbsp;<span class="num" id="3331024">0</span>&nbsp;<span class="op" id="3331026">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331030">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331041">runtime_pollClose</span><span class="op" id="3331058">(</span><span class="ident" id="3331059">pd</span><span class="op" id="3331061">.</span><span class="ident" id="3331062">runtimeCtx</span><span class="op" id="3331072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331075">pd</span><span class="op" id="3331077">.</span><span class="ident" id="3331078">runtimeCtx</span>&nbsp;<span class="op" id="3331089">=</span>&nbsp;<span class="num" id="3331091">0</span><br>
<span class="lineno"></span><span class="op" id="3331093">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3331096">func</span>&nbsp;<span class="op" id="3331101">(</span><span class="ident" id="3331102">pd</span>&nbsp;<span class="op" id="3331105">*</span><span class="ident" id="3331106">pollDesc</span><span class="op" id="3331114">)</span>&nbsp;<span class="ident" id="3331116">Lock</span><span class="op" id="3331120">(</span><span class="op" id="3331121">)</span>&nbsp;<span class="op" id="3331123">{</span><br>
<span class="lineno"></span><span class="op" id="3331125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331128">func</span>&nbsp;<span class="op" id="3331133">(</span><span class="ident" id="3331134">pd</span>&nbsp;<span class="op" id="3331137">*</span><span class="ident" id="3331138">pollDesc</span><span class="op" id="3331146">)</span>&nbsp;<span class="ident" id="3331148">Unlock</span><span class="op" id="3331154">(</span><span class="op" id="3331155">)</span>&nbsp;<span class="op" id="3331157">{</span><br>
<span class="lineno">55</span><span class="op" id="3331159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331162">func</span>&nbsp;<span class="op" id="3331167">(</span><span class="ident" id="3331168">pd</span>&nbsp;<span class="op" id="3331171">*</span><span class="ident" id="3331172">pollDesc</span><span class="op" id="3331180">)</span>&nbsp;<span class="ident" id="3331182">Wakeup</span><span class="op" id="3331188">(</span><span class="op" id="3331189">)</span>&nbsp;<span class="op" id="3331191">{</span><br>
<span class="lineno"></span><span class="op" id="3331193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3331196">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="3331272">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="3331334">func</span>&nbsp;<span class="op" id="3331339">(</span><span class="ident" id="3331340">pd</span>&nbsp;<span class="op" id="3331343">*</span><span class="ident" id="3331344">pollDesc</span><span class="op" id="3331352">)</span>&nbsp;<span class="ident" id="3331354">Evict</span><span class="op" id="3331359">(</span><span class="op" id="3331360">)</span>&nbsp;<span class="builtintype" id="3331362">bool</span>&nbsp;<span class="op" id="3331367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331370">if</span>&nbsp;<span class="ident" id="3331373">pd</span><span class="op" id="3331375">.</span><span class="ident" id="3331376">runtimeCtx</span>&nbsp;<span class="op" id="3331387">==</span>&nbsp;<span class="num" id="3331390">0</span>&nbsp;<span class="op" id="3331392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331396">return</span>&nbsp;<span class="ident" id="3331403">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331413">runtime_pollUnblock</span><span class="op" id="3331432">(</span><span class="ident" id="3331433">pd</span><span class="op" id="3331435">.</span><span class="ident" id="3331436">runtimeCtx</span><span class="op" id="3331446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331449">return</span>&nbsp;<span class="ident" id="3331456">false</span><br>
<span class="lineno"></span><span class="op" id="3331462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3331465">func</span>&nbsp;<span class="op" id="3331470">(</span><span class="ident" id="3331471">pd</span>&nbsp;<span class="op" id="3331474">*</span><span class="ident" id="3331475">pollDesc</span><span class="op" id="3331483">)</span>&nbsp;<span class="ident" id="3331485">Prepare</span><span class="op" id="3331492">(</span><span class="ident" id="3331493">mode</span>&nbsp;<span class="builtintype" id="3331498">int</span><span class="op" id="3331501">)</span>&nbsp;<span class="builtintype" id="3331503">error</span>&nbsp;<span class="op" id="3331509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331512">res</span>&nbsp;<span class="op" id="3331516">:=</span>&nbsp;<span class="ident" id="3331519">runtime_pollReset</span><span class="op" id="3331536">(</span><span class="ident" id="3331537">pd</span><span class="op" id="3331539">.</span><span class="ident" id="3331540">runtimeCtx</span><span class="op" id="3331550">,</span>&nbsp;<span class="ident" id="3331552">mode</span><span class="op" id="3331556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331559">return</span>&nbsp;<span class="ident" id="3331566">convertErr</span><span class="op" id="3331576">(</span><span class="ident" id="3331577">res</span><span class="op" id="3331580">)</span><br>
<span class="lineno"></span><span class="op" id="3331582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="3331585">func</span>&nbsp;<span class="op" id="3331590">(</span><span class="ident" id="3331591">pd</span>&nbsp;<span class="op" id="3331594">*</span><span class="ident" id="3331595">pollDesc</span><span class="op" id="3331603">)</span>&nbsp;<span class="ident" id="3331605">PrepareRead</span><span class="op" id="3331616">(</span><span class="op" id="3331617">)</span>&nbsp;<span class="builtintype" id="3331619">error</span>&nbsp;<span class="op" id="3331625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331628">return</span>&nbsp;<span class="ident" id="3331635">pd</span><span class="op" id="3331637">.</span><span class="ident" id="3331638">Prepare</span><span class="op" id="3331645">(</span><span class="string" id="3331646">&#39;r&#39;</span><span class="op" id="3331649">)</span><br>
<span class="lineno"></span><span class="op" id="3331651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331654">func</span>&nbsp;<span class="op" id="3331659">(</span><span class="ident" id="3331660">pd</span>&nbsp;<span class="op" id="3331663">*</span><span class="ident" id="3331664">pollDesc</span><span class="op" id="3331672">)</span>&nbsp;<span class="ident" id="3331674">PrepareWrite</span><span class="op" id="3331686">(</span><span class="op" id="3331687">)</span>&nbsp;<span class="builtintype" id="3331689">error</span>&nbsp;<span class="op" id="3331695">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331698">return</span>&nbsp;<span class="ident" id="3331705">pd</span><span class="op" id="3331707">.</span><span class="ident" id="3331708">Prepare</span><span class="op" id="3331715">(</span><span class="string" id="3331716">&#39;w&#39;</span><span class="op" id="3331719">)</span><br>
<span class="lineno"></span><span class="op" id="3331721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331724">func</span>&nbsp;<span class="op" id="3331729">(</span><span class="ident" id="3331730">pd</span>&nbsp;<span class="op" id="3331733">*</span><span class="ident" id="3331734">pollDesc</span><span class="op" id="3331742">)</span>&nbsp;<span class="ident" id="3331744">Wait</span><span class="op" id="3331748">(</span><span class="ident" id="3331749">mode</span>&nbsp;<span class="builtintype" id="3331754">int</span><span class="op" id="3331757">)</span>&nbsp;<span class="builtintype" id="3331759">error</span>&nbsp;<span class="op" id="3331765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331768">res</span>&nbsp;<span class="op" id="3331772">:=</span>&nbsp;<span class="ident" id="3331775">runtime_pollWait</span><span class="op" id="3331791">(</span><span class="ident" id="3331792">pd</span><span class="op" id="3331794">.</span><span class="ident" id="3331795">runtimeCtx</span><span class="op" id="3331805">,</span>&nbsp;<span class="ident" id="3331807">mode</span><span class="op" id="3331811">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331814">return</span>&nbsp;<span class="ident" id="3331821">convertErr</span><span class="op" id="3331831">(</span><span class="ident" id="3331832">res</span><span class="op" id="3331835">)</span><br>
<span class="lineno"></span><span class="op" id="3331837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331840">func</span>&nbsp;<span class="op" id="3331845">(</span><span class="ident" id="3331846">pd</span>&nbsp;<span class="op" id="3331849">*</span><span class="ident" id="3331850">pollDesc</span><span class="op" id="3331858">)</span>&nbsp;<span class="ident" id="3331860">WaitRead</span><span class="op" id="3331868">(</span><span class="op" id="3331869">)</span>&nbsp;<span class="builtintype" id="3331871">error</span>&nbsp;<span class="op" id="3331877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331880">return</span>&nbsp;<span class="ident" id="3331887">pd</span><span class="op" id="3331889">.</span><span class="ident" id="3331890">Wait</span><span class="op" id="3331894">(</span><span class="string" id="3331895">&#39;r&#39;</span><span class="op" id="3331898">)</span><br>
<span class="lineno">90</span><span class="op" id="3331900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331903">func</span>&nbsp;<span class="op" id="3331908">(</span><span class="ident" id="3331909">pd</span>&nbsp;<span class="op" id="3331912">*</span><span class="ident" id="3331913">pollDesc</span><span class="op" id="3331921">)</span>&nbsp;<span class="ident" id="3331923">WaitWrite</span><span class="op" id="3331932">(</span><span class="op" id="3331933">)</span>&nbsp;<span class="builtintype" id="3331935">error</span>&nbsp;<span class="op" id="3331941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331944">return</span>&nbsp;<span class="ident" id="3331951">pd</span><span class="op" id="3331953">.</span><span class="ident" id="3331954">Wait</span><span class="op" id="3331958">(</span><span class="string" id="3331959">&#39;w&#39;</span><span class="op" id="3331962">)</span><br>
<span class="lineno"></span><span class="op" id="3331964">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3331967">func</span>&nbsp;<span class="op" id="3331972">(</span><span class="ident" id="3331973">pd</span>&nbsp;<span class="op" id="3331976">*</span><span class="ident" id="3331977">pollDesc</span><span class="op" id="3331985">)</span>&nbsp;<span class="ident" id="3331987">WaitCanceled</span><span class="op" id="3331999">(</span><span class="ident" id="3332000">mode</span>&nbsp;<span class="builtintype" id="3332005">int</span><span class="op" id="3332008">)</span>&nbsp;<span class="op" id="3332010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332013">runtime_pollWaitCanceled</span><span class="op" id="3332037">(</span><span class="ident" id="3332038">pd</span><span class="op" id="3332040">.</span><span class="ident" id="3332041">runtimeCtx</span><span class="op" id="3332051">,</span>&nbsp;<span class="ident" id="3332053">mode</span><span class="op" id="3332057">)</span><br>
<span class="lineno"></span><span class="op" id="3332059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3332062">func</span>&nbsp;<span class="op" id="3332067">(</span><span class="ident" id="3332068">pd</span>&nbsp;<span class="op" id="3332071">*</span><span class="ident" id="3332072">pollDesc</span><span class="op" id="3332080">)</span>&nbsp;<span class="ident" id="3332082">WaitCanceledRead</span><span class="op" id="3332098">(</span><span class="op" id="3332099">)</span>&nbsp;<span class="op" id="3332101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332104">pd</span><span class="op" id="3332106">.</span><span class="ident" id="3332107">WaitCanceled</span><span class="op" id="3332119">(</span><span class="string" id="3332120">&#39;r&#39;</span><span class="op" id="3332123">)</span><br>
<span class="lineno"></span><span class="op" id="3332125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3332128">func</span>&nbsp;<span class="op" id="3332133">(</span><span class="ident" id="3332134">pd</span>&nbsp;<span class="op" id="3332137">*</span><span class="ident" id="3332138">pollDesc</span><span class="op" id="3332146">)</span>&nbsp;<span class="ident" id="3332148">WaitCanceledWrite</span><span class="op" id="3332165">(</span><span class="op" id="3332166">)</span>&nbsp;<span class="op" id="3332168">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332171">pd</span><span class="op" id="3332173">.</span><span class="ident" id="3332174">WaitCanceled</span><span class="op" id="3332186">(</span><span class="string" id="3332187">&#39;w&#39;</span><span class="op" id="3332190">)</span><br>
<span class="lineno"></span><span class="op" id="3332192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3332195">func</span>&nbsp;<span class="ident" id="3332200">convertErr</span><span class="op" id="3332210">(</span><span class="ident" id="3332211">res</span>&nbsp;<span class="builtintype" id="3332215">int</span><span class="op" id="3332218">)</span>&nbsp;<span class="builtintype" id="3332220">error</span>&nbsp;<span class="op" id="3332226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332229">switch</span>&nbsp;<span class="ident" id="3332236">res</span>&nbsp;<span class="op" id="3332240">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332243">case</span>&nbsp;<span class="num" id="3332248">0</span><span class="op" id="3332249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332253">return</span>&nbsp;<span class="ident" id="3332260">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332265">case</span>&nbsp;<span class="num" id="3332270">1</span><span class="op" id="3332271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332275">return</span>&nbsp;<span class="ident" id="3332282">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332294">case</span>&nbsp;<span class="num" id="3332299">2</span><span class="op" id="3332300">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332304">return</span>&nbsp;<span class="ident" id="3332311">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3332326">println</span><span class="op" id="3332333">(</span><span class="string" id="3332334">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="3332349">,</span>&nbsp;<span class="ident" id="3332351">res</span><span class="op" id="3332354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3332357">panic</span><span class="op" id="3332362">(</span><span class="string" id="3332363">&#34;unreachable&#34;</span><span class="op" id="3332376">)</span><br>
<span class="lineno"></span><span class="op" id="3332378">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3332381">func</span>&nbsp;<span class="op" id="3332386">(</span><span class="ident" id="3332387">fd</span>&nbsp;<span class="op" id="3332390">*</span><span class="ident" id="3332391">netFD</span><span class="op" id="3332396">)</span>&nbsp;<span class="ident" id="3332398">setDeadline</span><span class="op" id="3332409">(</span><span class="ident" id="3332410">t</span>&nbsp;<span class="ident" id="3332412">time</span><span class="op" id="3332416">.</span><span class="ident" id="3332417">Time</span><span class="op" id="3332421">)</span>&nbsp;<span class="builtintype" id="3332423">error</span>&nbsp;<span class="op" id="3332429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332432">return</span>&nbsp;<span class="ident" id="3332439">setDeadlineImpl</span><span class="op" id="3332454">(</span><span class="ident" id="3332455">fd</span><span class="op" id="3332457">,</span>&nbsp;<span class="ident" id="3332459">t</span><span class="op" id="3332460">,</span>&nbsp;<span class="string" id="3332462">&#39;r&#39;</span><span class="op" id="3332465">+</span><span class="string" id="3332466">&#39;w&#39;</span><span class="op" id="3332469">)</span><br>
<span class="lineno"></span><span class="op" id="3332471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3332474">func</span>&nbsp;<span class="op" id="3332479">(</span><span class="ident" id="3332480">fd</span>&nbsp;<span class="op" id="3332483">*</span><span class="ident" id="3332484">netFD</span><span class="op" id="3332489">)</span>&nbsp;<span class="ident" id="3332491">setReadDeadline</span><span class="op" id="3332506">(</span><span class="ident" id="3332507">t</span>&nbsp;<span class="ident" id="3332509">time</span><span class="op" id="3332513">.</span><span class="ident" id="3332514">Time</span><span class="op" id="3332518">)</span>&nbsp;<span class="builtintype" id="3332520">error</span>&nbsp;<span class="op" id="3332526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332529">return</span>&nbsp;<span class="ident" id="3332536">setDeadlineImpl</span><span class="op" id="3332551">(</span><span class="ident" id="3332552">fd</span><span class="op" id="3332554">,</span>&nbsp;<span class="ident" id="3332556">t</span><span class="op" id="3332557">,</span>&nbsp;<span class="string" id="3332559">&#39;r&#39;</span><span class="op" id="3332562">)</span><br>
<span class="lineno"></span><span class="op" id="3332564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3332567">func</span>&nbsp;<span class="op" id="3332572">(</span><span class="ident" id="3332573">fd</span>&nbsp;<span class="op" id="3332576">*</span><span class="ident" id="3332577">netFD</span><span class="op" id="3332582">)</span>&nbsp;<span class="ident" id="3332584">setWriteDeadline</span><span class="op" id="3332600">(</span><span class="ident" id="3332601">t</span>&nbsp;<span class="ident" id="3332603">time</span><span class="op" id="3332607">.</span><span class="ident" id="3332608">Time</span><span class="op" id="3332612">)</span>&nbsp;<span class="builtintype" id="3332614">error</span>&nbsp;<span class="op" id="3332620">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332623">return</span>&nbsp;<span class="ident" id="3332630">setDeadlineImpl</span><span class="op" id="3332645">(</span><span class="ident" id="3332646">fd</span><span class="op" id="3332648">,</span>&nbsp;<span class="ident" id="3332650">t</span><span class="op" id="3332651">,</span>&nbsp;<span class="string" id="3332653">&#39;w&#39;</span><span class="op" id="3332656">)</span><br>
<span class="lineno"></span><span class="op" id="3332658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3332661">func</span>&nbsp;<span class="ident" id="3332666">setDeadlineImpl</span><span class="op" id="3332681">(</span><span class="ident" id="3332682">fd</span>&nbsp;<span class="op" id="3332685">*</span><span class="ident" id="3332686">netFD</span><span class="op" id="3332691">,</span>&nbsp;<span class="ident" id="3332693">t</span>&nbsp;<span class="ident" id="3332695">time</span><span class="op" id="3332699">.</span><span class="ident" id="3332700">Time</span><span class="op" id="3332704">,</span>&nbsp;<span class="ident" id="3332706">mode</span>&nbsp;<span class="builtintype" id="3332711">int</span><span class="op" id="3332714">)</span>&nbsp;<span class="builtintype" id="3332716">error</span>&nbsp;<span class="op" id="3332722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332725">d</span>&nbsp;<span class="op" id="3332727">:=</span>&nbsp;<span class="ident" id="3332730">runtimeNano</span><span class="op" id="3332741">(</span><span class="op" id="3332742">)</span>&nbsp;<span class="op" id="3332744">+</span>&nbsp;<span class="ident" id="3332746">int64</span><span class="op" id="3332751">(</span><span class="ident" id="3332752">t</span><span class="op" id="3332753">.</span><span class="ident" id="3332754">Sub</span><span class="op" id="3332757">(</span><span class="ident" id="3332758">time</span><span class="op" id="3332762">.</span><span class="ident" id="3332763">Now</span><span class="op" id="3332766">(</span><span class="op" id="3332767">)</span><span class="op" id="3332768">)</span><span class="op" id="3332769">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332772">if</span>&nbsp;<span class="ident" id="3332775">t</span><span class="op" id="3332776">.</span><span class="ident" id="3332777">IsZero</span><span class="op" id="3332783">(</span><span class="op" id="3332784">)</span>&nbsp;<span class="op" id="3332786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332790">d</span>&nbsp;<span class="op" id="3332792">=</span>&nbsp;<span class="num" id="3332794">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332800">if</span>&nbsp;<span class="ident" id="3332803">err</span>&nbsp;<span class="op" id="3332807">:=</span>&nbsp;<span class="ident" id="3332810">fd</span><span class="op" id="3332812">.</span><span class="ident" id="3332813">incref</span><span class="op" id="3332819">(</span><span class="op" id="3332820">)</span><span class="op" id="3332821">;</span>&nbsp;<span class="ident" id="3332823">err</span>&nbsp;<span class="op" id="3332827">!=</span>&nbsp;<span class="ident" id="3332830">nil</span>&nbsp;<span class="op" id="3332834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332838">return</span>&nbsp;<span class="ident" id="3332845">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332853">runtime_pollSetDeadline</span><span class="op" id="3332876">(</span><span class="ident" id="3332877">fd</span><span class="op" id="3332879">.</span><span class="ident" id="3332880">pd</span><span class="op" id="3332882">.</span><span class="ident" id="3332883">runtimeCtx</span><span class="op" id="3332893">,</span>&nbsp;<span class="ident" id="3332895">d</span><span class="op" id="3332896">,</span>&nbsp;<span class="ident" id="3332898">mode</span><span class="op" id="3332902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332905">fd</span><span class="op" id="3332907">.</span><span class="ident" id="3332908">decref</span><span class="op" id="3332914">(</span><span class="op" id="3332915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332918">return</span>&nbsp;<span class="ident" id="3332925">nil</span><br>
<span class="lineno"></span><span class="op" id="3332929">}</span>
</div>
</body>
</html>
