<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6499447">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6499502">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6499556">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6499607">package</span>&nbsp;<span class="ident" id="6499615">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499620">import</span>&nbsp;<span class="op" id="6499627">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499630">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499639">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499645">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499658">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499671">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6499677">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6499687">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6499690">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499737">type</span>&nbsp;<span class="ident" id="6499742">WriteTest</span>&nbsp;<span class="keyword" id="6499752">struct</span>&nbsp;<span class="op" id="6499759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499762">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6499769">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499777">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6499784">[</span><span class="op" id="6499785">]</span><span class="builtintype" id="6499786">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499792">Method</span>&nbsp;<span class="builtintype" id="6499799">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499807">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6499814">os</span><span class="op" id="6499816">.</span><span class="ident" id="6499817">FileMode</span><br>
<span class="lineno"></span><span class="op" id="6499826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6499829">var</span>&nbsp;<span class="ident" id="6499833">writeTests</span>&nbsp;<span class="op" id="6499844">=</span>&nbsp;<span class="op" id="6499846">[</span><span class="op" id="6499847">]</span><span class="ident" id="6499848">WriteTest</span><span class="op" id="6499857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499864">Name</span><span class="op" id="6499868">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6499872">&#34;foo&#34;</span><span class="op" id="6499877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499881">Data</span><span class="op" id="6499885">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6499889">[</span><span class="op" id="6499890">]</span><span class="builtintype" id="6499891">byte</span><span class="op" id="6499895">(</span><span class="string" id="6499896">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="6499956">)</span><span class="op" id="6499957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499961">Method</span><span class="op" id="6499967">:</span>&nbsp;<span class="ident" id="6499969">Store</span><span class="op" id="6499974">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499978">Mode</span><span class="op" id="6499982">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6499986">0666</span><span class="op" id="6499990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499993">}</span><span class="op" id="6499994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500001">Name</span><span class="op" id="6500005">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6500009">&#34;bar&#34;</span><span class="op" id="6500014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500018">Data</span><span class="op" id="6500022">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6500026">nil</span><span class="op" id="6500029">,</span>&nbsp;<span class="comment" id="6500031">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500063">Method</span><span class="op" id="6500069">:</span>&nbsp;<span class="ident" id="6500071">Deflate</span><span class="op" id="6500078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500082">Mode</span><span class="op" id="6500086">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6500090">0644</span><span class="op" id="6500094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500097">}</span><span class="op" id="6500098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500105">Name</span><span class="op" id="6500109">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6500113">&#34;setuid&#34;</span><span class="op" id="6500121">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500125">Data</span><span class="op" id="6500129">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6500133">[</span><span class="op" id="6500134">]</span><span class="builtintype" id="6500135">byte</span><span class="op" id="6500139">(</span><span class="string" id="6500140">&#34;setuid&nbsp;file&#34;</span><span class="op" id="6500153">)</span><span class="op" id="6500154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500158">Method</span><span class="op" id="6500164">:</span>&nbsp;<span class="ident" id="6500166">Deflate</span><span class="op" id="6500173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500177">Mode</span><span class="op" id="6500181">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6500185">0755</span>&nbsp;<span class="op" id="6500190">|</span>&nbsp;<span class="ident" id="6500192">os</span><span class="op" id="6500194">.</span><span class="ident" id="6500195">ModeSetuid</span><span class="op" id="6500205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500208">}</span><span class="op" id="6500209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500212">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500216">Name</span><span class="op" id="6500220">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6500224">&#34;setgid&#34;</span><span class="op" id="6500232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500236">Data</span><span class="op" id="6500240">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6500244">[</span><span class="op" id="6500245">]</span><span class="builtintype" id="6500246">byte</span><span class="op" id="6500250">(</span><span class="string" id="6500251">&#34;setgid&nbsp;file&#34;</span><span class="op" id="6500264">)</span><span class="op" id="6500265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500269">Method</span><span class="op" id="6500275">:</span>&nbsp;<span class="ident" id="6500277">Deflate</span><span class="op" id="6500284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500288">Mode</span><span class="op" id="6500292">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6500296">0755</span>&nbsp;<span class="op" id="6500301">|</span>&nbsp;<span class="ident" id="6500303">os</span><span class="op" id="6500305">.</span><span class="ident" id="6500306">ModeSetgid</span><span class="op" id="6500316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500319">}</span><span class="op" id="6500320">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500327">Name</span><span class="op" id="6500331">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6500335">&#34;symlink&#34;</span><span class="op" id="6500344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500348">Data</span><span class="op" id="6500352">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6500356">[</span><span class="op" id="6500357">]</span><span class="builtintype" id="6500358">byte</span><span class="op" id="6500362">(</span><span class="string" id="6500363">&#34;../link/target&#34;</span><span class="op" id="6500379">)</span><span class="op" id="6500380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500384">Method</span><span class="op" id="6500390">:</span>&nbsp;<span class="ident" id="6500392">Deflate</span><span class="op" id="6500399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500403">Mode</span><span class="op" id="6500407">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6500411">0755</span>&nbsp;<span class="op" id="6500416">|</span>&nbsp;<span class="ident" id="6500418">os</span><span class="op" id="6500420">.</span><span class="ident" id="6500421">ModeSymlink</span><span class="op" id="6500432">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500435">}</span><span class="op" id="6500436">,</span><br>
<span class="lineno"></span><span class="op" id="6500438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6500441">func</span>&nbsp;<span class="ident" id="6500446">TestWriter</span><span class="op" id="6500456">(</span><span class="ident" id="6500457">t</span>&nbsp;<span class="op" id="6500459">*</span><span class="ident" id="6500460">testing</span><span class="op" id="6500467">.</span><span class="ident" id="6500468">T</span><span class="op" id="6500469">)</span>&nbsp;<span class="op" id="6500471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500474">largeData</span>&nbsp;<span class="op" id="6500484">:=</span>&nbsp;<span class="builtinfunc" id="6500487">make</span><span class="op" id="6500491">(</span><span class="op" id="6500492">[</span><span class="op" id="6500493">]</span><span class="builtintype" id="6500494">byte</span><span class="op" id="6500498">,</span>&nbsp;<span class="num" id="6500500">1</span><span class="op" id="6500501">&lt;&lt;</span><span class="num" id="6500503">17</span><span class="op" id="6500505">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500508">for</span>&nbsp;<span class="ident" id="6500512">i</span>&nbsp;<span class="op" id="6500514">:=</span>&nbsp;<span class="keyword" id="6500517">range</span>&nbsp;<span class="ident" id="6500523">largeData</span>&nbsp;<span class="op" id="6500533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500537">largeData</span><span class="op" id="6500546">[</span><span class="ident" id="6500547">i</span><span class="op" id="6500548">]</span>&nbsp;<span class="op" id="6500550">=</span>&nbsp;<span class="builtintype" id="6500552">byte</span><span class="op" id="6500556">(</span><span class="ident" id="6500557">rand</span><span class="op" id="6500561">.</span><span class="ident" id="6500562">Int</span><span class="op" id="6500565">(</span><span class="op" id="6500566">)</span><span class="op" id="6500567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500573">writeTests</span><span class="op" id="6500583">[</span><span class="num" id="6500584">1</span><span class="op" id="6500585">]</span><span class="op" id="6500586">.</span><span class="ident" id="6500587">Data</span>&nbsp;<span class="op" id="6500592">=</span>&nbsp;<span class="ident" id="6500594">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500605">defer</span>&nbsp;<span class="keyword" id="6500611">func</span><span class="op" id="6500615">(</span><span class="op" id="6500616">)</span>&nbsp;<span class="op" id="6500618">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500622">writeTests</span><span class="op" id="6500632">[</span><span class="num" id="6500633">1</span><span class="op" id="6500634">]</span><span class="op" id="6500635">.</span><span class="ident" id="6500636">Data</span>&nbsp;<span class="op" id="6500641">=</span>&nbsp;<span class="ident" id="6500643">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500648">}</span><span class="op" id="6500649">(</span><span class="op" id="6500650">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6500654">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500675">buf</span>&nbsp;<span class="op" id="6500679">:=</span>&nbsp;<span class="builtinfunc" id="6500682">new</span><span class="op" id="6500685">(</span><span class="ident" id="6500686">bytes</span><span class="op" id="6500691">.</span><span class="ident" id="6500692">Buffer</span><span class="op" id="6500698">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500701">w</span>&nbsp;<span class="op" id="6500703">:=</span>&nbsp;<span class="ident" id="6500706">NewWriter</span><span class="op" id="6500715">(</span><span class="ident" id="6500716">buf</span><span class="op" id="6500719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500723">for</span>&nbsp;<span class="ident" id="6500727">_</span><span class="op" id="6500728">,</span>&nbsp;<span class="ident" id="6500730">wt</span>&nbsp;<span class="op" id="6500733">:=</span>&nbsp;<span class="keyword" id="6500736">range</span>&nbsp;<span class="ident" id="6500742">writeTests</span>&nbsp;<span class="op" id="6500753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500757">testCreate</span><span class="op" id="6500767">(</span><span class="ident" id="6500768">t</span><span class="op" id="6500769">,</span>&nbsp;<span class="ident" id="6500771">w</span><span class="op" id="6500772">,</span>&nbsp;<span class="op" id="6500774">&amp;</span><span class="ident" id="6500775">wt</span><span class="op" id="6500777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500780">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500784">if</span>&nbsp;<span class="ident" id="6500787">err</span>&nbsp;<span class="op" id="6500791">:=</span>&nbsp;<span class="ident" id="6500794">w</span><span class="op" id="6500795">.</span><span class="ident" id="6500796">Close</span><span class="op" id="6500801">(</span><span class="op" id="6500802">)</span><span class="op" id="6500803">;</span>&nbsp;<span class="ident" id="6500805">err</span>&nbsp;<span class="op" id="6500809">!=</span>&nbsp;<span class="ident" id="6500812">nil</span>&nbsp;<span class="op" id="6500816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500820">t</span><span class="op" id="6500821">.</span><span class="ident" id="6500822">Fatal</span><span class="op" id="6500827">(</span><span class="ident" id="6500828">err</span><span class="op" id="6500831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6500838">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500855">r</span><span class="op" id="6500856">,</span>&nbsp;<span class="ident" id="6500858">err</span>&nbsp;<span class="op" id="6500862">:=</span>&nbsp;<span class="ident" id="6500865">NewReader</span><span class="op" id="6500874">(</span><span class="ident" id="6500875">bytes</span><span class="op" id="6500880">.</span><span class="ident" id="6500881">NewReader</span><span class="op" id="6500890">(</span><span class="ident" id="6500891">buf</span><span class="op" id="6500894">.</span><span class="ident" id="6500895">Bytes</span><span class="op" id="6500900">(</span><span class="op" id="6500901">)</span><span class="op" id="6500902">)</span><span class="op" id="6500903">,</span>&nbsp;<span class="ident" id="6500905">int64</span><span class="op" id="6500910">(</span><span class="ident" id="6500911">buf</span><span class="op" id="6500914">.</span><span class="ident" id="6500915">Len</span><span class="op" id="6500918">(</span><span class="op" id="6500919">)</span><span class="op" id="6500920">)</span><span class="op" id="6500921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500924">if</span>&nbsp;<span class="ident" id="6500927">err</span>&nbsp;<span class="op" id="6500931">!=</span>&nbsp;<span class="ident" id="6500934">nil</span>&nbsp;<span class="op" id="6500938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500942">t</span><span class="op" id="6500943">.</span><span class="ident" id="6500944">Fatal</span><span class="op" id="6500949">(</span><span class="ident" id="6500950">err</span><span class="op" id="6500953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500956">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500959">for</span>&nbsp;<span class="ident" id="6500963">i</span><span class="op" id="6500964">,</span>&nbsp;<span class="ident" id="6500966">wt</span>&nbsp;<span class="op" id="6500969">:=</span>&nbsp;<span class="keyword" id="6500972">range</span>&nbsp;<span class="ident" id="6500978">writeTests</span>&nbsp;<span class="op" id="6500989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500993">testReadFile</span><span class="op" id="6501005">(</span><span class="ident" id="6501006">t</span><span class="op" id="6501007">,</span>&nbsp;<span class="ident" id="6501009">r</span><span class="op" id="6501010">.</span><span class="ident" id="6501011">File</span><span class="op" id="6501015">[</span><span class="ident" id="6501016">i</span><span class="op" id="6501017">]</span><span class="op" id="6501018">,</span>&nbsp;<span class="op" id="6501020">&amp;</span><span class="ident" id="6501021">wt</span><span class="op" id="6501023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501026">}</span><br>
<span class="lineno"></span><span class="op" id="6501028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6501031">func</span>&nbsp;<span class="ident" id="6501036">TestWriterFlush</span><span class="op" id="6501051">(</span><span class="ident" id="6501052">t</span>&nbsp;<span class="op" id="6501054">*</span><span class="ident" id="6501055">testing</span><span class="op" id="6501062">.</span><span class="ident" id="6501063">T</span><span class="op" id="6501064">)</span>&nbsp;<span class="op" id="6501066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501069">var</span>&nbsp;<span class="ident" id="6501073">buf</span>&nbsp;<span class="ident" id="6501077">bytes</span><span class="op" id="6501082">.</span><span class="ident" id="6501083">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501091">w</span>&nbsp;<span class="op" id="6501093">:=</span>&nbsp;<span class="ident" id="6501096">NewWriter</span><span class="op" id="6501105">(</span><span class="keyword" id="6501106">struct</span><span class="op" id="6501112">{</span>&nbsp;<span class="ident" id="6501114">io</span><span class="op" id="6501116">.</span><span class="ident" id="6501117">Writer</span>&nbsp;<span class="op" id="6501124">}</span><span class="op" id="6501125">{</span><span class="op" id="6501126">&amp;</span><span class="ident" id="6501127">buf</span><span class="op" id="6501130">}</span><span class="op" id="6501131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501134">_</span><span class="op" id="6501135">,</span>&nbsp;<span class="ident" id="6501137">err</span>&nbsp;<span class="op" id="6501141">:=</span>&nbsp;<span class="ident" id="6501144">w</span><span class="op" id="6501145">.</span><span class="ident" id="6501146">Create</span><span class="op" id="6501152">(</span><span class="string" id="6501153">&#34;foo&#34;</span><span class="op" id="6501158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501161">if</span>&nbsp;<span class="ident" id="6501164">err</span>&nbsp;<span class="op" id="6501168">!=</span>&nbsp;<span class="ident" id="6501171">nil</span>&nbsp;<span class="op" id="6501175">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501179">t</span><span class="op" id="6501180">.</span><span class="ident" id="6501181">Fatal</span><span class="op" id="6501186">(</span><span class="ident" id="6501187">err</span><span class="op" id="6501190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501196">if</span>&nbsp;<span class="ident" id="6501199">buf</span><span class="op" id="6501202">.</span><span class="ident" id="6501203">Len</span><span class="op" id="6501206">(</span><span class="op" id="6501207">)</span>&nbsp;<span class="op" id="6501209">&gt;</span>&nbsp;<span class="num" id="6501211">0</span>&nbsp;<span class="op" id="6501213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501217">t</span><span class="op" id="6501218">.</span><span class="ident" id="6501219">Fatalf</span><span class="op" id="6501225">(</span><span class="string" id="6501226">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="6501265">,</span>&nbsp;<span class="ident" id="6501267">buf</span><span class="op" id="6501270">.</span><span class="ident" id="6501271">Len</span><span class="op" id="6501274">(</span><span class="op" id="6501275">)</span><span class="op" id="6501276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501279">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501282">if</span>&nbsp;<span class="ident" id="6501285">err</span>&nbsp;<span class="op" id="6501289">:=</span>&nbsp;<span class="ident" id="6501292">w</span><span class="op" id="6501293">.</span><span class="ident" id="6501294">Flush</span><span class="op" id="6501299">(</span><span class="op" id="6501300">)</span><span class="op" id="6501301">;</span>&nbsp;<span class="ident" id="6501303">err</span>&nbsp;<span class="op" id="6501307">!=</span>&nbsp;<span class="ident" id="6501310">nil</span>&nbsp;<span class="op" id="6501314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501318">t</span><span class="op" id="6501319">.</span><span class="ident" id="6501320">Fatal</span><span class="op" id="6501325">(</span><span class="ident" id="6501326">err</span><span class="op" id="6501329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501335">if</span>&nbsp;<span class="ident" id="6501338">buf</span><span class="op" id="6501341">.</span><span class="ident" id="6501342">Len</span><span class="op" id="6501345">(</span><span class="op" id="6501346">)</span>&nbsp;<span class="op" id="6501348">==</span>&nbsp;<span class="num" id="6501351">0</span>&nbsp;<span class="op" id="6501353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501357">t</span><span class="op" id="6501358">.</span><span class="ident" id="6501359">Fatal</span><span class="op" id="6501364">(</span><span class="string" id="6501365">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="6501395">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501398">}</span><br>
<span class="lineno"></span><span class="op" id="6501400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6501403">func</span>&nbsp;<span class="ident" id="6501408">testCreate</span><span class="op" id="6501418">(</span><span class="ident" id="6501419">t</span>&nbsp;<span class="op" id="6501421">*</span><span class="ident" id="6501422">testing</span><span class="op" id="6501429">.</span><span class="ident" id="6501430">T</span><span class="op" id="6501431">,</span>&nbsp;<span class="ident" id="6501433">w</span>&nbsp;<span class="op" id="6501435">*</span><span class="ident" id="6501436">Writer</span><span class="op" id="6501442">,</span>&nbsp;<span class="ident" id="6501444">wt</span>&nbsp;<span class="op" id="6501447">*</span><span class="ident" id="6501448">WriteTest</span><span class="op" id="6501457">)</span>&nbsp;<span class="op" id="6501459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501462">header</span>&nbsp;<span class="op" id="6501469">:=</span>&nbsp;<span class="op" id="6501472">&amp;</span><span class="ident" id="6501473">FileHeader</span><span class="op" id="6501483">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501487">Name</span><span class="op" id="6501491">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6501495">wt</span><span class="op" id="6501497">.</span><span class="ident" id="6501498">Name</span><span class="op" id="6501502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501506">Method</span><span class="op" id="6501512">:</span>&nbsp;<span class="ident" id="6501514">wt</span><span class="op" id="6501516">.</span><span class="ident" id="6501517">Method</span><span class="op" id="6501523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501529">if</span>&nbsp;<span class="ident" id="6501532">wt</span><span class="op" id="6501534">.</span><span class="ident" id="6501535">Mode</span>&nbsp;<span class="op" id="6501540">!=</span>&nbsp;<span class="num" id="6501543">0</span>&nbsp;<span class="op" id="6501545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501549">header</span><span class="op" id="6501555">.</span><span class="ident" id="6501556">SetMode</span><span class="op" id="6501563">(</span><span class="ident" id="6501564">wt</span><span class="op" id="6501566">.</span><span class="ident" id="6501567">Mode</span><span class="op" id="6501571">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501577">f</span><span class="op" id="6501578">,</span>&nbsp;<span class="ident" id="6501580">err</span>&nbsp;<span class="op" id="6501584">:=</span>&nbsp;<span class="ident" id="6501587">w</span><span class="op" id="6501588">.</span><span class="ident" id="6501589">CreateHeader</span><span class="op" id="6501601">(</span><span class="ident" id="6501602">header</span><span class="op" id="6501608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501611">if</span>&nbsp;<span class="ident" id="6501614">err</span>&nbsp;<span class="op" id="6501618">!=</span>&nbsp;<span class="ident" id="6501621">nil</span>&nbsp;<span class="op" id="6501625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501629">t</span><span class="op" id="6501630">.</span><span class="ident" id="6501631">Fatal</span><span class="op" id="6501636">(</span><span class="ident" id="6501637">err</span><span class="op" id="6501640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501643">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501646">_</span><span class="op" id="6501647">,</span>&nbsp;<span class="ident" id="6501649">err</span>&nbsp;<span class="op" id="6501653">=</span>&nbsp;<span class="ident" id="6501655">f</span><span class="op" id="6501656">.</span><span class="ident" id="6501657">Write</span><span class="op" id="6501662">(</span><span class="ident" id="6501663">wt</span><span class="op" id="6501665">.</span><span class="ident" id="6501666">Data</span><span class="op" id="6501670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501673">if</span>&nbsp;<span class="ident" id="6501676">err</span>&nbsp;<span class="op" id="6501680">!=</span>&nbsp;<span class="ident" id="6501683">nil</span>&nbsp;<span class="op" id="6501687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501691">t</span><span class="op" id="6501692">.</span><span class="ident" id="6501693">Fatal</span><span class="op" id="6501698">(</span><span class="ident" id="6501699">err</span><span class="op" id="6501702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501705">}</span><br>
<span class="lineno"></span><span class="op" id="6501707">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6501710">func</span>&nbsp;<span class="ident" id="6501715">testReadFile</span><span class="op" id="6501727">(</span><span class="ident" id="6501728">t</span>&nbsp;<span class="op" id="6501730">*</span><span class="ident" id="6501731">testing</span><span class="op" id="6501738">.</span><span class="ident" id="6501739">T</span><span class="op" id="6501740">,</span>&nbsp;<span class="ident" id="6501742">f</span>&nbsp;<span class="op" id="6501744">*</span><span class="ident" id="6501745">File</span><span class="op" id="6501749">,</span>&nbsp;<span class="ident" id="6501751">wt</span>&nbsp;<span class="op" id="6501754">*</span><span class="ident" id="6501755">WriteTest</span><span class="op" id="6501764">)</span>&nbsp;<span class="op" id="6501766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501769">if</span>&nbsp;<span class="ident" id="6501772">f</span><span class="op" id="6501773">.</span><span class="ident" id="6501774">Name</span>&nbsp;<span class="op" id="6501779">!=</span>&nbsp;<span class="ident" id="6501782">wt</span><span class="op" id="6501784">.</span><span class="ident" id="6501785">Name</span>&nbsp;<span class="op" id="6501790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501794">t</span><span class="op" id="6501795">.</span><span class="ident" id="6501796">Fatalf</span><span class="op" id="6501802">(</span><span class="string" id="6501803">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6501831">,</span>&nbsp;<span class="ident" id="6501833">f</span><span class="op" id="6501834">.</span><span class="ident" id="6501835">Name</span><span class="op" id="6501839">,</span>&nbsp;<span class="ident" id="6501841">wt</span><span class="op" id="6501843">.</span><span class="ident" id="6501844">Name</span><span class="op" id="6501848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501851">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501854">testFileMode</span><span class="op" id="6501866">(</span><span class="ident" id="6501867">t</span><span class="op" id="6501868">,</span>&nbsp;<span class="ident" id="6501870">wt</span><span class="op" id="6501872">.</span><span class="ident" id="6501873">Name</span><span class="op" id="6501877">,</span>&nbsp;<span class="ident" id="6501879">f</span><span class="op" id="6501880">,</span>&nbsp;<span class="ident" id="6501882">wt</span><span class="op" id="6501884">.</span><span class="ident" id="6501885">Mode</span><span class="op" id="6501889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501892">rc</span><span class="op" id="6501894">,</span>&nbsp;<span class="ident" id="6501896">err</span>&nbsp;<span class="op" id="6501900">:=</span>&nbsp;<span class="ident" id="6501903">f</span><span class="op" id="6501904">.</span><span class="ident" id="6501905">Open</span><span class="op" id="6501909">(</span><span class="op" id="6501910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501913">if</span>&nbsp;<span class="ident" id="6501916">err</span>&nbsp;<span class="op" id="6501920">!=</span>&nbsp;<span class="ident" id="6501923">nil</span>&nbsp;<span class="op" id="6501927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501931">t</span><span class="op" id="6501932">.</span><span class="ident" id="6501933">Fatal</span><span class="op" id="6501938">(</span><span class="string" id="6501939">&#34;opening:&#34;</span><span class="op" id="6501949">,</span>&nbsp;<span class="ident" id="6501951">err</span><span class="op" id="6501954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501957">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501960">b</span><span class="op" id="6501961">,</span>&nbsp;<span class="ident" id="6501963">err</span>&nbsp;<span class="op" id="6501967">:=</span>&nbsp;<span class="ident" id="6501970">ioutil</span><span class="op" id="6501976">.</span><span class="ident" id="6501977">ReadAll</span><span class="op" id="6501984">(</span><span class="ident" id="6501985">rc</span><span class="op" id="6501987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501990">if</span>&nbsp;<span class="ident" id="6501993">err</span>&nbsp;<span class="op" id="6501997">!=</span>&nbsp;<span class="ident" id="6502000">nil</span>&nbsp;<span class="op" id="6502004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502008">t</span><span class="op" id="6502009">.</span><span class="ident" id="6502010">Fatal</span><span class="op" id="6502015">(</span><span class="string" id="6502016">&#34;reading:&#34;</span><span class="op" id="6502026">,</span>&nbsp;<span class="ident" id="6502028">err</span><span class="op" id="6502031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502037">err</span>&nbsp;<span class="op" id="6502041">=</span>&nbsp;<span class="ident" id="6502043">rc</span><span class="op" id="6502045">.</span><span class="ident" id="6502046">Close</span><span class="op" id="6502051">(</span><span class="op" id="6502052">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502055">if</span>&nbsp;<span class="ident" id="6502058">err</span>&nbsp;<span class="op" id="6502062">!=</span>&nbsp;<span class="ident" id="6502065">nil</span>&nbsp;<span class="op" id="6502069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502073">t</span><span class="op" id="6502074">.</span><span class="ident" id="6502075">Fatal</span><span class="op" id="6502080">(</span><span class="string" id="6502081">&#34;closing:&#34;</span><span class="op" id="6502091">,</span>&nbsp;<span class="ident" id="6502093">err</span><span class="op" id="6502096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502102">if</span>&nbsp;<span class="op" id="6502105">!</span><span class="ident" id="6502106">bytes</span><span class="op" id="6502111">.</span><span class="ident" id="6502112">Equal</span><span class="op" id="6502117">(</span><span class="ident" id="6502118">b</span><span class="op" id="6502119">,</span>&nbsp;<span class="ident" id="6502121">wt</span><span class="op" id="6502123">.</span><span class="ident" id="6502124">Data</span><span class="op" id="6502128">)</span>&nbsp;<span class="op" id="6502130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502134">t</span><span class="op" id="6502135">.</span><span class="ident" id="6502136">Errorf</span><span class="op" id="6502142">(</span><span class="string" id="6502143">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6502170">,</span>&nbsp;<span class="ident" id="6502172">b</span><span class="op" id="6502173">,</span>&nbsp;<span class="ident" id="6502175">wt</span><span class="op" id="6502177">.</span><span class="ident" id="6502178">Data</span><span class="op" id="6502182">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502185">}</span><br>
<span class="lineno"></span><span class="op" id="6502187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6502190">func</span>&nbsp;<span class="ident" id="6502195">BenchmarkCompressedZipGarbage</span><span class="op" id="6502224">(</span><span class="ident" id="6502225">b</span>&nbsp;<span class="op" id="6502227">*</span><span class="ident" id="6502228">testing</span><span class="op" id="6502235">.</span><span class="ident" id="6502236">B</span><span class="op" id="6502237">)</span>&nbsp;<span class="op" id="6502239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502242">b</span><span class="op" id="6502243">.</span><span class="ident" id="6502244">ReportAllocs</span><span class="op" id="6502256">(</span><span class="op" id="6502257">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502260">var</span>&nbsp;<span class="ident" id="6502264">buf</span>&nbsp;<span class="ident" id="6502268">bytes</span><span class="op" id="6502273">.</span><span class="ident" id="6502274">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502282">bigBuf</span>&nbsp;<span class="op" id="6502289">:=</span>&nbsp;<span class="ident" id="6502292">bytes</span><span class="op" id="6502297">.</span><span class="ident" id="6502298">Repeat</span><span class="op" id="6502304">(</span><span class="op" id="6502305">[</span><span class="op" id="6502306">]</span><span class="builtintype" id="6502307">byte</span><span class="op" id="6502311">(</span><span class="string" id="6502312">&#34;a&#34;</span><span class="op" id="6502315">)</span><span class="op" id="6502316">,</span>&nbsp;<span class="num" id="6502318">1</span><span class="op" id="6502319">&lt;&lt;</span><span class="num" id="6502321">20</span><span class="op" id="6502323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502326">for</span>&nbsp;<span class="ident" id="6502330">i</span>&nbsp;<span class="op" id="6502332">:=</span>&nbsp;<span class="num" id="6502335">0</span><span class="op" id="6502336">;</span>&nbsp;<span class="ident" id="6502338">i</span>&nbsp;<span class="op" id="6502340">&lt;</span>&nbsp;<span class="ident" id="6502342">b</span><span class="op" id="6502343">.</span><span class="ident" id="6502344">N</span><span class="op" id="6502345">;</span>&nbsp;<span class="ident" id="6502347">i</span><span class="op" id="6502348">++</span>&nbsp;<span class="op" id="6502351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502355">buf</span><span class="op" id="6502358">.</span><span class="ident" id="6502359">Reset</span><span class="op" id="6502364">(</span><span class="op" id="6502365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502369">zw</span>&nbsp;<span class="op" id="6502372">:=</span>&nbsp;<span class="ident" id="6502375">NewWriter</span><span class="op" id="6502384">(</span><span class="op" id="6502385">&amp;</span><span class="ident" id="6502386">buf</span><span class="op" id="6502389">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502393">for</span>&nbsp;<span class="ident" id="6502397">j</span>&nbsp;<span class="op" id="6502399">:=</span>&nbsp;<span class="num" id="6502402">0</span><span class="op" id="6502403">;</span>&nbsp;<span class="ident" id="6502405">j</span>&nbsp;<span class="op" id="6502407">&lt;</span>&nbsp;<span class="num" id="6502409">3</span><span class="op" id="6502410">;</span>&nbsp;<span class="ident" id="6502412">j</span><span class="op" id="6502413">++</span>&nbsp;<span class="op" id="6502416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502421">w</span><span class="op" id="6502422">,</span>&nbsp;<span class="ident" id="6502424">_</span>&nbsp;<span class="op" id="6502426">:=</span>&nbsp;<span class="ident" id="6502429">zw</span><span class="op" id="6502431">.</span><span class="ident" id="6502432">CreateHeader</span><span class="op" id="6502444">(</span><span class="op" id="6502445">&amp;</span><span class="ident" id="6502446">FileHeader</span><span class="op" id="6502456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502462">Name</span><span class="op" id="6502466">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6502470">&#34;foo&#34;</span><span class="op" id="6502475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502481">Method</span><span class="op" id="6502487">:</span>&nbsp;<span class="ident" id="6502489">Deflate</span><span class="op" id="6502496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502501">}</span><span class="op" id="6502502">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502507">w</span><span class="op" id="6502508">.</span><span class="ident" id="6502509">Write</span><span class="op" id="6502514">(</span><span class="ident" id="6502515">bigBuf</span><span class="op" id="6502521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502529">zw</span><span class="op" id="6502531">.</span><span class="ident" id="6502532">Close</span><span class="op" id="6502537">(</span><span class="op" id="6502538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502541">}</span><br>
<span class="lineno"></span><span class="op" id="6502543">}</span>
</div>
</body>
</html>
