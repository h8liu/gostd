<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3084243">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3084299">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3084353">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3084404">package</span>&nbsp;<span class="ident" id="3084412">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3084417">import</span>&nbsp;<span class="op" id="3084424">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3084427">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3084433">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3084444">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3084453">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3084456">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3084522">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3084591">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3084605">func</span>&nbsp;<span class="ident" id="3084610">interfaceTable</span><span class="op" id="3084624">(</span><span class="ident" id="3084625">ifindex</span>&nbsp;<span class="builtintype" id="3084633">int</span><span class="op" id="3084636">)</span>&nbsp;<span class="op" id="3084638">(</span><span class="op" id="3084639">[</span><span class="op" id="3084640">]</span><span class="ident" id="3084641">Interface</span><span class="op" id="3084650">,</span>&nbsp;<span class="builtintype" id="3084652">error</span><span class="op" id="3084657">)</span>&nbsp;<span class="op" id="3084659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084662">tab</span><span class="op" id="3084665">,</span>&nbsp;<span class="ident" id="3084667">err</span>&nbsp;<span class="op" id="3084671">:=</span>&nbsp;<span class="ident" id="3084674">syscall</span><span class="op" id="3084681">.</span><span class="ident" id="3084682">NetlinkRIB</span><span class="op" id="3084692">(</span><span class="ident" id="3084693">syscall</span><span class="op" id="3084700">.</span><span class="ident" id="3084701">RTM_GETLINK</span><span class="op" id="3084712">,</span>&nbsp;<span class="ident" id="3084714">syscall</span><span class="op" id="3084721">.</span><span class="ident" id="3084722">AF_UNSPEC</span><span class="op" id="3084731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084734">if</span>&nbsp;<span class="ident" id="3084737">err</span>&nbsp;<span class="op" id="3084741">!=</span>&nbsp;<span class="ident" id="3084744">nil</span>&nbsp;<span class="op" id="3084748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084752">return</span>&nbsp;<span class="ident" id="3084759">nil</span><span class="op" id="3084762">,</span>&nbsp;<span class="ident" id="3084764">os</span><span class="op" id="3084766">.</span><span class="ident" id="3084767">NewSyscallError</span><span class="op" id="3084782">(</span><span class="string" id="3084783">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3084796">,</span>&nbsp;<span class="ident" id="3084798">err</span><span class="op" id="3084801">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084807">msgs</span><span class="op" id="3084811">,</span>&nbsp;<span class="ident" id="3084813">err</span>&nbsp;<span class="op" id="3084817">:=</span>&nbsp;<span class="ident" id="3084820">syscall</span><span class="op" id="3084827">.</span><span class="ident" id="3084828">ParseNetlinkMessage</span><span class="op" id="3084847">(</span><span class="ident" id="3084848">tab</span><span class="op" id="3084851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084854">if</span>&nbsp;<span class="ident" id="3084857">err</span>&nbsp;<span class="op" id="3084861">!=</span>&nbsp;<span class="ident" id="3084864">nil</span>&nbsp;<span class="op" id="3084868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084872">return</span>&nbsp;<span class="ident" id="3084879">nil</span><span class="op" id="3084882">,</span>&nbsp;<span class="ident" id="3084884">os</span><span class="op" id="3084886">.</span><span class="ident" id="3084887">NewSyscallError</span><span class="op" id="3084902">(</span><span class="string" id="3084903">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3084920">,</span>&nbsp;<span class="ident" id="3084922">err</span><span class="op" id="3084925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084928">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084931">var</span>&nbsp;<span class="ident" id="3084935">ift</span>&nbsp;<span class="op" id="3084939">[</span><span class="op" id="3084940">]</span><span class="ident" id="3084941">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3084951">loop</span><span class="op" id="3084955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084958">for</span>&nbsp;<span class="ident" id="3084962">_</span><span class="op" id="3084963">,</span>&nbsp;<span class="ident" id="3084965">m</span>&nbsp;<span class="op" id="3084967">:=</span>&nbsp;<span class="keyword" id="3084970">range</span>&nbsp;<span class="ident" id="3084976">msgs</span>&nbsp;<span class="op" id="3084981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084985">switch</span>&nbsp;<span class="ident" id="3084992">m</span><span class="op" id="3084993">.</span><span class="ident" id="3084994">Header</span><span class="op" id="3085000">.</span><span class="ident" id="3085001">Type</span>&nbsp;<span class="op" id="3085006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085010">case</span>&nbsp;<span class="ident" id="3085015">syscall</span><span class="op" id="3085022">.</span><span class="ident" id="3085023">NLMSG_DONE</span><span class="op" id="3085033">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085038">break</span>&nbsp;<span class="ident" id="3085044">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085051">case</span>&nbsp;<span class="ident" id="3085056">syscall</span><span class="op" id="3085063">.</span><span class="ident" id="3085064">RTM_NEWLINK</span><span class="op" id="3085075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085080">ifim</span>&nbsp;<span class="op" id="3085085">:=</span>&nbsp;<span class="op" id="3085088">(</span><span class="op" id="3085089">*</span><span class="ident" id="3085090">syscall</span><span class="op" id="3085097">.</span><span class="ident" id="3085098">IfInfomsg</span><span class="op" id="3085107">)</span><span class="op" id="3085108">(</span><span class="ident" id="3085109">unsafe</span><span class="op" id="3085115">.</span><span class="ident" id="3085116">Pointer</span><span class="op" id="3085123">(</span><span class="op" id="3085124">&amp;</span><span class="ident" id="3085125">m</span><span class="op" id="3085126">.</span><span class="ident" id="3085127">Data</span><span class="op" id="3085131">[</span><span class="num" id="3085132">0</span><span class="op" id="3085133">]</span><span class="op" id="3085134">)</span><span class="op" id="3085135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085140">if</span>&nbsp;<span class="ident" id="3085143">ifindex</span>&nbsp;<span class="op" id="3085151">==</span>&nbsp;<span class="num" id="3085154">0</span>&nbsp;<span class="op" id="3085156">||</span>&nbsp;<span class="ident" id="3085159">ifindex</span>&nbsp;<span class="op" id="3085167">==</span>&nbsp;<span class="builtintype" id="3085170">int</span><span class="op" id="3085173">(</span><span class="ident" id="3085174">ifim</span><span class="op" id="3085178">.</span><span class="ident" id="3085179">Index</span><span class="op" id="3085184">)</span>&nbsp;<span class="op" id="3085186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085192">attrs</span><span class="op" id="3085197">,</span>&nbsp;<span class="ident" id="3085199">err</span>&nbsp;<span class="op" id="3085203">:=</span>&nbsp;<span class="ident" id="3085206">syscall</span><span class="op" id="3085213">.</span><span class="ident" id="3085214">ParseNetlinkRouteAttr</span><span class="op" id="3085235">(</span><span class="op" id="3085236">&amp;</span><span class="ident" id="3085237">m</span><span class="op" id="3085238">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085244">if</span>&nbsp;<span class="ident" id="3085247">err</span>&nbsp;<span class="op" id="3085251">!=</span>&nbsp;<span class="ident" id="3085254">nil</span>&nbsp;<span class="op" id="3085258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085265">return</span>&nbsp;<span class="ident" id="3085272">nil</span><span class="op" id="3085275">,</span>&nbsp;<span class="ident" id="3085277">os</span><span class="op" id="3085279">.</span><span class="ident" id="3085280">NewSyscallError</span><span class="op" id="3085295">(</span><span class="string" id="3085296">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3085315">,</span>&nbsp;<span class="ident" id="3085317">err</span><span class="op" id="3085320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085332">ift</span>&nbsp;<span class="op" id="3085336">=</span>&nbsp;<span class="builtinfunc" id="3085338">append</span><span class="op" id="3085344">(</span><span class="ident" id="3085345">ift</span><span class="op" id="3085348">,</span>&nbsp;<span class="op" id="3085350">*</span><span class="ident" id="3085351">newLink</span><span class="op" id="3085358">(</span><span class="ident" id="3085359">ifim</span><span class="op" id="3085363">,</span>&nbsp;<span class="ident" id="3085365">attrs</span><span class="op" id="3085370">)</span><span class="op" id="3085371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085377">if</span>&nbsp;<span class="ident" id="3085380">ifindex</span>&nbsp;<span class="op" id="3085388">==</span>&nbsp;<span class="builtintype" id="3085391">int</span><span class="op" id="3085394">(</span><span class="ident" id="3085395">ifim</span><span class="op" id="3085399">.</span><span class="ident" id="3085400">Index</span><span class="op" id="3085405">)</span>&nbsp;<span class="op" id="3085407">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085414">break</span>&nbsp;<span class="ident" id="3085420">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085441">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085444">return</span>&nbsp;<span class="ident" id="3085451">ift</span><span class="op" id="3085454">,</span>&nbsp;<span class="ident" id="3085456">nil</span><br>
<span class="lineno"></span><span class="op" id="3085460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3085463">const</span>&nbsp;<span class="op" id="3085469">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3085472">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3085496">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085558">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3085581">=</span>&nbsp;<span class="num" id="3085583">768</span>&nbsp;<span class="comment" id="3085587">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085616">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3085639">=</span>&nbsp;<span class="num" id="3085641">769</span>&nbsp;<span class="comment" id="3085645">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085674">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3085697">=</span>&nbsp;<span class="num" id="3085699">776</span>&nbsp;<span class="comment" id="3085703">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085732">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3085755">=</span>&nbsp;<span class="num" id="3085757">778</span>&nbsp;<span class="comment" id="3085761">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085798">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3085821">=</span>&nbsp;<span class="num" id="3085823">823</span>&nbsp;<span class="comment" id="3085827">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3085863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3085866">func</span>&nbsp;<span class="ident" id="3085871">newLink</span><span class="op" id="3085878">(</span><span class="ident" id="3085879">ifim</span>&nbsp;<span class="op" id="3085884">*</span><span class="ident" id="3085885">syscall</span><span class="op" id="3085892">.</span><span class="ident" id="3085893">IfInfomsg</span><span class="op" id="3085902">,</span>&nbsp;<span class="ident" id="3085904">attrs</span>&nbsp;<span class="op" id="3085910">[</span><span class="op" id="3085911">]</span><span class="ident" id="3085912">syscall</span><span class="op" id="3085919">.</span><span class="ident" id="3085920">NetlinkRouteAttr</span><span class="op" id="3085936">)</span>&nbsp;<span class="op" id="3085938">*</span><span class="ident" id="3085939">Interface</span>&nbsp;<span class="op" id="3085949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085952">ifi</span>&nbsp;<span class="op" id="3085956">:=</span>&nbsp;<span class="op" id="3085959">&amp;</span><span class="ident" id="3085960">Interface</span><span class="op" id="3085969">{</span><span class="ident" id="3085970">Index</span><span class="op" id="3085975">:</span>&nbsp;<span class="builtintype" id="3085977">int</span><span class="op" id="3085980">(</span><span class="ident" id="3085981">ifim</span><span class="op" id="3085985">.</span><span class="ident" id="3085986">Index</span><span class="op" id="3085991">)</span><span class="op" id="3085992">,</span>&nbsp;<span class="ident" id="3085994">Flags</span><span class="op" id="3085999">:</span>&nbsp;<span class="ident" id="3086001">linkFlags</span><span class="op" id="3086010">(</span><span class="ident" id="3086011">ifim</span><span class="op" id="3086015">.</span><span class="ident" id="3086016">Flags</span><span class="op" id="3086021">)</span><span class="op" id="3086022">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086025">for</span>&nbsp;<span class="ident" id="3086029">_</span><span class="op" id="3086030">,</span>&nbsp;<span class="ident" id="3086032">a</span>&nbsp;<span class="op" id="3086034">:=</span>&nbsp;<span class="keyword" id="3086037">range</span>&nbsp;<span class="ident" id="3086043">attrs</span>&nbsp;<span class="op" id="3086049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086053">switch</span>&nbsp;<span class="ident" id="3086060">a</span><span class="op" id="3086061">.</span><span class="ident" id="3086062">Attr</span><span class="op" id="3086066">.</span><span class="ident" id="3086067">Type</span>&nbsp;<span class="op" id="3086072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086076">case</span>&nbsp;<span class="ident" id="3086081">syscall</span><span class="op" id="3086088">.</span><span class="ident" id="3086089">IFLA_ADDRESS</span><span class="op" id="3086101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3086106">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3086155">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3086202">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086226">switch</span>&nbsp;<span class="builtinfunc" id="3086233">len</span><span class="op" id="3086236">(</span><span class="ident" id="3086237">a</span><span class="op" id="3086238">.</span><span class="ident" id="3086239">Value</span><span class="op" id="3086244">)</span>&nbsp;<span class="op" id="3086246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086251">case</span>&nbsp;<span class="ident" id="3086256">IPv4len</span><span class="op" id="3086263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086269">switch</span>&nbsp;<span class="ident" id="3086276">ifim</span><span class="op" id="3086280">.</span><span class="ident" id="3086281">Type</span>&nbsp;<span class="op" id="3086286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086292">case</span>&nbsp;<span class="ident" id="3086297">sysARPHardwareIPv4IPv4</span><span class="op" id="3086319">,</span>&nbsp;<span class="ident" id="3086321">sysARPHardwareGREIPv4</span><span class="op" id="3086342">,</span>&nbsp;<span class="ident" id="3086344">sysARPHardwareIPv6IPv4</span><span class="op" id="3086366">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086373">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086391">case</span>&nbsp;<span class="ident" id="3086396">IPv6len</span><span class="op" id="3086403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086409">switch</span>&nbsp;<span class="ident" id="3086416">ifim</span><span class="op" id="3086420">.</span><span class="ident" id="3086421">Type</span>&nbsp;<span class="op" id="3086426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086432">case</span>&nbsp;<span class="ident" id="3086437">sysARPHardwareIPv6IPv6</span><span class="op" id="3086459">,</span>&nbsp;<span class="ident" id="3086461">sysARPHardwareGREIPv6</span><span class="op" id="3086482">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086489">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086512">var</span>&nbsp;<span class="ident" id="3086516">nonzero</span>&nbsp;<span class="builtintype" id="3086524">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086532">for</span>&nbsp;<span class="ident" id="3086536">_</span><span class="op" id="3086537">,</span>&nbsp;<span class="ident" id="3086539">b</span>&nbsp;<span class="op" id="3086541">:=</span>&nbsp;<span class="keyword" id="3086544">range</span>&nbsp;<span class="ident" id="3086550">a</span><span class="op" id="3086551">.</span><span class="ident" id="3086552">Value</span>&nbsp;<span class="op" id="3086558">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086564">if</span>&nbsp;<span class="ident" id="3086567">b</span>&nbsp;<span class="op" id="3086569">!=</span>&nbsp;<span class="num" id="3086572">0</span>&nbsp;<span class="op" id="3086574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086581">nonzero</span>&nbsp;<span class="op" id="3086589">=</span>&nbsp;<span class="builtintype" id="3086591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086601">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086616">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086621">if</span>&nbsp;<span class="ident" id="3086624">nonzero</span>&nbsp;<span class="op" id="3086632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086638">ifi</span><span class="op" id="3086641">.</span><span class="ident" id="3086642">HardwareAddr</span>&nbsp;<span class="op" id="3086655">=</span>&nbsp;<span class="ident" id="3086657">a</span><span class="op" id="3086658">.</span><span class="ident" id="3086659">Value</span><span class="op" id="3086664">[</span><span class="op" id="3086665">:</span><span class="op" id="3086666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086675">case</span>&nbsp;<span class="ident" id="3086680">syscall</span><span class="op" id="3086687">.</span><span class="ident" id="3086688">IFLA_IFNAME</span><span class="op" id="3086699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086704">ifi</span><span class="op" id="3086707">.</span><span class="ident" id="3086708">Name</span>&nbsp;<span class="op" id="3086713">=</span>&nbsp;<span class="builtintype" id="3086715">string</span><span class="op" id="3086721">(</span><span class="ident" id="3086722">a</span><span class="op" id="3086723">.</span><span class="ident" id="3086724">Value</span><span class="op" id="3086729">[</span><span class="op" id="3086730">:</span><span class="builtinfunc" id="3086731">len</span><span class="op" id="3086734">(</span><span class="ident" id="3086735">a</span><span class="op" id="3086736">.</span><span class="ident" id="3086737">Value</span><span class="op" id="3086742">)</span><span class="op" id="3086743">-</span><span class="num" id="3086744">1</span><span class="op" id="3086745">]</span><span class="op" id="3086746">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086750">case</span>&nbsp;<span class="ident" id="3086755">syscall</span><span class="op" id="3086762">.</span><span class="ident" id="3086763">IFLA_MTU</span><span class="op" id="3086771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086776">ifi</span><span class="op" id="3086779">.</span><span class="ident" id="3086780">MTU</span>&nbsp;<span class="op" id="3086784">=</span>&nbsp;<span class="builtintype" id="3086786">int</span><span class="op" id="3086789">(</span><span class="op" id="3086790">*</span><span class="op" id="3086791">(</span><span class="op" id="3086792">*</span><span class="builtintype" id="3086793">uint32</span><span class="op" id="3086799">)</span><span class="op" id="3086800">(</span><span class="ident" id="3086801">unsafe</span><span class="op" id="3086807">.</span><span class="ident" id="3086808">Pointer</span><span class="op" id="3086815">(</span><span class="op" id="3086816">&amp;</span><span class="ident" id="3086817">a</span><span class="op" id="3086818">.</span><span class="ident" id="3086819">Value</span><span class="op" id="3086824">[</span><span class="op" id="3086825">:</span><span class="num" id="3086826">4</span><span class="op" id="3086827">]</span><span class="op" id="3086828">[</span><span class="num" id="3086829">0</span><span class="op" id="3086830">]</span><span class="op" id="3086831">)</span><span class="op" id="3086832">)</span><span class="op" id="3086833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086843">return</span>&nbsp;<span class="ident" id="3086850">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3086854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086857">func</span>&nbsp;<span class="ident" id="3086862">linkFlags</span><span class="op" id="3086871">(</span><span class="ident" id="3086872">rawFlags</span>&nbsp;<span class="builtintype" id="3086881">uint32</span><span class="op" id="3086887">)</span>&nbsp;<span class="ident" id="3086889">Flags</span>&nbsp;<span class="op" id="3086895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086898">var</span>&nbsp;<span class="ident" id="3086902">f</span>&nbsp;<span class="ident" id="3086904">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086911">if</span>&nbsp;<span class="ident" id="3086914">rawFlags</span><span class="op" id="3086922">&amp;</span><span class="ident" id="3086923">syscall</span><span class="op" id="3086930">.</span><span class="ident" id="3086931">IFF_UP</span>&nbsp;<span class="op" id="3086938">!=</span>&nbsp;<span class="num" id="3086941">0</span>&nbsp;<span class="op" id="3086943">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086947">f</span>&nbsp;<span class="op" id="3086949">|=</span>&nbsp;<span class="ident" id="3086952">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086963">if</span>&nbsp;<span class="ident" id="3086966">rawFlags</span><span class="op" id="3086974">&amp;</span><span class="ident" id="3086975">syscall</span><span class="op" id="3086982">.</span><span class="ident" id="3086983">IFF_BROADCAST</span>&nbsp;<span class="op" id="3086997">!=</span>&nbsp;<span class="num" id="3087000">0</span>&nbsp;<span class="op" id="3087002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087006">f</span>&nbsp;<span class="op" id="3087008">|=</span>&nbsp;<span class="ident" id="3087011">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087026">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087029">if</span>&nbsp;<span class="ident" id="3087032">rawFlags</span><span class="op" id="3087040">&amp;</span><span class="ident" id="3087041">syscall</span><span class="op" id="3087048">.</span><span class="ident" id="3087049">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3087062">!=</span>&nbsp;<span class="num" id="3087065">0</span>&nbsp;<span class="op" id="3087067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087071">f</span>&nbsp;<span class="op" id="3087073">|=</span>&nbsp;<span class="ident" id="3087076">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087093">if</span>&nbsp;<span class="ident" id="3087096">rawFlags</span><span class="op" id="3087104">&amp;</span><span class="ident" id="3087105">syscall</span><span class="op" id="3087112">.</span><span class="ident" id="3087113">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3087129">!=</span>&nbsp;<span class="num" id="3087132">0</span>&nbsp;<span class="op" id="3087134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087138">f</span>&nbsp;<span class="op" id="3087140">|=</span>&nbsp;<span class="ident" id="3087143">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087164">if</span>&nbsp;<span class="ident" id="3087167">rawFlags</span><span class="op" id="3087175">&amp;</span><span class="ident" id="3087176">syscall</span><span class="op" id="3087183">.</span><span class="ident" id="3087184">IFF_MULTICAST</span>&nbsp;<span class="op" id="3087198">!=</span>&nbsp;<span class="num" id="3087201">0</span>&nbsp;<span class="op" id="3087203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087207">f</span>&nbsp;<span class="op" id="3087209">|=</span>&nbsp;<span class="ident" id="3087212">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087230">return</span>&nbsp;<span class="ident" id="3087237">f</span><br>
<span class="lineno">115</span><span class="op" id="3087239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3087242">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3087309">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3087379">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3087393">func</span>&nbsp;<span class="ident" id="3087398">interfaceAddrTable</span><span class="op" id="3087416">(</span><span class="ident" id="3087417">ifi</span>&nbsp;<span class="op" id="3087421">*</span><span class="ident" id="3087422">Interface</span><span class="op" id="3087431">)</span>&nbsp;<span class="op" id="3087433">(</span><span class="op" id="3087434">[</span><span class="op" id="3087435">]</span><span class="ident" id="3087436">Addr</span><span class="op" id="3087440">,</span>&nbsp;<span class="builtintype" id="3087442">error</span><span class="op" id="3087447">)</span>&nbsp;<span class="op" id="3087449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087452">tab</span><span class="op" id="3087455">,</span>&nbsp;<span class="ident" id="3087457">err</span>&nbsp;<span class="op" id="3087461">:=</span>&nbsp;<span class="ident" id="3087464">syscall</span><span class="op" id="3087471">.</span><span class="ident" id="3087472">NetlinkRIB</span><span class="op" id="3087482">(</span><span class="ident" id="3087483">syscall</span><span class="op" id="3087490">.</span><span class="ident" id="3087491">RTM_GETADDR</span><span class="op" id="3087502">,</span>&nbsp;<span class="ident" id="3087504">syscall</span><span class="op" id="3087511">.</span><span class="ident" id="3087512">AF_UNSPEC</span><span class="op" id="3087521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087524">if</span>&nbsp;<span class="ident" id="3087527">err</span>&nbsp;<span class="op" id="3087531">!=</span>&nbsp;<span class="ident" id="3087534">nil</span>&nbsp;<span class="op" id="3087538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087542">return</span>&nbsp;<span class="ident" id="3087549">nil</span><span class="op" id="3087552">,</span>&nbsp;<span class="ident" id="3087554">os</span><span class="op" id="3087556">.</span><span class="ident" id="3087557">NewSyscallError</span><span class="op" id="3087572">(</span><span class="string" id="3087573">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3087586">,</span>&nbsp;<span class="ident" id="3087588">err</span><span class="op" id="3087591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087594">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087597">msgs</span><span class="op" id="3087601">,</span>&nbsp;<span class="ident" id="3087603">err</span>&nbsp;<span class="op" id="3087607">:=</span>&nbsp;<span class="ident" id="3087610">syscall</span><span class="op" id="3087617">.</span><span class="ident" id="3087618">ParseNetlinkMessage</span><span class="op" id="3087637">(</span><span class="ident" id="3087638">tab</span><span class="op" id="3087641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087644">if</span>&nbsp;<span class="ident" id="3087647">err</span>&nbsp;<span class="op" id="3087651">!=</span>&nbsp;<span class="ident" id="3087654">nil</span>&nbsp;<span class="op" id="3087658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087662">return</span>&nbsp;<span class="ident" id="3087669">nil</span><span class="op" id="3087672">,</span>&nbsp;<span class="ident" id="3087674">os</span><span class="op" id="3087676">.</span><span class="ident" id="3087677">NewSyscallError</span><span class="op" id="3087692">(</span><span class="string" id="3087693">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3087710">,</span>&nbsp;<span class="ident" id="3087712">err</span><span class="op" id="3087715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087721">var</span>&nbsp;<span class="ident" id="3087725">ift</span>&nbsp;<span class="op" id="3087729">[</span><span class="op" id="3087730">]</span><span class="ident" id="3087731">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087742">if</span>&nbsp;<span class="ident" id="3087745">ifi</span>&nbsp;<span class="op" id="3087749">==</span>&nbsp;<span class="ident" id="3087752">nil</span>&nbsp;<span class="op" id="3087756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087760">var</span>&nbsp;<span class="ident" id="3087764">err</span>&nbsp;<span class="builtintype" id="3087768">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087776">ift</span><span class="op" id="3087779">,</span>&nbsp;<span class="ident" id="3087781">err</span>&nbsp;<span class="op" id="3087785">=</span>&nbsp;<span class="ident" id="3087787">interfaceTable</span><span class="op" id="3087801">(</span><span class="num" id="3087802">0</span><span class="op" id="3087803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087807">if</span>&nbsp;<span class="ident" id="3087810">err</span>&nbsp;<span class="op" id="3087814">!=</span>&nbsp;<span class="ident" id="3087817">nil</span>&nbsp;<span class="op" id="3087821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087826">return</span>&nbsp;<span class="ident" id="3087833">nil</span><span class="op" id="3087836">,</span>&nbsp;<span class="ident" id="3087838">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087850">ifat</span><span class="op" id="3087854">,</span>&nbsp;<span class="ident" id="3087856">err</span>&nbsp;<span class="op" id="3087860">:=</span>&nbsp;<span class="ident" id="3087863">addrTable</span><span class="op" id="3087872">(</span><span class="ident" id="3087873">ift</span><span class="op" id="3087876">,</span>&nbsp;<span class="ident" id="3087878">ifi</span><span class="op" id="3087881">,</span>&nbsp;<span class="ident" id="3087883">msgs</span><span class="op" id="3087887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087890">if</span>&nbsp;<span class="ident" id="3087893">err</span>&nbsp;<span class="op" id="3087897">!=</span>&nbsp;<span class="ident" id="3087900">nil</span>&nbsp;<span class="op" id="3087904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087908">return</span>&nbsp;<span class="ident" id="3087915">nil</span><span class="op" id="3087918">,</span>&nbsp;<span class="ident" id="3087920">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087928">return</span>&nbsp;<span class="ident" id="3087935">ifat</span><span class="op" id="3087939">,</span>&nbsp;<span class="ident" id="3087941">nil</span><br>
<span class="lineno"></span><span class="op" id="3087945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3087948">func</span>&nbsp;<span class="ident" id="3087953">addrTable</span><span class="op" id="3087962">(</span><span class="ident" id="3087963">ift</span>&nbsp;<span class="op" id="3087967">[</span><span class="op" id="3087968">]</span><span class="ident" id="3087969">Interface</span><span class="op" id="3087978">,</span>&nbsp;<span class="ident" id="3087980">ifi</span>&nbsp;<span class="op" id="3087984">*</span><span class="ident" id="3087985">Interface</span><span class="op" id="3087994">,</span>&nbsp;<span class="ident" id="3087996">msgs</span>&nbsp;<span class="op" id="3088001">[</span><span class="op" id="3088002">]</span><span class="ident" id="3088003">syscall</span><span class="op" id="3088010">.</span><span class="ident" id="3088011">NetlinkMessage</span><span class="op" id="3088025">)</span>&nbsp;<span class="op" id="3088027">(</span><span class="op" id="3088028">[</span><span class="op" id="3088029">]</span><span class="ident" id="3088030">Addr</span><span class="op" id="3088034">,</span>&nbsp;<span class="builtintype" id="3088036">error</span><span class="op" id="3088041">)</span>&nbsp;<span class="op" id="3088043">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088046">var</span>&nbsp;<span class="ident" id="3088050">ifat</span>&nbsp;<span class="op" id="3088055">[</span><span class="op" id="3088056">]</span><span class="ident" id="3088057">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3088062">loop</span><span class="op" id="3088066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088069">for</span>&nbsp;<span class="ident" id="3088073">_</span><span class="op" id="3088074">,</span>&nbsp;<span class="ident" id="3088076">m</span>&nbsp;<span class="op" id="3088078">:=</span>&nbsp;<span class="keyword" id="3088081">range</span>&nbsp;<span class="ident" id="3088087">msgs</span>&nbsp;<span class="op" id="3088092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088096">switch</span>&nbsp;<span class="ident" id="3088103">m</span><span class="op" id="3088104">.</span><span class="ident" id="3088105">Header</span><span class="op" id="3088111">.</span><span class="ident" id="3088112">Type</span>&nbsp;<span class="op" id="3088117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088121">case</span>&nbsp;<span class="ident" id="3088126">syscall</span><span class="op" id="3088133">.</span><span class="ident" id="3088134">NLMSG_DONE</span><span class="op" id="3088144">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088149">break</span>&nbsp;<span class="ident" id="3088155">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088162">case</span>&nbsp;<span class="ident" id="3088167">syscall</span><span class="op" id="3088174">.</span><span class="ident" id="3088175">RTM_NEWADDR</span><span class="op" id="3088186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088191">ifam</span>&nbsp;<span class="op" id="3088196">:=</span>&nbsp;<span class="op" id="3088199">(</span><span class="op" id="3088200">*</span><span class="ident" id="3088201">syscall</span><span class="op" id="3088208">.</span><span class="ident" id="3088209">IfAddrmsg</span><span class="op" id="3088218">)</span><span class="op" id="3088219">(</span><span class="ident" id="3088220">unsafe</span><span class="op" id="3088226">.</span><span class="ident" id="3088227">Pointer</span><span class="op" id="3088234">(</span><span class="op" id="3088235">&amp;</span><span class="ident" id="3088236">m</span><span class="op" id="3088237">.</span><span class="ident" id="3088238">Data</span><span class="op" id="3088242">[</span><span class="num" id="3088243">0</span><span class="op" id="3088244">]</span><span class="op" id="3088245">)</span><span class="op" id="3088246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088251">if</span>&nbsp;<span class="builtinfunc" id="3088254">len</span><span class="op" id="3088257">(</span><span class="ident" id="3088258">ift</span><span class="op" id="3088261">)</span>&nbsp;<span class="op" id="3088263">!=</span>&nbsp;<span class="num" id="3088266">0</span>&nbsp;<span class="op" id="3088268">||</span>&nbsp;<span class="ident" id="3088271">ifi</span><span class="op" id="3088274">.</span><span class="ident" id="3088275">Index</span>&nbsp;<span class="op" id="3088281">==</span>&nbsp;<span class="builtintype" id="3088284">int</span><span class="op" id="3088287">(</span><span class="ident" id="3088288">ifam</span><span class="op" id="3088292">.</span><span class="ident" id="3088293">Index</span><span class="op" id="3088298">)</span>&nbsp;<span class="op" id="3088300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088306">if</span>&nbsp;<span class="builtinfunc" id="3088309">len</span><span class="op" id="3088312">(</span><span class="ident" id="3088313">ift</span><span class="op" id="3088316">)</span>&nbsp;<span class="op" id="3088318">!=</span>&nbsp;<span class="num" id="3088321">0</span>&nbsp;<span class="op" id="3088323">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088330">var</span>&nbsp;<span class="ident" id="3088334">err</span>&nbsp;<span class="builtintype" id="3088338">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088349">ifi</span><span class="op" id="3088352">,</span>&nbsp;<span class="ident" id="3088354">err</span>&nbsp;<span class="op" id="3088358">=</span>&nbsp;<span class="ident" id="3088360">interfaceByIndex</span><span class="op" id="3088376">(</span><span class="ident" id="3088377">ift</span><span class="op" id="3088380">,</span>&nbsp;<span class="builtintype" id="3088382">int</span><span class="op" id="3088385">(</span><span class="ident" id="3088386">ifam</span><span class="op" id="3088390">.</span><span class="ident" id="3088391">Index</span><span class="op" id="3088396">)</span><span class="op" id="3088397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088404">if</span>&nbsp;<span class="ident" id="3088407">err</span>&nbsp;<span class="op" id="3088411">!=</span>&nbsp;<span class="ident" id="3088414">nil</span>&nbsp;<span class="op" id="3088418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088426">return</span>&nbsp;<span class="ident" id="3088433">nil</span><span class="op" id="3088436">,</span>&nbsp;<span class="ident" id="3088438">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088447">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088459">attrs</span><span class="op" id="3088464">,</span>&nbsp;<span class="ident" id="3088466">err</span>&nbsp;<span class="op" id="3088470">:=</span>&nbsp;<span class="ident" id="3088473">syscall</span><span class="op" id="3088480">.</span><span class="ident" id="3088481">ParseNetlinkRouteAttr</span><span class="op" id="3088502">(</span><span class="op" id="3088503">&amp;</span><span class="ident" id="3088504">m</span><span class="op" id="3088505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088511">if</span>&nbsp;<span class="ident" id="3088514">err</span>&nbsp;<span class="op" id="3088518">!=</span>&nbsp;<span class="ident" id="3088521">nil</span>&nbsp;<span class="op" id="3088525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088532">return</span>&nbsp;<span class="ident" id="3088539">nil</span><span class="op" id="3088542">,</span>&nbsp;<span class="ident" id="3088544">os</span><span class="op" id="3088546">.</span><span class="ident" id="3088547">NewSyscallError</span><span class="op" id="3088562">(</span><span class="string" id="3088563">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3088582">,</span>&nbsp;<span class="ident" id="3088584">err</span><span class="op" id="3088587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088593">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088599">ifa</span>&nbsp;<span class="op" id="3088603">:=</span>&nbsp;<span class="ident" id="3088606">newAddr</span><span class="op" id="3088613">(</span><span class="ident" id="3088614">ifi</span><span class="op" id="3088617">,</span>&nbsp;<span class="ident" id="3088619">ifam</span><span class="op" id="3088623">,</span>&nbsp;<span class="ident" id="3088625">attrs</span><span class="op" id="3088630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088636">if</span>&nbsp;<span class="ident" id="3088639">ifa</span>&nbsp;<span class="op" id="3088643">!=</span>&nbsp;<span class="ident" id="3088646">nil</span>&nbsp;<span class="op" id="3088650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088657">ifat</span>&nbsp;<span class="op" id="3088662">=</span>&nbsp;<span class="builtinfunc" id="3088664">append</span><span class="op" id="3088670">(</span><span class="ident" id="3088671">ifat</span><span class="op" id="3088675">,</span>&nbsp;<span class="ident" id="3088677">ifa</span><span class="op" id="3088680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088691">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088701">return</span>&nbsp;<span class="ident" id="3088708">ifat</span><span class="op" id="3088712">,</span>&nbsp;<span class="ident" id="3088714">nil</span><br>
<span class="lineno"></span><span class="op" id="3088718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3088721">func</span>&nbsp;<span class="ident" id="3088726">newAddr</span><span class="op" id="3088733">(</span><span class="ident" id="3088734">ifi</span>&nbsp;<span class="op" id="3088738">*</span><span class="ident" id="3088739">Interface</span><span class="op" id="3088748">,</span>&nbsp;<span class="ident" id="3088750">ifam</span>&nbsp;<span class="op" id="3088755">*</span><span class="ident" id="3088756">syscall</span><span class="op" id="3088763">.</span><span class="ident" id="3088764">IfAddrmsg</span><span class="op" id="3088773">,</span>&nbsp;<span class="ident" id="3088775">attrs</span>&nbsp;<span class="op" id="3088781">[</span><span class="op" id="3088782">]</span><span class="ident" id="3088783">syscall</span><span class="op" id="3088790">.</span><span class="ident" id="3088791">NetlinkRouteAttr</span><span class="op" id="3088807">)</span>&nbsp;<span class="ident" id="3088809">Addr</span>&nbsp;<span class="op" id="3088814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088817">var</span>&nbsp;<span class="ident" id="3088821">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3088836">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088842">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088903">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088966">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089021">if</span>&nbsp;<span class="ident" id="3089024">ifi</span><span class="op" id="3089027">.</span><span class="ident" id="3089028">Flags</span><span class="op" id="3089033">&amp;</span><span class="ident" id="3089034">FlagPointToPoint</span>&nbsp;<span class="op" id="3089051">!=</span>&nbsp;<span class="num" id="3089054">0</span>&nbsp;<span class="op" id="3089056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089060">for</span>&nbsp;<span class="ident" id="3089064">_</span><span class="op" id="3089065">,</span>&nbsp;<span class="ident" id="3089067">a</span>&nbsp;<span class="op" id="3089069">:=</span>&nbsp;<span class="keyword" id="3089072">range</span>&nbsp;<span class="ident" id="3089078">attrs</span>&nbsp;<span class="op" id="3089084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089089">if</span>&nbsp;<span class="ident" id="3089092">a</span><span class="op" id="3089093">.</span><span class="ident" id="3089094">Attr</span><span class="op" id="3089098">.</span><span class="ident" id="3089099">Type</span>&nbsp;<span class="op" id="3089104">==</span>&nbsp;<span class="ident" id="3089107">syscall</span><span class="op" id="3089114">.</span><span class="ident" id="3089115">IFA_LOCAL</span>&nbsp;<span class="op" id="3089125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089131">ipPointToPoint</span>&nbsp;<span class="op" id="3089146">=</span>&nbsp;<span class="builtintype" id="3089148">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089157">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089176">for</span>&nbsp;<span class="ident" id="3089180">_</span><span class="op" id="3089181">,</span>&nbsp;<span class="ident" id="3089183">a</span>&nbsp;<span class="op" id="3089185">:=</span>&nbsp;<span class="keyword" id="3089188">range</span>&nbsp;<span class="ident" id="3089194">attrs</span>&nbsp;<span class="op" id="3089200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089204">if</span>&nbsp;<span class="ident" id="3089207">ipPointToPoint</span>&nbsp;<span class="op" id="3089222">&amp;&amp;</span>&nbsp;<span class="ident" id="3089225">a</span><span class="op" id="3089226">.</span><span class="ident" id="3089227">Attr</span><span class="op" id="3089231">.</span><span class="ident" id="3089232">Type</span>&nbsp;<span class="op" id="3089237">==</span>&nbsp;<span class="ident" id="3089240">syscall</span><span class="op" id="3089247">.</span><span class="ident" id="3089248">IFA_ADDRESS</span>&nbsp;<span class="op" id="3089260">||</span>&nbsp;<span class="op" id="3089263">!</span><span class="ident" id="3089264">ipPointToPoint</span>&nbsp;<span class="op" id="3089279">&amp;&amp;</span>&nbsp;<span class="ident" id="3089282">a</span><span class="op" id="3089283">.</span><span class="ident" id="3089284">Attr</span><span class="op" id="3089288">.</span><span class="ident" id="3089289">Type</span>&nbsp;<span class="op" id="3089294">==</span>&nbsp;<span class="ident" id="3089297">syscall</span><span class="op" id="3089304">.</span><span class="ident" id="3089305">IFA_LOCAL</span>&nbsp;<span class="op" id="3089315">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089335">switch</span>&nbsp;<span class="ident" id="3089342">ifam</span><span class="op" id="3089346">.</span><span class="ident" id="3089347">Family</span>&nbsp;<span class="op" id="3089354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089358">case</span>&nbsp;<span class="ident" id="3089363">syscall</span><span class="op" id="3089370">.</span><span class="ident" id="3089371">AF_INET</span><span class="op" id="3089378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089383">return</span>&nbsp;<span class="op" id="3089390">&amp;</span><span class="ident" id="3089391">IPNet</span><span class="op" id="3089396">{</span><span class="ident" id="3089397">IP</span><span class="op" id="3089399">:</span>&nbsp;<span class="ident" id="3089401">IPv4</span><span class="op" id="3089405">(</span><span class="ident" id="3089406">a</span><span class="op" id="3089407">.</span><span class="ident" id="3089408">Value</span><span class="op" id="3089413">[</span><span class="num" id="3089414">0</span><span class="op" id="3089415">]</span><span class="op" id="3089416">,</span>&nbsp;<span class="ident" id="3089418">a</span><span class="op" id="3089419">.</span><span class="ident" id="3089420">Value</span><span class="op" id="3089425">[</span><span class="num" id="3089426">1</span><span class="op" id="3089427">]</span><span class="op" id="3089428">,</span>&nbsp;<span class="ident" id="3089430">a</span><span class="op" id="3089431">.</span><span class="ident" id="3089432">Value</span><span class="op" id="3089437">[</span><span class="num" id="3089438">2</span><span class="op" id="3089439">]</span><span class="op" id="3089440">,</span>&nbsp;<span class="ident" id="3089442">a</span><span class="op" id="3089443">.</span><span class="ident" id="3089444">Value</span><span class="op" id="3089449">[</span><span class="num" id="3089450">3</span><span class="op" id="3089451">]</span><span class="op" id="3089452">)</span><span class="op" id="3089453">,</span>&nbsp;<span class="ident" id="3089455">Mask</span><span class="op" id="3089459">:</span>&nbsp;<span class="ident" id="3089461">CIDRMask</span><span class="op" id="3089469">(</span><span class="builtintype" id="3089470">int</span><span class="op" id="3089473">(</span><span class="ident" id="3089474">ifam</span><span class="op" id="3089478">.</span><span class="ident" id="3089479">Prefixlen</span><span class="op" id="3089488">)</span><span class="op" id="3089489">,</span>&nbsp;<span class="num" id="3089491">8</span><span class="op" id="3089492">*</span><span class="ident" id="3089493">IPv4len</span><span class="op" id="3089500">)</span><span class="op" id="3089501">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089505">case</span>&nbsp;<span class="ident" id="3089510">syscall</span><span class="op" id="3089517">.</span><span class="ident" id="3089518">AF_INET6</span><span class="op" id="3089526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089531">ifa</span>&nbsp;<span class="op" id="3089535">:=</span>&nbsp;<span class="op" id="3089538">&amp;</span><span class="ident" id="3089539">IPNet</span><span class="op" id="3089544">{</span><span class="ident" id="3089545">IP</span><span class="op" id="3089547">:</span>&nbsp;<span class="builtinfunc" id="3089549">make</span><span class="op" id="3089553">(</span><span class="ident" id="3089554">IP</span><span class="op" id="3089556">,</span>&nbsp;<span class="ident" id="3089558">IPv6len</span><span class="op" id="3089565">)</span><span class="op" id="3089566">,</span>&nbsp;<span class="ident" id="3089568">Mask</span><span class="op" id="3089572">:</span>&nbsp;<span class="ident" id="3089574">CIDRMask</span><span class="op" id="3089582">(</span><span class="builtintype" id="3089583">int</span><span class="op" id="3089586">(</span><span class="ident" id="3089587">ifam</span><span class="op" id="3089591">.</span><span class="ident" id="3089592">Prefixlen</span><span class="op" id="3089601">)</span><span class="op" id="3089602">,</span>&nbsp;<span class="num" id="3089604">8</span><span class="op" id="3089605">*</span><span class="ident" id="3089606">IPv6len</span><span class="op" id="3089613">)</span><span class="op" id="3089614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3089619">copy</span><span class="op" id="3089623">(</span><span class="ident" id="3089624">ifa</span><span class="op" id="3089627">.</span><span class="ident" id="3089628">IP</span><span class="op" id="3089630">,</span>&nbsp;<span class="ident" id="3089632">a</span><span class="op" id="3089633">.</span><span class="ident" id="3089634">Value</span><span class="op" id="3089639">[</span><span class="op" id="3089640">:</span><span class="op" id="3089641">]</span><span class="op" id="3089642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089647">return</span>&nbsp;<span class="ident" id="3089654">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089660">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089666">return</span>&nbsp;<span class="ident" id="3089673">nil</span><br>
<span class="lineno"></span><span class="op" id="3089677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3089680">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3089744">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3089758">func</span>&nbsp;<span class="ident" id="3089763">interfaceMulticastAddrTable</span><span class="op" id="3089790">(</span><span class="ident" id="3089791">ifi</span>&nbsp;<span class="op" id="3089795">*</span><span class="ident" id="3089796">Interface</span><span class="op" id="3089805">)</span>&nbsp;<span class="op" id="3089807">(</span><span class="op" id="3089808">[</span><span class="op" id="3089809">]</span><span class="ident" id="3089810">Addr</span><span class="op" id="3089814">,</span>&nbsp;<span class="builtintype" id="3089816">error</span><span class="op" id="3089821">)</span>&nbsp;<span class="op" id="3089823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089826">ifmat4</span>&nbsp;<span class="op" id="3089833">:=</span>&nbsp;<span class="ident" id="3089836">parseProcNetIGMP</span><span class="op" id="3089852">(</span><span class="string" id="3089853">&#34;/proc/net/igmp&#34;</span><span class="op" id="3089869">,</span>&nbsp;<span class="ident" id="3089871">ifi</span><span class="op" id="3089874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089877">ifmat6</span>&nbsp;<span class="op" id="3089884">:=</span>&nbsp;<span class="ident" id="3089887">parseProcNetIGMP6</span><span class="op" id="3089904">(</span><span class="string" id="3089905">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3089922">,</span>&nbsp;<span class="ident" id="3089924">ifi</span><span class="op" id="3089927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089930">return</span>&nbsp;<span class="builtinfunc" id="3089937">append</span><span class="op" id="3089943">(</span><span class="ident" id="3089944">ifmat4</span><span class="op" id="3089950">,</span>&nbsp;<span class="ident" id="3089952">ifmat6</span><span class="op" id="3089958">...</span><span class="op" id="3089961">)</span><span class="op" id="3089962">,</span>&nbsp;<span class="ident" id="3089964">nil</span><br>
<span class="lineno">210</span><span class="op" id="3089968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3089971">func</span>&nbsp;<span class="ident" id="3089976">parseProcNetIGMP</span><span class="op" id="3089992">(</span><span class="ident" id="3089993">path</span>&nbsp;<span class="builtintype" id="3089998">string</span><span class="op" id="3090004">,</span>&nbsp;<span class="ident" id="3090006">ifi</span>&nbsp;<span class="op" id="3090010">*</span><span class="ident" id="3090011">Interface</span><span class="op" id="3090020">)</span>&nbsp;<span class="op" id="3090022">[</span><span class="op" id="3090023">]</span><span class="ident" id="3090024">Addr</span>&nbsp;<span class="op" id="3090029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090032">fd</span><span class="op" id="3090034">,</span>&nbsp;<span class="ident" id="3090036">err</span>&nbsp;<span class="op" id="3090040">:=</span>&nbsp;<span class="ident" id="3090043">open</span><span class="op" id="3090047">(</span><span class="ident" id="3090048">path</span><span class="op" id="3090052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090055">if</span>&nbsp;<span class="ident" id="3090058">err</span>&nbsp;<span class="op" id="3090062">!=</span>&nbsp;<span class="ident" id="3090065">nil</span>&nbsp;<span class="op" id="3090069">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090073">return</span>&nbsp;<span class="ident" id="3090080">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090088">defer</span>&nbsp;<span class="ident" id="3090094">fd</span><span class="op" id="3090096">.</span><span class="builtinfunc" id="3090097">close</span><span class="op" id="3090102">(</span><span class="op" id="3090103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090106">var</span>&nbsp;<span class="op" id="3090110">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090114">ifmat</span>&nbsp;<span class="op" id="3090120">[</span><span class="op" id="3090121">]</span><span class="ident" id="3090122">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090129">name</span>&nbsp;&nbsp;<span class="builtintype" id="3090135">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090146">fd</span><span class="op" id="3090148">.</span><span class="ident" id="3090149">readLine</span><span class="op" id="3090157">(</span><span class="op" id="3090158">)</span>&nbsp;<span class="comment" id="3090160">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090180">b</span>&nbsp;<span class="op" id="3090182">:=</span>&nbsp;<span class="builtinfunc" id="3090185">make</span><span class="op" id="3090189">(</span><span class="op" id="3090190">[</span><span class="op" id="3090191">]</span><span class="builtintype" id="3090192">byte</span><span class="op" id="3090196">,</span>&nbsp;<span class="ident" id="3090198">IPv4len</span><span class="op" id="3090205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090208">for</span>&nbsp;<span class="ident" id="3090212">l</span><span class="op" id="3090213">,</span>&nbsp;<span class="ident" id="3090215">ok</span>&nbsp;<span class="op" id="3090218">:=</span>&nbsp;<span class="ident" id="3090221">fd</span><span class="op" id="3090223">.</span><span class="ident" id="3090224">readLine</span><span class="op" id="3090232">(</span><span class="op" id="3090233">)</span><span class="op" id="3090234">;</span>&nbsp;<span class="ident" id="3090236">ok</span><span class="op" id="3090238">;</span>&nbsp;<span class="ident" id="3090240">l</span><span class="op" id="3090241">,</span>&nbsp;<span class="ident" id="3090243">ok</span>&nbsp;<span class="op" id="3090246">=</span>&nbsp;<span class="ident" id="3090248">fd</span><span class="op" id="3090250">.</span><span class="ident" id="3090251">readLine</span><span class="op" id="3090259">(</span><span class="op" id="3090260">)</span>&nbsp;<span class="op" id="3090262">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090266">f</span>&nbsp;<span class="op" id="3090268">:=</span>&nbsp;<span class="ident" id="3090271">splitAtBytes</span><span class="op" id="3090283">(</span><span class="ident" id="3090284">l</span><span class="op" id="3090285">,</span>&nbsp;<span class="string" id="3090287">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3090297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090301">if</span>&nbsp;<span class="builtinfunc" id="3090304">len</span><span class="op" id="3090307">(</span><span class="ident" id="3090308">f</span><span class="op" id="3090309">)</span>&nbsp;<span class="op" id="3090311">&lt;</span>&nbsp;<span class="num" id="3090313">4</span>&nbsp;<span class="op" id="3090315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090335">switch</span>&nbsp;<span class="op" id="3090342">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090346">case</span>&nbsp;<span class="ident" id="3090351">l</span><span class="op" id="3090352">[</span><span class="num" id="3090353">0</span><span class="op" id="3090354">]</span>&nbsp;<span class="op" id="3090356">!=</span>&nbsp;<span class="string" id="3090359">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3090363">&amp;&amp;</span>&nbsp;<span class="ident" id="3090366">l</span><span class="op" id="3090367">[</span><span class="num" id="3090368">0</span><span class="op" id="3090369">]</span>&nbsp;<span class="op" id="3090371">!=</span>&nbsp;<span class="string" id="3090374">&#39;\t&#39;</span><span class="op" id="3090378">:</span>&nbsp;<span class="comment" id="3090380">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090405">name</span>&nbsp;<span class="op" id="3090410">=</span>&nbsp;<span class="ident" id="3090412">f</span><span class="op" id="3090413">[</span><span class="num" id="3090414">1</span><span class="op" id="3090415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090419">case</span>&nbsp;<span class="builtinfunc" id="3090424">len</span><span class="op" id="3090427">(</span><span class="ident" id="3090428">f</span><span class="op" id="3090429">[</span><span class="num" id="3090430">0</span><span class="op" id="3090431">]</span><span class="op" id="3090432">)</span>&nbsp;<span class="op" id="3090434">==</span>&nbsp;<span class="num" id="3090437">8</span><span class="op" id="3090438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090443">if</span>&nbsp;<span class="ident" id="3090446">ifi</span>&nbsp;<span class="op" id="3090450">==</span>&nbsp;<span class="ident" id="3090453">nil</span>&nbsp;<span class="op" id="3090457">||</span>&nbsp;<span class="ident" id="3090460">name</span>&nbsp;<span class="op" id="3090465">==</span>&nbsp;<span class="ident" id="3090468">ifi</span><span class="op" id="3090471">.</span><span class="ident" id="3090472">Name</span>&nbsp;<span class="op" id="3090477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3090483">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3090519">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3090562">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090581">for</span>&nbsp;<span class="ident" id="3090585">i</span>&nbsp;<span class="op" id="3090587">:=</span>&nbsp;<span class="num" id="3090590">0</span><span class="op" id="3090591">;</span>&nbsp;<span class="ident" id="3090593">i</span><span class="op" id="3090594">+</span><span class="num" id="3090595">1</span>&nbsp;<span class="op" id="3090597">&lt;</span>&nbsp;<span class="builtinfunc" id="3090599">len</span><span class="op" id="3090602">(</span><span class="ident" id="3090603">f</span><span class="op" id="3090604">[</span><span class="num" id="3090605">0</span><span class="op" id="3090606">]</span><span class="op" id="3090607">)</span><span class="op" id="3090608">;</span>&nbsp;<span class="ident" id="3090610">i</span>&nbsp;<span class="op" id="3090612">+=</span>&nbsp;<span class="num" id="3090615">2</span>&nbsp;<span class="op" id="3090617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090624">b</span><span class="op" id="3090625">[</span><span class="ident" id="3090626">i</span><span class="op" id="3090627">/</span><span class="num" id="3090628">2</span><span class="op" id="3090629">]</span><span class="op" id="3090630">,</span>&nbsp;<span class="ident" id="3090632">_</span>&nbsp;<span class="op" id="3090634">=</span>&nbsp;<span class="ident" id="3090636">xtoi2</span><span class="op" id="3090641">(</span><span class="ident" id="3090642">f</span><span class="op" id="3090643">[</span><span class="num" id="3090644">0</span><span class="op" id="3090645">]</span><span class="op" id="3090646">[</span><span class="ident" id="3090647">i</span><span class="op" id="3090648">:</span><span class="ident" id="3090649">i</span><span class="op" id="3090650">+</span><span class="num" id="3090651">2</span><span class="op" id="3090652">]</span><span class="op" id="3090653">,</span>&nbsp;<span class="num" id="3090655">0</span><span class="op" id="3090656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090662">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090668">i</span>&nbsp;<span class="op" id="3090670">:=</span>&nbsp;<span class="op" id="3090673">*</span><span class="op" id="3090674">(</span><span class="op" id="3090675">*</span><span class="builtintype" id="3090676">uint32</span><span class="op" id="3090682">)</span><span class="op" id="3090683">(</span><span class="ident" id="3090684">unsafe</span><span class="op" id="3090690">.</span><span class="ident" id="3090691">Pointer</span><span class="op" id="3090698">(</span><span class="op" id="3090699">&amp;</span><span class="ident" id="3090700">b</span><span class="op" id="3090701">[</span><span class="op" id="3090702">:</span><span class="num" id="3090703">4</span><span class="op" id="3090704">]</span><span class="op" id="3090705">[</span><span class="num" id="3090706">0</span><span class="op" id="3090707">]</span><span class="op" id="3090708">)</span><span class="op" id="3090709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090715">ifma</span>&nbsp;<span class="op" id="3090720">:=</span>&nbsp;<span class="ident" id="3090723">IPAddr</span><span class="op" id="3090729">{</span><span class="ident" id="3090730">IP</span><span class="op" id="3090732">:</span>&nbsp;<span class="ident" id="3090734">IPv4</span><span class="op" id="3090738">(</span><span class="builtintype" id="3090739">byte</span><span class="op" id="3090743">(</span><span class="ident" id="3090744">i</span><span class="op" id="3090745">&gt;&gt;</span><span class="num" id="3090747">24</span><span class="op" id="3090749">)</span><span class="op" id="3090750">,</span>&nbsp;<span class="builtintype" id="3090752">byte</span><span class="op" id="3090756">(</span><span class="ident" id="3090757">i</span><span class="op" id="3090758">&gt;&gt;</span><span class="num" id="3090760">16</span><span class="op" id="3090762">)</span><span class="op" id="3090763">,</span>&nbsp;<span class="builtintype" id="3090765">byte</span><span class="op" id="3090769">(</span><span class="ident" id="3090770">i</span><span class="op" id="3090771">&gt;&gt;</span><span class="num" id="3090773">8</span><span class="op" id="3090774">)</span><span class="op" id="3090775">,</span>&nbsp;<span class="builtintype" id="3090777">byte</span><span class="op" id="3090781">(</span><span class="ident" id="3090782">i</span><span class="op" id="3090783">)</span><span class="op" id="3090784">)</span><span class="op" id="3090785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090791">ifmat</span>&nbsp;<span class="op" id="3090797">=</span>&nbsp;<span class="builtinfunc" id="3090799">append</span><span class="op" id="3090805">(</span><span class="ident" id="3090806">ifmat</span><span class="op" id="3090811">,</span>&nbsp;<span class="ident" id="3090813">ifma</span><span class="op" id="3090817">.</span><span class="ident" id="3090818">toAddr</span><span class="op" id="3090824">(</span><span class="op" id="3090825">)</span><span class="op" id="3090826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090835">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090841">return</span>&nbsp;<span class="ident" id="3090848">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3090854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3090857">func</span>&nbsp;<span class="ident" id="3090862">parseProcNetIGMP6</span><span class="op" id="3090879">(</span><span class="ident" id="3090880">path</span>&nbsp;<span class="builtintype" id="3090885">string</span><span class="op" id="3090891">,</span>&nbsp;<span class="ident" id="3090893">ifi</span>&nbsp;<span class="op" id="3090897">*</span><span class="ident" id="3090898">Interface</span><span class="op" id="3090907">)</span>&nbsp;<span class="op" id="3090909">[</span><span class="op" id="3090910">]</span><span class="ident" id="3090911">Addr</span>&nbsp;<span class="op" id="3090916">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090919">fd</span><span class="op" id="3090921">,</span>&nbsp;<span class="ident" id="3090923">err</span>&nbsp;<span class="op" id="3090927">:=</span>&nbsp;<span class="ident" id="3090930">open</span><span class="op" id="3090934">(</span><span class="ident" id="3090935">path</span><span class="op" id="3090939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090942">if</span>&nbsp;<span class="ident" id="3090945">err</span>&nbsp;<span class="op" id="3090949">!=</span>&nbsp;<span class="ident" id="3090952">nil</span>&nbsp;<span class="op" id="3090956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090960">return</span>&nbsp;<span class="ident" id="3090967">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090975">defer</span>&nbsp;<span class="ident" id="3090981">fd</span><span class="op" id="3090983">.</span><span class="builtinfunc" id="3090984">close</span><span class="op" id="3090989">(</span><span class="op" id="3090990">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090993">var</span>&nbsp;<span class="ident" id="3090997">ifmat</span>&nbsp;<span class="op" id="3091003">[</span><span class="op" id="3091004">]</span><span class="ident" id="3091005">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091011">b</span>&nbsp;<span class="op" id="3091013">:=</span>&nbsp;<span class="builtinfunc" id="3091016">make</span><span class="op" id="3091020">(</span><span class="op" id="3091021">[</span><span class="op" id="3091022">]</span><span class="builtintype" id="3091023">byte</span><span class="op" id="3091027">,</span>&nbsp;<span class="ident" id="3091029">IPv6len</span><span class="op" id="3091036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091039">for</span>&nbsp;<span class="ident" id="3091043">l</span><span class="op" id="3091044">,</span>&nbsp;<span class="ident" id="3091046">ok</span>&nbsp;<span class="op" id="3091049">:=</span>&nbsp;<span class="ident" id="3091052">fd</span><span class="op" id="3091054">.</span><span class="ident" id="3091055">readLine</span><span class="op" id="3091063">(</span><span class="op" id="3091064">)</span><span class="op" id="3091065">;</span>&nbsp;<span class="ident" id="3091067">ok</span><span class="op" id="3091069">;</span>&nbsp;<span class="ident" id="3091071">l</span><span class="op" id="3091072">,</span>&nbsp;<span class="ident" id="3091074">ok</span>&nbsp;<span class="op" id="3091077">=</span>&nbsp;<span class="ident" id="3091079">fd</span><span class="op" id="3091081">.</span><span class="ident" id="3091082">readLine</span><span class="op" id="3091090">(</span><span class="op" id="3091091">)</span>&nbsp;<span class="op" id="3091093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091097">f</span>&nbsp;<span class="op" id="3091099">:=</span>&nbsp;<span class="ident" id="3091102">splitAtBytes</span><span class="op" id="3091114">(</span><span class="ident" id="3091115">l</span><span class="op" id="3091116">,</span>&nbsp;<span class="string" id="3091118">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3091127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091131">if</span>&nbsp;<span class="builtinfunc" id="3091134">len</span><span class="op" id="3091137">(</span><span class="ident" id="3091138">f</span><span class="op" id="3091139">)</span>&nbsp;<span class="op" id="3091141">&lt;</span>&nbsp;<span class="num" id="3091143">6</span>&nbsp;<span class="op" id="3091145">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091150">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091165">if</span>&nbsp;<span class="ident" id="3091168">ifi</span>&nbsp;<span class="op" id="3091172">==</span>&nbsp;<span class="ident" id="3091175">nil</span>&nbsp;<span class="op" id="3091179">||</span>&nbsp;<span class="ident" id="3091182">f</span><span class="op" id="3091183">[</span><span class="num" id="3091184">1</span><span class="op" id="3091185">]</span>&nbsp;<span class="op" id="3091187">==</span>&nbsp;<span class="ident" id="3091190">ifi</span><span class="op" id="3091193">.</span><span class="ident" id="3091194">Name</span>&nbsp;<span class="op" id="3091199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091204">for</span>&nbsp;<span class="ident" id="3091208">i</span>&nbsp;<span class="op" id="3091210">:=</span>&nbsp;<span class="num" id="3091213">0</span><span class="op" id="3091214">;</span>&nbsp;<span class="ident" id="3091216">i</span><span class="op" id="3091217">+</span><span class="num" id="3091218">1</span>&nbsp;<span class="op" id="3091220">&lt;</span>&nbsp;<span class="builtinfunc" id="3091222">len</span><span class="op" id="3091225">(</span><span class="ident" id="3091226">f</span><span class="op" id="3091227">[</span><span class="num" id="3091228">2</span><span class="op" id="3091229">]</span><span class="op" id="3091230">)</span><span class="op" id="3091231">;</span>&nbsp;<span class="ident" id="3091233">i</span>&nbsp;<span class="op" id="3091235">+=</span>&nbsp;<span class="num" id="3091238">2</span>&nbsp;<span class="op" id="3091240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091246">b</span><span class="op" id="3091247">[</span><span class="ident" id="3091248">i</span><span class="op" id="3091249">/</span><span class="num" id="3091250">2</span><span class="op" id="3091251">]</span><span class="op" id="3091252">,</span>&nbsp;<span class="ident" id="3091254">_</span>&nbsp;<span class="op" id="3091256">=</span>&nbsp;<span class="ident" id="3091258">xtoi2</span><span class="op" id="3091263">(</span><span class="ident" id="3091264">f</span><span class="op" id="3091265">[</span><span class="num" id="3091266">2</span><span class="op" id="3091267">]</span><span class="op" id="3091268">[</span><span class="ident" id="3091269">i</span><span class="op" id="3091270">:</span><span class="ident" id="3091271">i</span><span class="op" id="3091272">+</span><span class="num" id="3091273">2</span><span class="op" id="3091274">]</span><span class="op" id="3091275">,</span>&nbsp;<span class="num" id="3091277">0</span><span class="op" id="3091278">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091288">ifma</span>&nbsp;<span class="op" id="3091293">:=</span>&nbsp;<span class="ident" id="3091296">IPAddr</span><span class="op" id="3091302">{</span><span class="ident" id="3091303">IP</span><span class="op" id="3091305">:</span>&nbsp;<span class="ident" id="3091307">IP</span><span class="op" id="3091309">{</span><span class="ident" id="3091310">b</span><span class="op" id="3091311">[</span><span class="num" id="3091312">0</span><span class="op" id="3091313">]</span><span class="op" id="3091314">,</span>&nbsp;<span class="ident" id="3091316">b</span><span class="op" id="3091317">[</span><span class="num" id="3091318">1</span><span class="op" id="3091319">]</span><span class="op" id="3091320">,</span>&nbsp;<span class="ident" id="3091322">b</span><span class="op" id="3091323">[</span><span class="num" id="3091324">2</span><span class="op" id="3091325">]</span><span class="op" id="3091326">,</span>&nbsp;<span class="ident" id="3091328">b</span><span class="op" id="3091329">[</span><span class="num" id="3091330">3</span><span class="op" id="3091331">]</span><span class="op" id="3091332">,</span>&nbsp;<span class="ident" id="3091334">b</span><span class="op" id="3091335">[</span><span class="num" id="3091336">4</span><span class="op" id="3091337">]</span><span class="op" id="3091338">,</span>&nbsp;<span class="ident" id="3091340">b</span><span class="op" id="3091341">[</span><span class="num" id="3091342">5</span><span class="op" id="3091343">]</span><span class="op" id="3091344">,</span>&nbsp;<span class="ident" id="3091346">b</span><span class="op" id="3091347">[</span><span class="num" id="3091348">6</span><span class="op" id="3091349">]</span><span class="op" id="3091350">,</span>&nbsp;<span class="ident" id="3091352">b</span><span class="op" id="3091353">[</span><span class="num" id="3091354">7</span><span class="op" id="3091355">]</span><span class="op" id="3091356">,</span>&nbsp;<span class="ident" id="3091358">b</span><span class="op" id="3091359">[</span><span class="num" id="3091360">8</span><span class="op" id="3091361">]</span><span class="op" id="3091362">,</span>&nbsp;<span class="ident" id="3091364">b</span><span class="op" id="3091365">[</span><span class="num" id="3091366">9</span><span class="op" id="3091367">]</span><span class="op" id="3091368">,</span>&nbsp;<span class="ident" id="3091370">b</span><span class="op" id="3091371">[</span><span class="num" id="3091372">10</span><span class="op" id="3091374">]</span><span class="op" id="3091375">,</span>&nbsp;<span class="ident" id="3091377">b</span><span class="op" id="3091378">[</span><span class="num" id="3091379">11</span><span class="op" id="3091381">]</span><span class="op" id="3091382">,</span>&nbsp;<span class="ident" id="3091384">b</span><span class="op" id="3091385">[</span><span class="num" id="3091386">12</span><span class="op" id="3091388">]</span><span class="op" id="3091389">,</span>&nbsp;<span class="ident" id="3091391">b</span><span class="op" id="3091392">[</span><span class="num" id="3091393">13</span><span class="op" id="3091395">]</span><span class="op" id="3091396">,</span>&nbsp;<span class="ident" id="3091398">b</span><span class="op" id="3091399">[</span><span class="num" id="3091400">14</span><span class="op" id="3091402">]</span><span class="op" id="3091403">,</span>&nbsp;<span class="ident" id="3091405">b</span><span class="op" id="3091406">[</span><span class="num" id="3091407">15</span><span class="op" id="3091409">]</span><span class="op" id="3091410">}</span><span class="op" id="3091411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091416">ifmat</span>&nbsp;<span class="op" id="3091422">=</span>&nbsp;<span class="builtinfunc" id="3091424">append</span><span class="op" id="3091430">(</span><span class="ident" id="3091431">ifmat</span><span class="op" id="3091436">,</span>&nbsp;<span class="ident" id="3091438">ifma</span><span class="op" id="3091442">.</span><span class="ident" id="3091443">toAddr</span><span class="op" id="3091449">(</span><span class="op" id="3091450">)</span><span class="op" id="3091451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091458">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091461">return</span>&nbsp;<span class="ident" id="3091468">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3091474">}</span>
</div>
</body>
</html>
