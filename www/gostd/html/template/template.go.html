<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4368263">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4368318">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4368372">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4368423">package</span>&nbsp;<span class="ident" id="4368431">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4368441">import</span>&nbsp;<span class="op" id="4368448">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368451">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368458">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368464">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368477">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368494">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368502">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4368519">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4368541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4368544">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="4368624">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="4368651">type</span>&nbsp;<span class="ident" id="4368656">Template</span>&nbsp;<span class="keyword" id="4368665">struct</span>&nbsp;<span class="op" id="4368672">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368675">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368711">escapeErr</span>&nbsp;<span class="builtintype" id="4368721">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368728">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368802">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368871">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368895">text</span>&nbsp;<span class="op" id="4368900">*</span><span class="ident" id="4368901">template</span><span class="op" id="4368909">.</span><span class="ident" id="4368910">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4368920">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4368987">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368998">*</span><span class="ident" id="4368999">parse</span><span class="op" id="4369004">.</span><span class="ident" id="4369005">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369011">*</span><span class="ident" id="4369012">nameSpace</span>&nbsp;<span class="comment" id="4369022">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="4369060">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4369063">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="4369128">var</span>&nbsp;<span class="ident" id="4369132">escapeOK</span>&nbsp;<span class="op" id="4369141">=</span>&nbsp;<span class="ident" id="4369143">fmt</span><span class="op" id="4369146">.</span><span class="ident" id="4369147">Errorf</span><span class="op" id="4369153">(</span><span class="string" id="4369154">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="4369182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369185">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="4369263">type</span>&nbsp;<span class="ident" id="4369268">nameSpace</span>&nbsp;<span class="keyword" id="4369278">struct</span>&nbsp;<span class="op" id="4369285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369288">mu</span>&nbsp;&nbsp;<span class="ident" id="4369292">sync</span><span class="op" id="4369296">.</span><span class="ident" id="4369297">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369304">set</span>&nbsp;<span class="keyword" id="4369308">map</span><span class="op" id="4369311">[</span><span class="builtintype" id="4369312">string</span><span class="op" id="4369318">]</span><span class="op" id="4369319">*</span><span class="ident" id="4369320">Template</span><br>
<span class="lineno"></span><span class="op" id="4369329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4369332">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="4369409">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4369420">func</span>&nbsp;<span class="op" id="4369425">(</span><span class="ident" id="4369426">t</span>&nbsp;<span class="op" id="4369428">*</span><span class="ident" id="4369429">Template</span><span class="op" id="4369437">)</span>&nbsp;<span class="ident" id="4369439">Templates</span><span class="op" id="4369448">(</span><span class="op" id="4369449">)</span>&nbsp;<span class="op" id="4369451">[</span><span class="op" id="4369452">]</span><span class="op" id="4369453">*</span><span class="ident" id="4369454">Template</span>&nbsp;<span class="op" id="4369463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369466">ns</span>&nbsp;<span class="op" id="4369469">:=</span>&nbsp;<span class="ident" id="4369472">t</span><span class="op" id="4369473">.</span><span class="ident" id="4369474">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369485">ns</span><span class="op" id="4369487">.</span><span class="ident" id="4369488">mu</span><span class="op" id="4369490">.</span><span class="ident" id="4369491">Lock</span><span class="op" id="4369495">(</span><span class="op" id="4369496">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369499">defer</span>&nbsp;<span class="ident" id="4369505">ns</span><span class="op" id="4369507">.</span><span class="ident" id="4369508">mu</span><span class="op" id="4369510">.</span><span class="ident" id="4369511">Unlock</span><span class="op" id="4369517">(</span><span class="op" id="4369518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4369521">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369568">m</span>&nbsp;<span class="op" id="4369570">:=</span>&nbsp;<span class="builtinfunc" id="4369573">make</span><span class="op" id="4369577">(</span><span class="op" id="4369578">[</span><span class="op" id="4369579">]</span><span class="op" id="4369580">*</span><span class="ident" id="4369581">Template</span><span class="op" id="4369589">,</span>&nbsp;<span class="num" id="4369591">0</span><span class="op" id="4369592">,</span>&nbsp;<span class="builtinfunc" id="4369594">len</span><span class="op" id="4369597">(</span><span class="ident" id="4369598">ns</span><span class="op" id="4369600">.</span><span class="ident" id="4369601">set</span><span class="op" id="4369604">)</span><span class="op" id="4369605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369608">for</span>&nbsp;<span class="ident" id="4369612">_</span><span class="op" id="4369613">,</span>&nbsp;<span class="ident" id="4369615">v</span>&nbsp;<span class="op" id="4369617">:=</span>&nbsp;<span class="keyword" id="4369620">range</span>&nbsp;<span class="ident" id="4369626">ns</span><span class="op" id="4369628">.</span><span class="ident" id="4369629">set</span>&nbsp;<span class="op" id="4369633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369637">m</span>&nbsp;<span class="op" id="4369639">=</span>&nbsp;<span class="builtinfunc" id="4369641">append</span><span class="op" id="4369647">(</span><span class="ident" id="4369648">m</span><span class="op" id="4369649">,</span>&nbsp;<span class="ident" id="4369651">v</span><span class="op" id="4369652">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369658">return</span>&nbsp;<span class="ident" id="4369665">m</span><br>
<span class="lineno"></span><span class="op" id="4369667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369670">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="4369714">func</span>&nbsp;<span class="op" id="4369719">(</span><span class="ident" id="4369720">t</span>&nbsp;<span class="op" id="4369722">*</span><span class="ident" id="4369723">Template</span><span class="op" id="4369731">)</span>&nbsp;<span class="ident" id="4369733">escape</span><span class="op" id="4369739">(</span><span class="op" id="4369740">)</span>&nbsp;<span class="builtintype" id="4369742">error</span>&nbsp;<span class="op" id="4369748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4369751">t</span><span class="op" id="4369752">.</span><span class="ident" id="4369753">nameSpace</span><span class="op" id="4369762">.</span><span class="ident" id="4369763">mu</span><span class="op" id="4369765">.</span><span class="ident" id="4369766">Lock</span><span class="op" id="4369770">(</span><span class="op" id="4369771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369774">defer</span>&nbsp;<span class="ident" id="4369780">t</span><span class="op" id="4369781">.</span><span class="ident" id="4369782">nameSpace</span><span class="op" id="4369791">.</span><span class="ident" id="4369792">mu</span><span class="op" id="4369794">.</span><span class="ident" id="4369795">Unlock</span><span class="op" id="4369801">(</span><span class="op" id="4369802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369805">if</span>&nbsp;<span class="ident" id="4369808">t</span><span class="op" id="4369809">.</span><span class="ident" id="4369810">escapeErr</span>&nbsp;<span class="op" id="4369820">==</span>&nbsp;<span class="builtintype" id="4369823">nil</span>&nbsp;<span class="op" id="4369827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369831">if</span>&nbsp;<span class="ident" id="4369834">err</span>&nbsp;<span class="op" id="4369838">:=</span>&nbsp;<span class="ident" id="4369841">escapeTemplate</span><span class="op" id="4369855">(</span><span class="ident" id="4369856">t</span><span class="op" id="4369857">,</span>&nbsp;<span class="ident" id="4369859">t</span><span class="op" id="4369860">.</span><span class="ident" id="4369861">text</span><span class="op" id="4369865">.</span><span class="ident" id="4369866">Root</span><span class="op" id="4369870">,</span>&nbsp;<span class="ident" id="4369872">t</span><span class="op" id="4369873">.</span><span class="ident" id="4369874">Name</span><span class="op" id="4369878">(</span><span class="op" id="4369879">)</span><span class="op" id="4369880">)</span><span class="op" id="4369881">;</span>&nbsp;<span class="ident" id="4369883">err</span>&nbsp;<span class="op" id="4369887">!=</span>&nbsp;<span class="builtintype" id="4369890">nil</span>&nbsp;<span class="op" id="4369894">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369899">return</span>&nbsp;<span class="ident" id="4369906">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369915">}</span>&nbsp;<span class="keyword" id="4369917">else</span>&nbsp;<span class="keyword" id="4369922">if</span>&nbsp;<span class="ident" id="4369925">t</span><span class="op" id="4369926">.</span><span class="ident" id="4369927">escapeErr</span>&nbsp;<span class="op" id="4369937">!=</span>&nbsp;<span class="ident" id="4369940">escapeOK</span>&nbsp;<span class="op" id="4369949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369953">return</span>&nbsp;<span class="ident" id="4369960">t</span><span class="op" id="4369961">.</span><span class="ident" id="4369962">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369973">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4369976">return</span>&nbsp;<span class="builtintype" id="4369983">nil</span><br>
<span class="lineno"></span><span class="op" id="4369987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369990">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4370057">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="4370086">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4370154">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4370227">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4370249">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4370299">func</span>&nbsp;<span class="op" id="4370304">(</span><span class="ident" id="4370305">t</span>&nbsp;<span class="op" id="4370307">*</span><span class="ident" id="4370308">Template</span><span class="op" id="4370316">)</span>&nbsp;<span class="ident" id="4370318">Execute</span><span class="op" id="4370325">(</span><span class="ident" id="4370326">wr</span>&nbsp;<span class="ident" id="4370329">io</span><span class="op" id="4370331">.</span><span class="ident" id="4370332">Writer</span><span class="op" id="4370338">,</span>&nbsp;<span class="ident" id="4370340">data</span>&nbsp;<span class="keyword" id="4370345">interface</span><span class="op" id="4370354">{</span><span class="op" id="4370355">}</span><span class="op" id="4370356">)</span>&nbsp;<span class="builtintype" id="4370358">error</span>&nbsp;<span class="op" id="4370364">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370367">if</span>&nbsp;<span class="ident" id="4370370">err</span>&nbsp;<span class="op" id="4370374">:=</span>&nbsp;<span class="ident" id="4370377">t</span><span class="op" id="4370378">.</span><span class="ident" id="4370379">escape</span><span class="op" id="4370385">(</span><span class="op" id="4370386">)</span><span class="op" id="4370387">;</span>&nbsp;<span class="ident" id="4370389">err</span>&nbsp;<span class="op" id="4370393">!=</span>&nbsp;<span class="builtintype" id="4370396">nil</span>&nbsp;<span class="op" id="4370400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370404">return</span>&nbsp;<span class="ident" id="4370411">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4370416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370419">return</span>&nbsp;<span class="ident" id="4370426">t</span><span class="op" id="4370427">.</span><span class="ident" id="4370428">text</span><span class="op" id="4370432">.</span><span class="ident" id="4370433">Execute</span><span class="op" id="4370440">(</span><span class="ident" id="4370441">wr</span><span class="op" id="4370443">,</span>&nbsp;<span class="ident" id="4370445">data</span><span class="op" id="4370449">)</span><br>
<span class="lineno"></span><span class="op" id="4370451">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4370454">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4370531">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4370597">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4370665">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="4370738">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4370760">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4370810">func</span>&nbsp;<span class="op" id="4370815">(</span><span class="ident" id="4370816">t</span>&nbsp;<span class="op" id="4370818">*</span><span class="ident" id="4370819">Template</span><span class="op" id="4370827">)</span>&nbsp;<span class="ident" id="4370829">ExecuteTemplate</span><span class="op" id="4370844">(</span><span class="ident" id="4370845">wr</span>&nbsp;<span class="ident" id="4370848">io</span><span class="op" id="4370850">.</span><span class="ident" id="4370851">Writer</span><span class="op" id="4370857">,</span>&nbsp;<span class="ident" id="4370859">name</span>&nbsp;<span class="builtintype" id="4370864">string</span><span class="op" id="4370870">,</span>&nbsp;<span class="ident" id="4370872">data</span>&nbsp;<span class="keyword" id="4370877">interface</span><span class="op" id="4370886">{</span><span class="op" id="4370887">}</span><span class="op" id="4370888">)</span>&nbsp;<span class="builtintype" id="4370890">error</span>&nbsp;<span class="op" id="4370896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4370899">tmpl</span><span class="op" id="4370903">,</span>&nbsp;<span class="ident" id="4370905">err</span>&nbsp;<span class="op" id="4370909">:=</span>&nbsp;<span class="ident" id="4370912">t</span><span class="op" id="4370913">.</span><span class="ident" id="4370914">lookupAndEscapeTemplate</span><span class="op" id="4370937">(</span><span class="ident" id="4370938">name</span><span class="op" id="4370942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370945">if</span>&nbsp;<span class="ident" id="4370948">err</span>&nbsp;<span class="op" id="4370952">!=</span>&nbsp;<span class="builtintype" id="4370955">nil</span>&nbsp;<span class="op" id="4370959">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370963">return</span>&nbsp;<span class="ident" id="4370970">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4370975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4370978">return</span>&nbsp;<span class="ident" id="4370985">tmpl</span><span class="op" id="4370989">.</span><span class="ident" id="4370990">text</span><span class="op" id="4370994">.</span><span class="ident" id="4370995">Execute</span><span class="op" id="4371002">(</span><span class="ident" id="4371003">wr</span><span class="op" id="4371005">,</span>&nbsp;<span class="ident" id="4371007">data</span><span class="op" id="4371011">)</span><br>
<span class="lineno"></span><span class="op" id="4371013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4371016">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4371092">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="4371165">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4371178">func</span>&nbsp;<span class="op" id="4371183">(</span><span class="ident" id="4371184">t</span>&nbsp;<span class="op" id="4371186">*</span><span class="ident" id="4371187">Template</span><span class="op" id="4371195">)</span>&nbsp;<span class="ident" id="4371197">lookupAndEscapeTemplate</span><span class="op" id="4371220">(</span><span class="ident" id="4371221">name</span>&nbsp;<span class="builtintype" id="4371226">string</span><span class="op" id="4371232">)</span>&nbsp;<span class="op" id="4371234">(</span><span class="ident" id="4371235">tmpl</span>&nbsp;<span class="op" id="4371240">*</span><span class="ident" id="4371241">Template</span><span class="op" id="4371249">,</span>&nbsp;<span class="ident" id="4371251">err</span>&nbsp;<span class="builtintype" id="4371255">error</span><span class="op" id="4371260">)</span>&nbsp;<span class="op" id="4371262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371265">t</span><span class="op" id="4371266">.</span><span class="ident" id="4371267">nameSpace</span><span class="op" id="4371276">.</span><span class="ident" id="4371277">mu</span><span class="op" id="4371279">.</span><span class="ident" id="4371280">Lock</span><span class="op" id="4371284">(</span><span class="op" id="4371285">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371288">defer</span>&nbsp;<span class="ident" id="4371294">t</span><span class="op" id="4371295">.</span><span class="ident" id="4371296">nameSpace</span><span class="op" id="4371305">.</span><span class="ident" id="4371306">mu</span><span class="op" id="4371308">.</span><span class="ident" id="4371309">Unlock</span><span class="op" id="4371315">(</span><span class="op" id="4371316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371319">tmpl</span>&nbsp;<span class="op" id="4371324">=</span>&nbsp;<span class="ident" id="4371326">t</span><span class="op" id="4371327">.</span><span class="ident" id="4371328">set</span><span class="op" id="4371331">[</span><span class="ident" id="4371332">name</span><span class="op" id="4371336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371339">if</span>&nbsp;<span class="ident" id="4371342">tmpl</span>&nbsp;<span class="op" id="4371347">==</span>&nbsp;<span class="builtintype" id="4371350">nil</span>&nbsp;<span class="op" id="4371354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371358">return</span>&nbsp;<span class="builtintype" id="4371365">nil</span><span class="op" id="4371368">,</span>&nbsp;<span class="ident" id="4371370">fmt</span><span class="op" id="4371373">.</span><span class="ident" id="4371374">Errorf</span><span class="op" id="4371380">(</span><span class="string" id="4371381">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="4371413">,</span>&nbsp;<span class="ident" id="4371415">name</span><span class="op" id="4371419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371422">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371425">if</span>&nbsp;<span class="ident" id="4371428">tmpl</span><span class="op" id="4371432">.</span><span class="ident" id="4371433">escapeErr</span>&nbsp;<span class="op" id="4371443">!=</span>&nbsp;<span class="builtintype" id="4371446">nil</span>&nbsp;<span class="op" id="4371450">&amp;&amp;</span>&nbsp;<span class="ident" id="4371453">tmpl</span><span class="op" id="4371457">.</span><span class="ident" id="4371458">escapeErr</span>&nbsp;<span class="op" id="4371468">!=</span>&nbsp;<span class="ident" id="4371471">escapeOK</span>&nbsp;<span class="op" id="4371480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371484">return</span>&nbsp;<span class="builtintype" id="4371491">nil</span><span class="op" id="4371494">,</span>&nbsp;<span class="ident" id="4371496">tmpl</span><span class="op" id="4371500">.</span><span class="ident" id="4371501">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371515">if</span>&nbsp;<span class="ident" id="4371518">tmpl</span><span class="op" id="4371522">.</span><span class="ident" id="4371523">text</span><span class="op" id="4371527">.</span><span class="ident" id="4371528">Tree</span>&nbsp;<span class="op" id="4371533">==</span>&nbsp;<span class="builtintype" id="4371536">nil</span>&nbsp;<span class="op" id="4371540">||</span>&nbsp;<span class="ident" id="4371543">tmpl</span><span class="op" id="4371547">.</span><span class="ident" id="4371548">text</span><span class="op" id="4371552">.</span><span class="ident" id="4371553">Root</span>&nbsp;<span class="op" id="4371558">==</span>&nbsp;<span class="builtintype" id="4371561">nil</span>&nbsp;<span class="op" id="4371565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371569">return</span>&nbsp;<span class="builtintype" id="4371576">nil</span><span class="op" id="4371579">,</span>&nbsp;<span class="ident" id="4371581">fmt</span><span class="op" id="4371584">.</span><span class="ident" id="4371585">Errorf</span><span class="op" id="4371591">(</span><span class="string" id="4371592">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="4371637">,</span>&nbsp;<span class="ident" id="4371639">name</span><span class="op" id="4371643">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371649">if</span>&nbsp;<span class="ident" id="4371652">t</span><span class="op" id="4371653">.</span><span class="ident" id="4371654">text</span><span class="op" id="4371658">.</span><span class="ident" id="4371659">Lookup</span><span class="op" id="4371665">(</span><span class="ident" id="4371666">name</span><span class="op" id="4371670">)</span>&nbsp;<span class="op" id="4371672">==</span>&nbsp;<span class="builtintype" id="4371675">nil</span>&nbsp;<span class="op" id="4371679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4371683">panic</span><span class="op" id="4371688">(</span><span class="string" id="4371689">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="4371750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371756">if</span>&nbsp;<span class="ident" id="4371759">tmpl</span><span class="op" id="4371763">.</span><span class="ident" id="4371764">escapeErr</span>&nbsp;<span class="op" id="4371774">==</span>&nbsp;<span class="builtintype" id="4371777">nil</span>&nbsp;<span class="op" id="4371781">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4371785">err</span>&nbsp;<span class="op" id="4371789">=</span>&nbsp;<span class="ident" id="4371791">escapeTemplate</span><span class="op" id="4371805">(</span><span class="ident" id="4371806">tmpl</span><span class="op" id="4371810">,</span>&nbsp;<span class="ident" id="4371812">tmpl</span><span class="op" id="4371816">.</span><span class="ident" id="4371817">text</span><span class="op" id="4371821">.</span><span class="ident" id="4371822">Root</span><span class="op" id="4371826">,</span>&nbsp;<span class="ident" id="4371828">name</span><span class="op" id="4371832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4371835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4371838">return</span>&nbsp;<span class="ident" id="4371845">tmpl</span><span class="op" id="4371849">,</span>&nbsp;<span class="ident" id="4371851">err</span><br>
<span class="lineno"></span><span class="op" id="4371855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4371858">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="4371928">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4371994">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="4372066">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="4372139">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="4372203">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="4372274">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="4372341">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="4372399">func</span>&nbsp;<span class="op" id="4372404">(</span><span class="ident" id="4372405">t</span>&nbsp;<span class="op" id="4372407">*</span><span class="ident" id="4372408">Template</span><span class="op" id="4372416">)</span>&nbsp;<span class="ident" id="4372418">Parse</span><span class="op" id="4372423">(</span><span class="ident" id="4372424">src</span>&nbsp;<span class="builtintype" id="4372428">string</span><span class="op" id="4372434">)</span>&nbsp;<span class="op" id="4372436">(</span><span class="op" id="4372437">*</span><span class="ident" id="4372438">Template</span><span class="op" id="4372446">,</span>&nbsp;<span class="builtintype" id="4372448">error</span><span class="op" id="4372453">)</span>&nbsp;<span class="op" id="4372455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372458">t</span><span class="op" id="4372459">.</span><span class="ident" id="4372460">nameSpace</span><span class="op" id="4372469">.</span><span class="ident" id="4372470">mu</span><span class="op" id="4372472">.</span><span class="ident" id="4372473">Lock</span><span class="op" id="4372477">(</span><span class="op" id="4372478">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372481">t</span><span class="op" id="4372482">.</span><span class="ident" id="4372483">escapeErr</span>&nbsp;<span class="op" id="4372493">=</span>&nbsp;<span class="builtintype" id="4372495">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372500">t</span><span class="op" id="4372501">.</span><span class="ident" id="4372502">nameSpace</span><span class="op" id="4372511">.</span><span class="ident" id="4372512">mu</span><span class="op" id="4372514">.</span><span class="ident" id="4372515">Unlock</span><span class="op" id="4372521">(</span><span class="op" id="4372522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372525">ret</span><span class="op" id="4372528">,</span>&nbsp;<span class="ident" id="4372530">err</span>&nbsp;<span class="op" id="4372534">:=</span>&nbsp;<span class="ident" id="4372537">t</span><span class="op" id="4372538">.</span><span class="ident" id="4372539">text</span><span class="op" id="4372543">.</span><span class="ident" id="4372544">Parse</span><span class="op" id="4372549">(</span><span class="ident" id="4372550">src</span><span class="op" id="4372553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372556">if</span>&nbsp;<span class="ident" id="4372559">err</span>&nbsp;<span class="op" id="4372563">!=</span>&nbsp;<span class="builtintype" id="4372566">nil</span>&nbsp;<span class="op" id="4372570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372574">return</span>&nbsp;<span class="builtintype" id="4372581">nil</span><span class="op" id="4372584">,</span>&nbsp;<span class="ident" id="4372586">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372594">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372664">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372717">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372778">t</span><span class="op" id="4372779">.</span><span class="ident" id="4372780">nameSpace</span><span class="op" id="4372789">.</span><span class="ident" id="4372790">mu</span><span class="op" id="4372792">.</span><span class="ident" id="4372793">Lock</span><span class="op" id="4372797">(</span><span class="op" id="4372798">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372801">defer</span>&nbsp;<span class="ident" id="4372807">t</span><span class="op" id="4372808">.</span><span class="ident" id="4372809">nameSpace</span><span class="op" id="4372818">.</span><span class="ident" id="4372819">mu</span><span class="op" id="4372821">.</span><span class="ident" id="4372822">Unlock</span><span class="op" id="4372828">(</span><span class="op" id="4372829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372832">for</span>&nbsp;<span class="ident" id="4372836">_</span><span class="op" id="4372837">,</span>&nbsp;<span class="ident" id="4372839">v</span>&nbsp;<span class="op" id="4372841">:=</span>&nbsp;<span class="keyword" id="4372844">range</span>&nbsp;<span class="ident" id="4372850">ret</span><span class="op" id="4372853">.</span><span class="ident" id="4372854">Templates</span><span class="op" id="4372863">(</span><span class="op" id="4372864">)</span>&nbsp;<span class="op" id="4372866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372870">name</span>&nbsp;<span class="op" id="4372875">:=</span>&nbsp;<span class="ident" id="4372878">v</span><span class="op" id="4372879">.</span><span class="ident" id="4372880">Name</span><span class="op" id="4372884">(</span><span class="op" id="4372885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372889">tmpl</span>&nbsp;<span class="op" id="4372894">:=</span>&nbsp;<span class="ident" id="4372897">t</span><span class="op" id="4372898">.</span><span class="ident" id="4372899">set</span><span class="op" id="4372902">[</span><span class="ident" id="4372903">name</span><span class="op" id="4372907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372911">if</span>&nbsp;<span class="ident" id="4372914">tmpl</span>&nbsp;<span class="op" id="4372919">==</span>&nbsp;<span class="builtintype" id="4372922">nil</span>&nbsp;<span class="op" id="4372926">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4372931">tmpl</span>&nbsp;<span class="op" id="4372936">=</span>&nbsp;<span class="ident" id="4372938">t</span><span class="op" id="4372939">.</span><span class="builtinfunc" id="4372940">new</span><span class="op" id="4372943">(</span><span class="ident" id="4372944">name</span><span class="op" id="4372948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4372952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372956">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373035">tmpl</span><span class="op" id="4373039">.</span><span class="ident" id="4373040">escapeErr</span>&nbsp;<span class="op" id="4373050">=</span>&nbsp;<span class="builtintype" id="4373052">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373058">tmpl</span><span class="op" id="4373062">.</span><span class="ident" id="4373063">text</span>&nbsp;<span class="op" id="4373068">=</span>&nbsp;<span class="ident" id="4373070">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373074">tmpl</span><span class="op" id="4373078">.</span><span class="ident" id="4373079">Tree</span>&nbsp;<span class="op" id="4373084">=</span>&nbsp;<span class="ident" id="4373086">v</span><span class="op" id="4373087">.</span><span class="ident" id="4373088">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4373094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373097">return</span>&nbsp;<span class="ident" id="4373104">t</span><span class="op" id="4373105">,</span>&nbsp;<span class="builtintype" id="4373107">nil</span><br>
<span class="lineno"></span><span class="op" id="4373111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="4373114">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="4373182">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="4373211">//</span><br>
<span class="lineno"></span><span class="comment" id="4373214">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4373269">func</span>&nbsp;<span class="op" id="4373274">(</span><span class="ident" id="4373275">t</span>&nbsp;<span class="op" id="4373277">*</span><span class="ident" id="4373278">Template</span><span class="op" id="4373286">)</span>&nbsp;<span class="ident" id="4373288">AddParseTree</span><span class="op" id="4373300">(</span><span class="ident" id="4373301">name</span>&nbsp;<span class="builtintype" id="4373306">string</span><span class="op" id="4373312">,</span>&nbsp;<span class="ident" id="4373314">tree</span>&nbsp;<span class="op" id="4373319">*</span><span class="ident" id="4373320">parse</span><span class="op" id="4373325">.</span><span class="ident" id="4373326">Tree</span><span class="op" id="4373330">)</span>&nbsp;<span class="op" id="4373332">(</span><span class="op" id="4373333">*</span><span class="ident" id="4373334">Template</span><span class="op" id="4373342">,</span>&nbsp;<span class="builtintype" id="4373344">error</span><span class="op" id="4373349">)</span>&nbsp;<span class="op" id="4373351">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373354">t</span><span class="op" id="4373355">.</span><span class="ident" id="4373356">nameSpace</span><span class="op" id="4373365">.</span><span class="ident" id="4373366">mu</span><span class="op" id="4373368">.</span><span class="ident" id="4373369">Lock</span><span class="op" id="4373373">(</span><span class="op" id="4373374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373377">defer</span>&nbsp;<span class="ident" id="4373383">t</span><span class="op" id="4373384">.</span><span class="ident" id="4373385">nameSpace</span><span class="op" id="4373394">.</span><span class="ident" id="4373395">mu</span><span class="op" id="4373397">.</span><span class="ident" id="4373398">Unlock</span><span class="op" id="4373404">(</span><span class="op" id="4373405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373408">if</span>&nbsp;<span class="ident" id="4373411">t</span><span class="op" id="4373412">.</span><span class="ident" id="4373413">escapeErr</span>&nbsp;<span class="op" id="4373423">!=</span>&nbsp;<span class="builtintype" id="4373426">nil</span>&nbsp;<span class="op" id="4373430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373434">return</span>&nbsp;<span class="builtintype" id="4373441">nil</span><span class="op" id="4373444">,</span>&nbsp;<span class="ident" id="4373446">fmt</span><span class="op" id="4373449">.</span><span class="ident" id="4373450">Errorf</span><span class="op" id="4373456">(</span><span class="string" id="4373457">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4373521">,</span>&nbsp;<span class="ident" id="4373523">t</span><span class="op" id="4373524">.</span><span class="ident" id="4373525">Name</span><span class="op" id="4373529">(</span><span class="op" id="4373530">)</span><span class="op" id="4373531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4373534">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373537">text</span><span class="op" id="4373541">,</span>&nbsp;<span class="ident" id="4373543">err</span>&nbsp;<span class="op" id="4373547">:=</span>&nbsp;<span class="ident" id="4373550">t</span><span class="op" id="4373551">.</span><span class="ident" id="4373552">text</span><span class="op" id="4373556">.</span><span class="ident" id="4373557">AddParseTree</span><span class="op" id="4373569">(</span><span class="ident" id="4373570">name</span><span class="op" id="4373574">,</span>&nbsp;<span class="ident" id="4373576">tree</span><span class="op" id="4373580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373583">if</span>&nbsp;<span class="ident" id="4373586">err</span>&nbsp;<span class="op" id="4373590">!=</span>&nbsp;<span class="builtintype" id="4373593">nil</span>&nbsp;<span class="op" id="4373597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373601">return</span>&nbsp;<span class="builtintype" id="4373608">nil</span><span class="op" id="4373611">,</span>&nbsp;<span class="ident" id="4373613">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4373618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373621">ret</span>&nbsp;<span class="op" id="4373625">:=</span>&nbsp;<span class="op" id="4373628">&amp;</span><span class="ident" id="4373629">Template</span><span class="op" id="4373637">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4373641">nil</span><span class="op" id="4373644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373648">text</span><span class="op" id="4373652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373656">text</span><span class="op" id="4373660">.</span><span class="ident" id="4373661">Tree</span><span class="op" id="4373665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373669">t</span><span class="op" id="4373670">.</span><span class="ident" id="4373671">nameSpace</span><span class="op" id="4373680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4373683">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373686">t</span><span class="op" id="4373687">.</span><span class="ident" id="4373688">set</span><span class="op" id="4373691">[</span><span class="ident" id="4373692">name</span><span class="op" id="4373696">]</span>&nbsp;<span class="op" id="4373698">=</span>&nbsp;<span class="ident" id="4373700">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4373705">return</span>&nbsp;<span class="ident" id="4373712">ret</span><span class="op" id="4373715">,</span>&nbsp;<span class="builtintype" id="4373717">nil</span><br>
<span class="lineno"></span><span class="op" id="4373721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4373724">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="4373795">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4373872">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="4373947">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="4374026">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="4374104">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="4374155">//</span><br>
<span class="lineno"></span><span class="comment" id="4374158">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4374213">func</span>&nbsp;<span class="op" id="4374218">(</span><span class="ident" id="4374219">t</span>&nbsp;<span class="op" id="4374221">*</span><span class="ident" id="4374222">Template</span><span class="op" id="4374230">)</span>&nbsp;<span class="ident" id="4374232">Clone</span><span class="op" id="4374237">(</span><span class="op" id="4374238">)</span>&nbsp;<span class="op" id="4374240">(</span><span class="op" id="4374241">*</span><span class="ident" id="4374242">Template</span><span class="op" id="4374250">,</span>&nbsp;<span class="builtintype" id="4374252">error</span><span class="op" id="4374257">)</span>&nbsp;<span class="op" id="4374259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374262">t</span><span class="op" id="4374263">.</span><span class="ident" id="4374264">nameSpace</span><span class="op" id="4374273">.</span><span class="ident" id="4374274">mu</span><span class="op" id="4374276">.</span><span class="ident" id="4374277">Lock</span><span class="op" id="4374281">(</span><span class="op" id="4374282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374285">defer</span>&nbsp;<span class="ident" id="4374291">t</span><span class="op" id="4374292">.</span><span class="ident" id="4374293">nameSpace</span><span class="op" id="4374302">.</span><span class="ident" id="4374303">mu</span><span class="op" id="4374305">.</span><span class="ident" id="4374306">Unlock</span><span class="op" id="4374312">(</span><span class="op" id="4374313">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374316">if</span>&nbsp;<span class="ident" id="4374319">t</span><span class="op" id="4374320">.</span><span class="ident" id="4374321">escapeErr</span>&nbsp;<span class="op" id="4374331">!=</span>&nbsp;<span class="builtintype" id="4374334">nil</span>&nbsp;<span class="op" id="4374338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374342">return</span>&nbsp;<span class="builtintype" id="4374349">nil</span><span class="op" id="4374352">,</span>&nbsp;<span class="ident" id="4374354">fmt</span><span class="op" id="4374357">.</span><span class="ident" id="4374358">Errorf</span><span class="op" id="4374364">(</span><span class="string" id="4374365">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4374419">,</span>&nbsp;<span class="ident" id="4374421">t</span><span class="op" id="4374422">.</span><span class="ident" id="4374423">Name</span><span class="op" id="4374427">(</span><span class="op" id="4374428">)</span><span class="op" id="4374429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374435">textClone</span><span class="op" id="4374444">,</span>&nbsp;<span class="ident" id="4374446">err</span>&nbsp;<span class="op" id="4374450">:=</span>&nbsp;<span class="ident" id="4374453">t</span><span class="op" id="4374454">.</span><span class="ident" id="4374455">text</span><span class="op" id="4374459">.</span><span class="ident" id="4374460">Clone</span><span class="op" id="4374465">(</span><span class="op" id="4374466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374469">if</span>&nbsp;<span class="ident" id="4374472">err</span>&nbsp;<span class="op" id="4374476">!=</span>&nbsp;<span class="builtintype" id="4374479">nil</span>&nbsp;<span class="op" id="4374483">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374487">return</span>&nbsp;<span class="builtintype" id="4374494">nil</span><span class="op" id="4374497">,</span>&nbsp;<span class="ident" id="4374499">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374507">ret</span>&nbsp;<span class="op" id="4374511">:=</span>&nbsp;<span class="op" id="4374514">&amp;</span><span class="ident" id="4374515">Template</span><span class="op" id="4374523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4374527">nil</span><span class="op" id="4374530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374534">textClone</span><span class="op" id="4374543">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374547">textClone</span><span class="op" id="4374556">.</span><span class="ident" id="4374557">Tree</span><span class="op" id="4374561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374565">&amp;</span><span class="ident" id="4374566">nameSpace</span><span class="op" id="4374575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374580">set</span><span class="op" id="4374583">:</span>&nbsp;<span class="builtinfunc" id="4374585">make</span><span class="op" id="4374589">(</span><span class="keyword" id="4374590">map</span><span class="op" id="4374593">[</span><span class="builtintype" id="4374594">string</span><span class="op" id="4374600">]</span><span class="op" id="4374601">*</span><span class="ident" id="4374602">Template</span><span class="op" id="4374610">)</span><span class="op" id="4374611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374615">}</span><span class="op" id="4374616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374619">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374622">for</span>&nbsp;<span class="ident" id="4374626">_</span><span class="op" id="4374627">,</span>&nbsp;<span class="ident" id="4374629">x</span>&nbsp;<span class="op" id="4374631">:=</span>&nbsp;<span class="keyword" id="4374634">range</span>&nbsp;<span class="ident" id="4374640">textClone</span><span class="op" id="4374649">.</span><span class="ident" id="4374650">Templates</span><span class="op" id="4374659">(</span><span class="op" id="4374660">)</span>&nbsp;<span class="op" id="4374662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374666">name</span>&nbsp;<span class="op" id="4374671">:=</span>&nbsp;<span class="ident" id="4374674">x</span><span class="op" id="4374675">.</span><span class="ident" id="4374676">Name</span><span class="op" id="4374680">(</span><span class="op" id="4374681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374685">src</span>&nbsp;<span class="op" id="4374689">:=</span>&nbsp;<span class="ident" id="4374692">t</span><span class="op" id="4374693">.</span><span class="ident" id="4374694">set</span><span class="op" id="4374697">[</span><span class="ident" id="4374698">name</span><span class="op" id="4374702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374706">if</span>&nbsp;<span class="ident" id="4374709">src</span>&nbsp;<span class="op" id="4374713">==</span>&nbsp;<span class="builtintype" id="4374716">nil</span>&nbsp;<span class="op" id="4374720">||</span>&nbsp;<span class="ident" id="4374723">src</span><span class="op" id="4374726">.</span><span class="ident" id="4374727">escapeErr</span>&nbsp;<span class="op" id="4374737">!=</span>&nbsp;<span class="builtintype" id="4374740">nil</span>&nbsp;<span class="op" id="4374744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374749">return</span>&nbsp;<span class="builtintype" id="4374756">nil</span><span class="op" id="4374759">,</span>&nbsp;<span class="ident" id="4374761">fmt</span><span class="op" id="4374764">.</span><span class="ident" id="4374765">Errorf</span><span class="op" id="4374771">(</span><span class="string" id="4374772">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4374826">,</span>&nbsp;<span class="ident" id="4374828">t</span><span class="op" id="4374829">.</span><span class="ident" id="4374830">Name</span><span class="op" id="4374834">(</span><span class="op" id="4374835">)</span><span class="op" id="4374836">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374844">x</span><span class="op" id="4374845">.</span><span class="ident" id="4374846">Tree</span>&nbsp;<span class="op" id="4374851">=</span>&nbsp;<span class="ident" id="4374853">x</span><span class="op" id="4374854">.</span><span class="ident" id="4374855">Tree</span><span class="op" id="4374859">.</span><span class="ident" id="4374860">Copy</span><span class="op" id="4374864">(</span><span class="op" id="4374865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374869">ret</span><span class="op" id="4374872">.</span><span class="ident" id="4374873">set</span><span class="op" id="4374876">[</span><span class="ident" id="4374877">name</span><span class="op" id="4374881">]</span>&nbsp;<span class="op" id="4374883">=</span>&nbsp;<span class="op" id="4374885">&amp;</span><span class="ident" id="4374886">Template</span><span class="op" id="4374894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4374899">nil</span><span class="op" id="4374902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374907">x</span><span class="op" id="4374908">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374913">x</span><span class="op" id="4374914">.</span><span class="ident" id="4374915">Tree</span><span class="op" id="4374919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374924">ret</span><span class="op" id="4374927">.</span><span class="ident" id="4374928">nameSpace</span><span class="op" id="4374937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374947">return</span>&nbsp;<span class="ident" id="4374954">ret</span><span class="op" id="4374957">,</span>&nbsp;<span class="builtintype" id="4374959">nil</span><br>
<span class="lineno">220</span><span class="op" id="4374963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4374966">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4375024">func</span>&nbsp;<span class="ident" id="4375029">New</span><span class="op" id="4375032">(</span><span class="ident" id="4375033">name</span>&nbsp;<span class="builtintype" id="4375038">string</span><span class="op" id="4375044">)</span>&nbsp;<span class="op" id="4375046">*</span><span class="ident" id="4375047">Template</span>&nbsp;<span class="op" id="4375056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375059">tmpl</span>&nbsp;<span class="op" id="4375064">:=</span>&nbsp;<span class="op" id="4375067">&amp;</span><span class="ident" id="4375068">Template</span><span class="op" id="4375076">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4375080">nil</span><span class="op" id="4375083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375087">template</span><span class="op" id="4375095">.</span><span class="ident" id="4375096">New</span><span class="op" id="4375099">(</span><span class="ident" id="4375100">name</span><span class="op" id="4375104">)</span><span class="op" id="4375105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4375109">nil</span><span class="op" id="4375112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375116">&amp;</span><span class="ident" id="4375117">nameSpace</span><span class="op" id="4375126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375131">set</span><span class="op" id="4375134">:</span>&nbsp;<span class="builtinfunc" id="4375136">make</span><span class="op" id="4375140">(</span><span class="keyword" id="4375141">map</span><span class="op" id="4375144">[</span><span class="builtintype" id="4375145">string</span><span class="op" id="4375151">]</span><span class="op" id="4375152">*</span><span class="ident" id="4375153">Template</span><span class="op" id="4375161">)</span><span class="op" id="4375162">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375166">}</span><span class="op" id="4375167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375173">tmpl</span><span class="op" id="4375177">.</span><span class="ident" id="4375178">set</span><span class="op" id="4375181">[</span><span class="ident" id="4375182">name</span><span class="op" id="4375186">]</span>&nbsp;<span class="op" id="4375188">=</span>&nbsp;<span class="ident" id="4375190">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375196">return</span>&nbsp;<span class="ident" id="4375203">tmpl</span><br>
<span class="lineno"></span><span class="op" id="4375208">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="4375211">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4375278">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="4375349">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4375418">func</span>&nbsp;<span class="op" id="4375423">(</span><span class="ident" id="4375424">t</span>&nbsp;<span class="op" id="4375426">*</span><span class="ident" id="4375427">Template</span><span class="op" id="4375435">)</span>&nbsp;<span class="ident" id="4375437">New</span><span class="op" id="4375440">(</span><span class="ident" id="4375441">name</span>&nbsp;<span class="builtintype" id="4375446">string</span><span class="op" id="4375452">)</span>&nbsp;<span class="op" id="4375454">*</span><span class="ident" id="4375455">Template</span>&nbsp;<span class="op" id="4375464">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375467">t</span><span class="op" id="4375468">.</span><span class="ident" id="4375469">nameSpace</span><span class="op" id="4375478">.</span><span class="ident" id="4375479">mu</span><span class="op" id="4375481">.</span><span class="ident" id="4375482">Lock</span><span class="op" id="4375486">(</span><span class="op" id="4375487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375490">defer</span>&nbsp;<span class="ident" id="4375496">t</span><span class="op" id="4375497">.</span><span class="ident" id="4375498">nameSpace</span><span class="op" id="4375507">.</span><span class="ident" id="4375508">mu</span><span class="op" id="4375510">.</span><span class="ident" id="4375511">Unlock</span><span class="op" id="4375517">(</span><span class="op" id="4375518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375521">return</span>&nbsp;<span class="ident" id="4375528">t</span><span class="op" id="4375529">.</span><span class="builtinfunc" id="4375530">new</span><span class="op" id="4375533">(</span><span class="ident" id="4375534">name</span><span class="op" id="4375538">)</span><br>
<span class="lineno"></span><span class="op" id="4375540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4375543">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="4375598">func</span>&nbsp;<span class="op" id="4375603">(</span><span class="ident" id="4375604">t</span>&nbsp;<span class="op" id="4375606">*</span><span class="ident" id="4375607">Template</span><span class="op" id="4375615">)</span>&nbsp;<span class="builtinfunc" id="4375617">new</span><span class="op" id="4375620">(</span><span class="ident" id="4375621">name</span>&nbsp;<span class="builtintype" id="4375626">string</span><span class="op" id="4375632">)</span>&nbsp;<span class="op" id="4375634">*</span><span class="ident" id="4375635">Template</span>&nbsp;<span class="op" id="4375644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375647">tmpl</span>&nbsp;<span class="op" id="4375652">:=</span>&nbsp;<span class="op" id="4375655">&amp;</span><span class="ident" id="4375656">Template</span><span class="op" id="4375664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4375668">nil</span><span class="op" id="4375671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375675">t</span><span class="op" id="4375676">.</span><span class="ident" id="4375677">text</span><span class="op" id="4375681">.</span><span class="ident" id="4375682">New</span><span class="op" id="4375685">(</span><span class="ident" id="4375686">name</span><span class="op" id="4375690">)</span><span class="op" id="4375691">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4375695">nil</span><span class="op" id="4375698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375702">t</span><span class="op" id="4375703">.</span><span class="ident" id="4375704">nameSpace</span><span class="op" id="4375713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375719">tmpl</span><span class="op" id="4375723">.</span><span class="ident" id="4375724">set</span><span class="op" id="4375727">[</span><span class="ident" id="4375728">name</span><span class="op" id="4375732">]</span>&nbsp;<span class="op" id="4375734">=</span>&nbsp;<span class="ident" id="4375736">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375742">return</span>&nbsp;<span class="ident" id="4375749">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="4375754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4375757">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4375799">func</span>&nbsp;<span class="op" id="4375804">(</span><span class="ident" id="4375805">t</span>&nbsp;<span class="op" id="4375807">*</span><span class="ident" id="4375808">Template</span><span class="op" id="4375816">)</span>&nbsp;<span class="ident" id="4375818">Name</span><span class="op" id="4375822">(</span><span class="op" id="4375823">)</span>&nbsp;<span class="builtintype" id="4375825">string</span>&nbsp;<span class="op" id="4375832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375835">return</span>&nbsp;<span class="ident" id="4375842">t</span><span class="op" id="4375843">.</span><span class="ident" id="4375844">text</span><span class="op" id="4375848">.</span><span class="ident" id="4375849">Name</span><span class="op" id="4375853">(</span><span class="op" id="4375854">)</span><br>
<span class="lineno">260</span><span class="op" id="4375856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4375859">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4375928">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="4376003">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="4376077">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="4376153">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4376230">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="4376303">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4376323">type</span>&nbsp;<span class="ident" id="4376328">FuncMap</span>&nbsp;<span class="keyword" id="4376336">map</span><span class="op" id="4376339">[</span><span class="builtintype" id="4376340">string</span><span class="op" id="4376346">]</span><span class="keyword" id="4376347">interface</span><span class="op" id="4376356">{</span><span class="op" id="4376357">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4376360">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4376439">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4376516">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4376591">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="4376642">func</span>&nbsp;<span class="op" id="4376647">(</span><span class="ident" id="4376648">t</span>&nbsp;<span class="op" id="4376650">*</span><span class="ident" id="4376651">Template</span><span class="op" id="4376659">)</span>&nbsp;<span class="ident" id="4376661">Funcs</span><span class="op" id="4376666">(</span><span class="ident" id="4376667">funcMap</span>&nbsp;<span class="ident" id="4376675">FuncMap</span><span class="op" id="4376682">)</span>&nbsp;<span class="op" id="4376684">*</span><span class="ident" id="4376685">Template</span>&nbsp;<span class="op" id="4376694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4376697">t</span><span class="op" id="4376698">.</span><span class="ident" id="4376699">text</span><span class="op" id="4376703">.</span><span class="ident" id="4376704">Funcs</span><span class="op" id="4376709">(</span><span class="ident" id="4376710">template</span><span class="op" id="4376718">.</span><span class="ident" id="4376719">FuncMap</span><span class="op" id="4376726">(</span><span class="ident" id="4376727">funcMap</span><span class="op" id="4376734">)</span><span class="op" id="4376735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4376738">return</span>&nbsp;<span class="ident" id="4376745">t</span><br>
<span class="lineno"></span><span class="op" id="4376747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="4376750">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4376827">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4376899">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4376975">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="4377011">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="4377073">func</span>&nbsp;<span class="op" id="4377078">(</span><span class="ident" id="4377079">t</span>&nbsp;<span class="op" id="4377081">*</span><span class="ident" id="4377082">Template</span><span class="op" id="4377090">)</span>&nbsp;<span class="ident" id="4377092">Delims</span><span class="op" id="4377098">(</span><span class="ident" id="4377099">left</span><span class="op" id="4377103">,</span>&nbsp;<span class="ident" id="4377105">right</span>&nbsp;<span class="builtintype" id="4377111">string</span><span class="op" id="4377117">)</span>&nbsp;<span class="op" id="4377119">*</span><span class="ident" id="4377120">Template</span>&nbsp;<span class="op" id="4377129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4377132">t</span><span class="op" id="4377133">.</span><span class="ident" id="4377134">text</span><span class="op" id="4377138">.</span><span class="ident" id="4377139">Delims</span><span class="op" id="4377145">(</span><span class="ident" id="4377146">left</span><span class="op" id="4377150">,</span>&nbsp;<span class="ident" id="4377152">right</span><span class="op" id="4377157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4377160">return</span>&nbsp;<span class="ident" id="4377167">t</span><br>
<span class="lineno"></span><span class="op" id="4377169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="4377172">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="4377250">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4377290">func</span>&nbsp;<span class="op" id="4377295">(</span><span class="ident" id="4377296">t</span>&nbsp;<span class="op" id="4377298">*</span><span class="ident" id="4377299">Template</span><span class="op" id="4377307">)</span>&nbsp;<span class="ident" id="4377309">Lookup</span><span class="op" id="4377315">(</span><span class="ident" id="4377316">name</span>&nbsp;<span class="builtintype" id="4377321">string</span><span class="op" id="4377327">)</span>&nbsp;<span class="op" id="4377329">*</span><span class="ident" id="4377330">Template</span>&nbsp;<span class="op" id="4377339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4377342">t</span><span class="op" id="4377343">.</span><span class="ident" id="4377344">nameSpace</span><span class="op" id="4377353">.</span><span class="ident" id="4377354">mu</span><span class="op" id="4377356">.</span><span class="ident" id="4377357">Lock</span><span class="op" id="4377361">(</span><span class="op" id="4377362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4377365">defer</span>&nbsp;<span class="ident" id="4377371">t</span><span class="op" id="4377372">.</span><span class="ident" id="4377373">nameSpace</span><span class="op" id="4377382">.</span><span class="ident" id="4377383">mu</span><span class="op" id="4377385">.</span><span class="ident" id="4377386">Unlock</span><span class="op" id="4377392">(</span><span class="op" id="4377393">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4377396">return</span>&nbsp;<span class="ident" id="4377403">t</span><span class="op" id="4377404">.</span><span class="ident" id="4377405">set</span><span class="op" id="4377408">[</span><span class="ident" id="4377409">name</span><span class="op" id="4377413">]</span><br>
<span class="lineno"></span><span class="op" id="4377415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4377418">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="4377499">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="4377589">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4377600">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="4377661">func</span>&nbsp;<span class="ident" id="4377666">Must</span><span class="op" id="4377670">(</span><span class="ident" id="4377671">t</span>&nbsp;<span class="op" id="4377673">*</span><span class="ident" id="4377674">Template</span><span class="op" id="4377682">,</span>&nbsp;<span class="ident" id="4377684">err</span>&nbsp;<span class="builtintype" id="4377688">error</span><span class="op" id="4377693">)</span>&nbsp;<span class="op" id="4377695">*</span><span class="ident" id="4377696">Template</span>&nbsp;<span class="op" id="4377705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4377708">if</span>&nbsp;<span class="ident" id="4377711">err</span>&nbsp;<span class="op" id="4377715">!=</span>&nbsp;<span class="builtintype" id="4377718">nil</span>&nbsp;<span class="op" id="4377722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4377726">panic</span><span class="op" id="4377731">(</span><span class="ident" id="4377732">err</span><span class="op" id="4377735">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4377738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4377741">return</span>&nbsp;<span class="ident" id="4377748">t</span><br>
<span class="lineno"></span><span class="op" id="4377750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4377753">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="4377831">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4377910">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4377983">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4378055">func</span>&nbsp;<span class="ident" id="4378060">ParseFiles</span><span class="op" id="4378070">(</span><span class="ident" id="4378071">filenames</span>&nbsp;<span class="op" id="4378081">...</span><span class="builtintype" id="4378084">string</span><span class="op" id="4378090">)</span>&nbsp;<span class="op" id="4378092">(</span><span class="op" id="4378093">*</span><span class="ident" id="4378094">Template</span><span class="op" id="4378102">,</span>&nbsp;<span class="builtintype" id="4378104">error</span><span class="op" id="4378109">)</span>&nbsp;<span class="op" id="4378111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378114">return</span>&nbsp;<span class="ident" id="4378121">parseFiles</span><span class="op" id="4378131">(</span><span class="builtintype" id="4378132">nil</span><span class="op" id="4378135">,</span>&nbsp;<span class="ident" id="4378137">filenames</span><span class="op" id="4378146">...</span><span class="op" id="4378149">)</span><br>
<span class="lineno">315</span><span class="op" id="4378151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4378154">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4378235">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4378309">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="4378364">func</span>&nbsp;<span class="op" id="4378369">(</span><span class="ident" id="4378370">t</span>&nbsp;<span class="op" id="4378372">*</span><span class="ident" id="4378373">Template</span><span class="op" id="4378381">)</span>&nbsp;<span class="ident" id="4378383">ParseFiles</span><span class="op" id="4378393">(</span><span class="ident" id="4378394">filenames</span>&nbsp;<span class="op" id="4378404">...</span><span class="builtintype" id="4378407">string</span><span class="op" id="4378413">)</span>&nbsp;<span class="op" id="4378415">(</span><span class="op" id="4378416">*</span><span class="ident" id="4378417">Template</span><span class="op" id="4378425">,</span>&nbsp;<span class="builtintype" id="4378427">error</span><span class="op" id="4378432">)</span>&nbsp;<span class="op" id="4378434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378437">return</span>&nbsp;<span class="ident" id="4378444">parseFiles</span><span class="op" id="4378454">(</span><span class="ident" id="4378455">t</span><span class="op" id="4378456">,</span>&nbsp;<span class="ident" id="4378458">filenames</span><span class="op" id="4378467">...</span><span class="op" id="4378470">)</span><br>
<span class="lineno"></span><span class="op" id="4378472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4378475">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="4378548">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4378603">func</span>&nbsp;<span class="ident" id="4378608">parseFiles</span><span class="op" id="4378618">(</span><span class="ident" id="4378619">t</span>&nbsp;<span class="op" id="4378621">*</span><span class="ident" id="4378622">Template</span><span class="op" id="4378630">,</span>&nbsp;<span class="ident" id="4378632">filenames</span>&nbsp;<span class="op" id="4378642">...</span><span class="builtintype" id="4378645">string</span><span class="op" id="4378651">)</span>&nbsp;<span class="op" id="4378653">(</span><span class="op" id="4378654">*</span><span class="ident" id="4378655">Template</span><span class="op" id="4378663">,</span>&nbsp;<span class="builtintype" id="4378665">error</span><span class="op" id="4378670">)</span>&nbsp;<span class="op" id="4378672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378675">if</span>&nbsp;<span class="builtinfunc" id="4378678">len</span><span class="op" id="4378681">(</span><span class="ident" id="4378682">filenames</span><span class="op" id="4378691">)</span>&nbsp;<span class="op" id="4378693">==</span>&nbsp;<span class="num" id="4378696">0</span>&nbsp;<span class="op" id="4378698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4378702">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378748">return</span>&nbsp;<span class="builtintype" id="4378755">nil</span><span class="op" id="4378758">,</span>&nbsp;<span class="ident" id="4378760">fmt</span><span class="op" id="4378763">.</span><span class="ident" id="4378764">Errorf</span><span class="op" id="4378770">(</span><span class="string" id="4378771">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="4378824">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4378827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378830">for</span>&nbsp;<span class="ident" id="4378834">_</span><span class="op" id="4378835">,</span>&nbsp;<span class="ident" id="4378837">filename</span>&nbsp;<span class="op" id="4378846">:=</span>&nbsp;<span class="keyword" id="4378849">range</span>&nbsp;<span class="ident" id="4378855">filenames</span>&nbsp;<span class="op" id="4378865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4378869">b</span><span class="op" id="4378870">,</span>&nbsp;<span class="ident" id="4378872">err</span>&nbsp;<span class="op" id="4378876">:=</span>&nbsp;<span class="ident" id="4378879">ioutil</span><span class="op" id="4378885">.</span><span class="ident" id="4378886">ReadFile</span><span class="op" id="4378894">(</span><span class="ident" id="4378895">filename</span><span class="op" id="4378903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378907">if</span>&nbsp;<span class="ident" id="4378910">err</span>&nbsp;<span class="op" id="4378914">!=</span>&nbsp;<span class="builtintype" id="4378917">nil</span>&nbsp;<span class="op" id="4378921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4378926">return</span>&nbsp;<span class="builtintype" id="4378933">nil</span><span class="op" id="4378936">,</span>&nbsp;<span class="ident" id="4378938">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4378944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4378948">s</span>&nbsp;<span class="op" id="4378950">:=</span>&nbsp;<span class="builtintype" id="4378953">string</span><span class="op" id="4378959">(</span><span class="ident" id="4378960">b</span><span class="op" id="4378961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4378965">name</span>&nbsp;<span class="op" id="4378970">:=</span>&nbsp;<span class="ident" id="4378973">filepath</span><span class="op" id="4378981">.</span><span class="ident" id="4378982">Base</span><span class="op" id="4378986">(</span><span class="ident" id="4378987">filename</span><span class="op" id="4378995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4378999">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379064">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379127">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379197">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379248">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379302">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379368">var</span>&nbsp;<span class="ident" id="4379372">tmpl</span>&nbsp;<span class="op" id="4379377">*</span><span class="ident" id="4379378">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379389">if</span>&nbsp;<span class="ident" id="4379392">t</span>&nbsp;<span class="op" id="4379394">==</span>&nbsp;<span class="builtintype" id="4379397">nil</span>&nbsp;<span class="op" id="4379401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379406">t</span>&nbsp;<span class="op" id="4379408">=</span>&nbsp;<span class="ident" id="4379410">New</span><span class="op" id="4379413">(</span><span class="ident" id="4379414">name</span><span class="op" id="4379418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379426">if</span>&nbsp;<span class="ident" id="4379429">name</span>&nbsp;<span class="op" id="4379434">==</span>&nbsp;<span class="ident" id="4379437">t</span><span class="op" id="4379438">.</span><span class="ident" id="4379439">Name</span><span class="op" id="4379443">(</span><span class="op" id="4379444">)</span>&nbsp;<span class="op" id="4379446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379451">tmpl</span>&nbsp;<span class="op" id="4379456">=</span>&nbsp;<span class="ident" id="4379458">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379462">}</span>&nbsp;<span class="keyword" id="4379464">else</span>&nbsp;<span class="op" id="4379469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379474">tmpl</span>&nbsp;<span class="op" id="4379479">=</span>&nbsp;<span class="ident" id="4379481">t</span><span class="op" id="4379482">.</span><span class="ident" id="4379483">New</span><span class="op" id="4379486">(</span><span class="ident" id="4379487">name</span><span class="op" id="4379491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379499">_</span><span class="op" id="4379500">,</span>&nbsp;<span class="ident" id="4379502">err</span>&nbsp;<span class="op" id="4379506">=</span>&nbsp;<span class="ident" id="4379508">tmpl</span><span class="op" id="4379512">.</span><span class="ident" id="4379513">Parse</span><span class="op" id="4379518">(</span><span class="ident" id="4379519">s</span><span class="op" id="4379520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379524">if</span>&nbsp;<span class="ident" id="4379527">err</span>&nbsp;<span class="op" id="4379531">!=</span>&nbsp;<span class="builtintype" id="4379534">nil</span>&nbsp;<span class="op" id="4379538">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379543">return</span>&nbsp;<span class="builtintype" id="4379550">nil</span><span class="op" id="4379553">,</span>&nbsp;<span class="ident" id="4379555">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4379567">return</span>&nbsp;<span class="ident" id="4379574">t</span><span class="op" id="4379575">,</span>&nbsp;<span class="builtintype" id="4379577">nil</span><br>
<span class="lineno"></span><span class="op" id="4379581">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="4379584">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4379665">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4379741">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4379817">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="4379890">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="4379951">func</span>&nbsp;<span class="ident" id="4379956">ParseGlob</span><span class="op" id="4379965">(</span><span class="ident" id="4379966">pattern</span>&nbsp;<span class="builtintype" id="4379974">string</span><span class="op" id="4379980">)</span>&nbsp;<span class="op" id="4379982">(</span><span class="op" id="4379983">*</span><span class="ident" id="4379984">Template</span><span class="op" id="4379992">,</span>&nbsp;<span class="builtintype" id="4379994">error</span><span class="op" id="4379999">)</span>&nbsp;<span class="op" id="4380001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380004">return</span>&nbsp;<span class="ident" id="4380011">parseGlob</span><span class="op" id="4380020">(</span><span class="builtintype" id="4380021">nil</span><span class="op" id="4380024">,</span>&nbsp;<span class="ident" id="4380026">pattern</span><span class="op" id="4380033">)</span><br>
<span class="lineno"></span><span class="op" id="4380035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="4380038">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4380114">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4380187">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4380264">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4380340">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="4380352">func</span>&nbsp;<span class="op" id="4380357">(</span><span class="ident" id="4380358">t</span>&nbsp;<span class="op" id="4380360">*</span><span class="ident" id="4380361">Template</span><span class="op" id="4380369">)</span>&nbsp;<span class="ident" id="4380371">ParseGlob</span><span class="op" id="4380380">(</span><span class="ident" id="4380381">pattern</span>&nbsp;<span class="builtintype" id="4380389">string</span><span class="op" id="4380395">)</span>&nbsp;<span class="op" id="4380397">(</span><span class="op" id="4380398">*</span><span class="ident" id="4380399">Template</span><span class="op" id="4380407">,</span>&nbsp;<span class="builtintype" id="4380409">error</span><span class="op" id="4380414">)</span>&nbsp;<span class="op" id="4380416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380419">return</span>&nbsp;<span class="ident" id="4380426">parseGlob</span><span class="op" id="4380435">(</span><span class="ident" id="4380436">t</span><span class="op" id="4380437">,</span>&nbsp;<span class="ident" id="4380439">pattern</span><span class="op" id="4380446">)</span><br>
<span class="lineno"></span><span class="op" id="4380448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380451">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="4380524">func</span>&nbsp;<span class="ident" id="4380529">parseGlob</span><span class="op" id="4380538">(</span><span class="ident" id="4380539">t</span>&nbsp;<span class="op" id="4380541">*</span><span class="ident" id="4380542">Template</span><span class="op" id="4380550">,</span>&nbsp;<span class="ident" id="4380552">pattern</span>&nbsp;<span class="builtintype" id="4380560">string</span><span class="op" id="4380566">)</span>&nbsp;<span class="op" id="4380568">(</span><span class="op" id="4380569">*</span><span class="ident" id="4380570">Template</span><span class="op" id="4380578">,</span>&nbsp;<span class="builtintype" id="4380580">error</span><span class="op" id="4380585">)</span>&nbsp;<span class="op" id="4380587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380590">filenames</span><span class="op" id="4380599">,</span>&nbsp;<span class="ident" id="4380601">err</span>&nbsp;<span class="op" id="4380605">:=</span>&nbsp;<span class="ident" id="4380608">filepath</span><span class="op" id="4380616">.</span><span class="ident" id="4380617">Glob</span><span class="op" id="4380621">(</span><span class="ident" id="4380622">pattern</span><span class="op" id="4380629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380632">if</span>&nbsp;<span class="ident" id="4380635">err</span>&nbsp;<span class="op" id="4380639">!=</span>&nbsp;<span class="builtintype" id="4380642">nil</span>&nbsp;<span class="op" id="4380646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380650">return</span>&nbsp;<span class="builtintype" id="4380657">nil</span><span class="op" id="4380660">,</span>&nbsp;<span class="ident" id="4380662">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4380667">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380670">if</span>&nbsp;<span class="builtinfunc" id="4380673">len</span><span class="op" id="4380676">(</span><span class="ident" id="4380677">filenames</span><span class="op" id="4380686">)</span>&nbsp;<span class="op" id="4380688">==</span>&nbsp;<span class="num" id="4380691">0</span>&nbsp;<span class="op" id="4380693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380697">return</span>&nbsp;<span class="builtintype" id="4380704">nil</span><span class="op" id="4380707">,</span>&nbsp;<span class="ident" id="4380709">fmt</span><span class="op" id="4380712">.</span><span class="ident" id="4380713">Errorf</span><span class="op" id="4380719">(</span><span class="string" id="4380720">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="4380766">,</span>&nbsp;<span class="ident" id="4380768">pattern</span><span class="op" id="4380775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4380778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380781">return</span>&nbsp;<span class="ident" id="4380788">parseFiles</span><span class="op" id="4380798">(</span><span class="ident" id="4380799">t</span><span class="op" id="4380800">,</span>&nbsp;<span class="ident" id="4380802">filenames</span><span class="op" id="4380811">...</span><span class="op" id="4380814">)</span><br>
<span class="lineno"></span><span class="op" id="4380816">}</span>
</div>
</body>
</html>
