<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/scanner</h2>
<ul>
<li><a href="/gostd/go/scanner/errors.go.html">errors.go</a></li>
<li><a href="/gostd/go/scanner/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/go/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5066074">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5066129">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5066183">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5066234">//&nbsp;Package&nbsp;scanner&nbsp;implements&nbsp;a&nbsp;scanner&nbsp;for&nbsp;Go&nbsp;source&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5066294">//&nbsp;It&nbsp;takes&nbsp;a&nbsp;[]byte&nbsp;as&nbsp;source&nbsp;which&nbsp;can&nbsp;then&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="5066353">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="5066399">//</span><br>
<span class="lineno"></span><span class="keyword" id="5066402">package</span>&nbsp;<span class="ident" id="5066410">scanner</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5066419">import</span>&nbsp;<span class="op" id="5066426">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066429">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066438">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066445">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066457">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066474">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066485">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5066496">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5066511">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5066514">//&nbsp;An&nbsp;ErrorHandler&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Scanner.Init.&nbsp;If&nbsp;a&nbsp;syntax&nbsp;error&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5066587">//&nbsp;encountered&nbsp;and&nbsp;a&nbsp;handler&nbsp;was&nbsp;installed,&nbsp;the&nbsp;handler&nbsp;is&nbsp;called&nbsp;with&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5066660">//&nbsp;position&nbsp;and&nbsp;an&nbsp;error&nbsp;message.&nbsp;The&nbsp;position&nbsp;points&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5066734">//&nbsp;the&nbsp;offending&nbsp;token.</span><br>
<span class="lineno">25</span><span class="comment" id="5066758">//</span><br>
<span class="lineno"></span><span class="keyword" id="5066761">type</span>&nbsp;<span class="ident" id="5066766">ErrorHandler</span>&nbsp;<span class="keyword" id="5066779">func</span><span class="op" id="5066783">(</span><span class="ident" id="5066784">pos</span>&nbsp;<span class="ident" id="5066788">token</span><span class="op" id="5066793">.</span><span class="ident" id="5066794">Position</span><span class="op" id="5066802">,</span>&nbsp;<span class="ident" id="5066804">msg</span>&nbsp;<span class="builtintype" id="5066808">string</span><span class="op" id="5066814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5066817">//&nbsp;A&nbsp;Scanner&nbsp;holds&nbsp;the&nbsp;scanner&#39;s&nbsp;internal&nbsp;state&nbsp;while&nbsp;processing</span><br>
<span class="lineno"></span><span class="comment" id="5066882">//&nbsp;a&nbsp;given&nbsp;text.&nbsp;&nbsp;It&nbsp;can&nbsp;be&nbsp;allocated&nbsp;as&nbsp;part&nbsp;of&nbsp;another&nbsp;data</span><br>
<span class="lineno">30</span><span class="comment" id="5066944">//&nbsp;structure&nbsp;but&nbsp;must&nbsp;be&nbsp;initialized&nbsp;via&nbsp;Init&nbsp;before&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="5067002">//</span><br>
<span class="lineno"></span><span class="keyword" id="5067005">type</span>&nbsp;<span class="ident" id="5067010">Scanner</span>&nbsp;<span class="keyword" id="5067018">struct</span>&nbsp;<span class="op" id="5067025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067028">//&nbsp;immutable&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067048">file</span>&nbsp;<span class="op" id="5067053">*</span><span class="ident" id="5067054">token</span><span class="op" id="5067059">.</span><span class="ident" id="5067060">File</span>&nbsp;&nbsp;<span class="comment" id="5067066">//&nbsp;source&nbsp;file&nbsp;handle</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067089">dir</span>&nbsp;&nbsp;<span class="builtintype" id="5067094">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067107">//&nbsp;directory&nbsp;portion&nbsp;of&nbsp;file.Name()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067144">src</span>&nbsp;&nbsp;<span class="op" id="5067149">[</span><span class="op" id="5067150">]</span><span class="builtintype" id="5067151">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067162">//&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067173">err</span>&nbsp;&nbsp;<span class="ident" id="5067178">ErrorHandler</span>&nbsp;<span class="comment" id="5067191">//&nbsp;error&nbsp;reporting;&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067219">mode</span>&nbsp;<span class="ident" id="5067224">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067237">//&nbsp;scanning&nbsp;mode</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067256">//&nbsp;scanning&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067275">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5067286">rune</span>&nbsp;<span class="comment" id="5067291">//&nbsp;current&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067313">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5067324">int</span>&nbsp;&nbsp;<span class="comment" id="5067329">//&nbsp;character&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067350">rdOffset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5067361">int</span>&nbsp;&nbsp;<span class="comment" id="5067366">//&nbsp;reading&nbsp;offset&nbsp;(position&nbsp;after&nbsp;current&nbsp;character)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067420">lineOffset</span>&nbsp;<span class="builtintype" id="5067431">int</span>&nbsp;&nbsp;<span class="comment" id="5067436">//&nbsp;current&nbsp;line&nbsp;offset</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067460">insertSemi</span>&nbsp;<span class="builtintype" id="5067471">bool</span>&nbsp;<span class="comment" id="5067476">//&nbsp;insert&nbsp;a&nbsp;semicolon&nbsp;before&nbsp;next&nbsp;newline</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5067520">//&nbsp;public&nbsp;state&nbsp;-&nbsp;ok&nbsp;to&nbsp;modify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067552">ErrorCount</span>&nbsp;<span class="builtintype" id="5067563">int</span>&nbsp;<span class="comment" id="5067567">//&nbsp;number&nbsp;of&nbsp;errors&nbsp;encountered</span><br>
<span class="lineno"></span><span class="op" id="5067599">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5067602">const</span>&nbsp;<span class="ident" id="5067608">bom</span>&nbsp;<span class="op" id="5067612">=</span>&nbsp;<span class="num" id="5067614">0xFEFF</span>&nbsp;<span class="comment" id="5067621">//&nbsp;byte&nbsp;order&nbsp;mark,&nbsp;only&nbsp;permitted&nbsp;as&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5067681">//&nbsp;Read&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;char&nbsp;into&nbsp;s.ch.</span><br>
<span class="lineno"></span><span class="comment" id="5067722">//&nbsp;s.ch&nbsp;&lt;&nbsp;0&nbsp;means&nbsp;end-of-file.</span><br>
<span class="lineno">55</span><span class="comment" id="5067753">//</span><br>
<span class="lineno"></span><span class="keyword" id="5067756">func</span>&nbsp;<span class="op" id="5067761">(</span><span class="ident" id="5067762">s</span>&nbsp;<span class="op" id="5067764">*</span><span class="ident" id="5067765">Scanner</span><span class="op" id="5067772">)</span>&nbsp;<span class="ident" id="5067774">next</span><span class="op" id="5067778">(</span><span class="op" id="5067779">)</span>&nbsp;<span class="op" id="5067781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067784">if</span>&nbsp;<span class="ident" id="5067787">s</span><span class="op" id="5067788">.</span><span class="ident" id="5067789">rdOffset</span>&nbsp;<span class="op" id="5067798">&lt;</span>&nbsp;<span class="builtinfunc" id="5067800">len</span><span class="op" id="5067803">(</span><span class="ident" id="5067804">s</span><span class="op" id="5067805">.</span><span class="ident" id="5067806">src</span><span class="op" id="5067809">)</span>&nbsp;<span class="op" id="5067811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067815">s</span><span class="op" id="5067816">.</span><span class="ident" id="5067817">offset</span>&nbsp;<span class="op" id="5067824">=</span>&nbsp;<span class="ident" id="5067826">s</span><span class="op" id="5067827">.</span><span class="ident" id="5067828">rdOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067839">if</span>&nbsp;<span class="ident" id="5067842">s</span><span class="op" id="5067843">.</span><span class="ident" id="5067844">ch</span>&nbsp;<span class="op" id="5067847">==</span>&nbsp;<span class="string" id="5067850">&#39;\n&#39;</span>&nbsp;<span class="op" id="5067855">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067860">s</span><span class="op" id="5067861">.</span><span class="ident" id="5067862">lineOffset</span>&nbsp;<span class="op" id="5067873">=</span>&nbsp;<span class="ident" id="5067875">s</span><span class="op" id="5067876">.</span><span class="ident" id="5067877">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067887">s</span><span class="op" id="5067888">.</span><span class="ident" id="5067889">file</span><span class="op" id="5067893">.</span><span class="ident" id="5067894">AddLine</span><span class="op" id="5067901">(</span><span class="ident" id="5067902">s</span><span class="op" id="5067903">.</span><span class="ident" id="5067904">offset</span><span class="op" id="5067910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5067914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067918">r</span><span class="op" id="5067919">,</span>&nbsp;<span class="ident" id="5067921">w</span>&nbsp;<span class="op" id="5067923">:=</span>&nbsp;<span class="builtintype" id="5067926">rune</span><span class="op" id="5067930">(</span><span class="ident" id="5067931">s</span><span class="op" id="5067932">.</span><span class="ident" id="5067933">src</span><span class="op" id="5067936">[</span><span class="ident" id="5067937">s</span><span class="op" id="5067938">.</span><span class="ident" id="5067939">rdOffset</span><span class="op" id="5067947">]</span><span class="op" id="5067948">)</span><span class="op" id="5067949">,</span>&nbsp;<span class="num" id="5067951">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067955">switch</span>&nbsp;<span class="op" id="5067962">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5067966">case</span>&nbsp;<span class="ident" id="5067971">r</span>&nbsp;<span class="op" id="5067973">==</span>&nbsp;<span class="num" id="5067976">0</span><span class="op" id="5067977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5067982">s</span><span class="op" id="5067983">.</span><span class="builtintype" id="5067984">error</span><span class="op" id="5067989">(</span><span class="ident" id="5067990">s</span><span class="op" id="5067991">.</span><span class="ident" id="5067992">offset</span><span class="op" id="5067998">,</span>&nbsp;<span class="string" id="5068000">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="5068023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068027">case</span>&nbsp;<span class="ident" id="5068032">r</span>&nbsp;<span class="op" id="5068034">&gt;=</span>&nbsp;<span class="num" id="5068037">0x80</span><span class="op" id="5068041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5068046">//&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068062">r</span><span class="op" id="5068063">,</span>&nbsp;<span class="ident" id="5068065">w</span>&nbsp;<span class="op" id="5068067">=</span>&nbsp;<span class="ident" id="5068069">utf8</span><span class="op" id="5068073">.</span><span class="ident" id="5068074">DecodeRune</span><span class="op" id="5068084">(</span><span class="ident" id="5068085">s</span><span class="op" id="5068086">.</span><span class="ident" id="5068087">src</span><span class="op" id="5068090">[</span><span class="ident" id="5068091">s</span><span class="op" id="5068092">.</span><span class="ident" id="5068093">rdOffset</span><span class="op" id="5068101">:</span><span class="op" id="5068102">]</span><span class="op" id="5068103">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068108">if</span>&nbsp;<span class="ident" id="5068111">r</span>&nbsp;<span class="op" id="5068113">==</span>&nbsp;<span class="ident" id="5068116">utf8</span><span class="op" id="5068120">.</span><span class="ident" id="5068121">RuneError</span>&nbsp;<span class="op" id="5068131">&amp;&amp;</span>&nbsp;<span class="ident" id="5068134">w</span>&nbsp;<span class="op" id="5068136">==</span>&nbsp;<span class="num" id="5068139">1</span>&nbsp;<span class="op" id="5068141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068147">s</span><span class="op" id="5068148">.</span><span class="builtintype" id="5068149">error</span><span class="op" id="5068154">(</span><span class="ident" id="5068155">s</span><span class="op" id="5068156">.</span><span class="ident" id="5068157">offset</span><span class="op" id="5068163">,</span>&nbsp;<span class="string" id="5068165">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="5068189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068194">}</span>&nbsp;<span class="keyword" id="5068196">else</span>&nbsp;<span class="keyword" id="5068201">if</span>&nbsp;<span class="ident" id="5068204">r</span>&nbsp;<span class="op" id="5068206">==</span>&nbsp;<span class="ident" id="5068209">bom</span>&nbsp;<span class="op" id="5068213">&amp;&amp;</span>&nbsp;<span class="ident" id="5068216">s</span><span class="op" id="5068217">.</span><span class="ident" id="5068218">offset</span>&nbsp;<span class="op" id="5068225">&gt;</span>&nbsp;<span class="num" id="5068227">0</span>&nbsp;<span class="op" id="5068229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068235">s</span><span class="op" id="5068236">.</span><span class="builtintype" id="5068237">error</span><span class="op" id="5068242">(</span><span class="ident" id="5068243">s</span><span class="op" id="5068244">.</span><span class="ident" id="5068245">offset</span><span class="op" id="5068251">,</span>&nbsp;<span class="string" id="5068253">&#34;illegal&nbsp;byte&nbsp;order&nbsp;mark&#34;</span><span class="op" id="5068278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068283">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068291">s</span><span class="op" id="5068292">.</span><span class="ident" id="5068293">rdOffset</span>&nbsp;<span class="op" id="5068302">+=</span>&nbsp;<span class="ident" id="5068305">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068309">s</span><span class="op" id="5068310">.</span><span class="ident" id="5068311">ch</span>&nbsp;<span class="op" id="5068314">=</span>&nbsp;<span class="ident" id="5068316">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068319">}</span>&nbsp;<span class="keyword" id="5068321">else</span>&nbsp;<span class="op" id="5068326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068330">s</span><span class="op" id="5068331">.</span><span class="ident" id="5068332">offset</span>&nbsp;<span class="op" id="5068339">=</span>&nbsp;<span class="builtinfunc" id="5068341">len</span><span class="op" id="5068344">(</span><span class="ident" id="5068345">s</span><span class="op" id="5068346">.</span><span class="ident" id="5068347">src</span><span class="op" id="5068350">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5068354">if</span>&nbsp;<span class="ident" id="5068357">s</span><span class="op" id="5068358">.</span><span class="ident" id="5068359">ch</span>&nbsp;<span class="op" id="5068362">==</span>&nbsp;<span class="string" id="5068365">&#39;\n&#39;</span>&nbsp;<span class="op" id="5068370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068375">s</span><span class="op" id="5068376">.</span><span class="ident" id="5068377">lineOffset</span>&nbsp;<span class="op" id="5068388">=</span>&nbsp;<span class="ident" id="5068390">s</span><span class="op" id="5068391">.</span><span class="ident" id="5068392">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068402">s</span><span class="op" id="5068403">.</span><span class="ident" id="5068404">file</span><span class="op" id="5068408">.</span><span class="ident" id="5068409">AddLine</span><span class="op" id="5068416">(</span><span class="ident" id="5068417">s</span><span class="op" id="5068418">.</span><span class="ident" id="5068419">offset</span><span class="op" id="5068425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068433">s</span><span class="op" id="5068434">.</span><span class="ident" id="5068435">ch</span>&nbsp;<span class="op" id="5068438">=</span>&nbsp;<span class="op" id="5068440">-</span><span class="num" id="5068441">1</span>&nbsp;<span class="comment" id="5068443">//&nbsp;eof</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5068451">}</span><br>
<span class="lineno"></span><span class="op" id="5068453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5068456">//&nbsp;A&nbsp;mode&nbsp;value&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;flags&nbsp;(or&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="5068498">//&nbsp;They&nbsp;control&nbsp;scanner&nbsp;behavior.</span><br>
<span class="lineno">90</span><span class="comment" id="5068532">//</span><br>
<span class="lineno"></span><span class="keyword" id="5068535">type</span>&nbsp;<span class="ident" id="5068540">Mode</span>&nbsp;<span class="builtintype" id="5068545">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5068551">const</span>&nbsp;<span class="op" id="5068557">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068560">ScanComments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068576">Mode</span>&nbsp;<span class="op" id="5068581">=</span>&nbsp;<span class="num" id="5068583">1</span>&nbsp;<span class="op" id="5068585">&lt;&lt;</span>&nbsp;<span class="ident" id="5068588">iota</span>&nbsp;<span class="comment" id="5068593">//&nbsp;return&nbsp;comments&nbsp;as&nbsp;COMMENT&nbsp;tokens</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5068631">dontInsertSemis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5068664">//&nbsp;do&nbsp;not&nbsp;automatically&nbsp;insert&nbsp;semicolons&nbsp;-&nbsp;for&nbsp;testing&nbsp;only</span><br>
<span class="lineno"></span><span class="op" id="5068725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5068728">//&nbsp;Init&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;s&nbsp;to&nbsp;tokenize&nbsp;the&nbsp;text&nbsp;src&nbsp;by&nbsp;setting&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5068799">//&nbsp;scanner&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;src.&nbsp;The&nbsp;scanner&nbsp;uses&nbsp;the&nbsp;file&nbsp;set&nbsp;file</span><br>
<span class="lineno">100</span><span class="comment" id="5068870">//&nbsp;for&nbsp;position&nbsp;information&nbsp;and&nbsp;it&nbsp;adds&nbsp;line&nbsp;information&nbsp;for&nbsp;each&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="5068942">//&nbsp;It&nbsp;is&nbsp;ok&nbsp;to&nbsp;re-use&nbsp;the&nbsp;same&nbsp;file&nbsp;when&nbsp;re-scanning&nbsp;the&nbsp;same&nbsp;file&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5069012">//&nbsp;line&nbsp;information&nbsp;which&nbsp;is&nbsp;already&nbsp;present&nbsp;is&nbsp;ignored.&nbsp;Init&nbsp;causes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5069083">//&nbsp;panic&nbsp;if&nbsp;the&nbsp;file&nbsp;size&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;src&nbsp;size.</span><br>
<span class="lineno"></span><span class="comment" id="5069138">//</span><br>
<span class="lineno">105</span><span class="comment" id="5069141">//&nbsp;Calls&nbsp;to&nbsp;Scan&nbsp;will&nbsp;invoke&nbsp;the&nbsp;error&nbsp;handler&nbsp;err&nbsp;if&nbsp;they&nbsp;encounter&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5069212">//&nbsp;syntax&nbsp;error&nbsp;and&nbsp;err&nbsp;is&nbsp;not&nbsp;nil.&nbsp;Also,&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered,</span><br>
<span class="lineno"></span><span class="comment" id="5069282">//&nbsp;the&nbsp;Scanner&nbsp;field&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one.&nbsp;The&nbsp;mode&nbsp;parameter</span><br>
<span class="lineno"></span><span class="comment" id="5069356">//&nbsp;determines&nbsp;how&nbsp;comments&nbsp;are&nbsp;handled.</span><br>
<span class="lineno"></span><span class="comment" id="5069396">//</span><br>
<span class="lineno">110</span><span class="comment" id="5069399">//&nbsp;Note&nbsp;that&nbsp;Init&nbsp;may&nbsp;call&nbsp;err&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="5069474">//&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5069490">//</span><br>
<span class="lineno"></span><span class="keyword" id="5069493">func</span>&nbsp;<span class="op" id="5069498">(</span><span class="ident" id="5069499">s</span>&nbsp;<span class="op" id="5069501">*</span><span class="ident" id="5069502">Scanner</span><span class="op" id="5069509">)</span>&nbsp;<span class="ident" id="5069511">Init</span><span class="op" id="5069515">(</span><span class="ident" id="5069516">file</span>&nbsp;<span class="op" id="5069521">*</span><span class="ident" id="5069522">token</span><span class="op" id="5069527">.</span><span class="ident" id="5069528">File</span><span class="op" id="5069532">,</span>&nbsp;<span class="ident" id="5069534">src</span>&nbsp;<span class="op" id="5069538">[</span><span class="op" id="5069539">]</span><span class="builtintype" id="5069540">byte</span><span class="op" id="5069544">,</span>&nbsp;<span class="ident" id="5069546">err</span>&nbsp;<span class="ident" id="5069550">ErrorHandler</span><span class="op" id="5069562">,</span>&nbsp;<span class="ident" id="5069564">mode</span>&nbsp;<span class="ident" id="5069569">Mode</span><span class="op" id="5069573">)</span>&nbsp;<span class="op" id="5069575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5069578">//&nbsp;Explicitly&nbsp;initialize&nbsp;all&nbsp;fields&nbsp;since&nbsp;a&nbsp;scanner&nbsp;may&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069646">if</span>&nbsp;<span class="ident" id="5069649">file</span><span class="op" id="5069653">.</span><span class="ident" id="5069654">Size</span><span class="op" id="5069658">(</span><span class="op" id="5069659">)</span>&nbsp;<span class="op" id="5069661">!=</span>&nbsp;<span class="builtinfunc" id="5069664">len</span><span class="op" id="5069667">(</span><span class="ident" id="5069668">src</span><span class="op" id="5069671">)</span>&nbsp;<span class="op" id="5069673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5069677">panic</span><span class="op" id="5069682">(</span><span class="ident" id="5069683">fmt</span><span class="op" id="5069686">.</span><span class="ident" id="5069687">Sprintf</span><span class="op" id="5069694">(</span><span class="string" id="5069695">&#34;file&nbsp;size&nbsp;(%d)&nbsp;does&nbsp;not&nbsp;match&nbsp;src&nbsp;len&nbsp;(%d)&#34;</span><span class="op" id="5069739">,</span>&nbsp;<span class="ident" id="5069741">file</span><span class="op" id="5069745">.</span><span class="ident" id="5069746">Size</span><span class="op" id="5069750">(</span><span class="op" id="5069751">)</span><span class="op" id="5069752">,</span>&nbsp;<span class="builtinfunc" id="5069754">len</span><span class="op" id="5069757">(</span><span class="ident" id="5069758">src</span><span class="op" id="5069761">)</span><span class="op" id="5069762">)</span><span class="op" id="5069763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5069766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069769">s</span><span class="op" id="5069770">.</span><span class="ident" id="5069771">file</span>&nbsp;<span class="op" id="5069776">=</span>&nbsp;<span class="ident" id="5069778">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069784">s</span><span class="op" id="5069785">.</span><span class="ident" id="5069786">dir</span><span class="op" id="5069789">,</span>&nbsp;<span class="ident" id="5069791">_</span>&nbsp;<span class="op" id="5069793">=</span>&nbsp;<span class="ident" id="5069795">filepath</span><span class="op" id="5069803">.</span><span class="ident" id="5069804">Split</span><span class="op" id="5069809">(</span><span class="ident" id="5069810">file</span><span class="op" id="5069814">.</span><span class="ident" id="5069815">Name</span><span class="op" id="5069819">(</span><span class="op" id="5069820">)</span><span class="op" id="5069821">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069824">s</span><span class="op" id="5069825">.</span><span class="ident" id="5069826">src</span>&nbsp;<span class="op" id="5069830">=</span>&nbsp;<span class="ident" id="5069832">src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069837">s</span><span class="op" id="5069838">.</span><span class="ident" id="5069839">err</span>&nbsp;<span class="op" id="5069843">=</span>&nbsp;<span class="ident" id="5069845">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069850">s</span><span class="op" id="5069851">.</span><span class="ident" id="5069852">mode</span>&nbsp;<span class="op" id="5069857">=</span>&nbsp;<span class="ident" id="5069859">mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069866">s</span><span class="op" id="5069867">.</span><span class="ident" id="5069868">ch</span>&nbsp;<span class="op" id="5069871">=</span>&nbsp;<span class="string" id="5069873">&#39;&nbsp;&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069878">s</span><span class="op" id="5069879">.</span><span class="ident" id="5069880">offset</span>&nbsp;<span class="op" id="5069887">=</span>&nbsp;<span class="num" id="5069889">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069892">s</span><span class="op" id="5069893">.</span><span class="ident" id="5069894">rdOffset</span>&nbsp;<span class="op" id="5069903">=</span>&nbsp;<span class="num" id="5069905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069908">s</span><span class="op" id="5069909">.</span><span class="ident" id="5069910">lineOffset</span>&nbsp;<span class="op" id="5069921">=</span>&nbsp;<span class="num" id="5069923">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069926">s</span><span class="op" id="5069927">.</span><span class="ident" id="5069928">insertSemi</span>&nbsp;<span class="op" id="5069939">=</span>&nbsp;<span class="builtintype" id="5069941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069948">s</span><span class="op" id="5069949">.</span><span class="ident" id="5069950">ErrorCount</span>&nbsp;<span class="op" id="5069961">=</span>&nbsp;<span class="num" id="5069963">0</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069967">s</span><span class="op" id="5069968">.</span><span class="ident" id="5069969">next</span><span class="op" id="5069973">(</span><span class="op" id="5069974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5069977">if</span>&nbsp;<span class="ident" id="5069980">s</span><span class="op" id="5069981">.</span><span class="ident" id="5069982">ch</span>&nbsp;<span class="op" id="5069985">==</span>&nbsp;<span class="ident" id="5069988">bom</span>&nbsp;<span class="op" id="5069992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5069996">s</span><span class="op" id="5069997">.</span><span class="ident" id="5069998">next</span><span class="op" id="5070002">(</span><span class="op" id="5070003">)</span>&nbsp;<span class="comment" id="5070005">//&nbsp;ignore&nbsp;BOM&nbsp;at&nbsp;file&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070038">}</span><br>
<span class="lineno">135</span><span class="op" id="5070040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5070043">func</span>&nbsp;<span class="op" id="5070048">(</span><span class="ident" id="5070049">s</span>&nbsp;<span class="op" id="5070051">*</span><span class="ident" id="5070052">Scanner</span><span class="op" id="5070059">)</span>&nbsp;<span class="builtintype" id="5070061">error</span><span class="op" id="5070066">(</span><span class="ident" id="5070067">offs</span>&nbsp;<span class="builtintype" id="5070072">int</span><span class="op" id="5070075">,</span>&nbsp;<span class="ident" id="5070077">msg</span>&nbsp;<span class="builtintype" id="5070081">string</span><span class="op" id="5070087">)</span>&nbsp;<span class="op" id="5070089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070092">if</span>&nbsp;<span class="ident" id="5070095">s</span><span class="op" id="5070096">.</span><span class="ident" id="5070097">err</span>&nbsp;<span class="op" id="5070101">!=</span>&nbsp;<span class="builtintype" id="5070104">nil</span>&nbsp;<span class="op" id="5070108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070112">s</span><span class="op" id="5070113">.</span><span class="ident" id="5070114">err</span><span class="op" id="5070117">(</span><span class="ident" id="5070118">s</span><span class="op" id="5070119">.</span><span class="ident" id="5070120">file</span><span class="op" id="5070124">.</span><span class="ident" id="5070125">Position</span><span class="op" id="5070133">(</span><span class="ident" id="5070134">s</span><span class="op" id="5070135">.</span><span class="ident" id="5070136">file</span><span class="op" id="5070140">.</span><span class="ident" id="5070141">Pos</span><span class="op" id="5070144">(</span><span class="ident" id="5070145">offs</span><span class="op" id="5070149">)</span><span class="op" id="5070150">)</span><span class="op" id="5070151">,</span>&nbsp;<span class="ident" id="5070153">msg</span><span class="op" id="5070156">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070162">s</span><span class="op" id="5070163">.</span><span class="ident" id="5070164">ErrorCount</span><span class="op" id="5070174">++</span><br>
<span class="lineno"></span><span class="op" id="5070177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5070180">var</span>&nbsp;<span class="ident" id="5070184">prefix</span>&nbsp;<span class="op" id="5070191">=</span>&nbsp;<span class="op" id="5070193">[</span><span class="op" id="5070194">]</span><span class="builtintype" id="5070195">byte</span><span class="op" id="5070199">(</span><span class="string" id="5070200">&#34;//line&nbsp;&#34;</span><span class="op" id="5070209">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="5070212">func</span>&nbsp;<span class="op" id="5070217">(</span><span class="ident" id="5070218">s</span>&nbsp;<span class="op" id="5070220">*</span><span class="ident" id="5070221">Scanner</span><span class="op" id="5070228">)</span>&nbsp;<span class="ident" id="5070230">interpretLineComment</span><span class="op" id="5070250">(</span><span class="ident" id="5070251">text</span>&nbsp;<span class="op" id="5070256">[</span><span class="op" id="5070257">]</span><span class="builtintype" id="5070258">byte</span><span class="op" id="5070262">)</span>&nbsp;<span class="op" id="5070264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070267">if</span>&nbsp;<span class="ident" id="5070270">bytes</span><span class="op" id="5070275">.</span><span class="ident" id="5070276">HasPrefix</span><span class="op" id="5070285">(</span><span class="ident" id="5070286">text</span><span class="op" id="5070290">,</span>&nbsp;<span class="ident" id="5070292">prefix</span><span class="op" id="5070298">)</span>&nbsp;<span class="op" id="5070300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070304">//&nbsp;get&nbsp;filename&nbsp;and&nbsp;line&nbsp;number,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070346">if</span>&nbsp;<span class="ident" id="5070349">i</span>&nbsp;<span class="op" id="5070351">:=</span>&nbsp;<span class="ident" id="5070354">bytes</span><span class="op" id="5070359">.</span><span class="ident" id="5070360">LastIndex</span><span class="op" id="5070369">(</span><span class="ident" id="5070370">text</span><span class="op" id="5070374">,</span>&nbsp;<span class="op" id="5070376">[</span><span class="op" id="5070377">]</span><span class="builtintype" id="5070378">byte</span><span class="op" id="5070382">{</span><span class="string" id="5070383">&#39;:&#39;</span><span class="op" id="5070386">}</span><span class="op" id="5070387">)</span><span class="op" id="5070388">;</span>&nbsp;<span class="ident" id="5070390">i</span>&nbsp;<span class="op" id="5070392">&gt;</span>&nbsp;<span class="num" id="5070394">0</span>&nbsp;<span class="op" id="5070396">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070401">if</span>&nbsp;<span class="ident" id="5070404">line</span><span class="op" id="5070408">,</span>&nbsp;<span class="ident" id="5070410">err</span>&nbsp;<span class="op" id="5070414">:=</span>&nbsp;<span class="ident" id="5070417">strconv</span><span class="op" id="5070424">.</span><span class="ident" id="5070425">Atoi</span><span class="op" id="5070429">(</span><span class="builtintype" id="5070430">string</span><span class="op" id="5070436">(</span><span class="ident" id="5070437">text</span><span class="op" id="5070441">[</span><span class="ident" id="5070442">i</span><span class="op" id="5070443">+</span><span class="num" id="5070444">1</span><span class="op" id="5070445">:</span><span class="op" id="5070446">]</span><span class="op" id="5070447">)</span><span class="op" id="5070448">)</span><span class="op" id="5070449">;</span>&nbsp;<span class="ident" id="5070451">err</span>&nbsp;<span class="op" id="5070455">==</span>&nbsp;<span class="builtintype" id="5070458">nil</span>&nbsp;<span class="op" id="5070462">&amp;&amp;</span>&nbsp;<span class="ident" id="5070465">line</span>&nbsp;<span class="op" id="5070470">&gt;</span>&nbsp;<span class="num" id="5070472">0</span>&nbsp;<span class="op" id="5070474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070480">//&nbsp;valid&nbsp;//line&nbsp;filename:line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070522">filename</span>&nbsp;<span class="op" id="5070531">:=</span>&nbsp;<span class="builtintype" id="5070534">string</span><span class="op" id="5070540">(</span><span class="ident" id="5070541">bytes</span><span class="op" id="5070546">.</span><span class="ident" id="5070547">TrimSpace</span><span class="op" id="5070556">(</span><span class="ident" id="5070557">text</span><span class="op" id="5070561">[</span><span class="builtinfunc" id="5070562">len</span><span class="op" id="5070565">(</span><span class="ident" id="5070566">prefix</span><span class="op" id="5070572">)</span><span class="op" id="5070573">:</span><span class="ident" id="5070574">i</span><span class="op" id="5070575">]</span><span class="op" id="5070576">)</span><span class="op" id="5070577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070583">if</span>&nbsp;<span class="ident" id="5070586">filename</span>&nbsp;<span class="op" id="5070595">!=</span>&nbsp;<span class="string" id="5070598">&#34;&#34;</span>&nbsp;<span class="op" id="5070601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070608">filename</span>&nbsp;<span class="op" id="5070617">=</span>&nbsp;<span class="ident" id="5070619">filepath</span><span class="op" id="5070627">.</span><span class="ident" id="5070628">Clean</span><span class="op" id="5070633">(</span><span class="ident" id="5070634">filename</span><span class="op" id="5070642">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5070649">if</span>&nbsp;<span class="op" id="5070652">!</span><span class="ident" id="5070653">filepath</span><span class="op" id="5070661">.</span><span class="ident" id="5070662">IsAbs</span><span class="op" id="5070667">(</span><span class="ident" id="5070668">filename</span><span class="op" id="5070676">)</span>&nbsp;<span class="op" id="5070678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070686">//&nbsp;make&nbsp;filename&nbsp;relative&nbsp;to&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070739">filename</span>&nbsp;<span class="op" id="5070748">=</span>&nbsp;<span class="ident" id="5070750">filepath</span><span class="op" id="5070758">.</span><span class="ident" id="5070759">Join</span><span class="op" id="5070763">(</span><span class="ident" id="5070764">s</span><span class="op" id="5070765">.</span><span class="ident" id="5070766">dir</span><span class="op" id="5070769">,</span>&nbsp;<span class="ident" id="5070771">filename</span><span class="op" id="5070779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070792">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070798">//&nbsp;update&nbsp;scanner&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5070829">s</span><span class="op" id="5070830">.</span><span class="ident" id="5070831">file</span><span class="op" id="5070835">.</span><span class="ident" id="5070836">AddLineInfo</span><span class="op" id="5070847">(</span><span class="ident" id="5070848">s</span><span class="op" id="5070849">.</span><span class="ident" id="5070850">lineOffset</span><span class="op" id="5070860">+</span><span class="builtinfunc" id="5070861">len</span><span class="op" id="5070864">(</span><span class="ident" id="5070865">text</span><span class="op" id="5070869">)</span><span class="op" id="5070870">+</span><span class="num" id="5070871">1</span><span class="op" id="5070872">,</span>&nbsp;<span class="ident" id="5070874">filename</span><span class="op" id="5070882">,</span>&nbsp;<span class="ident" id="5070884">line</span><span class="op" id="5070888">)</span>&nbsp;<span class="comment" id="5070890">//&nbsp;+len(text)+1&nbsp;since&nbsp;comment&nbsp;applies&nbsp;to&nbsp;next&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070951">}</span><br>
<span class="lineno">165</span><span class="op" id="5070953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5070956">func</span>&nbsp;<span class="op" id="5070961">(</span><span class="ident" id="5070962">s</span>&nbsp;<span class="op" id="5070964">*</span><span class="ident" id="5070965">Scanner</span><span class="op" id="5070972">)</span>&nbsp;<span class="ident" id="5070974">scanComment</span><span class="op" id="5070985">(</span><span class="op" id="5070986">)</span>&nbsp;<span class="builtintype" id="5070988">string</span>&nbsp;<span class="op" id="5070995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5070998">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed;&nbsp;s.ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;s.ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071059">offs</span>&nbsp;<span class="op" id="5071064">:=</span>&nbsp;<span class="ident" id="5071067">s</span><span class="op" id="5071068">.</span><span class="ident" id="5071069">offset</span>&nbsp;<span class="op" id="5071076">-</span>&nbsp;<span class="num" id="5071078">1</span>&nbsp;<span class="comment" id="5071080">//&nbsp;position&nbsp;of&nbsp;initial&nbsp;&#39;/&#39;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071108">hasCR</span>&nbsp;<span class="op" id="5071114">:=</span>&nbsp;<span class="builtintype" id="5071117">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071125">if</span>&nbsp;<span class="ident" id="5071128">s</span><span class="op" id="5071129">.</span><span class="ident" id="5071130">ch</span>&nbsp;<span class="op" id="5071133">==</span>&nbsp;<span class="string" id="5071136">&#39;/&#39;</span>&nbsp;<span class="op" id="5071140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5071144">//-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071163">s</span><span class="op" id="5071164">.</span><span class="ident" id="5071165">next</span><span class="op" id="5071169">(</span><span class="op" id="5071170">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071174">for</span>&nbsp;<span class="ident" id="5071178">s</span><span class="op" id="5071179">.</span><span class="ident" id="5071180">ch</span>&nbsp;<span class="op" id="5071183">!=</span>&nbsp;<span class="string" id="5071186">&#39;\n&#39;</span>&nbsp;<span class="op" id="5071191">&amp;&amp;</span>&nbsp;<span class="ident" id="5071194">s</span><span class="op" id="5071195">.</span><span class="ident" id="5071196">ch</span>&nbsp;<span class="op" id="5071199">&gt;=</span>&nbsp;<span class="num" id="5071202">0</span>&nbsp;<span class="op" id="5071204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071209">if</span>&nbsp;<span class="ident" id="5071212">s</span><span class="op" id="5071213">.</span><span class="ident" id="5071214">ch</span>&nbsp;<span class="op" id="5071217">==</span>&nbsp;<span class="string" id="5071220">&#39;\r&#39;</span>&nbsp;<span class="op" id="5071225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071231">hasCR</span>&nbsp;<span class="op" id="5071237">=</span>&nbsp;<span class="builtintype" id="5071239">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071252">s</span><span class="op" id="5071253">.</span><span class="ident" id="5071254">next</span><span class="op" id="5071258">(</span><span class="op" id="5071259">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071267">if</span>&nbsp;<span class="ident" id="5071270">offs</span>&nbsp;<span class="op" id="5071275">==</span>&nbsp;<span class="ident" id="5071278">s</span><span class="op" id="5071279">.</span><span class="ident" id="5071280">lineOffset</span>&nbsp;<span class="op" id="5071291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5071296">//&nbsp;comment&nbsp;starts&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;current&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071354">s</span><span class="op" id="5071355">.</span><span class="ident" id="5071356">interpretLineComment</span><span class="op" id="5071376">(</span><span class="ident" id="5071377">s</span><span class="op" id="5071378">.</span><span class="ident" id="5071379">src</span><span class="op" id="5071382">[</span><span class="ident" id="5071383">offs</span><span class="op" id="5071387">:</span><span class="ident" id="5071388">s</span><span class="op" id="5071389">.</span><span class="ident" id="5071390">offset</span><span class="op" id="5071396">]</span><span class="op" id="5071397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071401">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071405">goto</span>&nbsp;<span class="ident" id="5071410">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5071420">/*-style&nbsp;comment&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071441">s</span><span class="op" id="5071442">.</span><span class="ident" id="5071443">next</span><span class="op" id="5071447">(</span><span class="op" id="5071448">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071451">for</span>&nbsp;<span class="ident" id="5071455">s</span><span class="op" id="5071456">.</span><span class="ident" id="5071457">ch</span>&nbsp;<span class="op" id="5071460">&gt;=</span>&nbsp;<span class="num" id="5071463">0</span>&nbsp;<span class="op" id="5071465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071469">ch</span>&nbsp;<span class="op" id="5071472">:=</span>&nbsp;<span class="ident" id="5071475">s</span><span class="op" id="5071476">.</span><span class="ident" id="5071477">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071482">if</span>&nbsp;<span class="ident" id="5071485">ch</span>&nbsp;<span class="op" id="5071488">==</span>&nbsp;<span class="string" id="5071491">&#39;\r&#39;</span>&nbsp;<span class="op" id="5071496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071501">hasCR</span>&nbsp;<span class="op" id="5071507">=</span>&nbsp;<span class="builtintype" id="5071509">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071516">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071520">s</span><span class="op" id="5071521">.</span><span class="ident" id="5071522">next</span><span class="op" id="5071526">(</span><span class="op" id="5071527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071531">if</span>&nbsp;<span class="ident" id="5071534">ch</span>&nbsp;<span class="op" id="5071537">==</span>&nbsp;<span class="string" id="5071540">&#39;*&#39;</span>&nbsp;<span class="op" id="5071544">&amp;&amp;</span>&nbsp;<span class="ident" id="5071547">s</span><span class="op" id="5071548">.</span><span class="ident" id="5071549">ch</span>&nbsp;<span class="op" id="5071552">==</span>&nbsp;<span class="string" id="5071555">&#39;/&#39;</span>&nbsp;<span class="op" id="5071559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071564">s</span><span class="op" id="5071565">.</span><span class="ident" id="5071566">next</span><span class="op" id="5071570">(</span><span class="op" id="5071571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071576">goto</span>&nbsp;<span class="ident" id="5071581">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071588">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071595">s</span><span class="op" id="5071596">.</span><span class="builtintype" id="5071597">error</span><span class="op" id="5071602">(</span><span class="ident" id="5071603">offs</span><span class="op" id="5071607">,</span>&nbsp;<span class="string" id="5071609">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5071633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5071636">exit</span><span class="op" id="5071640">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071643">lit</span>&nbsp;<span class="op" id="5071647">:=</span>&nbsp;<span class="ident" id="5071650">s</span><span class="op" id="5071651">.</span><span class="ident" id="5071652">src</span><span class="op" id="5071655">[</span><span class="ident" id="5071656">offs</span><span class="op" id="5071660">:</span><span class="ident" id="5071661">s</span><span class="op" id="5071662">.</span><span class="ident" id="5071663">offset</span><span class="op" id="5071669">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071672">if</span>&nbsp;<span class="ident" id="5071675">hasCR</span>&nbsp;<span class="op" id="5071681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071685">lit</span>&nbsp;<span class="op" id="5071689">=</span>&nbsp;<span class="ident" id="5071691">stripCR</span><span class="op" id="5071698">(</span><span class="ident" id="5071699">lit</span><span class="op" id="5071702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071709">return</span>&nbsp;<span class="builtintype" id="5071716">string</span><span class="op" id="5071722">(</span><span class="ident" id="5071723">lit</span><span class="op" id="5071726">)</span><br>
<span class="lineno"></span><span class="op" id="5071728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5071731">func</span>&nbsp;<span class="op" id="5071736">(</span><span class="ident" id="5071737">s</span>&nbsp;<span class="op" id="5071739">*</span><span class="ident" id="5071740">Scanner</span><span class="op" id="5071747">)</span>&nbsp;<span class="ident" id="5071749">findLineEnd</span><span class="op" id="5071760">(</span><span class="op" id="5071761">)</span>&nbsp;<span class="builtintype" id="5071763">bool</span>&nbsp;<span class="op" id="5071768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5071771">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5071805">defer</span>&nbsp;<span class="keyword" id="5071811">func</span><span class="op" id="5071815">(</span><span class="ident" id="5071816">offs</span>&nbsp;<span class="builtintype" id="5071821">int</span><span class="op" id="5071824">)</span>&nbsp;<span class="op" id="5071826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5071830">//&nbsp;reset&nbsp;scanner&nbsp;state&nbsp;to&nbsp;where&nbsp;it&nbsp;was&nbsp;upon&nbsp;calling&nbsp;findLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071896">s</span><span class="op" id="5071897">.</span><span class="ident" id="5071898">ch</span>&nbsp;<span class="op" id="5071901">=</span>&nbsp;<span class="string" id="5071903">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071909">s</span><span class="op" id="5071910">.</span><span class="ident" id="5071911">offset</span>&nbsp;<span class="op" id="5071918">=</span>&nbsp;<span class="ident" id="5071920">offs</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071927">s</span><span class="op" id="5071928">.</span><span class="ident" id="5071929">rdOffset</span>&nbsp;<span class="op" id="5071938">=</span>&nbsp;<span class="ident" id="5071940">offs</span>&nbsp;<span class="op" id="5071945">+</span>&nbsp;<span class="num" id="5071947">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5071951">s</span><span class="op" id="5071952">.</span><span class="ident" id="5071953">next</span><span class="op" id="5071957">(</span><span class="op" id="5071958">)</span>&nbsp;<span class="comment" id="5071960">//&nbsp;consume&nbsp;initial&nbsp;&#39;/&#39;&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5071990">}</span><span class="op" id="5071991">(</span><span class="ident" id="5071992">s</span><span class="op" id="5071993">.</span><span class="ident" id="5071994">offset</span>&nbsp;<span class="op" id="5072001">-</span>&nbsp;<span class="num" id="5072003">1</span><span class="op" id="5072004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5072008">//&nbsp;read&nbsp;ahead&nbsp;until&nbsp;a&nbsp;newline,&nbsp;EOF,&nbsp;or&nbsp;non-comment&nbsp;token&nbsp;is&nbsp;found</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072075">for</span>&nbsp;<span class="ident" id="5072079">s</span><span class="op" id="5072080">.</span><span class="ident" id="5072081">ch</span>&nbsp;<span class="op" id="5072084">==</span>&nbsp;<span class="string" id="5072087">&#39;/&#39;</span>&nbsp;<span class="op" id="5072091">||</span>&nbsp;<span class="ident" id="5072094">s</span><span class="op" id="5072095">.</span><span class="ident" id="5072096">ch</span>&nbsp;<span class="op" id="5072099">==</span>&nbsp;<span class="string" id="5072102">&#39;*&#39;</span>&nbsp;<span class="op" id="5072106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072110">if</span>&nbsp;<span class="ident" id="5072113">s</span><span class="op" id="5072114">.</span><span class="ident" id="5072115">ch</span>&nbsp;<span class="op" id="5072118">==</span>&nbsp;<span class="string" id="5072121">&#39;/&#39;</span>&nbsp;<span class="op" id="5072125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5072130">//-style&nbsp;comment&nbsp;always&nbsp;contains&nbsp;a&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072176">return</span>&nbsp;<span class="builtintype" id="5072183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072190">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5072194">/*-style&nbsp;comment:&nbsp;look&nbsp;for&nbsp;newline&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072234">s</span><span class="op" id="5072235">.</span><span class="ident" id="5072236">next</span><span class="op" id="5072240">(</span><span class="op" id="5072241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072245">for</span>&nbsp;<span class="ident" id="5072249">s</span><span class="op" id="5072250">.</span><span class="ident" id="5072251">ch</span>&nbsp;<span class="op" id="5072254">&gt;=</span>&nbsp;<span class="num" id="5072257">0</span>&nbsp;<span class="op" id="5072259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072264">ch</span>&nbsp;<span class="op" id="5072267">:=</span>&nbsp;<span class="ident" id="5072270">s</span><span class="op" id="5072271">.</span><span class="ident" id="5072272">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072278">if</span>&nbsp;<span class="ident" id="5072281">ch</span>&nbsp;<span class="op" id="5072284">==</span>&nbsp;<span class="string" id="5072287">&#39;\n&#39;</span>&nbsp;<span class="op" id="5072292">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072298">return</span>&nbsp;<span class="builtintype" id="5072305">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072318">s</span><span class="op" id="5072319">.</span><span class="ident" id="5072320">next</span><span class="op" id="5072324">(</span><span class="op" id="5072325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072330">if</span>&nbsp;<span class="ident" id="5072333">ch</span>&nbsp;<span class="op" id="5072336">==</span>&nbsp;<span class="string" id="5072339">&#39;*&#39;</span>&nbsp;<span class="op" id="5072343">&amp;&amp;</span>&nbsp;<span class="ident" id="5072346">s</span><span class="op" id="5072347">.</span><span class="ident" id="5072348">ch</span>&nbsp;<span class="op" id="5072351">==</span>&nbsp;<span class="string" id="5072354">&#39;/&#39;</span>&nbsp;<span class="op" id="5072358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072364">s</span><span class="op" id="5072365">.</span><span class="ident" id="5072366">next</span><span class="op" id="5072370">(</span><span class="op" id="5072371">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072377">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072394">s</span><span class="op" id="5072395">.</span><span class="ident" id="5072396">skipWhitespace</span><span class="op" id="5072410">(</span><span class="op" id="5072411">)</span>&nbsp;<span class="comment" id="5072413">//&nbsp;s.insertSemi&nbsp;is&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072438">if</span>&nbsp;<span class="ident" id="5072441">s</span><span class="op" id="5072442">.</span><span class="ident" id="5072443">ch</span>&nbsp;<span class="op" id="5072446">&lt;</span>&nbsp;<span class="num" id="5072448">0</span>&nbsp;<span class="op" id="5072450">||</span>&nbsp;<span class="ident" id="5072453">s</span><span class="op" id="5072454">.</span><span class="ident" id="5072455">ch</span>&nbsp;<span class="op" id="5072458">==</span>&nbsp;<span class="string" id="5072461">&#39;\n&#39;</span>&nbsp;<span class="op" id="5072466">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072471">return</span>&nbsp;<span class="builtintype" id="5072478">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072489">if</span>&nbsp;<span class="ident" id="5072492">s</span><span class="op" id="5072493">.</span><span class="ident" id="5072494">ch</span>&nbsp;<span class="op" id="5072497">!=</span>&nbsp;<span class="string" id="5072500">&#39;/&#39;</span>&nbsp;<span class="op" id="5072504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5072509">//&nbsp;non-comment&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072533">return</span>&nbsp;<span class="builtintype" id="5072540">false</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072552">s</span><span class="op" id="5072553">.</span><span class="ident" id="5072554">next</span><span class="op" id="5072558">(</span><span class="op" id="5072559">)</span>&nbsp;<span class="comment" id="5072561">//&nbsp;consume&nbsp;&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072581">return</span>&nbsp;<span class="builtintype" id="5072588">false</span><br>
<span class="lineno">255</span><span class="op" id="5072594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5072597">func</span>&nbsp;<span class="ident" id="5072602">isLetter</span><span class="op" id="5072610">(</span><span class="ident" id="5072611">ch</span>&nbsp;<span class="builtintype" id="5072614">rune</span><span class="op" id="5072618">)</span>&nbsp;<span class="builtintype" id="5072620">bool</span>&nbsp;<span class="op" id="5072625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072628">return</span>&nbsp;<span class="string" id="5072635">&#39;a&#39;</span>&nbsp;<span class="op" id="5072639">&lt;=</span>&nbsp;<span class="ident" id="5072642">ch</span>&nbsp;<span class="op" id="5072645">&amp;&amp;</span>&nbsp;<span class="ident" id="5072648">ch</span>&nbsp;<span class="op" id="5072651">&lt;=</span>&nbsp;<span class="string" id="5072654">&#39;z&#39;</span>&nbsp;<span class="op" id="5072658">||</span>&nbsp;<span class="string" id="5072661">&#39;A&#39;</span>&nbsp;<span class="op" id="5072665">&lt;=</span>&nbsp;<span class="ident" id="5072668">ch</span>&nbsp;<span class="op" id="5072671">&amp;&amp;</span>&nbsp;<span class="ident" id="5072674">ch</span>&nbsp;<span class="op" id="5072677">&lt;=</span>&nbsp;<span class="string" id="5072680">&#39;Z&#39;</span>&nbsp;<span class="op" id="5072684">||</span>&nbsp;<span class="ident" id="5072687">ch</span>&nbsp;<span class="op" id="5072690">==</span>&nbsp;<span class="string" id="5072693">&#39;_&#39;</span>&nbsp;<span class="op" id="5072697">||</span>&nbsp;<span class="ident" id="5072700">ch</span>&nbsp;<span class="op" id="5072703">&gt;=</span>&nbsp;<span class="num" id="5072706">0x80</span>&nbsp;<span class="op" id="5072711">&amp;&amp;</span>&nbsp;<span class="ident" id="5072714">unicode</span><span class="op" id="5072721">.</span><span class="ident" id="5072722">IsLetter</span><span class="op" id="5072730">(</span><span class="ident" id="5072731">ch</span><span class="op" id="5072733">)</span><br>
<span class="lineno"></span><span class="op" id="5072735">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="5072738">func</span>&nbsp;<span class="ident" id="5072743">isDigit</span><span class="op" id="5072750">(</span><span class="ident" id="5072751">ch</span>&nbsp;<span class="builtintype" id="5072754">rune</span><span class="op" id="5072758">)</span>&nbsp;<span class="builtintype" id="5072760">bool</span>&nbsp;<span class="op" id="5072765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072768">return</span>&nbsp;<span class="string" id="5072775">&#39;0&#39;</span>&nbsp;<span class="op" id="5072779">&lt;=</span>&nbsp;<span class="ident" id="5072782">ch</span>&nbsp;<span class="op" id="5072785">&amp;&amp;</span>&nbsp;<span class="ident" id="5072788">ch</span>&nbsp;<span class="op" id="5072791">&lt;=</span>&nbsp;<span class="string" id="5072794">&#39;9&#39;</span>&nbsp;<span class="op" id="5072798">||</span>&nbsp;<span class="ident" id="5072801">ch</span>&nbsp;<span class="op" id="5072804">&gt;=</span>&nbsp;<span class="num" id="5072807">0x80</span>&nbsp;<span class="op" id="5072812">&amp;&amp;</span>&nbsp;<span class="ident" id="5072815">unicode</span><span class="op" id="5072822">.</span><span class="ident" id="5072823">IsDigit</span><span class="op" id="5072830">(</span><span class="ident" id="5072831">ch</span><span class="op" id="5072833">)</span><br>
<span class="lineno"></span><span class="op" id="5072835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5072838">func</span>&nbsp;<span class="op" id="5072843">(</span><span class="ident" id="5072844">s</span>&nbsp;<span class="op" id="5072846">*</span><span class="ident" id="5072847">Scanner</span><span class="op" id="5072854">)</span>&nbsp;<span class="ident" id="5072856">scanIdentifier</span><span class="op" id="5072870">(</span><span class="op" id="5072871">)</span>&nbsp;<span class="builtintype" id="5072873">string</span>&nbsp;<span class="op" id="5072880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072883">offs</span>&nbsp;<span class="op" id="5072888">:=</span>&nbsp;<span class="ident" id="5072891">s</span><span class="op" id="5072892">.</span><span class="ident" id="5072893">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072901">for</span>&nbsp;<span class="ident" id="5072905">isLetter</span><span class="op" id="5072913">(</span><span class="ident" id="5072914">s</span><span class="op" id="5072915">.</span><span class="ident" id="5072916">ch</span><span class="op" id="5072918">)</span>&nbsp;<span class="op" id="5072920">||</span>&nbsp;<span class="ident" id="5072923">isDigit</span><span class="op" id="5072930">(</span><span class="ident" id="5072931">s</span><span class="op" id="5072932">.</span><span class="ident" id="5072933">ch</span><span class="op" id="5072935">)</span>&nbsp;<span class="op" id="5072937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5072941">s</span><span class="op" id="5072942">.</span><span class="ident" id="5072943">next</span><span class="op" id="5072947">(</span><span class="op" id="5072948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5072951">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5072954">return</span>&nbsp;<span class="builtintype" id="5072961">string</span><span class="op" id="5072967">(</span><span class="ident" id="5072968">s</span><span class="op" id="5072969">.</span><span class="ident" id="5072970">src</span><span class="op" id="5072973">[</span><span class="ident" id="5072974">offs</span><span class="op" id="5072978">:</span><span class="ident" id="5072979">s</span><span class="op" id="5072980">.</span><span class="ident" id="5072981">offset</span><span class="op" id="5072987">]</span><span class="op" id="5072988">)</span><br>
<span class="lineno"></span><span class="op" id="5072990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5072993">func</span>&nbsp;<span class="ident" id="5072998">digitVal</span><span class="op" id="5073006">(</span><span class="ident" id="5073007">ch</span>&nbsp;<span class="builtintype" id="5073010">rune</span><span class="op" id="5073014">)</span>&nbsp;<span class="builtintype" id="5073016">int</span>&nbsp;<span class="op" id="5073020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073023">switch</span>&nbsp;<span class="op" id="5073030">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073033">case</span>&nbsp;<span class="string" id="5073038">&#39;0&#39;</span>&nbsp;<span class="op" id="5073042">&lt;=</span>&nbsp;<span class="ident" id="5073045">ch</span>&nbsp;<span class="op" id="5073048">&amp;&amp;</span>&nbsp;<span class="ident" id="5073051">ch</span>&nbsp;<span class="op" id="5073054">&lt;=</span>&nbsp;<span class="string" id="5073057">&#39;9&#39;</span><span class="op" id="5073060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073064">return</span>&nbsp;<span class="builtintype" id="5073071">int</span><span class="op" id="5073074">(</span><span class="ident" id="5073075">ch</span>&nbsp;<span class="op" id="5073078">-</span>&nbsp;<span class="string" id="5073080">&#39;0&#39;</span><span class="op" id="5073083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073086">case</span>&nbsp;<span class="string" id="5073091">&#39;a&#39;</span>&nbsp;<span class="op" id="5073095">&lt;=</span>&nbsp;<span class="ident" id="5073098">ch</span>&nbsp;<span class="op" id="5073101">&amp;&amp;</span>&nbsp;<span class="ident" id="5073104">ch</span>&nbsp;<span class="op" id="5073107">&lt;=</span>&nbsp;<span class="string" id="5073110">&#39;f&#39;</span><span class="op" id="5073113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073117">return</span>&nbsp;<span class="builtintype" id="5073124">int</span><span class="op" id="5073127">(</span><span class="ident" id="5073128">ch</span>&nbsp;<span class="op" id="5073131">-</span>&nbsp;<span class="string" id="5073133">&#39;a&#39;</span>&nbsp;<span class="op" id="5073137">+</span>&nbsp;<span class="num" id="5073139">10</span><span class="op" id="5073141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073144">case</span>&nbsp;<span class="string" id="5073149">&#39;A&#39;</span>&nbsp;<span class="op" id="5073153">&lt;=</span>&nbsp;<span class="ident" id="5073156">ch</span>&nbsp;<span class="op" id="5073159">&amp;&amp;</span>&nbsp;<span class="ident" id="5073162">ch</span>&nbsp;<span class="op" id="5073165">&lt;=</span>&nbsp;<span class="string" id="5073168">&#39;F&#39;</span><span class="op" id="5073171">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073175">return</span>&nbsp;<span class="builtintype" id="5073182">int</span><span class="op" id="5073185">(</span><span class="ident" id="5073186">ch</span>&nbsp;<span class="op" id="5073189">-</span>&nbsp;<span class="string" id="5073191">&#39;A&#39;</span>&nbsp;<span class="op" id="5073195">+</span>&nbsp;<span class="num" id="5073197">10</span><span class="op" id="5073199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073205">return</span>&nbsp;<span class="num" id="5073212">16</span>&nbsp;<span class="comment" id="5073215">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="5073250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5073253">func</span>&nbsp;<span class="op" id="5073258">(</span><span class="ident" id="5073259">s</span>&nbsp;<span class="op" id="5073261">*</span><span class="ident" id="5073262">Scanner</span><span class="op" id="5073269">)</span>&nbsp;<span class="ident" id="5073271">scanMantissa</span><span class="op" id="5073283">(</span><span class="ident" id="5073284">base</span>&nbsp;<span class="builtintype" id="5073289">int</span><span class="op" id="5073292">)</span>&nbsp;<span class="op" id="5073294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073297">for</span>&nbsp;<span class="ident" id="5073301">digitVal</span><span class="op" id="5073309">(</span><span class="ident" id="5073310">s</span><span class="op" id="5073311">.</span><span class="ident" id="5073312">ch</span><span class="op" id="5073314">)</span>&nbsp;<span class="op" id="5073316">&lt;</span>&nbsp;<span class="ident" id="5073318">base</span>&nbsp;<span class="op" id="5073323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073327">s</span><span class="op" id="5073328">.</span><span class="ident" id="5073329">next</span><span class="op" id="5073333">(</span><span class="op" id="5073334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073337">}</span><br>
<span class="lineno"></span><span class="op" id="5073339">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="5073342">func</span>&nbsp;<span class="op" id="5073347">(</span><span class="ident" id="5073348">s</span>&nbsp;<span class="op" id="5073350">*</span><span class="ident" id="5073351">Scanner</span><span class="op" id="5073358">)</span>&nbsp;<span class="ident" id="5073360">scanNumber</span><span class="op" id="5073370">(</span><span class="ident" id="5073371">seenDecimalPoint</span>&nbsp;<span class="builtintype" id="5073388">bool</span><span class="op" id="5073392">)</span>&nbsp;<span class="op" id="5073394">(</span><span class="ident" id="5073395">token</span><span class="op" id="5073400">.</span><span class="ident" id="5073401">Token</span><span class="op" id="5073406">,</span>&nbsp;<span class="builtintype" id="5073408">string</span><span class="op" id="5073414">)</span>&nbsp;<span class="op" id="5073416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073419">//&nbsp;digitVal(s.ch)&nbsp;&lt;&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073443">offs</span>&nbsp;<span class="op" id="5073448">:=</span>&nbsp;<span class="ident" id="5073451">s</span><span class="op" id="5073452">.</span><span class="ident" id="5073453">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073461">tok</span>&nbsp;<span class="op" id="5073465">:=</span>&nbsp;<span class="ident" id="5073468">token</span><span class="op" id="5073473">.</span><span class="ident" id="5073474">INT</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073480">if</span>&nbsp;<span class="ident" id="5073483">seenDecimalPoint</span>&nbsp;<span class="op" id="5073500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073504">offs</span><span class="op" id="5073508">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073513">tok</span>&nbsp;<span class="op" id="5073517">=</span>&nbsp;<span class="ident" id="5073519">token</span><span class="op" id="5073524">.</span><span class="ident" id="5073525">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073533">s</span><span class="op" id="5073534">.</span><span class="ident" id="5073535">scanMantissa</span><span class="op" id="5073547">(</span><span class="num" id="5073548">10</span><span class="op" id="5073550">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073554">goto</span>&nbsp;<span class="ident" id="5073559">exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073573">if</span>&nbsp;<span class="ident" id="5073576">s</span><span class="op" id="5073577">.</span><span class="ident" id="5073578">ch</span>&nbsp;<span class="op" id="5073581">==</span>&nbsp;<span class="string" id="5073584">&#39;0&#39;</span>&nbsp;<span class="op" id="5073588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073592">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073610">offs</span>&nbsp;<span class="op" id="5073615">:=</span>&nbsp;<span class="ident" id="5073618">s</span><span class="op" id="5073619">.</span><span class="ident" id="5073620">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073629">s</span><span class="op" id="5073630">.</span><span class="ident" id="5073631">next</span><span class="op" id="5073635">(</span><span class="op" id="5073636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073640">if</span>&nbsp;<span class="ident" id="5073643">s</span><span class="op" id="5073644">.</span><span class="ident" id="5073645">ch</span>&nbsp;<span class="op" id="5073648">==</span>&nbsp;<span class="string" id="5073651">&#39;x&#39;</span>&nbsp;<span class="op" id="5073655">||</span>&nbsp;<span class="ident" id="5073658">s</span><span class="op" id="5073659">.</span><span class="ident" id="5073660">ch</span>&nbsp;<span class="op" id="5073663">==</span>&nbsp;<span class="string" id="5073666">&#39;X&#39;</span>&nbsp;<span class="op" id="5073670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073675">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073697">s</span><span class="op" id="5073698">.</span><span class="ident" id="5073699">next</span><span class="op" id="5073703">(</span><span class="op" id="5073704">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073709">s</span><span class="op" id="5073710">.</span><span class="ident" id="5073711">scanMantissa</span><span class="op" id="5073723">(</span><span class="num" id="5073724">16</span><span class="op" id="5073726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073731">if</span>&nbsp;<span class="ident" id="5073734">s</span><span class="op" id="5073735">.</span><span class="ident" id="5073736">offset</span><span class="op" id="5073742">-</span><span class="ident" id="5073743">offs</span>&nbsp;<span class="op" id="5073748">&lt;=</span>&nbsp;<span class="num" id="5073751">2</span>&nbsp;<span class="op" id="5073753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073759">//&nbsp;only&nbsp;scanned&nbsp;&#34;0x&#34;&nbsp;or&nbsp;&#34;0X&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073792">s</span><span class="op" id="5073793">.</span><span class="builtintype" id="5073794">error</span><span class="op" id="5073799">(</span><span class="ident" id="5073800">offs</span><span class="op" id="5073804">,</span>&nbsp;<span class="string" id="5073806">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="5073834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073839">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5073843">}</span>&nbsp;<span class="keyword" id="5073845">else</span>&nbsp;<span class="op" id="5073850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073855">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073880">seenDecimalDigit</span>&nbsp;<span class="op" id="5073897">:=</span>&nbsp;<span class="builtintype" id="5073900">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5073909">s</span><span class="op" id="5073910">.</span><span class="ident" id="5073911">scanMantissa</span><span class="op" id="5073923">(</span><span class="num" id="5073924">8</span><span class="op" id="5073925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5073930">if</span>&nbsp;<span class="ident" id="5073933">s</span><span class="op" id="5073934">.</span><span class="ident" id="5073935">ch</span>&nbsp;<span class="op" id="5073938">==</span>&nbsp;<span class="string" id="5073941">&#39;8&#39;</span>&nbsp;<span class="op" id="5073945">||</span>&nbsp;<span class="ident" id="5073948">s</span><span class="op" id="5073949">.</span><span class="ident" id="5073950">ch</span>&nbsp;<span class="op" id="5073953">==</span>&nbsp;<span class="string" id="5073956">&#39;9&#39;</span>&nbsp;<span class="op" id="5073960">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5073966">//&nbsp;illegal&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074000">seenDecimalDigit</span>&nbsp;<span class="op" id="5074017">=</span>&nbsp;<span class="builtintype" id="5074019">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074028">s</span><span class="op" id="5074029">.</span><span class="ident" id="5074030">scanMantissa</span><span class="op" id="5074042">(</span><span class="num" id="5074043">10</span><span class="op" id="5074045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074055">if</span>&nbsp;<span class="ident" id="5074058">s</span><span class="op" id="5074059">.</span><span class="ident" id="5074060">ch</span>&nbsp;<span class="op" id="5074063">==</span>&nbsp;<span class="string" id="5074066">&#39;.&#39;</span>&nbsp;<span class="op" id="5074070">||</span>&nbsp;<span class="ident" id="5074073">s</span><span class="op" id="5074074">.</span><span class="ident" id="5074075">ch</span>&nbsp;<span class="op" id="5074078">==</span>&nbsp;<span class="string" id="5074081">&#39;e&#39;</span>&nbsp;<span class="op" id="5074085">||</span>&nbsp;<span class="ident" id="5074088">s</span><span class="op" id="5074089">.</span><span class="ident" id="5074090">ch</span>&nbsp;<span class="op" id="5074093">==</span>&nbsp;<span class="string" id="5074096">&#39;E&#39;</span>&nbsp;<span class="op" id="5074100">||</span>&nbsp;<span class="ident" id="5074103">s</span><span class="op" id="5074104">.</span><span class="ident" id="5074105">ch</span>&nbsp;<span class="op" id="5074108">==</span>&nbsp;<span class="string" id="5074111">&#39;i&#39;</span>&nbsp;<span class="op" id="5074115">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074121">goto</span>&nbsp;<span class="ident" id="5074126">fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5074143">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074159">if</span>&nbsp;<span class="ident" id="5074162">seenDecimalDigit</span>&nbsp;<span class="op" id="5074179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074185">s</span><span class="op" id="5074186">.</span><span class="builtintype" id="5074187">error</span><span class="op" id="5074192">(</span><span class="ident" id="5074193">offs</span><span class="op" id="5074197">,</span>&nbsp;<span class="string" id="5074199">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="5074221">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074234">goto</span>&nbsp;<span class="ident" id="5074239">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5074249">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074274">s</span><span class="op" id="5074275">.</span><span class="ident" id="5074276">scanMantissa</span><span class="op" id="5074288">(</span><span class="num" id="5074289">10</span><span class="op" id="5074291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5074294">fraction</span><span class="op" id="5074302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074305">if</span>&nbsp;<span class="ident" id="5074308">s</span><span class="op" id="5074309">.</span><span class="ident" id="5074310">ch</span>&nbsp;<span class="op" id="5074313">==</span>&nbsp;<span class="string" id="5074316">&#39;.&#39;</span>&nbsp;<span class="op" id="5074320">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074324">tok</span>&nbsp;<span class="op" id="5074328">=</span>&nbsp;<span class="ident" id="5074330">token</span><span class="op" id="5074335">.</span><span class="ident" id="5074336">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074344">s</span><span class="op" id="5074345">.</span><span class="ident" id="5074346">next</span><span class="op" id="5074350">(</span><span class="op" id="5074351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074355">s</span><span class="op" id="5074356">.</span><span class="ident" id="5074357">scanMantissa</span><span class="op" id="5074369">(</span><span class="num" id="5074370">10</span><span class="op" id="5074372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="ident" id="5074378">exponent</span><span class="op" id="5074386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074389">if</span>&nbsp;<span class="ident" id="5074392">s</span><span class="op" id="5074393">.</span><span class="ident" id="5074394">ch</span>&nbsp;<span class="op" id="5074397">==</span>&nbsp;<span class="string" id="5074400">&#39;e&#39;</span>&nbsp;<span class="op" id="5074404">||</span>&nbsp;<span class="ident" id="5074407">s</span><span class="op" id="5074408">.</span><span class="ident" id="5074409">ch</span>&nbsp;<span class="op" id="5074412">==</span>&nbsp;<span class="string" id="5074415">&#39;E&#39;</span>&nbsp;<span class="op" id="5074419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074423">tok</span>&nbsp;<span class="op" id="5074427">=</span>&nbsp;<span class="ident" id="5074429">token</span><span class="op" id="5074434">.</span><span class="ident" id="5074435">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074443">s</span><span class="op" id="5074444">.</span><span class="ident" id="5074445">next</span><span class="op" id="5074449">(</span><span class="op" id="5074450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074454">if</span>&nbsp;<span class="ident" id="5074457">s</span><span class="op" id="5074458">.</span><span class="ident" id="5074459">ch</span>&nbsp;<span class="op" id="5074462">==</span>&nbsp;<span class="string" id="5074465">&#39;-&#39;</span>&nbsp;<span class="op" id="5074469">||</span>&nbsp;<span class="ident" id="5074472">s</span><span class="op" id="5074473">.</span><span class="ident" id="5074474">ch</span>&nbsp;<span class="op" id="5074477">==</span>&nbsp;<span class="string" id="5074480">&#39;+&#39;</span>&nbsp;<span class="op" id="5074484">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074489">s</span><span class="op" id="5074490">.</span><span class="ident" id="5074491">next</span><span class="op" id="5074495">(</span><span class="op" id="5074496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074504">s</span><span class="op" id="5074505">.</span><span class="ident" id="5074506">scanMantissa</span><span class="op" id="5074518">(</span><span class="num" id="5074519">10</span><span class="op" id="5074521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074528">if</span>&nbsp;<span class="ident" id="5074531">s</span><span class="op" id="5074532">.</span><span class="ident" id="5074533">ch</span>&nbsp;<span class="op" id="5074536">==</span>&nbsp;<span class="string" id="5074539">&#39;i&#39;</span>&nbsp;<span class="op" id="5074543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074547">tok</span>&nbsp;<span class="op" id="5074551">=</span>&nbsp;<span class="ident" id="5074553">token</span><span class="op" id="5074558">.</span><span class="ident" id="5074559">IMAG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074566">s</span><span class="op" id="5074567">.</span><span class="ident" id="5074568">next</span><span class="op" id="5074572">(</span><span class="op" id="5074573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5074576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="ident" id="5074579">exit</span><span class="op" id="5074583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074586">return</span>&nbsp;<span class="ident" id="5074593">tok</span><span class="op" id="5074596">,</span>&nbsp;<span class="builtintype" id="5074598">string</span><span class="op" id="5074604">(</span><span class="ident" id="5074605">s</span><span class="op" id="5074606">.</span><span class="ident" id="5074607">src</span><span class="op" id="5074610">[</span><span class="ident" id="5074611">offs</span><span class="op" id="5074615">:</span><span class="ident" id="5074616">s</span><span class="op" id="5074617">.</span><span class="ident" id="5074618">offset</span><span class="op" id="5074624">]</span><span class="op" id="5074625">)</span><br>
<span class="lineno"></span><span class="op" id="5074627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5074630">//&nbsp;scanEscape&nbsp;parses&nbsp;an&nbsp;escape&nbsp;sequence&nbsp;where&nbsp;rune&nbsp;is&nbsp;the&nbsp;accepted</span><br>
<span class="lineno">365</span><span class="comment" id="5074697">//&nbsp;escaped&nbsp;quote.&nbsp;In&nbsp;case&nbsp;of&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;it&nbsp;stops&nbsp;at&nbsp;the&nbsp;offending</span><br>
<span class="lineno"></span><span class="comment" id="5074768">//&nbsp;character&nbsp;(without&nbsp;consuming&nbsp;it)&nbsp;and&nbsp;returns&nbsp;false.&nbsp;Otherwise</span><br>
<span class="lineno"></span><span class="comment" id="5074833">//&nbsp;it&nbsp;returns&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="5074853">func</span>&nbsp;<span class="op" id="5074858">(</span><span class="ident" id="5074859">s</span>&nbsp;<span class="op" id="5074861">*</span><span class="ident" id="5074862">Scanner</span><span class="op" id="5074869">)</span>&nbsp;<span class="ident" id="5074871">scanEscape</span><span class="op" id="5074881">(</span><span class="ident" id="5074882">quote</span>&nbsp;<span class="builtintype" id="5074888">rune</span><span class="op" id="5074892">)</span>&nbsp;<span class="builtintype" id="5074894">bool</span>&nbsp;<span class="op" id="5074899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5074902">offs</span>&nbsp;<span class="op" id="5074907">:=</span>&nbsp;<span class="ident" id="5074910">s</span><span class="op" id="5074911">.</span><span class="ident" id="5074912">offset</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074921">var</span>&nbsp;<span class="ident" id="5074925">n</span>&nbsp;<span class="builtintype" id="5074927">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074932">var</span>&nbsp;<span class="ident" id="5074936">base</span><span class="op" id="5074940">,</span>&nbsp;<span class="ident" id="5074942">max</span>&nbsp;<span class="builtintype" id="5074946">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074954">switch</span>&nbsp;<span class="ident" id="5074961">s</span><span class="op" id="5074962">.</span><span class="ident" id="5074963">ch</span>&nbsp;<span class="op" id="5074966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5074969">case</span>&nbsp;<span class="string" id="5074974">&#39;a&#39;</span><span class="op" id="5074977">,</span>&nbsp;<span class="string" id="5074979">&#39;b&#39;</span><span class="op" id="5074982">,</span>&nbsp;<span class="string" id="5074984">&#39;f&#39;</span><span class="op" id="5074987">,</span>&nbsp;<span class="string" id="5074989">&#39;n&#39;</span><span class="op" id="5074992">,</span>&nbsp;<span class="string" id="5074994">&#39;r&#39;</span><span class="op" id="5074997">,</span>&nbsp;<span class="string" id="5074999">&#39;t&#39;</span><span class="op" id="5075002">,</span>&nbsp;<span class="string" id="5075004">&#39;v&#39;</span><span class="op" id="5075007">,</span>&nbsp;<span class="string" id="5075009">&#39;\\&#39;</span><span class="op" id="5075013">,</span>&nbsp;<span class="ident" id="5075015">quote</span><span class="op" id="5075020">:</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075024">s</span><span class="op" id="5075025">.</span><span class="ident" id="5075026">next</span><span class="op" id="5075030">(</span><span class="op" id="5075031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075035">return</span>&nbsp;<span class="builtintype" id="5075042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075048">case</span>&nbsp;<span class="string" id="5075053">&#39;0&#39;</span><span class="op" id="5075056">,</span>&nbsp;<span class="string" id="5075058">&#39;1&#39;</span><span class="op" id="5075061">,</span>&nbsp;<span class="string" id="5075063">&#39;2&#39;</span><span class="op" id="5075066">,</span>&nbsp;<span class="string" id="5075068">&#39;3&#39;</span><span class="op" id="5075071">,</span>&nbsp;<span class="string" id="5075073">&#39;4&#39;</span><span class="op" id="5075076">,</span>&nbsp;<span class="string" id="5075078">&#39;5&#39;</span><span class="op" id="5075081">,</span>&nbsp;<span class="string" id="5075083">&#39;6&#39;</span><span class="op" id="5075086">,</span>&nbsp;<span class="string" id="5075088">&#39;7&#39;</span><span class="op" id="5075091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075095">n</span><span class="op" id="5075096">,</span>&nbsp;<span class="ident" id="5075098">base</span><span class="op" id="5075102">,</span>&nbsp;<span class="ident" id="5075104">max</span>&nbsp;<span class="op" id="5075108">=</span>&nbsp;<span class="num" id="5075110">3</span><span class="op" id="5075111">,</span>&nbsp;<span class="num" id="5075113">8</span><span class="op" id="5075114">,</span>&nbsp;<span class="num" id="5075116">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075121">case</span>&nbsp;<span class="string" id="5075126">&#39;x&#39;</span><span class="op" id="5075129">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075133">s</span><span class="op" id="5075134">.</span><span class="ident" id="5075135">next</span><span class="op" id="5075139">(</span><span class="op" id="5075140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075144">n</span><span class="op" id="5075145">,</span>&nbsp;<span class="ident" id="5075147">base</span><span class="op" id="5075151">,</span>&nbsp;<span class="ident" id="5075153">max</span>&nbsp;<span class="op" id="5075157">=</span>&nbsp;<span class="num" id="5075159">2</span><span class="op" id="5075160">,</span>&nbsp;<span class="num" id="5075162">16</span><span class="op" id="5075164">,</span>&nbsp;<span class="num" id="5075166">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075171">case</span>&nbsp;<span class="string" id="5075176">&#39;u&#39;</span><span class="op" id="5075179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075183">s</span><span class="op" id="5075184">.</span><span class="ident" id="5075185">next</span><span class="op" id="5075189">(</span><span class="op" id="5075190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075194">n</span><span class="op" id="5075195">,</span>&nbsp;<span class="ident" id="5075197">base</span><span class="op" id="5075201">,</span>&nbsp;<span class="ident" id="5075203">max</span>&nbsp;<span class="op" id="5075207">=</span>&nbsp;<span class="num" id="5075209">4</span><span class="op" id="5075210">,</span>&nbsp;<span class="num" id="5075212">16</span><span class="op" id="5075214">,</span>&nbsp;<span class="ident" id="5075216">unicode</span><span class="op" id="5075223">.</span><span class="ident" id="5075224">MaxRune</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075233">case</span>&nbsp;<span class="string" id="5075238">&#39;U&#39;</span><span class="op" id="5075241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075245">s</span><span class="op" id="5075246">.</span><span class="ident" id="5075247">next</span><span class="op" id="5075251">(</span><span class="op" id="5075252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075256">n</span><span class="op" id="5075257">,</span>&nbsp;<span class="ident" id="5075259">base</span><span class="op" id="5075263">,</span>&nbsp;<span class="ident" id="5075265">max</span>&nbsp;<span class="op" id="5075269">=</span>&nbsp;<span class="num" id="5075271">8</span><span class="op" id="5075272">,</span>&nbsp;<span class="num" id="5075274">16</span><span class="op" id="5075276">,</span>&nbsp;<span class="ident" id="5075278">unicode</span><span class="op" id="5075285">.</span><span class="ident" id="5075286">MaxRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075295">default</span><span class="op" id="5075302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075306">msg</span>&nbsp;<span class="op" id="5075310">:=</span>&nbsp;<span class="string" id="5075313">&#34;unknown&nbsp;escape&nbsp;sequence&#34;</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075341">if</span>&nbsp;<span class="ident" id="5075344">s</span><span class="op" id="5075345">.</span><span class="ident" id="5075346">ch</span>&nbsp;<span class="op" id="5075349">&lt;</span>&nbsp;<span class="num" id="5075351">0</span>&nbsp;<span class="op" id="5075353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075358">msg</span>&nbsp;<span class="op" id="5075362">=</span>&nbsp;<span class="string" id="5075364">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075403">s</span><span class="op" id="5075404">.</span><span class="builtintype" id="5075405">error</span><span class="op" id="5075410">(</span><span class="ident" id="5075411">offs</span><span class="op" id="5075415">,</span>&nbsp;<span class="ident" id="5075417">msg</span><span class="op" id="5075420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075424">return</span>&nbsp;<span class="builtintype" id="5075431">false</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075442">var</span>&nbsp;<span class="ident" id="5075446">x</span>&nbsp;<span class="builtintype" id="5075448">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075456">for</span>&nbsp;<span class="ident" id="5075460">n</span>&nbsp;<span class="op" id="5075462">&gt;</span>&nbsp;<span class="num" id="5075464">0</span>&nbsp;<span class="op" id="5075466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075470">d</span>&nbsp;<span class="op" id="5075472">:=</span>&nbsp;<span class="builtintype" id="5075475">uint32</span><span class="op" id="5075481">(</span><span class="ident" id="5075482">digitVal</span><span class="op" id="5075490">(</span><span class="ident" id="5075491">s</span><span class="op" id="5075492">.</span><span class="ident" id="5075493">ch</span><span class="op" id="5075495">)</span><span class="op" id="5075496">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075500">if</span>&nbsp;<span class="ident" id="5075503">d</span>&nbsp;<span class="op" id="5075505">&gt;=</span>&nbsp;<span class="ident" id="5075508">base</span>&nbsp;<span class="op" id="5075513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075518">msg</span>&nbsp;<span class="op" id="5075522">:=</span>&nbsp;<span class="ident" id="5075525">fmt</span><span class="op" id="5075528">.</span><span class="ident" id="5075529">Sprintf</span><span class="op" id="5075536">(</span><span class="string" id="5075537">&#34;illegal&nbsp;character&nbsp;%#U&nbsp;in&nbsp;escape&nbsp;sequence&#34;</span><span class="op" id="5075579">,</span>&nbsp;<span class="ident" id="5075581">s</span><span class="op" id="5075582">.</span><span class="ident" id="5075583">ch</span><span class="op" id="5075585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075590">if</span>&nbsp;<span class="ident" id="5075593">s</span><span class="op" id="5075594">.</span><span class="ident" id="5075595">ch</span>&nbsp;<span class="op" id="5075598">&lt;</span>&nbsp;<span class="num" id="5075600">0</span>&nbsp;<span class="op" id="5075602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075608">msg</span>&nbsp;<span class="op" id="5075612">=</span>&nbsp;<span class="string" id="5075614">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075650">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075655">s</span><span class="op" id="5075656">.</span><span class="builtintype" id="5075657">error</span><span class="op" id="5075662">(</span><span class="ident" id="5075663">s</span><span class="op" id="5075664">.</span><span class="ident" id="5075665">offset</span><span class="op" id="5075671">,</span>&nbsp;<span class="ident" id="5075673">msg</span><span class="op" id="5075676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075681">return</span>&nbsp;<span class="builtintype" id="5075688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075700">x</span>&nbsp;<span class="op" id="5075702">=</span>&nbsp;<span class="ident" id="5075704">x</span><span class="op" id="5075705">*</span><span class="ident" id="5075706">base</span>&nbsp;<span class="op" id="5075711">+</span>&nbsp;<span class="ident" id="5075713">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075717">s</span><span class="op" id="5075718">.</span><span class="ident" id="5075719">next</span><span class="op" id="5075723">(</span><span class="op" id="5075724">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075728">n</span><span class="op" id="5075729">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075737">if</span>&nbsp;<span class="ident" id="5075740">x</span>&nbsp;<span class="op" id="5075742">&gt;</span>&nbsp;<span class="ident" id="5075744">max</span>&nbsp;<span class="op" id="5075748">||</span>&nbsp;<span class="num" id="5075751">0xD800</span>&nbsp;<span class="op" id="5075758">&lt;=</span>&nbsp;<span class="ident" id="5075761">x</span>&nbsp;<span class="op" id="5075763">&amp;&amp;</span>&nbsp;<span class="ident" id="5075766">x</span>&nbsp;<span class="op" id="5075768">&lt;</span>&nbsp;<span class="num" id="5075770">0xE000</span>&nbsp;<span class="op" id="5075777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075781">s</span><span class="op" id="5075782">.</span><span class="builtintype" id="5075783">error</span><span class="op" id="5075788">(</span><span class="ident" id="5075789">offs</span><span class="op" id="5075793">,</span>&nbsp;<span class="string" id="5075795">&#34;escape&nbsp;sequence&nbsp;is&nbsp;invalid&nbsp;Unicode&nbsp;code&nbsp;point&#34;</span><span class="op" id="5075842">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075846">return</span>&nbsp;<span class="builtintype" id="5075853">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5075860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075864">return</span>&nbsp;<span class="builtintype" id="5075871">true</span><br>
<span class="lineno"></span><span class="op" id="5075876">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="keyword" id="5075879">func</span>&nbsp;<span class="op" id="5075884">(</span><span class="ident" id="5075885">s</span>&nbsp;<span class="op" id="5075887">*</span><span class="ident" id="5075888">Scanner</span><span class="op" id="5075895">)</span>&nbsp;<span class="ident" id="5075897">scanRune</span><span class="op" id="5075905">(</span><span class="op" id="5075906">)</span>&nbsp;<span class="builtintype" id="5075908">string</span>&nbsp;<span class="op" id="5075915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5075918">//&nbsp;&#39;\&#39;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075952">offs</span>&nbsp;<span class="op" id="5075957">:=</span>&nbsp;<span class="ident" id="5075960">s</span><span class="op" id="5075961">.</span><span class="ident" id="5075962">offset</span>&nbsp;<span class="op" id="5075969">-</span>&nbsp;<span class="num" id="5075971">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075975">valid</span>&nbsp;<span class="op" id="5075981">:=</span>&nbsp;<span class="builtintype" id="5075984">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5075990">n</span>&nbsp;<span class="op" id="5075992">:=</span>&nbsp;<span class="num" id="5075995">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5075998">for</span>&nbsp;<span class="op" id="5076002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076006">ch</span>&nbsp;<span class="op" id="5076009">:=</span>&nbsp;<span class="ident" id="5076012">s</span><span class="op" id="5076013">.</span><span class="ident" id="5076014">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076019">if</span>&nbsp;<span class="ident" id="5076022">ch</span>&nbsp;<span class="op" id="5076025">==</span>&nbsp;<span class="string" id="5076028">&#39;\n&#39;</span>&nbsp;<span class="op" id="5076033">||</span>&nbsp;<span class="ident" id="5076036">ch</span>&nbsp;<span class="op" id="5076039">&lt;</span>&nbsp;<span class="num" id="5076041">0</span>&nbsp;<span class="op" id="5076043">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5076048">//&nbsp;only&nbsp;report&nbsp;error&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;one&nbsp;already</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076101">if</span>&nbsp;<span class="ident" id="5076104">valid</span>&nbsp;<span class="op" id="5076110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076116">s</span><span class="op" id="5076117">.</span><span class="builtintype" id="5076118">error</span><span class="op" id="5076123">(</span><span class="ident" id="5076124">offs</span><span class="op" id="5076128">,</span>&nbsp;<span class="string" id="5076130">&#34;rune&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5076159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076165">valid</span>&nbsp;<span class="op" id="5076171">=</span>&nbsp;<span class="builtintype" id="5076173">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076182">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076187">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076199">s</span><span class="op" id="5076200">.</span><span class="ident" id="5076201">next</span><span class="op" id="5076205">(</span><span class="op" id="5076206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076210">if</span>&nbsp;<span class="ident" id="5076213">ch</span>&nbsp;<span class="op" id="5076216">==</span>&nbsp;<span class="string" id="5076219">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="5076224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076229">break</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076241">n</span><span class="op" id="5076242">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076247">if</span>&nbsp;<span class="ident" id="5076250">ch</span>&nbsp;<span class="op" id="5076253">==</span>&nbsp;<span class="string" id="5076256">&#39;\\&#39;</span>&nbsp;<span class="op" id="5076261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076266">if</span>&nbsp;<span class="op" id="5076269">!</span><span class="ident" id="5076270">s</span><span class="op" id="5076271">.</span><span class="ident" id="5076272">scanEscape</span><span class="op" id="5076282">(</span><span class="string" id="5076283">&#39;\&#39;&#39;</span><span class="op" id="5076287">)</span>&nbsp;<span class="op" id="5076289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076295">valid</span>&nbsp;<span class="op" id="5076301">=</span>&nbsp;<span class="builtintype" id="5076303">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5076317">//&nbsp;continue&nbsp;to&nbsp;read&nbsp;to&nbsp;closing&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076363">if</span>&nbsp;<span class="ident" id="5076366">valid</span>&nbsp;<span class="op" id="5076372">&amp;&amp;</span>&nbsp;<span class="ident" id="5076375">n</span>&nbsp;<span class="op" id="5076377">!=</span>&nbsp;<span class="num" id="5076380">1</span>&nbsp;<span class="op" id="5076382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076386">s</span><span class="op" id="5076387">.</span><span class="builtintype" id="5076388">error</span><span class="op" id="5076393">(</span><span class="ident" id="5076394">offs</span><span class="op" id="5076398">,</span>&nbsp;<span class="string" id="5076400">&#34;illegal&nbsp;rune&nbsp;literal&#34;</span><span class="op" id="5076422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076429">return</span>&nbsp;<span class="builtintype" id="5076436">string</span><span class="op" id="5076442">(</span><span class="ident" id="5076443">s</span><span class="op" id="5076444">.</span><span class="ident" id="5076445">src</span><span class="op" id="5076448">[</span><span class="ident" id="5076449">offs</span><span class="op" id="5076453">:</span><span class="ident" id="5076454">s</span><span class="op" id="5076455">.</span><span class="ident" id="5076456">offset</span><span class="op" id="5076462">]</span><span class="op" id="5076463">)</span><br>
<span class="lineno">455</span><span class="op" id="5076465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5076468">func</span>&nbsp;<span class="op" id="5076473">(</span><span class="ident" id="5076474">s</span>&nbsp;<span class="op" id="5076476">*</span><span class="ident" id="5076477">Scanner</span><span class="op" id="5076484">)</span>&nbsp;<span class="ident" id="5076486">scanString</span><span class="op" id="5076496">(</span><span class="op" id="5076497">)</span>&nbsp;<span class="builtintype" id="5076499">string</span>&nbsp;<span class="op" id="5076506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5076509">//&nbsp;&#39;&#34;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076542">offs</span>&nbsp;<span class="op" id="5076547">:=</span>&nbsp;<span class="ident" id="5076550">s</span><span class="op" id="5076551">.</span><span class="ident" id="5076552">offset</span>&nbsp;<span class="op" id="5076559">-</span>&nbsp;<span class="num" id="5076561">1</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076565">for</span>&nbsp;<span class="op" id="5076569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076573">ch</span>&nbsp;<span class="op" id="5076576">:=</span>&nbsp;<span class="ident" id="5076579">s</span><span class="op" id="5076580">.</span><span class="ident" id="5076581">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076586">if</span>&nbsp;<span class="ident" id="5076589">ch</span>&nbsp;<span class="op" id="5076592">==</span>&nbsp;<span class="string" id="5076595">&#39;\n&#39;</span>&nbsp;<span class="op" id="5076600">||</span>&nbsp;<span class="ident" id="5076603">ch</span>&nbsp;<span class="op" id="5076606">&lt;</span>&nbsp;<span class="num" id="5076608">0</span>&nbsp;<span class="op" id="5076610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076615">s</span><span class="op" id="5076616">.</span><span class="builtintype" id="5076617">error</span><span class="op" id="5076622">(</span><span class="ident" id="5076623">offs</span><span class="op" id="5076627">,</span>&nbsp;<span class="string" id="5076629">&#34;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5076660">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076665">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076677">s</span><span class="op" id="5076678">.</span><span class="ident" id="5076679">next</span><span class="op" id="5076683">(</span><span class="op" id="5076684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076688">if</span>&nbsp;<span class="ident" id="5076691">ch</span>&nbsp;<span class="op" id="5076694">==</span>&nbsp;<span class="string" id="5076697">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5076701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076706">break</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076718">if</span>&nbsp;<span class="ident" id="5076721">ch</span>&nbsp;<span class="op" id="5076724">==</span>&nbsp;<span class="string" id="5076727">&#39;\\&#39;</span>&nbsp;<span class="op" id="5076732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076737">s</span><span class="op" id="5076738">.</span><span class="ident" id="5076739">scanEscape</span><span class="op" id="5076749">(</span><span class="string" id="5076750">&#39;&#34;&#39;</span><span class="op" id="5076753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076760">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076764">return</span>&nbsp;<span class="builtintype" id="5076771">string</span><span class="op" id="5076777">(</span><span class="ident" id="5076778">s</span><span class="op" id="5076779">.</span><span class="ident" id="5076780">src</span><span class="op" id="5076783">[</span><span class="ident" id="5076784">offs</span><span class="op" id="5076788">:</span><span class="ident" id="5076789">s</span><span class="op" id="5076790">.</span><span class="ident" id="5076791">offset</span><span class="op" id="5076797">]</span><span class="op" id="5076798">)</span><br>
<span class="lineno"></span><span class="op" id="5076800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5076803">func</span>&nbsp;<span class="ident" id="5076808">stripCR</span><span class="op" id="5076815">(</span><span class="ident" id="5076816">b</span>&nbsp;<span class="op" id="5076818">[</span><span class="op" id="5076819">]</span><span class="builtintype" id="5076820">byte</span><span class="op" id="5076824">)</span>&nbsp;<span class="op" id="5076826">[</span><span class="op" id="5076827">]</span><span class="builtintype" id="5076828">byte</span>&nbsp;<span class="op" id="5076833">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076836">c</span>&nbsp;<span class="op" id="5076838">:=</span>&nbsp;<span class="builtinfunc" id="5076841">make</span><span class="op" id="5076845">(</span><span class="op" id="5076846">[</span><span class="op" id="5076847">]</span><span class="builtintype" id="5076848">byte</span><span class="op" id="5076852">,</span>&nbsp;<span class="builtinfunc" id="5076854">len</span><span class="op" id="5076857">(</span><span class="ident" id="5076858">b</span><span class="op" id="5076859">)</span><span class="op" id="5076860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076863">i</span>&nbsp;<span class="op" id="5076865">:=</span>&nbsp;<span class="num" id="5076868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076871">for</span>&nbsp;<span class="ident" id="5076875">_</span><span class="op" id="5076876">,</span>&nbsp;<span class="ident" id="5076878">ch</span>&nbsp;<span class="op" id="5076881">:=</span>&nbsp;<span class="keyword" id="5076884">range</span>&nbsp;<span class="ident" id="5076890">b</span>&nbsp;<span class="op" id="5076892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076896">if</span>&nbsp;<span class="ident" id="5076899">ch</span>&nbsp;<span class="op" id="5076902">!=</span>&nbsp;<span class="string" id="5076905">&#39;\r&#39;</span>&nbsp;<span class="op" id="5076910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076915">c</span><span class="op" id="5076916">[</span><span class="ident" id="5076917">i</span><span class="op" id="5076918">]</span>&nbsp;<span class="op" id="5076920">=</span>&nbsp;<span class="ident" id="5076922">ch</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5076928">i</span><span class="op" id="5076929">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5076937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5076940">return</span>&nbsp;<span class="ident" id="5076947">c</span><span class="op" id="5076948">[</span><span class="op" id="5076949">:</span><span class="ident" id="5076950">i</span><span class="op" id="5076951">]</span><br>
<span class="lineno"></span><span class="op" id="5076953">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span><span class="keyword" id="5076956">func</span>&nbsp;<span class="op" id="5076961">(</span><span class="ident" id="5076962">s</span>&nbsp;<span class="op" id="5076964">*</span><span class="ident" id="5076965">Scanner</span><span class="op" id="5076972">)</span>&nbsp;<span class="ident" id="5076974">scanRawString</span><span class="op" id="5076987">(</span><span class="op" id="5076988">)</span>&nbsp;<span class="builtintype" id="5076990">string</span>&nbsp;<span class="op" id="5076997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077000">//&nbsp;&#39;`&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077033">offs</span>&nbsp;<span class="op" id="5077038">:=</span>&nbsp;<span class="ident" id="5077041">s</span><span class="op" id="5077042">.</span><span class="ident" id="5077043">offset</span>&nbsp;<span class="op" id="5077050">-</span>&nbsp;<span class="num" id="5077052">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077056">hasCR</span>&nbsp;<span class="op" id="5077062">:=</span>&nbsp;<span class="builtintype" id="5077065">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077072">for</span>&nbsp;<span class="op" id="5077076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077080">ch</span>&nbsp;<span class="op" id="5077083">:=</span>&nbsp;<span class="ident" id="5077086">s</span><span class="op" id="5077087">.</span><span class="ident" id="5077088">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077093">if</span>&nbsp;<span class="ident" id="5077096">ch</span>&nbsp;<span class="op" id="5077099">&lt;</span>&nbsp;<span class="num" id="5077101">0</span>&nbsp;<span class="op" id="5077103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077108">s</span><span class="op" id="5077109">.</span><span class="builtintype" id="5077110">error</span><span class="op" id="5077115">(</span><span class="ident" id="5077116">offs</span><span class="op" id="5077120">,</span>&nbsp;<span class="string" id="5077122">&#34;raw&nbsp;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5077157">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077162">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077174">s</span><span class="op" id="5077175">.</span><span class="ident" id="5077176">next</span><span class="op" id="5077180">(</span><span class="op" id="5077181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077185">if</span>&nbsp;<span class="ident" id="5077188">ch</span>&nbsp;<span class="op" id="5077191">==</span>&nbsp;<span class="string" id="5077194">&#39;`&#39;</span>&nbsp;<span class="op" id="5077198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077203">break</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077215">if</span>&nbsp;<span class="ident" id="5077218">ch</span>&nbsp;<span class="op" id="5077221">==</span>&nbsp;<span class="string" id="5077224">&#39;\r&#39;</span>&nbsp;<span class="op" id="5077229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077234">hasCR</span>&nbsp;<span class="op" id="5077240">=</span>&nbsp;<span class="builtintype" id="5077242">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077252">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077256">lit</span>&nbsp;<span class="op" id="5077260">:=</span>&nbsp;<span class="ident" id="5077263">s</span><span class="op" id="5077264">.</span><span class="ident" id="5077265">src</span><span class="op" id="5077268">[</span><span class="ident" id="5077269">offs</span><span class="op" id="5077273">:</span><span class="ident" id="5077274">s</span><span class="op" id="5077275">.</span><span class="ident" id="5077276">offset</span><span class="op" id="5077282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077285">if</span>&nbsp;<span class="ident" id="5077288">hasCR</span>&nbsp;<span class="op" id="5077294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077298">lit</span>&nbsp;<span class="op" id="5077302">=</span>&nbsp;<span class="ident" id="5077304">stripCR</span><span class="op" id="5077311">(</span><span class="ident" id="5077312">lit</span><span class="op" id="5077315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077318">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077322">return</span>&nbsp;<span class="builtintype" id="5077329">string</span><span class="op" id="5077335">(</span><span class="ident" id="5077336">lit</span><span class="op" id="5077339">)</span><br>
<span class="lineno"></span><span class="op" id="5077341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5077344">func</span>&nbsp;<span class="op" id="5077349">(</span><span class="ident" id="5077350">s</span>&nbsp;<span class="op" id="5077352">*</span><span class="ident" id="5077353">Scanner</span><span class="op" id="5077360">)</span>&nbsp;<span class="ident" id="5077362">skipWhitespace</span><span class="op" id="5077376">(</span><span class="op" id="5077377">)</span>&nbsp;<span class="op" id="5077379">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077382">for</span>&nbsp;<span class="ident" id="5077386">s</span><span class="op" id="5077387">.</span><span class="ident" id="5077388">ch</span>&nbsp;<span class="op" id="5077391">==</span>&nbsp;<span class="string" id="5077394">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5077398">||</span>&nbsp;<span class="ident" id="5077401">s</span><span class="op" id="5077402">.</span><span class="ident" id="5077403">ch</span>&nbsp;<span class="op" id="5077406">==</span>&nbsp;<span class="string" id="5077409">&#39;\t&#39;</span>&nbsp;<span class="op" id="5077414">||</span>&nbsp;<span class="ident" id="5077417">s</span><span class="op" id="5077418">.</span><span class="ident" id="5077419">ch</span>&nbsp;<span class="op" id="5077422">==</span>&nbsp;<span class="string" id="5077425">&#39;\n&#39;</span>&nbsp;<span class="op" id="5077430">&amp;&amp;</span>&nbsp;<span class="op" id="5077433">!</span><span class="ident" id="5077434">s</span><span class="op" id="5077435">.</span><span class="ident" id="5077436">insertSemi</span>&nbsp;<span class="op" id="5077447">||</span>&nbsp;<span class="ident" id="5077450">s</span><span class="op" id="5077451">.</span><span class="ident" id="5077452">ch</span>&nbsp;<span class="op" id="5077455">==</span>&nbsp;<span class="string" id="5077458">&#39;\r&#39;</span>&nbsp;<span class="op" id="5077463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077467">s</span><span class="op" id="5077468">.</span><span class="ident" id="5077469">next</span><span class="op" id="5077473">(</span><span class="op" id="5077474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077477">}</span><br>
<span class="lineno"></span><span class="op" id="5077479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="5077482">//&nbsp;Helper&nbsp;functions&nbsp;for&nbsp;scanning&nbsp;multi-byte&nbsp;tokens&nbsp;such&nbsp;as&nbsp;&gt;&gt;&nbsp;+=&nbsp;&gt;&gt;=&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5077553">//&nbsp;Different&nbsp;routines&nbsp;recognize&nbsp;different&nbsp;length&nbsp;tok_i&nbsp;based&nbsp;on&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5077625">//&nbsp;of&nbsp;ch_i.&nbsp;If&nbsp;a&nbsp;token&nbsp;ends&nbsp;in&nbsp;&#39;=&#39;,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok1&nbsp;or&nbsp;tok3</span><br>
<span class="lineno"></span><span class="comment" id="5077688">//&nbsp;respectively.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok0&nbsp;if&nbsp;there&nbsp;was&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5077757">//&nbsp;matching&nbsp;character,&nbsp;or&nbsp;tok2&nbsp;if&nbsp;the&nbsp;matching&nbsp;character&nbsp;was&nbsp;ch2.</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="5077824">func</span>&nbsp;<span class="op" id="5077829">(</span><span class="ident" id="5077830">s</span>&nbsp;<span class="op" id="5077832">*</span><span class="ident" id="5077833">Scanner</span><span class="op" id="5077840">)</span>&nbsp;<span class="ident" id="5077842">switch2</span><span class="op" id="5077849">(</span><span class="ident" id="5077850">tok0</span><span class="op" id="5077854">,</span>&nbsp;<span class="ident" id="5077856">tok1</span>&nbsp;<span class="ident" id="5077861">token</span><span class="op" id="5077866">.</span><span class="ident" id="5077867">Token</span><span class="op" id="5077872">)</span>&nbsp;<span class="ident" id="5077874">token</span><span class="op" id="5077879">.</span><span class="ident" id="5077880">Token</span>&nbsp;<span class="op" id="5077886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077889">if</span>&nbsp;<span class="ident" id="5077892">s</span><span class="op" id="5077893">.</span><span class="ident" id="5077894">ch</span>&nbsp;<span class="op" id="5077897">==</span>&nbsp;<span class="string" id="5077900">&#39;=&#39;</span>&nbsp;<span class="op" id="5077904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077908">s</span><span class="op" id="5077909">.</span><span class="ident" id="5077910">next</span><span class="op" id="5077914">(</span><span class="op" id="5077915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077919">return</span>&nbsp;<span class="ident" id="5077926">tok1</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077935">return</span>&nbsp;<span class="ident" id="5077942">tok0</span><br>
<span class="lineno"></span><span class="op" id="5077947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5077950">func</span>&nbsp;<span class="op" id="5077955">(</span><span class="ident" id="5077956">s</span>&nbsp;<span class="op" id="5077958">*</span><span class="ident" id="5077959">Scanner</span><span class="op" id="5077966">)</span>&nbsp;<span class="ident" id="5077968">switch3</span><span class="op" id="5077975">(</span><span class="ident" id="5077976">tok0</span><span class="op" id="5077980">,</span>&nbsp;<span class="ident" id="5077982">tok1</span>&nbsp;<span class="ident" id="5077987">token</span><span class="op" id="5077992">.</span><span class="ident" id="5077993">Token</span><span class="op" id="5077998">,</span>&nbsp;<span class="ident" id="5078000">ch2</span>&nbsp;<span class="builtintype" id="5078004">rune</span><span class="op" id="5078008">,</span>&nbsp;<span class="ident" id="5078010">tok2</span>&nbsp;<span class="ident" id="5078015">token</span><span class="op" id="5078020">.</span><span class="ident" id="5078021">Token</span><span class="op" id="5078026">)</span>&nbsp;<span class="ident" id="5078028">token</span><span class="op" id="5078033">.</span><span class="ident" id="5078034">Token</span>&nbsp;<span class="op" id="5078040">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078043">if</span>&nbsp;<span class="ident" id="5078046">s</span><span class="op" id="5078047">.</span><span class="ident" id="5078048">ch</span>&nbsp;<span class="op" id="5078051">==</span>&nbsp;<span class="string" id="5078054">&#39;=&#39;</span>&nbsp;<span class="op" id="5078058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078062">s</span><span class="op" id="5078063">.</span><span class="ident" id="5078064">next</span><span class="op" id="5078068">(</span><span class="op" id="5078069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078073">return</span>&nbsp;<span class="ident" id="5078080">tok1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078089">if</span>&nbsp;<span class="ident" id="5078092">s</span><span class="op" id="5078093">.</span><span class="ident" id="5078094">ch</span>&nbsp;<span class="op" id="5078097">==</span>&nbsp;<span class="ident" id="5078100">ch2</span>&nbsp;<span class="op" id="5078104">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078108">s</span><span class="op" id="5078109">.</span><span class="ident" id="5078110">next</span><span class="op" id="5078114">(</span><span class="op" id="5078115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078119">return</span>&nbsp;<span class="ident" id="5078126">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078135">return</span>&nbsp;<span class="ident" id="5078142">tok0</span><br>
<span class="lineno"></span><span class="op" id="5078147">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="5078150">func</span>&nbsp;<span class="op" id="5078155">(</span><span class="ident" id="5078156">s</span>&nbsp;<span class="op" id="5078158">*</span><span class="ident" id="5078159">Scanner</span><span class="op" id="5078166">)</span>&nbsp;<span class="ident" id="5078168">switch4</span><span class="op" id="5078175">(</span><span class="ident" id="5078176">tok0</span><span class="op" id="5078180">,</span>&nbsp;<span class="ident" id="5078182">tok1</span>&nbsp;<span class="ident" id="5078187">token</span><span class="op" id="5078192">.</span><span class="ident" id="5078193">Token</span><span class="op" id="5078198">,</span>&nbsp;<span class="ident" id="5078200">ch2</span>&nbsp;<span class="builtintype" id="5078204">rune</span><span class="op" id="5078208">,</span>&nbsp;<span class="ident" id="5078210">tok2</span><span class="op" id="5078214">,</span>&nbsp;<span class="ident" id="5078216">tok3</span>&nbsp;<span class="ident" id="5078221">token</span><span class="op" id="5078226">.</span><span class="ident" id="5078227">Token</span><span class="op" id="5078232">)</span>&nbsp;<span class="ident" id="5078234">token</span><span class="op" id="5078239">.</span><span class="ident" id="5078240">Token</span>&nbsp;<span class="op" id="5078246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078249">if</span>&nbsp;<span class="ident" id="5078252">s</span><span class="op" id="5078253">.</span><span class="ident" id="5078254">ch</span>&nbsp;<span class="op" id="5078257">==</span>&nbsp;<span class="string" id="5078260">&#39;=&#39;</span>&nbsp;<span class="op" id="5078264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078268">s</span><span class="op" id="5078269">.</span><span class="ident" id="5078270">next</span><span class="op" id="5078274">(</span><span class="op" id="5078275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078279">return</span>&nbsp;<span class="ident" id="5078286">tok1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078295">if</span>&nbsp;<span class="ident" id="5078298">s</span><span class="op" id="5078299">.</span><span class="ident" id="5078300">ch</span>&nbsp;<span class="op" id="5078303">==</span>&nbsp;<span class="ident" id="5078306">ch2</span>&nbsp;<span class="op" id="5078310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078314">s</span><span class="op" id="5078315">.</span><span class="ident" id="5078316">next</span><span class="op" id="5078320">(</span><span class="op" id="5078321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078325">if</span>&nbsp;<span class="ident" id="5078328">s</span><span class="op" id="5078329">.</span><span class="ident" id="5078330">ch</span>&nbsp;<span class="op" id="5078333">==</span>&nbsp;<span class="string" id="5078336">&#39;=&#39;</span>&nbsp;<span class="op" id="5078340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5078345">s</span><span class="op" id="5078346">.</span><span class="ident" id="5078347">next</span><span class="op" id="5078351">(</span><span class="op" id="5078352">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078357">return</span>&nbsp;<span class="ident" id="5078364">tok3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078375">return</span>&nbsp;<span class="ident" id="5078382">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5078388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5078391">return</span>&nbsp;<span class="ident" id="5078398">tok0</span><br>
<span class="lineno">565</span><span class="op" id="5078403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5078406">//&nbsp;Scan&nbsp;scans&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;returns&nbsp;the&nbsp;token&nbsp;position,&nbsp;the&nbsp;token,</span><br>
<span class="lineno"></span><span class="comment" id="5078478">//&nbsp;and&nbsp;its&nbsp;literal&nbsp;string&nbsp;if&nbsp;applicable.&nbsp;The&nbsp;source&nbsp;end&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5078550">//&nbsp;token.EOF.</span><br>
<span class="lineno">570</span><span class="comment" id="5078564">//</span><br>
<span class="lineno"></span><span class="comment" id="5078567">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;literal&nbsp;(token.IDENT,&nbsp;token.INT,&nbsp;token.FLOAT,</span><br>
<span class="lineno"></span><span class="comment" id="5078643">//&nbsp;token.IMAG,&nbsp;token.CHAR,&nbsp;token.STRING)&nbsp;or&nbsp;token.COMMENT,&nbsp;the&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="5078721">//&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5078753">//</span><br>
<span class="lineno">575</span><span class="comment" id="5078756">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;keyword,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the&nbsp;keyword.</span><br>
<span class="lineno"></span><span class="comment" id="5078830">//</span><br>
<span class="lineno"></span><span class="comment" id="5078833">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.SEMICOLON,&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5078896">//&nbsp;literal&nbsp;string&nbsp;is&nbsp;&#34;;&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;present&nbsp;in&nbsp;the&nbsp;source,</span><br>
<span class="lineno"></span><span class="comment" id="5078965">//&nbsp;and&nbsp;&#34;\n&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;inserted&nbsp;because&nbsp;of&nbsp;a&nbsp;newline&nbsp;or</span><br>
<span class="lineno">580</span><span class="comment" id="5079031">//&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="5079042">//</span><br>
<span class="lineno"></span><span class="comment" id="5079045">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.ILLEGAL,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5079114">//&nbsp;offending&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="5079138">//</span><br>
<span class="lineno">585</span><span class="comment" id="5079141">//&nbsp;In&nbsp;all&nbsp;other&nbsp;cases,&nbsp;Scan&nbsp;returns&nbsp;an&nbsp;empty&nbsp;literal&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="5079202">//</span><br>
<span class="lineno"></span><span class="comment" id="5079205">//&nbsp;For&nbsp;more&nbsp;tolerant&nbsp;parsing,&nbsp;Scan&nbsp;will&nbsp;return&nbsp;a&nbsp;valid&nbsp;token&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5079269">//&nbsp;possible&nbsp;even&nbsp;if&nbsp;a&nbsp;syntax&nbsp;error&nbsp;was&nbsp;encountered.&nbsp;Thus,&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5079332">//&nbsp;if&nbsp;the&nbsp;resulting&nbsp;token&nbsp;sequence&nbsp;contains&nbsp;no&nbsp;illegal&nbsp;tokens,</span><br>
<span class="lineno">590</span><span class="comment" id="5079395">//&nbsp;a&nbsp;client&nbsp;may&nbsp;not&nbsp;assume&nbsp;that&nbsp;no&nbsp;error&nbsp;occurred.&nbsp;Instead&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5079457">//&nbsp;must&nbsp;check&nbsp;the&nbsp;scanner&#39;s&nbsp;ErrorCount&nbsp;or&nbsp;the&nbsp;number&nbsp;of&nbsp;calls</span><br>
<span class="lineno"></span><span class="comment" id="5079519">//&nbsp;of&nbsp;the&nbsp;error&nbsp;handler,&nbsp;if&nbsp;there&nbsp;was&nbsp;one&nbsp;installed.</span><br>
<span class="lineno"></span><span class="comment" id="5079572">//</span><br>
<span class="lineno"></span><span class="comment" id="5079575">//&nbsp;Scan&nbsp;adds&nbsp;line&nbsp;information&nbsp;to&nbsp;the&nbsp;file&nbsp;added&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno">595</span><span class="comment" id="5079635">//&nbsp;set&nbsp;with&nbsp;Init.&nbsp;Token&nbsp;positions&nbsp;are&nbsp;relative&nbsp;to&nbsp;that&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="5079695">//&nbsp;and&nbsp;thus&nbsp;relative&nbsp;to&nbsp;the&nbsp;file&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5079733">//</span><br>
<span class="lineno"></span><span class="keyword" id="5079736">func</span>&nbsp;<span class="op" id="5079741">(</span><span class="ident" id="5079742">s</span>&nbsp;<span class="op" id="5079744">*</span><span class="ident" id="5079745">Scanner</span><span class="op" id="5079752">)</span>&nbsp;<span class="ident" id="5079754">Scan</span><span class="op" id="5079758">(</span><span class="op" id="5079759">)</span>&nbsp;<span class="op" id="5079761">(</span><span class="ident" id="5079762">pos</span>&nbsp;<span class="ident" id="5079766">token</span><span class="op" id="5079771">.</span><span class="ident" id="5079772">Pos</span><span class="op" id="5079775">,</span>&nbsp;<span class="ident" id="5079777">tok</span>&nbsp;<span class="ident" id="5079781">token</span><span class="op" id="5079786">.</span><span class="ident" id="5079787">Token</span><span class="op" id="5079792">,</span>&nbsp;<span class="ident" id="5079794">lit</span>&nbsp;<span class="builtintype" id="5079798">string</span><span class="op" id="5079804">)</span>&nbsp;<span class="op" id="5079806">{</span><br>
<span class="lineno"></span><span class="ident" id="5079808">scanAgain</span><span class="op" id="5079817">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079820">s</span><span class="op" id="5079821">.</span><span class="ident" id="5079822">skipWhitespace</span><span class="op" id="5079836">(</span><span class="op" id="5079837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5079841">//&nbsp;current&nbsp;token&nbsp;start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079865">pos</span>&nbsp;<span class="op" id="5079869">=</span>&nbsp;<span class="ident" id="5079871">s</span><span class="op" id="5079872">.</span><span class="ident" id="5079873">file</span><span class="op" id="5079877">.</span><span class="ident" id="5079878">Pos</span><span class="op" id="5079881">(</span><span class="ident" id="5079882">s</span><span class="op" id="5079883">.</span><span class="ident" id="5079884">offset</span><span class="op" id="5079890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5079894">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079920">insertSemi</span>&nbsp;<span class="op" id="5079931">:=</span>&nbsp;<span class="builtintype" id="5079934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079941">switch</span>&nbsp;<span class="ident" id="5079948">ch</span>&nbsp;<span class="op" id="5079951">:=</span>&nbsp;<span class="ident" id="5079954">s</span><span class="op" id="5079955">.</span><span class="ident" id="5079956">ch</span><span class="op" id="5079958">;</span>&nbsp;<span class="op" id="5079960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5079963">case</span>&nbsp;<span class="ident" id="5079968">isLetter</span><span class="op" id="5079976">(</span><span class="ident" id="5079977">ch</span><span class="op" id="5079979">)</span><span class="op" id="5079980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5079984">lit</span>&nbsp;<span class="op" id="5079988">=</span>&nbsp;<span class="ident" id="5079990">s</span><span class="op" id="5079991">.</span><span class="ident" id="5079992">scanIdentifier</span><span class="op" id="5080006">(</span><span class="op" id="5080007">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080011">if</span>&nbsp;<span class="builtinfunc" id="5080014">len</span><span class="op" id="5080017">(</span><span class="ident" id="5080018">lit</span><span class="op" id="5080021">)</span>&nbsp;<span class="op" id="5080023">&gt;</span>&nbsp;<span class="num" id="5080025">1</span>&nbsp;<span class="op" id="5080027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080032">//&nbsp;keywords&nbsp;are&nbsp;longer&nbsp;than&nbsp;one&nbsp;letter&nbsp;-&nbsp;avoid&nbsp;lookup&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080099">tok</span>&nbsp;<span class="op" id="5080103">=</span>&nbsp;<span class="ident" id="5080105">token</span><span class="op" id="5080110">.</span><span class="ident" id="5080111">Lookup</span><span class="op" id="5080117">(</span><span class="ident" id="5080118">lit</span><span class="op" id="5080121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080126">switch</span>&nbsp;<span class="ident" id="5080133">tok</span>&nbsp;<span class="op" id="5080137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080142">case</span>&nbsp;<span class="ident" id="5080147">token</span><span class="op" id="5080152">.</span><span class="ident" id="5080153">IDENT</span><span class="op" id="5080158">,</span>&nbsp;<span class="ident" id="5080160">token</span><span class="op" id="5080165">.</span><span class="ident" id="5080166">BREAK</span><span class="op" id="5080171">,</span>&nbsp;<span class="ident" id="5080173">token</span><span class="op" id="5080178">.</span><span class="ident" id="5080179">CONTINUE</span><span class="op" id="5080187">,</span>&nbsp;<span class="ident" id="5080189">token</span><span class="op" id="5080194">.</span><span class="ident" id="5080195">FALLTHROUGH</span><span class="op" id="5080206">,</span>&nbsp;<span class="ident" id="5080208">token</span><span class="op" id="5080213">.</span><span class="ident" id="5080214">RETURN</span><span class="op" id="5080220">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080226">insertSemi</span>&nbsp;<span class="op" id="5080237">=</span>&nbsp;<span class="builtintype" id="5080239">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080251">}</span>&nbsp;<span class="keyword" id="5080253">else</span>&nbsp;<span class="op" id="5080258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080263">insertSemi</span>&nbsp;<span class="op" id="5080274">=</span>&nbsp;<span class="builtintype" id="5080276">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080284">tok</span>&nbsp;<span class="op" id="5080288">=</span>&nbsp;<span class="ident" id="5080290">token</span><span class="op" id="5080295">.</span><span class="ident" id="5080296">IDENT</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080307">case</span>&nbsp;<span class="string" id="5080312">&#39;0&#39;</span>&nbsp;<span class="op" id="5080316">&lt;=</span>&nbsp;<span class="ident" id="5080319">ch</span>&nbsp;<span class="op" id="5080322">&amp;&amp;</span>&nbsp;<span class="ident" id="5080325">ch</span>&nbsp;<span class="op" id="5080328">&lt;=</span>&nbsp;<span class="string" id="5080331">&#39;9&#39;</span><span class="op" id="5080334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080338">insertSemi</span>&nbsp;<span class="op" id="5080349">=</span>&nbsp;<span class="builtintype" id="5080351">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080358">tok</span><span class="op" id="5080361">,</span>&nbsp;<span class="ident" id="5080363">lit</span>&nbsp;<span class="op" id="5080367">=</span>&nbsp;<span class="ident" id="5080369">s</span><span class="op" id="5080370">.</span><span class="ident" id="5080371">scanNumber</span><span class="op" id="5080381">(</span><span class="builtintype" id="5080382">false</span><span class="op" id="5080387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080390">default</span><span class="op" id="5080397">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080401">s</span><span class="op" id="5080402">.</span><span class="ident" id="5080403">next</span><span class="op" id="5080407">(</span><span class="op" id="5080408">)</span>&nbsp;<span class="comment" id="5080410">//&nbsp;always&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080436">switch</span>&nbsp;<span class="ident" id="5080443">ch</span>&nbsp;<span class="op" id="5080446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080450">case</span>&nbsp;<span class="op" id="5080455">-</span><span class="num" id="5080456">1</span><span class="op" id="5080457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080462">if</span>&nbsp;<span class="ident" id="5080465">s</span><span class="op" id="5080466">.</span><span class="ident" id="5080467">insertSemi</span>&nbsp;<span class="op" id="5080478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080484">s</span><span class="op" id="5080485">.</span><span class="ident" id="5080486">insertSemi</span>&nbsp;<span class="op" id="5080497">=</span>&nbsp;<span class="builtintype" id="5080499">false</span>&nbsp;<span class="comment" id="5080505">//&nbsp;EOF&nbsp;consumed</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080525">return</span>&nbsp;<span class="ident" id="5080532">pos</span><span class="op" id="5080535">,</span>&nbsp;<span class="ident" id="5080537">token</span><span class="op" id="5080542">.</span><span class="ident" id="5080543">SEMICOLON</span><span class="op" id="5080552">,</span>&nbsp;<span class="string" id="5080554">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5080562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080567">tok</span>&nbsp;<span class="op" id="5080571">=</span>&nbsp;<span class="ident" id="5080573">token</span><span class="op" id="5080578">.</span><span class="ident" id="5080579">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080585">case</span>&nbsp;<span class="string" id="5080590">&#39;\n&#39;</span><span class="op" id="5080594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080599">//&nbsp;we&nbsp;only&nbsp;reach&nbsp;here&nbsp;if&nbsp;s.insertSemi&nbsp;was</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080644">//&nbsp;set&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;and&nbsp;exited&nbsp;early</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5080690">//&nbsp;from&nbsp;s.skipWhitespace()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080720">s</span><span class="op" id="5080721">.</span><span class="ident" id="5080722">insertSemi</span>&nbsp;<span class="op" id="5080733">=</span>&nbsp;<span class="builtintype" id="5080735">false</span>&nbsp;<span class="comment" id="5080741">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080764">return</span>&nbsp;<span class="ident" id="5080771">pos</span><span class="op" id="5080774">,</span>&nbsp;<span class="ident" id="5080776">token</span><span class="op" id="5080781">.</span><span class="ident" id="5080782">SEMICOLON</span><span class="op" id="5080791">,</span>&nbsp;<span class="string" id="5080793">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080800">case</span>&nbsp;<span class="string" id="5080805">&#39;&#34;&#39;</span><span class="op" id="5080808">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080813">insertSemi</span>&nbsp;<span class="op" id="5080824">=</span>&nbsp;<span class="builtintype" id="5080826">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080834">tok</span>&nbsp;<span class="op" id="5080838">=</span>&nbsp;<span class="ident" id="5080840">token</span><span class="op" id="5080845">.</span><span class="ident" id="5080846">STRING</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080856">lit</span>&nbsp;<span class="op" id="5080860">=</span>&nbsp;<span class="ident" id="5080862">s</span><span class="op" id="5080863">.</span><span class="ident" id="5080864">scanString</span><span class="op" id="5080874">(</span><span class="op" id="5080875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080879">case</span>&nbsp;<span class="string" id="5080884">&#39;\&#39;&#39;</span><span class="op" id="5080888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080893">insertSemi</span>&nbsp;<span class="op" id="5080904">=</span>&nbsp;<span class="builtintype" id="5080906">true</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080914">tok</span>&nbsp;<span class="op" id="5080918">=</span>&nbsp;<span class="ident" id="5080920">token</span><span class="op" id="5080925">.</span><span class="ident" id="5080926">CHAR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080934">lit</span>&nbsp;<span class="op" id="5080938">=</span>&nbsp;<span class="ident" id="5080940">s</span><span class="op" id="5080941">.</span><span class="ident" id="5080942">scanRune</span><span class="op" id="5080950">(</span><span class="op" id="5080951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5080955">case</span>&nbsp;<span class="string" id="5080960">&#39;`&#39;</span><span class="op" id="5080963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080968">insertSemi</span>&nbsp;<span class="op" id="5080979">=</span>&nbsp;<span class="builtintype" id="5080981">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5080989">tok</span>&nbsp;<span class="op" id="5080993">=</span>&nbsp;<span class="ident" id="5080995">token</span><span class="op" id="5081000">.</span><span class="ident" id="5081001">STRING</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081011">lit</span>&nbsp;<span class="op" id="5081015">=</span>&nbsp;<span class="ident" id="5081017">s</span><span class="op" id="5081018">.</span><span class="ident" id="5081019">scanRawString</span><span class="op" id="5081032">(</span><span class="op" id="5081033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081037">case</span>&nbsp;<span class="string" id="5081042">&#39;:&#39;</span><span class="op" id="5081045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081050">tok</span>&nbsp;<span class="op" id="5081054">=</span>&nbsp;<span class="ident" id="5081056">s</span><span class="op" id="5081057">.</span><span class="ident" id="5081058">switch2</span><span class="op" id="5081065">(</span><span class="ident" id="5081066">token</span><span class="op" id="5081071">.</span><span class="ident" id="5081072">COLON</span><span class="op" id="5081077">,</span>&nbsp;<span class="ident" id="5081079">token</span><span class="op" id="5081084">.</span><span class="ident" id="5081085">DEFINE</span><span class="op" id="5081091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081095">case</span>&nbsp;<span class="string" id="5081100">&#39;.&#39;</span><span class="op" id="5081103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081108">if</span>&nbsp;<span class="string" id="5081111">&#39;0&#39;</span>&nbsp;<span class="op" id="5081115">&lt;=</span>&nbsp;<span class="ident" id="5081118">s</span><span class="op" id="5081119">.</span><span class="ident" id="5081120">ch</span>&nbsp;<span class="op" id="5081123">&amp;&amp;</span>&nbsp;<span class="ident" id="5081126">s</span><span class="op" id="5081127">.</span><span class="ident" id="5081128">ch</span>&nbsp;<span class="op" id="5081131">&lt;=</span>&nbsp;<span class="string" id="5081134">&#39;9&#39;</span>&nbsp;<span class="op" id="5081138">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081144">insertSemi</span>&nbsp;<span class="op" id="5081155">=</span>&nbsp;<span class="builtintype" id="5081157">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081166">tok</span><span class="op" id="5081169">,</span>&nbsp;<span class="ident" id="5081171">lit</span>&nbsp;<span class="op" id="5081175">=</span>&nbsp;<span class="ident" id="5081177">s</span><span class="op" id="5081178">.</span><span class="ident" id="5081179">scanNumber</span><span class="op" id="5081189">(</span><span class="builtintype" id="5081190">true</span><span class="op" id="5081194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081199">}</span>&nbsp;<span class="keyword" id="5081201">else</span>&nbsp;<span class="keyword" id="5081206">if</span>&nbsp;<span class="ident" id="5081209">s</span><span class="op" id="5081210">.</span><span class="ident" id="5081211">ch</span>&nbsp;<span class="op" id="5081214">==</span>&nbsp;<span class="string" id="5081217">&#39;.&#39;</span>&nbsp;<span class="op" id="5081221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081227">s</span><span class="op" id="5081228">.</span><span class="ident" id="5081229">next</span><span class="op" id="5081233">(</span><span class="op" id="5081234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081240">if</span>&nbsp;<span class="ident" id="5081243">s</span><span class="op" id="5081244">.</span><span class="ident" id="5081245">ch</span>&nbsp;<span class="op" id="5081248">==</span>&nbsp;<span class="string" id="5081251">&#39;.&#39;</span>&nbsp;<span class="op" id="5081255">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081262">s</span><span class="op" id="5081263">.</span><span class="ident" id="5081264">next</span><span class="op" id="5081268">(</span><span class="op" id="5081269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081276">tok</span>&nbsp;<span class="op" id="5081280">=</span>&nbsp;<span class="ident" id="5081282">token</span><span class="op" id="5081287">.</span><span class="ident" id="5081288">ELLIPSIS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081306">}</span>&nbsp;<span class="keyword" id="5081308">else</span>&nbsp;<span class="op" id="5081313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081319">tok</span>&nbsp;<span class="op" id="5081323">=</span>&nbsp;<span class="ident" id="5081325">token</span><span class="op" id="5081330">.</span><span class="ident" id="5081331">PERIOD</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081345">case</span>&nbsp;<span class="string" id="5081350">&#39;,&#39;</span><span class="op" id="5081353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081358">tok</span>&nbsp;<span class="op" id="5081362">=</span>&nbsp;<span class="ident" id="5081364">token</span><span class="op" id="5081369">.</span><span class="ident" id="5081370">COMMA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081378">case</span>&nbsp;<span class="string" id="5081383">&#39;;&#39;</span><span class="op" id="5081386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081391">tok</span>&nbsp;<span class="op" id="5081395">=</span>&nbsp;<span class="ident" id="5081397">token</span><span class="op" id="5081402">.</span><span class="ident" id="5081403">SEMICOLON</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081416">lit</span>&nbsp;<span class="op" id="5081420">=</span>&nbsp;<span class="string" id="5081422">&#34;;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081428">case</span>&nbsp;<span class="string" id="5081433">&#39;(&#39;</span><span class="op" id="5081436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081441">tok</span>&nbsp;<span class="op" id="5081445">=</span>&nbsp;<span class="ident" id="5081447">token</span><span class="op" id="5081452">.</span><span class="ident" id="5081453">LPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081462">case</span>&nbsp;<span class="string" id="5081467">&#39;)&#39;</span><span class="op" id="5081470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081475">insertSemi</span>&nbsp;<span class="op" id="5081486">=</span>&nbsp;<span class="builtintype" id="5081488">true</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081496">tok</span>&nbsp;<span class="op" id="5081500">=</span>&nbsp;<span class="ident" id="5081502">token</span><span class="op" id="5081507">.</span><span class="ident" id="5081508">RPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081517">case</span>&nbsp;<span class="string" id="5081522">&#39;[&#39;</span><span class="op" id="5081525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081530">tok</span>&nbsp;<span class="op" id="5081534">=</span>&nbsp;<span class="ident" id="5081536">token</span><span class="op" id="5081541">.</span><span class="ident" id="5081542">LBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081551">case</span>&nbsp;<span class="string" id="5081556">&#39;]&#39;</span><span class="op" id="5081559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081564">insertSemi</span>&nbsp;<span class="op" id="5081575">=</span>&nbsp;<span class="builtintype" id="5081577">true</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081585">tok</span>&nbsp;<span class="op" id="5081589">=</span>&nbsp;<span class="ident" id="5081591">token</span><span class="op" id="5081596">.</span><span class="ident" id="5081597">RBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081606">case</span>&nbsp;<span class="string" id="5081611">&#39;{&#39;</span><span class="op" id="5081614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081619">tok</span>&nbsp;<span class="op" id="5081623">=</span>&nbsp;<span class="ident" id="5081625">token</span><span class="op" id="5081630">.</span><span class="ident" id="5081631">LBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081640">case</span>&nbsp;<span class="string" id="5081645">&#39;}&#39;</span><span class="op" id="5081648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081653">insertSemi</span>&nbsp;<span class="op" id="5081664">=</span>&nbsp;<span class="builtintype" id="5081666">true</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081674">tok</span>&nbsp;<span class="op" id="5081678">=</span>&nbsp;<span class="ident" id="5081680">token</span><span class="op" id="5081685">.</span><span class="ident" id="5081686">RBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081695">case</span>&nbsp;<span class="string" id="5081700">&#39;+&#39;</span><span class="op" id="5081703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081708">tok</span>&nbsp;<span class="op" id="5081712">=</span>&nbsp;<span class="ident" id="5081714">s</span><span class="op" id="5081715">.</span><span class="ident" id="5081716">switch3</span><span class="op" id="5081723">(</span><span class="ident" id="5081724">token</span><span class="op" id="5081729">.</span><span class="ident" id="5081730">ADD</span><span class="op" id="5081733">,</span>&nbsp;<span class="ident" id="5081735">token</span><span class="op" id="5081740">.</span><span class="ident" id="5081741">ADD_ASSIGN</span><span class="op" id="5081751">,</span>&nbsp;<span class="string" id="5081753">&#39;+&#39;</span><span class="op" id="5081756">,</span>&nbsp;<span class="ident" id="5081758">token</span><span class="op" id="5081763">.</span><span class="ident" id="5081764">INC</span><span class="op" id="5081767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081772">if</span>&nbsp;<span class="ident" id="5081775">tok</span>&nbsp;<span class="op" id="5081779">==</span>&nbsp;<span class="ident" id="5081782">token</span><span class="op" id="5081787">.</span><span class="ident" id="5081788">INC</span>&nbsp;<span class="op" id="5081792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081798">insertSemi</span>&nbsp;<span class="op" id="5081809">=</span>&nbsp;<span class="builtintype" id="5081811">true</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081823">case</span>&nbsp;<span class="string" id="5081828">&#39;-&#39;</span><span class="op" id="5081831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081836">tok</span>&nbsp;<span class="op" id="5081840">=</span>&nbsp;<span class="ident" id="5081842">s</span><span class="op" id="5081843">.</span><span class="ident" id="5081844">switch3</span><span class="op" id="5081851">(</span><span class="ident" id="5081852">token</span><span class="op" id="5081857">.</span><span class="ident" id="5081858">SUB</span><span class="op" id="5081861">,</span>&nbsp;<span class="ident" id="5081863">token</span><span class="op" id="5081868">.</span><span class="ident" id="5081869">SUB_ASSIGN</span><span class="op" id="5081879">,</span>&nbsp;<span class="string" id="5081881">&#39;-&#39;</span><span class="op" id="5081884">,</span>&nbsp;<span class="ident" id="5081886">token</span><span class="op" id="5081891">.</span><span class="ident" id="5081892">DEC</span><span class="op" id="5081895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081900">if</span>&nbsp;<span class="ident" id="5081903">tok</span>&nbsp;<span class="op" id="5081907">==</span>&nbsp;<span class="ident" id="5081910">token</span><span class="op" id="5081915">.</span><span class="ident" id="5081916">DEC</span>&nbsp;<span class="op" id="5081920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081926">insertSemi</span>&nbsp;<span class="op" id="5081937">=</span>&nbsp;<span class="builtintype" id="5081939">true</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5081947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5081951">case</span>&nbsp;<span class="string" id="5081956">&#39;*&#39;</span><span class="op" id="5081959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5081964">tok</span>&nbsp;<span class="op" id="5081968">=</span>&nbsp;<span class="ident" id="5081970">s</span><span class="op" id="5081971">.</span><span class="ident" id="5081972">switch2</span><span class="op" id="5081979">(</span><span class="ident" id="5081980">token</span><span class="op" id="5081985">.</span><span class="ident" id="5081986">MUL</span><span class="op" id="5081989">,</span>&nbsp;<span class="ident" id="5081991">token</span><span class="op" id="5081996">.</span><span class="ident" id="5081997">MUL_ASSIGN</span><span class="op" id="5082007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082011">case</span>&nbsp;<span class="string" id="5082016">&#39;/&#39;</span><span class="op" id="5082019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082024">if</span>&nbsp;<span class="ident" id="5082027">s</span><span class="op" id="5082028">.</span><span class="ident" id="5082029">ch</span>&nbsp;<span class="op" id="5082032">==</span>&nbsp;<span class="string" id="5082035">&#39;/&#39;</span>&nbsp;<span class="op" id="5082039">||</span>&nbsp;<span class="ident" id="5082042">s</span><span class="op" id="5082043">.</span><span class="ident" id="5082044">ch</span>&nbsp;<span class="op" id="5082047">==</span>&nbsp;<span class="string" id="5082050">&#39;*&#39;</span>&nbsp;<span class="op" id="5082054">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5082060">//&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082075">if</span>&nbsp;<span class="ident" id="5082078">s</span><span class="op" id="5082079">.</span><span class="ident" id="5082080">insertSemi</span>&nbsp;<span class="op" id="5082091">&amp;&amp;</span>&nbsp;<span class="ident" id="5082094">s</span><span class="op" id="5082095">.</span><span class="ident" id="5082096">findLineEnd</span><span class="op" id="5082107">(</span><span class="op" id="5082108">)</span>&nbsp;<span class="op" id="5082110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5082117">//&nbsp;reset&nbsp;position&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082172">s</span><span class="op" id="5082173">.</span><span class="ident" id="5082174">ch</span>&nbsp;<span class="op" id="5082177">=</span>&nbsp;<span class="string" id="5082179">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082188">s</span><span class="op" id="5082189">.</span><span class="ident" id="5082190">offset</span>&nbsp;<span class="op" id="5082197">=</span>&nbsp;<span class="ident" id="5082199">s</span><span class="op" id="5082200">.</span><span class="ident" id="5082201">file</span><span class="op" id="5082205">.</span><span class="ident" id="5082206">Offset</span><span class="op" id="5082212">(</span><span class="ident" id="5082213">pos</span><span class="op" id="5082216">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082223">s</span><span class="op" id="5082224">.</span><span class="ident" id="5082225">rdOffset</span>&nbsp;<span class="op" id="5082234">=</span>&nbsp;<span class="ident" id="5082236">s</span><span class="op" id="5082237">.</span><span class="ident" id="5082238">offset</span>&nbsp;<span class="op" id="5082245">+</span>&nbsp;<span class="num" id="5082247">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082254">s</span><span class="op" id="5082255">.</span><span class="ident" id="5082256">insertSemi</span>&nbsp;<span class="op" id="5082267">=</span>&nbsp;<span class="builtintype" id="5082269">false</span>&nbsp;<span class="comment" id="5082275">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082300">return</span>&nbsp;<span class="ident" id="5082307">pos</span><span class="op" id="5082310">,</span>&nbsp;<span class="ident" id="5082312">token</span><span class="op" id="5082317">.</span><span class="ident" id="5082318">SEMICOLON</span><span class="op" id="5082327">,</span>&nbsp;<span class="string" id="5082329">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082344">lit</span>&nbsp;<span class="op" id="5082348">=</span>&nbsp;<span class="ident" id="5082350">s</span><span class="op" id="5082351">.</span><span class="ident" id="5082352">scanComment</span><span class="op" id="5082363">(</span><span class="op" id="5082364">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082370">if</span>&nbsp;<span class="ident" id="5082373">s</span><span class="op" id="5082374">.</span><span class="ident" id="5082375">mode</span><span class="op" id="5082379">&amp;</span><span class="ident" id="5082380">ScanComments</span>&nbsp;<span class="op" id="5082393">==</span>&nbsp;<span class="num" id="5082396">0</span>&nbsp;<span class="op" id="5082398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5082405">//&nbsp;skip&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082426">s</span><span class="op" id="5082427">.</span><span class="ident" id="5082428">insertSemi</span>&nbsp;<span class="op" id="5082439">=</span>&nbsp;<span class="builtintype" id="5082441">false</span>&nbsp;<span class="comment" id="5082447">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082472">goto</span>&nbsp;<span class="ident" id="5082477">scanAgain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082491">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082497">tok</span>&nbsp;<span class="op" id="5082501">=</span>&nbsp;<span class="ident" id="5082503">token</span><span class="op" id="5082508">.</span><span class="ident" id="5082509">COMMENT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082520">}</span>&nbsp;<span class="keyword" id="5082522">else</span>&nbsp;<span class="op" id="5082527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082533">tok</span>&nbsp;<span class="op" id="5082537">=</span>&nbsp;<span class="ident" id="5082539">s</span><span class="op" id="5082540">.</span><span class="ident" id="5082541">switch2</span><span class="op" id="5082548">(</span><span class="ident" id="5082549">token</span><span class="op" id="5082554">.</span><span class="ident" id="5082555">QUO</span><span class="op" id="5082558">,</span>&nbsp;<span class="ident" id="5082560">token</span><span class="op" id="5082565">.</span><span class="ident" id="5082566">QUO_ASSIGN</span><span class="op" id="5082576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082585">case</span>&nbsp;<span class="string" id="5082590">&#39;%&#39;</span><span class="op" id="5082593">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082598">tok</span>&nbsp;<span class="op" id="5082602">=</span>&nbsp;<span class="ident" id="5082604">s</span><span class="op" id="5082605">.</span><span class="ident" id="5082606">switch2</span><span class="op" id="5082613">(</span><span class="ident" id="5082614">token</span><span class="op" id="5082619">.</span><span class="ident" id="5082620">REM</span><span class="op" id="5082623">,</span>&nbsp;<span class="ident" id="5082625">token</span><span class="op" id="5082630">.</span><span class="ident" id="5082631">REM_ASSIGN</span><span class="op" id="5082641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082645">case</span>&nbsp;<span class="string" id="5082650">&#39;^&#39;</span><span class="op" id="5082653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082658">tok</span>&nbsp;<span class="op" id="5082662">=</span>&nbsp;<span class="ident" id="5082664">s</span><span class="op" id="5082665">.</span><span class="ident" id="5082666">switch2</span><span class="op" id="5082673">(</span><span class="ident" id="5082674">token</span><span class="op" id="5082679">.</span><span class="ident" id="5082680">XOR</span><span class="op" id="5082683">,</span>&nbsp;<span class="ident" id="5082685">token</span><span class="op" id="5082690">.</span><span class="ident" id="5082691">XOR_ASSIGN</span><span class="op" id="5082701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082705">case</span>&nbsp;<span class="string" id="5082710">&#39;&lt;&#39;</span><span class="op" id="5082713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082718">if</span>&nbsp;<span class="ident" id="5082721">s</span><span class="op" id="5082722">.</span><span class="ident" id="5082723">ch</span>&nbsp;<span class="op" id="5082726">==</span>&nbsp;<span class="string" id="5082729">&#39;-&#39;</span>&nbsp;<span class="op" id="5082733">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082739">s</span><span class="op" id="5082740">.</span><span class="ident" id="5082741">next</span><span class="op" id="5082745">(</span><span class="op" id="5082746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082752">tok</span>&nbsp;<span class="op" id="5082756">=</span>&nbsp;<span class="ident" id="5082758">token</span><span class="op" id="5082763">.</span><span class="ident" id="5082764">ARROW</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082773">}</span>&nbsp;<span class="keyword" id="5082775">else</span>&nbsp;<span class="op" id="5082780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082786">tok</span>&nbsp;<span class="op" id="5082790">=</span>&nbsp;<span class="ident" id="5082792">s</span><span class="op" id="5082793">.</span><span class="ident" id="5082794">switch4</span><span class="op" id="5082801">(</span><span class="ident" id="5082802">token</span><span class="op" id="5082807">.</span><span class="ident" id="5082808">LSS</span><span class="op" id="5082811">,</span>&nbsp;<span class="ident" id="5082813">token</span><span class="op" id="5082818">.</span><span class="ident" id="5082819">LEQ</span><span class="op" id="5082822">,</span>&nbsp;<span class="string" id="5082824">&#39;&lt;&#39;</span><span class="op" id="5082827">,</span>&nbsp;<span class="ident" id="5082829">token</span><span class="op" id="5082834">.</span><span class="ident" id="5082835">SHL</span><span class="op" id="5082838">,</span>&nbsp;<span class="ident" id="5082840">token</span><span class="op" id="5082845">.</span><span class="ident" id="5082846">SHL_ASSIGN</span><span class="op" id="5082856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5082861">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082865">case</span>&nbsp;<span class="string" id="5082870">&#39;&gt;&#39;</span><span class="op" id="5082873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082878">tok</span>&nbsp;<span class="op" id="5082882">=</span>&nbsp;<span class="ident" id="5082884">s</span><span class="op" id="5082885">.</span><span class="ident" id="5082886">switch4</span><span class="op" id="5082893">(</span><span class="ident" id="5082894">token</span><span class="op" id="5082899">.</span><span class="ident" id="5082900">GTR</span><span class="op" id="5082903">,</span>&nbsp;<span class="ident" id="5082905">token</span><span class="op" id="5082910">.</span><span class="ident" id="5082911">GEQ</span><span class="op" id="5082914">,</span>&nbsp;<span class="string" id="5082916">&#39;&gt;&#39;</span><span class="op" id="5082919">,</span>&nbsp;<span class="ident" id="5082921">token</span><span class="op" id="5082926">.</span><span class="ident" id="5082927">SHR</span><span class="op" id="5082930">,</span>&nbsp;<span class="ident" id="5082932">token</span><span class="op" id="5082937">.</span><span class="ident" id="5082938">SHR_ASSIGN</span><span class="op" id="5082948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5082952">case</span>&nbsp;<span class="string" id="5082957">&#39;=&#39;</span><span class="op" id="5082960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5082965">tok</span>&nbsp;<span class="op" id="5082969">=</span>&nbsp;<span class="ident" id="5082971">s</span><span class="op" id="5082972">.</span><span class="ident" id="5082973">switch2</span><span class="op" id="5082980">(</span><span class="ident" id="5082981">token</span><span class="op" id="5082986">.</span><span class="ident" id="5082987">ASSIGN</span><span class="op" id="5082993">,</span>&nbsp;<span class="ident" id="5082995">token</span><span class="op" id="5083000">.</span><span class="ident" id="5083001">EQL</span><span class="op" id="5083004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083008">case</span>&nbsp;<span class="string" id="5083013">&#39;!&#39;</span><span class="op" id="5083016">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083021">tok</span>&nbsp;<span class="op" id="5083025">=</span>&nbsp;<span class="ident" id="5083027">s</span><span class="op" id="5083028">.</span><span class="ident" id="5083029">switch2</span><span class="op" id="5083036">(</span><span class="ident" id="5083037">token</span><span class="op" id="5083042">.</span><span class="ident" id="5083043">NOT</span><span class="op" id="5083046">,</span>&nbsp;<span class="ident" id="5083048">token</span><span class="op" id="5083053">.</span><span class="ident" id="5083054">NEQ</span><span class="op" id="5083057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083061">case</span>&nbsp;<span class="string" id="5083066">&#39;&amp;&#39;</span><span class="op" id="5083069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083074">if</span>&nbsp;<span class="ident" id="5083077">s</span><span class="op" id="5083078">.</span><span class="ident" id="5083079">ch</span>&nbsp;<span class="op" id="5083082">==</span>&nbsp;<span class="string" id="5083085">&#39;^&#39;</span>&nbsp;<span class="op" id="5083089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083095">s</span><span class="op" id="5083096">.</span><span class="ident" id="5083097">next</span><span class="op" id="5083101">(</span><span class="op" id="5083102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083108">tok</span>&nbsp;<span class="op" id="5083112">=</span>&nbsp;<span class="ident" id="5083114">s</span><span class="op" id="5083115">.</span><span class="ident" id="5083116">switch2</span><span class="op" id="5083123">(</span><span class="ident" id="5083124">token</span><span class="op" id="5083129">.</span><span class="ident" id="5083130">AND_NOT</span><span class="op" id="5083137">,</span>&nbsp;<span class="ident" id="5083139">token</span><span class="op" id="5083144">.</span><span class="ident" id="5083145">AND_NOT_ASSIGN</span><span class="op" id="5083159">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083164">}</span>&nbsp;<span class="keyword" id="5083166">else</span>&nbsp;<span class="op" id="5083171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083177">tok</span>&nbsp;<span class="op" id="5083181">=</span>&nbsp;<span class="ident" id="5083183">s</span><span class="op" id="5083184">.</span><span class="ident" id="5083185">switch3</span><span class="op" id="5083192">(</span><span class="ident" id="5083193">token</span><span class="op" id="5083198">.</span><span class="ident" id="5083199">AND</span><span class="op" id="5083202">,</span>&nbsp;<span class="ident" id="5083204">token</span><span class="op" id="5083209">.</span><span class="ident" id="5083210">AND_ASSIGN</span><span class="op" id="5083220">,</span>&nbsp;<span class="string" id="5083222">&#39;&amp;&#39;</span><span class="op" id="5083225">,</span>&nbsp;<span class="ident" id="5083227">token</span><span class="op" id="5083232">.</span><span class="ident" id="5083233">LAND</span><span class="op" id="5083237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083246">case</span>&nbsp;<span class="string" id="5083251">&#39;|&#39;</span><span class="op" id="5083254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083259">tok</span>&nbsp;<span class="op" id="5083263">=</span>&nbsp;<span class="ident" id="5083265">s</span><span class="op" id="5083266">.</span><span class="ident" id="5083267">switch3</span><span class="op" id="5083274">(</span><span class="ident" id="5083275">token</span><span class="op" id="5083280">.</span><span class="ident" id="5083281">OR</span><span class="op" id="5083283">,</span>&nbsp;<span class="ident" id="5083285">token</span><span class="op" id="5083290">.</span><span class="ident" id="5083291">OR_ASSIGN</span><span class="op" id="5083300">,</span>&nbsp;<span class="string" id="5083302">&#39;|&#39;</span><span class="op" id="5083305">,</span>&nbsp;<span class="ident" id="5083307">token</span><span class="op" id="5083312">.</span><span class="ident" id="5083313">LOR</span><span class="op" id="5083316">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083320">default</span><span class="op" id="5083327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5083332">//&nbsp;next&nbsp;reports&nbsp;unexpected&nbsp;BOMs&nbsp;-&nbsp;don&#39;t&nbsp;repeat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083382">if</span>&nbsp;<span class="ident" id="5083385">ch</span>&nbsp;<span class="op" id="5083388">!=</span>&nbsp;<span class="ident" id="5083391">bom</span>&nbsp;<span class="op" id="5083395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083401">s</span><span class="op" id="5083402">.</span><span class="builtintype" id="5083403">error</span><span class="op" id="5083408">(</span><span class="ident" id="5083409">s</span><span class="op" id="5083410">.</span><span class="ident" id="5083411">file</span><span class="op" id="5083415">.</span><span class="ident" id="5083416">Offset</span><span class="op" id="5083422">(</span><span class="ident" id="5083423">pos</span><span class="op" id="5083426">)</span><span class="op" id="5083427">,</span>&nbsp;<span class="ident" id="5083429">fmt</span><span class="op" id="5083432">.</span><span class="ident" id="5083433">Sprintf</span><span class="op" id="5083440">(</span><span class="string" id="5083441">&#34;illegal&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="5083464">,</span>&nbsp;<span class="ident" id="5083466">ch</span><span class="op" id="5083468">)</span><span class="op" id="5083469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083474">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083479">insertSemi</span>&nbsp;<span class="op" id="5083490">=</span>&nbsp;<span class="ident" id="5083492">s</span><span class="op" id="5083493">.</span><span class="ident" id="5083494">insertSemi</span>&nbsp;<span class="comment" id="5083505">//&nbsp;preserve&nbsp;insertSemi&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083536">tok</span>&nbsp;<span class="op" id="5083540">=</span>&nbsp;<span class="ident" id="5083542">token</span><span class="op" id="5083547">.</span><span class="ident" id="5083548">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083559">lit</span>&nbsp;<span class="op" id="5083563">=</span>&nbsp;<span class="builtintype" id="5083565">string</span><span class="op" id="5083571">(</span><span class="ident" id="5083572">ch</span><span class="op" id="5083574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083581">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083584">if</span>&nbsp;<span class="ident" id="5083587">s</span><span class="op" id="5083588">.</span><span class="ident" id="5083589">mode</span><span class="op" id="5083593">&amp;</span><span class="ident" id="5083594">dontInsertSemis</span>&nbsp;<span class="op" id="5083610">==</span>&nbsp;<span class="num" id="5083613">0</span>&nbsp;<span class="op" id="5083615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5083619">s</span><span class="op" id="5083620">.</span><span class="ident" id="5083621">insertSemi</span>&nbsp;<span class="op" id="5083632">=</span>&nbsp;<span class="ident" id="5083634">insertSemi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5083646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5083650">return</span><br>
<span class="lineno">760</span><span class="op" id="5083657">}</span>
</div>
</body>
</html>
