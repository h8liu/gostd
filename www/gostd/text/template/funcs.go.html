<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3225320">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3225375">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3225429">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3225480">package</span>&nbsp;<span class="ident" id="3225488">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225498">import</span>&nbsp;<span class="op" id="3225505">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225508">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225517">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225527">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225534">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225540">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225551">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225562">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225573">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3225584">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3225599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3225602">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to&nbsp;functions.</span><br>
<span class="lineno">20</span><span class="comment" id="3225682">//&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two&nbsp;return&nbsp;values&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3225763">//&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the&nbsp;second&nbsp;(error)</span><br>
<span class="lineno"></span><span class="comment" id="3225835">//&nbsp;return&nbsp;value&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution&nbsp;terminates&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3225915">//&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3225946">type</span>&nbsp;<span class="ident" id="3225951">FuncMap</span>&nbsp;<span class="keyword" id="3225959">map</span><span class="op" id="3225962">[</span><span class="builtintype" id="3225963">string</span><span class="op" id="3225969">]</span><span class="keyword" id="3225970">interface</span><span class="op" id="3225979">{</span><span class="op" id="3225980">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3225983">var</span>&nbsp;<span class="ident" id="3225987">builtins</span>&nbsp;<span class="op" id="3225996">=</span>&nbsp;<span class="ident" id="3225998">FuncMap</span><span class="op" id="3226005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226008">&#34;and&#34;</span><span class="op" id="3226013">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226020">and</span><span class="op" id="3226023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226026">&#34;call&#34;</span><span class="op" id="3226032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226038">call</span><span class="op" id="3226042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226045">&#34;html&#34;</span><span class="op" id="3226051">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226057">HTMLEscaper</span><span class="op" id="3226068">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226071">&#34;index&#34;</span><span class="op" id="3226078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226083">index</span><span class="op" id="3226088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226091">&#34;js&#34;</span><span class="op" id="3226095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226103">JSEscaper</span><span class="op" id="3226112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226115">&#34;len&#34;</span><span class="op" id="3226120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226127">length</span><span class="op" id="3226133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226136">&#34;not&#34;</span><span class="op" id="3226141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226148">not</span><span class="op" id="3226151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226154">&#34;or&#34;</span><span class="op" id="3226158">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226166">or</span><span class="op" id="3226168">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226171">&#34;print&#34;</span><span class="op" id="3226178">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226183">fmt</span><span class="op" id="3226186">.</span><span class="ident" id="3226187">Sprint</span><span class="op" id="3226193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226196">&#34;printf&#34;</span><span class="op" id="3226204">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3226208">fmt</span><span class="op" id="3226211">.</span><span class="ident" id="3226212">Sprintf</span><span class="op" id="3226219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226222">&#34;println&#34;</span><span class="op" id="3226231">:</span>&nbsp;&nbsp;<span class="ident" id="3226234">fmt</span><span class="op" id="3226237">.</span><span class="ident" id="3226238">Sprintln</span><span class="op" id="3226246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226249">&#34;urlquery&#34;</span><span class="op" id="3226259">:</span>&nbsp;<span class="ident" id="3226261">URLQueryEscaper</span><span class="op" id="3226276">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3226280">//&nbsp;Comparisons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226296">&#34;eq&#34;</span><span class="op" id="3226300">:</span>&nbsp;<span class="ident" id="3226302">eq</span><span class="op" id="3226304">,</span>&nbsp;<span class="comment" id="3226306">//&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226313">&#34;ge&#34;</span><span class="op" id="3226317">:</span>&nbsp;<span class="ident" id="3226319">ge</span><span class="op" id="3226321">,</span>&nbsp;<span class="comment" id="3226323">//&nbsp;&gt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226330">&#34;gt&#34;</span><span class="op" id="3226334">:</span>&nbsp;<span class="ident" id="3226336">gt</span><span class="op" id="3226338">,</span>&nbsp;<span class="comment" id="3226340">//&nbsp;&gt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226346">&#34;le&#34;</span><span class="op" id="3226350">:</span>&nbsp;<span class="ident" id="3226352">le</span><span class="op" id="3226354">,</span>&nbsp;<span class="comment" id="3226356">//&nbsp;&lt;=</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226363">&#34;lt&#34;</span><span class="op" id="3226367">:</span>&nbsp;<span class="ident" id="3226369">lt</span><span class="op" id="3226371">,</span>&nbsp;<span class="comment" id="3226373">//&nbsp;&lt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3226379">&#34;ne&#34;</span><span class="op" id="3226383">:</span>&nbsp;<span class="ident" id="3226385">ne</span><span class="op" id="3226387">,</span>&nbsp;<span class="comment" id="3226389">//&nbsp;!=</span><br>
<span class="lineno"></span><span class="op" id="3226395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226398">var</span>&nbsp;<span class="ident" id="3226402">builtinFuncs</span>&nbsp;<span class="op" id="3226415">=</span>&nbsp;<span class="ident" id="3226417">createValueFuncs</span><span class="op" id="3226433">(</span><span class="ident" id="3226434">builtins</span><span class="op" id="3226442">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3226445">//&nbsp;createValueFuncs&nbsp;turns&nbsp;a&nbsp;FuncMap&nbsp;into&nbsp;a&nbsp;map[string]reflect.Value</span><br>
<span class="lineno"></span><span class="keyword" id="3226513">func</span>&nbsp;<span class="ident" id="3226518">createValueFuncs</span><span class="op" id="3226534">(</span><span class="ident" id="3226535">funcMap</span>&nbsp;<span class="ident" id="3226543">FuncMap</span><span class="op" id="3226550">)</span>&nbsp;<span class="keyword" id="3226552">map</span><span class="op" id="3226555">[</span><span class="builtintype" id="3226556">string</span><span class="op" id="3226562">]</span><span class="ident" id="3226563">reflect</span><span class="op" id="3226570">.</span><span class="ident" id="3226571">Value</span>&nbsp;<span class="op" id="3226577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226580">m</span>&nbsp;<span class="op" id="3226582">:=</span>&nbsp;<span class="builtinfunc" id="3226585">make</span><span class="op" id="3226589">(</span><span class="keyword" id="3226590">map</span><span class="op" id="3226593">[</span><span class="builtintype" id="3226594">string</span><span class="op" id="3226600">]</span><span class="ident" id="3226601">reflect</span><span class="op" id="3226608">.</span><span class="ident" id="3226609">Value</span><span class="op" id="3226614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226617">addValueFuncs</span><span class="op" id="3226630">(</span><span class="ident" id="3226631">m</span><span class="op" id="3226632">,</span>&nbsp;<span class="ident" id="3226634">funcMap</span><span class="op" id="3226641">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226644">return</span>&nbsp;<span class="ident" id="3226651">m</span><br>
<span class="lineno"></span><span class="op" id="3226653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3226656">//&nbsp;addValueFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs,&nbsp;converting&nbsp;them&nbsp;to&nbsp;reflect.Values.</span><br>
<span class="lineno"></span><span class="keyword" id="3226747">func</span>&nbsp;<span class="ident" id="3226752">addValueFuncs</span><span class="op" id="3226765">(</span><span class="ident" id="3226766">out</span>&nbsp;<span class="keyword" id="3226770">map</span><span class="op" id="3226773">[</span><span class="builtintype" id="3226774">string</span><span class="op" id="3226780">]</span><span class="ident" id="3226781">reflect</span><span class="op" id="3226788">.</span><span class="ident" id="3226789">Value</span><span class="op" id="3226794">,</span>&nbsp;<span class="ident" id="3226796">in</span>&nbsp;<span class="ident" id="3226799">FuncMap</span><span class="op" id="3226806">)</span>&nbsp;<span class="op" id="3226808">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226811">for</span>&nbsp;<span class="ident" id="3226815">name</span><span class="op" id="3226819">,</span>&nbsp;<span class="ident" id="3226821">fn</span>&nbsp;<span class="op" id="3226824">:=</span>&nbsp;<span class="keyword" id="3226827">range</span>&nbsp;<span class="ident" id="3226833">in</span>&nbsp;<span class="op" id="3226836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226840">v</span>&nbsp;<span class="op" id="3226842">:=</span>&nbsp;<span class="ident" id="3226845">reflect</span><span class="op" id="3226852">.</span><span class="ident" id="3226853">ValueOf</span><span class="op" id="3226860">(</span><span class="ident" id="3226861">fn</span><span class="op" id="3226863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226867">if</span>&nbsp;<span class="ident" id="3226870">v</span><span class="op" id="3226871">.</span><span class="ident" id="3226872">Kind</span><span class="op" id="3226876">(</span><span class="op" id="3226877">)</span>&nbsp;<span class="op" id="3226879">!=</span>&nbsp;<span class="ident" id="3226882">reflect</span><span class="op" id="3226889">.</span><span class="ident" id="3226890">Func</span>&nbsp;<span class="op" id="3226895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3226900">panic</span><span class="op" id="3226905">(</span><span class="string" id="3226906">&#34;value&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="3226919">+</span>&nbsp;<span class="ident" id="3226921">name</span>&nbsp;<span class="op" id="3226926">+</span>&nbsp;<span class="string" id="3226928">&#34;&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="3226945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226949">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226953">if</span>&nbsp;<span class="op" id="3226956">!</span><span class="ident" id="3226957">goodFunc</span><span class="op" id="3226965">(</span><span class="ident" id="3226966">v</span><span class="op" id="3226967">.</span><span class="ident" id="3226968">Type</span><span class="op" id="3226972">(</span><span class="op" id="3226973">)</span><span class="op" id="3226974">)</span>&nbsp;<span class="op" id="3226976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3226981">panic</span><span class="op" id="3226986">(</span><span class="ident" id="3226987">fmt</span><span class="op" id="3226990">.</span><span class="ident" id="3226991">Errorf</span><span class="op" id="3226997">(</span><span class="string" id="3226998">&#34;can&#39;t&nbsp;install&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3227048">,</span>&nbsp;<span class="ident" id="3227050">name</span><span class="op" id="3227054">,</span>&nbsp;<span class="ident" id="3227056">v</span><span class="op" id="3227057">.</span><span class="ident" id="3227058">Type</span><span class="op" id="3227062">(</span><span class="op" id="3227063">)</span><span class="op" id="3227064">.</span><span class="ident" id="3227065">NumOut</span><span class="op" id="3227071">(</span><span class="op" id="3227072">)</span><span class="op" id="3227073">)</span><span class="op" id="3227074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227082">out</span><span class="op" id="3227085">[</span><span class="ident" id="3227086">name</span><span class="op" id="3227090">]</span>&nbsp;<span class="op" id="3227092">=</span>&nbsp;<span class="ident" id="3227094">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227097">}</span><br>
<span class="lineno">70</span><span class="op" id="3227099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3227102">//&nbsp;addFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs.&nbsp;It&nbsp;does&nbsp;no&nbsp;checking&nbsp;of&nbsp;the&nbsp;input&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="3227188">//&nbsp;call&nbsp;addValueFuncs&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="3227217">func</span>&nbsp;<span class="ident" id="3227222">addFuncs</span><span class="op" id="3227230">(</span><span class="ident" id="3227231">out</span><span class="op" id="3227234">,</span>&nbsp;<span class="ident" id="3227236">in</span>&nbsp;<span class="ident" id="3227239">FuncMap</span><span class="op" id="3227246">)</span>&nbsp;<span class="op" id="3227248">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227251">for</span>&nbsp;<span class="ident" id="3227255">name</span><span class="op" id="3227259">,</span>&nbsp;<span class="ident" id="3227261">fn</span>&nbsp;<span class="op" id="3227264">:=</span>&nbsp;<span class="keyword" id="3227267">range</span>&nbsp;<span class="ident" id="3227273">in</span>&nbsp;<span class="op" id="3227276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227280">out</span><span class="op" id="3227283">[</span><span class="ident" id="3227284">name</span><span class="op" id="3227288">]</span>&nbsp;<span class="op" id="3227290">=</span>&nbsp;<span class="ident" id="3227292">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227296">}</span><br>
<span class="lineno"></span><span class="op" id="3227298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3227301">//&nbsp;goodFunc&nbsp;checks&nbsp;that&nbsp;the&nbsp;function&nbsp;or&nbsp;method&nbsp;has&nbsp;the&nbsp;right&nbsp;result&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3227380">func</span>&nbsp;<span class="ident" id="3227385">goodFunc</span><span class="op" id="3227393">(</span><span class="ident" id="3227394">typ</span>&nbsp;<span class="ident" id="3227398">reflect</span><span class="op" id="3227405">.</span><span class="ident" id="3227406">Type</span><span class="op" id="3227410">)</span>&nbsp;<span class="builtintype" id="3227412">bool</span>&nbsp;<span class="op" id="3227417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3227420">//&nbsp;We&nbsp;allow&nbsp;functions&nbsp;with&nbsp;1&nbsp;result&nbsp;or&nbsp;2&nbsp;results&nbsp;where&nbsp;the&nbsp;second&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227500">switch</span>&nbsp;<span class="op" id="3227507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227510">case</span>&nbsp;<span class="ident" id="3227515">typ</span><span class="op" id="3227518">.</span><span class="ident" id="3227519">NumOut</span><span class="op" id="3227525">(</span><span class="op" id="3227526">)</span>&nbsp;<span class="op" id="3227528">==</span>&nbsp;<span class="num" id="3227531">1</span><span class="op" id="3227532">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227536">return</span>&nbsp;<span class="builtintype" id="3227543">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227549">case</span>&nbsp;<span class="ident" id="3227554">typ</span><span class="op" id="3227557">.</span><span class="ident" id="3227558">NumOut</span><span class="op" id="3227564">(</span><span class="op" id="3227565">)</span>&nbsp;<span class="op" id="3227567">==</span>&nbsp;<span class="num" id="3227570">2</span>&nbsp;<span class="op" id="3227572">&amp;&amp;</span>&nbsp;<span class="ident" id="3227575">typ</span><span class="op" id="3227578">.</span><span class="ident" id="3227579">Out</span><span class="op" id="3227582">(</span><span class="num" id="3227583">1</span><span class="op" id="3227584">)</span>&nbsp;<span class="op" id="3227586">==</span>&nbsp;<span class="ident" id="3227589">errorType</span><span class="op" id="3227598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227602">return</span>&nbsp;<span class="builtintype" id="3227609">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227618">return</span>&nbsp;<span class="builtintype" id="3227625">false</span><br>
<span class="lineno">90</span><span class="op" id="3227631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3227634">//&nbsp;findFunction&nbsp;looks&nbsp;for&nbsp;a&nbsp;function&nbsp;in&nbsp;the&nbsp;template,&nbsp;and&nbsp;global&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="3227704">func</span>&nbsp;<span class="ident" id="3227709">findFunction</span><span class="op" id="3227721">(</span><span class="ident" id="3227722">name</span>&nbsp;<span class="builtintype" id="3227727">string</span><span class="op" id="3227733">,</span>&nbsp;<span class="ident" id="3227735">tmpl</span>&nbsp;<span class="op" id="3227740">*</span><span class="ident" id="3227741">Template</span><span class="op" id="3227749">)</span>&nbsp;<span class="op" id="3227751">(</span><span class="ident" id="3227752">reflect</span><span class="op" id="3227759">.</span><span class="ident" id="3227760">Value</span><span class="op" id="3227765">,</span>&nbsp;<span class="builtintype" id="3227767">bool</span><span class="op" id="3227771">)</span>&nbsp;<span class="op" id="3227773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227776">if</span>&nbsp;<span class="ident" id="3227779">tmpl</span>&nbsp;<span class="op" id="3227784">!=</span>&nbsp;<span class="ident" id="3227787">nil</span>&nbsp;<span class="op" id="3227791">&amp;&amp;</span>&nbsp;<span class="ident" id="3227794">tmpl</span><span class="op" id="3227798">.</span><span class="ident" id="3227799">common</span>&nbsp;<span class="op" id="3227806">!=</span>&nbsp;<span class="ident" id="3227809">nil</span>&nbsp;<span class="op" id="3227813">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227817">if</span>&nbsp;<span class="ident" id="3227820">fn</span>&nbsp;<span class="op" id="3227823">:=</span>&nbsp;<span class="ident" id="3227826">tmpl</span><span class="op" id="3227830">.</span><span class="ident" id="3227831">execFuncs</span><span class="op" id="3227840">[</span><span class="ident" id="3227841">name</span><span class="op" id="3227845">]</span><span class="op" id="3227846">;</span>&nbsp;<span class="ident" id="3227848">fn</span><span class="op" id="3227850">.</span><span class="ident" id="3227851">IsValid</span><span class="op" id="3227858">(</span><span class="op" id="3227859">)</span>&nbsp;<span class="op" id="3227861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227866">return</span>&nbsp;<span class="ident" id="3227873">fn</span><span class="op" id="3227875">,</span>&nbsp;<span class="builtintype" id="3227877">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227890">if</span>&nbsp;<span class="ident" id="3227893">fn</span>&nbsp;<span class="op" id="3227896">:=</span>&nbsp;<span class="ident" id="3227899">builtinFuncs</span><span class="op" id="3227911">[</span><span class="ident" id="3227912">name</span><span class="op" id="3227916">]</span><span class="op" id="3227917">;</span>&nbsp;<span class="ident" id="3227919">fn</span><span class="op" id="3227921">.</span><span class="ident" id="3227922">IsValid</span><span class="op" id="3227929">(</span><span class="op" id="3227930">)</span>&nbsp;<span class="op" id="3227932">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227936">return</span>&nbsp;<span class="ident" id="3227943">fn</span><span class="op" id="3227945">,</span>&nbsp;<span class="builtintype" id="3227947">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227956">return</span>&nbsp;<span class="ident" id="3227963">reflect</span><span class="op" id="3227970">.</span><span class="ident" id="3227971">Value</span><span class="op" id="3227976">{</span><span class="op" id="3227977">}</span><span class="op" id="3227978">,</span>&nbsp;<span class="builtintype" id="3227980">false</span><br>
<span class="lineno"></span><span class="op" id="3227986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3227989">//&nbsp;Indexing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3228003">//&nbsp;index&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;indexing&nbsp;its&nbsp;first&nbsp;argument&nbsp;by&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="3228079">//&nbsp;arguments.&nbsp;&nbsp;Thus&nbsp;&#34;index&nbsp;x&nbsp;1&nbsp;2&nbsp;3&#34;&nbsp;is,&nbsp;in&nbsp;Go&nbsp;syntax,&nbsp;x[1][2][3].&nbsp;Each</span><br>
<span class="lineno"></span><span class="comment" id="3228150">//&nbsp;indexed&nbsp;item&nbsp;must&nbsp;be&nbsp;a&nbsp;map,&nbsp;slice,&nbsp;or&nbsp;array.</span><br>
<span class="lineno">110</span><span class="keyword" id="3228198">func</span>&nbsp;<span class="ident" id="3228203">index</span><span class="op" id="3228208">(</span><span class="ident" id="3228209">item</span>&nbsp;<span class="keyword" id="3228214">interface</span><span class="op" id="3228223">{</span><span class="op" id="3228224">}</span><span class="op" id="3228225">,</span>&nbsp;<span class="ident" id="3228227">indices</span>&nbsp;<span class="op" id="3228235">...</span><span class="keyword" id="3228238">interface</span><span class="op" id="3228247">{</span><span class="op" id="3228248">}</span><span class="op" id="3228249">)</span>&nbsp;<span class="op" id="3228251">(</span><span class="keyword" id="3228252">interface</span><span class="op" id="3228261">{</span><span class="op" id="3228262">}</span><span class="op" id="3228263">,</span>&nbsp;<span class="builtintype" id="3228265">error</span><span class="op" id="3228270">)</span>&nbsp;<span class="op" id="3228272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228275">v</span>&nbsp;<span class="op" id="3228277">:=</span>&nbsp;<span class="ident" id="3228280">reflect</span><span class="op" id="3228287">.</span><span class="ident" id="3228288">ValueOf</span><span class="op" id="3228295">(</span><span class="ident" id="3228296">item</span><span class="op" id="3228300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228303">for</span>&nbsp;<span class="ident" id="3228307">_</span><span class="op" id="3228308">,</span>&nbsp;<span class="ident" id="3228310">i</span>&nbsp;<span class="op" id="3228312">:=</span>&nbsp;<span class="keyword" id="3228315">range</span>&nbsp;<span class="ident" id="3228321">indices</span>&nbsp;<span class="op" id="3228329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228333">index</span>&nbsp;<span class="op" id="3228339">:=</span>&nbsp;<span class="ident" id="3228342">reflect</span><span class="op" id="3228349">.</span><span class="ident" id="3228350">ValueOf</span><span class="op" id="3228357">(</span><span class="ident" id="3228358">i</span><span class="op" id="3228359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228363">var</span>&nbsp;<span class="ident" id="3228367">isNil</span>&nbsp;<span class="builtintype" id="3228373">bool</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228380">if</span>&nbsp;<span class="ident" id="3228383">v</span><span class="op" id="3228384">,</span>&nbsp;<span class="ident" id="3228386">isNil</span>&nbsp;<span class="op" id="3228392">=</span>&nbsp;<span class="ident" id="3228394">indirect</span><span class="op" id="3228402">(</span><span class="ident" id="3228403">v</span><span class="op" id="3228404">)</span><span class="op" id="3228405">;</span>&nbsp;<span class="ident" id="3228407">isNil</span>&nbsp;<span class="op" id="3228413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228418">return</span>&nbsp;<span class="ident" id="3228425">nil</span><span class="op" id="3228428">,</span>&nbsp;<span class="ident" id="3228430">fmt</span><span class="op" id="3228433">.</span><span class="ident" id="3228434">Errorf</span><span class="op" id="3228440">(</span><span class="string" id="3228441">&#34;index&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3228463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228471">switch</span>&nbsp;<span class="ident" id="3228478">v</span><span class="op" id="3228479">.</span><span class="ident" id="3228480">Kind</span><span class="op" id="3228484">(</span><span class="op" id="3228485">)</span>&nbsp;<span class="op" id="3228487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228491">case</span>&nbsp;<span class="ident" id="3228496">reflect</span><span class="op" id="3228503">.</span><span class="ident" id="3228504">Array</span><span class="op" id="3228509">,</span>&nbsp;<span class="ident" id="3228511">reflect</span><span class="op" id="3228518">.</span><span class="ident" id="3228519">Slice</span><span class="op" id="3228524">,</span>&nbsp;<span class="ident" id="3228526">reflect</span><span class="op" id="3228533">.</span><span class="ident" id="3228534">String</span><span class="op" id="3228540">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228545">var</span>&nbsp;<span class="ident" id="3228549">x</span>&nbsp;<span class="ident" id="3228551">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228560">switch</span>&nbsp;<span class="ident" id="3228567">index</span><span class="op" id="3228572">.</span><span class="ident" id="3228573">Kind</span><span class="op" id="3228577">(</span><span class="op" id="3228578">)</span>&nbsp;<span class="op" id="3228580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228585">case</span>&nbsp;<span class="ident" id="3228590">reflect</span><span class="op" id="3228597">.</span><span class="ident" id="3228598">Int</span><span class="op" id="3228601">,</span>&nbsp;<span class="ident" id="3228603">reflect</span><span class="op" id="3228610">.</span><span class="ident" id="3228611">Int8</span><span class="op" id="3228615">,</span>&nbsp;<span class="ident" id="3228617">reflect</span><span class="op" id="3228624">.</span><span class="ident" id="3228625">Int16</span><span class="op" id="3228630">,</span>&nbsp;<span class="ident" id="3228632">reflect</span><span class="op" id="3228639">.</span><span class="ident" id="3228640">Int32</span><span class="op" id="3228645">,</span>&nbsp;<span class="ident" id="3228647">reflect</span><span class="op" id="3228654">.</span><span class="ident" id="3228655">Int64</span><span class="op" id="3228660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228666">x</span>&nbsp;<span class="op" id="3228668">=</span>&nbsp;<span class="ident" id="3228670">index</span><span class="op" id="3228675">.</span><span class="ident" id="3228676">Int</span><span class="op" id="3228679">(</span><span class="op" id="3228680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228685">case</span>&nbsp;<span class="ident" id="3228690">reflect</span><span class="op" id="3228697">.</span><span class="ident" id="3228698">Uint</span><span class="op" id="3228702">,</span>&nbsp;<span class="ident" id="3228704">reflect</span><span class="op" id="3228711">.</span><span class="ident" id="3228712">Uint8</span><span class="op" id="3228717">,</span>&nbsp;<span class="ident" id="3228719">reflect</span><span class="op" id="3228726">.</span><span class="ident" id="3228727">Uint16</span><span class="op" id="3228733">,</span>&nbsp;<span class="ident" id="3228735">reflect</span><span class="op" id="3228742">.</span><span class="ident" id="3228743">Uint32</span><span class="op" id="3228749">,</span>&nbsp;<span class="ident" id="3228751">reflect</span><span class="op" id="3228758">.</span><span class="ident" id="3228759">Uint64</span><span class="op" id="3228765">,</span>&nbsp;<span class="ident" id="3228767">reflect</span><span class="op" id="3228774">.</span><span class="ident" id="3228775">Uintptr</span><span class="op" id="3228782">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228788">x</span>&nbsp;<span class="op" id="3228790">=</span>&nbsp;<span class="ident" id="3228792">int64</span><span class="op" id="3228797">(</span><span class="ident" id="3228798">index</span><span class="op" id="3228803">.</span><span class="ident" id="3228804">Uint</span><span class="op" id="3228808">(</span><span class="op" id="3228809">)</span><span class="op" id="3228810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228815">default</span><span class="op" id="3228822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228828">return</span>&nbsp;<span class="ident" id="3228835">nil</span><span class="op" id="3228838">,</span>&nbsp;<span class="ident" id="3228840">fmt</span><span class="op" id="3228843">.</span><span class="ident" id="3228844">Errorf</span><span class="op" id="3228850">(</span><span class="string" id="3228851">&#34;cannot&nbsp;index&nbsp;slice/array&nbsp;with&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3228890">,</span>&nbsp;<span class="ident" id="3228892">index</span><span class="op" id="3228897">.</span><span class="ident" id="3228898">Type</span><span class="op" id="3228902">(</span><span class="op" id="3228903">)</span><span class="op" id="3228904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228914">if</span>&nbsp;<span class="ident" id="3228917">x</span>&nbsp;<span class="op" id="3228919">&lt;</span>&nbsp;<span class="num" id="3228921">0</span>&nbsp;<span class="op" id="3228923">||</span>&nbsp;<span class="ident" id="3228926">x</span>&nbsp;<span class="op" id="3228928">&gt;=</span>&nbsp;<span class="ident" id="3228931">int64</span><span class="op" id="3228936">(</span><span class="ident" id="3228937">v</span><span class="op" id="3228938">.</span><span class="ident" id="3228939">Len</span><span class="op" id="3228942">(</span><span class="op" id="3228943">)</span><span class="op" id="3228944">)</span>&nbsp;<span class="op" id="3228946">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228952">return</span>&nbsp;<span class="ident" id="3228959">nil</span><span class="op" id="3228962">,</span>&nbsp;<span class="ident" id="3228964">fmt</span><span class="op" id="3228967">.</span><span class="ident" id="3228968">Errorf</span><span class="op" id="3228974">(</span><span class="string" id="3228975">&#34;index&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="3228999">,</span>&nbsp;<span class="ident" id="3229001">x</span><span class="op" id="3229002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229012">v</span>&nbsp;<span class="op" id="3229014">=</span>&nbsp;<span class="ident" id="3229016">v</span><span class="op" id="3229017">.</span><span class="ident" id="3229018">Index</span><span class="op" id="3229023">(</span><span class="builtintype" id="3229024">int</span><span class="op" id="3229027">(</span><span class="ident" id="3229028">x</span><span class="op" id="3229029">)</span><span class="op" id="3229030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229034">case</span>&nbsp;<span class="ident" id="3229039">reflect</span><span class="op" id="3229046">.</span><span class="ident" id="3229047">Map</span><span class="op" id="3229050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229055">if</span>&nbsp;<span class="op" id="3229058">!</span><span class="ident" id="3229059">index</span><span class="op" id="3229064">.</span><span class="ident" id="3229065">IsValid</span><span class="op" id="3229072">(</span><span class="op" id="3229073">)</span>&nbsp;<span class="op" id="3229075">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229081">index</span>&nbsp;<span class="op" id="3229087">=</span>&nbsp;<span class="ident" id="3229089">reflect</span><span class="op" id="3229096">.</span><span class="ident" id="3229097">Zero</span><span class="op" id="3229101">(</span><span class="ident" id="3229102">v</span><span class="op" id="3229103">.</span><span class="ident" id="3229104">Type</span><span class="op" id="3229108">(</span><span class="op" id="3229109">)</span><span class="op" id="3229110">.</span><span class="ident" id="3229111">Key</span><span class="op" id="3229114">(</span><span class="op" id="3229115">)</span><span class="op" id="3229116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229126">if</span>&nbsp;<span class="op" id="3229129">!</span><span class="ident" id="3229130">index</span><span class="op" id="3229135">.</span><span class="ident" id="3229136">Type</span><span class="op" id="3229140">(</span><span class="op" id="3229141">)</span><span class="op" id="3229142">.</span><span class="ident" id="3229143">AssignableTo</span><span class="op" id="3229155">(</span><span class="ident" id="3229156">v</span><span class="op" id="3229157">.</span><span class="ident" id="3229158">Type</span><span class="op" id="3229162">(</span><span class="op" id="3229163">)</span><span class="op" id="3229164">.</span><span class="ident" id="3229165">Key</span><span class="op" id="3229168">(</span><span class="op" id="3229169">)</span><span class="op" id="3229170">)</span>&nbsp;<span class="op" id="3229172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229178">return</span>&nbsp;<span class="ident" id="3229185">nil</span><span class="op" id="3229188">,</span>&nbsp;<span class="ident" id="3229190">fmt</span><span class="op" id="3229193">.</span><span class="ident" id="3229194">Errorf</span><span class="op" id="3229200">(</span><span class="string" id="3229201">&#34;%s&nbsp;is&nbsp;not&nbsp;index&nbsp;type&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3229230">,</span>&nbsp;<span class="ident" id="3229232">index</span><span class="op" id="3229237">.</span><span class="ident" id="3229238">Type</span><span class="op" id="3229242">(</span><span class="op" id="3229243">)</span><span class="op" id="3229244">,</span>&nbsp;<span class="ident" id="3229246">v</span><span class="op" id="3229247">.</span><span class="ident" id="3229248">Type</span><span class="op" id="3229252">(</span><span class="op" id="3229253">)</span><span class="op" id="3229254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229259">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229264">if</span>&nbsp;<span class="ident" id="3229267">x</span>&nbsp;<span class="op" id="3229269">:=</span>&nbsp;<span class="ident" id="3229272">v</span><span class="op" id="3229273">.</span><span class="ident" id="3229274">MapIndex</span><span class="op" id="3229282">(</span><span class="ident" id="3229283">index</span><span class="op" id="3229288">)</span><span class="op" id="3229289">;</span>&nbsp;<span class="ident" id="3229291">x</span><span class="op" id="3229292">.</span><span class="ident" id="3229293">IsValid</span><span class="op" id="3229300">(</span><span class="op" id="3229301">)</span>&nbsp;<span class="op" id="3229303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229309">v</span>&nbsp;<span class="op" id="3229311">=</span>&nbsp;<span class="ident" id="3229313">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229318">}</span>&nbsp;<span class="keyword" id="3229320">else</span>&nbsp;<span class="op" id="3229325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229331">v</span>&nbsp;<span class="op" id="3229333">=</span>&nbsp;<span class="ident" id="3229335">reflect</span><span class="op" id="3229342">.</span><span class="ident" id="3229343">Zero</span><span class="op" id="3229347">(</span><span class="ident" id="3229348">v</span><span class="op" id="3229349">.</span><span class="ident" id="3229350">Type</span><span class="op" id="3229354">(</span><span class="op" id="3229355">)</span><span class="op" id="3229356">.</span><span class="ident" id="3229357">Elem</span><span class="op" id="3229361">(</span><span class="op" id="3229362">)</span><span class="op" id="3229363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229368">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229372">default</span><span class="op" id="3229379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229384">return</span>&nbsp;<span class="ident" id="3229391">nil</span><span class="op" id="3229394">,</span>&nbsp;<span class="ident" id="3229396">fmt</span><span class="op" id="3229399">.</span><span class="ident" id="3229400">Errorf</span><span class="op" id="3229406">(</span><span class="string" id="3229407">&#34;can&#39;t&nbsp;index&nbsp;item&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3229436">,</span>&nbsp;<span class="ident" id="3229438">v</span><span class="op" id="3229439">.</span><span class="ident" id="3229440">Type</span><span class="op" id="3229444">(</span><span class="op" id="3229445">)</span><span class="op" id="3229446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229456">return</span>&nbsp;<span class="ident" id="3229463">v</span><span class="op" id="3229464">.</span><span class="ident" id="3229465">Interface</span><span class="op" id="3229474">(</span><span class="op" id="3229475">)</span><span class="op" id="3229476">,</span>&nbsp;<span class="ident" id="3229478">nil</span><br>
<span class="lineno">150</span><span class="op" id="3229482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3229485">//&nbsp;Length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3229496">//&nbsp;length&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;item,&nbsp;with&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;defined&nbsp;length.</span><br>
<span class="lineno">155</span><span class="keyword" id="3229581">func</span>&nbsp;<span class="ident" id="3229586">length</span><span class="op" id="3229592">(</span><span class="ident" id="3229593">item</span>&nbsp;<span class="keyword" id="3229598">interface</span><span class="op" id="3229607">{</span><span class="op" id="3229608">}</span><span class="op" id="3229609">)</span>&nbsp;<span class="op" id="3229611">(</span><span class="builtintype" id="3229612">int</span><span class="op" id="3229615">,</span>&nbsp;<span class="builtintype" id="3229617">error</span><span class="op" id="3229622">)</span>&nbsp;<span class="op" id="3229624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229627">v</span><span class="op" id="3229628">,</span>&nbsp;<span class="ident" id="3229630">isNil</span>&nbsp;<span class="op" id="3229636">:=</span>&nbsp;<span class="ident" id="3229639">indirect</span><span class="op" id="3229647">(</span><span class="ident" id="3229648">reflect</span><span class="op" id="3229655">.</span><span class="ident" id="3229656">ValueOf</span><span class="op" id="3229663">(</span><span class="ident" id="3229664">item</span><span class="op" id="3229668">)</span><span class="op" id="3229669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229672">if</span>&nbsp;<span class="ident" id="3229675">isNil</span>&nbsp;<span class="op" id="3229681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229685">return</span>&nbsp;<span class="num" id="3229692">0</span><span class="op" id="3229693">,</span>&nbsp;<span class="ident" id="3229695">fmt</span><span class="op" id="3229698">.</span><span class="ident" id="3229699">Errorf</span><span class="op" id="3229705">(</span><span class="string" id="3229706">&#34;len&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3229726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229729">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229732">switch</span>&nbsp;<span class="ident" id="3229739">v</span><span class="op" id="3229740">.</span><span class="ident" id="3229741">Kind</span><span class="op" id="3229745">(</span><span class="op" id="3229746">)</span>&nbsp;<span class="op" id="3229748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229751">case</span>&nbsp;<span class="ident" id="3229756">reflect</span><span class="op" id="3229763">.</span><span class="ident" id="3229764">Array</span><span class="op" id="3229769">,</span>&nbsp;<span class="ident" id="3229771">reflect</span><span class="op" id="3229778">.</span><span class="ident" id="3229779">Chan</span><span class="op" id="3229783">,</span>&nbsp;<span class="ident" id="3229785">reflect</span><span class="op" id="3229792">.</span><span class="ident" id="3229793">Map</span><span class="op" id="3229796">,</span>&nbsp;<span class="ident" id="3229798">reflect</span><span class="op" id="3229805">.</span><span class="ident" id="3229806">Slice</span><span class="op" id="3229811">,</span>&nbsp;<span class="ident" id="3229813">reflect</span><span class="op" id="3229820">.</span><span class="ident" id="3229821">String</span><span class="op" id="3229827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229831">return</span>&nbsp;<span class="ident" id="3229838">v</span><span class="op" id="3229839">.</span><span class="ident" id="3229840">Len</span><span class="op" id="3229843">(</span><span class="op" id="3229844">)</span><span class="op" id="3229845">,</span>&nbsp;<span class="ident" id="3229847">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229855">return</span>&nbsp;<span class="num" id="3229862">0</span><span class="op" id="3229863">,</span>&nbsp;<span class="ident" id="3229865">fmt</span><span class="op" id="3229868">.</span><span class="ident" id="3229869">Errorf</span><span class="op" id="3229875">(</span><span class="string" id="3229876">&#34;len&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3229892">,</span>&nbsp;<span class="ident" id="3229894">v</span><span class="op" id="3229895">.</span><span class="ident" id="3229896">Type</span><span class="op" id="3229900">(</span><span class="op" id="3229901">)</span><span class="op" id="3229902">)</span><br>
<span class="lineno">165</span><span class="op" id="3229904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3229907">//&nbsp;Function&nbsp;invocation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3229931">//&nbsp;call&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;argument&nbsp;as&nbsp;a&nbsp;function.</span><br>
<span class="lineno">170</span><span class="comment" id="3230006">//&nbsp;The&nbsp;function&nbsp;must&nbsp;return&nbsp;1&nbsp;result,&nbsp;or&nbsp;2&nbsp;results,&nbsp;the&nbsp;second&nbsp;of&nbsp;which&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3230091">func</span>&nbsp;<span class="ident" id="3230096">call</span><span class="op" id="3230100">(</span><span class="ident" id="3230101">fn</span>&nbsp;<span class="keyword" id="3230104">interface</span><span class="op" id="3230113">{</span><span class="op" id="3230114">}</span><span class="op" id="3230115">,</span>&nbsp;<span class="ident" id="3230117">args</span>&nbsp;<span class="op" id="3230122">...</span><span class="keyword" id="3230125">interface</span><span class="op" id="3230134">{</span><span class="op" id="3230135">}</span><span class="op" id="3230136">)</span>&nbsp;<span class="op" id="3230138">(</span><span class="keyword" id="3230139">interface</span><span class="op" id="3230148">{</span><span class="op" id="3230149">}</span><span class="op" id="3230150">,</span>&nbsp;<span class="builtintype" id="3230152">error</span><span class="op" id="3230157">)</span>&nbsp;<span class="op" id="3230159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230162">v</span>&nbsp;<span class="op" id="3230164">:=</span>&nbsp;<span class="ident" id="3230167">reflect</span><span class="op" id="3230174">.</span><span class="ident" id="3230175">ValueOf</span><span class="op" id="3230182">(</span><span class="ident" id="3230183">fn</span><span class="op" id="3230185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230188">typ</span>&nbsp;<span class="op" id="3230192">:=</span>&nbsp;<span class="ident" id="3230195">v</span><span class="op" id="3230196">.</span><span class="ident" id="3230197">Type</span><span class="op" id="3230201">(</span><span class="op" id="3230202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230205">if</span>&nbsp;<span class="ident" id="3230208">typ</span><span class="op" id="3230211">.</span><span class="ident" id="3230212">Kind</span><span class="op" id="3230216">(</span><span class="op" id="3230217">)</span>&nbsp;<span class="op" id="3230219">!=</span>&nbsp;<span class="ident" id="3230222">reflect</span><span class="op" id="3230229">.</span><span class="ident" id="3230230">Func</span>&nbsp;<span class="op" id="3230235">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230239">return</span>&nbsp;<span class="ident" id="3230246">nil</span><span class="op" id="3230249">,</span>&nbsp;<span class="ident" id="3230251">fmt</span><span class="op" id="3230254">.</span><span class="ident" id="3230255">Errorf</span><span class="op" id="3230261">(</span><span class="string" id="3230262">&#34;non-function&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3230287">,</span>&nbsp;<span class="ident" id="3230289">typ</span><span class="op" id="3230292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230298">if</span>&nbsp;<span class="op" id="3230301">!</span><span class="ident" id="3230302">goodFunc</span><span class="op" id="3230310">(</span><span class="ident" id="3230311">typ</span><span class="op" id="3230314">)</span>&nbsp;<span class="op" id="3230316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230320">return</span>&nbsp;<span class="ident" id="3230327">nil</span><span class="op" id="3230330">,</span>&nbsp;<span class="ident" id="3230332">fmt</span><span class="op" id="3230335">.</span><span class="ident" id="3230336">Errorf</span><span class="op" id="3230342">(</span><span class="string" id="3230343">&#34;function&nbsp;called&nbsp;with&nbsp;%d&nbsp;args;&nbsp;should&nbsp;be&nbsp;1&nbsp;or&nbsp;2&#34;</span><span class="op" id="3230391">,</span>&nbsp;<span class="ident" id="3230393">typ</span><span class="op" id="3230396">.</span><span class="ident" id="3230397">NumOut</span><span class="op" id="3230403">(</span><span class="op" id="3230404">)</span><span class="op" id="3230405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230408">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230411">numIn</span>&nbsp;<span class="op" id="3230417">:=</span>&nbsp;<span class="ident" id="3230420">typ</span><span class="op" id="3230423">.</span><span class="ident" id="3230424">NumIn</span><span class="op" id="3230429">(</span><span class="op" id="3230430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230433">var</span>&nbsp;<span class="ident" id="3230437">dddType</span>&nbsp;<span class="ident" id="3230445">reflect</span><span class="op" id="3230452">.</span><span class="ident" id="3230453">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230459">if</span>&nbsp;<span class="ident" id="3230462">typ</span><span class="op" id="3230465">.</span><span class="ident" id="3230466">IsVariadic</span><span class="op" id="3230476">(</span><span class="op" id="3230477">)</span>&nbsp;<span class="op" id="3230479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230483">if</span>&nbsp;<span class="builtinfunc" id="3230486">len</span><span class="op" id="3230489">(</span><span class="ident" id="3230490">args</span><span class="op" id="3230494">)</span>&nbsp;<span class="op" id="3230496">&lt;</span>&nbsp;<span class="ident" id="3230498">numIn</span><span class="op" id="3230503">-</span><span class="num" id="3230504">1</span>&nbsp;<span class="op" id="3230506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230511">return</span>&nbsp;<span class="ident" id="3230518">nil</span><span class="op" id="3230521">,</span>&nbsp;<span class="ident" id="3230523">fmt</span><span class="op" id="3230526">.</span><span class="ident" id="3230527">Errorf</span><span class="op" id="3230533">(</span><span class="string" id="3230534">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&#34;</span><span class="op" id="3230581">,</span>&nbsp;<span class="builtinfunc" id="3230583">len</span><span class="op" id="3230586">(</span><span class="ident" id="3230587">args</span><span class="op" id="3230591">)</span><span class="op" id="3230592">,</span>&nbsp;<span class="ident" id="3230594">numIn</span><span class="op" id="3230599">-</span><span class="num" id="3230600">1</span><span class="op" id="3230601">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230609">dddType</span>&nbsp;<span class="op" id="3230617">=</span>&nbsp;<span class="ident" id="3230619">typ</span><span class="op" id="3230622">.</span><span class="ident" id="3230623">In</span><span class="op" id="3230625">(</span><span class="ident" id="3230626">numIn</span>&nbsp;<span class="op" id="3230632">-</span>&nbsp;<span class="num" id="3230634">1</span><span class="op" id="3230635">)</span><span class="op" id="3230636">.</span><span class="ident" id="3230637">Elem</span><span class="op" id="3230641">(</span><span class="op" id="3230642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230645">}</span>&nbsp;<span class="keyword" id="3230647">else</span>&nbsp;<span class="op" id="3230652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230656">if</span>&nbsp;<span class="builtinfunc" id="3230659">len</span><span class="op" id="3230662">(</span><span class="ident" id="3230663">args</span><span class="op" id="3230667">)</span>&nbsp;<span class="op" id="3230669">!=</span>&nbsp;<span class="ident" id="3230672">numIn</span>&nbsp;<span class="op" id="3230678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230683">return</span>&nbsp;<span class="ident" id="3230690">nil</span><span class="op" id="3230693">,</span>&nbsp;<span class="ident" id="3230695">fmt</span><span class="op" id="3230698">.</span><span class="ident" id="3230699">Errorf</span><span class="op" id="3230705">(</span><span class="string" id="3230706">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="3230744">,</span>&nbsp;<span class="builtinfunc" id="3230746">len</span><span class="op" id="3230749">(</span><span class="ident" id="3230750">args</span><span class="op" id="3230754">)</span><span class="op" id="3230755">,</span>&nbsp;<span class="ident" id="3230757">numIn</span><span class="op" id="3230762">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230772">argv</span>&nbsp;<span class="op" id="3230777">:=</span>&nbsp;<span class="builtinfunc" id="3230780">make</span><span class="op" id="3230784">(</span><span class="op" id="3230785">[</span><span class="op" id="3230786">]</span><span class="ident" id="3230787">reflect</span><span class="op" id="3230794">.</span><span class="ident" id="3230795">Value</span><span class="op" id="3230800">,</span>&nbsp;<span class="builtinfunc" id="3230802">len</span><span class="op" id="3230805">(</span><span class="ident" id="3230806">args</span><span class="op" id="3230810">)</span><span class="op" id="3230811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230814">for</span>&nbsp;<span class="ident" id="3230818">i</span><span class="op" id="3230819">,</span>&nbsp;<span class="ident" id="3230821">arg</span>&nbsp;<span class="op" id="3230825">:=</span>&nbsp;<span class="keyword" id="3230828">range</span>&nbsp;<span class="ident" id="3230834">args</span>&nbsp;<span class="op" id="3230839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230843">value</span>&nbsp;<span class="op" id="3230849">:=</span>&nbsp;<span class="ident" id="3230852">reflect</span><span class="op" id="3230859">.</span><span class="ident" id="3230860">ValueOf</span><span class="op" id="3230867">(</span><span class="ident" id="3230868">arg</span><span class="op" id="3230871">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3230875">//&nbsp;Compute&nbsp;the&nbsp;expected&nbsp;type.&nbsp;Clumsy&nbsp;because&nbsp;of&nbsp;variadics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230936">var</span>&nbsp;<span class="ident" id="3230940">argType</span>&nbsp;<span class="ident" id="3230948">reflect</span><span class="op" id="3230955">.</span><span class="ident" id="3230956">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230963">if</span>&nbsp;<span class="op" id="3230966">!</span><span class="ident" id="3230967">typ</span><span class="op" id="3230970">.</span><span class="ident" id="3230971">IsVariadic</span><span class="op" id="3230981">(</span><span class="op" id="3230982">)</span>&nbsp;<span class="op" id="3230984">||</span>&nbsp;<span class="ident" id="3230987">i</span>&nbsp;<span class="op" id="3230989">&lt;</span>&nbsp;<span class="ident" id="3230991">numIn</span><span class="op" id="3230996">-</span><span class="num" id="3230997">1</span>&nbsp;<span class="op" id="3230999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231004">argType</span>&nbsp;<span class="op" id="3231012">=</span>&nbsp;<span class="ident" id="3231014">typ</span><span class="op" id="3231017">.</span><span class="ident" id="3231018">In</span><span class="op" id="3231020">(</span><span class="ident" id="3231021">i</span><span class="op" id="3231022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231026">}</span>&nbsp;<span class="keyword" id="3231028">else</span>&nbsp;<span class="op" id="3231033">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231038">argType</span>&nbsp;<span class="op" id="3231046">=</span>&nbsp;<span class="ident" id="3231048">dddType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231062">if</span>&nbsp;<span class="op" id="3231065">!</span><span class="ident" id="3231066">value</span><span class="op" id="3231071">.</span><span class="ident" id="3231072">IsValid</span><span class="op" id="3231079">(</span><span class="op" id="3231080">)</span>&nbsp;<span class="op" id="3231082">&amp;&amp;</span>&nbsp;<span class="ident" id="3231085">canBeNil</span><span class="op" id="3231093">(</span><span class="ident" id="3231094">argType</span><span class="op" id="3231101">)</span>&nbsp;<span class="op" id="3231103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231108">value</span>&nbsp;<span class="op" id="3231114">=</span>&nbsp;<span class="ident" id="3231116">reflect</span><span class="op" id="3231123">.</span><span class="ident" id="3231124">Zero</span><span class="op" id="3231128">(</span><span class="ident" id="3231129">argType</span><span class="op" id="3231136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231140">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231144">if</span>&nbsp;<span class="op" id="3231147">!</span><span class="ident" id="3231148">value</span><span class="op" id="3231153">.</span><span class="ident" id="3231154">Type</span><span class="op" id="3231158">(</span><span class="op" id="3231159">)</span><span class="op" id="3231160">.</span><span class="ident" id="3231161">AssignableTo</span><span class="op" id="3231173">(</span><span class="ident" id="3231174">argType</span><span class="op" id="3231181">)</span>&nbsp;<span class="op" id="3231183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231188">return</span>&nbsp;<span class="ident" id="3231195">nil</span><span class="op" id="3231198">,</span>&nbsp;<span class="ident" id="3231200">fmt</span><span class="op" id="3231203">.</span><span class="ident" id="3231204">Errorf</span><span class="op" id="3231210">(</span><span class="string" id="3231211">&#34;arg&nbsp;%d&nbsp;has&nbsp;type&nbsp;%s;&nbsp;should&nbsp;be&nbsp;%s&#34;</span><span class="op" id="3231245">,</span>&nbsp;<span class="ident" id="3231247">i</span><span class="op" id="3231248">,</span>&nbsp;<span class="ident" id="3231250">value</span><span class="op" id="3231255">.</span><span class="ident" id="3231256">Type</span><span class="op" id="3231260">(</span><span class="op" id="3231261">)</span><span class="op" id="3231262">,</span>&nbsp;<span class="ident" id="3231264">argType</span><span class="op" id="3231271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231279">argv</span><span class="op" id="3231283">[</span><span class="ident" id="3231284">i</span><span class="op" id="3231285">]</span>&nbsp;<span class="op" id="3231287">=</span>&nbsp;<span class="ident" id="3231289">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231296">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231299">result</span>&nbsp;<span class="op" id="3231306">:=</span>&nbsp;<span class="ident" id="3231309">v</span><span class="op" id="3231310">.</span><span class="ident" id="3231311">Call</span><span class="op" id="3231315">(</span><span class="ident" id="3231316">argv</span><span class="op" id="3231320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231323">if</span>&nbsp;<span class="builtinfunc" id="3231326">len</span><span class="op" id="3231329">(</span><span class="ident" id="3231330">result</span><span class="op" id="3231336">)</span>&nbsp;<span class="op" id="3231338">==</span>&nbsp;<span class="num" id="3231341">2</span>&nbsp;<span class="op" id="3231343">&amp;&amp;</span>&nbsp;<span class="op" id="3231346">!</span><span class="ident" id="3231347">result</span><span class="op" id="3231353">[</span><span class="num" id="3231354">1</span><span class="op" id="3231355">]</span><span class="op" id="3231356">.</span><span class="ident" id="3231357">IsNil</span><span class="op" id="3231362">(</span><span class="op" id="3231363">)</span>&nbsp;<span class="op" id="3231365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231369">return</span>&nbsp;<span class="ident" id="3231376">result</span><span class="op" id="3231382">[</span><span class="num" id="3231383">0</span><span class="op" id="3231384">]</span><span class="op" id="3231385">.</span><span class="ident" id="3231386">Interface</span><span class="op" id="3231395">(</span><span class="op" id="3231396">)</span><span class="op" id="3231397">,</span>&nbsp;<span class="ident" id="3231399">result</span><span class="op" id="3231405">[</span><span class="num" id="3231406">1</span><span class="op" id="3231407">]</span><span class="op" id="3231408">.</span><span class="ident" id="3231409">Interface</span><span class="op" id="3231418">(</span><span class="op" id="3231419">)</span><span class="op" id="3231420">.</span><span class="op" id="3231421">(</span><span class="builtintype" id="3231422">error</span><span class="op" id="3231427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231433">return</span>&nbsp;<span class="ident" id="3231440">result</span><span class="op" id="3231446">[</span><span class="num" id="3231447">0</span><span class="op" id="3231448">]</span><span class="op" id="3231449">.</span><span class="ident" id="3231450">Interface</span><span class="op" id="3231459">(</span><span class="op" id="3231460">)</span><span class="op" id="3231461">,</span>&nbsp;<span class="ident" id="3231463">nil</span><br>
<span class="lineno">215</span><span class="op" id="3231467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231470">//&nbsp;Boolean&nbsp;logic.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231489">func</span>&nbsp;<span class="ident" id="3231494">truth</span><span class="op" id="3231499">(</span><span class="ident" id="3231500">a</span>&nbsp;<span class="keyword" id="3231502">interface</span><span class="op" id="3231511">{</span><span class="op" id="3231512">}</span><span class="op" id="3231513">)</span>&nbsp;<span class="builtintype" id="3231515">bool</span>&nbsp;<span class="op" id="3231520">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231523">t</span><span class="op" id="3231524">,</span>&nbsp;<span class="ident" id="3231526">_</span>&nbsp;<span class="op" id="3231528">:=</span>&nbsp;<span class="ident" id="3231531">isTrue</span><span class="op" id="3231537">(</span><span class="ident" id="3231538">reflect</span><span class="op" id="3231545">.</span><span class="ident" id="3231546">ValueOf</span><span class="op" id="3231553">(</span><span class="ident" id="3231554">a</span><span class="op" id="3231555">)</span><span class="op" id="3231556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231559">return</span>&nbsp;<span class="ident" id="3231566">t</span><br>
<span class="lineno"></span><span class="op" id="3231568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231571">//&nbsp;and&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;AND&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">225</span><span class="comment" id="3231631">//&nbsp;the&nbsp;first&nbsp;false&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3231696">func</span>&nbsp;<span class="ident" id="3231701">and</span><span class="op" id="3231704">(</span><span class="ident" id="3231705">arg0</span>&nbsp;<span class="keyword" id="3231710">interface</span><span class="op" id="3231719">{</span><span class="op" id="3231720">}</span><span class="op" id="3231721">,</span>&nbsp;<span class="ident" id="3231723">args</span>&nbsp;<span class="op" id="3231728">...</span><span class="keyword" id="3231731">interface</span><span class="op" id="3231740">{</span><span class="op" id="3231741">}</span><span class="op" id="3231742">)</span>&nbsp;<span class="keyword" id="3231744">interface</span><span class="op" id="3231753">{</span><span class="op" id="3231754">}</span>&nbsp;<span class="op" id="3231756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231759">if</span>&nbsp;<span class="op" id="3231762">!</span><span class="ident" id="3231763">truth</span><span class="op" id="3231768">(</span><span class="ident" id="3231769">arg0</span><span class="op" id="3231773">)</span>&nbsp;<span class="op" id="3231775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231779">return</span>&nbsp;<span class="ident" id="3231786">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231792">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231795">for</span>&nbsp;<span class="ident" id="3231799">i</span>&nbsp;<span class="op" id="3231801">:=</span>&nbsp;<span class="keyword" id="3231804">range</span>&nbsp;<span class="ident" id="3231810">args</span>&nbsp;<span class="op" id="3231815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231819">arg0</span>&nbsp;<span class="op" id="3231824">=</span>&nbsp;<span class="ident" id="3231826">args</span><span class="op" id="3231830">[</span><span class="ident" id="3231831">i</span><span class="op" id="3231832">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231836">if</span>&nbsp;<span class="op" id="3231839">!</span><span class="ident" id="3231840">truth</span><span class="op" id="3231845">(</span><span class="ident" id="3231846">arg0</span><span class="op" id="3231850">)</span>&nbsp;<span class="op" id="3231852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231857">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231865">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231871">return</span>&nbsp;<span class="ident" id="3231878">arg0</span><br>
<span class="lineno"></span><span class="op" id="3231883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231886">//&nbsp;or&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;OR&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">240</span><span class="comment" id="3231944">//&nbsp;the&nbsp;first&nbsp;true&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3232008">func</span>&nbsp;<span class="ident" id="3232013">or</span><span class="op" id="3232015">(</span><span class="ident" id="3232016">arg0</span>&nbsp;<span class="keyword" id="3232021">interface</span><span class="op" id="3232030">{</span><span class="op" id="3232031">}</span><span class="op" id="3232032">,</span>&nbsp;<span class="ident" id="3232034">args</span>&nbsp;<span class="op" id="3232039">...</span><span class="keyword" id="3232042">interface</span><span class="op" id="3232051">{</span><span class="op" id="3232052">}</span><span class="op" id="3232053">)</span>&nbsp;<span class="keyword" id="3232055">interface</span><span class="op" id="3232064">{</span><span class="op" id="3232065">}</span>&nbsp;<span class="op" id="3232067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232070">if</span>&nbsp;<span class="ident" id="3232073">truth</span><span class="op" id="3232078">(</span><span class="ident" id="3232079">arg0</span><span class="op" id="3232083">)</span>&nbsp;<span class="op" id="3232085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232089">return</span>&nbsp;<span class="ident" id="3232096">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232102">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232105">for</span>&nbsp;<span class="ident" id="3232109">i</span>&nbsp;<span class="op" id="3232111">:=</span>&nbsp;<span class="keyword" id="3232114">range</span>&nbsp;<span class="ident" id="3232120">args</span>&nbsp;<span class="op" id="3232125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232129">arg0</span>&nbsp;<span class="op" id="3232134">=</span>&nbsp;<span class="ident" id="3232136">args</span><span class="op" id="3232140">[</span><span class="ident" id="3232141">i</span><span class="op" id="3232142">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232146">if</span>&nbsp;<span class="ident" id="3232149">truth</span><span class="op" id="3232154">(</span><span class="ident" id="3232155">arg0</span><span class="op" id="3232159">)</span>&nbsp;<span class="op" id="3232161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232166">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232174">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232180">return</span>&nbsp;<span class="ident" id="3232187">arg0</span><br>
<span class="lineno"></span><span class="op" id="3232192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3232195">//&nbsp;not&nbsp;returns&nbsp;the&nbsp;Boolean&nbsp;negation&nbsp;of&nbsp;its&nbsp;argument.</span><br>
<span class="lineno">255</span><span class="keyword" id="3232248">func</span>&nbsp;<span class="ident" id="3232253">not</span><span class="op" id="3232256">(</span><span class="ident" id="3232257">arg</span>&nbsp;<span class="keyword" id="3232261">interface</span><span class="op" id="3232270">{</span><span class="op" id="3232271">}</span><span class="op" id="3232272">)</span>&nbsp;<span class="op" id="3232274">(</span><span class="ident" id="3232275">truth</span>&nbsp;<span class="builtintype" id="3232281">bool</span><span class="op" id="3232285">)</span>&nbsp;<span class="op" id="3232287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232290">truth</span><span class="op" id="3232295">,</span>&nbsp;<span class="ident" id="3232297">_</span>&nbsp;<span class="op" id="3232299">=</span>&nbsp;<span class="ident" id="3232301">isTrue</span><span class="op" id="3232307">(</span><span class="ident" id="3232308">reflect</span><span class="op" id="3232315">.</span><span class="ident" id="3232316">ValueOf</span><span class="op" id="3232323">(</span><span class="ident" id="3232324">arg</span><span class="op" id="3232327">)</span><span class="op" id="3232328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232331">return</span>&nbsp;<span class="op" id="3232338">!</span><span class="ident" id="3232339">truth</span><br>
<span class="lineno"></span><span class="op" id="3232345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3232348">//&nbsp;Comparison.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3232364">//&nbsp;TODO:&nbsp;Perhaps&nbsp;allow&nbsp;comparison&nbsp;between&nbsp;signed&nbsp;and&nbsp;unsigned&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232437">var</span>&nbsp;<span class="op" id="3232441">(</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232444">errBadComparisonType</span>&nbsp;<span class="op" id="3232465">=</span>&nbsp;<span class="ident" id="3232467">errors</span><span class="op" id="3232473">.</span><span class="ident" id="3232474">New</span><span class="op" id="3232477">(</span><span class="string" id="3232478">&#34;invalid&nbsp;type&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3232507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232510">errBadComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3232531">=</span>&nbsp;<span class="ident" id="3232533">errors</span><span class="op" id="3232539">.</span><span class="ident" id="3232540">New</span><span class="op" id="3232543">(</span><span class="string" id="3232544">&#34;incompatible&nbsp;types&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3232579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232582">errNoComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3232603">=</span>&nbsp;<span class="ident" id="3232605">errors</span><span class="op" id="3232611">.</span><span class="ident" id="3232612">New</span><span class="op" id="3232615">(</span><span class="string" id="3232616">&#34;missing&nbsp;argument&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3232649">)</span><br>
<span class="lineno"></span><span class="op" id="3232651">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3232654">type</span>&nbsp;<span class="ident" id="3232659">kind</span>&nbsp;<span class="builtintype" id="3232664">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232669">const</span>&nbsp;<span class="op" id="3232675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232678">invalidKind</span>&nbsp;<span class="ident" id="3232690">kind</span>&nbsp;<span class="op" id="3232695">=</span>&nbsp;<span class="ident" id="3232697">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232703">boolKind</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232713">complexKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232726">intKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232735">floatKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232746">integerKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232759">stringKind</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232771">uintKind</span><br>
<span class="lineno"></span><span class="op" id="3232780">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232783">func</span>&nbsp;<span class="ident" id="3232788">basicKind</span><span class="op" id="3232797">(</span><span class="ident" id="3232798">v</span>&nbsp;<span class="ident" id="3232800">reflect</span><span class="op" id="3232807">.</span><span class="ident" id="3232808">Value</span><span class="op" id="3232813">)</span>&nbsp;<span class="op" id="3232815">(</span><span class="ident" id="3232816">kind</span><span class="op" id="3232820">,</span>&nbsp;<span class="builtintype" id="3232822">error</span><span class="op" id="3232827">)</span>&nbsp;<span class="op" id="3232829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232832">switch</span>&nbsp;<span class="ident" id="3232839">v</span><span class="op" id="3232840">.</span><span class="ident" id="3232841">Kind</span><span class="op" id="3232845">(</span><span class="op" id="3232846">)</span>&nbsp;<span class="op" id="3232848">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232851">case</span>&nbsp;<span class="ident" id="3232856">reflect</span><span class="op" id="3232863">.</span><span class="ident" id="3232864">Bool</span><span class="op" id="3232868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232872">return</span>&nbsp;<span class="ident" id="3232879">boolKind</span><span class="op" id="3232887">,</span>&nbsp;<span class="ident" id="3232889">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232894">case</span>&nbsp;<span class="ident" id="3232899">reflect</span><span class="op" id="3232906">.</span><span class="ident" id="3232907">Int</span><span class="op" id="3232910">,</span>&nbsp;<span class="ident" id="3232912">reflect</span><span class="op" id="3232919">.</span><span class="ident" id="3232920">Int8</span><span class="op" id="3232924">,</span>&nbsp;<span class="ident" id="3232926">reflect</span><span class="op" id="3232933">.</span><span class="ident" id="3232934">Int16</span><span class="op" id="3232939">,</span>&nbsp;<span class="ident" id="3232941">reflect</span><span class="op" id="3232948">.</span><span class="ident" id="3232949">Int32</span><span class="op" id="3232954">,</span>&nbsp;<span class="ident" id="3232956">reflect</span><span class="op" id="3232963">.</span><span class="ident" id="3232964">Int64</span><span class="op" id="3232969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232973">return</span>&nbsp;<span class="ident" id="3232980">intKind</span><span class="op" id="3232987">,</span>&nbsp;<span class="ident" id="3232989">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232994">case</span>&nbsp;<span class="ident" id="3232999">reflect</span><span class="op" id="3233006">.</span><span class="ident" id="3233007">Uint</span><span class="op" id="3233011">,</span>&nbsp;<span class="ident" id="3233013">reflect</span><span class="op" id="3233020">.</span><span class="ident" id="3233021">Uint8</span><span class="op" id="3233026">,</span>&nbsp;<span class="ident" id="3233028">reflect</span><span class="op" id="3233035">.</span><span class="ident" id="3233036">Uint16</span><span class="op" id="3233042">,</span>&nbsp;<span class="ident" id="3233044">reflect</span><span class="op" id="3233051">.</span><span class="ident" id="3233052">Uint32</span><span class="op" id="3233058">,</span>&nbsp;<span class="ident" id="3233060">reflect</span><span class="op" id="3233067">.</span><span class="ident" id="3233068">Uint64</span><span class="op" id="3233074">,</span>&nbsp;<span class="ident" id="3233076">reflect</span><span class="op" id="3233083">.</span><span class="ident" id="3233084">Uintptr</span><span class="op" id="3233091">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233095">return</span>&nbsp;<span class="ident" id="3233102">uintKind</span><span class="op" id="3233110">,</span>&nbsp;<span class="ident" id="3233112">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233117">case</span>&nbsp;<span class="ident" id="3233122">reflect</span><span class="op" id="3233129">.</span><span class="ident" id="3233130">Float32</span><span class="op" id="3233137">,</span>&nbsp;<span class="ident" id="3233139">reflect</span><span class="op" id="3233146">.</span><span class="ident" id="3233147">Float64</span><span class="op" id="3233154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233158">return</span>&nbsp;<span class="ident" id="3233165">floatKind</span><span class="op" id="3233174">,</span>&nbsp;<span class="ident" id="3233176">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233181">case</span>&nbsp;<span class="ident" id="3233186">reflect</span><span class="op" id="3233193">.</span><span class="ident" id="3233194">Complex64</span><span class="op" id="3233203">,</span>&nbsp;<span class="ident" id="3233205">reflect</span><span class="op" id="3233212">.</span><span class="ident" id="3233213">Complex128</span><span class="op" id="3233223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233227">return</span>&nbsp;<span class="ident" id="3233234">complexKind</span><span class="op" id="3233245">,</span>&nbsp;<span class="ident" id="3233247">nil</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233252">case</span>&nbsp;<span class="ident" id="3233257">reflect</span><span class="op" id="3233264">.</span><span class="ident" id="3233265">String</span><span class="op" id="3233271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233275">return</span>&nbsp;<span class="ident" id="3233282">stringKind</span><span class="op" id="3233292">,</span>&nbsp;<span class="ident" id="3233294">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233302">return</span>&nbsp;<span class="ident" id="3233309">invalidKind</span><span class="op" id="3233320">,</span>&nbsp;<span class="ident" id="3233322">errBadComparisonType</span><br>
<span class="lineno"></span><span class="op" id="3233343">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3233346">//&nbsp;eq&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;==&nbsp;b&nbsp;||&nbsp;a&nbsp;==&nbsp;c&nbsp;||&nbsp;...</span><br>
<span class="lineno"></span><span class="keyword" id="3233401">func</span>&nbsp;<span class="ident" id="3233406">eq</span><span class="op" id="3233408">(</span><span class="ident" id="3233409">arg1</span>&nbsp;<span class="keyword" id="3233414">interface</span><span class="op" id="3233423">{</span><span class="op" id="3233424">}</span><span class="op" id="3233425">,</span>&nbsp;<span class="ident" id="3233427">arg2</span>&nbsp;<span class="op" id="3233432">...</span><span class="keyword" id="3233435">interface</span><span class="op" id="3233444">{</span><span class="op" id="3233445">}</span><span class="op" id="3233446">)</span>&nbsp;<span class="op" id="3233448">(</span><span class="builtintype" id="3233449">bool</span><span class="op" id="3233453">,</span>&nbsp;<span class="builtintype" id="3233455">error</span><span class="op" id="3233460">)</span>&nbsp;<span class="op" id="3233462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233465">v1</span>&nbsp;<span class="op" id="3233468">:=</span>&nbsp;<span class="ident" id="3233471">reflect</span><span class="op" id="3233478">.</span><span class="ident" id="3233479">ValueOf</span><span class="op" id="3233486">(</span><span class="ident" id="3233487">arg1</span><span class="op" id="3233491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233494">k1</span><span class="op" id="3233496">,</span>&nbsp;<span class="ident" id="3233498">err</span>&nbsp;<span class="op" id="3233502">:=</span>&nbsp;<span class="ident" id="3233505">basicKind</span><span class="op" id="3233514">(</span><span class="ident" id="3233515">v1</span><span class="op" id="3233517">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233520">if</span>&nbsp;<span class="ident" id="3233523">err</span>&nbsp;<span class="op" id="3233527">!=</span>&nbsp;<span class="ident" id="3233530">nil</span>&nbsp;<span class="op" id="3233534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233538">return</span>&nbsp;<span class="builtintype" id="3233545">false</span><span class="op" id="3233550">,</span>&nbsp;<span class="ident" id="3233552">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233560">if</span>&nbsp;<span class="builtinfunc" id="3233563">len</span><span class="op" id="3233566">(</span><span class="ident" id="3233567">arg2</span><span class="op" id="3233571">)</span>&nbsp;<span class="op" id="3233573">==</span>&nbsp;<span class="num" id="3233576">0</span>&nbsp;<span class="op" id="3233578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233582">return</span>&nbsp;<span class="builtintype" id="3233589">false</span><span class="op" id="3233594">,</span>&nbsp;<span class="ident" id="3233596">errNoComparison</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233616">for</span>&nbsp;<span class="ident" id="3233620">_</span><span class="op" id="3233621">,</span>&nbsp;<span class="ident" id="3233623">arg</span>&nbsp;<span class="op" id="3233627">:=</span>&nbsp;<span class="keyword" id="3233630">range</span>&nbsp;<span class="ident" id="3233636">arg2</span>&nbsp;<span class="op" id="3233641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233645">v2</span>&nbsp;<span class="op" id="3233648">:=</span>&nbsp;<span class="ident" id="3233651">reflect</span><span class="op" id="3233658">.</span><span class="ident" id="3233659">ValueOf</span><span class="op" id="3233666">(</span><span class="ident" id="3233667">arg</span><span class="op" id="3233670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233674">k2</span><span class="op" id="3233676">,</span>&nbsp;<span class="ident" id="3233678">err</span>&nbsp;<span class="op" id="3233682">:=</span>&nbsp;<span class="ident" id="3233685">basicKind</span><span class="op" id="3233694">(</span><span class="ident" id="3233695">v2</span><span class="op" id="3233697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233701">if</span>&nbsp;<span class="ident" id="3233704">err</span>&nbsp;<span class="op" id="3233708">!=</span>&nbsp;<span class="ident" id="3233711">nil</span>&nbsp;<span class="op" id="3233715">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233720">return</span>&nbsp;<span class="builtintype" id="3233727">false</span><span class="op" id="3233732">,</span>&nbsp;<span class="ident" id="3233734">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233744">truth</span>&nbsp;<span class="op" id="3233750">:=</span>&nbsp;<span class="builtintype" id="3233753">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233761">if</span>&nbsp;<span class="ident" id="3233764">k1</span>&nbsp;<span class="op" id="3233767">!=</span>&nbsp;<span class="ident" id="3233770">k2</span>&nbsp;<span class="op" id="3233773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3233778">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233852">switch</span>&nbsp;<span class="op" id="3233859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233864">case</span>&nbsp;<span class="ident" id="3233869">k1</span>&nbsp;<span class="op" id="3233872">==</span>&nbsp;<span class="ident" id="3233875">intKind</span>&nbsp;<span class="op" id="3233883">&amp;&amp;</span>&nbsp;<span class="ident" id="3233886">k2</span>&nbsp;<span class="op" id="3233889">==</span>&nbsp;<span class="ident" id="3233892">uintKind</span><span class="op" id="3233900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233906">truth</span>&nbsp;<span class="op" id="3233912">=</span>&nbsp;<span class="ident" id="3233914">v1</span><span class="op" id="3233916">.</span><span class="ident" id="3233917">Int</span><span class="op" id="3233920">(</span><span class="op" id="3233921">)</span>&nbsp;<span class="op" id="3233923">&gt;=</span>&nbsp;<span class="num" id="3233926">0</span>&nbsp;<span class="op" id="3233928">&amp;&amp;</span>&nbsp;<span class="ident" id="3233931">uint64</span><span class="op" id="3233937">(</span><span class="ident" id="3233938">v1</span><span class="op" id="3233940">.</span><span class="ident" id="3233941">Int</span><span class="op" id="3233944">(</span><span class="op" id="3233945">)</span><span class="op" id="3233946">)</span>&nbsp;<span class="op" id="3233948">==</span>&nbsp;<span class="ident" id="3233951">v2</span><span class="op" id="3233953">.</span><span class="ident" id="3233954">Uint</span><span class="op" id="3233958">(</span><span class="op" id="3233959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233964">case</span>&nbsp;<span class="ident" id="3233969">k1</span>&nbsp;<span class="op" id="3233972">==</span>&nbsp;<span class="ident" id="3233975">uintKind</span>&nbsp;<span class="op" id="3233984">&amp;&amp;</span>&nbsp;<span class="ident" id="3233987">k2</span>&nbsp;<span class="op" id="3233990">==</span>&nbsp;<span class="ident" id="3233993">intKind</span><span class="op" id="3234000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234006">truth</span>&nbsp;<span class="op" id="3234012">=</span>&nbsp;<span class="ident" id="3234014">v2</span><span class="op" id="3234016">.</span><span class="ident" id="3234017">Int</span><span class="op" id="3234020">(</span><span class="op" id="3234021">)</span>&nbsp;<span class="op" id="3234023">&gt;=</span>&nbsp;<span class="num" id="3234026">0</span>&nbsp;<span class="op" id="3234028">&amp;&amp;</span>&nbsp;<span class="ident" id="3234031">v1</span><span class="op" id="3234033">.</span><span class="ident" id="3234034">Uint</span><span class="op" id="3234038">(</span><span class="op" id="3234039">)</span>&nbsp;<span class="op" id="3234041">==</span>&nbsp;<span class="ident" id="3234044">uint64</span><span class="op" id="3234050">(</span><span class="ident" id="3234051">v2</span><span class="op" id="3234053">.</span><span class="ident" id="3234054">Int</span><span class="op" id="3234057">(</span><span class="op" id="3234058">)</span><span class="op" id="3234059">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234064">default</span><span class="op" id="3234071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234077">return</span>&nbsp;<span class="builtintype" id="3234084">false</span><span class="op" id="3234089">,</span>&nbsp;<span class="ident" id="3234091">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234115">}</span>&nbsp;<span class="keyword" id="3234117">else</span>&nbsp;<span class="op" id="3234122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234127">switch</span>&nbsp;<span class="ident" id="3234134">k1</span>&nbsp;<span class="op" id="3234137">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234142">case</span>&nbsp;<span class="ident" id="3234147">boolKind</span><span class="op" id="3234155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234161">truth</span>&nbsp;<span class="op" id="3234167">=</span>&nbsp;<span class="ident" id="3234169">v1</span><span class="op" id="3234171">.</span><span class="ident" id="3234172">Bool</span><span class="op" id="3234176">(</span><span class="op" id="3234177">)</span>&nbsp;<span class="op" id="3234179">==</span>&nbsp;<span class="ident" id="3234182">v2</span><span class="op" id="3234184">.</span><span class="ident" id="3234185">Bool</span><span class="op" id="3234189">(</span><span class="op" id="3234190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234195">case</span>&nbsp;<span class="ident" id="3234200">complexKind</span><span class="op" id="3234211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234217">truth</span>&nbsp;<span class="op" id="3234223">=</span>&nbsp;<span class="ident" id="3234225">v1</span><span class="op" id="3234227">.</span><span class="ident" id="3234228">Complex</span><span class="op" id="3234235">(</span><span class="op" id="3234236">)</span>&nbsp;<span class="op" id="3234238">==</span>&nbsp;<span class="ident" id="3234241">v2</span><span class="op" id="3234243">.</span><span class="ident" id="3234244">Complex</span><span class="op" id="3234251">(</span><span class="op" id="3234252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234257">case</span>&nbsp;<span class="ident" id="3234262">floatKind</span><span class="op" id="3234271">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234277">truth</span>&nbsp;<span class="op" id="3234283">=</span>&nbsp;<span class="ident" id="3234285">v1</span><span class="op" id="3234287">.</span><span class="ident" id="3234288">Float</span><span class="op" id="3234293">(</span><span class="op" id="3234294">)</span>&nbsp;<span class="op" id="3234296">==</span>&nbsp;<span class="ident" id="3234299">v2</span><span class="op" id="3234301">.</span><span class="ident" id="3234302">Float</span><span class="op" id="3234307">(</span><span class="op" id="3234308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234313">case</span>&nbsp;<span class="ident" id="3234318">intKind</span><span class="op" id="3234325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234331">truth</span>&nbsp;<span class="op" id="3234337">=</span>&nbsp;<span class="ident" id="3234339">v1</span><span class="op" id="3234341">.</span><span class="ident" id="3234342">Int</span><span class="op" id="3234345">(</span><span class="op" id="3234346">)</span>&nbsp;<span class="op" id="3234348">==</span>&nbsp;<span class="ident" id="3234351">v2</span><span class="op" id="3234353">.</span><span class="ident" id="3234354">Int</span><span class="op" id="3234357">(</span><span class="op" id="3234358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234363">case</span>&nbsp;<span class="ident" id="3234368">stringKind</span><span class="op" id="3234378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234384">truth</span>&nbsp;<span class="op" id="3234390">=</span>&nbsp;<span class="ident" id="3234392">v1</span><span class="op" id="3234394">.</span><span class="ident" id="3234395">String</span><span class="op" id="3234401">(</span><span class="op" id="3234402">)</span>&nbsp;<span class="op" id="3234404">==</span>&nbsp;<span class="ident" id="3234407">v2</span><span class="op" id="3234409">.</span><span class="ident" id="3234410">String</span><span class="op" id="3234416">(</span><span class="op" id="3234417">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234422">case</span>&nbsp;<span class="ident" id="3234427">uintKind</span><span class="op" id="3234435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234441">truth</span>&nbsp;<span class="op" id="3234447">=</span>&nbsp;<span class="ident" id="3234449">v1</span><span class="op" id="3234451">.</span><span class="ident" id="3234452">Uint</span><span class="op" id="3234456">(</span><span class="op" id="3234457">)</span>&nbsp;<span class="op" id="3234459">==</span>&nbsp;<span class="ident" id="3234462">v2</span><span class="op" id="3234464">.</span><span class="ident" id="3234465">Uint</span><span class="op" id="3234469">(</span><span class="op" id="3234470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234475">default</span><span class="op" id="3234482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3234488">panic</span><span class="op" id="3234493">(</span><span class="string" id="3234494">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3234508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234513">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234521">if</span>&nbsp;<span class="ident" id="3234524">truth</span>&nbsp;<span class="op" id="3234530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234535">return</span>&nbsp;<span class="builtintype" id="3234542">true</span><span class="op" id="3234546">,</span>&nbsp;<span class="ident" id="3234548">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234557">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234560">return</span>&nbsp;<span class="builtintype" id="3234567">false</span><span class="op" id="3234572">,</span>&nbsp;<span class="ident" id="3234574">nil</span><br>
<span class="lineno"></span><span class="op" id="3234578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3234581">//&nbsp;ne&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3234620">func</span>&nbsp;<span class="ident" id="3234625">ne</span><span class="op" id="3234627">(</span><span class="ident" id="3234628">arg1</span><span class="op" id="3234632">,</span>&nbsp;<span class="ident" id="3234634">arg2</span>&nbsp;<span class="keyword" id="3234639">interface</span><span class="op" id="3234648">{</span><span class="op" id="3234649">}</span><span class="op" id="3234650">)</span>&nbsp;<span class="op" id="3234652">(</span><span class="builtintype" id="3234653">bool</span><span class="op" id="3234657">,</span>&nbsp;<span class="builtintype" id="3234659">error</span><span class="op" id="3234664">)</span>&nbsp;<span class="op" id="3234666">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3234669">//&nbsp;!=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;==.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234698">equal</span><span class="op" id="3234703">,</span>&nbsp;<span class="ident" id="3234705">err</span>&nbsp;<span class="op" id="3234709">:=</span>&nbsp;<span class="ident" id="3234712">eq</span><span class="op" id="3234714">(</span><span class="ident" id="3234715">arg1</span><span class="op" id="3234719">,</span>&nbsp;<span class="ident" id="3234721">arg2</span><span class="op" id="3234725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234728">return</span>&nbsp;<span class="op" id="3234735">!</span><span class="ident" id="3234736">equal</span><span class="op" id="3234741">,</span>&nbsp;<span class="ident" id="3234743">err</span><br>
<span class="lineno"></span><span class="op" id="3234747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="3234750">//&nbsp;lt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&lt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3234788">func</span>&nbsp;<span class="ident" id="3234793">lt</span><span class="op" id="3234795">(</span><span class="ident" id="3234796">arg1</span><span class="op" id="3234800">,</span>&nbsp;<span class="ident" id="3234802">arg2</span>&nbsp;<span class="keyword" id="3234807">interface</span><span class="op" id="3234816">{</span><span class="op" id="3234817">}</span><span class="op" id="3234818">)</span>&nbsp;<span class="op" id="3234820">(</span><span class="builtintype" id="3234821">bool</span><span class="op" id="3234825">,</span>&nbsp;<span class="builtintype" id="3234827">error</span><span class="op" id="3234832">)</span>&nbsp;<span class="op" id="3234834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234837">v1</span>&nbsp;<span class="op" id="3234840">:=</span>&nbsp;<span class="ident" id="3234843">reflect</span><span class="op" id="3234850">.</span><span class="ident" id="3234851">ValueOf</span><span class="op" id="3234858">(</span><span class="ident" id="3234859">arg1</span><span class="op" id="3234863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234866">k1</span><span class="op" id="3234868">,</span>&nbsp;<span class="ident" id="3234870">err</span>&nbsp;<span class="op" id="3234874">:=</span>&nbsp;<span class="ident" id="3234877">basicKind</span><span class="op" id="3234886">(</span><span class="ident" id="3234887">v1</span><span class="op" id="3234889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234892">if</span>&nbsp;<span class="ident" id="3234895">err</span>&nbsp;<span class="op" id="3234899">!=</span>&nbsp;<span class="ident" id="3234902">nil</span>&nbsp;<span class="op" id="3234906">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234910">return</span>&nbsp;<span class="builtintype" id="3234917">false</span><span class="op" id="3234922">,</span>&nbsp;<span class="ident" id="3234924">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234932">v2</span>&nbsp;<span class="op" id="3234935">:=</span>&nbsp;<span class="ident" id="3234938">reflect</span><span class="op" id="3234945">.</span><span class="ident" id="3234946">ValueOf</span><span class="op" id="3234953">(</span><span class="ident" id="3234954">arg2</span><span class="op" id="3234958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234961">k2</span><span class="op" id="3234963">,</span>&nbsp;<span class="ident" id="3234965">err</span>&nbsp;<span class="op" id="3234969">:=</span>&nbsp;<span class="ident" id="3234972">basicKind</span><span class="op" id="3234981">(</span><span class="ident" id="3234982">v2</span><span class="op" id="3234984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234987">if</span>&nbsp;<span class="ident" id="3234990">err</span>&nbsp;<span class="op" id="3234994">!=</span>&nbsp;<span class="ident" id="3234997">nil</span>&nbsp;<span class="op" id="3235001">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235005">return</span>&nbsp;<span class="builtintype" id="3235012">false</span><span class="op" id="3235017">,</span>&nbsp;<span class="ident" id="3235019">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235027">truth</span>&nbsp;<span class="op" id="3235033">:=</span>&nbsp;<span class="builtintype" id="3235036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235043">if</span>&nbsp;<span class="ident" id="3235046">k1</span>&nbsp;<span class="op" id="3235049">!=</span>&nbsp;<span class="ident" id="3235052">k2</span>&nbsp;<span class="op" id="3235055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3235059">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235132">switch</span>&nbsp;<span class="op" id="3235139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235143">case</span>&nbsp;<span class="ident" id="3235148">k1</span>&nbsp;<span class="op" id="3235151">==</span>&nbsp;<span class="ident" id="3235154">intKind</span>&nbsp;<span class="op" id="3235162">&amp;&amp;</span>&nbsp;<span class="ident" id="3235165">k2</span>&nbsp;<span class="op" id="3235168">==</span>&nbsp;<span class="ident" id="3235171">uintKind</span><span class="op" id="3235179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235184">truth</span>&nbsp;<span class="op" id="3235190">=</span>&nbsp;<span class="ident" id="3235192">v1</span><span class="op" id="3235194">.</span><span class="ident" id="3235195">Int</span><span class="op" id="3235198">(</span><span class="op" id="3235199">)</span>&nbsp;<span class="op" id="3235201">&lt;</span>&nbsp;<span class="num" id="3235203">0</span>&nbsp;<span class="op" id="3235205">||</span>&nbsp;<span class="ident" id="3235208">uint64</span><span class="op" id="3235214">(</span><span class="ident" id="3235215">v1</span><span class="op" id="3235217">.</span><span class="ident" id="3235218">Int</span><span class="op" id="3235221">(</span><span class="op" id="3235222">)</span><span class="op" id="3235223">)</span>&nbsp;<span class="op" id="3235225">&lt;</span>&nbsp;<span class="ident" id="3235227">v2</span><span class="op" id="3235229">.</span><span class="ident" id="3235230">Uint</span><span class="op" id="3235234">(</span><span class="op" id="3235235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235239">case</span>&nbsp;<span class="ident" id="3235244">k1</span>&nbsp;<span class="op" id="3235247">==</span>&nbsp;<span class="ident" id="3235250">uintKind</span>&nbsp;<span class="op" id="3235259">&amp;&amp;</span>&nbsp;<span class="ident" id="3235262">k2</span>&nbsp;<span class="op" id="3235265">==</span>&nbsp;<span class="ident" id="3235268">intKind</span><span class="op" id="3235275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235280">truth</span>&nbsp;<span class="op" id="3235286">=</span>&nbsp;<span class="ident" id="3235288">v2</span><span class="op" id="3235290">.</span><span class="ident" id="3235291">Int</span><span class="op" id="3235294">(</span><span class="op" id="3235295">)</span>&nbsp;<span class="op" id="3235297">&gt;=</span>&nbsp;<span class="num" id="3235300">0</span>&nbsp;<span class="op" id="3235302">&amp;&amp;</span>&nbsp;<span class="ident" id="3235305">v1</span><span class="op" id="3235307">.</span><span class="ident" id="3235308">Uint</span><span class="op" id="3235312">(</span><span class="op" id="3235313">)</span>&nbsp;<span class="op" id="3235315">&lt;</span>&nbsp;<span class="ident" id="3235317">uint64</span><span class="op" id="3235323">(</span><span class="ident" id="3235324">v2</span><span class="op" id="3235326">.</span><span class="ident" id="3235327">Int</span><span class="op" id="3235330">(</span><span class="op" id="3235331">)</span><span class="op" id="3235332">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235336">default</span><span class="op" id="3235343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235348">return</span>&nbsp;<span class="builtintype" id="3235355">false</span><span class="op" id="3235360">,</span>&nbsp;<span class="ident" id="3235362">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235384">}</span>&nbsp;<span class="keyword" id="3235386">else</span>&nbsp;<span class="op" id="3235391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235395">switch</span>&nbsp;<span class="ident" id="3235402">k1</span>&nbsp;<span class="op" id="3235405">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235409">case</span>&nbsp;<span class="ident" id="3235414">boolKind</span><span class="op" id="3235422">,</span>&nbsp;<span class="ident" id="3235424">complexKind</span><span class="op" id="3235435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235440">return</span>&nbsp;<span class="builtintype" id="3235447">false</span><span class="op" id="3235452">,</span>&nbsp;<span class="ident" id="3235454">errBadComparisonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235477">case</span>&nbsp;<span class="ident" id="3235482">floatKind</span><span class="op" id="3235491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235496">truth</span>&nbsp;<span class="op" id="3235502">=</span>&nbsp;<span class="ident" id="3235504">v1</span><span class="op" id="3235506">.</span><span class="ident" id="3235507">Float</span><span class="op" id="3235512">(</span><span class="op" id="3235513">)</span>&nbsp;<span class="op" id="3235515">&lt;</span>&nbsp;<span class="ident" id="3235517">v2</span><span class="op" id="3235519">.</span><span class="ident" id="3235520">Float</span><span class="op" id="3235525">(</span><span class="op" id="3235526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235530">case</span>&nbsp;<span class="ident" id="3235535">intKind</span><span class="op" id="3235542">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235547">truth</span>&nbsp;<span class="op" id="3235553">=</span>&nbsp;<span class="ident" id="3235555">v1</span><span class="op" id="3235557">.</span><span class="ident" id="3235558">Int</span><span class="op" id="3235561">(</span><span class="op" id="3235562">)</span>&nbsp;<span class="op" id="3235564">&lt;</span>&nbsp;<span class="ident" id="3235566">v2</span><span class="op" id="3235568">.</span><span class="ident" id="3235569">Int</span><span class="op" id="3235572">(</span><span class="op" id="3235573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235577">case</span>&nbsp;<span class="ident" id="3235582">stringKind</span><span class="op" id="3235592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235597">truth</span>&nbsp;<span class="op" id="3235603">=</span>&nbsp;<span class="ident" id="3235605">v1</span><span class="op" id="3235607">.</span><span class="ident" id="3235608">String</span><span class="op" id="3235614">(</span><span class="op" id="3235615">)</span>&nbsp;<span class="op" id="3235617">&lt;</span>&nbsp;<span class="ident" id="3235619">v2</span><span class="op" id="3235621">.</span><span class="ident" id="3235622">String</span><span class="op" id="3235628">(</span><span class="op" id="3235629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235633">case</span>&nbsp;<span class="ident" id="3235638">uintKind</span><span class="op" id="3235646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235651">truth</span>&nbsp;<span class="op" id="3235657">=</span>&nbsp;<span class="ident" id="3235659">v1</span><span class="op" id="3235661">.</span><span class="ident" id="3235662">Uint</span><span class="op" id="3235666">(</span><span class="op" id="3235667">)</span>&nbsp;<span class="op" id="3235669">&lt;</span>&nbsp;<span class="ident" id="3235671">v2</span><span class="op" id="3235673">.</span><span class="ident" id="3235674">Uint</span><span class="op" id="3235678">(</span><span class="op" id="3235679">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235683">default</span><span class="op" id="3235690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3235695">panic</span><span class="op" id="3235700">(</span><span class="string" id="3235701">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3235715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235725">return</span>&nbsp;<span class="ident" id="3235732">truth</span><span class="op" id="3235737">,</span>&nbsp;<span class="ident" id="3235739">nil</span><br>
<span class="lineno">400</span><span class="op" id="3235743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3235746">//&nbsp;le&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;&lt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3235783">func</span>&nbsp;<span class="ident" id="3235788">le</span><span class="op" id="3235790">(</span><span class="ident" id="3235791">arg1</span><span class="op" id="3235795">,</span>&nbsp;<span class="ident" id="3235797">arg2</span>&nbsp;<span class="keyword" id="3235802">interface</span><span class="op" id="3235811">{</span><span class="op" id="3235812">}</span><span class="op" id="3235813">)</span>&nbsp;<span class="op" id="3235815">(</span><span class="builtintype" id="3235816">bool</span><span class="op" id="3235820">,</span>&nbsp;<span class="builtintype" id="3235822">error</span><span class="op" id="3235827">)</span>&nbsp;<span class="op" id="3235829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3235832">//&nbsp;&lt;=&nbsp;is&nbsp;&lt;&nbsp;or&nbsp;==.</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235851">lessThan</span><span class="op" id="3235859">,</span>&nbsp;<span class="ident" id="3235861">err</span>&nbsp;<span class="op" id="3235865">:=</span>&nbsp;<span class="ident" id="3235868">lt</span><span class="op" id="3235870">(</span><span class="ident" id="3235871">arg1</span><span class="op" id="3235875">,</span>&nbsp;<span class="ident" id="3235877">arg2</span><span class="op" id="3235881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235884">if</span>&nbsp;<span class="ident" id="3235887">lessThan</span>&nbsp;<span class="op" id="3235896">||</span>&nbsp;<span class="ident" id="3235899">err</span>&nbsp;<span class="op" id="3235903">!=</span>&nbsp;<span class="ident" id="3235906">nil</span>&nbsp;<span class="op" id="3235910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235914">return</span>&nbsp;<span class="ident" id="3235921">lessThan</span><span class="op" id="3235929">,</span>&nbsp;<span class="ident" id="3235931">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235939">return</span>&nbsp;<span class="ident" id="3235946">eq</span><span class="op" id="3235948">(</span><span class="ident" id="3235949">arg1</span><span class="op" id="3235953">,</span>&nbsp;<span class="ident" id="3235955">arg2</span><span class="op" id="3235959">)</span><br>
<span class="lineno">410</span><span class="op" id="3235961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3235964">//&nbsp;gt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3236002">func</span>&nbsp;<span class="ident" id="3236007">gt</span><span class="op" id="3236009">(</span><span class="ident" id="3236010">arg1</span><span class="op" id="3236014">,</span>&nbsp;<span class="ident" id="3236016">arg2</span>&nbsp;<span class="keyword" id="3236021">interface</span><span class="op" id="3236030">{</span><span class="op" id="3236031">}</span><span class="op" id="3236032">)</span>&nbsp;<span class="op" id="3236034">(</span><span class="builtintype" id="3236035">bool</span><span class="op" id="3236039">,</span>&nbsp;<span class="builtintype" id="3236041">error</span><span class="op" id="3236046">)</span>&nbsp;<span class="op" id="3236048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3236051">//&nbsp;&gt;&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;=.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236079">lessOrEqual</span><span class="op" id="3236090">,</span>&nbsp;<span class="ident" id="3236092">err</span>&nbsp;<span class="op" id="3236096">:=</span>&nbsp;<span class="ident" id="3236099">le</span><span class="op" id="3236101">(</span><span class="ident" id="3236102">arg1</span><span class="op" id="3236106">,</span>&nbsp;<span class="ident" id="3236108">arg2</span><span class="op" id="3236112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236115">if</span>&nbsp;<span class="ident" id="3236118">err</span>&nbsp;<span class="op" id="3236122">!=</span>&nbsp;<span class="ident" id="3236125">nil</span>&nbsp;<span class="op" id="3236129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236133">return</span>&nbsp;<span class="builtintype" id="3236140">false</span><span class="op" id="3236145">,</span>&nbsp;<span class="ident" id="3236147">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3236152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236155">return</span>&nbsp;<span class="op" id="3236162">!</span><span class="ident" id="3236163">lessOrEqual</span><span class="op" id="3236174">,</span>&nbsp;<span class="ident" id="3236176">nil</span><br>
<span class="lineno">420</span><span class="op" id="3236180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3236183">//&nbsp;ge&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3236222">func</span>&nbsp;<span class="ident" id="3236227">ge</span><span class="op" id="3236229">(</span><span class="ident" id="3236230">arg1</span><span class="op" id="3236234">,</span>&nbsp;<span class="ident" id="3236236">arg2</span>&nbsp;<span class="keyword" id="3236241">interface</span><span class="op" id="3236250">{</span><span class="op" id="3236251">}</span><span class="op" id="3236252">)</span>&nbsp;<span class="op" id="3236254">(</span><span class="builtintype" id="3236255">bool</span><span class="op" id="3236259">,</span>&nbsp;<span class="builtintype" id="3236261">error</span><span class="op" id="3236266">)</span>&nbsp;<span class="op" id="3236268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3236271">//&nbsp;&gt;=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236299">lessThan</span><span class="op" id="3236307">,</span>&nbsp;<span class="ident" id="3236309">err</span>&nbsp;<span class="op" id="3236313">:=</span>&nbsp;<span class="ident" id="3236316">lt</span><span class="op" id="3236318">(</span><span class="ident" id="3236319">arg1</span><span class="op" id="3236323">,</span>&nbsp;<span class="ident" id="3236325">arg2</span><span class="op" id="3236329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236332">if</span>&nbsp;<span class="ident" id="3236335">err</span>&nbsp;<span class="op" id="3236339">!=</span>&nbsp;<span class="ident" id="3236342">nil</span>&nbsp;<span class="op" id="3236346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236350">return</span>&nbsp;<span class="builtintype" id="3236357">false</span><span class="op" id="3236362">,</span>&nbsp;<span class="ident" id="3236364">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3236369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236372">return</span>&nbsp;<span class="op" id="3236379">!</span><span class="ident" id="3236380">lessThan</span><span class="op" id="3236388">,</span>&nbsp;<span class="ident" id="3236390">nil</span><br>
<span class="lineno">430</span><span class="op" id="3236394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3236397">//&nbsp;HTML&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3236416">var</span>&nbsp;<span class="op" id="3236420">(</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236423">htmlQuot</span>&nbsp;<span class="op" id="3236432">=</span>&nbsp;<span class="op" id="3236434">[</span><span class="op" id="3236435">]</span><span class="builtintype" id="3236436">byte</span><span class="op" id="3236440">(</span><span class="string" id="3236441">&#34;&amp;#34;&#34;</span><span class="op" id="3236448">)</span>&nbsp;<span class="comment" id="3236450">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;quot;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236476">htmlApos</span>&nbsp;<span class="op" id="3236485">=</span>&nbsp;<span class="op" id="3236487">[</span><span class="op" id="3236488">]</span><span class="builtintype" id="3236489">byte</span><span class="op" id="3236493">(</span><span class="string" id="3236494">&#34;&amp;#39;&#34;</span><span class="op" id="3236501">)</span>&nbsp;<span class="comment" id="3236503">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;apos;&#34;&nbsp;and&nbsp;apos&nbsp;was&nbsp;not&nbsp;in&nbsp;HTML&nbsp;until&nbsp;HTML5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236566">htmlAmp</span>&nbsp;&nbsp;<span class="op" id="3236575">=</span>&nbsp;<span class="op" id="3236577">[</span><span class="op" id="3236578">]</span><span class="builtintype" id="3236579">byte</span><span class="op" id="3236583">(</span><span class="string" id="3236584">&#34;&amp;amp;&#34;</span><span class="op" id="3236591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236594">htmlLt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3236603">=</span>&nbsp;<span class="op" id="3236605">[</span><span class="op" id="3236606">]</span><span class="builtintype" id="3236607">byte</span><span class="op" id="3236611">(</span><span class="string" id="3236612">&#34;&amp;lt;&#34;</span><span class="op" id="3236618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236621">htmlGt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3236630">=</span>&nbsp;<span class="op" id="3236632">[</span><span class="op" id="3236633">]</span><span class="builtintype" id="3236634">byte</span><span class="op" id="3236638">(</span><span class="string" id="3236639">&#34;&amp;gt;&#34;</span><span class="op" id="3236645">)</span><br>
<span class="lineno">440</span><span class="op" id="3236647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3236650">//&nbsp;HTMLEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3236730">func</span>&nbsp;<span class="ident" id="3236735">HTMLEscape</span><span class="op" id="3236745">(</span><span class="ident" id="3236746">w</span>&nbsp;<span class="ident" id="3236748">io</span><span class="op" id="3236750">.</span><span class="ident" id="3236751">Writer</span><span class="op" id="3236757">,</span>&nbsp;<span class="ident" id="3236759">b</span>&nbsp;<span class="op" id="3236761">[</span><span class="op" id="3236762">]</span><span class="builtintype" id="3236763">byte</span><span class="op" id="3236767">)</span>&nbsp;<span class="op" id="3236769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236772">last</span>&nbsp;<span class="op" id="3236777">:=</span>&nbsp;<span class="num" id="3236780">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236783">for</span>&nbsp;<span class="ident" id="3236787">i</span><span class="op" id="3236788">,</span>&nbsp;<span class="ident" id="3236790">c</span>&nbsp;<span class="op" id="3236792">:=</span>&nbsp;<span class="keyword" id="3236795">range</span>&nbsp;<span class="ident" id="3236801">b</span>&nbsp;<span class="op" id="3236803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236807">var</span>&nbsp;<span class="ident" id="3236811">html</span>&nbsp;<span class="op" id="3236816">[</span><span class="op" id="3236817">]</span><span class="builtintype" id="3236818">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236825">switch</span>&nbsp;<span class="ident" id="3236832">c</span>&nbsp;<span class="op" id="3236834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236838">case</span>&nbsp;<span class="string" id="3236843">&#39;&#34;&#39;</span><span class="op" id="3236846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236851">html</span>&nbsp;<span class="op" id="3236856">=</span>&nbsp;<span class="ident" id="3236858">htmlQuot</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236869">case</span>&nbsp;<span class="string" id="3236874">&#39;\&#39;&#39;</span><span class="op" id="3236878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236883">html</span>&nbsp;<span class="op" id="3236888">=</span>&nbsp;<span class="ident" id="3236890">htmlApos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236901">case</span>&nbsp;<span class="string" id="3236906">&#39;&amp;&#39;</span><span class="op" id="3236909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236914">html</span>&nbsp;<span class="op" id="3236919">=</span>&nbsp;<span class="ident" id="3236921">htmlAmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236931">case</span>&nbsp;<span class="string" id="3236936">&#39;&lt;&#39;</span><span class="op" id="3236939">:</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236944">html</span>&nbsp;<span class="op" id="3236949">=</span>&nbsp;<span class="ident" id="3236951">htmlLt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236960">case</span>&nbsp;<span class="string" id="3236965">&#39;&gt;&#39;</span><span class="op" id="3236968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236973">html</span>&nbsp;<span class="op" id="3236978">=</span>&nbsp;<span class="ident" id="3236980">htmlGt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236989">default</span><span class="op" id="3236996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237001">continue</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3237012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237016">w</span><span class="op" id="3237017">.</span><span class="ident" id="3237018">Write</span><span class="op" id="3237023">(</span><span class="ident" id="3237024">b</span><span class="op" id="3237025">[</span><span class="ident" id="3237026">last</span><span class="op" id="3237030">:</span><span class="ident" id="3237031">i</span><span class="op" id="3237032">]</span><span class="op" id="3237033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237037">w</span><span class="op" id="3237038">.</span><span class="ident" id="3237039">Write</span><span class="op" id="3237044">(</span><span class="ident" id="3237045">html</span><span class="op" id="3237049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237053">last</span>&nbsp;<span class="op" id="3237058">=</span>&nbsp;<span class="ident" id="3237060">i</span>&nbsp;<span class="op" id="3237062">+</span>&nbsp;<span class="num" id="3237064">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3237067">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237070">w</span><span class="op" id="3237071">.</span><span class="ident" id="3237072">Write</span><span class="op" id="3237077">(</span><span class="ident" id="3237078">b</span><span class="op" id="3237079">[</span><span class="ident" id="3237080">last</span><span class="op" id="3237084">:</span><span class="op" id="3237085">]</span><span class="op" id="3237086">)</span><br>
<span class="lineno"></span><span class="op" id="3237088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3237091">//&nbsp;HTMLEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3237173">func</span>&nbsp;<span class="ident" id="3237178">HTMLEscapeString</span><span class="op" id="3237194">(</span><span class="ident" id="3237195">s</span>&nbsp;<span class="builtintype" id="3237197">string</span><span class="op" id="3237203">)</span>&nbsp;<span class="builtintype" id="3237205">string</span>&nbsp;<span class="op" id="3237212">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3237215">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237247">if</span>&nbsp;<span class="ident" id="3237250">strings</span><span class="op" id="3237257">.</span><span class="ident" id="3237258">IndexAny</span><span class="op" id="3237266">(</span><span class="ident" id="3237267">s</span><span class="op" id="3237268">,</span>&nbsp;<span class="string" id="3237270">`&#39;&#34;&amp;&lt;&gt;`</span><span class="op" id="3237277">)</span>&nbsp;<span class="op" id="3237279">&lt;</span>&nbsp;<span class="num" id="3237281">0</span>&nbsp;<span class="op" id="3237283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237287">return</span>&nbsp;<span class="ident" id="3237294">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3237297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237300">var</span>&nbsp;<span class="ident" id="3237304">b</span>&nbsp;<span class="ident" id="3237306">bytes</span><span class="op" id="3237311">.</span><span class="ident" id="3237312">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237320">HTMLEscape</span><span class="op" id="3237330">(</span><span class="op" id="3237331">&amp;</span><span class="ident" id="3237332">b</span><span class="op" id="3237333">,</span>&nbsp;<span class="op" id="3237335">[</span><span class="op" id="3237336">]</span><span class="builtintype" id="3237337">byte</span><span class="op" id="3237341">(</span><span class="ident" id="3237342">s</span><span class="op" id="3237343">)</span><span class="op" id="3237344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237347">return</span>&nbsp;<span class="ident" id="3237354">b</span><span class="op" id="3237355">.</span><span class="ident" id="3237356">String</span><span class="op" id="3237362">(</span><span class="op" id="3237363">)</span><br>
<span class="lineno"></span><span class="op" id="3237365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3237368">//&nbsp;HTMLEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">480</span><span class="comment" id="3237434">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3237470">func</span>&nbsp;<span class="ident" id="3237475">HTMLEscaper</span><span class="op" id="3237486">(</span><span class="ident" id="3237487">args</span>&nbsp;<span class="op" id="3237492">...</span><span class="keyword" id="3237495">interface</span><span class="op" id="3237504">{</span><span class="op" id="3237505">}</span><span class="op" id="3237506">)</span>&nbsp;<span class="builtintype" id="3237508">string</span>&nbsp;<span class="op" id="3237515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237518">return</span>&nbsp;<span class="ident" id="3237525">HTMLEscapeString</span><span class="op" id="3237541">(</span><span class="ident" id="3237542">evalArgs</span><span class="op" id="3237550">(</span><span class="ident" id="3237551">args</span><span class="op" id="3237555">)</span><span class="op" id="3237556">)</span><br>
<span class="lineno"></span><span class="op" id="3237558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="3237561">//&nbsp;JavaScript&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3237586">var</span>&nbsp;<span class="op" id="3237590">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237593">jsLowUni</span>&nbsp;<span class="op" id="3237602">=</span>&nbsp;<span class="op" id="3237604">[</span><span class="op" id="3237605">]</span><span class="builtintype" id="3237606">byte</span><span class="op" id="3237610">(</span><span class="string" id="3237611">`\u00`</span><span class="op" id="3237617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237620">hex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237629">=</span>&nbsp;<span class="op" id="3237631">[</span><span class="op" id="3237632">]</span><span class="builtintype" id="3237633">byte</span><span class="op" id="3237637">(</span><span class="string" id="3237638">&#34;0123456789ABCDEF&#34;</span><span class="op" id="3237656">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237660">jsBackslash</span>&nbsp;<span class="op" id="3237672">=</span>&nbsp;<span class="op" id="3237674">[</span><span class="op" id="3237675">]</span><span class="builtintype" id="3237676">byte</span><span class="op" id="3237680">(</span><span class="string" id="3237681">`\\`</span><span class="op" id="3237685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237688">jsApos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237700">=</span>&nbsp;<span class="op" id="3237702">[</span><span class="op" id="3237703">]</span><span class="builtintype" id="3237704">byte</span><span class="op" id="3237708">(</span><span class="string" id="3237709">`\&#39;`</span><span class="op" id="3237713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237716">jsQuot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237728">=</span>&nbsp;<span class="op" id="3237730">[</span><span class="op" id="3237731">]</span><span class="builtintype" id="3237732">byte</span><span class="op" id="3237736">(</span><span class="string" id="3237737">`\&#34;`</span><span class="op" id="3237741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237744">jsLt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237756">=</span>&nbsp;<span class="op" id="3237758">[</span><span class="op" id="3237759">]</span><span class="builtintype" id="3237760">byte</span><span class="op" id="3237764">(</span><span class="string" id="3237765">`\x3C`</span><span class="op" id="3237771">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237774">jsGt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237786">=</span>&nbsp;<span class="op" id="3237788">[</span><span class="op" id="3237789">]</span><span class="builtintype" id="3237790">byte</span><span class="op" id="3237794">(</span><span class="string" id="3237795">`\x3E`</span><span class="op" id="3237801">)</span><br>
<span class="lineno"></span><span class="op" id="3237803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3237806">//&nbsp;JSEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3237890">func</span>&nbsp;<span class="ident" id="3237895">JSEscape</span><span class="op" id="3237903">(</span><span class="ident" id="3237904">w</span>&nbsp;<span class="ident" id="3237906">io</span><span class="op" id="3237908">.</span><span class="ident" id="3237909">Writer</span><span class="op" id="3237915">,</span>&nbsp;<span class="ident" id="3237917">b</span>&nbsp;<span class="op" id="3237919">[</span><span class="op" id="3237920">]</span><span class="builtintype" id="3237921">byte</span><span class="op" id="3237925">)</span>&nbsp;<span class="op" id="3237927">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237930">last</span>&nbsp;<span class="op" id="3237935">:=</span>&nbsp;<span class="num" id="3237938">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237941">for</span>&nbsp;<span class="ident" id="3237945">i</span>&nbsp;<span class="op" id="3237947">:=</span>&nbsp;<span class="num" id="3237950">0</span><span class="op" id="3237951">;</span>&nbsp;<span class="ident" id="3237953">i</span>&nbsp;<span class="op" id="3237955">&lt;</span>&nbsp;<span class="builtinfunc" id="3237957">len</span><span class="op" id="3237960">(</span><span class="ident" id="3237961">b</span><span class="op" id="3237962">)</span><span class="op" id="3237963">;</span>&nbsp;<span class="ident" id="3237965">i</span><span class="op" id="3237966">++</span>&nbsp;<span class="op" id="3237969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3237973">c</span>&nbsp;<span class="op" id="3237975">:=</span>&nbsp;<span class="ident" id="3237978">b</span><span class="op" id="3237979">[</span><span class="ident" id="3237980">i</span><span class="op" id="3237981">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3237986">if</span>&nbsp;<span class="op" id="3237989">!</span><span class="ident" id="3237990">jsIsSpecial</span><span class="op" id="3238001">(</span><span class="builtintype" id="3238002">rune</span><span class="op" id="3238006">(</span><span class="ident" id="3238007">c</span><span class="op" id="3238008">)</span><span class="op" id="3238009">)</span>&nbsp;<span class="op" id="3238011">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238016">//&nbsp;fast&nbsp;path:&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238047">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238062">w</span><span class="op" id="3238063">.</span><span class="ident" id="3238064">Write</span><span class="op" id="3238069">(</span><span class="ident" id="3238070">b</span><span class="op" id="3238071">[</span><span class="ident" id="3238072">last</span><span class="op" id="3238076">:</span><span class="ident" id="3238077">i</span><span class="op" id="3238078">]</span><span class="op" id="3238079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238084">if</span>&nbsp;<span class="ident" id="3238087">c</span>&nbsp;<span class="op" id="3238089">&lt;</span>&nbsp;<span class="ident" id="3238091">utf8</span><span class="op" id="3238095">.</span><span class="ident" id="3238096">RuneSelf</span>&nbsp;<span class="op" id="3238105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238110">//&nbsp;Quotes,&nbsp;slashes&nbsp;and&nbsp;angle&nbsp;brackets&nbsp;get&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238163">//&nbsp;Control&nbsp;characters&nbsp;get&nbsp;written&nbsp;as&nbsp;\u00XX.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238211">switch</span>&nbsp;<span class="ident" id="3238218">c</span>&nbsp;<span class="op" id="3238220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238225">case</span>&nbsp;<span class="string" id="3238230">&#39;\\&#39;</span><span class="op" id="3238234">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238240">w</span><span class="op" id="3238241">.</span><span class="ident" id="3238242">Write</span><span class="op" id="3238247">(</span><span class="ident" id="3238248">jsBackslash</span><span class="op" id="3238259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238264">case</span>&nbsp;<span class="string" id="3238269">&#39;\&#39;&#39;</span><span class="op" id="3238273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238279">w</span><span class="op" id="3238280">.</span><span class="ident" id="3238281">Write</span><span class="op" id="3238286">(</span><span class="ident" id="3238287">jsApos</span><span class="op" id="3238293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238298">case</span>&nbsp;<span class="string" id="3238303">&#39;&#34;&#39;</span><span class="op" id="3238306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238312">w</span><span class="op" id="3238313">.</span><span class="ident" id="3238314">Write</span><span class="op" id="3238319">(</span><span class="ident" id="3238320">jsQuot</span><span class="op" id="3238326">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238331">case</span>&nbsp;<span class="string" id="3238336">&#39;&lt;&#39;</span><span class="op" id="3238339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238345">w</span><span class="op" id="3238346">.</span><span class="ident" id="3238347">Write</span><span class="op" id="3238352">(</span><span class="ident" id="3238353">jsLt</span><span class="op" id="3238357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238362">case</span>&nbsp;<span class="string" id="3238367">&#39;&gt;&#39;</span><span class="op" id="3238370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238376">w</span><span class="op" id="3238377">.</span><span class="ident" id="3238378">Write</span><span class="op" id="3238383">(</span><span class="ident" id="3238384">jsGt</span><span class="op" id="3238388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238393">default</span><span class="op" id="3238400">:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238406">w</span><span class="op" id="3238407">.</span><span class="ident" id="3238408">Write</span><span class="op" id="3238413">(</span><span class="ident" id="3238414">jsLowUni</span><span class="op" id="3238422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238428">t</span><span class="op" id="3238429">,</span>&nbsp;<span class="ident" id="3238431">b</span>&nbsp;<span class="op" id="3238433">:=</span>&nbsp;<span class="ident" id="3238436">c</span><span class="op" id="3238437">&gt;&gt;</span><span class="num" id="3238439">4</span><span class="op" id="3238440">,</span>&nbsp;<span class="ident" id="3238442">c</span><span class="op" id="3238443">&amp;</span><span class="num" id="3238444">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238453">w</span><span class="op" id="3238454">.</span><span class="ident" id="3238455">Write</span><span class="op" id="3238460">(</span><span class="ident" id="3238461">hex</span><span class="op" id="3238464">[</span><span class="ident" id="3238465">t</span>&nbsp;<span class="op" id="3238467">:</span>&nbsp;<span class="ident" id="3238469">t</span><span class="op" id="3238470">+</span><span class="num" id="3238471">1</span><span class="op" id="3238472">]</span><span class="op" id="3238473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238479">w</span><span class="op" id="3238480">.</span><span class="ident" id="3238481">Write</span><span class="op" id="3238486">(</span><span class="ident" id="3238487">hex</span><span class="op" id="3238490">[</span><span class="ident" id="3238491">b</span>&nbsp;<span class="op" id="3238493">:</span>&nbsp;<span class="ident" id="3238495">b</span><span class="op" id="3238496">+</span><span class="num" id="3238497">1</span><span class="op" id="3238498">]</span><span class="op" id="3238499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238504">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238508">}</span>&nbsp;<span class="keyword" id="3238510">else</span>&nbsp;<span class="op" id="3238515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238520">//&nbsp;Unicode&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238540">r</span><span class="op" id="3238541">,</span>&nbsp;<span class="ident" id="3238543">size</span>&nbsp;<span class="op" id="3238548">:=</span>&nbsp;<span class="ident" id="3238551">utf8</span><span class="op" id="3238555">.</span><span class="ident" id="3238556">DecodeRune</span><span class="op" id="3238566">(</span><span class="ident" id="3238567">b</span><span class="op" id="3238568">[</span><span class="ident" id="3238569">i</span><span class="op" id="3238570">:</span><span class="op" id="3238571">]</span><span class="op" id="3238572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238577">if</span>&nbsp;<span class="ident" id="3238580">unicode</span><span class="op" id="3238587">.</span><span class="ident" id="3238588">IsPrint</span><span class="op" id="3238595">(</span><span class="ident" id="3238596">r</span><span class="op" id="3238597">)</span>&nbsp;<span class="op" id="3238599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238605">w</span><span class="op" id="3238606">.</span><span class="ident" id="3238607">Write</span><span class="op" id="3238612">(</span><span class="ident" id="3238613">b</span><span class="op" id="3238614">[</span><span class="ident" id="3238615">i</span>&nbsp;<span class="op" id="3238617">:</span>&nbsp;<span class="ident" id="3238619">i</span><span class="op" id="3238620">+</span><span class="ident" id="3238621">size</span><span class="op" id="3238625">]</span><span class="op" id="3238626">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238631">}</span>&nbsp;<span class="keyword" id="3238633">else</span>&nbsp;<span class="op" id="3238638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238644">fmt</span><span class="op" id="3238647">.</span><span class="ident" id="3238648">Fprintf</span><span class="op" id="3238655">(</span><span class="ident" id="3238656">w</span><span class="op" id="3238657">,</span>&nbsp;<span class="string" id="3238659">&#34;\\u%04X&#34;</span><span class="op" id="3238668">,</span>&nbsp;<span class="ident" id="3238670">r</span><span class="op" id="3238671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238681">i</span>&nbsp;<span class="op" id="3238683">+=</span>&nbsp;<span class="ident" id="3238686">size</span>&nbsp;<span class="op" id="3238691">-</span>&nbsp;<span class="num" id="3238693">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238697">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238701">last</span>&nbsp;<span class="op" id="3238706">=</span>&nbsp;<span class="ident" id="3238708">i</span>&nbsp;<span class="op" id="3238710">+</span>&nbsp;<span class="num" id="3238712">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238718">w</span><span class="op" id="3238719">.</span><span class="ident" id="3238720">Write</span><span class="op" id="3238725">(</span><span class="ident" id="3238726">b</span><span class="op" id="3238727">[</span><span class="ident" id="3238728">last</span><span class="op" id="3238732">:</span><span class="op" id="3238733">]</span><span class="op" id="3238734">)</span><br>
<span class="lineno"></span><span class="op" id="3238736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="3238739">//&nbsp;JSEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3238825">func</span>&nbsp;<span class="ident" id="3238830">JSEscapeString</span><span class="op" id="3238844">(</span><span class="ident" id="3238845">s</span>&nbsp;<span class="builtintype" id="3238847">string</span><span class="op" id="3238853">)</span>&nbsp;<span class="builtintype" id="3238855">string</span>&nbsp;<span class="op" id="3238862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3238865">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238897">if</span>&nbsp;<span class="ident" id="3238900">strings</span><span class="op" id="3238907">.</span><span class="ident" id="3238908">IndexFunc</span><span class="op" id="3238917">(</span><span class="ident" id="3238918">s</span><span class="op" id="3238919">,</span>&nbsp;<span class="ident" id="3238921">jsIsSpecial</span><span class="op" id="3238932">)</span>&nbsp;<span class="op" id="3238934">&lt;</span>&nbsp;<span class="num" id="3238936">0</span>&nbsp;<span class="op" id="3238938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238942">return</span>&nbsp;<span class="ident" id="3238949">s</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3238952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3238955">var</span>&nbsp;<span class="ident" id="3238959">b</span>&nbsp;<span class="ident" id="3238961">bytes</span><span class="op" id="3238966">.</span><span class="ident" id="3238967">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3238975">JSEscape</span><span class="op" id="3238983">(</span><span class="op" id="3238984">&amp;</span><span class="ident" id="3238985">b</span><span class="op" id="3238986">,</span>&nbsp;<span class="op" id="3238988">[</span><span class="op" id="3238989">]</span><span class="builtintype" id="3238990">byte</span><span class="op" id="3238994">(</span><span class="ident" id="3238995">s</span><span class="op" id="3238996">)</span><span class="op" id="3238997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239000">return</span>&nbsp;<span class="ident" id="3239007">b</span><span class="op" id="3239008">.</span><span class="ident" id="3239009">String</span><span class="op" id="3239015">(</span><span class="op" id="3239016">)</span><br>
<span class="lineno"></span><span class="op" id="3239018">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="3239021">func</span>&nbsp;<span class="ident" id="3239026">jsIsSpecial</span><span class="op" id="3239037">(</span><span class="ident" id="3239038">r</span>&nbsp;<span class="builtintype" id="3239040">rune</span><span class="op" id="3239044">)</span>&nbsp;<span class="builtintype" id="3239046">bool</span>&nbsp;<span class="op" id="3239051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239054">switch</span>&nbsp;<span class="ident" id="3239061">r</span>&nbsp;<span class="op" id="3239063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239066">case</span>&nbsp;<span class="string" id="3239071">&#39;\\&#39;</span><span class="op" id="3239075">,</span>&nbsp;<span class="string" id="3239077">&#39;\&#39;&#39;</span><span class="op" id="3239081">,</span>&nbsp;<span class="string" id="3239083">&#39;&#34;&#39;</span><span class="op" id="3239086">,</span>&nbsp;<span class="string" id="3239088">&#39;&lt;&#39;</span><span class="op" id="3239091">,</span>&nbsp;<span class="string" id="3239093">&#39;&gt;&#39;</span><span class="op" id="3239096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239100">return</span>&nbsp;<span class="builtintype" id="3239107">true</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3239113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239116">return</span>&nbsp;<span class="ident" id="3239123">r</span>&nbsp;<span class="op" id="3239125">&lt;</span>&nbsp;<span class="string" id="3239127">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3239131">||</span>&nbsp;<span class="ident" id="3239134">utf8</span><span class="op" id="3239138">.</span><span class="ident" id="3239139">RuneSelf</span>&nbsp;<span class="op" id="3239148">&lt;=</span>&nbsp;<span class="ident" id="3239151">r</span><br>
<span class="lineno"></span><span class="op" id="3239153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3239156">//&nbsp;JSEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">565</span><span class="comment" id="3239226">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3239262">func</span>&nbsp;<span class="ident" id="3239267">JSEscaper</span><span class="op" id="3239276">(</span><span class="ident" id="3239277">args</span>&nbsp;<span class="op" id="3239282">...</span><span class="keyword" id="3239285">interface</span><span class="op" id="3239294">{</span><span class="op" id="3239295">}</span><span class="op" id="3239296">)</span>&nbsp;<span class="builtintype" id="3239298">string</span>&nbsp;<span class="op" id="3239305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239308">return</span>&nbsp;<span class="ident" id="3239315">JSEscapeString</span><span class="op" id="3239329">(</span><span class="ident" id="3239330">evalArgs</span><span class="op" id="3239338">(</span><span class="ident" id="3239339">args</span><span class="op" id="3239343">)</span><span class="op" id="3239344">)</span><br>
<span class="lineno"></span><span class="op" id="3239346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="comment" id="3239349">//&nbsp;URLQueryEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;value&nbsp;of&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3239427">//&nbsp;its&nbsp;arguments&nbsp;in&nbsp;a&nbsp;form&nbsp;suitable&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;URL&nbsp;query.</span><br>
<span class="lineno"></span><span class="keyword" id="3239493">func</span>&nbsp;<span class="ident" id="3239498">URLQueryEscaper</span><span class="op" id="3239513">(</span><span class="ident" id="3239514">args</span>&nbsp;<span class="op" id="3239519">...</span><span class="keyword" id="3239522">interface</span><span class="op" id="3239531">{</span><span class="op" id="3239532">}</span><span class="op" id="3239533">)</span>&nbsp;<span class="builtintype" id="3239535">string</span>&nbsp;<span class="op" id="3239542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239545">return</span>&nbsp;<span class="ident" id="3239552">url</span><span class="op" id="3239555">.</span><span class="ident" id="3239556">QueryEscape</span><span class="op" id="3239567">(</span><span class="ident" id="3239568">evalArgs</span><span class="op" id="3239576">(</span><span class="ident" id="3239577">args</span><span class="op" id="3239581">)</span><span class="op" id="3239582">)</span><br>
<span class="lineno"></span><span class="op" id="3239584">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3239587">//&nbsp;evalArgs&nbsp;formats&nbsp;the&nbsp;list&nbsp;of&nbsp;arguments&nbsp;into&nbsp;a&nbsp;string.&nbsp;It&nbsp;is&nbsp;therefore&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3239674">//&nbsp;&nbsp;&nbsp;&nbspfmt.Sprint(args...)</span><br>
<span class="lineno"></span><span class="comment" id="3239697">//&nbsp;except&nbsp;that&nbsp;each&nbsp;argument&nbsp;is&nbsp;indirected&nbsp;(if&nbsp;a&nbsp;pointer),&nbsp;as&nbsp;required,</span><br>
<span class="lineno"></span><span class="comment" id="3239769">//&nbsp;using&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;the&nbsp;default&nbsp;string&nbsp;evaluation&nbsp;during&nbsp;template</span><br>
<span class="lineno">580</span><span class="comment" id="3239842">//&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="3239856">func</span>&nbsp;<span class="ident" id="3239861">evalArgs</span><span class="op" id="3239869">(</span><span class="ident" id="3239870">args</span>&nbsp;<span class="op" id="3239875">[</span><span class="op" id="3239876">]</span><span class="keyword" id="3239877">interface</span><span class="op" id="3239886">{</span><span class="op" id="3239887">}</span><span class="op" id="3239888">)</span>&nbsp;<span class="builtintype" id="3239890">string</span>&nbsp;<span class="op" id="3239897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3239900">ok</span>&nbsp;<span class="op" id="3239903">:=</span>&nbsp;<span class="builtintype" id="3239906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239913">var</span>&nbsp;<span class="ident" id="3239917">s</span>&nbsp;<span class="builtintype" id="3239919">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3239927">//&nbsp;Fast&nbsp;path&nbsp;for&nbsp;simple&nbsp;common&nbsp;case.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3239965">if</span>&nbsp;<span class="builtinfunc" id="3239968">len</span><span class="op" id="3239971">(</span><span class="ident" id="3239972">args</span><span class="op" id="3239976">)</span>&nbsp;<span class="op" id="3239978">==</span>&nbsp;<span class="num" id="3239981">1</span>&nbsp;<span class="op" id="3239983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3239987">s</span><span class="op" id="3239988">,</span>&nbsp;<span class="ident" id="3239990">ok</span>&nbsp;<span class="op" id="3239993">=</span>&nbsp;<span class="ident" id="3239995">args</span><span class="op" id="3239999">[</span><span class="num" id="3240000">0</span><span class="op" id="3240001">]</span><span class="op" id="3240002">.</span><span class="op" id="3240003">(</span><span class="builtintype" id="3240004">string</span><span class="op" id="3240010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240016">if</span>&nbsp;<span class="op" id="3240019">!</span><span class="ident" id="3240020">ok</span>&nbsp;<span class="op" id="3240023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240027">for</span>&nbsp;<span class="ident" id="3240031">i</span><span class="op" id="3240032">,</span>&nbsp;<span class="ident" id="3240034">arg</span>&nbsp;<span class="op" id="3240038">:=</span>&nbsp;<span class="keyword" id="3240041">range</span>&nbsp;<span class="ident" id="3240047">args</span>&nbsp;<span class="op" id="3240052">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240057">a</span><span class="op" id="3240058">,</span>&nbsp;<span class="ident" id="3240060">ok</span>&nbsp;<span class="op" id="3240063">:=</span>&nbsp;<span class="ident" id="3240066">printableValue</span><span class="op" id="3240080">(</span><span class="ident" id="3240081">reflect</span><span class="op" id="3240088">.</span><span class="ident" id="3240089">ValueOf</span><span class="op" id="3240096">(</span><span class="ident" id="3240097">arg</span><span class="op" id="3240100">)</span><span class="op" id="3240101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240106">if</span>&nbsp;<span class="ident" id="3240109">ok</span>&nbsp;<span class="op" id="3240112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240118">args</span><span class="op" id="3240122">[</span><span class="ident" id="3240123">i</span><span class="op" id="3240124">]</span>&nbsp;<span class="op" id="3240126">=</span>&nbsp;<span class="ident" id="3240128">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240133">}</span>&nbsp;<span class="comment" id="3240135">//&nbsp;else&nbsp;left&nbsp;fmt&nbsp;do&nbsp;its&nbsp;thing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240167">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3240171">s</span>&nbsp;<span class="op" id="3240173">=</span>&nbsp;<span class="ident" id="3240175">fmt</span><span class="op" id="3240178">.</span><span class="ident" id="3240179">Sprint</span><span class="op" id="3240185">(</span><span class="ident" id="3240186">args</span><span class="op" id="3240190">...</span><span class="op" id="3240193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3240196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3240199">return</span>&nbsp;<span class="ident" id="3240206">s</span><br>
<span class="lineno"></span><span class="op" id="3240208">}</span>
</div>
</body>
</html>
