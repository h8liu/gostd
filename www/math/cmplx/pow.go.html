<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5555672">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5555727">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5555781">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5555832">package</span>&nbsp;<span class="ident" id="5555840">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5555847">import</span>&nbsp;<span class="string" id="5555854">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555862">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5555922">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5555992">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5556050">//</span><br>
<span class="lineno"></span><span class="comment" id="5556053">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5556101">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5556165">//</span><br>
<span class="lineno"></span><span class="comment" id="5556168">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5556229">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5556299">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5556374">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5556441">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5556514">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5556586">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5556600">//</span><br>
<span class="lineno"></span><span class="comment" id="5556603">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5556669">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5556735">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5556748">//</span><br>
<span class="lineno"></span><span class="comment" id="5556751">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5556775">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5556805">//&nbsp;Complex&nbsp;power&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="5556831">//</span><br>
<span class="lineno"></span><span class="comment" id="5556834">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5556850">//</span><br>
<span class="lineno">35</span><span class="comment" id="5556853">//&nbsp;Raises&nbsp;complex&nbsp;A&nbsp;to&nbsp;the&nbsp;complex&nbsp;Zth&nbsp;power.</span><br>
<span class="lineno"></span><span class="comment" id="5556899">//&nbsp;Definition&nbsp;is&nbsp;per&nbsp;AMS55&nbsp;#&nbsp;4.2.8,</span><br>
<span class="lineno"></span><span class="comment" id="5556935">//&nbsp;analytically&nbsp;equivalent&nbsp;to&nbsp;cpow(a,z)&nbsp;=&nbsp;cexp(z&nbsp;clog(a)).</span><br>
<span class="lineno"></span><span class="comment" id="5556994">//</span><br>
<span class="lineno"></span><span class="comment" id="5556997">//&nbsp;ACCURACY:</span><br>
<span class="lineno">40</span><span class="comment" id="5557010">//</span><br>
<span class="lineno"></span><span class="comment" id="5557013">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5557053">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5557111">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5557172">//&nbsp;Pow&nbsp;returns&nbsp;x**y,&nbsp;the&nbsp;base-x&nbsp;exponential&nbsp;of&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5557222">//&nbsp;For&nbsp;generalized&nbsp;compatibility&nbsp;with&nbsp;math.Pow:</span><br>
<span class="lineno"></span><span class="comment" id="5557270">//&nbsp;&nbsp;&nbsp;&nbspPow(0,&nbsp;Â±0)&nbsp;returns&nbsp;1+0i</span><br>
<span class="lineno"></span><span class="comment" id="5557298">//&nbsp;&nbsp;&nbsp;&nbspPow(0,&nbsp;c)&nbsp;for&nbsp;real(c)&lt;0&nbsp;returns&nbsp;Inf+0i&nbsp;if&nbsp;imag(c)&nbsp;is&nbsp;zero,&nbsp;otherwise&nbsp;Inf+Inf&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="5557381">func</span>&nbsp;<span class="ident" id="5557386">Pow</span><span class="op" id="5557389">(</span><span class="ident" id="5557390">x</span><span class="op" id="5557391">,</span>&nbsp;<span class="ident" id="5557393">y</span>&nbsp;<span class="builtintype" id="5557395">complex128</span><span class="op" id="5557405">)</span>&nbsp;<span class="builtintype" id="5557407">complex128</span>&nbsp;<span class="op" id="5557418">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557421">if</span>&nbsp;<span class="ident" id="5557424"><a href="/math/cmplx/pow.go.html#5557390">x</a></span>&nbsp;<span class="op" id="5557426">==</span>&nbsp;<span class="num" id="5557429">0</span>&nbsp;<span class="op" id="5557431">{</span>&nbsp;<span class="comment" id="5557433">//&nbsp;Guaranteed&nbsp;also&nbsp;true&nbsp;for&nbsp;x&nbsp;==&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557472">r</span><span class="op" id="5557473">,</span>&nbsp;<span class="ident" id="5557475">i</span>&nbsp;<span class="op" id="5557477">:=</span>&nbsp;<span class="builtinfunc" id="5557480">real</span><span class="op" id="5557484">(</span><span class="ident" id="5557485"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557486">)</span><span class="op" id="5557487">,</span>&nbsp;<span class="builtinfunc" id="5557489">imag</span><span class="op" id="5557493">(</span><span class="ident" id="5557494"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557499">switch</span>&nbsp;<span class="op" id="5557506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557510">case</span>&nbsp;<span class="ident" id="5557515"><a href="/math/cmplx/pow.go.html#5557472">r</a></span>&nbsp;<span class="op" id="5557517">==</span>&nbsp;<span class="num" id="5557520">0</span><span class="op" id="5557521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557526">return</span>&nbsp;<span class="num" id="5557533">1</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557537">case</span>&nbsp;<span class="ident" id="5557542"><a href="/math/cmplx/pow.go.html#5557472">r</a></span>&nbsp;<span class="op" id="5557544">&lt;</span>&nbsp;<span class="num" id="5557546">0</span><span class="op" id="5557547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557552">if</span>&nbsp;<span class="ident" id="5557555"><a href="/math/cmplx/pow.go.html#5557475">i</a></span>&nbsp;<span class="op" id="5557557">==</span>&nbsp;<span class="num" id="5557560">0</span>&nbsp;<span class="op" id="5557562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557568">return</span>&nbsp;<span class="builtinfunc" id="5557575">complex</span><span class="op" id="5557582">(</span><span class="ident" id="5557583"><a href="/math/cmplx/pow.go.html#5555854">math</a></span><span class="op" id="5557587">.</span><span class="ident" id="5557588">Inf</span><span class="op" id="5557591">(</span><span class="num" id="5557592">1</span><span class="op" id="5557593">)</span><span class="op" id="5557594">,</span>&nbsp;<span class="num" id="5557596">0</span><span class="op" id="5557597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557607">return</span>&nbsp;<span class="ident" id="5557614"><a href="/math/cmplx/isinf.go.html#5552219">Inf</a></span><span class="op" id="5557617">(</span><span class="op" id="5557618">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557622">case</span>&nbsp;<span class="ident" id="5557627"><a href="/math/cmplx/pow.go.html#5557472">r</a></span>&nbsp;<span class="op" id="5557629">&gt;</span>&nbsp;<span class="num" id="5557631">0</span><span class="op" id="5557632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557637">return</span>&nbsp;<span class="num" id="5557644">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5557652">panic</span><span class="op" id="5557657">(</span><span class="string" id="5557658">&#34;not&nbsp;reached&#34;</span><span class="op" id="5557671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557674">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557677">modulus</span>&nbsp;<span class="op" id="5557685">:=</span>&nbsp;<span class="ident" id="5557688"><a href="/math/cmplx/abs.go.html#5545036">Abs</a></span><span class="op" id="5557691">(</span><span class="ident" id="5557692"><a href="/math/cmplx/pow.go.html#5557390">x</a></span><span class="op" id="5557693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557696">if</span>&nbsp;<span class="ident" id="5557699"><a href="/math/cmplx/pow.go.html#5557677">modulus</a></span>&nbsp;<span class="op" id="5557707">==</span>&nbsp;<span class="num" id="5557710">0</span>&nbsp;<span class="op" id="5557712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557716">return</span>&nbsp;<span class="builtinfunc" id="5557723">complex</span><span class="op" id="5557730">(</span><span class="num" id="5557731">0</span><span class="op" id="5557732">,</span>&nbsp;<span class="num" id="5557734">0</span><span class="op" id="5557735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557741">r</span>&nbsp;<span class="op" id="5557743">:=</span>&nbsp;<span class="ident" id="5557746"><a href="/math/cmplx/pow.go.html#5555854">math</a></span><span class="op" id="5557750">.</span><span class="ident" id="5557751">Pow</span><span class="op" id="5557754">(</span><span class="ident" id="5557755"><a href="/math/cmplx/pow.go.html#5557677">modulus</a></span><span class="op" id="5557762">,</span>&nbsp;<span class="builtinfunc" id="5557764">real</span><span class="op" id="5557768">(</span><span class="ident" id="5557769"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557770">)</span><span class="op" id="5557771">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557774">arg</span>&nbsp;<span class="op" id="5557778">:=</span>&nbsp;<span class="ident" id="5557781"><a href="/math/cmplx/phase.go.html#5555231">Phase</a></span><span class="op" id="5557786">(</span><span class="ident" id="5557787"><a href="/math/cmplx/pow.go.html#5557390">x</a></span><span class="op" id="5557788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557791">theta</span>&nbsp;<span class="op" id="5557797">:=</span>&nbsp;<span class="builtinfunc" id="5557800">real</span><span class="op" id="5557804">(</span><span class="ident" id="5557805"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557806">)</span>&nbsp;<span class="op" id="5557808">*</span>&nbsp;<span class="ident" id="5557810"><a href="/math/cmplx/pow.go.html#5557774">arg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557815">if</span>&nbsp;<span class="builtinfunc" id="5557818">imag</span><span class="op" id="5557822">(</span><span class="ident" id="5557823"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557824">)</span>&nbsp;<span class="op" id="5557826">!=</span>&nbsp;<span class="num" id="5557829">0</span>&nbsp;<span class="op" id="5557831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557835"><a href="/math/cmplx/pow.go.html#5557741">r</a></span>&nbsp;<span class="op" id="5557837">*=</span>&nbsp;<span class="ident" id="5557840"><a href="/math/cmplx/pow.go.html#5555854">math</a></span><span class="op" id="5557844">.</span><span class="ident" id="5557845">Exp</span><span class="op" id="5557848">(</span><span class="op" id="5557849">-</span><span class="builtinfunc" id="5557850">imag</span><span class="op" id="5557854">(</span><span class="ident" id="5557855"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557856">)</span>&nbsp;<span class="op" id="5557858">*</span>&nbsp;<span class="ident" id="5557860"><a href="/math/cmplx/pow.go.html#5557774">arg</a></span><span class="op" id="5557863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557867"><a href="/math/cmplx/pow.go.html#5557791">theta</a></span>&nbsp;<span class="op" id="5557873">+=</span>&nbsp;<span class="builtinfunc" id="5557876">imag</span><span class="op" id="5557880">(</span><span class="ident" id="5557881"><a href="/math/cmplx/pow.go.html#5557393">y</a></span><span class="op" id="5557882">)</span>&nbsp;<span class="op" id="5557884">*</span>&nbsp;<span class="ident" id="5557886"><a href="/math/cmplx/pow.go.html#5555854">math</a></span><span class="op" id="5557890">.</span><span class="ident" id="5557891">Log</span><span class="op" id="5557894">(</span><span class="ident" id="5557895"><a href="/math/cmplx/pow.go.html#5557677">modulus</a></span><span class="op" id="5557902">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557908">s</span><span class="op" id="5557909">,</span>&nbsp;<span class="ident" id="5557911">c</span>&nbsp;<span class="op" id="5557913">:=</span>&nbsp;<span class="ident" id="5557916"><a href="/math/cmplx/pow.go.html#5555854">math</a></span><span class="op" id="5557920">.</span><span class="ident" id="5557921">Sincos</span><span class="op" id="5557927">(</span><span class="ident" id="5557928"><a href="/math/cmplx/pow.go.html#5557791">theta</a></span><span class="op" id="5557933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557936">return</span>&nbsp;<span class="builtinfunc" id="5557943">complex</span><span class="op" id="5557950">(</span><span class="ident" id="5557951"><a href="/math/cmplx/pow.go.html#5557741">r</a></span><span class="op" id="5557952">*</span><span class="ident" id="5557953"><a href="/math/cmplx/pow.go.html#5557911">c</a></span><span class="op" id="5557954">,</span>&nbsp;<span class="ident" id="5557956"><a href="/math/cmplx/pow.go.html#5557741">r</a></span><span class="op" id="5557957">*</span><span class="ident" id="5557958"><a href="/math/cmplx/pow.go.html#5557908">s</a></span><span class="op" id="5557959">)</span><br>
<span class="lineno"></span><span class="op" id="5557961">}</span>
</div>
</body>
</html>
