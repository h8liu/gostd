<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/lzw</h2>
<ul>
<li><a href="/gostd/compress/lzw/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/lzw/reader_test.go.html" class="current">reader_test.go</a></li>
<li><a href="/gostd/compress/lzw/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/lzw/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8004495">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8004550">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8004604">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8004655">package</span>&nbsp;<span class="ident" id="8004663">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8004668">import</span>&nbsp;<span class="op" id="8004675">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004678">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004687">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004693">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004706">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004717">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004728">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004739">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8004749">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8004752">type</span>&nbsp;<span class="ident" id="8004757">lzwTest</span>&nbsp;<span class="keyword" id="8004765">struct</span>&nbsp;<span class="op" id="8004772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004775">desc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8004786">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004794">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8004805">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004813">compressed</span>&nbsp;<span class="builtintype" id="8004824">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004832">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8004843">error</span><br>
<span class="lineno"></span><span class="op" id="8004849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8004852">var</span>&nbsp;<span class="ident" id="8004856">lzwTests</span>&nbsp;<span class="op" id="8004865">=</span>&nbsp;<span class="op" id="8004867">[</span><span class="op" id="8004868">]</span><span class="ident" id="8004869">lzwTest</span><span class="op" id="8004876">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004883">&#34;empty;LSB;8&#34;</span><span class="op" id="8004896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004900">&#34;&#34;</span><span class="op" id="8004902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004906">&#34;\x01\x01&#34;</span><span class="op" id="8004916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004920">nil</span><span class="op" id="8004923">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004926">}</span><span class="op" id="8004927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004934">&#34;empty;MSB;8&#34;</span><span class="op" id="8004947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004951">&#34;&#34;</span><span class="op" id="8004953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004957">&#34;\x80\x80&#34;</span><span class="op" id="8004967">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004971">nil</span><span class="op" id="8004974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004977">}</span><span class="op" id="8004978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8004985">&#34;tobe;LSB;7&#34;</span><span class="op" id="8004997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005001">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="8005027">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005031">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="8005101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005105">nil</span><span class="op" id="8005108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005111">}</span><span class="op" id="8005112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005119">&#34;tobe;LSB;8&#34;</span><span class="op" id="8005131">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005135">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="8005161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005165">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04\x12\x34\xb8\xb0\xe0\xc1\x84\x01\x01&#34;</span><span class="op" id="8005247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005251">nil</span><span class="op" id="8005254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005257">}</span><span class="op" id="8005258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005261">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005265">&#34;tobe;MSB;7&#34;</span><span class="op" id="8005277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005281">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="8005307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005311">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="8005381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005385">nil</span><span class="op" id="8005388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005391">}</span><span class="op" id="8005392">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005399">&#34;tobe;MSB;8&#34;</span><span class="op" id="8005411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005415">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="8005441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005445">&#34;\x2a\x13\xc8\x44\x52\x79\x48\x9c\x4f\x2a\x40\xa0\x90\x68\x5c\x16\x0f\x09\x80\x80&#34;</span><span class="op" id="8005527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005531">nil</span><span class="op" id="8005534">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005537">}</span><span class="op" id="8005538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005545">&#34;tobe-truncated;LSB;8&#34;</span><span class="op" id="8005567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005571">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="8005597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005601">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04&#34;</span><span class="op" id="8005647">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005651">io</span><span class="op" id="8005653">.</span><span class="ident" id="8005654">ErrUnexpectedEOF</span><span class="op" id="8005670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005673">}</span><span class="op" id="8005674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8005677">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://en.wikipedia.org/wiki/Graphics_Interchange_Format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005767">&#34;gif;LSB;8&#34;</span><span class="op" id="8005778">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005782">&#34;\x28\xff\xff\xff\x28\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&#34;</span><span class="op" id="8005844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005848">&#34;\x00\x51\xfc\x1b\x28\x70\xa0\xc1\x83\x01\x01&#34;</span><span class="op" id="8005894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005898">nil</span><span class="op" id="8005901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005904">}</span><span class="op" id="8005905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8005908">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://compgroups.net/comp.lang.ruby/Decompressing-LZW-compression-from-PDF-file</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8006021">&#34;pdf;MSB;8&#34;</span><span class="op" id="8006032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8006036">&#34;-----A---B&#34;</span><span class="op" id="8006048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8006052">&#34;\x80\x0b\x60\x50\x22\x0c\x0c\x85\x01&#34;</span><span class="op" id="8006090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006094">nil</span><span class="op" id="8006097">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006100">}</span><span class="op" id="8006101">,</span><br>
<span class="lineno"></span><span class="op" id="8006103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8006106">func</span>&nbsp;<span class="ident" id="8006111">TestReader</span><span class="op" id="8006121">(</span><span class="ident" id="8006122">t</span>&nbsp;<span class="op" id="8006124">*</span><span class="ident" id="8006125">testing</span><span class="op" id="8006132">.</span><span class="ident" id="8006133">T</span><span class="op" id="8006134">)</span>&nbsp;<span class="op" id="8006136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006139">var</span>&nbsp;<span class="ident" id="8006143">b</span>&nbsp;<span class="ident" id="8006145">bytes</span><span class="op" id="8006150">.</span><span class="ident" id="8006151">Buffer</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006159">for</span>&nbsp;<span class="ident" id="8006163">_</span><span class="op" id="8006164">,</span>&nbsp;<span class="ident" id="8006166">tt</span>&nbsp;<span class="op" id="8006169">:=</span>&nbsp;<span class="keyword" id="8006172">range</span>&nbsp;<span class="ident" id="8006178">lzwTests</span>&nbsp;<span class="op" id="8006187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006191">d</span>&nbsp;<span class="op" id="8006193">:=</span>&nbsp;<span class="ident" id="8006196">strings</span><span class="op" id="8006203">.</span><span class="ident" id="8006204">Split</span><span class="op" id="8006209">(</span><span class="ident" id="8006210">tt</span><span class="op" id="8006212">.</span><span class="ident" id="8006213">desc</span><span class="op" id="8006217">,</span>&nbsp;<span class="string" id="8006219">&#34;;&#34;</span><span class="op" id="8006222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006226">var</span>&nbsp;<span class="ident" id="8006230">order</span>&nbsp;<span class="ident" id="8006236">Order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006244">switch</span>&nbsp;<span class="ident" id="8006251">d</span><span class="op" id="8006252">[</span><span class="num" id="8006253">1</span><span class="op" id="8006254">]</span>&nbsp;<span class="op" id="8006256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006260">case</span>&nbsp;<span class="string" id="8006265">&#34;LSB&#34;</span><span class="op" id="8006270">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006275">order</span>&nbsp;<span class="op" id="8006281">=</span>&nbsp;<span class="ident" id="8006283">LSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006289">case</span>&nbsp;<span class="string" id="8006294">&#34;MSB&#34;</span><span class="op" id="8006299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006304">order</span>&nbsp;<span class="op" id="8006310">=</span>&nbsp;<span class="ident" id="8006312">MSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006318">default</span><span class="op" id="8006325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006330">t</span><span class="op" id="8006331">.</span><span class="ident" id="8006332">Errorf</span><span class="op" id="8006338">(</span><span class="string" id="8006339">&#34;%s:&nbsp;bad&nbsp;order&nbsp;%q&#34;</span><span class="op" id="8006357">,</span>&nbsp;<span class="ident" id="8006359">tt</span><span class="op" id="8006361">.</span><span class="ident" id="8006362">desc</span><span class="op" id="8006366">,</span>&nbsp;<span class="ident" id="8006368">d</span><span class="op" id="8006369">[</span><span class="num" id="8006370">1</span><span class="op" id="8006371">]</span><span class="op" id="8006372">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006380">litWidth</span><span class="op" id="8006388">,</span>&nbsp;<span class="ident" id="8006390">_</span>&nbsp;<span class="op" id="8006392">:=</span>&nbsp;<span class="ident" id="8006395">strconv</span><span class="op" id="8006402">.</span><span class="ident" id="8006403">Atoi</span><span class="op" id="8006407">(</span><span class="ident" id="8006408">d</span><span class="op" id="8006409">[</span><span class="num" id="8006410">2</span><span class="op" id="8006411">]</span><span class="op" id="8006412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006416">rc</span>&nbsp;<span class="op" id="8006419">:=</span>&nbsp;<span class="ident" id="8006422">NewReader</span><span class="op" id="8006431">(</span><span class="ident" id="8006432">strings</span><span class="op" id="8006439">.</span><span class="ident" id="8006440">NewReader</span><span class="op" id="8006449">(</span><span class="ident" id="8006450">tt</span><span class="op" id="8006452">.</span><span class="ident" id="8006453">compressed</span><span class="op" id="8006463">)</span><span class="op" id="8006464">,</span>&nbsp;<span class="ident" id="8006466">order</span><span class="op" id="8006471">,</span>&nbsp;<span class="ident" id="8006473">litWidth</span><span class="op" id="8006481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006485">defer</span>&nbsp;<span class="ident" id="8006491">rc</span><span class="op" id="8006493">.</span><span class="ident" id="8006494">Close</span><span class="op" id="8006499">(</span><span class="op" id="8006500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006504">b</span><span class="op" id="8006505">.</span><span class="ident" id="8006506">Reset</span><span class="op" id="8006511">(</span><span class="op" id="8006512">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006516">n</span><span class="op" id="8006517">,</span>&nbsp;<span class="ident" id="8006519">err</span>&nbsp;<span class="op" id="8006523">:=</span>&nbsp;<span class="ident" id="8006526">io</span><span class="op" id="8006528">.</span><span class="ident" id="8006529">Copy</span><span class="op" id="8006533">(</span><span class="op" id="8006534">&amp;</span><span class="ident" id="8006535">b</span><span class="op" id="8006536">,</span>&nbsp;<span class="ident" id="8006538">rc</span><span class="op" id="8006540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006544">if</span>&nbsp;<span class="ident" id="8006547">err</span>&nbsp;<span class="op" id="8006551">!=</span>&nbsp;<span class="ident" id="8006554">nil</span>&nbsp;<span class="op" id="8006558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006563">if</span>&nbsp;<span class="ident" id="8006566">err</span>&nbsp;<span class="op" id="8006570">!=</span>&nbsp;<span class="ident" id="8006573">tt</span><span class="op" id="8006575">.</span><span class="ident" id="8006576">err</span>&nbsp;<span class="op" id="8006580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006586">t</span><span class="op" id="8006587">.</span><span class="ident" id="8006588">Errorf</span><span class="op" id="8006594">(</span><span class="string" id="8006595">&#34;%s:&nbsp;io.Copy:&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8006620">,</span>&nbsp;<span class="ident" id="8006622">tt</span><span class="op" id="8006624">.</span><span class="ident" id="8006625">desc</span><span class="op" id="8006629">,</span>&nbsp;<span class="ident" id="8006631">err</span><span class="op" id="8006634">,</span>&nbsp;<span class="ident" id="8006636">tt</span><span class="op" id="8006638">.</span><span class="ident" id="8006639">err</span><span class="op" id="8006642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006647">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006652">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006667">s</span>&nbsp;<span class="op" id="8006669">:=</span>&nbsp;<span class="ident" id="8006672">b</span><span class="op" id="8006673">.</span><span class="ident" id="8006674">String</span><span class="op" id="8006680">(</span><span class="op" id="8006681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006685">if</span>&nbsp;<span class="ident" id="8006688">s</span>&nbsp;<span class="op" id="8006690">!=</span>&nbsp;<span class="ident" id="8006693">tt</span><span class="op" id="8006695">.</span><span class="ident" id="8006696">raw</span>&nbsp;<span class="op" id="8006700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006705">t</span><span class="op" id="8006706">.</span><span class="ident" id="8006707">Errorf</span><span class="op" id="8006713">(</span><span class="string" id="8006714">&#34;%s:&nbsp;got&nbsp;%d-byte&nbsp;%q&nbsp;want&nbsp;%d-byte&nbsp;%q&#34;</span><span class="op" id="8006750">,</span>&nbsp;<span class="ident" id="8006752">tt</span><span class="op" id="8006754">.</span><span class="ident" id="8006755">desc</span><span class="op" id="8006759">,</span>&nbsp;<span class="ident" id="8006761">n</span><span class="op" id="8006762">,</span>&nbsp;<span class="ident" id="8006764">s</span><span class="op" id="8006765">,</span>&nbsp;<span class="builtinfunc" id="8006767">len</span><span class="op" id="8006770">(</span><span class="ident" id="8006771">tt</span><span class="op" id="8006773">.</span><span class="ident" id="8006774">raw</span><span class="op" id="8006777">)</span><span class="op" id="8006778">,</span>&nbsp;<span class="ident" id="8006780">tt</span><span class="op" id="8006782">.</span><span class="ident" id="8006783">raw</span><span class="op" id="8006786">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006793">}</span><br>
<span class="lineno"></span><span class="op" id="8006795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8006798">func</span>&nbsp;<span class="ident" id="8006803">benchmarkDecoder</span><span class="op" id="8006819">(</span><span class="ident" id="8006820">b</span>&nbsp;<span class="op" id="8006822">*</span><span class="ident" id="8006823">testing</span><span class="op" id="8006830">.</span><span class="ident" id="8006831">B</span><span class="op" id="8006832">,</span>&nbsp;<span class="ident" id="8006834">n</span>&nbsp;<span class="builtintype" id="8006836">int</span><span class="op" id="8006839">)</span>&nbsp;<span class="op" id="8006841">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006844">b</span><span class="op" id="8006845">.</span><span class="ident" id="8006846">StopTimer</span><span class="op" id="8006855">(</span><span class="op" id="8006856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006859">b</span><span class="op" id="8006860">.</span><span class="ident" id="8006861">SetBytes</span><span class="op" id="8006869">(</span><span class="ident" id="8006870">int64</span><span class="op" id="8006875">(</span><span class="ident" id="8006876">n</span><span class="op" id="8006877">)</span><span class="op" id="8006878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006881">buf0</span><span class="op" id="8006885">,</span>&nbsp;<span class="ident" id="8006887">err</span>&nbsp;<span class="op" id="8006891">:=</span>&nbsp;<span class="ident" id="8006894">ioutil</span><span class="op" id="8006900">.</span><span class="ident" id="8006901">ReadFile</span><span class="op" id="8006909">(</span><span class="string" id="8006910">&#34;../testdata/e.txt&#34;</span><span class="op" id="8006929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006932">if</span>&nbsp;<span class="ident" id="8006935">err</span>&nbsp;<span class="op" id="8006939">!=</span>&nbsp;<span class="ident" id="8006942">nil</span>&nbsp;<span class="op" id="8006946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006950">b</span><span class="op" id="8006951">.</span><span class="ident" id="8006952">Fatal</span><span class="op" id="8006957">(</span><span class="ident" id="8006958">err</span><span class="op" id="8006961">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006967">if</span>&nbsp;<span class="builtinfunc" id="8006970">len</span><span class="op" id="8006973">(</span><span class="ident" id="8006974">buf0</span><span class="op" id="8006978">)</span>&nbsp;<span class="op" id="8006980">==</span>&nbsp;<span class="num" id="8006983">0</span>&nbsp;<span class="op" id="8006985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006989">b</span><span class="op" id="8006990">.</span><span class="ident" id="8006991">Fatalf</span><span class="op" id="8006997">(</span><span class="string" id="8006998">&#34;test&nbsp;file&nbsp;has&nbsp;no&nbsp;data&#34;</span><span class="op" id="8007021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007027">compressed</span>&nbsp;<span class="op" id="8007038">:=</span>&nbsp;<span class="builtinfunc" id="8007041">new</span><span class="op" id="8007044">(</span><span class="ident" id="8007045">bytes</span><span class="op" id="8007050">.</span><span class="ident" id="8007051">Buffer</span><span class="op" id="8007057">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007060">w</span>&nbsp;<span class="op" id="8007062">:=</span>&nbsp;<span class="ident" id="8007065">NewWriter</span><span class="op" id="8007074">(</span><span class="ident" id="8007075">compressed</span><span class="op" id="8007085">,</span>&nbsp;<span class="ident" id="8007087">LSB</span><span class="op" id="8007090">,</span>&nbsp;<span class="num" id="8007092">8</span><span class="op" id="8007093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007096">for</span>&nbsp;<span class="ident" id="8007100">i</span>&nbsp;<span class="op" id="8007102">:=</span>&nbsp;<span class="num" id="8007105">0</span><span class="op" id="8007106">;</span>&nbsp;<span class="ident" id="8007108">i</span>&nbsp;<span class="op" id="8007110">&lt;</span>&nbsp;<span class="ident" id="8007112">n</span><span class="op" id="8007113">;</span>&nbsp;<span class="ident" id="8007115">i</span>&nbsp;<span class="op" id="8007117">+=</span>&nbsp;<span class="builtinfunc" id="8007120">len</span><span class="op" id="8007123">(</span><span class="ident" id="8007124">buf0</span><span class="op" id="8007128">)</span>&nbsp;<span class="op" id="8007130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007134">if</span>&nbsp;<span class="builtinfunc" id="8007137">len</span><span class="op" id="8007140">(</span><span class="ident" id="8007141">buf0</span><span class="op" id="8007145">)</span>&nbsp;<span class="op" id="8007147">&gt;</span>&nbsp;<span class="ident" id="8007149">n</span><span class="op" id="8007150">-</span><span class="ident" id="8007151">i</span>&nbsp;<span class="op" id="8007153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007158">buf0</span>&nbsp;<span class="op" id="8007163">=</span>&nbsp;<span class="ident" id="8007165">buf0</span><span class="op" id="8007169">[</span><span class="op" id="8007170">:</span><span class="ident" id="8007171">n</span><span class="op" id="8007172">-</span><span class="ident" id="8007173">i</span><span class="op" id="8007174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007178">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007182">w</span><span class="op" id="8007183">.</span><span class="ident" id="8007184">Write</span><span class="op" id="8007189">(</span><span class="ident" id="8007190">buf0</span><span class="op" id="8007194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007200">w</span><span class="op" id="8007201">.</span><span class="ident" id="8007202">Close</span><span class="op" id="8007207">(</span><span class="op" id="8007208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007211">buf1</span>&nbsp;<span class="op" id="8007216">:=</span>&nbsp;<span class="ident" id="8007219">compressed</span><span class="op" id="8007229">.</span><span class="ident" id="8007230">Bytes</span><span class="op" id="8007235">(</span><span class="op" id="8007236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007239">buf0</span><span class="op" id="8007243">,</span>&nbsp;<span class="ident" id="8007245">compressed</span><span class="op" id="8007255">,</span>&nbsp;<span class="ident" id="8007257">w</span>&nbsp;<span class="op" id="8007259">=</span>&nbsp;<span class="ident" id="8007261">nil</span><span class="op" id="8007264">,</span>&nbsp;<span class="ident" id="8007266">nil</span><span class="op" id="8007269">,</span>&nbsp;<span class="ident" id="8007271">nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007276">runtime</span><span class="op" id="8007283">.</span><span class="ident" id="8007284">GC</span><span class="op" id="8007286">(</span><span class="op" id="8007287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007290">b</span><span class="op" id="8007291">.</span><span class="ident" id="8007292">StartTimer</span><span class="op" id="8007302">(</span><span class="op" id="8007303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007306">for</span>&nbsp;<span class="ident" id="8007310">i</span>&nbsp;<span class="op" id="8007312">:=</span>&nbsp;<span class="num" id="8007315">0</span><span class="op" id="8007316">;</span>&nbsp;<span class="ident" id="8007318">i</span>&nbsp;<span class="op" id="8007320">&lt;</span>&nbsp;<span class="ident" id="8007322">b</span><span class="op" id="8007323">.</span><span class="ident" id="8007324">N</span><span class="op" id="8007325">;</span>&nbsp;<span class="ident" id="8007327">i</span><span class="op" id="8007328">++</span>&nbsp;<span class="op" id="8007331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007335">io</span><span class="op" id="8007337">.</span><span class="ident" id="8007338">Copy</span><span class="op" id="8007342">(</span><span class="ident" id="8007343">ioutil</span><span class="op" id="8007349">.</span><span class="ident" id="8007350">Discard</span><span class="op" id="8007357">,</span>&nbsp;<span class="ident" id="8007359">NewReader</span><span class="op" id="8007368">(</span><span class="ident" id="8007369">bytes</span><span class="op" id="8007374">.</span><span class="ident" id="8007375">NewReader</span><span class="op" id="8007384">(</span><span class="ident" id="8007385">buf1</span><span class="op" id="8007389">)</span><span class="op" id="8007390">,</span>&nbsp;<span class="ident" id="8007392">LSB</span><span class="op" id="8007395">,</span>&nbsp;<span class="num" id="8007397">8</span><span class="op" id="8007398">)</span><span class="op" id="8007399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007402">}</span><br>
<span class="lineno">140</span><span class="op" id="8007404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8007407">func</span>&nbsp;<span class="ident" id="8007412">BenchmarkDecoder1e4</span><span class="op" id="8007431">(</span><span class="ident" id="8007432">b</span>&nbsp;<span class="op" id="8007434">*</span><span class="ident" id="8007435">testing</span><span class="op" id="8007442">.</span><span class="ident" id="8007443">B</span><span class="op" id="8007444">)</span>&nbsp;<span class="op" id="8007446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007449">benchmarkDecoder</span><span class="op" id="8007465">(</span><span class="ident" id="8007466">b</span><span class="op" id="8007467">,</span>&nbsp;<span class="num" id="8007469">1e4</span><span class="op" id="8007472">)</span><br>
<span class="lineno"></span><span class="op" id="8007474">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="8007477">func</span>&nbsp;<span class="ident" id="8007482">BenchmarkDecoder1e5</span><span class="op" id="8007501">(</span><span class="ident" id="8007502">b</span>&nbsp;<span class="op" id="8007504">*</span><span class="ident" id="8007505">testing</span><span class="op" id="8007512">.</span><span class="ident" id="8007513">B</span><span class="op" id="8007514">)</span>&nbsp;<span class="op" id="8007516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007519">benchmarkDecoder</span><span class="op" id="8007535">(</span><span class="ident" id="8007536">b</span><span class="op" id="8007537">,</span>&nbsp;<span class="num" id="8007539">1e5</span><span class="op" id="8007542">)</span><br>
<span class="lineno"></span><span class="op" id="8007544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8007547">func</span>&nbsp;<span class="ident" id="8007552">BenchmarkDecoder1e6</span><span class="op" id="8007571">(</span><span class="ident" id="8007572">b</span>&nbsp;<span class="op" id="8007574">*</span><span class="ident" id="8007575">testing</span><span class="op" id="8007582">.</span><span class="ident" id="8007583">B</span><span class="op" id="8007584">)</span>&nbsp;<span class="op" id="8007586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007589">benchmarkDecoder</span><span class="op" id="8007605">(</span><span class="ident" id="8007606">b</span><span class="op" id="8007607">,</span>&nbsp;<span class="num" id="8007609">1e6</span><span class="op" id="8007612">)</span><br>
<span class="lineno"></span><span class="op" id="8007614">}</span>
</div>
</body>
</html>
