<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html" class="current">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2789760">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2789815">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2789869">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2789920">package</span>&nbsp;<span class="ident" id="2789928">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2789934">import</span>&nbsp;<span class="op" id="2789941">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2789944">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2789952">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2789962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2789965">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2790031">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2790100">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2790175">type</span>&nbsp;<span class="ident" id="2790180">Location</span>&nbsp;<span class="keyword" id="2790189">struct</span>&nbsp;<span class="op" id="2790196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790199">name</span>&nbsp;<span class="builtintype" id="2790204">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790212">zone</span>&nbsp;<span class="op" id="2790217">[</span><span class="op" id="2790218">]</span><span class="ident" id="2790219">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790225">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2790230">[</span><span class="op" id="2790231">]</span><span class="ident" id="2790232">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790244">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790291">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790341">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790393">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790446">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790482">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790515">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790569">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790622">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790637">cacheStart</span>&nbsp;<span class="builtintype" id="2790648">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790655">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2790666">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790673">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2790684">*</span><span class="ident" id="2790685">zone</span><br>
<span class="lineno"></span><span class="op" id="2790690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790693">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2790754">type</span>&nbsp;<span class="ident" id="2790759">zone</span>&nbsp;<span class="keyword" id="2790764">struct</span>&nbsp;<span class="op" id="2790771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790774">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2790781">string</span>&nbsp;<span class="comment" id="2790788">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790816">offset</span>&nbsp;<span class="builtintype" id="2790823">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2790830">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790854">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2790861">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2790868">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2790907">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2790910">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2790967">type</span>&nbsp;<span class="ident" id="2790972">zoneTrans</span>&nbsp;<span class="keyword" id="2790982">struct</span>&nbsp;<span class="op" id="2790989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790992">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791005">int64</span>&nbsp;<span class="comment" id="2791011">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791058">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791071">uint8</span>&nbsp;<span class="comment" id="2791077">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791138">isstd</span><span class="op" id="2791143">,</span>&nbsp;<span class="ident" id="2791145">isutc</span>&nbsp;<span class="builtintype" id="2791151">bool</span>&nbsp;&nbsp;<span class="comment" id="2791157">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2791194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791197">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2791259">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2791275">const</span>&nbsp;<span class="op" id="2791281">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791284">alpha</span>&nbsp;<span class="op" id="2791290">=</span>&nbsp;<span class="op" id="2791292">-</span><span class="num" id="2791293">1</span>&nbsp;<span class="op" id="2791295">&lt;&lt;</span>&nbsp;<span class="num" id="2791298">63</span>&nbsp;&nbsp;<span class="comment" id="2791302">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791320">omega</span>&nbsp;<span class="op" id="2791326">=</span>&nbsp;<span class="num" id="2791328">1</span><span class="op" id="2791329">&lt;&lt;</span><span class="num" id="2791331">63</span>&nbsp;<span class="op" id="2791334">-</span>&nbsp;<span class="num" id="2791336">1</span>&nbsp;<span class="comment" id="2791338">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2791355">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2791358">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2791410">var</span>&nbsp;<span class="ident" id="2791414">UTC</span>&nbsp;<span class="op" id="2791418">*</span><span class="ident" id="2791419">Location</span>&nbsp;<span class="op" id="2791428">=</span>&nbsp;<span class="op" id="2791430">&amp;</span><span class="ident" id="2791431">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791439">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2791494">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2791547">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2791598">var</span>&nbsp;<span class="ident" id="2791602">utcLoc</span>&nbsp;<span class="op" id="2791609">=</span>&nbsp;<span class="ident" id="2791611">Location</span><span class="op" id="2791619">{</span><span class="ident" id="2791620">name</span><span class="op" id="2791624">:</span>&nbsp;<span class="string" id="2791626">&#34;UTC&#34;</span><span class="op" id="2791631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791634">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2791684">var</span>&nbsp;<span class="ident" id="2791688">Local</span>&nbsp;<span class="op" id="2791694">*</span><span class="ident" id="2791695">Location</span>&nbsp;<span class="op" id="2791704">=</span>&nbsp;<span class="op" id="2791706">&amp;</span><span class="ident" id="2791707">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2791717">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2791774">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2791816">var</span>&nbsp;<span class="ident" id="2791820">localLoc</span>&nbsp;<span class="ident" id="2791829">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2791838">var</span>&nbsp;<span class="ident" id="2791842">localOnce</span>&nbsp;<span class="ident" id="2791852">sync</span><span class="op" id="2791856">.</span><span class="ident" id="2791857">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2791863">func</span>&nbsp;<span class="op" id="2791868">(</span><span class="ident" id="2791869">l</span>&nbsp;<span class="op" id="2791871">*</span><span class="ident" id="2791872">Location</span><span class="op" id="2791880">)</span>&nbsp;<span class="ident" id="2791882">get</span><span class="op" id="2791885">(</span><span class="op" id="2791886">)</span>&nbsp;<span class="op" id="2791888">*</span><span class="ident" id="2791889">Location</span>&nbsp;<span class="op" id="2791898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791901">if</span>&nbsp;<span class="ident" id="2791904">l</span>&nbsp;<span class="op" id="2791906">==</span>&nbsp;<span class="builtintype" id="2791909">nil</span>&nbsp;<span class="op" id="2791913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791917">return</span>&nbsp;<span class="op" id="2791924">&amp;</span><span class="ident" id="2791925">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791933">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791936">if</span>&nbsp;<span class="ident" id="2791939">l</span>&nbsp;<span class="op" id="2791941">==</span>&nbsp;<span class="op" id="2791944">&amp;</span><span class="ident" id="2791945">localLoc</span>&nbsp;<span class="op" id="2791954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791958">localOnce</span><span class="op" id="2791967">.</span><span class="ident" id="2791968">Do</span><span class="op" id="2791970">(</span><span class="ident" id="2791971">initLocal</span><span class="op" id="2791980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791986">return</span>&nbsp;<span class="ident" id="2791993">l</span><br>
<span class="lineno"></span><span class="op" id="2791995">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2791998">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2792066">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2792116">func</span>&nbsp;<span class="op" id="2792121">(</span><span class="ident" id="2792122">l</span>&nbsp;<span class="op" id="2792124">*</span><span class="ident" id="2792125">Location</span><span class="op" id="2792133">)</span>&nbsp;<span class="ident" id="2792135">String</span><span class="op" id="2792141">(</span><span class="op" id="2792142">)</span>&nbsp;<span class="builtintype" id="2792144">string</span>&nbsp;<span class="op" id="2792151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792154">return</span>&nbsp;<span class="ident" id="2792161">l</span><span class="op" id="2792162">.</span><span class="ident" id="2792163">get</span><span class="op" id="2792166">(</span><span class="op" id="2792167">)</span><span class="op" id="2792168">.</span><span class="ident" id="2792169">name</span><br>
<span class="lineno">85</span><span class="op" id="2792174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792177">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2792226">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2792283">func</span>&nbsp;<span class="ident" id="2792288">FixedZone</span><span class="op" id="2792297">(</span><span class="ident" id="2792298">name</span>&nbsp;<span class="builtintype" id="2792303">string</span><span class="op" id="2792309">,</span>&nbsp;<span class="ident" id="2792311">offset</span>&nbsp;<span class="builtintype" id="2792318">int</span><span class="op" id="2792321">)</span>&nbsp;<span class="op" id="2792323">*</span><span class="ident" id="2792324">Location</span>&nbsp;<span class="op" id="2792333">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792336">l</span>&nbsp;<span class="op" id="2792338">:=</span>&nbsp;<span class="op" id="2792341">&amp;</span><span class="ident" id="2792342">Location</span><span class="op" id="2792350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792354">name</span><span class="op" id="2792358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792366">name</span><span class="op" id="2792370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792374">zone</span><span class="op" id="2792378">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792386">[</span><span class="op" id="2792387">]</span><span class="ident" id="2792388">zone</span><span class="op" id="2792392">{</span><span class="op" id="2792393">{</span><span class="ident" id="2792394">name</span><span class="op" id="2792398">,</span>&nbsp;<span class="ident" id="2792400">offset</span><span class="op" id="2792406">,</span>&nbsp;<span class="builtintype" id="2792408">false</span><span class="op" id="2792413">}</span><span class="op" id="2792414">}</span><span class="op" id="2792415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792419">tx</span><span class="op" id="2792421">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792431">[</span><span class="op" id="2792432">]</span><span class="ident" id="2792433">zoneTrans</span><span class="op" id="2792442">{</span><span class="op" id="2792443">{</span><span class="ident" id="2792444">alpha</span><span class="op" id="2792449">,</span>&nbsp;<span class="num" id="2792451">0</span><span class="op" id="2792452">,</span>&nbsp;<span class="builtintype" id="2792454">false</span><span class="op" id="2792459">,</span>&nbsp;<span class="builtintype" id="2792461">false</span><span class="op" id="2792466">}</span><span class="op" id="2792467">}</span><span class="op" id="2792468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792472">cacheStart</span><span class="op" id="2792482">:</span>&nbsp;<span class="ident" id="2792484">alpha</span><span class="op" id="2792489">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792493">cacheEnd</span><span class="op" id="2792501">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2792505">omega</span><span class="op" id="2792510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792516">l</span><span class="op" id="2792517">.</span><span class="ident" id="2792518">cacheZone</span>&nbsp;<span class="op" id="2792528">=</span>&nbsp;<span class="op" id="2792530">&amp;</span><span class="ident" id="2792531">l</span><span class="op" id="2792532">.</span><span class="ident" id="2792533">zone</span><span class="op" id="2792537">[</span><span class="num" id="2792538">0</span><span class="op" id="2792539">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792542">return</span>&nbsp;<span class="ident" id="2792549">l</span><br>
<span class="lineno"></span><span class="op" id="2792551">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2792554">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2792617">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2792693">//</span><br>
<span class="lineno"></span><span class="comment" id="2792696">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2792768">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2792839">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2792908">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2792964">func</span>&nbsp;<span class="op" id="2792969">(</span><span class="ident" id="2792970">l</span>&nbsp;<span class="op" id="2792972">*</span><span class="ident" id="2792973">Location</span><span class="op" id="2792981">)</span>&nbsp;<span class="ident" id="2792983">lookup</span><span class="op" id="2792989">(</span><span class="ident" id="2792990">sec</span>&nbsp;<span class="builtintype" id="2792994">int64</span><span class="op" id="2792999">)</span>&nbsp;<span class="op" id="2793001">(</span><span class="ident" id="2793002">name</span>&nbsp;<span class="builtintype" id="2793007">string</span><span class="op" id="2793013">,</span>&nbsp;<span class="ident" id="2793015">offset</span>&nbsp;<span class="builtintype" id="2793022">int</span><span class="op" id="2793025">,</span>&nbsp;<span class="ident" id="2793027">isDST</span>&nbsp;<span class="builtintype" id="2793033">bool</span><span class="op" id="2793037">,</span>&nbsp;<span class="ident" id="2793039">start</span><span class="op" id="2793044">,</span>&nbsp;<span class="ident" id="2793046">end</span>&nbsp;<span class="builtintype" id="2793050">int64</span><span class="op" id="2793055">)</span>&nbsp;<span class="op" id="2793057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793060">l</span>&nbsp;<span class="op" id="2793062">=</span>&nbsp;<span class="ident" id="2793064">l</span><span class="op" id="2793065">.</span><span class="ident" id="2793066">get</span><span class="op" id="2793069">(</span><span class="op" id="2793070">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793074">if</span>&nbsp;<span class="builtinfunc" id="2793077">len</span><span class="op" id="2793080">(</span><span class="ident" id="2793081">l</span><span class="op" id="2793082">.</span><span class="ident" id="2793083">zone</span><span class="op" id="2793087">)</span>&nbsp;<span class="op" id="2793089">==</span>&nbsp;<span class="num" id="2793092">0</span>&nbsp;<span class="op" id="2793094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793098">name</span>&nbsp;<span class="op" id="2793103">=</span>&nbsp;<span class="string" id="2793105">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793113">offset</span>&nbsp;<span class="op" id="2793120">=</span>&nbsp;<span class="num" id="2793122">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793126">isDST</span>&nbsp;<span class="op" id="2793132">=</span>&nbsp;<span class="builtintype" id="2793134">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793142">start</span>&nbsp;<span class="op" id="2793148">=</span>&nbsp;<span class="ident" id="2793150">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793158">end</span>&nbsp;<span class="op" id="2793162">=</span>&nbsp;<span class="ident" id="2793164">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793172">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793184">if</span>&nbsp;<span class="ident" id="2793187">zone</span>&nbsp;<span class="op" id="2793192">:=</span>&nbsp;<span class="ident" id="2793195">l</span><span class="op" id="2793196">.</span><span class="ident" id="2793197">cacheZone</span><span class="op" id="2793206">;</span>&nbsp;<span class="ident" id="2793208">zone</span>&nbsp;<span class="op" id="2793213">!=</span>&nbsp;<span class="builtintype" id="2793216">nil</span>&nbsp;<span class="op" id="2793220">&amp;&amp;</span>&nbsp;<span class="ident" id="2793223">l</span><span class="op" id="2793224">.</span><span class="ident" id="2793225">cacheStart</span>&nbsp;<span class="op" id="2793236">&lt;=</span>&nbsp;<span class="ident" id="2793239">sec</span>&nbsp;<span class="op" id="2793243">&amp;&amp;</span>&nbsp;<span class="ident" id="2793246">sec</span>&nbsp;<span class="op" id="2793250">&lt;</span>&nbsp;<span class="ident" id="2793252">l</span><span class="op" id="2793253">.</span><span class="ident" id="2793254">cacheEnd</span>&nbsp;<span class="op" id="2793263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793267">name</span>&nbsp;<span class="op" id="2793272">=</span>&nbsp;<span class="ident" id="2793274">zone</span><span class="op" id="2793278">.</span><span class="ident" id="2793279">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793286">offset</span>&nbsp;<span class="op" id="2793293">=</span>&nbsp;<span class="ident" id="2793295">zone</span><span class="op" id="2793299">.</span><span class="ident" id="2793300">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793309">isDST</span>&nbsp;<span class="op" id="2793315">=</span>&nbsp;<span class="ident" id="2793317">zone</span><span class="op" id="2793321">.</span><span class="ident" id="2793322">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793330">start</span>&nbsp;<span class="op" id="2793336">=</span>&nbsp;<span class="ident" id="2793338">l</span><span class="op" id="2793339">.</span><span class="ident" id="2793340">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793353">end</span>&nbsp;<span class="op" id="2793357">=</span>&nbsp;<span class="ident" id="2793359">l</span><span class="op" id="2793360">.</span><span class="ident" id="2793361">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793384">if</span>&nbsp;<span class="builtinfunc" id="2793387">len</span><span class="op" id="2793390">(</span><span class="ident" id="2793391">l</span><span class="op" id="2793392">.</span><span class="ident" id="2793393">tx</span><span class="op" id="2793395">)</span>&nbsp;<span class="op" id="2793397">==</span>&nbsp;<span class="num" id="2793400">0</span>&nbsp;<span class="op" id="2793402">||</span>&nbsp;<span class="ident" id="2793405">sec</span>&nbsp;<span class="op" id="2793409">&lt;</span>&nbsp;<span class="ident" id="2793411">l</span><span class="op" id="2793412">.</span><span class="ident" id="2793413">tx</span><span class="op" id="2793415">[</span><span class="num" id="2793416">0</span><span class="op" id="2793417">]</span><span class="op" id="2793418">.</span><span class="ident" id="2793419">when</span>&nbsp;<span class="op" id="2793424">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793428">zone</span>&nbsp;<span class="op" id="2793433">:=</span>&nbsp;<span class="op" id="2793436">&amp;</span><span class="ident" id="2793437">l</span><span class="op" id="2793438">.</span><span class="ident" id="2793439">zone</span><span class="op" id="2793443">[</span><span class="ident" id="2793444">l</span><span class="op" id="2793445">.</span><span class="ident" id="2793446">lookupFirstZone</span><span class="op" id="2793461">(</span><span class="op" id="2793462">)</span><span class="op" id="2793463">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793467">name</span>&nbsp;<span class="op" id="2793472">=</span>&nbsp;<span class="ident" id="2793474">zone</span><span class="op" id="2793478">.</span><span class="ident" id="2793479">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793486">offset</span>&nbsp;<span class="op" id="2793493">=</span>&nbsp;<span class="ident" id="2793495">zone</span><span class="op" id="2793499">.</span><span class="ident" id="2793500">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793509">isDST</span>&nbsp;<span class="op" id="2793515">=</span>&nbsp;<span class="ident" id="2793517">zone</span><span class="op" id="2793521">.</span><span class="ident" id="2793522">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793530">start</span>&nbsp;<span class="op" id="2793536">=</span>&nbsp;<span class="ident" id="2793538">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793546">if</span>&nbsp;<span class="builtinfunc" id="2793549">len</span><span class="op" id="2793552">(</span><span class="ident" id="2793553">l</span><span class="op" id="2793554">.</span><span class="ident" id="2793555">tx</span><span class="op" id="2793557">)</span>&nbsp;<span class="op" id="2793559">&gt;</span>&nbsp;<span class="num" id="2793561">0</span>&nbsp;<span class="op" id="2793563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793568">end</span>&nbsp;<span class="op" id="2793572">=</span>&nbsp;<span class="ident" id="2793574">l</span><span class="op" id="2793575">.</span><span class="ident" id="2793576">tx</span><span class="op" id="2793578">[</span><span class="num" id="2793579">0</span><span class="op" id="2793580">]</span><span class="op" id="2793581">.</span><span class="ident" id="2793582">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793589">}</span>&nbsp;<span class="keyword" id="2793591">else</span>&nbsp;<span class="op" id="2793596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793601">end</span>&nbsp;<span class="op" id="2793605">=</span>&nbsp;<span class="ident" id="2793607">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793615">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793619">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793631">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793685">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793734">tx</span>&nbsp;<span class="op" id="2793737">:=</span>&nbsp;<span class="ident" id="2793740">l</span><span class="op" id="2793741">.</span><span class="ident" id="2793742">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793746">end</span>&nbsp;<span class="op" id="2793750">=</span>&nbsp;<span class="ident" id="2793752">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793759">lo</span>&nbsp;<span class="op" id="2793762">:=</span>&nbsp;<span class="num" id="2793765">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793768">hi</span>&nbsp;<span class="op" id="2793771">:=</span>&nbsp;<span class="builtinfunc" id="2793774">len</span><span class="op" id="2793777">(</span><span class="ident" id="2793778">tx</span><span class="op" id="2793780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793783">for</span>&nbsp;<span class="ident" id="2793787">hi</span><span class="op" id="2793789">-</span><span class="ident" id="2793790">lo</span>&nbsp;<span class="op" id="2793793">&gt;</span>&nbsp;<span class="num" id="2793795">1</span>&nbsp;<span class="op" id="2793797">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793801">m</span>&nbsp;<span class="op" id="2793803">:=</span>&nbsp;<span class="ident" id="2793806">lo</span>&nbsp;<span class="op" id="2793809">+</span>&nbsp;<span class="op" id="2793811">(</span><span class="ident" id="2793812">hi</span><span class="op" id="2793814">-</span><span class="ident" id="2793815">lo</span><span class="op" id="2793817">)</span><span class="op" id="2793818">/</span><span class="num" id="2793819">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793823">lim</span>&nbsp;<span class="op" id="2793827">:=</span>&nbsp;<span class="ident" id="2793830">tx</span><span class="op" id="2793832">[</span><span class="ident" id="2793833">m</span><span class="op" id="2793834">]</span><span class="op" id="2793835">.</span><span class="ident" id="2793836">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793843">if</span>&nbsp;<span class="ident" id="2793846">sec</span>&nbsp;<span class="op" id="2793850">&lt;</span>&nbsp;<span class="ident" id="2793852">lim</span>&nbsp;<span class="op" id="2793856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793861">end</span>&nbsp;<span class="op" id="2793865">=</span>&nbsp;<span class="ident" id="2793867">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793874">hi</span>&nbsp;<span class="op" id="2793877">=</span>&nbsp;<span class="ident" id="2793879">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793883">}</span>&nbsp;<span class="keyword" id="2793885">else</span>&nbsp;<span class="op" id="2793890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793895">lo</span>&nbsp;<span class="op" id="2793898">=</span>&nbsp;<span class="ident" id="2793900">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793910">zone</span>&nbsp;<span class="op" id="2793915">:=</span>&nbsp;<span class="op" id="2793918">&amp;</span><span class="ident" id="2793919">l</span><span class="op" id="2793920">.</span><span class="ident" id="2793921">zone</span><span class="op" id="2793925">[</span><span class="ident" id="2793926">tx</span><span class="op" id="2793928">[</span><span class="ident" id="2793929">lo</span><span class="op" id="2793931">]</span><span class="op" id="2793932">.</span><span class="ident" id="2793933">index</span><span class="op" id="2793938">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793941">name</span>&nbsp;<span class="op" id="2793946">=</span>&nbsp;<span class="ident" id="2793948">zone</span><span class="op" id="2793952">.</span><span class="ident" id="2793953">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793959">offset</span>&nbsp;<span class="op" id="2793966">=</span>&nbsp;<span class="ident" id="2793968">zone</span><span class="op" id="2793972">.</span><span class="ident" id="2793973">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793981">isDST</span>&nbsp;<span class="op" id="2793987">=</span>&nbsp;<span class="ident" id="2793989">zone</span><span class="op" id="2793993">.</span><span class="ident" id="2793994">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794001">start</span>&nbsp;<span class="op" id="2794007">=</span>&nbsp;<span class="ident" id="2794009">tx</span><span class="op" id="2794011">[</span><span class="ident" id="2794012">lo</span><span class="op" id="2794014">]</span><span class="op" id="2794015">.</span><span class="ident" id="2794016">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794022">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794061">return</span><br>
<span class="lineno"></span><span class="op" id="2794068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794071">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2794142">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2794211">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2794221">//</span><br>
<span class="lineno"></span><span class="comment" id="2794224">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2794276">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2794349">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2794404">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2794466">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2794528">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2794591">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2794663">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2794675">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2794741">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2794761">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2794798">func</span>&nbsp;<span class="op" id="2794803">(</span><span class="ident" id="2794804">l</span>&nbsp;<span class="op" id="2794806">*</span><span class="ident" id="2794807">Location</span><span class="op" id="2794815">)</span>&nbsp;<span class="ident" id="2794817">lookupFirstZone</span><span class="op" id="2794832">(</span><span class="op" id="2794833">)</span>&nbsp;<span class="builtintype" id="2794835">int</span>&nbsp;<span class="op" id="2794839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794842">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794854">if</span>&nbsp;<span class="op" id="2794857">!</span><span class="ident" id="2794858">l</span><span class="op" id="2794859">.</span><span class="ident" id="2794860">firstZoneUsed</span><span class="op" id="2794873">(</span><span class="op" id="2794874">)</span>&nbsp;<span class="op" id="2794876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794880">return</span>&nbsp;<span class="num" id="2794887">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794894">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794906">if</span>&nbsp;<span class="builtinfunc" id="2794909">len</span><span class="op" id="2794912">(</span><span class="ident" id="2794913">l</span><span class="op" id="2794914">.</span><span class="ident" id="2794915">tx</span><span class="op" id="2794917">)</span>&nbsp;<span class="op" id="2794919">&gt;</span>&nbsp;<span class="num" id="2794921">0</span>&nbsp;<span class="op" id="2794923">&amp;&amp;</span>&nbsp;<span class="ident" id="2794926">l</span><span class="op" id="2794927">.</span><span class="ident" id="2794928">zone</span><span class="op" id="2794932">[</span><span class="ident" id="2794933">l</span><span class="op" id="2794934">.</span><span class="ident" id="2794935">tx</span><span class="op" id="2794937">[</span><span class="num" id="2794938">0</span><span class="op" id="2794939">]</span><span class="op" id="2794940">.</span><span class="ident" id="2794941">index</span><span class="op" id="2794946">]</span><span class="op" id="2794947">.</span><span class="ident" id="2794948">isDST</span>&nbsp;<span class="op" id="2794954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794958">for</span>&nbsp;<span class="ident" id="2794962">zi</span>&nbsp;<span class="op" id="2794965">:=</span>&nbsp;<span class="builtintype" id="2794968">int</span><span class="op" id="2794971">(</span><span class="ident" id="2794972">l</span><span class="op" id="2794973">.</span><span class="ident" id="2794974">tx</span><span class="op" id="2794976">[</span><span class="num" id="2794977">0</span><span class="op" id="2794978">]</span><span class="op" id="2794979">.</span><span class="ident" id="2794980">index</span><span class="op" id="2794985">)</span>&nbsp;<span class="op" id="2794987">-</span>&nbsp;<span class="num" id="2794989">1</span><span class="op" id="2794990">;</span>&nbsp;<span class="ident" id="2794992">zi</span>&nbsp;<span class="op" id="2794995">&gt;=</span>&nbsp;<span class="num" id="2794998">0</span><span class="op" id="2794999">;</span>&nbsp;<span class="ident" id="2795001">zi</span><span class="op" id="2795003">--</span>&nbsp;<span class="op" id="2795006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795011">if</span>&nbsp;<span class="op" id="2795014">!</span><span class="ident" id="2795015">l</span><span class="op" id="2795016">.</span><span class="ident" id="2795017">zone</span><span class="op" id="2795021">[</span><span class="ident" id="2795022">zi</span><span class="op" id="2795024">]</span><span class="op" id="2795025">.</span><span class="ident" id="2795026">isDST</span>&nbsp;<span class="op" id="2795032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795038">return</span>&nbsp;<span class="ident" id="2795045">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795051">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795062">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795074">for</span>&nbsp;<span class="ident" id="2795078">zi</span>&nbsp;<span class="op" id="2795081">:=</span>&nbsp;<span class="keyword" id="2795084">range</span>&nbsp;<span class="ident" id="2795090">l</span><span class="op" id="2795091">.</span><span class="ident" id="2795092">zone</span>&nbsp;<span class="op" id="2795097">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795101">if</span>&nbsp;<span class="op" id="2795104">!</span><span class="ident" id="2795105">l</span><span class="op" id="2795106">.</span><span class="ident" id="2795107">zone</span><span class="op" id="2795111">[</span><span class="ident" id="2795112">zi</span><span class="op" id="2795114">]</span><span class="op" id="2795115">.</span><span class="ident" id="2795116">isDST</span>&nbsp;<span class="op" id="2795122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795127">return</span>&nbsp;<span class="ident" id="2795134">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795146">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795158">return</span>&nbsp;<span class="num" id="2795165">0</span><br>
<span class="lineno"></span><span class="op" id="2795167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795170">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2795234">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2795249">func</span>&nbsp;<span class="op" id="2795254">(</span><span class="ident" id="2795255">l</span>&nbsp;<span class="op" id="2795257">*</span><span class="ident" id="2795258">Location</span><span class="op" id="2795266">)</span>&nbsp;<span class="ident" id="2795268">firstZoneUsed</span><span class="op" id="2795281">(</span><span class="op" id="2795282">)</span>&nbsp;<span class="builtintype" id="2795284">bool</span>&nbsp;<span class="op" id="2795289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795292">for</span>&nbsp;<span class="ident" id="2795296">_</span><span class="op" id="2795297">,</span>&nbsp;<span class="ident" id="2795299">tx</span>&nbsp;<span class="op" id="2795302">:=</span>&nbsp;<span class="keyword" id="2795305">range</span>&nbsp;<span class="ident" id="2795311">l</span><span class="op" id="2795312">.</span><span class="ident" id="2795313">tx</span>&nbsp;<span class="op" id="2795316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795320">if</span>&nbsp;<span class="ident" id="2795323">tx</span><span class="op" id="2795325">.</span><span class="ident" id="2795326">index</span>&nbsp;<span class="op" id="2795332">==</span>&nbsp;<span class="num" id="2795335">0</span>&nbsp;<span class="op" id="2795337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795342">return</span>&nbsp;<span class="builtintype" id="2795349">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795362">return</span>&nbsp;<span class="builtintype" id="2795369">false</span><br>
<span class="lineno"></span><span class="op" id="2795375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2795378">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2795437">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2795501">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2795550">func</span>&nbsp;<span class="op" id="2795555">(</span><span class="ident" id="2795556">l</span>&nbsp;<span class="op" id="2795558">*</span><span class="ident" id="2795559">Location</span><span class="op" id="2795567">)</span>&nbsp;<span class="ident" id="2795569">lookupName</span><span class="op" id="2795579">(</span><span class="ident" id="2795580">name</span>&nbsp;<span class="builtintype" id="2795585">string</span><span class="op" id="2795591">,</span>&nbsp;<span class="ident" id="2795593">unix</span>&nbsp;<span class="builtintype" id="2795598">int64</span><span class="op" id="2795603">)</span>&nbsp;<span class="op" id="2795605">(</span><span class="ident" id="2795606">offset</span>&nbsp;<span class="builtintype" id="2795613">int</span><span class="op" id="2795616">,</span>&nbsp;<span class="ident" id="2795618">isDST</span>&nbsp;<span class="builtintype" id="2795624">bool</span><span class="op" id="2795628">,</span>&nbsp;<span class="ident" id="2795630">ok</span>&nbsp;<span class="builtintype" id="2795633">bool</span><span class="op" id="2795637">)</span>&nbsp;<span class="op" id="2795639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795642">l</span>&nbsp;<span class="op" id="2795644">=</span>&nbsp;<span class="ident" id="2795646">l</span><span class="op" id="2795647">.</span><span class="ident" id="2795648">get</span><span class="op" id="2795651">(</span><span class="op" id="2795652">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795656">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795719">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795789">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795852">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795911">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795978">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795995">for</span>&nbsp;<span class="ident" id="2795999">i</span>&nbsp;<span class="op" id="2796001">:=</span>&nbsp;<span class="keyword" id="2796004">range</span>&nbsp;<span class="ident" id="2796010">l</span><span class="op" id="2796011">.</span><span class="ident" id="2796012">zone</span>&nbsp;<span class="op" id="2796017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796021">zone</span>&nbsp;<span class="op" id="2796026">:=</span>&nbsp;<span class="op" id="2796029">&amp;</span><span class="ident" id="2796030">l</span><span class="op" id="2796031">.</span><span class="ident" id="2796032">zone</span><span class="op" id="2796036">[</span><span class="ident" id="2796037">i</span><span class="op" id="2796038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796042">if</span>&nbsp;<span class="ident" id="2796045">zone</span><span class="op" id="2796049">.</span><span class="ident" id="2796050">name</span>&nbsp;<span class="op" id="2796055">==</span>&nbsp;<span class="ident" id="2796058">name</span>&nbsp;<span class="op" id="2796063">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796068">nam</span><span class="op" id="2796071">,</span>&nbsp;<span class="ident" id="2796073">offset</span><span class="op" id="2796079">,</span>&nbsp;<span class="ident" id="2796081">isDST</span><span class="op" id="2796086">,</span>&nbsp;<span class="ident" id="2796088">_</span><span class="op" id="2796089">,</span>&nbsp;<span class="ident" id="2796091">_</span>&nbsp;<span class="op" id="2796093">:=</span>&nbsp;<span class="ident" id="2796096">l</span><span class="op" id="2796097">.</span><span class="ident" id="2796098">lookup</span><span class="op" id="2796104">(</span><span class="ident" id="2796105">unix</span>&nbsp;<span class="op" id="2796110">-</span>&nbsp;<span class="builtintype" id="2796112">int64</span><span class="op" id="2796117">(</span><span class="ident" id="2796118">zone</span><span class="op" id="2796122">.</span><span class="ident" id="2796123">offset</span><span class="op" id="2796129">)</span><span class="op" id="2796130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796135">if</span>&nbsp;<span class="ident" id="2796138">nam</span>&nbsp;<span class="op" id="2796142">==</span>&nbsp;<span class="ident" id="2796145">zone</span><span class="op" id="2796149">.</span><span class="ident" id="2796150">name</span>&nbsp;<span class="op" id="2796155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796161">return</span>&nbsp;<span class="ident" id="2796168">offset</span><span class="op" id="2796174">,</span>&nbsp;<span class="ident" id="2796176">isDST</span><span class="op" id="2796181">,</span>&nbsp;<span class="builtintype" id="2796183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796195">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796202">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796253">for</span>&nbsp;<span class="ident" id="2796257">i</span>&nbsp;<span class="op" id="2796259">:=</span>&nbsp;<span class="keyword" id="2796262">range</span>&nbsp;<span class="ident" id="2796268">l</span><span class="op" id="2796269">.</span><span class="ident" id="2796270">zone</span>&nbsp;<span class="op" id="2796275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796279">zone</span>&nbsp;<span class="op" id="2796284">:=</span>&nbsp;<span class="op" id="2796287">&amp;</span><span class="ident" id="2796288">l</span><span class="op" id="2796289">.</span><span class="ident" id="2796290">zone</span><span class="op" id="2796294">[</span><span class="ident" id="2796295">i</span><span class="op" id="2796296">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796300">if</span>&nbsp;<span class="ident" id="2796303">zone</span><span class="op" id="2796307">.</span><span class="ident" id="2796308">name</span>&nbsp;<span class="op" id="2796313">==</span>&nbsp;<span class="ident" id="2796316">name</span>&nbsp;<span class="op" id="2796321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796326">return</span>&nbsp;<span class="ident" id="2796333">zone</span><span class="op" id="2796337">.</span><span class="ident" id="2796338">offset</span><span class="op" id="2796344">,</span>&nbsp;<span class="ident" id="2796346">zone</span><span class="op" id="2796350">.</span><span class="ident" id="2796351">isDST</span><span class="op" id="2796356">,</span>&nbsp;<span class="builtintype" id="2796358">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796372">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796396">return</span><br>
<span class="lineno"></span><span class="op" id="2796403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2796406">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2796479">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2796540">var</span>&nbsp;<span class="ident" id="2796544">zoneinfo</span><span class="op" id="2796552">,</span>&nbsp;<span class="ident" id="2796554">_</span>&nbsp;<span class="op" id="2796556">=</span>&nbsp;<span class="ident" id="2796558">syscall</span><span class="op" id="2796565">.</span><span class="ident" id="2796566">Getenv</span><span class="op" id="2796572">(</span><span class="string" id="2796573">&#34;ZONEINFO&#34;</span><span class="op" id="2796583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2796586">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2796644">//</span><br>
<span class="lineno"></span><span class="comment" id="2796647">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2796704">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2796759">//</span><br>
<span class="lineno"></span><span class="comment" id="2796762">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2796840">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2796903">//</span><br>
<span class="lineno"></span><span class="comment" id="2796906">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2796966">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2797022">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2797086">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2797155">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2797204">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2797259">func</span>&nbsp;<span class="ident" id="2797264">LoadLocation</span><span class="op" id="2797276">(</span><span class="ident" id="2797277">name</span>&nbsp;<span class="builtintype" id="2797282">string</span><span class="op" id="2797288">)</span>&nbsp;<span class="op" id="2797290">(</span><span class="op" id="2797291">*</span><span class="ident" id="2797292">Location</span><span class="op" id="2797300">,</span>&nbsp;<span class="builtintype" id="2797302">error</span><span class="op" id="2797307">)</span>&nbsp;<span class="op" id="2797309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797312">if</span>&nbsp;<span class="ident" id="2797315">name</span>&nbsp;<span class="op" id="2797320">==</span>&nbsp;<span class="string" id="2797323">&#34;&#34;</span>&nbsp;<span class="op" id="2797326">||</span>&nbsp;<span class="ident" id="2797329">name</span>&nbsp;<span class="op" id="2797334">==</span>&nbsp;<span class="string" id="2797337">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2797343">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797347">return</span>&nbsp;<span class="ident" id="2797354">UTC</span><span class="op" id="2797357">,</span>&nbsp;<span class="builtintype" id="2797359">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797367">if</span>&nbsp;<span class="ident" id="2797370">name</span>&nbsp;<span class="op" id="2797375">==</span>&nbsp;<span class="string" id="2797378">&#34;Local&#34;</span>&nbsp;<span class="op" id="2797386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797390">return</span>&nbsp;<span class="ident" id="2797397">Local</span><span class="op" id="2797402">,</span>&nbsp;<span class="builtintype" id="2797404">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797409">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797412">if</span>&nbsp;<span class="ident" id="2797415">zoneinfo</span>&nbsp;<span class="op" id="2797424">!=</span>&nbsp;<span class="string" id="2797427">&#34;&#34;</span>&nbsp;<span class="op" id="2797430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797434">if</span>&nbsp;<span class="ident" id="2797437">z</span><span class="op" id="2797438">,</span>&nbsp;<span class="ident" id="2797440">err</span>&nbsp;<span class="op" id="2797444">:=</span>&nbsp;<span class="ident" id="2797447">loadZoneFile</span><span class="op" id="2797459">(</span><span class="ident" id="2797460">zoneinfo</span><span class="op" id="2797468">,</span>&nbsp;<span class="ident" id="2797470">name</span><span class="op" id="2797474">)</span><span class="op" id="2797475">;</span>&nbsp;<span class="ident" id="2797477">err</span>&nbsp;<span class="op" id="2797481">==</span>&nbsp;<span class="builtintype" id="2797484">nil</span>&nbsp;<span class="op" id="2797488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797493">z</span><span class="op" id="2797494">.</span><span class="ident" id="2797495">name</span>&nbsp;<span class="op" id="2797500">=</span>&nbsp;<span class="ident" id="2797502">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797510">return</span>&nbsp;<span class="ident" id="2797517">z</span><span class="op" id="2797518">,</span>&nbsp;<span class="builtintype" id="2797520">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797526">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797532">return</span>&nbsp;<span class="ident" id="2797539">loadLocation</span><span class="op" id="2797551">(</span><span class="ident" id="2797552">name</span><span class="op" id="2797556">)</span><br>
<span class="lineno"></span><span class="op" id="2797558">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
