<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8031884">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8031939">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8031993">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8032044">package</span>&nbsp;<span class="ident" id="8032052">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8032057">import</span>&nbsp;<span class="op" id="8032064">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8032067">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8032075">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8032082">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8032093">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8032100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8032103">var</span>&nbsp;<span class="ident" id="8032107">testDNSFlood</span>&nbsp;<span class="op" id="8032120">=</span>&nbsp;<span class="ident" id="8032122"><a href="/net/z_last_test.go.html#8032067">flag</a></span><span class="op" id="8032126">.</span><span class="ident" id="8032127">Bool</span><span class="op" id="8032131">(</span><span class="string" id="8032132">&#34;dnsflood&#34;</span><span class="op" id="8032142">,</span>&nbsp;<span class="builtintype" id="8032144">false</span><span class="op" id="8032149">,</span>&nbsp;<span class="string" id="8032151">&#34;whether&nbsp;to&nbsp;test&nbsp;dns&nbsp;query&nbsp;flooding&#34;</span><span class="op" id="8032187">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8032190">func</span>&nbsp;<span class="ident" id="8032195">TestDNSThreadLimit</span><span class="op" id="8032213">(</span><span class="ident" id="8032214">t</span>&nbsp;<span class="op" id="8032216">*</span><span class="ident" id="8032217"><a href="/net/z_last_test.go.html#8032082">testing</a></span><span class="op" id="8032224">.</span><span class="ident" id="8032225">T</span><span class="op" id="8032226">)</span>&nbsp;<span class="op" id="8032228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032231">if</span>&nbsp;<span class="op" id="8032234">!</span><span class="op" id="8032235">*</span><span class="ident" id="8032236"><a href="/net/z_last_test.go.html#8032107">testDNSFlood</a></span>&nbsp;<span class="op" id="8032249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032253"><a href="/net/z_last_test.go.html#8032214">t</a></span><span class="op" id="8032254">.</span><span class="ident" id="8032255">Skip</span><span class="op" id="8032259">(</span><span class="string" id="8032260">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8032300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032303">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032307">const</span>&nbsp;<span class="ident" id="8032313">N</span>&nbsp;<span class="op" id="8032315">=</span>&nbsp;<span class="num" id="8032317">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032324">c</span>&nbsp;<span class="op" id="8032326">:=</span>&nbsp;<span class="builtinfunc" id="8032329">make</span><span class="op" id="8032333">(</span><span class="keyword" id="8032334">chan</span>&nbsp;<span class="builtintype" id="8032339">int</span><span class="op" id="8032342">,</span>&nbsp;<span class="ident" id="8032344"><a href="/net/z_last_test.go.html#8032313">N</a></span><span class="op" id="8032345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032348">for</span>&nbsp;<span class="ident" id="8032352">i</span>&nbsp;<span class="op" id="8032354">:=</span>&nbsp;<span class="num" id="8032357">0</span><span class="op" id="8032358">;</span>&nbsp;<span class="ident" id="8032360"><a href="/net/z_last_test.go.html#8032352">i</a></span>&nbsp;<span class="op" id="8032362">&lt;</span>&nbsp;<span class="ident" id="8032364"><a href="/net/z_last_test.go.html#8032313">N</a></span><span class="op" id="8032365">;</span>&nbsp;<span class="ident" id="8032367"><a href="/net/z_last_test.go.html#8032352">i</a></span><span class="op" id="8032368">++</span>&nbsp;<span class="op" id="8032371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032375">go</span>&nbsp;<span class="keyword" id="8032378">func</span><span class="op" id="8032382">(</span><span class="ident" id="8032383">i</span>&nbsp;<span class="builtintype" id="8032385">int</span><span class="op" id="8032388">)</span>&nbsp;<span class="op" id="8032390">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032395"><a href="/net/lookup.go.html#1454959">LookupIP</a></span><span class="op" id="8032403">(</span><span class="ident" id="8032404"><a href="/net/z_last_test.go.html#8032075">fmt</a></span><span class="op" id="8032407">.</span><span class="ident" id="8032408">Sprintf</span><span class="op" id="8032415">(</span><span class="string" id="8032416">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="8032440">,</span>&nbsp;<span class="ident" id="8032442"><a href="/net/z_last_test.go.html#8032383">i</a></span><span class="op" id="8032443">)</span><span class="op" id="8032444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032449"><a href="/net/z_last_test.go.html#8032324">c</a></span>&nbsp;<span class="op" id="8032451">&lt;-</span>&nbsp;<span class="num" id="8032454">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032458">}</span><span class="op" id="8032459">(</span><span class="ident" id="8032460"><a href="/net/z_last_test.go.html#8032352">i</a></span><span class="op" id="8032461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8032467">//&nbsp;Don&#39;t&nbsp;bother&nbsp;waiting&nbsp;for&nbsp;the&nbsp;stragglers;&nbsp;stop&nbsp;at&nbsp;0.9&nbsp;N.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032527">for</span>&nbsp;<span class="ident" id="8032531">i</span>&nbsp;<span class="op" id="8032533">:=</span>&nbsp;<span class="num" id="8032536">0</span><span class="op" id="8032537">;</span>&nbsp;<span class="ident" id="8032539"><a href="/net/z_last_test.go.html#8032531">i</a></span>&nbsp;<span class="op" id="8032541">&lt;</span>&nbsp;<span class="ident" id="8032543"><a href="/net/z_last_test.go.html#8032313">N</a></span><span class="op" id="8032544">*</span><span class="num" id="8032545">9</span><span class="op" id="8032546">/</span><span class="num" id="8032547">10</span><span class="op" id="8032549">;</span>&nbsp;<span class="ident" id="8032551"><a href="/net/z_last_test.go.html#8032531">i</a></span><span class="op" id="8032552">++</span>&nbsp;<span class="op" id="8032555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032559">if</span>&nbsp;<span class="ident" id="8032562"><a href="/net/z_last_test.go.html#8032531">i</a></span><span class="op" id="8032563">%</span><span class="num" id="8032564">100</span>&nbsp;<span class="op" id="8032568">==</span>&nbsp;<span class="num" id="8032571">0</span>&nbsp;<span class="op" id="8032573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8032578">//println(&#34;TestDNSThreadLimit:&#34;,&nbsp;i)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032620">&lt;-</span><span class="ident" id="8032622"><a href="/net/z_last_test.go.html#8032324">c</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8032629">//&nbsp;If&nbsp;we&#39;re&nbsp;still&nbsp;here,&nbsp;it&nbsp;worked.</span><br>
<span class="lineno"></span><span class="op" id="8032664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="8032667">func</span>&nbsp;<span class="ident" id="8032672">TestLookupIPDeadline</span><span class="op" id="8032692">(</span><span class="ident" id="8032693">t</span>&nbsp;<span class="op" id="8032695">*</span><span class="ident" id="8032696"><a href="/net/z_last_test.go.html#8032082">testing</a></span><span class="op" id="8032703">.</span><span class="ident" id="8032704">T</span><span class="op" id="8032705">)</span>&nbsp;<span class="op" id="8032707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032710">if</span>&nbsp;<span class="op" id="8032713">!</span><span class="op" id="8032714">*</span><span class="ident" id="8032715"><a href="/net/z_last_test.go.html#8032107">testDNSFlood</a></span>&nbsp;<span class="op" id="8032728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032732"><a href="/net/z_last_test.go.html#8032693">t</a></span><span class="op" id="8032733">.</span><span class="ident" id="8032734">Skip</span><span class="op" id="8032738">(</span><span class="string" id="8032739">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8032779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8032782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032786">const</span>&nbsp;<span class="ident" id="8032792">N</span>&nbsp;<span class="op" id="8032794">=</span>&nbsp;<span class="num" id="8032796">5000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032802">const</span>&nbsp;<span class="ident" id="8032808">timeout</span>&nbsp;<span class="op" id="8032816">=</span>&nbsp;<span class="num" id="8032818">3</span>&nbsp;<span class="op" id="8032820">*</span>&nbsp;<span class="ident" id="8032822"><a href="/net/z_last_test.go.html#8032093">time</a></span><span class="op" id="8032826">.</span><span class="ident" id="8032827">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032835">c</span>&nbsp;<span class="op" id="8032837">:=</span>&nbsp;<span class="builtinfunc" id="8032840">make</span><span class="op" id="8032844">(</span><span class="keyword" id="8032845">chan</span>&nbsp;<span class="builtintype" id="8032850">error</span><span class="op" id="8032855">,</span>&nbsp;<span class="num" id="8032857">2</span><span class="op" id="8032858">*</span><span class="ident" id="8032859"><a href="/net/z_last_test.go.html#8032792">N</a></span><span class="op" id="8032860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032863">for</span>&nbsp;<span class="ident" id="8032867">i</span>&nbsp;<span class="op" id="8032869">:=</span>&nbsp;<span class="num" id="8032872">0</span><span class="op" id="8032873">;</span>&nbsp;<span class="ident" id="8032875"><a href="/net/z_last_test.go.html#8032867">i</a></span>&nbsp;<span class="op" id="8032877">&lt;</span>&nbsp;<span class="ident" id="8032879"><a href="/net/z_last_test.go.html#8032792">N</a></span><span class="op" id="8032880">;</span>&nbsp;<span class="ident" id="8032882"><a href="/net/z_last_test.go.html#8032867">i</a></span><span class="op" id="8032883">++</span>&nbsp;<span class="op" id="8032886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032890">name</span>&nbsp;<span class="op" id="8032895">:=</span>&nbsp;<span class="ident" id="8032898"><a href="/net/z_last_test.go.html#8032075">fmt</a></span><span class="op" id="8032901">.</span><span class="ident" id="8032902">Sprintf</span><span class="op" id="8032909">(</span><span class="string" id="8032910">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="8032934">,</span>&nbsp;<span class="ident" id="8032936"><a href="/net/z_last_test.go.html#8032867">i</a></span><span class="op" id="8032937">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8032941">go</span>&nbsp;<span class="keyword" id="8032944">func</span><span class="op" id="8032948">(</span><span class="op" id="8032949">)</span>&nbsp;<span class="op" id="8032951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8032956">_</span><span class="op" id="8032957">,</span>&nbsp;<span class="ident" id="8032959">err</span>&nbsp;<span class="op" id="8032963">:=</span>&nbsp;<span class="ident" id="8032966"><a href="/net/lookup.go.html#1455863">lookupIPDeadline</a></span><span class="op" id="8032982">(</span><span class="ident" id="8032983"><a href="/net/z_last_test.go.html#8032890">name</a></span><span class="op" id="8032987">,</span>&nbsp;<span class="ident" id="8032989"><a href="/net/z_last_test.go.html#8032093">time</a></span><span class="op" id="8032993">.</span><span class="ident" id="8032994">Now</span><span class="op" id="8032997">(</span><span class="op" id="8032998">)</span><span class="op" id="8032999">.</span><span class="ident" id="8033000">Add</span><span class="op" id="8033003">(</span><span class="ident" id="8033004"><a href="/net/z_last_test.go.html#8032808">timeout</a></span><span class="op" id="8033011">/</span><span class="num" id="8033012">2</span><span class="op" id="8033013">)</span><span class="op" id="8033014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033019"><a href="/net/z_last_test.go.html#8032835">c</a></span>&nbsp;<span class="op" id="8033021">&lt;-</span>&nbsp;<span class="ident" id="8033024"><a href="/net/z_last_test.go.html#8032959">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033030">}</span><span class="op" id="8033031">(</span><span class="op" id="8033032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033036">go</span>&nbsp;<span class="keyword" id="8033039">func</span><span class="op" id="8033043">(</span><span class="op" id="8033044">)</span>&nbsp;<span class="op" id="8033046">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033051">_</span><span class="op" id="8033052">,</span>&nbsp;<span class="ident" id="8033054">err</span>&nbsp;<span class="op" id="8033058">:=</span>&nbsp;<span class="ident" id="8033061"><a href="/net/lookup.go.html#1455863">lookupIPDeadline</a></span><span class="op" id="8033077">(</span><span class="ident" id="8033078"><a href="/net/z_last_test.go.html#8032890">name</a></span><span class="op" id="8033082">,</span>&nbsp;<span class="ident" id="8033084"><a href="/net/z_last_test.go.html#8032093">time</a></span><span class="op" id="8033088">.</span><span class="ident" id="8033089">Now</span><span class="op" id="8033092">(</span><span class="op" id="8033093">)</span><span class="op" id="8033094">.</span><span class="ident" id="8033095">Add</span><span class="op" id="8033098">(</span><span class="ident" id="8033099"><a href="/net/z_last_test.go.html#8032808">timeout</a></span><span class="op" id="8033106">)</span><span class="op" id="8033107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033112"><a href="/net/z_last_test.go.html#8032835">c</a></span>&nbsp;<span class="op" id="8033114">&lt;-</span>&nbsp;<span class="ident" id="8033117"><a href="/net/z_last_test.go.html#8033054">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033123">}</span><span class="op" id="8033124">(</span><span class="op" id="8033125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033131">qstats</span>&nbsp;<span class="op" id="8033138">:=</span>&nbsp;<span class="keyword" id="8033141">struct</span>&nbsp;<span class="op" id="8033148">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033152">succeeded</span><span class="op" id="8033161">,</span>&nbsp;<span class="ident" id="8033163">failed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8033178">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033184">timeout</span><span class="op" id="8033191">,</span>&nbsp;<span class="ident" id="8033193">temporary</span><span class="op" id="8033202">,</span>&nbsp;<span class="ident" id="8033204">other</span>&nbsp;<span class="builtintype" id="8033210">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033216">unknown</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8033242">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033247">}</span><span class="op" id="8033248">{</span><span class="op" id="8033249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033252">deadline</span>&nbsp;<span class="op" id="8033261">:=</span>&nbsp;<span class="ident" id="8033264"><a href="/net/z_last_test.go.html#8032093">time</a></span><span class="op" id="8033268">.</span><span class="ident" id="8033269">After</span><span class="op" id="8033274">(</span><span class="ident" id="8033275"><a href="/net/z_last_test.go.html#8032808">timeout</a></span>&nbsp;<span class="op" id="8033283">+</span>&nbsp;<span class="ident" id="8033285"><a href="/net/z_last_test.go.html#8032093">time</a></span><span class="op" id="8033289">.</span><span class="ident" id="8033290">Second</span><span class="op" id="8033296">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033299">for</span>&nbsp;<span class="ident" id="8033303">i</span>&nbsp;<span class="op" id="8033305">:=</span>&nbsp;<span class="num" id="8033308">0</span><span class="op" id="8033309">;</span>&nbsp;<span class="ident" id="8033311"><a href="/net/z_last_test.go.html#8033303">i</a></span>&nbsp;<span class="op" id="8033313">&lt;</span>&nbsp;<span class="num" id="8033315">2</span><span class="op" id="8033316">*</span><span class="ident" id="8033317"><a href="/net/z_last_test.go.html#8032792">N</a></span><span class="op" id="8033318">;</span>&nbsp;<span class="ident" id="8033320"><a href="/net/z_last_test.go.html#8033303">i</a></span><span class="op" id="8033321">++</span>&nbsp;<span class="op" id="8033324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033328">select</span>&nbsp;<span class="op" id="8033335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033339">case</span>&nbsp;<span class="op" id="8033344">&lt;-</span><span class="ident" id="8033346"><a href="/net/z_last_test.go.html#8033252">deadline</a></span><span class="op" id="8033354">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033359"><a href="/net/z_last_test.go.html#8032693">t</a></span><span class="op" id="8033360">.</span><span class="ident" id="8033361">Fatal</span><span class="op" id="8033366">(</span><span class="string" id="8033367">&#34;deadline&nbsp;exceeded&#34;</span><span class="op" id="8033386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033390">case</span>&nbsp;<span class="ident" id="8033395">err</span>&nbsp;<span class="op" id="8033399">:=</span>&nbsp;<span class="op" id="8033402">&lt;-</span><span class="ident" id="8033404"><a href="/net/z_last_test.go.html#8032835">c</a></span><span class="op" id="8033405">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033410">switch</span>&nbsp;<span class="ident" id="8033417">err</span>&nbsp;<span class="op" id="8033421">:=</span>&nbsp;<span class="ident" id="8033424"><a href="/net/z_last_test.go.html#8033395">err</a></span><span class="op" id="8033427">.</span><span class="op" id="8033428">(</span><span class="keyword" id="8033429">type</span><span class="op" id="8033433">)</span>&nbsp;<span class="op" id="8033435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033440">case</span>&nbsp;<span class="ident" id="8033445">nil</span><span class="op" id="8033448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033454"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033460">.</span><span class="ident" id="8033461">succeeded</span><span class="op" id="8033470">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033476">case</span>&nbsp;<span class="ident" id="8033481"><a href="/net/net.go.html#1469488">Error</a></span><span class="op" id="8033486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033492"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033498">.</span><span class="ident" id="8033499">failed</span><span class="op" id="8033505">++</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033512">if</span>&nbsp;<span class="ident" id="8033515"><a href="/net/z_last_test.go.html#8033417">err</a></span><span class="op" id="8033518">.</span><span class="ident" id="8033519">Timeout</span><span class="op" id="8033526">(</span><span class="op" id="8033527">)</span>&nbsp;<span class="op" id="8033529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033536"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033542">.</span><span class="ident" id="8033543">timeout</span><span class="op" id="8033550">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033563">if</span>&nbsp;<span class="ident" id="8033566"><a href="/net/z_last_test.go.html#8033417">err</a></span><span class="op" id="8033569">.</span><span class="ident" id="8033570">Temporary</span><span class="op" id="8033579">(</span><span class="op" id="8033580">)</span>&nbsp;<span class="op" id="8033582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033589"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033595">.</span><span class="ident" id="8033596">temporary</span><span class="op" id="8033605">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033618">if</span>&nbsp;<span class="op" id="8033621">!</span><span class="ident" id="8033622"><a href="/net/z_last_test.go.html#8033417">err</a></span><span class="op" id="8033625">.</span><span class="ident" id="8033626">Timeout</span><span class="op" id="8033633">(</span><span class="op" id="8033634">)</span>&nbsp;<span class="op" id="8033636">&amp;&amp;</span>&nbsp;<span class="op" id="8033639">!</span><span class="ident" id="8033640"><a href="/net/z_last_test.go.html#8033417">err</a></span><span class="op" id="8033643">.</span><span class="ident" id="8033644">Temporary</span><span class="op" id="8033653">(</span><span class="op" id="8033654">)</span>&nbsp;<span class="op" id="8033656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033663"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033669">.</span><span class="ident" id="8033670">other</span><span class="op" id="8033675">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8033687">default</span><span class="op" id="8033694">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033700"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033706">.</span><span class="ident" id="8033707">failed</span><span class="op" id="8033713">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8033720"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8033726">.</span><span class="ident" id="8033727">unknown</span><span class="op" id="8033734">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8033747">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8033751">//&nbsp;A&nbsp;high&nbsp;volume&nbsp;of&nbsp;DNS&nbsp;queries&nbsp;for&nbsp;sub-domain&nbsp;of&nbsp;golang.org</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8033813">//&nbsp;would&nbsp;be&nbsp;coordinated&nbsp;by&nbsp;authoritative&nbsp;or&nbsp;recursive&nbsp;server,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8033876">//&nbsp;or&nbsp;stub&nbsp;resolver&nbsp;which&nbsp;implements&nbsp;query-response&nbsp;rate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8033934">//&nbsp;limitation,&nbsp;so&nbsp;we&nbsp;can&nbsp;expect&nbsp;some&nbsp;query&nbsp;successes&nbsp;and&nbsp;more</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8033997">//&nbsp;failures&nbsp;including&nbsp;timeout,&nbsp;temporary&nbsp;and&nbsp;other&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8034055">//&nbsp;As&nbsp;a&nbsp;rule,&nbsp;unknown&nbsp;must&nbsp;not&nbsp;be&nbsp;shown&nbsp;but&nbsp;it&nbsp;might&nbsp;possibly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8034118">//&nbsp;happen&nbsp;due&nbsp;to&nbsp;issue&nbsp;4856&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8034156"><a href="/net/z_last_test.go.html#8032693">t</a></span><span class="op" id="8034157">.</span><span class="ident" id="8034158">Logf</span><span class="op" id="8034162">(</span><span class="string" id="8034163">&#34;%v&nbsp;succeeded,&nbsp;%v&nbsp;failed&nbsp;(%v&nbsp;timeout,&nbsp;%v&nbsp;temporary,&nbsp;%v&nbsp;other,&nbsp;%v&nbsp;unknown)&#34;</span><span class="op" id="8034237">,</span>&nbsp;<span class="ident" id="8034239"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034245">.</span><span class="ident" id="8034246">succeeded</span><span class="op" id="8034255">,</span>&nbsp;<span class="ident" id="8034257"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034263">.</span><span class="ident" id="8034264">failed</span><span class="op" id="8034270">,</span>&nbsp;<span class="ident" id="8034272"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034278">.</span><span class="ident" id="8034279">timeout</span><span class="op" id="8034286">,</span>&nbsp;<span class="ident" id="8034288"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034294">.</span><span class="ident" id="8034295">temporary</span><span class="op" id="8034304">,</span>&nbsp;<span class="ident" id="8034306"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034312">.</span><span class="ident" id="8034313">other</span><span class="op" id="8034318">,</span>&nbsp;<span class="ident" id="8034320"><a href="/net/z_last_test.go.html#8033131">qstats</a></span><span class="op" id="8034326">.</span><span class="ident" id="8034327">unknown</span><span class="op" id="8034334">)</span><br>
<span class="lineno"></span><span class="op" id="8034336">}</span>
</div>
</body>
</html>
