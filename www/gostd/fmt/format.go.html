<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2369860">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2369915">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2369969">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2370020">package</span>&nbsp;<span class="ident" id="2370028">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2370033">import</span>&nbsp;<span class="op" id="2370040">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2370043">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2370051">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2370062">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2370077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2370080">const</span>&nbsp;<span class="op" id="2370086">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2370089">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2370122">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370169">nByte</span>&nbsp;<span class="op" id="2370175">=</span>&nbsp;<span class="num" id="2370177">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370182">ldigits</span>&nbsp;<span class="op" id="2370190">=</span>&nbsp;<span class="string" id="2370192">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370212">udigits</span>&nbsp;<span class="op" id="2370220">=</span>&nbsp;<span class="string" id="2370222">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2370241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2370244">const</span>&nbsp;<span class="op" id="2370250">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370253">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2370262">=</span>&nbsp;<span class="builtintype" id="2370264">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370270">unsigned</span>&nbsp;<span class="op" id="2370279">=</span>&nbsp;<span class="builtintype" id="2370281">false</span><br>
<span class="lineno">25</span><span class="op" id="2370287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2370290">var</span>&nbsp;<span class="ident" id="2370294">padZeroBytes</span>&nbsp;<span class="op" id="2370307">=</span>&nbsp;<span class="builtinfunc" id="2370309">make</span><span class="op" id="2370313">(</span><span class="op" id="2370314">[</span><span class="op" id="2370315">]</span><span class="builtintype" id="2370316">byte</span><span class="op" id="2370320">,</span>&nbsp;<span class="ident" id="2370322">nByte</span><span class="op" id="2370327">)</span><br>
<span class="lineno"></span><span class="keyword" id="2370329">var</span>&nbsp;<span class="ident" id="2370333">padSpaceBytes</span>&nbsp;<span class="op" id="2370347">=</span>&nbsp;<span class="builtinfunc" id="2370349">make</span><span class="op" id="2370353">(</span><span class="op" id="2370354">[</span><span class="op" id="2370355">]</span><span class="builtintype" id="2370356">byte</span><span class="op" id="2370360">,</span>&nbsp;<span class="ident" id="2370362">nByte</span><span class="op" id="2370367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2370370">func</span>&nbsp;<span class="ident" id="2370375">init</span><span class="op" id="2370379">(</span><span class="op" id="2370380">)</span>&nbsp;<span class="op" id="2370382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2370385">for</span>&nbsp;<span class="ident" id="2370389">i</span>&nbsp;<span class="op" id="2370391">:=</span>&nbsp;<span class="num" id="2370394">0</span><span class="op" id="2370395">;</span>&nbsp;<span class="ident" id="2370397">i</span>&nbsp;<span class="op" id="2370399">&lt;</span>&nbsp;<span class="ident" id="2370401">nByte</span><span class="op" id="2370406">;</span>&nbsp;<span class="ident" id="2370408">i</span><span class="op" id="2370409">++</span>&nbsp;<span class="op" id="2370412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370416">padZeroBytes</span><span class="op" id="2370428">[</span><span class="ident" id="2370429">i</span><span class="op" id="2370430">]</span>&nbsp;<span class="op" id="2370432">=</span>&nbsp;<span class="string" id="2370434">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370440">padSpaceBytes</span><span class="op" id="2370453">[</span><span class="ident" id="2370454">i</span><span class="op" id="2370455">]</span>&nbsp;<span class="op" id="2370457">=</span>&nbsp;<span class="string" id="2370459">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2370464">}</span><br>
<span class="lineno">35</span><span class="op" id="2370466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2370469">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2370525">type</span>&nbsp;<span class="ident" id="2370530">fmtFlags</span>&nbsp;<span class="keyword" id="2370539">struct</span>&nbsp;<span class="op" id="2370546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370549">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2370561">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370567">precPresent</span>&nbsp;<span class="builtintype" id="2370579">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370585">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370597">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370603">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370615">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370621">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370633">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370639">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370651">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370657">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370669">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370675">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370687">bool</span>&nbsp;<span class="comment" id="2370692">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370733">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2370745">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2370752">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2370811">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2370878">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370932">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2370939">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2370945">sharpV</span>&nbsp;<span class="builtintype" id="2370952">bool</span><br>
<span class="lineno"></span><span class="op" id="2370957">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2370960">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2371010">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2371069">type</span>&nbsp;<span class="ident" id="2371074">fmt</span>&nbsp;<span class="keyword" id="2371078">struct</span>&nbsp;<span class="op" id="2371085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371088">intbuf</span>&nbsp;<span class="op" id="2371095">[</span><span class="ident" id="2371096">nByte</span><span class="op" id="2371101">]</span><span class="builtintype" id="2371102">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371108">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2371115">*</span><span class="ident" id="2371116">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2371124">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371145">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2371150">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371155">prec</span>&nbsp;<span class="builtintype" id="2371160">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371165">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2371174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2371177">func</span>&nbsp;<span class="op" id="2371182">(</span><span class="ident" id="2371183">f</span>&nbsp;<span class="op" id="2371185">*</span><span class="ident" id="2371186">fmt</span><span class="op" id="2371189">)</span>&nbsp;<span class="ident" id="2371191">clearflags</span><span class="op" id="2371201">(</span><span class="op" id="2371202">)</span>&nbsp;<span class="op" id="2371204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371207">f</span><span class="op" id="2371208">.</span><span class="ident" id="2371209">fmtFlags</span>&nbsp;<span class="op" id="2371218">=</span>&nbsp;<span class="ident" id="2371220">fmtFlags</span><span class="op" id="2371228">{</span><span class="op" id="2371229">}</span><br>
<span class="lineno"></span><span class="op" id="2371231">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2371234">func</span>&nbsp;<span class="op" id="2371239">(</span><span class="ident" id="2371240">f</span>&nbsp;<span class="op" id="2371242">*</span><span class="ident" id="2371243">fmt</span><span class="op" id="2371246">)</span>&nbsp;<span class="ident" id="2371248">init</span><span class="op" id="2371252">(</span><span class="ident" id="2371253">buf</span>&nbsp;<span class="op" id="2371257">*</span><span class="ident" id="2371258">buffer</span><span class="op" id="2371264">)</span>&nbsp;<span class="op" id="2371266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371269">f</span><span class="op" id="2371270">.</span><span class="ident" id="2371271">buf</span>&nbsp;<span class="op" id="2371275">=</span>&nbsp;<span class="ident" id="2371277">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371282">f</span><span class="op" id="2371283">.</span><span class="ident" id="2371284">clearflags</span><span class="op" id="2371294">(</span><span class="op" id="2371295">)</span><br>
<span class="lineno"></span><span class="op" id="2371297">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2371300">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2371386">func</span>&nbsp;<span class="op" id="2371391">(</span><span class="ident" id="2371392">f</span>&nbsp;<span class="op" id="2371394">*</span><span class="ident" id="2371395">fmt</span><span class="op" id="2371398">)</span>&nbsp;<span class="ident" id="2371400">computePadding</span><span class="op" id="2371414">(</span><span class="ident" id="2371415">width</span>&nbsp;<span class="builtintype" id="2371421">int</span><span class="op" id="2371424">)</span>&nbsp;<span class="op" id="2371426">(</span><span class="ident" id="2371427">padding</span>&nbsp;<span class="op" id="2371435">[</span><span class="op" id="2371436">]</span><span class="builtintype" id="2371437">byte</span><span class="op" id="2371441">,</span>&nbsp;<span class="ident" id="2371443">leftWidth</span><span class="op" id="2371452">,</span>&nbsp;<span class="ident" id="2371454">rightWidth</span>&nbsp;<span class="builtintype" id="2371465">int</span><span class="op" id="2371468">)</span>&nbsp;<span class="op" id="2371470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371473">left</span>&nbsp;<span class="op" id="2371478">:=</span>&nbsp;<span class="op" id="2371481">!</span><span class="ident" id="2371482">f</span><span class="op" id="2371483">.</span><span class="ident" id="2371484">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371491">w</span>&nbsp;<span class="op" id="2371493">:=</span>&nbsp;<span class="ident" id="2371496">f</span><span class="op" id="2371497">.</span><span class="ident" id="2371498">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371503">if</span>&nbsp;<span class="ident" id="2371506">w</span>&nbsp;<span class="op" id="2371508">&lt;</span>&nbsp;<span class="num" id="2371510">0</span>&nbsp;<span class="op" id="2371512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371516">left</span>&nbsp;<span class="op" id="2371521">=</span>&nbsp;<span class="builtintype" id="2371523">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371531">w</span>&nbsp;<span class="op" id="2371533">=</span>&nbsp;<span class="op" id="2371535">-</span><span class="ident" id="2371536">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371542">w</span>&nbsp;<span class="op" id="2371544">-=</span>&nbsp;<span class="ident" id="2371547">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371554">if</span>&nbsp;<span class="ident" id="2371557">w</span>&nbsp;<span class="op" id="2371559">&gt;</span>&nbsp;<span class="num" id="2371561">0</span>&nbsp;<span class="op" id="2371563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371567">if</span>&nbsp;<span class="ident" id="2371570">left</span>&nbsp;<span class="op" id="2371575">&amp;&amp;</span>&nbsp;<span class="ident" id="2371578">f</span><span class="op" id="2371579">.</span><span class="ident" id="2371580">zero</span>&nbsp;<span class="op" id="2371585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371590">return</span>&nbsp;<span class="ident" id="2371597">padZeroBytes</span><span class="op" id="2371609">,</span>&nbsp;<span class="ident" id="2371611">w</span><span class="op" id="2371612">,</span>&nbsp;<span class="num" id="2371614">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371622">if</span>&nbsp;<span class="ident" id="2371625">left</span>&nbsp;<span class="op" id="2371630">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371635">return</span>&nbsp;<span class="ident" id="2371642">padSpaceBytes</span><span class="op" id="2371655">,</span>&nbsp;<span class="ident" id="2371657">w</span><span class="op" id="2371658">,</span>&nbsp;<span class="num" id="2371660">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371664">}</span>&nbsp;<span class="keyword" id="2371666">else</span>&nbsp;<span class="op" id="2371671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2371676">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371717">return</span>&nbsp;<span class="ident" id="2371724">padSpaceBytes</span><span class="op" id="2371737">,</span>&nbsp;<span class="num" id="2371739">0</span><span class="op" id="2371740">,</span>&nbsp;<span class="ident" id="2371742">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371746">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371752">return</span><br>
<span class="lineno"></span><span class="op" id="2371759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2371762">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2371808">func</span>&nbsp;<span class="op" id="2371813">(</span><span class="ident" id="2371814">f</span>&nbsp;<span class="op" id="2371816">*</span><span class="ident" id="2371817">fmt</span><span class="op" id="2371820">)</span>&nbsp;<span class="ident" id="2371822">writePadding</span><span class="op" id="2371834">(</span><span class="ident" id="2371835">n</span>&nbsp;<span class="builtintype" id="2371837">int</span><span class="op" id="2371840">,</span>&nbsp;<span class="ident" id="2371842">padding</span>&nbsp;<span class="op" id="2371850">[</span><span class="op" id="2371851">]</span><span class="builtintype" id="2371852">byte</span><span class="op" id="2371856">)</span>&nbsp;<span class="op" id="2371858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371861">for</span>&nbsp;<span class="ident" id="2371865">n</span>&nbsp;<span class="op" id="2371867">&gt;</span>&nbsp;<span class="num" id="2371869">0</span>&nbsp;<span class="op" id="2371871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371875">m</span>&nbsp;<span class="op" id="2371877">:=</span>&nbsp;<span class="ident" id="2371880">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2371884">if</span>&nbsp;<span class="ident" id="2371887">m</span>&nbsp;<span class="op" id="2371889">&gt;</span>&nbsp;<span class="ident" id="2371891">nByte</span>&nbsp;<span class="op" id="2371897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371902">m</span>&nbsp;<span class="op" id="2371904">=</span>&nbsp;<span class="ident" id="2371906">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371918">f</span><span class="op" id="2371919">.</span><span class="ident" id="2371920">buf</span><span class="op" id="2371923">.</span><span class="ident" id="2371924">Write</span><span class="op" id="2371929">(</span><span class="ident" id="2371930">padding</span><span class="op" id="2371937">[</span><span class="num" id="2371938">0</span><span class="op" id="2371939">:</span><span class="ident" id="2371940">m</span><span class="op" id="2371941">]</span><span class="op" id="2371942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2371946">n</span>&nbsp;<span class="op" id="2371948">-=</span>&nbsp;<span class="ident" id="2371951">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2371954">}</span><br>
<span class="lineno"></span><span class="op" id="2371956">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2371959">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2372038">func</span>&nbsp;<span class="op" id="2372043">(</span><span class="ident" id="2372044">f</span>&nbsp;<span class="op" id="2372046">*</span><span class="ident" id="2372047">fmt</span><span class="op" id="2372050">)</span>&nbsp;<span class="ident" id="2372052">pad</span><span class="op" id="2372055">(</span><span class="ident" id="2372056">b</span>&nbsp;<span class="op" id="2372058">[</span><span class="op" id="2372059">]</span><span class="builtintype" id="2372060">byte</span><span class="op" id="2372064">)</span>&nbsp;<span class="op" id="2372066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372069">if</span>&nbsp;<span class="op" id="2372072">!</span><span class="ident" id="2372073">f</span><span class="op" id="2372074">.</span><span class="ident" id="2372075">widPresent</span>&nbsp;<span class="op" id="2372086">||</span>&nbsp;<span class="ident" id="2372089">f</span><span class="op" id="2372090">.</span><span class="ident" id="2372091">wid</span>&nbsp;<span class="op" id="2372095">==</span>&nbsp;<span class="num" id="2372098">0</span>&nbsp;<span class="op" id="2372100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372104">f</span><span class="op" id="2372105">.</span><span class="ident" id="2372106">buf</span><span class="op" id="2372109">.</span><span class="ident" id="2372110">Write</span><span class="op" id="2372115">(</span><span class="ident" id="2372116">b</span><span class="op" id="2372117">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372121">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372132">padding</span><span class="op" id="2372139">,</span>&nbsp;<span class="ident" id="2372141">left</span><span class="op" id="2372145">,</span>&nbsp;<span class="ident" id="2372147">right</span>&nbsp;<span class="op" id="2372153">:=</span>&nbsp;<span class="ident" id="2372156">f</span><span class="op" id="2372157">.</span><span class="ident" id="2372158">computePadding</span><span class="op" id="2372172">(</span><span class="ident" id="2372173">utf8</span><span class="op" id="2372177">.</span><span class="ident" id="2372178">RuneCount</span><span class="op" id="2372187">(</span><span class="ident" id="2372188">b</span><span class="op" id="2372189">)</span><span class="op" id="2372190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372193">if</span>&nbsp;<span class="ident" id="2372196">left</span>&nbsp;<span class="op" id="2372201">&gt;</span>&nbsp;<span class="num" id="2372203">0</span>&nbsp;<span class="op" id="2372205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372209">f</span><span class="op" id="2372210">.</span><span class="ident" id="2372211">writePadding</span><span class="op" id="2372223">(</span><span class="ident" id="2372224">left</span><span class="op" id="2372228">,</span>&nbsp;<span class="ident" id="2372230">padding</span><span class="op" id="2372237">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372243">f</span><span class="op" id="2372244">.</span><span class="ident" id="2372245">buf</span><span class="op" id="2372248">.</span><span class="ident" id="2372249">Write</span><span class="op" id="2372254">(</span><span class="ident" id="2372255">b</span><span class="op" id="2372256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372259">if</span>&nbsp;<span class="ident" id="2372262">right</span>&nbsp;<span class="op" id="2372268">&gt;</span>&nbsp;<span class="num" id="2372270">0</span>&nbsp;<span class="op" id="2372272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372276">f</span><span class="op" id="2372277">.</span><span class="ident" id="2372278">writePadding</span><span class="op" id="2372290">(</span><span class="ident" id="2372291">right</span><span class="op" id="2372296">,</span>&nbsp;<span class="ident" id="2372298">padding</span><span class="op" id="2372305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372308">}</span><br>
<span class="lineno">125</span><span class="op" id="2372310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2372313">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2372396">func</span>&nbsp;<span class="op" id="2372401">(</span><span class="ident" id="2372402">f</span>&nbsp;<span class="op" id="2372404">*</span><span class="ident" id="2372405">fmt</span><span class="op" id="2372408">)</span>&nbsp;<span class="ident" id="2372410">padString</span><span class="op" id="2372419">(</span><span class="ident" id="2372420">s</span>&nbsp;<span class="builtintype" id="2372422">string</span><span class="op" id="2372428">)</span>&nbsp;<span class="op" id="2372430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372433">if</span>&nbsp;<span class="op" id="2372436">!</span><span class="ident" id="2372437">f</span><span class="op" id="2372438">.</span><span class="ident" id="2372439">widPresent</span>&nbsp;<span class="op" id="2372450">||</span>&nbsp;<span class="ident" id="2372453">f</span><span class="op" id="2372454">.</span><span class="ident" id="2372455">wid</span>&nbsp;<span class="op" id="2372459">==</span>&nbsp;<span class="num" id="2372462">0</span>&nbsp;<span class="op" id="2372464">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372468">f</span><span class="op" id="2372469">.</span><span class="ident" id="2372470">buf</span><span class="op" id="2372473">.</span><span class="ident" id="2372474">WriteString</span><span class="op" id="2372485">(</span><span class="ident" id="2372486">s</span><span class="op" id="2372487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372491">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372502">padding</span><span class="op" id="2372509">,</span>&nbsp;<span class="ident" id="2372511">left</span><span class="op" id="2372515">,</span>&nbsp;<span class="ident" id="2372517">right</span>&nbsp;<span class="op" id="2372523">:=</span>&nbsp;<span class="ident" id="2372526">f</span><span class="op" id="2372527">.</span><span class="ident" id="2372528">computePadding</span><span class="op" id="2372542">(</span><span class="ident" id="2372543">utf8</span><span class="op" id="2372547">.</span><span class="ident" id="2372548">RuneCountInString</span><span class="op" id="2372565">(</span><span class="ident" id="2372566">s</span><span class="op" id="2372567">)</span><span class="op" id="2372568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372571">if</span>&nbsp;<span class="ident" id="2372574">left</span>&nbsp;<span class="op" id="2372579">&gt;</span>&nbsp;<span class="num" id="2372581">0</span>&nbsp;<span class="op" id="2372583">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372587">f</span><span class="op" id="2372588">.</span><span class="ident" id="2372589">writePadding</span><span class="op" id="2372601">(</span><span class="ident" id="2372602">left</span><span class="op" id="2372606">,</span>&nbsp;<span class="ident" id="2372608">padding</span><span class="op" id="2372615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372621">f</span><span class="op" id="2372622">.</span><span class="ident" id="2372623">buf</span><span class="op" id="2372626">.</span><span class="ident" id="2372627">WriteString</span><span class="op" id="2372638">(</span><span class="ident" id="2372639">s</span><span class="op" id="2372640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372643">if</span>&nbsp;<span class="ident" id="2372646">right</span>&nbsp;<span class="op" id="2372652">&gt;</span>&nbsp;<span class="num" id="2372654">0</span>&nbsp;<span class="op" id="2372656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372660">f</span><span class="op" id="2372661">.</span><span class="ident" id="2372662">writePadding</span><span class="op" id="2372674">(</span><span class="ident" id="2372675">right</span><span class="op" id="2372680">,</span>&nbsp;<span class="ident" id="2372682">padding</span><span class="op" id="2372689">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372692">}</span><br>
<span class="lineno"></span><span class="op" id="2372694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2372697">var</span>&nbsp;<span class="op" id="2372701">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372704">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2372715">=</span>&nbsp;<span class="op" id="2372717">[</span><span class="op" id="2372718">]</span><span class="builtintype" id="2372719">byte</span><span class="op" id="2372723">(</span><span class="string" id="2372724">&#34;true&#34;</span><span class="op" id="2372730">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372733">falseBytes</span>&nbsp;<span class="op" id="2372744">=</span>&nbsp;<span class="op" id="2372746">[</span><span class="op" id="2372747">]</span><span class="builtintype" id="2372748">byte</span><span class="op" id="2372752">(</span><span class="string" id="2372753">&#34;false&#34;</span><span class="op" id="2372760">)</span><br>
<span class="lineno"></span><span class="op" id="2372762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2372765">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2372799">func</span>&nbsp;<span class="op" id="2372804">(</span><span class="ident" id="2372805">f</span>&nbsp;<span class="op" id="2372807">*</span><span class="ident" id="2372808">fmt</span><span class="op" id="2372811">)</span>&nbsp;<span class="ident" id="2372813">fmt_boolean</span><span class="op" id="2372824">(</span><span class="ident" id="2372825">v</span>&nbsp;<span class="builtintype" id="2372827">bool</span><span class="op" id="2372831">)</span>&nbsp;<span class="op" id="2372833">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2372836">if</span>&nbsp;<span class="ident" id="2372839">v</span>&nbsp;<span class="op" id="2372841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372845">f</span><span class="op" id="2372846">.</span><span class="ident" id="2372847">pad</span><span class="op" id="2372850">(</span><span class="ident" id="2372851">trueBytes</span><span class="op" id="2372860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372863">}</span>&nbsp;<span class="keyword" id="2372865">else</span>&nbsp;<span class="op" id="2372870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2372874">f</span><span class="op" id="2372875">.</span><span class="ident" id="2372876">pad</span><span class="op" id="2372879">(</span><span class="ident" id="2372880">falseBytes</span><span class="op" id="2372890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2372893">}</span><br>
<span class="lineno">155</span><span class="op" id="2372895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2372898">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2372980">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2373011">func</span>&nbsp;<span class="op" id="2373016">(</span><span class="ident" id="2373017">f</span>&nbsp;<span class="op" id="2373019">*</span><span class="ident" id="2373020">fmt</span><span class="op" id="2373023">)</span>&nbsp;<span class="ident" id="2373025">integer</span><span class="op" id="2373032">(</span><span class="ident" id="2373033">a</span>&nbsp;<span class="ident" id="2373035">int64</span><span class="op" id="2373040">,</span>&nbsp;<span class="ident" id="2373042">base</span>&nbsp;<span class="ident" id="2373047">uint64</span><span class="op" id="2373053">,</span>&nbsp;<span class="ident" id="2373055">signedness</span>&nbsp;<span class="builtintype" id="2373066">bool</span><span class="op" id="2373070">,</span>&nbsp;<span class="ident" id="2373072">digits</span>&nbsp;<span class="builtintype" id="2373079">string</span><span class="op" id="2373085">)</span>&nbsp;<span class="op" id="2373087">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373090">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373146">if</span>&nbsp;<span class="ident" id="2373149">f</span><span class="op" id="2373150">.</span><span class="ident" id="2373151">precPresent</span>&nbsp;<span class="op" id="2373163">&amp;&amp;</span>&nbsp;<span class="ident" id="2373166">f</span><span class="op" id="2373167">.</span><span class="ident" id="2373168">prec</span>&nbsp;<span class="op" id="2373173">==</span>&nbsp;<span class="num" id="2373176">0</span>&nbsp;<span class="op" id="2373178">&amp;&amp;</span>&nbsp;<span class="ident" id="2373181">a</span>&nbsp;<span class="op" id="2373183">==</span>&nbsp;<span class="num" id="2373186">0</span>&nbsp;<span class="op" id="2373188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373192">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373204">var</span>&nbsp;<span class="ident" id="2373208">buf</span>&nbsp;<span class="op" id="2373212">[</span><span class="op" id="2373213">]</span><span class="builtintype" id="2373214">byte</span>&nbsp;<span class="op" id="2373219">=</span>&nbsp;<span class="ident" id="2373221">f</span><span class="op" id="2373222">.</span><span class="ident" id="2373223">intbuf</span><span class="op" id="2373229">[</span><span class="num" id="2373230">0</span><span class="op" id="2373231">:</span><span class="op" id="2373232">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373235">if</span>&nbsp;<span class="ident" id="2373238">f</span><span class="op" id="2373239">.</span><span class="ident" id="2373240">widPresent</span>&nbsp;<span class="op" id="2373251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373255">width</span>&nbsp;<span class="op" id="2373261">:=</span>&nbsp;<span class="ident" id="2373264">f</span><span class="op" id="2373265">.</span><span class="ident" id="2373266">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373272">if</span>&nbsp;<span class="ident" id="2373275">base</span>&nbsp;<span class="op" id="2373280">==</span>&nbsp;<span class="num" id="2373283">16</span>&nbsp;<span class="op" id="2373286">&amp;&amp;</span>&nbsp;<span class="ident" id="2373289">f</span><span class="op" id="2373290">.</span><span class="ident" id="2373291">sharp</span>&nbsp;<span class="op" id="2373297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373302">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373324">width</span>&nbsp;<span class="op" id="2373330">+=</span>&nbsp;<span class="num" id="2373333">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373341">if</span>&nbsp;<span class="ident" id="2373344">width</span>&nbsp;<span class="op" id="2373350">&gt;</span>&nbsp;<span class="ident" id="2373352">nByte</span>&nbsp;<span class="op" id="2373358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373363">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373404">buf</span>&nbsp;<span class="op" id="2373408">=</span>&nbsp;<span class="builtinfunc" id="2373410">make</span><span class="op" id="2373414">(</span><span class="op" id="2373415">[</span><span class="op" id="2373416">]</span><span class="builtintype" id="2373417">byte</span><span class="op" id="2373421">,</span>&nbsp;<span class="ident" id="2373423">width</span><span class="op" id="2373428">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373439">negative</span>&nbsp;<span class="op" id="2373448">:=</span>&nbsp;<span class="ident" id="2373451">signedness</span>&nbsp;<span class="op" id="2373462">==</span>&nbsp;<span class="ident" id="2373465">signed</span>&nbsp;<span class="op" id="2373472">&amp;&amp;</span>&nbsp;<span class="ident" id="2373475">a</span>&nbsp;<span class="op" id="2373477">&lt;</span>&nbsp;<span class="num" id="2373479">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373482">if</span>&nbsp;<span class="ident" id="2373485">negative</span>&nbsp;<span class="op" id="2373494">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373498">a</span>&nbsp;<span class="op" id="2373500">=</span>&nbsp;<span class="op" id="2373502">-</span><span class="ident" id="2373503">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373510">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373575">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373620">prec</span>&nbsp;<span class="op" id="2373625">:=</span>&nbsp;<span class="num" id="2373628">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373631">if</span>&nbsp;<span class="ident" id="2373634">f</span><span class="op" id="2373635">.</span><span class="ident" id="2373636">precPresent</span>&nbsp;<span class="op" id="2373648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373652">prec</span>&nbsp;<span class="op" id="2373657">=</span>&nbsp;<span class="ident" id="2373659">f</span><span class="op" id="2373660">.</span><span class="ident" id="2373661">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373668">f</span><span class="op" id="2373669">.</span><span class="ident" id="2373670">zero</span>&nbsp;<span class="op" id="2373675">=</span>&nbsp;<span class="builtintype" id="2373677">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373684">}</span>&nbsp;<span class="keyword" id="2373686">else</span>&nbsp;<span class="keyword" id="2373691">if</span>&nbsp;<span class="ident" id="2373694">f</span><span class="op" id="2373695">.</span><span class="ident" id="2373696">zero</span>&nbsp;<span class="op" id="2373701">&amp;&amp;</span>&nbsp;<span class="ident" id="2373704">f</span><span class="op" id="2373705">.</span><span class="ident" id="2373706">widPresent</span>&nbsp;<span class="op" id="2373717">&amp;&amp;</span>&nbsp;<span class="op" id="2373720">!</span><span class="ident" id="2373721">f</span><span class="op" id="2373722">.</span><span class="ident" id="2373723">minus</span>&nbsp;<span class="op" id="2373729">&amp;&amp;</span>&nbsp;<span class="ident" id="2373732">f</span><span class="op" id="2373733">.</span><span class="ident" id="2373734">wid</span>&nbsp;<span class="op" id="2373738">&gt;</span>&nbsp;<span class="num" id="2373740">0</span>&nbsp;<span class="op" id="2373742">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373746">prec</span>&nbsp;<span class="op" id="2373751">=</span>&nbsp;<span class="ident" id="2373753">f</span><span class="op" id="2373754">.</span><span class="ident" id="2373755">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2373761">if</span>&nbsp;<span class="ident" id="2373764">negative</span>&nbsp;<span class="op" id="2373773">||</span>&nbsp;<span class="ident" id="2373776">f</span><span class="op" id="2373777">.</span><span class="ident" id="2373778">plus</span>&nbsp;<span class="op" id="2373783">||</span>&nbsp;<span class="ident" id="2373786">f</span><span class="op" id="2373787">.</span><span class="ident" id="2373788">space</span>&nbsp;<span class="op" id="2373794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2373799">prec</span><span class="op" id="2373803">--</span>&nbsp;<span class="comment" id="2373806">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2373834">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373838">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373916">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2373970">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2374041">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374106">i</span>&nbsp;<span class="op" id="2374108">:=</span>&nbsp;<span class="builtinfunc" id="2374111">len</span><span class="op" id="2374114">(</span><span class="ident" id="2374115">buf</span><span class="op" id="2374118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374121">ua</span>&nbsp;<span class="op" id="2374124">:=</span>&nbsp;<span class="ident" id="2374127">uint64</span><span class="op" id="2374133">(</span><span class="ident" id="2374134">a</span><span class="op" id="2374135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2374138">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2374209">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374249">switch</span>&nbsp;<span class="ident" id="2374256">base</span>&nbsp;<span class="op" id="2374261">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374264">case</span>&nbsp;<span class="num" id="2374269">10</span><span class="op" id="2374271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374275">for</span>&nbsp;<span class="ident" id="2374279">ua</span>&nbsp;<span class="op" id="2374282">&gt;=</span>&nbsp;<span class="num" id="2374285">10</span>&nbsp;<span class="op" id="2374288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374293">i</span><span class="op" id="2374294">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374300">next</span>&nbsp;<span class="op" id="2374305">:=</span>&nbsp;<span class="ident" id="2374308">ua</span>&nbsp;<span class="op" id="2374311">/</span>&nbsp;<span class="num" id="2374313">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374319">buf</span><span class="op" id="2374322">[</span><span class="ident" id="2374323">i</span><span class="op" id="2374324">]</span>&nbsp;<span class="op" id="2374326">=</span>&nbsp;<span class="builtintype" id="2374328">byte</span><span class="op" id="2374332">(</span><span class="string" id="2374333">&#39;0&#39;</span>&nbsp;<span class="op" id="2374337">+</span>&nbsp;<span class="ident" id="2374339">ua</span>&nbsp;<span class="op" id="2374342">-</span>&nbsp;<span class="ident" id="2374344">next</span><span class="op" id="2374348">*</span><span class="num" id="2374349">10</span><span class="op" id="2374351">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374356">ua</span>&nbsp;<span class="op" id="2374359">=</span>&nbsp;<span class="ident" id="2374361">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374371">case</span>&nbsp;<span class="num" id="2374376">16</span><span class="op" id="2374378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374382">for</span>&nbsp;<span class="ident" id="2374386">ua</span>&nbsp;<span class="op" id="2374389">&gt;=</span>&nbsp;<span class="num" id="2374392">16</span>&nbsp;<span class="op" id="2374395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374400">i</span><span class="op" id="2374401">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374407">buf</span><span class="op" id="2374410">[</span><span class="ident" id="2374411">i</span><span class="op" id="2374412">]</span>&nbsp;<span class="op" id="2374414">=</span>&nbsp;<span class="ident" id="2374416">digits</span><span class="op" id="2374422">[</span><span class="ident" id="2374423">ua</span><span class="op" id="2374425">&amp;</span><span class="num" id="2374426">0xF</span><span class="op" id="2374429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374434">ua</span>&nbsp;<span class="op" id="2374437">&gt;&gt;=</span>&nbsp;<span class="num" id="2374441">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374448">case</span>&nbsp;<span class="num" id="2374453">8</span><span class="op" id="2374454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374458">for</span>&nbsp;<span class="ident" id="2374462">ua</span>&nbsp;<span class="op" id="2374465">&gt;=</span>&nbsp;<span class="num" id="2374468">8</span>&nbsp;<span class="op" id="2374470">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374475">i</span><span class="op" id="2374476">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374482">buf</span><span class="op" id="2374485">[</span><span class="ident" id="2374486">i</span><span class="op" id="2374487">]</span>&nbsp;<span class="op" id="2374489">=</span>&nbsp;<span class="builtintype" id="2374491">byte</span><span class="op" id="2374495">(</span><span class="string" id="2374496">&#39;0&#39;</span>&nbsp;<span class="op" id="2374500">+</span>&nbsp;<span class="ident" id="2374502">ua</span><span class="op" id="2374504">&amp;</span><span class="num" id="2374505">7</span><span class="op" id="2374506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374511">ua</span>&nbsp;<span class="op" id="2374514">&gt;&gt;=</span>&nbsp;<span class="num" id="2374518">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374525">case</span>&nbsp;<span class="num" id="2374530">2</span><span class="op" id="2374531">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374535">for</span>&nbsp;<span class="ident" id="2374539">ua</span>&nbsp;<span class="op" id="2374542">&gt;=</span>&nbsp;<span class="num" id="2374545">2</span>&nbsp;<span class="op" id="2374547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374552">i</span><span class="op" id="2374553">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374559">buf</span><span class="op" id="2374562">[</span><span class="ident" id="2374563">i</span><span class="op" id="2374564">]</span>&nbsp;<span class="op" id="2374566">=</span>&nbsp;<span class="builtintype" id="2374568">byte</span><span class="op" id="2374572">(</span><span class="string" id="2374573">&#39;0&#39;</span>&nbsp;<span class="op" id="2374577">+</span>&nbsp;<span class="ident" id="2374579">ua</span><span class="op" id="2374581">&amp;</span><span class="num" id="2374582">1</span><span class="op" id="2374583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374588">ua</span>&nbsp;<span class="op" id="2374591">&gt;&gt;=</span>&nbsp;<span class="num" id="2374595">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374599">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374602">default</span><span class="op" id="2374609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2374613">panic</span><span class="op" id="2374618">(</span><span class="string" id="2374619">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2374652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374658">i</span><span class="op" id="2374659">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374663">buf</span><span class="op" id="2374666">[</span><span class="ident" id="2374667">i</span><span class="op" id="2374668">]</span>&nbsp;<span class="op" id="2374670">=</span>&nbsp;<span class="ident" id="2374672">digits</span><span class="op" id="2374678">[</span><span class="ident" id="2374679">ua</span><span class="op" id="2374681">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374684">for</span>&nbsp;<span class="ident" id="2374688">i</span>&nbsp;<span class="op" id="2374690">&gt;</span>&nbsp;<span class="num" id="2374692">0</span>&nbsp;<span class="op" id="2374694">&amp;&amp;</span>&nbsp;<span class="ident" id="2374697">prec</span>&nbsp;<span class="op" id="2374702">&gt;</span>&nbsp;<span class="builtinfunc" id="2374704">len</span><span class="op" id="2374707">(</span><span class="ident" id="2374708">buf</span><span class="op" id="2374711">)</span><span class="op" id="2374712">-</span><span class="ident" id="2374713">i</span>&nbsp;<span class="op" id="2374715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374719">i</span><span class="op" id="2374720">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374725">buf</span><span class="op" id="2374728">[</span><span class="ident" id="2374729">i</span><span class="op" id="2374730">]</span>&nbsp;<span class="op" id="2374732">=</span>&nbsp;<span class="string" id="2374734">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2374743">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374777">if</span>&nbsp;<span class="ident" id="2374780">f</span><span class="op" id="2374781">.</span><span class="ident" id="2374782">sharp</span>&nbsp;<span class="op" id="2374788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374792">switch</span>&nbsp;<span class="ident" id="2374799">base</span>&nbsp;<span class="op" id="2374804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374808">case</span>&nbsp;<span class="num" id="2374813">8</span><span class="op" id="2374814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374819">if</span>&nbsp;<span class="ident" id="2374822">buf</span><span class="op" id="2374825">[</span><span class="ident" id="2374826">i</span><span class="op" id="2374827">]</span>&nbsp;<span class="op" id="2374829">!=</span>&nbsp;<span class="string" id="2374832">&#39;0&#39;</span>&nbsp;<span class="op" id="2374836">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374842">i</span><span class="op" id="2374843">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374850">buf</span><span class="op" id="2374853">[</span><span class="ident" id="2374854">i</span><span class="op" id="2374855">]</span>&nbsp;<span class="op" id="2374857">=</span>&nbsp;<span class="string" id="2374859">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374870">case</span>&nbsp;<span class="num" id="2374875">16</span><span class="op" id="2374877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374882">i</span><span class="op" id="2374883">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374889">buf</span><span class="op" id="2374892">[</span><span class="ident" id="2374893">i</span><span class="op" id="2374894">]</span>&nbsp;<span class="op" id="2374896">=</span>&nbsp;<span class="string" id="2374898">&#39;x&#39;</span>&nbsp;<span class="op" id="2374902">+</span>&nbsp;<span class="ident" id="2374904">digits</span><span class="op" id="2374910">[</span><span class="num" id="2374911">10</span><span class="op" id="2374913">]</span>&nbsp;<span class="op" id="2374915">-</span>&nbsp;<span class="string" id="2374917">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374924">i</span><span class="op" id="2374925">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374931">buf</span><span class="op" id="2374934">[</span><span class="ident" id="2374935">i</span><span class="op" id="2374936">]</span>&nbsp;<span class="op" id="2374938">=</span>&nbsp;<span class="string" id="2374940">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2374949">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2374952">if</span>&nbsp;<span class="ident" id="2374955">f</span><span class="op" id="2374956">.</span><span class="ident" id="2374957">unicode</span>&nbsp;<span class="op" id="2374965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374969">i</span><span class="op" id="2374970">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374975">buf</span><span class="op" id="2374978">[</span><span class="ident" id="2374979">i</span><span class="op" id="2374980">]</span>&nbsp;<span class="op" id="2374982">=</span>&nbsp;<span class="string" id="2374984">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374990">i</span><span class="op" id="2374991">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2374996">buf</span><span class="op" id="2374999">[</span><span class="ident" id="2375000">i</span><span class="op" id="2375001">]</span>&nbsp;<span class="op" id="2375003">=</span>&nbsp;<span class="string" id="2375005">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375014">if</span>&nbsp;<span class="ident" id="2375017">negative</span>&nbsp;<span class="op" id="2375026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375030">i</span><span class="op" id="2375031">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375036">buf</span><span class="op" id="2375039">[</span><span class="ident" id="2375040">i</span><span class="op" id="2375041">]</span>&nbsp;<span class="op" id="2375043">=</span>&nbsp;<span class="string" id="2375045">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375050">}</span>&nbsp;<span class="keyword" id="2375052">else</span>&nbsp;<span class="keyword" id="2375057">if</span>&nbsp;<span class="ident" id="2375060">f</span><span class="op" id="2375061">.</span><span class="ident" id="2375062">plus</span>&nbsp;<span class="op" id="2375067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375071">i</span><span class="op" id="2375072">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375077">buf</span><span class="op" id="2375080">[</span><span class="ident" id="2375081">i</span><span class="op" id="2375082">]</span>&nbsp;<span class="op" id="2375084">=</span>&nbsp;<span class="string" id="2375086">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375091">}</span>&nbsp;<span class="keyword" id="2375093">else</span>&nbsp;<span class="keyword" id="2375098">if</span>&nbsp;<span class="ident" id="2375101">f</span><span class="op" id="2375102">.</span><span class="ident" id="2375103">space</span>&nbsp;<span class="op" id="2375109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375113">i</span><span class="op" id="2375114">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375119">buf</span><span class="op" id="2375122">[</span><span class="ident" id="2375123">i</span><span class="op" id="2375124">]</span>&nbsp;<span class="op" id="2375126">=</span>&nbsp;<span class="string" id="2375128">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2375137">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375206">if</span>&nbsp;<span class="ident" id="2375209">f</span><span class="op" id="2375210">.</span><span class="ident" id="2375211">unicode</span>&nbsp;<span class="op" id="2375219">&amp;&amp;</span>&nbsp;<span class="ident" id="2375222">f</span><span class="op" id="2375223">.</span><span class="ident" id="2375224">uniQuote</span>&nbsp;<span class="op" id="2375233">&amp;&amp;</span>&nbsp;<span class="ident" id="2375236">a</span>&nbsp;<span class="op" id="2375238">&gt;=</span>&nbsp;<span class="num" id="2375241">0</span>&nbsp;<span class="op" id="2375243">&amp;&amp;</span>&nbsp;<span class="ident" id="2375246">a</span>&nbsp;<span class="op" id="2375248">&lt;=</span>&nbsp;<span class="ident" id="2375251">utf8</span><span class="op" id="2375255">.</span><span class="ident" id="2375256">MaxRune</span>&nbsp;<span class="op" id="2375264">&amp;&amp;</span>&nbsp;<span class="ident" id="2375267">strconv</span><span class="op" id="2375274">.</span><span class="ident" id="2375275">IsPrint</span><span class="op" id="2375282">(</span><span class="builtintype" id="2375283">rune</span><span class="op" id="2375287">(</span><span class="ident" id="2375288">a</span><span class="op" id="2375289">)</span><span class="op" id="2375290">)</span>&nbsp;<span class="op" id="2375292">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375296">runeWidth</span>&nbsp;<span class="op" id="2375306">:=</span>&nbsp;<span class="ident" id="2375309">utf8</span><span class="op" id="2375313">.</span><span class="ident" id="2375314">RuneLen</span><span class="op" id="2375321">(</span><span class="builtintype" id="2375322">rune</span><span class="op" id="2375326">(</span><span class="ident" id="2375327">a</span><span class="op" id="2375328">)</span><span class="op" id="2375329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375333">width</span>&nbsp;<span class="op" id="2375339">:=</span>&nbsp;<span class="num" id="2375342">1</span>&nbsp;<span class="op" id="2375344">+</span>&nbsp;<span class="num" id="2375346">1</span>&nbsp;<span class="op" id="2375348">+</span>&nbsp;<span class="ident" id="2375350">runeWidth</span>&nbsp;<span class="op" id="2375360">+</span>&nbsp;<span class="num" id="2375362">1</span>&nbsp;<span class="comment" id="2375364">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2375395">copy</span><span class="op" id="2375399">(</span><span class="ident" id="2375400">buf</span><span class="op" id="2375403">[</span><span class="ident" id="2375404">i</span><span class="op" id="2375405">-</span><span class="ident" id="2375406">width</span><span class="op" id="2375411">:</span><span class="op" id="2375412">]</span><span class="op" id="2375413">,</span>&nbsp;<span class="ident" id="2375415">buf</span><span class="op" id="2375418">[</span><span class="ident" id="2375419">i</span><span class="op" id="2375420">:</span><span class="op" id="2375421">]</span><span class="op" id="2375422">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2375426">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375463">i</span>&nbsp;<span class="op" id="2375465">-=</span>&nbsp;<span class="ident" id="2375468">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2375476">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375508">j</span>&nbsp;<span class="op" id="2375510">:=</span>&nbsp;<span class="builtinfunc" id="2375513">len</span><span class="op" id="2375516">(</span><span class="ident" id="2375517">buf</span><span class="op" id="2375520">)</span>&nbsp;<span class="op" id="2375522">-</span>&nbsp;<span class="ident" id="2375524">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375532">buf</span><span class="op" id="2375535">[</span><span class="ident" id="2375536">j</span><span class="op" id="2375537">]</span>&nbsp;<span class="op" id="2375539">=</span>&nbsp;<span class="string" id="2375541">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375547">j</span><span class="op" id="2375548">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375553">buf</span><span class="op" id="2375556">[</span><span class="ident" id="2375557">j</span><span class="op" id="2375558">]</span>&nbsp;<span class="op" id="2375560">=</span>&nbsp;<span class="string" id="2375562">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375569">j</span><span class="op" id="2375570">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375575">utf8</span><span class="op" id="2375579">.</span><span class="ident" id="2375580">EncodeRune</span><span class="op" id="2375590">(</span><span class="ident" id="2375591">buf</span><span class="op" id="2375594">[</span><span class="ident" id="2375595">j</span><span class="op" id="2375596">:</span><span class="op" id="2375597">]</span><span class="op" id="2375598">,</span>&nbsp;<span class="builtintype" id="2375600">rune</span><span class="op" id="2375604">(</span><span class="ident" id="2375605">a</span><span class="op" id="2375606">)</span><span class="op" id="2375607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375611">j</span>&nbsp;<span class="op" id="2375613">+=</span>&nbsp;<span class="ident" id="2375616">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375628">buf</span><span class="op" id="2375631">[</span><span class="ident" id="2375632">j</span><span class="op" id="2375633">]</span>&nbsp;<span class="op" id="2375635">=</span>&nbsp;<span class="string" id="2375637">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375647">f</span><span class="op" id="2375648">.</span><span class="ident" id="2375649">pad</span><span class="op" id="2375652">(</span><span class="ident" id="2375653">buf</span><span class="op" id="2375656">[</span><span class="ident" id="2375657">i</span><span class="op" id="2375658">:</span><span class="op" id="2375659">]</span><span class="op" id="2375660">)</span><br>
<span class="lineno"></span><span class="op" id="2375662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2375665">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2375738">func</span>&nbsp;<span class="op" id="2375743">(</span><span class="ident" id="2375744">f</span>&nbsp;<span class="op" id="2375746">*</span><span class="ident" id="2375747">fmt</span><span class="op" id="2375750">)</span>&nbsp;<span class="ident" id="2375752">truncate</span><span class="op" id="2375760">(</span><span class="ident" id="2375761">s</span>&nbsp;<span class="builtintype" id="2375763">string</span><span class="op" id="2375769">)</span>&nbsp;<span class="builtintype" id="2375771">string</span>&nbsp;<span class="op" id="2375778">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375781">if</span>&nbsp;<span class="ident" id="2375784">f</span><span class="op" id="2375785">.</span><span class="ident" id="2375786">precPresent</span>&nbsp;<span class="op" id="2375798">&amp;&amp;</span>&nbsp;<span class="ident" id="2375801">f</span><span class="op" id="2375802">.</span><span class="ident" id="2375803">prec</span>&nbsp;<span class="op" id="2375808">&lt;</span>&nbsp;<span class="ident" id="2375810">utf8</span><span class="op" id="2375814">.</span><span class="ident" id="2375815">RuneCountInString</span><span class="op" id="2375832">(</span><span class="ident" id="2375833">s</span><span class="op" id="2375834">)</span>&nbsp;<span class="op" id="2375836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375840">n</span>&nbsp;<span class="op" id="2375842">:=</span>&nbsp;<span class="ident" id="2375845">f</span><span class="op" id="2375846">.</span><span class="ident" id="2375847">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375854">for</span>&nbsp;<span class="ident" id="2375858">i</span>&nbsp;<span class="op" id="2375860">:=</span>&nbsp;<span class="keyword" id="2375863">range</span>&nbsp;<span class="ident" id="2375869">s</span>&nbsp;<span class="op" id="2375871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375876">if</span>&nbsp;<span class="ident" id="2375879">n</span>&nbsp;<span class="op" id="2375881">==</span>&nbsp;<span class="num" id="2375884">0</span>&nbsp;<span class="op" id="2375886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375892">s</span>&nbsp;<span class="op" id="2375894">=</span>&nbsp;<span class="ident" id="2375896">s</span><span class="op" id="2375897">[</span><span class="op" id="2375898">:</span><span class="ident" id="2375899">i</span><span class="op" id="2375900">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375906">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2375920">n</span><span class="op" id="2375921">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2375929">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2375932">return</span>&nbsp;<span class="ident" id="2375939">s</span><br>
<span class="lineno"></span><span class="op" id="2375941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2375944">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2375971">func</span>&nbsp;<span class="op" id="2375976">(</span><span class="ident" id="2375977">f</span>&nbsp;<span class="op" id="2375979">*</span><span class="ident" id="2375980">fmt</span><span class="op" id="2375983">)</span>&nbsp;<span class="ident" id="2375985">fmt_s</span><span class="op" id="2375990">(</span><span class="ident" id="2375991">s</span>&nbsp;<span class="builtintype" id="2375993">string</span><span class="op" id="2375999">)</span>&nbsp;<span class="op" id="2376001">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376004">s</span>&nbsp;<span class="op" id="2376006">=</span>&nbsp;<span class="ident" id="2376008">f</span><span class="op" id="2376009">.</span><span class="ident" id="2376010">truncate</span><span class="op" id="2376018">(</span><span class="ident" id="2376019">s</span><span class="op" id="2376020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376023">f</span><span class="op" id="2376024">.</span><span class="ident" id="2376025">padString</span><span class="op" id="2376034">(</span><span class="ident" id="2376035">s</span><span class="op" id="2376036">)</span><br>
<span class="lineno"></span><span class="op" id="2376038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2376041">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2376123">func</span>&nbsp;<span class="op" id="2376128">(</span><span class="ident" id="2376129">f</span>&nbsp;<span class="op" id="2376131">*</span><span class="ident" id="2376132">fmt</span><span class="op" id="2376135">)</span>&nbsp;<span class="ident" id="2376137">fmt_sbx</span><span class="op" id="2376144">(</span><span class="ident" id="2376145">s</span>&nbsp;<span class="builtintype" id="2376147">string</span><span class="op" id="2376153">,</span>&nbsp;<span class="ident" id="2376155">b</span>&nbsp;<span class="op" id="2376157">[</span><span class="op" id="2376158">]</span><span class="builtintype" id="2376159">byte</span><span class="op" id="2376163">,</span>&nbsp;<span class="ident" id="2376165">digits</span>&nbsp;<span class="builtintype" id="2376172">string</span><span class="op" id="2376178">)</span>&nbsp;<span class="op" id="2376180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376183">n</span>&nbsp;<span class="op" id="2376185">:=</span>&nbsp;<span class="builtinfunc" id="2376188">len</span><span class="op" id="2376191">(</span><span class="ident" id="2376192">b</span><span class="op" id="2376193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376196">if</span>&nbsp;<span class="ident" id="2376199">b</span>&nbsp;<span class="op" id="2376201">==</span>&nbsp;<span class="ident" id="2376204">nil</span>&nbsp;<span class="op" id="2376208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376212">n</span>&nbsp;<span class="op" id="2376214">=</span>&nbsp;<span class="builtinfunc" id="2376216">len</span><span class="op" id="2376219">(</span><span class="ident" id="2376220">s</span><span class="op" id="2376221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376224">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376227">x</span>&nbsp;<span class="op" id="2376229">:=</span>&nbsp;<span class="ident" id="2376232">digits</span><span class="op" id="2376238">[</span><span class="num" id="2376239">10</span><span class="op" id="2376241">]</span>&nbsp;<span class="op" id="2376243">-</span>&nbsp;<span class="string" id="2376245">&#39;a&#39;</span>&nbsp;<span class="op" id="2376249">+</span>&nbsp;<span class="string" id="2376251">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2376256">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376295">var</span>&nbsp;<span class="ident" id="2376299">buf</span>&nbsp;<span class="op" id="2376303">[</span><span class="op" id="2376304">]</span><span class="builtintype" id="2376305">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376311">for</span>&nbsp;<span class="ident" id="2376315">i</span>&nbsp;<span class="op" id="2376317">:=</span>&nbsp;<span class="num" id="2376320">0</span><span class="op" id="2376321">;</span>&nbsp;<span class="ident" id="2376323">i</span>&nbsp;<span class="op" id="2376325">&lt;</span>&nbsp;<span class="ident" id="2376327">n</span><span class="op" id="2376328">;</span>&nbsp;<span class="ident" id="2376330">i</span><span class="op" id="2376331">++</span>&nbsp;<span class="op" id="2376334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376338">if</span>&nbsp;<span class="ident" id="2376341">i</span>&nbsp;<span class="op" id="2376343">&gt;</span>&nbsp;<span class="num" id="2376345">0</span>&nbsp;<span class="op" id="2376347">&amp;&amp;</span>&nbsp;<span class="ident" id="2376350">f</span><span class="op" id="2376351">.</span><span class="ident" id="2376352">space</span>&nbsp;<span class="op" id="2376358">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376363">buf</span>&nbsp;<span class="op" id="2376367">=</span>&nbsp;<span class="builtinfunc" id="2376369">append</span><span class="op" id="2376375">(</span><span class="ident" id="2376376">buf</span><span class="op" id="2376379">,</span>&nbsp;<span class="string" id="2376381">&#39;&nbsp;&#39;</span><span class="op" id="2376384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376392">if</span>&nbsp;<span class="ident" id="2376395">f</span><span class="op" id="2376396">.</span><span class="ident" id="2376397">sharp</span>&nbsp;<span class="op" id="2376403">&amp;&amp;</span>&nbsp;<span class="op" id="2376406">(</span><span class="ident" id="2376407">f</span><span class="op" id="2376408">.</span><span class="ident" id="2376409">space</span>&nbsp;<span class="op" id="2376415">||</span>&nbsp;<span class="ident" id="2376418">i</span>&nbsp;<span class="op" id="2376420">==</span>&nbsp;<span class="num" id="2376423">0</span><span class="op" id="2376424">)</span>&nbsp;<span class="op" id="2376426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376431">buf</span>&nbsp;<span class="op" id="2376435">=</span>&nbsp;<span class="builtinfunc" id="2376437">append</span><span class="op" id="2376443">(</span><span class="ident" id="2376444">buf</span><span class="op" id="2376447">,</span>&nbsp;<span class="string" id="2376449">&#39;0&#39;</span><span class="op" id="2376452">,</span>&nbsp;<span class="ident" id="2376454">x</span><span class="op" id="2376455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376459">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376463">var</span>&nbsp;<span class="ident" id="2376467">c</span>&nbsp;<span class="builtintype" id="2376469">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376476">if</span>&nbsp;<span class="ident" id="2376479">b</span>&nbsp;<span class="op" id="2376481">==</span>&nbsp;<span class="ident" id="2376484">nil</span>&nbsp;<span class="op" id="2376488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376493">c</span>&nbsp;<span class="op" id="2376495">=</span>&nbsp;<span class="ident" id="2376497">s</span><span class="op" id="2376498">[</span><span class="ident" id="2376499">i</span><span class="op" id="2376500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376504">}</span>&nbsp;<span class="keyword" id="2376506">else</span>&nbsp;<span class="op" id="2376511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376516">c</span>&nbsp;<span class="op" id="2376518">=</span>&nbsp;<span class="ident" id="2376520">b</span><span class="op" id="2376521">[</span><span class="ident" id="2376522">i</span><span class="op" id="2376523">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376531">buf</span>&nbsp;<span class="op" id="2376535">=</span>&nbsp;<span class="builtinfunc" id="2376537">append</span><span class="op" id="2376543">(</span><span class="ident" id="2376544">buf</span><span class="op" id="2376547">,</span>&nbsp;<span class="ident" id="2376549">digits</span><span class="op" id="2376555">[</span><span class="ident" id="2376556">c</span><span class="op" id="2376557">&gt;&gt;</span><span class="num" id="2376559">4</span><span class="op" id="2376560">]</span><span class="op" id="2376561">,</span>&nbsp;<span class="ident" id="2376563">digits</span><span class="op" id="2376569">[</span><span class="ident" id="2376570">c</span><span class="op" id="2376571">&amp;</span><span class="num" id="2376572">0xF</span><span class="op" id="2376575">]</span><span class="op" id="2376576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376582">f</span><span class="op" id="2376583">.</span><span class="ident" id="2376584">pad</span><span class="op" id="2376587">(</span><span class="ident" id="2376588">buf</span><span class="op" id="2376591">)</span><br>
<span class="lineno"></span><span class="op" id="2376593">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2376596">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2376663">func</span>&nbsp;<span class="op" id="2376668">(</span><span class="ident" id="2376669">f</span>&nbsp;<span class="op" id="2376671">*</span><span class="ident" id="2376672">fmt</span><span class="op" id="2376675">)</span>&nbsp;<span class="ident" id="2376677">fmt_sx</span><span class="op" id="2376683">(</span><span class="ident" id="2376684">s</span><span class="op" id="2376685">,</span>&nbsp;<span class="ident" id="2376687">digits</span>&nbsp;<span class="builtintype" id="2376694">string</span><span class="op" id="2376700">)</span>&nbsp;<span class="op" id="2376702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376705">if</span>&nbsp;<span class="ident" id="2376708">f</span><span class="op" id="2376709">.</span><span class="ident" id="2376710">precPresent</span>&nbsp;<span class="op" id="2376722">&amp;&amp;</span>&nbsp;<span class="ident" id="2376725">f</span><span class="op" id="2376726">.</span><span class="ident" id="2376727">prec</span>&nbsp;<span class="op" id="2376732">&lt;</span>&nbsp;<span class="builtinfunc" id="2376734">len</span><span class="op" id="2376737">(</span><span class="ident" id="2376738">s</span><span class="op" id="2376739">)</span>&nbsp;<span class="op" id="2376741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376745">s</span>&nbsp;<span class="op" id="2376747">=</span>&nbsp;<span class="ident" id="2376749">s</span><span class="op" id="2376750">[</span><span class="op" id="2376751">:</span><span class="ident" id="2376752">f</span><span class="op" id="2376753">.</span><span class="ident" id="2376754">prec</span><span class="op" id="2376758">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376764">f</span><span class="op" id="2376765">.</span><span class="ident" id="2376766">fmt_sbx</span><span class="op" id="2376773">(</span><span class="ident" id="2376774">s</span><span class="op" id="2376775">,</span>&nbsp;<span class="ident" id="2376777">nil</span><span class="op" id="2376780">,</span>&nbsp;<span class="ident" id="2376782">digits</span><span class="op" id="2376788">)</span><br>
<span class="lineno"></span><span class="op" id="2376790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2376793">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2376864">func</span>&nbsp;<span class="op" id="2376869">(</span><span class="ident" id="2376870">f</span>&nbsp;<span class="op" id="2376872">*</span><span class="ident" id="2376873">fmt</span><span class="op" id="2376876">)</span>&nbsp;<span class="ident" id="2376878">fmt_bx</span><span class="op" id="2376884">(</span><span class="ident" id="2376885">b</span>&nbsp;<span class="op" id="2376887">[</span><span class="op" id="2376888">]</span><span class="builtintype" id="2376889">byte</span><span class="op" id="2376893">,</span>&nbsp;<span class="ident" id="2376895">digits</span>&nbsp;<span class="builtintype" id="2376902">string</span><span class="op" id="2376908">)</span>&nbsp;<span class="op" id="2376910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2376913">if</span>&nbsp;<span class="ident" id="2376916">f</span><span class="op" id="2376917">.</span><span class="ident" id="2376918">precPresent</span>&nbsp;<span class="op" id="2376930">&amp;&amp;</span>&nbsp;<span class="ident" id="2376933">f</span><span class="op" id="2376934">.</span><span class="ident" id="2376935">prec</span>&nbsp;<span class="op" id="2376940">&lt;</span>&nbsp;<span class="builtinfunc" id="2376942">len</span><span class="op" id="2376945">(</span><span class="ident" id="2376946">b</span><span class="op" id="2376947">)</span>&nbsp;<span class="op" id="2376949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376953">b</span>&nbsp;<span class="op" id="2376955">=</span>&nbsp;<span class="ident" id="2376957">b</span><span class="op" id="2376958">[</span><span class="op" id="2376959">:</span><span class="ident" id="2376960">f</span><span class="op" id="2376961">.</span><span class="ident" id="2376962">prec</span><span class="op" id="2376966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2376969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2376972">f</span><span class="op" id="2376973">.</span><span class="ident" id="2376974">fmt_sbx</span><span class="op" id="2376981">(</span><span class="string" id="2376982">&#34;&#34;</span><span class="op" id="2376984">,</span>&nbsp;<span class="ident" id="2376986">b</span><span class="op" id="2376987">,</span>&nbsp;<span class="ident" id="2376989">digits</span><span class="op" id="2376995">)</span><br>
<span class="lineno">355</span><span class="op" id="2376997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2377000">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2377074">func</span>&nbsp;<span class="op" id="2377079">(</span><span class="ident" id="2377080">f</span>&nbsp;<span class="op" id="2377082">*</span><span class="ident" id="2377083">fmt</span><span class="op" id="2377086">)</span>&nbsp;<span class="ident" id="2377088">fmt_q</span><span class="op" id="2377093">(</span><span class="ident" id="2377094">s</span>&nbsp;<span class="builtintype" id="2377096">string</span><span class="op" id="2377102">)</span>&nbsp;<span class="op" id="2377104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377107">s</span>&nbsp;<span class="op" id="2377109">=</span>&nbsp;<span class="ident" id="2377111">f</span><span class="op" id="2377112">.</span><span class="ident" id="2377113">truncate</span><span class="op" id="2377121">(</span><span class="ident" id="2377122">s</span><span class="op" id="2377123">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377126">var</span>&nbsp;<span class="ident" id="2377130">quoted</span>&nbsp;<span class="builtintype" id="2377137">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377145">if</span>&nbsp;<span class="ident" id="2377148">f</span><span class="op" id="2377149">.</span><span class="ident" id="2377150">sharp</span>&nbsp;<span class="op" id="2377156">&amp;&amp;</span>&nbsp;<span class="ident" id="2377159">strconv</span><span class="op" id="2377166">.</span><span class="ident" id="2377167">CanBackquote</span><span class="op" id="2377179">(</span><span class="ident" id="2377180">s</span><span class="op" id="2377181">)</span>&nbsp;<span class="op" id="2377183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377187">quoted</span>&nbsp;<span class="op" id="2377194">=</span>&nbsp;<span class="string" id="2377196">&#34;`&#34;</span>&nbsp;<span class="op" id="2377200">+</span>&nbsp;<span class="ident" id="2377202">s</span>&nbsp;<span class="op" id="2377204">+</span>&nbsp;<span class="string" id="2377206">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377211">}</span>&nbsp;<span class="keyword" id="2377213">else</span>&nbsp;<span class="op" id="2377218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377222">if</span>&nbsp;<span class="ident" id="2377225">f</span><span class="op" id="2377226">.</span><span class="ident" id="2377227">plus</span>&nbsp;<span class="op" id="2377232">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377237">quoted</span>&nbsp;<span class="op" id="2377244">=</span>&nbsp;<span class="ident" id="2377246">strconv</span><span class="op" id="2377253">.</span><span class="ident" id="2377254">QuoteToASCII</span><span class="op" id="2377266">(</span><span class="ident" id="2377267">s</span><span class="op" id="2377268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377272">}</span>&nbsp;<span class="keyword" id="2377274">else</span>&nbsp;<span class="op" id="2377279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377284">quoted</span>&nbsp;<span class="op" id="2377291">=</span>&nbsp;<span class="ident" id="2377293">strconv</span><span class="op" id="2377300">.</span><span class="ident" id="2377301">Quote</span><span class="op" id="2377306">(</span><span class="ident" id="2377307">s</span><span class="op" id="2377308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377315">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377318">f</span><span class="op" id="2377319">.</span><span class="ident" id="2377320">padString</span><span class="op" id="2377329">(</span><span class="ident" id="2377330">quoted</span><span class="op" id="2377336">)</span><br>
<span class="lineno"></span><span class="op" id="2377338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2377341">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2377422">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2377488">func</span>&nbsp;<span class="op" id="2377493">(</span><span class="ident" id="2377494">f</span>&nbsp;<span class="op" id="2377496">*</span><span class="ident" id="2377497">fmt</span><span class="op" id="2377500">)</span>&nbsp;<span class="ident" id="2377502">fmt_qc</span><span class="op" id="2377508">(</span><span class="ident" id="2377509">c</span>&nbsp;<span class="ident" id="2377511">int64</span><span class="op" id="2377516">)</span>&nbsp;<span class="op" id="2377518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377521">var</span>&nbsp;<span class="ident" id="2377525">quoted</span>&nbsp;<span class="op" id="2377532">[</span><span class="op" id="2377533">]</span><span class="builtintype" id="2377534">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377540">if</span>&nbsp;<span class="ident" id="2377543">f</span><span class="op" id="2377544">.</span><span class="ident" id="2377545">plus</span>&nbsp;<span class="op" id="2377550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377554">quoted</span>&nbsp;<span class="op" id="2377561">=</span>&nbsp;<span class="ident" id="2377563">strconv</span><span class="op" id="2377570">.</span><span class="ident" id="2377571">AppendQuoteRuneToASCII</span><span class="op" id="2377593">(</span><span class="ident" id="2377594">f</span><span class="op" id="2377595">.</span><span class="ident" id="2377596">intbuf</span><span class="op" id="2377602">[</span><span class="num" id="2377603">0</span><span class="op" id="2377604">:</span><span class="num" id="2377605">0</span><span class="op" id="2377606">]</span><span class="op" id="2377607">,</span>&nbsp;<span class="builtintype" id="2377609">rune</span><span class="op" id="2377613">(</span><span class="ident" id="2377614">c</span><span class="op" id="2377615">)</span><span class="op" id="2377616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377619">}</span>&nbsp;<span class="keyword" id="2377621">else</span>&nbsp;<span class="op" id="2377626">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377630">quoted</span>&nbsp;<span class="op" id="2377637">=</span>&nbsp;<span class="ident" id="2377639">strconv</span><span class="op" id="2377646">.</span><span class="ident" id="2377647">AppendQuoteRune</span><span class="op" id="2377662">(</span><span class="ident" id="2377663">f</span><span class="op" id="2377664">.</span><span class="ident" id="2377665">intbuf</span><span class="op" id="2377671">[</span><span class="num" id="2377672">0</span><span class="op" id="2377673">:</span><span class="num" id="2377674">0</span><span class="op" id="2377675">]</span><span class="op" id="2377676">,</span>&nbsp;<span class="builtintype" id="2377678">rune</span><span class="op" id="2377682">(</span><span class="ident" id="2377683">c</span><span class="op" id="2377684">)</span><span class="op" id="2377685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2377691">f</span><span class="op" id="2377692">.</span><span class="ident" id="2377693">pad</span><span class="op" id="2377696">(</span><span class="ident" id="2377697">quoted</span><span class="op" id="2377703">)</span><br>
<span class="lineno"></span><span class="op" id="2377705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2377708">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2377727">func</span>&nbsp;<span class="ident" id="2377732">doPrec</span><span class="op" id="2377738">(</span><span class="ident" id="2377739">f</span>&nbsp;<span class="op" id="2377741">*</span><span class="ident" id="2377742">fmt</span><span class="op" id="2377745">,</span>&nbsp;<span class="ident" id="2377747">def</span>&nbsp;<span class="builtintype" id="2377751">int</span><span class="op" id="2377754">)</span>&nbsp;<span class="builtintype" id="2377756">int</span>&nbsp;<span class="op" id="2377760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377763">if</span>&nbsp;<span class="ident" id="2377766">f</span><span class="op" id="2377767">.</span><span class="ident" id="2377768">precPresent</span>&nbsp;<span class="op" id="2377780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377784">return</span>&nbsp;<span class="ident" id="2377791">f</span><span class="op" id="2377792">.</span><span class="ident" id="2377793">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2377799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2377802">return</span>&nbsp;<span class="ident" id="2377809">def</span><br>
<span class="lineno"></span><span class="op" id="2377813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2377816">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2377917">func</span>&nbsp;<span class="op" id="2377922">(</span><span class="ident" id="2377923">f</span>&nbsp;<span class="op" id="2377925">*</span><span class="ident" id="2377926">fmt</span><span class="op" id="2377929">)</span>&nbsp;<span class="ident" id="2377931">formatFloat</span><span class="op" id="2377942">(</span><span class="ident" id="2377943">v</span>&nbsp;<span class="builtintype" id="2377945">float64</span><span class="op" id="2377952">,</span>&nbsp;<span class="ident" id="2377954">verb</span>&nbsp;<span class="builtintype" id="2377959">byte</span><span class="op" id="2377963">,</span>&nbsp;<span class="ident" id="2377965">prec</span><span class="op" id="2377969">,</span>&nbsp;<span class="ident" id="2377971">n</span>&nbsp;<span class="builtintype" id="2377973">int</span><span class="op" id="2377976">)</span>&nbsp;<span class="op" id="2377978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2377981">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378046">num</span>&nbsp;<span class="op" id="2378050">:=</span>&nbsp;<span class="ident" id="2378053">strconv</span><span class="op" id="2378060">.</span><span class="ident" id="2378061">AppendFloat</span><span class="op" id="2378072">(</span><span class="ident" id="2378073">f</span><span class="op" id="2378074">.</span><span class="ident" id="2378075">intbuf</span><span class="op" id="2378081">[</span><span class="num" id="2378082">0</span><span class="op" id="2378083">:</span><span class="num" id="2378084">1</span><span class="op" id="2378085">]</span><span class="op" id="2378086">,</span>&nbsp;<span class="ident" id="2378088">v</span><span class="op" id="2378089">,</span>&nbsp;<span class="ident" id="2378091">verb</span><span class="op" id="2378095">,</span>&nbsp;<span class="ident" id="2378097">prec</span><span class="op" id="2378101">,</span>&nbsp;<span class="ident" id="2378103">n</span><span class="op" id="2378104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378107">if</span>&nbsp;<span class="ident" id="2378110">num</span><span class="op" id="2378113">[</span><span class="num" id="2378114">1</span><span class="op" id="2378115">]</span>&nbsp;<span class="op" id="2378117">==</span>&nbsp;<span class="string" id="2378120">&#39;-&#39;</span>&nbsp;<span class="op" id="2378124">||</span>&nbsp;<span class="ident" id="2378127">num</span><span class="op" id="2378130">[</span><span class="num" id="2378131">1</span><span class="op" id="2378132">]</span>&nbsp;<span class="op" id="2378134">==</span>&nbsp;<span class="string" id="2378137">&#39;+&#39;</span>&nbsp;<span class="op" id="2378141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378145">num</span>&nbsp;<span class="op" id="2378149">=</span>&nbsp;<span class="ident" id="2378151">num</span><span class="op" id="2378154">[</span><span class="num" id="2378155">1</span><span class="op" id="2378156">:</span><span class="op" id="2378157">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378160">}</span>&nbsp;<span class="keyword" id="2378162">else</span>&nbsp;<span class="op" id="2378167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378171">num</span><span class="op" id="2378174">[</span><span class="num" id="2378175">0</span><span class="op" id="2378176">]</span>&nbsp;<span class="op" id="2378178">=</span>&nbsp;<span class="string" id="2378180">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378188">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378291">if</span>&nbsp;<span class="ident" id="2378294">math</span><span class="op" id="2378298">.</span><span class="ident" id="2378299">IsInf</span><span class="op" id="2378304">(</span><span class="ident" id="2378305">v</span><span class="op" id="2378306">,</span>&nbsp;<span class="num" id="2378308">0</span><span class="op" id="2378309">)</span>&nbsp;<span class="op" id="2378311">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378315">if</span>&nbsp;<span class="ident" id="2378318">f</span><span class="op" id="2378319">.</span><span class="ident" id="2378320">zero</span>&nbsp;<span class="op" id="2378325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378330">defer</span>&nbsp;<span class="keyword" id="2378336">func</span><span class="op" id="2378340">(</span><span class="op" id="2378341">)</span>&nbsp;<span class="op" id="2378343">{</span>&nbsp;<span class="ident" id="2378345">f</span><span class="op" id="2378346">.</span><span class="ident" id="2378347">zero</span>&nbsp;<span class="op" id="2378352">=</span>&nbsp;<span class="builtintype" id="2378354">true</span>&nbsp;<span class="op" id="2378359">}</span><span class="op" id="2378360">(</span><span class="op" id="2378361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378366">f</span><span class="op" id="2378367">.</span><span class="ident" id="2378368">zero</span>&nbsp;<span class="op" id="2378373">=</span>&nbsp;<span class="builtintype" id="2378375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378386">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378389">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378436">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378503">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378582">if</span>&nbsp;<span class="ident" id="2378585">f</span><span class="op" id="2378586">.</span><span class="ident" id="2378587">zero</span>&nbsp;<span class="op" id="2378592">&amp;&amp;</span>&nbsp;<span class="ident" id="2378595">f</span><span class="op" id="2378596">.</span><span class="ident" id="2378597">widPresent</span>&nbsp;<span class="op" id="2378608">&amp;&amp;</span>&nbsp;<span class="ident" id="2378611">f</span><span class="op" id="2378612">.</span><span class="ident" id="2378613">wid</span>&nbsp;<span class="op" id="2378617">&gt;</span>&nbsp;<span class="builtinfunc" id="2378619">len</span><span class="op" id="2378622">(</span><span class="ident" id="2378623">num</span><span class="op" id="2378626">)</span>&nbsp;<span class="op" id="2378628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378632">if</span>&nbsp;<span class="ident" id="2378635">f</span><span class="op" id="2378636">.</span><span class="ident" id="2378637">space</span>&nbsp;<span class="op" id="2378643">&amp;&amp;</span>&nbsp;<span class="ident" id="2378646">v</span>&nbsp;<span class="op" id="2378648">&gt;=</span>&nbsp;<span class="num" id="2378651">0</span>&nbsp;<span class="op" id="2378653">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378658">f</span><span class="op" id="2378659">.</span><span class="ident" id="2378660">buf</span><span class="op" id="2378663">.</span><span class="ident" id="2378664">WriteByte</span><span class="op" id="2378673">(</span><span class="string" id="2378674">&#39;&nbsp;&#39;</span><span class="op" id="2378677">)</span>&nbsp;<span class="comment" id="2378679">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378743">f</span><span class="op" id="2378744">.</span><span class="ident" id="2378745">wid</span><span class="op" id="2378748">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378753">}</span>&nbsp;<span class="keyword" id="2378755">else</span>&nbsp;<span class="keyword" id="2378760">if</span>&nbsp;<span class="ident" id="2378763">f</span><span class="op" id="2378764">.</span><span class="ident" id="2378765">plus</span>&nbsp;<span class="op" id="2378770">||</span>&nbsp;<span class="ident" id="2378773">v</span>&nbsp;<span class="op" id="2378775">&lt;</span>&nbsp;<span class="num" id="2378777">0</span>&nbsp;<span class="op" id="2378779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378784">f</span><span class="op" id="2378785">.</span><span class="ident" id="2378786">buf</span><span class="op" id="2378789">.</span><span class="ident" id="2378790">WriteByte</span><span class="op" id="2378799">(</span><span class="ident" id="2378800">num</span><span class="op" id="2378803">[</span><span class="num" id="2378804">0</span><span class="op" id="2378805">]</span><span class="op" id="2378806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378811">f</span><span class="op" id="2378812">.</span><span class="ident" id="2378813">wid</span><span class="op" id="2378816">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378825">f</span><span class="op" id="2378826">.</span><span class="ident" id="2378827">pad</span><span class="op" id="2378830">(</span><span class="ident" id="2378831">num</span><span class="op" id="2378834">[</span><span class="num" id="2378835">1</span><span class="op" id="2378836">:</span><span class="op" id="2378837">]</span><span class="op" id="2378838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378842">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378853">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378907">if</span>&nbsp;<span class="ident" id="2378910">f</span><span class="op" id="2378911">.</span><span class="ident" id="2378912">space</span>&nbsp;<span class="op" id="2378918">&amp;&amp;</span>&nbsp;<span class="ident" id="2378921">num</span><span class="op" id="2378924">[</span><span class="num" id="2378925">0</span><span class="op" id="2378926">]</span>&nbsp;<span class="op" id="2378928">==</span>&nbsp;<span class="string" id="2378931">&#39;+&#39;</span>&nbsp;<span class="op" id="2378935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378939">num</span><span class="op" id="2378942">[</span><span class="num" id="2378943">0</span><span class="op" id="2378944">]</span>&nbsp;<span class="op" id="2378946">=</span>&nbsp;<span class="string" id="2378948">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2378954">f</span><span class="op" id="2378955">.</span><span class="ident" id="2378956">pad</span><span class="op" id="2378959">(</span><span class="ident" id="2378960">num</span><span class="op" id="2378963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2378967">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2378975">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2378978">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2379058">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2379146">if</span>&nbsp;<span class="ident" id="2379149">f</span><span class="op" id="2379150">.</span><span class="ident" id="2379151">plus</span>&nbsp;<span class="op" id="2379156">||</span>&nbsp;<span class="ident" id="2379159">num</span><span class="op" id="2379162">[</span><span class="num" id="2379163">0</span><span class="op" id="2379164">]</span>&nbsp;<span class="op" id="2379166">==</span>&nbsp;<span class="string" id="2379169">&#39;-&#39;</span>&nbsp;<span class="op" id="2379173">||</span>&nbsp;<span class="ident" id="2379176">math</span><span class="op" id="2379180">.</span><span class="ident" id="2379181">IsInf</span><span class="op" id="2379186">(</span><span class="ident" id="2379187">v</span><span class="op" id="2379188">,</span>&nbsp;<span class="num" id="2379190">0</span><span class="op" id="2379191">)</span>&nbsp;<span class="op" id="2379193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379197">f</span><span class="op" id="2379198">.</span><span class="ident" id="2379199">pad</span><span class="op" id="2379202">(</span><span class="ident" id="2379203">num</span><span class="op" id="2379206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2379210">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2379218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2379221">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379301">f</span><span class="op" id="2379302">.</span><span class="ident" id="2379303">pad</span><span class="op" id="2379306">(</span><span class="ident" id="2379307">num</span><span class="op" id="2379310">[</span><span class="num" id="2379311">1</span><span class="op" id="2379312">:</span><span class="op" id="2379313">]</span><span class="op" id="2379314">)</span><br>
<span class="lineno"></span><span class="op" id="2379316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2379319">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2379371">func</span>&nbsp;<span class="op" id="2379376">(</span><span class="ident" id="2379377">f</span>&nbsp;<span class="op" id="2379379">*</span><span class="ident" id="2379380">fmt</span><span class="op" id="2379383">)</span>&nbsp;<span class="ident" id="2379385">fmt_e64</span><span class="op" id="2379392">(</span><span class="ident" id="2379393">v</span>&nbsp;<span class="builtintype" id="2379395">float64</span><span class="op" id="2379402">)</span>&nbsp;<span class="op" id="2379404">{</span>&nbsp;<span class="ident" id="2379406">f</span><span class="op" id="2379407">.</span><span class="ident" id="2379408">formatFloat</span><span class="op" id="2379419">(</span><span class="ident" id="2379420">v</span><span class="op" id="2379421">,</span>&nbsp;<span class="string" id="2379423">&#39;e&#39;</span><span class="op" id="2379426">,</span>&nbsp;<span class="ident" id="2379428">doPrec</span><span class="op" id="2379434">(</span><span class="ident" id="2379435">f</span><span class="op" id="2379436">,</span>&nbsp;<span class="num" id="2379438">6</span><span class="op" id="2379439">)</span><span class="op" id="2379440">,</span>&nbsp;<span class="num" id="2379442">64</span><span class="op" id="2379444">)</span>&nbsp;<span class="op" id="2379446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2379449">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2379501">func</span>&nbsp;<span class="op" id="2379506">(</span><span class="ident" id="2379507">f</span>&nbsp;<span class="op" id="2379509">*</span><span class="ident" id="2379510">fmt</span><span class="op" id="2379513">)</span>&nbsp;<span class="ident" id="2379515">fmt_E64</span><span class="op" id="2379522">(</span><span class="ident" id="2379523">v</span>&nbsp;<span class="builtintype" id="2379525">float64</span><span class="op" id="2379532">)</span>&nbsp;<span class="op" id="2379534">{</span>&nbsp;<span class="ident" id="2379536">f</span><span class="op" id="2379537">.</span><span class="ident" id="2379538">formatFloat</span><span class="op" id="2379549">(</span><span class="ident" id="2379550">v</span><span class="op" id="2379551">,</span>&nbsp;<span class="string" id="2379553">&#39;E&#39;</span><span class="op" id="2379556">,</span>&nbsp;<span class="ident" id="2379558">doPrec</span><span class="op" id="2379564">(</span><span class="ident" id="2379565">f</span><span class="op" id="2379566">,</span>&nbsp;<span class="num" id="2379568">6</span><span class="op" id="2379569">)</span><span class="op" id="2379570">,</span>&nbsp;<span class="num" id="2379572">64</span><span class="op" id="2379574">)</span>&nbsp;<span class="op" id="2379576">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2379579">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2379627">func</span>&nbsp;<span class="op" id="2379632">(</span><span class="ident" id="2379633">f</span>&nbsp;<span class="op" id="2379635">*</span><span class="ident" id="2379636">fmt</span><span class="op" id="2379639">)</span>&nbsp;<span class="ident" id="2379641">fmt_f64</span><span class="op" id="2379648">(</span><span class="ident" id="2379649">v</span>&nbsp;<span class="builtintype" id="2379651">float64</span><span class="op" id="2379658">)</span>&nbsp;<span class="op" id="2379660">{</span>&nbsp;<span class="ident" id="2379662">f</span><span class="op" id="2379663">.</span><span class="ident" id="2379664">formatFloat</span><span class="op" id="2379675">(</span><span class="ident" id="2379676">v</span><span class="op" id="2379677">,</span>&nbsp;<span class="string" id="2379679">&#39;f&#39;</span><span class="op" id="2379682">,</span>&nbsp;<span class="ident" id="2379684">doPrec</span><span class="op" id="2379690">(</span><span class="ident" id="2379691">f</span><span class="op" id="2379692">,</span>&nbsp;<span class="num" id="2379694">6</span><span class="op" id="2379695">)</span><span class="op" id="2379696">,</span>&nbsp;<span class="num" id="2379698">64</span><span class="op" id="2379700">)</span>&nbsp;<span class="op" id="2379702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2379705">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2379776">func</span>&nbsp;<span class="op" id="2379781">(</span><span class="ident" id="2379782">f</span>&nbsp;<span class="op" id="2379784">*</span><span class="ident" id="2379785">fmt</span><span class="op" id="2379788">)</span>&nbsp;<span class="ident" id="2379790">fmt_g64</span><span class="op" id="2379797">(</span><span class="ident" id="2379798">v</span>&nbsp;<span class="builtintype" id="2379800">float64</span><span class="op" id="2379807">)</span>&nbsp;<span class="op" id="2379809">{</span>&nbsp;<span class="ident" id="2379811">f</span><span class="op" id="2379812">.</span><span class="ident" id="2379813">formatFloat</span><span class="op" id="2379824">(</span><span class="ident" id="2379825">v</span><span class="op" id="2379826">,</span>&nbsp;<span class="string" id="2379828">&#39;g&#39;</span><span class="op" id="2379831">,</span>&nbsp;<span class="ident" id="2379833">doPrec</span><span class="op" id="2379839">(</span><span class="ident" id="2379840">f</span><span class="op" id="2379841">,</span>&nbsp;<span class="op" id="2379843">-</span><span class="num" id="2379844">1</span><span class="op" id="2379845">)</span><span class="op" id="2379846">,</span>&nbsp;<span class="num" id="2379848">64</span><span class="op" id="2379850">)</span>&nbsp;<span class="op" id="2379852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2379855">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2379926">func</span>&nbsp;<span class="op" id="2379931">(</span><span class="ident" id="2379932">f</span>&nbsp;<span class="op" id="2379934">*</span><span class="ident" id="2379935">fmt</span><span class="op" id="2379938">)</span>&nbsp;<span class="ident" id="2379940">fmt_G64</span><span class="op" id="2379947">(</span><span class="ident" id="2379948">v</span>&nbsp;<span class="builtintype" id="2379950">float64</span><span class="op" id="2379957">)</span>&nbsp;<span class="op" id="2379959">{</span>&nbsp;<span class="ident" id="2379961">f</span><span class="op" id="2379962">.</span><span class="ident" id="2379963">formatFloat</span><span class="op" id="2379974">(</span><span class="ident" id="2379975">v</span><span class="op" id="2379976">,</span>&nbsp;<span class="string" id="2379978">&#39;G&#39;</span><span class="op" id="2379981">,</span>&nbsp;<span class="ident" id="2379983">doPrec</span><span class="op" id="2379989">(</span><span class="ident" id="2379990">f</span><span class="op" id="2379991">,</span>&nbsp;<span class="op" id="2379993">-</span><span class="num" id="2379994">1</span><span class="op" id="2379995">)</span><span class="op" id="2379996">,</span>&nbsp;<span class="num" id="2379998">64</span><span class="op" id="2380000">)</span>&nbsp;<span class="op" id="2380002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2380005">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2380080">func</span>&nbsp;<span class="op" id="2380085">(</span><span class="ident" id="2380086">f</span>&nbsp;<span class="op" id="2380088">*</span><span class="ident" id="2380089">fmt</span><span class="op" id="2380092">)</span>&nbsp;<span class="ident" id="2380094">fmt_fb64</span><span class="op" id="2380102">(</span><span class="ident" id="2380103">v</span>&nbsp;<span class="builtintype" id="2380105">float64</span><span class="op" id="2380112">)</span>&nbsp;<span class="op" id="2380114">{</span>&nbsp;<span class="ident" id="2380116">f</span><span class="op" id="2380117">.</span><span class="ident" id="2380118">formatFloat</span><span class="op" id="2380129">(</span><span class="ident" id="2380130">v</span><span class="op" id="2380131">,</span>&nbsp;<span class="string" id="2380133">&#39;b&#39;</span><span class="op" id="2380136">,</span>&nbsp;<span class="num" id="2380138">0</span><span class="op" id="2380139">,</span>&nbsp;<span class="num" id="2380141">64</span><span class="op" id="2380143">)</span>&nbsp;<span class="op" id="2380145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380148">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2380159">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2380195">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380251">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2380303">func</span>&nbsp;<span class="op" id="2380308">(</span><span class="ident" id="2380309">f</span>&nbsp;<span class="op" id="2380311">*</span><span class="ident" id="2380312">fmt</span><span class="op" id="2380315">)</span>&nbsp;<span class="ident" id="2380317">fmt_e32</span><span class="op" id="2380324">(</span><span class="ident" id="2380325">v</span>&nbsp;<span class="builtintype" id="2380327">float32</span><span class="op" id="2380334">)</span>&nbsp;<span class="op" id="2380336">{</span>&nbsp;<span class="ident" id="2380338">f</span><span class="op" id="2380339">.</span><span class="ident" id="2380340">formatFloat</span><span class="op" id="2380351">(</span><span class="builtintype" id="2380352">float64</span><span class="op" id="2380359">(</span><span class="ident" id="2380360">v</span><span class="op" id="2380361">)</span><span class="op" id="2380362">,</span>&nbsp;<span class="string" id="2380364">&#39;e&#39;</span><span class="op" id="2380367">,</span>&nbsp;<span class="ident" id="2380369">doPrec</span><span class="op" id="2380375">(</span><span class="ident" id="2380376">f</span><span class="op" id="2380377">,</span>&nbsp;<span class="num" id="2380379">6</span><span class="op" id="2380380">)</span><span class="op" id="2380381">,</span>&nbsp;<span class="num" id="2380383">32</span><span class="op" id="2380385">)</span>&nbsp;<span class="op" id="2380387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2380390">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2380442">func</span>&nbsp;<span class="op" id="2380447">(</span><span class="ident" id="2380448">f</span>&nbsp;<span class="op" id="2380450">*</span><span class="ident" id="2380451">fmt</span><span class="op" id="2380454">)</span>&nbsp;<span class="ident" id="2380456">fmt_E32</span><span class="op" id="2380463">(</span><span class="ident" id="2380464">v</span>&nbsp;<span class="builtintype" id="2380466">float32</span><span class="op" id="2380473">)</span>&nbsp;<span class="op" id="2380475">{</span>&nbsp;<span class="ident" id="2380477">f</span><span class="op" id="2380478">.</span><span class="ident" id="2380479">formatFloat</span><span class="op" id="2380490">(</span><span class="builtintype" id="2380491">float64</span><span class="op" id="2380498">(</span><span class="ident" id="2380499">v</span><span class="op" id="2380500">)</span><span class="op" id="2380501">,</span>&nbsp;<span class="string" id="2380503">&#39;E&#39;</span><span class="op" id="2380506">,</span>&nbsp;<span class="ident" id="2380508">doPrec</span><span class="op" id="2380514">(</span><span class="ident" id="2380515">f</span><span class="op" id="2380516">,</span>&nbsp;<span class="num" id="2380518">6</span><span class="op" id="2380519">)</span><span class="op" id="2380520">,</span>&nbsp;<span class="num" id="2380522">32</span><span class="op" id="2380524">)</span>&nbsp;<span class="op" id="2380526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380529">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2380577">func</span>&nbsp;<span class="op" id="2380582">(</span><span class="ident" id="2380583">f</span>&nbsp;<span class="op" id="2380585">*</span><span class="ident" id="2380586">fmt</span><span class="op" id="2380589">)</span>&nbsp;<span class="ident" id="2380591">fmt_f32</span><span class="op" id="2380598">(</span><span class="ident" id="2380599">v</span>&nbsp;<span class="builtintype" id="2380601">float32</span><span class="op" id="2380608">)</span>&nbsp;<span class="op" id="2380610">{</span>&nbsp;<span class="ident" id="2380612">f</span><span class="op" id="2380613">.</span><span class="ident" id="2380614">formatFloat</span><span class="op" id="2380625">(</span><span class="builtintype" id="2380626">float64</span><span class="op" id="2380633">(</span><span class="ident" id="2380634">v</span><span class="op" id="2380635">)</span><span class="op" id="2380636">,</span>&nbsp;<span class="string" id="2380638">&#39;f&#39;</span><span class="op" id="2380641">,</span>&nbsp;<span class="ident" id="2380643">doPrec</span><span class="op" id="2380649">(</span><span class="ident" id="2380650">f</span><span class="op" id="2380651">,</span>&nbsp;<span class="num" id="2380653">6</span><span class="op" id="2380654">)</span><span class="op" id="2380655">,</span>&nbsp;<span class="num" id="2380657">32</span><span class="op" id="2380659">)</span>&nbsp;<span class="op" id="2380661">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2380664">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2380735">func</span>&nbsp;<span class="op" id="2380740">(</span><span class="ident" id="2380741">f</span>&nbsp;<span class="op" id="2380743">*</span><span class="ident" id="2380744">fmt</span><span class="op" id="2380747">)</span>&nbsp;<span class="ident" id="2380749">fmt_g32</span><span class="op" id="2380756">(</span><span class="ident" id="2380757">v</span>&nbsp;<span class="builtintype" id="2380759">float32</span><span class="op" id="2380766">)</span>&nbsp;<span class="op" id="2380768">{</span>&nbsp;<span class="ident" id="2380770">f</span><span class="op" id="2380771">.</span><span class="ident" id="2380772">formatFloat</span><span class="op" id="2380783">(</span><span class="builtintype" id="2380784">float64</span><span class="op" id="2380791">(</span><span class="ident" id="2380792">v</span><span class="op" id="2380793">)</span><span class="op" id="2380794">,</span>&nbsp;<span class="string" id="2380796">&#39;g&#39;</span><span class="op" id="2380799">,</span>&nbsp;<span class="ident" id="2380801">doPrec</span><span class="op" id="2380807">(</span><span class="ident" id="2380808">f</span><span class="op" id="2380809">,</span>&nbsp;<span class="op" id="2380811">-</span><span class="num" id="2380812">1</span><span class="op" id="2380813">)</span><span class="op" id="2380814">,</span>&nbsp;<span class="num" id="2380816">32</span><span class="op" id="2380818">)</span>&nbsp;<span class="op" id="2380820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380823">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2380894">func</span>&nbsp;<span class="op" id="2380899">(</span><span class="ident" id="2380900">f</span>&nbsp;<span class="op" id="2380902">*</span><span class="ident" id="2380903">fmt</span><span class="op" id="2380906">)</span>&nbsp;<span class="ident" id="2380908">fmt_G32</span><span class="op" id="2380915">(</span><span class="ident" id="2380916">v</span>&nbsp;<span class="builtintype" id="2380918">float32</span><span class="op" id="2380925">)</span>&nbsp;<span class="op" id="2380927">{</span>&nbsp;<span class="ident" id="2380929">f</span><span class="op" id="2380930">.</span><span class="ident" id="2380931">formatFloat</span><span class="op" id="2380942">(</span><span class="builtintype" id="2380943">float64</span><span class="op" id="2380950">(</span><span class="ident" id="2380951">v</span><span class="op" id="2380952">)</span><span class="op" id="2380953">,</span>&nbsp;<span class="string" id="2380955">&#39;G&#39;</span><span class="op" id="2380958">,</span>&nbsp;<span class="ident" id="2380960">doPrec</span><span class="op" id="2380966">(</span><span class="ident" id="2380967">f</span><span class="op" id="2380968">,</span>&nbsp;<span class="op" id="2380970">-</span><span class="num" id="2380971">1</span><span class="op" id="2380972">)</span><span class="op" id="2380973">,</span>&nbsp;<span class="num" id="2380975">32</span><span class="op" id="2380977">)</span>&nbsp;<span class="op" id="2380979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2380982">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2381057">func</span>&nbsp;<span class="op" id="2381062">(</span><span class="ident" id="2381063">f</span>&nbsp;<span class="op" id="2381065">*</span><span class="ident" id="2381066">fmt</span><span class="op" id="2381069">)</span>&nbsp;<span class="ident" id="2381071">fmt_fb32</span><span class="op" id="2381079">(</span><span class="ident" id="2381080">v</span>&nbsp;<span class="builtintype" id="2381082">float32</span><span class="op" id="2381089">)</span>&nbsp;<span class="op" id="2381091">{</span>&nbsp;<span class="ident" id="2381093">f</span><span class="op" id="2381094">.</span><span class="ident" id="2381095">formatFloat</span><span class="op" id="2381106">(</span><span class="builtintype" id="2381107">float64</span><span class="op" id="2381114">(</span><span class="ident" id="2381115">v</span><span class="op" id="2381116">)</span><span class="op" id="2381117">,</span>&nbsp;<span class="string" id="2381119">&#39;b&#39;</span><span class="op" id="2381122">,</span>&nbsp;<span class="num" id="2381124">0</span><span class="op" id="2381125">,</span>&nbsp;<span class="num" id="2381127">32</span><span class="op" id="2381129">)</span>&nbsp;<span class="op" id="2381131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2381134">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2381188">func</span>&nbsp;<span class="op" id="2381193">(</span><span class="ident" id="2381194">f</span>&nbsp;<span class="op" id="2381196">*</span><span class="ident" id="2381197">fmt</span><span class="op" id="2381200">)</span>&nbsp;<span class="ident" id="2381202">fmt_c64</span><span class="op" id="2381209">(</span><span class="ident" id="2381210">v</span>&nbsp;<span class="builtintype" id="2381212">complex64</span><span class="op" id="2381221">,</span>&nbsp;<span class="ident" id="2381223">verb</span>&nbsp;<span class="builtintype" id="2381228">rune</span><span class="op" id="2381232">)</span>&nbsp;<span class="op" id="2381234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381237">f</span><span class="op" id="2381238">.</span><span class="ident" id="2381239">fmt_complex</span><span class="op" id="2381250">(</span><span class="builtintype" id="2381251">float64</span><span class="op" id="2381258">(</span><span class="builtinfunc" id="2381259">real</span><span class="op" id="2381263">(</span><span class="ident" id="2381264">v</span><span class="op" id="2381265">)</span><span class="op" id="2381266">)</span><span class="op" id="2381267">,</span>&nbsp;<span class="builtintype" id="2381269">float64</span><span class="op" id="2381276">(</span><span class="builtinfunc" id="2381277">imag</span><span class="op" id="2381281">(</span><span class="ident" id="2381282">v</span><span class="op" id="2381283">)</span><span class="op" id="2381284">)</span><span class="op" id="2381285">,</span>&nbsp;<span class="num" id="2381287">32</span><span class="op" id="2381289">,</span>&nbsp;<span class="ident" id="2381291">verb</span><span class="op" id="2381295">)</span><br>
<span class="lineno"></span><span class="op" id="2381297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2381300">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2381356">func</span>&nbsp;<span class="op" id="2381361">(</span><span class="ident" id="2381362">f</span>&nbsp;<span class="op" id="2381364">*</span><span class="ident" id="2381365">fmt</span><span class="op" id="2381368">)</span>&nbsp;<span class="ident" id="2381370">fmt_c128</span><span class="op" id="2381378">(</span><span class="ident" id="2381379">v</span>&nbsp;<span class="builtintype" id="2381381">complex128</span><span class="op" id="2381391">,</span>&nbsp;<span class="ident" id="2381393">verb</span>&nbsp;<span class="builtintype" id="2381398">rune</span><span class="op" id="2381402">)</span>&nbsp;<span class="op" id="2381404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381407">f</span><span class="op" id="2381408">.</span><span class="ident" id="2381409">fmt_complex</span><span class="op" id="2381420">(</span><span class="builtinfunc" id="2381421">real</span><span class="op" id="2381425">(</span><span class="ident" id="2381426">v</span><span class="op" id="2381427">)</span><span class="op" id="2381428">,</span>&nbsp;<span class="builtinfunc" id="2381430">imag</span><span class="op" id="2381434">(</span><span class="ident" id="2381435">v</span><span class="op" id="2381436">)</span><span class="op" id="2381437">,</span>&nbsp;<span class="num" id="2381439">64</span><span class="op" id="2381441">,</span>&nbsp;<span class="ident" id="2381443">verb</span><span class="op" id="2381447">)</span><br>
<span class="lineno"></span><span class="op" id="2381449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2381452">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2381503">func</span>&nbsp;<span class="op" id="2381508">(</span><span class="ident" id="2381509">f</span>&nbsp;<span class="op" id="2381511">*</span><span class="ident" id="2381512">fmt</span><span class="op" id="2381515">)</span>&nbsp;<span class="ident" id="2381517">fmt_complex</span><span class="op" id="2381528">(</span><span class="ident" id="2381529">r</span><span class="op" id="2381530">,</span>&nbsp;<span class="ident" id="2381532">j</span>&nbsp;<span class="builtintype" id="2381534">float64</span><span class="op" id="2381541">,</span>&nbsp;<span class="ident" id="2381543">size</span>&nbsp;<span class="builtintype" id="2381548">int</span><span class="op" id="2381551">,</span>&nbsp;<span class="ident" id="2381553">verb</span>&nbsp;<span class="builtintype" id="2381558">rune</span><span class="op" id="2381562">)</span>&nbsp;<span class="op" id="2381564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381567">f</span><span class="op" id="2381568">.</span><span class="ident" id="2381569">buf</span><span class="op" id="2381572">.</span><span class="ident" id="2381573">WriteByte</span><span class="op" id="2381582">(</span><span class="string" id="2381583">&#39;(&#39;</span><span class="op" id="2381586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381589">oldPlus</span>&nbsp;<span class="op" id="2381597">:=</span>&nbsp;<span class="ident" id="2381600">f</span><span class="op" id="2381601">.</span><span class="ident" id="2381602">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381608">oldSpace</span>&nbsp;<span class="op" id="2381617">:=</span>&nbsp;<span class="ident" id="2381620">f</span><span class="op" id="2381621">.</span><span class="ident" id="2381622">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381629">oldWid</span>&nbsp;<span class="op" id="2381636">:=</span>&nbsp;<span class="ident" id="2381639">f</span><span class="op" id="2381640">.</span><span class="ident" id="2381641">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381646">for</span>&nbsp;<span class="ident" id="2381650">i</span>&nbsp;<span class="op" id="2381652">:=</span>&nbsp;<span class="num" id="2381655">0</span><span class="op" id="2381656">;</span>&nbsp;<span class="op" id="2381658">;</span>&nbsp;<span class="ident" id="2381660">i</span><span class="op" id="2381661">++</span>&nbsp;<span class="op" id="2381664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381668">switch</span>&nbsp;<span class="ident" id="2381675">verb</span>&nbsp;<span class="op" id="2381680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381684">case</span>&nbsp;<span class="string" id="2381689">&#39;b&#39;</span><span class="op" id="2381692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381697">f</span><span class="op" id="2381698">.</span><span class="ident" id="2381699">formatFloat</span><span class="op" id="2381710">(</span><span class="ident" id="2381711">r</span><span class="op" id="2381712">,</span>&nbsp;<span class="string" id="2381714">&#39;b&#39;</span><span class="op" id="2381717">,</span>&nbsp;<span class="num" id="2381719">0</span><span class="op" id="2381720">,</span>&nbsp;<span class="ident" id="2381722">size</span><span class="op" id="2381726">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381730">case</span>&nbsp;<span class="string" id="2381735">&#39;e&#39;</span><span class="op" id="2381738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381743">f</span><span class="op" id="2381744">.</span><span class="ident" id="2381745">formatFloat</span><span class="op" id="2381756">(</span><span class="ident" id="2381757">r</span><span class="op" id="2381758">,</span>&nbsp;<span class="string" id="2381760">&#39;e&#39;</span><span class="op" id="2381763">,</span>&nbsp;<span class="ident" id="2381765">doPrec</span><span class="op" id="2381771">(</span><span class="ident" id="2381772">f</span><span class="op" id="2381773">,</span>&nbsp;<span class="num" id="2381775">6</span><span class="op" id="2381776">)</span><span class="op" id="2381777">,</span>&nbsp;<span class="ident" id="2381779">size</span><span class="op" id="2381783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381787">case</span>&nbsp;<span class="string" id="2381792">&#39;E&#39;</span><span class="op" id="2381795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381800">f</span><span class="op" id="2381801">.</span><span class="ident" id="2381802">formatFloat</span><span class="op" id="2381813">(</span><span class="ident" id="2381814">r</span><span class="op" id="2381815">,</span>&nbsp;<span class="string" id="2381817">&#39;E&#39;</span><span class="op" id="2381820">,</span>&nbsp;<span class="ident" id="2381822">doPrec</span><span class="op" id="2381828">(</span><span class="ident" id="2381829">f</span><span class="op" id="2381830">,</span>&nbsp;<span class="num" id="2381832">6</span><span class="op" id="2381833">)</span><span class="op" id="2381834">,</span>&nbsp;<span class="ident" id="2381836">size</span><span class="op" id="2381840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381844">case</span>&nbsp;<span class="string" id="2381849">&#39;f&#39;</span><span class="op" id="2381852">,</span>&nbsp;<span class="string" id="2381854">&#39;F&#39;</span><span class="op" id="2381857">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381862">f</span><span class="op" id="2381863">.</span><span class="ident" id="2381864">formatFloat</span><span class="op" id="2381875">(</span><span class="ident" id="2381876">r</span><span class="op" id="2381877">,</span>&nbsp;<span class="string" id="2381879">&#39;f&#39;</span><span class="op" id="2381882">,</span>&nbsp;<span class="ident" id="2381884">doPrec</span><span class="op" id="2381890">(</span><span class="ident" id="2381891">f</span><span class="op" id="2381892">,</span>&nbsp;<span class="num" id="2381894">6</span><span class="op" id="2381895">)</span><span class="op" id="2381896">,</span>&nbsp;<span class="ident" id="2381898">size</span><span class="op" id="2381902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381906">case</span>&nbsp;<span class="string" id="2381911">&#39;g&#39;</span><span class="op" id="2381914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381919">f</span><span class="op" id="2381920">.</span><span class="ident" id="2381921">formatFloat</span><span class="op" id="2381932">(</span><span class="ident" id="2381933">r</span><span class="op" id="2381934">,</span>&nbsp;<span class="string" id="2381936">&#39;g&#39;</span><span class="op" id="2381939">,</span>&nbsp;<span class="ident" id="2381941">doPrec</span><span class="op" id="2381947">(</span><span class="ident" id="2381948">f</span><span class="op" id="2381949">,</span>&nbsp;<span class="op" id="2381951">-</span><span class="num" id="2381952">1</span><span class="op" id="2381953">)</span><span class="op" id="2381954">,</span>&nbsp;<span class="ident" id="2381956">size</span><span class="op" id="2381960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381964">case</span>&nbsp;<span class="string" id="2381969">&#39;G&#39;</span><span class="op" id="2381972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381977">f</span><span class="op" id="2381978">.</span><span class="ident" id="2381979">formatFloat</span><span class="op" id="2381990">(</span><span class="ident" id="2381991">r</span><span class="op" id="2381992">,</span>&nbsp;<span class="string" id="2381994">&#39;G&#39;</span><span class="op" id="2381997">,</span>&nbsp;<span class="ident" id="2381999">doPrec</span><span class="op" id="2382005">(</span><span class="ident" id="2382006">f</span><span class="op" id="2382007">,</span>&nbsp;<span class="op" id="2382009">-</span><span class="num" id="2382010">1</span><span class="op" id="2382011">)</span><span class="op" id="2382012">,</span>&nbsp;<span class="ident" id="2382014">size</span><span class="op" id="2382018">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382026">if</span>&nbsp;<span class="ident" id="2382029">i</span>&nbsp;<span class="op" id="2382031">!=</span>&nbsp;<span class="num" id="2382034">0</span>&nbsp;<span class="op" id="2382036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382041">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382053">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382092">f</span><span class="op" id="2382093">.</span><span class="ident" id="2382094">plus</span>&nbsp;<span class="op" id="2382099">=</span>&nbsp;<span class="builtintype" id="2382101">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382108">f</span><span class="op" id="2382109">.</span><span class="ident" id="2382110">space</span>&nbsp;<span class="op" id="2382116">=</span>&nbsp;<span class="builtintype" id="2382118">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382126">f</span><span class="op" id="2382127">.</span><span class="ident" id="2382128">wid</span>&nbsp;<span class="op" id="2382132">=</span>&nbsp;<span class="ident" id="2382134">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382143">r</span>&nbsp;<span class="op" id="2382145">=</span>&nbsp;<span class="ident" id="2382147">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382150">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382153">f</span><span class="op" id="2382154">.</span><span class="ident" id="2382155">space</span>&nbsp;<span class="op" id="2382161">=</span>&nbsp;<span class="ident" id="2382163">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382173">f</span><span class="op" id="2382174">.</span><span class="ident" id="2382175">plus</span>&nbsp;<span class="op" id="2382180">=</span>&nbsp;<span class="ident" id="2382182">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382191">f</span><span class="op" id="2382192">.</span><span class="ident" id="2382193">wid</span>&nbsp;<span class="op" id="2382197">=</span>&nbsp;<span class="ident" id="2382199">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382207">f</span><span class="op" id="2382208">.</span><span class="ident" id="2382209">buf</span><span class="op" id="2382212">.</span><span class="ident" id="2382213">Write</span><span class="op" id="2382218">(</span><span class="ident" id="2382219">irparenBytes</span><span class="op" id="2382231">)</span><br>
<span class="lineno"></span><span class="op" id="2382233">}</span>
</div>
</body>
</html>
