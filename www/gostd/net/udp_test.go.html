<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6728928">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6728984">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6729038">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6729089">package</span>&nbsp;<span class="ident" id="6729097">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6729102">import</span>&nbsp;<span class="op" id="6729109">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6729112">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6729123">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6729134">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6729145">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6729156">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6729163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6729166">func</span>&nbsp;<span class="ident" id="6729171">TestResolveUDPAddr</span><span class="op" id="6729189">(</span><span class="ident" id="6729190">t</span>&nbsp;<span class="op" id="6729192">*</span><span class="ident" id="6729193">testing</span><span class="op" id="6729200">.</span><span class="ident" id="6729201">T</span><span class="op" id="6729202">)</span>&nbsp;<span class="op" id="6729204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729207">for</span>&nbsp;<span class="ident" id="6729211">_</span><span class="op" id="6729212">,</span>&nbsp;<span class="ident" id="6729214">tt</span>&nbsp;<span class="op" id="6729217">:=</span>&nbsp;<span class="keyword" id="6729220">range</span>&nbsp;<span class="ident" id="6729226">resolveTCPAddrTests</span>&nbsp;<span class="op" id="6729246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729250">net</span>&nbsp;<span class="op" id="6729254">:=</span>&nbsp;<span class="ident" id="6729257">strings</span><span class="op" id="6729264">.</span><span class="ident" id="6729265">Replace</span><span class="op" id="6729272">(</span><span class="ident" id="6729273">tt</span><span class="op" id="6729275">.</span><span class="ident" id="6729276">net</span><span class="op" id="6729279">,</span>&nbsp;<span class="string" id="6729281">&#34;tcp&#34;</span><span class="op" id="6729286">,</span>&nbsp;<span class="string" id="6729288">&#34;udp&#34;</span><span class="op" id="6729293">,</span>&nbsp;<span class="op" id="6729295">-</span><span class="num" id="6729296">1</span><span class="op" id="6729297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729301">addr</span><span class="op" id="6729305">,</span>&nbsp;<span class="ident" id="6729307">err</span>&nbsp;<span class="op" id="6729311">:=</span>&nbsp;<span class="ident" id="6729314">ResolveUDPAddr</span><span class="op" id="6729328">(</span><span class="ident" id="6729329">net</span><span class="op" id="6729332">,</span>&nbsp;<span class="ident" id="6729334">tt</span><span class="op" id="6729336">.</span><span class="ident" id="6729337">litAddrOrName</span><span class="op" id="6729350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729354">if</span>&nbsp;<span class="ident" id="6729357">err</span>&nbsp;<span class="op" id="6729361">!=</span>&nbsp;<span class="ident" id="6729364">tt</span><span class="op" id="6729366">.</span><span class="ident" id="6729367">err</span>&nbsp;<span class="op" id="6729371">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729376">t</span><span class="op" id="6729377">.</span><span class="ident" id="6729378">Fatalf</span><span class="op" id="6729384">(</span><span class="string" id="6729385">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6729420">,</span>&nbsp;<span class="ident" id="6729422">net</span><span class="op" id="6729425">,</span>&nbsp;<span class="ident" id="6729427">tt</span><span class="op" id="6729429">.</span><span class="ident" id="6729430">litAddrOrName</span><span class="op" id="6729443">,</span>&nbsp;<span class="ident" id="6729445">err</span><span class="op" id="6729448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729456">if</span>&nbsp;<span class="op" id="6729459">!</span><span class="ident" id="6729460">reflect</span><span class="op" id="6729467">.</span><span class="ident" id="6729468">DeepEqual</span><span class="op" id="6729477">(</span><span class="ident" id="6729478">addr</span><span class="op" id="6729482">,</span>&nbsp;<span class="op" id="6729484">(</span><span class="op" id="6729485">*</span><span class="ident" id="6729486">UDPAddr</span><span class="op" id="6729493">)</span><span class="op" id="6729494">(</span><span class="ident" id="6729495">tt</span><span class="op" id="6729497">.</span><span class="ident" id="6729498">addr</span><span class="op" id="6729502">)</span><span class="op" id="6729503">)</span>&nbsp;<span class="op" id="6729505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729510">t</span><span class="op" id="6729511">.</span><span class="ident" id="6729512">Fatalf</span><span class="op" id="6729518">(</span><span class="string" id="6729519">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6729559">,</span>&nbsp;<span class="ident" id="6729561">net</span><span class="op" id="6729564">,</span>&nbsp;<span class="ident" id="6729566">tt</span><span class="op" id="6729568">.</span><span class="ident" id="6729569">litAddrOrName</span><span class="op" id="6729582">,</span>&nbsp;<span class="ident" id="6729584">addr</span><span class="op" id="6729588">,</span>&nbsp;<span class="ident" id="6729590">tt</span><span class="op" id="6729592">.</span><span class="ident" id="6729593">addr</span><span class="op" id="6729597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729601">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729605">if</span>&nbsp;<span class="ident" id="6729608">err</span>&nbsp;<span class="op" id="6729612">==</span>&nbsp;<span class="ident" id="6729615">nil</span>&nbsp;<span class="op" id="6729619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729624">str</span>&nbsp;<span class="op" id="6729628">:=</span>&nbsp;<span class="ident" id="6729631">addr</span><span class="op" id="6729635">.</span><span class="ident" id="6729636">String</span><span class="op" id="6729642">(</span><span class="op" id="6729643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729648">addr1</span><span class="op" id="6729653">,</span>&nbsp;<span class="ident" id="6729655">err</span>&nbsp;<span class="op" id="6729659">:=</span>&nbsp;<span class="ident" id="6729662">ResolveUDPAddr</span><span class="op" id="6729676">(</span><span class="ident" id="6729677">net</span><span class="op" id="6729680">,</span>&nbsp;<span class="ident" id="6729682">str</span><span class="op" id="6729685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729690">if</span>&nbsp;<span class="ident" id="6729693">err</span>&nbsp;<span class="op" id="6729697">!=</span>&nbsp;<span class="ident" id="6729700">nil</span>&nbsp;<span class="op" id="6729704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729710">t</span><span class="op" id="6729711">.</span><span class="ident" id="6729712">Fatalf</span><span class="op" id="6729718">(</span><span class="string" id="6729719">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="6729757">,</span>&nbsp;<span class="ident" id="6729759">net</span><span class="op" id="6729762">,</span>&nbsp;<span class="ident" id="6729764">str</span><span class="op" id="6729767">,</span>&nbsp;<span class="ident" id="6729769">tt</span><span class="op" id="6729771">.</span><span class="ident" id="6729772">litAddrOrName</span><span class="op" id="6729785">,</span>&nbsp;<span class="ident" id="6729787">err</span><span class="op" id="6729790">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729800">if</span>&nbsp;<span class="op" id="6729803">!</span><span class="ident" id="6729804">reflect</span><span class="op" id="6729811">.</span><span class="ident" id="6729812">DeepEqual</span><span class="op" id="6729821">(</span><span class="ident" id="6729822">addr1</span><span class="op" id="6729827">,</span>&nbsp;<span class="ident" id="6729829">addr</span><span class="op" id="6729833">)</span>&nbsp;<span class="op" id="6729835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6729841">t</span><span class="op" id="6729842">.</span><span class="ident" id="6729843">Fatalf</span><span class="op" id="6729849">(</span><span class="string" id="6729850">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6729900">,</span>&nbsp;<span class="ident" id="6729902">net</span><span class="op" id="6729905">,</span>&nbsp;<span class="ident" id="6729907">str</span><span class="op" id="6729910">,</span>&nbsp;<span class="ident" id="6729912">tt</span><span class="op" id="6729914">.</span><span class="ident" id="6729915">litAddrOrName</span><span class="op" id="6729928">,</span>&nbsp;<span class="ident" id="6729930">addr1</span><span class="op" id="6729935">,</span>&nbsp;<span class="ident" id="6729937">addr</span><span class="op" id="6729941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729950">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6729953">}</span><br>
<span class="lineno"></span><span class="op" id="6729955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6729958">func</span>&nbsp;<span class="ident" id="6729963">TestReadFromUDP</span><span class="op" id="6729978">(</span><span class="ident" id="6729979">t</span>&nbsp;<span class="op" id="6729981">*</span><span class="ident" id="6729982">testing</span><span class="op" id="6729989">.</span><span class="ident" id="6729990">T</span><span class="op" id="6729991">)</span>&nbsp;<span class="op" id="6729993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6729996">switch</span>&nbsp;<span class="ident" id="6730003">runtime</span><span class="op" id="6730010">.</span><span class="ident" id="6730011">GOOS</span>&nbsp;<span class="op" id="6730016">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730019">case</span>&nbsp;<span class="string" id="6730024">&#34;nacl&#34;</span><span class="op" id="6730030">,</span>&nbsp;<span class="string" id="6730032">&#34;plan9&#34;</span><span class="op" id="6730039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730043">t</span><span class="op" id="6730044">.</span><span class="ident" id="6730045">Skipf</span><span class="op" id="6730050">(</span><span class="string" id="6730051">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="6730088">,</span>&nbsp;<span class="ident" id="6730090">runtime</span><span class="op" id="6730097">.</span><span class="ident" id="6730098">GOOS</span><span class="op" id="6730102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730109">ra</span><span class="op" id="6730111">,</span>&nbsp;<span class="ident" id="6730113">err</span>&nbsp;<span class="op" id="6730117">:=</span>&nbsp;<span class="ident" id="6730120">ResolveUDPAddr</span><span class="op" id="6730134">(</span><span class="string" id="6730135">&#34;udp&#34;</span><span class="op" id="6730140">,</span>&nbsp;<span class="string" id="6730142">&#34;127.0.0.1:7&#34;</span><span class="op" id="6730155">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730158">if</span>&nbsp;<span class="ident" id="6730161">err</span>&nbsp;<span class="op" id="6730165">!=</span>&nbsp;<span class="ident" id="6730168">nil</span>&nbsp;<span class="op" id="6730172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730176">t</span><span class="op" id="6730177">.</span><span class="ident" id="6730178">Fatal</span><span class="op" id="6730183">(</span><span class="ident" id="6730184">err</span><span class="op" id="6730187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730194">la</span><span class="op" id="6730196">,</span>&nbsp;<span class="ident" id="6730198">err</span>&nbsp;<span class="op" id="6730202">:=</span>&nbsp;<span class="ident" id="6730205">ResolveUDPAddr</span><span class="op" id="6730219">(</span><span class="string" id="6730220">&#34;udp&#34;</span><span class="op" id="6730225">,</span>&nbsp;<span class="string" id="6730227">&#34;127.0.0.1:0&#34;</span><span class="op" id="6730240">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730243">if</span>&nbsp;<span class="ident" id="6730246">err</span>&nbsp;<span class="op" id="6730250">!=</span>&nbsp;<span class="ident" id="6730253">nil</span>&nbsp;<span class="op" id="6730257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730261">t</span><span class="op" id="6730262">.</span><span class="ident" id="6730263">Fatal</span><span class="op" id="6730268">(</span><span class="ident" id="6730269">err</span><span class="op" id="6730272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730279">c</span><span class="op" id="6730280">,</span>&nbsp;<span class="ident" id="6730282">err</span>&nbsp;<span class="op" id="6730286">:=</span>&nbsp;<span class="ident" id="6730289">ListenUDP</span><span class="op" id="6730298">(</span><span class="string" id="6730299">&#34;udp&#34;</span><span class="op" id="6730304">,</span>&nbsp;<span class="ident" id="6730306">la</span><span class="op" id="6730308">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730311">if</span>&nbsp;<span class="ident" id="6730314">err</span>&nbsp;<span class="op" id="6730318">!=</span>&nbsp;<span class="ident" id="6730321">nil</span>&nbsp;<span class="op" id="6730325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730329">t</span><span class="op" id="6730330">.</span><span class="ident" id="6730331">Fatal</span><span class="op" id="6730336">(</span><span class="ident" id="6730337">err</span><span class="op" id="6730340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730346">defer</span>&nbsp;<span class="ident" id="6730352">c</span><span class="op" id="6730353">.</span><span class="ident" id="6730354">Close</span><span class="op" id="6730359">(</span><span class="op" id="6730360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730364">_</span><span class="op" id="6730365">,</span>&nbsp;<span class="ident" id="6730367">err</span>&nbsp;<span class="op" id="6730371">=</span>&nbsp;<span class="ident" id="6730373">c</span><span class="op" id="6730374">.</span><span class="ident" id="6730375">WriteToUDP</span><span class="op" id="6730385">(</span><span class="op" id="6730386">[</span><span class="op" id="6730387">]</span><span class="builtintype" id="6730388">byte</span><span class="op" id="6730392">(</span><span class="string" id="6730393">&#34;a&#34;</span><span class="op" id="6730396">)</span><span class="op" id="6730397">,</span>&nbsp;<span class="ident" id="6730399">ra</span><span class="op" id="6730401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730404">if</span>&nbsp;<span class="ident" id="6730407">err</span>&nbsp;<span class="op" id="6730411">!=</span>&nbsp;<span class="ident" id="6730414">nil</span>&nbsp;<span class="op" id="6730418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730422">t</span><span class="op" id="6730423">.</span><span class="ident" id="6730424">Fatal</span><span class="op" id="6730429">(</span><span class="ident" id="6730430">err</span><span class="op" id="6730433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730440">err</span>&nbsp;<span class="op" id="6730444">=</span>&nbsp;<span class="ident" id="6730446">c</span><span class="op" id="6730447">.</span><span class="ident" id="6730448">SetDeadline</span><span class="op" id="6730459">(</span><span class="ident" id="6730460">time</span><span class="op" id="6730464">.</span><span class="ident" id="6730465">Now</span><span class="op" id="6730468">(</span><span class="op" id="6730469">)</span><span class="op" id="6730470">.</span><span class="ident" id="6730471">Add</span><span class="op" id="6730474">(</span><span class="num" id="6730475">100</span>&nbsp;<span class="op" id="6730479">*</span>&nbsp;<span class="ident" id="6730481">time</span><span class="op" id="6730485">.</span><span class="ident" id="6730486">Millisecond</span><span class="op" id="6730497">)</span><span class="op" id="6730498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730501">if</span>&nbsp;<span class="ident" id="6730504">err</span>&nbsp;<span class="op" id="6730508">!=</span>&nbsp;<span class="ident" id="6730511">nil</span>&nbsp;<span class="op" id="6730515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730519">t</span><span class="op" id="6730520">.</span><span class="ident" id="6730521">Fatal</span><span class="op" id="6730526">(</span><span class="ident" id="6730527">err</span><span class="op" id="6730530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730536">b</span>&nbsp;<span class="op" id="6730538">:=</span>&nbsp;<span class="builtinfunc" id="6730541">make</span><span class="op" id="6730545">(</span><span class="op" id="6730546">[</span><span class="op" id="6730547">]</span><span class="builtintype" id="6730548">byte</span><span class="op" id="6730552">,</span>&nbsp;<span class="num" id="6730554">1</span><span class="op" id="6730555">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730558">_</span><span class="op" id="6730559">,</span>&nbsp;<span class="ident" id="6730561">_</span><span class="op" id="6730562">,</span>&nbsp;<span class="ident" id="6730564">err</span>&nbsp;<span class="op" id="6730568">=</span>&nbsp;<span class="ident" id="6730570">c</span><span class="op" id="6730571">.</span><span class="ident" id="6730572">ReadFromUDP</span><span class="op" id="6730583">(</span><span class="ident" id="6730584">b</span><span class="op" id="6730585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730588">if</span>&nbsp;<span class="ident" id="6730591">err</span>&nbsp;<span class="op" id="6730595">==</span>&nbsp;<span class="ident" id="6730598">nil</span>&nbsp;<span class="op" id="6730602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730606">t</span><span class="op" id="6730607">.</span><span class="ident" id="6730608">Fatal</span><span class="op" id="6730613">(</span><span class="string" id="6730614">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6730639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730642">}</span>&nbsp;<span class="keyword" id="6730644">else</span>&nbsp;<span class="keyword" id="6730649">if</span>&nbsp;<span class="op" id="6730652">!</span><span class="ident" id="6730653">isTimeout</span><span class="op" id="6730662">(</span><span class="ident" id="6730663">err</span><span class="op" id="6730666">)</span>&nbsp;<span class="op" id="6730668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730672">t</span><span class="op" id="6730673">.</span><span class="ident" id="6730674">Fatal</span><span class="op" id="6730679">(</span><span class="ident" id="6730680">err</span><span class="op" id="6730683">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730686">}</span><br>
<span class="lineno"></span><span class="op" id="6730688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6730691">func</span>&nbsp;<span class="ident" id="6730696">TestWriteToUDP</span><span class="op" id="6730710">(</span><span class="ident" id="6730711">t</span>&nbsp;<span class="op" id="6730713">*</span><span class="ident" id="6730714">testing</span><span class="op" id="6730721">.</span><span class="ident" id="6730722">T</span><span class="op" id="6730723">)</span>&nbsp;<span class="op" id="6730725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730728">switch</span>&nbsp;<span class="ident" id="6730735">runtime</span><span class="op" id="6730742">.</span><span class="ident" id="6730743">GOOS</span>&nbsp;<span class="op" id="6730748">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730751">case</span>&nbsp;<span class="string" id="6730756">&#34;plan9&#34;</span><span class="op" id="6730763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730767">t</span><span class="op" id="6730768">.</span><span class="ident" id="6730769">Skipf</span><span class="op" id="6730774">(</span><span class="string" id="6730775">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6730796">,</span>&nbsp;<span class="ident" id="6730798">runtime</span><span class="op" id="6730805">.</span><span class="ident" id="6730806">GOOS</span><span class="op" id="6730810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730817">l</span><span class="op" id="6730818">,</span>&nbsp;<span class="ident" id="6730820">err</span>&nbsp;<span class="op" id="6730824">:=</span>&nbsp;<span class="ident" id="6730827">ListenPacket</span><span class="op" id="6730839">(</span><span class="string" id="6730840">&#34;udp&#34;</span><span class="op" id="6730845">,</span>&nbsp;<span class="string" id="6730847">&#34;127.0.0.1:0&#34;</span><span class="op" id="6730860">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730863">if</span>&nbsp;<span class="ident" id="6730866">err</span>&nbsp;<span class="op" id="6730870">!=</span>&nbsp;<span class="ident" id="6730873">nil</span>&nbsp;<span class="op" id="6730877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730881">t</span><span class="op" id="6730882">.</span><span class="ident" id="6730883">Fatalf</span><span class="op" id="6730889">(</span><span class="string" id="6730890">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6730909">,</span>&nbsp;<span class="ident" id="6730911">err</span><span class="op" id="6730914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6730917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6730920">defer</span>&nbsp;<span class="ident" id="6730926">l</span><span class="op" id="6730927">.</span><span class="ident" id="6730928">Close</span><span class="op" id="6730933">(</span><span class="op" id="6730934">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730938">testWriteToConn</span><span class="op" id="6730953">(</span><span class="ident" id="6730954">t</span><span class="op" id="6730955">,</span>&nbsp;<span class="ident" id="6730957">l</span><span class="op" id="6730958">.</span><span class="ident" id="6730959">LocalAddr</span><span class="op" id="6730968">(</span><span class="op" id="6730969">)</span><span class="op" id="6730970">.</span><span class="ident" id="6730971">String</span><span class="op" id="6730977">(</span><span class="op" id="6730978">)</span><span class="op" id="6730979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6730982">testWriteToPacketConn</span><span class="op" id="6731003">(</span><span class="ident" id="6731004">t</span><span class="op" id="6731005">,</span>&nbsp;<span class="ident" id="6731007">l</span><span class="op" id="6731008">.</span><span class="ident" id="6731009">LocalAddr</span><span class="op" id="6731018">(</span><span class="op" id="6731019">)</span><span class="op" id="6731020">.</span><span class="ident" id="6731021">String</span><span class="op" id="6731027">(</span><span class="op" id="6731028">)</span><span class="op" id="6731029">)</span><br>
<span class="lineno"></span><span class="op" id="6731031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6731034">func</span>&nbsp;<span class="ident" id="6731039">testWriteToConn</span><span class="op" id="6731054">(</span><span class="ident" id="6731055">t</span>&nbsp;<span class="op" id="6731057">*</span><span class="ident" id="6731058">testing</span><span class="op" id="6731065">.</span><span class="ident" id="6731066">T</span><span class="op" id="6731067">,</span>&nbsp;<span class="ident" id="6731069">raddr</span>&nbsp;<span class="builtintype" id="6731075">string</span><span class="op" id="6731081">)</span>&nbsp;<span class="op" id="6731083">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731086">c</span><span class="op" id="6731087">,</span>&nbsp;<span class="ident" id="6731089">err</span>&nbsp;<span class="op" id="6731093">:=</span>&nbsp;<span class="ident" id="6731096">Dial</span><span class="op" id="6731100">(</span><span class="string" id="6731101">&#34;udp&#34;</span><span class="op" id="6731106">,</span>&nbsp;<span class="ident" id="6731108">raddr</span><span class="op" id="6731113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731116">if</span>&nbsp;<span class="ident" id="6731119">err</span>&nbsp;<span class="op" id="6731123">!=</span>&nbsp;<span class="ident" id="6731126">nil</span>&nbsp;<span class="op" id="6731130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731134">t</span><span class="op" id="6731135">.</span><span class="ident" id="6731136">Fatalf</span><span class="op" id="6731142">(</span><span class="string" id="6731143">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731160">,</span>&nbsp;<span class="ident" id="6731162">err</span><span class="op" id="6731165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731171">defer</span>&nbsp;<span class="ident" id="6731177">c</span><span class="op" id="6731178">.</span><span class="ident" id="6731179">Close</span><span class="op" id="6731184">(</span><span class="op" id="6731185">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731189">ra</span><span class="op" id="6731191">,</span>&nbsp;<span class="ident" id="6731193">err</span>&nbsp;<span class="op" id="6731197">:=</span>&nbsp;<span class="ident" id="6731200">ResolveUDPAddr</span><span class="op" id="6731214">(</span><span class="string" id="6731215">&#34;udp&#34;</span><span class="op" id="6731220">,</span>&nbsp;<span class="ident" id="6731222">raddr</span><span class="op" id="6731227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731230">if</span>&nbsp;<span class="ident" id="6731233">err</span>&nbsp;<span class="op" id="6731237">!=</span>&nbsp;<span class="ident" id="6731240">nil</span>&nbsp;<span class="op" id="6731244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731248">t</span><span class="op" id="6731249">.</span><span class="ident" id="6731250">Fatalf</span><span class="op" id="6731256">(</span><span class="string" id="6731257">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731284">,</span>&nbsp;<span class="ident" id="6731286">err</span><span class="op" id="6731289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731292">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731296">_</span><span class="op" id="6731297">,</span>&nbsp;<span class="ident" id="6731299">err</span>&nbsp;<span class="op" id="6731303">=</span>&nbsp;<span class="ident" id="6731305">c</span><span class="op" id="6731306">.</span><span class="op" id="6731307">(</span><span class="op" id="6731308">*</span><span class="ident" id="6731309">UDPConn</span><span class="op" id="6731316">)</span><span class="op" id="6731317">.</span><span class="ident" id="6731318">WriteToUDP</span><span class="op" id="6731328">(</span><span class="op" id="6731329">[</span><span class="op" id="6731330">]</span><span class="builtintype" id="6731331">byte</span><span class="op" id="6731335">(</span><span class="string" id="6731336">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6731369">)</span><span class="op" id="6731370">,</span>&nbsp;<span class="ident" id="6731372">ra</span><span class="op" id="6731374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731377">if</span>&nbsp;<span class="ident" id="6731380">err</span>&nbsp;<span class="op" id="6731384">==</span>&nbsp;<span class="ident" id="6731387">nil</span>&nbsp;<span class="op" id="6731391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731395">t</span><span class="op" id="6731396">.</span><span class="ident" id="6731397">Fatal</span><span class="op" id="6731402">(</span><span class="string" id="6731403">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6731427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731430">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731433">if</span>&nbsp;<span class="ident" id="6731436">err</span>&nbsp;<span class="op" id="6731440">!=</span>&nbsp;<span class="ident" id="6731443">nil</span>&nbsp;<span class="op" id="6731447">&amp;&amp;</span>&nbsp;<span class="ident" id="6731450">err</span><span class="op" id="6731453">.</span><span class="op" id="6731454">(</span><span class="op" id="6731455">*</span><span class="ident" id="6731456">OpError</span><span class="op" id="6731463">)</span><span class="op" id="6731464">.</span><span class="ident" id="6731465">Err</span>&nbsp;<span class="op" id="6731469">!=</span>&nbsp;<span class="ident" id="6731472">ErrWriteToConnected</span>&nbsp;<span class="op" id="6731492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731496">t</span><span class="op" id="6731497">.</span><span class="ident" id="6731498">Fatalf</span><span class="op" id="6731504">(</span><span class="string" id="6731505">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6731556">,</span>&nbsp;<span class="ident" id="6731558">err</span><span class="op" id="6731561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731568">_</span><span class="op" id="6731569">,</span>&nbsp;<span class="ident" id="6731571">err</span>&nbsp;<span class="op" id="6731575">=</span>&nbsp;<span class="ident" id="6731577">c</span><span class="op" id="6731578">.</span><span class="op" id="6731579">(</span><span class="op" id="6731580">*</span><span class="ident" id="6731581">UDPConn</span><span class="op" id="6731588">)</span><span class="op" id="6731589">.</span><span class="ident" id="6731590">WriteTo</span><span class="op" id="6731597">(</span><span class="op" id="6731598">[</span><span class="op" id="6731599">]</span><span class="builtintype" id="6731600">byte</span><span class="op" id="6731604">(</span><span class="string" id="6731605">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6731638">)</span><span class="op" id="6731639">,</span>&nbsp;<span class="ident" id="6731641">ra</span><span class="op" id="6731643">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731646">if</span>&nbsp;<span class="ident" id="6731649">err</span>&nbsp;<span class="op" id="6731653">==</span>&nbsp;<span class="ident" id="6731656">nil</span>&nbsp;<span class="op" id="6731660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731664">t</span><span class="op" id="6731665">.</span><span class="ident" id="6731666">Fatal</span><span class="op" id="6731671">(</span><span class="string" id="6731672">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6731693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731699">if</span>&nbsp;<span class="ident" id="6731702">err</span>&nbsp;<span class="op" id="6731706">!=</span>&nbsp;<span class="ident" id="6731709">nil</span>&nbsp;<span class="op" id="6731713">&amp;&amp;</span>&nbsp;<span class="ident" id="6731716">err</span><span class="op" id="6731719">.</span><span class="op" id="6731720">(</span><span class="op" id="6731721">*</span><span class="ident" id="6731722">OpError</span><span class="op" id="6731729">)</span><span class="op" id="6731730">.</span><span class="ident" id="6731731">Err</span>&nbsp;<span class="op" id="6731735">!=</span>&nbsp;<span class="ident" id="6731738">ErrWriteToConnected</span>&nbsp;<span class="op" id="6731758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731762">t</span><span class="op" id="6731763">.</span><span class="ident" id="6731764">Fatalf</span><span class="op" id="6731770">(</span><span class="string" id="6731771">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6731819">,</span>&nbsp;<span class="ident" id="6731821">err</span><span class="op" id="6731824">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731831">_</span><span class="op" id="6731832">,</span>&nbsp;<span class="ident" id="6731834">err</span>&nbsp;<span class="op" id="6731838">=</span>&nbsp;<span class="ident" id="6731840">c</span><span class="op" id="6731841">.</span><span class="ident" id="6731842">Write</span><span class="op" id="6731847">(</span><span class="op" id="6731848">[</span><span class="op" id="6731849">]</span><span class="builtintype" id="6731850">byte</span><span class="op" id="6731854">(</span><span class="string" id="6731855">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6731888">)</span><span class="op" id="6731889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731892">if</span>&nbsp;<span class="ident" id="6731895">err</span>&nbsp;<span class="op" id="6731899">!=</span>&nbsp;<span class="ident" id="6731902">nil</span>&nbsp;<span class="op" id="6731906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731910">t</span><span class="op" id="6731911">.</span><span class="ident" id="6731912">Fatalf</span><span class="op" id="6731918">(</span><span class="string" id="6731919">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6731937">,</span>&nbsp;<span class="ident" id="6731939">err</span><span class="op" id="6731942">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731945">}</span><br>
<span class="lineno"></span><span class="op" id="6731947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6731950">func</span>&nbsp;<span class="ident" id="6731955">testWriteToPacketConn</span><span class="op" id="6731976">(</span><span class="ident" id="6731977">t</span>&nbsp;<span class="op" id="6731979">*</span><span class="ident" id="6731980">testing</span><span class="op" id="6731987">.</span><span class="ident" id="6731988">T</span><span class="op" id="6731989">,</span>&nbsp;<span class="ident" id="6731991">raddr</span>&nbsp;<span class="builtintype" id="6731997">string</span><span class="op" id="6732003">)</span>&nbsp;<span class="op" id="6732005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732008">c</span><span class="op" id="6732009">,</span>&nbsp;<span class="ident" id="6732011">err</span>&nbsp;<span class="op" id="6732015">:=</span>&nbsp;<span class="ident" id="6732018">ListenPacket</span><span class="op" id="6732030">(</span><span class="string" id="6732031">&#34;udp&#34;</span><span class="op" id="6732036">,</span>&nbsp;<span class="string" id="6732038">&#34;127.0.0.1:0&#34;</span><span class="op" id="6732051">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732054">if</span>&nbsp;<span class="ident" id="6732057">err</span>&nbsp;<span class="op" id="6732061">!=</span>&nbsp;<span class="ident" id="6732064">nil</span>&nbsp;<span class="op" id="6732068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732072">t</span><span class="op" id="6732073">.</span><span class="ident" id="6732074">Fatalf</span><span class="op" id="6732080">(</span><span class="string" id="6732081">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732106">,</span>&nbsp;<span class="ident" id="6732108">err</span><span class="op" id="6732111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732117">defer</span>&nbsp;<span class="ident" id="6732123">c</span><span class="op" id="6732124">.</span><span class="ident" id="6732125">Close</span><span class="op" id="6732130">(</span><span class="op" id="6732131">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732135">ra</span><span class="op" id="6732137">,</span>&nbsp;<span class="ident" id="6732139">err</span>&nbsp;<span class="op" id="6732143">:=</span>&nbsp;<span class="ident" id="6732146">ResolveUDPAddr</span><span class="op" id="6732160">(</span><span class="string" id="6732161">&#34;udp&#34;</span><span class="op" id="6732166">,</span>&nbsp;<span class="ident" id="6732168">raddr</span><span class="op" id="6732173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732176">if</span>&nbsp;<span class="ident" id="6732179">err</span>&nbsp;<span class="op" id="6732183">!=</span>&nbsp;<span class="ident" id="6732186">nil</span>&nbsp;<span class="op" id="6732190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732194">t</span><span class="op" id="6732195">.</span><span class="ident" id="6732196">Fatalf</span><span class="op" id="6732202">(</span><span class="string" id="6732203">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732230">,</span>&nbsp;<span class="ident" id="6732232">err</span><span class="op" id="6732235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732242">_</span><span class="op" id="6732243">,</span>&nbsp;<span class="ident" id="6732245">err</span>&nbsp;<span class="op" id="6732249">=</span>&nbsp;<span class="ident" id="6732251">c</span><span class="op" id="6732252">.</span><span class="op" id="6732253">(</span><span class="op" id="6732254">*</span><span class="ident" id="6732255">UDPConn</span><span class="op" id="6732262">)</span><span class="op" id="6732263">.</span><span class="ident" id="6732264">WriteToUDP</span><span class="op" id="6732274">(</span><span class="op" id="6732275">[</span><span class="op" id="6732276">]</span><span class="builtintype" id="6732277">byte</span><span class="op" id="6732281">(</span><span class="string" id="6732282">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6732311">)</span><span class="op" id="6732312">,</span>&nbsp;<span class="ident" id="6732314">ra</span><span class="op" id="6732316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732319">if</span>&nbsp;<span class="ident" id="6732322">err</span>&nbsp;<span class="op" id="6732326">!=</span>&nbsp;<span class="ident" id="6732329">nil</span>&nbsp;<span class="op" id="6732333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732337">t</span><span class="op" id="6732338">.</span><span class="ident" id="6732339">Fatalf</span><span class="op" id="6732345">(</span><span class="string" id="6732346">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732369">,</span>&nbsp;<span class="ident" id="6732371">err</span><span class="op" id="6732374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732381">_</span><span class="op" id="6732382">,</span>&nbsp;<span class="ident" id="6732384">err</span>&nbsp;<span class="op" id="6732388">=</span>&nbsp;<span class="ident" id="6732390">c</span><span class="op" id="6732391">.</span><span class="ident" id="6732392">WriteTo</span><span class="op" id="6732399">(</span><span class="op" id="6732400">[</span><span class="op" id="6732401">]</span><span class="builtintype" id="6732402">byte</span><span class="op" id="6732406">(</span><span class="string" id="6732407">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6732436">)</span><span class="op" id="6732437">,</span>&nbsp;<span class="ident" id="6732439">ra</span><span class="op" id="6732441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732444">if</span>&nbsp;<span class="ident" id="6732447">err</span>&nbsp;<span class="op" id="6732451">!=</span>&nbsp;<span class="ident" id="6732454">nil</span>&nbsp;<span class="op" id="6732458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732462">t</span><span class="op" id="6732463">.</span><span class="ident" id="6732464">Fatalf</span><span class="op" id="6732470">(</span><span class="string" id="6732471">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6732491">,</span>&nbsp;<span class="ident" id="6732493">err</span><span class="op" id="6732496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732503">_</span><span class="op" id="6732504">,</span>&nbsp;<span class="ident" id="6732506">err</span>&nbsp;<span class="op" id="6732510">=</span>&nbsp;<span class="ident" id="6732512">c</span><span class="op" id="6732513">.</span><span class="op" id="6732514">(</span><span class="op" id="6732515">*</span><span class="ident" id="6732516">UDPConn</span><span class="op" id="6732523">)</span><span class="op" id="6732524">.</span><span class="ident" id="6732525">Write</span><span class="op" id="6732530">(</span><span class="op" id="6732531">[</span><span class="op" id="6732532">]</span><span class="builtintype" id="6732533">byte</span><span class="op" id="6732537">(</span><span class="string" id="6732538">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6732567">)</span><span class="op" id="6732568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732571">if</span>&nbsp;<span class="ident" id="6732574">err</span>&nbsp;<span class="op" id="6732578">==</span>&nbsp;<span class="ident" id="6732581">nil</span>&nbsp;<span class="op" id="6732585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732589">t</span><span class="op" id="6732590">.</span><span class="ident" id="6732591">Fatal</span><span class="op" id="6732596">(</span><span class="string" id="6732597">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6732616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732619">}</span><br>
<span class="lineno"></span><span class="op" id="6732621">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6732624">var</span>&nbsp;<span class="ident" id="6732628">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6732650">=</span>&nbsp;<span class="op" id="6732652">[</span><span class="op" id="6732653">]</span><span class="keyword" id="6732654">struct</span>&nbsp;<span class="op" id="6732661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732664">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6732670">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732678">laddr</span>&nbsp;<span class="op" id="6732684">*</span><span class="ident" id="6732685">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="6732693">}</span><span class="op" id="6732694">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732697">{</span><span class="string" id="6732698">&#34;udp4&#34;</span><span class="op" id="6732704">,</span>&nbsp;<span class="op" id="6732706">&amp;</span><span class="ident" id="6732707">UDPAddr</span><span class="op" id="6732714">{</span><span class="ident" id="6732715">IP</span><span class="op" id="6732717">:</span>&nbsp;<span class="ident" id="6732719">IPv4</span><span class="op" id="6732723">(</span><span class="num" id="6732724">127</span><span class="op" id="6732727">,</span>&nbsp;<span class="num" id="6732729">0</span><span class="op" id="6732730">,</span>&nbsp;<span class="num" id="6732732">0</span><span class="op" id="6732733">,</span>&nbsp;<span class="num" id="6732735">1</span><span class="op" id="6732736">)</span><span class="op" id="6732737">}</span><span class="op" id="6732738">}</span><span class="op" id="6732739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732742">{</span><span class="string" id="6732743">&#34;udp4&#34;</span><span class="op" id="6732749">,</span>&nbsp;<span class="op" id="6732751">&amp;</span><span class="ident" id="6732752">UDPAddr</span><span class="op" id="6732759">{</span><span class="op" id="6732760">}</span><span class="op" id="6732761">}</span><span class="op" id="6732762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732765">{</span><span class="string" id="6732766">&#34;udp4&#34;</span><span class="op" id="6732772">,</span>&nbsp;<span class="ident" id="6732774">nil</span><span class="op" id="6732777">}</span><span class="op" id="6732778">,</span><br>
<span class="lineno"></span><span class="op" id="6732780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6732783">func</span>&nbsp;<span class="ident" id="6732788">TestUDPConnLocalName</span><span class="op" id="6732808">(</span><span class="ident" id="6732809">t</span>&nbsp;<span class="op" id="6732811">*</span><span class="ident" id="6732812">testing</span><span class="op" id="6732819">.</span><span class="ident" id="6732820">T</span><span class="op" id="6732821">)</span>&nbsp;<span class="op" id="6732823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732826">if</span>&nbsp;<span class="ident" id="6732829">testing</span><span class="op" id="6732836">.</span><span class="ident" id="6732837">Short</span><span class="op" id="6732842">(</span><span class="op" id="6732843">)</span>&nbsp;<span class="op" id="6732845">||</span>&nbsp;<span class="op" id="6732848">!</span><span class="op" id="6732849">*</span><span class="ident" id="6732850">testExternal</span>&nbsp;<span class="op" id="6732863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732867">t</span><span class="op" id="6732868">.</span><span class="ident" id="6732869">Skip</span><span class="op" id="6732873">(</span><span class="string" id="6732874">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6732915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6732918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6732922">for</span>&nbsp;<span class="ident" id="6732926">_</span><span class="op" id="6732927">,</span>&nbsp;<span class="ident" id="6732929">tt</span>&nbsp;<span class="op" id="6732932">:=</span>&nbsp;<span class="keyword" id="6732935">range</span>&nbsp;<span class="ident" id="6732941">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6732963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6732967">c</span><span class="op" id="6732968">,</span>&nbsp;<span class="ident" id="6732970">err</span>&nbsp;<span class="op" id="6732974">:=</span>&nbsp;<span class="ident" id="6732977">ListenUDP</span><span class="op" id="6732986">(</span><span class="ident" id="6732987">tt</span><span class="op" id="6732989">.</span><span class="ident" id="6732990">net</span><span class="op" id="6732993">,</span>&nbsp;<span class="ident" id="6732995">tt</span><span class="op" id="6732997">.</span><span class="ident" id="6732998">laddr</span><span class="op" id="6733003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733007">if</span>&nbsp;<span class="ident" id="6733010">err</span>&nbsp;<span class="op" id="6733014">!=</span>&nbsp;<span class="ident" id="6733017">nil</span>&nbsp;<span class="op" id="6733021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733026">t</span><span class="op" id="6733027">.</span><span class="ident" id="6733028">Fatalf</span><span class="op" id="6733034">(</span><span class="string" id="6733035">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733057">,</span>&nbsp;<span class="ident" id="6733059">err</span><span class="op" id="6733062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733066">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733070">defer</span>&nbsp;<span class="ident" id="6733076">c</span><span class="op" id="6733077">.</span><span class="ident" id="6733078">Close</span><span class="op" id="6733083">(</span><span class="op" id="6733084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733088">la</span>&nbsp;<span class="op" id="6733091">:=</span>&nbsp;<span class="ident" id="6733094">c</span><span class="op" id="6733095">.</span><span class="ident" id="6733096">LocalAddr</span><span class="op" id="6733105">(</span><span class="op" id="6733106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733110">if</span>&nbsp;<span class="ident" id="6733113">a</span><span class="op" id="6733114">,</span>&nbsp;<span class="ident" id="6733116">ok</span>&nbsp;<span class="op" id="6733119">:=</span>&nbsp;<span class="ident" id="6733122">la</span><span class="op" id="6733124">.</span><span class="op" id="6733125">(</span><span class="op" id="6733126">*</span><span class="ident" id="6733127">UDPAddr</span><span class="op" id="6733134">)</span><span class="op" id="6733135">;</span>&nbsp;<span class="op" id="6733137">!</span><span class="ident" id="6733138">ok</span>&nbsp;<span class="op" id="6733141">||</span>&nbsp;<span class="ident" id="6733144">a</span><span class="op" id="6733145">.</span><span class="ident" id="6733146">Port</span>&nbsp;<span class="op" id="6733151">==</span>&nbsp;<span class="num" id="6733154">0</span>&nbsp;<span class="op" id="6733156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733161">t</span><span class="op" id="6733162">.</span><span class="ident" id="6733163">Fatalf</span><span class="op" id="6733169">(</span><span class="string" id="6733170">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6733231">,</span>&nbsp;<span class="ident" id="6733233">la</span><span class="op" id="6733235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733239">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733242">}</span><br>
<span class="lineno"></span><span class="op" id="6733244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6733247">func</span>&nbsp;<span class="ident" id="6733252">TestUDPConnLocalAndRemoteNames</span><span class="op" id="6733282">(</span><span class="ident" id="6733283">t</span>&nbsp;<span class="op" id="6733285">*</span><span class="ident" id="6733286">testing</span><span class="op" id="6733293">.</span><span class="ident" id="6733294">T</span><span class="op" id="6733295">)</span>&nbsp;<span class="op" id="6733297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733300">for</span>&nbsp;<span class="ident" id="6733304">_</span><span class="op" id="6733305">,</span>&nbsp;<span class="ident" id="6733307">laddr</span>&nbsp;<span class="op" id="6733313">:=</span>&nbsp;<span class="keyword" id="6733316">range</span>&nbsp;<span class="op" id="6733322">[</span><span class="op" id="6733323">]</span><span class="builtintype" id="6733324">string</span><span class="op" id="6733330">{</span><span class="string" id="6733331">&#34;&#34;</span><span class="op" id="6733333">,</span>&nbsp;<span class="string" id="6733335">&#34;127.0.0.1:0&#34;</span><span class="op" id="6733348">}</span>&nbsp;<span class="op" id="6733350">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733354">c1</span><span class="op" id="6733356">,</span>&nbsp;<span class="ident" id="6733358">err</span>&nbsp;<span class="op" id="6733362">:=</span>&nbsp;<span class="ident" id="6733365">ListenPacket</span><span class="op" id="6733377">(</span><span class="string" id="6733378">&#34;udp&#34;</span><span class="op" id="6733383">,</span>&nbsp;<span class="string" id="6733385">&#34;127.0.0.1:0&#34;</span><span class="op" id="6733398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733402">if</span>&nbsp;<span class="ident" id="6733405">err</span>&nbsp;<span class="op" id="6733409">!=</span>&nbsp;<span class="ident" id="6733412">nil</span>&nbsp;<span class="op" id="6733416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733421">t</span><span class="op" id="6733422">.</span><span class="ident" id="6733423">Fatalf</span><span class="op" id="6733429">(</span><span class="string" id="6733430">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733452">,</span>&nbsp;<span class="ident" id="6733454">err</span><span class="op" id="6733457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733465">defer</span>&nbsp;<span class="ident" id="6733471">c1</span><span class="op" id="6733473">.</span><span class="ident" id="6733474">Close</span><span class="op" id="6733479">(</span><span class="op" id="6733480">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733485">var</span>&nbsp;<span class="ident" id="6733489">la</span>&nbsp;<span class="op" id="6733492">*</span><span class="ident" id="6733493">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733503">if</span>&nbsp;<span class="ident" id="6733506">laddr</span>&nbsp;<span class="op" id="6733512">!=</span>&nbsp;<span class="string" id="6733515">&#34;&#34;</span>&nbsp;<span class="op" id="6733518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733523">var</span>&nbsp;<span class="ident" id="6733527">err</span>&nbsp;<span class="builtintype" id="6733531">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733540">if</span>&nbsp;<span class="ident" id="6733543">la</span><span class="op" id="6733545">,</span>&nbsp;<span class="ident" id="6733547">err</span>&nbsp;<span class="op" id="6733551">=</span>&nbsp;<span class="ident" id="6733553">ResolveUDPAddr</span><span class="op" id="6733567">(</span><span class="string" id="6733568">&#34;udp&#34;</span><span class="op" id="6733573">,</span>&nbsp;<span class="ident" id="6733575">laddr</span><span class="op" id="6733580">)</span><span class="op" id="6733581">;</span>&nbsp;<span class="ident" id="6733583">err</span>&nbsp;<span class="op" id="6733587">!=</span>&nbsp;<span class="ident" id="6733590">nil</span>&nbsp;<span class="op" id="6733594">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733600">t</span><span class="op" id="6733601">.</span><span class="ident" id="6733602">Fatalf</span><span class="op" id="6733608">(</span><span class="string" id="6733609">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733636">,</span>&nbsp;<span class="ident" id="6733638">err</span><span class="op" id="6733641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733654">c2</span><span class="op" id="6733656">,</span>&nbsp;<span class="ident" id="6733658">err</span>&nbsp;<span class="op" id="6733662">:=</span>&nbsp;<span class="ident" id="6733665">DialUDP</span><span class="op" id="6733672">(</span><span class="string" id="6733673">&#34;udp&#34;</span><span class="op" id="6733678">,</span>&nbsp;<span class="ident" id="6733680">la</span><span class="op" id="6733682">,</span>&nbsp;<span class="ident" id="6733684">c1</span><span class="op" id="6733686">.</span><span class="ident" id="6733687">LocalAddr</span><span class="op" id="6733696">(</span><span class="op" id="6733697">)</span><span class="op" id="6733698">.</span><span class="op" id="6733699">(</span><span class="op" id="6733700">*</span><span class="ident" id="6733701">UDPAddr</span><span class="op" id="6733708">)</span><span class="op" id="6733709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733713">if</span>&nbsp;<span class="ident" id="6733716">err</span>&nbsp;<span class="op" id="6733720">!=</span>&nbsp;<span class="ident" id="6733723">nil</span>&nbsp;<span class="op" id="6733727">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733732">t</span><span class="op" id="6733733">.</span><span class="ident" id="6733734">Fatalf</span><span class="op" id="6733740">(</span><span class="string" id="6733741">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6733761">,</span>&nbsp;<span class="ident" id="6733763">err</span><span class="op" id="6733766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733774">defer</span>&nbsp;<span class="ident" id="6733780">c2</span><span class="op" id="6733782">.</span><span class="ident" id="6733783">Close</span><span class="op" id="6733788">(</span><span class="op" id="6733789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733794">var</span>&nbsp;<span class="ident" id="6733798">connAddrs</span>&nbsp;<span class="op" id="6733808">=</span>&nbsp;<span class="op" id="6733810">[</span><span class="num" id="6733811">4</span><span class="op" id="6733812">]</span><span class="keyword" id="6733813">struct</span>&nbsp;<span class="op" id="6733820">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733825">got</span>&nbsp;<span class="ident" id="6733829">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6733837">ok</span>&nbsp;&nbsp;<span class="builtintype" id="6733841">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733848">}</span><span class="op" id="6733849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733854">{</span><span class="ident" id="6733855">c1</span><span class="op" id="6733857">.</span><span class="ident" id="6733858">LocalAddr</span><span class="op" id="6733867">(</span><span class="op" id="6733868">)</span><span class="op" id="6733869">,</span>&nbsp;<span class="builtintype" id="6733871">true</span><span class="op" id="6733875">}</span><span class="op" id="6733876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733881">{</span><span class="ident" id="6733882">c1</span><span class="op" id="6733884">.</span><span class="op" id="6733885">(</span><span class="op" id="6733886">*</span><span class="ident" id="6733887">UDPConn</span><span class="op" id="6733894">)</span><span class="op" id="6733895">.</span><span class="ident" id="6733896">RemoteAddr</span><span class="op" id="6733906">(</span><span class="op" id="6733907">)</span><span class="op" id="6733908">,</span>&nbsp;<span class="builtintype" id="6733910">false</span><span class="op" id="6733915">}</span><span class="op" id="6733916">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733921">{</span><span class="ident" id="6733922">c2</span><span class="op" id="6733924">.</span><span class="ident" id="6733925">LocalAddr</span><span class="op" id="6733934">(</span><span class="op" id="6733935">)</span><span class="op" id="6733936">,</span>&nbsp;<span class="builtintype" id="6733938">true</span><span class="op" id="6733942">}</span><span class="op" id="6733943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733948">{</span><span class="ident" id="6733949">c2</span><span class="op" id="6733951">.</span><span class="ident" id="6733952">RemoteAddr</span><span class="op" id="6733962">(</span><span class="op" id="6733963">)</span><span class="op" id="6733964">,</span>&nbsp;<span class="builtintype" id="6733966">true</span><span class="op" id="6733970">}</span><span class="op" id="6733971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6733975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6733979">for</span>&nbsp;<span class="ident" id="6733983">_</span><span class="op" id="6733984">,</span>&nbsp;<span class="ident" id="6733986">ca</span>&nbsp;<span class="op" id="6733989">:=</span>&nbsp;<span class="keyword" id="6733992">range</span>&nbsp;<span class="ident" id="6733998">connAddrs</span>&nbsp;<span class="op" id="6734008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734013">if</span>&nbsp;<span class="ident" id="6734016">a</span><span class="op" id="6734017">,</span>&nbsp;<span class="ident" id="6734019">ok</span>&nbsp;<span class="op" id="6734022">:=</span>&nbsp;<span class="ident" id="6734025">ca</span><span class="op" id="6734027">.</span><span class="ident" id="6734028">got</span><span class="op" id="6734031">.</span><span class="op" id="6734032">(</span><span class="op" id="6734033">*</span><span class="ident" id="6734034">UDPAddr</span><span class="op" id="6734041">)</span><span class="op" id="6734042">;</span>&nbsp;<span class="ident" id="6734044">ok</span>&nbsp;<span class="op" id="6734047">!=</span>&nbsp;<span class="ident" id="6734050">ca</span><span class="op" id="6734052">.</span><span class="ident" id="6734053">ok</span>&nbsp;<span class="op" id="6734056">||</span>&nbsp;<span class="ident" id="6734059">ok</span>&nbsp;<span class="op" id="6734062">&amp;&amp;</span>&nbsp;<span class="ident" id="6734065">a</span><span class="op" id="6734066">.</span><span class="ident" id="6734067">Port</span>&nbsp;<span class="op" id="6734072">==</span>&nbsp;<span class="num" id="6734075">0</span>&nbsp;<span class="op" id="6734077">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734083">t</span><span class="op" id="6734084">.</span><span class="ident" id="6734085">Fatalf</span><span class="op" id="6734091">(</span><span class="string" id="6734092">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6734153">,</span>&nbsp;<span class="ident" id="6734155">ca</span><span class="op" id="6734157">.</span><span class="ident" id="6734158">got</span><span class="op" id="6734161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734173">}</span><br>
<span class="lineno"></span><span class="op" id="6734175">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6734178">func</span>&nbsp;<span class="ident" id="6734183">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="6734210">(</span><span class="ident" id="6734211">t</span>&nbsp;<span class="op" id="6734213">*</span><span class="ident" id="6734214">testing</span><span class="op" id="6734221">.</span><span class="ident" id="6734222">T</span><span class="op" id="6734223">)</span>&nbsp;<span class="op" id="6734225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734228">if</span>&nbsp;<span class="ident" id="6734231">testing</span><span class="op" id="6734238">.</span><span class="ident" id="6734239">Short</span><span class="op" id="6734244">(</span><span class="op" id="6734245">)</span>&nbsp;<span class="op" id="6734247">||</span>&nbsp;<span class="op" id="6734250">!</span><span class="op" id="6734251">*</span><span class="ident" id="6734252">testExternal</span>&nbsp;<span class="op" id="6734265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734269">t</span><span class="op" id="6734270">.</span><span class="ident" id="6734271">Skip</span><span class="op" id="6734275">(</span><span class="string" id="6734276">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6734317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734320">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734323">if</span>&nbsp;<span class="op" id="6734326">!</span><span class="ident" id="6734327">supportsIPv6</span>&nbsp;<span class="op" id="6734340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734344">t</span><span class="op" id="6734345">.</span><span class="ident" id="6734346">Skip</span><span class="op" id="6734350">(</span><span class="string" id="6734351">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6734374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734380">ifi</span>&nbsp;<span class="op" id="6734384">:=</span>&nbsp;<span class="ident" id="6734387">loopbackInterface</span><span class="op" id="6734404">(</span><span class="op" id="6734405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734408">if</span>&nbsp;<span class="ident" id="6734411">ifi</span>&nbsp;<span class="op" id="6734415">==</span>&nbsp;<span class="ident" id="6734418">nil</span>&nbsp;<span class="op" id="6734422">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734426">t</span><span class="op" id="6734427">.</span><span class="ident" id="6734428">Skip</span><span class="op" id="6734432">(</span><span class="string" id="6734433">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="6734463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734469">laddr</span>&nbsp;<span class="op" id="6734475">:=</span>&nbsp;<span class="ident" id="6734478">ipv6LinkLocalUnicastAddr</span><span class="op" id="6734502">(</span><span class="ident" id="6734503">ifi</span><span class="op" id="6734506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734509">if</span>&nbsp;<span class="ident" id="6734512">laddr</span>&nbsp;<span class="op" id="6734518">==</span>&nbsp;<span class="string" id="6734521">&#34;&#34;</span>&nbsp;<span class="op" id="6734524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734528">t</span><span class="op" id="6734529">.</span><span class="ident" id="6734530">Skip</span><span class="op" id="6734534">(</span><span class="string" id="6734535">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="6734579">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734586">type</span>&nbsp;<span class="ident" id="6734591">test</span>&nbsp;<span class="keyword" id="6734596">struct</span>&nbsp;<span class="op" id="6734603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734607">net</span><span class="op" id="6734610">,</span>&nbsp;<span class="ident" id="6734612">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6734618">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734627">nameLookup</span>&nbsp;<span class="builtintype" id="6734638">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734647">var</span>&nbsp;<span class="ident" id="6734651">tests</span>&nbsp;<span class="op" id="6734657">=</span>&nbsp;<span class="op" id="6734659">[</span><span class="op" id="6734660">]</span><span class="ident" id="6734661">test</span><span class="op" id="6734665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734669">{</span><span class="string" id="6734670">&#34;udp&#34;</span><span class="op" id="6734675">,</span>&nbsp;<span class="string" id="6734677">&#34;[&#34;</span>&nbsp;<span class="op" id="6734681">+</span>&nbsp;<span class="ident" id="6734683">laddr</span>&nbsp;<span class="op" id="6734689">+</span>&nbsp;<span class="string" id="6734691">&#34;%&#34;</span>&nbsp;<span class="op" id="6734695">+</span>&nbsp;<span class="ident" id="6734697">ifi</span><span class="op" id="6734700">.</span><span class="ident" id="6734701">Name</span>&nbsp;<span class="op" id="6734706">+</span>&nbsp;<span class="string" id="6734708">&#34;]:0&#34;</span><span class="op" id="6734713">,</span>&nbsp;<span class="builtintype" id="6734715">false</span><span class="op" id="6734720">}</span><span class="op" id="6734721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734725">{</span><span class="string" id="6734726">&#34;udp6&#34;</span><span class="op" id="6734732">,</span>&nbsp;<span class="string" id="6734734">&#34;[&#34;</span>&nbsp;<span class="op" id="6734738">+</span>&nbsp;<span class="ident" id="6734740">laddr</span>&nbsp;<span class="op" id="6734746">+</span>&nbsp;<span class="string" id="6734748">&#34;%&#34;</span>&nbsp;<span class="op" id="6734752">+</span>&nbsp;<span class="ident" id="6734754">ifi</span><span class="op" id="6734757">.</span><span class="ident" id="6734758">Name</span>&nbsp;<span class="op" id="6734763">+</span>&nbsp;<span class="string" id="6734765">&#34;]:0&#34;</span><span class="op" id="6734770">,</span>&nbsp;<span class="builtintype" id="6734772">false</span><span class="op" id="6734777">}</span><span class="op" id="6734778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734781">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6734784">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734844">if</span>&nbsp;<span class="ident" id="6734847">runtime</span><span class="op" id="6734854">.</span><span class="ident" id="6734855">GOOS</span>&nbsp;<span class="op" id="6734860">==</span>&nbsp;<span class="string" id="6734863">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="6734875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734879">tests</span>&nbsp;<span class="op" id="6734885">=</span>&nbsp;<span class="ident" id="6734887">tests</span><span class="op" id="6734892">[</span><span class="num" id="6734893">1</span><span class="op" id="6734894">:</span><span class="op" id="6734895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6734898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734901">switch</span>&nbsp;<span class="ident" id="6734908">runtime</span><span class="op" id="6734915">.</span><span class="ident" id="6734916">GOOS</span>&nbsp;<span class="op" id="6734921">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6734924">case</span>&nbsp;<span class="string" id="6734929">&#34;darwin&#34;</span><span class="op" id="6734937">,</span>&nbsp;<span class="string" id="6734939">&#34;dragonfly&#34;</span><span class="op" id="6734950">,</span>&nbsp;<span class="string" id="6734952">&#34;freebsd&#34;</span><span class="op" id="6734961">,</span>&nbsp;<span class="string" id="6734963">&#34;openbsd&#34;</span><span class="op" id="6734972">,</span>&nbsp;<span class="string" id="6734974">&#34;netbsd&#34;</span><span class="op" id="6734982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6734986">tests</span>&nbsp;<span class="op" id="6734992">=</span>&nbsp;<span class="builtinfunc" id="6734994">append</span><span class="op" id="6735000">(</span><span class="ident" id="6735001">tests</span><span class="op" id="6735006">,</span>&nbsp;<span class="op" id="6735008">[</span><span class="op" id="6735009">]</span><span class="ident" id="6735010">test</span><span class="op" id="6735014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735019">{</span><span class="string" id="6735020">&#34;udp&#34;</span><span class="op" id="6735025">,</span>&nbsp;<span class="string" id="6735027">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6735041">+</span>&nbsp;<span class="ident" id="6735043">ifi</span><span class="op" id="6735046">.</span><span class="ident" id="6735047">Name</span>&nbsp;<span class="op" id="6735052">+</span>&nbsp;<span class="string" id="6735054">&#34;]:0&#34;</span><span class="op" id="6735059">,</span>&nbsp;<span class="builtintype" id="6735061">true</span><span class="op" id="6735065">}</span><span class="op" id="6735066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735071">{</span><span class="string" id="6735072">&#34;udp6&#34;</span><span class="op" id="6735078">,</span>&nbsp;<span class="string" id="6735080">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6735094">+</span>&nbsp;<span class="ident" id="6735096">ifi</span><span class="op" id="6735099">.</span><span class="ident" id="6735100">Name</span>&nbsp;<span class="op" id="6735105">+</span>&nbsp;<span class="string" id="6735107">&#34;]:0&#34;</span><span class="op" id="6735112">,</span>&nbsp;<span class="builtintype" id="6735114">true</span><span class="op" id="6735118">}</span><span class="op" id="6735119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735123">}</span><span class="op" id="6735124">...</span><span class="op" id="6735127">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735130">case</span>&nbsp;<span class="string" id="6735135">&#34;linux&#34;</span><span class="op" id="6735142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735146">tests</span>&nbsp;<span class="op" id="6735152">=</span>&nbsp;<span class="builtinfunc" id="6735154">append</span><span class="op" id="6735160">(</span><span class="ident" id="6735161">tests</span><span class="op" id="6735166">,</span>&nbsp;<span class="op" id="6735168">[</span><span class="op" id="6735169">]</span><span class="ident" id="6735170">test</span><span class="op" id="6735174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735179">{</span><span class="string" id="6735180">&#34;udp&#34;</span><span class="op" id="6735185">,</span>&nbsp;<span class="string" id="6735187">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6735205">+</span>&nbsp;<span class="ident" id="6735207">ifi</span><span class="op" id="6735210">.</span><span class="ident" id="6735211">Name</span>&nbsp;<span class="op" id="6735216">+</span>&nbsp;<span class="string" id="6735218">&#34;]:0&#34;</span><span class="op" id="6735223">,</span>&nbsp;<span class="builtintype" id="6735225">true</span><span class="op" id="6735229">}</span><span class="op" id="6735230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735235">{</span><span class="string" id="6735236">&#34;udp6&#34;</span><span class="op" id="6735242">,</span>&nbsp;<span class="string" id="6735244">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6735262">+</span>&nbsp;<span class="ident" id="6735264">ifi</span><span class="op" id="6735267">.</span><span class="ident" id="6735268">Name</span>&nbsp;<span class="op" id="6735273">+</span>&nbsp;<span class="string" id="6735275">&#34;]:0&#34;</span><span class="op" id="6735280">,</span>&nbsp;<span class="builtintype" id="6735282">true</span><span class="op" id="6735286">}</span><span class="op" id="6735287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735291">}</span><span class="op" id="6735292">...</span><span class="op" id="6735295">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735301">for</span>&nbsp;<span class="ident" id="6735305">_</span><span class="op" id="6735306">,</span>&nbsp;<span class="ident" id="6735308">tt</span>&nbsp;<span class="op" id="6735311">:=</span>&nbsp;<span class="keyword" id="6735314">range</span>&nbsp;<span class="ident" id="6735320">tests</span>&nbsp;<span class="op" id="6735326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735330">c1</span><span class="op" id="6735332">,</span>&nbsp;<span class="ident" id="6735334">err</span>&nbsp;<span class="op" id="6735338">:=</span>&nbsp;<span class="ident" id="6735341">ListenPacket</span><span class="op" id="6735353">(</span><span class="ident" id="6735354">tt</span><span class="op" id="6735356">.</span><span class="ident" id="6735357">net</span><span class="op" id="6735360">,</span>&nbsp;<span class="ident" id="6735362">tt</span><span class="op" id="6735364">.</span><span class="ident" id="6735365">addr</span><span class="op" id="6735369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735373">if</span>&nbsp;<span class="ident" id="6735376">err</span>&nbsp;<span class="op" id="6735380">!=</span>&nbsp;<span class="ident" id="6735383">nil</span>&nbsp;<span class="op" id="6735387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6735392">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6735438">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735487">t</span><span class="op" id="6735488">.</span><span class="ident" id="6735489">Logf</span><span class="op" id="6735493">(</span><span class="string" id="6735494">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6735519">,</span>&nbsp;<span class="ident" id="6735521">err</span><span class="op" id="6735524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735529">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735544">defer</span>&nbsp;<span class="ident" id="6735550">c1</span><span class="op" id="6735552">.</span><span class="ident" id="6735553">Close</span><span class="op" id="6735558">(</span><span class="op" id="6735559">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735563">if</span>&nbsp;<span class="ident" id="6735566">la</span><span class="op" id="6735568">,</span>&nbsp;<span class="ident" id="6735570">ok</span>&nbsp;<span class="op" id="6735573">:=</span>&nbsp;<span class="ident" id="6735576">c1</span><span class="op" id="6735578">.</span><span class="ident" id="6735579">LocalAddr</span><span class="op" id="6735588">(</span><span class="op" id="6735589">)</span><span class="op" id="6735590">.</span><span class="op" id="6735591">(</span><span class="op" id="6735592">*</span><span class="ident" id="6735593">UDPAddr</span><span class="op" id="6735600">)</span><span class="op" id="6735601">;</span>&nbsp;<span class="op" id="6735603">!</span><span class="ident" id="6735604">ok</span>&nbsp;<span class="op" id="6735607">||</span>&nbsp;<span class="op" id="6735610">!</span><span class="ident" id="6735611">tt</span><span class="op" id="6735613">.</span><span class="ident" id="6735614">nameLookup</span>&nbsp;<span class="op" id="6735625">&amp;&amp;</span>&nbsp;<span class="ident" id="6735628">la</span><span class="op" id="6735630">.</span><span class="ident" id="6735631">Zone</span>&nbsp;<span class="op" id="6735636">==</span>&nbsp;<span class="string" id="6735639">&#34;&#34;</span>&nbsp;<span class="op" id="6735642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735647">t</span><span class="op" id="6735648">.</span><span class="ident" id="6735649">Fatalf</span><span class="op" id="6735655">(</span><span class="string" id="6735656">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6735712">,</span>&nbsp;<span class="ident" id="6735714">la</span><span class="op" id="6735716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735725">c2</span><span class="op" id="6735727">,</span>&nbsp;<span class="ident" id="6735729">err</span>&nbsp;<span class="op" id="6735733">:=</span>&nbsp;<span class="ident" id="6735736">Dial</span><span class="op" id="6735740">(</span><span class="ident" id="6735741">tt</span><span class="op" id="6735743">.</span><span class="ident" id="6735744">net</span><span class="op" id="6735747">,</span>&nbsp;<span class="ident" id="6735749">c1</span><span class="op" id="6735751">.</span><span class="ident" id="6735752">LocalAddr</span><span class="op" id="6735761">(</span><span class="op" id="6735762">)</span><span class="op" id="6735763">.</span><span class="ident" id="6735764">String</span><span class="op" id="6735770">(</span><span class="op" id="6735771">)</span><span class="op" id="6735772">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735776">if</span>&nbsp;<span class="ident" id="6735779">err</span>&nbsp;<span class="op" id="6735783">!=</span>&nbsp;<span class="ident" id="6735786">nil</span>&nbsp;<span class="op" id="6735790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735795">t</span><span class="op" id="6735796">.</span><span class="ident" id="6735797">Fatalf</span><span class="op" id="6735803">(</span><span class="string" id="6735804">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6735821">,</span>&nbsp;<span class="ident" id="6735823">err</span><span class="op" id="6735826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6735830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735834">defer</span>&nbsp;<span class="ident" id="6735840">c2</span><span class="op" id="6735842">.</span><span class="ident" id="6735843">Close</span><span class="op" id="6735848">(</span><span class="op" id="6735849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6735853">if</span>&nbsp;<span class="ident" id="6735856">la</span><span class="op" id="6735858">,</span>&nbsp;<span class="ident" id="6735860">ok</span>&nbsp;<span class="op" id="6735863">:=</span>&nbsp;<span class="ident" id="6735866">c2</span><span class="op" id="6735868">.</span><span class="ident" id="6735869">LocalAddr</span><span class="op" id="6735878">(</span><span class="op" id="6735879">)</span><span class="op" id="6735880">.</span><span class="op" id="6735881">(</span><span class="op" id="6735882">*</span><span class="ident" id="6735883">UDPAddr</span><span class="op" id="6735890">)</span><span class="op" id="6735891">;</span>&nbsp;<span class="op" id="6735893">!</span><span class="ident" id="6735894">ok</span>&nbsp;<span class="op" id="6735897">||</span>&nbsp;<span class="op" id="6735900">!</span><span class="ident" id="6735901">tt</span><span class="op" id="6735903">.</span><span class="ident" id="6735904">nameLookup</span>&nbsp;<span class="op" id="6735915">&amp;&amp;</span>&nbsp;<span class="ident" id="6735918">la</span><span class="op" id="6735920">.</span><span class="ident" id="6735921">Zone</span>&nbsp;<span class="op" id="6735926">==</span>&nbsp;<span class="string" id="6735929">&#34;&#34;</span>&nbsp;<span class="op" id="6735932">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6735937">t</span><span class="op" id="6735938">.</span><span class="ident" id="6735939">Fatalf</span><span class="op" id="6735945">(</span><span class="string" id="6735946">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6736002">,</span>&nbsp;<span class="ident" id="6736004">la</span><span class="op" id="6736006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6736014">if</span>&nbsp;<span class="ident" id="6736017">ra</span><span class="op" id="6736019">,</span>&nbsp;<span class="ident" id="6736021">ok</span>&nbsp;<span class="op" id="6736024">:=</span>&nbsp;<span class="ident" id="6736027">c2</span><span class="op" id="6736029">.</span><span class="ident" id="6736030">RemoteAddr</span><span class="op" id="6736040">(</span><span class="op" id="6736041">)</span><span class="op" id="6736042">.</span><span class="op" id="6736043">(</span><span class="op" id="6736044">*</span><span class="ident" id="6736045">UDPAddr</span><span class="op" id="6736052">)</span><span class="op" id="6736053">;</span>&nbsp;<span class="op" id="6736055">!</span><span class="ident" id="6736056">ok</span>&nbsp;<span class="op" id="6736059">||</span>&nbsp;<span class="op" id="6736062">!</span><span class="ident" id="6736063">tt</span><span class="op" id="6736065">.</span><span class="ident" id="6736066">nameLookup</span>&nbsp;<span class="op" id="6736077">&amp;&amp;</span>&nbsp;<span class="ident" id="6736080">ra</span><span class="op" id="6736082">.</span><span class="ident" id="6736083">Zone</span>&nbsp;<span class="op" id="6736088">==</span>&nbsp;<span class="string" id="6736091">&#34;&#34;</span>&nbsp;<span class="op" id="6736094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6736099">t</span><span class="op" id="6736100">.</span><span class="ident" id="6736101">Fatalf</span><span class="op" id="6736107">(</span><span class="string" id="6736108">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6736164">,</span>&nbsp;<span class="ident" id="6736166">ra</span><span class="op" id="6736168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736172">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6736177">if</span>&nbsp;<span class="ident" id="6736180">_</span><span class="op" id="6736181">,</span>&nbsp;<span class="ident" id="6736183">err</span>&nbsp;<span class="op" id="6736187">:=</span>&nbsp;<span class="ident" id="6736190">c2</span><span class="op" id="6736192">.</span><span class="ident" id="6736193">Write</span><span class="op" id="6736198">(</span><span class="op" id="6736199">[</span><span class="op" id="6736200">]</span><span class="builtintype" id="6736201">byte</span><span class="op" id="6736205">(</span><span class="string" id="6736206">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="6736236">)</span><span class="op" id="6736237">)</span><span class="op" id="6736238">;</span>&nbsp;<span class="ident" id="6736240">err</span>&nbsp;<span class="op" id="6736244">!=</span>&nbsp;<span class="ident" id="6736247">nil</span>&nbsp;<span class="op" id="6736251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6736256">t</span><span class="op" id="6736257">.</span><span class="ident" id="6736258">Fatalf</span><span class="op" id="6736264">(</span><span class="string" id="6736265">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6736288">,</span>&nbsp;<span class="ident" id="6736290">err</span><span class="op" id="6736293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6736301">b</span>&nbsp;<span class="op" id="6736303">:=</span>&nbsp;<span class="builtinfunc" id="6736306">make</span><span class="op" id="6736310">(</span><span class="op" id="6736311">[</span><span class="op" id="6736312">]</span><span class="builtintype" id="6736313">byte</span><span class="op" id="6736317">,</span>&nbsp;<span class="num" id="6736319">32</span><span class="op" id="6736321">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6736325">if</span>&nbsp;<span class="ident" id="6736328">_</span><span class="op" id="6736329">,</span>&nbsp;<span class="ident" id="6736331">from</span><span class="op" id="6736335">,</span>&nbsp;<span class="ident" id="6736337">err</span>&nbsp;<span class="op" id="6736341">:=</span>&nbsp;<span class="ident" id="6736344">c1</span><span class="op" id="6736346">.</span><span class="ident" id="6736347">ReadFrom</span><span class="op" id="6736355">(</span><span class="ident" id="6736356">b</span><span class="op" id="6736357">)</span><span class="op" id="6736358">;</span>&nbsp;<span class="ident" id="6736360">err</span>&nbsp;<span class="op" id="6736364">!=</span>&nbsp;<span class="ident" id="6736367">nil</span>&nbsp;<span class="op" id="6736371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6736376">t</span><span class="op" id="6736377">.</span><span class="ident" id="6736378">Fatalf</span><span class="op" id="6736384">(</span><span class="string" id="6736385">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6736417">,</span>&nbsp;<span class="ident" id="6736419">err</span><span class="op" id="6736422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736426">}</span>&nbsp;<span class="keyword" id="6736428">else</span>&nbsp;<span class="op" id="6736433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6736438">if</span>&nbsp;<span class="ident" id="6736441">ra</span><span class="op" id="6736443">,</span>&nbsp;<span class="ident" id="6736445">ok</span>&nbsp;<span class="op" id="6736448">:=</span>&nbsp;<span class="ident" id="6736451">from</span><span class="op" id="6736455">.</span><span class="op" id="6736456">(</span><span class="op" id="6736457">*</span><span class="ident" id="6736458">UDPAddr</span><span class="op" id="6736465">)</span><span class="op" id="6736466">;</span>&nbsp;<span class="op" id="6736468">!</span><span class="ident" id="6736469">ok</span>&nbsp;<span class="op" id="6736472">||</span>&nbsp;<span class="op" id="6736475">!</span><span class="ident" id="6736476">tt</span><span class="op" id="6736478">.</span><span class="ident" id="6736479">nameLookup</span>&nbsp;<span class="op" id="6736490">&amp;&amp;</span>&nbsp;<span class="ident" id="6736493">ra</span><span class="op" id="6736495">.</span><span class="ident" id="6736496">Zone</span>&nbsp;<span class="op" id="6736501">==</span>&nbsp;<span class="string" id="6736504">&#34;&#34;</span>&nbsp;<span class="op" id="6736507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6736513">t</span><span class="op" id="6736514">.</span><span class="ident" id="6736515">Fatalf</span><span class="op" id="6736521">(</span><span class="string" id="6736522">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6736578">,</span>&nbsp;<span class="ident" id="6736580">ra</span><span class="op" id="6736582">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6736594">}</span><br>
<span class="lineno"></span><span class="op" id="6736596">}</span>
</div>
</body>
</html>
