<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7065861">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7065916">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7065970">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7066021">package</span>&nbsp;<span class="ident" id="7066029">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7066039">import</span>&nbsp;<span class="op" id="7066046">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066049">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066058">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066065">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066071">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066084">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066096">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066107">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066118">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066129">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7066139">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7066142">type</span>&nbsp;<span class="ident" id="7066147">dumpTest</span>&nbsp;<span class="keyword" id="7066156">struct</span>&nbsp;<span class="op" id="7066163">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066166">Req</span>&nbsp;&nbsp;<span class="ident" id="7066171">http</span><span class="op" id="7066175">.</span><span class="ident" id="7066176">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066185">Body</span>&nbsp;<span class="keyword" id="7066190">interface</span><span class="op" id="7066199">{</span><span class="op" id="7066200">}</span>&nbsp;<span class="comment" id="7066202">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066268">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7066280">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066288">WantDumpOut</span>&nbsp;<span class="builtintype" id="7066300">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066308">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7066320">bool</span>&nbsp;<span class="comment" id="7066325">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="7066373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7066376">var</span>&nbsp;<span class="ident" id="7066380">dumpTests</span>&nbsp;<span class="op" id="7066390">=</span>&nbsp;<span class="op" id="7066392">[</span><span class="op" id="7066393">]</span><span class="ident" id="7066394">dumpTest</span><span class="op" id="7066402">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7066406">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066462">Req</span><span class="op" id="7066465">:</span>&nbsp;<span class="ident" id="7066467">http</span><span class="op" id="7066471">.</span><span class="ident" id="7066472">Request</span><span class="op" id="7066479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066484">Method</span><span class="op" id="7066490">:</span>&nbsp;<span class="string" id="7066492">&#34;GET&#34;</span><span class="op" id="7066497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066502">URL</span><span class="op" id="7066505">:</span>&nbsp;<span class="op" id="7066507">&amp;</span><span class="ident" id="7066508">url</span><span class="op" id="7066511">.</span><span class="ident" id="7066512">URL</span><span class="op" id="7066515">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066521">Scheme</span><span class="op" id="7066527">:</span>&nbsp;<span class="string" id="7066529">&#34;http&#34;</span><span class="op" id="7066535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066541">Host</span><span class="op" id="7066545">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7066549">&#34;www.google.com&#34;</span><span class="op" id="7066565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066571">Path</span><span class="op" id="7066575">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7066579">&#34;/search&#34;</span><span class="op" id="7066588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066593">}</span><span class="op" id="7066594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066599">ProtoMajor</span><span class="op" id="7066609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7066617">1</span><span class="op" id="7066618">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066623">ProtoMinor</span><span class="op" id="7066633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7066641">1</span><span class="op" id="7066642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066647">TransferEncoding</span><span class="op" id="7066663">:</span>&nbsp;<span class="op" id="7066665">[</span><span class="op" id="7066666">]</span><span class="builtintype" id="7066667">string</span><span class="op" id="7066673">{</span><span class="string" id="7066674">&#34;chunked&#34;</span><span class="op" id="7066683">}</span><span class="op" id="7066684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066688">}</span><span class="op" id="7066689">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066694">Body</span><span class="op" id="7066698">:</span>&nbsp;<span class="op" id="7066700">[</span><span class="op" id="7066701">]</span><span class="builtintype" id="7066702">byte</span><span class="op" id="7066706">(</span><span class="string" id="7066707">&#34;abcdef&#34;</span><span class="op" id="7066715">)</span><span class="op" id="7066716">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066721">WantDump</span><span class="op" id="7066729">:</span>&nbsp;<span class="string" id="7066731">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7066758">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066763">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7066790">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066795">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7066832">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066837">chunk</span><span class="op" id="7066842">(</span><span class="string" id="7066843">&#34;abcdef&#34;</span><span class="op" id="7066851">)</span>&nbsp;<span class="op" id="7066853">+</span>&nbsp;<span class="ident" id="7066855">chunk</span><span class="op" id="7066860">(</span><span class="string" id="7066861">&#34;&#34;</span><span class="op" id="7066863">)</span><span class="op" id="7066864">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066867">}</span><span class="op" id="7066868">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7066872">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7066955">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066989">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066993">Req</span><span class="op" id="7066996">:</span>&nbsp;<span class="ident" id="7066998">http</span><span class="op" id="7067002">.</span><span class="ident" id="7067003">Request</span><span class="op" id="7067010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067015">Method</span><span class="op" id="7067021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067027">&#34;GET&#34;</span><span class="op" id="7067032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067037">URL</span><span class="op" id="7067040">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7067049">mustParseURL</span><span class="op" id="7067061">(</span><span class="string" id="7067062">&#34;/foo&#34;</span><span class="op" id="7067068">)</span><span class="op" id="7067069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067074">ProtoMajor</span><span class="op" id="7067084">:</span>&nbsp;<span class="num" id="7067086">1</span><span class="op" id="7067087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067092">ProtoMinor</span><span class="op" id="7067102">:</span>&nbsp;<span class="num" id="7067104">0</span><span class="op" id="7067105">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067110">Header</span><span class="op" id="7067116">:</span>&nbsp;<span class="ident" id="7067118">http</span><span class="op" id="7067122">.</span><span class="ident" id="7067123">Header</span><span class="op" id="7067129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067135">&#34;X-Foo&#34;</span><span class="op" id="7067142">:</span>&nbsp;<span class="op" id="7067144">[</span><span class="op" id="7067145">]</span><span class="builtintype" id="7067146">string</span><span class="op" id="7067152">{</span><span class="string" id="7067153">&#34;X-Bar&#34;</span><span class="op" id="7067160">}</span><span class="op" id="7067161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067166">}</span><span class="op" id="7067167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067171">}</span><span class="op" id="7067172">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067177">WantDump</span><span class="op" id="7067185">:</span>&nbsp;<span class="string" id="7067187">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="7067211">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067216">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7067238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067241">}</span><span class="op" id="7067242">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067246">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067250">Req</span><span class="op" id="7067253">:</span>&nbsp;<span class="op" id="7067255">*</span><span class="ident" id="7067256">mustNewRequest</span><span class="op" id="7067270">(</span><span class="string" id="7067271">&#34;GET&#34;</span><span class="op" id="7067276">,</span>&nbsp;<span class="string" id="7067278">&#34;http://example.com/foo&#34;</span><span class="op" id="7067302">,</span>&nbsp;<span class="ident" id="7067304">nil</span><span class="op" id="7067307">)</span><span class="op" id="7067308">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067313">WantDumpOut</span><span class="op" id="7067324">:</span>&nbsp;<span class="string" id="7067326">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7067350">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067355">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7067379">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067384">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7067422">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067427">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7067458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067461">}</span><span class="op" id="7067462">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067466">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067530">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067587">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067605">Req</span><span class="op" id="7067608">:</span>&nbsp;<span class="op" id="7067610">*</span><span class="ident" id="7067611">mustNewRequest</span><span class="op" id="7067625">(</span><span class="string" id="7067626">&#34;GET&#34;</span><span class="op" id="7067631">,</span>&nbsp;<span class="string" id="7067633">&#34;https://example.com/foo&#34;</span><span class="op" id="7067658">,</span>&nbsp;<span class="ident" id="7067660">nil</span><span class="op" id="7067663">)</span><span class="op" id="7067664">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067669">WantDumpOut</span><span class="op" id="7067680">:</span>&nbsp;<span class="string" id="7067682">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7067706">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067711">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7067735">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067740">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7067778">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7067783">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7067814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067817">}</span><span class="op" id="7067818">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067822">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067880">Req</span><span class="op" id="7067883">:</span>&nbsp;<span class="ident" id="7067885">http</span><span class="op" id="7067889">.</span><span class="ident" id="7067890">Request</span><span class="op" id="7067897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067902">Method</span><span class="op" id="7067908">:</span>&nbsp;<span class="string" id="7067910">&#34;POST&#34;</span><span class="op" id="7067916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067921">URL</span><span class="op" id="7067924">:</span>&nbsp;<span class="op" id="7067926">&amp;</span><span class="ident" id="7067927">url</span><span class="op" id="7067930">.</span><span class="ident" id="7067931">URL</span><span class="op" id="7067934">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067940">Scheme</span><span class="op" id="7067946">:</span>&nbsp;<span class="string" id="7067948">&#34;http&#34;</span><span class="op" id="7067954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067960">Host</span><span class="op" id="7067964">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7067968">&#34;post.tld&#34;</span><span class="op" id="7067978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067984">Path</span><span class="op" id="7067988">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7067992">&#34;/&#34;</span><span class="op" id="7067995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068000">}</span><span class="op" id="7068001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068006">ContentLength</span><span class="op" id="7068019">:</span>&nbsp;<span class="num" id="7068021">6</span><span class="op" id="7068022">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068027">ProtoMajor</span><span class="op" id="7068037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068042">1</span><span class="op" id="7068043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068048">ProtoMinor</span><span class="op" id="7068058">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068063">1</span><span class="op" id="7068064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068068">}</span><span class="op" id="7068069">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068074">Body</span><span class="op" id="7068078">:</span>&nbsp;<span class="op" id="7068080">[</span><span class="op" id="7068081">]</span><span class="builtintype" id="7068082">byte</span><span class="op" id="7068086">(</span><span class="string" id="7068087">&#34;abcdef&#34;</span><span class="op" id="7068095">)</span><span class="op" id="7068096">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068101">WantDumpOut</span><span class="op" id="7068112">:</span>&nbsp;<span class="string" id="7068114">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7068136">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068141">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7068162">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068167">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7068205">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068210">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7068234">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068239">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7068270">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068275">NoBody</span><span class="op" id="7068281">:</span>&nbsp;<span class="builtintype" id="7068283">true</span><span class="op" id="7068287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068290">}</span><span class="op" id="7068291">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068295">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068350">Req</span><span class="op" id="7068353">:</span>&nbsp;<span class="ident" id="7068355">http</span><span class="op" id="7068359">.</span><span class="ident" id="7068360">Request</span><span class="op" id="7068367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068372">Method</span><span class="op" id="7068378">:</span>&nbsp;<span class="string" id="7068380">&#34;POST&#34;</span><span class="op" id="7068386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068391">URL</span><span class="op" id="7068394">:</span>&nbsp;<span class="op" id="7068396">&amp;</span><span class="ident" id="7068397">url</span><span class="op" id="7068400">.</span><span class="ident" id="7068401">URL</span><span class="op" id="7068404">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068410">Scheme</span><span class="op" id="7068416">:</span>&nbsp;<span class="string" id="7068418">&#34;http&#34;</span><span class="op" id="7068424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068430">Host</span><span class="op" id="7068434">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7068438">&#34;post.tld&#34;</span><span class="op" id="7068448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068454">Path</span><span class="op" id="7068458">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7068462">&#34;/&#34;</span><span class="op" id="7068465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068470">}</span><span class="op" id="7068471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068476">ContentLength</span><span class="op" id="7068489">:</span>&nbsp;<span class="num" id="7068491">8193</span><span class="op" id="7068495">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068500">ProtoMajor</span><span class="op" id="7068510">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068515">1</span><span class="op" id="7068516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068521">ProtoMinor</span><span class="op" id="7068531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068536">1</span><span class="op" id="7068537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068541">}</span><span class="op" id="7068542">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068547">Body</span><span class="op" id="7068551">:</span>&nbsp;<span class="ident" id="7068553">bytes</span><span class="op" id="7068558">.</span><span class="ident" id="7068559">Repeat</span><span class="op" id="7068565">(</span><span class="op" id="7068566">[</span><span class="op" id="7068567">]</span><span class="builtintype" id="7068568">byte</span><span class="op" id="7068572">(</span><span class="string" id="7068573">&#34;a&#34;</span><span class="op" id="7068576">)</span><span class="op" id="7068577">,</span>&nbsp;<span class="num" id="7068579">8193</span><span class="op" id="7068583">)</span><span class="op" id="7068584">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068589">WantDumpOut</span><span class="op" id="7068600">:</span>&nbsp;<span class="string" id="7068602">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7068624">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068629">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7068650">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068655">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7068693">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068698">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="7068725">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7068730">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7068762">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068767">strings</span><span class="op" id="7068774">.</span><span class="ident" id="7068775">Repeat</span><span class="op" id="7068781">(</span><span class="string" id="7068782">&#34;a&#34;</span><span class="op" id="7068785">,</span>&nbsp;<span class="num" id="7068787">8193</span><span class="op" id="7068791">)</span><span class="op" id="7068792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068795">}</span><span class="op" id="7068796">,</span><br>
<span class="lineno"></span><span class="op" id="7068798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7068801">func</span>&nbsp;<span class="ident" id="7068806">TestDumpRequest</span><span class="op" id="7068821">(</span><span class="ident" id="7068822">t</span>&nbsp;<span class="op" id="7068824">*</span><span class="ident" id="7068825">testing</span><span class="op" id="7068832">.</span><span class="ident" id="7068833">T</span><span class="op" id="7068834">)</span>&nbsp;<span class="op" id="7068836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068839">numg0</span>&nbsp;<span class="op" id="7068845">:=</span>&nbsp;<span class="ident" id="7068848">runtime</span><span class="op" id="7068855">.</span><span class="ident" id="7068856">NumGoroutine</span><span class="op" id="7068868">(</span><span class="op" id="7068869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068872">for</span>&nbsp;<span class="ident" id="7068876">i</span><span class="op" id="7068877">,</span>&nbsp;<span class="ident" id="7068879">tt</span>&nbsp;<span class="op" id="7068882">:=</span>&nbsp;<span class="keyword" id="7068885">range</span>&nbsp;<span class="ident" id="7068891">dumpTests</span>&nbsp;<span class="op" id="7068901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068905">setBody</span>&nbsp;<span class="op" id="7068913">:=</span>&nbsp;<span class="keyword" id="7068916">func</span><span class="op" id="7068920">(</span><span class="op" id="7068921">)</span>&nbsp;<span class="op" id="7068923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068928">if</span>&nbsp;<span class="ident" id="7068931">tt</span><span class="op" id="7068933">.</span><span class="ident" id="7068934">Body</span>&nbsp;<span class="op" id="7068939">==</span>&nbsp;<span class="ident" id="7068942">nil</span>&nbsp;<span class="op" id="7068946">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068952">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068967">switch</span>&nbsp;<span class="ident" id="7068974">b</span>&nbsp;<span class="op" id="7068976">:=</span>&nbsp;<span class="ident" id="7068979">tt</span><span class="op" id="7068981">.</span><span class="ident" id="7068982">Body</span><span class="op" id="7068986">.</span><span class="op" id="7068987">(</span><span class="keyword" id="7068988">type</span><span class="op" id="7068992">)</span>&nbsp;<span class="op" id="7068994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068999">case</span>&nbsp;<span class="op" id="7069004">[</span><span class="op" id="7069005">]</span><span class="builtintype" id="7069006">byte</span><span class="op" id="7069010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069016">tt</span><span class="op" id="7069018">.</span><span class="ident" id="7069019">Req</span><span class="op" id="7069022">.</span><span class="ident" id="7069023">Body</span>&nbsp;<span class="op" id="7069028">=</span>&nbsp;<span class="ident" id="7069030">ioutil</span><span class="op" id="7069036">.</span><span class="ident" id="7069037">NopCloser</span><span class="op" id="7069046">(</span><span class="ident" id="7069047">bytes</span><span class="op" id="7069052">.</span><span class="ident" id="7069053">NewReader</span><span class="op" id="7069062">(</span><span class="ident" id="7069063">b</span><span class="op" id="7069064">)</span><span class="op" id="7069065">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069070">case</span>&nbsp;<span class="keyword" id="7069075">func</span><span class="op" id="7069079">(</span><span class="op" id="7069080">)</span>&nbsp;<span class="ident" id="7069082">io</span><span class="op" id="7069084">.</span><span class="ident" id="7069085">ReadCloser</span><span class="op" id="7069095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069101">tt</span><span class="op" id="7069103">.</span><span class="ident" id="7069104">Req</span><span class="op" id="7069107">.</span><span class="ident" id="7069108">Body</span>&nbsp;<span class="op" id="7069113">=</span>&nbsp;<span class="ident" id="7069115">b</span><span class="op" id="7069116">(</span><span class="op" id="7069117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069122">default</span><span class="op" id="7069129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069135">t</span><span class="op" id="7069136">.</span><span class="ident" id="7069137">Fatalf</span><span class="op" id="7069143">(</span><span class="string" id="7069144">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="7069177">,</span>&nbsp;<span class="ident" id="7069179">i</span><span class="op" id="7069180">,</span>&nbsp;<span class="ident" id="7069182">tt</span><span class="op" id="7069184">.</span><span class="ident" id="7069185">Body</span><span class="op" id="7069189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069194">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069202">setBody</span><span class="op" id="7069209">(</span><span class="op" id="7069210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069214">if</span>&nbsp;<span class="ident" id="7069217">tt</span><span class="op" id="7069219">.</span><span class="ident" id="7069220">Req</span><span class="op" id="7069223">.</span><span class="ident" id="7069224">Header</span>&nbsp;<span class="op" id="7069231">==</span>&nbsp;<span class="ident" id="7069234">nil</span>&nbsp;<span class="op" id="7069238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069243">tt</span><span class="op" id="7069245">.</span><span class="ident" id="7069246">Req</span><span class="op" id="7069249">.</span><span class="ident" id="7069250">Header</span>&nbsp;<span class="op" id="7069257">=</span>&nbsp;<span class="builtinfunc" id="7069259">make</span><span class="op" id="7069263">(</span><span class="ident" id="7069264">http</span><span class="op" id="7069268">.</span><span class="ident" id="7069269">Header</span><span class="op" id="7069275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069279">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069284">if</span>&nbsp;<span class="ident" id="7069287">tt</span><span class="op" id="7069289">.</span><span class="ident" id="7069290">WantDump</span>&nbsp;<span class="op" id="7069299">!=</span>&nbsp;<span class="string" id="7069302">&#34;&#34;</span>&nbsp;<span class="op" id="7069305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069310">setBody</span><span class="op" id="7069317">(</span><span class="op" id="7069318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069323">dump</span><span class="op" id="7069327">,</span>&nbsp;<span class="ident" id="7069329">err</span>&nbsp;<span class="op" id="7069333">:=</span>&nbsp;<span class="ident" id="7069336">DumpRequest</span><span class="op" id="7069347">(</span><span class="op" id="7069348">&amp;</span><span class="ident" id="7069349">tt</span><span class="op" id="7069351">.</span><span class="ident" id="7069352">Req</span><span class="op" id="7069355">,</span>&nbsp;<span class="op" id="7069357">!</span><span class="ident" id="7069358">tt</span><span class="op" id="7069360">.</span><span class="ident" id="7069361">NoBody</span><span class="op" id="7069367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069372">if</span>&nbsp;<span class="ident" id="7069375">err</span>&nbsp;<span class="op" id="7069379">!=</span>&nbsp;<span class="ident" id="7069382">nil</span>&nbsp;<span class="op" id="7069386">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069392">t</span><span class="op" id="7069393">.</span><span class="ident" id="7069394">Errorf</span><span class="op" id="7069400">(</span><span class="string" id="7069401">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7069422">,</span>&nbsp;<span class="ident" id="7069424">i</span><span class="op" id="7069425">,</span>&nbsp;<span class="ident" id="7069427">err</span><span class="op" id="7069430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069436">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069453">if</span>&nbsp;<span class="builtintype" id="7069456">string</span><span class="op" id="7069462">(</span><span class="ident" id="7069463">dump</span><span class="op" id="7069467">)</span>&nbsp;<span class="op" id="7069469">!=</span>&nbsp;<span class="ident" id="7069472">tt</span><span class="op" id="7069474">.</span><span class="ident" id="7069475">WantDump</span>&nbsp;<span class="op" id="7069484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069490">t</span><span class="op" id="7069491">.</span><span class="ident" id="7069492">Errorf</span><span class="op" id="7069498">(</span><span class="string" id="7069499">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7069543">,</span>&nbsp;<span class="ident" id="7069545">i</span><span class="op" id="7069546">,</span>&nbsp;<span class="ident" id="7069548">tt</span><span class="op" id="7069550">.</span><span class="ident" id="7069551">WantDump</span><span class="op" id="7069559">,</span>&nbsp;<span class="builtintype" id="7069561">string</span><span class="op" id="7069567">(</span><span class="ident" id="7069568">dump</span><span class="op" id="7069572">)</span><span class="op" id="7069573">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069579">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069600">if</span>&nbsp;<span class="ident" id="7069603">tt</span><span class="op" id="7069605">.</span><span class="ident" id="7069606">WantDumpOut</span>&nbsp;<span class="op" id="7069618">!=</span>&nbsp;<span class="string" id="7069621">&#34;&#34;</span>&nbsp;<span class="op" id="7069624">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069629">setBody</span><span class="op" id="7069636">(</span><span class="op" id="7069637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069642">dump</span><span class="op" id="7069646">,</span>&nbsp;<span class="ident" id="7069648">err</span>&nbsp;<span class="op" id="7069652">:=</span>&nbsp;<span class="ident" id="7069655">DumpRequestOut</span><span class="op" id="7069669">(</span><span class="op" id="7069670">&amp;</span><span class="ident" id="7069671">tt</span><span class="op" id="7069673">.</span><span class="ident" id="7069674">Req</span><span class="op" id="7069677">,</span>&nbsp;<span class="op" id="7069679">!</span><span class="ident" id="7069680">tt</span><span class="op" id="7069682">.</span><span class="ident" id="7069683">NoBody</span><span class="op" id="7069689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069694">if</span>&nbsp;<span class="ident" id="7069697">err</span>&nbsp;<span class="op" id="7069701">!=</span>&nbsp;<span class="ident" id="7069704">nil</span>&nbsp;<span class="op" id="7069708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069714">t</span><span class="op" id="7069715">.</span><span class="ident" id="7069716">Errorf</span><span class="op" id="7069722">(</span><span class="string" id="7069723">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7069747">,</span>&nbsp;<span class="ident" id="7069749">i</span><span class="op" id="7069750">,</span>&nbsp;<span class="ident" id="7069752">err</span><span class="op" id="7069755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069761">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069778">if</span>&nbsp;<span class="builtintype" id="7069781">string</span><span class="op" id="7069787">(</span><span class="ident" id="7069788">dump</span><span class="op" id="7069792">)</span>&nbsp;<span class="op" id="7069794">!=</span>&nbsp;<span class="ident" id="7069797">tt</span><span class="op" id="7069799">.</span><span class="ident" id="7069800">WantDumpOut</span>&nbsp;<span class="op" id="7069812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069818">t</span><span class="op" id="7069819">.</span><span class="ident" id="7069820">Errorf</span><span class="op" id="7069826">(</span><span class="string" id="7069827">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7069874">,</span>&nbsp;<span class="ident" id="7069876">i</span><span class="op" id="7069877">,</span>&nbsp;<span class="ident" id="7069879">tt</span><span class="op" id="7069881">.</span><span class="ident" id="7069882">WantDumpOut</span><span class="op" id="7069893">,</span>&nbsp;<span class="builtintype" id="7069895">string</span><span class="op" id="7069901">(</span><span class="ident" id="7069902">dump</span><span class="op" id="7069906">)</span><span class="op" id="7069907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069913">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069925">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7069935">if</span>&nbsp;<span class="ident" id="7069938">dg</span>&nbsp;<span class="op" id="7069941">:=</span>&nbsp;<span class="ident" id="7069944">runtime</span><span class="op" id="7069951">.</span><span class="ident" id="7069952">NumGoroutine</span><span class="op" id="7069964">(</span><span class="op" id="7069965">)</span>&nbsp;<span class="op" id="7069967">-</span>&nbsp;<span class="ident" id="7069969">numg0</span><span class="op" id="7069974">;</span>&nbsp;<span class="ident" id="7069976">dg</span>&nbsp;<span class="op" id="7069979">&gt;</span>&nbsp;<span class="num" id="7069981">4</span>&nbsp;<span class="op" id="7069983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069987">buf</span>&nbsp;<span class="op" id="7069991">:=</span>&nbsp;<span class="builtinfunc" id="7069994">make</span><span class="op" id="7069998">(</span><span class="op" id="7069999">[</span><span class="op" id="7070000">]</span><span class="builtintype" id="7070001">byte</span><span class="op" id="7070005">,</span>&nbsp;<span class="num" id="7070007">4096</span><span class="op" id="7070011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070015">buf</span>&nbsp;<span class="op" id="7070019">=</span>&nbsp;<span class="ident" id="7070021">buf</span><span class="op" id="7070024">[</span><span class="op" id="7070025">:</span><span class="ident" id="7070026">runtime</span><span class="op" id="7070033">.</span><span class="ident" id="7070034">Stack</span><span class="op" id="7070039">(</span><span class="ident" id="7070040">buf</span><span class="op" id="7070043">,</span>&nbsp;<span class="builtintype" id="7070045">true</span><span class="op" id="7070049">)</span><span class="op" id="7070050">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070054">t</span><span class="op" id="7070055">.</span><span class="ident" id="7070056">Errorf</span><span class="op" id="7070062">(</span><span class="string" id="7070063">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="7070120">,</span>&nbsp;<span class="ident" id="7070122">dg</span><span class="op" id="7070124">,</span>&nbsp;<span class="ident" id="7070126">buf</span><span class="op" id="7070129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070132">}</span><br>
<span class="lineno"></span><span class="op" id="7070134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070137">func</span>&nbsp;<span class="ident" id="7070142">chunk</span><span class="op" id="7070147">(</span><span class="ident" id="7070148">s</span>&nbsp;<span class="builtintype" id="7070150">string</span><span class="op" id="7070156">)</span>&nbsp;<span class="builtintype" id="7070158">string</span>&nbsp;<span class="op" id="7070165">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070168">return</span>&nbsp;<span class="ident" id="7070175">fmt</span><span class="op" id="7070178">.</span><span class="ident" id="7070179">Sprintf</span><span class="op" id="7070186">(</span><span class="string" id="7070187">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7070201">,</span>&nbsp;<span class="builtinfunc" id="7070203">len</span><span class="op" id="7070206">(</span><span class="ident" id="7070207">s</span><span class="op" id="7070208">)</span><span class="op" id="7070209">,</span>&nbsp;<span class="ident" id="7070211">s</span><span class="op" id="7070212">)</span><br>
<span class="lineno"></span><span class="op" id="7070214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070217">func</span>&nbsp;<span class="ident" id="7070222">mustParseURL</span><span class="op" id="7070234">(</span><span class="ident" id="7070235">s</span>&nbsp;<span class="builtintype" id="7070237">string</span><span class="op" id="7070243">)</span>&nbsp;<span class="op" id="7070245">*</span><span class="ident" id="7070246">url</span><span class="op" id="7070249">.</span><span class="ident" id="7070250">URL</span>&nbsp;<span class="op" id="7070254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070257">u</span><span class="op" id="7070258">,</span>&nbsp;<span class="ident" id="7070260">err</span>&nbsp;<span class="op" id="7070264">:=</span>&nbsp;<span class="ident" id="7070267">url</span><span class="op" id="7070270">.</span><span class="ident" id="7070271">Parse</span><span class="op" id="7070276">(</span><span class="ident" id="7070277">s</span><span class="op" id="7070278">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070281">if</span>&nbsp;<span class="ident" id="7070284">err</span>&nbsp;<span class="op" id="7070288">!=</span>&nbsp;<span class="ident" id="7070291">nil</span>&nbsp;<span class="op" id="7070295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7070299">panic</span><span class="op" id="7070304">(</span><span class="ident" id="7070305">fmt</span><span class="op" id="7070308">.</span><span class="ident" id="7070309">Sprintf</span><span class="op" id="7070316">(</span><span class="string" id="7070317">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7070343">,</span>&nbsp;<span class="ident" id="7070345">s</span><span class="op" id="7070346">,</span>&nbsp;<span class="ident" id="7070348">err</span><span class="op" id="7070351">)</span><span class="op" id="7070352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070358">return</span>&nbsp;<span class="ident" id="7070365">u</span><br>
<span class="lineno"></span><span class="op" id="7070367">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="7070370">func</span>&nbsp;<span class="ident" id="7070375">mustNewRequest</span><span class="op" id="7070389">(</span><span class="ident" id="7070390">method</span><span class="op" id="7070396">,</span>&nbsp;<span class="ident" id="7070398">url</span>&nbsp;<span class="builtintype" id="7070402">string</span><span class="op" id="7070408">,</span>&nbsp;<span class="ident" id="7070410">body</span>&nbsp;<span class="ident" id="7070415">io</span><span class="op" id="7070417">.</span><span class="ident" id="7070418">Reader</span><span class="op" id="7070424">)</span>&nbsp;<span class="op" id="7070426">*</span><span class="ident" id="7070427">http</span><span class="op" id="7070431">.</span><span class="ident" id="7070432">Request</span>&nbsp;<span class="op" id="7070440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070443">req</span><span class="op" id="7070446">,</span>&nbsp;<span class="ident" id="7070448">err</span>&nbsp;<span class="op" id="7070452">:=</span>&nbsp;<span class="ident" id="7070455">http</span><span class="op" id="7070459">.</span><span class="ident" id="7070460">NewRequest</span><span class="op" id="7070470">(</span><span class="ident" id="7070471">method</span><span class="op" id="7070477">,</span>&nbsp;<span class="ident" id="7070479">url</span><span class="op" id="7070482">,</span>&nbsp;<span class="ident" id="7070484">body</span><span class="op" id="7070488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070491">if</span>&nbsp;<span class="ident" id="7070494">err</span>&nbsp;<span class="op" id="7070498">!=</span>&nbsp;<span class="ident" id="7070501">nil</span>&nbsp;<span class="op" id="7070505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7070509">panic</span><span class="op" id="7070514">(</span><span class="ident" id="7070515">fmt</span><span class="op" id="7070518">.</span><span class="ident" id="7070519">Sprintf</span><span class="op" id="7070526">(</span><span class="string" id="7070527">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7070560">,</span>&nbsp;<span class="ident" id="7070562">method</span><span class="op" id="7070568">,</span>&nbsp;<span class="ident" id="7070570">url</span><span class="op" id="7070573">,</span>&nbsp;<span class="ident" id="7070575">body</span><span class="op" id="7070579">,</span>&nbsp;<span class="ident" id="7070581">err</span><span class="op" id="7070584">)</span><span class="op" id="7070585">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070591">return</span>&nbsp;<span class="ident" id="7070598">req</span><br>
<span class="lineno"></span><span class="op" id="7070602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070605">var</span>&nbsp;<span class="ident" id="7070609">dumpResTests</span>&nbsp;<span class="op" id="7070622">=</span>&nbsp;<span class="op" id="7070624">[</span><span class="op" id="7070625">]</span><span class="keyword" id="7070626">struct</span>&nbsp;<span class="op" id="7070633">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070636">res</span>&nbsp;&nbsp;<span class="op" id="7070641">*</span><span class="ident" id="7070642">http</span><span class="op" id="7070646">.</span><span class="ident" id="7070647">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070657">body</span>&nbsp;<span class="builtintype" id="7070662">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070668">want</span>&nbsp;<span class="builtintype" id="7070673">string</span><br>
<span class="lineno"></span><span class="op" id="7070680">}</span><span class="op" id="7070681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070684">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070688">res</span><span class="op" id="7070691">:</span>&nbsp;<span class="op" id="7070693">&amp;</span><span class="ident" id="7070694">http</span><span class="op" id="7070698">.</span><span class="ident" id="7070699">Response</span><span class="op" id="7070707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070712">Status</span><span class="op" id="7070718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7070727">&#34;200&nbsp;OK&#34;</span><span class="op" id="7070735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070740">StatusCode</span><span class="op" id="7070750">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7070755">200</span><span class="op" id="7070758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070763">Proto</span><span class="op" id="7070768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7070778">&#34;HTTP/1.1&#34;</span><span class="op" id="7070788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070793">ProtoMajor</span><span class="op" id="7070803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7070808">1</span><span class="op" id="7070809">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070814">ProtoMinor</span><span class="op" id="7070824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7070829">1</span><span class="op" id="7070830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070835">ContentLength</span><span class="op" id="7070848">:</span>&nbsp;<span class="num" id="7070850">50</span><span class="op" id="7070852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070857">Header</span><span class="op" id="7070863">:</span>&nbsp;<span class="ident" id="7070865">http</span><span class="op" id="7070869">.</span><span class="ident" id="7070870">Header</span><span class="op" id="7070876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070882">&#34;Foo&#34;</span><span class="op" id="7070887">:</span>&nbsp;<span class="op" id="7070889">[</span><span class="op" id="7070890">]</span><span class="builtintype" id="7070891">string</span><span class="op" id="7070897">{</span><span class="string" id="7070898">&#34;Bar&#34;</span><span class="op" id="7070903">}</span><span class="op" id="7070904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070909">}</span><span class="op" id="7070910">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070915">Body</span><span class="op" id="7070919">:</span>&nbsp;<span class="ident" id="7070921">ioutil</span><span class="op" id="7070927">.</span><span class="ident" id="7070928">NopCloser</span><span class="op" id="7070937">(</span><span class="ident" id="7070938">strings</span><span class="op" id="7070945">.</span><span class="ident" id="7070946">NewReader</span><span class="op" id="7070955">(</span><span class="string" id="7070956">&#34;foo&#34;</span><span class="op" id="7070961">)</span><span class="op" id="7070962">)</span><span class="op" id="7070963">,</span>&nbsp;<span class="comment" id="7070965">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070988">}</span><span class="op" id="7070989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070993">body</span><span class="op" id="7070997">:</span>&nbsp;<span class="builtintype" id="7070999">false</span><span class="op" id="7071004">,</span>&nbsp;<span class="comment" id="7071006">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071048">want</span><span class="op" id="7071052">:</span>&nbsp;<span class="string" id="7071054">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="7071099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071102">}</span><span class="op" id="7071103">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071111">res</span><span class="op" id="7071114">:</span>&nbsp;<span class="op" id="7071116">&amp;</span><span class="ident" id="7071117">http</span><span class="op" id="7071121">.</span><span class="ident" id="7071122">Response</span><span class="op" id="7071130">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071135">Status</span><span class="op" id="7071141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071150">&#34;200&nbsp;OK&#34;</span><span class="op" id="7071158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071163">StatusCode</span><span class="op" id="7071173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071178">200</span><span class="op" id="7071181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071186">Proto</span><span class="op" id="7071191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071201">&#34;HTTP/1.1&#34;</span><span class="op" id="7071211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071216">ProtoMajor</span><span class="op" id="7071226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071231">1</span><span class="op" id="7071232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071237">ProtoMinor</span><span class="op" id="7071247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071252">1</span><span class="op" id="7071253">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071258">ContentLength</span><span class="op" id="7071271">:</span>&nbsp;<span class="num" id="7071273">3</span><span class="op" id="7071274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071279">Body</span><span class="op" id="7071283">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071294">ioutil</span><span class="op" id="7071300">.</span><span class="ident" id="7071301">NopCloser</span><span class="op" id="7071310">(</span><span class="ident" id="7071311">strings</span><span class="op" id="7071318">.</span><span class="ident" id="7071319">NewReader</span><span class="op" id="7071328">(</span><span class="string" id="7071329">&#34;foo&#34;</span><span class="op" id="7071334">)</span><span class="op" id="7071335">)</span><span class="op" id="7071336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071340">}</span><span class="op" id="7071341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071345">body</span><span class="op" id="7071349">:</span>&nbsp;<span class="builtintype" id="7071351">true</span><span class="op" id="7071355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071359">want</span><span class="op" id="7071363">:</span>&nbsp;<span class="string" id="7071365">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="7071405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071408">}</span><span class="op" id="7071409">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071417">res</span><span class="op" id="7071420">:</span>&nbsp;<span class="op" id="7071422">&amp;</span><span class="ident" id="7071423">http</span><span class="op" id="7071427">.</span><span class="ident" id="7071428">Response</span><span class="op" id="7071436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071441">Status</span><span class="op" id="7071447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071459">&#34;200&nbsp;OK&#34;</span><span class="op" id="7071467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071472">StatusCode</span><span class="op" id="7071482">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071490">200</span><span class="op" id="7071493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071498">Proto</span><span class="op" id="7071503">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071516">&#34;HTTP/1.1&#34;</span><span class="op" id="7071526">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071531">ProtoMajor</span><span class="op" id="7071541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071549">1</span><span class="op" id="7071550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071555">ProtoMinor</span><span class="op" id="7071565">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071573">1</span><span class="op" id="7071574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071579">ContentLength</span><span class="op" id="7071592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7071597">-</span><span class="num" id="7071598">1</span><span class="op" id="7071599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071604">Body</span><span class="op" id="7071608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071622">ioutil</span><span class="op" id="7071628">.</span><span class="ident" id="7071629">NopCloser</span><span class="op" id="7071638">(</span><span class="ident" id="7071639">strings</span><span class="op" id="7071646">.</span><span class="ident" id="7071647">NewReader</span><span class="op" id="7071656">(</span><span class="string" id="7071657">&#34;foo&#34;</span><span class="op" id="7071662">)</span><span class="op" id="7071663">)</span><span class="op" id="7071664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071669">TransferEncoding</span><span class="op" id="7071685">:</span>&nbsp;<span class="op" id="7071687">[</span><span class="op" id="7071688">]</span><span class="builtintype" id="7071689">string</span><span class="op" id="7071695">{</span><span class="string" id="7071696">&#34;chunked&#34;</span><span class="op" id="7071705">}</span><span class="op" id="7071706">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071710">}</span><span class="op" id="7071711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071715">body</span><span class="op" id="7071719">:</span>&nbsp;<span class="builtintype" id="7071721">true</span><span class="op" id="7071725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071729">want</span><span class="op" id="7071733">:</span>&nbsp;<span class="string" id="7071735">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="7071788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071791">}</span><span class="op" id="7071792">,</span><br>
<span class="lineno"></span><span class="op" id="7071794">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="7071797">func</span>&nbsp;<span class="ident" id="7071802">TestDumpResponse</span><span class="op" id="7071818">(</span><span class="ident" id="7071819">t</span>&nbsp;<span class="op" id="7071821">*</span><span class="ident" id="7071822">testing</span><span class="op" id="7071829">.</span><span class="ident" id="7071830">T</span><span class="op" id="7071831">)</span>&nbsp;<span class="op" id="7071833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071836">for</span>&nbsp;<span class="ident" id="7071840">i</span><span class="op" id="7071841">,</span>&nbsp;<span class="ident" id="7071843">tt</span>&nbsp;<span class="op" id="7071846">:=</span>&nbsp;<span class="keyword" id="7071849">range</span>&nbsp;<span class="ident" id="7071855">dumpResTests</span>&nbsp;<span class="op" id="7071868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071872">gotb</span><span class="op" id="7071876">,</span>&nbsp;<span class="ident" id="7071878">err</span>&nbsp;<span class="op" id="7071882">:=</span>&nbsp;<span class="ident" id="7071885">DumpResponse</span><span class="op" id="7071897">(</span><span class="ident" id="7071898">tt</span><span class="op" id="7071900">.</span><span class="ident" id="7071901">res</span><span class="op" id="7071904">,</span>&nbsp;<span class="ident" id="7071906">tt</span><span class="op" id="7071908">.</span><span class="ident" id="7071909">body</span><span class="op" id="7071913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071917">if</span>&nbsp;<span class="ident" id="7071920">err</span>&nbsp;<span class="op" id="7071924">!=</span>&nbsp;<span class="ident" id="7071927">nil</span>&nbsp;<span class="op" id="7071931">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071936">t</span><span class="op" id="7071937">.</span><span class="ident" id="7071938">Errorf</span><span class="op" id="7071944">(</span><span class="string" id="7071945">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7071968">,</span>&nbsp;<span class="ident" id="7071970">i</span><span class="op" id="7071971">,</span>&nbsp;<span class="ident" id="7071973">err</span><span class="op" id="7071976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071981">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071996">got</span>&nbsp;<span class="op" id="7072000">:=</span>&nbsp;<span class="builtintype" id="7072003">string</span><span class="op" id="7072009">(</span><span class="ident" id="7072010">gotb</span><span class="op" id="7072014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072018">got</span>&nbsp;<span class="op" id="7072022">=</span>&nbsp;<span class="ident" id="7072024">strings</span><span class="op" id="7072031">.</span><span class="ident" id="7072032">TrimSpace</span><span class="op" id="7072041">(</span><span class="ident" id="7072042">got</span><span class="op" id="7072045">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072049">got</span>&nbsp;<span class="op" id="7072053">=</span>&nbsp;<span class="ident" id="7072055">strings</span><span class="op" id="7072062">.</span><span class="ident" id="7072063">Replace</span><span class="op" id="7072070">(</span><span class="ident" id="7072071">got</span><span class="op" id="7072074">,</span>&nbsp;<span class="string" id="7072076">&#34;\r&#34;</span><span class="op" id="7072080">,</span>&nbsp;<span class="string" id="7072082">&#34;&#34;</span><span class="op" id="7072084">,</span>&nbsp;<span class="op" id="7072086">-</span><span class="num" id="7072087">1</span><span class="op" id="7072088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072093">if</span>&nbsp;<span class="ident" id="7072096">got</span>&nbsp;<span class="op" id="7072100">!=</span>&nbsp;<span class="ident" id="7072103">tt</span><span class="op" id="7072105">.</span><span class="ident" id="7072106">want</span>&nbsp;<span class="op" id="7072111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072116">t</span><span class="op" id="7072117">.</span><span class="ident" id="7072118">Errorf</span><span class="op" id="7072124">(</span><span class="string" id="7072125">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="7072168">,</span>&nbsp;<span class="ident" id="7072170">i</span><span class="op" id="7072171">,</span>&nbsp;<span class="ident" id="7072173">got</span><span class="op" id="7072176">,</span>&nbsp;<span class="ident" id="7072178">tt</span><span class="op" id="7072180">.</span><span class="ident" id="7072181">want</span><span class="op" id="7072185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072189">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072192">}</span><br>
<span class="lineno"></span><span class="op" id="7072194">}</span>
</div>
</body>
</html>
