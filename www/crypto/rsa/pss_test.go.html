<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8200494">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8200549">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8200603">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8200654">package</span>&nbsp;<span class="ident" id="8200662">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8200667">import</span>&nbsp;<span class="op" id="8200674">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200677">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200686">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200695">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200713">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200723">_</span>&nbsp;<span class="string" id="8200725">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200739">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200754">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200769">_</span>&nbsp;<span class="string" id="8200771">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200788">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200804">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200816">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200822">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200833">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8200844">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8200854">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8200857">func</span>&nbsp;<span class="ident" id="8200862">TestEMSAPSS</span><span class="op" id="8200873">(</span><span class="ident" id="8200874">t</span>&nbsp;<span class="op" id="8200876">*</span><span class="ident" id="8200877">testing</span><span class="op" id="8200884">.</span><span class="ident" id="8200885">T</span><span class="op" id="8200886">)</span>&nbsp;<span class="op" id="8200888">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8200891">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200994">msg</span>&nbsp;<span class="op" id="8200998">:=</span>&nbsp;<span class="op" id="8201001">[</span><span class="op" id="8201002">]</span><span class="builtintype" id="8201003">byte</span><span class="op" id="8201007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201011">0x85</span><span class="op" id="8201015">,</span>&nbsp;<span class="num" id="8201017">0x9e</span><span class="op" id="8201021">,</span>&nbsp;<span class="num" id="8201023">0xef</span><span class="op" id="8201027">,</span>&nbsp;<span class="num" id="8201029">0x2f</span><span class="op" id="8201033">,</span>&nbsp;<span class="num" id="8201035">0xd7</span><span class="op" id="8201039">,</span>&nbsp;<span class="num" id="8201041">0x8a</span><span class="op" id="8201045">,</span>&nbsp;<span class="num" id="8201047">0xca</span><span class="op" id="8201051">,</span>&nbsp;<span class="num" id="8201053">0x00</span><span class="op" id="8201057">,</span>&nbsp;<span class="num" id="8201059">0x30</span><span class="op" id="8201063">,</span>&nbsp;<span class="num" id="8201065">0x8b</span><span class="op" id="8201069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201073">0xdc</span><span class="op" id="8201077">,</span>&nbsp;<span class="num" id="8201079">0x47</span><span class="op" id="8201083">,</span>&nbsp;<span class="num" id="8201085">0x11</span><span class="op" id="8201089">,</span>&nbsp;<span class="num" id="8201091">0x93</span><span class="op" id="8201095">,</span>&nbsp;<span class="num" id="8201097">0xbf</span><span class="op" id="8201101">,</span>&nbsp;<span class="num" id="8201103">0x55</span><span class="op" id="8201107">,</span>&nbsp;<span class="num" id="8201109">0xbf</span><span class="op" id="8201113">,</span>&nbsp;<span class="num" id="8201115">0x9d</span><span class="op" id="8201119">,</span>&nbsp;<span class="num" id="8201121">0x78</span><span class="op" id="8201125">,</span>&nbsp;<span class="num" id="8201127">0xdb</span><span class="op" id="8201131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201135">0x8f</span><span class="op" id="8201139">,</span>&nbsp;<span class="num" id="8201141">0x8a</span><span class="op" id="8201145">,</span>&nbsp;<span class="num" id="8201147">0x67</span><span class="op" id="8201151">,</span>&nbsp;<span class="num" id="8201153">0x2b</span><span class="op" id="8201157">,</span>&nbsp;<span class="num" id="8201159">0x48</span><span class="op" id="8201163">,</span>&nbsp;<span class="num" id="8201165">0x46</span><span class="op" id="8201169">,</span>&nbsp;<span class="num" id="8201171">0x34</span><span class="op" id="8201175">,</span>&nbsp;<span class="num" id="8201177">0xf3</span><span class="op" id="8201181">,</span>&nbsp;<span class="num" id="8201183">0xc9</span><span class="op" id="8201187">,</span>&nbsp;<span class="num" id="8201189">0xc2</span><span class="op" id="8201193">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201197">0x6e</span><span class="op" id="8201201">,</span>&nbsp;<span class="num" id="8201203">0x64</span><span class="op" id="8201207">,</span>&nbsp;<span class="num" id="8201209">0x78</span><span class="op" id="8201213">,</span>&nbsp;<span class="num" id="8201215">0xae</span><span class="op" id="8201219">,</span>&nbsp;<span class="num" id="8201221">0x10</span><span class="op" id="8201225">,</span>&nbsp;<span class="num" id="8201227">0x26</span><span class="op" id="8201231">,</span>&nbsp;<span class="num" id="8201233">0x0f</span><span class="op" id="8201237">,</span>&nbsp;<span class="num" id="8201239">0xe0</span><span class="op" id="8201243">,</span>&nbsp;<span class="num" id="8201245">0xdd</span><span class="op" id="8201249">,</span>&nbsp;<span class="num" id="8201251">0x8c</span><span class="op" id="8201255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201259">0x08</span><span class="op" id="8201263">,</span>&nbsp;<span class="num" id="8201265">0x2e</span><span class="op" id="8201269">,</span>&nbsp;<span class="num" id="8201271">0x53</span><span class="op" id="8201275">,</span>&nbsp;<span class="num" id="8201277">0xa5</span><span class="op" id="8201281">,</span>&nbsp;<span class="num" id="8201283">0x29</span><span class="op" id="8201287">,</span>&nbsp;<span class="num" id="8201289">0x3a</span><span class="op" id="8201293">,</span>&nbsp;<span class="num" id="8201295">0xf2</span><span class="op" id="8201299">,</span>&nbsp;<span class="num" id="8201301">0x17</span><span class="op" id="8201305">,</span>&nbsp;<span class="num" id="8201307">0x3c</span><span class="op" id="8201311">,</span>&nbsp;<span class="num" id="8201313">0xd5</span><span class="op" id="8201317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201321">0x0c</span><span class="op" id="8201325">,</span>&nbsp;<span class="num" id="8201327">0x6d</span><span class="op" id="8201331">,</span>&nbsp;<span class="num" id="8201333">0x5d</span><span class="op" id="8201337">,</span>&nbsp;<span class="num" id="8201339">0x35</span><span class="op" id="8201343">,</span>&nbsp;<span class="num" id="8201345">0x4f</span><span class="op" id="8201349">,</span>&nbsp;<span class="num" id="8201351">0xeb</span><span class="op" id="8201355">,</span>&nbsp;<span class="num" id="8201357">0xf7</span><span class="op" id="8201361">,</span>&nbsp;<span class="num" id="8201363">0x8b</span><span class="op" id="8201367">,</span>&nbsp;<span class="num" id="8201369">0x26</span><span class="op" id="8201373">,</span>&nbsp;<span class="num" id="8201375">0x02</span><span class="op" id="8201379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201383">0x1c</span><span class="op" id="8201387">,</span>&nbsp;<span class="num" id="8201389">0x25</span><span class="op" id="8201393">,</span>&nbsp;<span class="num" id="8201395">0xc0</span><span class="op" id="8201399">,</span>&nbsp;<span class="num" id="8201401">0x27</span><span class="op" id="8201405">,</span>&nbsp;<span class="num" id="8201407">0x12</span><span class="op" id="8201411">,</span>&nbsp;<span class="num" id="8201413">0xe7</span><span class="op" id="8201417">,</span>&nbsp;<span class="num" id="8201419">0x8c</span><span class="op" id="8201423">,</span>&nbsp;<span class="num" id="8201425">0xd4</span><span class="op" id="8201429">,</span>&nbsp;<span class="num" id="8201431">0x69</span><span class="op" id="8201435">,</span>&nbsp;<span class="num" id="8201437">0x4c</span><span class="op" id="8201441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201445">0x9f</span><span class="op" id="8201449">,</span>&nbsp;<span class="num" id="8201451">0x46</span><span class="op" id="8201455">,</span>&nbsp;<span class="num" id="8201457">0x97</span><span class="op" id="8201461">,</span>&nbsp;<span class="num" id="8201463">0x77</span><span class="op" id="8201467">,</span>&nbsp;<span class="num" id="8201469">0xe4</span><span class="op" id="8201473">,</span>&nbsp;<span class="num" id="8201475">0x51</span><span class="op" id="8201479">,</span>&nbsp;<span class="num" id="8201481">0xe7</span><span class="op" id="8201485">,</span>&nbsp;<span class="num" id="8201487">0xf8</span><span class="op" id="8201491">,</span>&nbsp;<span class="num" id="8201493">0xe9</span><span class="op" id="8201497">,</span>&nbsp;<span class="num" id="8201499">0xe0</span><span class="op" id="8201503">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201507">0x4c</span><span class="op" id="8201511">,</span>&nbsp;<span class="num" id="8201513">0xd3</span><span class="op" id="8201517">,</span>&nbsp;<span class="num" id="8201519">0x73</span><span class="op" id="8201523">,</span>&nbsp;<span class="num" id="8201525">0x9c</span><span class="op" id="8201529">,</span>&nbsp;<span class="num" id="8201531">0x6b</span><span class="op" id="8201535">,</span>&nbsp;<span class="num" id="8201537">0xbf</span><span class="op" id="8201541">,</span>&nbsp;<span class="num" id="8201543">0xed</span><span class="op" id="8201547">,</span>&nbsp;<span class="num" id="8201549">0xae</span><span class="op" id="8201553">,</span>&nbsp;<span class="num" id="8201555">0x48</span><span class="op" id="8201559">,</span>&nbsp;<span class="num" id="8201561">0x7f</span><span class="op" id="8201565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201569">0xb5</span><span class="op" id="8201573">,</span>&nbsp;<span class="num" id="8201575">0x56</span><span class="op" id="8201579">,</span>&nbsp;<span class="num" id="8201581">0x44</span><span class="op" id="8201585">,</span>&nbsp;<span class="num" id="8201587">0xe9</span><span class="op" id="8201591">,</span>&nbsp;<span class="num" id="8201593">0xca</span><span class="op" id="8201597">,</span>&nbsp;<span class="num" id="8201599">0x74</span><span class="op" id="8201603">,</span>&nbsp;<span class="num" id="8201605">0xff</span><span class="op" id="8201609">,</span>&nbsp;<span class="num" id="8201611">0x77</span><span class="op" id="8201615">,</span>&nbsp;<span class="num" id="8201617">0xa5</span><span class="op" id="8201621">,</span>&nbsp;<span class="num" id="8201623">0x3c</span><span class="op" id="8201627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201631">0xb7</span><span class="op" id="8201635">,</span>&nbsp;<span class="num" id="8201637">0x29</span><span class="op" id="8201641">,</span>&nbsp;<span class="num" id="8201643">0x80</span><span class="op" id="8201647">,</span>&nbsp;<span class="num" id="8201649">0x2f</span><span class="op" id="8201653">,</span>&nbsp;<span class="num" id="8201655">0x6e</span><span class="op" id="8201659">,</span>&nbsp;<span class="num" id="8201661">0xd4</span><span class="op" id="8201665">,</span>&nbsp;<span class="num" id="8201667">0xa5</span><span class="op" id="8201671">,</span>&nbsp;<span class="num" id="8201673">0xff</span><span class="op" id="8201677">,</span>&nbsp;<span class="num" id="8201679">0xa8</span><span class="op" id="8201683">,</span>&nbsp;<span class="num" id="8201685">0xba</span><span class="op" id="8201689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201693">0x15</span><span class="op" id="8201697">,</span>&nbsp;<span class="num" id="8201699">0x98</span><span class="op" id="8201703">,</span>&nbsp;<span class="num" id="8201705">0x90</span><span class="op" id="8201709">,</span>&nbsp;<span class="num" id="8201711">0xfc</span><span class="op" id="8201715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201718">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201721">salt</span>&nbsp;<span class="op" id="8201726">:=</span>&nbsp;<span class="op" id="8201729">[</span><span class="op" id="8201730">]</span><span class="builtintype" id="8201731">byte</span><span class="op" id="8201735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201739">0xe3</span><span class="op" id="8201743">,</span>&nbsp;<span class="num" id="8201745">0xb5</span><span class="op" id="8201749">,</span>&nbsp;<span class="num" id="8201751">0xd5</span><span class="op" id="8201755">,</span>&nbsp;<span class="num" id="8201757">0xd0</span><span class="op" id="8201761">,</span>&nbsp;<span class="num" id="8201763">0x02</span><span class="op" id="8201767">,</span>&nbsp;<span class="num" id="8201769">0xc1</span><span class="op" id="8201773">,</span>&nbsp;<span class="num" id="8201775">0xbc</span><span class="op" id="8201779">,</span>&nbsp;<span class="num" id="8201781">0xe5</span><span class="op" id="8201785">,</span>&nbsp;<span class="num" id="8201787">0x0c</span><span class="op" id="8201791">,</span>&nbsp;<span class="num" id="8201793">0x2b</span><span class="op" id="8201797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201801">0x65</span><span class="op" id="8201805">,</span>&nbsp;<span class="num" id="8201807">0xef</span><span class="op" id="8201811">,</span>&nbsp;<span class="num" id="8201813">0x88</span><span class="op" id="8201817">,</span>&nbsp;<span class="num" id="8201819">0xa1</span><span class="op" id="8201823">,</span>&nbsp;<span class="num" id="8201825">0x88</span><span class="op" id="8201829">,</span>&nbsp;<span class="num" id="8201831">0xd8</span><span class="op" id="8201835">,</span>&nbsp;<span class="num" id="8201837">0x3b</span><span class="op" id="8201841">,</span>&nbsp;<span class="num" id="8201843">0xce</span><span class="op" id="8201847">,</span>&nbsp;<span class="num" id="8201849">0x7e</span><span class="op" id="8201853">,</span>&nbsp;<span class="num" id="8201855">0x61</span><span class="op" id="8201859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201865">expected</span>&nbsp;<span class="op" id="8201874">:=</span>&nbsp;<span class="op" id="8201877">[</span><span class="op" id="8201878">]</span><span class="builtintype" id="8201879">byte</span><span class="op" id="8201883">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201887">0x66</span><span class="op" id="8201891">,</span>&nbsp;<span class="num" id="8201893">0xe4</span><span class="op" id="8201897">,</span>&nbsp;<span class="num" id="8201899">0x67</span><span class="op" id="8201903">,</span>&nbsp;<span class="num" id="8201905">0x2e</span><span class="op" id="8201909">,</span>&nbsp;<span class="num" id="8201911">0x83</span><span class="op" id="8201915">,</span>&nbsp;<span class="num" id="8201917">0x6a</span><span class="op" id="8201921">,</span>&nbsp;<span class="num" id="8201923">0xd1</span><span class="op" id="8201927">,</span>&nbsp;<span class="num" id="8201929">0x21</span><span class="op" id="8201933">,</span>&nbsp;<span class="num" id="8201935">0xba</span><span class="op" id="8201939">,</span>&nbsp;<span class="num" id="8201941">0x24</span><span class="op" id="8201945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8201949">0x4b</span><span class="op" id="8201953">,</span>&nbsp;<span class="num" id="8201955">0xed</span><span class="op" id="8201959">,</span>&nbsp;<span class="num" id="8201961">0x65</span><span class="op" id="8201965">,</span>&nbsp;<span class="num" id="8201967">0x76</span><span class="op" id="8201971">,</span>&nbsp;<span class="num" id="8201973">0xb8</span><span class="op" id="8201977">,</span>&nbsp;<span class="num" id="8201979">0x67</span><span class="op" id="8201983">,</span>&nbsp;<span class="num" id="8201985">0xd9</span><span class="op" id="8201989">,</span>&nbsp;<span class="num" id="8201991">0xa4</span><span class="op" id="8201995">,</span>&nbsp;<span class="num" id="8201997">0x47</span><span class="op" id="8202001">,</span>&nbsp;<span class="num" id="8202003">0xc2</span><span class="op" id="8202007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202011">0x8a</span><span class="op" id="8202015">,</span>&nbsp;<span class="num" id="8202017">0x6e</span><span class="op" id="8202021">,</span>&nbsp;<span class="num" id="8202023">0x66</span><span class="op" id="8202027">,</span>&nbsp;<span class="num" id="8202029">0xa5</span><span class="op" id="8202033">,</span>&nbsp;<span class="num" id="8202035">0xb8</span><span class="op" id="8202039">,</span>&nbsp;<span class="num" id="8202041">0x7d</span><span class="op" id="8202045">,</span>&nbsp;<span class="num" id="8202047">0xee</span><span class="op" id="8202051">,</span>&nbsp;<span class="num" id="8202053">0x7f</span><span class="op" id="8202057">,</span>&nbsp;<span class="num" id="8202059">0xbc</span><span class="op" id="8202063">,</span>&nbsp;<span class="num" id="8202065">0x7e</span><span class="op" id="8202069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202073">0x65</span><span class="op" id="8202077">,</span>&nbsp;<span class="num" id="8202079">0xaf</span><span class="op" id="8202083">,</span>&nbsp;<span class="num" id="8202085">0x50</span><span class="op" id="8202089">,</span>&nbsp;<span class="num" id="8202091">0x57</span><span class="op" id="8202095">,</span>&nbsp;<span class="num" id="8202097">0xf8</span><span class="op" id="8202101">,</span>&nbsp;<span class="num" id="8202103">0x6f</span><span class="op" id="8202107">,</span>&nbsp;<span class="num" id="8202109">0xae</span><span class="op" id="8202113">,</span>&nbsp;<span class="num" id="8202115">0x89</span><span class="op" id="8202119">,</span>&nbsp;<span class="num" id="8202121">0x84</span><span class="op" id="8202125">,</span>&nbsp;<span class="num" id="8202127">0xd9</span><span class="op" id="8202131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202135">0xba</span><span class="op" id="8202139">,</span>&nbsp;<span class="num" id="8202141">0x7f</span><span class="op" id="8202145">,</span>&nbsp;<span class="num" id="8202147">0x96</span><span class="op" id="8202151">,</span>&nbsp;<span class="num" id="8202153">0x9a</span><span class="op" id="8202157">,</span>&nbsp;<span class="num" id="8202159">0xd6</span><span class="op" id="8202163">,</span>&nbsp;<span class="num" id="8202165">0xfe</span><span class="op" id="8202169">,</span>&nbsp;<span class="num" id="8202171">0x02</span><span class="op" id="8202175">,</span>&nbsp;<span class="num" id="8202177">0xa4</span><span class="op" id="8202181">,</span>&nbsp;<span class="num" id="8202183">0xd7</span><span class="op" id="8202187">,</span>&nbsp;<span class="num" id="8202189">0x5f</span><span class="op" id="8202193">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202197">0x74</span><span class="op" id="8202201">,</span>&nbsp;<span class="num" id="8202203">0x45</span><span class="op" id="8202207">,</span>&nbsp;<span class="num" id="8202209">0xfe</span><span class="op" id="8202213">,</span>&nbsp;<span class="num" id="8202215">0xfd</span><span class="op" id="8202219">,</span>&nbsp;<span class="num" id="8202221">0xd8</span><span class="op" id="8202225">,</span>&nbsp;<span class="num" id="8202227">0x5b</span><span class="op" id="8202231">,</span>&nbsp;<span class="num" id="8202233">0x6d</span><span class="op" id="8202237">,</span>&nbsp;<span class="num" id="8202239">0x3a</span><span class="op" id="8202243">,</span>&nbsp;<span class="num" id="8202245">0x47</span><span class="op" id="8202249">,</span>&nbsp;<span class="num" id="8202251">0x7c</span><span class="op" id="8202255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202259">0x28</span><span class="op" id="8202263">,</span>&nbsp;<span class="num" id="8202265">0xd2</span><span class="op" id="8202269">,</span>&nbsp;<span class="num" id="8202271">0x4b</span><span class="op" id="8202275">,</span>&nbsp;<span class="num" id="8202277">0xa1</span><span class="op" id="8202281">,</span>&nbsp;<span class="num" id="8202283">0xe3</span><span class="op" id="8202287">,</span>&nbsp;<span class="num" id="8202289">0x75</span><span class="op" id="8202293">,</span>&nbsp;<span class="num" id="8202295">0x6f</span><span class="op" id="8202299">,</span>&nbsp;<span class="num" id="8202301">0x79</span><span class="op" id="8202305">,</span>&nbsp;<span class="num" id="8202307">0x2d</span><span class="op" id="8202311">,</span>&nbsp;<span class="num" id="8202313">0xd1</span><span class="op" id="8202317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202321">0xdc</span><span class="op" id="8202325">,</span>&nbsp;<span class="num" id="8202327">0xe8</span><span class="op" id="8202331">,</span>&nbsp;<span class="num" id="8202333">0xca</span><span class="op" id="8202337">,</span>&nbsp;<span class="num" id="8202339">0x94</span><span class="op" id="8202343">,</span>&nbsp;<span class="num" id="8202345">0x44</span><span class="op" id="8202349">,</span>&nbsp;<span class="num" id="8202351">0x0e</span><span class="op" id="8202355">,</span>&nbsp;<span class="num" id="8202357">0xcb</span><span class="op" id="8202361">,</span>&nbsp;<span class="num" id="8202363">0x52</span><span class="op" id="8202367">,</span>&nbsp;<span class="num" id="8202369">0x79</span><span class="op" id="8202373">,</span>&nbsp;<span class="num" id="8202375">0xec</span><span class="op" id="8202379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202383">0xd3</span><span class="op" id="8202387">,</span>&nbsp;<span class="num" id="8202389">0x18</span><span class="op" id="8202393">,</span>&nbsp;<span class="num" id="8202395">0x3a</span><span class="op" id="8202399">,</span>&nbsp;<span class="num" id="8202401">0x31</span><span class="op" id="8202405">,</span>&nbsp;<span class="num" id="8202407">0x1f</span><span class="op" id="8202411">,</span>&nbsp;<span class="num" id="8202413">0xc8</span><span class="op" id="8202417">,</span>&nbsp;<span class="num" id="8202419">0x96</span><span class="op" id="8202423">,</span>&nbsp;<span class="num" id="8202425">0xda</span><span class="op" id="8202429">,</span>&nbsp;<span class="num" id="8202431">0x1c</span><span class="op" id="8202435">,</span>&nbsp;<span class="num" id="8202437">0xb3</span><span class="op" id="8202441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202445">0x93</span><span class="op" id="8202449">,</span>&nbsp;<span class="num" id="8202451">0x11</span><span class="op" id="8202455">,</span>&nbsp;<span class="num" id="8202457">0xaf</span><span class="op" id="8202461">,</span>&nbsp;<span class="num" id="8202463">0x37</span><span class="op" id="8202467">,</span>&nbsp;<span class="num" id="8202469">0xea</span><span class="op" id="8202473">,</span>&nbsp;<span class="num" id="8202475">0x4a</span><span class="op" id="8202479">,</span>&nbsp;<span class="num" id="8202481">0x75</span><span class="op" id="8202485">,</span>&nbsp;<span class="num" id="8202487">0xe2</span><span class="op" id="8202491">,</span>&nbsp;<span class="num" id="8202493">0x4b</span><span class="op" id="8202497">,</span>&nbsp;<span class="num" id="8202499">0xdb</span><span class="op" id="8202503">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202507">0xfd</span><span class="op" id="8202511">,</span>&nbsp;<span class="num" id="8202513">0x5c</span><span class="op" id="8202517">,</span>&nbsp;<span class="num" id="8202519">0x1d</span><span class="op" id="8202523">,</span>&nbsp;<span class="num" id="8202525">0xa0</span><span class="op" id="8202529">,</span>&nbsp;<span class="num" id="8202531">0xde</span><span class="op" id="8202535">,</span>&nbsp;<span class="num" id="8202537">0x7c</span><span class="op" id="8202541">,</span>&nbsp;<span class="num" id="8202543">0xec</span><span class="op" id="8202547">,</span>&nbsp;<span class="num" id="8202549">0xdf</span><span class="op" id="8202553">,</span>&nbsp;<span class="num" id="8202555">0x1a</span><span class="op" id="8202559">,</span>&nbsp;<span class="num" id="8202561">0x89</span><span class="op" id="8202565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202569">0x6f</span><span class="op" id="8202573">,</span>&nbsp;<span class="num" id="8202575">0x9d</span><span class="op" id="8202579">,</span>&nbsp;<span class="num" id="8202581">0x8b</span><span class="op" id="8202585">,</span>&nbsp;<span class="num" id="8202587">0xc8</span><span class="op" id="8202591">,</span>&nbsp;<span class="num" id="8202593">0x16</span><span class="op" id="8202597">,</span>&nbsp;<span class="num" id="8202599">0xd9</span><span class="op" id="8202603">,</span>&nbsp;<span class="num" id="8202605">0x7c</span><span class="op" id="8202609">,</span>&nbsp;<span class="num" id="8202611">0xd7</span><span class="op" id="8202615">,</span>&nbsp;<span class="num" id="8202617">0xa2</span><span class="op" id="8202621">,</span>&nbsp;<span class="num" id="8202623">0xc4</span><span class="op" id="8202627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8202631">0x3b</span><span class="op" id="8202635">,</span>&nbsp;<span class="num" id="8202637">0xad</span><span class="op" id="8202641">,</span>&nbsp;<span class="num" id="8202643">0x54</span><span class="op" id="8202647">,</span>&nbsp;<span class="num" id="8202649">0x6f</span><span class="op" id="8202653">,</span>&nbsp;<span class="num" id="8202655">0xbe</span><span class="op" id="8202659">,</span>&nbsp;<span class="num" id="8202661">0x8c</span><span class="op" id="8202665">,</span>&nbsp;<span class="num" id="8202667">0xfe</span><span class="op" id="8202671">,</span>&nbsp;<span class="num" id="8202673">0xbc</span><span class="op" id="8202677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202684">hash</span>&nbsp;<span class="op" id="8202689">:=</span>&nbsp;<span class="ident" id="8202692">sha1</span><span class="op" id="8202696">.</span><span class="ident" id="8202697">New</span><span class="op" id="8202700">(</span><span class="op" id="8202701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202704">hash</span><span class="op" id="8202708">.</span><span class="ident" id="8202709">Write</span><span class="op" id="8202714">(</span><span class="ident" id="8202715">msg</span><span class="op" id="8202718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202721">hashed</span>&nbsp;<span class="op" id="8202728">:=</span>&nbsp;<span class="ident" id="8202731">hash</span><span class="op" id="8202735">.</span><span class="ident" id="8202736">Sum</span><span class="op" id="8202739">(</span><span class="ident" id="8202740">nil</span><span class="op" id="8202743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202747">encoded</span><span class="op" id="8202754">,</span>&nbsp;<span class="ident" id="8202756">err</span>&nbsp;<span class="op" id="8202760">:=</span>&nbsp;<span class="ident" id="8202763">emsaPSSEncode</span><span class="op" id="8202776">(</span><span class="ident" id="8202777">hashed</span><span class="op" id="8202783">,</span>&nbsp;<span class="num" id="8202785">1023</span><span class="op" id="8202789">,</span>&nbsp;<span class="ident" id="8202791">salt</span><span class="op" id="8202795">,</span>&nbsp;<span class="ident" id="8202797">sha1</span><span class="op" id="8202801">.</span><span class="ident" id="8202802">New</span><span class="op" id="8202805">(</span><span class="op" id="8202806">)</span><span class="op" id="8202807">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202810">if</span>&nbsp;<span class="ident" id="8202813">err</span>&nbsp;<span class="op" id="8202817">!=</span>&nbsp;<span class="ident" id="8202820">nil</span>&nbsp;<span class="op" id="8202824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202828">t</span><span class="op" id="8202829">.</span><span class="ident" id="8202830">Errorf</span><span class="op" id="8202836">(</span><span class="string" id="8202837">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8202869">,</span>&nbsp;<span class="ident" id="8202871">err</span><span class="op" id="8202874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202880">if</span>&nbsp;<span class="op" id="8202883">!</span><span class="ident" id="8202884">bytes</span><span class="op" id="8202889">.</span><span class="ident" id="8202890">Equal</span><span class="op" id="8202895">(</span><span class="ident" id="8202896">encoded</span><span class="op" id="8202903">,</span>&nbsp;<span class="ident" id="8202905">expected</span><span class="op" id="8202913">)</span>&nbsp;<span class="op" id="8202915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202919">t</span><span class="op" id="8202920">.</span><span class="ident" id="8202921">Errorf</span><span class="op" id="8202927">(</span><span class="string" id="8202928">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8202959">,</span>&nbsp;<span class="ident" id="8202961">encoded</span><span class="op" id="8202968">,</span>&nbsp;<span class="ident" id="8202970">expected</span><span class="op" id="8202978">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202985">if</span>&nbsp;<span class="ident" id="8202988">err</span>&nbsp;<span class="op" id="8202992">=</span>&nbsp;<span class="ident" id="8202994">emsaPSSVerify</span><span class="op" id="8203007">(</span><span class="ident" id="8203008">hashed</span><span class="op" id="8203014">,</span>&nbsp;<span class="ident" id="8203016">encoded</span><span class="op" id="8203023">,</span>&nbsp;<span class="num" id="8203025">1023</span><span class="op" id="8203029">,</span>&nbsp;<span class="builtinfunc" id="8203031">len</span><span class="op" id="8203034">(</span><span class="ident" id="8203035">salt</span><span class="op" id="8203039">)</span><span class="op" id="8203040">,</span>&nbsp;<span class="ident" id="8203042">sha1</span><span class="op" id="8203046">.</span><span class="ident" id="8203047">New</span><span class="op" id="8203050">(</span><span class="op" id="8203051">)</span><span class="op" id="8203052">)</span><span class="op" id="8203053">;</span>&nbsp;<span class="ident" id="8203055">err</span>&nbsp;<span class="op" id="8203059">!=</span>&nbsp;<span class="ident" id="8203062">nil</span>&nbsp;<span class="op" id="8203066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203070">t</span><span class="op" id="8203071">.</span><span class="ident" id="8203072">Errorf</span><span class="op" id="8203078">(</span><span class="string" id="8203079">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8203101">,</span>&nbsp;<span class="ident" id="8203103">err</span><span class="op" id="8203106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203109">}</span><br>
<span class="lineno">75</span><span class="op" id="8203111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8203114">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8203179">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8203243">func</span>&nbsp;<span class="ident" id="8203248">TestPSSGolden</span><span class="op" id="8203261">(</span><span class="ident" id="8203262">t</span>&nbsp;<span class="op" id="8203264">*</span><span class="ident" id="8203265">testing</span><span class="op" id="8203272">.</span><span class="ident" id="8203273">T</span><span class="op" id="8203274">)</span>&nbsp;<span class="op" id="8203276">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203279">inFile</span><span class="op" id="8203285">,</span>&nbsp;<span class="ident" id="8203287">err</span>&nbsp;<span class="op" id="8203291">:=</span>&nbsp;<span class="ident" id="8203294">os</span><span class="op" id="8203296">.</span><span class="ident" id="8203297">Open</span><span class="op" id="8203301">(</span><span class="string" id="8203302">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8203329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203332">if</span>&nbsp;<span class="ident" id="8203335">err</span>&nbsp;<span class="op" id="8203339">!=</span>&nbsp;<span class="ident" id="8203342">nil</span>&nbsp;<span class="op" id="8203346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203350">t</span><span class="op" id="8203351">.</span><span class="ident" id="8203352">Fatalf</span><span class="op" id="8203358">(</span><span class="string" id="8203359">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8203390">,</span>&nbsp;<span class="ident" id="8203392">err</span><span class="op" id="8203395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203401">defer</span>&nbsp;<span class="ident" id="8203407">inFile</span><span class="op" id="8203413">.</span><span class="ident" id="8203414">Close</span><span class="op" id="8203419">(</span><span class="op" id="8203420">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203424">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203489">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203560">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203630">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203665">const</span>&nbsp;<span class="ident" id="8203671">newKeyMarker</span>&nbsp;<span class="op" id="8203684">=</span>&nbsp;<span class="string" id="8203686">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203703">const</span>&nbsp;<span class="ident" id="8203709">newSignatureMarker</span>&nbsp;<span class="op" id="8203728">=</span>&nbsp;<span class="string" id="8203730">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203754">values</span>&nbsp;<span class="op" id="8203761">:=</span>&nbsp;<span class="builtinfunc" id="8203764">make</span><span class="op" id="8203768">(</span><span class="keyword" id="8203769">chan</span>&nbsp;<span class="builtintype" id="8203774">string</span><span class="op" id="8203780">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203784">go</span>&nbsp;<span class="keyword" id="8203787">func</span><span class="op" id="8203791">(</span><span class="op" id="8203792">)</span>&nbsp;<span class="op" id="8203794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203798">defer</span>&nbsp;<span class="builtinfunc" id="8203804">close</span><span class="op" id="8203809">(</span><span class="ident" id="8203810">values</span><span class="op" id="8203816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203820">scanner</span>&nbsp;<span class="op" id="8203828">:=</span>&nbsp;<span class="ident" id="8203831">bufio</span><span class="op" id="8203836">.</span><span class="ident" id="8203837">NewScanner</span><span class="op" id="8203847">(</span><span class="ident" id="8203848">bzip2</span><span class="op" id="8203853">.</span><span class="ident" id="8203854">NewReader</span><span class="op" id="8203863">(</span><span class="ident" id="8203864">inFile</span><span class="op" id="8203870">)</span><span class="op" id="8203871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203875">var</span>&nbsp;<span class="ident" id="8203879">partialValue</span>&nbsp;<span class="builtintype" id="8203892">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203901">lastWasValue</span>&nbsp;<span class="op" id="8203914">:=</span>&nbsp;<span class="ident" id="8203917">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203925">for</span>&nbsp;<span class="ident" id="8203929">scanner</span><span class="op" id="8203936">.</span><span class="ident" id="8203937">Scan</span><span class="op" id="8203941">(</span><span class="op" id="8203942">)</span>&nbsp;<span class="op" id="8203944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203949">line</span>&nbsp;<span class="op" id="8203954">:=</span>&nbsp;<span class="ident" id="8203957">scanner</span><span class="op" id="8203964">.</span><span class="ident" id="8203965">Text</span><span class="op" id="8203969">(</span><span class="op" id="8203970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203975">switch</span>&nbsp;<span class="op" id="8203982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203987">case</span>&nbsp;<span class="builtinfunc" id="8203992">len</span><span class="op" id="8203995">(</span><span class="ident" id="8203996">line</span><span class="op" id="8204000">)</span>&nbsp;<span class="op" id="8204002">==</span>&nbsp;<span class="num" id="8204005">0</span><span class="op" id="8204006">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204012">if</span>&nbsp;<span class="builtinfunc" id="8204015">len</span><span class="op" id="8204018">(</span><span class="ident" id="8204019">partialValue</span><span class="op" id="8204031">)</span>&nbsp;<span class="op" id="8204033">&gt;</span>&nbsp;<span class="num" id="8204035">0</span>&nbsp;<span class="op" id="8204037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204044">values</span>&nbsp;<span class="op" id="8204051">&lt;-</span>&nbsp;<span class="ident" id="8204054">strings</span><span class="op" id="8204061">.</span><span class="ident" id="8204062">Replace</span><span class="op" id="8204069">(</span><span class="ident" id="8204070">partialValue</span><span class="op" id="8204082">,</span>&nbsp;<span class="string" id="8204084">&#34;&nbsp;&#34;</span><span class="op" id="8204087">,</span>&nbsp;<span class="string" id="8204089">&#34;&#34;</span><span class="op" id="8204091">,</span>&nbsp;<span class="op" id="8204093">-</span><span class="num" id="8204094">1</span><span class="op" id="8204095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204102">partialValue</span>&nbsp;<span class="op" id="8204115">=</span>&nbsp;<span class="string" id="8204117">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204125">lastWasValue</span>&nbsp;<span class="op" id="8204138">=</span>&nbsp;<span class="ident" id="8204140">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204149">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204155">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204167">case</span>&nbsp;<span class="ident" id="8204172">strings</span><span class="op" id="8204179">.</span><span class="ident" id="8204180">HasPrefix</span><span class="op" id="8204189">(</span><span class="ident" id="8204190">line</span><span class="op" id="8204194">,</span>&nbsp;<span class="string" id="8204196">&#34;#&nbsp;======&#34;</span><span class="op" id="8204206">)</span>&nbsp;<span class="op" id="8204208">&amp;&amp;</span>&nbsp;<span class="ident" id="8204211">lastWasValue</span><span class="op" id="8204223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204229">values</span>&nbsp;<span class="op" id="8204236">&lt;-</span>&nbsp;<span class="ident" id="8204239">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204256">lastWasValue</span>&nbsp;<span class="op" id="8204269">=</span>&nbsp;<span class="ident" id="8204271">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204280">case</span>&nbsp;<span class="ident" id="8204285">strings</span><span class="op" id="8204292">.</span><span class="ident" id="8204293">HasPrefix</span><span class="op" id="8204302">(</span><span class="ident" id="8204303">line</span><span class="op" id="8204307">,</span>&nbsp;<span class="string" id="8204309">&#34;#&nbsp;------&#34;</span><span class="op" id="8204319">)</span>&nbsp;<span class="op" id="8204321">&amp;&amp;</span>&nbsp;<span class="ident" id="8204324">lastWasValue</span><span class="op" id="8204336">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204342">values</span>&nbsp;<span class="op" id="8204349">&lt;-</span>&nbsp;<span class="ident" id="8204352">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204375">lastWasValue</span>&nbsp;<span class="op" id="8204388">=</span>&nbsp;<span class="ident" id="8204390">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204399">case</span>&nbsp;<span class="ident" id="8204404">strings</span><span class="op" id="8204411">.</span><span class="ident" id="8204412">HasPrefix</span><span class="op" id="8204421">(</span><span class="ident" id="8204422">line</span><span class="op" id="8204426">,</span>&nbsp;<span class="string" id="8204428">&#34;#&#34;</span><span class="op" id="8204431">)</span><span class="op" id="8204432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204438">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204450">default</span><span class="op" id="8204457">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204463">partialValue</span>&nbsp;<span class="op" id="8204476">+=</span>&nbsp;<span class="ident" id="8204479">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204495">if</span>&nbsp;<span class="ident" id="8204498">err</span>&nbsp;<span class="op" id="8204502">:=</span>&nbsp;<span class="ident" id="8204505">scanner</span><span class="op" id="8204512">.</span><span class="ident" id="8204513">Err</span><span class="op" id="8204516">(</span><span class="op" id="8204517">)</span><span class="op" id="8204518">;</span>&nbsp;<span class="ident" id="8204520">err</span>&nbsp;<span class="op" id="8204524">!=</span>&nbsp;<span class="ident" id="8204527">nil</span>&nbsp;<span class="op" id="8204531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8204536">panic</span><span class="op" id="8204541">(</span><span class="ident" id="8204542">err</span><span class="op" id="8204545">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204552">}</span><span class="op" id="8204553">(</span><span class="op" id="8204554">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204558">var</span>&nbsp;<span class="ident" id="8204562">key</span>&nbsp;<span class="op" id="8204566">*</span><span class="ident" id="8204567">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204578">var</span>&nbsp;<span class="ident" id="8204582">hashed</span>&nbsp;<span class="op" id="8204589">[</span><span class="op" id="8204590">]</span><span class="builtintype" id="8204591">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204597">hash</span>&nbsp;<span class="op" id="8204602">:=</span>&nbsp;<span class="ident" id="8204605">crypto</span><span class="op" id="8204611">.</span><span class="ident" id="8204612">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204618">h</span>&nbsp;<span class="op" id="8204620">:=</span>&nbsp;<span class="ident" id="8204623">hash</span><span class="op" id="8204627">.</span><span class="ident" id="8204628">New</span><span class="op" id="8204631">(</span><span class="op" id="8204632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204635">opts</span>&nbsp;<span class="op" id="8204640">:=</span>&nbsp;<span class="op" id="8204643">&amp;</span><span class="ident" id="8204644">PSSOptions</span><span class="op" id="8204654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204658">SaltLength</span><span class="op" id="8204668">:</span>&nbsp;<span class="ident" id="8204670">PSSSaltLengthEqualsHash</span><span class="op" id="8204693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204696">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204700">for</span>&nbsp;<span class="ident" id="8204704">marker</span>&nbsp;<span class="op" id="8204711">:=</span>&nbsp;<span class="keyword" id="8204714">range</span>&nbsp;<span class="ident" id="8204720">values</span>&nbsp;<span class="op" id="8204727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204731">switch</span>&nbsp;<span class="ident" id="8204738">marker</span>&nbsp;<span class="op" id="8204745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204749">case</span>&nbsp;<span class="ident" id="8204754">newKeyMarker</span><span class="op" id="8204766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204771">key</span>&nbsp;<span class="op" id="8204775">=</span>&nbsp;<span class="builtinfunc" id="8204777">new</span><span class="op" id="8204780">(</span><span class="ident" id="8204781">PublicKey</span><span class="op" id="8204790">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204795">nHex</span><span class="op" id="8204799">,</span>&nbsp;<span class="ident" id="8204801">ok</span>&nbsp;<span class="op" id="8204804">:=</span>&nbsp;<span class="op" id="8204807">&lt;-</span><span class="ident" id="8204809">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204819">if</span>&nbsp;<span class="op" id="8204822">!</span><span class="ident" id="8204823">ok</span>&nbsp;<span class="op" id="8204826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204832">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204849">key</span><span class="op" id="8204852">.</span><span class="ident" id="8204853">N</span>&nbsp;<span class="op" id="8204855">=</span>&nbsp;<span class="ident" id="8204857">bigFromHex</span><span class="op" id="8204867">(</span><span class="ident" id="8204868">nHex</span><span class="op" id="8204872">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204877">key</span><span class="op" id="8204880">.</span><span class="ident" id="8204881">E</span>&nbsp;<span class="op" id="8204883">=</span>&nbsp;<span class="ident" id="8204885">intFromHex</span><span class="op" id="8204895">(</span><span class="op" id="8204896">&lt;-</span><span class="ident" id="8204898">values</span><span class="op" id="8204904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8204909">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204958">for</span>&nbsp;<span class="ident" id="8204962">i</span>&nbsp;<span class="op" id="8204964">:=</span>&nbsp;<span class="num" id="8204967">0</span><span class="op" id="8204968">;</span>&nbsp;<span class="ident" id="8204970">i</span>&nbsp;<span class="op" id="8204972">&lt;</span>&nbsp;<span class="num" id="8204974">6</span><span class="op" id="8204975">;</span>&nbsp;<span class="ident" id="8204977">i</span><span class="op" id="8204978">++</span>&nbsp;<span class="op" id="8204981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204987">&lt;-</span><span class="ident" id="8204989">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204999">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8205003">case</span>&nbsp;<span class="ident" id="8205008">newSignatureMarker</span><span class="op" id="8205026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205031">msg</span>&nbsp;<span class="op" id="8205035">:=</span>&nbsp;<span class="ident" id="8205038">fromHex</span><span class="op" id="8205045">(</span><span class="op" id="8205046">&lt;-</span><span class="ident" id="8205048">values</span><span class="op" id="8205054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205059">&lt;-</span><span class="ident" id="8205061">values</span>&nbsp;<span class="comment" id="8205068">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205084">sig</span>&nbsp;<span class="op" id="8205088">:=</span>&nbsp;<span class="ident" id="8205091">fromHex</span><span class="op" id="8205098">(</span><span class="op" id="8205099">&lt;-</span><span class="ident" id="8205101">values</span><span class="op" id="8205107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205113">h</span><span class="op" id="8205114">.</span><span class="ident" id="8205115">Reset</span><span class="op" id="8205120">(</span><span class="op" id="8205121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205126">h</span><span class="op" id="8205127">.</span><span class="ident" id="8205128">Write</span><span class="op" id="8205133">(</span><span class="ident" id="8205134">msg</span><span class="op" id="8205137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205142">hashed</span>&nbsp;<span class="op" id="8205149">=</span>&nbsp;<span class="ident" id="8205151">h</span><span class="op" id="8205152">.</span><span class="ident" id="8205153">Sum</span><span class="op" id="8205156">(</span><span class="ident" id="8205157">hashed</span><span class="op" id="8205163">[</span><span class="op" id="8205164">:</span><span class="num" id="8205165">0</span><span class="op" id="8205166">]</span><span class="op" id="8205167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8205173">if</span>&nbsp;<span class="ident" id="8205176">err</span>&nbsp;<span class="op" id="8205180">:=</span>&nbsp;<span class="ident" id="8205183">VerifyPSS</span><span class="op" id="8205192">(</span><span class="ident" id="8205193">key</span><span class="op" id="8205196">,</span>&nbsp;<span class="ident" id="8205198">hash</span><span class="op" id="8205202">,</span>&nbsp;<span class="ident" id="8205204">hashed</span><span class="op" id="8205210">,</span>&nbsp;<span class="ident" id="8205212">sig</span><span class="op" id="8205215">,</span>&nbsp;<span class="ident" id="8205217">opts</span><span class="op" id="8205221">)</span><span class="op" id="8205222">;</span>&nbsp;<span class="ident" id="8205224">err</span>&nbsp;<span class="op" id="8205228">!=</span>&nbsp;<span class="ident" id="8205231">nil</span>&nbsp;<span class="op" id="8205235">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205241">t</span><span class="op" id="8205242">.</span><span class="ident" id="8205243">Error</span><span class="op" id="8205248">(</span><span class="ident" id="8205249">err</span><span class="op" id="8205252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8205261">default</span><span class="op" id="8205268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205273">t</span><span class="op" id="8205274">.</span><span class="ident" id="8205275">Fatalf</span><span class="op" id="8205281">(</span><span class="string" id="8205282">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8205301">+</span>&nbsp;<span class="ident" id="8205303">marker</span><span class="op" id="8205309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205313">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205316">}</span><br>
<span class="lineno"></span><span class="op" id="8205318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8205321">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8205400">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8205468">func</span>&nbsp;<span class="ident" id="8205473">TestPSSOpenSSL</span><span class="op" id="8205487">(</span><span class="ident" id="8205488">t</span>&nbsp;<span class="op" id="8205490">*</span><span class="ident" id="8205491">testing</span><span class="op" id="8205498">.</span><span class="ident" id="8205499">T</span><span class="op" id="8205500">)</span>&nbsp;<span class="op" id="8205502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205505">hash</span>&nbsp;<span class="op" id="8205510">:=</span>&nbsp;<span class="ident" id="8205513">crypto</span><span class="op" id="8205519">.</span><span class="ident" id="8205520">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205528">h</span>&nbsp;<span class="op" id="8205530">:=</span>&nbsp;<span class="ident" id="8205533">hash</span><span class="op" id="8205537">.</span><span class="ident" id="8205538">New</span><span class="op" id="8205541">(</span><span class="op" id="8205542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205545">h</span><span class="op" id="8205546">.</span><span class="ident" id="8205547">Write</span><span class="op" id="8205552">(</span><span class="op" id="8205553">[</span><span class="op" id="8205554">]</span><span class="builtintype" id="8205555">byte</span><span class="op" id="8205559">(</span><span class="string" id="8205560">&#34;testing&#34;</span><span class="op" id="8205569">)</span><span class="op" id="8205570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205573">hashed</span>&nbsp;<span class="op" id="8205580">:=</span>&nbsp;<span class="ident" id="8205583">h</span><span class="op" id="8205584">.</span><span class="ident" id="8205585">Sum</span><span class="op" id="8205588">(</span><span class="ident" id="8205589">nil</span><span class="op" id="8205592">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205596">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205705">sig</span>&nbsp;<span class="op" id="8205709">:=</span>&nbsp;<span class="op" id="8205712">[</span><span class="op" id="8205713">]</span><span class="builtintype" id="8205714">byte</span><span class="op" id="8205718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8205722">0x95</span><span class="op" id="8205726">,</span>&nbsp;<span class="num" id="8205728">0x59</span><span class="op" id="8205732">,</span>&nbsp;<span class="num" id="8205734">0x6f</span><span class="op" id="8205738">,</span>&nbsp;<span class="num" id="8205740">0xd3</span><span class="op" id="8205744">,</span>&nbsp;<span class="num" id="8205746">0x10</span><span class="op" id="8205750">,</span>&nbsp;<span class="num" id="8205752">0xa2</span><span class="op" id="8205756">,</span>&nbsp;<span class="num" id="8205758">0xe7</span><span class="op" id="8205762">,</span>&nbsp;<span class="num" id="8205764">0xa2</span><span class="op" id="8205768">,</span>&nbsp;<span class="num" id="8205770">0x92</span><span class="op" id="8205774">,</span>&nbsp;<span class="num" id="8205776">0x9d</span><span class="op" id="8205780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8205784">0x4a</span><span class="op" id="8205788">,</span>&nbsp;<span class="num" id="8205790">0x07</span><span class="op" id="8205794">,</span>&nbsp;<span class="num" id="8205796">0x2e</span><span class="op" id="8205800">,</span>&nbsp;<span class="num" id="8205802">0x2b</span><span class="op" id="8205806">,</span>&nbsp;<span class="num" id="8205808">0x27</span><span class="op" id="8205812">,</span>&nbsp;<span class="num" id="8205814">0xcc</span><span class="op" id="8205818">,</span>&nbsp;<span class="num" id="8205820">0x06</span><span class="op" id="8205824">,</span>&nbsp;<span class="num" id="8205826">0xc2</span><span class="op" id="8205830">,</span>&nbsp;<span class="num" id="8205832">0x87</span><span class="op" id="8205836">,</span>&nbsp;<span class="num" id="8205838">0x2c</span><span class="op" id="8205842">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8205846">0x52</span><span class="op" id="8205850">,</span>&nbsp;<span class="num" id="8205852">0xf0</span><span class="op" id="8205856">,</span>&nbsp;<span class="num" id="8205858">0x4a</span><span class="op" id="8205862">,</span>&nbsp;<span class="num" id="8205864">0xcc</span><span class="op" id="8205868">,</span>&nbsp;<span class="num" id="8205870">0x05</span><span class="op" id="8205874">,</span>&nbsp;<span class="num" id="8205876">0x94</span><span class="op" id="8205880">,</span>&nbsp;<span class="num" id="8205882">0xf2</span><span class="op" id="8205886">,</span>&nbsp;<span class="num" id="8205888">0xc3</span><span class="op" id="8205892">,</span>&nbsp;<span class="num" id="8205894">0x2e</span><span class="op" id="8205898">,</span>&nbsp;<span class="num" id="8205900">0x20</span><span class="op" id="8205904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8205908">0xd7</span><span class="op" id="8205912">,</span>&nbsp;<span class="num" id="8205914">0x3e</span><span class="op" id="8205918">,</span>&nbsp;<span class="num" id="8205920">0x66</span><span class="op" id="8205924">,</span>&nbsp;<span class="num" id="8205926">0x62</span><span class="op" id="8205930">,</span>&nbsp;<span class="num" id="8205932">0xb5</span><span class="op" id="8205936">,</span>&nbsp;<span class="num" id="8205938">0x95</span><span class="op" id="8205942">,</span>&nbsp;<span class="num" id="8205944">0x2b</span><span class="op" id="8205948">,</span>&nbsp;<span class="num" id="8205950">0xa3</span><span class="op" id="8205954">,</span>&nbsp;<span class="num" id="8205956">0x93</span><span class="op" id="8205960">,</span>&nbsp;<span class="num" id="8205962">0x9a</span><span class="op" id="8205966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8205970">0x66</span><span class="op" id="8205974">,</span>&nbsp;<span class="num" id="8205976">0x64</span><span class="op" id="8205980">,</span>&nbsp;<span class="num" id="8205982">0x25</span><span class="op" id="8205986">,</span>&nbsp;<span class="num" id="8205988">0xe0</span><span class="op" id="8205992">,</span>&nbsp;<span class="num" id="8205994">0x74</span><span class="op" id="8205998">,</span>&nbsp;<span class="num" id="8206000">0x66</span><span class="op" id="8206004">,</span>&nbsp;<span class="num" id="8206006">0x8c</span><span class="op" id="8206010">,</span>&nbsp;<span class="num" id="8206012">0x3e</span><span class="op" id="8206016">,</span>&nbsp;<span class="num" id="8206018">0x92</span><span class="op" id="8206022">,</span>&nbsp;<span class="num" id="8206024">0xeb</span><span class="op" id="8206028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206032">0xc6</span><span class="op" id="8206036">,</span>&nbsp;<span class="num" id="8206038">0xe6</span><span class="op" id="8206042">,</span>&nbsp;<span class="num" id="8206044">0xc0</span><span class="op" id="8206048">,</span>&nbsp;<span class="num" id="8206050">0x44</span><span class="op" id="8206054">,</span>&nbsp;<span class="num" id="8206056">0xf3</span><span class="op" id="8206060">,</span>&nbsp;<span class="num" id="8206062">0xb4</span><span class="op" id="8206066">,</span>&nbsp;<span class="num" id="8206068">0xb4</span><span class="op" id="8206072">,</span>&nbsp;<span class="num" id="8206074">0x2e</span><span class="op" id="8206078">,</span>&nbsp;<span class="num" id="8206080">0x8c</span><span class="op" id="8206084">,</span>&nbsp;<span class="num" id="8206086">0x66</span><span class="op" id="8206090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8206094">0x0a</span><span class="op" id="8206098">,</span>&nbsp;<span class="num" id="8206100">0x37</span><span class="op" id="8206104">,</span>&nbsp;<span class="num" id="8206106">0x9c</span><span class="op" id="8206110">,</span>&nbsp;<span class="num" id="8206112">0x69</span><span class="op" id="8206116">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206123">if</span>&nbsp;<span class="ident" id="8206126">err</span>&nbsp;<span class="op" id="8206130">:=</span>&nbsp;<span class="ident" id="8206133">VerifyPSS</span><span class="op" id="8206142">(</span><span class="op" id="8206143">&amp;</span><span class="ident" id="8206144">rsaPrivateKey</span><span class="op" id="8206157">.</span><span class="ident" id="8206158">PublicKey</span><span class="op" id="8206167">,</span>&nbsp;<span class="ident" id="8206169">hash</span><span class="op" id="8206173">,</span>&nbsp;<span class="ident" id="8206175">hashed</span><span class="op" id="8206181">,</span>&nbsp;<span class="ident" id="8206183">sig</span><span class="op" id="8206186">,</span>&nbsp;<span class="ident" id="8206188">nil</span><span class="op" id="8206191">)</span><span class="op" id="8206192">;</span>&nbsp;<span class="ident" id="8206194">err</span>&nbsp;<span class="op" id="8206198">!=</span>&nbsp;<span class="ident" id="8206201">nil</span>&nbsp;<span class="op" id="8206205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206209">t</span><span class="op" id="8206210">.</span><span class="ident" id="8206211">Error</span><span class="op" id="8206216">(</span><span class="ident" id="8206217">err</span><span class="op" id="8206220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206223">}</span><br>
<span class="lineno">190</span><span class="op" id="8206225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8206228">func</span>&nbsp;<span class="ident" id="8206233">TestPSSSigning</span><span class="op" id="8206247">(</span><span class="ident" id="8206248">t</span>&nbsp;<span class="op" id="8206250">*</span><span class="ident" id="8206251">testing</span><span class="op" id="8206258">.</span><span class="ident" id="8206259">T</span><span class="op" id="8206260">)</span>&nbsp;<span class="op" id="8206262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206265">var</span>&nbsp;<span class="ident" id="8206269">saltLengthCombinations</span>&nbsp;<span class="op" id="8206292">=</span>&nbsp;<span class="op" id="8206294">[</span><span class="op" id="8206295">]</span><span class="keyword" id="8206296">struct</span>&nbsp;<span class="op" id="8206303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206307">signSaltLength</span><span class="op" id="8206321">,</span>&nbsp;<span class="ident" id="8206323">verifySaltLength</span>&nbsp;<span class="builtintype" id="8206340">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206346">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8206379">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206385">}</span><span class="op" id="8206386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206390">{</span><span class="ident" id="8206391">PSSSaltLengthAuto</span><span class="op" id="8206408">,</span>&nbsp;<span class="ident" id="8206410">PSSSaltLengthAuto</span><span class="op" id="8206427">,</span>&nbsp;<span class="ident" id="8206429">true</span><span class="op" id="8206433">}</span><span class="op" id="8206434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206438">{</span><span class="ident" id="8206439">PSSSaltLengthEqualsHash</span><span class="op" id="8206462">,</span>&nbsp;<span class="ident" id="8206464">PSSSaltLengthAuto</span><span class="op" id="8206481">,</span>&nbsp;<span class="ident" id="8206483">true</span><span class="op" id="8206487">}</span><span class="op" id="8206488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206492">{</span><span class="ident" id="8206493">PSSSaltLengthEqualsHash</span><span class="op" id="8206516">,</span>&nbsp;<span class="ident" id="8206518">PSSSaltLengthEqualsHash</span><span class="op" id="8206541">,</span>&nbsp;<span class="ident" id="8206543">true</span><span class="op" id="8206547">}</span><span class="op" id="8206548">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206552">{</span><span class="ident" id="8206553">PSSSaltLengthEqualsHash</span><span class="op" id="8206576">,</span>&nbsp;<span class="num" id="8206578">8</span><span class="op" id="8206579">,</span>&nbsp;<span class="ident" id="8206581">false</span><span class="op" id="8206586">}</span><span class="op" id="8206587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206591">{</span><span class="ident" id="8206592">PSSSaltLengthAuto</span><span class="op" id="8206609">,</span>&nbsp;<span class="ident" id="8206611">PSSSaltLengthEqualsHash</span><span class="op" id="8206634">,</span>&nbsp;<span class="ident" id="8206636">false</span><span class="op" id="8206641">}</span><span class="op" id="8206642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206646">{</span><span class="num" id="8206647">8</span><span class="op" id="8206648">,</span>&nbsp;<span class="num" id="8206650">8</span><span class="op" id="8206651">,</span>&nbsp;<span class="ident" id="8206653">true</span><span class="op" id="8206657">}</span><span class="op" id="8206658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206665">hash</span>&nbsp;<span class="op" id="8206670">:=</span>&nbsp;<span class="ident" id="8206673">crypto</span><span class="op" id="8206679">.</span><span class="ident" id="8206680">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206685">h</span>&nbsp;<span class="op" id="8206687">:=</span>&nbsp;<span class="ident" id="8206690">hash</span><span class="op" id="8206694">.</span><span class="ident" id="8206695">New</span><span class="op" id="8206698">(</span><span class="op" id="8206699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206702">h</span><span class="op" id="8206703">.</span><span class="ident" id="8206704">Write</span><span class="op" id="8206709">(</span><span class="op" id="8206710">[</span><span class="op" id="8206711">]</span><span class="builtintype" id="8206712">byte</span><span class="op" id="8206716">(</span><span class="string" id="8206717">&#34;testing&#34;</span><span class="op" id="8206726">)</span><span class="op" id="8206727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206730">hashed</span>&nbsp;<span class="op" id="8206737">:=</span>&nbsp;<span class="ident" id="8206740">h</span><span class="op" id="8206741">.</span><span class="ident" id="8206742">Sum</span><span class="op" id="8206745">(</span><span class="ident" id="8206746">nil</span><span class="op" id="8206749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206752">var</span>&nbsp;<span class="ident" id="8206756">opts</span>&nbsp;<span class="ident" id="8206761">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206774">for</span>&nbsp;<span class="ident" id="8206778">i</span><span class="op" id="8206779">,</span>&nbsp;<span class="ident" id="8206781">test</span>&nbsp;<span class="op" id="8206786">:=</span>&nbsp;<span class="keyword" id="8206789">range</span>&nbsp;<span class="ident" id="8206795">saltLengthCombinations</span>&nbsp;<span class="op" id="8206818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206822">opts</span><span class="op" id="8206826">.</span><span class="ident" id="8206827">SaltLength</span>&nbsp;<span class="op" id="8206838">=</span>&nbsp;<span class="ident" id="8206840">test</span><span class="op" id="8206844">.</span><span class="ident" id="8206845">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206862">sig</span><span class="op" id="8206865">,</span>&nbsp;<span class="ident" id="8206867">err</span>&nbsp;<span class="op" id="8206871">:=</span>&nbsp;<span class="ident" id="8206874">SignPSS</span><span class="op" id="8206881">(</span><span class="ident" id="8206882">rand</span><span class="op" id="8206886">.</span><span class="ident" id="8206887">Reader</span><span class="op" id="8206893">,</span>&nbsp;<span class="ident" id="8206895">rsaPrivateKey</span><span class="op" id="8206908">,</span>&nbsp;<span class="ident" id="8206910">hash</span><span class="op" id="8206914">,</span>&nbsp;<span class="ident" id="8206916">hashed</span><span class="op" id="8206922">,</span>&nbsp;<span class="op" id="8206924">&amp;</span><span class="ident" id="8206925">opts</span><span class="op" id="8206929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206933">if</span>&nbsp;<span class="ident" id="8206936">err</span>&nbsp;<span class="op" id="8206940">!=</span>&nbsp;<span class="ident" id="8206943">nil</span>&nbsp;<span class="op" id="8206947">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206952">t</span><span class="op" id="8206953">.</span><span class="ident" id="8206954">Errorf</span><span class="op" id="8206960">(</span><span class="string" id="8206961">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8206991">,</span>&nbsp;<span class="ident" id="8206993">i</span><span class="op" id="8206994">,</span>&nbsp;<span class="ident" id="8206996">err</span><span class="op" id="8206999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207004">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207020">opts</span><span class="op" id="8207024">.</span><span class="ident" id="8207025">SaltLength</span>&nbsp;<span class="op" id="8207036">=</span>&nbsp;<span class="ident" id="8207038">test</span><span class="op" id="8207042">.</span><span class="ident" id="8207043">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207062">err</span>&nbsp;<span class="op" id="8207066">=</span>&nbsp;<span class="ident" id="8207068">VerifyPSS</span><span class="op" id="8207077">(</span><span class="op" id="8207078">&amp;</span><span class="ident" id="8207079">rsaPrivateKey</span><span class="op" id="8207092">.</span><span class="ident" id="8207093">PublicKey</span><span class="op" id="8207102">,</span>&nbsp;<span class="ident" id="8207104">hash</span><span class="op" id="8207108">,</span>&nbsp;<span class="ident" id="8207110">hashed</span><span class="op" id="8207116">,</span>&nbsp;<span class="ident" id="8207118">sig</span><span class="op" id="8207121">,</span>&nbsp;<span class="op" id="8207123">&amp;</span><span class="ident" id="8207124">opts</span><span class="op" id="8207128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207132">if</span>&nbsp;<span class="op" id="8207135">(</span><span class="ident" id="8207136">err</span>&nbsp;<span class="op" id="8207140">==</span>&nbsp;<span class="ident" id="8207143">nil</span><span class="op" id="8207146">)</span>&nbsp;<span class="op" id="8207148">!=</span>&nbsp;<span class="ident" id="8207151">test</span><span class="op" id="8207155">.</span><span class="ident" id="8207156">good</span>&nbsp;<span class="op" id="8207161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207166">t</span><span class="op" id="8207167">.</span><span class="ident" id="8207168">Errorf</span><span class="op" id="8207174">(</span><span class="string" id="8207175">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8207213">,</span>&nbsp;<span class="ident" id="8207215">i</span><span class="op" id="8207216">,</span>&nbsp;<span class="ident" id="8207218">test</span><span class="op" id="8207222">.</span><span class="ident" id="8207223">good</span><span class="op" id="8207227">,</span>&nbsp;<span class="ident" id="8207229">err</span><span class="op" id="8207232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207239">}</span><br>
<span class="lineno">225</span><span class="op" id="8207241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8207244">func</span>&nbsp;<span class="ident" id="8207249">bigFromHex</span><span class="op" id="8207259">(</span><span class="ident" id="8207260">hex</span>&nbsp;<span class="builtintype" id="8207264">string</span><span class="op" id="8207270">)</span>&nbsp;<span class="op" id="8207272">*</span><span class="ident" id="8207273">big</span><span class="op" id="8207276">.</span><span class="ident" id="8207277">Int</span>&nbsp;<span class="op" id="8207281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207284">n</span><span class="op" id="8207285">,</span>&nbsp;<span class="ident" id="8207287">ok</span>&nbsp;<span class="op" id="8207290">:=</span>&nbsp;<span class="builtinfunc" id="8207293">new</span><span class="op" id="8207296">(</span><span class="ident" id="8207297">big</span><span class="op" id="8207300">.</span><span class="ident" id="8207301">Int</span><span class="op" id="8207304">)</span><span class="op" id="8207305">.</span><span class="ident" id="8207306">SetString</span><span class="op" id="8207315">(</span><span class="ident" id="8207316">hex</span><span class="op" id="8207319">,</span>&nbsp;<span class="num" id="8207321">16</span><span class="op" id="8207323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207326">if</span>&nbsp;<span class="op" id="8207329">!</span><span class="ident" id="8207330">ok</span>&nbsp;<span class="op" id="8207333">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8207337">panic</span><span class="op" id="8207342">(</span><span class="string" id="8207343">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8207355">+</span>&nbsp;<span class="ident" id="8207357">hex</span><span class="op" id="8207360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207366">return</span>&nbsp;<span class="ident" id="8207373">n</span><br>
<span class="lineno"></span><span class="op" id="8207375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8207378">func</span>&nbsp;<span class="ident" id="8207383">intFromHex</span><span class="op" id="8207393">(</span><span class="ident" id="8207394">hex</span>&nbsp;<span class="builtintype" id="8207398">string</span><span class="op" id="8207404">)</span>&nbsp;<span class="builtintype" id="8207406">int</span>&nbsp;<span class="op" id="8207410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207413">i</span><span class="op" id="8207414">,</span>&nbsp;<span class="ident" id="8207416">err</span>&nbsp;<span class="op" id="8207420">:=</span>&nbsp;<span class="ident" id="8207423">strconv</span><span class="op" id="8207430">.</span><span class="ident" id="8207431">ParseInt</span><span class="op" id="8207439">(</span><span class="ident" id="8207440">hex</span><span class="op" id="8207443">,</span>&nbsp;<span class="num" id="8207445">16</span><span class="op" id="8207447">,</span>&nbsp;<span class="num" id="8207449">32</span><span class="op" id="8207451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207454">if</span>&nbsp;<span class="ident" id="8207457">err</span>&nbsp;<span class="op" id="8207461">!=</span>&nbsp;<span class="ident" id="8207464">nil</span>&nbsp;<span class="op" id="8207468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8207472">panic</span><span class="op" id="8207477">(</span><span class="ident" id="8207478">err</span><span class="op" id="8207481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207484">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207487">return</span>&nbsp;<span class="builtintype" id="8207494">int</span><span class="op" id="8207497">(</span><span class="ident" id="8207498">i</span><span class="op" id="8207499">)</span><br>
<span class="lineno"></span><span class="op" id="8207501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8207504">func</span>&nbsp;<span class="ident" id="8207509">fromHex</span><span class="op" id="8207516">(</span><span class="ident" id="8207517">hexStr</span>&nbsp;<span class="builtintype" id="8207524">string</span><span class="op" id="8207530">)</span>&nbsp;<span class="op" id="8207532">[</span><span class="op" id="8207533">]</span><span class="builtintype" id="8207534">byte</span>&nbsp;<span class="op" id="8207539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207542">s</span><span class="op" id="8207543">,</span>&nbsp;<span class="ident" id="8207545">err</span>&nbsp;<span class="op" id="8207549">:=</span>&nbsp;<span class="ident" id="8207552">hex</span><span class="op" id="8207555">.</span><span class="ident" id="8207556">DecodeString</span><span class="op" id="8207568">(</span><span class="ident" id="8207569">hexStr</span><span class="op" id="8207575">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207578">if</span>&nbsp;<span class="ident" id="8207581">err</span>&nbsp;<span class="op" id="8207585">!=</span>&nbsp;<span class="ident" id="8207588">nil</span>&nbsp;<span class="op" id="8207592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8207596">panic</span><span class="op" id="8207601">(</span><span class="ident" id="8207602">err</span><span class="op" id="8207605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207611">return</span>&nbsp;<span class="ident" id="8207618">s</span><br>
<span class="lineno"></span><span class="op" id="8207620">}</span>
</div>
</body>
</html>
