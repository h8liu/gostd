<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4268855">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4268910">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4268964">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4269015">/*<br>
<span class="lineno"></span>Package&nbsp;hmac&nbsp;implements&nbsp;the&nbsp;Keyed-Hash&nbsp;Message&nbsp;Authentication&nbsp;Code&nbsp;(HMAC)&nbsp;as<br>
<span class="lineno"></span>defined&nbsp;in&nbsp;U.S.&nbsp;Federal&nbsp;Information&nbsp;Processing&nbsp;Standards&nbsp;Publication&nbsp;198.<br>
<span class="lineno"></span>An&nbsp;HMAC&nbsp;is&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;that&nbsp;uses&nbsp;a&nbsp;key&nbsp;to&nbsp;sign&nbsp;a&nbsp;message.<br>
<span class="lineno"></span>The&nbsp;receiver&nbsp;verifies&nbsp;the&nbsp;hash&nbsp;by&nbsp;recomputing&nbsp;it&nbsp;using&nbsp;the&nbsp;same&nbsp;key.<br>
<span class="lineno">10</span><br>
<span class="lineno"></span>Receivers&nbsp;should&nbsp;be&nbsp;careful&nbsp;to&nbsp;use&nbsp;Equal&nbsp;to&nbsp;compare&nbsp;MACs&nbsp;in&nbsp;order&nbsp;to&nbsp;avoid<br>
<span class="lineno"></span>timing&nbsp;side-channels:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;CheckMAC&nbsp;returns&nbsp;true&nbsp;if&nbsp;messageMAC&nbsp;is&nbsp;a&nbsp;valid&nbsp;HMAC&nbsp;tag&nbsp;for&nbsp;message.<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbspfunc&nbsp;CheckMAC(message,&nbsp;messageMAC,&nbsp;key&nbsp;[]byte)&nbsp;bool&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspmac&nbsp;:=&nbsp;hmac.New(sha256.New,&nbsp;key)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspmac.Write(message)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspexpectedMAC&nbsp;:=&nbsp;mac.Sum(nil)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;hmac.Equal(messageMAC,&nbsp;expectedMAC)<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4269669">package</span>&nbsp;<span class="ident" id="4269677">hmac</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4269683">import</span>&nbsp;<span class="op" id="4269690">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4269693">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4269710">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4269717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4269720">//&nbsp;FIPS&nbsp;198:</span><br>
<span class="lineno">30</span><span class="comment" id="4269733">//&nbsp;http://csrc.nist.gov/publications/fips/fips198/fips-198a.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4269798">//&nbsp;key&nbsp;is&nbsp;zero&nbsp;padded&nbsp;to&nbsp;the&nbsp;block&nbsp;size&nbsp;of&nbsp;the&nbsp;hash&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4269859">//&nbsp;ipad&nbsp;=&nbsp;0x36&nbsp;byte&nbsp;repeated&nbsp;for&nbsp;key&nbsp;length</span><br>
<span class="lineno"></span><span class="comment" id="4269903">//&nbsp;opad&nbsp;=&nbsp;0x5c&nbsp;byte&nbsp;repeated&nbsp;for&nbsp;key&nbsp;length</span><br>
<span class="lineno">35</span><span class="comment" id="4269947">//&nbsp;hmac&nbsp;=&nbsp;H([key&nbsp;^&nbsp;opad]&nbsp;H([key&nbsp;^&nbsp;ipad]&nbsp;text))</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4269995">type</span>&nbsp;<span class="ident" id="4270000">hmac</span>&nbsp;<span class="keyword" id="4270005">struct</span>&nbsp;<span class="op" id="4270012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270015">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4270028">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270033">blocksize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4270046">int</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270051">key</span><span class="op" id="4270054">,</span>&nbsp;<span class="ident" id="4270056">tmp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4270064">[</span><span class="op" id="4270065">]</span><span class="builtintype" id="4270066">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270072">outer</span><span class="op" id="4270077">,</span>&nbsp;<span class="ident" id="4270079">inner</span>&nbsp;<span class="ident" id="4270085"><a href="/crypto/hmac/hmac.go.html#4269710">hash</a></span><span class="op" id="4270089">.</span><span class="ident" id="4270090">Hash</span><br>
<span class="lineno"></span><span class="op" id="4270095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270098">func</span>&nbsp;<span class="op" id="4270103">(</span><span class="ident" id="4270104">h</span>&nbsp;<span class="op" id="4270106">*</span><span class="ident" id="4270107"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270111">)</span>&nbsp;<span class="ident" id="4270113">tmpPad</span><span class="op" id="4270119">(</span><span class="ident" id="4270120">xor</span>&nbsp;<span class="builtintype" id="4270124">byte</span><span class="op" id="4270128">)</span>&nbsp;<span class="op" id="4270130">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270133">for</span>&nbsp;<span class="ident" id="4270137">i</span><span class="op" id="4270138">,</span>&nbsp;<span class="ident" id="4270140">k</span>&nbsp;<span class="op" id="4270142">:=</span>&nbsp;<span class="keyword" id="4270145">range</span>&nbsp;<span class="ident" id="4270151"><a href="/crypto/hmac/hmac.go.html#4270104">h</a></span><span class="op" id="4270152">.</span><span class="ident" id="4270153">key</span>&nbsp;<span class="op" id="4270157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270161"><a href="/crypto/hmac/hmac.go.html#4270104">h</a></span><span class="op" id="4270162">.</span><span class="ident" id="4270163">tmp</span><span class="op" id="4270166">[</span><span class="ident" id="4270167"><a href="/crypto/hmac/hmac.go.html#4270137">i</a></span><span class="op" id="4270168">]</span>&nbsp;<span class="op" id="4270170">=</span>&nbsp;<span class="ident" id="4270172"><a href="/crypto/hmac/hmac.go.html#4270120">xor</a></span>&nbsp;<span class="op" id="4270176">^</span>&nbsp;<span class="ident" id="4270178"><a href="/crypto/hmac/hmac.go.html#4270140">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270184">for</span>&nbsp;<span class="ident" id="4270188">i</span>&nbsp;<span class="op" id="4270190">:=</span>&nbsp;<span class="builtinfunc" id="4270193">len</span><span class="op" id="4270196">(</span><span class="ident" id="4270197"><a href="/crypto/hmac/hmac.go.html#4270104">h</a></span><span class="op" id="4270198">.</span><span class="ident" id="4270199">key</span><span class="op" id="4270202">)</span><span class="op" id="4270203">;</span>&nbsp;<span class="ident" id="4270205"><a href="/crypto/hmac/hmac.go.html#4270188">i</a></span>&nbsp;<span class="op" id="4270207">&lt;</span>&nbsp;<span class="ident" id="4270209"><a href="/crypto/hmac/hmac.go.html#4270104">h</a></span><span class="op" id="4270210">.</span><span class="ident" id="4270211">blocksize</span><span class="op" id="4270220">;</span>&nbsp;<span class="ident" id="4270222"><a href="/crypto/hmac/hmac.go.html#4270188">i</a></span><span class="op" id="4270223">++</span>&nbsp;<span class="op" id="4270226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270230"><a href="/crypto/hmac/hmac.go.html#4270104">h</a></span><span class="op" id="4270231">.</span><span class="ident" id="4270232">tmp</span><span class="op" id="4270235">[</span><span class="ident" id="4270236"><a href="/crypto/hmac/hmac.go.html#4270188">i</a></span><span class="op" id="4270237">]</span>&nbsp;<span class="op" id="4270239">=</span>&nbsp;<span class="ident" id="4270241"><a href="/crypto/hmac/hmac.go.html#4270120">xor</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270246">}</span><br>
<span class="lineno"></span><span class="op" id="4270248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270251">func</span>&nbsp;<span class="op" id="4270256">(</span><span class="ident" id="4270257">h</span>&nbsp;<span class="op" id="4270259">*</span><span class="ident" id="4270260"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270264">)</span>&nbsp;<span class="ident" id="4270266">Sum</span><span class="op" id="4270269">(</span><span class="ident" id="4270270">in</span>&nbsp;<span class="op" id="4270273">[</span><span class="op" id="4270274">]</span><span class="builtintype" id="4270275">byte</span><span class="op" id="4270279">)</span>&nbsp;<span class="op" id="4270281">[</span><span class="op" id="4270282">]</span><span class="builtintype" id="4270283">byte</span>&nbsp;<span class="op" id="4270288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270291">origLen</span>&nbsp;<span class="op" id="4270299">:=</span>&nbsp;<span class="builtinfunc" id="4270302">len</span><span class="op" id="4270305">(</span><span class="ident" id="4270306"><a href="/crypto/hmac/hmac.go.html#4270270">in</a></span><span class="op" id="4270308">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270311"><a href="/crypto/hmac/hmac.go.html#4270270">in</a></span>&nbsp;<span class="op" id="4270314">=</span>&nbsp;<span class="ident" id="4270316"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270317">.</span><span class="ident" id="4270318">inner</span><span class="op" id="4270323">.</span><span class="ident" id="4270324">Sum</span><span class="op" id="4270327">(</span><span class="ident" id="4270328"><a href="/crypto/hmac/hmac.go.html#4270270">in</a></span><span class="op" id="4270330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270333"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270334">.</span><span class="ident" id="4270335">tmpPad</span><span class="op" id="4270341">(</span><span class="num" id="4270342">0x5c</span><span class="op" id="4270346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4270349">copy</span><span class="op" id="4270353">(</span><span class="ident" id="4270354"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270355">.</span><span class="ident" id="4270356">tmp</span><span class="op" id="4270359">[</span><span class="ident" id="4270360"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270361">.</span><span class="ident" id="4270362">blocksize</span><span class="op" id="4270371">:</span><span class="op" id="4270372">]</span><span class="op" id="4270373">,</span>&nbsp;<span class="ident" id="4270375"><a href="/crypto/hmac/hmac.go.html#4270270">in</a></span><span class="op" id="4270377">[</span><span class="ident" id="4270378"><a href="/crypto/hmac/hmac.go.html#4270291">origLen</a></span><span class="op" id="4270385">:</span><span class="op" id="4270386">]</span><span class="op" id="4270387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270390"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270391">.</span><span class="ident" id="4270392">outer</span><span class="op" id="4270397">.</span><span class="ident" id="4270398">Reset</span><span class="op" id="4270403">(</span><span class="op" id="4270404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270407"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270408">.</span><span class="ident" id="4270409">outer</span><span class="op" id="4270414">.</span><span class="ident" id="4270415">Write</span><span class="op" id="4270420">(</span><span class="ident" id="4270421"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270422">.</span><span class="ident" id="4270423">tmp</span><span class="op" id="4270426">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270429">return</span>&nbsp;<span class="ident" id="4270436"><a href="/crypto/hmac/hmac.go.html#4270257">h</a></span><span class="op" id="4270437">.</span><span class="ident" id="4270438">outer</span><span class="op" id="4270443">.</span><span class="ident" id="4270444">Sum</span><span class="op" id="4270447">(</span><span class="ident" id="4270448"><a href="/crypto/hmac/hmac.go.html#4270270">in</a></span><span class="op" id="4270450">[</span><span class="op" id="4270451">:</span><span class="ident" id="4270452"><a href="/crypto/hmac/hmac.go.html#4270291">origLen</a></span><span class="op" id="4270459">]</span><span class="op" id="4270460">)</span><br>
<span class="lineno"></span><span class="op" id="4270462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270465">func</span>&nbsp;<span class="op" id="4270470">(</span><span class="ident" id="4270471">h</span>&nbsp;<span class="op" id="4270473">*</span><span class="ident" id="4270474"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270478">)</span>&nbsp;<span class="ident" id="4270480">Write</span><span class="op" id="4270485">(</span><span class="ident" id="4270486">p</span>&nbsp;<span class="op" id="4270488">[</span><span class="op" id="4270489">]</span><span class="builtintype" id="4270490">byte</span><span class="op" id="4270494">)</span>&nbsp;<span class="op" id="4270496">(</span><span class="ident" id="4270497">n</span>&nbsp;<span class="builtintype" id="4270499">int</span><span class="op" id="4270502">,</span>&nbsp;<span class="ident" id="4270504">err</span>&nbsp;<span class="builtintype" id="4270508">error</span><span class="op" id="4270513">)</span>&nbsp;<span class="op" id="4270515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270518">return</span>&nbsp;<span class="ident" id="4270525"><a href="/crypto/hmac/hmac.go.html#4270471">h</a></span><span class="op" id="4270526">.</span><span class="ident" id="4270527">inner</span><span class="op" id="4270532">.</span><span class="ident" id="4270533">Write</span><span class="op" id="4270538">(</span><span class="ident" id="4270539"><a href="/crypto/hmac/hmac.go.html#4270486">p</a></span><span class="op" id="4270540">)</span><br>
<span class="lineno">65</span><span class="op" id="4270542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270545">func</span>&nbsp;<span class="op" id="4270550">(</span><span class="ident" id="4270551">h</span>&nbsp;<span class="op" id="4270553">*</span><span class="ident" id="4270554"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270558">)</span>&nbsp;<span class="ident" id="4270560">Size</span><span class="op" id="4270564">(</span><span class="op" id="4270565">)</span>&nbsp;<span class="builtintype" id="4270567">int</span>&nbsp;<span class="op" id="4270571">{</span>&nbsp;<span class="keyword" id="4270573">return</span>&nbsp;<span class="ident" id="4270580"><a href="/crypto/hmac/hmac.go.html#4270551">h</a></span><span class="op" id="4270581">.</span><span class="ident" id="4270582">size</span>&nbsp;<span class="op" id="4270587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270590">func</span>&nbsp;<span class="op" id="4270595">(</span><span class="ident" id="4270596">h</span>&nbsp;<span class="op" id="4270598">*</span><span class="ident" id="4270599"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270603">)</span>&nbsp;<span class="ident" id="4270605">BlockSize</span><span class="op" id="4270614">(</span><span class="op" id="4270615">)</span>&nbsp;<span class="builtintype" id="4270617">int</span>&nbsp;<span class="op" id="4270621">{</span>&nbsp;<span class="keyword" id="4270623">return</span>&nbsp;<span class="ident" id="4270630"><a href="/crypto/hmac/hmac.go.html#4270596">h</a></span><span class="op" id="4270631">.</span><span class="ident" id="4270632">blocksize</span>&nbsp;<span class="op" id="4270642">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4270645">func</span>&nbsp;<span class="op" id="4270650">(</span><span class="ident" id="4270651">h</span>&nbsp;<span class="op" id="4270653">*</span><span class="ident" id="4270654"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270658">)</span>&nbsp;<span class="ident" id="4270660">Reset</span><span class="op" id="4270665">(</span><span class="op" id="4270666">)</span>&nbsp;<span class="op" id="4270668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270671"><a href="/crypto/hmac/hmac.go.html#4270651">h</a></span><span class="op" id="4270672">.</span><span class="ident" id="4270673">inner</span><span class="op" id="4270678">.</span><span class="ident" id="4270679">Reset</span><span class="op" id="4270684">(</span><span class="op" id="4270685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270688"><a href="/crypto/hmac/hmac.go.html#4270651">h</a></span><span class="op" id="4270689">.</span><span class="ident" id="4270690">tmpPad</span><span class="op" id="4270696">(</span><span class="num" id="4270697">0x36</span><span class="op" id="4270701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270704"><a href="/crypto/hmac/hmac.go.html#4270651">h</a></span><span class="op" id="4270705">.</span><span class="ident" id="4270706">inner</span><span class="op" id="4270711">.</span><span class="ident" id="4270712">Write</span><span class="op" id="4270717">(</span><span class="ident" id="4270718"><a href="/crypto/hmac/hmac.go.html#4270651">h</a></span><span class="op" id="4270719">.</span><span class="ident" id="4270720">tmp</span><span class="op" id="4270723">[</span><span class="op" id="4270724">:</span><span class="ident" id="4270725"><a href="/crypto/hmac/hmac.go.html#4270651">h</a></span><span class="op" id="4270726">.</span><span class="ident" id="4270727">blocksize</span><span class="op" id="4270736">]</span><span class="op" id="4270737">)</span><br>
<span class="lineno">75</span><span class="op" id="4270739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270742">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;HMAC&nbsp;hash&nbsp;using&nbsp;the&nbsp;given&nbsp;hash.Hash&nbsp;type&nbsp;and&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4270813">func</span>&nbsp;<span class="ident" id="4270818">New</span><span class="op" id="4270821">(</span><span class="ident" id="4270822">h</span>&nbsp;<span class="keyword" id="4270824">func</span><span class="op" id="4270828">(</span><span class="op" id="4270829">)</span>&nbsp;<span class="ident" id="4270831"><a href="/crypto/hmac/hmac.go.html#4269710">hash</a></span><span class="op" id="4270835">.</span><span class="ident" id="4270836">Hash</span><span class="op" id="4270840">,</span>&nbsp;<span class="ident" id="4270842">key</span>&nbsp;<span class="op" id="4270846">[</span><span class="op" id="4270847">]</span><span class="builtintype" id="4270848">byte</span><span class="op" id="4270852">)</span>&nbsp;<span class="ident" id="4270854"><a href="/crypto/hmac/hmac.go.html#4269710">hash</a></span><span class="op" id="4270858">.</span><span class="ident" id="4270859">Hash</span>&nbsp;<span class="op" id="4270864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270867">hm</span>&nbsp;<span class="op" id="4270870">:=</span>&nbsp;<span class="builtinfunc" id="4270873">new</span><span class="op" id="4270876">(</span><span class="ident" id="4270877"><a href="/crypto/hmac/hmac.go.html#4270000">hmac</a></span><span class="op" id="4270881">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270884"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270886">.</span><span class="ident" id="4270887">outer</span>&nbsp;<span class="op" id="4270893">=</span>&nbsp;<span class="ident" id="4270895"><a href="/crypto/hmac/hmac.go.html#4270822">h</a></span><span class="op" id="4270896">(</span><span class="op" id="4270897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270900"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270902">.</span><span class="ident" id="4270903">inner</span>&nbsp;<span class="op" id="4270909">=</span>&nbsp;<span class="ident" id="4270911"><a href="/crypto/hmac/hmac.go.html#4270822">h</a></span><span class="op" id="4270912">(</span><span class="op" id="4270913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270916"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270918">.</span><span class="ident" id="4270919">size</span>&nbsp;<span class="op" id="4270924">=</span>&nbsp;<span class="ident" id="4270926"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270928">.</span><span class="ident" id="4270929">inner</span><span class="op" id="4270934">.</span><span class="ident" id="4270935">Size</span><span class="op" id="4270939">(</span><span class="op" id="4270940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270943"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270945">.</span><span class="ident" id="4270946">blocksize</span>&nbsp;<span class="op" id="4270956">=</span>&nbsp;<span class="ident" id="4270958"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270960">.</span><span class="ident" id="4270961">inner</span><span class="op" id="4270966">.</span><span class="ident" id="4270967">BlockSize</span><span class="op" id="4270976">(</span><span class="op" id="4270977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270980"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4270982">.</span><span class="ident" id="4270983">tmp</span>&nbsp;<span class="op" id="4270987">=</span>&nbsp;<span class="builtinfunc" id="4270989">make</span><span class="op" id="4270993">(</span><span class="op" id="4270994">[</span><span class="op" id="4270995">]</span><span class="builtintype" id="4270996">byte</span><span class="op" id="4271000">,</span>&nbsp;<span class="ident" id="4271002"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271004">.</span><span class="ident" id="4271005">blocksize</span><span class="op" id="4271014">+</span><span class="ident" id="4271015"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271017">.</span><span class="ident" id="4271018">size</span><span class="op" id="4271022">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271025">if</span>&nbsp;<span class="builtinfunc" id="4271028">len</span><span class="op" id="4271031">(</span><span class="ident" id="4271032"><a href="/crypto/hmac/hmac.go.html#4270842">key</a></span><span class="op" id="4271035">)</span>&nbsp;<span class="op" id="4271037">&gt;</span>&nbsp;<span class="ident" id="4271039"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271041">.</span><span class="ident" id="4271042">blocksize</span>&nbsp;<span class="op" id="4271052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271056">//&nbsp;If&nbsp;key&nbsp;is&nbsp;too&nbsp;big,&nbsp;hash&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271089"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271091">.</span><span class="ident" id="4271092">outer</span><span class="op" id="4271097">.</span><span class="ident" id="4271098">Write</span><span class="op" id="4271103">(</span><span class="ident" id="4271104"><a href="/crypto/hmac/hmac.go.html#4270842">key</a></span><span class="op" id="4271107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271111"><a href="/crypto/hmac/hmac.go.html#4270842">key</a></span>&nbsp;<span class="op" id="4271115">=</span>&nbsp;<span class="ident" id="4271117"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271119">.</span><span class="ident" id="4271120">outer</span><span class="op" id="4271125">.</span><span class="ident" id="4271126">Sum</span><span class="op" id="4271129">(</span><span class="ident" id="4271130">nil</span><span class="op" id="4271133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271136">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271139"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271141">.</span><span class="ident" id="4271142">key</span>&nbsp;<span class="op" id="4271146">=</span>&nbsp;<span class="builtinfunc" id="4271148">make</span><span class="op" id="4271152">(</span><span class="op" id="4271153">[</span><span class="op" id="4271154">]</span><span class="builtintype" id="4271155">byte</span><span class="op" id="4271159">,</span>&nbsp;<span class="builtinfunc" id="4271161">len</span><span class="op" id="4271164">(</span><span class="ident" id="4271165"><a href="/crypto/hmac/hmac.go.html#4270842">key</a></span><span class="op" id="4271168">)</span><span class="op" id="4271169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4271172">copy</span><span class="op" id="4271176">(</span><span class="ident" id="4271177"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271179">.</span><span class="ident" id="4271180">key</span><span class="op" id="4271183">,</span>&nbsp;<span class="ident" id="4271185"><a href="/crypto/hmac/hmac.go.html#4270842">key</a></span><span class="op" id="4271188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271191"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><span class="op" id="4271193">.</span><span class="ident" id="4271194">Reset</span><span class="op" id="4271199">(</span><span class="op" id="4271200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271203">return</span>&nbsp;<span class="ident" id="4271210"><a href="/crypto/hmac/hmac.go.html#4270867">hm</a></span><br>
<span class="lineno"></span><span class="op" id="4271213">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="4271216">//&nbsp;Equal&nbsp;compares&nbsp;two&nbsp;MACs&nbsp;for&nbsp;equality&nbsp;without&nbsp;leaking&nbsp;timing&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4271292">func</span>&nbsp;<span class="ident" id="4271297">Equal</span><span class="op" id="4271302">(</span><span class="ident" id="4271303">mac1</span><span class="op" id="4271307">,</span>&nbsp;<span class="ident" id="4271309">mac2</span>&nbsp;<span class="op" id="4271314">[</span><span class="op" id="4271315">]</span><span class="builtintype" id="4271316">byte</span><span class="op" id="4271320">)</span>&nbsp;<span class="builtintype" id="4271322">bool</span>&nbsp;<span class="op" id="4271327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271330">//&nbsp;We&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;constant&nbsp;time&nbsp;if&nbsp;the&nbsp;lengths&nbsp;of&nbsp;the&nbsp;MACs&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271399">//&nbsp;different&nbsp;as&nbsp;that&nbsp;suggests&nbsp;that&nbsp;a&nbsp;completely&nbsp;different&nbsp;hash&nbsp;function</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271472">//&nbsp;was&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271486">return</span>&nbsp;<span class="builtinfunc" id="4271493">len</span><span class="op" id="4271496">(</span><span class="ident" id="4271497"><a href="/crypto/hmac/hmac.go.html#4271303">mac1</a></span><span class="op" id="4271501">)</span>&nbsp;<span class="op" id="4271503">==</span>&nbsp;<span class="builtinfunc" id="4271506">len</span><span class="op" id="4271509">(</span><span class="ident" id="4271510"><a href="/crypto/hmac/hmac.go.html#4271309">mac2</a></span><span class="op" id="4271514">)</span>&nbsp;<span class="op" id="4271516">&amp;&amp;</span>&nbsp;<span class="ident" id="4271519"><a href="/crypto/hmac/hmac.go.html#4269693">subtle</a></span><span class="op" id="4271525">.</span><span class="ident" id="4271526">ConstantTimeCompare</span><span class="op" id="4271545">(</span><span class="ident" id="4271546"><a href="/crypto/hmac/hmac.go.html#4271303">mac1</a></span><span class="op" id="4271550">,</span>&nbsp;<span class="ident" id="4271552"><a href="/crypto/hmac/hmac.go.html#4271309">mac2</a></span><span class="op" id="4271556">)</span>&nbsp;<span class="op" id="4271558">==</span>&nbsp;<span class="num" id="4271561">1</span><br>
<span class="lineno"></span><span class="op" id="4271563">}</span>
</div>
</body>
</html>
