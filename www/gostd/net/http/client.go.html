<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html" class="current">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4079895">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4079950">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4080004">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4080055">//&nbsp;HTTP&nbsp;client.&nbsp;See&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="4080085">//</span><br>
<span class="lineno"></span><span class="comment" id="4080088">//&nbsp;This&nbsp;is&nbsp;the&nbsp;high-level&nbsp;Client&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="4080132">//&nbsp;The&nbsp;low-level&nbsp;implementation&nbsp;is&nbsp;in&nbsp;transport.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4080185">package</span>&nbsp;<span class="ident" id="4080193">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080199">import</span>&nbsp;<span class="op" id="4080206">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080209">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080228">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080238">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080245">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080251">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080264">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080271">&#34;net/url&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080282">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080293">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4080301">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4080308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4080311">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;an&nbsp;HTTP&nbsp;client.&nbsp;Its&nbsp;zero&nbsp;value&nbsp;(DefaultClient)&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4080378">//&nbsp;usable&nbsp;client&nbsp;that&nbsp;uses&nbsp;DefaultTransport.</span><br>
<span class="lineno"></span><span class="comment" id="4080423">//</span><br>
<span class="lineno"></span><span class="comment" id="4080426">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;typically&nbsp;has&nbsp;internal&nbsp;state&nbsp;(cached&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="4080493">//&nbsp;connections),&nbsp;so&nbsp;Clients&nbsp;should&nbsp;be&nbsp;reused&nbsp;instead&nbsp;of&nbsp;created&nbsp;as</span><br>
<span class="lineno">30</span><span class="comment" id="4080560">//&nbsp;needed.&nbsp;Clients&nbsp;are&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="4080631">//</span><br>
<span class="lineno"></span><span class="comment" id="4080634">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;higher-level&nbsp;than&nbsp;a&nbsp;RoundTripper&nbsp;(such&nbsp;as&nbsp;Transport)</span><br>
<span class="lineno"></span><span class="comment" id="4080702">//&nbsp;and&nbsp;additionally&nbsp;handles&nbsp;HTTP&nbsp;details&nbsp;such&nbsp;as&nbsp;cookies&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4080763">//&nbsp;redirects.</span><br>
<span class="lineno">35</span><span class="keyword" id="4080777">type</span>&nbsp;<span class="ident" id="4080782">Client</span>&nbsp;<span class="keyword" id="4080789">struct</span>&nbsp;<span class="op" id="4080796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4080799">//&nbsp;Transport&nbsp;specifies&nbsp;the&nbsp;mechanism&nbsp;by&nbsp;which&nbsp;individual</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4080857">//&nbsp;HTTP&nbsp;requests&nbsp;are&nbsp;made.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4080885">//&nbsp;If&nbsp;nil,&nbsp;DefaultTransport&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080923">Transport</span>&nbsp;<span class="ident" id="4080933"><a href="/gostd/net/http/client.go.html#4082635">RoundTripper</a></span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4080948">//&nbsp;CheckRedirect&nbsp;specifies&nbsp;the&nbsp;policy&nbsp;for&nbsp;handling&nbsp;redirects.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081011">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;not&nbsp;nil,&nbsp;the&nbsp;client&nbsp;calls&nbsp;it&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081071">//&nbsp;following&nbsp;an&nbsp;HTTP&nbsp;redirect.&nbsp;The&nbsp;arguments&nbsp;req&nbsp;and&nbsp;via&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081133">//&nbsp;the&nbsp;upcoming&nbsp;request&nbsp;and&nbsp;the&nbsp;requests&nbsp;made&nbsp;already,&nbsp;oldest</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081196">//&nbsp;first.&nbsp;If&nbsp;CheckRedirect&nbsp;returns&nbsp;an&nbsp;error,&nbsp;the&nbsp;Client&#39;s&nbsp;Get</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081259">//&nbsp;method&nbsp;returns&nbsp;both&nbsp;the&nbsp;previous&nbsp;Response&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081309">//&nbsp;CheckRedirect&#39;s&nbsp;error&nbsp;(wrapped&nbsp;in&nbsp;a&nbsp;url.Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081371">//&nbsp;issuing&nbsp;the&nbsp;Request&nbsp;req.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081400">//</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081404">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;nil,&nbsp;the&nbsp;Client&nbsp;uses&nbsp;its&nbsp;default&nbsp;policy,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081469">//&nbsp;which&nbsp;is&nbsp;to&nbsp;stop&nbsp;after&nbsp;10&nbsp;consecutive&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081521">CheckRedirect</span>&nbsp;<span class="keyword" id="4081535">func</span><span class="op" id="4081539">(</span><span class="ident" id="4081540">req</span>&nbsp;<span class="op" id="4081544">*</span><span class="ident" id="4081545"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4081552">,</span>&nbsp;<span class="ident" id="4081554">via</span>&nbsp;<span class="op" id="4081558">[</span><span class="op" id="4081559">]</span><span class="op" id="4081560">*</span><span class="ident" id="4081561"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4081568">)</span>&nbsp;<span class="builtintype" id="4081570">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081578">//&nbsp;Jar&nbsp;specifies&nbsp;the&nbsp;cookie&nbsp;jar.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081612">//&nbsp;If&nbsp;Jar&nbsp;is&nbsp;nil,&nbsp;cookies&nbsp;are&nbsp;not&nbsp;sent&nbsp;in&nbsp;requests&nbsp;and&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081676">//&nbsp;in&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081694">Jar</span>&nbsp;<span class="ident" id="4081698"><a href="/gostd/net/http/jar.go.html#4131931">CookieJar</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081710">//&nbsp;Timeout&nbsp;specifies&nbsp;a&nbsp;time&nbsp;limit&nbsp;for&nbsp;requests&nbsp;made&nbsp;by&nbsp;this</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081771">//&nbsp;Client.&nbsp;The&nbsp;timeout&nbsp;includes&nbsp;connection&nbsp;time,&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081825">//&nbsp;redirects,&nbsp;and&nbsp;reading&nbsp;the&nbsp;response&nbsp;body.&nbsp;The&nbsp;timer&nbsp;remains</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081889">//&nbsp;running&nbsp;after&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do&nbsp;return&nbsp;and&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081946">//&nbsp;interrupt&nbsp;reading&nbsp;of&nbsp;the&nbsp;Response.Body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081990">//</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4081994">//&nbsp;A&nbsp;Timeout&nbsp;of&nbsp;zero&nbsp;means&nbsp;no&nbsp;timeout.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082034">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082038">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;must&nbsp;support&nbsp;the&nbsp;CancelRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082096">//&nbsp;method&nbsp;or&nbsp;Client&nbsp;will&nbsp;return&nbsp;errors&nbsp;when&nbsp;attempting&nbsp;to&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082160">//&nbsp;a&nbsp;request&nbsp;with&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do.&nbsp;Client&#39;s&nbsp;default</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082220">//&nbsp;Transport&nbsp;(DefaultTransport)&nbsp;supports&nbsp;CancelRequest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082277">Timeout</span>&nbsp;<span class="ident" id="4082285"><a href="/gostd/net/http/client.go.html#4080301">time</a></span><span class="op" id="4082289">.</span><span class="ident" id="4082290"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><br>
<span class="lineno"></span><span class="op" id="4082299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4082302">//&nbsp;DefaultClient&nbsp;is&nbsp;the&nbsp;default&nbsp;Client&nbsp;and&nbsp;is&nbsp;used&nbsp;by&nbsp;Get,&nbsp;Head,&nbsp;and&nbsp;Post.</span><br>
<span class="lineno">75</span><span class="keyword" id="4082377">var</span>&nbsp;<span class="ident" id="4082381">DefaultClient</span>&nbsp;<span class="op" id="4082395">=</span>&nbsp;<span class="op" id="4082397">&amp;</span><span class="ident" id="4082398"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4082404">{</span><span class="op" id="4082405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4082408">//&nbsp;RoundTripper&nbsp;is&nbsp;an&nbsp;interface&nbsp;representing&nbsp;the&nbsp;ability&nbsp;to&nbsp;execute&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4082478">//&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;obtaining&nbsp;the&nbsp;Response&nbsp;for&nbsp;a&nbsp;given&nbsp;Request.</span><br>
<span class="lineno"></span><span class="comment" id="4082550">//</span><br>
<span class="lineno">80</span><span class="comment" id="4082553">//&nbsp;A&nbsp;RoundTripper&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple</span><br>
<span class="lineno"></span><span class="comment" id="4082615">//&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="4082630">type</span>&nbsp;<span class="ident" id="4082635">RoundTripper</span>&nbsp;<span class="keyword" id="4082648">interface</span>&nbsp;<span class="op" id="4082658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082661">//&nbsp;RoundTrip&nbsp;executes&nbsp;a&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082721">//&nbsp;the&nbsp;Response&nbsp;for&nbsp;the&nbsp;request&nbsp;req.&nbsp;&nbsp;RoundTrip&nbsp;should&nbsp;not</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082781">//&nbsp;attempt&nbsp;to&nbsp;interpret&nbsp;the&nbsp;response.&nbsp;&nbsp;In&nbsp;particular,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082836">//&nbsp;RoundTrip&nbsp;must&nbsp;return&nbsp;err&nbsp;==&nbsp;nil&nbsp;if&nbsp;it&nbsp;obtained&nbsp;a&nbsp;response,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082900">//&nbsp;regardless&nbsp;of&nbsp;the&nbsp;response&#39;s&nbsp;HTTP&nbsp;status&nbsp;code.&nbsp;&nbsp;A&nbsp;non-nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4082962">//&nbsp;err&nbsp;should&nbsp;be&nbsp;reserved&nbsp;for&nbsp;failure&nbsp;to&nbsp;obtain&nbsp;a&nbsp;response.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083023">//&nbsp;Similarly,&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;attempt&nbsp;to&nbsp;handle</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083077">//&nbsp;higher-level&nbsp;protocol&nbsp;details&nbsp;such&nbsp;as&nbsp;redirects,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083130">//&nbsp;authentication,&nbsp;or&nbsp;cookies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083162">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083166">//&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;modify&nbsp;the&nbsp;request,&nbsp;except&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083222">//&nbsp;consuming&nbsp;and&nbsp;closing&nbsp;the&nbsp;Body,&nbsp;including&nbsp;on&nbsp;errors.&nbsp;The</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083283">//&nbsp;request&#39;s&nbsp;URL&nbsp;and&nbsp;Header&nbsp;fields&nbsp;are&nbsp;guaranteed&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083340">//&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083357">RoundTrip</span><span class="op" id="4083366">(</span><span class="op" id="4083367">*</span><span class="ident" id="4083368"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4083375">)</span>&nbsp;<span class="op" id="4083377">(</span><span class="op" id="4083378">*</span><span class="ident" id="4083379"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4083387">,</span>&nbsp;<span class="builtintype" id="4083389">error</span><span class="op" id="4083394">)</span><br>
<span class="lineno"></span><span class="op" id="4083396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="4083399">//&nbsp;Given&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host&#34;,&nbsp;&#34;host:port&#34;,&nbsp;or&nbsp;&#34;[ipv6::address]:port&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="4083477">//&nbsp;return&nbsp;true&nbsp;if&nbsp;the&nbsp;string&nbsp;includes&nbsp;a&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="4083523">func</span>&nbsp;<span class="ident" id="4083528">hasPort</span><span class="op" id="4083535">(</span><span class="ident" id="4083536">s</span>&nbsp;<span class="builtintype" id="4083538">string</span><span class="op" id="4083544">)</span>&nbsp;<span class="builtintype" id="4083546">bool</span>&nbsp;<span class="op" id="4083551">{</span>&nbsp;<span class="keyword" id="4083553">return</span>&nbsp;<span class="ident" id="4083560"><a href="/gostd/net/http/client.go.html#4080282">strings</a></span><span class="op" id="4083567">.</span><span class="ident" id="4083568"><a href="/gostd/strings/strings.go.html#2969551">LastIndex</a></span><span class="op" id="4083577">(</span><span class="ident" id="4083578"><a href="/gostd/net/http/client.go.html#4083536">s</a></span><span class="op" id="4083579">,</span>&nbsp;<span class="string" id="4083581">&#34;:&#34;</span><span class="op" id="4083584">)</span>&nbsp;<span class="op" id="4083586">&gt;</span>&nbsp;<span class="ident" id="4083588"><a href="/gostd/net/http/client.go.html#4080282">strings</a></span><span class="op" id="4083595">.</span><span class="ident" id="4083596"><a href="/gostd/strings/strings.go.html#2969551">LastIndex</a></span><span class="op" id="4083605">(</span><span class="ident" id="4083606"><a href="/gostd/net/http/client.go.html#4083536">s</a></span><span class="op" id="4083607">,</span>&nbsp;<span class="string" id="4083609">&#34;]&#34;</span><span class="op" id="4083612">)</span>&nbsp;<span class="op" id="4083614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4083617">//&nbsp;refererForURL&nbsp;returns&nbsp;a&nbsp;referer&nbsp;without&nbsp;any&nbsp;authentication&nbsp;info&nbsp;or</span><br>
<span class="lineno">105</span><span class="comment" id="4083687">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;if&nbsp;lastReq&nbsp;scheme&nbsp;is&nbsp;https&nbsp;and&nbsp;newReq&nbsp;scheme&nbsp;is&nbsp;http.</span><br>
<span class="lineno"></span><span class="keyword" id="4083760">func</span>&nbsp;<span class="ident" id="4083765">refererForURL</span><span class="op" id="4083778">(</span><span class="ident" id="4083779">lastReq</span><span class="op" id="4083786">,</span>&nbsp;<span class="ident" id="4083788">newReq</span>&nbsp;<span class="op" id="4083795">*</span><span class="ident" id="4083796"><a href="/gostd/net/http/client.go.html#4080271">url</a></span><span class="op" id="4083799">.</span><span class="ident" id="4083800"><a href="/gostd/net/url/url.go.html#3751194">URL</a></span><span class="op" id="4083803">)</span>&nbsp;<span class="builtintype" id="4083805">string</span>&nbsp;<span class="op" id="4083812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083815">//&nbsp;https://tools.ietf.org/html/rfc7231#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083869">//&nbsp;&nbsp;&nbsp;&#34;Clients&nbsp;SHOULD&nbsp;NOT&nbsp;include&nbsp;a&nbsp;Referer&nbsp;header&nbsp;field&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083931">//&nbsp;&nbsp;&nbsp;&nbsp;(non-secure)&nbsp;HTTP&nbsp;request&nbsp;if&nbsp;the&nbsp;referring&nbsp;page&nbsp;was</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4083990">//&nbsp;&nbsp;&nbsp;&nbsp;transferred&nbsp;with&nbsp;a&nbsp;secure&nbsp;protocol.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084034">if</span>&nbsp;<span class="ident" id="4084037"><a href="/gostd/net/http/client.go.html#4083779">lastReq</a></span><span class="op" id="4084044">.</span><span class="ident" id="4084045"><a href="/gostd/net/url/url.go.html#3751208">Scheme</a></span>&nbsp;<span class="op" id="4084052">==</span>&nbsp;<span class="string" id="4084055">&#34;https&#34;</span>&nbsp;<span class="op" id="4084063">&amp;&amp;</span>&nbsp;<span class="ident" id="4084066"><a href="/gostd/net/http/client.go.html#4083788">newReq</a></span><span class="op" id="4084072">.</span><span class="ident" id="4084073"><a href="/gostd/net/url/url.go.html#3751208">Scheme</a></span>&nbsp;<span class="op" id="4084080">==</span>&nbsp;<span class="string" id="4084083">&#34;http&#34;</span>&nbsp;<span class="op" id="4084090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084094">return</span>&nbsp;<span class="string" id="4084101">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084108">referer</span>&nbsp;<span class="op" id="4084116">:=</span>&nbsp;<span class="ident" id="4084119"><a href="/gostd/net/http/client.go.html#4083779">lastReq</a></span><span class="op" id="4084126">.</span><span class="ident" id="4084127"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="4084133">(</span><span class="op" id="4084134">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084137">if</span>&nbsp;<span class="ident" id="4084140"><a href="/gostd/net/http/client.go.html#4083779">lastReq</a></span><span class="op" id="4084147">.</span><span class="ident" id="4084148"><a href="/gostd/net/url/url.go.html#3751268">User</a></span>&nbsp;<span class="op" id="4084153">!=</span>&nbsp;<span class="builtintype" id="4084156">nil</span>&nbsp;<span class="op" id="4084160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084164">//&nbsp;This&nbsp;is&nbsp;not&nbsp;very&nbsp;efficient,&nbsp;but&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084220">//&nbsp;do&nbsp;without:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084237">//&nbsp;-&nbsp;introducing&nbsp;a&nbsp;new&nbsp;method&nbsp;on&nbsp;URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084276">//&nbsp;-&nbsp;creating&nbsp;a&nbsp;race&nbsp;condition</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084309">//&nbsp;-&nbsp;copying&nbsp;the&nbsp;URL&nbsp;struct&nbsp;manually,&nbsp;which&nbsp;would&nbsp;cause</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4084367">//&nbsp;&nbsp;&nbsp;maintenance&nbsp;problems&nbsp;down&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084409">auth</span>&nbsp;<span class="op" id="4084414">:=</span>&nbsp;<span class="ident" id="4084417"><a href="/gostd/net/http/client.go.html#4083779">lastReq</a></span><span class="op" id="4084424">.</span><span class="ident" id="4084425"><a href="/gostd/net/url/url.go.html#3751268">User</a></span><span class="op" id="4084429">.</span><span class="ident" id="4084430"><a href="/gostd/net/url/url.go.html#3752889">String</a></span><span class="op" id="4084436">(</span><span class="op" id="4084437">)</span>&nbsp;<span class="op" id="4084439">+</span>&nbsp;<span class="string" id="4084441">&#34;@&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084447"><a href="/gostd/net/http/client.go.html#4084108">referer</a></span>&nbsp;<span class="op" id="4084455">=</span>&nbsp;<span class="ident" id="4084457"><a href="/gostd/net/http/client.go.html#4080282">strings</a></span><span class="op" id="4084464">.</span><span class="ident" id="4084465"><a href="/gostd/strings/strings.go.html#2983409">Replace</a></span><span class="op" id="4084472">(</span><span class="ident" id="4084473"><a href="/gostd/net/http/client.go.html#4084108">referer</a></span><span class="op" id="4084480">,</span>&nbsp;<span class="ident" id="4084482"><a href="/gostd/net/http/client.go.html#4084409">auth</a></span><span class="op" id="4084486">,</span>&nbsp;<span class="string" id="4084488">&#34;&#34;</span><span class="op" id="4084490">,</span>&nbsp;<span class="num" id="4084492">1</span><span class="op" id="4084493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084496">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084499">return</span>&nbsp;<span class="ident" id="4084506"><a href="/gostd/net/http/client.go.html#4084108">referer</a></span><br>
<span class="lineno"></span><span class="op" id="4084514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084517">//&nbsp;Used&nbsp;in&nbsp;Send&nbsp;to&nbsp;implement&nbsp;io.ReadCloser&nbsp;by&nbsp;bundling&nbsp;together&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4084585">//&nbsp;bufio.Reader&nbsp;through&nbsp;which&nbsp;we&nbsp;read&nbsp;the&nbsp;response,&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">130</span><span class="comment" id="4084656">//&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4084679">type</span>&nbsp;<span class="ident" id="4084684">readClose</span>&nbsp;<span class="keyword" id="4084694">struct</span>&nbsp;<span class="op" id="4084701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084704"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4084706">.</span><span class="ident" id="4084707"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084715"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4084717">.</span><span class="ident" id="4084718"><a href="/gostd/io/io.go.html#1422563">Closer</a></span><br>
<span class="lineno"></span><span class="op" id="4084725">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4084728">func</span>&nbsp;<span class="op" id="4084733">(</span><span class="ident" id="4084734">c</span>&nbsp;<span class="op" id="4084736">*</span><span class="ident" id="4084737"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4084743">)</span>&nbsp;<span class="ident" id="4084745">send</span><span class="op" id="4084749">(</span><span class="ident" id="4084750">req</span>&nbsp;<span class="op" id="4084754">*</span><span class="ident" id="4084755"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4084762">)</span>&nbsp;<span class="op" id="4084764">(</span><span class="op" id="4084765">*</span><span class="ident" id="4084766"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4084774">,</span>&nbsp;<span class="builtintype" id="4084776">error</span><span class="op" id="4084781">)</span>&nbsp;<span class="op" id="4084783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084786">if</span>&nbsp;<span class="ident" id="4084789"><a href="/gostd/net/http/client.go.html#4084734">c</a></span><span class="op" id="4084790">.</span><span class="ident" id="4084791"><a href="/gostd/net/http/client.go.html#4081694">Jar</a></span>&nbsp;<span class="op" id="4084795">!=</span>&nbsp;<span class="builtintype" id="4084798">nil</span>&nbsp;<span class="op" id="4084802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084806">for</span>&nbsp;<span class="ident" id="4084810">_</span><span class="op" id="4084811">,</span>&nbsp;<span class="ident" id="4084813">cookie</span>&nbsp;<span class="op" id="4084820">:=</span>&nbsp;<span class="keyword" id="4084823">range</span>&nbsp;<span class="ident" id="4084829"><a href="/gostd/net/http/client.go.html#4084734">c</a></span><span class="op" id="4084830">.</span><span class="ident" id="4084831"><a href="/gostd/net/http/client.go.html#4081694">Jar</a></span><span class="op" id="4084834">.</span><span class="ident" id="4084835"><a href="/gostd/net/http/jar.go.html#4132361">Cookies</a></span><span class="op" id="4084842">(</span><span class="ident" id="4084843"><a href="/gostd/net/http/client.go.html#4084750">req</a></span><span class="op" id="4084846">.</span><span class="ident" id="4084847"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4084850">)</span>&nbsp;<span class="op" id="4084852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084857"><a href="/gostd/net/http/client.go.html#4084750">req</a></span><span class="op" id="4084860">.</span><span class="ident" id="4084861"><a href="/gostd/net/http/request.go.html#4142973">AddCookie</a></span><span class="op" id="4084870">(</span><span class="ident" id="4084871"><a href="/gostd/net/http/client.go.html#4084813">cookie</a></span><span class="op" id="4084877">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084887">resp</span><span class="op" id="4084891">,</span>&nbsp;<span class="ident" id="4084893">err</span>&nbsp;<span class="op" id="4084897">:=</span>&nbsp;<span class="ident" id="4084900"><a href="/gostd/net/http/client.go.html#4086413">send</a></span><span class="op" id="4084904">(</span><span class="ident" id="4084905"><a href="/gostd/net/http/client.go.html#4084750">req</a></span><span class="op" id="4084908">,</span>&nbsp;<span class="ident" id="4084910"><a href="/gostd/net/http/client.go.html#4084734">c</a></span><span class="op" id="4084911">.</span><span class="ident" id="4084912"><a href="/gostd/net/http/client.go.html#4086212">transport</a></span><span class="op" id="4084921">(</span><span class="op" id="4084922">)</span><span class="op" id="4084923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084926">if</span>&nbsp;<span class="ident" id="4084929"><a href="/gostd/net/http/client.go.html#4084893">err</a></span>&nbsp;<span class="op" id="4084933">!=</span>&nbsp;<span class="builtintype" id="4084936">nil</span>&nbsp;<span class="op" id="4084940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084944">return</span>&nbsp;<span class="builtintype" id="4084951">nil</span><span class="op" id="4084954">,</span>&nbsp;<span class="ident" id="4084956"><a href="/gostd/net/http/client.go.html#4084893">err</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084964">if</span>&nbsp;<span class="ident" id="4084967"><a href="/gostd/net/http/client.go.html#4084734">c</a></span><span class="op" id="4084968">.</span><span class="ident" id="4084969"><a href="/gostd/net/http/client.go.html#4081694">Jar</a></span>&nbsp;<span class="op" id="4084973">!=</span>&nbsp;<span class="builtintype" id="4084976">nil</span>&nbsp;<span class="op" id="4084980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084984">if</span>&nbsp;<span class="ident" id="4084987">rc</span>&nbsp;<span class="op" id="4084990">:=</span>&nbsp;<span class="ident" id="4084993"><a href="/gostd/net/http/client.go.html#4084887">resp</a></span><span class="op" id="4084997">.</span><span class="ident" id="4084998"><a href="/gostd/net/http/response.go.html#4163756">Cookies</a></span><span class="op" id="4085005">(</span><span class="op" id="4085006">)</span><span class="op" id="4085007">;</span>&nbsp;<span class="builtinfunc" id="4085009">len</span><span class="op" id="4085012">(</span><span class="ident" id="4085013"><a href="/gostd/net/http/client.go.html#4084987">rc</a></span><span class="op" id="4085015">)</span>&nbsp;<span class="op" id="4085017">&gt;</span>&nbsp;<span class="num" id="4085019">0</span>&nbsp;<span class="op" id="4085021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085026"><a href="/gostd/net/http/client.go.html#4084734">c</a></span><span class="op" id="4085027">.</span><span class="ident" id="4085028"><a href="/gostd/net/http/client.go.html#4081694">Jar</a></span><span class="op" id="4085031">.</span><span class="ident" id="4085032"><a href="/gostd/net/http/jar.go.html#4132139">SetCookies</a></span><span class="op" id="4085042">(</span><span class="ident" id="4085043"><a href="/gostd/net/http/client.go.html#4084750">req</a></span><span class="op" id="4085046">.</span><span class="ident" id="4085047"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4085050">,</span>&nbsp;<span class="ident" id="4085052"><a href="/gostd/net/http/client.go.html#4084987">rc</a></span><span class="op" id="4085054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085058">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085064">return</span>&nbsp;<span class="ident" id="4085071"><a href="/gostd/net/http/client.go.html#4084887">resp</a></span><span class="op" id="4085075">,</span>&nbsp;<span class="ident" id="4085077"><a href="/gostd/net/http/client.go.html#4084893">err</a></span><br>
<span class="lineno"></span><span class="op" id="4085081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085084">//&nbsp;Do&nbsp;sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;and&nbsp;returns&nbsp;an&nbsp;HTTP&nbsp;response,&nbsp;following</span><br>
<span class="lineno">155</span><span class="comment" id="4085152">//&nbsp;policy&nbsp;(e.g.&nbsp;redirects,&nbsp;cookies,&nbsp;auth)&nbsp;as&nbsp;configured&nbsp;on&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="4085223">//</span><br>
<span class="lineno"></span><span class="comment" id="4085226">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;caused&nbsp;by&nbsp;client&nbsp;policy&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4085286">//&nbsp;CheckRedirect),&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4085345">//&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno">160</span><span class="comment" id="4085391">//</span><br>
<span class="lineno"></span><span class="comment" id="4085394">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="4085456">//</span><br>
<span class="lineno"></span><span class="comment" id="4085459">//&nbsp;Callers&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="4085523">//&nbsp;resp.Body&nbsp;is&nbsp;not&nbsp;closed,&nbsp;the&nbsp;Client&#39;s&nbsp;underlying&nbsp;RoundTripper</span><br>
<span class="lineno">165</span><span class="comment" id="4085588">//&nbsp;(typically&nbsp;Transport)&nbsp;may&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;re-use&nbsp;a&nbsp;persistent&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="4085656">//&nbsp;connection&nbsp;to&nbsp;the&nbsp;server&nbsp;for&nbsp;a&nbsp;subsequent&nbsp;&#34;keep-alive&#34;&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="4085723">//</span><br>
<span class="lineno"></span><span class="comment" id="4085726">//&nbsp;The&nbsp;request&nbsp;Body,&nbsp;if&nbsp;non-nil,&nbsp;will&nbsp;be&nbsp;closed&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="4085792">//&nbsp;Transport,&nbsp;even&nbsp;on&nbsp;errors.</span><br>
<span class="lineno">170</span><span class="comment" id="4085822">//</span><br>
<span class="lineno"></span><span class="comment" id="4085825">//&nbsp;Generally&nbsp;Get,&nbsp;Post,&nbsp;or&nbsp;PostForm&nbsp;will&nbsp;be&nbsp;used&nbsp;instead&nbsp;of&nbsp;Do.</span><br>
<span class="lineno"></span><span class="keyword" id="4085889">func</span>&nbsp;<span class="op" id="4085894">(</span><span class="ident" id="4085895">c</span>&nbsp;<span class="op" id="4085897">*</span><span class="ident" id="4085898"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4085904">)</span>&nbsp;<span class="ident" id="4085906">Do</span><span class="op" id="4085908">(</span><span class="ident" id="4085909">req</span>&nbsp;<span class="op" id="4085913">*</span><span class="ident" id="4085914"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4085921">)</span>&nbsp;<span class="op" id="4085923">(</span><span class="ident" id="4085924">resp</span>&nbsp;<span class="op" id="4085929">*</span><span class="ident" id="4085930"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4085938">,</span>&nbsp;<span class="ident" id="4085940">err</span>&nbsp;<span class="builtintype" id="4085944">error</span><span class="op" id="4085949">)</span>&nbsp;<span class="op" id="4085951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085954">if</span>&nbsp;<span class="ident" id="4085957"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4085960">.</span><span class="ident" id="4085961"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4085968">==</span>&nbsp;<span class="string" id="4085971">&#34;GET&#34;</span>&nbsp;<span class="op" id="4085977">||</span>&nbsp;<span class="ident" id="4085980"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4085983">.</span><span class="ident" id="4085984"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4085991">==</span>&nbsp;<span class="string" id="4085994">&#34;HEAD&#34;</span>&nbsp;<span class="op" id="4086001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086005">return</span>&nbsp;<span class="ident" id="4086012"><a href="/gostd/net/http/client.go.html#4085895">c</a></span><span class="op" id="4086013">.</span><span class="ident" id="4086014"><a href="/gostd/net/http/client.go.html#4089823">doFollowingRedirects</a></span><span class="op" id="4086034">(</span><span class="ident" id="4086035"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4086038">,</span>&nbsp;<span class="ident" id="4086040"><a href="/gostd/net/http/client.go.html#4087935">shouldRedirectGet</a></span><span class="op" id="4086057">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086063">if</span>&nbsp;<span class="ident" id="4086066"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4086069">.</span><span class="ident" id="4086070"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4086077">==</span>&nbsp;<span class="string" id="4086080">&#34;POST&#34;</span>&nbsp;<span class="op" id="4086087">||</span>&nbsp;<span class="ident" id="4086090"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4086093">.</span><span class="ident" id="4086094"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4086101">==</span>&nbsp;<span class="string" id="4086104">&#34;PUT&#34;</span>&nbsp;<span class="op" id="4086110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086114">return</span>&nbsp;<span class="ident" id="4086121"><a href="/gostd/net/http/client.go.html#4085895">c</a></span><span class="op" id="4086122">.</span><span class="ident" id="4086123"><a href="/gostd/net/http/client.go.html#4089823">doFollowingRedirects</a></span><span class="op" id="4086143">(</span><span class="ident" id="4086144"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4086147">,</span>&nbsp;<span class="ident" id="4086149"><a href="/gostd/net/http/client.go.html#4088230">shouldRedirectPost</a></span><span class="op" id="4086167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086173">return</span>&nbsp;<span class="ident" id="4086180"><a href="/gostd/net/http/client.go.html#4085895">c</a></span><span class="op" id="4086181">.</span><span class="ident" id="4086182"><a href="/gostd/net/http/client.go.html#4084745">send</a></span><span class="op" id="4086186">(</span><span class="ident" id="4086187"><a href="/gostd/net/http/client.go.html#4085909">req</a></span><span class="op" id="4086190">)</span><br>
<span class="lineno">180</span><span class="op" id="4086192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4086195">func</span>&nbsp;<span class="op" id="4086200">(</span><span class="ident" id="4086201">c</span>&nbsp;<span class="op" id="4086203">*</span><span class="ident" id="4086204"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4086210">)</span>&nbsp;<span class="ident" id="4086212">transport</span><span class="op" id="4086221">(</span><span class="op" id="4086222">)</span>&nbsp;<span class="ident" id="4086224"><a href="/gostd/net/http/client.go.html#4082635">RoundTripper</a></span>&nbsp;<span class="op" id="4086237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086240">if</span>&nbsp;<span class="ident" id="4086243"><a href="/gostd/net/http/client.go.html#4086201">c</a></span><span class="op" id="4086244">.</span><span class="ident" id="4086245"><a href="/gostd/net/http/client.go.html#4080923">Transport</a></span>&nbsp;<span class="op" id="4086255">!=</span>&nbsp;<span class="builtintype" id="4086258">nil</span>&nbsp;<span class="op" id="4086262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086266">return</span>&nbsp;<span class="ident" id="4086273"><a href="/gostd/net/http/client.go.html#4086201">c</a></span><span class="op" id="4086274">.</span><span class="ident" id="4086275"><a href="/gostd/net/http/client.go.html#4080923">Transport</a></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086289">return</span>&nbsp;<span class="ident" id="4086296"><a href="/gostd/net/http/transport.go.html#4260261">DefaultTransport</a></span><br>
<span class="lineno"></span><span class="op" id="4086313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4086316">//&nbsp;send&nbsp;issues&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno">190</span><span class="comment" id="4086348">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4086408">func</span>&nbsp;<span class="ident" id="4086413">send</span><span class="op" id="4086417">(</span><span class="ident" id="4086418">req</span>&nbsp;<span class="op" id="4086422">*</span><span class="ident" id="4086423"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4086430">,</span>&nbsp;<span class="ident" id="4086432">t</span>&nbsp;<span class="ident" id="4086434"><a href="/gostd/net/http/client.go.html#4082635">RoundTripper</a></span><span class="op" id="4086446">)</span>&nbsp;<span class="op" id="4086448">(</span><span class="ident" id="4086449">resp</span>&nbsp;<span class="op" id="4086454">*</span><span class="ident" id="4086455"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4086463">,</span>&nbsp;<span class="ident" id="4086465">err</span>&nbsp;<span class="builtintype" id="4086469">error</span><span class="op" id="4086474">)</span>&nbsp;<span class="op" id="4086476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086479">if</span>&nbsp;<span class="ident" id="4086482"><a href="/gostd/net/http/client.go.html#4086432">t</a></span>&nbsp;<span class="op" id="4086484">==</span>&nbsp;<span class="builtintype" id="4086487">nil</span>&nbsp;<span class="op" id="4086491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086495"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086498">.</span><span class="ident" id="4086499"><a href="/gostd/net/http/request.go.html#4160935">closeBody</a></span><span class="op" id="4086508">(</span><span class="op" id="4086509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086513">return</span>&nbsp;<span class="builtintype" id="4086520">nil</span><span class="op" id="4086523">,</span>&nbsp;<span class="ident" id="4086525"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4086531">.</span><span class="ident" id="4086532"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4086535">(</span><span class="string" id="4086536">&#34;http:&nbsp;no&nbsp;Client.Transport&nbsp;or&nbsp;DefaultTransport&#34;</span><span class="op" id="4086583">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086590">if</span>&nbsp;<span class="ident" id="4086593"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086596">.</span><span class="ident" id="4086597"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span>&nbsp;<span class="op" id="4086601">==</span>&nbsp;<span class="builtintype" id="4086604">nil</span>&nbsp;<span class="op" id="4086608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086612"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086615">.</span><span class="ident" id="4086616"><a href="/gostd/net/http/request.go.html#4160935">closeBody</a></span><span class="op" id="4086625">(</span><span class="op" id="4086626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086630">return</span>&nbsp;<span class="builtintype" id="4086637">nil</span><span class="op" id="4086640">,</span>&nbsp;<span class="ident" id="4086642"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4086648">.</span><span class="ident" id="4086649"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4086652">(</span><span class="string" id="4086653">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="4086676">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086683">if</span>&nbsp;<span class="ident" id="4086686"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086689">.</span><span class="ident" id="4086690"><a href="/gostd/net/http/request.go.html#4141462">RequestURI</a></span>&nbsp;<span class="op" id="4086701">!=</span>&nbsp;<span class="string" id="4086704">&#34;&#34;</span>&nbsp;<span class="op" id="4086707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086711"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086714">.</span><span class="ident" id="4086715"><a href="/gostd/net/http/request.go.html#4160935">closeBody</a></span><span class="op" id="4086724">(</span><span class="op" id="4086725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086729">return</span>&nbsp;<span class="builtintype" id="4086736">nil</span><span class="op" id="4086739">,</span>&nbsp;<span class="ident" id="4086741"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4086747">.</span><span class="ident" id="4086748"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4086751">(</span><span class="string" id="4086752">&#34;http:&nbsp;Request.RequestURI&nbsp;can&#39;t&nbsp;be&nbsp;set&nbsp;in&nbsp;client&nbsp;requests.&#34;</span><span class="op" id="4086811">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086818">//&nbsp;Most&nbsp;the&nbsp;callers&nbsp;of&nbsp;send&nbsp;(Get,&nbsp;Post,&nbsp;et&nbsp;al)&nbsp;don&#39;t&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086877">//&nbsp;Headers,&nbsp;leaving&nbsp;it&nbsp;uninitialized.&nbsp;&nbsp;We&nbsp;guarantee&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086937">//&nbsp;Transport&nbsp;that&nbsp;this&nbsp;has&nbsp;been&nbsp;initialized,&nbsp;though.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4086991">if</span>&nbsp;<span class="ident" id="4086994"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4086997">.</span><span class="ident" id="4086998"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span>&nbsp;<span class="op" id="4087005">==</span>&nbsp;<span class="builtintype" id="4087008">nil</span>&nbsp;<span class="op" id="4087012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087016"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4087019">.</span><span class="ident" id="4087020"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span>&nbsp;<span class="op" id="4087027">=</span>&nbsp;<span class="builtinfunc" id="4087029">make</span><span class="op" id="4087033">(</span><span class="ident" id="4087034"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="4087040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087047">if</span>&nbsp;<span class="ident" id="4087050">u</span>&nbsp;<span class="op" id="4087052">:=</span>&nbsp;<span class="ident" id="4087055"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4087058">.</span><span class="ident" id="4087059"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4087062">.</span><span class="ident" id="4087063"><a href="/gostd/net/url/url.go.html#3751268">User</a></span><span class="op" id="4087067">;</span>&nbsp;<span class="ident" id="4087069"><a href="/gostd/net/http/client.go.html#4087050">u</a></span>&nbsp;<span class="op" id="4087071">!=</span>&nbsp;<span class="builtintype" id="4087074">nil</span>&nbsp;<span class="op" id="4087078">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087082">username</span>&nbsp;<span class="op" id="4087091">:=</span>&nbsp;<span class="ident" id="4087094"><a href="/gostd/net/http/client.go.html#4087050">u</a></span><span class="op" id="4087095">.</span><span class="ident" id="4087096"><a href="/gostd/net/url/url.go.html#3752535">Username</a></span><span class="op" id="4087104">(</span><span class="op" id="4087105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087109">password</span><span class="op" id="4087117">,</span>&nbsp;<span class="ident" id="4087119">_</span>&nbsp;<span class="op" id="4087121">:=</span>&nbsp;<span class="ident" id="4087124"><a href="/gostd/net/http/client.go.html#4087050">u</a></span><span class="op" id="4087125">.</span><span class="ident" id="4087126"><a href="/gostd/net/url/url.go.html#3752671">Password</a></span><span class="op" id="4087134">(</span><span class="op" id="4087135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087139"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4087142">.</span><span class="ident" id="4087143"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="4087149">.</span><span class="ident" id="4087150"><a href="/gostd/net/http/header.go.html#4126491">Set</a></span><span class="op" id="4087153">(</span><span class="string" id="4087154">&#34;Authorization&#34;</span><span class="op" id="4087169">,</span>&nbsp;<span class="string" id="4087171">&#34;Basic&nbsp;&#34;</span><span class="op" id="4087179">+</span><span class="ident" id="4087180"><a href="/gostd/net/http/client.go.html#4087681">basicAuth</a></span><span class="op" id="4087189">(</span><span class="ident" id="4087190"><a href="/gostd/net/http/client.go.html#4087082">username</a></span><span class="op" id="4087198">,</span>&nbsp;<span class="ident" id="4087200"><a href="/gostd/net/http/client.go.html#4087109">password</a></span><span class="op" id="4087208">)</span><span class="op" id="4087209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087215"><a href="/gostd/net/http/client.go.html#4086449">resp</a></span><span class="op" id="4087219">,</span>&nbsp;<span class="ident" id="4087221"><a href="/gostd/net/http/client.go.html#4086465">err</a></span>&nbsp;<span class="op" id="4087225">=</span>&nbsp;<span class="ident" id="4087227"><a href="/gostd/net/http/client.go.html#4086432">t</a></span><span class="op" id="4087228">.</span><span class="ident" id="4087229"><a href="/gostd/net/http/client.go.html#4083357">RoundTrip</a></span><span class="op" id="4087238">(</span><span class="ident" id="4087239"><a href="/gostd/net/http/client.go.html#4086418">req</a></span><span class="op" id="4087242">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087245">if</span>&nbsp;<span class="ident" id="4087248"><a href="/gostd/net/http/client.go.html#4086465">err</a></span>&nbsp;<span class="op" id="4087252">!=</span>&nbsp;<span class="builtintype" id="4087255">nil</span>&nbsp;<span class="op" id="4087259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087263">if</span>&nbsp;<span class="ident" id="4087266"><a href="/gostd/net/http/client.go.html#4086449">resp</a></span>&nbsp;<span class="op" id="4087271">!=</span>&nbsp;<span class="builtintype" id="4087274">nil</span>&nbsp;<span class="op" id="4087278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087283"><a href="/gostd/net/http/client.go.html#4080264">log</a></span><span class="op" id="4087286">.</span><span class="ident" id="4087287"><a href="/gostd/log/log.go.html#4078664">Printf</a></span><span class="op" id="4087293">(</span><span class="string" id="4087294">&#34;RoundTripper&nbsp;returned&nbsp;a&nbsp;response&nbsp;&amp;&nbsp;error;&nbsp;ignoring&nbsp;response&#34;</span><span class="op" id="4087355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087363">return</span>&nbsp;<span class="builtintype" id="4087370">nil</span><span class="op" id="4087373">,</span>&nbsp;<span class="ident" id="4087375"><a href="/gostd/net/http/client.go.html#4086465">err</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087383">return</span>&nbsp;<span class="ident" id="4087390"><a href="/gostd/net/http/client.go.html#4086449">resp</a></span><span class="op" id="4087394">,</span>&nbsp;<span class="builtintype" id="4087396">nil</span><br>
<span class="lineno"></span><span class="op" id="4087400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087403">//&nbsp;See&nbsp;2&nbsp;(end&nbsp;of&nbsp;page&nbsp;4)&nbsp;http://www.ietf.org/rfc/rfc2617.txt</span><br>
<span class="lineno">230</span><span class="comment" id="4087464">//&nbsp;&#34;To&nbsp;receive&nbsp;authorization,&nbsp;the&nbsp;client&nbsp;sends&nbsp;the&nbsp;userid&nbsp;and&nbsp;password,</span><br>
<span class="lineno"></span><span class="comment" id="4087536">//&nbsp;separated&nbsp;by&nbsp;a&nbsp;single&nbsp;colon&nbsp;(&#34;:&#34;)&nbsp;character,&nbsp;within&nbsp;a&nbsp;base64</span><br>
<span class="lineno"></span><span class="comment" id="4087600">//&nbsp;encoded&nbsp;string&nbsp;in&nbsp;the&nbsp;credentials.&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4087639">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;urlencoded.</span><br>
<span class="lineno"></span><span class="keyword" id="4087676">func</span>&nbsp;<span class="ident" id="4087681">basicAuth</span><span class="op" id="4087690">(</span><span class="ident" id="4087691">username</span><span class="op" id="4087699">,</span>&nbsp;<span class="ident" id="4087701">password</span>&nbsp;<span class="builtintype" id="4087710">string</span><span class="op" id="4087716">)</span>&nbsp;<span class="builtintype" id="4087718">string</span>&nbsp;<span class="op" id="4087725">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087728">auth</span>&nbsp;<span class="op" id="4087733">:=</span>&nbsp;<span class="ident" id="4087736"><a href="/gostd/net/http/client.go.html#4087691">username</a></span>&nbsp;<span class="op" id="4087745">+</span>&nbsp;<span class="string" id="4087747">&#34;:&#34;</span>&nbsp;<span class="op" id="4087751">+</span>&nbsp;<span class="ident" id="4087753"><a href="/gostd/net/http/client.go.html#4087701">password</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087763">return</span>&nbsp;<span class="ident" id="4087770"><a href="/gostd/net/http/client.go.html#4080209">base64</a></span><span class="op" id="4087776">.</span><span class="ident" id="4087777"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4087788">.</span><span class="ident" id="4087789"><a href="/gostd/encoding/base64/base64.go.html#4054475">EncodeToString</a></span><span class="op" id="4087803">(</span><span class="op" id="4087804">[</span><span class="op" id="4087805">]</span><span class="builtintype" id="4087806">byte</span><span class="op" id="4087810">(</span><span class="ident" id="4087811"><a href="/gostd/net/http/client.go.html#4087728">auth</a></span><span class="op" id="4087815">)</span><span class="op" id="4087816">)</span><br>
<span class="lineno"></span><span class="op" id="4087818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087821">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Get&nbsp;utility&nbsp;should</span><br>
<span class="lineno">240</span><span class="comment" id="4087903">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="4087930">func</span>&nbsp;<span class="ident" id="4087935">shouldRedirectGet</span><span class="op" id="4087952">(</span><span class="ident" id="4087953">statusCode</span>&nbsp;<span class="builtintype" id="4087964">int</span><span class="op" id="4087967">)</span>&nbsp;<span class="builtintype" id="4087969">bool</span>&nbsp;<span class="op" id="4087974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087977">switch</span>&nbsp;<span class="ident" id="4087984"><a href="/gostd/net/http/client.go.html#4087953">statusCode</a></span>&nbsp;<span class="op" id="4087995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4087998">case</span>&nbsp;<span class="ident" id="4088003"><a href="/gostd/net/http/status.go.html#4236480">StatusMovedPermanently</a></span><span class="op" id="4088025">,</span>&nbsp;<span class="ident" id="4088027"><a href="/gostd/net/http/status.go.html#4236511">StatusFound</a></span><span class="op" id="4088038">,</span>&nbsp;<span class="ident" id="4088040"><a href="/gostd/net/http/status.go.html#4236542">StatusSeeOther</a></span><span class="op" id="4088054">,</span>&nbsp;<span class="ident" id="4088056"><a href="/gostd/net/http/status.go.html#4236635">StatusTemporaryRedirect</a></span><span class="op" id="4088079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088083">return</span>&nbsp;<span class="builtintype" id="4088090">true</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4088096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088099">return</span>&nbsp;<span class="builtintype" id="4088106">false</span><br>
<span class="lineno"></span><span class="op" id="4088112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088115">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Post&nbsp;utility&nbsp;should</span><br>
<span class="lineno">250</span><span class="comment" id="4088198">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="4088225">func</span>&nbsp;<span class="ident" id="4088230">shouldRedirectPost</span><span class="op" id="4088248">(</span><span class="ident" id="4088249">statusCode</span>&nbsp;<span class="builtintype" id="4088260">int</span><span class="op" id="4088263">)</span>&nbsp;<span class="builtintype" id="4088265">bool</span>&nbsp;<span class="op" id="4088270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088273">switch</span>&nbsp;<span class="ident" id="4088280"><a href="/gostd/net/http/client.go.html#4088249">statusCode</a></span>&nbsp;<span class="op" id="4088291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088294">case</span>&nbsp;<span class="ident" id="4088299"><a href="/gostd/net/http/status.go.html#4236511">StatusFound</a></span><span class="op" id="4088310">,</span>&nbsp;<span class="ident" id="4088312"><a href="/gostd/net/http/status.go.html#4236542">StatusSeeOther</a></span><span class="op" id="4088326">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088330">return</span>&nbsp;<span class="builtintype" id="4088337">true</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4088343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088346">return</span>&nbsp;<span class="builtintype" id="4088353">false</span><br>
<span class="lineno"></span><span class="op" id="4088359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088362">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following</span><br>
<span class="lineno">260</span><span class="comment" id="4088445">//&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect,&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;10&nbsp;redirects:</span><br>
<span class="lineno"></span><span class="comment" id="4088523">//</span><br>
<span class="lineno"></span><span class="comment" id="4088526">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="4088556">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="4088574">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">265</span><span class="comment" id="4088596">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="4088627">//</span><br>
<span class="lineno"></span><span class="comment" id="4088630">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;there&nbsp;were&nbsp;too&nbsp;many&nbsp;redirects&nbsp;or&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span><span class="comment" id="4088699">//&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4088766">//&nbsp;error.</span><br>
<span class="lineno">270</span><span class="comment" id="4088776">//</span><br>
<span class="lineno"></span><span class="comment" id="4088779">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="4088841">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4088901">//</span><br>
<span class="lineno"></span><span class="comment" id="4088904">//&nbsp;Get&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Get.</span><br>
<span class="lineno">275</span><span class="keyword" id="4088950">func</span>&nbsp;<span class="ident" id="4088955">Get</span><span class="op" id="4088958">(</span><span class="ident" id="4088959">url</span>&nbsp;<span class="builtintype" id="4088963">string</span><span class="op" id="4088969">)</span>&nbsp;<span class="op" id="4088971">(</span><span class="ident" id="4088972">resp</span>&nbsp;<span class="op" id="4088977">*</span><span class="ident" id="4088978"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4088986">,</span>&nbsp;<span class="ident" id="4088988">err</span>&nbsp;<span class="builtintype" id="4088992">error</span><span class="op" id="4088997">)</span>&nbsp;<span class="op" id="4088999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089002">return</span>&nbsp;<span class="ident" id="4089009"><a href="/gostd/net/http/client.go.html#4082381">DefaultClient</a></span><span class="op" id="4089022">.</span><span class="ident" id="4089023"><a href="/gostd/net/http/client.go.html#4089623">Get</a></span><span class="op" id="4089026">(</span><span class="ident" id="4089027"><a href="/gostd/net/http/client.go.html#4088959">url</a></span><span class="op" id="4089030">)</span><br>
<span class="lineno"></span><span class="op" id="4089032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089035">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">280</span><span class="comment" id="4089108">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4089180">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="4089216">//</span><br>
<span class="lineno"></span><span class="comment" id="4089219">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="4089249">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">285</span><span class="comment" id="4089267">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="4089289">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="4089320">//</span><br>
<span class="lineno"></span><span class="comment" id="4089323">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;the&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="4089392">//&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t</span><br>
<span class="lineno">290</span><span class="comment" id="4089462">//&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4089481">//</span><br>
<span class="lineno"></span><span class="comment" id="4089484">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="4089546">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4089606">func</span>&nbsp;<span class="op" id="4089611">(</span><span class="ident" id="4089612">c</span>&nbsp;<span class="op" id="4089614">*</span><span class="ident" id="4089615"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4089621">)</span>&nbsp;<span class="ident" id="4089623">Get</span><span class="op" id="4089626">(</span><span class="ident" id="4089627">url</span>&nbsp;<span class="builtintype" id="4089631">string</span><span class="op" id="4089637">)</span>&nbsp;<span class="op" id="4089639">(</span><span class="ident" id="4089640">resp</span>&nbsp;<span class="op" id="4089645">*</span><span class="ident" id="4089646"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4089654">,</span>&nbsp;<span class="ident" id="4089656">err</span>&nbsp;<span class="builtintype" id="4089660">error</span><span class="op" id="4089665">)</span>&nbsp;<span class="op" id="4089667">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4089670">req</span><span class="op" id="4089673">,</span>&nbsp;<span class="ident" id="4089675"><a href="/gostd/net/http/client.go.html#4089656">err</a></span>&nbsp;<span class="op" id="4089679">:=</span>&nbsp;<span class="ident" id="4089682"><a href="/gostd/net/http/request.go.html#4149529">NewRequest</a></span><span class="op" id="4089692">(</span><span class="string" id="4089693">&#34;GET&#34;</span><span class="op" id="4089698">,</span>&nbsp;<span class="ident" id="4089700"><a href="/gostd/net/http/client.go.html#4089627">url</a></span><span class="op" id="4089703">,</span>&nbsp;<span class="builtintype" id="4089705">nil</span><span class="op" id="4089708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089711">if</span>&nbsp;<span class="ident" id="4089714"><a href="/gostd/net/http/client.go.html#4089656">err</a></span>&nbsp;<span class="op" id="4089718">!=</span>&nbsp;<span class="builtintype" id="4089721">nil</span>&nbsp;<span class="op" id="4089725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089729">return</span>&nbsp;<span class="builtintype" id="4089736">nil</span><span class="op" id="4089739">,</span>&nbsp;<span class="ident" id="4089741"><a href="/gostd/net/http/client.go.html#4089656">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4089746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089749">return</span>&nbsp;<span class="ident" id="4089756"><a href="/gostd/net/http/client.go.html#4089612">c</a></span><span class="op" id="4089757">.</span><span class="ident" id="4089758"><a href="/gostd/net/http/client.go.html#4089823">doFollowingRedirects</a></span><span class="op" id="4089778">(</span><span class="ident" id="4089779"><a href="/gostd/net/http/client.go.html#4089670">req</a></span><span class="op" id="4089782">,</span>&nbsp;<span class="ident" id="4089784"><a href="/gostd/net/http/client.go.html#4087935">shouldRedirectGet</a></span><span class="op" id="4089801">)</span><br>
<span class="lineno">300</span><span class="op" id="4089803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4089806">func</span>&nbsp;<span class="op" id="4089811">(</span><span class="ident" id="4089812">c</span>&nbsp;<span class="op" id="4089814">*</span><span class="ident" id="4089815"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4089821">)</span>&nbsp;<span class="ident" id="4089823">doFollowingRedirects</span><span class="op" id="4089843">(</span><span class="ident" id="4089844">ireq</span>&nbsp;<span class="op" id="4089849">*</span><span class="ident" id="4089850"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4089857">,</span>&nbsp;<span class="ident" id="4089859">shouldRedirect</span>&nbsp;<span class="keyword" id="4089874">func</span><span class="op" id="4089878">(</span><span class="builtintype" id="4089879">int</span><span class="op" id="4089882">)</span>&nbsp;<span class="builtintype" id="4089884">bool</span><span class="op" id="4089888">)</span>&nbsp;<span class="op" id="4089890">(</span><span class="ident" id="4089891">resp</span>&nbsp;<span class="op" id="4089896">*</span><span class="ident" id="4089897"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4089905">,</span>&nbsp;<span class="ident" id="4089907">err</span>&nbsp;<span class="builtintype" id="4089911">error</span><span class="op" id="4089916">)</span>&nbsp;<span class="op" id="4089918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089921">var</span>&nbsp;<span class="ident" id="4089925">base</span>&nbsp;<span class="op" id="4089930">*</span><span class="ident" id="4089931"><a href="/gostd/net/http/client.go.html#4080271">url</a></span><span class="op" id="4089934">.</span><span class="ident" id="4089935"><a href="/gostd/net/url/url.go.html#3751194">URL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4089940">redirectChecker</span>&nbsp;<span class="op" id="4089956">:=</span>&nbsp;<span class="ident" id="4089959"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4089960">.</span><span class="ident" id="4089961"><a href="/gostd/net/http/client.go.html#4081521">CheckRedirect</a></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4089976">if</span>&nbsp;<span class="ident" id="4089979"><a href="/gostd/net/http/client.go.html#4089940">redirectChecker</a></span>&nbsp;<span class="op" id="4089995">==</span>&nbsp;<span class="builtintype" id="4089998">nil</span>&nbsp;<span class="op" id="4090002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090006"><a href="/gostd/net/http/client.go.html#4089940">redirectChecker</a></span>&nbsp;<span class="op" id="4090022">=</span>&nbsp;<span class="ident" id="4090024"><a href="/gostd/net/http/client.go.html#4092569">defaultCheckRedirect</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090049">var</span>&nbsp;<span class="ident" id="4090053">via</span>&nbsp;<span class="op" id="4090057">[</span><span class="op" id="4090058">]</span><span class="op" id="4090059">*</span><span class="ident" id="4090060"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090070">if</span>&nbsp;<span class="ident" id="4090073"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4090077">.</span><span class="ident" id="4090078"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span>&nbsp;<span class="op" id="4090082">==</span>&nbsp;<span class="builtintype" id="4090085">nil</span>&nbsp;<span class="op" id="4090089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090093"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4090097">.</span><span class="ident" id="4090098"><a href="/gostd/net/http/request.go.html#4160935">closeBody</a></span><span class="op" id="4090107">(</span><span class="op" id="4090108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090112">return</span>&nbsp;<span class="builtintype" id="4090119">nil</span><span class="op" id="4090122">,</span>&nbsp;<span class="ident" id="4090124"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4090130">.</span><span class="ident" id="4090131"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4090134">(</span><span class="string" id="4090135">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="4090158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090165">var</span>&nbsp;<span class="ident" id="4090169">reqmu</span>&nbsp;<span class="ident" id="4090175"><a href="/gostd/net/http/client.go.html#4080293">sync</a></span><span class="op" id="4090179">.</span><span class="ident" id="4090180"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span>&nbsp;<span class="comment" id="4090186">//&nbsp;guards&nbsp;req</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090201">req</span>&nbsp;<span class="op" id="4090205">:=</span>&nbsp;<span class="ident" id="4090208"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090215">var</span>&nbsp;<span class="ident" id="4090219">timer</span>&nbsp;<span class="op" id="4090225">*</span><span class="ident" id="4090226"><a href="/gostd/net/http/client.go.html#4080301">time</a></span><span class="op" id="4090230">.</span><span class="ident" id="4090231"><a href="/gostd/time/sleep.go.html#2715079">Timer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090238">if</span>&nbsp;<span class="ident" id="4090241"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4090242">.</span><span class="ident" id="4090243"><a href="/gostd/net/http/client.go.html#4082277">Timeout</a></span>&nbsp;<span class="op" id="4090251">&gt;</span>&nbsp;<span class="num" id="4090253">0</span>&nbsp;<span class="op" id="4090255">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090259">type</span>&nbsp;<span class="ident" id="4090264">canceler</span>&nbsp;<span class="keyword" id="4090273">interface</span>&nbsp;<span class="op" id="4090283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090288">CancelRequest</span><span class="op" id="4090301">(</span><span class="op" id="4090302">*</span><span class="ident" id="4090303"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4090310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090318">tr</span><span class="op" id="4090320">,</span>&nbsp;<span class="ident" id="4090322">ok</span>&nbsp;<span class="op" id="4090325">:=</span>&nbsp;<span class="ident" id="4090328"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4090329">.</span><span class="ident" id="4090330"><a href="/gostd/net/http/client.go.html#4086212">transport</a></span><span class="op" id="4090339">(</span><span class="op" id="4090340">)</span><span class="op" id="4090341">.</span><span class="op" id="4090342">(</span><span class="ident" id="4090343"><a href="/gostd/net/http/client.go.html#4090264">canceler</a></span><span class="op" id="4090351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090355">if</span>&nbsp;<span class="op" id="4090358">!</span><span class="ident" id="4090359"><a href="/gostd/net/http/client.go.html#4090322">ok</a></span>&nbsp;<span class="op" id="4090362">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090367">return</span>&nbsp;<span class="builtintype" id="4090374">nil</span><span class="op" id="4090377">,</span>&nbsp;<span class="ident" id="4090379"><a href="/gostd/net/http/client.go.html#4080238">fmt</a></span><span class="op" id="4090382">.</span><span class="ident" id="4090383"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4090389">(</span><span class="string" id="4090390">&#34;net/http:&nbsp;Client&nbsp;Transport&nbsp;of&nbsp;type&nbsp;%T&nbsp;doesn&#39;t&nbsp;support&nbsp;CancelRequest;&nbsp;Timeout&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4090482">,</span>&nbsp;<span class="ident" id="4090484"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4090485">.</span><span class="ident" id="4090486"><a href="/gostd/net/http/client.go.html#4086212">transport</a></span><span class="op" id="4090495">(</span><span class="op" id="4090496">)</span><span class="op" id="4090497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090505"><a href="/gostd/net/http/client.go.html#4090219">timer</a></span>&nbsp;<span class="op" id="4090511">=</span>&nbsp;<span class="ident" id="4090513"><a href="/gostd/net/http/client.go.html#4080301">time</a></span><span class="op" id="4090517">.</span><span class="ident" id="4090518"><a href="/gostd/time/sleep.go.html#2716875">AfterFunc</a></span><span class="op" id="4090527">(</span><span class="ident" id="4090528"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4090529">.</span><span class="ident" id="4090530"><a href="/gostd/net/http/client.go.html#4082277">Timeout</a></span><span class="op" id="4090537">,</span>&nbsp;<span class="keyword" id="4090539">func</span><span class="op" id="4090543">(</span><span class="op" id="4090544">)</span>&nbsp;<span class="op" id="4090546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090551"><a href="/gostd/net/http/client.go.html#4090169">reqmu</a></span><span class="op" id="4090556">.</span><span class="ident" id="4090557"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="4090561">(</span><span class="op" id="4090562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090567">defer</span>&nbsp;<span class="ident" id="4090573"><a href="/gostd/net/http/client.go.html#4090169">reqmu</a></span><span class="op" id="4090578">.</span><span class="ident" id="4090579"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="4090585">(</span><span class="op" id="4090586">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090591"><a href="/gostd/net/http/client.go.html#4090318">tr</a></span><span class="op" id="4090593">.</span><span class="ident" id="4090594"><a href="/gostd/net/http/client.go.html#4090288">CancelRequest</a></span><span class="op" id="4090607">(</span><span class="ident" id="4090608"><a href="/gostd/net/http/client.go.html#4090201">req</a></span><span class="op" id="4090611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090615">}</span><span class="op" id="4090616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090623">urlStr</span>&nbsp;<span class="op" id="4090630">:=</span>&nbsp;<span class="string" id="4090633">&#34;&#34;</span>&nbsp;<span class="comment" id="4090636">//&nbsp;next&nbsp;relative&nbsp;or&nbsp;absolute&nbsp;URL&nbsp;to&nbsp;fetch&nbsp;(after&nbsp;first&nbsp;request)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090701">redirectFailed</span>&nbsp;<span class="op" id="4090716">:=</span>&nbsp;<span class="builtintype" id="4090719">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090726">for</span>&nbsp;<span class="ident" id="4090730">redirect</span>&nbsp;<span class="op" id="4090739">:=</span>&nbsp;<span class="num" id="4090742">0</span><span class="op" id="4090743">;</span>&nbsp;<span class="op" id="4090745">;</span>&nbsp;<span class="ident" id="4090747"><a href="/gostd/net/http/client.go.html#4090730">redirect</a></span><span class="op" id="4090755">++</span>&nbsp;<span class="op" id="4090758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090762">if</span>&nbsp;<span class="ident" id="4090765"><a href="/gostd/net/http/client.go.html#4090730">redirect</a></span>&nbsp;<span class="op" id="4090774">!=</span>&nbsp;<span class="num" id="4090777">0</span>&nbsp;<span class="op" id="4090779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090784">nreq</span>&nbsp;<span class="op" id="4090789">:=</span>&nbsp;<span class="builtinfunc" id="4090792">new</span><span class="op" id="4090795">(</span><span class="ident" id="4090796"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4090803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090808"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4090812">.</span><span class="ident" id="4090813"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4090820">=</span>&nbsp;<span class="ident" id="4090822"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4090826">.</span><span class="ident" id="4090827"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090837">if</span>&nbsp;<span class="ident" id="4090840"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4090844">.</span><span class="ident" id="4090845"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4090852">==</span>&nbsp;<span class="string" id="4090855">&#34;POST&#34;</span>&nbsp;<span class="op" id="4090862">||</span>&nbsp;<span class="ident" id="4090865"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4090869">.</span><span class="ident" id="4090870"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4090877">==</span>&nbsp;<span class="string" id="4090880">&#34;PUT&#34;</span>&nbsp;<span class="op" id="4090886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090892"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4090896">.</span><span class="ident" id="4090897"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span>&nbsp;<span class="op" id="4090904">=</span>&nbsp;<span class="string" id="4090906">&#34;GET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4090915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090920"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4090924">.</span><span class="ident" id="4090925"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span>&nbsp;<span class="op" id="4090932">=</span>&nbsp;<span class="builtinfunc" id="4090934">make</span><span class="op" id="4090938">(</span><span class="ident" id="4090939"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="4090945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4090950"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4090954">.</span><span class="ident" id="4090955"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4090958">,</span>&nbsp;<span class="ident" id="4090960"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4090964">=</span>&nbsp;<span class="ident" id="4090966"><a href="/gostd/net/http/client.go.html#4089925">base</a></span><span class="op" id="4090970">.</span><span class="ident" id="4090971"><a href="/gostd/net/url/url.go.html#3762216">Parse</a></span><span class="op" id="4090976">(</span><span class="ident" id="4090977"><a href="/gostd/net/http/client.go.html#4090623">urlStr</a></span><span class="op" id="4090983">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4090988">if</span>&nbsp;<span class="ident" id="4090991"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4090995">!=</span>&nbsp;<span class="builtintype" id="4090998">nil</span>&nbsp;<span class="op" id="4091002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091008">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091022">if</span>&nbsp;<span class="builtinfunc" id="4091025">len</span><span class="op" id="4091028">(</span><span class="ident" id="4091029"><a href="/gostd/net/http/client.go.html#4090053">via</a></span><span class="op" id="4091032">)</span>&nbsp;<span class="op" id="4091034">&gt;</span>&nbsp;<span class="num" id="4091036">0</span>&nbsp;<span class="op" id="4091038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091044">//&nbsp;Add&nbsp;the&nbsp;Referer&nbsp;header.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091075">lastReq</span>&nbsp;<span class="op" id="4091083">:=</span>&nbsp;<span class="ident" id="4091086"><a href="/gostd/net/http/client.go.html#4090053">via</a></span><span class="op" id="4091089">[</span><span class="builtinfunc" id="4091090">len</span><span class="op" id="4091093">(</span><span class="ident" id="4091094"><a href="/gostd/net/http/client.go.html#4090053">via</a></span><span class="op" id="4091097">)</span><span class="op" id="4091098">-</span><span class="num" id="4091099">1</span><span class="op" id="4091100">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091106">if</span>&nbsp;<span class="ident" id="4091109">ref</span>&nbsp;<span class="op" id="4091113">:=</span>&nbsp;<span class="ident" id="4091116"><a href="/gostd/net/http/client.go.html#4083765">refererForURL</a></span><span class="op" id="4091129">(</span><span class="ident" id="4091130"><a href="/gostd/net/http/client.go.html#4091075">lastReq</a></span><span class="op" id="4091137">.</span><span class="ident" id="4091138"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4091141">,</span>&nbsp;<span class="ident" id="4091143"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4091147">.</span><span class="ident" id="4091148"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4091151">)</span><span class="op" id="4091152">;</span>&nbsp;<span class="ident" id="4091154"><a href="/gostd/net/http/client.go.html#4091109">ref</a></span>&nbsp;<span class="op" id="4091158">!=</span>&nbsp;<span class="string" id="4091161">&#34;&#34;</span>&nbsp;<span class="op" id="4091164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091171"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4091175">.</span><span class="ident" id="4091176"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="4091182">.</span><span class="ident" id="4091183"><a href="/gostd/net/http/header.go.html#4126491">Set</a></span><span class="op" id="4091186">(</span><span class="string" id="4091187">&#34;Referer&#34;</span><span class="op" id="4091196">,</span>&nbsp;<span class="ident" id="4091198"><a href="/gostd/net/http/client.go.html#4091109">ref</a></span><span class="op" id="4091201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091214"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4091218">=</span>&nbsp;<span class="ident" id="4091220"><a href="/gostd/net/http/client.go.html#4089940">redirectChecker</a></span><span class="op" id="4091235">(</span><span class="ident" id="4091236"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><span class="op" id="4091240">,</span>&nbsp;<span class="ident" id="4091242"><a href="/gostd/net/http/client.go.html#4090053">via</a></span><span class="op" id="4091245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091251">if</span>&nbsp;<span class="ident" id="4091254"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4091258">!=</span>&nbsp;<span class="builtintype" id="4091261">nil</span>&nbsp;<span class="op" id="4091265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091272"><a href="/gostd/net/http/client.go.html#4090701">redirectFailed</a></span>&nbsp;<span class="op" id="4091287">=</span>&nbsp;<span class="builtintype" id="4091289">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091299">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091309">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091319"><a href="/gostd/net/http/client.go.html#4090169">reqmu</a></span><span class="op" id="4091324">.</span><span class="ident" id="4091325"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="4091329">(</span><span class="op" id="4091330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091335"><a href="/gostd/net/http/client.go.html#4090201">req</a></span>&nbsp;<span class="op" id="4091339">=</span>&nbsp;<span class="ident" id="4091341"><a href="/gostd/net/http/client.go.html#4090784">nreq</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091349"><a href="/gostd/net/http/client.go.html#4090169">reqmu</a></span><span class="op" id="4091354">.</span><span class="ident" id="4091355"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="4091361">(</span><span class="op" id="4091362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091366">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091371"><a href="/gostd/net/http/client.go.html#4090623">urlStr</a></span>&nbsp;<span class="op" id="4091378">=</span>&nbsp;<span class="ident" id="4091380"><a href="/gostd/net/http/client.go.html#4090201">req</a></span><span class="op" id="4091383">.</span><span class="ident" id="4091384"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="4091387">.</span><span class="ident" id="4091388"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="4091394">(</span><span class="op" id="4091395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091399">if</span>&nbsp;<span class="ident" id="4091402"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091406">,</span>&nbsp;<span class="ident" id="4091408"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4091412">=</span>&nbsp;<span class="ident" id="4091414"><a href="/gostd/net/http/client.go.html#4089812">c</a></span><span class="op" id="4091415">.</span><span class="ident" id="4091416"><a href="/gostd/net/http/client.go.html#4084745">send</a></span><span class="op" id="4091420">(</span><span class="ident" id="4091421"><a href="/gostd/net/http/client.go.html#4090201">req</a></span><span class="op" id="4091424">)</span><span class="op" id="4091425">;</span>&nbsp;<span class="ident" id="4091427"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4091431">!=</span>&nbsp;<span class="builtintype" id="4091434">nil</span>&nbsp;<span class="op" id="4091438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091443">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091451">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091456">if</span>&nbsp;<span class="ident" id="4091459"><a href="/gostd/net/http/client.go.html#4089859">shouldRedirect</a></span><span class="op" id="4091473">(</span><span class="ident" id="4091474"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091478">.</span><span class="ident" id="4091479"><a href="/gostd/net/http/response.go.html#4161564">StatusCode</a></span><span class="op" id="4091489">)</span>&nbsp;<span class="op" id="4091491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091496">//&nbsp;Read&nbsp;the&nbsp;body&nbsp;if&nbsp;small&nbsp;so&nbsp;underlying&nbsp;TCP&nbsp;connection&nbsp;will&nbsp;be&nbsp;re-used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091571">//&nbsp;No&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;errors:&nbsp;if&nbsp;it&nbsp;fails,&nbsp;Transport&nbsp;won&#39;t&nbsp;reuse&nbsp;it&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091652">const</span>&nbsp;<span class="ident" id="4091658">maxBodySlurpSize</span>&nbsp;<span class="op" id="4091675">=</span>&nbsp;<span class="num" id="4091677">2</span>&nbsp;<span class="op" id="4091679">&lt;&lt;</span>&nbsp;<span class="num" id="4091682">10</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091688">if</span>&nbsp;<span class="ident" id="4091691"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091695">.</span><span class="ident" id="4091696"><a href="/gostd/net/http/response.go.html#4162765">ContentLength</a></span>&nbsp;<span class="op" id="4091710">==</span>&nbsp;<span class="op" id="4091713">-</span><span class="num" id="4091714">1</span>&nbsp;<span class="op" id="4091716">||</span>&nbsp;<span class="ident" id="4091719"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091723">.</span><span class="ident" id="4091724"><a href="/gostd/net/http/response.go.html#4162765">ContentLength</a></span>&nbsp;<span class="op" id="4091738">&lt;=</span>&nbsp;<span class="ident" id="4091741"><a href="/gostd/net/http/client.go.html#4091658">maxBodySlurpSize</a></span>&nbsp;<span class="op" id="4091758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091764"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4091766">.</span><span class="ident" id="4091767"><a href="/gostd/io/io.go.html#1430100">CopyN</a></span><span class="op" id="4091772">(</span><span class="ident" id="4091773"><a href="/gostd/net/http/client.go.html#4080251">ioutil</a></span><span class="op" id="4091779">.</span><span class="ident" id="4091780"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="4091787">,</span>&nbsp;<span class="ident" id="4091789"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091793">.</span><span class="ident" id="4091794"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="4091798">,</span>&nbsp;<span class="ident" id="4091800"><a href="/gostd/net/http/client.go.html#4091658">maxBodySlurpSize</a></span><span class="op" id="4091816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091826"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091830">.</span><span class="ident" id="4091831"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="4091835">.</span><span class="ident" id="4091836"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="4091841">(</span><span class="op" id="4091842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091847">if</span>&nbsp;<span class="ident" id="4091850"><a href="/gostd/net/http/client.go.html#4090623">urlStr</a></span>&nbsp;<span class="op" id="4091857">=</span>&nbsp;<span class="ident" id="4091859"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091863">.</span><span class="ident" id="4091864"><a href="/gostd/net/http/response.go.html#4162137">Header</a></span><span class="op" id="4091870">.</span><span class="ident" id="4091871"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="4091874">(</span><span class="string" id="4091875">&#34;Location&#34;</span><span class="op" id="4091885">)</span><span class="op" id="4091886">;</span>&nbsp;<span class="ident" id="4091888"><a href="/gostd/net/http/client.go.html#4090623">urlStr</a></span>&nbsp;<span class="op" id="4091895">==</span>&nbsp;<span class="string" id="4091898">&#34;&#34;</span>&nbsp;<span class="op" id="4091901">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091907"><a href="/gostd/net/http/client.go.html#4089907">err</a></span>&nbsp;<span class="op" id="4091911">=</span>&nbsp;<span class="ident" id="4091913"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4091919">.</span><span class="ident" id="4091920"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4091923">(</span><span class="ident" id="4091924"><a href="/gostd/net/http/client.go.html#4080238">fmt</a></span><span class="op" id="4091927">.</span><span class="ident" id="4091928"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4091935">(</span><span class="string" id="4091936">&#34;%d&nbsp;response&nbsp;missing&nbsp;Location&nbsp;header&#34;</span><span class="op" id="4091973">,</span>&nbsp;<span class="ident" id="4091975"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4091979">.</span><span class="ident" id="4091980"><a href="/gostd/net/http/response.go.html#4161564">StatusCode</a></span><span class="op" id="4091990">)</span><span class="op" id="4091991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091997">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092011"><a href="/gostd/net/http/client.go.html#4089925">base</a></span>&nbsp;<span class="op" id="4092016">=</span>&nbsp;<span class="ident" id="4092018"><a href="/gostd/net/http/client.go.html#4090201">req</a></span><span class="op" id="4092021">.</span><span class="ident" id="4092022"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092029"><a href="/gostd/net/http/client.go.html#4090053">via</a></span>&nbsp;<span class="op" id="4092033">=</span>&nbsp;<span class="builtinfunc" id="4092035">append</span><span class="op" id="4092041">(</span><span class="ident" id="4092042"><a href="/gostd/net/http/client.go.html#4090053">via</a></span><span class="op" id="4092045">,</span>&nbsp;<span class="ident" id="4092047"><a href="/gostd/net/http/client.go.html#4090201">req</a></span><span class="op" id="4092050">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092055">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092070">if</span>&nbsp;<span class="ident" id="4092073"><a href="/gostd/net/http/client.go.html#4090219">timer</a></span>&nbsp;<span class="op" id="4092079">!=</span>&nbsp;<span class="builtintype" id="4092082">nil</span>&nbsp;<span class="op" id="4092086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092091"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4092095">.</span><span class="ident" id="4092096"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span>&nbsp;<span class="op" id="4092101">=</span>&nbsp;<span class="op" id="4092103">&amp;</span><span class="ident" id="4092104"><a href="/gostd/net/http/client.go.html#4095228">cancelTimerBody</a></span><span class="op" id="4092119">{</span><span class="ident" id="4092120"><a href="/gostd/net/http/client.go.html#4090219">timer</a></span><span class="op" id="4092125">,</span>&nbsp;<span class="ident" id="4092127"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4092131">.</span><span class="ident" id="4092132"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="4092136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092140">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092144">return</span>&nbsp;<span class="ident" id="4092151"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4092155">,</span>&nbsp;<span class="builtintype" id="4092157">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092166">method</span>&nbsp;<span class="op" id="4092173">:=</span>&nbsp;<span class="ident" id="4092176"><a href="/gostd/net/http/client.go.html#4089844">ireq</a></span><span class="op" id="4092180">.</span><span class="ident" id="4092181"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092189">urlErr</span>&nbsp;<span class="op" id="4092196">:=</span>&nbsp;<span class="op" id="4092199">&amp;</span><span class="ident" id="4092200"><a href="/gostd/net/http/client.go.html#4080271">url</a></span><span class="op" id="4092203">.</span><span class="ident" id="4092204"><a href="/gostd/net/url/url.go.html#3746062">Error</a></span><span class="op" id="4092209">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092213"><a href="/gostd/net/url/url.go.html#3746078">Op</a></span><span class="op" id="4092215">:</span>&nbsp;&nbsp;<span class="ident" id="4092218"><a href="/gostd/net/http/client.go.html#4092166">method</a></span><span class="op" id="4092224">[</span><span class="num" id="4092225">0</span><span class="op" id="4092226">:</span><span class="num" id="4092227">1</span><span class="op" id="4092228">]</span>&nbsp;<span class="op" id="4092230">+</span>&nbsp;<span class="ident" id="4092232"><a href="/gostd/net/http/client.go.html#4080282">strings</a></span><span class="op" id="4092239">.</span><span class="ident" id="4092240"><a href="/gostd/strings/strings.go.html#2977307">ToLower</a></span><span class="op" id="4092247">(</span><span class="ident" id="4092248"><a href="/gostd/net/http/client.go.html#4092166">method</a></span><span class="op" id="4092254">[</span><span class="num" id="4092255">1</span><span class="op" id="4092256">:</span><span class="op" id="4092257">]</span><span class="op" id="4092258">)</span><span class="op" id="4092259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092263"><a href="/gostd/net/url/url.go.html#3746090">URL</a></span><span class="op" id="4092266">:</span>&nbsp;<span class="ident" id="4092268"><a href="/gostd/net/http/client.go.html#4090623">urlStr</a></span><span class="op" id="4092274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092278"><a href="/gostd/net/url/url.go.html#3746102">Err</a></span><span class="op" id="4092281">:</span>&nbsp;<span class="ident" id="4092283"><a href="/gostd/net/http/client.go.html#4089907">err</a></span><span class="op" id="4092286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092293">if</span>&nbsp;<span class="ident" id="4092296"><a href="/gostd/net/http/client.go.html#4090701">redirectFailed</a></span>&nbsp;<span class="op" id="4092311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4092315">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;Go&nbsp;1&nbsp;compatibility:&nbsp;return&nbsp;both&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4092382">//&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;CheckRedirect&nbsp;function&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4092438">//&nbsp;See&nbsp;http://golang.org/issue/3795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092476">return</span>&nbsp;<span class="ident" id="4092483"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4092487">,</span>&nbsp;<span class="ident" id="4092489"><a href="/gostd/net/http/client.go.html#4092189">urlErr</a></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092501">if</span>&nbsp;<span class="ident" id="4092504"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span>&nbsp;<span class="op" id="4092509">!=</span>&nbsp;<span class="builtintype" id="4092512">nil</span>&nbsp;<span class="op" id="4092516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092520"><a href="/gostd/net/http/client.go.html#4089891">resp</a></span><span class="op" id="4092524">.</span><span class="ident" id="4092525"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="4092529">.</span><span class="ident" id="4092530"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="4092535">(</span><span class="op" id="4092536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092539">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092542">return</span>&nbsp;<span class="builtintype" id="4092549">nil</span><span class="op" id="4092552">,</span>&nbsp;<span class="ident" id="4092554"><a href="/gostd/net/http/client.go.html#4092189">urlErr</a></span><br>
<span class="lineno"></span><span class="op" id="4092561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4092564">func</span>&nbsp;<span class="ident" id="4092569">defaultCheckRedirect</span><span class="op" id="4092589">(</span><span class="ident" id="4092590">req</span>&nbsp;<span class="op" id="4092594">*</span><span class="ident" id="4092595"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4092602">,</span>&nbsp;<span class="ident" id="4092604">via</span>&nbsp;<span class="op" id="4092608">[</span><span class="op" id="4092609">]</span><span class="op" id="4092610">*</span><span class="ident" id="4092611"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4092618">)</span>&nbsp;<span class="builtintype" id="4092620">error</span>&nbsp;<span class="op" id="4092626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092629">if</span>&nbsp;<span class="builtinfunc" id="4092632">len</span><span class="op" id="4092635">(</span><span class="ident" id="4092636"><a href="/gostd/net/http/client.go.html#4092604">via</a></span><span class="op" id="4092639">)</span>&nbsp;<span class="op" id="4092641">&gt;=</span>&nbsp;<span class="num" id="4092644">10</span>&nbsp;<span class="op" id="4092647">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092651">return</span>&nbsp;<span class="ident" id="4092658"><a href="/gostd/net/http/client.go.html#4080228">errors</a></span><span class="op" id="4092664">.</span><span class="ident" id="4092665"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4092668">(</span><span class="string" id="4092669">&#34;stopped&nbsp;after&nbsp;10&nbsp;redirects&#34;</span><span class="op" id="4092697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092703">return</span>&nbsp;<span class="builtintype" id="4092710">nil</span><br>
<span class="lineno"></span><span class="op" id="4092714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="4092717">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno"></span><span class="comment" id="4092761">//</span><br>
<span class="lineno"></span><span class="comment" id="4092764">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4092824">//</span><br>
<span class="lineno"></span><span class="comment" id="4092827">//&nbsp;Post&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Post</span><br>
<span class="lineno">425</span><span class="keyword" id="4092874">func</span>&nbsp;<span class="ident" id="4092879">Post</span><span class="op" id="4092883">(</span><span class="ident" id="4092884">url</span>&nbsp;<span class="builtintype" id="4092888">string</span><span class="op" id="4092894">,</span>&nbsp;<span class="ident" id="4092896">bodyType</span>&nbsp;<span class="builtintype" id="4092905">string</span><span class="op" id="4092911">,</span>&nbsp;<span class="ident" id="4092913">body</span>&nbsp;<span class="ident" id="4092918"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4092920">.</span><span class="ident" id="4092921"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4092927">)</span>&nbsp;<span class="op" id="4092929">(</span><span class="ident" id="4092930">resp</span>&nbsp;<span class="op" id="4092935">*</span><span class="ident" id="4092936"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4092944">,</span>&nbsp;<span class="ident" id="4092946">err</span>&nbsp;<span class="builtintype" id="4092950">error</span><span class="op" id="4092955">)</span>&nbsp;<span class="op" id="4092957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092960">return</span>&nbsp;<span class="ident" id="4092967"><a href="/gostd/net/http/client.go.html#4082381">DefaultClient</a></span><span class="op" id="4092980">.</span><span class="ident" id="4092981"><a href="/gostd/net/http/client.go.html#4093218">Post</a></span><span class="op" id="4092985">(</span><span class="ident" id="4092986"><a href="/gostd/net/http/client.go.html#4092884">url</a></span><span class="op" id="4092989">,</span>&nbsp;<span class="ident" id="4092991"><a href="/gostd/net/http/client.go.html#4092896">bodyType</a></span><span class="op" id="4092999">,</span>&nbsp;<span class="ident" id="4093001"><a href="/gostd/net/http/client.go.html#4092913">body</a></span><span class="op" id="4093005">)</span><br>
<span class="lineno"></span><span class="op" id="4093007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093010">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno">430</span><span class="comment" id="4093054">//</span><br>
<span class="lineno"></span><span class="comment" id="4093057">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4093117">//</span><br>
<span class="lineno"></span><span class="comment" id="4093120">//&nbsp;If&nbsp;the&nbsp;provided&nbsp;body&nbsp;is&nbsp;also&nbsp;an&nbsp;io.Closer,&nbsp;it&nbsp;is&nbsp;closed&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4093189">//&nbsp;request.</span><br>
<span class="lineno">435</span><span class="keyword" id="4093201">func</span>&nbsp;<span class="op" id="4093206">(</span><span class="ident" id="4093207">c</span>&nbsp;<span class="op" id="4093209">*</span><span class="ident" id="4093210"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4093216">)</span>&nbsp;<span class="ident" id="4093218">Post</span><span class="op" id="4093222">(</span><span class="ident" id="4093223">url</span>&nbsp;<span class="builtintype" id="4093227">string</span><span class="op" id="4093233">,</span>&nbsp;<span class="ident" id="4093235">bodyType</span>&nbsp;<span class="builtintype" id="4093244">string</span><span class="op" id="4093250">,</span>&nbsp;<span class="ident" id="4093252">body</span>&nbsp;<span class="ident" id="4093257"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4093259">.</span><span class="ident" id="4093260"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4093266">)</span>&nbsp;<span class="op" id="4093268">(</span><span class="ident" id="4093269">resp</span>&nbsp;<span class="op" id="4093274">*</span><span class="ident" id="4093275"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4093283">,</span>&nbsp;<span class="ident" id="4093285">err</span>&nbsp;<span class="builtintype" id="4093289">error</span><span class="op" id="4093294">)</span>&nbsp;<span class="op" id="4093296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093299">req</span><span class="op" id="4093302">,</span>&nbsp;<span class="ident" id="4093304"><a href="/gostd/net/http/client.go.html#4093285">err</a></span>&nbsp;<span class="op" id="4093308">:=</span>&nbsp;<span class="ident" id="4093311"><a href="/gostd/net/http/request.go.html#4149529">NewRequest</a></span><span class="op" id="4093321">(</span><span class="string" id="4093322">&#34;POST&#34;</span><span class="op" id="4093328">,</span>&nbsp;<span class="ident" id="4093330"><a href="/gostd/net/http/client.go.html#4093223">url</a></span><span class="op" id="4093333">,</span>&nbsp;<span class="ident" id="4093335"><a href="/gostd/net/http/client.go.html#4093252">body</a></span><span class="op" id="4093339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093342">if</span>&nbsp;<span class="ident" id="4093345"><a href="/gostd/net/http/client.go.html#4093285">err</a></span>&nbsp;<span class="op" id="4093349">!=</span>&nbsp;<span class="builtintype" id="4093352">nil</span>&nbsp;<span class="op" id="4093356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093360">return</span>&nbsp;<span class="builtintype" id="4093367">nil</span><span class="op" id="4093370">,</span>&nbsp;<span class="ident" id="4093372"><a href="/gostd/net/http/client.go.html#4093285">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093377">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093380"><a href="/gostd/net/http/client.go.html#4093299">req</a></span><span class="op" id="4093383">.</span><span class="ident" id="4093384"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="4093390">.</span><span class="ident" id="4093391"><a href="/gostd/net/http/header.go.html#4126491">Set</a></span><span class="op" id="4093394">(</span><span class="string" id="4093395">&#34;Content-Type&#34;</span><span class="op" id="4093409">,</span>&nbsp;<span class="ident" id="4093411"><a href="/gostd/net/http/client.go.html#4093235">bodyType</a></span><span class="op" id="4093419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093422">return</span>&nbsp;<span class="ident" id="4093429"><a href="/gostd/net/http/client.go.html#4093207">c</a></span><span class="op" id="4093430">.</span><span class="ident" id="4093431"><a href="/gostd/net/http/client.go.html#4089823">doFollowingRedirects</a></span><span class="op" id="4093451">(</span><span class="ident" id="4093452"><a href="/gostd/net/http/client.go.html#4093299">req</a></span><span class="op" id="4093455">,</span>&nbsp;<span class="ident" id="4093457"><a href="/gostd/net/http/client.go.html#4088230">shouldRedirectPost</a></span><span class="op" id="4093475">)</span><br>
<span class="lineno"></span><span class="op" id="4093477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093480">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and</span><br>
<span class="lineno">445</span><span class="comment" id="4093549">//&nbsp;values&nbsp;URL-encoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="4093592">//</span><br>
<span class="lineno"></span><span class="comment" id="4093595">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="4093657">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4093717">//</span><br>
<span class="lineno">450</span><span class="comment" id="4093720">//&nbsp;PostForm&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.PostForm</span><br>
<span class="lineno"></span><span class="keyword" id="4093775">func</span>&nbsp;<span class="ident" id="4093780">PostForm</span><span class="op" id="4093788">(</span><span class="ident" id="4093789">url</span>&nbsp;<span class="builtintype" id="4093793">string</span><span class="op" id="4093799">,</span>&nbsp;<span class="ident" id="4093801">data</span>&nbsp;<span class="ident" id="4093806"><a href="/gostd/net/http/client.go.html#4080271">url</a></span><span class="op" id="4093809">.</span><span class="ident" id="4093810"><a href="/gostd/net/url/url.go.html#3758861">Values</a></span><span class="op" id="4093816">)</span>&nbsp;<span class="op" id="4093818">(</span><span class="ident" id="4093819">resp</span>&nbsp;<span class="op" id="4093824">*</span><span class="ident" id="4093825"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4093833">,</span>&nbsp;<span class="ident" id="4093835">err</span>&nbsp;<span class="builtintype" id="4093839">error</span><span class="op" id="4093844">)</span>&nbsp;<span class="op" id="4093846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093849">return</span>&nbsp;<span class="ident" id="4093856"><a href="/gostd/net/http/client.go.html#4082381">DefaultClient</a></span><span class="op" id="4093869">.</span><span class="ident" id="4093870"><a href="/gostd/net/http/client.go.html#4094146">PostForm</a></span><span class="op" id="4093878">(</span><span class="ident" id="4093879"><a href="/gostd/net/http/client.go.html#4093789">url</a></span><span class="op" id="4093882">,</span>&nbsp;<span class="ident" id="4093884"><a href="/gostd/net/http/client.go.html#4093801">data</a></span><span class="op" id="4093888">)</span><br>
<span class="lineno"></span><span class="op" id="4093890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="4093893">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,</span><br>
<span class="lineno"></span><span class="comment" id="4093941">//&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and&nbsp;values&nbsp;urlencoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="4094004">//</span><br>
<span class="lineno"></span><span class="comment" id="4094007">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="4094069">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno">460</span><span class="keyword" id="4094129">func</span>&nbsp;<span class="op" id="4094134">(</span><span class="ident" id="4094135">c</span>&nbsp;<span class="op" id="4094137">*</span><span class="ident" id="4094138"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4094144">)</span>&nbsp;<span class="ident" id="4094146">PostForm</span><span class="op" id="4094154">(</span><span class="ident" id="4094155">url</span>&nbsp;<span class="builtintype" id="4094159">string</span><span class="op" id="4094165">,</span>&nbsp;<span class="ident" id="4094167">data</span>&nbsp;<span class="ident" id="4094172"><a href="/gostd/net/http/client.go.html#4080271">url</a></span><span class="op" id="4094175">.</span><span class="ident" id="4094176"><a href="/gostd/net/url/url.go.html#3758861">Values</a></span><span class="op" id="4094182">)</span>&nbsp;<span class="op" id="4094184">(</span><span class="ident" id="4094185">resp</span>&nbsp;<span class="op" id="4094190">*</span><span class="ident" id="4094191"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4094199">,</span>&nbsp;<span class="ident" id="4094201">err</span>&nbsp;<span class="builtintype" id="4094205">error</span><span class="op" id="4094210">)</span>&nbsp;<span class="op" id="4094212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094215">return</span>&nbsp;<span class="ident" id="4094222"><a href="/gostd/net/http/client.go.html#4094135">c</a></span><span class="op" id="4094223">.</span><span class="ident" id="4094224"><a href="/gostd/net/http/client.go.html#4093218">Post</a></span><span class="op" id="4094228">(</span><span class="ident" id="4094229"><a href="/gostd/net/http/client.go.html#4094155">url</a></span><span class="op" id="4094232">,</span>&nbsp;<span class="string" id="4094234">&#34;application/x-www-form-urlencoded&#34;</span><span class="op" id="4094269">,</span>&nbsp;<span class="ident" id="4094271"><a href="/gostd/net/http/client.go.html#4080282">strings</a></span><span class="op" id="4094278">.</span><span class="ident" id="4094279"><a href="/gostd/strings/reader.go.html#2948317">NewReader</a></span><span class="op" id="4094288">(</span><span class="ident" id="4094289"><a href="/gostd/net/http/client.go.html#4094167">data</a></span><span class="op" id="4094293">.</span><span class="ident" id="4094294"><a href="/gostd/net/url/url.go.html#3760724">Encode</a></span><span class="op" id="4094300">(</span><span class="op" id="4094301">)</span><span class="op" id="4094302">)</span><span class="op" id="4094303">)</span><br>
<span class="lineno"></span><span class="op" id="4094305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094308">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="4094383">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4094456">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="4094492">//</span><br>
<span class="lineno"></span><span class="comment" id="4094495">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="4094525">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">470</span><span class="comment" id="4094543">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="4094565">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="4094596">//</span><br>
<span class="lineno"></span><span class="comment" id="4094599">//&nbsp;Head&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Head</span><br>
<span class="lineno"></span><span class="keyword" id="4094646">func</span>&nbsp;<span class="ident" id="4094651">Head</span><span class="op" id="4094655">(</span><span class="ident" id="4094656">url</span>&nbsp;<span class="builtintype" id="4094660">string</span><span class="op" id="4094666">)</span>&nbsp;<span class="op" id="4094668">(</span><span class="ident" id="4094669">resp</span>&nbsp;<span class="op" id="4094674">*</span><span class="ident" id="4094675"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4094683">,</span>&nbsp;<span class="ident" id="4094685">err</span>&nbsp;<span class="builtintype" id="4094689">error</span><span class="op" id="4094694">)</span>&nbsp;<span class="op" id="4094696">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094699">return</span>&nbsp;<span class="ident" id="4094706"><a href="/gostd/net/http/client.go.html#4082381">DefaultClient</a></span><span class="op" id="4094719">.</span><span class="ident" id="4094720"><a href="/gostd/net/http/client.go.html#4095038">Head</a></span><span class="op" id="4094724">(</span><span class="ident" id="4094725"><a href="/gostd/net/http/client.go.html#4094656">url</a></span><span class="op" id="4094728">)</span><br>
<span class="lineno"></span><span class="op" id="4094730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094733">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4094808">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="4094881">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="4094917">//</span><br>
<span class="lineno"></span><span class="comment" id="4094920">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="4094950">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="4094968">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">485</span><span class="comment" id="4094990">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="keyword" id="4095021">func</span>&nbsp;<span class="op" id="4095026">(</span><span class="ident" id="4095027">c</span>&nbsp;<span class="op" id="4095029">*</span><span class="ident" id="4095030"><a href="/gostd/net/http/client.go.html#4080782">Client</a></span><span class="op" id="4095036">)</span>&nbsp;<span class="ident" id="4095038">Head</span><span class="op" id="4095042">(</span><span class="ident" id="4095043">url</span>&nbsp;<span class="builtintype" id="4095047">string</span><span class="op" id="4095053">)</span>&nbsp;<span class="op" id="4095055">(</span><span class="ident" id="4095056">resp</span>&nbsp;<span class="op" id="4095061">*</span><span class="ident" id="4095062"><a href="/gostd/net/http/response.go.html#4161509">Response</a></span><span class="op" id="4095070">,</span>&nbsp;<span class="ident" id="4095072">err</span>&nbsp;<span class="builtintype" id="4095076">error</span><span class="op" id="4095081">)</span>&nbsp;<span class="op" id="4095083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095086">req</span><span class="op" id="4095089">,</span>&nbsp;<span class="ident" id="4095091"><a href="/gostd/net/http/client.go.html#4095072">err</a></span>&nbsp;<span class="op" id="4095095">:=</span>&nbsp;<span class="ident" id="4095098"><a href="/gostd/net/http/request.go.html#4149529">NewRequest</a></span><span class="op" id="4095108">(</span><span class="string" id="4095109">&#34;HEAD&#34;</span><span class="op" id="4095115">,</span>&nbsp;<span class="ident" id="4095117"><a href="/gostd/net/http/client.go.html#4095043">url</a></span><span class="op" id="4095120">,</span>&nbsp;<span class="builtintype" id="4095122">nil</span><span class="op" id="4095125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095128">if</span>&nbsp;<span class="ident" id="4095131"><a href="/gostd/net/http/client.go.html#4095072">err</a></span>&nbsp;<span class="op" id="4095135">!=</span>&nbsp;<span class="builtintype" id="4095138">nil</span>&nbsp;<span class="op" id="4095142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095146">return</span>&nbsp;<span class="builtintype" id="4095153">nil</span><span class="op" id="4095156">,</span>&nbsp;<span class="ident" id="4095158"><a href="/gostd/net/http/client.go.html#4095072">err</a></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095166">return</span>&nbsp;<span class="ident" id="4095173"><a href="/gostd/net/http/client.go.html#4095027">c</a></span><span class="op" id="4095174">.</span><span class="ident" id="4095175"><a href="/gostd/net/http/client.go.html#4089823">doFollowingRedirects</a></span><span class="op" id="4095195">(</span><span class="ident" id="4095196"><a href="/gostd/net/http/client.go.html#4095086">req</a></span><span class="op" id="4095199">,</span>&nbsp;<span class="ident" id="4095201"><a href="/gostd/net/http/client.go.html#4087935">shouldRedirectGet</a></span><span class="op" id="4095218">)</span><br>
<span class="lineno"></span><span class="op" id="4095220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095223">type</span>&nbsp;<span class="ident" id="4095228">cancelTimerBody</span>&nbsp;<span class="keyword" id="4095244">struct</span>&nbsp;<span class="op" id="4095251">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095254">t</span>&nbsp;&nbsp;<span class="op" id="4095257">*</span><span class="ident" id="4095258"><a href="/gostd/net/http/client.go.html#4080301">time</a></span><span class="op" id="4095262">.</span><span class="ident" id="4095263"><a href="/gostd/time/sleep.go.html#2715079">Timer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095270">rc</span>&nbsp;<span class="ident" id="4095273"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4095275">.</span><span class="ident" id="4095276"><a href="/gostd/io/io.go.html#1423414">ReadCloser</a></span><br>
<span class="lineno"></span><span class="op" id="4095287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095290">func</span>&nbsp;<span class="op" id="4095295">(</span><span class="ident" id="4095296">b</span>&nbsp;<span class="op" id="4095298">*</span><span class="ident" id="4095299"><a href="/gostd/net/http/client.go.html#4095228">cancelTimerBody</a></span><span class="op" id="4095314">)</span>&nbsp;<span class="ident" id="4095316">Read</span><span class="op" id="4095320">(</span><span class="ident" id="4095321">p</span>&nbsp;<span class="op" id="4095323">[</span><span class="op" id="4095324">]</span><span class="builtintype" id="4095325">byte</span><span class="op" id="4095329">)</span>&nbsp;<span class="op" id="4095331">(</span><span class="ident" id="4095332">n</span>&nbsp;<span class="builtintype" id="4095334">int</span><span class="op" id="4095337">,</span>&nbsp;<span class="ident" id="4095339">err</span>&nbsp;<span class="builtintype" id="4095343">error</span><span class="op" id="4095348">)</span>&nbsp;<span class="op" id="4095350">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095353"><a href="/gostd/net/http/client.go.html#4095332">n</a></span><span class="op" id="4095354">,</span>&nbsp;<span class="ident" id="4095356"><a href="/gostd/net/http/client.go.html#4095339">err</a></span>&nbsp;<span class="op" id="4095360">=</span>&nbsp;<span class="ident" id="4095362"><a href="/gostd/net/http/client.go.html#4095296">b</a></span><span class="op" id="4095363">.</span><span class="ident" id="4095364"><a href="/gostd/net/http/client.go.html#4095270">rc</a></span><span class="op" id="4095366">.</span><span class="ident" id="4095367"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="4095371">(</span><span class="ident" id="4095372"><a href="/gostd/net/http/client.go.html#4095321">p</a></span><span class="op" id="4095373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095376">if</span>&nbsp;<span class="ident" id="4095379"><a href="/gostd/net/http/client.go.html#4095339">err</a></span>&nbsp;<span class="op" id="4095383">==</span>&nbsp;<span class="ident" id="4095386"><a href="/gostd/net/http/client.go.html#4080245">io</a></span><span class="op" id="4095388">.</span><span class="ident" id="4095389"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="4095393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095397"><a href="/gostd/net/http/client.go.html#4095296">b</a></span><span class="op" id="4095398">.</span><span class="ident" id="4095399"><a href="/gostd/net/http/client.go.html#4095254">t</a></span><span class="op" id="4095400">.</span><span class="ident" id="4095401"><a href="/gostd/time/sleep.go.html#2715389">Stop</a></span><span class="op" id="4095405">(</span><span class="op" id="4095406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095412">return</span><br>
<span class="lineno">505</span><span class="op" id="4095419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095422">func</span>&nbsp;<span class="op" id="4095427">(</span><span class="ident" id="4095428">b</span>&nbsp;<span class="op" id="4095430">*</span><span class="ident" id="4095431"><a href="/gostd/net/http/client.go.html#4095228">cancelTimerBody</a></span><span class="op" id="4095446">)</span>&nbsp;<span class="ident" id="4095448">Close</span><span class="op" id="4095453">(</span><span class="op" id="4095454">)</span>&nbsp;<span class="builtintype" id="4095456">error</span>&nbsp;<span class="op" id="4095462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095465">err</span>&nbsp;<span class="op" id="4095469">:=</span>&nbsp;<span class="ident" id="4095472"><a href="/gostd/net/http/client.go.html#4095428">b</a></span><span class="op" id="4095473">.</span><span class="ident" id="4095474"><a href="/gostd/net/http/client.go.html#4095270">rc</a></span><span class="op" id="4095476">.</span><span class="ident" id="4095477"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="4095482">(</span><span class="op" id="4095483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095486"><a href="/gostd/net/http/client.go.html#4095428">b</a></span><span class="op" id="4095487">.</span><span class="ident" id="4095488"><a href="/gostd/net/http/client.go.html#4095254">t</a></span><span class="op" id="4095489">.</span><span class="ident" id="4095490"><a href="/gostd/time/sleep.go.html#2715389">Stop</a></span><span class="op" id="4095494">(</span><span class="op" id="4095495">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095498">return</span>&nbsp;<span class="ident" id="4095505"><a href="/gostd/net/http/client.go.html#4095465">err</a></span><br>
<span class="lineno"></span><span class="op" id="4095509">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
