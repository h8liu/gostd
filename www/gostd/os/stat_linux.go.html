<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html" class="current">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2359711">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2359766">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2359820">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2359871">package</span>&nbsp;<span class="ident" id="2359879">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2359883">import</span>&nbsp;<span class="op" id="2359890">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2359893">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2359904">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2359911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2359914">func</span>&nbsp;<span class="ident" id="2359919">sameFile</span><span class="op" id="2359927">(</span><span class="ident" id="2359928">fs1</span><span class="op" id="2359931">,</span>&nbsp;<span class="ident" id="2359933">fs2</span>&nbsp;<span class="op" id="2359937">*</span><span class="ident" id="2359938">fileStat</span><span class="op" id="2359946">)</span>&nbsp;<span class="builtintype" id="2359948">bool</span>&nbsp;<span class="op" id="2359953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2359956">stat1</span>&nbsp;<span class="op" id="2359962">:=</span>&nbsp;<span class="ident" id="2359965">fs1</span><span class="op" id="2359968">.</span><span class="ident" id="2359969">sys</span><span class="op" id="2359972">.</span><span class="op" id="2359973">(</span><span class="op" id="2359974">*</span><span class="ident" id="2359975">syscall</span><span class="op" id="2359982">.</span><span class="ident" id="2359983">Stat_t</span><span class="op" id="2359989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2359992">stat2</span>&nbsp;<span class="op" id="2359998">:=</span>&nbsp;<span class="ident" id="2360001">fs2</span><span class="op" id="2360004">.</span><span class="ident" id="2360005">sys</span><span class="op" id="2360008">.</span><span class="op" id="2360009">(</span><span class="op" id="2360010">*</span><span class="ident" id="2360011">syscall</span><span class="op" id="2360018">.</span><span class="ident" id="2360019">Stat_t</span><span class="op" id="2360025">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360028">return</span>&nbsp;<span class="ident" id="2360035">stat1</span><span class="op" id="2360040">.</span><span class="ident" id="2360041">Dev</span>&nbsp;<span class="op" id="2360045">==</span>&nbsp;<span class="ident" id="2360048">stat2</span><span class="op" id="2360053">.</span><span class="ident" id="2360054">Dev</span>&nbsp;<span class="op" id="2360058">&amp;&amp;</span>&nbsp;<span class="ident" id="2360061">stat1</span><span class="op" id="2360066">.</span><span class="ident" id="2360067">Ino</span>&nbsp;<span class="op" id="2360071">==</span>&nbsp;<span class="ident" id="2360074">stat2</span><span class="op" id="2360079">.</span><span class="ident" id="2360080">Ino</span><br>
<span class="lineno"></span><span class="op" id="2360084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2360087">func</span>&nbsp;<span class="ident" id="2360092">fileInfoFromStat</span><span class="op" id="2360108">(</span><span class="ident" id="2360109">st</span>&nbsp;<span class="op" id="2360112">*</span><span class="ident" id="2360113">syscall</span><span class="op" id="2360120">.</span><span class="ident" id="2360121">Stat_t</span><span class="op" id="2360127">,</span>&nbsp;<span class="ident" id="2360129">name</span>&nbsp;<span class="builtintype" id="2360134">string</span><span class="op" id="2360140">)</span>&nbsp;<span class="ident" id="2360142">FileInfo</span>&nbsp;<span class="op" id="2360151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360154">fs</span>&nbsp;<span class="op" id="2360157">:=</span>&nbsp;<span class="op" id="2360160">&amp;</span><span class="ident" id="2360161">fileStat</span><span class="op" id="2360169">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360173">name</span><span class="op" id="2360177">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360182">basename</span><span class="op" id="2360190">(</span><span class="ident" id="2360191">name</span><span class="op" id="2360195">)</span><span class="op" id="2360196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360200">size</span><span class="op" id="2360204">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360209">int64</span><span class="op" id="2360214">(</span><span class="ident" id="2360215">st</span><span class="op" id="2360217">.</span><span class="ident" id="2360218">Size</span><span class="op" id="2360222">)</span><span class="op" id="2360223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360227">modTime</span><span class="op" id="2360234">:</span>&nbsp;<span class="ident" id="2360236">timespecToTime</span><span class="op" id="2360250">(</span><span class="ident" id="2360251">st</span><span class="op" id="2360253">.</span><span class="ident" id="2360254">Mtim</span><span class="op" id="2360258">)</span><span class="op" id="2360259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360263">sys</span><span class="op" id="2360266">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360272">st</span><span class="op" id="2360274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2360277">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360280">fs</span><span class="op" id="2360282">.</span><span class="ident" id="2360283">mode</span>&nbsp;<span class="op" id="2360288">=</span>&nbsp;<span class="ident" id="2360290">FileMode</span><span class="op" id="2360298">(</span><span class="ident" id="2360299">st</span><span class="op" id="2360301">.</span><span class="ident" id="2360302">Mode</span>&nbsp;<span class="op" id="2360307">&amp;</span>&nbsp;<span class="num" id="2360309">0777</span><span class="op" id="2360313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360316">switch</span>&nbsp;<span class="ident" id="2360323">st</span><span class="op" id="2360325">.</span><span class="ident" id="2360326">Mode</span>&nbsp;<span class="op" id="2360331">&amp;</span>&nbsp;<span class="ident" id="2360333">syscall</span><span class="op" id="2360340">.</span><span class="ident" id="2360341">S_IFMT</span>&nbsp;<span class="op" id="2360348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360351">case</span>&nbsp;<span class="ident" id="2360356">syscall</span><span class="op" id="2360363">.</span><span class="ident" id="2360364">S_IFBLK</span><span class="op" id="2360371">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360375">fs</span><span class="op" id="2360377">.</span><span class="ident" id="2360378">mode</span>&nbsp;<span class="op" id="2360383">|=</span>&nbsp;<span class="ident" id="2360386">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360398">case</span>&nbsp;<span class="ident" id="2360403">syscall</span><span class="op" id="2360410">.</span><span class="ident" id="2360411">S_IFCHR</span><span class="op" id="2360418">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360422">fs</span><span class="op" id="2360424">.</span><span class="ident" id="2360425">mode</span>&nbsp;<span class="op" id="2360430">|=</span>&nbsp;<span class="ident" id="2360433">ModeDevice</span>&nbsp;<span class="op" id="2360444">|</span>&nbsp;<span class="ident" id="2360446">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360462">case</span>&nbsp;<span class="ident" id="2360467">syscall</span><span class="op" id="2360474">.</span><span class="ident" id="2360475">S_IFDIR</span><span class="op" id="2360482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360486">fs</span><span class="op" id="2360488">.</span><span class="ident" id="2360489">mode</span>&nbsp;<span class="op" id="2360494">|=</span>&nbsp;<span class="ident" id="2360497">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360506">case</span>&nbsp;<span class="ident" id="2360511">syscall</span><span class="op" id="2360518">.</span><span class="ident" id="2360519">S_IFIFO</span><span class="op" id="2360526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360530">fs</span><span class="op" id="2360532">.</span><span class="ident" id="2360533">mode</span>&nbsp;<span class="op" id="2360538">|=</span>&nbsp;<span class="ident" id="2360541">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360556">case</span>&nbsp;<span class="ident" id="2360561">syscall</span><span class="op" id="2360568">.</span><span class="ident" id="2360569">S_IFLNK</span><span class="op" id="2360576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360580">fs</span><span class="op" id="2360582">.</span><span class="ident" id="2360583">mode</span>&nbsp;<span class="op" id="2360588">|=</span>&nbsp;<span class="ident" id="2360591">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360604">case</span>&nbsp;<span class="ident" id="2360609">syscall</span><span class="op" id="2360616">.</span><span class="ident" id="2360617">S_IFREG</span><span class="op" id="2360624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2360628">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360646">case</span>&nbsp;<span class="ident" id="2360651">syscall</span><span class="op" id="2360658">.</span><span class="ident" id="2360659">S_IFSOCK</span><span class="op" id="2360667">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360671">fs</span><span class="op" id="2360673">.</span><span class="ident" id="2360674">mode</span>&nbsp;<span class="op" id="2360679">|=</span>&nbsp;<span class="ident" id="2360682">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2360694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360697">if</span>&nbsp;<span class="ident" id="2360700">st</span><span class="op" id="2360702">.</span><span class="ident" id="2360703">Mode</span><span class="op" id="2360707">&amp;</span><span class="ident" id="2360708">syscall</span><span class="op" id="2360715">.</span><span class="ident" id="2360716">S_ISGID</span>&nbsp;<span class="op" id="2360724">!=</span>&nbsp;<span class="num" id="2360727">0</span>&nbsp;<span class="op" id="2360729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360733">fs</span><span class="op" id="2360735">.</span><span class="ident" id="2360736">mode</span>&nbsp;<span class="op" id="2360741">|=</span>&nbsp;<span class="ident" id="2360744">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2360756">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360759">if</span>&nbsp;<span class="ident" id="2360762">st</span><span class="op" id="2360764">.</span><span class="ident" id="2360765">Mode</span><span class="op" id="2360769">&amp;</span><span class="ident" id="2360770">syscall</span><span class="op" id="2360777">.</span><span class="ident" id="2360778">S_ISUID</span>&nbsp;<span class="op" id="2360786">!=</span>&nbsp;<span class="num" id="2360789">0</span>&nbsp;<span class="op" id="2360791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360795">fs</span><span class="op" id="2360797">.</span><span class="ident" id="2360798">mode</span>&nbsp;<span class="op" id="2360803">|=</span>&nbsp;<span class="ident" id="2360806">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2360818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360821">if</span>&nbsp;<span class="ident" id="2360824">st</span><span class="op" id="2360826">.</span><span class="ident" id="2360827">Mode</span><span class="op" id="2360831">&amp;</span><span class="ident" id="2360832">syscall</span><span class="op" id="2360839">.</span><span class="ident" id="2360840">S_ISVTX</span>&nbsp;<span class="op" id="2360848">!=</span>&nbsp;<span class="num" id="2360851">0</span>&nbsp;<span class="op" id="2360853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2360857">fs</span><span class="op" id="2360859">.</span><span class="ident" id="2360860">mode</span>&nbsp;<span class="op" id="2360865">|=</span>&nbsp;<span class="ident" id="2360868">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2360880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360883">return</span>&nbsp;<span class="ident" id="2360890">fs</span><br>
<span class="lineno"></span><span class="op" id="2360893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2360896">func</span>&nbsp;<span class="ident" id="2360901">timespecToTime</span><span class="op" id="2360915">(</span><span class="ident" id="2360916">ts</span>&nbsp;<span class="ident" id="2360919">syscall</span><span class="op" id="2360926">.</span><span class="ident" id="2360927">Timespec</span><span class="op" id="2360935">)</span>&nbsp;<span class="ident" id="2360937">time</span><span class="op" id="2360941">.</span><span class="ident" id="2360942">Time</span>&nbsp;<span class="op" id="2360947">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2360950">return</span>&nbsp;<span class="ident" id="2360957">time</span><span class="op" id="2360961">.</span><span class="ident" id="2360962">Unix</span><span class="op" id="2360966">(</span><span class="ident" id="2360967">int64</span><span class="op" id="2360972">(</span><span class="ident" id="2360973">ts</span><span class="op" id="2360975">.</span><span class="ident" id="2360976">Sec</span><span class="op" id="2360979">)</span><span class="op" id="2360980">,</span>&nbsp;<span class="ident" id="2360982">int64</span><span class="op" id="2360987">(</span><span class="ident" id="2360988">ts</span><span class="op" id="2360990">.</span><span class="ident" id="2360991">Nsec</span><span class="op" id="2360995">)</span><span class="op" id="2360996">)</span><br>
<span class="lineno"></span><span class="op" id="2360998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2361001">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2361017">func</span>&nbsp;<span class="ident" id="2361022">atime</span><span class="op" id="2361027">(</span><span class="ident" id="2361028">fi</span>&nbsp;<span class="ident" id="2361031">FileInfo</span><span class="op" id="2361039">)</span>&nbsp;<span class="ident" id="2361041">time</span><span class="op" id="2361045">.</span><span class="ident" id="2361046">Time</span>&nbsp;<span class="op" id="2361051">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2361054">return</span>&nbsp;<span class="ident" id="2361061">timespecToTime</span><span class="op" id="2361075">(</span><span class="ident" id="2361076">fi</span><span class="op" id="2361078">.</span><span class="ident" id="2361079">Sys</span><span class="op" id="2361082">(</span><span class="op" id="2361083">)</span><span class="op" id="2361084">.</span><span class="op" id="2361085">(</span><span class="op" id="2361086">*</span><span class="ident" id="2361087">syscall</span><span class="op" id="2361094">.</span><span class="ident" id="2361095">Stat_t</span><span class="op" id="2361101">)</span><span class="op" id="2361102">.</span><span class="ident" id="2361103">Atim</span><span class="op" id="2361107">)</span><br>
<span class="lineno"></span><span class="op" id="2361109">}</span>
</div>
</body>
</html>
