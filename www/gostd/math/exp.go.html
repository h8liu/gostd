<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2112532">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2112587">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2112641">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2112692">package</span>&nbsp;<span class="ident" id="2112700">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2112706">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2112756">//</span><br>
<span class="lineno"></span><span class="comment" id="2112759">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2112781">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2112801">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2112819">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2112863">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2112900">func</span>&nbsp;<span class="ident" id="2112905">Exp</span><span class="op" id="2112908">(</span><span class="ident" id="2112909">x</span>&nbsp;<span class="builtintype" id="2112911">float64</span><span class="op" id="2112918">)</span>&nbsp;<span class="builtintype" id="2112920">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2112929">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2112989">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2113047">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2113106">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2113136">//</span><br>
<span class="lineno"></span><span class="comment" id="2113139">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2113195">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2113264">//</span><br>
<span class="lineno"></span><span class="comment" id="2113267">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2113323">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2113380">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2113397">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2113453">//</span><br>
<span class="lineno"></span><span class="comment" id="2113456">//</span><br>
<span class="lineno">30</span><span class="comment" id="2113459">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2113469">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2113502">//</span><br>
<span class="lineno"></span><span class="comment" id="2113505">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2113515">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2113543">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2113602">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2113650">//</span><br>
<span class="lineno"></span><span class="comment" id="2113653">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2113702">//</span><br>
<span class="lineno">40</span><span class="comment" id="2113705">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2113764">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2113782">//</span><br>
<span class="lineno"></span><span class="comment" id="2113785">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2113851">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2113885">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2113899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2113974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2114042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2114111">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2114177">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2114198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2114268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2114335">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2114347">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2114399">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2114448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2114492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2114539">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2114574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2114611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2114647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2114690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2114757">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2114801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2114815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2114873">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2114934">//</span><br>
<span class="lineno"></span><span class="comment" id="2114937">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2114974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2115003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2115037">//</span><br>
<span class="lineno"></span><span class="comment" id="2115040">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2115058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2115100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2115128">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2115181">//</span><br>
<span class="lineno"></span><span class="comment" id="2115184">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2115197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2115267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2115307">//</span><br>
<span class="lineno"></span><span class="comment" id="2115310">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2115325">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2115349">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2115417">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2115486">//</span><br>
<span class="lineno"></span><span class="comment" id="2115489">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2115503">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2115569">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2115633">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2115699">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2115744">func</span>&nbsp;<span class="ident" id="2115749">exp</span><span class="op" id="2115752">(</span><span class="ident" id="2115753">x</span>&nbsp;<span class="builtintype" id="2115755">float64</span><span class="op" id="2115762">)</span>&nbsp;<span class="builtintype" id="2115764">float64</span>&nbsp;<span class="op" id="2115772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115775">const</span>&nbsp;<span class="op" id="2115781">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115785">Ln2Hi</span>&nbsp;<span class="op" id="2115791">=</span>&nbsp;<span class="num" id="2115793">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115822">Ln2Lo</span>&nbsp;<span class="op" id="2115828">=</span>&nbsp;<span class="num" id="2115830">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115859">Log2e</span>&nbsp;<span class="op" id="2115865">=</span>&nbsp;<span class="num" id="2115867">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115897">Overflow</span>&nbsp;&nbsp;<span class="op" id="2115907">=</span>&nbsp;<span class="num" id="2115909">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115938">Underflow</span>&nbsp;<span class="op" id="2115948">=</span>&nbsp;<span class="op" id="2115950">-</span><span class="num" id="2115951">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115980">NearZero</span>&nbsp;&nbsp;<span class="op" id="2115990">=</span>&nbsp;<span class="num" id="2115992">1.0</span>&nbsp;<span class="op" id="2115996">/</span>&nbsp;<span class="op" id="2115998">(</span><span class="num" id="2115999">1</span>&nbsp;<span class="op" id="2116001">&lt;&lt;</span>&nbsp;<span class="num" id="2116004">28</span><span class="op" id="2116006">)</span>&nbsp;<span class="comment" id="2116008">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116023">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116041">switch</span>&nbsp;<span class="op" id="2116048">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116051">case</span>&nbsp;<span class="ident" id="2116056">IsNaN</span><span class="op" id="2116061">(</span><span class="ident" id="2116062">x</span><span class="op" id="2116063">)</span>&nbsp;<span class="op" id="2116065">||</span>&nbsp;<span class="ident" id="2116068">IsInf</span><span class="op" id="2116073">(</span><span class="ident" id="2116074">x</span><span class="op" id="2116075">,</span>&nbsp;<span class="num" id="2116077">1</span><span class="op" id="2116078">)</span><span class="op" id="2116079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116083">return</span>&nbsp;<span class="ident" id="2116090">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116093">case</span>&nbsp;<span class="ident" id="2116098">IsInf</span><span class="op" id="2116103">(</span><span class="ident" id="2116104">x</span><span class="op" id="2116105">,</span>&nbsp;<span class="op" id="2116107">-</span><span class="num" id="2116108">1</span><span class="op" id="2116109">)</span><span class="op" id="2116110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116114">return</span>&nbsp;<span class="num" id="2116121">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116124">case</span>&nbsp;<span class="ident" id="2116129">x</span>&nbsp;<span class="op" id="2116131">&gt;</span>&nbsp;<span class="ident" id="2116133">Overflow</span><span class="op" id="2116141">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116145">return</span>&nbsp;<span class="ident" id="2116152">Inf</span><span class="op" id="2116155">(</span><span class="num" id="2116156">1</span><span class="op" id="2116157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116160">case</span>&nbsp;<span class="ident" id="2116165">x</span>&nbsp;<span class="op" id="2116167">&lt;</span>&nbsp;<span class="ident" id="2116169">Underflow</span><span class="op" id="2116178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116182">return</span>&nbsp;<span class="num" id="2116189">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116192">case</span>&nbsp;<span class="op" id="2116197">-</span><span class="ident" id="2116198">NearZero</span>&nbsp;<span class="op" id="2116207">&lt;</span>&nbsp;<span class="ident" id="2116209">x</span>&nbsp;<span class="op" id="2116211">&amp;&amp;</span>&nbsp;<span class="ident" id="2116214">x</span>&nbsp;<span class="op" id="2116216">&lt;</span>&nbsp;<span class="ident" id="2116218">NearZero</span><span class="op" id="2116226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116230">return</span>&nbsp;<span class="num" id="2116237">1</span>&nbsp;<span class="op" id="2116239">+</span>&nbsp;<span class="ident" id="2116241">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116248">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116305">var</span>&nbsp;<span class="ident" id="2116309">k</span>&nbsp;<span class="builtintype" id="2116311">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116316">switch</span>&nbsp;<span class="op" id="2116323">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116326">case</span>&nbsp;<span class="ident" id="2116331">x</span>&nbsp;<span class="op" id="2116333">&lt;</span>&nbsp;<span class="num" id="2116335">0</span><span class="op" id="2116336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116340">k</span>&nbsp;<span class="op" id="2116342">=</span>&nbsp;<span class="builtintype" id="2116344">int</span><span class="op" id="2116347">(</span><span class="ident" id="2116348">Log2e</span><span class="op" id="2116353">*</span><span class="ident" id="2116354">x</span>&nbsp;<span class="op" id="2116356">-</span>&nbsp;<span class="num" id="2116358">0.5</span><span class="op" id="2116361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116364">case</span>&nbsp;<span class="ident" id="2116369">x</span>&nbsp;<span class="op" id="2116371">&gt;</span>&nbsp;<span class="num" id="2116373">0</span><span class="op" id="2116374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116378">k</span>&nbsp;<span class="op" id="2116380">=</span>&nbsp;<span class="builtintype" id="2116382">int</span><span class="op" id="2116385">(</span><span class="ident" id="2116386">Log2e</span><span class="op" id="2116391">*</span><span class="ident" id="2116392">x</span>&nbsp;<span class="op" id="2116394">+</span>&nbsp;<span class="num" id="2116396">0.5</span><span class="op" id="2116399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116402">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116405">hi</span>&nbsp;<span class="op" id="2116408">:=</span>&nbsp;<span class="ident" id="2116411">x</span>&nbsp;<span class="op" id="2116413">-</span>&nbsp;<span class="builtintype" id="2116415">float64</span><span class="op" id="2116422">(</span><span class="ident" id="2116423">k</span><span class="op" id="2116424">)</span><span class="op" id="2116425">*</span><span class="ident" id="2116426">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116433">lo</span>&nbsp;<span class="op" id="2116436">:=</span>&nbsp;<span class="builtintype" id="2116439">float64</span><span class="op" id="2116446">(</span><span class="ident" id="2116447">k</span><span class="op" id="2116448">)</span>&nbsp;<span class="op" id="2116450">*</span>&nbsp;<span class="ident" id="2116452">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116460">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116472">return</span>&nbsp;<span class="ident" id="2116479">expmulti</span><span class="op" id="2116487">(</span><span class="ident" id="2116488">hi</span><span class="op" id="2116490">,</span>&nbsp;<span class="ident" id="2116492">lo</span><span class="op" id="2116494">,</span>&nbsp;<span class="ident" id="2116496">k</span><span class="op" id="2116497">)</span><br>
<span class="lineno">130</span><span class="op" id="2116499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2116502">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2116553">//</span><br>
<span class="lineno"></span><span class="comment" id="2116556">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2116594">func</span>&nbsp;<span class="ident" id="2116599">Exp2</span><span class="op" id="2116603">(</span><span class="ident" id="2116604">x</span>&nbsp;<span class="builtintype" id="2116606">float64</span><span class="op" id="2116613">)</span>&nbsp;<span class="builtintype" id="2116615">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2116624">func</span>&nbsp;<span class="ident" id="2116629">exp2</span><span class="op" id="2116633">(</span><span class="ident" id="2116634">x</span>&nbsp;<span class="builtintype" id="2116636">float64</span><span class="op" id="2116643">)</span>&nbsp;<span class="builtintype" id="2116645">float64</span>&nbsp;<span class="op" id="2116653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116656">const</span>&nbsp;<span class="op" id="2116662">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116666">Ln2Hi</span>&nbsp;<span class="op" id="2116672">=</span>&nbsp;<span class="num" id="2116674">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116703">Ln2Lo</span>&nbsp;<span class="op" id="2116709">=</span>&nbsp;<span class="num" id="2116711">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116741">Overflow</span>&nbsp;&nbsp;<span class="op" id="2116751">=</span>&nbsp;<span class="num" id="2116753">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116778">Underflow</span>&nbsp;<span class="op" id="2116788">=</span>&nbsp;<span class="op" id="2116790">-</span><span class="num" id="2116791">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116803">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116807">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116825">switch</span>&nbsp;<span class="op" id="2116832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116835">case</span>&nbsp;<span class="ident" id="2116840">IsNaN</span><span class="op" id="2116845">(</span><span class="ident" id="2116846">x</span><span class="op" id="2116847">)</span>&nbsp;<span class="op" id="2116849">||</span>&nbsp;<span class="ident" id="2116852">IsInf</span><span class="op" id="2116857">(</span><span class="ident" id="2116858">x</span><span class="op" id="2116859">,</span>&nbsp;<span class="num" id="2116861">1</span><span class="op" id="2116862">)</span><span class="op" id="2116863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116867">return</span>&nbsp;<span class="ident" id="2116874">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116877">case</span>&nbsp;<span class="ident" id="2116882">IsInf</span><span class="op" id="2116887">(</span><span class="ident" id="2116888">x</span><span class="op" id="2116889">,</span>&nbsp;<span class="op" id="2116891">-</span><span class="num" id="2116892">1</span><span class="op" id="2116893">)</span><span class="op" id="2116894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116898">return</span>&nbsp;<span class="num" id="2116905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116908">case</span>&nbsp;<span class="ident" id="2116913">x</span>&nbsp;<span class="op" id="2116915">&gt;</span>&nbsp;<span class="ident" id="2116917">Overflow</span><span class="op" id="2116925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116929">return</span>&nbsp;<span class="ident" id="2116936">Inf</span><span class="op" id="2116939">(</span><span class="num" id="2116940">1</span><span class="op" id="2116941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116944">case</span>&nbsp;<span class="ident" id="2116949">x</span>&nbsp;<span class="op" id="2116951">&lt;</span>&nbsp;<span class="ident" id="2116953">Underflow</span><span class="op" id="2116962">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116966">return</span>&nbsp;<span class="num" id="2116973">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116980">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2117043">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117092">var</span>&nbsp;<span class="ident" id="2117096">k</span>&nbsp;<span class="builtintype" id="2117098">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117103">switch</span>&nbsp;<span class="op" id="2117110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117113">case</span>&nbsp;<span class="ident" id="2117118">x</span>&nbsp;<span class="op" id="2117120">&gt;</span>&nbsp;<span class="num" id="2117122">0</span><span class="op" id="2117123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117127">k</span>&nbsp;<span class="op" id="2117129">=</span>&nbsp;<span class="builtintype" id="2117131">int</span><span class="op" id="2117134">(</span><span class="ident" id="2117135">x</span>&nbsp;<span class="op" id="2117137">+</span>&nbsp;<span class="num" id="2117139">0.5</span><span class="op" id="2117142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117145">case</span>&nbsp;<span class="ident" id="2117150">x</span>&nbsp;<span class="op" id="2117152">&lt;</span>&nbsp;<span class="num" id="2117154">0</span><span class="op" id="2117155">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117159">k</span>&nbsp;<span class="op" id="2117161">=</span>&nbsp;<span class="builtintype" id="2117163">int</span><span class="op" id="2117166">(</span><span class="ident" id="2117167">x</span>&nbsp;<span class="op" id="2117169">-</span>&nbsp;<span class="num" id="2117171">0.5</span><span class="op" id="2117174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117180">t</span>&nbsp;<span class="op" id="2117182">:=</span>&nbsp;<span class="ident" id="2117185">x</span>&nbsp;<span class="op" id="2117187">-</span>&nbsp;<span class="builtintype" id="2117189">float64</span><span class="op" id="2117196">(</span><span class="ident" id="2117197">k</span><span class="op" id="2117198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117201">hi</span>&nbsp;<span class="op" id="2117204">:=</span>&nbsp;<span class="ident" id="2117207">t</span>&nbsp;<span class="op" id="2117209">*</span>&nbsp;<span class="ident" id="2117211">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117218">lo</span>&nbsp;<span class="op" id="2117221">:=</span>&nbsp;<span class="op" id="2117224">-</span><span class="ident" id="2117225">t</span>&nbsp;<span class="op" id="2117227">*</span>&nbsp;<span class="ident" id="2117229">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2117237">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117249">return</span>&nbsp;<span class="ident" id="2117256">expmulti</span><span class="op" id="2117264">(</span><span class="ident" id="2117265">hi</span><span class="op" id="2117267">,</span>&nbsp;<span class="ident" id="2117269">lo</span><span class="op" id="2117271">,</span>&nbsp;<span class="ident" id="2117273">k</span><span class="op" id="2117274">)</span><br>
<span class="lineno"></span><span class="op" id="2117276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2117279">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2117347">func</span>&nbsp;<span class="ident" id="2117352">expmulti</span><span class="op" id="2117360">(</span><span class="ident" id="2117361">hi</span><span class="op" id="2117363">,</span>&nbsp;<span class="ident" id="2117365">lo</span>&nbsp;<span class="builtintype" id="2117368">float64</span><span class="op" id="2117375">,</span>&nbsp;<span class="ident" id="2117377">k</span>&nbsp;<span class="builtintype" id="2117379">int</span><span class="op" id="2117382">)</span>&nbsp;<span class="builtintype" id="2117384">float64</span>&nbsp;<span class="op" id="2117392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117395">const</span>&nbsp;<span class="op" id="2117401">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117405">P1</span>&nbsp;<span class="op" id="2117408">=</span>&nbsp;<span class="num" id="2117410">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2117438">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117469">P2</span>&nbsp;<span class="op" id="2117472">=</span>&nbsp;<span class="op" id="2117474">-</span><span class="num" id="2117475">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2117502">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117533">P3</span>&nbsp;<span class="op" id="2117536">=</span>&nbsp;<span class="num" id="2117538">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2117566">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117597">P4</span>&nbsp;<span class="op" id="2117600">=</span>&nbsp;<span class="op" id="2117602">-</span><span class="num" id="2117603">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2117630">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117661">P5</span>&nbsp;<span class="op" id="2117664">=</span>&nbsp;<span class="num" id="2117666">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2117694">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117728">r</span>&nbsp;<span class="op" id="2117730">:=</span>&nbsp;<span class="ident" id="2117733">hi</span>&nbsp;<span class="op" id="2117736">-</span>&nbsp;<span class="ident" id="2117738">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117742">t</span>&nbsp;<span class="op" id="2117744">:=</span>&nbsp;<span class="ident" id="2117747">r</span>&nbsp;<span class="op" id="2117749">*</span>&nbsp;<span class="ident" id="2117751">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117754">c</span>&nbsp;<span class="op" id="2117756">:=</span>&nbsp;<span class="ident" id="2117759">r</span>&nbsp;<span class="op" id="2117761">-</span>&nbsp;<span class="ident" id="2117763">t</span><span class="op" id="2117764">*</span><span class="op" id="2117765">(</span><span class="ident" id="2117766">P1</span><span class="op" id="2117768">+</span><span class="ident" id="2117769">t</span><span class="op" id="2117770">*</span><span class="op" id="2117771">(</span><span class="ident" id="2117772">P2</span><span class="op" id="2117774">+</span><span class="ident" id="2117775">t</span><span class="op" id="2117776">*</span><span class="op" id="2117777">(</span><span class="ident" id="2117778">P3</span><span class="op" id="2117780">+</span><span class="ident" id="2117781">t</span><span class="op" id="2117782">*</span><span class="op" id="2117783">(</span><span class="ident" id="2117784">P4</span><span class="op" id="2117786">+</span><span class="ident" id="2117787">t</span><span class="op" id="2117788">*</span><span class="ident" id="2117789">P5</span><span class="op" id="2117791">)</span><span class="op" id="2117792">)</span><span class="op" id="2117793">)</span><span class="op" id="2117794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117797">y</span>&nbsp;<span class="op" id="2117799">:=</span>&nbsp;<span class="num" id="2117802">1</span>&nbsp;<span class="op" id="2117804">-</span>&nbsp;<span class="op" id="2117806">(</span><span class="op" id="2117807">(</span><span class="ident" id="2117808">lo</span>&nbsp;<span class="op" id="2117811">-</span>&nbsp;<span class="op" id="2117813">(</span><span class="ident" id="2117814">r</span><span class="op" id="2117815">*</span><span class="ident" id="2117816">c</span><span class="op" id="2117817">)</span><span class="op" id="2117818">/</span><span class="op" id="2117819">(</span><span class="num" id="2117820">2</span><span class="op" id="2117821">-</span><span class="ident" id="2117822">c</span><span class="op" id="2117823">)</span><span class="op" id="2117824">)</span>&nbsp;<span class="op" id="2117826">-</span>&nbsp;<span class="ident" id="2117828">hi</span><span class="op" id="2117830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2117833">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117886">return</span>&nbsp;<span class="ident" id="2117893">Ldexp</span><span class="op" id="2117898">(</span><span class="ident" id="2117899">y</span><span class="op" id="2117900">,</span>&nbsp;<span class="ident" id="2117902">k</span><span class="op" id="2117903">)</span><br>
<span class="lineno"></span><span class="op" id="2117905">}</span>
</div>
</body>
</html>
