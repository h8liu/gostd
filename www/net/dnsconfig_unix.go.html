<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1356157">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1356212">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1356266">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1356317">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356382">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1356431">package</span>&nbsp;<span class="ident" id="1356439">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1356444">type</span>&nbsp;<span class="ident" id="1356449">dnsConfig</span>&nbsp;<span class="keyword" id="1356459">struct</span>&nbsp;<span class="op" id="1356466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356469">servers</span>&nbsp;&nbsp;<span class="op" id="1356478">[</span><span class="op" id="1356479">]</span><span class="builtintype" id="1356480">string</span>&nbsp;<span class="comment" id="1356487">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356506">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1356515">[</span><span class="op" id="1356516">]</span><span class="builtintype" id="1356517">string</span>&nbsp;<span class="comment" id="1356524">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356561">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1356570">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1356579">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356633">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="1356642">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1356651">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356690">attempts</span>&nbsp;<span class="builtintype" id="1356699">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1356708">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356752">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1356761">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1356770">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="1356799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="1356802">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="1356844">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="1356906">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="1356960">func</span>&nbsp;<span class="ident" id="1356965">dnsReadConfig</span><span class="op" id="1356978">(</span><span class="ident" id="1356979">filename</span>&nbsp;<span class="builtintype" id="1356988">string</span><span class="op" id="1356994">)</span>&nbsp;<span class="op" id="1356996">(</span><span class="op" id="1356997">*</span><span class="ident" id="1356998"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="1357007">,</span>&nbsp;<span class="builtintype" id="1357009">error</span><span class="op" id="1357014">)</span>&nbsp;<span class="op" id="1357016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357019">file</span><span class="op" id="1357023">,</span>&nbsp;<span class="ident" id="1357025">err</span>&nbsp;<span class="op" id="1357029">:=</span>&nbsp;<span class="ident" id="1357032"><a href="/net/parse.go.html#1476797">open</a></span><span class="op" id="1357036">(</span><span class="ident" id="1357037"><a href="/net/dnsconfig_unix.go.html#1356979">filename</a></span><span class="op" id="1357045">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357048">if</span>&nbsp;<span class="ident" id="1357051"><a href="/net/dnsconfig_unix.go.html#1357025">err</a></span>&nbsp;<span class="op" id="1357055">!=</span>&nbsp;<span class="ident" id="1357058">nil</span>&nbsp;<span class="op" id="1357062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357066">return</span>&nbsp;<span class="ident" id="1357073">nil</span><span class="op" id="1357076">,</span>&nbsp;<span class="op" id="1357078">&amp;</span><span class="ident" id="1357079"><a href="/net/net.go.html#1474409">DNSConfigError</a></span><span class="op" id="1357093">{</span><span class="ident" id="1357094"><a href="/net/dnsconfig_unix.go.html#1357025">err</a></span><span class="op" id="1357097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357103">defer</span>&nbsp;<span class="ident" id="1357109"><a href="/net/dnsconfig_unix.go.html#1357019">file</a></span><span class="op" id="1357113">.</span><span class="builtinfunc" id="1357114">close</span><span class="op" id="1357119">(</span><span class="op" id="1357120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357123">conf</span>&nbsp;<span class="op" id="1357128">:=</span>&nbsp;<span class="op" id="1357131">&amp;</span><span class="ident" id="1357132"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="1357141">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357145">ndots</span><span class="op" id="1357150">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="1357155">1</span><span class="op" id="1357156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357160">timeout</span><span class="op" id="1357167">:</span>&nbsp;&nbsp;<span class="num" id="1357170">5</span><span class="op" id="1357171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357175">attempts</span><span class="op" id="1357183">:</span>&nbsp;<span class="num" id="1357185">2</span><span class="op" id="1357186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357192">for</span>&nbsp;<span class="ident" id="1357196">line</span><span class="op" id="1357200">,</span>&nbsp;<span class="ident" id="1357202">ok</span>&nbsp;<span class="op" id="1357205">:=</span>&nbsp;<span class="ident" id="1357208"><a href="/net/dnsconfig_unix.go.html#1357019">file</a></span><span class="op" id="1357212">.</span><span class="ident" id="1357213">readLine</span><span class="op" id="1357221">(</span><span class="op" id="1357222">)</span><span class="op" id="1357223">;</span>&nbsp;<span class="ident" id="1357225"><a href="/net/dnsconfig_unix.go.html#1357202">ok</a></span><span class="op" id="1357227">;</span>&nbsp;<span class="ident" id="1357229"><a href="/net/dnsconfig_unix.go.html#1357196">line</a></span><span class="op" id="1357233">,</span>&nbsp;<span class="ident" id="1357235"><a href="/net/dnsconfig_unix.go.html#1357202">ok</a></span>&nbsp;<span class="op" id="1357238">=</span>&nbsp;<span class="ident" id="1357240"><a href="/net/dnsconfig_unix.go.html#1357019">file</a></span><span class="op" id="1357244">.</span><span class="ident" id="1357245">readLine</span><span class="op" id="1357253">(</span><span class="op" id="1357254">)</span>&nbsp;<span class="op" id="1357256">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357260">f</span>&nbsp;<span class="op" id="1357262">:=</span>&nbsp;<span class="ident" id="1357265"><a href="/net/parse.go.html#1477633">getFields</a></span><span class="op" id="1357274">(</span><span class="ident" id="1357275"><a href="/net/dnsconfig_unix.go.html#1357196">line</a></span><span class="op" id="1357279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357283">if</span>&nbsp;<span class="builtinfunc" id="1357286">len</span><span class="op" id="1357289">(</span><span class="ident" id="1357290"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357291">)</span>&nbsp;<span class="op" id="1357293">&lt;</span>&nbsp;<span class="num" id="1357295">1</span>&nbsp;<span class="op" id="1357297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357302">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357317">switch</span>&nbsp;<span class="ident" id="1357324"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357325">[</span><span class="num" id="1357326">0</span><span class="op" id="1357327">]</span>&nbsp;<span class="op" id="1357329">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357333">case</span>&nbsp;<span class="string" id="1357338">&#34;nameserver&#34;</span><span class="op" id="1357350">:</span>&nbsp;<span class="comment" id="1357352">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357378">if</span>&nbsp;<span class="builtinfunc" id="1357381">len</span><span class="op" id="1357384">(</span><span class="ident" id="1357385"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357386">)</span>&nbsp;<span class="op" id="1357388">&gt;</span>&nbsp;<span class="num" id="1357390">1</span>&nbsp;<span class="op" id="1357392">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1357395">len</span><span class="op" id="1357398">(</span><span class="ident" id="1357399"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357403">.</span><span class="ident" id="1357404">servers</span><span class="op" id="1357411">)</span>&nbsp;<span class="op" id="1357413">&lt;</span>&nbsp;<span class="num" id="1357415">3</span>&nbsp;<span class="op" id="1357417">{</span>&nbsp;<span class="comment" id="1357419">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357456">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357504">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357554">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357576">if</span>&nbsp;<span class="ident" id="1357579"><a href="/net/ip.go.html#1427725">parseIPv4</a></span><span class="op" id="1357588">(</span><span class="ident" id="1357589"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357590">[</span><span class="num" id="1357591">1</span><span class="op" id="1357592">]</span><span class="op" id="1357593">)</span>&nbsp;<span class="op" id="1357595">!=</span>&nbsp;<span class="ident" id="1357598">nil</span>&nbsp;<span class="op" id="1357602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357609"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357613">.</span><span class="ident" id="1357614">servers</span>&nbsp;<span class="op" id="1357622">=</span>&nbsp;<span class="builtinfunc" id="1357624">append</span><span class="op" id="1357630">(</span><span class="ident" id="1357631"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357635">.</span><span class="ident" id="1357636">servers</span><span class="op" id="1357643">,</span>&nbsp;<span class="ident" id="1357645"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357646">[</span><span class="num" id="1357647">1</span><span class="op" id="1357648">]</span><span class="op" id="1357649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357655">}</span>&nbsp;<span class="keyword" id="1357657">else</span>&nbsp;<span class="keyword" id="1357662">if</span>&nbsp;<span class="ident" id="1357665">ip</span><span class="op" id="1357667">,</span>&nbsp;<span class="ident" id="1357669">_</span>&nbsp;<span class="op" id="1357671">:=</span>&nbsp;<span class="ident" id="1357674"><a href="/net/ip.go.html#1428351">parseIPv6</a></span><span class="op" id="1357683">(</span><span class="ident" id="1357684"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357685">[</span><span class="num" id="1357686">1</span><span class="op" id="1357687">]</span><span class="op" id="1357688">,</span>&nbsp;<span class="builtintype" id="1357690">true</span><span class="op" id="1357694">)</span><span class="op" id="1357695">;</span>&nbsp;<span class="ident" id="1357697"><a href="/net/dnsconfig_unix.go.html#1357665">ip</a></span>&nbsp;<span class="op" id="1357700">!=</span>&nbsp;<span class="ident" id="1357703">nil</span>&nbsp;<span class="op" id="1357707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357714"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357718">.</span><span class="ident" id="1357719">servers</span>&nbsp;<span class="op" id="1357727">=</span>&nbsp;<span class="builtinfunc" id="1357729">append</span><span class="op" id="1357735">(</span><span class="ident" id="1357736"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357740">.</span><span class="ident" id="1357741">servers</span><span class="op" id="1357748">,</span>&nbsp;<span class="ident" id="1357750"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357751">[</span><span class="num" id="1357752">1</span><span class="op" id="1357753">]</span><span class="op" id="1357754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357760">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357770">case</span>&nbsp;<span class="string" id="1357775">&#34;domain&#34;</span><span class="op" id="1357783">:</span>&nbsp;<span class="comment" id="1357785">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357827">if</span>&nbsp;<span class="builtinfunc" id="1357830">len</span><span class="op" id="1357833">(</span><span class="ident" id="1357834"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357835">)</span>&nbsp;<span class="op" id="1357837">&gt;</span>&nbsp;<span class="num" id="1357839">1</span>&nbsp;<span class="op" id="1357841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357847"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357851">.</span><span class="ident" id="1357852">search</span>&nbsp;<span class="op" id="1357859">=</span>&nbsp;<span class="op" id="1357861">[</span><span class="op" id="1357862">]</span><span class="builtintype" id="1357863">string</span><span class="op" id="1357869">{</span><span class="ident" id="1357870"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357871">[</span><span class="num" id="1357872">1</span><span class="op" id="1357873">]</span><span class="op" id="1357874">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357884">case</span>&nbsp;<span class="string" id="1357889">&#34;search&#34;</span><span class="op" id="1357897">:</span>&nbsp;<span class="comment" id="1357899">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357938"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1357942">.</span><span class="ident" id="1357943">search</span>&nbsp;<span class="op" id="1357950">=</span>&nbsp;<span class="builtinfunc" id="1357952">make</span><span class="op" id="1357956">(</span><span class="op" id="1357957">[</span><span class="op" id="1357958">]</span><span class="builtintype" id="1357959">string</span><span class="op" id="1357965">,</span>&nbsp;<span class="builtinfunc" id="1357967">len</span><span class="op" id="1357970">(</span><span class="ident" id="1357971"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1357972">)</span><span class="op" id="1357973">-</span><span class="num" id="1357974">1</span><span class="op" id="1357975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357980">for</span>&nbsp;<span class="ident" id="1357984">i</span>&nbsp;<span class="op" id="1357986">:=</span>&nbsp;<span class="num" id="1357989">0</span><span class="op" id="1357990">;</span>&nbsp;<span class="ident" id="1357992"><a href="/net/dnsconfig_unix.go.html#1357984">i</a></span>&nbsp;<span class="op" id="1357994">&lt;</span>&nbsp;<span class="builtinfunc" id="1357996">len</span><span class="op" id="1357999">(</span><span class="ident" id="1358000"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358004">.</span><span class="ident" id="1358005">search</span><span class="op" id="1358011">)</span><span class="op" id="1358012">;</span>&nbsp;<span class="ident" id="1358014"><a href="/net/dnsconfig_unix.go.html#1357984">i</a></span><span class="op" id="1358015">++</span>&nbsp;<span class="op" id="1358018">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358024"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358028">.</span><span class="ident" id="1358029">search</span><span class="op" id="1358035">[</span><span class="ident" id="1358036"><a href="/net/dnsconfig_unix.go.html#1357984">i</a></span><span class="op" id="1358037">]</span>&nbsp;<span class="op" id="1358039">=</span>&nbsp;<span class="ident" id="1358041"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1358042">[</span><span class="ident" id="1358043"><a href="/net/dnsconfig_unix.go.html#1357984">i</a></span><span class="op" id="1358044">+</span><span class="num" id="1358045">1</span><span class="op" id="1358046">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358056">case</span>&nbsp;<span class="string" id="1358061">&#34;options&#34;</span><span class="op" id="1358070">:</span>&nbsp;<span class="comment" id="1358072">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358092">for</span>&nbsp;<span class="ident" id="1358096">i</span>&nbsp;<span class="op" id="1358098">:=</span>&nbsp;<span class="num" id="1358101">1</span><span class="op" id="1358102">;</span>&nbsp;<span class="ident" id="1358104"><a href="/net/dnsconfig_unix.go.html#1358096">i</a></span>&nbsp;<span class="op" id="1358106">&lt;</span>&nbsp;<span class="builtinfunc" id="1358108">len</span><span class="op" id="1358111">(</span><span class="ident" id="1358112"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1358113">)</span><span class="op" id="1358114">;</span>&nbsp;<span class="ident" id="1358116"><a href="/net/dnsconfig_unix.go.html#1358096">i</a></span><span class="op" id="1358117">++</span>&nbsp;<span class="op" id="1358120">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358126">s</span>&nbsp;<span class="op" id="1358128">:=</span>&nbsp;<span class="ident" id="1358131"><a href="/net/dnsconfig_unix.go.html#1357260">f</a></span><span class="op" id="1358132">[</span><span class="ident" id="1358133"><a href="/net/dnsconfig_unix.go.html#1358096">i</a></span><span class="op" id="1358134">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358140">switch</span>&nbsp;<span class="op" id="1358147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358153">case</span>&nbsp;<span class="ident" id="1358158"><a href="/net/dnsconfig_unix.go.html#1358596">hasPrefix</a></span><span class="op" id="1358167">(</span><span class="ident" id="1358168"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358169">,</span>&nbsp;<span class="string" id="1358171">&#34;ndots:&#34;</span><span class="op" id="1358179">)</span><span class="op" id="1358180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358187">n</span><span class="op" id="1358188">,</span>&nbsp;<span class="ident" id="1358190">_</span><span class="op" id="1358191">,</span>&nbsp;<span class="ident" id="1358193">_</span>&nbsp;<span class="op" id="1358195">:=</span>&nbsp;<span class="ident" id="1358198"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1358202">(</span><span class="ident" id="1358203"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358204">,</span>&nbsp;<span class="num" id="1358206">6</span><span class="op" id="1358207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358214">if</span>&nbsp;<span class="ident" id="1358217"><a href="/net/dnsconfig_unix.go.html#1358187">n</a></span>&nbsp;<span class="op" id="1358219">&lt;</span>&nbsp;<span class="num" id="1358221">1</span>&nbsp;<span class="op" id="1358223">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358231"><a href="/net/dnsconfig_unix.go.html#1358187">n</a></span>&nbsp;<span class="op" id="1358233">=</span>&nbsp;<span class="num" id="1358235">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358249"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358253">.</span><span class="ident" id="1358254">ndots</span>&nbsp;<span class="op" id="1358260">=</span>&nbsp;<span class="ident" id="1358262"><a href="/net/dnsconfig_unix.go.html#1358187">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358268">case</span>&nbsp;<span class="ident" id="1358273"><a href="/net/dnsconfig_unix.go.html#1358596">hasPrefix</a></span><span class="op" id="1358282">(</span><span class="ident" id="1358283"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358284">,</span>&nbsp;<span class="string" id="1358286">&#34;timeout:&#34;</span><span class="op" id="1358296">)</span><span class="op" id="1358297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358304">n</span><span class="op" id="1358305">,</span>&nbsp;<span class="ident" id="1358307">_</span><span class="op" id="1358308">,</span>&nbsp;<span class="ident" id="1358310">_</span>&nbsp;<span class="op" id="1358312">:=</span>&nbsp;<span class="ident" id="1358315"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1358319">(</span><span class="ident" id="1358320"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358321">,</span>&nbsp;<span class="num" id="1358323">8</span><span class="op" id="1358324">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358331">if</span>&nbsp;<span class="ident" id="1358334"><a href="/net/dnsconfig_unix.go.html#1358304">n</a></span>&nbsp;<span class="op" id="1358336">&lt;</span>&nbsp;<span class="num" id="1358338">1</span>&nbsp;<span class="op" id="1358340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358348"><a href="/net/dnsconfig_unix.go.html#1358304">n</a></span>&nbsp;<span class="op" id="1358350">=</span>&nbsp;<span class="num" id="1358352">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358366"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358370">.</span><span class="ident" id="1358371">timeout</span>&nbsp;<span class="op" id="1358379">=</span>&nbsp;<span class="ident" id="1358381"><a href="/net/dnsconfig_unix.go.html#1358304">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358387">case</span>&nbsp;<span class="ident" id="1358392"><a href="/net/dnsconfig_unix.go.html#1358596">hasPrefix</a></span><span class="op" id="1358401">(</span><span class="ident" id="1358402"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358403">,</span>&nbsp;<span class="string" id="1358405">&#34;attempts:&#34;</span><span class="op" id="1358416">)</span><span class="op" id="1358417">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358424">n</span><span class="op" id="1358425">,</span>&nbsp;<span class="ident" id="1358427">_</span><span class="op" id="1358428">,</span>&nbsp;<span class="ident" id="1358430">_</span>&nbsp;<span class="op" id="1358432">:=</span>&nbsp;<span class="ident" id="1358435"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1358439">(</span><span class="ident" id="1358440"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span><span class="op" id="1358441">,</span>&nbsp;<span class="num" id="1358443">9</span><span class="op" id="1358444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358451">if</span>&nbsp;<span class="ident" id="1358454"><a href="/net/dnsconfig_unix.go.html#1358424">n</a></span>&nbsp;<span class="op" id="1358456">&lt;</span>&nbsp;<span class="num" id="1358458">1</span>&nbsp;<span class="op" id="1358460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358468"><a href="/net/dnsconfig_unix.go.html#1358424">n</a></span>&nbsp;<span class="op" id="1358470">=</span>&nbsp;<span class="num" id="1358472">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358486"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358490">.</span><span class="ident" id="1358491">attempts</span>&nbsp;<span class="op" id="1358500">=</span>&nbsp;<span class="ident" id="1358502"><a href="/net/dnsconfig_unix.go.html#1358424">n</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358508">case</span>&nbsp;<span class="ident" id="1358513"><a href="/net/dnsconfig_unix.go.html#1358126">s</a></span>&nbsp;<span class="op" id="1358515">==</span>&nbsp;<span class="string" id="1358518">&#34;rotate&#34;</span><span class="op" id="1358526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358533"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358537">.</span><span class="ident" id="1358538">rotate</span>&nbsp;<span class="op" id="1358545">=</span>&nbsp;<span class="builtintype" id="1358547">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358565">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358571">return</span>&nbsp;<span class="ident" id="1358578"><a href="/net/dnsconfig_unix.go.html#1357123">conf</a></span><span class="op" id="1358582">,</span>&nbsp;<span class="ident" id="1358584">nil</span><br>
<span class="lineno"></span><span class="op" id="1358588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1358591">func</span>&nbsp;<span class="ident" id="1358596">hasPrefix</span><span class="op" id="1358605">(</span><span class="ident" id="1358606">s</span><span class="op" id="1358607">,</span>&nbsp;<span class="ident" id="1358609">prefix</span>&nbsp;<span class="builtintype" id="1358616">string</span><span class="op" id="1358622">)</span>&nbsp;<span class="builtintype" id="1358624">bool</span>&nbsp;<span class="op" id="1358629">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358632">return</span>&nbsp;<span class="builtinfunc" id="1358639">len</span><span class="op" id="1358642">(</span><span class="ident" id="1358643"><a href="/net/dnsconfig_unix.go.html#1358606">s</a></span><span class="op" id="1358644">)</span>&nbsp;<span class="op" id="1358646">&gt;=</span>&nbsp;<span class="builtinfunc" id="1358649">len</span><span class="op" id="1358652">(</span><span class="ident" id="1358653"><a href="/net/dnsconfig_unix.go.html#1358609">prefix</a></span><span class="op" id="1358659">)</span>&nbsp;<span class="op" id="1358661">&amp;&amp;</span>&nbsp;<span class="ident" id="1358664"><a href="/net/dnsconfig_unix.go.html#1358606">s</a></span><span class="op" id="1358665">[</span><span class="op" id="1358666">:</span><span class="builtinfunc" id="1358667">len</span><span class="op" id="1358670">(</span><span class="ident" id="1358671"><a href="/net/dnsconfig_unix.go.html#1358609">prefix</a></span><span class="op" id="1358677">)</span><span class="op" id="1358678">]</span>&nbsp;<span class="op" id="1358680">==</span>&nbsp;<span class="ident" id="1358683"><a href="/net/dnsconfig_unix.go.html#1358609">prefix</a></span><br>
<span class="lineno"></span><span class="op" id="1358690">}</span>
</div>
</body>
</html>
