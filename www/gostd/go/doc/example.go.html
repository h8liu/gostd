<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5821671">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5821726">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5821780">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5821831">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5821877">package</span>&nbsp;<span class="ident" id="5821885">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5821890">import</span>&nbsp;<span class="op" id="5821897">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821900">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821910">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821922">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821930">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821940">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821948">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821959">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821970">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5821981">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5821996">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5821999">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5822069">type</span>&nbsp;<span class="ident" id="5822074">Example</span>&nbsp;<span class="keyword" id="5822082">struct</span>&nbsp;<span class="op" id="5822089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822092">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5822104">string</span>&nbsp;<span class="comment" id="5822111">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822150">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5822162">string</span>&nbsp;<span class="comment" id="5822169">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822201">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5822213">ast</span><span class="op" id="5822216">.</span><span class="ident" id="5822217">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822223">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5822235">*</span><span class="ident" id="5822236">ast</span><span class="op" id="5822239">.</span><span class="ident" id="5822240">File</span>&nbsp;<span class="comment" id="5822245">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822288">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5822300">[</span><span class="op" id="5822301">]</span><span class="op" id="5822302">*</span><span class="ident" id="5822303">ast</span><span class="op" id="5822306">.</span><span class="ident" id="5822307">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822321">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5822333">string</span>&nbsp;<span class="comment" id="5822340">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822360">EmptyOutput</span>&nbsp;<span class="builtintype" id="5822372">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5822379">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5822403">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5822415">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5822422">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="5822452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5822455">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5822530">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="5822607">//</span><br>
<span class="lineno"></span><span class="comment" id="5822610">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5822680">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5822755">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="5822773">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="5822849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5822925">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="5822988">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5823062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5823138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="5823211">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="5823245">func</span>&nbsp;<span class="ident" id="5823250">Examples</span><span class="op" id="5823258">(</span><span class="ident" id="5823259">files</span>&nbsp;<span class="op" id="5823265">...</span><span class="op" id="5823268">*</span><span class="ident" id="5823269">ast</span><span class="op" id="5823272">.</span><span class="ident" id="5823273">File</span><span class="op" id="5823277">)</span>&nbsp;<span class="op" id="5823279">[</span><span class="op" id="5823280">]</span><span class="op" id="5823281">*</span><span class="ident" id="5823282">Example</span>&nbsp;<span class="op" id="5823290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823293">var</span>&nbsp;<span class="ident" id="5823297">list</span>&nbsp;<span class="op" id="5823302">[</span><span class="op" id="5823303">]</span><span class="op" id="5823304">*</span><span class="ident" id="5823305">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823314">for</span>&nbsp;<span class="ident" id="5823318">_</span><span class="op" id="5823319">,</span>&nbsp;<span class="ident" id="5823321">file</span>&nbsp;<span class="op" id="5823326">:=</span>&nbsp;<span class="keyword" id="5823329">range</span>&nbsp;<span class="ident" id="5823335">files</span>&nbsp;<span class="op" id="5823341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823345">hasTests</span>&nbsp;<span class="op" id="5823354">:=</span>&nbsp;<span class="builtintype" id="5823357">false</span>&nbsp;<span class="comment" id="5823363">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823402">numDecl</span>&nbsp;<span class="op" id="5823410">:=</span>&nbsp;<span class="num" id="5823413">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5823420">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823471">var</span>&nbsp;<span class="ident" id="5823475">flist</span>&nbsp;<span class="op" id="5823481">[</span><span class="op" id="5823482">]</span><span class="op" id="5823483">*</span><span class="ident" id="5823484">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823494">for</span>&nbsp;<span class="ident" id="5823498">_</span><span class="op" id="5823499">,</span>&nbsp;<span class="ident" id="5823501">decl</span>&nbsp;<span class="op" id="5823506">:=</span>&nbsp;<span class="keyword" id="5823509">range</span>&nbsp;<span class="ident" id="5823515">file</span><span class="op" id="5823519">.</span><span class="ident" id="5823520">Decls</span>&nbsp;<span class="op" id="5823526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823531">if</span>&nbsp;<span class="ident" id="5823534">g</span><span class="op" id="5823535">,</span>&nbsp;<span class="ident" id="5823537">ok</span>&nbsp;<span class="op" id="5823540">:=</span>&nbsp;<span class="ident" id="5823543">decl</span><span class="op" id="5823547">.</span><span class="op" id="5823548">(</span><span class="op" id="5823549">*</span><span class="ident" id="5823550">ast</span><span class="op" id="5823553">.</span><span class="ident" id="5823554">GenDecl</span><span class="op" id="5823561">)</span><span class="op" id="5823562">;</span>&nbsp;<span class="ident" id="5823564">ok</span>&nbsp;<span class="op" id="5823567">&amp;&amp;</span>&nbsp;<span class="ident" id="5823570">g</span><span class="op" id="5823571">.</span><span class="ident" id="5823572">Tok</span>&nbsp;<span class="op" id="5823576">!=</span>&nbsp;<span class="ident" id="5823579">token</span><span class="op" id="5823584">.</span><span class="ident" id="5823585">IMPORT</span>&nbsp;<span class="op" id="5823592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823598">numDecl</span><span class="op" id="5823605">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823612">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5823624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823629">f</span><span class="op" id="5823630">,</span>&nbsp;<span class="ident" id="5823632">ok</span>&nbsp;<span class="op" id="5823635">:=</span>&nbsp;<span class="ident" id="5823638">decl</span><span class="op" id="5823642">.</span><span class="op" id="5823643">(</span><span class="op" id="5823644">*</span><span class="ident" id="5823645">ast</span><span class="op" id="5823648">.</span><span class="ident" id="5823649">FuncDecl</span><span class="op" id="5823657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823662">if</span>&nbsp;<span class="op" id="5823665">!</span><span class="ident" id="5823666">ok</span>&nbsp;<span class="op" id="5823669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823675">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5823687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823692">numDecl</span><span class="op" id="5823699">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823705">name</span>&nbsp;<span class="op" id="5823710">:=</span>&nbsp;<span class="ident" id="5823713">f</span><span class="op" id="5823714">.</span><span class="ident" id="5823715">Name</span><span class="op" id="5823719">.</span><span class="ident" id="5823720">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823728">if</span>&nbsp;<span class="ident" id="5823731">isTest</span><span class="op" id="5823737">(</span><span class="ident" id="5823738">name</span><span class="op" id="5823742">,</span>&nbsp;<span class="string" id="5823744">&#34;Test&#34;</span><span class="op" id="5823750">)</span>&nbsp;<span class="op" id="5823752">||</span>&nbsp;<span class="ident" id="5823755">isTest</span><span class="op" id="5823761">(</span><span class="ident" id="5823762">name</span><span class="op" id="5823766">,</span>&nbsp;<span class="string" id="5823768">&#34;Benchmark&#34;</span><span class="op" id="5823779">)</span>&nbsp;<span class="op" id="5823781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823787">hasTests</span>&nbsp;<span class="op" id="5823796">=</span>&nbsp;<span class="builtintype" id="5823798">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823807">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5823819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823824">if</span>&nbsp;<span class="op" id="5823827">!</span><span class="ident" id="5823828">isTest</span><span class="op" id="5823834">(</span><span class="ident" id="5823835">name</span><span class="op" id="5823839">,</span>&nbsp;<span class="string" id="5823841">&#34;Example&#34;</span><span class="op" id="5823850">)</span>&nbsp;<span class="op" id="5823852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823858">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5823870">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823875">var</span>&nbsp;<span class="ident" id="5823879">doc</span>&nbsp;<span class="builtintype" id="5823883">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5823893">if</span>&nbsp;<span class="ident" id="5823896">f</span><span class="op" id="5823897">.</span><span class="ident" id="5823898">Doc</span>&nbsp;<span class="op" id="5823902">!=</span>&nbsp;<span class="ident" id="5823905">nil</span>&nbsp;<span class="op" id="5823909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823915">doc</span>&nbsp;<span class="op" id="5823919">=</span>&nbsp;<span class="ident" id="5823921">f</span><span class="op" id="5823922">.</span><span class="ident" id="5823923">Doc</span><span class="op" id="5823926">.</span><span class="ident" id="5823927">Text</span><span class="op" id="5823931">(</span><span class="op" id="5823932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5823937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5823942">output</span><span class="op" id="5823948">,</span>&nbsp;<span class="ident" id="5823950">hasOutput</span>&nbsp;<span class="op" id="5823960">:=</span>&nbsp;<span class="ident" id="5823963">exampleOutput</span><span class="op" id="5823976">(</span><span class="ident" id="5823977">f</span><span class="op" id="5823978">.</span><span class="ident" id="5823979">Body</span><span class="op" id="5823983">,</span>&nbsp;<span class="ident" id="5823985">file</span><span class="op" id="5823989">.</span><span class="ident" id="5823990">Comments</span><span class="op" id="5823998">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824003">flist</span>&nbsp;<span class="op" id="5824009">=</span>&nbsp;<span class="builtinfunc" id="5824011">append</span><span class="op" id="5824017">(</span><span class="ident" id="5824018">flist</span><span class="op" id="5824023">,</span>&nbsp;<span class="op" id="5824025">&amp;</span><span class="ident" id="5824026">Example</span><span class="op" id="5824033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824039">Name</span><span class="op" id="5824043">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824052">name</span><span class="op" id="5824056">[</span><span class="builtinfunc" id="5824057">len</span><span class="op" id="5824060">(</span><span class="string" id="5824061">&#34;Example&#34;</span><span class="op" id="5824070">)</span><span class="op" id="5824071">:</span><span class="op" id="5824072">]</span><span class="op" id="5824073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824079">Doc</span><span class="op" id="5824082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824092">doc</span><span class="op" id="5824095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824101">Code</span><span class="op" id="5824105">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824114">f</span><span class="op" id="5824115">.</span><span class="ident" id="5824116">Body</span><span class="op" id="5824120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824126">Play</span><span class="op" id="5824130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824139">playExample</span><span class="op" id="5824150">(</span><span class="ident" id="5824151">file</span><span class="op" id="5824155">,</span>&nbsp;<span class="ident" id="5824157">f</span><span class="op" id="5824158">.</span><span class="ident" id="5824159">Body</span><span class="op" id="5824163">)</span><span class="op" id="5824164">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824170">Comments</span><span class="op" id="5824178">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824183">file</span><span class="op" id="5824187">.</span><span class="ident" id="5824188">Comments</span><span class="op" id="5824196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824202">Output</span><span class="op" id="5824208">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5824215">output</span><span class="op" id="5824221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824227">EmptyOutput</span><span class="op" id="5824238">:</span>&nbsp;<span class="ident" id="5824240">output</span>&nbsp;<span class="op" id="5824247">==</span>&nbsp;<span class="string" id="5824250">&#34;&#34;</span>&nbsp;<span class="op" id="5824253">&amp;&amp;</span>&nbsp;<span class="ident" id="5824256">hasOutput</span><span class="op" id="5824265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824271">Order</span><span class="op" id="5824276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5824284">len</span><span class="op" id="5824287">(</span><span class="ident" id="5824288">flist</span><span class="op" id="5824293">)</span><span class="op" id="5824294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5824299">}</span><span class="op" id="5824300">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5824304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5824308">if</span>&nbsp;<span class="op" id="5824311">!</span><span class="ident" id="5824312">hasTests</span>&nbsp;<span class="op" id="5824321">&amp;&amp;</span>&nbsp;<span class="ident" id="5824324">numDecl</span>&nbsp;<span class="op" id="5824332">&gt;</span>&nbsp;<span class="num" id="5824334">1</span>&nbsp;<span class="op" id="5824336">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5824339">len</span><span class="op" id="5824342">(</span><span class="ident" id="5824343">flist</span><span class="op" id="5824348">)</span>&nbsp;<span class="op" id="5824350">==</span>&nbsp;<span class="num" id="5824353">1</span>&nbsp;<span class="op" id="5824355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5824360">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5824415">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5824467">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824520">flist</span><span class="op" id="5824525">[</span><span class="num" id="5824526">0</span><span class="op" id="5824527">]</span><span class="op" id="5824528">.</span><span class="ident" id="5824529">Code</span>&nbsp;<span class="op" id="5824534">=</span>&nbsp;<span class="ident" id="5824536">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824544">flist</span><span class="op" id="5824549">[</span><span class="num" id="5824550">0</span><span class="op" id="5824551">]</span><span class="op" id="5824552">.</span><span class="ident" id="5824553">Play</span>&nbsp;<span class="op" id="5824558">=</span>&nbsp;<span class="ident" id="5824560">playExampleFile</span><span class="op" id="5824575">(</span><span class="ident" id="5824576">file</span><span class="op" id="5824580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5824584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824588">list</span>&nbsp;<span class="op" id="5824593">=</span>&nbsp;<span class="builtinfunc" id="5824595">append</span><span class="op" id="5824601">(</span><span class="ident" id="5824602">list</span><span class="op" id="5824606">,</span>&nbsp;<span class="ident" id="5824608">flist</span><span class="op" id="5824613">...</span><span class="op" id="5824616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5824619">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5824622">sort</span><span class="op" id="5824626">.</span><span class="ident" id="5824627">Sort</span><span class="op" id="5824631">(</span><span class="ident" id="5824632">exampleByName</span><span class="op" id="5824645">(</span><span class="ident" id="5824646">list</span><span class="op" id="5824650">)</span><span class="op" id="5824651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5824654">return</span>&nbsp;<span class="ident" id="5824661">list</span><br>
<span class="lineno"></span><span class="op" id="5824666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5824669">var</span>&nbsp;<span class="ident" id="5824673">outputPrefix</span>&nbsp;<span class="op" id="5824686">=</span>&nbsp;<span class="ident" id="5824688">regexp</span><span class="op" id="5824694">.</span><span class="ident" id="5824695">MustCompile</span><span class="op" id="5824706">(</span><span class="string" id="5824707">`(?i)^[[:space:]]*output:`</span><span class="op" id="5824733">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5824736">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="5824813">func</span>&nbsp;<span class="ident" id="5824818">exampleOutput</span><span class="op" id="5824831">(</span><span class="ident" id="5824832">b</span>&nbsp;<span class="op" id="5824834">*</span><span class="ident" id="5824835">ast</span><span class="op" id="5824838">.</span><span class="ident" id="5824839">BlockStmt</span><span class="op" id="5824848">,</span>&nbsp;<span class="ident" id="5824850">comments</span>&nbsp;<span class="op" id="5824859">[</span><span class="op" id="5824860">]</span><span class="op" id="5824861">*</span><span class="ident" id="5824862">ast</span><span class="op" id="5824865">.</span><span class="ident" id="5824866">CommentGroup</span><span class="op" id="5824878">)</span>&nbsp;<span class="op" id="5824880">(</span><span class="ident" id="5824881">output</span>&nbsp;<span class="builtintype" id="5824888">string</span><span class="op" id="5824894">,</span>&nbsp;<span class="ident" id="5824896">ok</span>&nbsp;<span class="builtintype" id="5824899">bool</span><span class="op" id="5824903">)</span>&nbsp;<span class="op" id="5824905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5824908">if</span>&nbsp;<span class="ident" id="5824911">_</span><span class="op" id="5824912">,</span>&nbsp;<span class="ident" id="5824914">last</span>&nbsp;<span class="op" id="5824919">:=</span>&nbsp;<span class="ident" id="5824922">lastComment</span><span class="op" id="5824933">(</span><span class="ident" id="5824934">b</span><span class="op" id="5824935">,</span>&nbsp;<span class="ident" id="5824937">comments</span><span class="op" id="5824945">)</span><span class="op" id="5824946">;</span>&nbsp;<span class="ident" id="5824948">last</span>&nbsp;<span class="op" id="5824953">!=</span>&nbsp;<span class="ident" id="5824956">nil</span>&nbsp;<span class="op" id="5824960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5824964">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5825013">text</span>&nbsp;<span class="op" id="5825018">:=</span>&nbsp;<span class="ident" id="5825021">last</span><span class="op" id="5825025">.</span><span class="ident" id="5825026">Text</span><span class="op" id="5825030">(</span><span class="op" id="5825031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825035">if</span>&nbsp;<span class="ident" id="5825038">loc</span>&nbsp;<span class="op" id="5825042">:=</span>&nbsp;<span class="ident" id="5825045">outputPrefix</span><span class="op" id="5825057">.</span><span class="ident" id="5825058">FindStringIndex</span><span class="op" id="5825073">(</span><span class="ident" id="5825074">text</span><span class="op" id="5825078">)</span><span class="op" id="5825079">;</span>&nbsp;<span class="ident" id="5825081">loc</span>&nbsp;<span class="op" id="5825085">!=</span>&nbsp;<span class="ident" id="5825088">nil</span>&nbsp;<span class="op" id="5825092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5825097">text</span>&nbsp;<span class="op" id="5825102">=</span>&nbsp;<span class="ident" id="5825104">text</span><span class="op" id="5825108">[</span><span class="ident" id="5825109">loc</span><span class="op" id="5825112">[</span><span class="num" id="5825113">1</span><span class="op" id="5825114">]</span><span class="op" id="5825115">:</span><span class="op" id="5825116">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5825121">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5825187">text</span>&nbsp;<span class="op" id="5825192">=</span>&nbsp;<span class="ident" id="5825194">strings</span><span class="op" id="5825201">.</span><span class="ident" id="5825202">TrimLeft</span><span class="op" id="5825210">(</span><span class="ident" id="5825211">text</span><span class="op" id="5825215">,</span>&nbsp;<span class="string" id="5825217">&#34;&nbsp;&#34;</span><span class="op" id="5825220">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825225">if</span>&nbsp;<span class="builtinfunc" id="5825228">len</span><span class="op" id="5825231">(</span><span class="ident" id="5825232">text</span><span class="op" id="5825236">)</span>&nbsp;<span class="op" id="5825238">&gt;</span>&nbsp;<span class="num" id="5825240">0</span>&nbsp;<span class="op" id="5825242">&amp;&amp;</span>&nbsp;<span class="ident" id="5825245">text</span><span class="op" id="5825249">[</span><span class="num" id="5825250">0</span><span class="op" id="5825251">]</span>&nbsp;<span class="op" id="5825253">==</span>&nbsp;<span class="string" id="5825256">&#39;\n&#39;</span>&nbsp;<span class="op" id="5825261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5825267">text</span>&nbsp;<span class="op" id="5825272">=</span>&nbsp;<span class="ident" id="5825274">text</span><span class="op" id="5825278">[</span><span class="num" id="5825279">1</span><span class="op" id="5825280">:</span><span class="op" id="5825281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5825286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825291">return</span>&nbsp;<span class="ident" id="5825298">text</span><span class="op" id="5825302">,</span>&nbsp;<span class="builtintype" id="5825304">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5825311">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5825314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825317">return</span>&nbsp;<span class="string" id="5825324">&#34;&#34;</span><span class="op" id="5825326">,</span>&nbsp;<span class="builtintype" id="5825328">false</span>&nbsp;<span class="comment" id="5825334">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="5825363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5825366">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="5825437">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5825508">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="5825557">func</span>&nbsp;<span class="ident" id="5825562">isTest</span><span class="op" id="5825568">(</span><span class="ident" id="5825569">name</span><span class="op" id="5825573">,</span>&nbsp;<span class="ident" id="5825575">prefix</span>&nbsp;<span class="builtintype" id="5825582">string</span><span class="op" id="5825588">)</span>&nbsp;<span class="builtintype" id="5825590">bool</span>&nbsp;<span class="op" id="5825595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825598">if</span>&nbsp;<span class="op" id="5825601">!</span><span class="ident" id="5825602">strings</span><span class="op" id="5825609">.</span><span class="ident" id="5825610">HasPrefix</span><span class="op" id="5825619">(</span><span class="ident" id="5825620">name</span><span class="op" id="5825624">,</span>&nbsp;<span class="ident" id="5825626">prefix</span><span class="op" id="5825632">)</span>&nbsp;<span class="op" id="5825634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825638">return</span>&nbsp;<span class="builtintype" id="5825645">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5825652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825655">if</span>&nbsp;<span class="builtinfunc" id="5825658">len</span><span class="op" id="5825661">(</span><span class="ident" id="5825662">name</span><span class="op" id="5825666">)</span>&nbsp;<span class="op" id="5825668">==</span>&nbsp;<span class="builtinfunc" id="5825671">len</span><span class="op" id="5825674">(</span><span class="ident" id="5825675">prefix</span><span class="op" id="5825681">)</span>&nbsp;<span class="op" id="5825683">{</span>&nbsp;<span class="comment" id="5825685">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825703">return</span>&nbsp;<span class="builtintype" id="5825710">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5825716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5825719">rune</span><span class="op" id="5825723">,</span>&nbsp;<span class="ident" id="5825725">_</span>&nbsp;<span class="op" id="5825727">:=</span>&nbsp;<span class="ident" id="5825730">utf8</span><span class="op" id="5825734">.</span><span class="ident" id="5825735">DecodeRuneInString</span><span class="op" id="5825753">(</span><span class="ident" id="5825754">name</span><span class="op" id="5825758">[</span><span class="builtinfunc" id="5825759">len</span><span class="op" id="5825762">(</span><span class="ident" id="5825763">prefix</span><span class="op" id="5825769">)</span><span class="op" id="5825770">:</span><span class="op" id="5825771">]</span><span class="op" id="5825772">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5825775">return</span>&nbsp;<span class="op" id="5825782">!</span><span class="ident" id="5825783">unicode</span><span class="op" id="5825790">.</span><span class="ident" id="5825791">IsLower</span><span class="op" id="5825798">(</span><span class="builtintype" id="5825799">rune</span><span class="op" id="5825803">)</span><br>
<span class="lineno"></span><span class="op" id="5825805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5825808">type</span>&nbsp;<span class="ident" id="5825813">exampleByName</span>&nbsp;<span class="op" id="5825827">[</span><span class="op" id="5825828">]</span><span class="op" id="5825829">*</span><span class="ident" id="5825830">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5825839">func</span>&nbsp;<span class="op" id="5825844">(</span><span class="ident" id="5825845">s</span>&nbsp;<span class="ident" id="5825847">exampleByName</span><span class="op" id="5825860">)</span>&nbsp;<span class="ident" id="5825862">Len</span><span class="op" id="5825865">(</span><span class="op" id="5825866">)</span>&nbsp;<span class="builtintype" id="5825868">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5825882">{</span>&nbsp;<span class="keyword" id="5825884">return</span>&nbsp;<span class="builtinfunc" id="5825891">len</span><span class="op" id="5825894">(</span><span class="ident" id="5825895">s</span><span class="op" id="5825896">)</span>&nbsp;<span class="op" id="5825898">}</span><br>
<span class="lineno"></span><span class="keyword" id="5825900">func</span>&nbsp;<span class="op" id="5825905">(</span><span class="ident" id="5825906">s</span>&nbsp;<span class="ident" id="5825908">exampleByName</span><span class="op" id="5825921">)</span>&nbsp;<span class="ident" id="5825923">Swap</span><span class="op" id="5825927">(</span><span class="ident" id="5825928">i</span><span class="op" id="5825929">,</span>&nbsp;<span class="ident" id="5825931">j</span>&nbsp;<span class="builtintype" id="5825933">int</span><span class="op" id="5825936">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5825943">{</span>&nbsp;<span class="ident" id="5825945">s</span><span class="op" id="5825946">[</span><span class="ident" id="5825947">i</span><span class="op" id="5825948">]</span><span class="op" id="5825949">,</span>&nbsp;<span class="ident" id="5825951">s</span><span class="op" id="5825952">[</span><span class="ident" id="5825953">j</span><span class="op" id="5825954">]</span>&nbsp;<span class="op" id="5825956">=</span>&nbsp;<span class="ident" id="5825958">s</span><span class="op" id="5825959">[</span><span class="ident" id="5825960">j</span><span class="op" id="5825961">]</span><span class="op" id="5825962">,</span>&nbsp;<span class="ident" id="5825964">s</span><span class="op" id="5825965">[</span><span class="ident" id="5825966">i</span><span class="op" id="5825967">]</span>&nbsp;<span class="op" id="5825969">}</span><br>
<span class="lineno"></span><span class="keyword" id="5825971">func</span>&nbsp;<span class="op" id="5825976">(</span><span class="ident" id="5825977">s</span>&nbsp;<span class="ident" id="5825979">exampleByName</span><span class="op" id="5825992">)</span>&nbsp;<span class="ident" id="5825994">Less</span><span class="op" id="5825998">(</span><span class="ident" id="5825999">i</span><span class="op" id="5826000">,</span>&nbsp;<span class="ident" id="5826002">j</span>&nbsp;<span class="builtintype" id="5826004">int</span><span class="op" id="5826007">)</span>&nbsp;<span class="builtintype" id="5826009">bool</span>&nbsp;<span class="op" id="5826014">{</span>&nbsp;<span class="keyword" id="5826016">return</span>&nbsp;<span class="ident" id="5826023">s</span><span class="op" id="5826024">[</span><span class="ident" id="5826025">i</span><span class="op" id="5826026">]</span><span class="op" id="5826027">.</span><span class="ident" id="5826028">Name</span>&nbsp;<span class="op" id="5826033">&lt;</span>&nbsp;<span class="ident" id="5826035">s</span><span class="op" id="5826036">[</span><span class="ident" id="5826037">j</span><span class="op" id="5826038">]</span><span class="op" id="5826039">.</span><span class="ident" id="5826040">Name</span>&nbsp;<span class="op" id="5826045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5826048">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="5826113">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5826174">func</span>&nbsp;<span class="ident" id="5826179">playExample</span><span class="op" id="5826190">(</span><span class="ident" id="5826191">file</span>&nbsp;<span class="op" id="5826196">*</span><span class="ident" id="5826197">ast</span><span class="op" id="5826200">.</span><span class="ident" id="5826201">File</span><span class="op" id="5826205">,</span>&nbsp;<span class="ident" id="5826207">body</span>&nbsp;<span class="op" id="5826212">*</span><span class="ident" id="5826213">ast</span><span class="op" id="5826216">.</span><span class="ident" id="5826217">BlockStmt</span><span class="op" id="5826226">)</span>&nbsp;<span class="op" id="5826228">*</span><span class="ident" id="5826229">ast</span><span class="op" id="5826232">.</span><span class="ident" id="5826233">File</span>&nbsp;<span class="op" id="5826238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826241">if</span>&nbsp;<span class="op" id="5826244">!</span><span class="ident" id="5826245">strings</span><span class="op" id="5826252">.</span><span class="ident" id="5826253">HasSuffix</span><span class="op" id="5826262">(</span><span class="ident" id="5826263">file</span><span class="op" id="5826267">.</span><span class="ident" id="5826268">Name</span><span class="op" id="5826272">.</span><span class="ident" id="5826273">Name</span><span class="op" id="5826277">,</span>&nbsp;<span class="string" id="5826279">&#34;_test&#34;</span><span class="op" id="5826286">)</span>&nbsp;<span class="op" id="5826288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826292">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826344">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826372">return</span>&nbsp;<span class="ident" id="5826379">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826388">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826433">topDecls</span>&nbsp;<span class="op" id="5826442">:=</span>&nbsp;<span class="builtinfunc" id="5826445">make</span><span class="op" id="5826449">(</span><span class="keyword" id="5826450">map</span><span class="op" id="5826453">[</span><span class="op" id="5826454">*</span><span class="ident" id="5826455">ast</span><span class="op" id="5826458">.</span><span class="ident" id="5826459">Object</span><span class="op" id="5826465">]</span><span class="builtintype" id="5826466">bool</span><span class="op" id="5826470">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826473">for</span>&nbsp;<span class="ident" id="5826477">_</span><span class="op" id="5826478">,</span>&nbsp;<span class="ident" id="5826480">decl</span>&nbsp;<span class="op" id="5826485">:=</span>&nbsp;<span class="keyword" id="5826488">range</span>&nbsp;<span class="ident" id="5826494">file</span><span class="op" id="5826498">.</span><span class="ident" id="5826499">Decls</span>&nbsp;<span class="op" id="5826505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826509">switch</span>&nbsp;<span class="ident" id="5826516">d</span>&nbsp;<span class="op" id="5826518">:=</span>&nbsp;<span class="ident" id="5826521">decl</span><span class="op" id="5826525">.</span><span class="op" id="5826526">(</span><span class="keyword" id="5826527">type</span><span class="op" id="5826531">)</span>&nbsp;<span class="op" id="5826533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826537">case</span>&nbsp;<span class="op" id="5826542">*</span><span class="ident" id="5826543">ast</span><span class="op" id="5826546">.</span><span class="ident" id="5826547">FuncDecl</span><span class="op" id="5826555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826560">topDecls</span><span class="op" id="5826568">[</span><span class="ident" id="5826569">d</span><span class="op" id="5826570">.</span><span class="ident" id="5826571">Name</span><span class="op" id="5826575">.</span><span class="ident" id="5826576">Obj</span><span class="op" id="5826579">]</span>&nbsp;<span class="op" id="5826581">=</span>&nbsp;<span class="builtintype" id="5826583">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826590">case</span>&nbsp;<span class="op" id="5826595">*</span><span class="ident" id="5826596">ast</span><span class="op" id="5826599">.</span><span class="ident" id="5826600">GenDecl</span><span class="op" id="5826607">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826612">for</span>&nbsp;<span class="ident" id="5826616">_</span><span class="op" id="5826617">,</span>&nbsp;<span class="ident" id="5826619">spec</span>&nbsp;<span class="op" id="5826624">:=</span>&nbsp;<span class="keyword" id="5826627">range</span>&nbsp;<span class="ident" id="5826633">d</span><span class="op" id="5826634">.</span><span class="ident" id="5826635">Specs</span>&nbsp;<span class="op" id="5826641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826647">switch</span>&nbsp;<span class="ident" id="5826654">s</span>&nbsp;<span class="op" id="5826656">:=</span>&nbsp;<span class="ident" id="5826659">spec</span><span class="op" id="5826663">.</span><span class="op" id="5826664">(</span><span class="keyword" id="5826665">type</span><span class="op" id="5826669">)</span>&nbsp;<span class="op" id="5826671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826677">case</span>&nbsp;<span class="op" id="5826682">*</span><span class="ident" id="5826683">ast</span><span class="op" id="5826686">.</span><span class="ident" id="5826687">TypeSpec</span><span class="op" id="5826695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826702">topDecls</span><span class="op" id="5826710">[</span><span class="ident" id="5826711">s</span><span class="op" id="5826712">.</span><span class="ident" id="5826713">Name</span><span class="op" id="5826717">.</span><span class="ident" id="5826718">Obj</span><span class="op" id="5826721">]</span>&nbsp;<span class="op" id="5826723">=</span>&nbsp;<span class="builtintype" id="5826725">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826734">case</span>&nbsp;<span class="op" id="5826739">*</span><span class="ident" id="5826740">ast</span><span class="op" id="5826743">.</span><span class="ident" id="5826744">ValueSpec</span><span class="op" id="5826753">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826760">for</span>&nbsp;<span class="ident" id="5826764">_</span><span class="op" id="5826765">,</span>&nbsp;<span class="ident" id="5826767">id</span>&nbsp;<span class="op" id="5826770">:=</span>&nbsp;<span class="keyword" id="5826773">range</span>&nbsp;<span class="ident" id="5826779">s</span><span class="op" id="5826780">.</span><span class="ident" id="5826781">Names</span>&nbsp;<span class="op" id="5826787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826795">topDecls</span><span class="op" id="5826803">[</span><span class="ident" id="5826804">id</span><span class="op" id="5826806">.</span><span class="ident" id="5826807">Obj</span><span class="op" id="5826810">]</span>&nbsp;<span class="op" id="5826812">=</span>&nbsp;<span class="builtintype" id="5826814">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826835">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5826842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826846">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826914">unresolved</span>&nbsp;<span class="op" id="5826925">:=</span>&nbsp;<span class="builtinfunc" id="5826928">make</span><span class="op" id="5826932">(</span><span class="keyword" id="5826933">map</span><span class="op" id="5826936">[</span><span class="builtintype" id="5826937">string</span><span class="op" id="5826943">]</span><span class="builtintype" id="5826944">bool</span><span class="op" id="5826948">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826951">usesTopDecl</span>&nbsp;<span class="op" id="5826963">:=</span>&nbsp;<span class="builtintype" id="5826966">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5826973">var</span>&nbsp;<span class="ident" id="5826977">inspectFunc</span>&nbsp;<span class="keyword" id="5826989">func</span><span class="op" id="5826993">(</span><span class="ident" id="5826994">ast</span><span class="op" id="5826997">.</span><span class="ident" id="5826998">Node</span><span class="op" id="5827002">)</span>&nbsp;<span class="builtintype" id="5827004">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827010">inspectFunc</span>&nbsp;<span class="op" id="5827022">=</span>&nbsp;<span class="keyword" id="5827024">func</span><span class="op" id="5827028">(</span><span class="ident" id="5827029">n</span>&nbsp;<span class="ident" id="5827031">ast</span><span class="op" id="5827034">.</span><span class="ident" id="5827035">Node</span><span class="op" id="5827039">)</span>&nbsp;<span class="builtintype" id="5827041">bool</span>&nbsp;<span class="op" id="5827046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827050">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827114">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827178">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827224">if</span>&nbsp;<span class="ident" id="5827227">e</span><span class="op" id="5827228">,</span>&nbsp;<span class="ident" id="5827230">ok</span>&nbsp;<span class="op" id="5827233">:=</span>&nbsp;<span class="ident" id="5827236">n</span><span class="op" id="5827237">.</span><span class="op" id="5827238">(</span><span class="op" id="5827239">*</span><span class="ident" id="5827240">ast</span><span class="op" id="5827243">.</span><span class="ident" id="5827244">SelectorExpr</span><span class="op" id="5827256">)</span><span class="op" id="5827257">;</span>&nbsp;<span class="ident" id="5827259">ok</span>&nbsp;<span class="op" id="5827262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827267">ast</span><span class="op" id="5827270">.</span><span class="ident" id="5827271">Inspect</span><span class="op" id="5827278">(</span><span class="ident" id="5827279">e</span><span class="op" id="5827280">.</span><span class="ident" id="5827281">X</span><span class="op" id="5827282">,</span>&nbsp;<span class="ident" id="5827284">inspectFunc</span><span class="op" id="5827295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827300">return</span>&nbsp;<span class="builtintype" id="5827307">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827315">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827319">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827374">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827428">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827452">if</span>&nbsp;<span class="ident" id="5827455">e</span><span class="op" id="5827456">,</span>&nbsp;<span class="ident" id="5827458">ok</span>&nbsp;<span class="op" id="5827461">:=</span>&nbsp;<span class="ident" id="5827464">n</span><span class="op" id="5827465">.</span><span class="op" id="5827466">(</span><span class="op" id="5827467">*</span><span class="ident" id="5827468">ast</span><span class="op" id="5827471">.</span><span class="ident" id="5827472">KeyValueExpr</span><span class="op" id="5827484">)</span><span class="op" id="5827485">;</span>&nbsp;<span class="ident" id="5827487">ok</span>&nbsp;<span class="op" id="5827490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827495">ast</span><span class="op" id="5827498">.</span><span class="ident" id="5827499">Inspect</span><span class="op" id="5827506">(</span><span class="ident" id="5827507">e</span><span class="op" id="5827508">.</span><span class="ident" id="5827509">Value</span><span class="op" id="5827514">,</span>&nbsp;<span class="ident" id="5827516">inspectFunc</span><span class="op" id="5827527">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827532">return</span>&nbsp;<span class="builtintype" id="5827539">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827551">if</span>&nbsp;<span class="ident" id="5827554">id</span><span class="op" id="5827556">,</span>&nbsp;<span class="ident" id="5827558">ok</span>&nbsp;<span class="op" id="5827561">:=</span>&nbsp;<span class="ident" id="5827564">n</span><span class="op" id="5827565">.</span><span class="op" id="5827566">(</span><span class="op" id="5827567">*</span><span class="ident" id="5827568">ast</span><span class="op" id="5827571">.</span><span class="ident" id="5827572">Ident</span><span class="op" id="5827577">)</span><span class="op" id="5827578">;</span>&nbsp;<span class="ident" id="5827580">ok</span>&nbsp;<span class="op" id="5827583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827588">if</span>&nbsp;<span class="ident" id="5827591">id</span><span class="op" id="5827593">.</span><span class="ident" id="5827594">Obj</span>&nbsp;<span class="op" id="5827598">==</span>&nbsp;<span class="ident" id="5827601">nil</span>&nbsp;<span class="op" id="5827605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827611">unresolved</span><span class="op" id="5827621">[</span><span class="ident" id="5827622">id</span><span class="op" id="5827624">.</span><span class="ident" id="5827625">Name</span><span class="op" id="5827629">]</span>&nbsp;<span class="op" id="5827631">=</span>&nbsp;<span class="builtintype" id="5827633">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827641">}</span>&nbsp;<span class="keyword" id="5827643">else</span>&nbsp;<span class="keyword" id="5827648">if</span>&nbsp;<span class="ident" id="5827651">topDecls</span><span class="op" id="5827659">[</span><span class="ident" id="5827660">id</span><span class="op" id="5827662">.</span><span class="ident" id="5827663">Obj</span><span class="op" id="5827666">]</span>&nbsp;<span class="op" id="5827668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827674">usesTopDecl</span>&nbsp;<span class="op" id="5827686">=</span>&nbsp;<span class="builtintype" id="5827688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827704">return</span>&nbsp;<span class="builtintype" id="5827711">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827720">ast</span><span class="op" id="5827723">.</span><span class="ident" id="5827724">Inspect</span><span class="op" id="5827731">(</span><span class="ident" id="5827732">body</span><span class="op" id="5827736">,</span>&nbsp;<span class="ident" id="5827738">inspectFunc</span><span class="op" id="5827749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827752">if</span>&nbsp;<span class="ident" id="5827755">usesTopDecl</span>&nbsp;<span class="op" id="5827767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827771">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827837">return</span>&nbsp;<span class="ident" id="5827844">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5827849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5827853">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827910">for</span>&nbsp;<span class="ident" id="5827914">n</span>&nbsp;<span class="op" id="5827916">:=</span>&nbsp;<span class="keyword" id="5827919">range</span>&nbsp;<span class="ident" id="5827925">unresolved</span>&nbsp;<span class="op" id="5827936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5827940">if</span>&nbsp;<span class="ident" id="5827943">predeclaredTypes</span><span class="op" id="5827959">[</span><span class="ident" id="5827960">n</span><span class="op" id="5827961">]</span>&nbsp;<span class="op" id="5827963">||</span>&nbsp;<span class="ident" id="5827966">predeclaredConstants</span><span class="op" id="5827986">[</span><span class="ident" id="5827987">n</span><span class="op" id="5827988">]</span>&nbsp;<span class="op" id="5827990">||</span>&nbsp;<span class="ident" id="5827993">predeclaredFuncs</span><span class="op" id="5828009">[</span><span class="ident" id="5828010">n</span><span class="op" id="5828011">]</span>&nbsp;<span class="op" id="5828013">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5828018">delete</span><span class="op" id="5828024">(</span><span class="ident" id="5828025">unresolved</span><span class="op" id="5828035">,</span>&nbsp;<span class="ident" id="5828037">n</span><span class="op" id="5828038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828049">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828118">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828185">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828261">namedImports</span>&nbsp;<span class="op" id="5828274">:=</span>&nbsp;<span class="builtinfunc" id="5828277">make</span><span class="op" id="5828281">(</span><span class="keyword" id="5828282">map</span><span class="op" id="5828285">[</span><span class="builtintype" id="5828286">string</span><span class="op" id="5828292">]</span><span class="builtintype" id="5828293">string</span><span class="op" id="5828299">)</span>&nbsp;<span class="comment" id="5828301">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828316">var</span>&nbsp;<span class="ident" id="5828320">blankImports</span>&nbsp;<span class="op" id="5828333">[</span><span class="op" id="5828334">]</span><span class="ident" id="5828335">ast</span><span class="op" id="5828338">.</span><span class="ident" id="5828339">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828356">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828370">for</span>&nbsp;<span class="ident" id="5828374">_</span><span class="op" id="5828375">,</span>&nbsp;<span class="ident" id="5828377">s</span>&nbsp;<span class="op" id="5828379">:=</span>&nbsp;<span class="keyword" id="5828382">range</span>&nbsp;<span class="ident" id="5828388">file</span><span class="op" id="5828392">.</span><span class="ident" id="5828393">Imports</span>&nbsp;<span class="op" id="5828401">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828405">p</span><span class="op" id="5828406">,</span>&nbsp;<span class="ident" id="5828408">err</span>&nbsp;<span class="op" id="5828412">:=</span>&nbsp;<span class="ident" id="5828415">strconv</span><span class="op" id="5828422">.</span><span class="ident" id="5828423">Unquote</span><span class="op" id="5828430">(</span><span class="ident" id="5828431">s</span><span class="op" id="5828432">.</span><span class="ident" id="5828433">Path</span><span class="op" id="5828437">.</span><span class="ident" id="5828438">Value</span><span class="op" id="5828443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828447">if</span>&nbsp;<span class="ident" id="5828450">err</span>&nbsp;<span class="op" id="5828454">!=</span>&nbsp;<span class="ident" id="5828457">nil</span>&nbsp;<span class="op" id="5828461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828466">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828481">n</span>&nbsp;<span class="op" id="5828483">:=</span>&nbsp;<span class="ident" id="5828486">path</span><span class="op" id="5828490">.</span><span class="ident" id="5828491">Base</span><span class="op" id="5828495">(</span><span class="ident" id="5828496">p</span><span class="op" id="5828497">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828501">if</span>&nbsp;<span class="ident" id="5828504">s</span><span class="op" id="5828505">.</span><span class="ident" id="5828506">Name</span>&nbsp;<span class="op" id="5828511">!=</span>&nbsp;<span class="ident" id="5828514">nil</span>&nbsp;<span class="op" id="5828518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828523">n</span>&nbsp;<span class="op" id="5828525">=</span>&nbsp;<span class="ident" id="5828527">s</span><span class="op" id="5828528">.</span><span class="ident" id="5828529">Name</span><span class="op" id="5828533">.</span><span class="ident" id="5828534">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828542">switch</span>&nbsp;<span class="ident" id="5828549">n</span>&nbsp;<span class="op" id="5828551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828556">case</span>&nbsp;<span class="string" id="5828561">&#34;_&#34;</span><span class="op" id="5828564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828570">blankImports</span>&nbsp;<span class="op" id="5828583">=</span>&nbsp;<span class="builtinfunc" id="5828585">append</span><span class="op" id="5828591">(</span><span class="ident" id="5828592">blankImports</span><span class="op" id="5828604">,</span>&nbsp;<span class="ident" id="5828606">s</span><span class="op" id="5828607">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828613">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828625">case</span>&nbsp;<span class="string" id="5828630">&#34;.&#34;</span><span class="op" id="5828633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828639">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828682">return</span>&nbsp;<span class="ident" id="5828689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828696">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828704">if</span>&nbsp;<span class="ident" id="5828707">unresolved</span><span class="op" id="5828717">[</span><span class="ident" id="5828718">n</span><span class="op" id="5828719">]</span>&nbsp;<span class="op" id="5828721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828726">namedImports</span><span class="op" id="5828738">[</span><span class="ident" id="5828739">n</span><span class="op" id="5828740">]</span>&nbsp;<span class="op" id="5828742">=</span>&nbsp;<span class="ident" id="5828744">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5828749">delete</span><span class="op" id="5828755">(</span><span class="ident" id="5828756">unresolved</span><span class="op" id="5828766">,</span>&nbsp;<span class="ident" id="5828768">n</span><span class="op" id="5828769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828773">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828780">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828848">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828892">if</span>&nbsp;<span class="builtinfunc" id="5828895">len</span><span class="op" id="5828898">(</span><span class="ident" id="5828899">unresolved</span><span class="op" id="5828909">)</span>&nbsp;<span class="op" id="5828911">&gt;</span>&nbsp;<span class="num" id="5828913">0</span>&nbsp;<span class="op" id="5828915">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828919">return</span>&nbsp;<span class="ident" id="5828926">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5828931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828935">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5828989">var</span>&nbsp;<span class="ident" id="5828993">comments</span>&nbsp;<span class="op" id="5829002">[</span><span class="op" id="5829003">]</span><span class="op" id="5829004">*</span><span class="ident" id="5829005">ast</span><span class="op" id="5829008">.</span><span class="ident" id="5829009">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829023">for</span>&nbsp;<span class="ident" id="5829027">_</span><span class="op" id="5829028">,</span>&nbsp;<span class="ident" id="5829030">s</span>&nbsp;<span class="op" id="5829032">:=</span>&nbsp;<span class="keyword" id="5829035">range</span>&nbsp;<span class="ident" id="5829041">blankImports</span>&nbsp;<span class="op" id="5829054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829058">if</span>&nbsp;<span class="ident" id="5829061">c</span>&nbsp;<span class="op" id="5829063">:=</span>&nbsp;<span class="ident" id="5829066">s</span><span class="op" id="5829067">.</span><span class="op" id="5829068">(</span><span class="op" id="5829069">*</span><span class="ident" id="5829070">ast</span><span class="op" id="5829073">.</span><span class="ident" id="5829074">ImportSpec</span><span class="op" id="5829084">)</span><span class="op" id="5829085">.</span><span class="ident" id="5829086">Doc</span><span class="op" id="5829089">;</span>&nbsp;<span class="ident" id="5829091">c</span>&nbsp;<span class="op" id="5829093">!=</span>&nbsp;<span class="ident" id="5829096">nil</span>&nbsp;<span class="op" id="5829100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829105">comments</span>&nbsp;<span class="op" id="5829114">=</span>&nbsp;<span class="builtinfunc" id="5829116">append</span><span class="op" id="5829122">(</span><span class="ident" id="5829123">comments</span><span class="op" id="5829131">,</span>&nbsp;<span class="ident" id="5829133">c</span><span class="op" id="5829134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829141">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829145">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829201">for</span>&nbsp;<span class="ident" id="5829205">_</span><span class="op" id="5829206">,</span>&nbsp;<span class="ident" id="5829208">c</span>&nbsp;<span class="op" id="5829210">:=</span>&nbsp;<span class="keyword" id="5829213">range</span>&nbsp;<span class="ident" id="5829219">file</span><span class="op" id="5829223">.</span><span class="ident" id="5829224">Comments</span>&nbsp;<span class="op" id="5829233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829237">if</span>&nbsp;<span class="ident" id="5829240">body</span><span class="op" id="5829244">.</span><span class="ident" id="5829245">Pos</span><span class="op" id="5829248">(</span><span class="op" id="5829249">)</span>&nbsp;<span class="op" id="5829251">&lt;=</span>&nbsp;<span class="ident" id="5829254">c</span><span class="op" id="5829255">.</span><span class="ident" id="5829256">Pos</span><span class="op" id="5829259">(</span><span class="op" id="5829260">)</span>&nbsp;<span class="op" id="5829262">&amp;&amp;</span>&nbsp;<span class="ident" id="5829265">c</span><span class="op" id="5829266">.</span><span class="ident" id="5829267">End</span><span class="op" id="5829270">(</span><span class="op" id="5829271">)</span>&nbsp;<span class="op" id="5829273">&lt;=</span>&nbsp;<span class="ident" id="5829276">body</span><span class="op" id="5829280">.</span><span class="ident" id="5829281">End</span><span class="op" id="5829284">(</span><span class="op" id="5829285">)</span>&nbsp;<span class="op" id="5829287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829292">comments</span>&nbsp;<span class="op" id="5829301">=</span>&nbsp;<span class="builtinfunc" id="5829303">append</span><span class="op" id="5829309">(</span><span class="ident" id="5829310">comments</span><span class="op" id="5829318">,</span>&nbsp;<span class="ident" id="5829320">c</span><span class="op" id="5829321">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829332">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829390">body</span><span class="op" id="5829394">,</span>&nbsp;<span class="ident" id="5829396">comments</span>&nbsp;<span class="op" id="5829405">=</span>&nbsp;<span class="ident" id="5829407">stripOutputComment</span><span class="op" id="5829425">(</span><span class="ident" id="5829426">body</span><span class="op" id="5829430">,</span>&nbsp;<span class="ident" id="5829432">comments</span><span class="op" id="5829440">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829444">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829479">importDecl</span>&nbsp;<span class="op" id="5829490">:=</span>&nbsp;<span class="op" id="5829493">&amp;</span><span class="ident" id="5829494">ast</span><span class="op" id="5829497">.</span><span class="ident" id="5829498">GenDecl</span><span class="op" id="5829505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829509">Tok</span><span class="op" id="5829512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5829517">token</span><span class="op" id="5829522">.</span><span class="ident" id="5829523">IMPORT</span><span class="op" id="5829529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829533">Lparen</span><span class="op" id="5829539">:</span>&nbsp;<span class="num" id="5829541">1</span><span class="op" id="5829542">,</span>&nbsp;<span class="comment" id="5829544">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829597">Rparen</span><span class="op" id="5829603">:</span>&nbsp;<span class="num" id="5829605">1</span><span class="op" id="5829606">,</span>&nbsp;<span class="comment" id="5829608">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829649">for</span>&nbsp;<span class="ident" id="5829653">n</span><span class="op" id="5829654">,</span>&nbsp;<span class="ident" id="5829656">p</span>&nbsp;<span class="op" id="5829658">:=</span>&nbsp;<span class="keyword" id="5829661">range</span>&nbsp;<span class="ident" id="5829667">namedImports</span>&nbsp;<span class="op" id="5829680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829684">s</span>&nbsp;<span class="op" id="5829686">:=</span>&nbsp;<span class="op" id="5829689">&amp;</span><span class="ident" id="5829690">ast</span><span class="op" id="5829693">.</span><span class="ident" id="5829694">ImportSpec</span><span class="op" id="5829704">{</span><span class="ident" id="5829705">Path</span><span class="op" id="5829709">:</span>&nbsp;<span class="op" id="5829711">&amp;</span><span class="ident" id="5829712">ast</span><span class="op" id="5829715">.</span><span class="ident" id="5829716">BasicLit</span><span class="op" id="5829724">{</span><span class="ident" id="5829725">Value</span><span class="op" id="5829730">:</span>&nbsp;<span class="ident" id="5829732">strconv</span><span class="op" id="5829739">.</span><span class="ident" id="5829740">Quote</span><span class="op" id="5829745">(</span><span class="ident" id="5829746">p</span><span class="op" id="5829747">)</span><span class="op" id="5829748">}</span><span class="op" id="5829749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5829753">if</span>&nbsp;<span class="ident" id="5829756">path</span><span class="op" id="5829760">.</span><span class="ident" id="5829761">Base</span><span class="op" id="5829765">(</span><span class="ident" id="5829766">p</span><span class="op" id="5829767">)</span>&nbsp;<span class="op" id="5829769">!=</span>&nbsp;<span class="ident" id="5829772">n</span>&nbsp;<span class="op" id="5829774">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829779">s</span><span class="op" id="5829780">.</span><span class="ident" id="5829781">Name</span>&nbsp;<span class="op" id="5829786">=</span>&nbsp;<span class="ident" id="5829788">ast</span><span class="op" id="5829791">.</span><span class="ident" id="5829792">NewIdent</span><span class="op" id="5829800">(</span><span class="ident" id="5829801">n</span><span class="op" id="5829802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829810">importDecl</span><span class="op" id="5829820">.</span><span class="ident" id="5829821">Specs</span>&nbsp;<span class="op" id="5829827">=</span>&nbsp;<span class="builtinfunc" id="5829829">append</span><span class="op" id="5829835">(</span><span class="ident" id="5829836">importDecl</span><span class="op" id="5829846">.</span><span class="ident" id="5829847">Specs</span><span class="op" id="5829852">,</span>&nbsp;<span class="ident" id="5829854">s</span><span class="op" id="5829855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5829858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829861">importDecl</span><span class="op" id="5829871">.</span><span class="ident" id="5829872">Specs</span>&nbsp;<span class="op" id="5829878">=</span>&nbsp;<span class="builtinfunc" id="5829880">append</span><span class="op" id="5829886">(</span><span class="ident" id="5829887">importDecl</span><span class="op" id="5829897">.</span><span class="ident" id="5829898">Specs</span><span class="op" id="5829903">,</span>&nbsp;<span class="ident" id="5829905">blankImports</span><span class="op" id="5829917">...</span><span class="op" id="5829920">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829924">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829954">funcDecl</span>&nbsp;<span class="op" id="5829963">:=</span>&nbsp;<span class="op" id="5829966">&amp;</span><span class="ident" id="5829967">ast</span><span class="op" id="5829970">.</span><span class="ident" id="5829971">FuncDecl</span><span class="op" id="5829979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829983">Name</span><span class="op" id="5829987">:</span>&nbsp;<span class="ident" id="5829989">ast</span><span class="op" id="5829992">.</span><span class="ident" id="5829993">NewIdent</span><span class="op" id="5830001">(</span><span class="string" id="5830002">&#34;main&#34;</span><span class="op" id="5830008">)</span><span class="op" id="5830009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830013">Type</span><span class="op" id="5830017">:</span>&nbsp;<span class="op" id="5830019">&amp;</span><span class="ident" id="5830020">ast</span><span class="op" id="5830023">.</span><span class="ident" id="5830024">FuncType</span><span class="op" id="5830032">{</span><span class="ident" id="5830033">Params</span><span class="op" id="5830039">:</span>&nbsp;<span class="op" id="5830041">&amp;</span><span class="ident" id="5830042">ast</span><span class="op" id="5830045">.</span><span class="ident" id="5830046">FieldList</span><span class="op" id="5830055">{</span><span class="op" id="5830056">}</span><span class="op" id="5830057">}</span><span class="op" id="5830058">,</span>&nbsp;<span class="comment" id="5830060">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830097">Body</span><span class="op" id="5830101">:</span>&nbsp;<span class="ident" id="5830103">body</span><span class="op" id="5830107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830114">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830135">return</span>&nbsp;<span class="op" id="5830142">&amp;</span><span class="ident" id="5830143">ast</span><span class="op" id="5830146">.</span><span class="ident" id="5830147">File</span><span class="op" id="5830151">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830155">Name</span><span class="op" id="5830159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830165">ast</span><span class="op" id="5830168">.</span><span class="ident" id="5830169">NewIdent</span><span class="op" id="5830177">(</span><span class="string" id="5830178">&#34;main&#34;</span><span class="op" id="5830184">)</span><span class="op" id="5830185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830189">Decls</span><span class="op" id="5830194">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5830199">[</span><span class="op" id="5830200">]</span><span class="ident" id="5830201">ast</span><span class="op" id="5830204">.</span><span class="ident" id="5830205">Decl</span><span class="op" id="5830209">{</span><span class="ident" id="5830210">importDecl</span><span class="op" id="5830220">,</span>&nbsp;<span class="ident" id="5830222">funcDecl</span><span class="op" id="5830230">}</span><span class="op" id="5830231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830235">Comments</span><span class="op" id="5830243">:</span>&nbsp;<span class="ident" id="5830245">comments</span><span class="op" id="5830253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830256">}</span><br>
<span class="lineno"></span><span class="op" id="5830258">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="5830261">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="5830339">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5830398">func</span>&nbsp;<span class="ident" id="5830403">playExampleFile</span><span class="op" id="5830418">(</span><span class="ident" id="5830419">file</span>&nbsp;<span class="op" id="5830424">*</span><span class="ident" id="5830425">ast</span><span class="op" id="5830428">.</span><span class="ident" id="5830429">File</span><span class="op" id="5830433">)</span>&nbsp;<span class="op" id="5830435">*</span><span class="ident" id="5830436">ast</span><span class="op" id="5830439">.</span><span class="ident" id="5830440">File</span>&nbsp;<span class="op" id="5830445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830448">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830488">comments</span>&nbsp;<span class="op" id="5830497">:=</span>&nbsp;<span class="ident" id="5830500">file</span><span class="op" id="5830504">.</span><span class="ident" id="5830505">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830515">if</span>&nbsp;<span class="builtinfunc" id="5830518">len</span><span class="op" id="5830521">(</span><span class="ident" id="5830522">comments</span><span class="op" id="5830530">)</span>&nbsp;<span class="op" id="5830532">&gt;</span>&nbsp;<span class="num" id="5830534">0</span>&nbsp;<span class="op" id="5830536">&amp;&amp;</span>&nbsp;<span class="ident" id="5830539">strings</span><span class="op" id="5830546">.</span><span class="ident" id="5830547">HasPrefix</span><span class="op" id="5830556">(</span><span class="ident" id="5830557">comments</span><span class="op" id="5830565">[</span><span class="num" id="5830566">0</span><span class="op" id="5830567">]</span><span class="op" id="5830568">.</span><span class="ident" id="5830569">Text</span><span class="op" id="5830573">(</span><span class="op" id="5830574">)</span><span class="op" id="5830575">,</span>&nbsp;<span class="string" id="5830577">&#34;Copyright&#34;</span><span class="op" id="5830588">)</span>&nbsp;<span class="op" id="5830590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830594">comments</span>&nbsp;<span class="op" id="5830603">=</span>&nbsp;<span class="ident" id="5830605">comments</span><span class="op" id="5830613">[</span><span class="num" id="5830614">1</span><span class="op" id="5830615">:</span><span class="op" id="5830616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830623">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830692">var</span>&nbsp;<span class="ident" id="5830696">decls</span>&nbsp;<span class="op" id="5830702">[</span><span class="op" id="5830703">]</span><span class="ident" id="5830704">ast</span><span class="op" id="5830707">.</span><span class="ident" id="5830708">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830714">for</span>&nbsp;<span class="ident" id="5830718">_</span><span class="op" id="5830719">,</span>&nbsp;<span class="ident" id="5830721">d</span>&nbsp;<span class="op" id="5830723">:=</span>&nbsp;<span class="keyword" id="5830726">range</span>&nbsp;<span class="ident" id="5830732">file</span><span class="op" id="5830736">.</span><span class="ident" id="5830737">Decls</span>&nbsp;<span class="op" id="5830743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5830747">if</span>&nbsp;<span class="ident" id="5830750">f</span><span class="op" id="5830751">,</span>&nbsp;<span class="ident" id="5830753">ok</span>&nbsp;<span class="op" id="5830756">:=</span>&nbsp;<span class="ident" id="5830759">d</span><span class="op" id="5830760">.</span><span class="op" id="5830761">(</span><span class="op" id="5830762">*</span><span class="ident" id="5830763">ast</span><span class="op" id="5830766">.</span><span class="ident" id="5830767">FuncDecl</span><span class="op" id="5830775">)</span><span class="op" id="5830776">;</span>&nbsp;<span class="ident" id="5830778">ok</span>&nbsp;<span class="op" id="5830781">&amp;&amp;</span>&nbsp;<span class="ident" id="5830784">isTest</span><span class="op" id="5830790">(</span><span class="ident" id="5830791">f</span><span class="op" id="5830792">.</span><span class="ident" id="5830793">Name</span><span class="op" id="5830797">.</span><span class="ident" id="5830798">Name</span><span class="op" id="5830802">,</span>&nbsp;<span class="string" id="5830804">&#34;Example&#34;</span><span class="op" id="5830813">)</span>&nbsp;<span class="op" id="5830815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830820">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830874">newF</span>&nbsp;<span class="op" id="5830879">:=</span>&nbsp;<span class="op" id="5830882">*</span><span class="ident" id="5830883">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830888">newF</span><span class="op" id="5830892">.</span><span class="ident" id="5830893">Name</span>&nbsp;<span class="op" id="5830898">=</span>&nbsp;<span class="ident" id="5830900">ast</span><span class="op" id="5830903">.</span><span class="ident" id="5830904">NewIdent</span><span class="op" id="5830912">(</span><span class="string" id="5830913">&#34;main&#34;</span><span class="op" id="5830919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830924">newF</span><span class="op" id="5830928">.</span><span class="ident" id="5830929">Body</span><span class="op" id="5830933">,</span>&nbsp;<span class="ident" id="5830935">comments</span>&nbsp;<span class="op" id="5830944">=</span>&nbsp;<span class="ident" id="5830946">stripOutputComment</span><span class="op" id="5830964">(</span><span class="ident" id="5830965">f</span><span class="op" id="5830966">.</span><span class="ident" id="5830967">Body</span><span class="op" id="5830971">,</span>&nbsp;<span class="ident" id="5830973">comments</span><span class="op" id="5830981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830986">d</span>&nbsp;<span class="op" id="5830988">=</span>&nbsp;<span class="op" id="5830990">&amp;</span><span class="ident" id="5830991">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5830998">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831002">decls</span>&nbsp;<span class="op" id="5831008">=</span>&nbsp;<span class="builtinfunc" id="5831010">append</span><span class="op" id="5831016">(</span><span class="ident" id="5831017">decls</span><span class="op" id="5831022">,</span>&nbsp;<span class="ident" id="5831024">d</span><span class="op" id="5831025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5831028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831032">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831080">f</span>&nbsp;<span class="op" id="5831082">:=</span>&nbsp;<span class="op" id="5831085">*</span><span class="ident" id="5831086">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831092">f</span><span class="op" id="5831093">.</span><span class="ident" id="5831094">Name</span>&nbsp;<span class="op" id="5831099">=</span>&nbsp;<span class="ident" id="5831101">ast</span><span class="op" id="5831104">.</span><span class="ident" id="5831105">NewIdent</span><span class="op" id="5831113">(</span><span class="string" id="5831114">&#34;main&#34;</span><span class="op" id="5831120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831123">f</span><span class="op" id="5831124">.</span><span class="ident" id="5831125">Decls</span>&nbsp;<span class="op" id="5831131">=</span>&nbsp;<span class="ident" id="5831133">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831140">f</span><span class="op" id="5831141">.</span><span class="ident" id="5831142">Comments</span>&nbsp;<span class="op" id="5831151">=</span>&nbsp;<span class="ident" id="5831153">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831163">return</span>&nbsp;<span class="op" id="5831170">&amp;</span><span class="ident" id="5831171">f</span><br>
<span class="lineno"></span><span class="op" id="5831173">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5831176">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="5831247">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5831307">func</span>&nbsp;<span class="ident" id="5831312">stripOutputComment</span><span class="op" id="5831330">(</span><span class="ident" id="5831331">body</span>&nbsp;<span class="op" id="5831336">*</span><span class="ident" id="5831337">ast</span><span class="op" id="5831340">.</span><span class="ident" id="5831341">BlockStmt</span><span class="op" id="5831350">,</span>&nbsp;<span class="ident" id="5831352">comments</span>&nbsp;<span class="op" id="5831361">[</span><span class="op" id="5831362">]</span><span class="op" id="5831363">*</span><span class="ident" id="5831364">ast</span><span class="op" id="5831367">.</span><span class="ident" id="5831368">CommentGroup</span><span class="op" id="5831380">)</span>&nbsp;<span class="op" id="5831382">(</span><span class="op" id="5831383">*</span><span class="ident" id="5831384">ast</span><span class="op" id="5831387">.</span><span class="ident" id="5831388">BlockStmt</span><span class="op" id="5831397">,</span>&nbsp;<span class="op" id="5831399">[</span><span class="op" id="5831400">]</span><span class="op" id="5831401">*</span><span class="ident" id="5831402">ast</span><span class="op" id="5831405">.</span><span class="ident" id="5831406">CommentGroup</span><span class="op" id="5831418">)</span>&nbsp;<span class="op" id="5831420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831423">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831469">i</span><span class="op" id="5831470">,</span>&nbsp;<span class="ident" id="5831472">last</span>&nbsp;<span class="op" id="5831477">:=</span>&nbsp;<span class="ident" id="5831480">lastComment</span><span class="op" id="5831491">(</span><span class="ident" id="5831492">body</span><span class="op" id="5831496">,</span>&nbsp;<span class="ident" id="5831498">comments</span><span class="op" id="5831506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831509">if</span>&nbsp;<span class="ident" id="5831512">last</span>&nbsp;<span class="op" id="5831517">==</span>&nbsp;<span class="ident" id="5831520">nil</span>&nbsp;<span class="op" id="5831524">||</span>&nbsp;<span class="op" id="5831527">!</span><span class="ident" id="5831528">outputPrefix</span><span class="op" id="5831540">.</span><span class="ident" id="5831541">MatchString</span><span class="op" id="5831552">(</span><span class="ident" id="5831553">last</span><span class="op" id="5831557">.</span><span class="ident" id="5831558">Text</span><span class="op" id="5831562">(</span><span class="op" id="5831563">)</span><span class="op" id="5831564">)</span>&nbsp;<span class="op" id="5831566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831570">return</span>&nbsp;<span class="ident" id="5831577">body</span><span class="op" id="5831581">,</span>&nbsp;<span class="ident" id="5831583">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5831593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831597">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831665">newBody</span>&nbsp;<span class="op" id="5831673">:=</span>&nbsp;<span class="op" id="5831676">&amp;</span><span class="ident" id="5831677">ast</span><span class="op" id="5831680">.</span><span class="ident" id="5831681">BlockStmt</span><span class="op" id="5831690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831694">Lbrace</span><span class="op" id="5831700">:</span>&nbsp;<span class="ident" id="5831702">body</span><span class="op" id="5831706">.</span><span class="ident" id="5831707">Lbrace</span><span class="op" id="5831713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831717">List</span><span class="op" id="5831721">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5831725">body</span><span class="op" id="5831729">.</span><span class="ident" id="5831730">List</span><span class="op" id="5831734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831738">Rbrace</span><span class="op" id="5831744">:</span>&nbsp;<span class="ident" id="5831746">last</span><span class="op" id="5831750">.</span><span class="ident" id="5831751">Pos</span><span class="op" id="5831754">(</span><span class="op" id="5831755">)</span><span class="op" id="5831756">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5831759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831762">newComments</span>&nbsp;<span class="op" id="5831774">:=</span>&nbsp;<span class="builtinfunc" id="5831777">make</span><span class="op" id="5831781">(</span><span class="op" id="5831782">[</span><span class="op" id="5831783">]</span><span class="op" id="5831784">*</span><span class="ident" id="5831785">ast</span><span class="op" id="5831788">.</span><span class="ident" id="5831789">CommentGroup</span><span class="op" id="5831801">,</span>&nbsp;<span class="builtinfunc" id="5831803">len</span><span class="op" id="5831806">(</span><span class="ident" id="5831807">comments</span><span class="op" id="5831815">)</span><span class="op" id="5831816">-</span><span class="num" id="5831817">1</span><span class="op" id="5831818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5831821">copy</span><span class="op" id="5831825">(</span><span class="ident" id="5831826">newComments</span><span class="op" id="5831837">,</span>&nbsp;<span class="ident" id="5831839">comments</span><span class="op" id="5831847">[</span><span class="op" id="5831848">:</span><span class="ident" id="5831849">i</span><span class="op" id="5831850">]</span><span class="op" id="5831851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5831854">copy</span><span class="op" id="5831858">(</span><span class="ident" id="5831859">newComments</span><span class="op" id="5831870">[</span><span class="ident" id="5831871">i</span><span class="op" id="5831872">:</span><span class="op" id="5831873">]</span><span class="op" id="5831874">,</span>&nbsp;<span class="ident" id="5831876">comments</span><span class="op" id="5831884">[</span><span class="ident" id="5831885">i</span><span class="op" id="5831886">+</span><span class="num" id="5831887">1</span><span class="op" id="5831888">:</span><span class="op" id="5831889">]</span><span class="op" id="5831890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831893">return</span>&nbsp;<span class="ident" id="5831900">newBody</span><span class="op" id="5831907">,</span>&nbsp;<span class="ident" id="5831909">newComments</span><br>
<span class="lineno">340</span><span class="op" id="5831921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5831924">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="5831991">func</span>&nbsp;<span class="ident" id="5831996">lastComment</span><span class="op" id="5832007">(</span><span class="ident" id="5832008">b</span>&nbsp;<span class="op" id="5832010">*</span><span class="ident" id="5832011">ast</span><span class="op" id="5832014">.</span><span class="ident" id="5832015">BlockStmt</span><span class="op" id="5832024">,</span>&nbsp;<span class="ident" id="5832026">c</span>&nbsp;<span class="op" id="5832028">[</span><span class="op" id="5832029">]</span><span class="op" id="5832030">*</span><span class="ident" id="5832031">ast</span><span class="op" id="5832034">.</span><span class="ident" id="5832035">CommentGroup</span><span class="op" id="5832047">)</span>&nbsp;<span class="op" id="5832049">(</span><span class="ident" id="5832050">i</span>&nbsp;<span class="builtintype" id="5832052">int</span><span class="op" id="5832055">,</span>&nbsp;<span class="ident" id="5832057">last</span>&nbsp;<span class="op" id="5832062">*</span><span class="ident" id="5832063">ast</span><span class="op" id="5832066">.</span><span class="ident" id="5832067">CommentGroup</span><span class="op" id="5832079">)</span>&nbsp;<span class="op" id="5832081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5832084">pos</span><span class="op" id="5832087">,</span>&nbsp;<span class="ident" id="5832089">end</span>&nbsp;<span class="op" id="5832093">:=</span>&nbsp;<span class="ident" id="5832096">b</span><span class="op" id="5832097">.</span><span class="ident" id="5832098">Pos</span><span class="op" id="5832101">(</span><span class="op" id="5832102">)</span><span class="op" id="5832103">,</span>&nbsp;<span class="ident" id="5832105">b</span><span class="op" id="5832106">.</span><span class="ident" id="5832107">End</span><span class="op" id="5832110">(</span><span class="op" id="5832111">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832114">for</span>&nbsp;<span class="ident" id="5832118">j</span><span class="op" id="5832119">,</span>&nbsp;<span class="ident" id="5832121">cg</span>&nbsp;<span class="op" id="5832124">:=</span>&nbsp;<span class="keyword" id="5832127">range</span>&nbsp;<span class="ident" id="5832133">c</span>&nbsp;<span class="op" id="5832135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832139">if</span>&nbsp;<span class="ident" id="5832142">cg</span><span class="op" id="5832144">.</span><span class="ident" id="5832145">Pos</span><span class="op" id="5832148">(</span><span class="op" id="5832149">)</span>&nbsp;<span class="op" id="5832151">&lt;</span>&nbsp;<span class="ident" id="5832153">pos</span>&nbsp;<span class="op" id="5832157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832162">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5832173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832177">if</span>&nbsp;<span class="ident" id="5832180">cg</span><span class="op" id="5832182">.</span><span class="ident" id="5832183">End</span><span class="op" id="5832186">(</span><span class="op" id="5832187">)</span>&nbsp;<span class="op" id="5832189">&gt;</span>&nbsp;<span class="ident" id="5832191">end</span>&nbsp;<span class="op" id="5832195">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832200">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5832208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5832212">i</span><span class="op" id="5832213">,</span>&nbsp;<span class="ident" id="5832215">last</span>&nbsp;<span class="op" id="5832220">=</span>&nbsp;<span class="ident" id="5832222">j</span><span class="op" id="5832223">,</span>&nbsp;<span class="ident" id="5832225">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5832229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832232">return</span><br>
<span class="lineno">355</span><span class="op" id="5832239">}</span>
</div>
</body>
</html>
