<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6951035">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6951090">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6951144">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6951195">package</span>&nbsp;<span class="ident" id="6951203">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951208">import</span>&nbsp;<span class="op" id="6951215">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951218">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951227">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951234">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951243">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951258">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951271">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6951281">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6951284">func</span>&nbsp;<span class="ident" id="6951289">diff</span><span class="op" id="6951293">(</span><span class="ident" id="6951294">m0</span><span class="op" id="6951296">,</span>&nbsp;<span class="ident" id="6951298">m1</span>&nbsp;<span class="ident" id="6951301">image</span><span class="op" id="6951306">.</span><span class="ident" id="6951307">Image</span><span class="op" id="6951312">)</span>&nbsp;<span class="builtintype" id="6951314">error</span>&nbsp;<span class="op" id="6951320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951323">b0</span><span class="op" id="6951325">,</span>&nbsp;<span class="ident" id="6951327">b1</span>&nbsp;<span class="op" id="6951330">:=</span>&nbsp;<span class="ident" id="6951333">m0</span><span class="op" id="6951335">.</span><span class="ident" id="6951336">Bounds</span><span class="op" id="6951342">(</span><span class="op" id="6951343">)</span><span class="op" id="6951344">,</span>&nbsp;<span class="ident" id="6951346">m1</span><span class="op" id="6951348">.</span><span class="ident" id="6951349">Bounds</span><span class="op" id="6951355">(</span><span class="op" id="6951356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951359">if</span>&nbsp;<span class="op" id="6951362">!</span><span class="ident" id="6951363">b0</span><span class="op" id="6951365">.</span><span class="ident" id="6951366">Size</span><span class="op" id="6951370">(</span><span class="op" id="6951371">)</span><span class="op" id="6951372">.</span><span class="ident" id="6951373">Eq</span><span class="op" id="6951375">(</span><span class="ident" id="6951376">b1</span><span class="op" id="6951378">.</span><span class="ident" id="6951379">Size</span><span class="op" id="6951383">(</span><span class="op" id="6951384">)</span><span class="op" id="6951385">)</span>&nbsp;<span class="op" id="6951387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951391">return</span>&nbsp;<span class="ident" id="6951398">fmt</span><span class="op" id="6951401">.</span><span class="ident" id="6951402">Errorf</span><span class="op" id="6951408">(</span><span class="string" id="6951409">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6951438">,</span>&nbsp;<span class="ident" id="6951440">b0</span><span class="op" id="6951442">,</span>&nbsp;<span class="ident" id="6951444">b1</span><span class="op" id="6951446">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951452">dx</span>&nbsp;<span class="op" id="6951455">:=</span>&nbsp;<span class="ident" id="6951458">b1</span><span class="op" id="6951460">.</span><span class="ident" id="6951461">Min</span><span class="op" id="6951464">.</span><span class="ident" id="6951465">X</span>&nbsp;<span class="op" id="6951467">-</span>&nbsp;<span class="ident" id="6951469">b0</span><span class="op" id="6951471">.</span><span class="ident" id="6951472">Min</span><span class="op" id="6951475">.</span><span class="ident" id="6951476">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951479">dy</span>&nbsp;<span class="op" id="6951482">:=</span>&nbsp;<span class="ident" id="6951485">b1</span><span class="op" id="6951487">.</span><span class="ident" id="6951488">Min</span><span class="op" id="6951491">.</span><span class="ident" id="6951492">Y</span>&nbsp;<span class="op" id="6951494">-</span>&nbsp;<span class="ident" id="6951496">b0</span><span class="op" id="6951498">.</span><span class="ident" id="6951499">Min</span><span class="op" id="6951502">.</span><span class="ident" id="6951503">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951506">for</span>&nbsp;<span class="ident" id="6951510">y</span>&nbsp;<span class="op" id="6951512">:=</span>&nbsp;<span class="ident" id="6951515">b0</span><span class="op" id="6951517">.</span><span class="ident" id="6951518">Min</span><span class="op" id="6951521">.</span><span class="ident" id="6951522">Y</span><span class="op" id="6951523">;</span>&nbsp;<span class="ident" id="6951525">y</span>&nbsp;<span class="op" id="6951527">&lt;</span>&nbsp;<span class="ident" id="6951529">b0</span><span class="op" id="6951531">.</span><span class="ident" id="6951532">Max</span><span class="op" id="6951535">.</span><span class="ident" id="6951536">Y</span><span class="op" id="6951537">;</span>&nbsp;<span class="ident" id="6951539">y</span><span class="op" id="6951540">++</span>&nbsp;<span class="op" id="6951543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951547">for</span>&nbsp;<span class="ident" id="6951551">x</span>&nbsp;<span class="op" id="6951553">:=</span>&nbsp;<span class="ident" id="6951556">b0</span><span class="op" id="6951558">.</span><span class="ident" id="6951559">Min</span><span class="op" id="6951562">.</span><span class="ident" id="6951563">X</span><span class="op" id="6951564">;</span>&nbsp;<span class="ident" id="6951566">x</span>&nbsp;<span class="op" id="6951568">&lt;</span>&nbsp;<span class="ident" id="6951570">b0</span><span class="op" id="6951572">.</span><span class="ident" id="6951573">Max</span><span class="op" id="6951576">.</span><span class="ident" id="6951577">X</span><span class="op" id="6951578">;</span>&nbsp;<span class="ident" id="6951580">x</span><span class="op" id="6951581">++</span>&nbsp;<span class="op" id="6951584">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951589">c0</span>&nbsp;<span class="op" id="6951592">:=</span>&nbsp;<span class="ident" id="6951595">m0</span><span class="op" id="6951597">.</span><span class="ident" id="6951598">At</span><span class="op" id="6951600">(</span><span class="ident" id="6951601">x</span><span class="op" id="6951602">,</span>&nbsp;<span class="ident" id="6951604">y</span><span class="op" id="6951605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951610">c1</span>&nbsp;<span class="op" id="6951613">:=</span>&nbsp;<span class="ident" id="6951616">m1</span><span class="op" id="6951618">.</span><span class="ident" id="6951619">At</span><span class="op" id="6951621">(</span><span class="ident" id="6951622">x</span><span class="op" id="6951623">+</span><span class="ident" id="6951624">dx</span><span class="op" id="6951626">,</span>&nbsp;<span class="ident" id="6951628">y</span><span class="op" id="6951629">+</span><span class="ident" id="6951630">dy</span><span class="op" id="6951632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951637">r0</span><span class="op" id="6951639">,</span>&nbsp;<span class="ident" id="6951641">g0</span><span class="op" id="6951643">,</span>&nbsp;<span class="ident" id="6951645">b0</span><span class="op" id="6951647">,</span>&nbsp;<span class="ident" id="6951649">a0</span>&nbsp;<span class="op" id="6951652">:=</span>&nbsp;<span class="ident" id="6951655">c0</span><span class="op" id="6951657">.</span><span class="ident" id="6951658">RGBA</span><span class="op" id="6951662">(</span><span class="op" id="6951663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951668">r1</span><span class="op" id="6951670">,</span>&nbsp;<span class="ident" id="6951672">g1</span><span class="op" id="6951674">,</span>&nbsp;<span class="ident" id="6951676">b1</span><span class="op" id="6951678">,</span>&nbsp;<span class="ident" id="6951680">a1</span>&nbsp;<span class="op" id="6951683">:=</span>&nbsp;<span class="ident" id="6951686">c1</span><span class="op" id="6951688">.</span><span class="ident" id="6951689">RGBA</span><span class="op" id="6951693">(</span><span class="op" id="6951694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951699">if</span>&nbsp;<span class="ident" id="6951702">r0</span>&nbsp;<span class="op" id="6951705">!=</span>&nbsp;<span class="ident" id="6951708">r1</span>&nbsp;<span class="op" id="6951711">||</span>&nbsp;<span class="ident" id="6951714">g0</span>&nbsp;<span class="op" id="6951717">!=</span>&nbsp;<span class="ident" id="6951720">g1</span>&nbsp;<span class="op" id="6951723">||</span>&nbsp;<span class="ident" id="6951726">b0</span>&nbsp;<span class="op" id="6951729">!=</span>&nbsp;<span class="ident" id="6951732">b1</span>&nbsp;<span class="op" id="6951735">||</span>&nbsp;<span class="ident" id="6951738">a0</span>&nbsp;<span class="op" id="6951741">!=</span>&nbsp;<span class="ident" id="6951744">a1</span>&nbsp;<span class="op" id="6951747">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951753">return</span>&nbsp;<span class="ident" id="6951760">fmt</span><span class="op" id="6951763">.</span><span class="ident" id="6951764">Errorf</span><span class="op" id="6951770">(</span><span class="string" id="6951771">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6951808">,</span>&nbsp;<span class="ident" id="6951810">x</span><span class="op" id="6951811">,</span>&nbsp;<span class="ident" id="6951813">y</span><span class="op" id="6951814">,</span>&nbsp;<span class="ident" id="6951816">c0</span><span class="op" id="6951818">,</span>&nbsp;<span class="ident" id="6951820">c1</span><span class="op" id="6951822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951837">return</span>&nbsp;<span class="ident" id="6951844">nil</span><br>
<span class="lineno">35</span><span class="op" id="6951848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951851">func</span>&nbsp;<span class="ident" id="6951856">encodeDecode</span><span class="op" id="6951868">(</span><span class="ident" id="6951869">m</span>&nbsp;<span class="ident" id="6951871">image</span><span class="op" id="6951876">.</span><span class="ident" id="6951877">Image</span><span class="op" id="6951882">)</span>&nbsp;<span class="op" id="6951884">(</span><span class="ident" id="6951885">image</span><span class="op" id="6951890">.</span><span class="ident" id="6951891">Image</span><span class="op" id="6951896">,</span>&nbsp;<span class="builtintype" id="6951898">error</span><span class="op" id="6951903">)</span>&nbsp;<span class="op" id="6951905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951908">var</span>&nbsp;<span class="ident" id="6951912">b</span>&nbsp;<span class="ident" id="6951914">bytes</span><span class="op" id="6951919">.</span><span class="ident" id="6951920">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951928">err</span>&nbsp;<span class="op" id="6951932">:=</span>&nbsp;<span class="ident" id="6951935">Encode</span><span class="op" id="6951941">(</span><span class="op" id="6951942">&amp;</span><span class="ident" id="6951943">b</span><span class="op" id="6951944">,</span>&nbsp;<span class="ident" id="6951946">m</span><span class="op" id="6951947">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951950">if</span>&nbsp;<span class="ident" id="6951953">err</span>&nbsp;<span class="op" id="6951957">!=</span>&nbsp;<span class="ident" id="6951960">nil</span>&nbsp;<span class="op" id="6951964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951968">return</span>&nbsp;<span class="ident" id="6951975">nil</span><span class="op" id="6951978">,</span>&nbsp;<span class="ident" id="6951980">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6951988">return</span>&nbsp;<span class="ident" id="6951995">Decode</span><span class="op" id="6952001">(</span><span class="op" id="6952002">&amp;</span><span class="ident" id="6952003">b</span><span class="op" id="6952004">)</span><br>
<span class="lineno"></span><span class="op" id="6952006">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6952009">func</span>&nbsp;<span class="ident" id="6952014">TestWriter</span><span class="op" id="6952024">(</span><span class="ident" id="6952025">t</span>&nbsp;<span class="op" id="6952027">*</span><span class="ident" id="6952028">testing</span><span class="op" id="6952035">.</span><span class="ident" id="6952036">T</span><span class="op" id="6952037">)</span>&nbsp;<span class="op" id="6952039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6952042">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952100">names</span>&nbsp;<span class="op" id="6952106">:=</span>&nbsp;<span class="ident" id="6952109">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952120">if</span>&nbsp;<span class="ident" id="6952123">testing</span><span class="op" id="6952130">.</span><span class="ident" id="6952131">Short</span><span class="op" id="6952136">(</span><span class="op" id="6952137">)</span>&nbsp;<span class="op" id="6952139">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952143">names</span>&nbsp;<span class="op" id="6952149">=</span>&nbsp;<span class="ident" id="6952151">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952170">for</span>&nbsp;<span class="ident" id="6952174">_</span><span class="op" id="6952175">,</span>&nbsp;<span class="ident" id="6952177">fn</span>&nbsp;<span class="op" id="6952180">:=</span>&nbsp;<span class="keyword" id="6952183">range</span>&nbsp;<span class="ident" id="6952189">names</span>&nbsp;<span class="op" id="6952195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952199">qfn</span>&nbsp;<span class="op" id="6952203">:=</span>&nbsp;<span class="string" id="6952206">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="6952227">+</span>&nbsp;<span class="ident" id="6952229">fn</span>&nbsp;<span class="op" id="6952232">+</span>&nbsp;<span class="string" id="6952234">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6952243">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952264">m0</span><span class="op" id="6952266">,</span>&nbsp;<span class="ident" id="6952268">err</span>&nbsp;<span class="op" id="6952272">:=</span>&nbsp;<span class="ident" id="6952275">readPNG</span><span class="op" id="6952282">(</span><span class="ident" id="6952283">qfn</span><span class="op" id="6952286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952290">if</span>&nbsp;<span class="ident" id="6952293">err</span>&nbsp;<span class="op" id="6952297">!=</span>&nbsp;<span class="ident" id="6952300">nil</span>&nbsp;<span class="op" id="6952304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952309">t</span><span class="op" id="6952310">.</span><span class="ident" id="6952311">Error</span><span class="op" id="6952316">(</span><span class="ident" id="6952317">fn</span><span class="op" id="6952319">,</span>&nbsp;<span class="ident" id="6952321">err</span><span class="op" id="6952324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952329">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952340">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6952344">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952397">m1</span><span class="op" id="6952399">,</span>&nbsp;<span class="ident" id="6952401">err</span>&nbsp;<span class="op" id="6952405">:=</span>&nbsp;<span class="ident" id="6952408">readPNG</span><span class="op" id="6952415">(</span><span class="ident" id="6952416">qfn</span><span class="op" id="6952419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952423">if</span>&nbsp;<span class="ident" id="6952426">err</span>&nbsp;<span class="op" id="6952430">!=</span>&nbsp;<span class="ident" id="6952433">nil</span>&nbsp;<span class="op" id="6952437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952442">t</span><span class="op" id="6952443">.</span><span class="ident" id="6952444">Error</span><span class="op" id="6952449">(</span><span class="ident" id="6952450">fn</span><span class="op" id="6952452">,</span>&nbsp;<span class="ident" id="6952454">err</span><span class="op" id="6952457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952462">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952475">m2</span><span class="op" id="6952477">,</span>&nbsp;<span class="ident" id="6952479">err</span>&nbsp;<span class="op" id="6952483">:=</span>&nbsp;<span class="ident" id="6952486">encodeDecode</span><span class="op" id="6952498">(</span><span class="ident" id="6952499">m1</span><span class="op" id="6952501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952505">if</span>&nbsp;<span class="ident" id="6952508">err</span>&nbsp;<span class="op" id="6952512">!=</span>&nbsp;<span class="ident" id="6952515">nil</span>&nbsp;<span class="op" id="6952519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952524">t</span><span class="op" id="6952525">.</span><span class="ident" id="6952526">Error</span><span class="op" id="6952531">(</span><span class="ident" id="6952532">fn</span><span class="op" id="6952534">,</span>&nbsp;<span class="ident" id="6952536">err</span><span class="op" id="6952539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952544">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6952557">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952579">err</span>&nbsp;<span class="op" id="6952583">=</span>&nbsp;<span class="ident" id="6952585">diff</span><span class="op" id="6952589">(</span><span class="ident" id="6952590">m0</span><span class="op" id="6952592">,</span>&nbsp;<span class="ident" id="6952594">m2</span><span class="op" id="6952596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952600">if</span>&nbsp;<span class="ident" id="6952603">err</span>&nbsp;<span class="op" id="6952607">!=</span>&nbsp;<span class="ident" id="6952610">nil</span>&nbsp;<span class="op" id="6952614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952619">t</span><span class="op" id="6952620">.</span><span class="ident" id="6952621">Error</span><span class="op" id="6952626">(</span><span class="ident" id="6952627">fn</span><span class="op" id="6952629">,</span>&nbsp;<span class="ident" id="6952631">err</span><span class="op" id="6952634">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952639">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952653">}</span><br>
<span class="lineno"></span><span class="op" id="6952655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6952658">func</span>&nbsp;<span class="ident" id="6952663">TestWriterLevels</span><span class="op" id="6952679">(</span><span class="ident" id="6952680">t</span>&nbsp;<span class="op" id="6952682">*</span><span class="ident" id="6952683">testing</span><span class="op" id="6952690">.</span><span class="ident" id="6952691">T</span><span class="op" id="6952692">)</span>&nbsp;<span class="op" id="6952694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952697">m</span>&nbsp;<span class="op" id="6952699">:=</span>&nbsp;<span class="ident" id="6952702">image</span><span class="op" id="6952707">.</span><span class="ident" id="6952708">NewNRGBA</span><span class="op" id="6952716">(</span><span class="ident" id="6952717">image</span><span class="op" id="6952722">.</span><span class="ident" id="6952723">Rect</span><span class="op" id="6952727">(</span><span class="num" id="6952728">0</span><span class="op" id="6952729">,</span>&nbsp;<span class="num" id="6952731">0</span><span class="op" id="6952732">,</span>&nbsp;<span class="num" id="6952734">100</span><span class="op" id="6952737">,</span>&nbsp;<span class="num" id="6952739">100</span><span class="op" id="6952742">)</span><span class="op" id="6952743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952747">var</span>&nbsp;<span class="ident" id="6952751">b1</span><span class="op" id="6952753">,</span>&nbsp;<span class="ident" id="6952755">b2</span>&nbsp;<span class="ident" id="6952758">bytes</span><span class="op" id="6952763">.</span><span class="ident" id="6952764">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952772">if</span>&nbsp;<span class="ident" id="6952775">err</span>&nbsp;<span class="op" id="6952779">:=</span>&nbsp;<span class="op" id="6952782">(</span><span class="op" id="6952783">&amp;</span><span class="ident" id="6952784">Encoder</span><span class="op" id="6952791">{</span><span class="op" id="6952792">}</span><span class="op" id="6952793">)</span><span class="op" id="6952794">.</span><span class="ident" id="6952795">Encode</span><span class="op" id="6952801">(</span><span class="op" id="6952802">&amp;</span><span class="ident" id="6952803">b1</span><span class="op" id="6952805">,</span>&nbsp;<span class="ident" id="6952807">m</span><span class="op" id="6952808">)</span><span class="op" id="6952809">;</span>&nbsp;<span class="ident" id="6952811">err</span>&nbsp;<span class="op" id="6952815">!=</span>&nbsp;<span class="ident" id="6952818">nil</span>&nbsp;<span class="op" id="6952822">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952826">t</span><span class="op" id="6952827">.</span><span class="ident" id="6952828">Fatal</span><span class="op" id="6952833">(</span><span class="ident" id="6952834">err</span><span class="op" id="6952837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952843">noenc</span>&nbsp;<span class="op" id="6952849">:=</span>&nbsp;<span class="op" id="6952852">&amp;</span><span class="ident" id="6952853">Encoder</span><span class="op" id="6952860">{</span><span class="ident" id="6952861">CompressionLevel</span><span class="op" id="6952877">:</span>&nbsp;<span class="ident" id="6952879">NoCompression</span><span class="op" id="6952892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952895">if</span>&nbsp;<span class="ident" id="6952898">err</span>&nbsp;<span class="op" id="6952902">:=</span>&nbsp;<span class="ident" id="6952905">noenc</span><span class="op" id="6952910">.</span><span class="ident" id="6952911">Encode</span><span class="op" id="6952917">(</span><span class="op" id="6952918">&amp;</span><span class="ident" id="6952919">b2</span><span class="op" id="6952921">,</span>&nbsp;<span class="ident" id="6952923">m</span><span class="op" id="6952924">)</span><span class="op" id="6952925">;</span>&nbsp;<span class="ident" id="6952927">err</span>&nbsp;<span class="op" id="6952931">!=</span>&nbsp;<span class="ident" id="6952934">nil</span>&nbsp;<span class="op" id="6952938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952942">t</span><span class="op" id="6952943">.</span><span class="ident" id="6952944">Fatal</span><span class="op" id="6952949">(</span><span class="ident" id="6952950">err</span><span class="op" id="6952953">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952960">if</span>&nbsp;<span class="ident" id="6952963">b2</span><span class="op" id="6952965">.</span><span class="ident" id="6952966">Len</span><span class="op" id="6952969">(</span><span class="op" id="6952970">)</span>&nbsp;<span class="op" id="6952972">&lt;=</span>&nbsp;<span class="ident" id="6952975">b1</span><span class="op" id="6952977">.</span><span class="ident" id="6952978">Len</span><span class="op" id="6952981">(</span><span class="op" id="6952982">)</span>&nbsp;<span class="op" id="6952984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952988">t</span><span class="op" id="6952989">.</span><span class="ident" id="6952990">Error</span><span class="op" id="6952995">(</span><span class="string" id="6952996">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="6953064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953067">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953070">if</span>&nbsp;<span class="ident" id="6953073">_</span><span class="op" id="6953074">,</span>&nbsp;<span class="ident" id="6953076">err</span>&nbsp;<span class="op" id="6953080">:=</span>&nbsp;<span class="ident" id="6953083">Decode</span><span class="op" id="6953089">(</span><span class="op" id="6953090">&amp;</span><span class="ident" id="6953091">b1</span><span class="op" id="6953093">)</span><span class="op" id="6953094">;</span>&nbsp;<span class="ident" id="6953096">err</span>&nbsp;<span class="op" id="6953100">!=</span>&nbsp;<span class="ident" id="6953103">nil</span>&nbsp;<span class="op" id="6953107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953111">t</span><span class="op" id="6953112">.</span><span class="ident" id="6953113">Error</span><span class="op" id="6953118">(</span><span class="string" id="6953119">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="6953153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953159">if</span>&nbsp;<span class="ident" id="6953162">_</span><span class="op" id="6953163">,</span>&nbsp;<span class="ident" id="6953165">err</span>&nbsp;<span class="op" id="6953169">:=</span>&nbsp;<span class="ident" id="6953172">Decode</span><span class="op" id="6953178">(</span><span class="op" id="6953179">&amp;</span><span class="ident" id="6953180">b2</span><span class="op" id="6953182">)</span><span class="op" id="6953183">;</span>&nbsp;<span class="ident" id="6953185">err</span>&nbsp;<span class="op" id="6953189">!=</span>&nbsp;<span class="ident" id="6953192">nil</span>&nbsp;<span class="op" id="6953196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953200">t</span><span class="op" id="6953201">.</span><span class="ident" id="6953202">Error</span><span class="op" id="6953207">(</span><span class="string" id="6953208">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="6953237">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953240">}</span><br>
<span class="lineno"></span><span class="op" id="6953242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953245">func</span>&nbsp;<span class="ident" id="6953250">TestSubImage</span><span class="op" id="6953262">(</span><span class="ident" id="6953263">t</span>&nbsp;<span class="op" id="6953265">*</span><span class="ident" id="6953266">testing</span><span class="op" id="6953273">.</span><span class="ident" id="6953274">T</span><span class="op" id="6953275">)</span>&nbsp;<span class="op" id="6953277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953280">m0</span>&nbsp;<span class="op" id="6953283">:=</span>&nbsp;<span class="ident" id="6953286">image</span><span class="op" id="6953291">.</span><span class="ident" id="6953292">NewRGBA</span><span class="op" id="6953299">(</span><span class="ident" id="6953300">image</span><span class="op" id="6953305">.</span><span class="ident" id="6953306">Rect</span><span class="op" id="6953310">(</span><span class="num" id="6953311">0</span><span class="op" id="6953312">,</span>&nbsp;<span class="num" id="6953314">0</span><span class="op" id="6953315">,</span>&nbsp;<span class="num" id="6953317">256</span><span class="op" id="6953320">,</span>&nbsp;<span class="num" id="6953322">256</span><span class="op" id="6953325">)</span><span class="op" id="6953326">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953329">for</span>&nbsp;<span class="ident" id="6953333">y</span>&nbsp;<span class="op" id="6953335">:=</span>&nbsp;<span class="num" id="6953338">0</span><span class="op" id="6953339">;</span>&nbsp;<span class="ident" id="6953341">y</span>&nbsp;<span class="op" id="6953343">&lt;</span>&nbsp;<span class="num" id="6953345">256</span><span class="op" id="6953348">;</span>&nbsp;<span class="ident" id="6953350">y</span><span class="op" id="6953351">++</span>&nbsp;<span class="op" id="6953354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953358">for</span>&nbsp;<span class="ident" id="6953362">x</span>&nbsp;<span class="op" id="6953364">:=</span>&nbsp;<span class="num" id="6953367">0</span><span class="op" id="6953368">;</span>&nbsp;<span class="ident" id="6953370">x</span>&nbsp;<span class="op" id="6953372">&lt;</span>&nbsp;<span class="num" id="6953374">256</span><span class="op" id="6953377">;</span>&nbsp;<span class="ident" id="6953379">x</span><span class="op" id="6953380">++</span>&nbsp;<span class="op" id="6953383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953388">m0</span><span class="op" id="6953390">.</span><span class="ident" id="6953391">Set</span><span class="op" id="6953394">(</span><span class="ident" id="6953395">x</span><span class="op" id="6953396">,</span>&nbsp;<span class="ident" id="6953398">y</span><span class="op" id="6953399">,</span>&nbsp;<span class="ident" id="6953401">color</span><span class="op" id="6953406">.</span><span class="ident" id="6953407">RGBA</span><span class="op" id="6953411">{</span><span class="builtintype" id="6953412">uint8</span><span class="op" id="6953417">(</span><span class="ident" id="6953418">x</span><span class="op" id="6953419">)</span><span class="op" id="6953420">,</span>&nbsp;<span class="builtintype" id="6953422">uint8</span><span class="op" id="6953427">(</span><span class="ident" id="6953428">y</span><span class="op" id="6953429">)</span><span class="op" id="6953430">,</span>&nbsp;<span class="num" id="6953432">0</span><span class="op" id="6953433">,</span>&nbsp;<span class="num" id="6953435">255</span><span class="op" id="6953438">}</span><span class="op" id="6953439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953446">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953449">m0</span>&nbsp;<span class="op" id="6953452">=</span>&nbsp;<span class="ident" id="6953454">m0</span><span class="op" id="6953456">.</span><span class="ident" id="6953457">SubImage</span><span class="op" id="6953465">(</span><span class="ident" id="6953466">image</span><span class="op" id="6953471">.</span><span class="ident" id="6953472">Rect</span><span class="op" id="6953476">(</span><span class="num" id="6953477">50</span><span class="op" id="6953479">,</span>&nbsp;<span class="num" id="6953481">30</span><span class="op" id="6953483">,</span>&nbsp;<span class="num" id="6953485">250</span><span class="op" id="6953488">,</span>&nbsp;<span class="num" id="6953490">130</span><span class="op" id="6953493">)</span><span class="op" id="6953494">)</span><span class="op" id="6953495">.</span><span class="op" id="6953496">(</span><span class="op" id="6953497">*</span><span class="ident" id="6953498">image</span><span class="op" id="6953503">.</span><span class="ident" id="6953504">RGBA</span><span class="op" id="6953508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953511">m1</span><span class="op" id="6953513">,</span>&nbsp;<span class="ident" id="6953515">err</span>&nbsp;<span class="op" id="6953519">:=</span>&nbsp;<span class="ident" id="6953522">encodeDecode</span><span class="op" id="6953534">(</span><span class="ident" id="6953535">m0</span><span class="op" id="6953537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953540">if</span>&nbsp;<span class="ident" id="6953543">err</span>&nbsp;<span class="op" id="6953547">!=</span>&nbsp;<span class="ident" id="6953550">nil</span>&nbsp;<span class="op" id="6953554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953558">t</span><span class="op" id="6953559">.</span><span class="ident" id="6953560">Error</span><span class="op" id="6953565">(</span><span class="ident" id="6953566">err</span><span class="op" id="6953569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953573">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953584">err</span>&nbsp;<span class="op" id="6953588">=</span>&nbsp;<span class="ident" id="6953590">diff</span><span class="op" id="6953594">(</span><span class="ident" id="6953595">m0</span><span class="op" id="6953597">,</span>&nbsp;<span class="ident" id="6953599">m1</span><span class="op" id="6953601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953604">if</span>&nbsp;<span class="ident" id="6953607">err</span>&nbsp;<span class="op" id="6953611">!=</span>&nbsp;<span class="ident" id="6953614">nil</span>&nbsp;<span class="op" id="6953618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953622">t</span><span class="op" id="6953623">.</span><span class="ident" id="6953624">Error</span><span class="op" id="6953629">(</span><span class="ident" id="6953630">err</span><span class="op" id="6953633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953637">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953645">}</span><br>
<span class="lineno"></span><span class="op" id="6953647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953650">func</span>&nbsp;<span class="ident" id="6953655">BenchmarkEncodeGray</span><span class="op" id="6953674">(</span><span class="ident" id="6953675">b</span>&nbsp;<span class="op" id="6953677">*</span><span class="ident" id="6953678">testing</span><span class="op" id="6953685">.</span><span class="ident" id="6953686">B</span><span class="op" id="6953687">)</span>&nbsp;<span class="op" id="6953689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953692">b</span><span class="op" id="6953693">.</span><span class="ident" id="6953694">StopTimer</span><span class="op" id="6953703">(</span><span class="op" id="6953704">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953707">img</span>&nbsp;<span class="op" id="6953711">:=</span>&nbsp;<span class="ident" id="6953714">image</span><span class="op" id="6953719">.</span><span class="ident" id="6953720">NewGray</span><span class="op" id="6953727">(</span><span class="ident" id="6953728">image</span><span class="op" id="6953733">.</span><span class="ident" id="6953734">Rect</span><span class="op" id="6953738">(</span><span class="num" id="6953739">0</span><span class="op" id="6953740">,</span>&nbsp;<span class="num" id="6953742">0</span><span class="op" id="6953743">,</span>&nbsp;<span class="num" id="6953745">640</span><span class="op" id="6953748">,</span>&nbsp;<span class="num" id="6953750">480</span><span class="op" id="6953753">)</span><span class="op" id="6953754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953757">b</span><span class="op" id="6953758">.</span><span class="ident" id="6953759">SetBytes</span><span class="op" id="6953767">(</span><span class="num" id="6953768">640</span>&nbsp;<span class="op" id="6953772">*</span>&nbsp;<span class="num" id="6953774">480</span>&nbsp;<span class="op" id="6953778">*</span>&nbsp;<span class="num" id="6953780">1</span><span class="op" id="6953781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953784">b</span><span class="op" id="6953785">.</span><span class="ident" id="6953786">StartTimer</span><span class="op" id="6953796">(</span><span class="op" id="6953797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953800">for</span>&nbsp;<span class="ident" id="6953804">i</span>&nbsp;<span class="op" id="6953806">:=</span>&nbsp;<span class="num" id="6953809">0</span><span class="op" id="6953810">;</span>&nbsp;<span class="ident" id="6953812">i</span>&nbsp;<span class="op" id="6953814">&lt;</span>&nbsp;<span class="ident" id="6953816">b</span><span class="op" id="6953817">.</span><span class="ident" id="6953818">N</span><span class="op" id="6953819">;</span>&nbsp;<span class="ident" id="6953821">i</span><span class="op" id="6953822">++</span>&nbsp;<span class="op" id="6953825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953829">Encode</span><span class="op" id="6953835">(</span><span class="ident" id="6953836">ioutil</span><span class="op" id="6953842">.</span><span class="ident" id="6953843">Discard</span><span class="op" id="6953850">,</span>&nbsp;<span class="ident" id="6953852">img</span><span class="op" id="6953855">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953858">}</span><br>
<span class="lineno"></span><span class="op" id="6953860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953863">func</span>&nbsp;<span class="ident" id="6953868">BenchmarkEncodeNRGBOpaque</span><span class="op" id="6953893">(</span><span class="ident" id="6953894">b</span>&nbsp;<span class="op" id="6953896">*</span><span class="ident" id="6953897">testing</span><span class="op" id="6953904">.</span><span class="ident" id="6953905">B</span><span class="op" id="6953906">)</span>&nbsp;<span class="op" id="6953908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953911">b</span><span class="op" id="6953912">.</span><span class="ident" id="6953913">StopTimer</span><span class="op" id="6953922">(</span><span class="op" id="6953923">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953926">img</span>&nbsp;<span class="op" id="6953930">:=</span>&nbsp;<span class="ident" id="6953933">image</span><span class="op" id="6953938">.</span><span class="ident" id="6953939">NewNRGBA</span><span class="op" id="6953947">(</span><span class="ident" id="6953948">image</span><span class="op" id="6953953">.</span><span class="ident" id="6953954">Rect</span><span class="op" id="6953958">(</span><span class="num" id="6953959">0</span><span class="op" id="6953960">,</span>&nbsp;<span class="num" id="6953962">0</span><span class="op" id="6953963">,</span>&nbsp;<span class="num" id="6953965">640</span><span class="op" id="6953968">,</span>&nbsp;<span class="num" id="6953970">480</span><span class="op" id="6953973">)</span><span class="op" id="6953974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6953977">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954032">bo</span>&nbsp;<span class="op" id="6954035">:=</span>&nbsp;<span class="ident" id="6954038">img</span><span class="op" id="6954041">.</span><span class="ident" id="6954042">Bounds</span><span class="op" id="6954048">(</span><span class="op" id="6954049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954052">for</span>&nbsp;<span class="ident" id="6954056">y</span>&nbsp;<span class="op" id="6954058">:=</span>&nbsp;<span class="ident" id="6954061">bo</span><span class="op" id="6954063">.</span><span class="ident" id="6954064">Min</span><span class="op" id="6954067">.</span><span class="ident" id="6954068">Y</span><span class="op" id="6954069">;</span>&nbsp;<span class="ident" id="6954071">y</span>&nbsp;<span class="op" id="6954073">&lt;</span>&nbsp;<span class="ident" id="6954075">bo</span><span class="op" id="6954077">.</span><span class="ident" id="6954078">Max</span><span class="op" id="6954081">.</span><span class="ident" id="6954082">Y</span><span class="op" id="6954083">;</span>&nbsp;<span class="ident" id="6954085">y</span><span class="op" id="6954086">++</span>&nbsp;<span class="op" id="6954089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954093">for</span>&nbsp;<span class="ident" id="6954097">x</span>&nbsp;<span class="op" id="6954099">:=</span>&nbsp;<span class="ident" id="6954102">bo</span><span class="op" id="6954104">.</span><span class="ident" id="6954105">Min</span><span class="op" id="6954108">.</span><span class="ident" id="6954109">X</span><span class="op" id="6954110">;</span>&nbsp;<span class="ident" id="6954112">x</span>&nbsp;<span class="op" id="6954114">&lt;</span>&nbsp;<span class="ident" id="6954116">bo</span><span class="op" id="6954118">.</span><span class="ident" id="6954119">Max</span><span class="op" id="6954122">.</span><span class="ident" id="6954123">X</span><span class="op" id="6954124">;</span>&nbsp;<span class="ident" id="6954126">x</span><span class="op" id="6954127">++</span>&nbsp;<span class="op" id="6954130">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954135">img</span><span class="op" id="6954138">.</span><span class="ident" id="6954139">Set</span><span class="op" id="6954142">(</span><span class="ident" id="6954143">x</span><span class="op" id="6954144">,</span>&nbsp;<span class="ident" id="6954146">y</span><span class="op" id="6954147">,</span>&nbsp;<span class="ident" id="6954149">color</span><span class="op" id="6954154">.</span><span class="ident" id="6954155">NRGBA</span><span class="op" id="6954160">{</span><span class="num" id="6954161">0</span><span class="op" id="6954162">,</span>&nbsp;<span class="num" id="6954164">0</span><span class="op" id="6954165">,</span>&nbsp;<span class="num" id="6954167">0</span><span class="op" id="6954168">,</span>&nbsp;<span class="num" id="6954170">255</span><span class="op" id="6954173">}</span><span class="op" id="6954174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954184">if</span>&nbsp;<span class="op" id="6954187">!</span><span class="ident" id="6954188">img</span><span class="op" id="6954191">.</span><span class="ident" id="6954192">Opaque</span><span class="op" id="6954198">(</span><span class="op" id="6954199">)</span>&nbsp;<span class="op" id="6954201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954205">b</span><span class="op" id="6954206">.</span><span class="ident" id="6954207">Fatal</span><span class="op" id="6954212">(</span><span class="string" id="6954213">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6954242">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954248">b</span><span class="op" id="6954249">.</span><span class="ident" id="6954250">SetBytes</span><span class="op" id="6954258">(</span><span class="num" id="6954259">640</span>&nbsp;<span class="op" id="6954263">*</span>&nbsp;<span class="num" id="6954265">480</span>&nbsp;<span class="op" id="6954269">*</span>&nbsp;<span class="num" id="6954271">4</span><span class="op" id="6954272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954275">b</span><span class="op" id="6954276">.</span><span class="ident" id="6954277">StartTimer</span><span class="op" id="6954287">(</span><span class="op" id="6954288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954291">for</span>&nbsp;<span class="ident" id="6954295">i</span>&nbsp;<span class="op" id="6954297">:=</span>&nbsp;<span class="num" id="6954300">0</span><span class="op" id="6954301">;</span>&nbsp;<span class="ident" id="6954303">i</span>&nbsp;<span class="op" id="6954305">&lt;</span>&nbsp;<span class="ident" id="6954307">b</span><span class="op" id="6954308">.</span><span class="ident" id="6954309">N</span><span class="op" id="6954310">;</span>&nbsp;<span class="ident" id="6954312">i</span><span class="op" id="6954313">++</span>&nbsp;<span class="op" id="6954316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954320">Encode</span><span class="op" id="6954326">(</span><span class="ident" id="6954327">ioutil</span><span class="op" id="6954333">.</span><span class="ident" id="6954334">Discard</span><span class="op" id="6954341">,</span>&nbsp;<span class="ident" id="6954343">img</span><span class="op" id="6954346">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954349">}</span><br>
<span class="lineno"></span><span class="op" id="6954351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954354">func</span>&nbsp;<span class="ident" id="6954359">BenchmarkEncodeNRGBA</span><span class="op" id="6954379">(</span><span class="ident" id="6954380">b</span>&nbsp;<span class="op" id="6954382">*</span><span class="ident" id="6954383">testing</span><span class="op" id="6954390">.</span><span class="ident" id="6954391">B</span><span class="op" id="6954392">)</span>&nbsp;<span class="op" id="6954394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954397">b</span><span class="op" id="6954398">.</span><span class="ident" id="6954399">StopTimer</span><span class="op" id="6954408">(</span><span class="op" id="6954409">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954412">img</span>&nbsp;<span class="op" id="6954416">:=</span>&nbsp;<span class="ident" id="6954419">image</span><span class="op" id="6954424">.</span><span class="ident" id="6954425">NewNRGBA</span><span class="op" id="6954433">(</span><span class="ident" id="6954434">image</span><span class="op" id="6954439">.</span><span class="ident" id="6954440">Rect</span><span class="op" id="6954444">(</span><span class="num" id="6954445">0</span><span class="op" id="6954446">,</span>&nbsp;<span class="num" id="6954448">0</span><span class="op" id="6954449">,</span>&nbsp;<span class="num" id="6954451">640</span><span class="op" id="6954454">,</span>&nbsp;<span class="num" id="6954456">480</span><span class="op" id="6954459">)</span><span class="op" id="6954460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954463">if</span>&nbsp;<span class="ident" id="6954466">img</span><span class="op" id="6954469">.</span><span class="ident" id="6954470">Opaque</span><span class="op" id="6954476">(</span><span class="op" id="6954477">)</span>&nbsp;<span class="op" id="6954479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954483">b</span><span class="op" id="6954484">.</span><span class="ident" id="6954485">Fatal</span><span class="op" id="6954490">(</span><span class="string" id="6954491">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6954524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954530">b</span><span class="op" id="6954531">.</span><span class="ident" id="6954532">SetBytes</span><span class="op" id="6954540">(</span><span class="num" id="6954541">640</span>&nbsp;<span class="op" id="6954545">*</span>&nbsp;<span class="num" id="6954547">480</span>&nbsp;<span class="op" id="6954551">*</span>&nbsp;<span class="num" id="6954553">4</span><span class="op" id="6954554">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954557">b</span><span class="op" id="6954558">.</span><span class="ident" id="6954559">StartTimer</span><span class="op" id="6954569">(</span><span class="op" id="6954570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954573">for</span>&nbsp;<span class="ident" id="6954577">i</span>&nbsp;<span class="op" id="6954579">:=</span>&nbsp;<span class="num" id="6954582">0</span><span class="op" id="6954583">;</span>&nbsp;<span class="ident" id="6954585">i</span>&nbsp;<span class="op" id="6954587">&lt;</span>&nbsp;<span class="ident" id="6954589">b</span><span class="op" id="6954590">.</span><span class="ident" id="6954591">N</span><span class="op" id="6954592">;</span>&nbsp;<span class="ident" id="6954594">i</span><span class="op" id="6954595">++</span>&nbsp;<span class="op" id="6954598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954602">Encode</span><span class="op" id="6954608">(</span><span class="ident" id="6954609">ioutil</span><span class="op" id="6954615">.</span><span class="ident" id="6954616">Discard</span><span class="op" id="6954623">,</span>&nbsp;<span class="ident" id="6954625">img</span><span class="op" id="6954628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954631">}</span><br>
<span class="lineno"></span><span class="op" id="6954633">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6954636">func</span>&nbsp;<span class="ident" id="6954641">BenchmarkEncodePaletted</span><span class="op" id="6954664">(</span><span class="ident" id="6954665">b</span>&nbsp;<span class="op" id="6954667">*</span><span class="ident" id="6954668">testing</span><span class="op" id="6954675">.</span><span class="ident" id="6954676">B</span><span class="op" id="6954677">)</span>&nbsp;<span class="op" id="6954679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954682">b</span><span class="op" id="6954683">.</span><span class="ident" id="6954684">StopTimer</span><span class="op" id="6954693">(</span><span class="op" id="6954694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954697">img</span>&nbsp;<span class="op" id="6954701">:=</span>&nbsp;<span class="ident" id="6954704">image</span><span class="op" id="6954709">.</span><span class="ident" id="6954710">NewPaletted</span><span class="op" id="6954721">(</span><span class="ident" id="6954722">image</span><span class="op" id="6954727">.</span><span class="ident" id="6954728">Rect</span><span class="op" id="6954732">(</span><span class="num" id="6954733">0</span><span class="op" id="6954734">,</span>&nbsp;<span class="num" id="6954736">0</span><span class="op" id="6954737">,</span>&nbsp;<span class="num" id="6954739">640</span><span class="op" id="6954742">,</span>&nbsp;<span class="num" id="6954744">480</span><span class="op" id="6954747">)</span><span class="op" id="6954748">,</span>&nbsp;<span class="ident" id="6954750">color</span><span class="op" id="6954755">.</span><span class="ident" id="6954756">Palette</span><span class="op" id="6954763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954767">color</span><span class="op" id="6954772">.</span><span class="ident" id="6954773">RGBA</span><span class="op" id="6954777">{</span><span class="num" id="6954778">0</span><span class="op" id="6954779">,</span>&nbsp;<span class="num" id="6954781">0</span><span class="op" id="6954782">,</span>&nbsp;<span class="num" id="6954784">0</span><span class="op" id="6954785">,</span>&nbsp;<span class="num" id="6954787">255</span><span class="op" id="6954790">}</span><span class="op" id="6954791">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954795">color</span><span class="op" id="6954800">.</span><span class="ident" id="6954801">RGBA</span><span class="op" id="6954805">{</span><span class="num" id="6954806">255</span><span class="op" id="6954809">,</span>&nbsp;<span class="num" id="6954811">255</span><span class="op" id="6954814">,</span>&nbsp;<span class="num" id="6954816">255</span><span class="op" id="6954819">,</span>&nbsp;<span class="num" id="6954821">255</span><span class="op" id="6954824">}</span><span class="op" id="6954825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954828">}</span><span class="op" id="6954829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954832">b</span><span class="op" id="6954833">.</span><span class="ident" id="6954834">SetBytes</span><span class="op" id="6954842">(</span><span class="num" id="6954843">640</span>&nbsp;<span class="op" id="6954847">*</span>&nbsp;<span class="num" id="6954849">480</span>&nbsp;<span class="op" id="6954853">*</span>&nbsp;<span class="num" id="6954855">1</span><span class="op" id="6954856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954859">b</span><span class="op" id="6954860">.</span><span class="ident" id="6954861">StartTimer</span><span class="op" id="6954871">(</span><span class="op" id="6954872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6954875">for</span>&nbsp;<span class="ident" id="6954879">i</span>&nbsp;<span class="op" id="6954881">:=</span>&nbsp;<span class="num" id="6954884">0</span><span class="op" id="6954885">;</span>&nbsp;<span class="ident" id="6954887">i</span>&nbsp;<span class="op" id="6954889">&lt;</span>&nbsp;<span class="ident" id="6954891">b</span><span class="op" id="6954892">.</span><span class="ident" id="6954893">N</span><span class="op" id="6954894">;</span>&nbsp;<span class="ident" id="6954896">i</span><span class="op" id="6954897">++</span>&nbsp;<span class="op" id="6954900">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954904">Encode</span><span class="op" id="6954910">(</span><span class="ident" id="6954911">ioutil</span><span class="op" id="6954917">.</span><span class="ident" id="6954918">Discard</span><span class="op" id="6954925">,</span>&nbsp;<span class="ident" id="6954927">img</span><span class="op" id="6954930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954933">}</span><br>
<span class="lineno"></span><span class="op" id="6954935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954938">func</span>&nbsp;<span class="ident" id="6954943">BenchmarkEncodeRGBOpaque</span><span class="op" id="6954967">(</span><span class="ident" id="6954968">b</span>&nbsp;<span class="op" id="6954970">*</span><span class="ident" id="6954971">testing</span><span class="op" id="6954978">.</span><span class="ident" id="6954979">B</span><span class="op" id="6954980">)</span>&nbsp;<span class="op" id="6954982">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954985">b</span><span class="op" id="6954986">.</span><span class="ident" id="6954987">StopTimer</span><span class="op" id="6954996">(</span><span class="op" id="6954997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955000">img</span>&nbsp;<span class="op" id="6955004">:=</span>&nbsp;<span class="ident" id="6955007">image</span><span class="op" id="6955012">.</span><span class="ident" id="6955013">NewRGBA</span><span class="op" id="6955020">(</span><span class="ident" id="6955021">image</span><span class="op" id="6955026">.</span><span class="ident" id="6955027">Rect</span><span class="op" id="6955031">(</span><span class="num" id="6955032">0</span><span class="op" id="6955033">,</span>&nbsp;<span class="num" id="6955035">0</span><span class="op" id="6955036">,</span>&nbsp;<span class="num" id="6955038">640</span><span class="op" id="6955041">,</span>&nbsp;<span class="num" id="6955043">480</span><span class="op" id="6955046">)</span><span class="op" id="6955047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955050">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955105">bo</span>&nbsp;<span class="op" id="6955108">:=</span>&nbsp;<span class="ident" id="6955111">img</span><span class="op" id="6955114">.</span><span class="ident" id="6955115">Bounds</span><span class="op" id="6955121">(</span><span class="op" id="6955122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955125">for</span>&nbsp;<span class="ident" id="6955129">y</span>&nbsp;<span class="op" id="6955131">:=</span>&nbsp;<span class="ident" id="6955134">bo</span><span class="op" id="6955136">.</span><span class="ident" id="6955137">Min</span><span class="op" id="6955140">.</span><span class="ident" id="6955141">Y</span><span class="op" id="6955142">;</span>&nbsp;<span class="ident" id="6955144">y</span>&nbsp;<span class="op" id="6955146">&lt;</span>&nbsp;<span class="ident" id="6955148">bo</span><span class="op" id="6955150">.</span><span class="ident" id="6955151">Max</span><span class="op" id="6955154">.</span><span class="ident" id="6955155">Y</span><span class="op" id="6955156">;</span>&nbsp;<span class="ident" id="6955158">y</span><span class="op" id="6955159">++</span>&nbsp;<span class="op" id="6955162">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955166">for</span>&nbsp;<span class="ident" id="6955170">x</span>&nbsp;<span class="op" id="6955172">:=</span>&nbsp;<span class="ident" id="6955175">bo</span><span class="op" id="6955177">.</span><span class="ident" id="6955178">Min</span><span class="op" id="6955181">.</span><span class="ident" id="6955182">X</span><span class="op" id="6955183">;</span>&nbsp;<span class="ident" id="6955185">x</span>&nbsp;<span class="op" id="6955187">&lt;</span>&nbsp;<span class="ident" id="6955189">bo</span><span class="op" id="6955191">.</span><span class="ident" id="6955192">Max</span><span class="op" id="6955195">.</span><span class="ident" id="6955196">X</span><span class="op" id="6955197">;</span>&nbsp;<span class="ident" id="6955199">x</span><span class="op" id="6955200">++</span>&nbsp;<span class="op" id="6955203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955208">img</span><span class="op" id="6955211">.</span><span class="ident" id="6955212">Set</span><span class="op" id="6955215">(</span><span class="ident" id="6955216">x</span><span class="op" id="6955217">,</span>&nbsp;<span class="ident" id="6955219">y</span><span class="op" id="6955220">,</span>&nbsp;<span class="ident" id="6955222">color</span><span class="op" id="6955227">.</span><span class="ident" id="6955228">RGBA</span><span class="op" id="6955232">{</span><span class="num" id="6955233">0</span><span class="op" id="6955234">,</span>&nbsp;<span class="num" id="6955236">0</span><span class="op" id="6955237">,</span>&nbsp;<span class="num" id="6955239">0</span><span class="op" id="6955240">,</span>&nbsp;<span class="num" id="6955242">255</span><span class="op" id="6955245">}</span><span class="op" id="6955246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955256">if</span>&nbsp;<span class="op" id="6955259">!</span><span class="ident" id="6955260">img</span><span class="op" id="6955263">.</span><span class="ident" id="6955264">Opaque</span><span class="op" id="6955270">(</span><span class="op" id="6955271">)</span>&nbsp;<span class="op" id="6955273">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955277">b</span><span class="op" id="6955278">.</span><span class="ident" id="6955279">Fatal</span><span class="op" id="6955284">(</span><span class="string" id="6955285">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6955314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955320">b</span><span class="op" id="6955321">.</span><span class="ident" id="6955322">SetBytes</span><span class="op" id="6955330">(</span><span class="num" id="6955331">640</span>&nbsp;<span class="op" id="6955335">*</span>&nbsp;<span class="num" id="6955337">480</span>&nbsp;<span class="op" id="6955341">*</span>&nbsp;<span class="num" id="6955343">4</span><span class="op" id="6955344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955347">b</span><span class="op" id="6955348">.</span><span class="ident" id="6955349">StartTimer</span><span class="op" id="6955359">(</span><span class="op" id="6955360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955363">for</span>&nbsp;<span class="ident" id="6955367">i</span>&nbsp;<span class="op" id="6955369">:=</span>&nbsp;<span class="num" id="6955372">0</span><span class="op" id="6955373">;</span>&nbsp;<span class="ident" id="6955375">i</span>&nbsp;<span class="op" id="6955377">&lt;</span>&nbsp;<span class="ident" id="6955379">b</span><span class="op" id="6955380">.</span><span class="ident" id="6955381">N</span><span class="op" id="6955382">;</span>&nbsp;<span class="ident" id="6955384">i</span><span class="op" id="6955385">++</span>&nbsp;<span class="op" id="6955388">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955392">Encode</span><span class="op" id="6955398">(</span><span class="ident" id="6955399">ioutil</span><span class="op" id="6955405">.</span><span class="ident" id="6955406">Discard</span><span class="op" id="6955413">,</span>&nbsp;<span class="ident" id="6955415">img</span><span class="op" id="6955418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955421">}</span><br>
<span class="lineno"></span><span class="op" id="6955423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6955426">func</span>&nbsp;<span class="ident" id="6955431">BenchmarkEncodeRGBA</span><span class="op" id="6955450">(</span><span class="ident" id="6955451">b</span>&nbsp;<span class="op" id="6955453">*</span><span class="ident" id="6955454">testing</span><span class="op" id="6955461">.</span><span class="ident" id="6955462">B</span><span class="op" id="6955463">)</span>&nbsp;<span class="op" id="6955465">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955468">b</span><span class="op" id="6955469">.</span><span class="ident" id="6955470">StopTimer</span><span class="op" id="6955479">(</span><span class="op" id="6955480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955483">img</span>&nbsp;<span class="op" id="6955487">:=</span>&nbsp;<span class="ident" id="6955490">image</span><span class="op" id="6955495">.</span><span class="ident" id="6955496">NewRGBA</span><span class="op" id="6955503">(</span><span class="ident" id="6955504">image</span><span class="op" id="6955509">.</span><span class="ident" id="6955510">Rect</span><span class="op" id="6955514">(</span><span class="num" id="6955515">0</span><span class="op" id="6955516">,</span>&nbsp;<span class="num" id="6955518">0</span><span class="op" id="6955519">,</span>&nbsp;<span class="num" id="6955521">640</span><span class="op" id="6955524">,</span>&nbsp;<span class="num" id="6955526">480</span><span class="op" id="6955529">)</span><span class="op" id="6955530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955533">if</span>&nbsp;<span class="ident" id="6955536">img</span><span class="op" id="6955539">.</span><span class="ident" id="6955540">Opaque</span><span class="op" id="6955546">(</span><span class="op" id="6955547">)</span>&nbsp;<span class="op" id="6955549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955553">b</span><span class="op" id="6955554">.</span><span class="ident" id="6955555">Fatal</span><span class="op" id="6955560">(</span><span class="string" id="6955561">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6955594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955597">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955600">b</span><span class="op" id="6955601">.</span><span class="ident" id="6955602">SetBytes</span><span class="op" id="6955610">(</span><span class="num" id="6955611">640</span>&nbsp;<span class="op" id="6955615">*</span>&nbsp;<span class="num" id="6955617">480</span>&nbsp;<span class="op" id="6955621">*</span>&nbsp;<span class="num" id="6955623">4</span><span class="op" id="6955624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955627">b</span><span class="op" id="6955628">.</span><span class="ident" id="6955629">StartTimer</span><span class="op" id="6955639">(</span><span class="op" id="6955640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6955643">for</span>&nbsp;<span class="ident" id="6955647">i</span>&nbsp;<span class="op" id="6955649">:=</span>&nbsp;<span class="num" id="6955652">0</span><span class="op" id="6955653">;</span>&nbsp;<span class="ident" id="6955655">i</span>&nbsp;<span class="op" id="6955657">&lt;</span>&nbsp;<span class="ident" id="6955659">b</span><span class="op" id="6955660">.</span><span class="ident" id="6955661">N</span><span class="op" id="6955662">;</span>&nbsp;<span class="ident" id="6955664">i</span><span class="op" id="6955665">++</span>&nbsp;<span class="op" id="6955668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6955672">Encode</span><span class="op" id="6955678">(</span><span class="ident" id="6955679">ioutil</span><span class="op" id="6955685">.</span><span class="ident" id="6955686">Discard</span><span class="op" id="6955693">,</span>&nbsp;<span class="ident" id="6955695">img</span><span class="op" id="6955698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955701">}</span><br>
<span class="lineno">210</span><span class="op" id="6955703">}</span>
</div>
</body>
</html>
