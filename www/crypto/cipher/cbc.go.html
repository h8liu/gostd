<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3702075">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3702130">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3702184">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3702235">//&nbsp;Cipher&nbsp;block&nbsp;chaining&nbsp;(CBC)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3702273">//&nbsp;CBC&nbsp;provides&nbsp;confidentiality&nbsp;by&nbsp;xoring&nbsp;(chaining)&nbsp;each&nbsp;plaintext&nbsp;block</span><br>
<span class="lineno"></span><span class="comment" id="3702347">//&nbsp;with&nbsp;the&nbsp;previous&nbsp;ciphertext&nbsp;block&nbsp;before&nbsp;applying&nbsp;the&nbsp;block&nbsp;cipher.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="3702420">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;10-11</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702454">package</span>&nbsp;<span class="ident" id="3702462">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702470">type</span>&nbsp;<span class="ident" id="3702475">cbc</span>&nbsp;<span class="keyword" id="3702479">struct</span>&nbsp;<span class="op" id="3702486">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702489">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3702499"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702506">blockSize</span>&nbsp;<span class="builtintype" id="3702516">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702521">iv</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3702531">[</span><span class="op" id="3702532">]</span><span class="builtintype" id="3702533">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702539">tmp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3702549">[</span><span class="op" id="3702550">]</span><span class="builtintype" id="3702551">byte</span><br>
<span class="lineno"></span><span class="op" id="3702556">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3702559">func</span>&nbsp;<span class="ident" id="3702564">newCBC</span><span class="op" id="3702570">(</span><span class="ident" id="3702571">b</span>&nbsp;<span class="ident" id="3702573"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><span class="op" id="3702578">,</span>&nbsp;<span class="ident" id="3702580">iv</span>&nbsp;<span class="op" id="3702583">[</span><span class="op" id="3702584">]</span><span class="builtintype" id="3702585">byte</span><span class="op" id="3702589">)</span>&nbsp;<span class="op" id="3702591">*</span><span class="ident" id="3702592"><a href="/crypto/cipher/cbc.go.html#3702475">cbc</a></span>&nbsp;<span class="op" id="3702596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702599">return</span>&nbsp;<span class="op" id="3702606">&amp;</span><span class="ident" id="3702607"><a href="/crypto/cipher/cbc.go.html#3702475">cbc</a></span><span class="op" id="3702610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702614">b</span><span class="op" id="3702615">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3702625"><a href="/crypto/cipher/cbc.go.html#3702571">b</a></span><span class="op" id="3702626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702630">blockSize</span><span class="op" id="3702639">:</span>&nbsp;<span class="ident" id="3702641"><a href="/crypto/cipher/cbc.go.html#3702571">b</a></span><span class="op" id="3702642">.</span><span class="ident" id="3702643">BlockSize</span><span class="op" id="3702652">(</span><span class="op" id="3702653">)</span><span class="op" id="3702654">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702658">iv</span><span class="op" id="3702660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3702669"><a href="/crypto/cipher/cipher.go.html#3709015">dup</a></span><span class="op" id="3702672">(</span><span class="ident" id="3702673"><a href="/crypto/cipher/cbc.go.html#3702580">iv</a></span><span class="op" id="3702675">)</span><span class="op" id="3702676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702680">tmp</span><span class="op" id="3702683">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3702691">make</span><span class="op" id="3702695">(</span><span class="op" id="3702696">[</span><span class="op" id="3702697">]</span><span class="builtintype" id="3702698">byte</span><span class="op" id="3702702">,</span>&nbsp;<span class="ident" id="3702704"><a href="/crypto/cipher/cbc.go.html#3702571">b</a></span><span class="op" id="3702705">.</span><span class="ident" id="3702706">BlockSize</span><span class="op" id="3702715">(</span><span class="op" id="3702716">)</span><span class="op" id="3702717">)</span><span class="op" id="3702718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702721">}</span><br>
<span class="lineno"></span><span class="op" id="3702723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3702726">type</span>&nbsp;<span class="ident" id="3702731">cbcEncrypter</span>&nbsp;<span class="ident" id="3702744"><a href="/crypto/cipher/cbc.go.html#3702475">cbc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3702749">//&nbsp;NewCBCEncrypter&nbsp;returns&nbsp;a&nbsp;BlockMode&nbsp;which&nbsp;encrypts&nbsp;in&nbsp;cipher&nbsp;block&nbsp;chaining</span><br>
<span class="lineno"></span><span class="comment" id="3702828">//&nbsp;mode,&nbsp;using&nbsp;the&nbsp;given&nbsp;Block.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3702901">//&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno">35</span><span class="keyword" id="3702924">func</span>&nbsp;<span class="ident" id="3702929">NewCBCEncrypter</span><span class="op" id="3702944">(</span><span class="ident" id="3702945">b</span>&nbsp;<span class="ident" id="3702947"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><span class="op" id="3702952">,</span>&nbsp;<span class="ident" id="3702954">iv</span>&nbsp;<span class="op" id="3702957">[</span><span class="op" id="3702958">]</span><span class="builtintype" id="3702959">byte</span><span class="op" id="3702963">)</span>&nbsp;<span class="ident" id="3702965"><a href="/crypto/cipher/cipher.go.html#3708708">BlockMode</a></span>&nbsp;<span class="op" id="3702975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702978">if</span>&nbsp;<span class="builtinfunc" id="3702981">len</span><span class="op" id="3702984">(</span><span class="ident" id="3702985"><a href="/crypto/cipher/cbc.go.html#3702954">iv</a></span><span class="op" id="3702987">)</span>&nbsp;<span class="op" id="3702989">!=</span>&nbsp;<span class="ident" id="3702992"><a href="/crypto/cipher/cbc.go.html#3702945">b</a></span><span class="op" id="3702993">.</span><span class="ident" id="3702994">BlockSize</span><span class="op" id="3703003">(</span><span class="op" id="3703004">)</span>&nbsp;<span class="op" id="3703006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703010">panic</span><span class="op" id="3703015">(</span><span class="string" id="3703016">&#34;cipher.NewCBCEncrypter:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3703073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703079">return</span>&nbsp;<span class="op" id="3703086">(</span><span class="op" id="3703087">*</span><span class="ident" id="3703088"><a href="/crypto/cipher/cbc.go.html#3702731">cbcEncrypter</a></span><span class="op" id="3703100">)</span><span class="op" id="3703101">(</span><span class="ident" id="3703102"><a href="/crypto/cipher/cbc.go.html#3702564">newCBC</a></span><span class="op" id="3703108">(</span><span class="ident" id="3703109"><a href="/crypto/cipher/cbc.go.html#3702945">b</a></span><span class="op" id="3703110">,</span>&nbsp;<span class="ident" id="3703112"><a href="/crypto/cipher/cbc.go.html#3702954">iv</a></span><span class="op" id="3703114">)</span><span class="op" id="3703115">)</span><br>
<span class="lineno">40</span><span class="op" id="3703117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703120">func</span>&nbsp;<span class="op" id="3703125">(</span><span class="ident" id="3703126">x</span>&nbsp;<span class="op" id="3703128">*</span><span class="ident" id="3703129"><a href="/crypto/cipher/cbc.go.html#3702731">cbcEncrypter</a></span><span class="op" id="3703141">)</span>&nbsp;<span class="ident" id="3703143">BlockSize</span><span class="op" id="3703152">(</span><span class="op" id="3703153">)</span>&nbsp;<span class="builtintype" id="3703155">int</span>&nbsp;<span class="op" id="3703159">{</span>&nbsp;<span class="keyword" id="3703161">return</span>&nbsp;<span class="ident" id="3703168"><a href="/crypto/cipher/cbc.go.html#3703126">x</a></span><span class="op" id="3703169">.</span><span class="ident" id="3703170">blockSize</span>&nbsp;<span class="op" id="3703180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703183">func</span>&nbsp;<span class="op" id="3703188">(</span><span class="ident" id="3703189">x</span>&nbsp;<span class="op" id="3703191">*</span><span class="ident" id="3703192"><a href="/crypto/cipher/cbc.go.html#3702731">cbcEncrypter</a></span><span class="op" id="3703204">)</span>&nbsp;<span class="ident" id="3703206">CryptBlocks</span><span class="op" id="3703217">(</span><span class="ident" id="3703218">dst</span><span class="op" id="3703221">,</span>&nbsp;<span class="ident" id="3703223">src</span>&nbsp;<span class="op" id="3703227">[</span><span class="op" id="3703228">]</span><span class="builtintype" id="3703229">byte</span><span class="op" id="3703233">)</span>&nbsp;<span class="op" id="3703235">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703238">if</span>&nbsp;<span class="builtinfunc" id="3703241">len</span><span class="op" id="3703244">(</span><span class="ident" id="3703245"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span><span class="op" id="3703248">)</span><span class="op" id="3703249">%</span><span class="ident" id="3703250"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703251">.</span><span class="ident" id="3703252">blockSize</span>&nbsp;<span class="op" id="3703262">!=</span>&nbsp;<span class="num" id="3703265">0</span>&nbsp;<span class="op" id="3703267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703271">panic</span><span class="op" id="3703276">(</span><span class="string" id="3703277">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="3703315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703321">if</span>&nbsp;<span class="builtinfunc" id="3703324">len</span><span class="op" id="3703327">(</span><span class="ident" id="3703328"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703331">)</span>&nbsp;<span class="op" id="3703333">&lt;</span>&nbsp;<span class="builtinfunc" id="3703335">len</span><span class="op" id="3703338">(</span><span class="ident" id="3703339"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span><span class="op" id="3703342">)</span>&nbsp;<span class="op" id="3703344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703348">panic</span><span class="op" id="3703353">(</span><span class="string" id="3703354">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="3703396">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703403">iv</span>&nbsp;<span class="op" id="3703406">:=</span>&nbsp;<span class="ident" id="3703409"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703410">.</span><span class="ident" id="3703411">iv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703416">for</span>&nbsp;<span class="builtinfunc" id="3703420">len</span><span class="op" id="3703423">(</span><span class="ident" id="3703424"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span><span class="op" id="3703427">)</span>&nbsp;<span class="op" id="3703429">&gt;</span>&nbsp;<span class="num" id="3703431">0</span>&nbsp;<span class="op" id="3703433">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703437">//&nbsp;Write&nbsp;the&nbsp;xor&nbsp;to&nbsp;dst,&nbsp;then&nbsp;encrypt&nbsp;in&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703487"><a href="/crypto/cipher/xor.go.html#3724540">xorBytes</a></span><span class="op" id="3703495">(</span><span class="ident" id="3703496"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703499">[</span><span class="op" id="3703500">:</span><span class="ident" id="3703501"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703502">.</span><span class="ident" id="3703503">blockSize</span><span class="op" id="3703512">]</span><span class="op" id="3703513">,</span>&nbsp;<span class="ident" id="3703515"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span><span class="op" id="3703518">[</span><span class="op" id="3703519">:</span><span class="ident" id="3703520"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703521">.</span><span class="ident" id="3703522">blockSize</span><span class="op" id="3703531">]</span><span class="op" id="3703532">,</span>&nbsp;<span class="ident" id="3703534"><a href="/crypto/cipher/cbc.go.html#3703403">iv</a></span><span class="op" id="3703536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703540"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703541">.</span><span class="ident" id="3703542">b</span><span class="op" id="3703543">.</span><span class="ident" id="3703544">Encrypt</span><span class="op" id="3703551">(</span><span class="ident" id="3703552"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703555">[</span><span class="op" id="3703556">:</span><span class="ident" id="3703557"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703558">.</span><span class="ident" id="3703559">blockSize</span><span class="op" id="3703568">]</span><span class="op" id="3703569">,</span>&nbsp;<span class="ident" id="3703571"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703574">[</span><span class="op" id="3703575">:</span><span class="ident" id="3703576"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703577">.</span><span class="ident" id="3703578">blockSize</span><span class="op" id="3703587">]</span><span class="op" id="3703588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703593">//&nbsp;Move&nbsp;to&nbsp;the&nbsp;next&nbsp;block&nbsp;with&nbsp;this&nbsp;block&nbsp;as&nbsp;the&nbsp;next&nbsp;iv.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703653"><a href="/crypto/cipher/cbc.go.html#3703403">iv</a></span>&nbsp;<span class="op" id="3703656">=</span>&nbsp;<span class="ident" id="3703658"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703661">[</span><span class="op" id="3703662">:</span><span class="ident" id="3703663"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703664">.</span><span class="ident" id="3703665">blockSize</span><span class="op" id="3703674">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703678"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span>&nbsp;<span class="op" id="3703682">=</span>&nbsp;<span class="ident" id="3703684"><a href="/crypto/cipher/cbc.go.html#3703223">src</a></span><span class="op" id="3703687">[</span><span class="ident" id="3703688"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703689">.</span><span class="ident" id="3703690">blockSize</span><span class="op" id="3703699">:</span><span class="op" id="3703700">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703704"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span>&nbsp;<span class="op" id="3703708">=</span>&nbsp;<span class="ident" id="3703710"><a href="/crypto/cipher/cbc.go.html#3703218">dst</a></span><span class="op" id="3703713">[</span><span class="ident" id="3703714"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703715">.</span><span class="ident" id="3703716">blockSize</span><span class="op" id="3703725">:</span><span class="op" id="3703726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3703733">//&nbsp;Save&nbsp;the&nbsp;iv&nbsp;for&nbsp;the&nbsp;next&nbsp;CryptBlocks&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703780">copy</span><span class="op" id="3703784">(</span><span class="ident" id="3703785"><a href="/crypto/cipher/cbc.go.html#3703189">x</a></span><span class="op" id="3703786">.</span><span class="ident" id="3703787">iv</span><span class="op" id="3703789">,</span>&nbsp;<span class="ident" id="3703791"><a href="/crypto/cipher/cbc.go.html#3703403">iv</a></span><span class="op" id="3703793">)</span><br>
<span class="lineno"></span><span class="op" id="3703795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703798">func</span>&nbsp;<span class="op" id="3703803">(</span><span class="ident" id="3703804">x</span>&nbsp;<span class="op" id="3703806">*</span><span class="ident" id="3703807"><a href="/crypto/cipher/cbc.go.html#3702731">cbcEncrypter</a></span><span class="op" id="3703819">)</span>&nbsp;<span class="ident" id="3703821">SetIV</span><span class="op" id="3703826">(</span><span class="ident" id="3703827">iv</span>&nbsp;<span class="op" id="3703830">[</span><span class="op" id="3703831">]</span><span class="builtintype" id="3703832">byte</span><span class="op" id="3703836">)</span>&nbsp;<span class="op" id="3703838">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703841">if</span>&nbsp;<span class="builtinfunc" id="3703844">len</span><span class="op" id="3703847">(</span><span class="ident" id="3703848"><a href="/crypto/cipher/cbc.go.html#3703827">iv</a></span><span class="op" id="3703850">)</span>&nbsp;<span class="op" id="3703852">!=</span>&nbsp;<span class="builtinfunc" id="3703855">len</span><span class="op" id="3703858">(</span><span class="ident" id="3703859"><a href="/crypto/cipher/cbc.go.html#3703804">x</a></span><span class="op" id="3703860">.</span><span class="ident" id="3703861">iv</span><span class="op" id="3703863">)</span>&nbsp;<span class="op" id="3703865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703869">panic</span><span class="op" id="3703874">(</span><span class="string" id="3703875">&#34;cipher:&nbsp;incorrect&nbsp;length&nbsp;IV&#34;</span><span class="op" id="3703904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3703910">copy</span><span class="op" id="3703914">(</span><span class="ident" id="3703915"><a href="/crypto/cipher/cbc.go.html#3703804">x</a></span><span class="op" id="3703916">.</span><span class="ident" id="3703917">iv</span><span class="op" id="3703919">,</span>&nbsp;<span class="ident" id="3703921"><a href="/crypto/cipher/cbc.go.html#3703827">iv</a></span><span class="op" id="3703923">)</span><br>
<span class="lineno"></span><span class="op" id="3703925">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="3703928">type</span>&nbsp;<span class="ident" id="3703933">cbcDecrypter</span>&nbsp;<span class="ident" id="3703946"><a href="/crypto/cipher/cbc.go.html#3702475">cbc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3703951">//&nbsp;NewCBCDecrypter&nbsp;returns&nbsp;a&nbsp;BlockMode&nbsp;which&nbsp;decrypts&nbsp;in&nbsp;cipher&nbsp;block&nbsp;chaining</span><br>
<span class="lineno"></span><span class="comment" id="3704030">//&nbsp;mode,&nbsp;using&nbsp;the&nbsp;given&nbsp;Block.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="3704103">//&nbsp;Block&#39;s&nbsp;block&nbsp;size&nbsp;and&nbsp;must&nbsp;match&nbsp;the&nbsp;iv&nbsp;used&nbsp;to&nbsp;encrypt&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3704173">func</span>&nbsp;<span class="ident" id="3704178">NewCBCDecrypter</span><span class="op" id="3704193">(</span><span class="ident" id="3704194">b</span>&nbsp;<span class="ident" id="3704196"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><span class="op" id="3704201">,</span>&nbsp;<span class="ident" id="3704203">iv</span>&nbsp;<span class="op" id="3704206">[</span><span class="op" id="3704207">]</span><span class="builtintype" id="3704208">byte</span><span class="op" id="3704212">)</span>&nbsp;<span class="ident" id="3704214"><a href="/crypto/cipher/cipher.go.html#3708708">BlockMode</a></span>&nbsp;<span class="op" id="3704224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704227">if</span>&nbsp;<span class="builtinfunc" id="3704230">len</span><span class="op" id="3704233">(</span><span class="ident" id="3704234"><a href="/crypto/cipher/cbc.go.html#3704203">iv</a></span><span class="op" id="3704236">)</span>&nbsp;<span class="op" id="3704238">!=</span>&nbsp;<span class="ident" id="3704241"><a href="/crypto/cipher/cbc.go.html#3704194">b</a></span><span class="op" id="3704242">.</span><span class="ident" id="3704243">BlockSize</span><span class="op" id="3704252">(</span><span class="op" id="3704253">)</span>&nbsp;<span class="op" id="3704255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3704259">panic</span><span class="op" id="3704264">(</span><span class="string" id="3704265">&#34;cipher.NewCBCDecrypter:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3704322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704325">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704328">return</span>&nbsp;<span class="op" id="3704335">(</span><span class="op" id="3704336">*</span><span class="ident" id="3704337"><a href="/crypto/cipher/cbc.go.html#3703933">cbcDecrypter</a></span><span class="op" id="3704349">)</span><span class="op" id="3704350">(</span><span class="ident" id="3704351"><a href="/crypto/cipher/cbc.go.html#3702564">newCBC</a></span><span class="op" id="3704357">(</span><span class="ident" id="3704358"><a href="/crypto/cipher/cbc.go.html#3704194">b</a></span><span class="op" id="3704359">,</span>&nbsp;<span class="ident" id="3704361"><a href="/crypto/cipher/cbc.go.html#3704203">iv</a></span><span class="op" id="3704363">)</span><span class="op" id="3704364">)</span><br>
<span class="lineno"></span><span class="op" id="3704366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3704369">func</span>&nbsp;<span class="op" id="3704374">(</span><span class="ident" id="3704375">x</span>&nbsp;<span class="op" id="3704377">*</span><span class="ident" id="3704378"><a href="/crypto/cipher/cbc.go.html#3703933">cbcDecrypter</a></span><span class="op" id="3704390">)</span>&nbsp;<span class="ident" id="3704392">BlockSize</span><span class="op" id="3704401">(</span><span class="op" id="3704402">)</span>&nbsp;<span class="builtintype" id="3704404">int</span>&nbsp;<span class="op" id="3704408">{</span>&nbsp;<span class="keyword" id="3704410">return</span>&nbsp;<span class="ident" id="3704417"><a href="/crypto/cipher/cbc.go.html#3704375">x</a></span><span class="op" id="3704418">.</span><span class="ident" id="3704419">blockSize</span>&nbsp;<span class="op" id="3704429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="3704432">func</span>&nbsp;<span class="op" id="3704437">(</span><span class="ident" id="3704438">x</span>&nbsp;<span class="op" id="3704440">*</span><span class="ident" id="3704441"><a href="/crypto/cipher/cbc.go.html#3703933">cbcDecrypter</a></span><span class="op" id="3704453">)</span>&nbsp;<span class="ident" id="3704455">CryptBlocks</span><span class="op" id="3704466">(</span><span class="ident" id="3704467">dst</span><span class="op" id="3704470">,</span>&nbsp;<span class="ident" id="3704472">src</span>&nbsp;<span class="op" id="3704476">[</span><span class="op" id="3704477">]</span><span class="builtintype" id="3704478">byte</span><span class="op" id="3704482">)</span>&nbsp;<span class="op" id="3704484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704487">if</span>&nbsp;<span class="builtinfunc" id="3704490">len</span><span class="op" id="3704493">(</span><span class="ident" id="3704494"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3704497">)</span><span class="op" id="3704498">%</span><span class="ident" id="3704499"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3704500">.</span><span class="ident" id="3704501">blockSize</span>&nbsp;<span class="op" id="3704511">!=</span>&nbsp;<span class="num" id="3704514">0</span>&nbsp;<span class="op" id="3704516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3704520">panic</span><span class="op" id="3704525">(</span><span class="string" id="3704526">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="3704564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704570">if</span>&nbsp;<span class="builtinfunc" id="3704573">len</span><span class="op" id="3704576">(</span><span class="ident" id="3704577"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3704580">)</span>&nbsp;<span class="op" id="3704582">&lt;</span>&nbsp;<span class="builtinfunc" id="3704584">len</span><span class="op" id="3704587">(</span><span class="ident" id="3704588"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3704591">)</span>&nbsp;<span class="op" id="3704593">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3704597">panic</span><span class="op" id="3704602">(</span><span class="string" id="3704603">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="3704645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704651">if</span>&nbsp;<span class="builtinfunc" id="3704654">len</span><span class="op" id="3704657">(</span><span class="ident" id="3704658"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3704661">)</span>&nbsp;<span class="op" id="3704663">==</span>&nbsp;<span class="num" id="3704666">0</span>&nbsp;<span class="op" id="3704668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704680">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3704684">//&nbsp;For&nbsp;each&nbsp;block,&nbsp;we&nbsp;need&nbsp;to&nbsp;xor&nbsp;the&nbsp;decrypted&nbsp;data&nbsp;with&nbsp;the&nbsp;previous&nbsp;block&#39;s&nbsp;ciphertext&nbsp;(the&nbsp;iv).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3704785">//&nbsp;To&nbsp;avoid&nbsp;making&nbsp;a&nbsp;copy&nbsp;each&nbsp;time,&nbsp;we&nbsp;loop&nbsp;over&nbsp;the&nbsp;blocks&nbsp;BACKWARDS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704858">end</span>&nbsp;<span class="op" id="3704862">:=</span>&nbsp;<span class="builtinfunc" id="3704865">len</span><span class="op" id="3704868">(</span><span class="ident" id="3704869"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3704872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704875">start</span>&nbsp;<span class="op" id="3704881">:=</span>&nbsp;<span class="ident" id="3704884"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span>&nbsp;<span class="op" id="3704888">-</span>&nbsp;<span class="ident" id="3704890"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3704891">.</span><span class="ident" id="3704892">blockSize</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704903">prev</span>&nbsp;<span class="op" id="3704908">:=</span>&nbsp;<span class="ident" id="3704911"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span>&nbsp;<span class="op" id="3704917">-</span>&nbsp;<span class="ident" id="3704919"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3704920">.</span><span class="ident" id="3704921">blockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3704933">//&nbsp;Copy&nbsp;the&nbsp;last&nbsp;block&nbsp;of&nbsp;ciphertext&nbsp;in&nbsp;preparation&nbsp;as&nbsp;the&nbsp;new&nbsp;iv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3705001">copy</span><span class="op" id="3705005">(</span><span class="ident" id="3705006"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705007">.</span><span class="ident" id="3705008">tmp</span><span class="op" id="3705011">,</span>&nbsp;<span class="ident" id="3705013"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3705016">[</span><span class="ident" id="3705017"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705022">:</span><span class="ident" id="3705023"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705026">]</span><span class="op" id="3705027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3705031">//&nbsp;Loop&nbsp;over&nbsp;all&nbsp;but&nbsp;the&nbsp;first&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705070">for</span>&nbsp;<span class="ident" id="3705074"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span>&nbsp;<span class="op" id="3705080">&gt;</span>&nbsp;<span class="num" id="3705082">0</span>&nbsp;<span class="op" id="3705084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705088"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705089">.</span><span class="ident" id="3705090">b</span><span class="op" id="3705091">.</span><span class="ident" id="3705092">Decrypt</span><span class="op" id="3705099">(</span><span class="ident" id="3705100"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705103">[</span><span class="ident" id="3705104"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705109">:</span><span class="ident" id="3705110"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705113">]</span><span class="op" id="3705114">,</span>&nbsp;<span class="ident" id="3705116"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3705119">[</span><span class="ident" id="3705120"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705125">:</span><span class="ident" id="3705126"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705129">]</span><span class="op" id="3705130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705134"><a href="/crypto/cipher/xor.go.html#3724540">xorBytes</a></span><span class="op" id="3705142">(</span><span class="ident" id="3705143"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705146">[</span><span class="ident" id="3705147"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705152">:</span><span class="ident" id="3705153"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705156">]</span><span class="op" id="3705157">,</span>&nbsp;<span class="ident" id="3705159"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705162">[</span><span class="ident" id="3705163"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705168">:</span><span class="ident" id="3705169"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705172">]</span><span class="op" id="3705173">,</span>&nbsp;<span class="ident" id="3705175"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3705178">[</span><span class="ident" id="3705179"><a href="/crypto/cipher/cbc.go.html#3704903">prev</a></span><span class="op" id="3705183">:</span><span class="ident" id="3705184"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705189">]</span><span class="op" id="3705190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705195"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span>&nbsp;<span class="op" id="3705199">=</span>&nbsp;<span class="ident" id="3705201"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705209"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span>&nbsp;<span class="op" id="3705215">=</span>&nbsp;<span class="ident" id="3705217"><a href="/crypto/cipher/cbc.go.html#3704903">prev</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705224"><a href="/crypto/cipher/cbc.go.html#3704903">prev</a></span>&nbsp;<span class="op" id="3705229">-=</span>&nbsp;<span class="ident" id="3705232"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705233">.</span><span class="ident" id="3705234">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3705249">//&nbsp;The&nbsp;first&nbsp;block&nbsp;is&nbsp;special&nbsp;because&nbsp;it&nbsp;uses&nbsp;the&nbsp;saved&nbsp;iv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705310"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705311">.</span><span class="ident" id="3705312">b</span><span class="op" id="3705313">.</span><span class="ident" id="3705314">Decrypt</span><span class="op" id="3705321">(</span><span class="ident" id="3705322"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705325">[</span><span class="ident" id="3705326"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705331">:</span><span class="ident" id="3705332"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705335">]</span><span class="op" id="3705336">,</span>&nbsp;<span class="ident" id="3705338"><a href="/crypto/cipher/cbc.go.html#3704472">src</a></span><span class="op" id="3705341">[</span><span class="ident" id="3705342"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705347">:</span><span class="ident" id="3705348"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705351">]</span><span class="op" id="3705352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705355"><a href="/crypto/cipher/xor.go.html#3724540">xorBytes</a></span><span class="op" id="3705363">(</span><span class="ident" id="3705364"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705367">[</span><span class="ident" id="3705368"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705373">:</span><span class="ident" id="3705374"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705377">]</span><span class="op" id="3705378">,</span>&nbsp;<span class="ident" id="3705380"><a href="/crypto/cipher/cbc.go.html#3704467">dst</a></span><span class="op" id="3705383">[</span><span class="ident" id="3705384"><a href="/crypto/cipher/cbc.go.html#3704875">start</a></span><span class="op" id="3705389">:</span><span class="ident" id="3705390"><a href="/crypto/cipher/cbc.go.html#3704858">end</a></span><span class="op" id="3705393">]</span><span class="op" id="3705394">,</span>&nbsp;<span class="ident" id="3705396"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705397">.</span><span class="ident" id="3705398">iv</span><span class="op" id="3705400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3705404">//&nbsp;Set&nbsp;the&nbsp;new&nbsp;iv&nbsp;to&nbsp;the&nbsp;first&nbsp;block&nbsp;we&nbsp;copied&nbsp;earlier.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705461"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705462">.</span><span class="ident" id="3705463">iv</span><span class="op" id="3705465">,</span>&nbsp;<span class="ident" id="3705467"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705468">.</span><span class="ident" id="3705469">tmp</span>&nbsp;<span class="op" id="3705473">=</span>&nbsp;<span class="ident" id="3705475"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705476">.</span><span class="ident" id="3705477">tmp</span><span class="op" id="3705480">,</span>&nbsp;<span class="ident" id="3705482"><a href="/crypto/cipher/cbc.go.html#3704438">x</a></span><span class="op" id="3705483">.</span><span class="ident" id="3705484">iv</span><br>
<span class="lineno"></span><span class="op" id="3705487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3705490">func</span>&nbsp;<span class="op" id="3705495">(</span><span class="ident" id="3705496">x</span>&nbsp;<span class="op" id="3705498">*</span><span class="ident" id="3705499"><a href="/crypto/cipher/cbc.go.html#3703933">cbcDecrypter</a></span><span class="op" id="3705511">)</span>&nbsp;<span class="ident" id="3705513">SetIV</span><span class="op" id="3705518">(</span><span class="ident" id="3705519">iv</span>&nbsp;<span class="op" id="3705522">[</span><span class="op" id="3705523">]</span><span class="builtintype" id="3705524">byte</span><span class="op" id="3705528">)</span>&nbsp;<span class="op" id="3705530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705533">if</span>&nbsp;<span class="builtinfunc" id="3705536">len</span><span class="op" id="3705539">(</span><span class="ident" id="3705540"><a href="/crypto/cipher/cbc.go.html#3705519">iv</a></span><span class="op" id="3705542">)</span>&nbsp;<span class="op" id="3705544">!=</span>&nbsp;<span class="builtinfunc" id="3705547">len</span><span class="op" id="3705550">(</span><span class="ident" id="3705551"><a href="/crypto/cipher/cbc.go.html#3705496">x</a></span><span class="op" id="3705552">.</span><span class="ident" id="3705553">iv</span><span class="op" id="3705555">)</span>&nbsp;<span class="op" id="3705557">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3705561">panic</span><span class="op" id="3705566">(</span><span class="string" id="3705567">&#34;cipher:&nbsp;incorrect&nbsp;length&nbsp;IV&#34;</span><span class="op" id="3705596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3705602">copy</span><span class="op" id="3705606">(</span><span class="ident" id="3705607"><a href="/crypto/cipher/cbc.go.html#3705496">x</a></span><span class="op" id="3705608">.</span><span class="ident" id="3705609">iv</span><span class="op" id="3705611">,</span>&nbsp;<span class="ident" id="3705613"><a href="/crypto/cipher/cbc.go.html#3705519">iv</a></span><span class="op" id="3705615">)</span><br>
<span class="lineno"></span><span class="op" id="3705617">}</span>
</div>
</body>
</html>
