<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="4865934">package</span>&nbsp;<span class="ident" id="4865942">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4865949">import</span>&nbsp;<span class="op" id="4865956">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4865959">&#34;math&#34;</span><br>
<span class="lineno">5</span><span class="op" id="4865966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4865969">//&nbsp;InstReg&nbsp;executes&nbsp;register&nbsp;based&nbsp;instructions</span><br>
<span class="lineno"></span><span class="keyword" id="4866017">type</span>&nbsp;<span class="ident" id="4866022">instReg</span>&nbsp;<span class="keyword" id="4866030">struct</span><span class="op" id="4866036">{</span><span class="op" id="4866037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="4866040">//&nbsp;I&nbsp;executes&nbsp;the&nbsp;register&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="comment" id="4866080">//&nbsp;Might&nbsp;return&nbsp;invalid&nbsp;instruction&nbsp;exception.</span><br>
<span class="lineno"></span><span class="keyword" id="4866127">func</span>&nbsp;<span class="op" id="4866132">(</span><span class="ident" id="4866133">i</span>&nbsp;<span class="op" id="4866135">*</span><span class="ident" id="4866136">instReg</span><span class="op" id="4866143">)</span>&nbsp;<span class="ident" id="4866145">I</span><span class="op" id="4866146">(</span><span class="ident" id="4866147">cpu</span>&nbsp;<span class="op" id="4866151">*</span><span class="ident" id="4866152">cpu</span><span class="op" id="4866155">,</span>&nbsp;<span class="ident" id="4866157">in</span>&nbsp;<span class="builtintype" id="4866160">uint32</span><span class="op" id="4866166">)</span>&nbsp;<span class="op" id="4866168">*</span><span class="ident" id="4866169">Excep</span>&nbsp;<span class="op" id="4866175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4866178">//&nbsp;bit&nbsp;(32:24]&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866199">if</span>&nbsp;<span class="op" id="4866202">(</span><span class="op" id="4866203">(</span><span class="ident" id="4866204">in</span>&nbsp;<span class="op" id="4866207">&gt;&gt;</span>&nbsp;<span class="num" id="4866210">24</span><span class="op" id="4866212">)</span>&nbsp;<span class="op" id="4866214">&amp;</span>&nbsp;<span class="num" id="4866216">0xff</span><span class="op" id="4866220">)</span>&nbsp;<span class="op" id="4866222">!=</span>&nbsp;<span class="num" id="4866225">0</span>&nbsp;<span class="op" id="4866227">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4866231">panic</span><span class="op" id="4866236">(</span><span class="string" id="4866237">&#34;not&nbsp;a&nbsp;register&nbsp;inst&#34;</span><span class="op" id="4866258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866265">dest</span>&nbsp;<span class="op" id="4866270">:=</span>&nbsp;<span class="op" id="4866273">(</span><span class="ident" id="4866274">in</span>&nbsp;<span class="op" id="4866277">&gt;&gt;</span>&nbsp;<span class="num" id="4866280">21</span><span class="op" id="4866282">)</span>&nbsp;<span class="op" id="4866284">&amp;</span>&nbsp;<span class="num" id="4866286">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4866292">//&nbsp;(24:21]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866304">src1</span>&nbsp;<span class="op" id="4866309">:=</span>&nbsp;<span class="op" id="4866312">(</span><span class="ident" id="4866313">in</span>&nbsp;<span class="op" id="4866316">&gt;&gt;</span>&nbsp;<span class="num" id="4866319">18</span><span class="op" id="4866321">)</span>&nbsp;<span class="op" id="4866323">&amp;</span>&nbsp;<span class="num" id="4866325">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4866331">//&nbsp;(21:18]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866343">src2</span>&nbsp;<span class="op" id="4866348">:=</span>&nbsp;<span class="op" id="4866351">(</span><span class="ident" id="4866352">in</span>&nbsp;<span class="op" id="4866355">&gt;&gt;</span>&nbsp;<span class="num" id="4866358">15</span><span class="op" id="4866360">)</span>&nbsp;<span class="op" id="4866362">&amp;</span>&nbsp;<span class="num" id="4866364">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4866370">//&nbsp;(18:15]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866382">shift</span>&nbsp;<span class="op" id="4866388">:=</span>&nbsp;<span class="op" id="4866391">(</span><span class="ident" id="4866392">in</span>&nbsp;<span class="op" id="4866395">&gt;&gt;</span>&nbsp;<span class="num" id="4866398">10</span><span class="op" id="4866400">)</span>&nbsp;<span class="op" id="4866402">&amp;</span>&nbsp;<span class="num" id="4866404">0x1f</span>&nbsp;<span class="comment" id="4866409">//&nbsp;(15:10]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866421">isFloat</span>&nbsp;<span class="op" id="4866429">:=</span>&nbsp;<span class="op" id="4866432">(</span><span class="ident" id="4866433">in</span>&nbsp;<span class="op" id="4866436">&gt;&gt;</span>&nbsp;<span class="num" id="4866439">8</span><span class="op" id="4866440">)</span>&nbsp;<span class="op" id="4866442">&amp;</span>&nbsp;<span class="num" id="4866444">0x1</span>&nbsp;<span class="comment" id="4866448">//&nbsp;(9:8]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866458">funct</span>&nbsp;<span class="op" id="4866464">:=</span>&nbsp;<span class="ident" id="4866467">in</span>&nbsp;<span class="op" id="4866470">&amp;</span>&nbsp;<span class="num" id="4866472">0xff</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866485">//&nbsp;(8:0]</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866496">s1</span>&nbsp;<span class="op" id="4866499">:=</span>&nbsp;<span class="ident" id="4866502">cpu</span><span class="op" id="4866505">.</span><span class="ident" id="4866506">regs</span><span class="op" id="4866510">[</span><span class="ident" id="4866511">src1</span><span class="op" id="4866515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866518">s2</span>&nbsp;<span class="op" id="4866521">:=</span>&nbsp;<span class="ident" id="4866524">cpu</span><span class="op" id="4866527">.</span><span class="ident" id="4866528">regs</span><span class="op" id="4866532">[</span><span class="ident" id="4866533">src2</span><span class="op" id="4866537">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866540">d</span>&nbsp;<span class="op" id="4866542">:=</span>&nbsp;<span class="builtintype" id="4866545">uint32</span><span class="op" id="4866551">(</span><span class="num" id="4866552">0</span><span class="op" id="4866553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866557">if</span>&nbsp;<span class="ident" id="4866560">isFloat</span>&nbsp;<span class="op" id="4866568">==</span>&nbsp;<span class="num" id="4866571">0</span>&nbsp;<span class="op" id="4866573">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866577">switch</span>&nbsp;<span class="ident" id="4866584">funct</span>&nbsp;<span class="op" id="4866590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866594">case</span>&nbsp;<span class="num" id="4866599">0</span><span class="op" id="4866600">:</span>&nbsp;<span class="comment" id="4866602">//&nbsp;sll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866612">d</span>&nbsp;<span class="op" id="4866614">=</span>&nbsp;<span class="ident" id="4866616">s1</span>&nbsp;<span class="op" id="4866619">&lt;&lt;</span>&nbsp;<span class="ident" id="4866622">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866630">case</span>&nbsp;<span class="num" id="4866635">1</span><span class="op" id="4866636">:</span>&nbsp;<span class="comment" id="4866638">//&nbsp;srl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866648">d</span>&nbsp;<span class="op" id="4866650">=</span>&nbsp;<span class="ident" id="4866652">s1</span>&nbsp;<span class="op" id="4866655">&gt;&gt;</span>&nbsp;<span class="ident" id="4866658">shift</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866666">case</span>&nbsp;<span class="num" id="4866671">2</span><span class="op" id="4866672">:</span>&nbsp;<span class="comment" id="4866674">//&nbsp;sra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866684">d</span>&nbsp;<span class="op" id="4866686">=</span>&nbsp;<span class="builtintype" id="4866688">uint32</span><span class="op" id="4866694">(</span><span class="builtintype" id="4866695">int32</span><span class="op" id="4866700">(</span><span class="ident" id="4866701">s1</span><span class="op" id="4866703">)</span>&nbsp;<span class="op" id="4866705">&gt;&gt;</span>&nbsp;<span class="ident" id="4866708">shift</span><span class="op" id="4866713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866717">case</span>&nbsp;<span class="num" id="4866722">3</span><span class="op" id="4866723">:</span>&nbsp;<span class="comment" id="4866725">//&nbsp;sllv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866736">d</span>&nbsp;<span class="op" id="4866738">=</span>&nbsp;<span class="ident" id="4866740">s1</span>&nbsp;<span class="op" id="4866743">&lt;&lt;</span>&nbsp;<span class="ident" id="4866746">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866751">case</span>&nbsp;<span class="num" id="4866756">4</span><span class="op" id="4866757">:</span>&nbsp;<span class="comment" id="4866759">//&nbsp;srlv</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866770">d</span>&nbsp;<span class="op" id="4866772">=</span>&nbsp;<span class="ident" id="4866774">s1</span>&nbsp;<span class="op" id="4866777">&gt;&gt;</span>&nbsp;<span class="ident" id="4866780">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866785">case</span>&nbsp;<span class="num" id="4866790">5</span><span class="op" id="4866791">:</span>&nbsp;<span class="comment" id="4866793">//&nbsp;srla</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866804">d</span>&nbsp;<span class="op" id="4866806">=</span>&nbsp;<span class="builtintype" id="4866808">uint32</span><span class="op" id="4866814">(</span><span class="builtintype" id="4866815">int32</span><span class="op" id="4866820">(</span><span class="ident" id="4866821">s1</span><span class="op" id="4866823">)</span>&nbsp;<span class="op" id="4866825">&gt;&gt;</span>&nbsp;<span class="ident" id="4866828">s2</span><span class="op" id="4866830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866834">case</span>&nbsp;<span class="num" id="4866839">6</span><span class="op" id="4866840">:</span>&nbsp;<span class="comment" id="4866842">//&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866852">d</span>&nbsp;<span class="op" id="4866854">=</span>&nbsp;<span class="ident" id="4866856">s1</span>&nbsp;<span class="op" id="4866859">+</span>&nbsp;<span class="ident" id="4866861">s2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866866">case</span>&nbsp;<span class="num" id="4866871">7</span><span class="op" id="4866872">:</span>&nbsp;<span class="comment" id="4866874">//&nbsp;sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866884">d</span>&nbsp;<span class="op" id="4866886">=</span>&nbsp;<span class="ident" id="4866888">s1</span>&nbsp;<span class="op" id="4866891">-</span>&nbsp;<span class="ident" id="4866893">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866898">case</span>&nbsp;<span class="num" id="4866903">8</span><span class="op" id="4866904">:</span>&nbsp;<span class="comment" id="4866906">//&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866916">d</span>&nbsp;<span class="op" id="4866918">=</span>&nbsp;<span class="ident" id="4866920">s1</span>&nbsp;<span class="op" id="4866923">&amp;</span>&nbsp;<span class="ident" id="4866925">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866930">case</span>&nbsp;<span class="num" id="4866935">9</span><span class="op" id="4866936">:</span>&nbsp;<span class="comment" id="4866938">//&nbsp;or</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866947">d</span>&nbsp;<span class="op" id="4866949">=</span>&nbsp;<span class="ident" id="4866951">s1</span>&nbsp;<span class="op" id="4866954">|</span>&nbsp;<span class="ident" id="4866956">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866961">case</span>&nbsp;<span class="num" id="4866966">10</span><span class="op" id="4866968">:</span>&nbsp;<span class="comment" id="4866970">//&nbsp;xor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866980">d</span>&nbsp;<span class="op" id="4866982">=</span>&nbsp;<span class="ident" id="4866984">s1</span>&nbsp;<span class="op" id="4866987">^</span>&nbsp;<span class="ident" id="4866989">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866994">case</span>&nbsp;<span class="num" id="4866999">11</span><span class="op" id="4867001">:</span>&nbsp;<span class="comment" id="4867003">//&nbsp;nor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867013">d</span>&nbsp;<span class="op" id="4867015">=</span>&nbsp;<span class="op" id="4867017">^</span><span class="op" id="4867018">(</span><span class="ident" id="4867019">s1</span>&nbsp;<span class="op" id="4867022">|</span>&nbsp;<span class="ident" id="4867024">s2</span><span class="op" id="4867026">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867030">case</span>&nbsp;<span class="num" id="4867035">12</span><span class="op" id="4867037">:</span>&nbsp;<span class="comment" id="4867039">//&nbsp;slt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867049">if</span>&nbsp;<span class="builtintype" id="4867052">int32</span><span class="op" id="4867057">(</span><span class="ident" id="4867058">s1</span><span class="op" id="4867060">)</span>&nbsp;<span class="op" id="4867062">&lt;</span>&nbsp;<span class="builtintype" id="4867064">int32</span><span class="op" id="4867069">(</span><span class="ident" id="4867070">s2</span><span class="op" id="4867072">)</span>&nbsp;<span class="op" id="4867074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867080">d</span>&nbsp;<span class="op" id="4867082">=</span>&nbsp;<span class="num" id="4867084">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867089">}</span>&nbsp;<span class="keyword" id="4867091">else</span>&nbsp;<span class="op" id="4867096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867102">d</span>&nbsp;<span class="op" id="4867104">=</span>&nbsp;<span class="num" id="4867106">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867115">case</span>&nbsp;<span class="num" id="4867120">13</span><span class="op" id="4867122">:</span>&nbsp;<span class="comment" id="4867124">//&nbsp;sltu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867135">if</span>&nbsp;<span class="ident" id="4867138">s1</span>&nbsp;<span class="op" id="4867141">&lt;</span>&nbsp;<span class="ident" id="4867143">s2</span>&nbsp;<span class="op" id="4867146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867152">d</span>&nbsp;<span class="op" id="4867154">=</span>&nbsp;<span class="num" id="4867156">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867161">}</span>&nbsp;<span class="keyword" id="4867163">else</span>&nbsp;<span class="op" id="4867168">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867174">d</span>&nbsp;<span class="op" id="4867176">=</span>&nbsp;<span class="num" id="4867178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867187">case</span>&nbsp;<span class="num" id="4867192">14</span><span class="op" id="4867194">:</span>&nbsp;<span class="comment" id="4867196">//&nbsp;mul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867206">d</span>&nbsp;<span class="op" id="4867208">=</span>&nbsp;<span class="builtintype" id="4867210">uint32</span><span class="op" id="4867216">(</span><span class="builtintype" id="4867217">int32</span><span class="op" id="4867222">(</span><span class="ident" id="4867223">s1</span><span class="op" id="4867225">)</span>&nbsp;<span class="op" id="4867227">*</span>&nbsp;<span class="builtintype" id="4867229">int32</span><span class="op" id="4867234">(</span><span class="ident" id="4867235">s2</span><span class="op" id="4867237">)</span><span class="op" id="4867238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867242">case</span>&nbsp;<span class="num" id="4867247">15</span><span class="op" id="4867249">:</span>&nbsp;<span class="comment" id="4867251">//&nbsp;mulu</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867262">d</span>&nbsp;<span class="op" id="4867264">=</span>&nbsp;<span class="ident" id="4867266">s1</span>&nbsp;<span class="op" id="4867269">*</span>&nbsp;<span class="ident" id="4867271">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867276">case</span>&nbsp;<span class="num" id="4867281">16</span><span class="op" id="4867283">:</span>&nbsp;<span class="comment" id="4867285">//&nbsp;div</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867295">if</span>&nbsp;<span class="ident" id="4867298">s2</span>&nbsp;<span class="op" id="4867301">==</span>&nbsp;<span class="num" id="4867304">0</span>&nbsp;<span class="op" id="4867306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867312">d</span>&nbsp;<span class="op" id="4867314">=</span>&nbsp;<span class="num" id="4867316">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867321">}</span>&nbsp;<span class="keyword" id="4867323">else</span>&nbsp;<span class="op" id="4867328">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867334">d</span>&nbsp;<span class="op" id="4867336">=</span>&nbsp;<span class="builtintype" id="4867338">uint32</span><span class="op" id="4867344">(</span><span class="builtintype" id="4867345">int32</span><span class="op" id="4867350">(</span><span class="ident" id="4867351">s1</span><span class="op" id="4867353">)</span>&nbsp;<span class="op" id="4867355">/</span>&nbsp;<span class="builtintype" id="4867357">int32</span><span class="op" id="4867362">(</span><span class="ident" id="4867363">s2</span><span class="op" id="4867365">)</span><span class="op" id="4867366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867375">case</span>&nbsp;<span class="num" id="4867380">17</span><span class="op" id="4867382">:</span>&nbsp;<span class="comment" id="4867384">//&nbsp;divu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867395">if</span>&nbsp;<span class="ident" id="4867398">s2</span>&nbsp;<span class="op" id="4867401">==</span>&nbsp;<span class="num" id="4867404">0</span>&nbsp;<span class="op" id="4867406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867412">d</span>&nbsp;<span class="op" id="4867414">=</span>&nbsp;<span class="num" id="4867416">0</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867421">}</span>&nbsp;<span class="keyword" id="4867423">else</span>&nbsp;<span class="op" id="4867428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867434">d</span>&nbsp;<span class="op" id="4867436">=</span>&nbsp;<span class="ident" id="4867438">s1</span>&nbsp;<span class="op" id="4867441">/</span>&nbsp;<span class="ident" id="4867443">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867453">case</span>&nbsp;<span class="num" id="4867458">18</span><span class="op" id="4867460">:</span>&nbsp;<span class="comment" id="4867462">//&nbsp;mod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867472">if</span>&nbsp;<span class="ident" id="4867475">s2</span>&nbsp;<span class="op" id="4867478">==</span>&nbsp;<span class="num" id="4867481">0</span>&nbsp;<span class="op" id="4867483">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867489">d</span>&nbsp;<span class="op" id="4867491">=</span>&nbsp;<span class="num" id="4867493">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867498">}</span>&nbsp;<span class="keyword" id="4867500">else</span>&nbsp;<span class="op" id="4867505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867511">d</span>&nbsp;<span class="op" id="4867513">=</span>&nbsp;<span class="builtintype" id="4867515">uint32</span><span class="op" id="4867521">(</span><span class="builtintype" id="4867522">int32</span><span class="op" id="4867527">(</span><span class="ident" id="4867528">s1</span><span class="op" id="4867530">)</span>&nbsp;<span class="op" id="4867532">%</span>&nbsp;<span class="builtintype" id="4867534">int32</span><span class="op" id="4867539">(</span><span class="ident" id="4867540">s2</span><span class="op" id="4867542">)</span><span class="op" id="4867543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867552">case</span>&nbsp;<span class="num" id="4867557">19</span><span class="op" id="4867559">:</span>&nbsp;<span class="comment" id="4867561">//&nbsp;modu</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867572">if</span>&nbsp;<span class="ident" id="4867575">s2</span>&nbsp;<span class="op" id="4867578">==</span>&nbsp;<span class="num" id="4867581">0</span>&nbsp;<span class="op" id="4867583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867589">d</span>&nbsp;<span class="op" id="4867591">=</span>&nbsp;<span class="num" id="4867593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867598">}</span>&nbsp;<span class="keyword" id="4867600">else</span>&nbsp;<span class="op" id="4867605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867611">d</span>&nbsp;<span class="op" id="4867613">=</span>&nbsp;<span class="ident" id="4867615">s1</span>&nbsp;<span class="op" id="4867618">%</span>&nbsp;<span class="ident" id="4867620">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867626">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867630">default</span><span class="op" id="4867637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867642">return</span>&nbsp;<span class="ident" id="4867649">errInvalidInst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867669">}</span>&nbsp;<span class="keyword" id="4867671">else</span>&nbsp;<span class="op" id="4867676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867680">f1</span>&nbsp;<span class="op" id="4867683">:=</span>&nbsp;<span class="ident" id="4867686">math</span><span class="op" id="4867690">.</span><span class="ident" id="4867691">Float32frombits</span><span class="op" id="4867706">(</span><span class="ident" id="4867707">s1</span><span class="op" id="4867709">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867713">f2</span>&nbsp;<span class="op" id="4867716">:=</span>&nbsp;<span class="ident" id="4867719">math</span><span class="op" id="4867723">.</span><span class="ident" id="4867724">Float32frombits</span><span class="op" id="4867739">(</span><span class="ident" id="4867740">s2</span><span class="op" id="4867742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867746">var</span>&nbsp;<span class="ident" id="4867750">fd</span>&nbsp;<span class="builtintype" id="4867753">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867763">switch</span>&nbsp;<span class="ident" id="4867770">funct</span>&nbsp;<span class="op" id="4867776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867780">case</span>&nbsp;<span class="num" id="4867785">0</span><span class="op" id="4867786">:</span>&nbsp;<span class="comment" id="4867788">//&nbsp;fadd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867799">fd</span>&nbsp;<span class="op" id="4867802">=</span>&nbsp;<span class="ident" id="4867804">f1</span>&nbsp;<span class="op" id="4867807">+</span>&nbsp;<span class="ident" id="4867809">f2</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867814">case</span>&nbsp;<span class="num" id="4867819">1</span><span class="op" id="4867820">:</span>&nbsp;<span class="comment" id="4867822">//&nbsp;fsub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867833">fd</span>&nbsp;<span class="op" id="4867836">=</span>&nbsp;<span class="ident" id="4867838">f1</span>&nbsp;<span class="op" id="4867841">-</span>&nbsp;<span class="ident" id="4867843">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867848">case</span>&nbsp;<span class="num" id="4867853">2</span><span class="op" id="4867854">:</span>&nbsp;<span class="comment" id="4867856">//&nbsp;fmul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867867">fd</span>&nbsp;<span class="op" id="4867870">=</span>&nbsp;<span class="ident" id="4867872">f1</span>&nbsp;<span class="op" id="4867875">*</span>&nbsp;<span class="ident" id="4867877">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867882">case</span>&nbsp;<span class="num" id="4867887">3</span><span class="op" id="4867888">:</span>&nbsp;<span class="comment" id="4867890">//&nbsp;fdiv</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867901">fd</span>&nbsp;<span class="op" id="4867904">=</span>&nbsp;<span class="ident" id="4867906">f1</span>&nbsp;<span class="op" id="4867909">/</span>&nbsp;<span class="ident" id="4867911">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867916">case</span>&nbsp;<span class="num" id="4867921">4</span><span class="op" id="4867922">:</span>&nbsp;<span class="comment" id="4867924">//&nbsp;fint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867935">d</span>&nbsp;<span class="op" id="4867937">=</span>&nbsp;<span class="builtintype" id="4867939">uint32</span><span class="op" id="4867945">(</span><span class="ident" id="4867946">f1</span><span class="op" id="4867948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867952">default</span><span class="op" id="4867959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867964">return</span>&nbsp;<span class="ident" id="4867971">errInvalidInst</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867993">if</span>&nbsp;<span class="ident" id="4867996">funct</span>&nbsp;<span class="op" id="4868002">!=</span>&nbsp;<span class="num" id="4868005">4</span>&nbsp;<span class="op" id="4868007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868012">d</span>&nbsp;<span class="op" id="4868014">=</span>&nbsp;<span class="ident" id="4868016">math</span><span class="op" id="4868020">.</span><span class="ident" id="4868021">Float32bits</span><span class="op" id="4868032">(</span><span class="ident" id="4868033">fd</span><span class="op" id="4868035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868039">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868046">cpu</span><span class="op" id="4868049">.</span><span class="ident" id="4868050">regs</span><span class="op" id="4868054">[</span><span class="ident" id="4868055">dest</span><span class="op" id="4868059">]</span>&nbsp;<span class="op" id="4868061">=</span>&nbsp;<span class="ident" id="4868063">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868066">return</span>&nbsp;<span class="ident" id="4868073">nil</span><br>
<span class="lineno"></span><span class="op" id="4868077">}</span>
</div>
</body>
</html>
