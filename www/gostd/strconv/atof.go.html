<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2224278">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2224333">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2224387">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2224438">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2224515">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2224539">package</span>&nbsp;<span class="ident" id="2224547">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2224556">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2224604">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2224618">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2224665">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2224738">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2224798">import</span>&nbsp;<span class="string" id="2224805">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2224813">var</span>&nbsp;<span class="ident" id="2224817">optimize</span>&nbsp;<span class="op" id="2224826">=</span>&nbsp;<span class="builtintype" id="2224828">true</span>&nbsp;<span class="comment" id="2224833">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2224860">func</span>&nbsp;<span class="ident" id="2224865">equalIgnoreCase</span><span class="op" id="2224880">(</span><span class="ident" id="2224881">s1</span><span class="op" id="2224883">,</span>&nbsp;<span class="ident" id="2224885">s2</span>&nbsp;<span class="builtintype" id="2224888">string</span><span class="op" id="2224894">)</span>&nbsp;<span class="builtintype" id="2224896">bool</span>&nbsp;<span class="op" id="2224901">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224904">if</span>&nbsp;<span class="builtinfunc" id="2224907">len</span><span class="op" id="2224910">(</span><span class="ident" id="2224911">s1</span><span class="op" id="2224913">)</span>&nbsp;<span class="op" id="2224915">!=</span>&nbsp;<span class="builtinfunc" id="2224918">len</span><span class="op" id="2224921">(</span><span class="ident" id="2224922">s2</span><span class="op" id="2224924">)</span>&nbsp;<span class="op" id="2224926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224930">return</span>&nbsp;<span class="builtintype" id="2224937">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2224944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224947">for</span>&nbsp;<span class="ident" id="2224951">i</span>&nbsp;<span class="op" id="2224953">:=</span>&nbsp;<span class="num" id="2224956">0</span><span class="op" id="2224957">;</span>&nbsp;<span class="ident" id="2224959">i</span>&nbsp;<span class="op" id="2224961">&lt;</span>&nbsp;<span class="builtinfunc" id="2224963">len</span><span class="op" id="2224966">(</span><span class="ident" id="2224967">s1</span><span class="op" id="2224969">)</span><span class="op" id="2224970">;</span>&nbsp;<span class="ident" id="2224972">i</span><span class="op" id="2224973">++</span>&nbsp;<span class="op" id="2224976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2224980">c1</span>&nbsp;<span class="op" id="2224983">:=</span>&nbsp;<span class="ident" id="2224986">s1</span><span class="op" id="2224988">[</span><span class="ident" id="2224989">i</span><span class="op" id="2224990">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2224994">if</span>&nbsp;<span class="string" id="2224997">&#39;A&#39;</span>&nbsp;<span class="op" id="2225001">&lt;=</span>&nbsp;<span class="ident" id="2225004">c1</span>&nbsp;<span class="op" id="2225007">&amp;&amp;</span>&nbsp;<span class="ident" id="2225010">c1</span>&nbsp;<span class="op" id="2225013">&lt;=</span>&nbsp;<span class="string" id="2225016">&#39;Z&#39;</span>&nbsp;<span class="op" id="2225020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225025">c1</span>&nbsp;<span class="op" id="2225028">+=</span>&nbsp;<span class="string" id="2225031">&#39;a&#39;</span>&nbsp;<span class="op" id="2225035">-</span>&nbsp;<span class="string" id="2225037">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225047">c2</span>&nbsp;<span class="op" id="2225050">:=</span>&nbsp;<span class="ident" id="2225053">s2</span><span class="op" id="2225055">[</span><span class="ident" id="2225056">i</span><span class="op" id="2225057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225061">if</span>&nbsp;<span class="string" id="2225064">&#39;A&#39;</span>&nbsp;<span class="op" id="2225068">&lt;=</span>&nbsp;<span class="ident" id="2225071">c2</span>&nbsp;<span class="op" id="2225074">&amp;&amp;</span>&nbsp;<span class="ident" id="2225077">c2</span>&nbsp;<span class="op" id="2225080">&lt;=</span>&nbsp;<span class="string" id="2225083">&#39;Z&#39;</span>&nbsp;<span class="op" id="2225087">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225092">c2</span>&nbsp;<span class="op" id="2225095">+=</span>&nbsp;<span class="string" id="2225098">&#39;a&#39;</span>&nbsp;<span class="op" id="2225102">-</span>&nbsp;<span class="string" id="2225104">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225114">if</span>&nbsp;<span class="ident" id="2225117">c1</span>&nbsp;<span class="op" id="2225120">!=</span>&nbsp;<span class="ident" id="2225123">c2</span>&nbsp;<span class="op" id="2225126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225131">return</span>&nbsp;<span class="builtintype" id="2225138">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225146">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225152">return</span>&nbsp;<span class="builtintype" id="2225159">true</span><br>
<span class="lineno"></span><span class="op" id="2225164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2225167">func</span>&nbsp;<span class="ident" id="2225172">special</span><span class="op" id="2225179">(</span><span class="ident" id="2225180">s</span>&nbsp;<span class="builtintype" id="2225182">string</span><span class="op" id="2225188">)</span>&nbsp;<span class="op" id="2225190">(</span><span class="ident" id="2225191">f</span>&nbsp;<span class="builtintype" id="2225193">float64</span><span class="op" id="2225200">,</span>&nbsp;<span class="ident" id="2225202">ok</span>&nbsp;<span class="builtintype" id="2225205">bool</span><span class="op" id="2225209">)</span>&nbsp;<span class="op" id="2225211">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225214">if</span>&nbsp;<span class="builtinfunc" id="2225217">len</span><span class="op" id="2225220">(</span><span class="ident" id="2225221">s</span><span class="op" id="2225222">)</span>&nbsp;<span class="op" id="2225224">==</span>&nbsp;<span class="num" id="2225227">0</span>&nbsp;<span class="op" id="2225229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225244">switch</span>&nbsp;<span class="ident" id="2225251">s</span><span class="op" id="2225252">[</span><span class="num" id="2225253">0</span><span class="op" id="2225254">]</span>&nbsp;<span class="op" id="2225256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225259">default</span><span class="op" id="2225266">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225278">case</span>&nbsp;<span class="string" id="2225283">&#39;+&#39;</span><span class="op" id="2225286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225290">if</span>&nbsp;<span class="ident" id="2225293">equalIgnoreCase</span><span class="op" id="2225308">(</span><span class="ident" id="2225309">s</span><span class="op" id="2225310">,</span>&nbsp;<span class="string" id="2225312">&#34;+inf&#34;</span><span class="op" id="2225318">)</span>&nbsp;<span class="op" id="2225320">||</span>&nbsp;<span class="ident" id="2225323">equalIgnoreCase</span><span class="op" id="2225338">(</span><span class="ident" id="2225339">s</span><span class="op" id="2225340">,</span>&nbsp;<span class="string" id="2225342">&#34;+infinity&#34;</span><span class="op" id="2225353">)</span>&nbsp;<span class="op" id="2225355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225360">return</span>&nbsp;<span class="ident" id="2225367">math</span><span class="op" id="2225371">.</span><span class="ident" id="2225372">Inf</span><span class="op" id="2225375">(</span><span class="num" id="2225376">1</span><span class="op" id="2225377">)</span><span class="op" id="2225378">,</span>&nbsp;<span class="builtintype" id="2225380">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225387">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225390">case</span>&nbsp;<span class="string" id="2225395">&#39;-&#39;</span><span class="op" id="2225398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225402">if</span>&nbsp;<span class="ident" id="2225405">equalIgnoreCase</span><span class="op" id="2225420">(</span><span class="ident" id="2225421">s</span><span class="op" id="2225422">,</span>&nbsp;<span class="string" id="2225424">&#34;-inf&#34;</span><span class="op" id="2225430">)</span>&nbsp;<span class="op" id="2225432">||</span>&nbsp;<span class="ident" id="2225435">equalIgnoreCase</span><span class="op" id="2225450">(</span><span class="ident" id="2225451">s</span><span class="op" id="2225452">,</span>&nbsp;<span class="string" id="2225454">&#34;-infinity&#34;</span><span class="op" id="2225465">)</span>&nbsp;<span class="op" id="2225467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225472">return</span>&nbsp;<span class="ident" id="2225479">math</span><span class="op" id="2225483">.</span><span class="ident" id="2225484">Inf</span><span class="op" id="2225487">(</span><span class="op" id="2225488">-</span><span class="num" id="2225489">1</span><span class="op" id="2225490">)</span><span class="op" id="2225491">,</span>&nbsp;<span class="builtintype" id="2225493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225503">case</span>&nbsp;<span class="string" id="2225508">&#39;n&#39;</span><span class="op" id="2225511">,</span>&nbsp;<span class="string" id="2225513">&#39;N&#39;</span><span class="op" id="2225516">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225520">if</span>&nbsp;<span class="ident" id="2225523">equalIgnoreCase</span><span class="op" id="2225538">(</span><span class="ident" id="2225539">s</span><span class="op" id="2225540">,</span>&nbsp;<span class="string" id="2225542">&#34;nan&#34;</span><span class="op" id="2225547">)</span>&nbsp;<span class="op" id="2225549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225554">return</span>&nbsp;<span class="ident" id="2225561">math</span><span class="op" id="2225565">.</span><span class="ident" id="2225566">NaN</span><span class="op" id="2225569">(</span><span class="op" id="2225570">)</span><span class="op" id="2225571">,</span>&nbsp;<span class="builtintype" id="2225573">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225583">case</span>&nbsp;<span class="string" id="2225588">&#39;i&#39;</span><span class="op" id="2225591">,</span>&nbsp;<span class="string" id="2225593">&#39;I&#39;</span><span class="op" id="2225596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225600">if</span>&nbsp;<span class="ident" id="2225603">equalIgnoreCase</span><span class="op" id="2225618">(</span><span class="ident" id="2225619">s</span><span class="op" id="2225620">,</span>&nbsp;<span class="string" id="2225622">&#34;inf&#34;</span><span class="op" id="2225627">)</span>&nbsp;<span class="op" id="2225629">||</span>&nbsp;<span class="ident" id="2225632">equalIgnoreCase</span><span class="op" id="2225647">(</span><span class="ident" id="2225648">s</span><span class="op" id="2225649">,</span>&nbsp;<span class="string" id="2225651">&#34;infinity&#34;</span><span class="op" id="2225661">)</span>&nbsp;<span class="op" id="2225663">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225668">return</span>&nbsp;<span class="ident" id="2225675">math</span><span class="op" id="2225679">.</span><span class="ident" id="2225680">Inf</span><span class="op" id="2225683">(</span><span class="num" id="2225684">1</span><span class="op" id="2225685">)</span><span class="op" id="2225686">,</span>&nbsp;<span class="builtintype" id="2225688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225701">return</span><br>
<span class="lineno"></span><span class="op" id="2225708">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2225711">func</span>&nbsp;<span class="op" id="2225716">(</span><span class="ident" id="2225717">b</span>&nbsp;<span class="op" id="2225719">*</span><span class="ident" id="2225720">decimal</span><span class="op" id="2225727">)</span>&nbsp;<span class="ident" id="2225729">set</span><span class="op" id="2225732">(</span><span class="ident" id="2225733">s</span>&nbsp;<span class="builtintype" id="2225735">string</span><span class="op" id="2225741">)</span>&nbsp;<span class="op" id="2225743">(</span><span class="ident" id="2225744">ok</span>&nbsp;<span class="builtintype" id="2225747">bool</span><span class="op" id="2225751">)</span>&nbsp;<span class="op" id="2225753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225756">i</span>&nbsp;<span class="op" id="2225758">:=</span>&nbsp;<span class="num" id="2225761">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225764">b</span><span class="op" id="2225765">.</span><span class="ident" id="2225766">neg</span>&nbsp;<span class="op" id="2225770">=</span>&nbsp;<span class="builtintype" id="2225772">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225779">b</span><span class="op" id="2225780">.</span><span class="ident" id="2225781">trunc</span>&nbsp;<span class="op" id="2225787">=</span>&nbsp;<span class="builtintype" id="2225789">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2225797">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225815">if</span>&nbsp;<span class="ident" id="2225818">i</span>&nbsp;<span class="op" id="2225820">&gt;=</span>&nbsp;<span class="builtinfunc" id="2225823">len</span><span class="op" id="2225826">(</span><span class="ident" id="2225827">s</span><span class="op" id="2225828">)</span>&nbsp;<span class="op" id="2225830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225834">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225842">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225845">switch</span>&nbsp;<span class="op" id="2225852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225855">case</span>&nbsp;<span class="ident" id="2225860">s</span><span class="op" id="2225861">[</span><span class="ident" id="2225862">i</span><span class="op" id="2225863">]</span>&nbsp;<span class="op" id="2225865">==</span>&nbsp;<span class="string" id="2225868">&#39;+&#39;</span><span class="op" id="2225871">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225875">i</span><span class="op" id="2225876">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225880">case</span>&nbsp;<span class="ident" id="2225885">s</span><span class="op" id="2225886">[</span><span class="ident" id="2225887">i</span><span class="op" id="2225888">]</span>&nbsp;<span class="op" id="2225890">==</span>&nbsp;<span class="string" id="2225893">&#39;-&#39;</span><span class="op" id="2225896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225900">b</span><span class="op" id="2225901">.</span><span class="ident" id="2225902">neg</span>&nbsp;<span class="op" id="2225906">=</span>&nbsp;<span class="builtintype" id="2225908">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225915">i</span><span class="op" id="2225916">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2225920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2225924">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225935">sawdot</span>&nbsp;<span class="op" id="2225942">:=</span>&nbsp;<span class="builtintype" id="2225945">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2225952">sawdigits</span>&nbsp;<span class="op" id="2225962">:=</span>&nbsp;<span class="builtintype" id="2225965">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225972">for</span>&nbsp;<span class="op" id="2225976">;</span>&nbsp;<span class="ident" id="2225978">i</span>&nbsp;<span class="op" id="2225980">&lt;</span>&nbsp;<span class="builtinfunc" id="2225982">len</span><span class="op" id="2225985">(</span><span class="ident" id="2225986">s</span><span class="op" id="2225987">)</span><span class="op" id="2225988">;</span>&nbsp;<span class="ident" id="2225990">i</span><span class="op" id="2225991">++</span>&nbsp;<span class="op" id="2225994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2225998">switch</span>&nbsp;<span class="op" id="2226005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226009">case</span>&nbsp;<span class="ident" id="2226014">s</span><span class="op" id="2226015">[</span><span class="ident" id="2226016">i</span><span class="op" id="2226017">]</span>&nbsp;<span class="op" id="2226019">==</span>&nbsp;<span class="string" id="2226022">&#39;.&#39;</span><span class="op" id="2226025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226030">if</span>&nbsp;<span class="ident" id="2226033">sawdot</span>&nbsp;<span class="op" id="2226040">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226046">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226061">sawdot</span>&nbsp;<span class="op" id="2226068">=</span>&nbsp;<span class="builtintype" id="2226070">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226078">b</span><span class="op" id="2226079">.</span><span class="ident" id="2226080">dp</span>&nbsp;<span class="op" id="2226083">=</span>&nbsp;<span class="ident" id="2226085">b</span><span class="op" id="2226086">.</span><span class="ident" id="2226087">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226093">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226105">case</span>&nbsp;<span class="string" id="2226110">&#39;0&#39;</span>&nbsp;<span class="op" id="2226114">&lt;=</span>&nbsp;<span class="ident" id="2226117">s</span><span class="op" id="2226118">[</span><span class="ident" id="2226119">i</span><span class="op" id="2226120">]</span>&nbsp;<span class="op" id="2226122">&amp;&amp;</span>&nbsp;<span class="ident" id="2226125">s</span><span class="op" id="2226126">[</span><span class="ident" id="2226127">i</span><span class="op" id="2226128">]</span>&nbsp;<span class="op" id="2226130">&lt;=</span>&nbsp;<span class="string" id="2226133">&#39;9&#39;</span><span class="op" id="2226136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226141">sawdigits</span>&nbsp;<span class="op" id="2226151">=</span>&nbsp;<span class="builtintype" id="2226153">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226161">if</span>&nbsp;<span class="ident" id="2226164">s</span><span class="op" id="2226165">[</span><span class="ident" id="2226166">i</span><span class="op" id="2226167">]</span>&nbsp;<span class="op" id="2226169">==</span>&nbsp;<span class="string" id="2226172">&#39;0&#39;</span>&nbsp;<span class="op" id="2226176">&amp;&amp;</span>&nbsp;<span class="ident" id="2226179">b</span><span class="op" id="2226180">.</span><span class="ident" id="2226181">nd</span>&nbsp;<span class="op" id="2226184">==</span>&nbsp;<span class="num" id="2226187">0</span>&nbsp;<span class="op" id="2226189">{</span>&nbsp;<span class="comment" id="2226191">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226219">b</span><span class="op" id="2226220">.</span><span class="ident" id="2226221">dp</span><span class="op" id="2226223">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226230">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226247">if</span>&nbsp;<span class="ident" id="2226250">b</span><span class="op" id="2226251">.</span><span class="ident" id="2226252">nd</span>&nbsp;<span class="op" id="2226255">&lt;</span>&nbsp;<span class="builtinfunc" id="2226257">len</span><span class="op" id="2226260">(</span><span class="ident" id="2226261">b</span><span class="op" id="2226262">.</span><span class="ident" id="2226263">d</span><span class="op" id="2226264">)</span>&nbsp;<span class="op" id="2226266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226272">b</span><span class="op" id="2226273">.</span><span class="ident" id="2226274">d</span><span class="op" id="2226275">[</span><span class="ident" id="2226276">b</span><span class="op" id="2226277">.</span><span class="ident" id="2226278">nd</span><span class="op" id="2226280">]</span>&nbsp;<span class="op" id="2226282">=</span>&nbsp;<span class="ident" id="2226284">s</span><span class="op" id="2226285">[</span><span class="ident" id="2226286">i</span><span class="op" id="2226287">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226293">b</span><span class="op" id="2226294">.</span><span class="ident" id="2226295">nd</span><span class="op" id="2226297">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226303">}</span>&nbsp;<span class="keyword" id="2226305">else</span>&nbsp;<span class="keyword" id="2226310">if</span>&nbsp;<span class="ident" id="2226313">s</span><span class="op" id="2226314">[</span><span class="ident" id="2226315">i</span><span class="op" id="2226316">]</span>&nbsp;<span class="op" id="2226318">!=</span>&nbsp;<span class="string" id="2226321">&#39;0&#39;</span>&nbsp;<span class="op" id="2226325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226331">b</span><span class="op" id="2226332">.</span><span class="ident" id="2226333">trunc</span>&nbsp;<span class="op" id="2226339">=</span>&nbsp;<span class="builtintype" id="2226341">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226354">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226365">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226369">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226379">if</span>&nbsp;<span class="op" id="2226382">!</span><span class="ident" id="2226383">sawdigits</span>&nbsp;<span class="op" id="2226393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226397">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226405">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226408">if</span>&nbsp;<span class="op" id="2226411">!</span><span class="ident" id="2226412">sawdot</span>&nbsp;<span class="op" id="2226419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226423">b</span><span class="op" id="2226424">.</span><span class="ident" id="2226425">dp</span>&nbsp;<span class="op" id="2226428">=</span>&nbsp;<span class="ident" id="2226430">b</span><span class="op" id="2226431">.</span><span class="ident" id="2226432">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2226440">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2226483">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2226530">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2226576">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2226628">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226654">if</span>&nbsp;<span class="ident" id="2226657">i</span>&nbsp;<span class="op" id="2226659">&lt;</span>&nbsp;<span class="builtinfunc" id="2226661">len</span><span class="op" id="2226664">(</span><span class="ident" id="2226665">s</span><span class="op" id="2226666">)</span>&nbsp;<span class="op" id="2226668">&amp;&amp;</span>&nbsp;<span class="op" id="2226671">(</span><span class="ident" id="2226672">s</span><span class="op" id="2226673">[</span><span class="ident" id="2226674">i</span><span class="op" id="2226675">]</span>&nbsp;<span class="op" id="2226677">==</span>&nbsp;<span class="string" id="2226680">&#39;e&#39;</span>&nbsp;<span class="op" id="2226684">||</span>&nbsp;<span class="ident" id="2226687">s</span><span class="op" id="2226688">[</span><span class="ident" id="2226689">i</span><span class="op" id="2226690">]</span>&nbsp;<span class="op" id="2226692">==</span>&nbsp;<span class="string" id="2226695">&#39;E&#39;</span><span class="op" id="2226698">)</span>&nbsp;<span class="op" id="2226700">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226704">i</span><span class="op" id="2226705">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226710">if</span>&nbsp;<span class="ident" id="2226713">i</span>&nbsp;<span class="op" id="2226715">&gt;=</span>&nbsp;<span class="builtinfunc" id="2226718">len</span><span class="op" id="2226721">(</span><span class="ident" id="2226722">s</span><span class="op" id="2226723">)</span>&nbsp;<span class="op" id="2226725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226743">esign</span>&nbsp;<span class="op" id="2226749">:=</span>&nbsp;<span class="num" id="2226752">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226756">if</span>&nbsp;<span class="ident" id="2226759">s</span><span class="op" id="2226760">[</span><span class="ident" id="2226761">i</span><span class="op" id="2226762">]</span>&nbsp;<span class="op" id="2226764">==</span>&nbsp;<span class="string" id="2226767">&#39;+&#39;</span>&nbsp;<span class="op" id="2226771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226776">i</span><span class="op" id="2226777">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226782">}</span>&nbsp;<span class="keyword" id="2226784">else</span>&nbsp;<span class="keyword" id="2226789">if</span>&nbsp;<span class="ident" id="2226792">s</span><span class="op" id="2226793">[</span><span class="ident" id="2226794">i</span><span class="op" id="2226795">]</span>&nbsp;<span class="op" id="2226797">==</span>&nbsp;<span class="string" id="2226800">&#39;-&#39;</span>&nbsp;<span class="op" id="2226804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226809">i</span><span class="op" id="2226810">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226816">esign</span>&nbsp;<span class="op" id="2226822">=</span>&nbsp;<span class="op" id="2226824">-</span><span class="num" id="2226825">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226833">if</span>&nbsp;<span class="ident" id="2226836">i</span>&nbsp;<span class="op" id="2226838">&gt;=</span>&nbsp;<span class="builtinfunc" id="2226841">len</span><span class="op" id="2226844">(</span><span class="ident" id="2226845">s</span><span class="op" id="2226846">)</span>&nbsp;<span class="op" id="2226848">||</span>&nbsp;<span class="ident" id="2226851">s</span><span class="op" id="2226852">[</span><span class="ident" id="2226853">i</span><span class="op" id="2226854">]</span>&nbsp;<span class="op" id="2226856">&lt;</span>&nbsp;<span class="string" id="2226858">&#39;0&#39;</span>&nbsp;<span class="op" id="2226862">||</span>&nbsp;<span class="ident" id="2226865">s</span><span class="op" id="2226866">[</span><span class="ident" id="2226867">i</span><span class="op" id="2226868">]</span>&nbsp;<span class="op" id="2226870">&gt;</span>&nbsp;<span class="string" id="2226872">&#39;9&#39;</span>&nbsp;<span class="op" id="2226876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226881">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2226890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226894">e</span>&nbsp;<span class="op" id="2226896">:=</span>&nbsp;<span class="num" id="2226899">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226903">for</span>&nbsp;<span class="op" id="2226907">;</span>&nbsp;<span class="ident" id="2226909">i</span>&nbsp;<span class="op" id="2226911">&lt;</span>&nbsp;<span class="builtinfunc" id="2226913">len</span><span class="op" id="2226916">(</span><span class="ident" id="2226917">s</span><span class="op" id="2226918">)</span>&nbsp;<span class="op" id="2226920">&amp;&amp;</span>&nbsp;<span class="string" id="2226923">&#39;0&#39;</span>&nbsp;<span class="op" id="2226927">&lt;=</span>&nbsp;<span class="ident" id="2226930">s</span><span class="op" id="2226931">[</span><span class="ident" id="2226932">i</span><span class="op" id="2226933">]</span>&nbsp;<span class="op" id="2226935">&amp;&amp;</span>&nbsp;<span class="ident" id="2226938">s</span><span class="op" id="2226939">[</span><span class="ident" id="2226940">i</span><span class="op" id="2226941">]</span>&nbsp;<span class="op" id="2226943">&lt;=</span>&nbsp;<span class="string" id="2226946">&#39;9&#39;</span><span class="op" id="2226949">;</span>&nbsp;<span class="ident" id="2226951">i</span><span class="op" id="2226952">++</span>&nbsp;<span class="op" id="2226955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2226960">if</span>&nbsp;<span class="ident" id="2226963">e</span>&nbsp;<span class="op" id="2226965">&lt;</span>&nbsp;<span class="num" id="2226967">10000</span>&nbsp;<span class="op" id="2226973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2226979">e</span>&nbsp;<span class="op" id="2226981">=</span>&nbsp;<span class="ident" id="2226983">e</span><span class="op" id="2226984">*</span><span class="num" id="2226985">10</span>&nbsp;<span class="op" id="2226988">+</span>&nbsp;<span class="builtintype" id="2226990">int</span><span class="op" id="2226993">(</span><span class="ident" id="2226994">s</span><span class="op" id="2226995">[</span><span class="ident" id="2226996">i</span><span class="op" id="2226997">]</span><span class="op" id="2226998">)</span>&nbsp;<span class="op" id="2227000">-</span>&nbsp;<span class="string" id="2227002">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227013">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227017">b</span><span class="op" id="2227018">.</span><span class="ident" id="2227019">dp</span>&nbsp;<span class="op" id="2227022">+=</span>&nbsp;<span class="ident" id="2227025">e</span>&nbsp;<span class="op" id="2227027">*</span>&nbsp;<span class="ident" id="2227029">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227040">if</span>&nbsp;<span class="ident" id="2227043">i</span>&nbsp;<span class="op" id="2227045">!=</span>&nbsp;<span class="builtinfunc" id="2227048">len</span><span class="op" id="2227051">(</span><span class="ident" id="2227052">s</span><span class="op" id="2227053">)</span>&nbsp;<span class="op" id="2227055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227059">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227071">ok</span>&nbsp;<span class="op" id="2227074">=</span>&nbsp;<span class="builtintype" id="2227076">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227082">return</span><br>
<span class="lineno"></span><span class="op" id="2227089">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2227092">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2227156">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2227222">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2227261">func</span>&nbsp;<span class="ident" id="2227266">readFloat</span><span class="op" id="2227275">(</span><span class="ident" id="2227276">s</span>&nbsp;<span class="builtintype" id="2227278">string</span><span class="op" id="2227284">)</span>&nbsp;<span class="op" id="2227286">(</span><span class="ident" id="2227287">mantissa</span>&nbsp;<span class="ident" id="2227296">uint64</span><span class="op" id="2227302">,</span>&nbsp;<span class="ident" id="2227304">exp</span>&nbsp;<span class="builtintype" id="2227308">int</span><span class="op" id="2227311">,</span>&nbsp;<span class="ident" id="2227313">neg</span><span class="op" id="2227316">,</span>&nbsp;<span class="ident" id="2227318">trunc</span><span class="op" id="2227323">,</span>&nbsp;<span class="ident" id="2227325">ok</span>&nbsp;<span class="builtintype" id="2227328">bool</span><span class="op" id="2227332">)</span>&nbsp;<span class="op" id="2227334">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227337">const</span>&nbsp;<span class="ident" id="2227343">uint64digits</span>&nbsp;<span class="op" id="2227356">=</span>&nbsp;<span class="num" id="2227358">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227362">i</span>&nbsp;<span class="op" id="2227364">:=</span>&nbsp;<span class="num" id="2227367">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2227371">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227389">if</span>&nbsp;<span class="ident" id="2227392">i</span>&nbsp;<span class="op" id="2227394">&gt;=</span>&nbsp;<span class="builtinfunc" id="2227397">len</span><span class="op" id="2227400">(</span><span class="ident" id="2227401">s</span><span class="op" id="2227402">)</span>&nbsp;<span class="op" id="2227404">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227408">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227419">switch</span>&nbsp;<span class="op" id="2227426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227429">case</span>&nbsp;<span class="ident" id="2227434">s</span><span class="op" id="2227435">[</span><span class="ident" id="2227436">i</span><span class="op" id="2227437">]</span>&nbsp;<span class="op" id="2227439">==</span>&nbsp;<span class="string" id="2227442">&#39;+&#39;</span><span class="op" id="2227445">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227449">i</span><span class="op" id="2227450">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227454">case</span>&nbsp;<span class="ident" id="2227459">s</span><span class="op" id="2227460">[</span><span class="ident" id="2227461">i</span><span class="op" id="2227462">]</span>&nbsp;<span class="op" id="2227464">==</span>&nbsp;<span class="string" id="2227467">&#39;-&#39;</span><span class="op" id="2227470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227474">neg</span>&nbsp;<span class="op" id="2227478">=</span>&nbsp;<span class="builtintype" id="2227480">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227487">i</span><span class="op" id="2227488">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2227496">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227507">sawdot</span>&nbsp;<span class="op" id="2227514">:=</span>&nbsp;<span class="builtintype" id="2227517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227524">sawdigits</span>&nbsp;<span class="op" id="2227534">:=</span>&nbsp;<span class="builtintype" id="2227537">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227544">nd</span>&nbsp;<span class="op" id="2227547">:=</span>&nbsp;<span class="num" id="2227550">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227553">ndMant</span>&nbsp;<span class="op" id="2227560">:=</span>&nbsp;<span class="num" id="2227563">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227566">dp</span>&nbsp;<span class="op" id="2227569">:=</span>&nbsp;<span class="num" id="2227572">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227575">for</span>&nbsp;<span class="op" id="2227579">;</span>&nbsp;<span class="ident" id="2227581">i</span>&nbsp;<span class="op" id="2227583">&lt;</span>&nbsp;<span class="builtinfunc" id="2227585">len</span><span class="op" id="2227588">(</span><span class="ident" id="2227589">s</span><span class="op" id="2227590">)</span><span class="op" id="2227591">;</span>&nbsp;<span class="ident" id="2227593">i</span><span class="op" id="2227594">++</span>&nbsp;<span class="op" id="2227597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227601">switch</span>&nbsp;<span class="ident" id="2227608">c</span>&nbsp;<span class="op" id="2227610">:=</span>&nbsp;<span class="ident" id="2227613">s</span><span class="op" id="2227614">[</span><span class="ident" id="2227615">i</span><span class="op" id="2227616">]</span><span class="op" id="2227617">;</span>&nbsp;<span class="builtintype" id="2227619">true</span>&nbsp;<span class="op" id="2227624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227628">case</span>&nbsp;<span class="ident" id="2227633">c</span>&nbsp;<span class="op" id="2227635">==</span>&nbsp;<span class="string" id="2227638">&#39;.&#39;</span><span class="op" id="2227641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227646">if</span>&nbsp;<span class="ident" id="2227649">sawdot</span>&nbsp;<span class="op" id="2227656">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227662">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227677">sawdot</span>&nbsp;<span class="op" id="2227684">=</span>&nbsp;<span class="builtintype" id="2227686">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227694">dp</span>&nbsp;<span class="op" id="2227697">=</span>&nbsp;<span class="ident" id="2227699">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227705">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227717">case</span>&nbsp;<span class="string" id="2227722">&#39;0&#39;</span>&nbsp;<span class="op" id="2227726">&lt;=</span>&nbsp;<span class="ident" id="2227729">c</span>&nbsp;<span class="op" id="2227731">&amp;&amp;</span>&nbsp;<span class="ident" id="2227734">c</span>&nbsp;<span class="op" id="2227736">&lt;=</span>&nbsp;<span class="string" id="2227739">&#39;9&#39;</span><span class="op" id="2227742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227747">sawdigits</span>&nbsp;<span class="op" id="2227757">=</span>&nbsp;<span class="builtintype" id="2227759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227767">if</span>&nbsp;<span class="ident" id="2227770">c</span>&nbsp;<span class="op" id="2227772">==</span>&nbsp;<span class="string" id="2227775">&#39;0&#39;</span>&nbsp;<span class="op" id="2227779">&amp;&amp;</span>&nbsp;<span class="ident" id="2227782">nd</span>&nbsp;<span class="op" id="2227785">==</span>&nbsp;<span class="num" id="2227788">0</span>&nbsp;<span class="op" id="2227790">{</span>&nbsp;<span class="comment" id="2227792">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227820">dp</span><span class="op" id="2227822">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227829">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227846">nd</span><span class="op" id="2227848">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227854">if</span>&nbsp;<span class="ident" id="2227857">ndMant</span>&nbsp;<span class="op" id="2227864">&lt;</span>&nbsp;<span class="ident" id="2227866">uint64digits</span>&nbsp;<span class="op" id="2227879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227885">mantissa</span>&nbsp;<span class="op" id="2227894">*=</span>&nbsp;<span class="num" id="2227897">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227904">mantissa</span>&nbsp;<span class="op" id="2227913">+=</span>&nbsp;<span class="ident" id="2227916">uint64</span><span class="op" id="2227922">(</span><span class="ident" id="2227923">c</span>&nbsp;<span class="op" id="2227925">-</span>&nbsp;<span class="string" id="2227927">&#39;0&#39;</span><span class="op" id="2227930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227936">ndMant</span><span class="op" id="2227942">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227948">}</span>&nbsp;<span class="keyword" id="2227950">else</span>&nbsp;<span class="keyword" id="2227955">if</span>&nbsp;<span class="ident" id="2227958">s</span><span class="op" id="2227959">[</span><span class="ident" id="2227960">i</span><span class="op" id="2227961">]</span>&nbsp;<span class="op" id="2227963">!=</span>&nbsp;<span class="string" id="2227966">&#39;0&#39;</span>&nbsp;<span class="op" id="2227970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2227976">trunc</span>&nbsp;<span class="op" id="2227982">=</span>&nbsp;<span class="builtintype" id="2227984">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2227992">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2227997">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228012">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228022">if</span>&nbsp;<span class="op" id="2228025">!</span><span class="ident" id="2228026">sawdigits</span>&nbsp;<span class="op" id="2228036">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228040">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228051">if</span>&nbsp;<span class="op" id="2228054">!</span><span class="ident" id="2228055">sawdot</span>&nbsp;<span class="op" id="2228062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228066">dp</span>&nbsp;<span class="op" id="2228069">=</span>&nbsp;<span class="ident" id="2228071">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228075">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228079">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228122">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228169">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228215">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228267">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228293">if</span>&nbsp;<span class="ident" id="2228296">i</span>&nbsp;<span class="op" id="2228298">&lt;</span>&nbsp;<span class="builtinfunc" id="2228300">len</span><span class="op" id="2228303">(</span><span class="ident" id="2228304">s</span><span class="op" id="2228305">)</span>&nbsp;<span class="op" id="2228307">&amp;&amp;</span>&nbsp;<span class="op" id="2228310">(</span><span class="ident" id="2228311">s</span><span class="op" id="2228312">[</span><span class="ident" id="2228313">i</span><span class="op" id="2228314">]</span>&nbsp;<span class="op" id="2228316">==</span>&nbsp;<span class="string" id="2228319">&#39;e&#39;</span>&nbsp;<span class="op" id="2228323">||</span>&nbsp;<span class="ident" id="2228326">s</span><span class="op" id="2228327">[</span><span class="ident" id="2228328">i</span><span class="op" id="2228329">]</span>&nbsp;<span class="op" id="2228331">==</span>&nbsp;<span class="string" id="2228334">&#39;E&#39;</span><span class="op" id="2228337">)</span>&nbsp;<span class="op" id="2228339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228343">i</span><span class="op" id="2228344">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228349">if</span>&nbsp;<span class="ident" id="2228352">i</span>&nbsp;<span class="op" id="2228354">&gt;=</span>&nbsp;<span class="builtinfunc" id="2228357">len</span><span class="op" id="2228360">(</span><span class="ident" id="2228361">s</span><span class="op" id="2228362">)</span>&nbsp;<span class="op" id="2228364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228369">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228382">esign</span>&nbsp;<span class="op" id="2228388">:=</span>&nbsp;<span class="num" id="2228391">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228395">if</span>&nbsp;<span class="ident" id="2228398">s</span><span class="op" id="2228399">[</span><span class="ident" id="2228400">i</span><span class="op" id="2228401">]</span>&nbsp;<span class="op" id="2228403">==</span>&nbsp;<span class="string" id="2228406">&#39;+&#39;</span>&nbsp;<span class="op" id="2228410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228415">i</span><span class="op" id="2228416">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228421">}</span>&nbsp;<span class="keyword" id="2228423">else</span>&nbsp;<span class="keyword" id="2228428">if</span>&nbsp;<span class="ident" id="2228431">s</span><span class="op" id="2228432">[</span><span class="ident" id="2228433">i</span><span class="op" id="2228434">]</span>&nbsp;<span class="op" id="2228436">==</span>&nbsp;<span class="string" id="2228439">&#39;-&#39;</span>&nbsp;<span class="op" id="2228443">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228448">i</span><span class="op" id="2228449">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228455">esign</span>&nbsp;<span class="op" id="2228461">=</span>&nbsp;<span class="op" id="2228463">-</span><span class="num" id="2228464">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228472">if</span>&nbsp;<span class="ident" id="2228475">i</span>&nbsp;<span class="op" id="2228477">&gt;=</span>&nbsp;<span class="builtinfunc" id="2228480">len</span><span class="op" id="2228483">(</span><span class="ident" id="2228484">s</span><span class="op" id="2228485">)</span>&nbsp;<span class="op" id="2228487">||</span>&nbsp;<span class="ident" id="2228490">s</span><span class="op" id="2228491">[</span><span class="ident" id="2228492">i</span><span class="op" id="2228493">]</span>&nbsp;<span class="op" id="2228495">&lt;</span>&nbsp;<span class="string" id="2228497">&#39;0&#39;</span>&nbsp;<span class="op" id="2228501">||</span>&nbsp;<span class="ident" id="2228504">s</span><span class="op" id="2228505">[</span><span class="ident" id="2228506">i</span><span class="op" id="2228507">]</span>&nbsp;<span class="op" id="2228509">&gt;</span>&nbsp;<span class="string" id="2228511">&#39;9&#39;</span>&nbsp;<span class="op" id="2228515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228520">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228533">e</span>&nbsp;<span class="op" id="2228535">:=</span>&nbsp;<span class="num" id="2228538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228542">for</span>&nbsp;<span class="op" id="2228546">;</span>&nbsp;<span class="ident" id="2228548">i</span>&nbsp;<span class="op" id="2228550">&lt;</span>&nbsp;<span class="builtinfunc" id="2228552">len</span><span class="op" id="2228555">(</span><span class="ident" id="2228556">s</span><span class="op" id="2228557">)</span>&nbsp;<span class="op" id="2228559">&amp;&amp;</span>&nbsp;<span class="string" id="2228562">&#39;0&#39;</span>&nbsp;<span class="op" id="2228566">&lt;=</span>&nbsp;<span class="ident" id="2228569">s</span><span class="op" id="2228570">[</span><span class="ident" id="2228571">i</span><span class="op" id="2228572">]</span>&nbsp;<span class="op" id="2228574">&amp;&amp;</span>&nbsp;<span class="ident" id="2228577">s</span><span class="op" id="2228578">[</span><span class="ident" id="2228579">i</span><span class="op" id="2228580">]</span>&nbsp;<span class="op" id="2228582">&lt;=</span>&nbsp;<span class="string" id="2228585">&#39;9&#39;</span><span class="op" id="2228588">;</span>&nbsp;<span class="ident" id="2228590">i</span><span class="op" id="2228591">++</span>&nbsp;<span class="op" id="2228594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228599">if</span>&nbsp;<span class="ident" id="2228602">e</span>&nbsp;<span class="op" id="2228604">&lt;</span>&nbsp;<span class="num" id="2228606">10000</span>&nbsp;<span class="op" id="2228612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228618">e</span>&nbsp;<span class="op" id="2228620">=</span>&nbsp;<span class="ident" id="2228622">e</span><span class="op" id="2228623">*</span><span class="num" id="2228624">10</span>&nbsp;<span class="op" id="2228627">+</span>&nbsp;<span class="builtintype" id="2228629">int</span><span class="op" id="2228632">(</span><span class="ident" id="2228633">s</span><span class="op" id="2228634">[</span><span class="ident" id="2228635">i</span><span class="op" id="2228636">]</span><span class="op" id="2228637">)</span>&nbsp;<span class="op" id="2228639">-</span>&nbsp;<span class="string" id="2228641">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228656">dp</span>&nbsp;<span class="op" id="2228659">+=</span>&nbsp;<span class="ident" id="2228662">e</span>&nbsp;<span class="op" id="2228664">*</span>&nbsp;<span class="ident" id="2228666">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228677">if</span>&nbsp;<span class="ident" id="2228680">i</span>&nbsp;<span class="op" id="2228682">!=</span>&nbsp;<span class="builtinfunc" id="2228685">len</span><span class="op" id="2228688">(</span><span class="ident" id="2228689">s</span><span class="op" id="2228690">)</span>&nbsp;<span class="op" id="2228692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228696">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2228704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228708">exp</span>&nbsp;<span class="op" id="2228712">=</span>&nbsp;<span class="ident" id="2228714">dp</span>&nbsp;<span class="op" id="2228717">-</span>&nbsp;<span class="ident" id="2228719">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2228727">ok</span>&nbsp;<span class="op" id="2228730">=</span>&nbsp;<span class="builtintype" id="2228732">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228738">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2228746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2228749">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2228797">var</span>&nbsp;<span class="ident" id="2228801">powtab</span>&nbsp;<span class="op" id="2228808">=</span>&nbsp;<span class="op" id="2228810">[</span><span class="op" id="2228811">]</span><span class="builtintype" id="2228812">int</span><span class="op" id="2228815">{</span><span class="num" id="2228816">1</span><span class="op" id="2228817">,</span>&nbsp;<span class="num" id="2228819">3</span><span class="op" id="2228820">,</span>&nbsp;<span class="num" id="2228822">6</span><span class="op" id="2228823">,</span>&nbsp;<span class="num" id="2228825">9</span><span class="op" id="2228826">,</span>&nbsp;<span class="num" id="2228828">13</span><span class="op" id="2228830">,</span>&nbsp;<span class="num" id="2228832">16</span><span class="op" id="2228834">,</span>&nbsp;<span class="num" id="2228836">19</span><span class="op" id="2228838">,</span>&nbsp;<span class="num" id="2228840">23</span><span class="op" id="2228842">,</span>&nbsp;<span class="num" id="2228844">26</span><span class="op" id="2228846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2228849">func</span>&nbsp;<span class="op" id="2228854">(</span><span class="ident" id="2228855">d</span>&nbsp;<span class="op" id="2228857">*</span><span class="ident" id="2228858">decimal</span><span class="op" id="2228865">)</span>&nbsp;<span class="ident" id="2228867">floatBits</span><span class="op" id="2228876">(</span><span class="ident" id="2228877">flt</span>&nbsp;<span class="op" id="2228881">*</span><span class="ident" id="2228882">floatInfo</span><span class="op" id="2228891">)</span>&nbsp;<span class="op" id="2228893">(</span><span class="ident" id="2228894">b</span>&nbsp;<span class="ident" id="2228896">uint64</span><span class="op" id="2228902">,</span>&nbsp;<span class="ident" id="2228904">overflow</span>&nbsp;<span class="builtintype" id="2228913">bool</span><span class="op" id="2228917">)</span>&nbsp;<span class="op" id="2228919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228922">var</span>&nbsp;<span class="ident" id="2228926">exp</span>&nbsp;<span class="builtintype" id="2228930">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228935">var</span>&nbsp;<span class="ident" id="2228939">mant</span>&nbsp;<span class="ident" id="2228944">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2228953">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228988">if</span>&nbsp;<span class="ident" id="2228991">d</span><span class="op" id="2228992">.</span><span class="ident" id="2228993">nd</span>&nbsp;<span class="op" id="2228996">==</span>&nbsp;<span class="num" id="2228999">0</span>&nbsp;<span class="op" id="2229001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229005">mant</span>&nbsp;<span class="op" id="2229010">=</span>&nbsp;<span class="num" id="2229012">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229016">exp</span>&nbsp;<span class="op" id="2229020">=</span>&nbsp;<span class="ident" id="2229022">flt</span><span class="op" id="2229025">.</span><span class="ident" id="2229026">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229033">goto</span>&nbsp;<span class="ident" id="2229038">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229047">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229079">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229119">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229194">if</span>&nbsp;<span class="ident" id="2229197">d</span><span class="op" id="2229198">.</span><span class="ident" id="2229199">dp</span>&nbsp;<span class="op" id="2229202">&gt;</span>&nbsp;<span class="num" id="2229204">310</span>&nbsp;<span class="op" id="2229208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229212">goto</span>&nbsp;<span class="ident" id="2229217">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229227">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229230">if</span>&nbsp;<span class="ident" id="2229233">d</span><span class="op" id="2229234">.</span><span class="ident" id="2229235">dp</span>&nbsp;<span class="op" id="2229238">&lt;</span>&nbsp;<span class="op" id="2229240">-</span><span class="num" id="2229241">330</span>&nbsp;<span class="op" id="2229245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229249">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229259">mant</span>&nbsp;<span class="op" id="2229264">=</span>&nbsp;<span class="num" id="2229266">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229270">exp</span>&nbsp;<span class="op" id="2229274">=</span>&nbsp;<span class="ident" id="2229276">flt</span><span class="op" id="2229279">.</span><span class="ident" id="2229280">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229287">goto</span>&nbsp;<span class="ident" id="2229292">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229301">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229354">exp</span>&nbsp;<span class="op" id="2229358">=</span>&nbsp;<span class="num" id="2229360">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229363">for</span>&nbsp;<span class="ident" id="2229367">d</span><span class="op" id="2229368">.</span><span class="ident" id="2229369">dp</span>&nbsp;<span class="op" id="2229372">&gt;</span>&nbsp;<span class="num" id="2229374">0</span>&nbsp;<span class="op" id="2229376">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229380">var</span>&nbsp;<span class="ident" id="2229384">n</span>&nbsp;<span class="builtintype" id="2229386">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229392">if</span>&nbsp;<span class="ident" id="2229395">d</span><span class="op" id="2229396">.</span><span class="ident" id="2229397">dp</span>&nbsp;<span class="op" id="2229400">&gt;=</span>&nbsp;<span class="builtinfunc" id="2229403">len</span><span class="op" id="2229406">(</span><span class="ident" id="2229407">powtab</span><span class="op" id="2229413">)</span>&nbsp;<span class="op" id="2229415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229420">n</span>&nbsp;<span class="op" id="2229422">=</span>&nbsp;<span class="num" id="2229424">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229429">}</span>&nbsp;<span class="keyword" id="2229431">else</span>&nbsp;<span class="op" id="2229436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229441">n</span>&nbsp;<span class="op" id="2229443">=</span>&nbsp;<span class="ident" id="2229445">powtab</span><span class="op" id="2229451">[</span><span class="ident" id="2229452">d</span><span class="op" id="2229453">.</span><span class="ident" id="2229454">dp</span><span class="op" id="2229456">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229464">d</span><span class="op" id="2229465">.</span><span class="ident" id="2229466">Shift</span><span class="op" id="2229471">(</span><span class="op" id="2229472">-</span><span class="ident" id="2229473">n</span><span class="op" id="2229474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229478">exp</span>&nbsp;<span class="op" id="2229482">+=</span>&nbsp;<span class="ident" id="2229485">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229491">for</span>&nbsp;<span class="ident" id="2229495">d</span><span class="op" id="2229496">.</span><span class="ident" id="2229497">dp</span>&nbsp;<span class="op" id="2229500">&lt;</span>&nbsp;<span class="num" id="2229502">0</span>&nbsp;<span class="op" id="2229504">||</span>&nbsp;<span class="ident" id="2229507">d</span><span class="op" id="2229508">.</span><span class="ident" id="2229509">dp</span>&nbsp;<span class="op" id="2229512">==</span>&nbsp;<span class="num" id="2229515">0</span>&nbsp;<span class="op" id="2229517">&amp;&amp;</span>&nbsp;<span class="ident" id="2229520">d</span><span class="op" id="2229521">.</span><span class="ident" id="2229522">d</span><span class="op" id="2229523">[</span><span class="num" id="2229524">0</span><span class="op" id="2229525">]</span>&nbsp;<span class="op" id="2229527">&lt;</span>&nbsp;<span class="string" id="2229529">&#39;5&#39;</span>&nbsp;<span class="op" id="2229533">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229537">var</span>&nbsp;<span class="ident" id="2229541">n</span>&nbsp;<span class="builtintype" id="2229543">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229549">if</span>&nbsp;<span class="op" id="2229552">-</span><span class="ident" id="2229553">d</span><span class="op" id="2229554">.</span><span class="ident" id="2229555">dp</span>&nbsp;<span class="op" id="2229558">&gt;=</span>&nbsp;<span class="builtinfunc" id="2229561">len</span><span class="op" id="2229564">(</span><span class="ident" id="2229565">powtab</span><span class="op" id="2229571">)</span>&nbsp;<span class="op" id="2229573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229578">n</span>&nbsp;<span class="op" id="2229580">=</span>&nbsp;<span class="num" id="2229582">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229587">}</span>&nbsp;<span class="keyword" id="2229589">else</span>&nbsp;<span class="op" id="2229594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229599">n</span>&nbsp;<span class="op" id="2229601">=</span>&nbsp;<span class="ident" id="2229603">powtab</span><span class="op" id="2229609">[</span><span class="op" id="2229610">-</span><span class="ident" id="2229611">d</span><span class="op" id="2229612">.</span><span class="ident" id="2229613">dp</span><span class="op" id="2229615">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229623">d</span><span class="op" id="2229624">.</span><span class="ident" id="2229625">Shift</span><span class="op" id="2229630">(</span><span class="ident" id="2229631">n</span><span class="op" id="2229632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229636">exp</span>&nbsp;<span class="op" id="2229640">-=</span>&nbsp;<span class="ident" id="2229643">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229650">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229710">exp</span><span class="op" id="2229713">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229718">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229768">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229815">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229841">if</span>&nbsp;<span class="ident" id="2229844">exp</span>&nbsp;<span class="op" id="2229848">&lt;</span>&nbsp;<span class="ident" id="2229850">flt</span><span class="op" id="2229853">.</span><span class="ident" id="2229854">bias</span><span class="op" id="2229858">+</span><span class="num" id="2229859">1</span>&nbsp;<span class="op" id="2229861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229865">n</span>&nbsp;<span class="op" id="2229867">:=</span>&nbsp;<span class="ident" id="2229870">flt</span><span class="op" id="2229873">.</span><span class="ident" id="2229874">bias</span>&nbsp;<span class="op" id="2229879">+</span>&nbsp;<span class="num" id="2229881">1</span>&nbsp;<span class="op" id="2229883">-</span>&nbsp;<span class="ident" id="2229885">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229891">d</span><span class="op" id="2229892">.</span><span class="ident" id="2229893">Shift</span><span class="op" id="2229898">(</span><span class="op" id="2229899">-</span><span class="ident" id="2229900">n</span><span class="op" id="2229901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229905">exp</span>&nbsp;<span class="op" id="2229909">+=</span>&nbsp;<span class="ident" id="2229912">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229919">if</span>&nbsp;<span class="ident" id="2229922">exp</span><span class="op" id="2229925">-</span><span class="ident" id="2229926">flt</span><span class="op" id="2229929">.</span><span class="ident" id="2229930">bias</span>&nbsp;<span class="op" id="2229935">&gt;=</span>&nbsp;<span class="num" id="2229938">1</span><span class="op" id="2229939">&lt;&lt;</span><span class="ident" id="2229941">flt</span><span class="op" id="2229944">.</span><span class="ident" id="2229945">expbits</span><span class="op" id="2229952">-</span><span class="num" id="2229953">1</span>&nbsp;<span class="op" id="2229955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229959">goto</span>&nbsp;<span class="ident" id="2229964">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229974">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229978">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230011">d</span><span class="op" id="2230012">.</span><span class="ident" id="2230013">Shift</span><span class="op" id="2230018">(</span><span class="builtintype" id="2230019">int</span><span class="op" id="2230022">(</span><span class="num" id="2230023">1</span>&nbsp;<span class="op" id="2230025">+</span>&nbsp;<span class="ident" id="2230027">flt</span><span class="op" id="2230030">.</span><span class="ident" id="2230031">mantbits</span><span class="op" id="2230039">)</span><span class="op" id="2230040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230043">mant</span>&nbsp;<span class="op" id="2230048">=</span>&nbsp;<span class="ident" id="2230050">d</span><span class="op" id="2230051">.</span><span class="ident" id="2230052">RoundedInteger</span><span class="op" id="2230066">(</span><span class="op" id="2230067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230071">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230120">if</span>&nbsp;<span class="ident" id="2230123">mant</span>&nbsp;<span class="op" id="2230128">==</span>&nbsp;<span class="num" id="2230131">2</span><span class="op" id="2230132">&lt;&lt;</span><span class="ident" id="2230134">flt</span><span class="op" id="2230137">.</span><span class="ident" id="2230138">mantbits</span>&nbsp;<span class="op" id="2230147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230151">mant</span>&nbsp;<span class="op" id="2230156">&gt;&gt;=</span>&nbsp;<span class="num" id="2230160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230164">exp</span><span class="op" id="2230167">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230172">if</span>&nbsp;<span class="ident" id="2230175">exp</span><span class="op" id="2230178">-</span><span class="ident" id="2230179">flt</span><span class="op" id="2230182">.</span><span class="ident" id="2230183">bias</span>&nbsp;<span class="op" id="2230188">&gt;=</span>&nbsp;<span class="num" id="2230191">1</span><span class="op" id="2230192">&lt;&lt;</span><span class="ident" id="2230194">flt</span><span class="op" id="2230197">.</span><span class="ident" id="2230198">expbits</span><span class="op" id="2230205">-</span><span class="num" id="2230206">1</span>&nbsp;<span class="op" id="2230208">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230213">goto</span>&nbsp;<span class="ident" id="2230218">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230236">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230254">if</span>&nbsp;<span class="ident" id="2230257">mant</span><span class="op" id="2230261">&amp;</span><span class="op" id="2230262">(</span><span class="num" id="2230263">1</span><span class="op" id="2230264">&lt;&lt;</span><span class="ident" id="2230266">flt</span><span class="op" id="2230269">.</span><span class="ident" id="2230270">mantbits</span><span class="op" id="2230278">)</span>&nbsp;<span class="op" id="2230280">==</span>&nbsp;<span class="num" id="2230283">0</span>&nbsp;<span class="op" id="2230285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230289">exp</span>&nbsp;<span class="op" id="2230293">=</span>&nbsp;<span class="ident" id="2230295">flt</span><span class="op" id="2230298">.</span><span class="ident" id="2230299">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230308">goto</span>&nbsp;<span class="ident" id="2230313">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2230318">overflow</span><span class="op" id="2230326">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230329">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230339">mant</span>&nbsp;<span class="op" id="2230344">=</span>&nbsp;<span class="num" id="2230346">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230349">exp</span>&nbsp;<span class="op" id="2230353">=</span>&nbsp;<span class="num" id="2230355">1</span><span class="op" id="2230356">&lt;&lt;</span><span class="ident" id="2230358">flt</span><span class="op" id="2230361">.</span><span class="ident" id="2230362">expbits</span>&nbsp;<span class="op" id="2230370">-</span>&nbsp;<span class="num" id="2230372">1</span>&nbsp;<span class="op" id="2230374">+</span>&nbsp;<span class="ident" id="2230376">flt</span><span class="op" id="2230379">.</span><span class="ident" id="2230380">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230386">overflow</span>&nbsp;<span class="op" id="2230395">=</span>&nbsp;<span class="builtintype" id="2230397">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2230403">out</span><span class="op" id="2230406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230409">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230428">bits</span>&nbsp;<span class="op" id="2230433">:=</span>&nbsp;<span class="ident" id="2230436">mant</span>&nbsp;<span class="op" id="2230441">&amp;</span>&nbsp;<span class="op" id="2230443">(</span><span class="ident" id="2230444">uint64</span><span class="op" id="2230450">(</span><span class="num" id="2230451">1</span><span class="op" id="2230452">)</span><span class="op" id="2230453">&lt;&lt;</span><span class="ident" id="2230455">flt</span><span class="op" id="2230458">.</span><span class="ident" id="2230459">mantbits</span>&nbsp;<span class="op" id="2230468">-</span>&nbsp;<span class="num" id="2230470">1</span><span class="op" id="2230471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230474">bits</span>&nbsp;<span class="op" id="2230479">|=</span>&nbsp;<span class="ident" id="2230482">uint64</span><span class="op" id="2230488">(</span><span class="op" id="2230489">(</span><span class="ident" id="2230490">exp</span><span class="op" id="2230493">-</span><span class="ident" id="2230494">flt</span><span class="op" id="2230497">.</span><span class="ident" id="2230498">bias</span><span class="op" id="2230502">)</span><span class="op" id="2230503">&amp;</span><span class="op" id="2230504">(</span><span class="num" id="2230505">1</span><span class="op" id="2230506">&lt;&lt;</span><span class="ident" id="2230508">flt</span><span class="op" id="2230511">.</span><span class="ident" id="2230512">expbits</span><span class="op" id="2230519">-</span><span class="num" id="2230520">1</span><span class="op" id="2230521">)</span><span class="op" id="2230522">)</span>&nbsp;<span class="op" id="2230524">&lt;&lt;</span>&nbsp;<span class="ident" id="2230527">flt</span><span class="op" id="2230530">.</span><span class="ident" id="2230531">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230541">if</span>&nbsp;<span class="ident" id="2230544">d</span><span class="op" id="2230545">.</span><span class="ident" id="2230546">neg</span>&nbsp;<span class="op" id="2230550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230554">bits</span>&nbsp;<span class="op" id="2230559">|=</span>&nbsp;<span class="num" id="2230562">1</span>&nbsp;<span class="op" id="2230564">&lt;&lt;</span>&nbsp;<span class="ident" id="2230567">flt</span><span class="op" id="2230570">.</span><span class="ident" id="2230571">mantbits</span>&nbsp;<span class="op" id="2230580">&lt;&lt;</span>&nbsp;<span class="ident" id="2230583">flt</span><span class="op" id="2230586">.</span><span class="ident" id="2230587">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230599">return</span>&nbsp;<span class="ident" id="2230606">bits</span><span class="op" id="2230610">,</span>&nbsp;<span class="ident" id="2230612">overflow</span><br>
<span class="lineno"></span><span class="op" id="2230621">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2230624">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2230647">var</span>&nbsp;<span class="ident" id="2230651">float64pow10</span>&nbsp;<span class="op" id="2230664">=</span>&nbsp;<span class="op" id="2230666">[</span><span class="op" id="2230667">]</span><span class="builtintype" id="2230668">float64</span><span class="op" id="2230675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2230678">1e0</span><span class="op" id="2230681">,</span>&nbsp;<span class="num" id="2230683">1e1</span><span class="op" id="2230686">,</span>&nbsp;<span class="num" id="2230688">1e2</span><span class="op" id="2230691">,</span>&nbsp;<span class="num" id="2230693">1e3</span><span class="op" id="2230696">,</span>&nbsp;<span class="num" id="2230698">1e4</span><span class="op" id="2230701">,</span>&nbsp;<span class="num" id="2230703">1e5</span><span class="op" id="2230706">,</span>&nbsp;<span class="num" id="2230708">1e6</span><span class="op" id="2230711">,</span>&nbsp;<span class="num" id="2230713">1e7</span><span class="op" id="2230716">,</span>&nbsp;<span class="num" id="2230718">1e8</span><span class="op" id="2230721">,</span>&nbsp;<span class="num" id="2230723">1e9</span><span class="op" id="2230726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2230729">1e10</span><span class="op" id="2230733">,</span>&nbsp;<span class="num" id="2230735">1e11</span><span class="op" id="2230739">,</span>&nbsp;<span class="num" id="2230741">1e12</span><span class="op" id="2230745">,</span>&nbsp;<span class="num" id="2230747">1e13</span><span class="op" id="2230751">,</span>&nbsp;<span class="num" id="2230753">1e14</span><span class="op" id="2230757">,</span>&nbsp;<span class="num" id="2230759">1e15</span><span class="op" id="2230763">,</span>&nbsp;<span class="num" id="2230765">1e16</span><span class="op" id="2230769">,</span>&nbsp;<span class="num" id="2230771">1e17</span><span class="op" id="2230775">,</span>&nbsp;<span class="num" id="2230777">1e18</span><span class="op" id="2230781">,</span>&nbsp;<span class="num" id="2230783">1e19</span><span class="op" id="2230787">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2230790">1e20</span><span class="op" id="2230794">,</span>&nbsp;<span class="num" id="2230796">1e21</span><span class="op" id="2230800">,</span>&nbsp;<span class="num" id="2230802">1e22</span><span class="op" id="2230806">,</span><br>
<span class="lineno"></span><span class="op" id="2230808">}</span><br>
<span class="lineno"></span><span class="keyword" id="2230810">var</span>&nbsp;<span class="ident" id="2230814">float32pow10</span>&nbsp;<span class="op" id="2230827">=</span>&nbsp;<span class="op" id="2230829">[</span><span class="op" id="2230830">]</span><span class="builtintype" id="2230831">float32</span><span class="op" id="2230838">{</span><span class="num" id="2230839">1e0</span><span class="op" id="2230842">,</span>&nbsp;<span class="num" id="2230844">1e1</span><span class="op" id="2230847">,</span>&nbsp;<span class="num" id="2230849">1e2</span><span class="op" id="2230852">,</span>&nbsp;<span class="num" id="2230854">1e3</span><span class="op" id="2230857">,</span>&nbsp;<span class="num" id="2230859">1e4</span><span class="op" id="2230862">,</span>&nbsp;<span class="num" id="2230864">1e5</span><span class="op" id="2230867">,</span>&nbsp;<span class="num" id="2230869">1e6</span><span class="op" id="2230872">,</span>&nbsp;<span class="num" id="2230874">1e7</span><span class="op" id="2230877">,</span>&nbsp;<span class="num" id="2230879">1e8</span><span class="op" id="2230882">,</span>&nbsp;<span class="num" id="2230884">1e9</span><span class="op" id="2230887">,</span>&nbsp;<span class="num" id="2230889">1e10</span><span class="op" id="2230893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2230896">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2230972">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2231059">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2231082">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2231108">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2231155">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2231202">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2231274">func</span>&nbsp;<span class="ident" id="2231279">atof64exact</span><span class="op" id="2231290">(</span><span class="ident" id="2231291">mantissa</span>&nbsp;<span class="ident" id="2231300">uint64</span><span class="op" id="2231306">,</span>&nbsp;<span class="ident" id="2231308">exp</span>&nbsp;<span class="builtintype" id="2231312">int</span><span class="op" id="2231315">,</span>&nbsp;<span class="ident" id="2231317">neg</span>&nbsp;<span class="builtintype" id="2231321">bool</span><span class="op" id="2231325">)</span>&nbsp;<span class="op" id="2231327">(</span><span class="ident" id="2231328">f</span>&nbsp;<span class="builtintype" id="2231330">float64</span><span class="op" id="2231337">,</span>&nbsp;<span class="ident" id="2231339">ok</span>&nbsp;<span class="builtintype" id="2231342">bool</span><span class="op" id="2231346">)</span>&nbsp;<span class="op" id="2231348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231351">if</span>&nbsp;<span class="ident" id="2231354">mantissa</span><span class="op" id="2231362">&gt;&gt;</span><span class="ident" id="2231364">float64info</span><span class="op" id="2231375">.</span><span class="ident" id="2231376">mantbits</span>&nbsp;<span class="op" id="2231385">!=</span>&nbsp;<span class="num" id="2231388">0</span>&nbsp;<span class="op" id="2231390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231394">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231402">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231405">f</span>&nbsp;<span class="op" id="2231407">=</span>&nbsp;<span class="builtintype" id="2231409">float64</span><span class="op" id="2231416">(</span><span class="ident" id="2231417">mantissa</span><span class="op" id="2231425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231428">if</span>&nbsp;<span class="ident" id="2231431">neg</span>&nbsp;<span class="op" id="2231435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231439">f</span>&nbsp;<span class="op" id="2231441">=</span>&nbsp;<span class="op" id="2231443">-</span><span class="ident" id="2231444">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231450">switch</span>&nbsp;<span class="op" id="2231457">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231460">case</span>&nbsp;<span class="ident" id="2231465">exp</span>&nbsp;<span class="op" id="2231469">==</span>&nbsp;<span class="num" id="2231472">0</span><span class="op" id="2231473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231477">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231494">return</span>&nbsp;<span class="ident" id="2231501">f</span><span class="op" id="2231502">,</span>&nbsp;<span class="builtintype" id="2231504">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231510">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231543">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231581">case</span>&nbsp;<span class="ident" id="2231586">exp</span>&nbsp;<span class="op" id="2231590">&gt;</span>&nbsp;<span class="num" id="2231592">0</span>&nbsp;<span class="op" id="2231594">&amp;&amp;</span>&nbsp;<span class="ident" id="2231597">exp</span>&nbsp;<span class="op" id="2231601">&lt;=</span>&nbsp;<span class="num" id="2231604">15</span><span class="op" id="2231606">+</span><span class="num" id="2231607">22</span><span class="op" id="2231609">:</span>&nbsp;<span class="comment" id="2231611">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231627">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231680">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231729">if</span>&nbsp;<span class="ident" id="2231732">exp</span>&nbsp;<span class="op" id="2231736">&gt;</span>&nbsp;<span class="num" id="2231738">22</span>&nbsp;<span class="op" id="2231741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231746">f</span>&nbsp;<span class="op" id="2231748">*=</span>&nbsp;<span class="ident" id="2231751">float64pow10</span><span class="op" id="2231763">[</span><span class="ident" id="2231764">exp</span><span class="op" id="2231767">-</span><span class="num" id="2231768">22</span><span class="op" id="2231770">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231775">exp</span>&nbsp;<span class="op" id="2231779">=</span>&nbsp;<span class="num" id="2231781">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231790">if</span>&nbsp;<span class="ident" id="2231793">f</span>&nbsp;<span class="op" id="2231795">&gt;</span>&nbsp;<span class="num" id="2231797">1e15</span>&nbsp;<span class="op" id="2231802">||</span>&nbsp;<span class="ident" id="2231805">f</span>&nbsp;<span class="op" id="2231807">&lt;</span>&nbsp;<span class="op" id="2231809">-</span><span class="num" id="2231810">1e15</span>&nbsp;<span class="op" id="2231815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231820">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231861">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231874">return</span>&nbsp;<span class="ident" id="2231881">f</span>&nbsp;<span class="op" id="2231883">*</span>&nbsp;<span class="ident" id="2231885">float64pow10</span><span class="op" id="2231897">[</span><span class="ident" id="2231898">exp</span><span class="op" id="2231901">]</span><span class="op" id="2231902">,</span>&nbsp;<span class="builtintype" id="2231904">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231910">case</span>&nbsp;<span class="ident" id="2231915">exp</span>&nbsp;<span class="op" id="2231919">&lt;</span>&nbsp;<span class="num" id="2231921">0</span>&nbsp;<span class="op" id="2231923">&amp;&amp;</span>&nbsp;<span class="ident" id="2231926">exp</span>&nbsp;<span class="op" id="2231930">&gt;=</span>&nbsp;<span class="op" id="2231933">-</span><span class="num" id="2231934">22</span><span class="op" id="2231936">:</span>&nbsp;<span class="comment" id="2231938">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231954">return</span>&nbsp;<span class="ident" id="2231961">f</span>&nbsp;<span class="op" id="2231963">/</span>&nbsp;<span class="ident" id="2231965">float64pow10</span><span class="op" id="2231977">[</span><span class="op" id="2231978">-</span><span class="ident" id="2231979">exp</span><span class="op" id="2231982">]</span><span class="op" id="2231983">,</span>&nbsp;<span class="builtintype" id="2231985">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231991">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231994">return</span><br>
<span class="lineno"></span><span class="op" id="2232001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2232004">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2232073">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2232146">func</span>&nbsp;<span class="ident" id="2232151">atof32exact</span><span class="op" id="2232162">(</span><span class="ident" id="2232163">mantissa</span>&nbsp;<span class="ident" id="2232172">uint64</span><span class="op" id="2232178">,</span>&nbsp;<span class="ident" id="2232180">exp</span>&nbsp;<span class="builtintype" id="2232184">int</span><span class="op" id="2232187">,</span>&nbsp;<span class="ident" id="2232189">neg</span>&nbsp;<span class="builtintype" id="2232193">bool</span><span class="op" id="2232197">)</span>&nbsp;<span class="op" id="2232199">(</span><span class="ident" id="2232200">f</span>&nbsp;<span class="builtintype" id="2232202">float32</span><span class="op" id="2232209">,</span>&nbsp;<span class="ident" id="2232211">ok</span>&nbsp;<span class="builtintype" id="2232214">bool</span><span class="op" id="2232218">)</span>&nbsp;<span class="op" id="2232220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232223">if</span>&nbsp;<span class="ident" id="2232226">mantissa</span><span class="op" id="2232234">&gt;&gt;</span><span class="ident" id="2232236">float32info</span><span class="op" id="2232247">.</span><span class="ident" id="2232248">mantbits</span>&nbsp;<span class="op" id="2232257">!=</span>&nbsp;<span class="num" id="2232260">0</span>&nbsp;<span class="op" id="2232262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232266">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232277">f</span>&nbsp;<span class="op" id="2232279">=</span>&nbsp;<span class="builtintype" id="2232281">float32</span><span class="op" id="2232288">(</span><span class="ident" id="2232289">mantissa</span><span class="op" id="2232297">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232300">if</span>&nbsp;<span class="ident" id="2232303">neg</span>&nbsp;<span class="op" id="2232307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232311">f</span>&nbsp;<span class="op" id="2232313">=</span>&nbsp;<span class="op" id="2232315">-</span><span class="ident" id="2232316">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232322">switch</span>&nbsp;<span class="op" id="2232329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232332">case</span>&nbsp;<span class="ident" id="2232337">exp</span>&nbsp;<span class="op" id="2232341">==</span>&nbsp;<span class="num" id="2232344">0</span><span class="op" id="2232345">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232349">return</span>&nbsp;<span class="ident" id="2232356">f</span><span class="op" id="2232357">,</span>&nbsp;<span class="builtintype" id="2232359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232365">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232397">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232435">case</span>&nbsp;<span class="ident" id="2232440">exp</span>&nbsp;<span class="op" id="2232444">&gt;</span>&nbsp;<span class="num" id="2232446">0</span>&nbsp;<span class="op" id="2232448">&amp;&amp;</span>&nbsp;<span class="ident" id="2232451">exp</span>&nbsp;<span class="op" id="2232455">&lt;=</span>&nbsp;<span class="num" id="2232458">7</span><span class="op" id="2232459">+</span><span class="num" id="2232460">10</span><span class="op" id="2232462">:</span>&nbsp;<span class="comment" id="2232464">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232480">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232533">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232582">if</span>&nbsp;<span class="ident" id="2232585">exp</span>&nbsp;<span class="op" id="2232589">&gt;</span>&nbsp;<span class="num" id="2232591">10</span>&nbsp;<span class="op" id="2232594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232599">f</span>&nbsp;<span class="op" id="2232601">*=</span>&nbsp;<span class="ident" id="2232604">float32pow10</span><span class="op" id="2232616">[</span><span class="ident" id="2232617">exp</span><span class="op" id="2232620">-</span><span class="num" id="2232621">10</span><span class="op" id="2232623">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232628">exp</span>&nbsp;<span class="op" id="2232632">=</span>&nbsp;<span class="num" id="2232634">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232639">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232643">if</span>&nbsp;<span class="ident" id="2232646">f</span>&nbsp;<span class="op" id="2232648">&gt;</span>&nbsp;<span class="num" id="2232650">1e7</span>&nbsp;<span class="op" id="2232654">||</span>&nbsp;<span class="ident" id="2232657">f</span>&nbsp;<span class="op" id="2232659">&lt;</span>&nbsp;<span class="op" id="2232661">-</span><span class="num" id="2232662">1e7</span>&nbsp;<span class="op" id="2232666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2232671">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232712">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232725">return</span>&nbsp;<span class="ident" id="2232732">f</span>&nbsp;<span class="op" id="2232734">*</span>&nbsp;<span class="ident" id="2232736">float32pow10</span><span class="op" id="2232748">[</span><span class="ident" id="2232749">exp</span><span class="op" id="2232752">]</span><span class="op" id="2232753">,</span>&nbsp;<span class="builtintype" id="2232755">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232761">case</span>&nbsp;<span class="ident" id="2232766">exp</span>&nbsp;<span class="op" id="2232770">&lt;</span>&nbsp;<span class="num" id="2232772">0</span>&nbsp;<span class="op" id="2232774">&amp;&amp;</span>&nbsp;<span class="ident" id="2232777">exp</span>&nbsp;<span class="op" id="2232781">&gt;=</span>&nbsp;<span class="op" id="2232784">-</span><span class="num" id="2232785">10</span><span class="op" id="2232787">:</span>&nbsp;<span class="comment" id="2232789">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232805">return</span>&nbsp;<span class="ident" id="2232812">f</span>&nbsp;<span class="op" id="2232814">/</span>&nbsp;<span class="ident" id="2232816">float32pow10</span><span class="op" id="2232828">[</span><span class="op" id="2232829">-</span><span class="ident" id="2232830">exp</span><span class="op" id="2232833">]</span><span class="op" id="2232834">,</span>&nbsp;<span class="builtintype" id="2232836">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232845">return</span><br>
<span class="lineno"></span><span class="op" id="2232852">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2232855">const</span>&nbsp;<span class="ident" id="2232861">fnParseFloat</span>&nbsp;<span class="op" id="2232874">=</span>&nbsp;<span class="string" id="2232876">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232890">func</span>&nbsp;<span class="ident" id="2232895">atof32</span><span class="op" id="2232901">(</span><span class="ident" id="2232902">s</span>&nbsp;<span class="builtintype" id="2232904">string</span><span class="op" id="2232910">)</span>&nbsp;<span class="op" id="2232912">(</span><span class="ident" id="2232913">f</span>&nbsp;<span class="builtintype" id="2232915">float32</span><span class="op" id="2232922">,</span>&nbsp;<span class="ident" id="2232924">err</span>&nbsp;<span class="builtintype" id="2232928">error</span><span class="op" id="2232933">)</span>&nbsp;<span class="op" id="2232935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232938">if</span>&nbsp;<span class="ident" id="2232941">val</span><span class="op" id="2232944">,</span>&nbsp;<span class="ident" id="2232946">ok</span>&nbsp;<span class="op" id="2232949">:=</span>&nbsp;<span class="ident" id="2232952">special</span><span class="op" id="2232959">(</span><span class="ident" id="2232960">s</span><span class="op" id="2232961">)</span><span class="op" id="2232962">;</span>&nbsp;<span class="ident" id="2232964">ok</span>&nbsp;<span class="op" id="2232967">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232971">return</span>&nbsp;<span class="builtintype" id="2232978">float32</span><span class="op" id="2232985">(</span><span class="ident" id="2232986">val</span><span class="op" id="2232989">)</span><span class="op" id="2232990">,</span>&nbsp;<span class="ident" id="2232992">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233001">if</span>&nbsp;<span class="ident" id="2233004">optimize</span>&nbsp;<span class="op" id="2233013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233017">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233051">mantissa</span><span class="op" id="2233059">,</span>&nbsp;<span class="ident" id="2233061">exp</span><span class="op" id="2233064">,</span>&nbsp;<span class="ident" id="2233066">neg</span><span class="op" id="2233069">,</span>&nbsp;<span class="ident" id="2233071">trunc</span><span class="op" id="2233076">,</span>&nbsp;<span class="ident" id="2233078">ok</span>&nbsp;<span class="op" id="2233081">:=</span>&nbsp;<span class="ident" id="2233084">readFloat</span><span class="op" id="2233093">(</span><span class="ident" id="2233094">s</span><span class="op" id="2233095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233099">if</span>&nbsp;<span class="ident" id="2233102">ok</span>&nbsp;<span class="op" id="2233105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233110">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233163">if</span>&nbsp;<span class="op" id="2233166">!</span><span class="ident" id="2233167">trunc</span>&nbsp;<span class="op" id="2233173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233179">if</span>&nbsp;<span class="ident" id="2233182">f</span><span class="op" id="2233183">,</span>&nbsp;<span class="ident" id="2233185">ok</span>&nbsp;<span class="op" id="2233188">:=</span>&nbsp;<span class="ident" id="2233191">atof32exact</span><span class="op" id="2233202">(</span><span class="ident" id="2233203">mantissa</span><span class="op" id="2233211">,</span>&nbsp;<span class="ident" id="2233213">exp</span><span class="op" id="2233216">,</span>&nbsp;<span class="ident" id="2233218">neg</span><span class="op" id="2233221">)</span><span class="op" id="2233222">;</span>&nbsp;<span class="ident" id="2233224">ok</span>&nbsp;<span class="op" id="2233227">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233234">return</span>&nbsp;<span class="ident" id="2233241">f</span><span class="op" id="2233242">,</span>&nbsp;<span class="ident" id="2233244">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233262">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233291">ext</span>&nbsp;<span class="op" id="2233295">:=</span>&nbsp;<span class="builtinfunc" id="2233298">new</span><span class="op" id="2233301">(</span><span class="ident" id="2233302">extFloat</span><span class="op" id="2233310">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233315">if</span>&nbsp;<span class="ident" id="2233318">ok</span>&nbsp;<span class="op" id="2233321">:=</span>&nbsp;<span class="ident" id="2233324">ext</span><span class="op" id="2233327">.</span><span class="ident" id="2233328">AssignDecimal</span><span class="op" id="2233341">(</span><span class="ident" id="2233342">mantissa</span><span class="op" id="2233350">,</span>&nbsp;<span class="ident" id="2233352">exp</span><span class="op" id="2233355">,</span>&nbsp;<span class="ident" id="2233357">neg</span><span class="op" id="2233360">,</span>&nbsp;<span class="ident" id="2233362">trunc</span><span class="op" id="2233367">,</span>&nbsp;<span class="op" id="2233369">&amp;</span><span class="ident" id="2233370">float32info</span><span class="op" id="2233381">)</span><span class="op" id="2233382">;</span>&nbsp;<span class="ident" id="2233384">ok</span>&nbsp;<span class="op" id="2233387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233393">b</span><span class="op" id="2233394">,</span>&nbsp;<span class="ident" id="2233396">ovf</span>&nbsp;<span class="op" id="2233400">:=</span>&nbsp;<span class="ident" id="2233403">ext</span><span class="op" id="2233406">.</span><span class="ident" id="2233407">floatBits</span><span class="op" id="2233416">(</span><span class="op" id="2233417">&amp;</span><span class="ident" id="2233418">float32info</span><span class="op" id="2233429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233435">f</span>&nbsp;<span class="op" id="2233437">=</span>&nbsp;<span class="ident" id="2233439">math</span><span class="op" id="2233443">.</span><span class="ident" id="2233444">Float32frombits</span><span class="op" id="2233459">(</span><span class="builtintype" id="2233460">uint32</span><span class="op" id="2233466">(</span><span class="ident" id="2233467">b</span><span class="op" id="2233468">)</span><span class="op" id="2233469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233475">if</span>&nbsp;<span class="ident" id="2233478">ovf</span>&nbsp;<span class="op" id="2233482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233489">err</span>&nbsp;<span class="op" id="2233493">=</span>&nbsp;<span class="ident" id="2233495">rangeError</span><span class="op" id="2233505">(</span><span class="ident" id="2233506">fnParseFloat</span><span class="op" id="2233518">,</span>&nbsp;<span class="ident" id="2233520">s</span><span class="op" id="2233521">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233533">return</span>&nbsp;<span class="ident" id="2233540">f</span><span class="op" id="2233541">,</span>&nbsp;<span class="ident" id="2233543">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233557">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233560">var</span>&nbsp;<span class="ident" id="2233564">d</span>&nbsp;<span class="ident" id="2233566">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233575">if</span>&nbsp;<span class="op" id="2233578">!</span><span class="ident" id="2233579">d</span><span class="op" id="2233580">.</span><span class="ident" id="2233581">set</span><span class="op" id="2233584">(</span><span class="ident" id="2233585">s</span><span class="op" id="2233586">)</span>&nbsp;<span class="op" id="2233588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233592">return</span>&nbsp;<span class="num" id="2233599">0</span><span class="op" id="2233600">,</span>&nbsp;<span class="ident" id="2233602">syntaxError</span><span class="op" id="2233613">(</span><span class="ident" id="2233614">fnParseFloat</span><span class="op" id="2233626">,</span>&nbsp;<span class="ident" id="2233628">s</span><span class="op" id="2233629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233635">b</span><span class="op" id="2233636">,</span>&nbsp;<span class="ident" id="2233638">ovf</span>&nbsp;<span class="op" id="2233642">:=</span>&nbsp;<span class="ident" id="2233645">d</span><span class="op" id="2233646">.</span><span class="ident" id="2233647">floatBits</span><span class="op" id="2233656">(</span><span class="op" id="2233657">&amp;</span><span class="ident" id="2233658">float32info</span><span class="op" id="2233669">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233672">f</span>&nbsp;<span class="op" id="2233674">=</span>&nbsp;<span class="ident" id="2233676">math</span><span class="op" id="2233680">.</span><span class="ident" id="2233681">Float32frombits</span><span class="op" id="2233696">(</span><span class="builtintype" id="2233697">uint32</span><span class="op" id="2233703">(</span><span class="ident" id="2233704">b</span><span class="op" id="2233705">)</span><span class="op" id="2233706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233709">if</span>&nbsp;<span class="ident" id="2233712">ovf</span>&nbsp;<span class="op" id="2233716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233720">err</span>&nbsp;<span class="op" id="2233724">=</span>&nbsp;<span class="ident" id="2233726">rangeError</span><span class="op" id="2233736">(</span><span class="ident" id="2233737">fnParseFloat</span><span class="op" id="2233749">,</span>&nbsp;<span class="ident" id="2233751">s</span><span class="op" id="2233752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233758">return</span>&nbsp;<span class="ident" id="2233765">f</span><span class="op" id="2233766">,</span>&nbsp;<span class="ident" id="2233768">err</span><br>
<span class="lineno">475</span><span class="op" id="2233772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233775">func</span>&nbsp;<span class="ident" id="2233780">atof64</span><span class="op" id="2233786">(</span><span class="ident" id="2233787">s</span>&nbsp;<span class="builtintype" id="2233789">string</span><span class="op" id="2233795">)</span>&nbsp;<span class="op" id="2233797">(</span><span class="ident" id="2233798">f</span>&nbsp;<span class="builtintype" id="2233800">float64</span><span class="op" id="2233807">,</span>&nbsp;<span class="ident" id="2233809">err</span>&nbsp;<span class="builtintype" id="2233813">error</span><span class="op" id="2233818">)</span>&nbsp;<span class="op" id="2233820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233823">if</span>&nbsp;<span class="ident" id="2233826">val</span><span class="op" id="2233829">,</span>&nbsp;<span class="ident" id="2233831">ok</span>&nbsp;<span class="op" id="2233834">:=</span>&nbsp;<span class="ident" id="2233837">special</span><span class="op" id="2233844">(</span><span class="ident" id="2233845">s</span><span class="op" id="2233846">)</span><span class="op" id="2233847">;</span>&nbsp;<span class="ident" id="2233849">ok</span>&nbsp;<span class="op" id="2233852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233856">return</span>&nbsp;<span class="ident" id="2233863">val</span><span class="op" id="2233866">,</span>&nbsp;<span class="ident" id="2233868">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233877">if</span>&nbsp;<span class="ident" id="2233880">optimize</span>&nbsp;<span class="op" id="2233889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233893">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233927">mantissa</span><span class="op" id="2233935">,</span>&nbsp;<span class="ident" id="2233937">exp</span><span class="op" id="2233940">,</span>&nbsp;<span class="ident" id="2233942">neg</span><span class="op" id="2233945">,</span>&nbsp;<span class="ident" id="2233947">trunc</span><span class="op" id="2233952">,</span>&nbsp;<span class="ident" id="2233954">ok</span>&nbsp;<span class="op" id="2233957">:=</span>&nbsp;<span class="ident" id="2233960">readFloat</span><span class="op" id="2233969">(</span><span class="ident" id="2233970">s</span><span class="op" id="2233971">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233975">if</span>&nbsp;<span class="ident" id="2233978">ok</span>&nbsp;<span class="op" id="2233981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2233986">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234039">if</span>&nbsp;<span class="op" id="2234042">!</span><span class="ident" id="2234043">trunc</span>&nbsp;<span class="op" id="2234049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234055">if</span>&nbsp;<span class="ident" id="2234058">f</span><span class="op" id="2234059">,</span>&nbsp;<span class="ident" id="2234061">ok</span>&nbsp;<span class="op" id="2234064">:=</span>&nbsp;<span class="ident" id="2234067">atof64exact</span><span class="op" id="2234078">(</span><span class="ident" id="2234079">mantissa</span><span class="op" id="2234087">,</span>&nbsp;<span class="ident" id="2234089">exp</span><span class="op" id="2234092">,</span>&nbsp;<span class="ident" id="2234094">neg</span><span class="op" id="2234097">)</span><span class="op" id="2234098">;</span>&nbsp;<span class="ident" id="2234100">ok</span>&nbsp;<span class="op" id="2234103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234110">return</span>&nbsp;<span class="ident" id="2234117">f</span><span class="op" id="2234118">,</span>&nbsp;<span class="ident" id="2234120">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234138">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234167">ext</span>&nbsp;<span class="op" id="2234171">:=</span>&nbsp;<span class="builtinfunc" id="2234174">new</span><span class="op" id="2234177">(</span><span class="ident" id="2234178">extFloat</span><span class="op" id="2234186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234191">if</span>&nbsp;<span class="ident" id="2234194">ok</span>&nbsp;<span class="op" id="2234197">:=</span>&nbsp;<span class="ident" id="2234200">ext</span><span class="op" id="2234203">.</span><span class="ident" id="2234204">AssignDecimal</span><span class="op" id="2234217">(</span><span class="ident" id="2234218">mantissa</span><span class="op" id="2234226">,</span>&nbsp;<span class="ident" id="2234228">exp</span><span class="op" id="2234231">,</span>&nbsp;<span class="ident" id="2234233">neg</span><span class="op" id="2234236">,</span>&nbsp;<span class="ident" id="2234238">trunc</span><span class="op" id="2234243">,</span>&nbsp;<span class="op" id="2234245">&amp;</span><span class="ident" id="2234246">float64info</span><span class="op" id="2234257">)</span><span class="op" id="2234258">;</span>&nbsp;<span class="ident" id="2234260">ok</span>&nbsp;<span class="op" id="2234263">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234269">b</span><span class="op" id="2234270">,</span>&nbsp;<span class="ident" id="2234272">ovf</span>&nbsp;<span class="op" id="2234276">:=</span>&nbsp;<span class="ident" id="2234279">ext</span><span class="op" id="2234282">.</span><span class="ident" id="2234283">floatBits</span><span class="op" id="2234292">(</span><span class="op" id="2234293">&amp;</span><span class="ident" id="2234294">float64info</span><span class="op" id="2234305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234311">f</span>&nbsp;<span class="op" id="2234313">=</span>&nbsp;<span class="ident" id="2234315">math</span><span class="op" id="2234319">.</span><span class="ident" id="2234320">Float64frombits</span><span class="op" id="2234335">(</span><span class="ident" id="2234336">b</span><span class="op" id="2234337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234343">if</span>&nbsp;<span class="ident" id="2234346">ovf</span>&nbsp;<span class="op" id="2234350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234357">err</span>&nbsp;<span class="op" id="2234361">=</span>&nbsp;<span class="ident" id="2234363">rangeError</span><span class="op" id="2234373">(</span><span class="ident" id="2234374">fnParseFloat</span><span class="op" id="2234386">,</span>&nbsp;<span class="ident" id="2234388">s</span><span class="op" id="2234389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234395">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234401">return</span>&nbsp;<span class="ident" id="2234408">f</span><span class="op" id="2234409">,</span>&nbsp;<span class="ident" id="2234411">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234428">var</span>&nbsp;<span class="ident" id="2234432">d</span>&nbsp;<span class="ident" id="2234434">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234443">if</span>&nbsp;<span class="op" id="2234446">!</span><span class="ident" id="2234447">d</span><span class="op" id="2234448">.</span><span class="ident" id="2234449">set</span><span class="op" id="2234452">(</span><span class="ident" id="2234453">s</span><span class="op" id="2234454">)</span>&nbsp;<span class="op" id="2234456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234460">return</span>&nbsp;<span class="num" id="2234467">0</span><span class="op" id="2234468">,</span>&nbsp;<span class="ident" id="2234470">syntaxError</span><span class="op" id="2234481">(</span><span class="ident" id="2234482">fnParseFloat</span><span class="op" id="2234494">,</span>&nbsp;<span class="ident" id="2234496">s</span><span class="op" id="2234497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234503">b</span><span class="op" id="2234504">,</span>&nbsp;<span class="ident" id="2234506">ovf</span>&nbsp;<span class="op" id="2234510">:=</span>&nbsp;<span class="ident" id="2234513">d</span><span class="op" id="2234514">.</span><span class="ident" id="2234515">floatBits</span><span class="op" id="2234524">(</span><span class="op" id="2234525">&amp;</span><span class="ident" id="2234526">float64info</span><span class="op" id="2234537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234540">f</span>&nbsp;<span class="op" id="2234542">=</span>&nbsp;<span class="ident" id="2234544">math</span><span class="op" id="2234548">.</span><span class="ident" id="2234549">Float64frombits</span><span class="op" id="2234564">(</span><span class="ident" id="2234565">b</span><span class="op" id="2234566">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234569">if</span>&nbsp;<span class="ident" id="2234572">ovf</span>&nbsp;<span class="op" id="2234576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234580">err</span>&nbsp;<span class="op" id="2234584">=</span>&nbsp;<span class="ident" id="2234586">rangeError</span><span class="op" id="2234596">(</span><span class="ident" id="2234597">fnParseFloat</span><span class="op" id="2234609">,</span>&nbsp;<span class="ident" id="2234611">s</span><span class="op" id="2234612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234618">return</span>&nbsp;<span class="ident" id="2234625">f</span><span class="op" id="2234626">,</span>&nbsp;<span class="ident" id="2234628">err</span><br>
<span class="lineno"></span><span class="op" id="2234632">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2234635">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2234698">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2234777">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2234847">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2234901">//</span><br>
<span class="lineno"></span><span class="comment" id="2234904">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2234967">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2235031">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2235067">//</span><br>
<span class="lineno">525</span><span class="comment" id="2235070">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2235137">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2235165">//</span><br>
<span class="lineno"></span><span class="comment" id="2235168">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2235250">//</span><br>
<span class="lineno">530</span><span class="comment" id="2235253">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2235315">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2235381">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2235434">func</span>&nbsp;<span class="ident" id="2235439">ParseFloat</span><span class="op" id="2235449">(</span><span class="ident" id="2235450">s</span>&nbsp;<span class="builtintype" id="2235452">string</span><span class="op" id="2235458">,</span>&nbsp;<span class="ident" id="2235460">bitSize</span>&nbsp;<span class="builtintype" id="2235468">int</span><span class="op" id="2235471">)</span>&nbsp;<span class="op" id="2235473">(</span><span class="ident" id="2235474">f</span>&nbsp;<span class="builtintype" id="2235476">float64</span><span class="op" id="2235483">,</span>&nbsp;<span class="ident" id="2235485">err</span>&nbsp;<span class="builtintype" id="2235489">error</span><span class="op" id="2235494">)</span>&nbsp;<span class="op" id="2235496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235499">if</span>&nbsp;<span class="ident" id="2235502">bitSize</span>&nbsp;<span class="op" id="2235510">==</span>&nbsp;<span class="num" id="2235513">32</span>&nbsp;<span class="op" id="2235516">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235520">f1</span><span class="op" id="2235522">,</span>&nbsp;<span class="ident" id="2235524">err1</span>&nbsp;<span class="op" id="2235529">:=</span>&nbsp;<span class="ident" id="2235532">atof32</span><span class="op" id="2235538">(</span><span class="ident" id="2235539">s</span><span class="op" id="2235540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235544">return</span>&nbsp;<span class="builtintype" id="2235551">float64</span><span class="op" id="2235558">(</span><span class="ident" id="2235559">f1</span><span class="op" id="2235561">)</span><span class="op" id="2235562">,</span>&nbsp;<span class="ident" id="2235564">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235573">f1</span><span class="op" id="2235575">,</span>&nbsp;<span class="ident" id="2235577">err1</span>&nbsp;<span class="op" id="2235582">:=</span>&nbsp;<span class="ident" id="2235585">atof64</span><span class="op" id="2235591">(</span><span class="ident" id="2235592">s</span><span class="op" id="2235593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235596">return</span>&nbsp;<span class="ident" id="2235603">f1</span><span class="op" id="2235605">,</span>&nbsp;<span class="ident" id="2235607">err1</span><br>
<span class="lineno">540</span><span class="op" id="2235612">}</span>
</div>
</body>
</html>
