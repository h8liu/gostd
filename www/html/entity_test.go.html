<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8189594">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8189649">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8189703">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8189754">package</span>&nbsp;<span class="ident" id="8189762">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8189768">import</span>&nbsp;<span class="op" id="8189775">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8189778">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8189789">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8189804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8189807">func</span>&nbsp;<span class="ident" id="8189812">TestEntityLength</span><span class="op" id="8189828">(</span><span class="ident" id="8189829">t</span>&nbsp;<span class="op" id="8189831">*</span><span class="ident" id="8189832">testing</span><span class="op" id="8189839">.</span><span class="ident" id="8189840">T</span><span class="op" id="8189841">)</span>&nbsp;<span class="op" id="8189843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8189846">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8189928">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8190008">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190061">for</span>&nbsp;<span class="ident" id="8190065">k</span><span class="op" id="8190066">,</span>&nbsp;<span class="ident" id="8190068">v</span>&nbsp;<span class="op" id="8190070">:=</span>&nbsp;<span class="keyword" id="8190073">range</span>&nbsp;<span class="ident" id="8190079">entity</span>&nbsp;<span class="op" id="8190086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190090">if</span>&nbsp;<span class="num" id="8190093">1</span><span class="op" id="8190094">+</span><span class="builtinfunc" id="8190095">len</span><span class="op" id="8190098">(</span><span class="ident" id="8190099">k</span><span class="op" id="8190100">)</span>&nbsp;<span class="op" id="8190102">&lt;</span>&nbsp;<span class="ident" id="8190104">utf8</span><span class="op" id="8190108">.</span><span class="ident" id="8190109">RuneLen</span><span class="op" id="8190116">(</span><span class="ident" id="8190117">v</span><span class="op" id="8190118">)</span>&nbsp;<span class="op" id="8190120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190125">t</span><span class="op" id="8190126">.</span><span class="ident" id="8190127">Error</span><span class="op" id="8190132">(</span><span class="string" id="8190133">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="8190152">+</span>&nbsp;<span class="ident" id="8190154">k</span>&nbsp;<span class="op" id="8190156">+</span>&nbsp;<span class="string" id="8190158">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="8190197">+</span>&nbsp;<span class="builtintype" id="8190199">string</span><span class="op" id="8190205">(</span><span class="ident" id="8190206">v</span><span class="op" id="8190207">)</span><span class="op" id="8190208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190212">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190216">if</span>&nbsp;<span class="builtinfunc" id="8190219">len</span><span class="op" id="8190222">(</span><span class="ident" id="8190223">k</span><span class="op" id="8190224">)</span>&nbsp;<span class="op" id="8190226">&gt;</span>&nbsp;<span class="ident" id="8190228">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="8190258">&amp;&amp;</span>&nbsp;<span class="ident" id="8190261">k</span><span class="op" id="8190262">[</span><span class="builtinfunc" id="8190263">len</span><span class="op" id="8190266">(</span><span class="ident" id="8190267">k</span><span class="op" id="8190268">)</span><span class="op" id="8190269">-</span><span class="num" id="8190270">1</span><span class="op" id="8190271">]</span>&nbsp;<span class="op" id="8190273">!=</span>&nbsp;<span class="string" id="8190276">&#39;;&#39;</span>&nbsp;<span class="op" id="8190280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190285">t</span><span class="op" id="8190286">.</span><span class="ident" id="8190287">Errorf</span><span class="op" id="8190293">(</span><span class="string" id="8190294">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="8190365">,</span>&nbsp;<span class="ident" id="8190367">k</span><span class="op" id="8190368">,</span>&nbsp;<span class="builtinfunc" id="8190370">len</span><span class="op" id="8190373">(</span><span class="ident" id="8190374">k</span><span class="op" id="8190375">)</span><span class="op" id="8190376">,</span>&nbsp;<span class="ident" id="8190378">longestEntityWithoutSemicolon</span><span class="op" id="8190407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190417">for</span>&nbsp;<span class="ident" id="8190421">k</span><span class="op" id="8190422">,</span>&nbsp;<span class="ident" id="8190424">v</span>&nbsp;<span class="op" id="8190426">:=</span>&nbsp;<span class="keyword" id="8190429">range</span>&nbsp;<span class="ident" id="8190435">entity2</span>&nbsp;<span class="op" id="8190443">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190447">if</span>&nbsp;<span class="num" id="8190450">1</span><span class="op" id="8190451">+</span><span class="builtinfunc" id="8190452">len</span><span class="op" id="8190455">(</span><span class="ident" id="8190456">k</span><span class="op" id="8190457">)</span>&nbsp;<span class="op" id="8190459">&lt;</span>&nbsp;<span class="ident" id="8190461">utf8</span><span class="op" id="8190465">.</span><span class="ident" id="8190466">RuneLen</span><span class="op" id="8190473">(</span><span class="ident" id="8190474">v</span><span class="op" id="8190475">[</span><span class="num" id="8190476">0</span><span class="op" id="8190477">]</span><span class="op" id="8190478">)</span><span class="op" id="8190479">+</span><span class="ident" id="8190480">utf8</span><span class="op" id="8190484">.</span><span class="ident" id="8190485">RuneLen</span><span class="op" id="8190492">(</span><span class="ident" id="8190493">v</span><span class="op" id="8190494">[</span><span class="num" id="8190495">1</span><span class="op" id="8190496">]</span><span class="op" id="8190497">)</span>&nbsp;<span class="op" id="8190499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190504">t</span><span class="op" id="8190505">.</span><span class="ident" id="8190506">Error</span><span class="op" id="8190511">(</span><span class="string" id="8190512">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="8190531">+</span>&nbsp;<span class="ident" id="8190533">k</span>&nbsp;<span class="op" id="8190535">+</span>&nbsp;<span class="string" id="8190537">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="8190576">+</span>&nbsp;<span class="builtintype" id="8190578">string</span><span class="op" id="8190584">(</span><span class="ident" id="8190585">v</span><span class="op" id="8190586">[</span><span class="num" id="8190587">0</span><span class="op" id="8190588">]</span><span class="op" id="8190589">)</span>&nbsp;<span class="op" id="8190591">+</span>&nbsp;<span class="builtintype" id="8190593">string</span><span class="op" id="8190599">(</span><span class="ident" id="8190600">v</span><span class="op" id="8190601">[</span><span class="num" id="8190602">1</span><span class="op" id="8190603">]</span><span class="op" id="8190604">)</span><span class="op" id="8190605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190612">}</span><br>
<span class="lineno"></span><span class="op" id="8190614">}</span>
</div>
</body>
</html>
