<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2177634">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2177689">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2177743">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2177794">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2177871">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2177895">package</span>&nbsp;<span class="ident" id="2177903">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2177912">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2177960">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2177974">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2178021">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2178094">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2178154">import</span>&nbsp;<span class="string" id="2178161">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2178169">var</span>&nbsp;<span class="ident" id="2178173">optimize</span>&nbsp;<span class="op" id="2178182">=</span>&nbsp;<span class="builtintype" id="2178184">true</span>&nbsp;<span class="comment" id="2178189">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2178216">func</span>&nbsp;<span class="ident" id="2178221">equalIgnoreCase</span><span class="op" id="2178236">(</span><span class="ident" id="2178237">s1</span><span class="op" id="2178239">,</span>&nbsp;<span class="ident" id="2178241">s2</span>&nbsp;<span class="builtintype" id="2178244">string</span><span class="op" id="2178250">)</span>&nbsp;<span class="builtintype" id="2178252">bool</span>&nbsp;<span class="op" id="2178257">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178260">if</span>&nbsp;<span class="builtinfunc" id="2178263">len</span><span class="op" id="2178266">(</span><span class="ident" id="2178267">s1</span><span class="op" id="2178269">)</span>&nbsp;<span class="op" id="2178271">!=</span>&nbsp;<span class="builtinfunc" id="2178274">len</span><span class="op" id="2178277">(</span><span class="ident" id="2178278">s2</span><span class="op" id="2178280">)</span>&nbsp;<span class="op" id="2178282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178286">return</span>&nbsp;<span class="builtintype" id="2178293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178303">for</span>&nbsp;<span class="ident" id="2178307">i</span>&nbsp;<span class="op" id="2178309">:=</span>&nbsp;<span class="num" id="2178312">0</span><span class="op" id="2178313">;</span>&nbsp;<span class="ident" id="2178315">i</span>&nbsp;<span class="op" id="2178317">&lt;</span>&nbsp;<span class="builtinfunc" id="2178319">len</span><span class="op" id="2178322">(</span><span class="ident" id="2178323">s1</span><span class="op" id="2178325">)</span><span class="op" id="2178326">;</span>&nbsp;<span class="ident" id="2178328">i</span><span class="op" id="2178329">++</span>&nbsp;<span class="op" id="2178332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178336">c1</span>&nbsp;<span class="op" id="2178339">:=</span>&nbsp;<span class="ident" id="2178342">s1</span><span class="op" id="2178344">[</span><span class="ident" id="2178345">i</span><span class="op" id="2178346">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178350">if</span>&nbsp;<span class="string" id="2178353">&#39;A&#39;</span>&nbsp;<span class="op" id="2178357">&lt;=</span>&nbsp;<span class="ident" id="2178360">c1</span>&nbsp;<span class="op" id="2178363">&amp;&amp;</span>&nbsp;<span class="ident" id="2178366">c1</span>&nbsp;<span class="op" id="2178369">&lt;=</span>&nbsp;<span class="string" id="2178372">&#39;Z&#39;</span>&nbsp;<span class="op" id="2178376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178381">c1</span>&nbsp;<span class="op" id="2178384">+=</span>&nbsp;<span class="string" id="2178387">&#39;a&#39;</span>&nbsp;<span class="op" id="2178391">-</span>&nbsp;<span class="string" id="2178393">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178403">c2</span>&nbsp;<span class="op" id="2178406">:=</span>&nbsp;<span class="ident" id="2178409">s2</span><span class="op" id="2178411">[</span><span class="ident" id="2178412">i</span><span class="op" id="2178413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178417">if</span>&nbsp;<span class="string" id="2178420">&#39;A&#39;</span>&nbsp;<span class="op" id="2178424">&lt;=</span>&nbsp;<span class="ident" id="2178427">c2</span>&nbsp;<span class="op" id="2178430">&amp;&amp;</span>&nbsp;<span class="ident" id="2178433">c2</span>&nbsp;<span class="op" id="2178436">&lt;=</span>&nbsp;<span class="string" id="2178439">&#39;Z&#39;</span>&nbsp;<span class="op" id="2178443">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178448">c2</span>&nbsp;<span class="op" id="2178451">+=</span>&nbsp;<span class="string" id="2178454">&#39;a&#39;</span>&nbsp;<span class="op" id="2178458">-</span>&nbsp;<span class="string" id="2178460">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178470">if</span>&nbsp;<span class="ident" id="2178473">c1</span>&nbsp;<span class="op" id="2178476">!=</span>&nbsp;<span class="ident" id="2178479">c2</span>&nbsp;<span class="op" id="2178482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178487">return</span>&nbsp;<span class="builtintype" id="2178494">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178502">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178508">return</span>&nbsp;<span class="builtintype" id="2178515">true</span><br>
<span class="lineno"></span><span class="op" id="2178520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2178523">func</span>&nbsp;<span class="ident" id="2178528">special</span><span class="op" id="2178535">(</span><span class="ident" id="2178536">s</span>&nbsp;<span class="builtintype" id="2178538">string</span><span class="op" id="2178544">)</span>&nbsp;<span class="op" id="2178546">(</span><span class="ident" id="2178547">f</span>&nbsp;<span class="builtintype" id="2178549">float64</span><span class="op" id="2178556">,</span>&nbsp;<span class="ident" id="2178558">ok</span>&nbsp;<span class="builtintype" id="2178561">bool</span><span class="op" id="2178565">)</span>&nbsp;<span class="op" id="2178567">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178570">if</span>&nbsp;<span class="builtinfunc" id="2178573">len</span><span class="op" id="2178576">(</span><span class="ident" id="2178577">s</span><span class="op" id="2178578">)</span>&nbsp;<span class="op" id="2178580">==</span>&nbsp;<span class="num" id="2178583">0</span>&nbsp;<span class="op" id="2178585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178589">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178600">switch</span>&nbsp;<span class="ident" id="2178607">s</span><span class="op" id="2178608">[</span><span class="num" id="2178609">0</span><span class="op" id="2178610">]</span>&nbsp;<span class="op" id="2178612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178615">default</span><span class="op" id="2178622">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178634">case</span>&nbsp;<span class="string" id="2178639">&#39;+&#39;</span><span class="op" id="2178642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178646">if</span>&nbsp;<span class="ident" id="2178649">equalIgnoreCase</span><span class="op" id="2178664">(</span><span class="ident" id="2178665">s</span><span class="op" id="2178666">,</span>&nbsp;<span class="string" id="2178668">&#34;+inf&#34;</span><span class="op" id="2178674">)</span>&nbsp;<span class="op" id="2178676">||</span>&nbsp;<span class="ident" id="2178679">equalIgnoreCase</span><span class="op" id="2178694">(</span><span class="ident" id="2178695">s</span><span class="op" id="2178696">,</span>&nbsp;<span class="string" id="2178698">&#34;+infinity&#34;</span><span class="op" id="2178709">)</span>&nbsp;<span class="op" id="2178711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178716">return</span>&nbsp;<span class="ident" id="2178723">math</span><span class="op" id="2178727">.</span><span class="ident" id="2178728">Inf</span><span class="op" id="2178731">(</span><span class="num" id="2178732">1</span><span class="op" id="2178733">)</span><span class="op" id="2178734">,</span>&nbsp;<span class="builtintype" id="2178736">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178743">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178746">case</span>&nbsp;<span class="string" id="2178751">&#39;-&#39;</span><span class="op" id="2178754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178758">if</span>&nbsp;<span class="ident" id="2178761">equalIgnoreCase</span><span class="op" id="2178776">(</span><span class="ident" id="2178777">s</span><span class="op" id="2178778">,</span>&nbsp;<span class="string" id="2178780">&#34;-inf&#34;</span><span class="op" id="2178786">)</span>&nbsp;<span class="op" id="2178788">||</span>&nbsp;<span class="ident" id="2178791">equalIgnoreCase</span><span class="op" id="2178806">(</span><span class="ident" id="2178807">s</span><span class="op" id="2178808">,</span>&nbsp;<span class="string" id="2178810">&#34;-infinity&#34;</span><span class="op" id="2178821">)</span>&nbsp;<span class="op" id="2178823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178828">return</span>&nbsp;<span class="ident" id="2178835">math</span><span class="op" id="2178839">.</span><span class="ident" id="2178840">Inf</span><span class="op" id="2178843">(</span><span class="op" id="2178844">-</span><span class="num" id="2178845">1</span><span class="op" id="2178846">)</span><span class="op" id="2178847">,</span>&nbsp;<span class="builtintype" id="2178849">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178859">case</span>&nbsp;<span class="string" id="2178864">&#39;n&#39;</span><span class="op" id="2178867">,</span>&nbsp;<span class="string" id="2178869">&#39;N&#39;</span><span class="op" id="2178872">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178876">if</span>&nbsp;<span class="ident" id="2178879">equalIgnoreCase</span><span class="op" id="2178894">(</span><span class="ident" id="2178895">s</span><span class="op" id="2178896">,</span>&nbsp;<span class="string" id="2178898">&#34;nan&#34;</span><span class="op" id="2178903">)</span>&nbsp;<span class="op" id="2178905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178910">return</span>&nbsp;<span class="ident" id="2178917">math</span><span class="op" id="2178921">.</span><span class="ident" id="2178922">NaN</span><span class="op" id="2178925">(</span><span class="op" id="2178926">)</span><span class="op" id="2178927">,</span>&nbsp;<span class="builtintype" id="2178929">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178939">case</span>&nbsp;<span class="string" id="2178944">&#39;i&#39;</span><span class="op" id="2178947">,</span>&nbsp;<span class="string" id="2178949">&#39;I&#39;</span><span class="op" id="2178952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178956">if</span>&nbsp;<span class="ident" id="2178959">equalIgnoreCase</span><span class="op" id="2178974">(</span><span class="ident" id="2178975">s</span><span class="op" id="2178976">,</span>&nbsp;<span class="string" id="2178978">&#34;inf&#34;</span><span class="op" id="2178983">)</span>&nbsp;<span class="op" id="2178985">||</span>&nbsp;<span class="ident" id="2178988">equalIgnoreCase</span><span class="op" id="2179003">(</span><span class="ident" id="2179004">s</span><span class="op" id="2179005">,</span>&nbsp;<span class="string" id="2179007">&#34;infinity&#34;</span><span class="op" id="2179017">)</span>&nbsp;<span class="op" id="2179019">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179024">return</span>&nbsp;<span class="ident" id="2179031">math</span><span class="op" id="2179035">.</span><span class="ident" id="2179036">Inf</span><span class="op" id="2179039">(</span><span class="num" id="2179040">1</span><span class="op" id="2179041">)</span><span class="op" id="2179042">,</span>&nbsp;<span class="builtintype" id="2179044">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179057">return</span><br>
<span class="lineno"></span><span class="op" id="2179064">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2179067">func</span>&nbsp;<span class="op" id="2179072">(</span><span class="ident" id="2179073">b</span>&nbsp;<span class="op" id="2179075">*</span><span class="ident" id="2179076">decimal</span><span class="op" id="2179083">)</span>&nbsp;<span class="ident" id="2179085">set</span><span class="op" id="2179088">(</span><span class="ident" id="2179089">s</span>&nbsp;<span class="builtintype" id="2179091">string</span><span class="op" id="2179097">)</span>&nbsp;<span class="op" id="2179099">(</span><span class="ident" id="2179100">ok</span>&nbsp;<span class="builtintype" id="2179103">bool</span><span class="op" id="2179107">)</span>&nbsp;<span class="op" id="2179109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179112">i</span>&nbsp;<span class="op" id="2179114">:=</span>&nbsp;<span class="num" id="2179117">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179120">b</span><span class="op" id="2179121">.</span><span class="ident" id="2179122">neg</span>&nbsp;<span class="op" id="2179126">=</span>&nbsp;<span class="builtintype" id="2179128">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179135">b</span><span class="op" id="2179136">.</span><span class="ident" id="2179137">trunc</span>&nbsp;<span class="op" id="2179143">=</span>&nbsp;<span class="builtintype" id="2179145">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179153">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179171">if</span>&nbsp;<span class="ident" id="2179174">i</span>&nbsp;<span class="op" id="2179176">&gt;=</span>&nbsp;<span class="builtinfunc" id="2179179">len</span><span class="op" id="2179182">(</span><span class="ident" id="2179183">s</span><span class="op" id="2179184">)</span>&nbsp;<span class="op" id="2179186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179190">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179198">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179201">switch</span>&nbsp;<span class="op" id="2179208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179211">case</span>&nbsp;<span class="ident" id="2179216">s</span><span class="op" id="2179217">[</span><span class="ident" id="2179218">i</span><span class="op" id="2179219">]</span>&nbsp;<span class="op" id="2179221">==</span>&nbsp;<span class="string" id="2179224">&#39;+&#39;</span><span class="op" id="2179227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179231">i</span><span class="op" id="2179232">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179236">case</span>&nbsp;<span class="ident" id="2179241">s</span><span class="op" id="2179242">[</span><span class="ident" id="2179243">i</span><span class="op" id="2179244">]</span>&nbsp;<span class="op" id="2179246">==</span>&nbsp;<span class="string" id="2179249">&#39;-&#39;</span><span class="op" id="2179252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179256">b</span><span class="op" id="2179257">.</span><span class="ident" id="2179258">neg</span>&nbsp;<span class="op" id="2179262">=</span>&nbsp;<span class="builtintype" id="2179264">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179271">i</span><span class="op" id="2179272">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179280">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179291">sawdot</span>&nbsp;<span class="op" id="2179298">:=</span>&nbsp;<span class="builtintype" id="2179301">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179308">sawdigits</span>&nbsp;<span class="op" id="2179318">:=</span>&nbsp;<span class="builtintype" id="2179321">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179328">for</span>&nbsp;<span class="op" id="2179332">;</span>&nbsp;<span class="ident" id="2179334">i</span>&nbsp;<span class="op" id="2179336">&lt;</span>&nbsp;<span class="builtinfunc" id="2179338">len</span><span class="op" id="2179341">(</span><span class="ident" id="2179342">s</span><span class="op" id="2179343">)</span><span class="op" id="2179344">;</span>&nbsp;<span class="ident" id="2179346">i</span><span class="op" id="2179347">++</span>&nbsp;<span class="op" id="2179350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179354">switch</span>&nbsp;<span class="op" id="2179361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179365">case</span>&nbsp;<span class="ident" id="2179370">s</span><span class="op" id="2179371">[</span><span class="ident" id="2179372">i</span><span class="op" id="2179373">]</span>&nbsp;<span class="op" id="2179375">==</span>&nbsp;<span class="string" id="2179378">&#39;.&#39;</span><span class="op" id="2179381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179386">if</span>&nbsp;<span class="ident" id="2179389">sawdot</span>&nbsp;<span class="op" id="2179396">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179402">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179417">sawdot</span>&nbsp;<span class="op" id="2179424">=</span>&nbsp;<span class="builtintype" id="2179426">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179434">b</span><span class="op" id="2179435">.</span><span class="ident" id="2179436">dp</span>&nbsp;<span class="op" id="2179439">=</span>&nbsp;<span class="ident" id="2179441">b</span><span class="op" id="2179442">.</span><span class="ident" id="2179443">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179449">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179461">case</span>&nbsp;<span class="string" id="2179466">&#39;0&#39;</span>&nbsp;<span class="op" id="2179470">&lt;=</span>&nbsp;<span class="ident" id="2179473">s</span><span class="op" id="2179474">[</span><span class="ident" id="2179475">i</span><span class="op" id="2179476">]</span>&nbsp;<span class="op" id="2179478">&amp;&amp;</span>&nbsp;<span class="ident" id="2179481">s</span><span class="op" id="2179482">[</span><span class="ident" id="2179483">i</span><span class="op" id="2179484">]</span>&nbsp;<span class="op" id="2179486">&lt;=</span>&nbsp;<span class="string" id="2179489">&#39;9&#39;</span><span class="op" id="2179492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179497">sawdigits</span>&nbsp;<span class="op" id="2179507">=</span>&nbsp;<span class="builtintype" id="2179509">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179517">if</span>&nbsp;<span class="ident" id="2179520">s</span><span class="op" id="2179521">[</span><span class="ident" id="2179522">i</span><span class="op" id="2179523">]</span>&nbsp;<span class="op" id="2179525">==</span>&nbsp;<span class="string" id="2179528">&#39;0&#39;</span>&nbsp;<span class="op" id="2179532">&amp;&amp;</span>&nbsp;<span class="ident" id="2179535">b</span><span class="op" id="2179536">.</span><span class="ident" id="2179537">nd</span>&nbsp;<span class="op" id="2179540">==</span>&nbsp;<span class="num" id="2179543">0</span>&nbsp;<span class="op" id="2179545">{</span>&nbsp;<span class="comment" id="2179547">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179575">b</span><span class="op" id="2179576">.</span><span class="ident" id="2179577">dp</span><span class="op" id="2179579">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179586">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179603">if</span>&nbsp;<span class="ident" id="2179606">b</span><span class="op" id="2179607">.</span><span class="ident" id="2179608">nd</span>&nbsp;<span class="op" id="2179611">&lt;</span>&nbsp;<span class="builtinfunc" id="2179613">len</span><span class="op" id="2179616">(</span><span class="ident" id="2179617">b</span><span class="op" id="2179618">.</span><span class="ident" id="2179619">d</span><span class="op" id="2179620">)</span>&nbsp;<span class="op" id="2179622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179628">b</span><span class="op" id="2179629">.</span><span class="ident" id="2179630">d</span><span class="op" id="2179631">[</span><span class="ident" id="2179632">b</span><span class="op" id="2179633">.</span><span class="ident" id="2179634">nd</span><span class="op" id="2179636">]</span>&nbsp;<span class="op" id="2179638">=</span>&nbsp;<span class="ident" id="2179640">s</span><span class="op" id="2179641">[</span><span class="ident" id="2179642">i</span><span class="op" id="2179643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179649">b</span><span class="op" id="2179650">.</span><span class="ident" id="2179651">nd</span><span class="op" id="2179653">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179659">}</span>&nbsp;<span class="keyword" id="2179661">else</span>&nbsp;<span class="keyword" id="2179666">if</span>&nbsp;<span class="ident" id="2179669">s</span><span class="op" id="2179670">[</span><span class="ident" id="2179671">i</span><span class="op" id="2179672">]</span>&nbsp;<span class="op" id="2179674">!=</span>&nbsp;<span class="string" id="2179677">&#39;0&#39;</span>&nbsp;<span class="op" id="2179681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179687">b</span><span class="op" id="2179688">.</span><span class="ident" id="2179689">trunc</span>&nbsp;<span class="op" id="2179695">=</span>&nbsp;<span class="builtintype" id="2179697">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179710">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179721">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179725">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179735">if</span>&nbsp;<span class="op" id="2179738">!</span><span class="ident" id="2179739">sawdigits</span>&nbsp;<span class="op" id="2179749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179761">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179764">if</span>&nbsp;<span class="op" id="2179767">!</span><span class="ident" id="2179768">sawdot</span>&nbsp;<span class="op" id="2179775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179779">b</span><span class="op" id="2179780">.</span><span class="ident" id="2179781">dp</span>&nbsp;<span class="op" id="2179784">=</span>&nbsp;<span class="ident" id="2179786">b</span><span class="op" id="2179787">.</span><span class="ident" id="2179788">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179796">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179839">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179886">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179932">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179984">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180010">if</span>&nbsp;<span class="ident" id="2180013">i</span>&nbsp;<span class="op" id="2180015">&lt;</span>&nbsp;<span class="builtinfunc" id="2180017">len</span><span class="op" id="2180020">(</span><span class="ident" id="2180021">s</span><span class="op" id="2180022">)</span>&nbsp;<span class="op" id="2180024">&amp;&amp;</span>&nbsp;<span class="op" id="2180027">(</span><span class="ident" id="2180028">s</span><span class="op" id="2180029">[</span><span class="ident" id="2180030">i</span><span class="op" id="2180031">]</span>&nbsp;<span class="op" id="2180033">==</span>&nbsp;<span class="string" id="2180036">&#39;e&#39;</span>&nbsp;<span class="op" id="2180040">||</span>&nbsp;<span class="ident" id="2180043">s</span><span class="op" id="2180044">[</span><span class="ident" id="2180045">i</span><span class="op" id="2180046">]</span>&nbsp;<span class="op" id="2180048">==</span>&nbsp;<span class="string" id="2180051">&#39;E&#39;</span><span class="op" id="2180054">)</span>&nbsp;<span class="op" id="2180056">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180060">i</span><span class="op" id="2180061">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180066">if</span>&nbsp;<span class="ident" id="2180069">i</span>&nbsp;<span class="op" id="2180071">&gt;=</span>&nbsp;<span class="builtinfunc" id="2180074">len</span><span class="op" id="2180077">(</span><span class="ident" id="2180078">s</span><span class="op" id="2180079">)</span>&nbsp;<span class="op" id="2180081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180086">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180099">esign</span>&nbsp;<span class="op" id="2180105">:=</span>&nbsp;<span class="num" id="2180108">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180112">if</span>&nbsp;<span class="ident" id="2180115">s</span><span class="op" id="2180116">[</span><span class="ident" id="2180117">i</span><span class="op" id="2180118">]</span>&nbsp;<span class="op" id="2180120">==</span>&nbsp;<span class="string" id="2180123">&#39;+&#39;</span>&nbsp;<span class="op" id="2180127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180132">i</span><span class="op" id="2180133">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180138">}</span>&nbsp;<span class="keyword" id="2180140">else</span>&nbsp;<span class="keyword" id="2180145">if</span>&nbsp;<span class="ident" id="2180148">s</span><span class="op" id="2180149">[</span><span class="ident" id="2180150">i</span><span class="op" id="2180151">]</span>&nbsp;<span class="op" id="2180153">==</span>&nbsp;<span class="string" id="2180156">&#39;-&#39;</span>&nbsp;<span class="op" id="2180160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180165">i</span><span class="op" id="2180166">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180172">esign</span>&nbsp;<span class="op" id="2180178">=</span>&nbsp;<span class="op" id="2180180">-</span><span class="num" id="2180181">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180189">if</span>&nbsp;<span class="ident" id="2180192">i</span>&nbsp;<span class="op" id="2180194">&gt;=</span>&nbsp;<span class="builtinfunc" id="2180197">len</span><span class="op" id="2180200">(</span><span class="ident" id="2180201">s</span><span class="op" id="2180202">)</span>&nbsp;<span class="op" id="2180204">||</span>&nbsp;<span class="ident" id="2180207">s</span><span class="op" id="2180208">[</span><span class="ident" id="2180209">i</span><span class="op" id="2180210">]</span>&nbsp;<span class="op" id="2180212">&lt;</span>&nbsp;<span class="string" id="2180214">&#39;0&#39;</span>&nbsp;<span class="op" id="2180218">||</span>&nbsp;<span class="ident" id="2180221">s</span><span class="op" id="2180222">[</span><span class="ident" id="2180223">i</span><span class="op" id="2180224">]</span>&nbsp;<span class="op" id="2180226">&gt;</span>&nbsp;<span class="string" id="2180228">&#39;9&#39;</span>&nbsp;<span class="op" id="2180232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180237">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180250">e</span>&nbsp;<span class="op" id="2180252">:=</span>&nbsp;<span class="num" id="2180255">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180259">for</span>&nbsp;<span class="op" id="2180263">;</span>&nbsp;<span class="ident" id="2180265">i</span>&nbsp;<span class="op" id="2180267">&lt;</span>&nbsp;<span class="builtinfunc" id="2180269">len</span><span class="op" id="2180272">(</span><span class="ident" id="2180273">s</span><span class="op" id="2180274">)</span>&nbsp;<span class="op" id="2180276">&amp;&amp;</span>&nbsp;<span class="string" id="2180279">&#39;0&#39;</span>&nbsp;<span class="op" id="2180283">&lt;=</span>&nbsp;<span class="ident" id="2180286">s</span><span class="op" id="2180287">[</span><span class="ident" id="2180288">i</span><span class="op" id="2180289">]</span>&nbsp;<span class="op" id="2180291">&amp;&amp;</span>&nbsp;<span class="ident" id="2180294">s</span><span class="op" id="2180295">[</span><span class="ident" id="2180296">i</span><span class="op" id="2180297">]</span>&nbsp;<span class="op" id="2180299">&lt;=</span>&nbsp;<span class="string" id="2180302">&#39;9&#39;</span><span class="op" id="2180305">;</span>&nbsp;<span class="ident" id="2180307">i</span><span class="op" id="2180308">++</span>&nbsp;<span class="op" id="2180311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180316">if</span>&nbsp;<span class="ident" id="2180319">e</span>&nbsp;<span class="op" id="2180321">&lt;</span>&nbsp;<span class="num" id="2180323">10000</span>&nbsp;<span class="op" id="2180329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180335">e</span>&nbsp;<span class="op" id="2180337">=</span>&nbsp;<span class="ident" id="2180339">e</span><span class="op" id="2180340">*</span><span class="num" id="2180341">10</span>&nbsp;<span class="op" id="2180344">+</span>&nbsp;<span class="builtintype" id="2180346">int</span><span class="op" id="2180349">(</span><span class="ident" id="2180350">s</span><span class="op" id="2180351">[</span><span class="ident" id="2180352">i</span><span class="op" id="2180353">]</span><span class="op" id="2180354">)</span>&nbsp;<span class="op" id="2180356">-</span>&nbsp;<span class="string" id="2180358">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180369">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180373">b</span><span class="op" id="2180374">.</span><span class="ident" id="2180375">dp</span>&nbsp;<span class="op" id="2180378">+=</span>&nbsp;<span class="ident" id="2180381">e</span>&nbsp;<span class="op" id="2180383">*</span>&nbsp;<span class="ident" id="2180385">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180396">if</span>&nbsp;<span class="ident" id="2180399">i</span>&nbsp;<span class="op" id="2180401">!=</span>&nbsp;<span class="builtinfunc" id="2180404">len</span><span class="op" id="2180407">(</span><span class="ident" id="2180408">s</span><span class="op" id="2180409">)</span>&nbsp;<span class="op" id="2180411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180415">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180427">ok</span>&nbsp;<span class="op" id="2180430">=</span>&nbsp;<span class="builtintype" id="2180432">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180438">return</span><br>
<span class="lineno"></span><span class="op" id="2180445">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2180448">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2180512">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2180578">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2180617">func</span>&nbsp;<span class="ident" id="2180622">readFloat</span><span class="op" id="2180631">(</span><span class="ident" id="2180632">s</span>&nbsp;<span class="builtintype" id="2180634">string</span><span class="op" id="2180640">)</span>&nbsp;<span class="op" id="2180642">(</span><span class="ident" id="2180643">mantissa</span>&nbsp;<span class="ident" id="2180652">uint64</span><span class="op" id="2180658">,</span>&nbsp;<span class="ident" id="2180660">exp</span>&nbsp;<span class="builtintype" id="2180664">int</span><span class="op" id="2180667">,</span>&nbsp;<span class="ident" id="2180669">neg</span><span class="op" id="2180672">,</span>&nbsp;<span class="ident" id="2180674">trunc</span><span class="op" id="2180679">,</span>&nbsp;<span class="ident" id="2180681">ok</span>&nbsp;<span class="builtintype" id="2180684">bool</span><span class="op" id="2180688">)</span>&nbsp;<span class="op" id="2180690">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180693">const</span>&nbsp;<span class="ident" id="2180699">uint64digits</span>&nbsp;<span class="op" id="2180712">=</span>&nbsp;<span class="num" id="2180714">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180718">i</span>&nbsp;<span class="op" id="2180720">:=</span>&nbsp;<span class="num" id="2180723">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2180727">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180745">if</span>&nbsp;<span class="ident" id="2180748">i</span>&nbsp;<span class="op" id="2180750">&gt;=</span>&nbsp;<span class="builtinfunc" id="2180753">len</span><span class="op" id="2180756">(</span><span class="ident" id="2180757">s</span><span class="op" id="2180758">)</span>&nbsp;<span class="op" id="2180760">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180764">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180775">switch</span>&nbsp;<span class="op" id="2180782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180785">case</span>&nbsp;<span class="ident" id="2180790">s</span><span class="op" id="2180791">[</span><span class="ident" id="2180792">i</span><span class="op" id="2180793">]</span>&nbsp;<span class="op" id="2180795">==</span>&nbsp;<span class="string" id="2180798">&#39;+&#39;</span><span class="op" id="2180801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180805">i</span><span class="op" id="2180806">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180810">case</span>&nbsp;<span class="ident" id="2180815">s</span><span class="op" id="2180816">[</span><span class="ident" id="2180817">i</span><span class="op" id="2180818">]</span>&nbsp;<span class="op" id="2180820">==</span>&nbsp;<span class="string" id="2180823">&#39;-&#39;</span><span class="op" id="2180826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180830">neg</span>&nbsp;<span class="op" id="2180834">=</span>&nbsp;<span class="builtintype" id="2180836">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180843">i</span><span class="op" id="2180844">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2180852">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180863">sawdot</span>&nbsp;<span class="op" id="2180870">:=</span>&nbsp;<span class="builtintype" id="2180873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180880">sawdigits</span>&nbsp;<span class="op" id="2180890">:=</span>&nbsp;<span class="builtintype" id="2180893">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180900">nd</span>&nbsp;<span class="op" id="2180903">:=</span>&nbsp;<span class="num" id="2180906">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180909">ndMant</span>&nbsp;<span class="op" id="2180916">:=</span>&nbsp;<span class="num" id="2180919">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180922">dp</span>&nbsp;<span class="op" id="2180925">:=</span>&nbsp;<span class="num" id="2180928">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180931">for</span>&nbsp;<span class="op" id="2180935">;</span>&nbsp;<span class="ident" id="2180937">i</span>&nbsp;<span class="op" id="2180939">&lt;</span>&nbsp;<span class="builtinfunc" id="2180941">len</span><span class="op" id="2180944">(</span><span class="ident" id="2180945">s</span><span class="op" id="2180946">)</span><span class="op" id="2180947">;</span>&nbsp;<span class="ident" id="2180949">i</span><span class="op" id="2180950">++</span>&nbsp;<span class="op" id="2180953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180957">switch</span>&nbsp;<span class="ident" id="2180964">c</span>&nbsp;<span class="op" id="2180966">:=</span>&nbsp;<span class="ident" id="2180969">s</span><span class="op" id="2180970">[</span><span class="ident" id="2180971">i</span><span class="op" id="2180972">]</span><span class="op" id="2180973">;</span>&nbsp;<span class="builtintype" id="2180975">true</span>&nbsp;<span class="op" id="2180980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180984">case</span>&nbsp;<span class="ident" id="2180989">c</span>&nbsp;<span class="op" id="2180991">==</span>&nbsp;<span class="string" id="2180994">&#39;.&#39;</span><span class="op" id="2180997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181002">if</span>&nbsp;<span class="ident" id="2181005">sawdot</span>&nbsp;<span class="op" id="2181012">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181033">sawdot</span>&nbsp;<span class="op" id="2181040">=</span>&nbsp;<span class="builtintype" id="2181042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181050">dp</span>&nbsp;<span class="op" id="2181053">=</span>&nbsp;<span class="ident" id="2181055">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181061">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181073">case</span>&nbsp;<span class="string" id="2181078">&#39;0&#39;</span>&nbsp;<span class="op" id="2181082">&lt;=</span>&nbsp;<span class="ident" id="2181085">c</span>&nbsp;<span class="op" id="2181087">&amp;&amp;</span>&nbsp;<span class="ident" id="2181090">c</span>&nbsp;<span class="op" id="2181092">&lt;=</span>&nbsp;<span class="string" id="2181095">&#39;9&#39;</span><span class="op" id="2181098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181103">sawdigits</span>&nbsp;<span class="op" id="2181113">=</span>&nbsp;<span class="builtintype" id="2181115">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181123">if</span>&nbsp;<span class="ident" id="2181126">c</span>&nbsp;<span class="op" id="2181128">==</span>&nbsp;<span class="string" id="2181131">&#39;0&#39;</span>&nbsp;<span class="op" id="2181135">&amp;&amp;</span>&nbsp;<span class="ident" id="2181138">nd</span>&nbsp;<span class="op" id="2181141">==</span>&nbsp;<span class="num" id="2181144">0</span>&nbsp;<span class="op" id="2181146">{</span>&nbsp;<span class="comment" id="2181148">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181176">dp</span><span class="op" id="2181178">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181185">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181202">nd</span><span class="op" id="2181204">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181210">if</span>&nbsp;<span class="ident" id="2181213">ndMant</span>&nbsp;<span class="op" id="2181220">&lt;</span>&nbsp;<span class="ident" id="2181222">uint64digits</span>&nbsp;<span class="op" id="2181235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181241">mantissa</span>&nbsp;<span class="op" id="2181250">*=</span>&nbsp;<span class="num" id="2181253">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181260">mantissa</span>&nbsp;<span class="op" id="2181269">+=</span>&nbsp;<span class="ident" id="2181272">uint64</span><span class="op" id="2181278">(</span><span class="ident" id="2181279">c</span>&nbsp;<span class="op" id="2181281">-</span>&nbsp;<span class="string" id="2181283">&#39;0&#39;</span><span class="op" id="2181286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181292">ndMant</span><span class="op" id="2181298">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181304">}</span>&nbsp;<span class="keyword" id="2181306">else</span>&nbsp;<span class="keyword" id="2181311">if</span>&nbsp;<span class="ident" id="2181314">s</span><span class="op" id="2181315">[</span><span class="ident" id="2181316">i</span><span class="op" id="2181317">]</span>&nbsp;<span class="op" id="2181319">!=</span>&nbsp;<span class="string" id="2181322">&#39;0&#39;</span>&nbsp;<span class="op" id="2181326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181332">trunc</span>&nbsp;<span class="op" id="2181338">=</span>&nbsp;<span class="builtintype" id="2181340">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181348">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181353">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181368">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181378">if</span>&nbsp;<span class="op" id="2181381">!</span><span class="ident" id="2181382">sawdigits</span>&nbsp;<span class="op" id="2181392">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181396">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181407">if</span>&nbsp;<span class="op" id="2181410">!</span><span class="ident" id="2181411">sawdot</span>&nbsp;<span class="op" id="2181418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181422">dp</span>&nbsp;<span class="op" id="2181425">=</span>&nbsp;<span class="ident" id="2181427">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181431">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181435">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181478">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181525">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181571">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181623">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181649">if</span>&nbsp;<span class="ident" id="2181652">i</span>&nbsp;<span class="op" id="2181654">&lt;</span>&nbsp;<span class="builtinfunc" id="2181656">len</span><span class="op" id="2181659">(</span><span class="ident" id="2181660">s</span><span class="op" id="2181661">)</span>&nbsp;<span class="op" id="2181663">&amp;&amp;</span>&nbsp;<span class="op" id="2181666">(</span><span class="ident" id="2181667">s</span><span class="op" id="2181668">[</span><span class="ident" id="2181669">i</span><span class="op" id="2181670">]</span>&nbsp;<span class="op" id="2181672">==</span>&nbsp;<span class="string" id="2181675">&#39;e&#39;</span>&nbsp;<span class="op" id="2181679">||</span>&nbsp;<span class="ident" id="2181682">s</span><span class="op" id="2181683">[</span><span class="ident" id="2181684">i</span><span class="op" id="2181685">]</span>&nbsp;<span class="op" id="2181687">==</span>&nbsp;<span class="string" id="2181690">&#39;E&#39;</span><span class="op" id="2181693">)</span>&nbsp;<span class="op" id="2181695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181699">i</span><span class="op" id="2181700">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181705">if</span>&nbsp;<span class="ident" id="2181708">i</span>&nbsp;<span class="op" id="2181710">&gt;=</span>&nbsp;<span class="builtinfunc" id="2181713">len</span><span class="op" id="2181716">(</span><span class="ident" id="2181717">s</span><span class="op" id="2181718">)</span>&nbsp;<span class="op" id="2181720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181725">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181738">esign</span>&nbsp;<span class="op" id="2181744">:=</span>&nbsp;<span class="num" id="2181747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181751">if</span>&nbsp;<span class="ident" id="2181754">s</span><span class="op" id="2181755">[</span><span class="ident" id="2181756">i</span><span class="op" id="2181757">]</span>&nbsp;<span class="op" id="2181759">==</span>&nbsp;<span class="string" id="2181762">&#39;+&#39;</span>&nbsp;<span class="op" id="2181766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181771">i</span><span class="op" id="2181772">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181777">}</span>&nbsp;<span class="keyword" id="2181779">else</span>&nbsp;<span class="keyword" id="2181784">if</span>&nbsp;<span class="ident" id="2181787">s</span><span class="op" id="2181788">[</span><span class="ident" id="2181789">i</span><span class="op" id="2181790">]</span>&nbsp;<span class="op" id="2181792">==</span>&nbsp;<span class="string" id="2181795">&#39;-&#39;</span>&nbsp;<span class="op" id="2181799">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181804">i</span><span class="op" id="2181805">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181811">esign</span>&nbsp;<span class="op" id="2181817">=</span>&nbsp;<span class="op" id="2181819">-</span><span class="num" id="2181820">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181828">if</span>&nbsp;<span class="ident" id="2181831">i</span>&nbsp;<span class="op" id="2181833">&gt;=</span>&nbsp;<span class="builtinfunc" id="2181836">len</span><span class="op" id="2181839">(</span><span class="ident" id="2181840">s</span><span class="op" id="2181841">)</span>&nbsp;<span class="op" id="2181843">||</span>&nbsp;<span class="ident" id="2181846">s</span><span class="op" id="2181847">[</span><span class="ident" id="2181848">i</span><span class="op" id="2181849">]</span>&nbsp;<span class="op" id="2181851">&lt;</span>&nbsp;<span class="string" id="2181853">&#39;0&#39;</span>&nbsp;<span class="op" id="2181857">||</span>&nbsp;<span class="ident" id="2181860">s</span><span class="op" id="2181861">[</span><span class="ident" id="2181862">i</span><span class="op" id="2181863">]</span>&nbsp;<span class="op" id="2181865">&gt;</span>&nbsp;<span class="string" id="2181867">&#39;9&#39;</span>&nbsp;<span class="op" id="2181871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181876">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181889">e</span>&nbsp;<span class="op" id="2181891">:=</span>&nbsp;<span class="num" id="2181894">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181898">for</span>&nbsp;<span class="op" id="2181902">;</span>&nbsp;<span class="ident" id="2181904">i</span>&nbsp;<span class="op" id="2181906">&lt;</span>&nbsp;<span class="builtinfunc" id="2181908">len</span><span class="op" id="2181911">(</span><span class="ident" id="2181912">s</span><span class="op" id="2181913">)</span>&nbsp;<span class="op" id="2181915">&amp;&amp;</span>&nbsp;<span class="string" id="2181918">&#39;0&#39;</span>&nbsp;<span class="op" id="2181922">&lt;=</span>&nbsp;<span class="ident" id="2181925">s</span><span class="op" id="2181926">[</span><span class="ident" id="2181927">i</span><span class="op" id="2181928">]</span>&nbsp;<span class="op" id="2181930">&amp;&amp;</span>&nbsp;<span class="ident" id="2181933">s</span><span class="op" id="2181934">[</span><span class="ident" id="2181935">i</span><span class="op" id="2181936">]</span>&nbsp;<span class="op" id="2181938">&lt;=</span>&nbsp;<span class="string" id="2181941">&#39;9&#39;</span><span class="op" id="2181944">;</span>&nbsp;<span class="ident" id="2181946">i</span><span class="op" id="2181947">++</span>&nbsp;<span class="op" id="2181950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181955">if</span>&nbsp;<span class="ident" id="2181958">e</span>&nbsp;<span class="op" id="2181960">&lt;</span>&nbsp;<span class="num" id="2181962">10000</span>&nbsp;<span class="op" id="2181968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181974">e</span>&nbsp;<span class="op" id="2181976">=</span>&nbsp;<span class="ident" id="2181978">e</span><span class="op" id="2181979">*</span><span class="num" id="2181980">10</span>&nbsp;<span class="op" id="2181983">+</span>&nbsp;<span class="builtintype" id="2181985">int</span><span class="op" id="2181988">(</span><span class="ident" id="2181989">s</span><span class="op" id="2181990">[</span><span class="ident" id="2181991">i</span><span class="op" id="2181992">]</span><span class="op" id="2181993">)</span>&nbsp;<span class="op" id="2181995">-</span>&nbsp;<span class="string" id="2181997">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182012">dp</span>&nbsp;<span class="op" id="2182015">+=</span>&nbsp;<span class="ident" id="2182018">e</span>&nbsp;<span class="op" id="2182020">*</span>&nbsp;<span class="ident" id="2182022">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182033">if</span>&nbsp;<span class="ident" id="2182036">i</span>&nbsp;<span class="op" id="2182038">!=</span>&nbsp;<span class="builtinfunc" id="2182041">len</span><span class="op" id="2182044">(</span><span class="ident" id="2182045">s</span><span class="op" id="2182046">)</span>&nbsp;<span class="op" id="2182048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182052">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182064">exp</span>&nbsp;<span class="op" id="2182068">=</span>&nbsp;<span class="ident" id="2182070">dp</span>&nbsp;<span class="op" id="2182073">-</span>&nbsp;<span class="ident" id="2182075">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182083">ok</span>&nbsp;<span class="op" id="2182086">=</span>&nbsp;<span class="builtintype" id="2182088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182094">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2182102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2182105">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2182153">var</span>&nbsp;<span class="ident" id="2182157">powtab</span>&nbsp;<span class="op" id="2182164">=</span>&nbsp;<span class="op" id="2182166">[</span><span class="op" id="2182167">]</span><span class="builtintype" id="2182168">int</span><span class="op" id="2182171">{</span><span class="num" id="2182172">1</span><span class="op" id="2182173">,</span>&nbsp;<span class="num" id="2182175">3</span><span class="op" id="2182176">,</span>&nbsp;<span class="num" id="2182178">6</span><span class="op" id="2182179">,</span>&nbsp;<span class="num" id="2182181">9</span><span class="op" id="2182182">,</span>&nbsp;<span class="num" id="2182184">13</span><span class="op" id="2182186">,</span>&nbsp;<span class="num" id="2182188">16</span><span class="op" id="2182190">,</span>&nbsp;<span class="num" id="2182192">19</span><span class="op" id="2182194">,</span>&nbsp;<span class="num" id="2182196">23</span><span class="op" id="2182198">,</span>&nbsp;<span class="num" id="2182200">26</span><span class="op" id="2182202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2182205">func</span>&nbsp;<span class="op" id="2182210">(</span><span class="ident" id="2182211">d</span>&nbsp;<span class="op" id="2182213">*</span><span class="ident" id="2182214">decimal</span><span class="op" id="2182221">)</span>&nbsp;<span class="ident" id="2182223">floatBits</span><span class="op" id="2182232">(</span><span class="ident" id="2182233">flt</span>&nbsp;<span class="op" id="2182237">*</span><span class="ident" id="2182238">floatInfo</span><span class="op" id="2182247">)</span>&nbsp;<span class="op" id="2182249">(</span><span class="ident" id="2182250">b</span>&nbsp;<span class="ident" id="2182252">uint64</span><span class="op" id="2182258">,</span>&nbsp;<span class="ident" id="2182260">overflow</span>&nbsp;<span class="builtintype" id="2182269">bool</span><span class="op" id="2182273">)</span>&nbsp;<span class="op" id="2182275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182278">var</span>&nbsp;<span class="ident" id="2182282">exp</span>&nbsp;<span class="builtintype" id="2182286">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182291">var</span>&nbsp;<span class="ident" id="2182295">mant</span>&nbsp;<span class="ident" id="2182300">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182309">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182344">if</span>&nbsp;<span class="ident" id="2182347">d</span><span class="op" id="2182348">.</span><span class="ident" id="2182349">nd</span>&nbsp;<span class="op" id="2182352">==</span>&nbsp;<span class="num" id="2182355">0</span>&nbsp;<span class="op" id="2182357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182361">mant</span>&nbsp;<span class="op" id="2182366">=</span>&nbsp;<span class="num" id="2182368">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182372">exp</span>&nbsp;<span class="op" id="2182376">=</span>&nbsp;<span class="ident" id="2182378">flt</span><span class="op" id="2182381">.</span><span class="ident" id="2182382">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182389">goto</span>&nbsp;<span class="ident" id="2182394">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182403">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182435">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182475">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182550">if</span>&nbsp;<span class="ident" id="2182553">d</span><span class="op" id="2182554">.</span><span class="ident" id="2182555">dp</span>&nbsp;<span class="op" id="2182558">&gt;</span>&nbsp;<span class="num" id="2182560">310</span>&nbsp;<span class="op" id="2182564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182568">goto</span>&nbsp;<span class="ident" id="2182573">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182583">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182586">if</span>&nbsp;<span class="ident" id="2182589">d</span><span class="op" id="2182590">.</span><span class="ident" id="2182591">dp</span>&nbsp;<span class="op" id="2182594">&lt;</span>&nbsp;<span class="op" id="2182596">-</span><span class="num" id="2182597">330</span>&nbsp;<span class="op" id="2182601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182605">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182615">mant</span>&nbsp;<span class="op" id="2182620">=</span>&nbsp;<span class="num" id="2182622">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182626">exp</span>&nbsp;<span class="op" id="2182630">=</span>&nbsp;<span class="ident" id="2182632">flt</span><span class="op" id="2182635">.</span><span class="ident" id="2182636">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182643">goto</span>&nbsp;<span class="ident" id="2182648">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182657">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182710">exp</span>&nbsp;<span class="op" id="2182714">=</span>&nbsp;<span class="num" id="2182716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182719">for</span>&nbsp;<span class="ident" id="2182723">d</span><span class="op" id="2182724">.</span><span class="ident" id="2182725">dp</span>&nbsp;<span class="op" id="2182728">&gt;</span>&nbsp;<span class="num" id="2182730">0</span>&nbsp;<span class="op" id="2182732">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182736">var</span>&nbsp;<span class="ident" id="2182740">n</span>&nbsp;<span class="builtintype" id="2182742">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182748">if</span>&nbsp;<span class="ident" id="2182751">d</span><span class="op" id="2182752">.</span><span class="ident" id="2182753">dp</span>&nbsp;<span class="op" id="2182756">&gt;=</span>&nbsp;<span class="builtinfunc" id="2182759">len</span><span class="op" id="2182762">(</span><span class="ident" id="2182763">powtab</span><span class="op" id="2182769">)</span>&nbsp;<span class="op" id="2182771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182776">n</span>&nbsp;<span class="op" id="2182778">=</span>&nbsp;<span class="num" id="2182780">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182785">}</span>&nbsp;<span class="keyword" id="2182787">else</span>&nbsp;<span class="op" id="2182792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182797">n</span>&nbsp;<span class="op" id="2182799">=</span>&nbsp;<span class="ident" id="2182801">powtab</span><span class="op" id="2182807">[</span><span class="ident" id="2182808">d</span><span class="op" id="2182809">.</span><span class="ident" id="2182810">dp</span><span class="op" id="2182812">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182820">d</span><span class="op" id="2182821">.</span><span class="ident" id="2182822">Shift</span><span class="op" id="2182827">(</span><span class="op" id="2182828">-</span><span class="ident" id="2182829">n</span><span class="op" id="2182830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182834">exp</span>&nbsp;<span class="op" id="2182838">+=</span>&nbsp;<span class="ident" id="2182841">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182847">for</span>&nbsp;<span class="ident" id="2182851">d</span><span class="op" id="2182852">.</span><span class="ident" id="2182853">dp</span>&nbsp;<span class="op" id="2182856">&lt;</span>&nbsp;<span class="num" id="2182858">0</span>&nbsp;<span class="op" id="2182860">||</span>&nbsp;<span class="ident" id="2182863">d</span><span class="op" id="2182864">.</span><span class="ident" id="2182865">dp</span>&nbsp;<span class="op" id="2182868">==</span>&nbsp;<span class="num" id="2182871">0</span>&nbsp;<span class="op" id="2182873">&amp;&amp;</span>&nbsp;<span class="ident" id="2182876">d</span><span class="op" id="2182877">.</span><span class="ident" id="2182878">d</span><span class="op" id="2182879">[</span><span class="num" id="2182880">0</span><span class="op" id="2182881">]</span>&nbsp;<span class="op" id="2182883">&lt;</span>&nbsp;<span class="string" id="2182885">&#39;5&#39;</span>&nbsp;<span class="op" id="2182889">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182893">var</span>&nbsp;<span class="ident" id="2182897">n</span>&nbsp;<span class="builtintype" id="2182899">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182905">if</span>&nbsp;<span class="op" id="2182908">-</span><span class="ident" id="2182909">d</span><span class="op" id="2182910">.</span><span class="ident" id="2182911">dp</span>&nbsp;<span class="op" id="2182914">&gt;=</span>&nbsp;<span class="builtinfunc" id="2182917">len</span><span class="op" id="2182920">(</span><span class="ident" id="2182921">powtab</span><span class="op" id="2182927">)</span>&nbsp;<span class="op" id="2182929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182934">n</span>&nbsp;<span class="op" id="2182936">=</span>&nbsp;<span class="num" id="2182938">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182943">}</span>&nbsp;<span class="keyword" id="2182945">else</span>&nbsp;<span class="op" id="2182950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182955">n</span>&nbsp;<span class="op" id="2182957">=</span>&nbsp;<span class="ident" id="2182959">powtab</span><span class="op" id="2182965">[</span><span class="op" id="2182966">-</span><span class="ident" id="2182967">d</span><span class="op" id="2182968">.</span><span class="ident" id="2182969">dp</span><span class="op" id="2182971">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182979">d</span><span class="op" id="2182980">.</span><span class="ident" id="2182981">Shift</span><span class="op" id="2182986">(</span><span class="ident" id="2182987">n</span><span class="op" id="2182988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2182992">exp</span>&nbsp;<span class="op" id="2182996">-=</span>&nbsp;<span class="ident" id="2182999">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183006">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183066">exp</span><span class="op" id="2183069">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183074">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183124">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183171">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183197">if</span>&nbsp;<span class="ident" id="2183200">exp</span>&nbsp;<span class="op" id="2183204">&lt;</span>&nbsp;<span class="ident" id="2183206">flt</span><span class="op" id="2183209">.</span><span class="ident" id="2183210">bias</span><span class="op" id="2183214">+</span><span class="num" id="2183215">1</span>&nbsp;<span class="op" id="2183217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183221">n</span>&nbsp;<span class="op" id="2183223">:=</span>&nbsp;<span class="ident" id="2183226">flt</span><span class="op" id="2183229">.</span><span class="ident" id="2183230">bias</span>&nbsp;<span class="op" id="2183235">+</span>&nbsp;<span class="num" id="2183237">1</span>&nbsp;<span class="op" id="2183239">-</span>&nbsp;<span class="ident" id="2183241">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183247">d</span><span class="op" id="2183248">.</span><span class="ident" id="2183249">Shift</span><span class="op" id="2183254">(</span><span class="op" id="2183255">-</span><span class="ident" id="2183256">n</span><span class="op" id="2183257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183261">exp</span>&nbsp;<span class="op" id="2183265">+=</span>&nbsp;<span class="ident" id="2183268">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183275">if</span>&nbsp;<span class="ident" id="2183278">exp</span><span class="op" id="2183281">-</span><span class="ident" id="2183282">flt</span><span class="op" id="2183285">.</span><span class="ident" id="2183286">bias</span>&nbsp;<span class="op" id="2183291">&gt;=</span>&nbsp;<span class="num" id="2183294">1</span><span class="op" id="2183295">&lt;&lt;</span><span class="ident" id="2183297">flt</span><span class="op" id="2183300">.</span><span class="ident" id="2183301">expbits</span><span class="op" id="2183308">-</span><span class="num" id="2183309">1</span>&nbsp;<span class="op" id="2183311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183315">goto</span>&nbsp;<span class="ident" id="2183320">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183330">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183334">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183367">d</span><span class="op" id="2183368">.</span><span class="ident" id="2183369">Shift</span><span class="op" id="2183374">(</span><span class="builtintype" id="2183375">int</span><span class="op" id="2183378">(</span><span class="num" id="2183379">1</span>&nbsp;<span class="op" id="2183381">+</span>&nbsp;<span class="ident" id="2183383">flt</span><span class="op" id="2183386">.</span><span class="ident" id="2183387">mantbits</span><span class="op" id="2183395">)</span><span class="op" id="2183396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183399">mant</span>&nbsp;<span class="op" id="2183404">=</span>&nbsp;<span class="ident" id="2183406">d</span><span class="op" id="2183407">.</span><span class="ident" id="2183408">RoundedInteger</span><span class="op" id="2183422">(</span><span class="op" id="2183423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183427">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183476">if</span>&nbsp;<span class="ident" id="2183479">mant</span>&nbsp;<span class="op" id="2183484">==</span>&nbsp;<span class="num" id="2183487">2</span><span class="op" id="2183488">&lt;&lt;</span><span class="ident" id="2183490">flt</span><span class="op" id="2183493">.</span><span class="ident" id="2183494">mantbits</span>&nbsp;<span class="op" id="2183503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183507">mant</span>&nbsp;<span class="op" id="2183512">&gt;&gt;=</span>&nbsp;<span class="num" id="2183516">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183520">exp</span><span class="op" id="2183523">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183528">if</span>&nbsp;<span class="ident" id="2183531">exp</span><span class="op" id="2183534">-</span><span class="ident" id="2183535">flt</span><span class="op" id="2183538">.</span><span class="ident" id="2183539">bias</span>&nbsp;<span class="op" id="2183544">&gt;=</span>&nbsp;<span class="num" id="2183547">1</span><span class="op" id="2183548">&lt;&lt;</span><span class="ident" id="2183550">flt</span><span class="op" id="2183553">.</span><span class="ident" id="2183554">expbits</span><span class="op" id="2183561">-</span><span class="num" id="2183562">1</span>&nbsp;<span class="op" id="2183564">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183569">goto</span>&nbsp;<span class="ident" id="2183574">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183592">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183610">if</span>&nbsp;<span class="ident" id="2183613">mant</span><span class="op" id="2183617">&amp;</span><span class="op" id="2183618">(</span><span class="num" id="2183619">1</span><span class="op" id="2183620">&lt;&lt;</span><span class="ident" id="2183622">flt</span><span class="op" id="2183625">.</span><span class="ident" id="2183626">mantbits</span><span class="op" id="2183634">)</span>&nbsp;<span class="op" id="2183636">==</span>&nbsp;<span class="num" id="2183639">0</span>&nbsp;<span class="op" id="2183641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183645">exp</span>&nbsp;<span class="op" id="2183649">=</span>&nbsp;<span class="ident" id="2183651">flt</span><span class="op" id="2183654">.</span><span class="ident" id="2183655">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183664">goto</span>&nbsp;<span class="ident" id="2183669">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2183674">overflow</span><span class="op" id="2183682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183685">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183695">mant</span>&nbsp;<span class="op" id="2183700">=</span>&nbsp;<span class="num" id="2183702">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183705">exp</span>&nbsp;<span class="op" id="2183709">=</span>&nbsp;<span class="num" id="2183711">1</span><span class="op" id="2183712">&lt;&lt;</span><span class="ident" id="2183714">flt</span><span class="op" id="2183717">.</span><span class="ident" id="2183718">expbits</span>&nbsp;<span class="op" id="2183726">-</span>&nbsp;<span class="num" id="2183728">1</span>&nbsp;<span class="op" id="2183730">+</span>&nbsp;<span class="ident" id="2183732">flt</span><span class="op" id="2183735">.</span><span class="ident" id="2183736">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183742">overflow</span>&nbsp;<span class="op" id="2183751">=</span>&nbsp;<span class="builtintype" id="2183753">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2183759">out</span><span class="op" id="2183762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183765">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183784">bits</span>&nbsp;<span class="op" id="2183789">:=</span>&nbsp;<span class="ident" id="2183792">mant</span>&nbsp;<span class="op" id="2183797">&amp;</span>&nbsp;<span class="op" id="2183799">(</span><span class="ident" id="2183800">uint64</span><span class="op" id="2183806">(</span><span class="num" id="2183807">1</span><span class="op" id="2183808">)</span><span class="op" id="2183809">&lt;&lt;</span><span class="ident" id="2183811">flt</span><span class="op" id="2183814">.</span><span class="ident" id="2183815">mantbits</span>&nbsp;<span class="op" id="2183824">-</span>&nbsp;<span class="num" id="2183826">1</span><span class="op" id="2183827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183830">bits</span>&nbsp;<span class="op" id="2183835">|=</span>&nbsp;<span class="ident" id="2183838">uint64</span><span class="op" id="2183844">(</span><span class="op" id="2183845">(</span><span class="ident" id="2183846">exp</span><span class="op" id="2183849">-</span><span class="ident" id="2183850">flt</span><span class="op" id="2183853">.</span><span class="ident" id="2183854">bias</span><span class="op" id="2183858">)</span><span class="op" id="2183859">&amp;</span><span class="op" id="2183860">(</span><span class="num" id="2183861">1</span><span class="op" id="2183862">&lt;&lt;</span><span class="ident" id="2183864">flt</span><span class="op" id="2183867">.</span><span class="ident" id="2183868">expbits</span><span class="op" id="2183875">-</span><span class="num" id="2183876">1</span><span class="op" id="2183877">)</span><span class="op" id="2183878">)</span>&nbsp;<span class="op" id="2183880">&lt;&lt;</span>&nbsp;<span class="ident" id="2183883">flt</span><span class="op" id="2183886">.</span><span class="ident" id="2183887">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183897">if</span>&nbsp;<span class="ident" id="2183900">d</span><span class="op" id="2183901">.</span><span class="ident" id="2183902">neg</span>&nbsp;<span class="op" id="2183906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2183910">bits</span>&nbsp;<span class="op" id="2183915">|=</span>&nbsp;<span class="num" id="2183918">1</span>&nbsp;<span class="op" id="2183920">&lt;&lt;</span>&nbsp;<span class="ident" id="2183923">flt</span><span class="op" id="2183926">.</span><span class="ident" id="2183927">mantbits</span>&nbsp;<span class="op" id="2183936">&lt;&lt;</span>&nbsp;<span class="ident" id="2183939">flt</span><span class="op" id="2183942">.</span><span class="ident" id="2183943">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183955">return</span>&nbsp;<span class="ident" id="2183962">bits</span><span class="op" id="2183966">,</span>&nbsp;<span class="ident" id="2183968">overflow</span><br>
<span class="lineno"></span><span class="op" id="2183977">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2183980">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2184003">var</span>&nbsp;<span class="ident" id="2184007">float64pow10</span>&nbsp;<span class="op" id="2184020">=</span>&nbsp;<span class="op" id="2184022">[</span><span class="op" id="2184023">]</span><span class="builtintype" id="2184024">float64</span><span class="op" id="2184031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2184034">1e0</span><span class="op" id="2184037">,</span>&nbsp;<span class="num" id="2184039">1e1</span><span class="op" id="2184042">,</span>&nbsp;<span class="num" id="2184044">1e2</span><span class="op" id="2184047">,</span>&nbsp;<span class="num" id="2184049">1e3</span><span class="op" id="2184052">,</span>&nbsp;<span class="num" id="2184054">1e4</span><span class="op" id="2184057">,</span>&nbsp;<span class="num" id="2184059">1e5</span><span class="op" id="2184062">,</span>&nbsp;<span class="num" id="2184064">1e6</span><span class="op" id="2184067">,</span>&nbsp;<span class="num" id="2184069">1e7</span><span class="op" id="2184072">,</span>&nbsp;<span class="num" id="2184074">1e8</span><span class="op" id="2184077">,</span>&nbsp;<span class="num" id="2184079">1e9</span><span class="op" id="2184082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2184085">1e10</span><span class="op" id="2184089">,</span>&nbsp;<span class="num" id="2184091">1e11</span><span class="op" id="2184095">,</span>&nbsp;<span class="num" id="2184097">1e12</span><span class="op" id="2184101">,</span>&nbsp;<span class="num" id="2184103">1e13</span><span class="op" id="2184107">,</span>&nbsp;<span class="num" id="2184109">1e14</span><span class="op" id="2184113">,</span>&nbsp;<span class="num" id="2184115">1e15</span><span class="op" id="2184119">,</span>&nbsp;<span class="num" id="2184121">1e16</span><span class="op" id="2184125">,</span>&nbsp;<span class="num" id="2184127">1e17</span><span class="op" id="2184131">,</span>&nbsp;<span class="num" id="2184133">1e18</span><span class="op" id="2184137">,</span>&nbsp;<span class="num" id="2184139">1e19</span><span class="op" id="2184143">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2184146">1e20</span><span class="op" id="2184150">,</span>&nbsp;<span class="num" id="2184152">1e21</span><span class="op" id="2184156">,</span>&nbsp;<span class="num" id="2184158">1e22</span><span class="op" id="2184162">,</span><br>
<span class="lineno"></span><span class="op" id="2184164">}</span><br>
<span class="lineno"></span><span class="keyword" id="2184166">var</span>&nbsp;<span class="ident" id="2184170">float32pow10</span>&nbsp;<span class="op" id="2184183">=</span>&nbsp;<span class="op" id="2184185">[</span><span class="op" id="2184186">]</span><span class="builtintype" id="2184187">float32</span><span class="op" id="2184194">{</span><span class="num" id="2184195">1e0</span><span class="op" id="2184198">,</span>&nbsp;<span class="num" id="2184200">1e1</span><span class="op" id="2184203">,</span>&nbsp;<span class="num" id="2184205">1e2</span><span class="op" id="2184208">,</span>&nbsp;<span class="num" id="2184210">1e3</span><span class="op" id="2184213">,</span>&nbsp;<span class="num" id="2184215">1e4</span><span class="op" id="2184218">,</span>&nbsp;<span class="num" id="2184220">1e5</span><span class="op" id="2184223">,</span>&nbsp;<span class="num" id="2184225">1e6</span><span class="op" id="2184228">,</span>&nbsp;<span class="num" id="2184230">1e7</span><span class="op" id="2184233">,</span>&nbsp;<span class="num" id="2184235">1e8</span><span class="op" id="2184238">,</span>&nbsp;<span class="num" id="2184240">1e9</span><span class="op" id="2184243">,</span>&nbsp;<span class="num" id="2184245">1e10</span><span class="op" id="2184249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2184252">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2184328">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2184415">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2184438">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2184464">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2184511">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2184558">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2184630">func</span>&nbsp;<span class="ident" id="2184635">atof64exact</span><span class="op" id="2184646">(</span><span class="ident" id="2184647">mantissa</span>&nbsp;<span class="ident" id="2184656">uint64</span><span class="op" id="2184662">,</span>&nbsp;<span class="ident" id="2184664">exp</span>&nbsp;<span class="builtintype" id="2184668">int</span><span class="op" id="2184671">,</span>&nbsp;<span class="ident" id="2184673">neg</span>&nbsp;<span class="builtintype" id="2184677">bool</span><span class="op" id="2184681">)</span>&nbsp;<span class="op" id="2184683">(</span><span class="ident" id="2184684">f</span>&nbsp;<span class="builtintype" id="2184686">float64</span><span class="op" id="2184693">,</span>&nbsp;<span class="ident" id="2184695">ok</span>&nbsp;<span class="builtintype" id="2184698">bool</span><span class="op" id="2184702">)</span>&nbsp;<span class="op" id="2184704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184707">if</span>&nbsp;<span class="ident" id="2184710">mantissa</span><span class="op" id="2184718">&gt;&gt;</span><span class="ident" id="2184720">float64info</span><span class="op" id="2184731">.</span><span class="ident" id="2184732">mantbits</span>&nbsp;<span class="op" id="2184741">!=</span>&nbsp;<span class="num" id="2184744">0</span>&nbsp;<span class="op" id="2184746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184758">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184761">f</span>&nbsp;<span class="op" id="2184763">=</span>&nbsp;<span class="builtintype" id="2184765">float64</span><span class="op" id="2184772">(</span><span class="ident" id="2184773">mantissa</span><span class="op" id="2184781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184784">if</span>&nbsp;<span class="ident" id="2184787">neg</span>&nbsp;<span class="op" id="2184791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184795">f</span>&nbsp;<span class="op" id="2184797">=</span>&nbsp;<span class="op" id="2184799">-</span><span class="ident" id="2184800">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184806">switch</span>&nbsp;<span class="op" id="2184813">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184816">case</span>&nbsp;<span class="ident" id="2184821">exp</span>&nbsp;<span class="op" id="2184825">==</span>&nbsp;<span class="num" id="2184828">0</span><span class="op" id="2184829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184833">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184850">return</span>&nbsp;<span class="ident" id="2184857">f</span><span class="op" id="2184858">,</span>&nbsp;<span class="builtintype" id="2184860">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184866">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184899">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184937">case</span>&nbsp;<span class="ident" id="2184942">exp</span>&nbsp;<span class="op" id="2184946">&gt;</span>&nbsp;<span class="num" id="2184948">0</span>&nbsp;<span class="op" id="2184950">&amp;&amp;</span>&nbsp;<span class="ident" id="2184953">exp</span>&nbsp;<span class="op" id="2184957">&lt;=</span>&nbsp;<span class="num" id="2184960">15</span><span class="op" id="2184962">+</span><span class="num" id="2184963">22</span><span class="op" id="2184965">:</span>&nbsp;<span class="comment" id="2184967">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184983">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185036">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185085">if</span>&nbsp;<span class="ident" id="2185088">exp</span>&nbsp;<span class="op" id="2185092">&gt;</span>&nbsp;<span class="num" id="2185094">22</span>&nbsp;<span class="op" id="2185097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185102">f</span>&nbsp;<span class="op" id="2185104">*=</span>&nbsp;<span class="ident" id="2185107">float64pow10</span><span class="op" id="2185119">[</span><span class="ident" id="2185120">exp</span><span class="op" id="2185123">-</span><span class="num" id="2185124">22</span><span class="op" id="2185126">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185131">exp</span>&nbsp;<span class="op" id="2185135">=</span>&nbsp;<span class="num" id="2185137">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185146">if</span>&nbsp;<span class="ident" id="2185149">f</span>&nbsp;<span class="op" id="2185151">&gt;</span>&nbsp;<span class="num" id="2185153">1e15</span>&nbsp;<span class="op" id="2185158">||</span>&nbsp;<span class="ident" id="2185161">f</span>&nbsp;<span class="op" id="2185163">&lt;</span>&nbsp;<span class="op" id="2185165">-</span><span class="num" id="2185166">1e15</span>&nbsp;<span class="op" id="2185171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185176">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185217">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185230">return</span>&nbsp;<span class="ident" id="2185237">f</span>&nbsp;<span class="op" id="2185239">*</span>&nbsp;<span class="ident" id="2185241">float64pow10</span><span class="op" id="2185253">[</span><span class="ident" id="2185254">exp</span><span class="op" id="2185257">]</span><span class="op" id="2185258">,</span>&nbsp;<span class="builtintype" id="2185260">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185266">case</span>&nbsp;<span class="ident" id="2185271">exp</span>&nbsp;<span class="op" id="2185275">&lt;</span>&nbsp;<span class="num" id="2185277">0</span>&nbsp;<span class="op" id="2185279">&amp;&amp;</span>&nbsp;<span class="ident" id="2185282">exp</span>&nbsp;<span class="op" id="2185286">&gt;=</span>&nbsp;<span class="op" id="2185289">-</span><span class="num" id="2185290">22</span><span class="op" id="2185292">:</span>&nbsp;<span class="comment" id="2185294">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185310">return</span>&nbsp;<span class="ident" id="2185317">f</span>&nbsp;<span class="op" id="2185319">/</span>&nbsp;<span class="ident" id="2185321">float64pow10</span><span class="op" id="2185333">[</span><span class="op" id="2185334">-</span><span class="ident" id="2185335">exp</span><span class="op" id="2185338">]</span><span class="op" id="2185339">,</span>&nbsp;<span class="builtintype" id="2185341">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185347">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185350">return</span><br>
<span class="lineno"></span><span class="op" id="2185357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2185360">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2185429">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2185502">func</span>&nbsp;<span class="ident" id="2185507">atof32exact</span><span class="op" id="2185518">(</span><span class="ident" id="2185519">mantissa</span>&nbsp;<span class="ident" id="2185528">uint64</span><span class="op" id="2185534">,</span>&nbsp;<span class="ident" id="2185536">exp</span>&nbsp;<span class="builtintype" id="2185540">int</span><span class="op" id="2185543">,</span>&nbsp;<span class="ident" id="2185545">neg</span>&nbsp;<span class="builtintype" id="2185549">bool</span><span class="op" id="2185553">)</span>&nbsp;<span class="op" id="2185555">(</span><span class="ident" id="2185556">f</span>&nbsp;<span class="builtintype" id="2185558">float32</span><span class="op" id="2185565">,</span>&nbsp;<span class="ident" id="2185567">ok</span>&nbsp;<span class="builtintype" id="2185570">bool</span><span class="op" id="2185574">)</span>&nbsp;<span class="op" id="2185576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185579">if</span>&nbsp;<span class="ident" id="2185582">mantissa</span><span class="op" id="2185590">&gt;&gt;</span><span class="ident" id="2185592">float32info</span><span class="op" id="2185603">.</span><span class="ident" id="2185604">mantbits</span>&nbsp;<span class="op" id="2185613">!=</span>&nbsp;<span class="num" id="2185616">0</span>&nbsp;<span class="op" id="2185618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185622">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185633">f</span>&nbsp;<span class="op" id="2185635">=</span>&nbsp;<span class="builtintype" id="2185637">float32</span><span class="op" id="2185644">(</span><span class="ident" id="2185645">mantissa</span><span class="op" id="2185653">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185656">if</span>&nbsp;<span class="ident" id="2185659">neg</span>&nbsp;<span class="op" id="2185663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185667">f</span>&nbsp;<span class="op" id="2185669">=</span>&nbsp;<span class="op" id="2185671">-</span><span class="ident" id="2185672">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185678">switch</span>&nbsp;<span class="op" id="2185685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185688">case</span>&nbsp;<span class="ident" id="2185693">exp</span>&nbsp;<span class="op" id="2185697">==</span>&nbsp;<span class="num" id="2185700">0</span><span class="op" id="2185701">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185705">return</span>&nbsp;<span class="ident" id="2185712">f</span><span class="op" id="2185713">,</span>&nbsp;<span class="builtintype" id="2185715">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185721">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185753">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185791">case</span>&nbsp;<span class="ident" id="2185796">exp</span>&nbsp;<span class="op" id="2185800">&gt;</span>&nbsp;<span class="num" id="2185802">0</span>&nbsp;<span class="op" id="2185804">&amp;&amp;</span>&nbsp;<span class="ident" id="2185807">exp</span>&nbsp;<span class="op" id="2185811">&lt;=</span>&nbsp;<span class="num" id="2185814">7</span><span class="op" id="2185815">+</span><span class="num" id="2185816">10</span><span class="op" id="2185818">:</span>&nbsp;<span class="comment" id="2185820">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185836">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185889">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185938">if</span>&nbsp;<span class="ident" id="2185941">exp</span>&nbsp;<span class="op" id="2185945">&gt;</span>&nbsp;<span class="num" id="2185947">10</span>&nbsp;<span class="op" id="2185950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185955">f</span>&nbsp;<span class="op" id="2185957">*=</span>&nbsp;<span class="ident" id="2185960">float32pow10</span><span class="op" id="2185972">[</span><span class="ident" id="2185973">exp</span><span class="op" id="2185976">-</span><span class="num" id="2185977">10</span><span class="op" id="2185979">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2185984">exp</span>&nbsp;<span class="op" id="2185988">=</span>&nbsp;<span class="num" id="2185990">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185995">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185999">if</span>&nbsp;<span class="ident" id="2186002">f</span>&nbsp;<span class="op" id="2186004">&gt;</span>&nbsp;<span class="num" id="2186006">1e7</span>&nbsp;<span class="op" id="2186010">||</span>&nbsp;<span class="ident" id="2186013">f</span>&nbsp;<span class="op" id="2186015">&lt;</span>&nbsp;<span class="op" id="2186017">-</span><span class="num" id="2186018">1e7</span>&nbsp;<span class="op" id="2186022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2186027">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186081">return</span>&nbsp;<span class="ident" id="2186088">f</span>&nbsp;<span class="op" id="2186090">*</span>&nbsp;<span class="ident" id="2186092">float32pow10</span><span class="op" id="2186104">[</span><span class="ident" id="2186105">exp</span><span class="op" id="2186108">]</span><span class="op" id="2186109">,</span>&nbsp;<span class="builtintype" id="2186111">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186117">case</span>&nbsp;<span class="ident" id="2186122">exp</span>&nbsp;<span class="op" id="2186126">&lt;</span>&nbsp;<span class="num" id="2186128">0</span>&nbsp;<span class="op" id="2186130">&amp;&amp;</span>&nbsp;<span class="ident" id="2186133">exp</span>&nbsp;<span class="op" id="2186137">&gt;=</span>&nbsp;<span class="op" id="2186140">-</span><span class="num" id="2186141">10</span><span class="op" id="2186143">:</span>&nbsp;<span class="comment" id="2186145">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186161">return</span>&nbsp;<span class="ident" id="2186168">f</span>&nbsp;<span class="op" id="2186170">/</span>&nbsp;<span class="ident" id="2186172">float32pow10</span><span class="op" id="2186184">[</span><span class="op" id="2186185">-</span><span class="ident" id="2186186">exp</span><span class="op" id="2186189">]</span><span class="op" id="2186190">,</span>&nbsp;<span class="builtintype" id="2186192">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186201">return</span><br>
<span class="lineno"></span><span class="op" id="2186208">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2186211">const</span>&nbsp;<span class="ident" id="2186217">fnParseFloat</span>&nbsp;<span class="op" id="2186230">=</span>&nbsp;<span class="string" id="2186232">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2186246">func</span>&nbsp;<span class="ident" id="2186251">atof32</span><span class="op" id="2186257">(</span><span class="ident" id="2186258">s</span>&nbsp;<span class="builtintype" id="2186260">string</span><span class="op" id="2186266">)</span>&nbsp;<span class="op" id="2186268">(</span><span class="ident" id="2186269">f</span>&nbsp;<span class="builtintype" id="2186271">float32</span><span class="op" id="2186278">,</span>&nbsp;<span class="ident" id="2186280">err</span>&nbsp;<span class="builtintype" id="2186284">error</span><span class="op" id="2186289">)</span>&nbsp;<span class="op" id="2186291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186294">if</span>&nbsp;<span class="ident" id="2186297">val</span><span class="op" id="2186300">,</span>&nbsp;<span class="ident" id="2186302">ok</span>&nbsp;<span class="op" id="2186305">:=</span>&nbsp;<span class="ident" id="2186308">special</span><span class="op" id="2186315">(</span><span class="ident" id="2186316">s</span><span class="op" id="2186317">)</span><span class="op" id="2186318">;</span>&nbsp;<span class="ident" id="2186320">ok</span>&nbsp;<span class="op" id="2186323">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186327">return</span>&nbsp;<span class="builtintype" id="2186334">float32</span><span class="op" id="2186341">(</span><span class="ident" id="2186342">val</span><span class="op" id="2186345">)</span><span class="op" id="2186346">,</span>&nbsp;<span class="ident" id="2186348">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186357">if</span>&nbsp;<span class="ident" id="2186360">optimize</span>&nbsp;<span class="op" id="2186369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2186373">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186407">mantissa</span><span class="op" id="2186415">,</span>&nbsp;<span class="ident" id="2186417">exp</span><span class="op" id="2186420">,</span>&nbsp;<span class="ident" id="2186422">neg</span><span class="op" id="2186425">,</span>&nbsp;<span class="ident" id="2186427">trunc</span><span class="op" id="2186432">,</span>&nbsp;<span class="ident" id="2186434">ok</span>&nbsp;<span class="op" id="2186437">:=</span>&nbsp;<span class="ident" id="2186440">readFloat</span><span class="op" id="2186449">(</span><span class="ident" id="2186450">s</span><span class="op" id="2186451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186455">if</span>&nbsp;<span class="ident" id="2186458">ok</span>&nbsp;<span class="op" id="2186461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2186466">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186519">if</span>&nbsp;<span class="op" id="2186522">!</span><span class="ident" id="2186523">trunc</span>&nbsp;<span class="op" id="2186529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186535">if</span>&nbsp;<span class="ident" id="2186538">f</span><span class="op" id="2186539">,</span>&nbsp;<span class="ident" id="2186541">ok</span>&nbsp;<span class="op" id="2186544">:=</span>&nbsp;<span class="ident" id="2186547">atof32exact</span><span class="op" id="2186558">(</span><span class="ident" id="2186559">mantissa</span><span class="op" id="2186567">,</span>&nbsp;<span class="ident" id="2186569">exp</span><span class="op" id="2186572">,</span>&nbsp;<span class="ident" id="2186574">neg</span><span class="op" id="2186577">)</span><span class="op" id="2186578">;</span>&nbsp;<span class="ident" id="2186580">ok</span>&nbsp;<span class="op" id="2186583">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186590">return</span>&nbsp;<span class="ident" id="2186597">f</span><span class="op" id="2186598">,</span>&nbsp;<span class="ident" id="2186600">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2186618">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186647">ext</span>&nbsp;<span class="op" id="2186651">:=</span>&nbsp;<span class="builtinfunc" id="2186654">new</span><span class="op" id="2186657">(</span><span class="ident" id="2186658">extFloat</span><span class="op" id="2186666">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186671">if</span>&nbsp;<span class="ident" id="2186674">ok</span>&nbsp;<span class="op" id="2186677">:=</span>&nbsp;<span class="ident" id="2186680">ext</span><span class="op" id="2186683">.</span><span class="ident" id="2186684">AssignDecimal</span><span class="op" id="2186697">(</span><span class="ident" id="2186698">mantissa</span><span class="op" id="2186706">,</span>&nbsp;<span class="ident" id="2186708">exp</span><span class="op" id="2186711">,</span>&nbsp;<span class="ident" id="2186713">neg</span><span class="op" id="2186716">,</span>&nbsp;<span class="ident" id="2186718">trunc</span><span class="op" id="2186723">,</span>&nbsp;<span class="op" id="2186725">&amp;</span><span class="ident" id="2186726">float32info</span><span class="op" id="2186737">)</span><span class="op" id="2186738">;</span>&nbsp;<span class="ident" id="2186740">ok</span>&nbsp;<span class="op" id="2186743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186749">b</span><span class="op" id="2186750">,</span>&nbsp;<span class="ident" id="2186752">ovf</span>&nbsp;<span class="op" id="2186756">:=</span>&nbsp;<span class="ident" id="2186759">ext</span><span class="op" id="2186762">.</span><span class="ident" id="2186763">floatBits</span><span class="op" id="2186772">(</span><span class="op" id="2186773">&amp;</span><span class="ident" id="2186774">float32info</span><span class="op" id="2186785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186791">f</span>&nbsp;<span class="op" id="2186793">=</span>&nbsp;<span class="ident" id="2186795">math</span><span class="op" id="2186799">.</span><span class="ident" id="2186800">Float32frombits</span><span class="op" id="2186815">(</span><span class="builtintype" id="2186816">uint32</span><span class="op" id="2186822">(</span><span class="ident" id="2186823">b</span><span class="op" id="2186824">)</span><span class="op" id="2186825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186831">if</span>&nbsp;<span class="ident" id="2186834">ovf</span>&nbsp;<span class="op" id="2186838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186845">err</span>&nbsp;<span class="op" id="2186849">=</span>&nbsp;<span class="ident" id="2186851">rangeError</span><span class="op" id="2186861">(</span><span class="ident" id="2186862">fnParseFloat</span><span class="op" id="2186874">,</span>&nbsp;<span class="ident" id="2186876">s</span><span class="op" id="2186877">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186889">return</span>&nbsp;<span class="ident" id="2186896">f</span><span class="op" id="2186897">,</span>&nbsp;<span class="ident" id="2186899">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186913">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186916">var</span>&nbsp;<span class="ident" id="2186920">d</span>&nbsp;<span class="ident" id="2186922">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186931">if</span>&nbsp;<span class="op" id="2186934">!</span><span class="ident" id="2186935">d</span><span class="op" id="2186936">.</span><span class="ident" id="2186937">set</span><span class="op" id="2186940">(</span><span class="ident" id="2186941">s</span><span class="op" id="2186942">)</span>&nbsp;<span class="op" id="2186944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2186948">return</span>&nbsp;<span class="num" id="2186955">0</span><span class="op" id="2186956">,</span>&nbsp;<span class="ident" id="2186958">syntaxError</span><span class="op" id="2186969">(</span><span class="ident" id="2186970">fnParseFloat</span><span class="op" id="2186982">,</span>&nbsp;<span class="ident" id="2186984">s</span><span class="op" id="2186985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2186988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2186991">b</span><span class="op" id="2186992">,</span>&nbsp;<span class="ident" id="2186994">ovf</span>&nbsp;<span class="op" id="2186998">:=</span>&nbsp;<span class="ident" id="2187001">d</span><span class="op" id="2187002">.</span><span class="ident" id="2187003">floatBits</span><span class="op" id="2187012">(</span><span class="op" id="2187013">&amp;</span><span class="ident" id="2187014">float32info</span><span class="op" id="2187025">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187028">f</span>&nbsp;<span class="op" id="2187030">=</span>&nbsp;<span class="ident" id="2187032">math</span><span class="op" id="2187036">.</span><span class="ident" id="2187037">Float32frombits</span><span class="op" id="2187052">(</span><span class="builtintype" id="2187053">uint32</span><span class="op" id="2187059">(</span><span class="ident" id="2187060">b</span><span class="op" id="2187061">)</span><span class="op" id="2187062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187065">if</span>&nbsp;<span class="ident" id="2187068">ovf</span>&nbsp;<span class="op" id="2187072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187076">err</span>&nbsp;<span class="op" id="2187080">=</span>&nbsp;<span class="ident" id="2187082">rangeError</span><span class="op" id="2187092">(</span><span class="ident" id="2187093">fnParseFloat</span><span class="op" id="2187105">,</span>&nbsp;<span class="ident" id="2187107">s</span><span class="op" id="2187108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187114">return</span>&nbsp;<span class="ident" id="2187121">f</span><span class="op" id="2187122">,</span>&nbsp;<span class="ident" id="2187124">err</span><br>
<span class="lineno">475</span><span class="op" id="2187128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2187131">func</span>&nbsp;<span class="ident" id="2187136">atof64</span><span class="op" id="2187142">(</span><span class="ident" id="2187143">s</span>&nbsp;<span class="builtintype" id="2187145">string</span><span class="op" id="2187151">)</span>&nbsp;<span class="op" id="2187153">(</span><span class="ident" id="2187154">f</span>&nbsp;<span class="builtintype" id="2187156">float64</span><span class="op" id="2187163">,</span>&nbsp;<span class="ident" id="2187165">err</span>&nbsp;<span class="builtintype" id="2187169">error</span><span class="op" id="2187174">)</span>&nbsp;<span class="op" id="2187176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187179">if</span>&nbsp;<span class="ident" id="2187182">val</span><span class="op" id="2187185">,</span>&nbsp;<span class="ident" id="2187187">ok</span>&nbsp;<span class="op" id="2187190">:=</span>&nbsp;<span class="ident" id="2187193">special</span><span class="op" id="2187200">(</span><span class="ident" id="2187201">s</span><span class="op" id="2187202">)</span><span class="op" id="2187203">;</span>&nbsp;<span class="ident" id="2187205">ok</span>&nbsp;<span class="op" id="2187208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187212">return</span>&nbsp;<span class="ident" id="2187219">val</span><span class="op" id="2187222">,</span>&nbsp;<span class="ident" id="2187224">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187233">if</span>&nbsp;<span class="ident" id="2187236">optimize</span>&nbsp;<span class="op" id="2187245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2187249">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187283">mantissa</span><span class="op" id="2187291">,</span>&nbsp;<span class="ident" id="2187293">exp</span><span class="op" id="2187296">,</span>&nbsp;<span class="ident" id="2187298">neg</span><span class="op" id="2187301">,</span>&nbsp;<span class="ident" id="2187303">trunc</span><span class="op" id="2187308">,</span>&nbsp;<span class="ident" id="2187310">ok</span>&nbsp;<span class="op" id="2187313">:=</span>&nbsp;<span class="ident" id="2187316">readFloat</span><span class="op" id="2187325">(</span><span class="ident" id="2187326">s</span><span class="op" id="2187327">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187331">if</span>&nbsp;<span class="ident" id="2187334">ok</span>&nbsp;<span class="op" id="2187337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2187342">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187395">if</span>&nbsp;<span class="op" id="2187398">!</span><span class="ident" id="2187399">trunc</span>&nbsp;<span class="op" id="2187405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187411">if</span>&nbsp;<span class="ident" id="2187414">f</span><span class="op" id="2187415">,</span>&nbsp;<span class="ident" id="2187417">ok</span>&nbsp;<span class="op" id="2187420">:=</span>&nbsp;<span class="ident" id="2187423">atof64exact</span><span class="op" id="2187434">(</span><span class="ident" id="2187435">mantissa</span><span class="op" id="2187443">,</span>&nbsp;<span class="ident" id="2187445">exp</span><span class="op" id="2187448">,</span>&nbsp;<span class="ident" id="2187450">neg</span><span class="op" id="2187453">)</span><span class="op" id="2187454">;</span>&nbsp;<span class="ident" id="2187456">ok</span>&nbsp;<span class="op" id="2187459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187466">return</span>&nbsp;<span class="ident" id="2187473">f</span><span class="op" id="2187474">,</span>&nbsp;<span class="ident" id="2187476">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2187494">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187523">ext</span>&nbsp;<span class="op" id="2187527">:=</span>&nbsp;<span class="builtinfunc" id="2187530">new</span><span class="op" id="2187533">(</span><span class="ident" id="2187534">extFloat</span><span class="op" id="2187542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187547">if</span>&nbsp;<span class="ident" id="2187550">ok</span>&nbsp;<span class="op" id="2187553">:=</span>&nbsp;<span class="ident" id="2187556">ext</span><span class="op" id="2187559">.</span><span class="ident" id="2187560">AssignDecimal</span><span class="op" id="2187573">(</span><span class="ident" id="2187574">mantissa</span><span class="op" id="2187582">,</span>&nbsp;<span class="ident" id="2187584">exp</span><span class="op" id="2187587">,</span>&nbsp;<span class="ident" id="2187589">neg</span><span class="op" id="2187592">,</span>&nbsp;<span class="ident" id="2187594">trunc</span><span class="op" id="2187599">,</span>&nbsp;<span class="op" id="2187601">&amp;</span><span class="ident" id="2187602">float64info</span><span class="op" id="2187613">)</span><span class="op" id="2187614">;</span>&nbsp;<span class="ident" id="2187616">ok</span>&nbsp;<span class="op" id="2187619">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187625">b</span><span class="op" id="2187626">,</span>&nbsp;<span class="ident" id="2187628">ovf</span>&nbsp;<span class="op" id="2187632">:=</span>&nbsp;<span class="ident" id="2187635">ext</span><span class="op" id="2187638">.</span><span class="ident" id="2187639">floatBits</span><span class="op" id="2187648">(</span><span class="op" id="2187649">&amp;</span><span class="ident" id="2187650">float64info</span><span class="op" id="2187661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187667">f</span>&nbsp;<span class="op" id="2187669">=</span>&nbsp;<span class="ident" id="2187671">math</span><span class="op" id="2187675">.</span><span class="ident" id="2187676">Float64frombits</span><span class="op" id="2187691">(</span><span class="ident" id="2187692">b</span><span class="op" id="2187693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187699">if</span>&nbsp;<span class="ident" id="2187702">ovf</span>&nbsp;<span class="op" id="2187706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187713">err</span>&nbsp;<span class="op" id="2187717">=</span>&nbsp;<span class="ident" id="2187719">rangeError</span><span class="op" id="2187729">(</span><span class="ident" id="2187730">fnParseFloat</span><span class="op" id="2187742">,</span>&nbsp;<span class="ident" id="2187744">s</span><span class="op" id="2187745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187751">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187757">return</span>&nbsp;<span class="ident" id="2187764">f</span><span class="op" id="2187765">,</span>&nbsp;<span class="ident" id="2187767">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187784">var</span>&nbsp;<span class="ident" id="2187788">d</span>&nbsp;<span class="ident" id="2187790">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187799">if</span>&nbsp;<span class="op" id="2187802">!</span><span class="ident" id="2187803">d</span><span class="op" id="2187804">.</span><span class="ident" id="2187805">set</span><span class="op" id="2187808">(</span><span class="ident" id="2187809">s</span><span class="op" id="2187810">)</span>&nbsp;<span class="op" id="2187812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187816">return</span>&nbsp;<span class="num" id="2187823">0</span><span class="op" id="2187824">,</span>&nbsp;<span class="ident" id="2187826">syntaxError</span><span class="op" id="2187837">(</span><span class="ident" id="2187838">fnParseFloat</span><span class="op" id="2187850">,</span>&nbsp;<span class="ident" id="2187852">s</span><span class="op" id="2187853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187859">b</span><span class="op" id="2187860">,</span>&nbsp;<span class="ident" id="2187862">ovf</span>&nbsp;<span class="op" id="2187866">:=</span>&nbsp;<span class="ident" id="2187869">d</span><span class="op" id="2187870">.</span><span class="ident" id="2187871">floatBits</span><span class="op" id="2187880">(</span><span class="op" id="2187881">&amp;</span><span class="ident" id="2187882">float64info</span><span class="op" id="2187893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187896">f</span>&nbsp;<span class="op" id="2187898">=</span>&nbsp;<span class="ident" id="2187900">math</span><span class="op" id="2187904">.</span><span class="ident" id="2187905">Float64frombits</span><span class="op" id="2187920">(</span><span class="ident" id="2187921">b</span><span class="op" id="2187922">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187925">if</span>&nbsp;<span class="ident" id="2187928">ovf</span>&nbsp;<span class="op" id="2187932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2187936">err</span>&nbsp;<span class="op" id="2187940">=</span>&nbsp;<span class="ident" id="2187942">rangeError</span><span class="op" id="2187952">(</span><span class="ident" id="2187953">fnParseFloat</span><span class="op" id="2187965">,</span>&nbsp;<span class="ident" id="2187967">s</span><span class="op" id="2187968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2187971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2187974">return</span>&nbsp;<span class="ident" id="2187981">f</span><span class="op" id="2187982">,</span>&nbsp;<span class="ident" id="2187984">err</span><br>
<span class="lineno"></span><span class="op" id="2187988">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2187991">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2188054">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2188133">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2188203">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2188257">//</span><br>
<span class="lineno"></span><span class="comment" id="2188260">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2188323">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2188387">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2188423">//</span><br>
<span class="lineno">525</span><span class="comment" id="2188426">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2188493">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2188521">//</span><br>
<span class="lineno"></span><span class="comment" id="2188524">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2188606">//</span><br>
<span class="lineno">530</span><span class="comment" id="2188609">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2188671">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2188737">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2188790">func</span>&nbsp;<span class="ident" id="2188795">ParseFloat</span><span class="op" id="2188805">(</span><span class="ident" id="2188806">s</span>&nbsp;<span class="builtintype" id="2188808">string</span><span class="op" id="2188814">,</span>&nbsp;<span class="ident" id="2188816">bitSize</span>&nbsp;<span class="builtintype" id="2188824">int</span><span class="op" id="2188827">)</span>&nbsp;<span class="op" id="2188829">(</span><span class="ident" id="2188830">f</span>&nbsp;<span class="builtintype" id="2188832">float64</span><span class="op" id="2188839">,</span>&nbsp;<span class="ident" id="2188841">err</span>&nbsp;<span class="builtintype" id="2188845">error</span><span class="op" id="2188850">)</span>&nbsp;<span class="op" id="2188852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2188855">if</span>&nbsp;<span class="ident" id="2188858">bitSize</span>&nbsp;<span class="op" id="2188866">==</span>&nbsp;<span class="num" id="2188869">32</span>&nbsp;<span class="op" id="2188872">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2188876">f1</span><span class="op" id="2188878">,</span>&nbsp;<span class="ident" id="2188880">err1</span>&nbsp;<span class="op" id="2188885">:=</span>&nbsp;<span class="ident" id="2188888">atof32</span><span class="op" id="2188894">(</span><span class="ident" id="2188895">s</span><span class="op" id="2188896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2188900">return</span>&nbsp;<span class="builtintype" id="2188907">float64</span><span class="op" id="2188914">(</span><span class="ident" id="2188915">f1</span><span class="op" id="2188917">)</span><span class="op" id="2188918">,</span>&nbsp;<span class="ident" id="2188920">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2188926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2188929">f1</span><span class="op" id="2188931">,</span>&nbsp;<span class="ident" id="2188933">err1</span>&nbsp;<span class="op" id="2188938">:=</span>&nbsp;<span class="ident" id="2188941">atof64</span><span class="op" id="2188947">(</span><span class="ident" id="2188948">s</span><span class="op" id="2188949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2188952">return</span>&nbsp;<span class="ident" id="2188959">f1</span><span class="op" id="2188961">,</span>&nbsp;<span class="ident" id="2188963">err1</span><br>
<span class="lineno">540</span><span class="op" id="2188968">}</span>
</div>
</body>
</html>
