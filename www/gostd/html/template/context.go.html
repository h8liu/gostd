<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3478714">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3478769">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3478823">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3478874">package</span>&nbsp;<span class="ident" id="3478882">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478892">import</span>&nbsp;<span class="op" id="3478899">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3478902">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="3478908">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3478911">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3478988">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="3479058">//</span><br>
<span class="lineno"></span><span class="comment" id="3479061">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="3479136">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="3479179">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="3479229">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="3479267">type</span>&nbsp;<span class="ident" id="3479272">context</span>&nbsp;<span class="keyword" id="3479280">struct</span>&nbsp;<span class="op" id="3479287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479290">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3479298">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479305">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3479313">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479320">urlPart</span>&nbsp;<span class="ident" id="3479328">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479337">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3479345">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479352">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479360">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479366">element</span>&nbsp;<span class="ident" id="3479374">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479383">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479391">*</span><span class="ident" id="3479392">Error</span><br>
<span class="lineno"></span><span class="op" id="3479398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479401">func</span>&nbsp;<span class="op" id="3479406">(</span><span class="ident" id="3479407">c</span>&nbsp;<span class="ident" id="3479409">context</span><span class="op" id="3479416">)</span>&nbsp;<span class="ident" id="3479418">String</span><span class="op" id="3479424">(</span><span class="op" id="3479425">)</span>&nbsp;<span class="builtintype" id="3479427">string</span>&nbsp;<span class="op" id="3479434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479437">return</span>&nbsp;<span class="ident" id="3479444">fmt</span><span class="op" id="3479447">.</span><span class="ident" id="3479448">Sprintf</span><span class="op" id="3479455">(</span><span class="string" id="3479456">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="3479480">,</span>&nbsp;<span class="ident" id="3479482">c</span><span class="op" id="3479483">.</span><span class="ident" id="3479484">state</span><span class="op" id="3479489">,</span>&nbsp;<span class="ident" id="3479491">c</span><span class="op" id="3479492">.</span><span class="ident" id="3479493">delim</span><span class="op" id="3479498">,</span>&nbsp;<span class="ident" id="3479500">c</span><span class="op" id="3479501">.</span><span class="ident" id="3479502">urlPart</span><span class="op" id="3479509">,</span>&nbsp;<span class="ident" id="3479511">c</span><span class="op" id="3479512">.</span><span class="ident" id="3479513">jsCtx</span><span class="op" id="3479518">,</span>&nbsp;<span class="ident" id="3479520">c</span><span class="op" id="3479521">.</span><span class="ident" id="3479522">attr</span><span class="op" id="3479526">,</span>&nbsp;<span class="ident" id="3479528">c</span><span class="op" id="3479529">.</span><span class="ident" id="3479530">element</span><span class="op" id="3479537">,</span>&nbsp;<span class="ident" id="3479539">c</span><span class="op" id="3479540">.</span><span class="ident" id="3479541">err</span><span class="op" id="3479544">)</span><br>
<span class="lineno">30</span><span class="op" id="3479546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479549">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3479595">func</span>&nbsp;<span class="op" id="3479600">(</span><span class="ident" id="3479601">c</span>&nbsp;<span class="ident" id="3479603">context</span><span class="op" id="3479610">)</span>&nbsp;<span class="ident" id="3479612">eq</span><span class="op" id="3479614">(</span><span class="ident" id="3479615">d</span>&nbsp;<span class="ident" id="3479617">context</span><span class="op" id="3479624">)</span>&nbsp;<span class="builtintype" id="3479626">bool</span>&nbsp;<span class="op" id="3479631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479634">return</span>&nbsp;<span class="ident" id="3479641">c</span><span class="op" id="3479642">.</span><span class="ident" id="3479643">state</span>&nbsp;<span class="op" id="3479649">==</span>&nbsp;<span class="ident" id="3479652">d</span><span class="op" id="3479653">.</span><span class="ident" id="3479654">state</span>&nbsp;<span class="op" id="3479660">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479665">c</span><span class="op" id="3479666">.</span><span class="ident" id="3479667">delim</span>&nbsp;<span class="op" id="3479673">==</span>&nbsp;<span class="ident" id="3479676">d</span><span class="op" id="3479677">.</span><span class="ident" id="3479678">delim</span>&nbsp;<span class="op" id="3479684">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479689">c</span><span class="op" id="3479690">.</span><span class="ident" id="3479691">urlPart</span>&nbsp;<span class="op" id="3479699">==</span>&nbsp;<span class="ident" id="3479702">d</span><span class="op" id="3479703">.</span><span class="ident" id="3479704">urlPart</span>&nbsp;<span class="op" id="3479712">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479717">c</span><span class="op" id="3479718">.</span><span class="ident" id="3479719">jsCtx</span>&nbsp;<span class="op" id="3479725">==</span>&nbsp;<span class="ident" id="3479728">d</span><span class="op" id="3479729">.</span><span class="ident" id="3479730">jsCtx</span>&nbsp;<span class="op" id="3479736">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479741">c</span><span class="op" id="3479742">.</span><span class="ident" id="3479743">attr</span>&nbsp;<span class="op" id="3479748">==</span>&nbsp;<span class="ident" id="3479751">d</span><span class="op" id="3479752">.</span><span class="ident" id="3479753">attr</span>&nbsp;<span class="op" id="3479758">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479763">c</span><span class="op" id="3479764">.</span><span class="ident" id="3479765">element</span>&nbsp;<span class="op" id="3479773">==</span>&nbsp;<span class="ident" id="3479776">d</span><span class="op" id="3479777">.</span><span class="ident" id="3479778">element</span>&nbsp;<span class="op" id="3479786">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479791">c</span><span class="op" id="3479792">.</span><span class="ident" id="3479793">err</span>&nbsp;<span class="op" id="3479797">==</span>&nbsp;<span class="ident" id="3479800">d</span><span class="op" id="3479801">.</span><span class="ident" id="3479802">err</span><br>
<span class="lineno"></span><span class="op" id="3479806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479809">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3479887">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="3479943">func</span>&nbsp;<span class="op" id="3479948">(</span><span class="ident" id="3479949">c</span>&nbsp;<span class="ident" id="3479951">context</span><span class="op" id="3479958">)</span>&nbsp;<span class="ident" id="3479960">mangle</span><span class="op" id="3479966">(</span><span class="ident" id="3479967">templateName</span>&nbsp;<span class="builtintype" id="3479980">string</span><span class="op" id="3479986">)</span>&nbsp;<span class="builtintype" id="3479988">string</span>&nbsp;<span class="op" id="3479995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479998">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480070">if</span>&nbsp;<span class="ident" id="3480073">c</span><span class="op" id="3480074">.</span><span class="ident" id="3480075">state</span>&nbsp;<span class="op" id="3480081">==</span>&nbsp;<span class="ident" id="3480084">stateText</span>&nbsp;<span class="op" id="3480094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480098">return</span>&nbsp;<span class="ident" id="3480105">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480119">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480122">s</span>&nbsp;<span class="op" id="3480124">:=</span>&nbsp;<span class="ident" id="3480127">templateName</span>&nbsp;<span class="op" id="3480140">+</span>&nbsp;<span class="string" id="3480142">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="3480159">+</span>&nbsp;<span class="ident" id="3480161">c</span><span class="op" id="3480162">.</span><span class="ident" id="3480163">state</span><span class="op" id="3480168">.</span><span class="ident" id="3480169">String</span><span class="op" id="3480175">(</span><span class="op" id="3480176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480179">if</span>&nbsp;<span class="ident" id="3480182">c</span><span class="op" id="3480183">.</span><span class="ident" id="3480184">delim</span>&nbsp;<span class="op" id="3480190">!=</span>&nbsp;<span class="num" id="3480193">0</span>&nbsp;<span class="op" id="3480195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480199">s</span>&nbsp;<span class="op" id="3480201">+=</span>&nbsp;<span class="string" id="3480204">&#34;_&#34;</span>&nbsp;<span class="op" id="3480208">+</span>&nbsp;<span class="ident" id="3480210">c</span><span class="op" id="3480211">.</span><span class="ident" id="3480212">delim</span><span class="op" id="3480217">.</span><span class="ident" id="3480218">String</span><span class="op" id="3480224">(</span><span class="op" id="3480225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480231">if</span>&nbsp;<span class="ident" id="3480234">c</span><span class="op" id="3480235">.</span><span class="ident" id="3480236">urlPart</span>&nbsp;<span class="op" id="3480244">!=</span>&nbsp;<span class="num" id="3480247">0</span>&nbsp;<span class="op" id="3480249">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480253">s</span>&nbsp;<span class="op" id="3480255">+=</span>&nbsp;<span class="string" id="3480258">&#34;_&#34;</span>&nbsp;<span class="op" id="3480262">+</span>&nbsp;<span class="ident" id="3480264">c</span><span class="op" id="3480265">.</span><span class="ident" id="3480266">urlPart</span><span class="op" id="3480273">.</span><span class="ident" id="3480274">String</span><span class="op" id="3480280">(</span><span class="op" id="3480281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480287">if</span>&nbsp;<span class="ident" id="3480290">c</span><span class="op" id="3480291">.</span><span class="ident" id="3480292">jsCtx</span>&nbsp;<span class="op" id="3480298">!=</span>&nbsp;<span class="num" id="3480301">0</span>&nbsp;<span class="op" id="3480303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480307">s</span>&nbsp;<span class="op" id="3480309">+=</span>&nbsp;<span class="string" id="3480312">&#34;_&#34;</span>&nbsp;<span class="op" id="3480316">+</span>&nbsp;<span class="ident" id="3480318">c</span><span class="op" id="3480319">.</span><span class="ident" id="3480320">jsCtx</span><span class="op" id="3480325">.</span><span class="ident" id="3480326">String</span><span class="op" id="3480332">(</span><span class="op" id="3480333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480336">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480339">if</span>&nbsp;<span class="ident" id="3480342">c</span><span class="op" id="3480343">.</span><span class="ident" id="3480344">attr</span>&nbsp;<span class="op" id="3480349">!=</span>&nbsp;<span class="num" id="3480352">0</span>&nbsp;<span class="op" id="3480354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480358">s</span>&nbsp;<span class="op" id="3480360">+=</span>&nbsp;<span class="string" id="3480363">&#34;_&#34;</span>&nbsp;<span class="op" id="3480367">+</span>&nbsp;<span class="ident" id="3480369">c</span><span class="op" id="3480370">.</span><span class="ident" id="3480371">attr</span><span class="op" id="3480375">.</span><span class="ident" id="3480376">String</span><span class="op" id="3480382">(</span><span class="op" id="3480383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480389">if</span>&nbsp;<span class="ident" id="3480392">c</span><span class="op" id="3480393">.</span><span class="ident" id="3480394">element</span>&nbsp;<span class="op" id="3480402">!=</span>&nbsp;<span class="num" id="3480405">0</span>&nbsp;<span class="op" id="3480407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480411">s</span>&nbsp;<span class="op" id="3480413">+=</span>&nbsp;<span class="string" id="3480416">&#34;_&#34;</span>&nbsp;<span class="op" id="3480420">+</span>&nbsp;<span class="ident" id="3480422">c</span><span class="op" id="3480423">.</span><span class="ident" id="3480424">element</span><span class="op" id="3480431">.</span><span class="ident" id="3480432">String</span><span class="op" id="3480438">(</span><span class="op" id="3480439">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480445">return</span>&nbsp;<span class="ident" id="3480452">s</span><br>
<span class="lineno"></span><span class="op" id="3480454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3480457">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="3480508">//</span><br>
<span class="lineno"></span><span class="comment" id="3480511">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="3480590">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3480667">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="3480740">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="3480820">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3480850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="3480888">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3480966">type</span>&nbsp;<span class="ident" id="3480971">state</span>&nbsp;<span class="builtintype" id="3480977">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="3480984">const</span>&nbsp;<span class="op" id="3480990">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3480993">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481054">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481117">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481167">stateText</span>&nbsp;<span class="ident" id="3481177">state</span>&nbsp;<span class="op" id="3481183">=</span>&nbsp;<span class="ident" id="3481185">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481191">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481257">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481267">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481318">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481370">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481385">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481455">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481520">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481536">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481608">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481660">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481678">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481735">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481749">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481821">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481891">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481904">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481973">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481984">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482053">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482063">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482125">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482134">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482200">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482214">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482280">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482294">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482355">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482370">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482438">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482455">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482518">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482534">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482599">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482609">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482669">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482684">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482744">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482759">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482823">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482838">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482902">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482917">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482972">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482985">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483047">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3483065">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483122">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3483139">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3483201">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483228">stateError</span><br>
<span class="lineno"></span><span class="op" id="3483239">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3483242">var</span>&nbsp;<span class="ident" id="3483246">stateNames</span>&nbsp;<span class="op" id="3483257">=</span>&nbsp;<span class="op" id="3483259">[</span><span class="op" id="3483260">...</span><span class="op" id="3483263">]</span><span class="builtintype" id="3483264">string</span><span class="op" id="3483270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483273">stateText</span><span class="op" id="3483282">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483291">&#34;stateText&#34;</span><span class="op" id="3483302">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483305">stateTag</span><span class="op" id="3483313">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483323">&#34;stateTag&#34;</span><span class="op" id="3483333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483336">stateAttrName</span><span class="op" id="3483349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483354">&#34;stateAttrName&#34;</span><span class="op" id="3483369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483372">stateAfterName</span><span class="op" id="3483386">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3483390">&#34;stateAfterName&#34;</span><span class="op" id="3483406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483409">stateBeforeValue</span><span class="op" id="3483425">:</span>&nbsp;<span class="string" id="3483427">&#34;stateBeforeValue&#34;</span><span class="op" id="3483445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483448">stateHTMLCmt</span><span class="op" id="3483460">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483466">&#34;stateHTMLCmt&#34;</span><span class="op" id="3483480">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483483">stateRCDATA</span><span class="op" id="3483494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483501">&#34;stateRCDATA&#34;</span><span class="op" id="3483514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483517">stateAttr</span><span class="op" id="3483526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483535">&#34;stateAttr&#34;</span><span class="op" id="3483546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483549">stateURL</span><span class="op" id="3483557">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483567">&#34;stateURL&#34;</span><span class="op" id="3483577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483580">stateJS</span><span class="op" id="3483587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483598">&#34;stateJS&#34;</span><span class="op" id="3483607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483610">stateJSDqStr</span><span class="op" id="3483622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483628">&#34;stateJSDqStr&#34;</span><span class="op" id="3483642">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483645">stateJSSqStr</span><span class="op" id="3483657">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483663">&#34;stateJSSqStr&#34;</span><span class="op" id="3483677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483680">stateJSRegexp</span><span class="op" id="3483693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483698">&#34;stateJSRegexp&#34;</span><span class="op" id="3483713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483716">stateJSBlockCmt</span><span class="op" id="3483731">:</span>&nbsp;&nbsp;<span class="string" id="3483734">&#34;stateJSBlockCmt&#34;</span><span class="op" id="3483751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483754">stateJSLineCmt</span><span class="op" id="3483768">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3483772">&#34;stateJSLineCmt&#34;</span><span class="op" id="3483788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483791">stateCSS</span><span class="op" id="3483799">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483809">&#34;stateCSS&#34;</span><span class="op" id="3483819">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483822">stateCSSDqStr</span><span class="op" id="3483835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483840">&#34;stateCSSDqStr&#34;</span><span class="op" id="3483855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483858">stateCSSSqStr</span><span class="op" id="3483871">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483876">&#34;stateCSSSqStr&#34;</span><span class="op" id="3483891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483894">stateCSSDqURL</span><span class="op" id="3483907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483912">&#34;stateCSSDqURL&#34;</span><span class="op" id="3483927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483930">stateCSSSqURL</span><span class="op" id="3483943">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483948">&#34;stateCSSSqURL&#34;</span><span class="op" id="3483963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483966">stateCSSURL</span><span class="op" id="3483977">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3483984">&#34;stateCSSURL&#34;</span><span class="op" id="3483997">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484000">stateCSSBlockCmt</span><span class="op" id="3484016">:</span>&nbsp;<span class="string" id="3484018">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="3484036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484039">stateCSSLineCmt</span><span class="op" id="3484054">:</span>&nbsp;&nbsp;<span class="string" id="3484057">&#34;stateCSSLineCmt&#34;</span><span class="op" id="3484074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484077">stateError</span><span class="op" id="3484087">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3484095">&#34;stateError&#34;</span><span class="op" id="3484107">,</span><br>
<span class="lineno"></span><span class="op" id="3484109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="3484112">func</span>&nbsp;<span class="op" id="3484117">(</span><span class="ident" id="3484118">s</span>&nbsp;<span class="ident" id="3484120">state</span><span class="op" id="3484125">)</span>&nbsp;<span class="ident" id="3484127">String</span><span class="op" id="3484133">(</span><span class="op" id="3484134">)</span>&nbsp;<span class="builtintype" id="3484136">string</span>&nbsp;<span class="op" id="3484143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484146">if</span>&nbsp;<span class="builtintype" id="3484149">int</span><span class="op" id="3484152">(</span><span class="ident" id="3484153">s</span><span class="op" id="3484154">)</span>&nbsp;<span class="op" id="3484156">&lt;</span>&nbsp;<span class="builtinfunc" id="3484158">len</span><span class="op" id="3484161">(</span><span class="ident" id="3484162">stateNames</span><span class="op" id="3484172">)</span>&nbsp;<span class="op" id="3484174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484178">return</span>&nbsp;<span class="ident" id="3484185">stateNames</span><span class="op" id="3484195">[</span><span class="ident" id="3484196">s</span><span class="op" id="3484197">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484203">return</span>&nbsp;<span class="ident" id="3484210">fmt</span><span class="op" id="3484213">.</span><span class="ident" id="3484214">Sprintf</span><span class="op" id="3484221">(</span><span class="string" id="3484222">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="3484240">,</span>&nbsp;<span class="builtintype" id="3484242">int</span><span class="op" id="3484245">(</span><span class="ident" id="3484246">s</span><span class="op" id="3484247">)</span><span class="op" id="3484248">)</span><br>
<span class="lineno">170</span><span class="op" id="3484250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3484253">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="3484329">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="3484386">func</span>&nbsp;<span class="ident" id="3484391">isComment</span><span class="op" id="3484400">(</span><span class="ident" id="3484401">s</span>&nbsp;<span class="ident" id="3484403">state</span><span class="op" id="3484408">)</span>&nbsp;<span class="builtintype" id="3484410">bool</span>&nbsp;<span class="op" id="3484415">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484418">switch</span>&nbsp;<span class="ident" id="3484425">s</span>&nbsp;<span class="op" id="3484427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484430">case</span>&nbsp;<span class="ident" id="3484435">stateHTMLCmt</span><span class="op" id="3484447">,</span>&nbsp;<span class="ident" id="3484449">stateJSBlockCmt</span><span class="op" id="3484464">,</span>&nbsp;<span class="ident" id="3484466">stateJSLineCmt</span><span class="op" id="3484480">,</span>&nbsp;<span class="ident" id="3484482">stateCSSBlockCmt</span><span class="op" id="3484498">,</span>&nbsp;<span class="ident" id="3484500">stateCSSLineCmt</span><span class="op" id="3484515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484519">return</span>&nbsp;<span class="builtintype" id="3484526">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484535">return</span>&nbsp;<span class="builtintype" id="3484542">false</span><br>
<span class="lineno">180</span><span class="op" id="3484548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3484551">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="3484613">func</span>&nbsp;<span class="ident" id="3484618">isInTag</span><span class="op" id="3484625">(</span><span class="ident" id="3484626">s</span>&nbsp;<span class="ident" id="3484628">state</span><span class="op" id="3484633">)</span>&nbsp;<span class="builtintype" id="3484635">bool</span>&nbsp;<span class="op" id="3484640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484643">switch</span>&nbsp;<span class="ident" id="3484650">s</span>&nbsp;<span class="op" id="3484652">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484655">case</span>&nbsp;<span class="ident" id="3484660">stateTag</span><span class="op" id="3484668">,</span>&nbsp;<span class="ident" id="3484670">stateAttrName</span><span class="op" id="3484683">,</span>&nbsp;<span class="ident" id="3484685">stateAfterName</span><span class="op" id="3484699">,</span>&nbsp;<span class="ident" id="3484701">stateBeforeValue</span><span class="op" id="3484717">,</span>&nbsp;<span class="ident" id="3484719">stateAttr</span><span class="op" id="3484728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484732">return</span>&nbsp;<span class="builtintype" id="3484739">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484748">return</span>&nbsp;<span class="builtintype" id="3484755">false</span><br>
<span class="lineno"></span><span class="op" id="3484761">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3484764">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="3484832">type</span>&nbsp;<span class="ident" id="3484837">delim</span>&nbsp;<span class="builtintype" id="3484843">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484850">const</span>&nbsp;<span class="op" id="3484856">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3484859">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484903">delimNone</span>&nbsp;<span class="ident" id="3484913">delim</span>&nbsp;<span class="op" id="3484919">=</span>&nbsp;<span class="ident" id="3484921">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3484927">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485001">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485019">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485093">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485111">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485181">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485207">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="3485226">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3485229">var</span>&nbsp;<span class="ident" id="3485233">delimNames</span>&nbsp;<span class="op" id="3485244">=</span>&nbsp;<span class="op" id="3485246">[</span><span class="op" id="3485247">...</span><span class="op" id="3485250">]</span><span class="builtintype" id="3485251">string</span><span class="op" id="3485257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485260">delimNone</span><span class="op" id="3485269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3485280">&#34;delimNone&#34;</span><span class="op" id="3485291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485294">delimDoubleQuote</span><span class="op" id="3485310">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3485314">&#34;delimDoubleQuote&#34;</span><span class="op" id="3485332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485335">delimSingleQuote</span><span class="op" id="3485351">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3485355">&#34;delimSingleQuote&#34;</span><span class="op" id="3485373">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485376">delimSpaceOrTagEnd</span><span class="op" id="3485394">:</span>&nbsp;<span class="string" id="3485396">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="3485416">,</span><br>
<span class="lineno"></span><span class="op" id="3485418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3485421">func</span>&nbsp;<span class="op" id="3485426">(</span><span class="ident" id="3485427">d</span>&nbsp;<span class="ident" id="3485429">delim</span><span class="op" id="3485434">)</span>&nbsp;<span class="ident" id="3485436">String</span><span class="op" id="3485442">(</span><span class="op" id="3485443">)</span>&nbsp;<span class="builtintype" id="3485445">string</span>&nbsp;<span class="op" id="3485452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3485455">if</span>&nbsp;<span class="builtintype" id="3485458">int</span><span class="op" id="3485461">(</span><span class="ident" id="3485462">d</span><span class="op" id="3485463">)</span>&nbsp;<span class="op" id="3485465">&lt;</span>&nbsp;<span class="builtinfunc" id="3485467">len</span><span class="op" id="3485470">(</span><span class="ident" id="3485471">delimNames</span><span class="op" id="3485481">)</span>&nbsp;<span class="op" id="3485483">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3485487">return</span>&nbsp;<span class="ident" id="3485494">delimNames</span><span class="op" id="3485504">[</span><span class="ident" id="3485505">d</span><span class="op" id="3485506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3485509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3485512">return</span>&nbsp;<span class="ident" id="3485519">fmt</span><span class="op" id="3485522">.</span><span class="ident" id="3485523">Sprintf</span><span class="op" id="3485530">(</span><span class="string" id="3485531">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="3485549">,</span>&nbsp;<span class="builtintype" id="3485551">int</span><span class="op" id="3485554">(</span><span class="ident" id="3485555">d</span><span class="op" id="3485556">)</span><span class="op" id="3485557">)</span><br>
<span class="lineno"></span><span class="op" id="3485559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3485562">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3485642">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="3485666">type</span>&nbsp;<span class="ident" id="3485671">urlPart</span>&nbsp;<span class="builtintype" id="3485679">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3485686">const</span>&nbsp;<span class="op" id="3485692">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485695">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485763">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485802">urlPartNone</span>&nbsp;<span class="ident" id="3485814">urlPart</span>&nbsp;<span class="op" id="3485822">=</span>&nbsp;<span class="ident" id="3485824">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485830">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485904">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485945">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3485962">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486031">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486066">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486086">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486155">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486186">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="3486201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3486204">var</span>&nbsp;<span class="ident" id="3486208">urlPartNames</span>&nbsp;<span class="op" id="3486221">=</span>&nbsp;<span class="op" id="3486223">[</span><span class="op" id="3486224">...</span><span class="op" id="3486227">]</span><span class="builtintype" id="3486228">string</span><span class="op" id="3486234">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486237">urlPartNone</span><span class="op" id="3486248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3486257">&#34;urlPartNone&#34;</span><span class="op" id="3486270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486273">urlPartPreQuery</span><span class="op" id="3486288">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3486293">&#34;urlPartPreQuery&#34;</span><span class="op" id="3486310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486313">urlPartQueryOrFrag</span><span class="op" id="3486331">:</span>&nbsp;<span class="string" id="3486333">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="3486353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486356">urlPartUnknown</span><span class="op" id="3486370">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3486376">&#34;urlPartUnknown&#34;</span><span class="op" id="3486392">,</span><br>
<span class="lineno"></span><span class="op" id="3486394">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="3486397">func</span>&nbsp;<span class="op" id="3486402">(</span><span class="ident" id="3486403">u</span>&nbsp;<span class="ident" id="3486405">urlPart</span><span class="op" id="3486412">)</span>&nbsp;<span class="ident" id="3486414">String</span><span class="op" id="3486420">(</span><span class="op" id="3486421">)</span>&nbsp;<span class="builtintype" id="3486423">string</span>&nbsp;<span class="op" id="3486430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486433">if</span>&nbsp;<span class="builtintype" id="3486436">int</span><span class="op" id="3486439">(</span><span class="ident" id="3486440">u</span><span class="op" id="3486441">)</span>&nbsp;<span class="op" id="3486443">&lt;</span>&nbsp;<span class="builtinfunc" id="3486445">len</span><span class="op" id="3486448">(</span><span class="ident" id="3486449">urlPartNames</span><span class="op" id="3486461">)</span>&nbsp;<span class="op" id="3486463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486467">return</span>&nbsp;<span class="ident" id="3486474">urlPartNames</span><span class="op" id="3486486">[</span><span class="ident" id="3486487">u</span><span class="op" id="3486488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486491">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486494">return</span>&nbsp;<span class="ident" id="3486501">fmt</span><span class="op" id="3486504">.</span><span class="ident" id="3486505">Sprintf</span><span class="op" id="3486512">(</span><span class="string" id="3486513">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="3486533">,</span>&nbsp;<span class="builtintype" id="3486535">int</span><span class="op" id="3486538">(</span><span class="ident" id="3486539">u</span><span class="op" id="3486540">)</span><span class="op" id="3486541">)</span><br>
<span class="lineno"></span><span class="op" id="3486543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3486546">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3486621">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="3486643">type</span>&nbsp;<span class="ident" id="3486648">jsCtx</span>&nbsp;<span class="builtintype" id="3486654">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3486661">const</span>&nbsp;<span class="op" id="3486667">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486670">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486735">jsCtxRegexp</span>&nbsp;<span class="ident" id="3486747">jsCtx</span>&nbsp;<span class="op" id="3486753">=</span>&nbsp;<span class="ident" id="3486755">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486761">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486828">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486840">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486913">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="3486926">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="3486929">func</span>&nbsp;<span class="op" id="3486934">(</span><span class="ident" id="3486935">c</span>&nbsp;<span class="ident" id="3486937">jsCtx</span><span class="op" id="3486942">)</span>&nbsp;<span class="ident" id="3486944">String</span><span class="op" id="3486950">(</span><span class="op" id="3486951">)</span>&nbsp;<span class="builtintype" id="3486953">string</span>&nbsp;<span class="op" id="3486960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486963">switch</span>&nbsp;<span class="ident" id="3486970">c</span>&nbsp;<span class="op" id="3486972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486975">case</span>&nbsp;<span class="ident" id="3486980">jsCtxRegexp</span><span class="op" id="3486991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486995">return</span>&nbsp;<span class="string" id="3487002">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487017">case</span>&nbsp;<span class="ident" id="3487022">jsCtxDivOp</span><span class="op" id="3487032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487036">return</span>&nbsp;<span class="string" id="3487043">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487057">case</span>&nbsp;<span class="ident" id="3487062">jsCtxUnknown</span><span class="op" id="3487074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487078">return</span>&nbsp;<span class="string" id="3487085">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487101">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487104">return</span>&nbsp;<span class="ident" id="3487111">fmt</span><span class="op" id="3487114">.</span><span class="ident" id="3487115">Sprintf</span><span class="op" id="3487122">(</span><span class="string" id="3487123">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="3487141">,</span>&nbsp;<span class="builtintype" id="3487143">int</span><span class="op" id="3487146">(</span><span class="ident" id="3487147">c</span><span class="op" id="3487148">)</span><span class="op" id="3487149">)</span><br>
<span class="lineno"></span><span class="op" id="3487151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3487154">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3487234">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="3487314">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3487388">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3487467">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="3487498">type</span>&nbsp;<span class="ident" id="3487503">element</span>&nbsp;<span class="builtintype" id="3487511">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3487518">const</span>&nbsp;<span class="op" id="3487524">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487527">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487597">elementNone</span>&nbsp;<span class="ident" id="3487609">element</span>&nbsp;<span class="op" id="3487617">=</span>&nbsp;<span class="ident" id="3487619">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487625">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487689">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487704">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487766">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487780">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487846">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487863">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487923">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="3487936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3487939">var</span>&nbsp;<span class="ident" id="3487943">elementNames</span>&nbsp;<span class="op" id="3487956">=</span>&nbsp;<span class="op" id="3487958">[</span><span class="op" id="3487959">...</span><span class="op" id="3487962">]</span><span class="builtintype" id="3487963">string</span><span class="op" id="3487969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487972">elementNone</span><span class="op" id="3487983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3487989">&#34;elementNone&#34;</span><span class="op" id="3488002">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488005">elementScript</span><span class="op" id="3488018">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3488022">&#34;elementScript&#34;</span><span class="op" id="3488037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488040">elementStyle</span><span class="op" id="3488052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3488057">&#34;elementStyle&#34;</span><span class="op" id="3488071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488074">elementTextarea</span><span class="op" id="3488089">:</span>&nbsp;<span class="string" id="3488091">&#34;elementTextarea&#34;</span><span class="op" id="3488108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488111">elementTitle</span><span class="op" id="3488123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3488128">&#34;elementTitle&#34;</span><span class="op" id="3488142">,</span><br>
<span class="lineno"></span><span class="op" id="3488144">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="3488147">func</span>&nbsp;<span class="op" id="3488152">(</span><span class="ident" id="3488153">e</span>&nbsp;<span class="ident" id="3488155">element</span><span class="op" id="3488162">)</span>&nbsp;<span class="ident" id="3488164">String</span><span class="op" id="3488170">(</span><span class="op" id="3488171">)</span>&nbsp;<span class="builtintype" id="3488173">string</span>&nbsp;<span class="op" id="3488180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488183">if</span>&nbsp;<span class="builtintype" id="3488186">int</span><span class="op" id="3488189">(</span><span class="ident" id="3488190">e</span><span class="op" id="3488191">)</span>&nbsp;<span class="op" id="3488193">&lt;</span>&nbsp;<span class="builtinfunc" id="3488195">len</span><span class="op" id="3488198">(</span><span class="ident" id="3488199">elementNames</span><span class="op" id="3488211">)</span>&nbsp;<span class="op" id="3488213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488217">return</span>&nbsp;<span class="ident" id="3488224">elementNames</span><span class="op" id="3488236">[</span><span class="ident" id="3488237">e</span><span class="op" id="3488238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488241">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488244">return</span>&nbsp;<span class="ident" id="3488251">fmt</span><span class="op" id="3488254">.</span><span class="ident" id="3488255">Sprintf</span><span class="op" id="3488262">(</span><span class="string" id="3488263">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="3488283">,</span>&nbsp;<span class="builtintype" id="3488285">int</span><span class="op" id="3488288">(</span><span class="ident" id="3488289">e</span><span class="op" id="3488290">)</span><span class="op" id="3488291">)</span><br>
<span class="lineno"></span><span class="op" id="3488293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3488296">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="3488371">type</span>&nbsp;<span class="ident" id="3488376">attr</span>&nbsp;<span class="builtintype" id="3488381">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3488388">const</span>&nbsp;<span class="op" id="3488394">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3488397">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488461">attrNone</span>&nbsp;<span class="ident" id="3488470">attr</span>&nbsp;<span class="op" id="3488475">=</span>&nbsp;<span class="ident" id="3488477">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3488483">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488541">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3488553">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488622">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3488633">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488695">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="3488703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488706">var</span>&nbsp;<span class="ident" id="3488710">attrNames</span>&nbsp;<span class="op" id="3488720">=</span>&nbsp;<span class="op" id="3488722">[</span><span class="op" id="3488723">...</span><span class="op" id="3488726">]</span><span class="builtintype" id="3488727">string</span><span class="op" id="3488733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488736">attrNone</span><span class="op" id="3488744">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3488748">&#34;attrNone&#34;</span><span class="op" id="3488758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488761">attrScript</span><span class="op" id="3488771">:</span>&nbsp;<span class="string" id="3488773">&#34;attrScript&#34;</span><span class="op" id="3488785">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488788">attrStyle</span><span class="op" id="3488797">:</span>&nbsp;&nbsp;<span class="string" id="3488800">&#34;attrStyle&#34;</span><span class="op" id="3488811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488814">attrURL</span><span class="op" id="3488821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3488826">&#34;attrURL&#34;</span><span class="op" id="3488835">,</span><br>
<span class="lineno"></span><span class="op" id="3488837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488840">func</span>&nbsp;<span class="op" id="3488845">(</span><span class="ident" id="3488846">a</span>&nbsp;<span class="ident" id="3488848">attr</span><span class="op" id="3488852">)</span>&nbsp;<span class="ident" id="3488854">String</span><span class="op" id="3488860">(</span><span class="op" id="3488861">)</span>&nbsp;<span class="builtintype" id="3488863">string</span>&nbsp;<span class="op" id="3488870">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488873">if</span>&nbsp;<span class="builtintype" id="3488876">int</span><span class="op" id="3488879">(</span><span class="ident" id="3488880">a</span><span class="op" id="3488881">)</span>&nbsp;<span class="op" id="3488883">&lt;</span>&nbsp;<span class="builtinfunc" id="3488885">len</span><span class="op" id="3488888">(</span><span class="ident" id="3488889">attrNames</span><span class="op" id="3488898">)</span>&nbsp;<span class="op" id="3488900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488904">return</span>&nbsp;<span class="ident" id="3488911">attrNames</span><span class="op" id="3488920">[</span><span class="ident" id="3488921">a</span><span class="op" id="3488922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488928">return</span>&nbsp;<span class="ident" id="3488935">fmt</span><span class="op" id="3488938">.</span><span class="ident" id="3488939">Sprintf</span><span class="op" id="3488946">(</span><span class="string" id="3488947">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="3488964">,</span>&nbsp;<span class="builtintype" id="3488966">int</span><span class="op" id="3488969">(</span><span class="ident" id="3488970">a</span><span class="op" id="3488971">)</span><span class="op" id="3488972">)</span><br>
<span class="lineno"></span><span class="op" id="3488974">}</span>
</div>
</body>
</html>
