<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2604931">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2604986">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2605040">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2605091">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2605165">//</span><br>
<span class="lineno"></span><span class="comment" id="2605168">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2605236">package</span>&nbsp;<span class="ident" id="2605244">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2605250">import</span>&nbsp;<span class="string" id="2605257">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2605267">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2605334">//</span><br>
<span class="lineno"></span><span class="comment" id="2605337">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2605409">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2605482">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2605546">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2605585">//</span><br>
<span class="lineno"></span><span class="comment" id="2605588">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2605665">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2605729">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2605793">//</span><br>
<span class="lineno"></span><span class="comment" id="2605796">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2605873">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2605949">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2606027">//</span><br>
<span class="lineno"></span><span class="comment" id="2606030">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2606107">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2606188">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2606262">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2606342">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2606420">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2606469">//</span><br>
<span class="lineno"></span><span class="comment" id="2606472">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2606552">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2606631">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2606710">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2606783">//</span><br>
<span class="lineno"></span><span class="keyword" id="2606786">type</span>&nbsp;<span class="ident" id="2606791">Time</span>&nbsp;<span class="keyword" id="2606796">struct</span>&nbsp;<span class="op" id="2606803">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606806">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606856">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606892">sec</span>&nbsp;<span class="ident" id="2606896">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606904">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606949">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2606996">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2607040">nsec</span>&nbsp;<span class="builtintype" id="2607045">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2607053">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2607107">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2607160">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2607194">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2607237">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2607285">loc</span>&nbsp;<span class="op" id="2607289">*</span><span class="ident" id="2607290">Location</span><br>
<span class="lineno">55</span><span class="op" id="2607299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607302">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2607358">func</span>&nbsp;<span class="op" id="2607363">(</span><span class="ident" id="2607364">t</span>&nbsp;<span class="ident" id="2607366">Time</span><span class="op" id="2607370">)</span>&nbsp;<span class="ident" id="2607372">After</span><span class="op" id="2607377">(</span><span class="ident" id="2607378">u</span>&nbsp;<span class="ident" id="2607380">Time</span><span class="op" id="2607384">)</span>&nbsp;<span class="builtintype" id="2607386">bool</span>&nbsp;<span class="op" id="2607391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607394">return</span>&nbsp;<span class="ident" id="2607401">t</span><span class="op" id="2607402">.</span><span class="ident" id="2607403">sec</span>&nbsp;<span class="op" id="2607407">&gt;</span>&nbsp;<span class="ident" id="2607409">u</span><span class="op" id="2607410">.</span><span class="ident" id="2607411">sec</span>&nbsp;<span class="op" id="2607415">||</span>&nbsp;<span class="ident" id="2607418">t</span><span class="op" id="2607419">.</span><span class="ident" id="2607420">sec</span>&nbsp;<span class="op" id="2607424">==</span>&nbsp;<span class="ident" id="2607427">u</span><span class="op" id="2607428">.</span><span class="ident" id="2607429">sec</span>&nbsp;<span class="op" id="2607433">&amp;&amp;</span>&nbsp;<span class="ident" id="2607436">t</span><span class="op" id="2607437">.</span><span class="ident" id="2607438">nsec</span>&nbsp;<span class="op" id="2607443">&gt;</span>&nbsp;<span class="ident" id="2607445">u</span><span class="op" id="2607446">.</span><span class="ident" id="2607447">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2607452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607455">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2607513">func</span>&nbsp;<span class="op" id="2607518">(</span><span class="ident" id="2607519">t</span>&nbsp;<span class="ident" id="2607521">Time</span><span class="op" id="2607525">)</span>&nbsp;<span class="ident" id="2607527">Before</span><span class="op" id="2607533">(</span><span class="ident" id="2607534">u</span>&nbsp;<span class="ident" id="2607536">Time</span><span class="op" id="2607540">)</span>&nbsp;<span class="builtintype" id="2607542">bool</span>&nbsp;<span class="op" id="2607547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607550">return</span>&nbsp;<span class="ident" id="2607557">t</span><span class="op" id="2607558">.</span><span class="ident" id="2607559">sec</span>&nbsp;<span class="op" id="2607563">&lt;</span>&nbsp;<span class="ident" id="2607565">u</span><span class="op" id="2607566">.</span><span class="ident" id="2607567">sec</span>&nbsp;<span class="op" id="2607571">||</span>&nbsp;<span class="ident" id="2607574">t</span><span class="op" id="2607575">.</span><span class="ident" id="2607576">sec</span>&nbsp;<span class="op" id="2607580">==</span>&nbsp;<span class="ident" id="2607583">u</span><span class="op" id="2607584">.</span><span class="ident" id="2607585">sec</span>&nbsp;<span class="op" id="2607589">&amp;&amp;</span>&nbsp;<span class="ident" id="2607592">t</span><span class="op" id="2607593">.</span><span class="ident" id="2607594">nsec</span>&nbsp;<span class="op" id="2607599">&lt;</span>&nbsp;<span class="ident" id="2607601">u</span><span class="op" id="2607602">.</span><span class="ident" id="2607603">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2607608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607611">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2607677">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2607744">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2607800">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2607871">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2607889">func</span>&nbsp;<span class="op" id="2607894">(</span><span class="ident" id="2607895">t</span>&nbsp;<span class="ident" id="2607897">Time</span><span class="op" id="2607901">)</span>&nbsp;<span class="ident" id="2607903">Equal</span><span class="op" id="2607908">(</span><span class="ident" id="2607909">u</span>&nbsp;<span class="ident" id="2607911">Time</span><span class="op" id="2607915">)</span>&nbsp;<span class="builtintype" id="2607917">bool</span>&nbsp;<span class="op" id="2607922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607925">return</span>&nbsp;<span class="ident" id="2607932">t</span><span class="op" id="2607933">.</span><span class="ident" id="2607934">sec</span>&nbsp;<span class="op" id="2607938">==</span>&nbsp;<span class="ident" id="2607941">u</span><span class="op" id="2607942">.</span><span class="ident" id="2607943">sec</span>&nbsp;<span class="op" id="2607947">&amp;&amp;</span>&nbsp;<span class="ident" id="2607950">t</span><span class="op" id="2607951">.</span><span class="ident" id="2607952">nsec</span>&nbsp;<span class="op" id="2607957">==</span>&nbsp;<span class="ident" id="2607960">u</span><span class="op" id="2607961">.</span><span class="ident" id="2607962">nsec</span><br>
<span class="lineno"></span><span class="op" id="2607967">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2607970">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2608031">type</span>&nbsp;<span class="ident" id="2608036">Month</span>&nbsp;<span class="builtintype" id="2608042">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2608047">const</span>&nbsp;<span class="op" id="2608053">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608056">January</span>&nbsp;<span class="ident" id="2608064">Month</span>&nbsp;<span class="op" id="2608070">=</span>&nbsp;<span class="num" id="2608072">1</span>&nbsp;<span class="op" id="2608074">+</span>&nbsp;<span class="ident" id="2608076">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608082">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608092">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608099">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608106">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608111">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608117">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608123">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608131">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608142">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608151">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608161">December</span><br>
<span class="lineno"></span><span class="op" id="2608170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2608173">var</span>&nbsp;<span class="ident" id="2608177">months</span>&nbsp;<span class="op" id="2608184">=</span>&nbsp;<span class="op" id="2608186">[</span><span class="op" id="2608187">...</span><span class="op" id="2608190">]</span><span class="builtintype" id="2608191">string</span><span class="op" id="2608197">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608200">&#34;January&#34;</span><span class="op" id="2608209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608212">&#34;February&#34;</span><span class="op" id="2608222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608225">&#34;March&#34;</span><span class="op" id="2608232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608235">&#34;April&#34;</span><span class="op" id="2608242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608245">&#34;May&#34;</span><span class="op" id="2608250">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608253">&#34;June&#34;</span><span class="op" id="2608259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608262">&#34;July&#34;</span><span class="op" id="2608268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608271">&#34;August&#34;</span><span class="op" id="2608279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608282">&#34;September&#34;</span><span class="op" id="2608293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608296">&#34;October&#34;</span><span class="op" id="2608305">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608308">&#34;November&#34;</span><span class="op" id="2608318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608321">&#34;December&#34;</span><span class="op" id="2608331">,</span><br>
<span class="lineno"></span><span class="op" id="2608333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2608336">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2608414">func</span>&nbsp;<span class="op" id="2608419">(</span><span class="ident" id="2608420">m</span>&nbsp;<span class="ident" id="2608422">Month</span><span class="op" id="2608427">)</span>&nbsp;<span class="ident" id="2608429">String</span><span class="op" id="2608435">(</span><span class="op" id="2608436">)</span>&nbsp;<span class="builtintype" id="2608438">string</span>&nbsp;<span class="op" id="2608445">{</span>&nbsp;<span class="keyword" id="2608447">return</span>&nbsp;<span class="ident" id="2608454">months</span><span class="op" id="2608460">[</span><span class="ident" id="2608461">m</span><span class="op" id="2608462">-</span><span class="num" id="2608463">1</span><span class="op" id="2608464">]</span>&nbsp;<span class="op" id="2608466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2608469">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2608529">type</span>&nbsp;<span class="ident" id="2608534">Weekday</span>&nbsp;<span class="builtintype" id="2608542">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2608547">const</span>&nbsp;<span class="op" id="2608553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608556">Sunday</span>&nbsp;<span class="ident" id="2608563">Weekday</span>&nbsp;<span class="op" id="2608571">=</span>&nbsp;<span class="ident" id="2608573">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608579">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608587">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608596">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608607">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608617">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608625">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2608634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2608637">var</span>&nbsp;<span class="ident" id="2608641">days</span>&nbsp;<span class="op" id="2608646">=</span>&nbsp;<span class="op" id="2608648">[</span><span class="op" id="2608649">...</span><span class="op" id="2608652">]</span><span class="builtintype" id="2608653">string</span><span class="op" id="2608659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608662">&#34;Sunday&#34;</span><span class="op" id="2608670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608673">&#34;Monday&#34;</span><span class="op" id="2608681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608684">&#34;Tuesday&#34;</span><span class="op" id="2608693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608696">&#34;Wednesday&#34;</span><span class="op" id="2608707">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608710">&#34;Thursday&#34;</span><span class="op" id="2608720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608723">&#34;Friday&#34;</span><span class="op" id="2608731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2608734">&#34;Saturday&#34;</span><span class="op" id="2608744">,</span><br>
<span class="lineno"></span><span class="op" id="2608746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2608749">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2608822">func</span>&nbsp;<span class="op" id="2608827">(</span><span class="ident" id="2608828">d</span>&nbsp;<span class="ident" id="2608830">Weekday</span><span class="op" id="2608837">)</span>&nbsp;<span class="ident" id="2608839">String</span><span class="op" id="2608845">(</span><span class="op" id="2608846">)</span>&nbsp;<span class="builtintype" id="2608848">string</span>&nbsp;<span class="op" id="2608855">{</span>&nbsp;<span class="keyword" id="2608857">return</span>&nbsp;<span class="ident" id="2608864">days</span><span class="op" id="2608868">[</span><span class="ident" id="2608869">d</span><span class="op" id="2608870">]</span>&nbsp;<span class="op" id="2608872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2608875">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2608900">//</span><br>
<span class="lineno">140</span><span class="comment" id="2608903">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2608949">//&nbsp;&nbsp;&nbsp;&nbspJanuary&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2608994">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2609063">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2609135">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2609205">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2609271">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2609336">//</span><br>
<span class="lineno"></span><span class="comment" id="2609339">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2609407">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2609477">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2609548">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2609616">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2609684">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2609717">//</span><br>
<span class="lineno">155</span><span class="comment" id="2609720">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2609790">//</span><br>
<span class="lineno"></span><span class="comment" id="2609793">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2609865">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2609933">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2610005">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2610075">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2610145">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2610217">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2610288">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2610359">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2610432">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2610505">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2610570">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2610642">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2610669">//</span><br>
<span class="lineno"></span><span class="comment" id="2610672">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2610688">//</span><br>
<span class="lineno"></span><span class="comment" id="2610691">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2610705">//</span><br>
<span class="lineno">175</span><span class="comment" id="2610708">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2610724">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2610740">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2610754">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="2610759">//</span><br>
<span class="lineno">180</span><span class="comment" id="2610762">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2610777">//</span><br>
<span class="lineno"></span><span class="comment" id="2610780">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2610849">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2610922">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2610993">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2611065">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2611137">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2611209">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2611282">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2611355">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2611373">//</span><br>
<span class="lineno"></span><span class="comment" id="2611376">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2611444">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2611501">//</span><br>
<span class="lineno">195</span><span class="comment" id="2611504">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2611579">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2611654">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2611726">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2611800">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2611846">//</span><br>
<span class="lineno"></span><span class="comment" id="2611849">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2611925">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2611983">//</span><br>
<span class="lineno"></span><span class="comment" id="2611986">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2612060">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2612070">//</span><br>
<span class="lineno"></span><span class="comment" id="2612073">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2612146">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2612212">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2612286">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2612359">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2612428">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2612497">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2612524">//</span><br>
<span class="lineno">215</span><span class="comment" id="2612527">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2612595">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2612638">const</span>&nbsp;<span class="op" id="2612644">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612647">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612701">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612772">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612814">absoluteZeroYear</span>&nbsp;<span class="op" id="2612831">=</span>&nbsp;<span class="op" id="2612833">-</span><span class="num" id="2612834">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612849">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612880">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612933">internalYear</span>&nbsp;<span class="op" id="2612946">=</span>&nbsp;<span class="num" id="2612948">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612952">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612988">unixYear</span>&nbsp;<span class="op" id="2612997">=</span>&nbsp;<span class="num" id="2612999">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2613006">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613074">absoluteToInternal</span>&nbsp;<span class="ident" id="2613093">int64</span>&nbsp;<span class="op" id="2613099">=</span>&nbsp;<span class="op" id="2613101">(</span><span class="ident" id="2613102">absoluteZeroYear</span>&nbsp;<span class="op" id="2613119">-</span>&nbsp;<span class="ident" id="2613121">internalYear</span><span class="op" id="2613133">)</span>&nbsp;<span class="op" id="2613135">*</span>&nbsp;<span class="num" id="2613137">365.2425</span>&nbsp;<span class="op" id="2613146">*</span>&nbsp;<span class="ident" id="2613148">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613163">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2613188">=</span>&nbsp;<span class="op" id="2613190">-</span><span class="ident" id="2613191">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613212">unixToInternal</span>&nbsp;<span class="ident" id="2613227">int64</span>&nbsp;<span class="op" id="2613233">=</span>&nbsp;<span class="op" id="2613235">(</span><span class="num" id="2613236">1969</span><span class="op" id="2613240">*</span><span class="num" id="2613241">365</span>&nbsp;<span class="op" id="2613245">+</span>&nbsp;<span class="num" id="2613247">1969</span><span class="op" id="2613251">/</span><span class="num" id="2613252">4</span>&nbsp;<span class="op" id="2613254">-</span>&nbsp;<span class="num" id="2613256">1969</span><span class="op" id="2613260">/</span><span class="num" id="2613261">100</span>&nbsp;<span class="op" id="2613265">+</span>&nbsp;<span class="num" id="2613267">1969</span><span class="op" id="2613271">/</span><span class="num" id="2613272">400</span><span class="op" id="2613275">)</span>&nbsp;<span class="op" id="2613277">*</span>&nbsp;<span class="ident" id="2613279">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613294">internalToUnix</span>&nbsp;<span class="ident" id="2613309">int64</span>&nbsp;<span class="op" id="2613315">=</span>&nbsp;<span class="op" id="2613317">-</span><span class="ident" id="2613318">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2613333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2613336">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2613398">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2613434">func</span>&nbsp;<span class="op" id="2613439">(</span><span class="ident" id="2613440">t</span>&nbsp;<span class="ident" id="2613442">Time</span><span class="op" id="2613446">)</span>&nbsp;<span class="ident" id="2613448">IsZero</span><span class="op" id="2613454">(</span><span class="op" id="2613455">)</span>&nbsp;<span class="builtintype" id="2613457">bool</span>&nbsp;<span class="op" id="2613462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613465">return</span>&nbsp;<span class="ident" id="2613472">t</span><span class="op" id="2613473">.</span><span class="ident" id="2613474">sec</span>&nbsp;<span class="op" id="2613478">==</span>&nbsp;<span class="num" id="2613481">0</span>&nbsp;<span class="op" id="2613483">&amp;&amp;</span>&nbsp;<span class="ident" id="2613486">t</span><span class="op" id="2613487">.</span><span class="ident" id="2613488">nsec</span>&nbsp;<span class="op" id="2613493">==</span>&nbsp;<span class="num" id="2613496">0</span><br>
<span class="lineno"></span><span class="op" id="2613498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2613501">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2613577">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2613652">func</span>&nbsp;<span class="op" id="2613657">(</span><span class="ident" id="2613658">t</span>&nbsp;<span class="ident" id="2613660">Time</span><span class="op" id="2613664">)</span>&nbsp;<span class="ident" id="2613666">abs</span><span class="op" id="2613669">(</span><span class="op" id="2613670">)</span>&nbsp;<span class="ident" id="2613672">uint64</span>&nbsp;<span class="op" id="2613679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613682">l</span>&nbsp;<span class="op" id="2613684">:=</span>&nbsp;<span class="ident" id="2613687">t</span><span class="op" id="2613688">.</span><span class="ident" id="2613689">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2613694">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613734">if</span>&nbsp;<span class="ident" id="2613737">l</span>&nbsp;<span class="op" id="2613739">==</span>&nbsp;<span class="ident" id="2613742">nil</span>&nbsp;<span class="op" id="2613746">||</span>&nbsp;<span class="ident" id="2613749">l</span>&nbsp;<span class="op" id="2613751">==</span>&nbsp;<span class="op" id="2613754">&amp;</span><span class="ident" id="2613755">localLoc</span>&nbsp;<span class="op" id="2613764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613768">l</span>&nbsp;<span class="op" id="2613770">=</span>&nbsp;<span class="ident" id="2613772">l</span><span class="op" id="2613773">.</span><span class="ident" id="2613774">get</span><span class="op" id="2613777">(</span><span class="op" id="2613778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613784">sec</span>&nbsp;<span class="op" id="2613788">:=</span>&nbsp;<span class="ident" id="2613791">t</span><span class="op" id="2613792">.</span><span class="ident" id="2613793">sec</span>&nbsp;<span class="op" id="2613797">+</span>&nbsp;<span class="ident" id="2613799">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613815">if</span>&nbsp;<span class="ident" id="2613818">l</span>&nbsp;<span class="op" id="2613820">!=</span>&nbsp;<span class="op" id="2613823">&amp;</span><span class="ident" id="2613824">utcLoc</span>&nbsp;<span class="op" id="2613831">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613835">if</span>&nbsp;<span class="ident" id="2613838">l</span><span class="op" id="2613839">.</span><span class="ident" id="2613840">cacheZone</span>&nbsp;<span class="op" id="2613850">!=</span>&nbsp;<span class="ident" id="2613853">nil</span>&nbsp;<span class="op" id="2613857">&amp;&amp;</span>&nbsp;<span class="ident" id="2613860">l</span><span class="op" id="2613861">.</span><span class="ident" id="2613862">cacheStart</span>&nbsp;<span class="op" id="2613873">&lt;=</span>&nbsp;<span class="ident" id="2613876">sec</span>&nbsp;<span class="op" id="2613880">&amp;&amp;</span>&nbsp;<span class="ident" id="2613883">sec</span>&nbsp;<span class="op" id="2613887">&lt;</span>&nbsp;<span class="ident" id="2613889">l</span><span class="op" id="2613890">.</span><span class="ident" id="2613891">cacheEnd</span>&nbsp;<span class="op" id="2613900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613905">sec</span>&nbsp;<span class="op" id="2613909">+=</span>&nbsp;<span class="ident" id="2613912">int64</span><span class="op" id="2613917">(</span><span class="ident" id="2613918">l</span><span class="op" id="2613919">.</span><span class="ident" id="2613920">cacheZone</span><span class="op" id="2613929">.</span><span class="ident" id="2613930">offset</span><span class="op" id="2613936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613940">}</span>&nbsp;<span class="keyword" id="2613942">else</span>&nbsp;<span class="op" id="2613947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613952">_</span><span class="op" id="2613953">,</span>&nbsp;<span class="ident" id="2613955">offset</span><span class="op" id="2613961">,</span>&nbsp;<span class="ident" id="2613963">_</span><span class="op" id="2613964">,</span>&nbsp;<span class="ident" id="2613966">_</span><span class="op" id="2613967">,</span>&nbsp;<span class="ident" id="2613969">_</span>&nbsp;<span class="op" id="2613971">:=</span>&nbsp;<span class="ident" id="2613974">l</span><span class="op" id="2613975">.</span><span class="ident" id="2613976">lookup</span><span class="op" id="2613982">(</span><span class="ident" id="2613983">sec</span><span class="op" id="2613986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613991">sec</span>&nbsp;<span class="op" id="2613995">+=</span>&nbsp;<span class="ident" id="2613998">int64</span><span class="op" id="2614003">(</span><span class="ident" id="2614004">offset</span><span class="op" id="2614010">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614020">return</span>&nbsp;<span class="ident" id="2614027">uint64</span><span class="op" id="2614033">(</span><span class="ident" id="2614034">sec</span>&nbsp;<span class="op" id="2614038">+</span>&nbsp;<span class="op" id="2614040">(</span><span class="ident" id="2614041">unixToInternal</span>&nbsp;<span class="op" id="2614056">+</span>&nbsp;<span class="ident" id="2614058">internalToAbsolute</span><span class="op" id="2614076">)</span><span class="op" id="2614077">)</span><br>
<span class="lineno"></span><span class="op" id="2614079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2614082">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2614138">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2614198">func</span>&nbsp;<span class="op" id="2614203">(</span><span class="ident" id="2614204">t</span>&nbsp;<span class="ident" id="2614206">Time</span><span class="op" id="2614210">)</span>&nbsp;<span class="ident" id="2614212">locabs</span><span class="op" id="2614218">(</span><span class="op" id="2614219">)</span>&nbsp;<span class="op" id="2614221">(</span><span class="ident" id="2614222">name</span>&nbsp;<span class="builtintype" id="2614227">string</span><span class="op" id="2614233">,</span>&nbsp;<span class="ident" id="2614235">offset</span>&nbsp;<span class="builtintype" id="2614242">int</span><span class="op" id="2614245">,</span>&nbsp;<span class="ident" id="2614247">abs</span>&nbsp;<span class="ident" id="2614251">uint64</span><span class="op" id="2614257">)</span>&nbsp;<span class="op" id="2614259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614262">l</span>&nbsp;<span class="op" id="2614264">:=</span>&nbsp;<span class="ident" id="2614267">t</span><span class="op" id="2614268">.</span><span class="ident" id="2614269">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614274">if</span>&nbsp;<span class="ident" id="2614277">l</span>&nbsp;<span class="op" id="2614279">==</span>&nbsp;<span class="ident" id="2614282">nil</span>&nbsp;<span class="op" id="2614286">||</span>&nbsp;<span class="ident" id="2614289">l</span>&nbsp;<span class="op" id="2614291">==</span>&nbsp;<span class="op" id="2614294">&amp;</span><span class="ident" id="2614295">localLoc</span>&nbsp;<span class="op" id="2614304">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614308">l</span>&nbsp;<span class="op" id="2614310">=</span>&nbsp;<span class="ident" id="2614312">l</span><span class="op" id="2614313">.</span><span class="ident" id="2614314">get</span><span class="op" id="2614317">(</span><span class="op" id="2614318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2614324">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614380">sec</span>&nbsp;<span class="op" id="2614384">:=</span>&nbsp;<span class="ident" id="2614387">t</span><span class="op" id="2614388">.</span><span class="ident" id="2614389">sec</span>&nbsp;<span class="op" id="2614393">+</span>&nbsp;<span class="ident" id="2614395">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614411">if</span>&nbsp;<span class="ident" id="2614414">l</span>&nbsp;<span class="op" id="2614416">!=</span>&nbsp;<span class="op" id="2614419">&amp;</span><span class="ident" id="2614420">utcLoc</span>&nbsp;<span class="op" id="2614427">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614431">if</span>&nbsp;<span class="ident" id="2614434">l</span><span class="op" id="2614435">.</span><span class="ident" id="2614436">cacheZone</span>&nbsp;<span class="op" id="2614446">!=</span>&nbsp;<span class="ident" id="2614449">nil</span>&nbsp;<span class="op" id="2614453">&amp;&amp;</span>&nbsp;<span class="ident" id="2614456">l</span><span class="op" id="2614457">.</span><span class="ident" id="2614458">cacheStart</span>&nbsp;<span class="op" id="2614469">&lt;=</span>&nbsp;<span class="ident" id="2614472">sec</span>&nbsp;<span class="op" id="2614476">&amp;&amp;</span>&nbsp;<span class="ident" id="2614479">sec</span>&nbsp;<span class="op" id="2614483">&lt;</span>&nbsp;<span class="ident" id="2614485">l</span><span class="op" id="2614486">.</span><span class="ident" id="2614487">cacheEnd</span>&nbsp;<span class="op" id="2614496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614501">name</span>&nbsp;<span class="op" id="2614506">=</span>&nbsp;<span class="ident" id="2614508">l</span><span class="op" id="2614509">.</span><span class="ident" id="2614510">cacheZone</span><span class="op" id="2614519">.</span><span class="ident" id="2614520">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614528">offset</span>&nbsp;<span class="op" id="2614535">=</span>&nbsp;<span class="ident" id="2614537">l</span><span class="op" id="2614538">.</span><span class="ident" id="2614539">cacheZone</span><span class="op" id="2614548">.</span><span class="ident" id="2614549">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614558">}</span>&nbsp;<span class="keyword" id="2614560">else</span>&nbsp;<span class="op" id="2614565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614570">name</span><span class="op" id="2614574">,</span>&nbsp;<span class="ident" id="2614576">offset</span><span class="op" id="2614582">,</span>&nbsp;<span class="ident" id="2614584">_</span><span class="op" id="2614585">,</span>&nbsp;<span class="ident" id="2614587">_</span><span class="op" id="2614588">,</span>&nbsp;<span class="ident" id="2614590">_</span>&nbsp;<span class="op" id="2614592">=</span>&nbsp;<span class="ident" id="2614594">l</span><span class="op" id="2614595">.</span><span class="ident" id="2614596">lookup</span><span class="op" id="2614602">(</span><span class="ident" id="2614603">sec</span><span class="op" id="2614606">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614614">sec</span>&nbsp;<span class="op" id="2614618">+=</span>&nbsp;<span class="ident" id="2614621">int64</span><span class="op" id="2614626">(</span><span class="ident" id="2614627">offset</span><span class="op" id="2614633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614636">}</span>&nbsp;<span class="keyword" id="2614638">else</span>&nbsp;<span class="op" id="2614643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614647">name</span>&nbsp;<span class="op" id="2614652">=</span>&nbsp;<span class="string" id="2614654">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614661">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614664">abs</span>&nbsp;<span class="op" id="2614668">=</span>&nbsp;<span class="ident" id="2614670">uint64</span><span class="op" id="2614676">(</span><span class="ident" id="2614677">sec</span>&nbsp;<span class="op" id="2614681">+</span>&nbsp;<span class="op" id="2614683">(</span><span class="ident" id="2614684">unixToInternal</span>&nbsp;<span class="op" id="2614699">+</span>&nbsp;<span class="ident" id="2614701">internalToAbsolute</span><span class="op" id="2614719">)</span><span class="op" id="2614720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614723">return</span><br>
<span class="lineno"></span><span class="op" id="2614730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2614733">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2614793">func</span>&nbsp;<span class="op" id="2614798">(</span><span class="ident" id="2614799">t</span>&nbsp;<span class="ident" id="2614801">Time</span><span class="op" id="2614805">)</span>&nbsp;<span class="ident" id="2614807">Date</span><span class="op" id="2614811">(</span><span class="op" id="2614812">)</span>&nbsp;<span class="op" id="2614814">(</span><span class="ident" id="2614815">year</span>&nbsp;<span class="builtintype" id="2614820">int</span><span class="op" id="2614823">,</span>&nbsp;<span class="ident" id="2614825">month</span>&nbsp;<span class="ident" id="2614831">Month</span><span class="op" id="2614836">,</span>&nbsp;<span class="ident" id="2614838">day</span>&nbsp;<span class="builtintype" id="2614842">int</span><span class="op" id="2614845">)</span>&nbsp;<span class="op" id="2614847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614850">year</span><span class="op" id="2614854">,</span>&nbsp;<span class="ident" id="2614856">month</span><span class="op" id="2614861">,</span>&nbsp;<span class="ident" id="2614863">day</span><span class="op" id="2614866">,</span>&nbsp;<span class="ident" id="2614868">_</span>&nbsp;<span class="op" id="2614870">=</span>&nbsp;<span class="ident" id="2614872">t</span><span class="op" id="2614873">.</span><span class="ident" id="2614874">date</span><span class="op" id="2614878">(</span><span class="builtintype" id="2614879">true</span><span class="op" id="2614883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614886">return</span><br>
<span class="lineno"></span><span class="op" id="2614893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2614896">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2614940">func</span>&nbsp;<span class="op" id="2614945">(</span><span class="ident" id="2614946">t</span>&nbsp;<span class="ident" id="2614948">Time</span><span class="op" id="2614952">)</span>&nbsp;<span class="ident" id="2614954">Year</span><span class="op" id="2614958">(</span><span class="op" id="2614959">)</span>&nbsp;<span class="builtintype" id="2614961">int</span>&nbsp;<span class="op" id="2614965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614968">year</span><span class="op" id="2614972">,</span>&nbsp;<span class="ident" id="2614974">_</span><span class="op" id="2614975">,</span>&nbsp;<span class="ident" id="2614977">_</span><span class="op" id="2614978">,</span>&nbsp;<span class="ident" id="2614980">_</span>&nbsp;<span class="op" id="2614982">:=</span>&nbsp;<span class="ident" id="2614985">t</span><span class="op" id="2614986">.</span><span class="ident" id="2614987">date</span><span class="op" id="2614991">(</span><span class="builtintype" id="2614992">false</span><span class="op" id="2614997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615000">return</span>&nbsp;<span class="ident" id="2615007">year</span><br>
<span class="lineno"></span><span class="op" id="2615012">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2615015">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2615070">func</span>&nbsp;<span class="op" id="2615075">(</span><span class="ident" id="2615076">t</span>&nbsp;<span class="ident" id="2615078">Time</span><span class="op" id="2615082">)</span>&nbsp;<span class="ident" id="2615084">Month</span><span class="op" id="2615089">(</span><span class="op" id="2615090">)</span>&nbsp;<span class="ident" id="2615092">Month</span>&nbsp;<span class="op" id="2615098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615101">_</span><span class="op" id="2615102">,</span>&nbsp;<span class="ident" id="2615104">month</span><span class="op" id="2615109">,</span>&nbsp;<span class="ident" id="2615111">_</span><span class="op" id="2615112">,</span>&nbsp;<span class="ident" id="2615114">_</span>&nbsp;<span class="op" id="2615116">:=</span>&nbsp;<span class="ident" id="2615119">t</span><span class="op" id="2615120">.</span><span class="ident" id="2615121">date</span><span class="op" id="2615125">(</span><span class="builtintype" id="2615126">true</span><span class="op" id="2615130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615133">return</span>&nbsp;<span class="ident" id="2615140">month</span><br>
<span class="lineno">305</span><span class="op" id="2615146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2615149">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2615201">func</span>&nbsp;<span class="op" id="2615206">(</span><span class="ident" id="2615207">t</span>&nbsp;<span class="ident" id="2615209">Time</span><span class="op" id="2615213">)</span>&nbsp;<span class="ident" id="2615215">Day</span><span class="op" id="2615218">(</span><span class="op" id="2615219">)</span>&nbsp;<span class="builtintype" id="2615221">int</span>&nbsp;<span class="op" id="2615225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615228">_</span><span class="op" id="2615229">,</span>&nbsp;<span class="ident" id="2615231">_</span><span class="op" id="2615232">,</span>&nbsp;<span class="ident" id="2615234">day</span><span class="op" id="2615237">,</span>&nbsp;<span class="ident" id="2615239">_</span>&nbsp;<span class="op" id="2615241">:=</span>&nbsp;<span class="ident" id="2615244">t</span><span class="op" id="2615245">.</span><span class="ident" id="2615246">date</span><span class="op" id="2615250">(</span><span class="builtintype" id="2615251">true</span><span class="op" id="2615255">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615258">return</span>&nbsp;<span class="ident" id="2615265">day</span><br>
<span class="lineno"></span><span class="op" id="2615269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2615272">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2615327">func</span>&nbsp;<span class="op" id="2615332">(</span><span class="ident" id="2615333">t</span>&nbsp;<span class="ident" id="2615335">Time</span><span class="op" id="2615339">)</span>&nbsp;<span class="ident" id="2615341">Weekday</span><span class="op" id="2615348">(</span><span class="op" id="2615349">)</span>&nbsp;<span class="ident" id="2615351">Weekday</span>&nbsp;<span class="op" id="2615359">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615362">return</span>&nbsp;<span class="ident" id="2615369">absWeekday</span><span class="op" id="2615379">(</span><span class="ident" id="2615380">t</span><span class="op" id="2615381">.</span><span class="ident" id="2615382">abs</span><span class="op" id="2615385">(</span><span class="op" id="2615386">)</span><span class="op" id="2615387">)</span><br>
<span class="lineno"></span><span class="op" id="2615389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2615392">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2615456">func</span>&nbsp;<span class="ident" id="2615461">absWeekday</span><span class="op" id="2615471">(</span><span class="ident" id="2615472">abs</span>&nbsp;<span class="ident" id="2615476">uint64</span><span class="op" id="2615482">)</span>&nbsp;<span class="ident" id="2615484">Weekday</span>&nbsp;<span class="op" id="2615492">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2615495">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615569">sec</span>&nbsp;<span class="op" id="2615573">:=</span>&nbsp;<span class="op" id="2615576">(</span><span class="ident" id="2615577">abs</span>&nbsp;<span class="op" id="2615581">+</span>&nbsp;<span class="ident" id="2615583">uint64</span><span class="op" id="2615589">(</span><span class="ident" id="2615590">Monday</span><span class="op" id="2615596">)</span><span class="op" id="2615597">*</span><span class="ident" id="2615598">secondsPerDay</span><span class="op" id="2615611">)</span>&nbsp;<span class="op" id="2615613">%</span>&nbsp;<span class="ident" id="2615615">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615631">return</span>&nbsp;<span class="ident" id="2615638">Weekday</span><span class="op" id="2615645">(</span><span class="builtintype" id="2615646">int</span><span class="op" id="2615649">(</span><span class="ident" id="2615650">sec</span><span class="op" id="2615653">)</span>&nbsp;<span class="op" id="2615655">/</span>&nbsp;<span class="ident" id="2615657">secondsPerDay</span><span class="op" id="2615670">)</span><br>
<span class="lineno"></span><span class="op" id="2615672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2615675">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2615747">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2615819">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2615893">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2615909">func</span>&nbsp;<span class="op" id="2615914">(</span><span class="ident" id="2615915">t</span>&nbsp;<span class="ident" id="2615917">Time</span><span class="op" id="2615921">)</span>&nbsp;<span class="ident" id="2615923">ISOWeek</span><span class="op" id="2615930">(</span><span class="op" id="2615931">)</span>&nbsp;<span class="op" id="2615933">(</span><span class="ident" id="2615934">year</span><span class="op" id="2615938">,</span>&nbsp;<span class="ident" id="2615940">week</span>&nbsp;<span class="builtintype" id="2615945">int</span><span class="op" id="2615948">)</span>&nbsp;<span class="op" id="2615950">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615953">year</span><span class="op" id="2615957">,</span>&nbsp;<span class="ident" id="2615959">month</span><span class="op" id="2615964">,</span>&nbsp;<span class="ident" id="2615966">day</span><span class="op" id="2615969">,</span>&nbsp;<span class="ident" id="2615971">yday</span>&nbsp;<span class="op" id="2615976">:=</span>&nbsp;<span class="ident" id="2615979">t</span><span class="op" id="2615980">.</span><span class="ident" id="2615981">date</span><span class="op" id="2615985">(</span><span class="builtintype" id="2615986">true</span><span class="op" id="2615990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615993">wday</span>&nbsp;<span class="op" id="2615998">:=</span>&nbsp;<span class="builtintype" id="2616001">int</span><span class="op" id="2616004">(</span><span class="ident" id="2616005">t</span><span class="op" id="2616006">.</span><span class="ident" id="2616007">Weekday</span><span class="op" id="2616014">(</span><span class="op" id="2616015">)</span><span class="op" id="2616016">+</span><span class="num" id="2616017">6</span><span class="op" id="2616018">)</span>&nbsp;<span class="op" id="2616020">%</span>&nbsp;<span class="num" id="2616022">7</span>&nbsp;<span class="comment" id="2616024">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616052">const</span>&nbsp;<span class="op" id="2616058">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616062">Mon</span>&nbsp;<span class="builtintype" id="2616066">int</span>&nbsp;<span class="op" id="2616070">=</span>&nbsp;<span class="ident" id="2616072">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616079">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616085">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616091">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616097">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616103">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616109">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616114">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616118">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616172">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616238">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616298">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616357">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616380">week</span>&nbsp;<span class="op" id="2616385">=</span>&nbsp;<span class="op" id="2616387">(</span><span class="ident" id="2616388">yday</span>&nbsp;<span class="op" id="2616393">-</span>&nbsp;<span class="ident" id="2616395">wday</span>&nbsp;<span class="op" id="2616400">+</span>&nbsp;<span class="num" id="2616402">7</span><span class="op" id="2616403">)</span>&nbsp;<span class="op" id="2616405">/</span>&nbsp;<span class="num" id="2616407">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616411">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616467">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616519">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616587">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616614">jan1wday</span>&nbsp;<span class="op" id="2616623">:=</span>&nbsp;<span class="op" id="2616626">(</span><span class="ident" id="2616627">wday</span>&nbsp;<span class="op" id="2616632">-</span>&nbsp;<span class="ident" id="2616634">yday</span>&nbsp;<span class="op" id="2616639">+</span>&nbsp;<span class="num" id="2616641">7</span><span class="op" id="2616642">*</span><span class="num" id="2616643">53</span><span class="op" id="2616645">)</span>&nbsp;<span class="op" id="2616647">%</span>&nbsp;<span class="num" id="2616649">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616652">if</span>&nbsp;<span class="ident" id="2616655">Tue</span>&nbsp;<span class="op" id="2616659">&lt;=</span>&nbsp;<span class="ident" id="2616662">jan1wday</span>&nbsp;<span class="op" id="2616671">&amp;&amp;</span>&nbsp;<span class="ident" id="2616674">jan1wday</span>&nbsp;<span class="op" id="2616683">&lt;=</span>&nbsp;<span class="ident" id="2616686">Thu</span>&nbsp;<span class="op" id="2616690">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616694">week</span><span class="op" id="2616698">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616706">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616771">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616803">if</span>&nbsp;<span class="ident" id="2616806">week</span>&nbsp;<span class="op" id="2616811">==</span>&nbsp;<span class="num" id="2616814">0</span>&nbsp;<span class="op" id="2616816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616820">year</span><span class="op" id="2616824">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616829">week</span>&nbsp;<span class="op" id="2616834">=</span>&nbsp;<span class="num" id="2616836">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616841">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616902">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616950">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617019">if</span>&nbsp;<span class="ident" id="2617022">jan1wday</span>&nbsp;<span class="op" id="2617031">==</span>&nbsp;<span class="ident" id="2617034">Fri</span>&nbsp;<span class="op" id="2617038">||</span>&nbsp;<span class="op" id="2617041">(</span><span class="ident" id="2617042">jan1wday</span>&nbsp;<span class="op" id="2617051">==</span>&nbsp;<span class="ident" id="2617054">Sat</span>&nbsp;<span class="op" id="2617058">&amp;&amp;</span>&nbsp;<span class="ident" id="2617061">isLeap</span><span class="op" id="2617067">(</span><span class="ident" id="2617068">year</span><span class="op" id="2617072">)</span><span class="op" id="2617073">)</span>&nbsp;<span class="op" id="2617075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617080">week</span><span class="op" id="2617084">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617092">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617096">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617148">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617201">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617253">if</span>&nbsp;<span class="ident" id="2617256">month</span>&nbsp;<span class="op" id="2617262">==</span>&nbsp;<span class="ident" id="2617265">December</span>&nbsp;<span class="op" id="2617274">&amp;&amp;</span>&nbsp;<span class="ident" id="2617277">day</span>&nbsp;<span class="op" id="2617281">&gt;=</span>&nbsp;<span class="num" id="2617284">29</span>&nbsp;<span class="op" id="2617287">&amp;&amp;</span>&nbsp;<span class="ident" id="2617290">wday</span>&nbsp;<span class="op" id="2617295">&lt;</span>&nbsp;<span class="ident" id="2617297">Thu</span>&nbsp;<span class="op" id="2617301">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617305">if</span>&nbsp;<span class="ident" id="2617308">dec31wday</span>&nbsp;<span class="op" id="2617318">:=</span>&nbsp;<span class="op" id="2617321">(</span><span class="ident" id="2617322">wday</span>&nbsp;<span class="op" id="2617327">+</span>&nbsp;<span class="num" id="2617329">31</span>&nbsp;<span class="op" id="2617332">-</span>&nbsp;<span class="ident" id="2617334">day</span><span class="op" id="2617337">)</span>&nbsp;<span class="op" id="2617339">%</span>&nbsp;<span class="num" id="2617341">7</span><span class="op" id="2617342">;</span>&nbsp;<span class="ident" id="2617344">Mon</span>&nbsp;<span class="op" id="2617348">&lt;=</span>&nbsp;<span class="ident" id="2617351">dec31wday</span>&nbsp;<span class="op" id="2617361">&amp;&amp;</span>&nbsp;<span class="ident" id="2617364">dec31wday</span>&nbsp;<span class="op" id="2617374">&lt;=</span>&nbsp;<span class="ident" id="2617377">Wed</span>&nbsp;<span class="op" id="2617381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617386">year</span><span class="op" id="2617390">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617396">week</span>&nbsp;<span class="op" id="2617401">=</span>&nbsp;<span class="num" id="2617403">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617410">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617414">return</span><br>
<span class="lineno"></span><span class="op" id="2617421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617424">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2617501">func</span>&nbsp;<span class="op" id="2617506">(</span><span class="ident" id="2617507">t</span>&nbsp;<span class="ident" id="2617509">Time</span><span class="op" id="2617513">)</span>&nbsp;<span class="ident" id="2617515">Clock</span><span class="op" id="2617520">(</span><span class="op" id="2617521">)</span>&nbsp;<span class="op" id="2617523">(</span><span class="ident" id="2617524">hour</span><span class="op" id="2617528">,</span>&nbsp;<span class="ident" id="2617530">min</span><span class="op" id="2617533">,</span>&nbsp;<span class="ident" id="2617535">sec</span>&nbsp;<span class="builtintype" id="2617539">int</span><span class="op" id="2617542">)</span>&nbsp;<span class="op" id="2617544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617547">return</span>&nbsp;<span class="ident" id="2617554">absClock</span><span class="op" id="2617562">(</span><span class="ident" id="2617563">t</span><span class="op" id="2617564">.</span><span class="ident" id="2617565">abs</span><span class="op" id="2617568">(</span><span class="op" id="2617569">)</span><span class="op" id="2617570">)</span><br>
<span class="lineno"></span><span class="op" id="2617572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617575">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2617635">func</span>&nbsp;<span class="ident" id="2617640">absClock</span><span class="op" id="2617648">(</span><span class="ident" id="2617649">abs</span>&nbsp;<span class="ident" id="2617653">uint64</span><span class="op" id="2617659">)</span>&nbsp;<span class="op" id="2617661">(</span><span class="ident" id="2617662">hour</span><span class="op" id="2617666">,</span>&nbsp;<span class="ident" id="2617668">min</span><span class="op" id="2617671">,</span>&nbsp;<span class="ident" id="2617673">sec</span>&nbsp;<span class="builtintype" id="2617677">int</span><span class="op" id="2617680">)</span>&nbsp;<span class="op" id="2617682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617685">sec</span>&nbsp;<span class="op" id="2617689">=</span>&nbsp;<span class="builtintype" id="2617691">int</span><span class="op" id="2617694">(</span><span class="ident" id="2617695">abs</span>&nbsp;<span class="op" id="2617699">%</span>&nbsp;<span class="ident" id="2617701">secondsPerDay</span><span class="op" id="2617714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617717">hour</span>&nbsp;<span class="op" id="2617722">=</span>&nbsp;<span class="ident" id="2617724">sec</span>&nbsp;<span class="op" id="2617728">/</span>&nbsp;<span class="ident" id="2617730">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617746">sec</span>&nbsp;<span class="op" id="2617750">-=</span>&nbsp;<span class="ident" id="2617753">hour</span>&nbsp;<span class="op" id="2617758">*</span>&nbsp;<span class="ident" id="2617760">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617776">min</span>&nbsp;<span class="op" id="2617780">=</span>&nbsp;<span class="ident" id="2617782">sec</span>&nbsp;<span class="op" id="2617786">/</span>&nbsp;<span class="ident" id="2617788">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617806">sec</span>&nbsp;<span class="op" id="2617810">-=</span>&nbsp;<span class="ident" id="2617813">min</span>&nbsp;<span class="op" id="2617817">*</span>&nbsp;<span class="ident" id="2617819">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617837">return</span><br>
<span class="lineno"></span><span class="op" id="2617844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617847">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2617925">func</span>&nbsp;<span class="op" id="2617930">(</span><span class="ident" id="2617931">t</span>&nbsp;<span class="ident" id="2617933">Time</span><span class="op" id="2617937">)</span>&nbsp;<span class="ident" id="2617939">Hour</span><span class="op" id="2617943">(</span><span class="op" id="2617944">)</span>&nbsp;<span class="builtintype" id="2617946">int</span>&nbsp;<span class="op" id="2617950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617953">return</span>&nbsp;<span class="builtintype" id="2617960">int</span><span class="op" id="2617963">(</span><span class="ident" id="2617964">t</span><span class="op" id="2617965">.</span><span class="ident" id="2617966">abs</span><span class="op" id="2617969">(</span><span class="op" id="2617970">)</span><span class="op" id="2617971">%</span><span class="ident" id="2617972">secondsPerDay</span><span class="op" id="2617985">)</span>&nbsp;<span class="op" id="2617987">/</span>&nbsp;<span class="ident" id="2617989">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2618004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2618007">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2618097">func</span>&nbsp;<span class="op" id="2618102">(</span><span class="ident" id="2618103">t</span>&nbsp;<span class="ident" id="2618105">Time</span><span class="op" id="2618109">)</span>&nbsp;<span class="ident" id="2618111">Minute</span><span class="op" id="2618117">(</span><span class="op" id="2618118">)</span>&nbsp;<span class="builtintype" id="2618120">int</span>&nbsp;<span class="op" id="2618124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618127">return</span>&nbsp;<span class="builtintype" id="2618134">int</span><span class="op" id="2618137">(</span><span class="ident" id="2618138">t</span><span class="op" id="2618139">.</span><span class="ident" id="2618140">abs</span><span class="op" id="2618143">(</span><span class="op" id="2618144">)</span><span class="op" id="2618145">%</span><span class="ident" id="2618146">secondsPerHour</span><span class="op" id="2618160">)</span>&nbsp;<span class="op" id="2618162">/</span>&nbsp;<span class="ident" id="2618164">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2618181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2618184">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2618276">func</span>&nbsp;<span class="op" id="2618281">(</span><span class="ident" id="2618282">t</span>&nbsp;<span class="ident" id="2618284">Time</span><span class="op" id="2618288">)</span>&nbsp;<span class="ident" id="2618290">Second</span><span class="op" id="2618296">(</span><span class="op" id="2618297">)</span>&nbsp;<span class="builtintype" id="2618299">int</span>&nbsp;<span class="op" id="2618303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618306">return</span>&nbsp;<span class="builtintype" id="2618313">int</span><span class="op" id="2618316">(</span><span class="ident" id="2618317">t</span><span class="op" id="2618318">.</span><span class="ident" id="2618319">abs</span><span class="op" id="2618322">(</span><span class="op" id="2618323">)</span>&nbsp;<span class="op" id="2618325">%</span>&nbsp;<span class="ident" id="2618327">secondsPerMinute</span><span class="op" id="2618343">)</span><br>
<span class="lineno"></span><span class="op" id="2618345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2618348">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2618426">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2618458">func</span>&nbsp;<span class="op" id="2618463">(</span><span class="ident" id="2618464">t</span>&nbsp;<span class="ident" id="2618466">Time</span><span class="op" id="2618470">)</span>&nbsp;<span class="ident" id="2618472">Nanosecond</span><span class="op" id="2618482">(</span><span class="op" id="2618483">)</span>&nbsp;<span class="builtintype" id="2618485">int</span>&nbsp;<span class="op" id="2618489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618492">return</span>&nbsp;<span class="builtintype" id="2618499">int</span><span class="op" id="2618502">(</span><span class="ident" id="2618503">t</span><span class="op" id="2618504">.</span><span class="ident" id="2618505">nsec</span><span class="op" id="2618509">)</span><br>
<span class="lineno"></span><span class="op" id="2618511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2618514">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2618610">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2618640">func</span>&nbsp;<span class="op" id="2618645">(</span><span class="ident" id="2618646">t</span>&nbsp;<span class="ident" id="2618648">Time</span><span class="op" id="2618652">)</span>&nbsp;<span class="ident" id="2618654">YearDay</span><span class="op" id="2618661">(</span><span class="op" id="2618662">)</span>&nbsp;<span class="builtintype" id="2618664">int</span>&nbsp;<span class="op" id="2618668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618671">_</span><span class="op" id="2618672">,</span>&nbsp;<span class="ident" id="2618674">_</span><span class="op" id="2618675">,</span>&nbsp;<span class="ident" id="2618677">_</span><span class="op" id="2618678">,</span>&nbsp;<span class="ident" id="2618680">yday</span>&nbsp;<span class="op" id="2618685">:=</span>&nbsp;<span class="ident" id="2618688">t</span><span class="op" id="2618689">.</span><span class="ident" id="2618690">date</span><span class="op" id="2618694">(</span><span class="builtintype" id="2618695">false</span><span class="op" id="2618700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618703">return</span>&nbsp;<span class="ident" id="2618710">yday</span>&nbsp;<span class="op" id="2618715">+</span>&nbsp;<span class="num" id="2618717">1</span><br>
<span class="lineno">425</span><span class="op" id="2618719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2618722">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2618785">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2618849">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2618911">type</span>&nbsp;<span class="ident" id="2618916">Duration</span>&nbsp;<span class="ident" id="2618925">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2618932">const</span>&nbsp;<span class="op" id="2618938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618941">minDuration</span>&nbsp;<span class="ident" id="2618953">Duration</span>&nbsp;<span class="op" id="2618962">=</span>&nbsp;<span class="op" id="2618964">-</span><span class="num" id="2618965">1</span>&nbsp;<span class="op" id="2618967">&lt;&lt;</span>&nbsp;<span class="num" id="2618970">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618974">maxDuration</span>&nbsp;<span class="ident" id="2618986">Duration</span>&nbsp;<span class="op" id="2618995">=</span>&nbsp;<span class="num" id="2618997">1</span><span class="op" id="2618998">&lt;&lt;</span><span class="num" id="2619000">63</span>&nbsp;<span class="op" id="2619003">-</span>&nbsp;<span class="num" id="2619005">1</span><br>
<span class="lineno">435</span><span class="op" id="2619007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2619010">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2619082">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2619151">//</span><br>
<span class="lineno">440</span><span class="comment" id="2619154">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2619209">//&nbsp;&nbsp;&nbsp;&nbspsecond&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2619234">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2619294">//</span><br>
<span class="lineno"></span><span class="comment" id="2619297">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2619363">//&nbsp;&nbsp;&nbsp;&nbspseconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2619380">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2619443">//</span><br>
<span class="lineno"></span><span class="keyword" id="2619446">const</span>&nbsp;<span class="op" id="2619452">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619455">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2619467">Duration</span>&nbsp;<span class="op" id="2619476">=</span>&nbsp;<span class="num" id="2619478">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619481">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619502">=</span>&nbsp;<span class="num" id="2619504">1000</span>&nbsp;<span class="op" id="2619509">*</span>&nbsp;<span class="ident" id="2619511">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619523">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619544">=</span>&nbsp;<span class="num" id="2619546">1000</span>&nbsp;<span class="op" id="2619551">*</span>&nbsp;<span class="ident" id="2619553">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619566">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619587">=</span>&nbsp;<span class="num" id="2619589">1000</span>&nbsp;<span class="op" id="2619594">*</span>&nbsp;<span class="ident" id="2619596">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619609">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619630">=</span>&nbsp;<span class="num" id="2619632">60</span>&nbsp;<span class="op" id="2619635">*</span>&nbsp;<span class="ident" id="2619637">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619645">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619666">=</span>&nbsp;<span class="num" id="2619668">60</span>&nbsp;<span class="op" id="2619671">*</span>&nbsp;<span class="ident" id="2619673">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2619680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2619683">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2619761">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2619840">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2619919">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2619991">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2620008">func</span>&nbsp;<span class="op" id="2620013">(</span><span class="ident" id="2620014">d</span>&nbsp;<span class="ident" id="2620016">Duration</span><span class="op" id="2620024">)</span>&nbsp;<span class="ident" id="2620026">String</span><span class="op" id="2620032">(</span><span class="op" id="2620033">)</span>&nbsp;<span class="builtintype" id="2620035">string</span>&nbsp;<span class="op" id="2620042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620045">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620090">var</span>&nbsp;<span class="ident" id="2620094">buf</span>&nbsp;<span class="op" id="2620098">[</span><span class="num" id="2620099">32</span><span class="op" id="2620101">]</span><span class="builtintype" id="2620102">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620108">w</span>&nbsp;<span class="op" id="2620110">:=</span>&nbsp;<span class="builtinfunc" id="2620113">len</span><span class="op" id="2620116">(</span><span class="ident" id="2620117">buf</span><span class="op" id="2620120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620124">u</span>&nbsp;<span class="op" id="2620126">:=</span>&nbsp;<span class="ident" id="2620129">uint64</span><span class="op" id="2620135">(</span><span class="ident" id="2620136">d</span><span class="op" id="2620137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620140">neg</span>&nbsp;<span class="op" id="2620144">:=</span>&nbsp;<span class="ident" id="2620147">d</span>&nbsp;<span class="op" id="2620149">&lt;</span>&nbsp;<span class="num" id="2620151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620154">if</span>&nbsp;<span class="ident" id="2620157">neg</span>&nbsp;<span class="op" id="2620161">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620165">u</span>&nbsp;<span class="op" id="2620167">=</span>&nbsp;<span class="op" id="2620169">-</span><span class="ident" id="2620170">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620177">if</span>&nbsp;<span class="ident" id="2620180">u</span>&nbsp;<span class="op" id="2620182">&lt;</span>&nbsp;<span class="ident" id="2620184">uint64</span><span class="op" id="2620190">(</span><span class="ident" id="2620191">Second</span><span class="op" id="2620197">)</span>&nbsp;<span class="op" id="2620199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620203">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620260">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620295">var</span>&nbsp;<span class="ident" id="2620299">prec</span>&nbsp;<span class="builtintype" id="2620304">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620310">w</span><span class="op" id="2620311">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620316">buf</span><span class="op" id="2620319">[</span><span class="ident" id="2620320">w</span><span class="op" id="2620321">]</span>&nbsp;<span class="op" id="2620323">=</span>&nbsp;<span class="string" id="2620325">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620331">w</span><span class="op" id="2620332">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620337">switch</span>&nbsp;<span class="op" id="2620344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620348">case</span>&nbsp;<span class="ident" id="2620353">u</span>&nbsp;<span class="op" id="2620355">==</span>&nbsp;<span class="num" id="2620358">0</span><span class="op" id="2620359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620364">return</span>&nbsp;<span class="string" id="2620371">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620377">case</span>&nbsp;<span class="ident" id="2620382">u</span>&nbsp;<span class="op" id="2620384">&lt;</span>&nbsp;<span class="ident" id="2620386">uint64</span><span class="op" id="2620392">(</span><span class="ident" id="2620393">Microsecond</span><span class="op" id="2620404">)</span><span class="op" id="2620405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620410">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620434">prec</span>&nbsp;<span class="op" id="2620439">=</span>&nbsp;<span class="num" id="2620441">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620446">buf</span><span class="op" id="2620449">[</span><span class="ident" id="2620450">w</span><span class="op" id="2620451">]</span>&nbsp;<span class="op" id="2620453">=</span>&nbsp;<span class="string" id="2620455">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620461">case</span>&nbsp;<span class="ident" id="2620466">u</span>&nbsp;<span class="op" id="2620468">&lt;</span>&nbsp;<span class="ident" id="2620470">uint64</span><span class="op" id="2620476">(</span><span class="ident" id="2620477">Millisecond</span><span class="op" id="2620488">)</span><span class="op" id="2620489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620494">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620519">prec</span>&nbsp;<span class="op" id="2620524">=</span>&nbsp;<span class="num" id="2620526">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620531">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620573">w</span><span class="op" id="2620574">--</span>&nbsp;<span class="comment" id="2620577">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2620608">copy</span><span class="op" id="2620612">(</span><span class="ident" id="2620613">buf</span><span class="op" id="2620616">[</span><span class="ident" id="2620617">w</span><span class="op" id="2620618">:</span><span class="op" id="2620619">]</span><span class="op" id="2620620">,</span>&nbsp;<span class="string" id="2620622">&#34;µ&#34;</span><span class="op" id="2620626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620630">default</span><span class="op" id="2620637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620642">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620667">prec</span>&nbsp;<span class="op" id="2620672">=</span>&nbsp;<span class="num" id="2620674">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620679">buf</span><span class="op" id="2620682">[</span><span class="ident" id="2620683">w</span><span class="op" id="2620684">]</span>&nbsp;<span class="op" id="2620686">=</span>&nbsp;<span class="string" id="2620688">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620698">w</span><span class="op" id="2620699">,</span>&nbsp;<span class="ident" id="2620701">u</span>&nbsp;<span class="op" id="2620703">=</span>&nbsp;<span class="ident" id="2620705">fmtFrac</span><span class="op" id="2620712">(</span><span class="ident" id="2620713">buf</span><span class="op" id="2620716">[</span><span class="op" id="2620717">:</span><span class="ident" id="2620718">w</span><span class="op" id="2620719">]</span><span class="op" id="2620720">,</span>&nbsp;<span class="ident" id="2620722">u</span><span class="op" id="2620723">,</span>&nbsp;<span class="ident" id="2620725">prec</span><span class="op" id="2620729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620733">w</span>&nbsp;<span class="op" id="2620735">=</span>&nbsp;<span class="ident" id="2620737">fmtInt</span><span class="op" id="2620743">(</span><span class="ident" id="2620744">buf</span><span class="op" id="2620747">[</span><span class="op" id="2620748">:</span><span class="ident" id="2620749">w</span><span class="op" id="2620750">]</span><span class="op" id="2620751">,</span>&nbsp;<span class="ident" id="2620753">u</span><span class="op" id="2620754">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620757">}</span>&nbsp;<span class="keyword" id="2620759">else</span>&nbsp;<span class="op" id="2620764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620768">w</span><span class="op" id="2620769">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620774">buf</span><span class="op" id="2620777">[</span><span class="ident" id="2620778">w</span><span class="op" id="2620779">]</span>&nbsp;<span class="op" id="2620781">=</span>&nbsp;<span class="string" id="2620783">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620790">w</span><span class="op" id="2620791">,</span>&nbsp;<span class="ident" id="2620793">u</span>&nbsp;<span class="op" id="2620795">=</span>&nbsp;<span class="ident" id="2620797">fmtFrac</span><span class="op" id="2620804">(</span><span class="ident" id="2620805">buf</span><span class="op" id="2620808">[</span><span class="op" id="2620809">:</span><span class="ident" id="2620810">w</span><span class="op" id="2620811">]</span><span class="op" id="2620812">,</span>&nbsp;<span class="ident" id="2620814">u</span><span class="op" id="2620815">,</span>&nbsp;<span class="num" id="2620817">9</span><span class="op" id="2620818">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620823">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620853">w</span>&nbsp;<span class="op" id="2620855">=</span>&nbsp;<span class="ident" id="2620857">fmtInt</span><span class="op" id="2620863">(</span><span class="ident" id="2620864">buf</span><span class="op" id="2620867">[</span><span class="op" id="2620868">:</span><span class="ident" id="2620869">w</span><span class="op" id="2620870">]</span><span class="op" id="2620871">,</span>&nbsp;<span class="ident" id="2620873">u</span><span class="op" id="2620874">%</span><span class="num" id="2620875">60</span><span class="op" id="2620877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620881">u</span>&nbsp;<span class="op" id="2620883">/=</span>&nbsp;<span class="num" id="2620886">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2620892">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620922">if</span>&nbsp;<span class="ident" id="2620925">u</span>&nbsp;<span class="op" id="2620927">&gt;</span>&nbsp;<span class="num" id="2620929">0</span>&nbsp;<span class="op" id="2620931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620936">w</span><span class="op" id="2620937">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620943">buf</span><span class="op" id="2620946">[</span><span class="ident" id="2620947">w</span><span class="op" id="2620948">]</span>&nbsp;<span class="op" id="2620950">=</span>&nbsp;<span class="string" id="2620952">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620959">w</span>&nbsp;<span class="op" id="2620961">=</span>&nbsp;<span class="ident" id="2620963">fmtInt</span><span class="op" id="2620969">(</span><span class="ident" id="2620970">buf</span><span class="op" id="2620973">[</span><span class="op" id="2620974">:</span><span class="ident" id="2620975">w</span><span class="op" id="2620976">]</span><span class="op" id="2620977">,</span>&nbsp;<span class="ident" id="2620979">u</span><span class="op" id="2620980">%</span><span class="num" id="2620981">60</span><span class="op" id="2620983">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620988">u</span>&nbsp;<span class="op" id="2620990">/=</span>&nbsp;<span class="num" id="2620993">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2621000">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2621029">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621088">if</span>&nbsp;<span class="ident" id="2621091">u</span>&nbsp;<span class="op" id="2621093">&gt;</span>&nbsp;<span class="num" id="2621095">0</span>&nbsp;<span class="op" id="2621097">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621103">w</span><span class="op" id="2621104">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621111">buf</span><span class="op" id="2621114">[</span><span class="ident" id="2621115">w</span><span class="op" id="2621116">]</span>&nbsp;<span class="op" id="2621118">=</span>&nbsp;<span class="string" id="2621120">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621128">w</span>&nbsp;<span class="op" id="2621130">=</span>&nbsp;<span class="ident" id="2621132">fmtInt</span><span class="op" id="2621138">(</span><span class="ident" id="2621139">buf</span><span class="op" id="2621142">[</span><span class="op" id="2621143">:</span><span class="ident" id="2621144">w</span><span class="op" id="2621145">]</span><span class="op" id="2621146">,</span>&nbsp;<span class="ident" id="2621148">u</span><span class="op" id="2621149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621158">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621165">if</span>&nbsp;<span class="ident" id="2621168">neg</span>&nbsp;<span class="op" id="2621172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621176">w</span><span class="op" id="2621177">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621182">buf</span><span class="op" id="2621185">[</span><span class="ident" id="2621186">w</span><span class="op" id="2621187">]</span>&nbsp;<span class="op" id="2621189">=</span>&nbsp;<span class="string" id="2621191">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621200">return</span>&nbsp;<span class="builtintype" id="2621207">string</span><span class="op" id="2621213">(</span><span class="ident" id="2621214">buf</span><span class="op" id="2621217">[</span><span class="ident" id="2621218">w</span><span class="op" id="2621219">:</span><span class="op" id="2621220">]</span><span class="op" id="2621221">)</span><br>
<span class="lineno"></span><span class="op" id="2621223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2621226">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2621298">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2621361">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2621430">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2621478">func</span>&nbsp;<span class="ident" id="2621483">fmtFrac</span><span class="op" id="2621490">(</span><span class="ident" id="2621491">buf</span>&nbsp;<span class="op" id="2621495">[</span><span class="op" id="2621496">]</span><span class="builtintype" id="2621497">byte</span><span class="op" id="2621501">,</span>&nbsp;<span class="ident" id="2621503">v</span>&nbsp;<span class="ident" id="2621505">uint64</span><span class="op" id="2621511">,</span>&nbsp;<span class="ident" id="2621513">prec</span>&nbsp;<span class="builtintype" id="2621518">int</span><span class="op" id="2621521">)</span>&nbsp;<span class="op" id="2621523">(</span><span class="ident" id="2621524">nw</span>&nbsp;<span class="builtintype" id="2621527">int</span><span class="op" id="2621530">,</span>&nbsp;<span class="ident" id="2621532">nv</span>&nbsp;<span class="ident" id="2621535">uint64</span><span class="op" id="2621541">)</span>&nbsp;<span class="op" id="2621543">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2621546">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621605">w</span>&nbsp;<span class="op" id="2621607">:=</span>&nbsp;<span class="builtinfunc" id="2621610">len</span><span class="op" id="2621613">(</span><span class="ident" id="2621614">buf</span><span class="op" id="2621617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2621620">print</span>&nbsp;<span class="op" id="2621626">:=</span>&nbsp;<span class="builtintype" id="2621629">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621636">for</span>&nbsp;<span class="ident" id="2621640">i</span>&nbsp;<span class="op" id="2621642">:=</span>&nbsp;<span class="num" id="2621645">0</span><span class="op" id="2621646">;</span>&nbsp;<span class="ident" id="2621648">i</span>&nbsp;<span class="op" id="2621650">&lt;</span>&nbsp;<span class="ident" id="2621652">prec</span><span class="op" id="2621656">;</span>&nbsp;<span class="ident" id="2621658">i</span><span class="op" id="2621659">++</span>&nbsp;<span class="op" id="2621662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621666">digit</span>&nbsp;<span class="op" id="2621672">:=</span>&nbsp;<span class="ident" id="2621675">v</span>&nbsp;<span class="op" id="2621677">%</span>&nbsp;<span class="num" id="2621679">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2621684">print</span>&nbsp;<span class="op" id="2621690">=</span>&nbsp;<span class="builtinfunc" id="2621692">print</span>&nbsp;<span class="op" id="2621698">||</span>&nbsp;<span class="ident" id="2621701">digit</span>&nbsp;<span class="op" id="2621707">!=</span>&nbsp;<span class="num" id="2621710">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621714">if</span>&nbsp;<span class="builtinfunc" id="2621717">print</span>&nbsp;<span class="op" id="2621723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621728">w</span><span class="op" id="2621729">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621735">buf</span><span class="op" id="2621738">[</span><span class="ident" id="2621739">w</span><span class="op" id="2621740">]</span>&nbsp;<span class="op" id="2621742">=</span>&nbsp;<span class="builtintype" id="2621744">byte</span><span class="op" id="2621748">(</span><span class="ident" id="2621749">digit</span><span class="op" id="2621754">)</span>&nbsp;<span class="op" id="2621756">+</span>&nbsp;<span class="string" id="2621758">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621764">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621768">v</span>&nbsp;<span class="op" id="2621770">/=</span>&nbsp;<span class="num" id="2621773">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621780">if</span>&nbsp;<span class="builtinfunc" id="2621783">print</span>&nbsp;<span class="op" id="2621789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621793">w</span><span class="op" id="2621794">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621799">buf</span><span class="op" id="2621802">[</span><span class="ident" id="2621803">w</span><span class="op" id="2621804">]</span>&nbsp;<span class="op" id="2621806">=</span>&nbsp;<span class="string" id="2621808">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621816">return</span>&nbsp;<span class="ident" id="2621823">w</span><span class="op" id="2621824">,</span>&nbsp;<span class="ident" id="2621826">v</span><br>
<span class="lineno"></span><span class="op" id="2621828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2621831">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2621873">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2621922">func</span>&nbsp;<span class="ident" id="2621927">fmtInt</span><span class="op" id="2621933">(</span><span class="ident" id="2621934">buf</span>&nbsp;<span class="op" id="2621938">[</span><span class="op" id="2621939">]</span><span class="builtintype" id="2621940">byte</span><span class="op" id="2621944">,</span>&nbsp;<span class="ident" id="2621946">v</span>&nbsp;<span class="ident" id="2621948">uint64</span><span class="op" id="2621954">)</span>&nbsp;<span class="builtintype" id="2621956">int</span>&nbsp;<span class="op" id="2621960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621963">w</span>&nbsp;<span class="op" id="2621965">:=</span>&nbsp;<span class="builtinfunc" id="2621968">len</span><span class="op" id="2621971">(</span><span class="ident" id="2621972">buf</span><span class="op" id="2621975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621978">if</span>&nbsp;<span class="ident" id="2621981">v</span>&nbsp;<span class="op" id="2621983">==</span>&nbsp;<span class="num" id="2621986">0</span>&nbsp;<span class="op" id="2621988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621992">w</span><span class="op" id="2621993">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621998">buf</span><span class="op" id="2622001">[</span><span class="ident" id="2622002">w</span><span class="op" id="2622003">]</span>&nbsp;<span class="op" id="2622005">=</span>&nbsp;<span class="string" id="2622007">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622012">}</span>&nbsp;<span class="keyword" id="2622014">else</span>&nbsp;<span class="op" id="2622019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622023">for</span>&nbsp;<span class="ident" id="2622027">v</span>&nbsp;<span class="op" id="2622029">&gt;</span>&nbsp;<span class="num" id="2622031">0</span>&nbsp;<span class="op" id="2622033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622038">w</span><span class="op" id="2622039">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622045">buf</span><span class="op" id="2622048">[</span><span class="ident" id="2622049">w</span><span class="op" id="2622050">]</span>&nbsp;<span class="op" id="2622052">=</span>&nbsp;<span class="builtintype" id="2622054">byte</span><span class="op" id="2622058">(</span><span class="ident" id="2622059">v</span><span class="op" id="2622060">%</span><span class="num" id="2622061">10</span><span class="op" id="2622063">)</span>&nbsp;<span class="op" id="2622065">+</span>&nbsp;<span class="string" id="2622067">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622074">v</span>&nbsp;<span class="op" id="2622076">/=</span>&nbsp;<span class="num" id="2622079">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622090">return</span>&nbsp;<span class="ident" id="2622097">w</span><br>
<span class="lineno"></span><span class="op" id="2622099">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2622102">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2622170">func</span>&nbsp;<span class="op" id="2622175">(</span><span class="ident" id="2622176">d</span>&nbsp;<span class="ident" id="2622178">Duration</span><span class="op" id="2622186">)</span>&nbsp;<span class="ident" id="2622188">Nanoseconds</span><span class="op" id="2622199">(</span><span class="op" id="2622200">)</span>&nbsp;<span class="ident" id="2622202">int64</span>&nbsp;<span class="op" id="2622208">{</span>&nbsp;<span class="keyword" id="2622210">return</span>&nbsp;<span class="ident" id="2622217">int64</span><span class="op" id="2622222">(</span><span class="ident" id="2622223">d</span><span class="op" id="2622224">)</span>&nbsp;<span class="op" id="2622226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2622229">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2622282">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2622349">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2622419">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2622483">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2622548">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2622612">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2622675">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2622692">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2622763">func</span>&nbsp;<span class="op" id="2622768">(</span><span class="ident" id="2622769">d</span>&nbsp;<span class="ident" id="2622771">Duration</span><span class="op" id="2622779">)</span>&nbsp;<span class="ident" id="2622781">Seconds</span><span class="op" id="2622788">(</span><span class="op" id="2622789">)</span>&nbsp;<span class="builtintype" id="2622791">float64</span>&nbsp;<span class="op" id="2622799">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622802">sec</span>&nbsp;<span class="op" id="2622806">:=</span>&nbsp;<span class="ident" id="2622809">d</span>&nbsp;<span class="op" id="2622811">/</span>&nbsp;<span class="ident" id="2622813">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622821">nsec</span>&nbsp;<span class="op" id="2622826">:=</span>&nbsp;<span class="ident" id="2622829">d</span>&nbsp;<span class="op" id="2622831">%</span>&nbsp;<span class="ident" id="2622833">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622841">return</span>&nbsp;<span class="builtintype" id="2622848">float64</span><span class="op" id="2622855">(</span><span class="ident" id="2622856">sec</span><span class="op" id="2622859">)</span>&nbsp;<span class="op" id="2622861">+</span>&nbsp;<span class="builtintype" id="2622863">float64</span><span class="op" id="2622870">(</span><span class="ident" id="2622871">nsec</span><span class="op" id="2622875">)</span><span class="op" id="2622876">*</span><span class="num" id="2622877">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2622882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2622885">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2622956">func</span>&nbsp;<span class="op" id="2622961">(</span><span class="ident" id="2622962">d</span>&nbsp;<span class="ident" id="2622964">Duration</span><span class="op" id="2622972">)</span>&nbsp;<span class="ident" id="2622974">Minutes</span><span class="op" id="2622981">(</span><span class="op" id="2622982">)</span>&nbsp;<span class="builtintype" id="2622984">float64</span>&nbsp;<span class="op" id="2622992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622995">min</span>&nbsp;<span class="op" id="2622999">:=</span>&nbsp;<span class="ident" id="2623002">d</span>&nbsp;<span class="op" id="2623004">/</span>&nbsp;<span class="ident" id="2623006">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623014">nsec</span>&nbsp;<span class="op" id="2623019">:=</span>&nbsp;<span class="ident" id="2623022">d</span>&nbsp;<span class="op" id="2623024">%</span>&nbsp;<span class="ident" id="2623026">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623034">return</span>&nbsp;<span class="builtintype" id="2623041">float64</span><span class="op" id="2623048">(</span><span class="ident" id="2623049">min</span><span class="op" id="2623052">)</span>&nbsp;<span class="op" id="2623054">+</span>&nbsp;<span class="builtintype" id="2623056">float64</span><span class="op" id="2623063">(</span><span class="ident" id="2623064">nsec</span><span class="op" id="2623068">)</span><span class="op" id="2623069">*</span><span class="op" id="2623070">(</span><span class="num" id="2623071">1e-9</span><span class="op" id="2623075">/</span><span class="num" id="2623076">60</span><span class="op" id="2623078">)</span><br>
<span class="lineno">600</span><span class="op" id="2623080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2623083">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2623150">func</span>&nbsp;<span class="op" id="2623155">(</span><span class="ident" id="2623156">d</span>&nbsp;<span class="ident" id="2623158">Duration</span><span class="op" id="2623166">)</span>&nbsp;<span class="ident" id="2623168">Hours</span><span class="op" id="2623173">(</span><span class="op" id="2623174">)</span>&nbsp;<span class="builtintype" id="2623176">float64</span>&nbsp;<span class="op" id="2623184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623187">hour</span>&nbsp;<span class="op" id="2623192">:=</span>&nbsp;<span class="ident" id="2623195">d</span>&nbsp;<span class="op" id="2623197">/</span>&nbsp;<span class="ident" id="2623199">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623205">nsec</span>&nbsp;<span class="op" id="2623210">:=</span>&nbsp;<span class="ident" id="2623213">d</span>&nbsp;<span class="op" id="2623215">%</span>&nbsp;<span class="ident" id="2623217">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623223">return</span>&nbsp;<span class="builtintype" id="2623230">float64</span><span class="op" id="2623237">(</span><span class="ident" id="2623238">hour</span><span class="op" id="2623242">)</span>&nbsp;<span class="op" id="2623244">+</span>&nbsp;<span class="builtintype" id="2623246">float64</span><span class="op" id="2623253">(</span><span class="ident" id="2623254">nsec</span><span class="op" id="2623258">)</span><span class="op" id="2623259">*</span><span class="op" id="2623260">(</span><span class="num" id="2623261">1e-9</span><span class="op" id="2623265">/</span><span class="num" id="2623266">60</span><span class="op" id="2623268">/</span><span class="num" id="2623269">60</span><span class="op" id="2623271">)</span><br>
<span class="lineno"></span><span class="op" id="2623273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2623276">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2623305">func</span>&nbsp;<span class="op" id="2623310">(</span><span class="ident" id="2623311">t</span>&nbsp;<span class="ident" id="2623313">Time</span><span class="op" id="2623317">)</span>&nbsp;<span class="ident" id="2623319">Add</span><span class="op" id="2623322">(</span><span class="ident" id="2623323">d</span>&nbsp;<span class="ident" id="2623325">Duration</span><span class="op" id="2623333">)</span>&nbsp;<span class="ident" id="2623335">Time</span>&nbsp;<span class="op" id="2623340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623343">t</span><span class="op" id="2623344">.</span><span class="ident" id="2623345">sec</span>&nbsp;<span class="op" id="2623349">+=</span>&nbsp;<span class="ident" id="2623352">int64</span><span class="op" id="2623357">(</span><span class="ident" id="2623358">d</span>&nbsp;<span class="op" id="2623360">/</span>&nbsp;<span class="num" id="2623362">1e9</span><span class="op" id="2623365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623368">nsec</span>&nbsp;<span class="op" id="2623373">:=</span>&nbsp;<span class="builtintype" id="2623376">int32</span><span class="op" id="2623381">(</span><span class="ident" id="2623382">t</span><span class="op" id="2623383">.</span><span class="ident" id="2623384">nsec</span><span class="op" id="2623388">)</span>&nbsp;<span class="op" id="2623390">+</span>&nbsp;<span class="builtintype" id="2623392">int32</span><span class="op" id="2623397">(</span><span class="ident" id="2623398">d</span><span class="op" id="2623399">%</span><span class="num" id="2623400">1e9</span><span class="op" id="2623403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623406">if</span>&nbsp;<span class="ident" id="2623409">nsec</span>&nbsp;<span class="op" id="2623414">&gt;=</span>&nbsp;<span class="num" id="2623417">1e9</span>&nbsp;<span class="op" id="2623421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623425">t</span><span class="op" id="2623426">.</span><span class="ident" id="2623427">sec</span><span class="op" id="2623430">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623435">nsec</span>&nbsp;<span class="op" id="2623440">-=</span>&nbsp;<span class="num" id="2623443">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623448">}</span>&nbsp;<span class="keyword" id="2623450">else</span>&nbsp;<span class="keyword" id="2623455">if</span>&nbsp;<span class="ident" id="2623458">nsec</span>&nbsp;<span class="op" id="2623463">&lt;</span>&nbsp;<span class="num" id="2623465">0</span>&nbsp;<span class="op" id="2623467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623471">t</span><span class="op" id="2623472">.</span><span class="ident" id="2623473">sec</span><span class="op" id="2623476">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623481">nsec</span>&nbsp;<span class="op" id="2623486">+=</span>&nbsp;<span class="num" id="2623489">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623494">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623497">t</span><span class="op" id="2623498">.</span><span class="ident" id="2623499">nsec</span>&nbsp;<span class="op" id="2623504">=</span>&nbsp;<span class="ident" id="2623506">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623512">return</span>&nbsp;<span class="ident" id="2623519">t</span><br>
<span class="lineno"></span><span class="op" id="2623521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2623524">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2623604">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2623681">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2623702">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2623753">func</span>&nbsp;<span class="op" id="2623758">(</span><span class="ident" id="2623759">t</span>&nbsp;<span class="ident" id="2623761">Time</span><span class="op" id="2623765">)</span>&nbsp;<span class="ident" id="2623767">Sub</span><span class="op" id="2623770">(</span><span class="ident" id="2623771">u</span>&nbsp;<span class="ident" id="2623773">Time</span><span class="op" id="2623777">)</span>&nbsp;<span class="ident" id="2623779">Duration</span>&nbsp;<span class="op" id="2623788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623791">d</span>&nbsp;<span class="op" id="2623793">:=</span>&nbsp;<span class="ident" id="2623796">Duration</span><span class="op" id="2623804">(</span><span class="ident" id="2623805">t</span><span class="op" id="2623806">.</span><span class="ident" id="2623807">sec</span><span class="op" id="2623810">-</span><span class="ident" id="2623811">u</span><span class="op" id="2623812">.</span><span class="ident" id="2623813">sec</span><span class="op" id="2623816">)</span><span class="op" id="2623817">*</span><span class="ident" id="2623818">Second</span>&nbsp;<span class="op" id="2623825">+</span>&nbsp;<span class="ident" id="2623827">Duration</span><span class="op" id="2623835">(</span><span class="builtintype" id="2623836">int32</span><span class="op" id="2623841">(</span><span class="ident" id="2623842">t</span><span class="op" id="2623843">.</span><span class="ident" id="2623844">nsec</span><span class="op" id="2623848">)</span><span class="op" id="2623849">-</span><span class="builtintype" id="2623850">int32</span><span class="op" id="2623855">(</span><span class="ident" id="2623856">u</span><span class="op" id="2623857">.</span><span class="ident" id="2623858">nsec</span><span class="op" id="2623862">)</span><span class="op" id="2623863">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2623866">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623903">switch</span>&nbsp;<span class="op" id="2623910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623913">case</span>&nbsp;<span class="ident" id="2623918">u</span><span class="op" id="2623919">.</span><span class="ident" id="2623920">Add</span><span class="op" id="2623923">(</span><span class="ident" id="2623924">d</span><span class="op" id="2623925">)</span><span class="op" id="2623926">.</span><span class="ident" id="2623927">Equal</span><span class="op" id="2623932">(</span><span class="ident" id="2623933">t</span><span class="op" id="2623934">)</span><span class="op" id="2623935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623939">return</span>&nbsp;<span class="ident" id="2623946">d</span>&nbsp;<span class="comment" id="2623948">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623965">case</span>&nbsp;<span class="ident" id="2623970">t</span><span class="op" id="2623971">.</span><span class="ident" id="2623972">Before</span><span class="op" id="2623978">(</span><span class="ident" id="2623979">u</span><span class="op" id="2623980">)</span><span class="op" id="2623981">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623985">return</span>&nbsp;<span class="ident" id="2623992">minDuration</span>&nbsp;<span class="comment" id="2624004">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624039">default</span><span class="op" id="2624046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624050">return</span>&nbsp;<span class="ident" id="2624057">maxDuration</span>&nbsp;<span class="comment" id="2624069">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624104">}</span><br>
<span class="lineno"></span><span class="op" id="2624106">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2624109">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2624152">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2624194">func</span>&nbsp;<span class="ident" id="2624199">Since</span><span class="op" id="2624204">(</span><span class="ident" id="2624205">t</span>&nbsp;<span class="ident" id="2624207">Time</span><span class="op" id="2624211">)</span>&nbsp;<span class="ident" id="2624213">Duration</span>&nbsp;<span class="op" id="2624222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624225">return</span>&nbsp;<span class="ident" id="2624232">Now</span><span class="op" id="2624235">(</span><span class="op" id="2624236">)</span><span class="op" id="2624237">.</span><span class="ident" id="2624238">Sub</span><span class="op" id="2624241">(</span><span class="ident" id="2624242">t</span><span class="op" id="2624243">)</span><br>
<span class="lineno">645</span><span class="op" id="2624245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2624248">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2624304">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2624353">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2624414">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2624440">//</span><br>
<span class="lineno"></span><span class="comment" id="2624443">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2624508">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2624566">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2624618">func</span>&nbsp;<span class="op" id="2624623">(</span><span class="ident" id="2624624">t</span>&nbsp;<span class="ident" id="2624626">Time</span><span class="op" id="2624630">)</span>&nbsp;<span class="ident" id="2624632">AddDate</span><span class="op" id="2624639">(</span><span class="ident" id="2624640">years</span>&nbsp;<span class="builtintype" id="2624646">int</span><span class="op" id="2624649">,</span>&nbsp;<span class="ident" id="2624651">months</span>&nbsp;<span class="builtintype" id="2624658">int</span><span class="op" id="2624661">,</span>&nbsp;<span class="ident" id="2624663">days</span>&nbsp;<span class="builtintype" id="2624668">int</span><span class="op" id="2624671">)</span>&nbsp;<span class="ident" id="2624673">Time</span>&nbsp;<span class="op" id="2624678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624681">year</span><span class="op" id="2624685">,</span>&nbsp;<span class="ident" id="2624687">month</span><span class="op" id="2624692">,</span>&nbsp;<span class="ident" id="2624694">day</span>&nbsp;<span class="op" id="2624698">:=</span>&nbsp;<span class="ident" id="2624701">t</span><span class="op" id="2624702">.</span><span class="ident" id="2624703">Date</span><span class="op" id="2624707">(</span><span class="op" id="2624708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624711">hour</span><span class="op" id="2624715">,</span>&nbsp;<span class="ident" id="2624717">min</span><span class="op" id="2624720">,</span>&nbsp;<span class="ident" id="2624722">sec</span>&nbsp;<span class="op" id="2624726">:=</span>&nbsp;<span class="ident" id="2624729">t</span><span class="op" id="2624730">.</span><span class="ident" id="2624731">Clock</span><span class="op" id="2624736">(</span><span class="op" id="2624737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624740">return</span>&nbsp;<span class="ident" id="2624747">Date</span><span class="op" id="2624751">(</span><span class="ident" id="2624752">year</span><span class="op" id="2624756">+</span><span class="ident" id="2624757">years</span><span class="op" id="2624762">,</span>&nbsp;<span class="ident" id="2624764">month</span><span class="op" id="2624769">+</span><span class="ident" id="2624770">Month</span><span class="op" id="2624775">(</span><span class="ident" id="2624776">months</span><span class="op" id="2624782">)</span><span class="op" id="2624783">,</span>&nbsp;<span class="ident" id="2624785">day</span><span class="op" id="2624788">+</span><span class="ident" id="2624789">days</span><span class="op" id="2624793">,</span>&nbsp;<span class="ident" id="2624795">hour</span><span class="op" id="2624799">,</span>&nbsp;<span class="ident" id="2624801">min</span><span class="op" id="2624804">,</span>&nbsp;<span class="ident" id="2624806">sec</span><span class="op" id="2624809">,</span>&nbsp;<span class="builtintype" id="2624811">int</span><span class="op" id="2624814">(</span><span class="ident" id="2624815">t</span><span class="op" id="2624816">.</span><span class="ident" id="2624817">nsec</span><span class="op" id="2624821">)</span><span class="op" id="2624822">,</span>&nbsp;<span class="ident" id="2624824">t</span><span class="op" id="2624825">.</span><span class="ident" id="2624826">loc</span><span class="op" id="2624829">)</span><br>
<span class="lineno"></span><span class="op" id="2624831">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2624834">const</span>&nbsp;<span class="op" id="2624840">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624843">secondsPerMinute</span>&nbsp;<span class="op" id="2624860">=</span>&nbsp;<span class="num" id="2624862">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624866">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2624883">=</span>&nbsp;<span class="num" id="2624885">60</span>&nbsp;<span class="op" id="2624888">*</span>&nbsp;<span class="num" id="2624890">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624894">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2624911">=</span>&nbsp;<span class="num" id="2624913">24</span>&nbsp;<span class="op" id="2624916">*</span>&nbsp;<span class="ident" id="2624918">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624934">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2624951">=</span>&nbsp;<span class="num" id="2624953">7</span>&nbsp;<span class="op" id="2624955">*</span>&nbsp;<span class="ident" id="2624957">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624972">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2624989">=</span>&nbsp;<span class="num" id="2624991">365</span><span class="op" id="2624994">*</span><span class="num" id="2624995">400</span>&nbsp;<span class="op" id="2624999">+</span>&nbsp;<span class="num" id="2625001">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625005">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2625022">=</span>&nbsp;<span class="num" id="2625024">365</span><span class="op" id="2625027">*</span><span class="num" id="2625028">100</span>&nbsp;<span class="op" id="2625032">+</span>&nbsp;<span class="num" id="2625034">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625038">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2625055">=</span>&nbsp;<span class="num" id="2625057">365</span><span class="op" id="2625060">*</span><span class="num" id="2625061">4</span>&nbsp;<span class="op" id="2625063">+</span>&nbsp;<span class="num" id="2625065">1</span><br>
<span class="lineno"></span><span class="op" id="2625067">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2625070">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2625130">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2625170">func</span>&nbsp;<span class="op" id="2625175">(</span><span class="ident" id="2625176">t</span>&nbsp;<span class="ident" id="2625178">Time</span><span class="op" id="2625182">)</span>&nbsp;<span class="ident" id="2625184">date</span><span class="op" id="2625188">(</span><span class="ident" id="2625189">full</span>&nbsp;<span class="builtintype" id="2625194">bool</span><span class="op" id="2625198">)</span>&nbsp;<span class="op" id="2625200">(</span><span class="ident" id="2625201">year</span>&nbsp;<span class="builtintype" id="2625206">int</span><span class="op" id="2625209">,</span>&nbsp;<span class="ident" id="2625211">month</span>&nbsp;<span class="ident" id="2625217">Month</span><span class="op" id="2625222">,</span>&nbsp;<span class="ident" id="2625224">day</span>&nbsp;<span class="builtintype" id="2625228">int</span><span class="op" id="2625231">,</span>&nbsp;<span class="ident" id="2625233">yday</span>&nbsp;<span class="builtintype" id="2625238">int</span><span class="op" id="2625241">)</span>&nbsp;<span class="op" id="2625243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625246">return</span>&nbsp;<span class="ident" id="2625253">absDate</span><span class="op" id="2625260">(</span><span class="ident" id="2625261">t</span><span class="op" id="2625262">.</span><span class="ident" id="2625263">abs</span><span class="op" id="2625266">(</span><span class="op" id="2625267">)</span><span class="op" id="2625268">,</span>&nbsp;<span class="ident" id="2625270">full</span><span class="op" id="2625274">)</span><br>
<span class="lineno">675</span><span class="op" id="2625276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2625279">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2625337">func</span>&nbsp;<span class="ident" id="2625342">absDate</span><span class="op" id="2625349">(</span><span class="ident" id="2625350">abs</span>&nbsp;<span class="ident" id="2625354">uint64</span><span class="op" id="2625360">,</span>&nbsp;<span class="ident" id="2625362">full</span>&nbsp;<span class="builtintype" id="2625367">bool</span><span class="op" id="2625371">)</span>&nbsp;<span class="op" id="2625373">(</span><span class="ident" id="2625374">year</span>&nbsp;<span class="builtintype" id="2625379">int</span><span class="op" id="2625382">,</span>&nbsp;<span class="ident" id="2625384">month</span>&nbsp;<span class="ident" id="2625390">Month</span><span class="op" id="2625395">,</span>&nbsp;<span class="ident" id="2625397">day</span>&nbsp;<span class="builtintype" id="2625401">int</span><span class="op" id="2625404">,</span>&nbsp;<span class="ident" id="2625406">yday</span>&nbsp;<span class="builtintype" id="2625411">int</span><span class="op" id="2625414">)</span>&nbsp;<span class="op" id="2625416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625419">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625448">d</span>&nbsp;<span class="op" id="2625450">:=</span>&nbsp;<span class="ident" id="2625453">abs</span>&nbsp;<span class="op" id="2625457">/</span>&nbsp;<span class="ident" id="2625459">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625475">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625508">n</span>&nbsp;<span class="op" id="2625510">:=</span>&nbsp;<span class="ident" id="2625513">d</span>&nbsp;<span class="op" id="2625515">/</span>&nbsp;<span class="ident" id="2625517">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625534">y</span>&nbsp;<span class="op" id="2625536">:=</span>&nbsp;<span class="num" id="2625539">400</span>&nbsp;<span class="op" id="2625543">*</span>&nbsp;<span class="ident" id="2625545">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625548">d</span>&nbsp;<span class="op" id="2625550">-=</span>&nbsp;<span class="ident" id="2625553">daysPer400Years</span>&nbsp;<span class="op" id="2625569">*</span>&nbsp;<span class="ident" id="2625571">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625575">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625604">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625667">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625731">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625778">n</span>&nbsp;<span class="op" id="2625780">=</span>&nbsp;<span class="ident" id="2625782">d</span>&nbsp;<span class="op" id="2625784">/</span>&nbsp;<span class="ident" id="2625786">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625803">n</span>&nbsp;<span class="op" id="2625805">-=</span>&nbsp;<span class="ident" id="2625808">n</span>&nbsp;<span class="op" id="2625810">&gt;&gt;</span>&nbsp;<span class="num" id="2625813">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625816">y</span>&nbsp;<span class="op" id="2625818">+=</span>&nbsp;<span class="num" id="2625821">100</span>&nbsp;<span class="op" id="2625825">*</span>&nbsp;<span class="ident" id="2625827">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625830">d</span>&nbsp;<span class="op" id="2625832">-=</span>&nbsp;<span class="ident" id="2625835">daysPer100Years</span>&nbsp;<span class="op" id="2625851">*</span>&nbsp;<span class="ident" id="2625853">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625857">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625884">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2625943">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625971">n</span>&nbsp;<span class="op" id="2625973">=</span>&nbsp;<span class="ident" id="2625975">d</span>&nbsp;<span class="op" id="2625977">/</span>&nbsp;<span class="ident" id="2625979">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625994">y</span>&nbsp;<span class="op" id="2625996">+=</span>&nbsp;<span class="num" id="2625999">4</span>&nbsp;<span class="op" id="2626001">*</span>&nbsp;<span class="ident" id="2626003">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626006">d</span>&nbsp;<span class="op" id="2626008">-=</span>&nbsp;<span class="ident" id="2626011">daysPer4Years</span>&nbsp;<span class="op" id="2626025">*</span>&nbsp;<span class="ident" id="2626027">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626031">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626072">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626139">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626200">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626225">n</span>&nbsp;<span class="op" id="2626227">=</span>&nbsp;<span class="ident" id="2626229">d</span>&nbsp;<span class="op" id="2626231">/</span>&nbsp;<span class="num" id="2626233">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626238">n</span>&nbsp;<span class="op" id="2626240">-=</span>&nbsp;<span class="ident" id="2626243">n</span>&nbsp;<span class="op" id="2626245">&gt;&gt;</span>&nbsp;<span class="num" id="2626248">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626251">y</span>&nbsp;<span class="op" id="2626253">+=</span>&nbsp;<span class="ident" id="2626256">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626259">d</span>&nbsp;<span class="op" id="2626261">-=</span>&nbsp;<span class="num" id="2626264">365</span>&nbsp;<span class="op" id="2626268">*</span>&nbsp;<span class="ident" id="2626270">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626274">year</span>&nbsp;<span class="op" id="2626279">=</span>&nbsp;<span class="builtintype" id="2626281">int</span><span class="op" id="2626284">(</span><span class="ident" id="2626285">int64</span><span class="op" id="2626290">(</span><span class="ident" id="2626291">y</span><span class="op" id="2626292">)</span>&nbsp;<span class="op" id="2626294">+</span>&nbsp;<span class="ident" id="2626296">absoluteZeroYear</span><span class="op" id="2626312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626315">yday</span>&nbsp;<span class="op" id="2626320">=</span>&nbsp;<span class="builtintype" id="2626322">int</span><span class="op" id="2626325">(</span><span class="ident" id="2626326">d</span><span class="op" id="2626327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626331">if</span>&nbsp;<span class="op" id="2626334">!</span><span class="ident" id="2626335">full</span>&nbsp;<span class="op" id="2626340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626344">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626356">day</span>&nbsp;<span class="op" id="2626360">=</span>&nbsp;<span class="ident" id="2626362">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626368">if</span>&nbsp;<span class="ident" id="2626371">isLeap</span><span class="op" id="2626377">(</span><span class="ident" id="2626378">year</span><span class="op" id="2626382">)</span>&nbsp;<span class="op" id="2626384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626388">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626403">switch</span>&nbsp;<span class="op" id="2626410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626414">case</span>&nbsp;<span class="ident" id="2626419">day</span>&nbsp;<span class="op" id="2626423">&gt;</span>&nbsp;<span class="num" id="2626425">31</span><span class="op" id="2626427">+</span><span class="num" id="2626428">29</span><span class="op" id="2626430">-</span><span class="num" id="2626431">1</span><span class="op" id="2626432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626437">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626484">day</span><span class="op" id="2626487">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626492">case</span>&nbsp;<span class="ident" id="2626497">day</span>&nbsp;<span class="op" id="2626501">==</span>&nbsp;<span class="num" id="2626504">31</span><span class="op" id="2626506">+</span><span class="num" id="2626507">29</span><span class="op" id="2626509">-</span><span class="num" id="2626510">1</span><span class="op" id="2626511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626516">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626532">month</span>&nbsp;<span class="op" id="2626538">=</span>&nbsp;<span class="ident" id="2626540">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626552">day</span>&nbsp;<span class="op" id="2626556">=</span>&nbsp;<span class="num" id="2626558">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626564">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626580">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2626643">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626708">month</span>&nbsp;<span class="op" id="2626714">=</span>&nbsp;<span class="ident" id="2626716">Month</span><span class="op" id="2626721">(</span><span class="ident" id="2626722">day</span>&nbsp;<span class="op" id="2626726">/</span>&nbsp;<span class="num" id="2626728">31</span><span class="op" id="2626730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626733">end</span>&nbsp;<span class="op" id="2626737">:=</span>&nbsp;<span class="builtintype" id="2626740">int</span><span class="op" id="2626743">(</span><span class="ident" id="2626744">daysBefore</span><span class="op" id="2626754">[</span><span class="ident" id="2626755">month</span><span class="op" id="2626760">+</span><span class="num" id="2626761">1</span><span class="op" id="2626762">]</span><span class="op" id="2626763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626766">var</span>&nbsp;<span class="ident" id="2626770">begin</span>&nbsp;<span class="builtintype" id="2626776">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626781">if</span>&nbsp;<span class="ident" id="2626784">day</span>&nbsp;<span class="op" id="2626788">&gt;=</span>&nbsp;<span class="ident" id="2626791">end</span>&nbsp;<span class="op" id="2626795">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626799">month</span><span class="op" id="2626804">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626809">begin</span>&nbsp;<span class="op" id="2626815">=</span>&nbsp;<span class="ident" id="2626817">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626822">}</span>&nbsp;<span class="keyword" id="2626824">else</span>&nbsp;<span class="op" id="2626829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626833">begin</span>&nbsp;<span class="op" id="2626839">=</span>&nbsp;<span class="builtintype" id="2626841">int</span><span class="op" id="2626844">(</span><span class="ident" id="2626845">daysBefore</span><span class="op" id="2626855">[</span><span class="ident" id="2626856">month</span><span class="op" id="2626861">]</span><span class="op" id="2626862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2626865">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626869">month</span><span class="op" id="2626874">++</span>&nbsp;<span class="comment" id="2626877">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626902">day</span>&nbsp;<span class="op" id="2626906">=</span>&nbsp;<span class="ident" id="2626908">day</span>&nbsp;<span class="op" id="2626912">-</span>&nbsp;<span class="ident" id="2626914">begin</span>&nbsp;<span class="op" id="2626920">+</span>&nbsp;<span class="num" id="2626922">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626925">return</span><br>
<span class="lineno"></span><span class="op" id="2626932">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2626935">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2626997">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2627061">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2627118">var</span>&nbsp;<span class="ident" id="2627122">daysBefore</span>&nbsp;<span class="op" id="2627133">=</span>&nbsp;<span class="op" id="2627135">[</span><span class="op" id="2627136">...</span><span class="op" id="2627139">]</span><span class="builtintype" id="2627140">int32</span><span class="op" id="2627145">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627148">0</span><span class="op" id="2627149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627152">31</span><span class="op" id="2627154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627157">31</span>&nbsp;<span class="op" id="2627160">+</span>&nbsp;<span class="num" id="2627162">28</span><span class="op" id="2627164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627167">31</span>&nbsp;<span class="op" id="2627170">+</span>&nbsp;<span class="num" id="2627172">28</span>&nbsp;<span class="op" id="2627175">+</span>&nbsp;<span class="num" id="2627177">31</span><span class="op" id="2627179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627182">31</span>&nbsp;<span class="op" id="2627185">+</span>&nbsp;<span class="num" id="2627187">28</span>&nbsp;<span class="op" id="2627190">+</span>&nbsp;<span class="num" id="2627192">31</span>&nbsp;<span class="op" id="2627195">+</span>&nbsp;<span class="num" id="2627197">30</span><span class="op" id="2627199">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627202">31</span>&nbsp;<span class="op" id="2627205">+</span>&nbsp;<span class="num" id="2627207">28</span>&nbsp;<span class="op" id="2627210">+</span>&nbsp;<span class="num" id="2627212">31</span>&nbsp;<span class="op" id="2627215">+</span>&nbsp;<span class="num" id="2627217">30</span>&nbsp;<span class="op" id="2627220">+</span>&nbsp;<span class="num" id="2627222">31</span><span class="op" id="2627224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627227">31</span>&nbsp;<span class="op" id="2627230">+</span>&nbsp;<span class="num" id="2627232">28</span>&nbsp;<span class="op" id="2627235">+</span>&nbsp;<span class="num" id="2627237">31</span>&nbsp;<span class="op" id="2627240">+</span>&nbsp;<span class="num" id="2627242">30</span>&nbsp;<span class="op" id="2627245">+</span>&nbsp;<span class="num" id="2627247">31</span>&nbsp;<span class="op" id="2627250">+</span>&nbsp;<span class="num" id="2627252">30</span><span class="op" id="2627254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627257">31</span>&nbsp;<span class="op" id="2627260">+</span>&nbsp;<span class="num" id="2627262">28</span>&nbsp;<span class="op" id="2627265">+</span>&nbsp;<span class="num" id="2627267">31</span>&nbsp;<span class="op" id="2627270">+</span>&nbsp;<span class="num" id="2627272">30</span>&nbsp;<span class="op" id="2627275">+</span>&nbsp;<span class="num" id="2627277">31</span>&nbsp;<span class="op" id="2627280">+</span>&nbsp;<span class="num" id="2627282">30</span>&nbsp;<span class="op" id="2627285">+</span>&nbsp;<span class="num" id="2627287">31</span><span class="op" id="2627289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627292">31</span>&nbsp;<span class="op" id="2627295">+</span>&nbsp;<span class="num" id="2627297">28</span>&nbsp;<span class="op" id="2627300">+</span>&nbsp;<span class="num" id="2627302">31</span>&nbsp;<span class="op" id="2627305">+</span>&nbsp;<span class="num" id="2627307">30</span>&nbsp;<span class="op" id="2627310">+</span>&nbsp;<span class="num" id="2627312">31</span>&nbsp;<span class="op" id="2627315">+</span>&nbsp;<span class="num" id="2627317">30</span>&nbsp;<span class="op" id="2627320">+</span>&nbsp;<span class="num" id="2627322">31</span>&nbsp;<span class="op" id="2627325">+</span>&nbsp;<span class="num" id="2627327">31</span><span class="op" id="2627329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627332">31</span>&nbsp;<span class="op" id="2627335">+</span>&nbsp;<span class="num" id="2627337">28</span>&nbsp;<span class="op" id="2627340">+</span>&nbsp;<span class="num" id="2627342">31</span>&nbsp;<span class="op" id="2627345">+</span>&nbsp;<span class="num" id="2627347">30</span>&nbsp;<span class="op" id="2627350">+</span>&nbsp;<span class="num" id="2627352">31</span>&nbsp;<span class="op" id="2627355">+</span>&nbsp;<span class="num" id="2627357">30</span>&nbsp;<span class="op" id="2627360">+</span>&nbsp;<span class="num" id="2627362">31</span>&nbsp;<span class="op" id="2627365">+</span>&nbsp;<span class="num" id="2627367">31</span>&nbsp;<span class="op" id="2627370">+</span>&nbsp;<span class="num" id="2627372">30</span><span class="op" id="2627374">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627377">31</span>&nbsp;<span class="op" id="2627380">+</span>&nbsp;<span class="num" id="2627382">28</span>&nbsp;<span class="op" id="2627385">+</span>&nbsp;<span class="num" id="2627387">31</span>&nbsp;<span class="op" id="2627390">+</span>&nbsp;<span class="num" id="2627392">30</span>&nbsp;<span class="op" id="2627395">+</span>&nbsp;<span class="num" id="2627397">31</span>&nbsp;<span class="op" id="2627400">+</span>&nbsp;<span class="num" id="2627402">30</span>&nbsp;<span class="op" id="2627405">+</span>&nbsp;<span class="num" id="2627407">31</span>&nbsp;<span class="op" id="2627410">+</span>&nbsp;<span class="num" id="2627412">31</span>&nbsp;<span class="op" id="2627415">+</span>&nbsp;<span class="num" id="2627417">30</span>&nbsp;<span class="op" id="2627420">+</span>&nbsp;<span class="num" id="2627422">31</span><span class="op" id="2627424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627427">31</span>&nbsp;<span class="op" id="2627430">+</span>&nbsp;<span class="num" id="2627432">28</span>&nbsp;<span class="op" id="2627435">+</span>&nbsp;<span class="num" id="2627437">31</span>&nbsp;<span class="op" id="2627440">+</span>&nbsp;<span class="num" id="2627442">30</span>&nbsp;<span class="op" id="2627445">+</span>&nbsp;<span class="num" id="2627447">31</span>&nbsp;<span class="op" id="2627450">+</span>&nbsp;<span class="num" id="2627452">30</span>&nbsp;<span class="op" id="2627455">+</span>&nbsp;<span class="num" id="2627457">31</span>&nbsp;<span class="op" id="2627460">+</span>&nbsp;<span class="num" id="2627462">31</span>&nbsp;<span class="op" id="2627465">+</span>&nbsp;<span class="num" id="2627467">30</span>&nbsp;<span class="op" id="2627470">+</span>&nbsp;<span class="num" id="2627472">31</span>&nbsp;<span class="op" id="2627475">+</span>&nbsp;<span class="num" id="2627477">30</span><span class="op" id="2627479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2627482">31</span>&nbsp;<span class="op" id="2627485">+</span>&nbsp;<span class="num" id="2627487">28</span>&nbsp;<span class="op" id="2627490">+</span>&nbsp;<span class="num" id="2627492">31</span>&nbsp;<span class="op" id="2627495">+</span>&nbsp;<span class="num" id="2627497">30</span>&nbsp;<span class="op" id="2627500">+</span>&nbsp;<span class="num" id="2627502">31</span>&nbsp;<span class="op" id="2627505">+</span>&nbsp;<span class="num" id="2627507">30</span>&nbsp;<span class="op" id="2627510">+</span>&nbsp;<span class="num" id="2627512">31</span>&nbsp;<span class="op" id="2627515">+</span>&nbsp;<span class="num" id="2627517">31</span>&nbsp;<span class="op" id="2627520">+</span>&nbsp;<span class="num" id="2627522">30</span>&nbsp;<span class="op" id="2627525">+</span>&nbsp;<span class="num" id="2627527">31</span>&nbsp;<span class="op" id="2627530">+</span>&nbsp;<span class="num" id="2627532">30</span>&nbsp;<span class="op" id="2627535">+</span>&nbsp;<span class="num" id="2627537">31</span><span class="op" id="2627539">,</span><br>
<span class="lineno"></span><span class="op" id="2627541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2627544">func</span>&nbsp;<span class="ident" id="2627549">daysIn</span><span class="op" id="2627555">(</span><span class="ident" id="2627556">m</span>&nbsp;<span class="ident" id="2627558">Month</span><span class="op" id="2627563">,</span>&nbsp;<span class="ident" id="2627565">year</span>&nbsp;<span class="builtintype" id="2627570">int</span><span class="op" id="2627573">)</span>&nbsp;<span class="builtintype" id="2627575">int</span>&nbsp;<span class="op" id="2627579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627582">if</span>&nbsp;<span class="ident" id="2627585">m</span>&nbsp;<span class="op" id="2627587">==</span>&nbsp;<span class="ident" id="2627590">February</span>&nbsp;<span class="op" id="2627599">&amp;&amp;</span>&nbsp;<span class="ident" id="2627602">isLeap</span><span class="op" id="2627608">(</span><span class="ident" id="2627609">year</span><span class="op" id="2627613">)</span>&nbsp;<span class="op" id="2627615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627619">return</span>&nbsp;<span class="num" id="2627626">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2627630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627633">return</span>&nbsp;<span class="builtintype" id="2627640">int</span><span class="op" id="2627643">(</span><span class="ident" id="2627644">daysBefore</span><span class="op" id="2627654">[</span><span class="ident" id="2627655">m</span><span class="op" id="2627656">]</span>&nbsp;<span class="op" id="2627658">-</span>&nbsp;<span class="ident" id="2627660">daysBefore</span><span class="op" id="2627670">[</span><span class="ident" id="2627671">m</span><span class="op" id="2627672">-</span><span class="num" id="2627673">1</span><span class="op" id="2627674">]</span><span class="op" id="2627675">)</span><br>
<span class="lineno">775</span><span class="op" id="2627677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627680">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2627712">func</span>&nbsp;<span class="ident" id="2627717">now</span><span class="op" id="2627720">(</span><span class="op" id="2627721">)</span>&nbsp;<span class="op" id="2627723">(</span><span class="ident" id="2627724">sec</span>&nbsp;<span class="ident" id="2627728">int64</span><span class="op" id="2627733">,</span>&nbsp;<span class="ident" id="2627735">nsec</span>&nbsp;<span class="builtintype" id="2627740">int32</span><span class="op" id="2627745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2627748">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2627787">func</span>&nbsp;<span class="ident" id="2627792">Now</span><span class="op" id="2627795">(</span><span class="op" id="2627796">)</span>&nbsp;<span class="ident" id="2627798">Time</span>&nbsp;<span class="op" id="2627803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627806">sec</span><span class="op" id="2627809">,</span>&nbsp;<span class="ident" id="2627811">nsec</span>&nbsp;<span class="op" id="2627816">:=</span>&nbsp;<span class="ident" id="2627819">now</span><span class="op" id="2627822">(</span><span class="op" id="2627823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627826">return</span>&nbsp;<span class="ident" id="2627833">Time</span><span class="op" id="2627837">{</span><span class="ident" id="2627838">sec</span>&nbsp;<span class="op" id="2627842">+</span>&nbsp;<span class="ident" id="2627844">unixToInternal</span><span class="op" id="2627858">,</span>&nbsp;<span class="ident" id="2627860">nsec</span><span class="op" id="2627864">,</span>&nbsp;<span class="ident" id="2627866">Local</span><span class="op" id="2627871">}</span><br>
<span class="lineno"></span><span class="op" id="2627873">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2627876">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2627923">func</span>&nbsp;<span class="op" id="2627928">(</span><span class="ident" id="2627929">t</span>&nbsp;<span class="ident" id="2627931">Time</span><span class="op" id="2627935">)</span>&nbsp;<span class="ident" id="2627937">UTC</span><span class="op" id="2627940">(</span><span class="op" id="2627941">)</span>&nbsp;<span class="ident" id="2627943">Time</span>&nbsp;<span class="op" id="2627948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627951">t</span><span class="op" id="2627952">.</span><span class="ident" id="2627953">loc</span>&nbsp;<span class="op" id="2627957">=</span>&nbsp;<span class="ident" id="2627959">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627964">return</span>&nbsp;<span class="ident" id="2627971">t</span><br>
<span class="lineno">790</span><span class="op" id="2627973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627976">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2628032">func</span>&nbsp;<span class="op" id="2628037">(</span><span class="ident" id="2628038">t</span>&nbsp;<span class="ident" id="2628040">Time</span><span class="op" id="2628044">)</span>&nbsp;<span class="ident" id="2628046">Local</span><span class="op" id="2628051">(</span><span class="op" id="2628052">)</span>&nbsp;<span class="ident" id="2628054">Time</span>&nbsp;<span class="op" id="2628059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628062">t</span><span class="op" id="2628063">.</span><span class="ident" id="2628064">loc</span>&nbsp;<span class="op" id="2628068">=</span>&nbsp;<span class="ident" id="2628070">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628077">return</span>&nbsp;<span class="ident" id="2628084">t</span><br>
<span class="lineno"></span><span class="op" id="2628086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2628089">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2628147">//</span><br>
<span class="lineno">800</span><span class="comment" id="2628150">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2628178">func</span>&nbsp;<span class="op" id="2628183">(</span><span class="ident" id="2628184">t</span>&nbsp;<span class="ident" id="2628186">Time</span><span class="op" id="2628190">)</span>&nbsp;<span class="ident" id="2628192">In</span><span class="op" id="2628194">(</span><span class="ident" id="2628195">loc</span>&nbsp;<span class="op" id="2628199">*</span><span class="ident" id="2628200">Location</span><span class="op" id="2628208">)</span>&nbsp;<span class="ident" id="2628210">Time</span>&nbsp;<span class="op" id="2628215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628218">if</span>&nbsp;<span class="ident" id="2628221">loc</span>&nbsp;<span class="op" id="2628225">==</span>&nbsp;<span class="ident" id="2628228">nil</span>&nbsp;<span class="op" id="2628232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2628236">panic</span><span class="op" id="2628241">(</span><span class="string" id="2628242">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2628285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628288">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628291">t</span><span class="op" id="2628292">.</span><span class="ident" id="2628293">loc</span>&nbsp;<span class="op" id="2628297">=</span>&nbsp;<span class="ident" id="2628299">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628304">return</span>&nbsp;<span class="ident" id="2628311">t</span><br>
<span class="lineno"></span><span class="op" id="2628313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2628316">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2628381">func</span>&nbsp;<span class="op" id="2628386">(</span><span class="ident" id="2628387">t</span>&nbsp;<span class="ident" id="2628389">Time</span><span class="op" id="2628393">)</span>&nbsp;<span class="ident" id="2628395">Location</span><span class="op" id="2628403">(</span><span class="op" id="2628404">)</span>&nbsp;<span class="op" id="2628406">*</span><span class="ident" id="2628407">Location</span>&nbsp;<span class="op" id="2628416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628419">l</span>&nbsp;<span class="op" id="2628421">:=</span>&nbsp;<span class="ident" id="2628424">t</span><span class="op" id="2628425">.</span><span class="ident" id="2628426">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628431">if</span>&nbsp;<span class="ident" id="2628434">l</span>&nbsp;<span class="op" id="2628436">==</span>&nbsp;<span class="ident" id="2628439">nil</span>&nbsp;<span class="op" id="2628443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628447">l</span>&nbsp;<span class="op" id="2628449">=</span>&nbsp;<span class="ident" id="2628451">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628456">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628459">return</span>&nbsp;<span class="ident" id="2628466">l</span><br>
<span class="lineno"></span><span class="op" id="2628468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2628471">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2628549">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2628624">func</span>&nbsp;<span class="op" id="2628629">(</span><span class="ident" id="2628630">t</span>&nbsp;<span class="ident" id="2628632">Time</span><span class="op" id="2628636">)</span>&nbsp;<span class="ident" id="2628638">Zone</span><span class="op" id="2628642">(</span><span class="op" id="2628643">)</span>&nbsp;<span class="op" id="2628645">(</span><span class="ident" id="2628646">name</span>&nbsp;<span class="builtintype" id="2628651">string</span><span class="op" id="2628657">,</span>&nbsp;<span class="ident" id="2628659">offset</span>&nbsp;<span class="builtintype" id="2628666">int</span><span class="op" id="2628669">)</span>&nbsp;<span class="op" id="2628671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628674">name</span><span class="op" id="2628678">,</span>&nbsp;<span class="ident" id="2628680">offset</span><span class="op" id="2628686">,</span>&nbsp;<span class="ident" id="2628688">_</span><span class="op" id="2628689">,</span>&nbsp;<span class="ident" id="2628691">_</span><span class="op" id="2628692">,</span>&nbsp;<span class="ident" id="2628694">_</span>&nbsp;<span class="op" id="2628696">=</span>&nbsp;<span class="ident" id="2628698">t</span><span class="op" id="2628699">.</span><span class="ident" id="2628700">loc</span><span class="op" id="2628703">.</span><span class="ident" id="2628704">lookup</span><span class="op" id="2628710">(</span><span class="ident" id="2628711">t</span><span class="op" id="2628712">.</span><span class="ident" id="2628713">sec</span>&nbsp;<span class="op" id="2628717">+</span>&nbsp;<span class="ident" id="2628719">internalToUnix</span><span class="op" id="2628733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628736">return</span><br>
<span class="lineno"></span><span class="op" id="2628743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2628746">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2628810">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2628840">func</span>&nbsp;<span class="op" id="2628845">(</span><span class="ident" id="2628846">t</span>&nbsp;<span class="ident" id="2628848">Time</span><span class="op" id="2628852">)</span>&nbsp;<span class="ident" id="2628854">Unix</span><span class="op" id="2628858">(</span><span class="op" id="2628859">)</span>&nbsp;<span class="ident" id="2628861">int64</span>&nbsp;<span class="op" id="2628867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628870">return</span>&nbsp;<span class="ident" id="2628877">t</span><span class="op" id="2628878">.</span><span class="ident" id="2628879">sec</span>&nbsp;<span class="op" id="2628883">+</span>&nbsp;<span class="ident" id="2628885">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2628900">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2628903">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2628975">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2629046">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2629114">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2629185">func</span>&nbsp;<span class="op" id="2629190">(</span><span class="ident" id="2629191">t</span>&nbsp;<span class="ident" id="2629193">Time</span><span class="op" id="2629197">)</span>&nbsp;<span class="ident" id="2629199">UnixNano</span><span class="op" id="2629207">(</span><span class="op" id="2629208">)</span>&nbsp;<span class="ident" id="2629210">int64</span>&nbsp;<span class="op" id="2629216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629219">return</span>&nbsp;<span class="op" id="2629226">(</span><span class="ident" id="2629227">t</span><span class="op" id="2629228">.</span><span class="ident" id="2629229">sec</span><span class="op" id="2629232">+</span><span class="ident" id="2629233">internalToUnix</span><span class="op" id="2629247">)</span><span class="op" id="2629248">*</span><span class="num" id="2629249">1e9</span>&nbsp;<span class="op" id="2629253">+</span>&nbsp;<span class="ident" id="2629255">int64</span><span class="op" id="2629260">(</span><span class="ident" id="2629261">t</span><span class="op" id="2629262">.</span><span class="ident" id="2629263">nsec</span><span class="op" id="2629267">)</span><br>
<span class="lineno"></span><span class="op" id="2629269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2629272">const</span>&nbsp;<span class="ident" id="2629278">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2629296">byte</span>&nbsp;<span class="op" id="2629301">=</span>&nbsp;<span class="num" id="2629303">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2629306">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2629374">func</span>&nbsp;<span class="op" id="2629379">(</span><span class="ident" id="2629380">t</span>&nbsp;<span class="ident" id="2629382">Time</span><span class="op" id="2629386">)</span>&nbsp;<span class="ident" id="2629388">MarshalBinary</span><span class="op" id="2629401">(</span><span class="op" id="2629402">)</span>&nbsp;<span class="op" id="2629404">(</span><span class="op" id="2629405">[</span><span class="op" id="2629406">]</span><span class="builtintype" id="2629407">byte</span><span class="op" id="2629411">,</span>&nbsp;<span class="builtintype" id="2629413">error</span><span class="op" id="2629418">)</span>&nbsp;<span class="op" id="2629420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629423">var</span>&nbsp;<span class="ident" id="2629427">offsetMin</span>&nbsp;<span class="builtintype" id="2629437">int16</span>&nbsp;<span class="comment" id="2629443">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629480">if</span>&nbsp;<span class="ident" id="2629483">t</span><span class="op" id="2629484">.</span><span class="ident" id="2629485">Location</span><span class="op" id="2629493">(</span><span class="op" id="2629494">)</span>&nbsp;<span class="op" id="2629496">==</span>&nbsp;<span class="op" id="2629499">&amp;</span><span class="ident" id="2629500">utcLoc</span>&nbsp;<span class="op" id="2629507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629511">offsetMin</span>&nbsp;<span class="op" id="2629521">=</span>&nbsp;<span class="op" id="2629523">-</span><span class="num" id="2629524">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629527">}</span>&nbsp;<span class="keyword" id="2629529">else</span>&nbsp;<span class="op" id="2629534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629538">_</span><span class="op" id="2629539">,</span>&nbsp;<span class="ident" id="2629541">offset</span>&nbsp;<span class="op" id="2629548">:=</span>&nbsp;<span class="ident" id="2629551">t</span><span class="op" id="2629552">.</span><span class="ident" id="2629553">Zone</span><span class="op" id="2629557">(</span><span class="op" id="2629558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629562">if</span>&nbsp;<span class="ident" id="2629565">offset</span><span class="op" id="2629571">%</span><span class="num" id="2629572">60</span>&nbsp;<span class="op" id="2629575">!=</span>&nbsp;<span class="num" id="2629578">0</span>&nbsp;<span class="op" id="2629580">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629585">return</span>&nbsp;<span class="ident" id="2629592">nil</span><span class="op" id="2629595">,</span>&nbsp;<span class="ident" id="2629597">errors</span><span class="op" id="2629603">.</span><span class="ident" id="2629604">New</span><span class="op" id="2629607">(</span><span class="string" id="2629608">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2629663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629671">offset</span>&nbsp;<span class="op" id="2629678">/=</span>&nbsp;<span class="num" id="2629681">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629686">if</span>&nbsp;<span class="ident" id="2629689">offset</span>&nbsp;<span class="op" id="2629696">&lt;</span>&nbsp;<span class="op" id="2629698">-</span><span class="num" id="2629699">32768</span>&nbsp;<span class="op" id="2629705">||</span>&nbsp;<span class="ident" id="2629708">offset</span>&nbsp;<span class="op" id="2629715">==</span>&nbsp;<span class="op" id="2629718">-</span><span class="num" id="2629719">1</span>&nbsp;<span class="op" id="2629721">||</span>&nbsp;<span class="ident" id="2629724">offset</span>&nbsp;<span class="op" id="2629731">&gt;</span>&nbsp;<span class="num" id="2629733">32767</span>&nbsp;<span class="op" id="2629739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629744">return</span>&nbsp;<span class="ident" id="2629751">nil</span><span class="op" id="2629754">,</span>&nbsp;<span class="ident" id="2629756">errors</span><span class="op" id="2629762">.</span><span class="ident" id="2629763">New</span><span class="op" id="2629766">(</span><span class="string" id="2629767">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2629811">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629819">offsetMin</span>&nbsp;<span class="op" id="2629829">=</span>&nbsp;<span class="builtintype" id="2629831">int16</span><span class="op" id="2629836">(</span><span class="ident" id="2629837">offset</span><span class="op" id="2629843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629850">enc</span>&nbsp;<span class="op" id="2629854">:=</span>&nbsp;<span class="op" id="2629857">[</span><span class="op" id="2629858">]</span><span class="builtintype" id="2629859">byte</span><span class="op" id="2629863">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629867">timeBinaryVersion</span><span class="op" id="2629884">,</span>&nbsp;<span class="comment" id="2629886">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2629908">byte</span><span class="op" id="2629912">(</span><span class="ident" id="2629913">t</span><span class="op" id="2629914">.</span><span class="ident" id="2629915">sec</span>&nbsp;<span class="op" id="2629919">&gt;&gt;</span>&nbsp;<span class="num" id="2629922">56</span><span class="op" id="2629924">)</span><span class="op" id="2629925">,</span>&nbsp;<span class="comment" id="2629927">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2629951">byte</span><span class="op" id="2629955">(</span><span class="ident" id="2629956">t</span><span class="op" id="2629957">.</span><span class="ident" id="2629958">sec</span>&nbsp;<span class="op" id="2629962">&gt;&gt;</span>&nbsp;<span class="num" id="2629965">48</span><span class="op" id="2629967">)</span><span class="op" id="2629968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2629972">byte</span><span class="op" id="2629976">(</span><span class="ident" id="2629977">t</span><span class="op" id="2629978">.</span><span class="ident" id="2629979">sec</span>&nbsp;<span class="op" id="2629983">&gt;&gt;</span>&nbsp;<span class="num" id="2629986">40</span><span class="op" id="2629988">)</span><span class="op" id="2629989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2629993">byte</span><span class="op" id="2629997">(</span><span class="ident" id="2629998">t</span><span class="op" id="2629999">.</span><span class="ident" id="2630000">sec</span>&nbsp;<span class="op" id="2630004">&gt;&gt;</span>&nbsp;<span class="num" id="2630007">32</span><span class="op" id="2630009">)</span><span class="op" id="2630010">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630014">byte</span><span class="op" id="2630018">(</span><span class="ident" id="2630019">t</span><span class="op" id="2630020">.</span><span class="ident" id="2630021">sec</span>&nbsp;<span class="op" id="2630025">&gt;&gt;</span>&nbsp;<span class="num" id="2630028">24</span><span class="op" id="2630030">)</span><span class="op" id="2630031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630035">byte</span><span class="op" id="2630039">(</span><span class="ident" id="2630040">t</span><span class="op" id="2630041">.</span><span class="ident" id="2630042">sec</span>&nbsp;<span class="op" id="2630046">&gt;&gt;</span>&nbsp;<span class="num" id="2630049">16</span><span class="op" id="2630051">)</span><span class="op" id="2630052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630056">byte</span><span class="op" id="2630060">(</span><span class="ident" id="2630061">t</span><span class="op" id="2630062">.</span><span class="ident" id="2630063">sec</span>&nbsp;<span class="op" id="2630067">&gt;&gt;</span>&nbsp;<span class="num" id="2630070">8</span><span class="op" id="2630071">)</span><span class="op" id="2630072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630076">byte</span><span class="op" id="2630080">(</span><span class="ident" id="2630081">t</span><span class="op" id="2630082">.</span><span class="ident" id="2630083">sec</span><span class="op" id="2630086">)</span><span class="op" id="2630087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630091">byte</span><span class="op" id="2630095">(</span><span class="ident" id="2630096">t</span><span class="op" id="2630097">.</span><span class="ident" id="2630098">nsec</span>&nbsp;<span class="op" id="2630103">&gt;&gt;</span>&nbsp;<span class="num" id="2630106">24</span><span class="op" id="2630108">)</span><span class="op" id="2630109">,</span>&nbsp;<span class="comment" id="2630111">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630140">byte</span><span class="op" id="2630144">(</span><span class="ident" id="2630145">t</span><span class="op" id="2630146">.</span><span class="ident" id="2630147">nsec</span>&nbsp;<span class="op" id="2630152">&gt;&gt;</span>&nbsp;<span class="num" id="2630155">16</span><span class="op" id="2630157">)</span><span class="op" id="2630158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630162">byte</span><span class="op" id="2630166">(</span><span class="ident" id="2630167">t</span><span class="op" id="2630168">.</span><span class="ident" id="2630169">nsec</span>&nbsp;<span class="op" id="2630174">&gt;&gt;</span>&nbsp;<span class="num" id="2630177">8</span><span class="op" id="2630178">)</span><span class="op" id="2630179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630183">byte</span><span class="op" id="2630187">(</span><span class="ident" id="2630188">t</span><span class="op" id="2630189">.</span><span class="ident" id="2630190">nsec</span><span class="op" id="2630194">)</span><span class="op" id="2630195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630199">byte</span><span class="op" id="2630203">(</span><span class="ident" id="2630204">offsetMin</span>&nbsp;<span class="op" id="2630214">&gt;&gt;</span>&nbsp;<span class="num" id="2630217">8</span><span class="op" id="2630218">)</span><span class="op" id="2630219">,</span>&nbsp;<span class="comment" id="2630221">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2630262">byte</span><span class="op" id="2630266">(</span><span class="ident" id="2630267">offsetMin</span><span class="op" id="2630276">)</span><span class="op" id="2630277">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630284">return</span>&nbsp;<span class="ident" id="2630291">enc</span><span class="op" id="2630294">,</span>&nbsp;<span class="ident" id="2630296">nil</span><br>
<span class="lineno"></span><span class="op" id="2630300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2630303">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2630375">func</span>&nbsp;<span class="op" id="2630380">(</span><span class="ident" id="2630381">t</span>&nbsp;<span class="op" id="2630383">*</span><span class="ident" id="2630384">Time</span><span class="op" id="2630388">)</span>&nbsp;<span class="ident" id="2630390">UnmarshalBinary</span><span class="op" id="2630405">(</span><span class="ident" id="2630406">data</span>&nbsp;<span class="op" id="2630411">[</span><span class="op" id="2630412">]</span><span class="builtintype" id="2630413">byte</span><span class="op" id="2630417">)</span>&nbsp;<span class="builtintype" id="2630419">error</span>&nbsp;<span class="op" id="2630425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630428">buf</span>&nbsp;<span class="op" id="2630432">:=</span>&nbsp;<span class="ident" id="2630435">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630441">if</span>&nbsp;<span class="builtinfunc" id="2630444">len</span><span class="op" id="2630447">(</span><span class="ident" id="2630448">buf</span><span class="op" id="2630451">)</span>&nbsp;<span class="op" id="2630453">==</span>&nbsp;<span class="num" id="2630456">0</span>&nbsp;<span class="op" id="2630458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630462">return</span>&nbsp;<span class="ident" id="2630469">errors</span><span class="op" id="2630475">.</span><span class="ident" id="2630476">New</span><span class="op" id="2630479">(</span><span class="string" id="2630480">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2630511">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630518">if</span>&nbsp;<span class="ident" id="2630521">buf</span><span class="op" id="2630524">[</span><span class="num" id="2630525">0</span><span class="op" id="2630526">]</span>&nbsp;<span class="op" id="2630528">!=</span>&nbsp;<span class="ident" id="2630531">timeBinaryVersion</span>&nbsp;<span class="op" id="2630549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630553">return</span>&nbsp;<span class="ident" id="2630560">errors</span><span class="op" id="2630566">.</span><span class="ident" id="2630567">New</span><span class="op" id="2630570">(</span><span class="string" id="2630571">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2630614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630617">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630621">if</span>&nbsp;<span class="builtinfunc" id="2630624">len</span><span class="op" id="2630627">(</span><span class="ident" id="2630628">buf</span><span class="op" id="2630631">)</span>&nbsp;<span class="op" id="2630633">!=</span>&nbsp;<span class="comment" id="2630636">/*version*/</span>&nbsp;<span class="num" id="2630648">1</span><span class="op" id="2630649">+</span>&nbsp;<span class="comment" id="2630651">/*sec*/</span>&nbsp;<span class="num" id="2630659">8</span><span class="op" id="2630660">+</span>&nbsp;<span class="comment" id="2630662">/*nsec*/</span>&nbsp;<span class="num" id="2630671">4</span><span class="op" id="2630672">+</span>&nbsp;<span class="comment" id="2630674">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2630690">2</span>&nbsp;<span class="op" id="2630692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630696">return</span>&nbsp;<span class="ident" id="2630703">errors</span><span class="op" id="2630709">.</span><span class="ident" id="2630710">New</span><span class="op" id="2630713">(</span><span class="string" id="2630714">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2630752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630759">buf</span>&nbsp;<span class="op" id="2630763">=</span>&nbsp;<span class="ident" id="2630765">buf</span><span class="op" id="2630768">[</span><span class="num" id="2630769">1</span><span class="op" id="2630770">:</span><span class="op" id="2630771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630774">t</span><span class="op" id="2630775">.</span><span class="ident" id="2630776">sec</span>&nbsp;<span class="op" id="2630780">=</span>&nbsp;<span class="ident" id="2630782">int64</span><span class="op" id="2630787">(</span><span class="ident" id="2630788">buf</span><span class="op" id="2630791">[</span><span class="num" id="2630792">7</span><span class="op" id="2630793">]</span><span class="op" id="2630794">)</span>&nbsp;<span class="op" id="2630796">|</span>&nbsp;<span class="ident" id="2630798">int64</span><span class="op" id="2630803">(</span><span class="ident" id="2630804">buf</span><span class="op" id="2630807">[</span><span class="num" id="2630808">6</span><span class="op" id="2630809">]</span><span class="op" id="2630810">)</span><span class="op" id="2630811">&lt;&lt;</span><span class="num" id="2630813">8</span>&nbsp;<span class="op" id="2630815">|</span>&nbsp;<span class="ident" id="2630817">int64</span><span class="op" id="2630822">(</span><span class="ident" id="2630823">buf</span><span class="op" id="2630826">[</span><span class="num" id="2630827">5</span><span class="op" id="2630828">]</span><span class="op" id="2630829">)</span><span class="op" id="2630830">&lt;&lt;</span><span class="num" id="2630832">16</span>&nbsp;<span class="op" id="2630835">|</span>&nbsp;<span class="ident" id="2630837">int64</span><span class="op" id="2630842">(</span><span class="ident" id="2630843">buf</span><span class="op" id="2630846">[</span><span class="num" id="2630847">4</span><span class="op" id="2630848">]</span><span class="op" id="2630849">)</span><span class="op" id="2630850">&lt;&lt;</span><span class="num" id="2630852">24</span>&nbsp;<span class="op" id="2630855">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630859">int64</span><span class="op" id="2630864">(</span><span class="ident" id="2630865">buf</span><span class="op" id="2630868">[</span><span class="num" id="2630869">3</span><span class="op" id="2630870">]</span><span class="op" id="2630871">)</span><span class="op" id="2630872">&lt;&lt;</span><span class="num" id="2630874">32</span>&nbsp;<span class="op" id="2630877">|</span>&nbsp;<span class="ident" id="2630879">int64</span><span class="op" id="2630884">(</span><span class="ident" id="2630885">buf</span><span class="op" id="2630888">[</span><span class="num" id="2630889">2</span><span class="op" id="2630890">]</span><span class="op" id="2630891">)</span><span class="op" id="2630892">&lt;&lt;</span><span class="num" id="2630894">40</span>&nbsp;<span class="op" id="2630897">|</span>&nbsp;<span class="ident" id="2630899">int64</span><span class="op" id="2630904">(</span><span class="ident" id="2630905">buf</span><span class="op" id="2630908">[</span><span class="num" id="2630909">1</span><span class="op" id="2630910">]</span><span class="op" id="2630911">)</span><span class="op" id="2630912">&lt;&lt;</span><span class="num" id="2630914">48</span>&nbsp;<span class="op" id="2630917">|</span>&nbsp;<span class="ident" id="2630919">int64</span><span class="op" id="2630924">(</span><span class="ident" id="2630925">buf</span><span class="op" id="2630928">[</span><span class="num" id="2630929">0</span><span class="op" id="2630930">]</span><span class="op" id="2630931">)</span><span class="op" id="2630932">&lt;&lt;</span><span class="num" id="2630934">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630939">buf</span>&nbsp;<span class="op" id="2630943">=</span>&nbsp;<span class="ident" id="2630945">buf</span><span class="op" id="2630948">[</span><span class="num" id="2630949">8</span><span class="op" id="2630950">:</span><span class="op" id="2630951">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630954">t</span><span class="op" id="2630955">.</span><span class="ident" id="2630956">nsec</span>&nbsp;<span class="op" id="2630961">=</span>&nbsp;<span class="builtintype" id="2630963">int32</span><span class="op" id="2630968">(</span><span class="ident" id="2630969">buf</span><span class="op" id="2630972">[</span><span class="num" id="2630973">3</span><span class="op" id="2630974">]</span><span class="op" id="2630975">)</span>&nbsp;<span class="op" id="2630977">|</span>&nbsp;<span class="builtintype" id="2630979">int32</span><span class="op" id="2630984">(</span><span class="ident" id="2630985">buf</span><span class="op" id="2630988">[</span><span class="num" id="2630989">2</span><span class="op" id="2630990">]</span><span class="op" id="2630991">)</span><span class="op" id="2630992">&lt;&lt;</span><span class="num" id="2630994">8</span>&nbsp;<span class="op" id="2630996">|</span>&nbsp;<span class="builtintype" id="2630998">int32</span><span class="op" id="2631003">(</span><span class="ident" id="2631004">buf</span><span class="op" id="2631007">[</span><span class="num" id="2631008">1</span><span class="op" id="2631009">]</span><span class="op" id="2631010">)</span><span class="op" id="2631011">&lt;&lt;</span><span class="num" id="2631013">16</span>&nbsp;<span class="op" id="2631016">|</span>&nbsp;<span class="builtintype" id="2631018">int32</span><span class="op" id="2631023">(</span><span class="ident" id="2631024">buf</span><span class="op" id="2631027">[</span><span class="num" id="2631028">0</span><span class="op" id="2631029">]</span><span class="op" id="2631030">)</span><span class="op" id="2631031">&lt;&lt;</span><span class="num" id="2631033">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631038">buf</span>&nbsp;<span class="op" id="2631042">=</span>&nbsp;<span class="ident" id="2631044">buf</span><span class="op" id="2631047">[</span><span class="num" id="2631048">4</span><span class="op" id="2631049">:</span><span class="op" id="2631050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631053">offset</span>&nbsp;<span class="op" id="2631060">:=</span>&nbsp;<span class="builtintype" id="2631063">int</span><span class="op" id="2631066">(</span><span class="builtintype" id="2631067">int16</span><span class="op" id="2631072">(</span><span class="ident" id="2631073">buf</span><span class="op" id="2631076">[</span><span class="num" id="2631077">1</span><span class="op" id="2631078">]</span><span class="op" id="2631079">)</span><span class="op" id="2631080">|</span><span class="builtintype" id="2631081">int16</span><span class="op" id="2631086">(</span><span class="ident" id="2631087">buf</span><span class="op" id="2631090">[</span><span class="num" id="2631091">0</span><span class="op" id="2631092">]</span><span class="op" id="2631093">)</span><span class="op" id="2631094">&lt;&lt;</span><span class="num" id="2631096">8</span><span class="op" id="2631097">)</span>&nbsp;<span class="op" id="2631099">*</span>&nbsp;<span class="num" id="2631101">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631106">if</span>&nbsp;<span class="ident" id="2631109">offset</span>&nbsp;<span class="op" id="2631116">==</span>&nbsp;<span class="op" id="2631119">-</span><span class="num" id="2631120">1</span><span class="op" id="2631121">*</span><span class="num" id="2631122">60</span>&nbsp;<span class="op" id="2631125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631129">t</span><span class="op" id="2631130">.</span><span class="ident" id="2631131">loc</span>&nbsp;<span class="op" id="2631135">=</span>&nbsp;<span class="op" id="2631137">&amp;</span><span class="ident" id="2631138">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631146">}</span>&nbsp;<span class="keyword" id="2631148">else</span>&nbsp;<span class="keyword" id="2631153">if</span>&nbsp;<span class="ident" id="2631156">_</span><span class="op" id="2631157">,</span>&nbsp;<span class="ident" id="2631159">localoff</span><span class="op" id="2631167">,</span>&nbsp;<span class="ident" id="2631169">_</span><span class="op" id="2631170">,</span>&nbsp;<span class="ident" id="2631172">_</span><span class="op" id="2631173">,</span>&nbsp;<span class="ident" id="2631175">_</span>&nbsp;<span class="op" id="2631177">:=</span>&nbsp;<span class="ident" id="2631180">Local</span><span class="op" id="2631185">.</span><span class="ident" id="2631186">lookup</span><span class="op" id="2631192">(</span><span class="ident" id="2631193">t</span><span class="op" id="2631194">.</span><span class="ident" id="2631195">sec</span>&nbsp;<span class="op" id="2631199">+</span>&nbsp;<span class="ident" id="2631201">internalToUnix</span><span class="op" id="2631215">)</span><span class="op" id="2631216">;</span>&nbsp;<span class="ident" id="2631218">offset</span>&nbsp;<span class="op" id="2631225">==</span>&nbsp;<span class="ident" id="2631228">localoff</span>&nbsp;<span class="op" id="2631237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631241">t</span><span class="op" id="2631242">.</span><span class="ident" id="2631243">loc</span>&nbsp;<span class="op" id="2631247">=</span>&nbsp;<span class="ident" id="2631249">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631256">}</span>&nbsp;<span class="keyword" id="2631258">else</span>&nbsp;<span class="op" id="2631263">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631267">t</span><span class="op" id="2631268">.</span><span class="ident" id="2631269">loc</span>&nbsp;<span class="op" id="2631273">=</span>&nbsp;<span class="ident" id="2631275">FixedZone</span><span class="op" id="2631284">(</span><span class="string" id="2631285">&#34;&#34;</span><span class="op" id="2631287">,</span>&nbsp;<span class="ident" id="2631289">offset</span><span class="op" id="2631295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631302">return</span>&nbsp;<span class="ident" id="2631309">nil</span><br>
<span class="lineno"></span><span class="op" id="2631313">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2631316">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2631397">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2631479">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2631515">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2631569">func</span>&nbsp;<span class="op" id="2631574">(</span><span class="ident" id="2631575">t</span>&nbsp;<span class="ident" id="2631577">Time</span><span class="op" id="2631581">)</span>&nbsp;<span class="ident" id="2631583">GobEncode</span><span class="op" id="2631592">(</span><span class="op" id="2631593">)</span>&nbsp;<span class="op" id="2631595">(</span><span class="op" id="2631596">[</span><span class="op" id="2631597">]</span><span class="builtintype" id="2631598">byte</span><span class="op" id="2631602">,</span>&nbsp;<span class="builtintype" id="2631604">error</span><span class="op" id="2631609">)</span>&nbsp;<span class="op" id="2631611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631614">return</span>&nbsp;<span class="ident" id="2631621">t</span><span class="op" id="2631622">.</span><span class="ident" id="2631623">MarshalBinary</span><span class="op" id="2631636">(</span><span class="op" id="2631637">)</span><br>
<span class="lineno"></span><span class="op" id="2631639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2631642">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2631696">func</span>&nbsp;<span class="op" id="2631701">(</span><span class="ident" id="2631702">t</span>&nbsp;<span class="op" id="2631704">*</span><span class="ident" id="2631705">Time</span><span class="op" id="2631709">)</span>&nbsp;<span class="ident" id="2631711">GobDecode</span><span class="op" id="2631720">(</span><span class="ident" id="2631721">data</span>&nbsp;<span class="op" id="2631726">[</span><span class="op" id="2631727">]</span><span class="builtintype" id="2631728">byte</span><span class="op" id="2631732">)</span>&nbsp;<span class="builtintype" id="2631734">error</span>&nbsp;<span class="op" id="2631740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631743">return</span>&nbsp;<span class="ident" id="2631750">t</span><span class="op" id="2631751">.</span><span class="ident" id="2631752">UnmarshalBinary</span><span class="op" id="2631767">(</span><span class="ident" id="2631768">data</span><span class="op" id="2631772">)</span><br>
<span class="lineno"></span><span class="op" id="2631774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2631777">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2631833">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2631928">func</span>&nbsp;<span class="op" id="2631933">(</span><span class="ident" id="2631934">t</span>&nbsp;<span class="ident" id="2631936">Time</span><span class="op" id="2631940">)</span>&nbsp;<span class="ident" id="2631942">MarshalJSON</span><span class="op" id="2631953">(</span><span class="op" id="2631954">)</span>&nbsp;<span class="op" id="2631956">(</span><span class="op" id="2631957">[</span><span class="op" id="2631958">]</span><span class="builtintype" id="2631959">byte</span><span class="op" id="2631963">,</span>&nbsp;<span class="builtintype" id="2631965">error</span><span class="op" id="2631970">)</span>&nbsp;<span class="op" id="2631972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631975">if</span>&nbsp;<span class="ident" id="2631978">y</span>&nbsp;<span class="op" id="2631980">:=</span>&nbsp;<span class="ident" id="2631983">t</span><span class="op" id="2631984">.</span><span class="ident" id="2631985">Year</span><span class="op" id="2631989">(</span><span class="op" id="2631990">)</span><span class="op" id="2631991">;</span>&nbsp;<span class="ident" id="2631993">y</span>&nbsp;<span class="op" id="2631995">&lt;</span>&nbsp;<span class="num" id="2631997">0</span>&nbsp;<span class="op" id="2631999">||</span>&nbsp;<span class="ident" id="2632002">y</span>&nbsp;<span class="op" id="2632004">&gt;=</span>&nbsp;<span class="num" id="2632007">10000</span>&nbsp;<span class="op" id="2632013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2632017">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2632073">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632129">return</span>&nbsp;<span class="ident" id="2632136">nil</span><span class="op" id="2632139">,</span>&nbsp;<span class="ident" id="2632141">errors</span><span class="op" id="2632147">.</span><span class="ident" id="2632148">New</span><span class="op" id="2632151">(</span><span class="string" id="2632152">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2632202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2632205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632208">return</span>&nbsp;<span class="op" id="2632215">[</span><span class="op" id="2632216">]</span><span class="builtintype" id="2632217">byte</span><span class="op" id="2632221">(</span><span class="ident" id="2632222">t</span><span class="op" id="2632223">.</span><span class="ident" id="2632224">Format</span><span class="op" id="2632230">(</span><span class="string" id="2632231">`&#34;`</span>&nbsp;<span class="op" id="2632235">+</span>&nbsp;<span class="ident" id="2632237">RFC3339Nano</span>&nbsp;<span class="op" id="2632249">+</span>&nbsp;<span class="string" id="2632251">`&#34;`</span><span class="op" id="2632254">)</span><span class="op" id="2632255">)</span><span class="op" id="2632256">,</span>&nbsp;<span class="ident" id="2632258">nil</span><br>
<span class="lineno"></span><span class="op" id="2632262">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2632265">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2632325">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2632391">func</span>&nbsp;<span class="op" id="2632396">(</span><span class="ident" id="2632397">t</span>&nbsp;<span class="op" id="2632399">*</span><span class="ident" id="2632400">Time</span><span class="op" id="2632404">)</span>&nbsp;<span class="ident" id="2632406">UnmarshalJSON</span><span class="op" id="2632419">(</span><span class="ident" id="2632420">data</span>&nbsp;<span class="op" id="2632425">[</span><span class="op" id="2632426">]</span><span class="builtintype" id="2632427">byte</span><span class="op" id="2632431">)</span>&nbsp;<span class="op" id="2632433">(</span><span class="ident" id="2632434">err</span>&nbsp;<span class="builtintype" id="2632438">error</span><span class="op" id="2632443">)</span>&nbsp;<span class="op" id="2632445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2632448">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2632504">*</span><span class="ident" id="2632505">t</span><span class="op" id="2632506">,</span>&nbsp;<span class="ident" id="2632508">err</span>&nbsp;<span class="op" id="2632512">=</span>&nbsp;<span class="ident" id="2632514">Parse</span><span class="op" id="2632519">(</span><span class="string" id="2632520">`&#34;`</span><span class="op" id="2632523">+</span><span class="ident" id="2632524">RFC3339</span><span class="op" id="2632531">+</span><span class="string" id="2632532">`&#34;`</span><span class="op" id="2632535">,</span>&nbsp;<span class="builtintype" id="2632537">string</span><span class="op" id="2632543">(</span><span class="ident" id="2632544">data</span><span class="op" id="2632548">)</span><span class="op" id="2632549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632552">return</span><br>
<span class="lineno"></span><span class="op" id="2632559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2632562">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2632626">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2632715">func</span>&nbsp;<span class="op" id="2632720">(</span><span class="ident" id="2632721">t</span>&nbsp;<span class="ident" id="2632723">Time</span><span class="op" id="2632727">)</span>&nbsp;<span class="ident" id="2632729">MarshalText</span><span class="op" id="2632740">(</span><span class="op" id="2632741">)</span>&nbsp;<span class="op" id="2632743">(</span><span class="op" id="2632744">[</span><span class="op" id="2632745">]</span><span class="builtintype" id="2632746">byte</span><span class="op" id="2632750">,</span>&nbsp;<span class="builtintype" id="2632752">error</span><span class="op" id="2632757">)</span>&nbsp;<span class="op" id="2632759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632762">if</span>&nbsp;<span class="ident" id="2632765">y</span>&nbsp;<span class="op" id="2632767">:=</span>&nbsp;<span class="ident" id="2632770">t</span><span class="op" id="2632771">.</span><span class="ident" id="2632772">Year</span><span class="op" id="2632776">(</span><span class="op" id="2632777">)</span><span class="op" id="2632778">;</span>&nbsp;<span class="ident" id="2632780">y</span>&nbsp;<span class="op" id="2632782">&lt;</span>&nbsp;<span class="num" id="2632784">0</span>&nbsp;<span class="op" id="2632786">||</span>&nbsp;<span class="ident" id="2632789">y</span>&nbsp;<span class="op" id="2632791">&gt;=</span>&nbsp;<span class="num" id="2632794">10000</span>&nbsp;<span class="op" id="2632800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632804">return</span>&nbsp;<span class="ident" id="2632811">nil</span><span class="op" id="2632814">,</span>&nbsp;<span class="ident" id="2632816">errors</span><span class="op" id="2632822">.</span><span class="ident" id="2632823">New</span><span class="op" id="2632826">(</span><span class="string" id="2632827">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2632877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2632880">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632883">return</span>&nbsp;<span class="op" id="2632890">[</span><span class="op" id="2632891">]</span><span class="builtintype" id="2632892">byte</span><span class="op" id="2632896">(</span><span class="ident" id="2632897">t</span><span class="op" id="2632898">.</span><span class="ident" id="2632899">Format</span><span class="op" id="2632905">(</span><span class="ident" id="2632906">RFC3339Nano</span><span class="op" id="2632917">)</span><span class="op" id="2632918">)</span><span class="op" id="2632919">,</span>&nbsp;<span class="ident" id="2632921">nil</span><br>
<span class="lineno"></span><span class="op" id="2632925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2632928">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2632996">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2633046">func</span>&nbsp;<span class="op" id="2633051">(</span><span class="ident" id="2633052">t</span>&nbsp;<span class="op" id="2633054">*</span><span class="ident" id="2633055">Time</span><span class="op" id="2633059">)</span>&nbsp;<span class="ident" id="2633061">UnmarshalText</span><span class="op" id="2633074">(</span><span class="ident" id="2633075">data</span>&nbsp;<span class="op" id="2633080">[</span><span class="op" id="2633081">]</span><span class="builtintype" id="2633082">byte</span><span class="op" id="2633086">)</span>&nbsp;<span class="op" id="2633088">(</span><span class="ident" id="2633089">err</span>&nbsp;<span class="builtintype" id="2633093">error</span><span class="op" id="2633098">)</span>&nbsp;<span class="op" id="2633100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2633103">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633159">*</span><span class="ident" id="2633160">t</span><span class="op" id="2633161">,</span>&nbsp;<span class="ident" id="2633163">err</span>&nbsp;<span class="op" id="2633167">=</span>&nbsp;<span class="ident" id="2633169">Parse</span><span class="op" id="2633174">(</span><span class="ident" id="2633175">RFC3339</span><span class="op" id="2633182">,</span>&nbsp;<span class="builtintype" id="2633184">string</span><span class="op" id="2633190">(</span><span class="ident" id="2633191">data</span><span class="op" id="2633195">)</span><span class="op" id="2633196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633199">return</span><br>
<span class="lineno"></span><span class="op" id="2633206">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2633209">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2633278">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2633341">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2633403">func</span>&nbsp;<span class="ident" id="2633408">Unix</span><span class="op" id="2633412">(</span><span class="ident" id="2633413">sec</span>&nbsp;<span class="ident" id="2633417">int64</span><span class="op" id="2633422">,</span>&nbsp;<span class="ident" id="2633424">nsec</span>&nbsp;<span class="ident" id="2633429">int64</span><span class="op" id="2633434">)</span>&nbsp;<span class="ident" id="2633436">Time</span>&nbsp;<span class="op" id="2633441">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633444">if</span>&nbsp;<span class="ident" id="2633447">nsec</span>&nbsp;<span class="op" id="2633452">&lt;</span>&nbsp;<span class="num" id="2633454">0</span>&nbsp;<span class="op" id="2633456">||</span>&nbsp;<span class="ident" id="2633459">nsec</span>&nbsp;<span class="op" id="2633464">&gt;=</span>&nbsp;<span class="num" id="2633467">1e9</span>&nbsp;<span class="op" id="2633471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633475">n</span>&nbsp;<span class="op" id="2633477">:=</span>&nbsp;<span class="ident" id="2633480">nsec</span>&nbsp;<span class="op" id="2633485">/</span>&nbsp;<span class="num" id="2633487">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633493">sec</span>&nbsp;<span class="op" id="2633497">+=</span>&nbsp;<span class="ident" id="2633500">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633504">nsec</span>&nbsp;<span class="op" id="2633509">-=</span>&nbsp;<span class="ident" id="2633512">n</span>&nbsp;<span class="op" id="2633514">*</span>&nbsp;<span class="num" id="2633516">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633522">if</span>&nbsp;<span class="ident" id="2633525">nsec</span>&nbsp;<span class="op" id="2633530">&lt;</span>&nbsp;<span class="num" id="2633532">0</span>&nbsp;<span class="op" id="2633534">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633539">nsec</span>&nbsp;<span class="op" id="2633544">+=</span>&nbsp;<span class="num" id="2633547">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633554">sec</span><span class="op" id="2633557">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633568">return</span>&nbsp;<span class="ident" id="2633575">Time</span><span class="op" id="2633579">{</span><span class="ident" id="2633580">sec</span>&nbsp;<span class="op" id="2633584">+</span>&nbsp;<span class="ident" id="2633586">unixToInternal</span><span class="op" id="2633600">,</span>&nbsp;<span class="builtintype" id="2633602">int32</span><span class="op" id="2633607">(</span><span class="ident" id="2633608">nsec</span><span class="op" id="2633612">)</span><span class="op" id="2633613">,</span>&nbsp;<span class="ident" id="2633615">Local</span><span class="op" id="2633620">}</span><br>
<span class="lineno">980</span><span class="op" id="2633622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633625">func</span>&nbsp;<span class="ident" id="2633630">isLeap</span><span class="op" id="2633636">(</span><span class="ident" id="2633637">year</span>&nbsp;<span class="builtintype" id="2633642">int</span><span class="op" id="2633645">)</span>&nbsp;<span class="builtintype" id="2633647">bool</span>&nbsp;<span class="op" id="2633652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633655">return</span>&nbsp;<span class="ident" id="2633662">year</span><span class="op" id="2633666">%</span><span class="num" id="2633667">4</span>&nbsp;<span class="op" id="2633669">==</span>&nbsp;<span class="num" id="2633672">0</span>&nbsp;<span class="op" id="2633674">&amp;&amp;</span>&nbsp;<span class="op" id="2633677">(</span><span class="ident" id="2633678">year</span><span class="op" id="2633682">%</span><span class="num" id="2633683">100</span>&nbsp;<span class="op" id="2633687">!=</span>&nbsp;<span class="num" id="2633690">0</span>&nbsp;<span class="op" id="2633692">||</span>&nbsp;<span class="ident" id="2633695">year</span><span class="op" id="2633699">%</span><span class="num" id="2633700">400</span>&nbsp;<span class="op" id="2633704">==</span>&nbsp;<span class="num" id="2633707">0</span><span class="op" id="2633708">)</span><br>
<span class="lineno"></span><span class="op" id="2633710">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2633713">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2633748">//&nbsp;&nbsp;&nbsp;&nbsphi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2633786">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2633805">func</span>&nbsp;<span class="ident" id="2633810">norm</span><span class="op" id="2633814">(</span><span class="ident" id="2633815">hi</span><span class="op" id="2633817">,</span>&nbsp;<span class="ident" id="2633819">lo</span><span class="op" id="2633821">,</span>&nbsp;<span class="ident" id="2633823">base</span>&nbsp;<span class="builtintype" id="2633828">int</span><span class="op" id="2633831">)</span>&nbsp;<span class="op" id="2633833">(</span><span class="ident" id="2633834">nhi</span><span class="op" id="2633837">,</span>&nbsp;<span class="ident" id="2633839">nlo</span>&nbsp;<span class="builtintype" id="2633843">int</span><span class="op" id="2633846">)</span>&nbsp;<span class="op" id="2633848">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633851">if</span>&nbsp;<span class="ident" id="2633854">lo</span>&nbsp;<span class="op" id="2633857">&lt;</span>&nbsp;<span class="num" id="2633859">0</span>&nbsp;<span class="op" id="2633861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633865">n</span>&nbsp;<span class="op" id="2633867">:=</span>&nbsp;<span class="op" id="2633870">(</span><span class="op" id="2633871">-</span><span class="ident" id="2633872">lo</span><span class="op" id="2633874">-</span><span class="num" id="2633875">1</span><span class="op" id="2633876">)</span><span class="op" id="2633877">/</span><span class="ident" id="2633878">base</span>&nbsp;<span class="op" id="2633883">+</span>&nbsp;<span class="num" id="2633885">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633889">hi</span>&nbsp;<span class="op" id="2633892">-=</span>&nbsp;<span class="ident" id="2633895">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633899">lo</span>&nbsp;<span class="op" id="2633902">+=</span>&nbsp;<span class="ident" id="2633905">n</span>&nbsp;<span class="op" id="2633907">*</span>&nbsp;<span class="ident" id="2633909">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633915">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633918">if</span>&nbsp;<span class="ident" id="2633921">lo</span>&nbsp;<span class="op" id="2633924">&gt;=</span>&nbsp;<span class="ident" id="2633927">base</span>&nbsp;<span class="op" id="2633932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633936">n</span>&nbsp;<span class="op" id="2633938">:=</span>&nbsp;<span class="ident" id="2633941">lo</span>&nbsp;<span class="op" id="2633944">/</span>&nbsp;<span class="ident" id="2633946">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633953">hi</span>&nbsp;<span class="op" id="2633956">+=</span>&nbsp;<span class="ident" id="2633959">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633963">lo</span>&nbsp;<span class="op" id="2633966">-=</span>&nbsp;<span class="ident" id="2633969">n</span>&nbsp;<span class="op" id="2633971">*</span>&nbsp;<span class="ident" id="2633973">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633979">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633982">return</span>&nbsp;<span class="ident" id="2633989">hi</span><span class="op" id="2633991">,</span>&nbsp;<span class="ident" id="2633993">lo</span><br>
<span class="lineno"></span><span class="op" id="2633996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2633999">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2634041">//&nbsp;&nbsp;&nbsp;&nbspyyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2634083">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2634147">//</span><br>
<span class="lineno"></span><span class="comment" id="2634150">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2634216">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2634284">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2634335">//</span><br>
<span class="lineno"></span><span class="comment" id="2634338">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2634400">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2634476">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2634545">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2634614">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2634686">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2634741">//</span><br>
<span class="lineno"></span><span class="comment" id="2634744">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2634774">func</span>&nbsp;<span class="ident" id="2634779">Date</span><span class="op" id="2634783">(</span><span class="ident" id="2634784">year</span>&nbsp;<span class="builtintype" id="2634789">int</span><span class="op" id="2634792">,</span>&nbsp;<span class="ident" id="2634794">month</span>&nbsp;<span class="ident" id="2634800">Month</span><span class="op" id="2634805">,</span>&nbsp;<span class="ident" id="2634807">day</span><span class="op" id="2634810">,</span>&nbsp;<span class="ident" id="2634812">hour</span><span class="op" id="2634816">,</span>&nbsp;<span class="ident" id="2634818">min</span><span class="op" id="2634821">,</span>&nbsp;<span class="ident" id="2634823">sec</span><span class="op" id="2634826">,</span>&nbsp;<span class="ident" id="2634828">nsec</span>&nbsp;<span class="builtintype" id="2634833">int</span><span class="op" id="2634836">,</span>&nbsp;<span class="ident" id="2634838">loc</span>&nbsp;<span class="op" id="2634842">*</span><span class="ident" id="2634843">Location</span><span class="op" id="2634851">)</span>&nbsp;<span class="ident" id="2634853">Time</span>&nbsp;<span class="op" id="2634858">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634861">if</span>&nbsp;<span class="ident" id="2634864">loc</span>&nbsp;<span class="op" id="2634868">==</span>&nbsp;<span class="ident" id="2634871">nil</span>&nbsp;<span class="op" id="2634875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2634879">panic</span><span class="op" id="2634884">(</span><span class="string" id="2634885">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2634925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2634932">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634976">m</span>&nbsp;<span class="op" id="2634978">:=</span>&nbsp;<span class="builtintype" id="2634981">int</span><span class="op" id="2634984">(</span><span class="ident" id="2634985">month</span><span class="op" id="2634990">)</span>&nbsp;<span class="op" id="2634992">-</span>&nbsp;<span class="num" id="2634994">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634997">year</span><span class="op" id="2635001">,</span>&nbsp;<span class="ident" id="2635003">m</span>&nbsp;<span class="op" id="2635005">=</span>&nbsp;<span class="ident" id="2635007">norm</span><span class="op" id="2635011">(</span><span class="ident" id="2635012">year</span><span class="op" id="2635016">,</span>&nbsp;<span class="ident" id="2635018">m</span><span class="op" id="2635019">,</span>&nbsp;<span class="num" id="2635021">12</span><span class="op" id="2635023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635026">month</span>&nbsp;<span class="op" id="2635032">=</span>&nbsp;<span class="ident" id="2635034">Month</span><span class="op" id="2635039">(</span><span class="ident" id="2635040">m</span><span class="op" id="2635041">)</span>&nbsp;<span class="op" id="2635043">+</span>&nbsp;<span class="num" id="2635045">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635049">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635107">sec</span><span class="op" id="2635110">,</span>&nbsp;<span class="ident" id="2635112">nsec</span>&nbsp;<span class="op" id="2635117">=</span>&nbsp;<span class="ident" id="2635119">norm</span><span class="op" id="2635123">(</span><span class="ident" id="2635124">sec</span><span class="op" id="2635127">,</span>&nbsp;<span class="ident" id="2635129">nsec</span><span class="op" id="2635133">,</span>&nbsp;<span class="num" id="2635135">1e9</span><span class="op" id="2635138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635141">min</span><span class="op" id="2635144">,</span>&nbsp;<span class="ident" id="2635146">sec</span>&nbsp;<span class="op" id="2635150">=</span>&nbsp;<span class="ident" id="2635152">norm</span><span class="op" id="2635156">(</span><span class="ident" id="2635157">min</span><span class="op" id="2635160">,</span>&nbsp;<span class="ident" id="2635162">sec</span><span class="op" id="2635165">,</span>&nbsp;<span class="num" id="2635167">60</span><span class="op" id="2635169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635172">hour</span><span class="op" id="2635176">,</span>&nbsp;<span class="ident" id="2635178">min</span>&nbsp;<span class="op" id="2635182">=</span>&nbsp;<span class="ident" id="2635184">norm</span><span class="op" id="2635188">(</span><span class="ident" id="2635189">hour</span><span class="op" id="2635193">,</span>&nbsp;<span class="ident" id="2635195">min</span><span class="op" id="2635198">,</span>&nbsp;<span class="num" id="2635200">60</span><span class="op" id="2635202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635205">day</span><span class="op" id="2635208">,</span>&nbsp;<span class="ident" id="2635210">hour</span>&nbsp;<span class="op" id="2635215">=</span>&nbsp;<span class="ident" id="2635217">norm</span><span class="op" id="2635221">(</span><span class="ident" id="2635222">day</span><span class="op" id="2635225">,</span>&nbsp;<span class="ident" id="2635227">hour</span><span class="op" id="2635231">,</span>&nbsp;<span class="num" id="2635233">24</span><span class="op" id="2635235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635239">y</span>&nbsp;<span class="op" id="2635241">:=</span>&nbsp;<span class="ident" id="2635244">uint64</span><span class="op" id="2635250">(</span><span class="ident" id="2635251">int64</span><span class="op" id="2635256">(</span><span class="ident" id="2635257">year</span><span class="op" id="2635261">)</span>&nbsp;<span class="op" id="2635263">-</span>&nbsp;<span class="ident" id="2635265">absoluteZeroYear</span><span class="op" id="2635281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635285">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635329">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635367">n</span>&nbsp;<span class="op" id="2635369">:=</span>&nbsp;<span class="ident" id="2635372">y</span>&nbsp;<span class="op" id="2635374">/</span>&nbsp;<span class="num" id="2635376">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635381">y</span>&nbsp;<span class="op" id="2635383">-=</span>&nbsp;<span class="num" id="2635386">400</span>&nbsp;<span class="op" id="2635390">*</span>&nbsp;<span class="ident" id="2635392">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635395">d</span>&nbsp;<span class="op" id="2635397">:=</span>&nbsp;<span class="ident" id="2635400">daysPer400Years</span>&nbsp;<span class="op" id="2635416">*</span>&nbsp;<span class="ident" id="2635418">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635422">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635450">n</span>&nbsp;<span class="op" id="2635452">=</span>&nbsp;<span class="ident" id="2635454">y</span>&nbsp;<span class="op" id="2635456">/</span>&nbsp;<span class="num" id="2635458">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635463">y</span>&nbsp;<span class="op" id="2635465">-=</span>&nbsp;<span class="num" id="2635468">100</span>&nbsp;<span class="op" id="2635472">*</span>&nbsp;<span class="ident" id="2635474">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635477">d</span>&nbsp;<span class="op" id="2635479">+=</span>&nbsp;<span class="ident" id="2635482">daysPer100Years</span>&nbsp;<span class="op" id="2635498">*</span>&nbsp;<span class="ident" id="2635500">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635504">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635530">n</span>&nbsp;<span class="op" id="2635532">=</span>&nbsp;<span class="ident" id="2635534">y</span>&nbsp;<span class="op" id="2635536">/</span>&nbsp;<span class="num" id="2635538">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635541">y</span>&nbsp;<span class="op" id="2635543">-=</span>&nbsp;<span class="num" id="2635546">4</span>&nbsp;<span class="op" id="2635548">*</span>&nbsp;<span class="ident" id="2635550">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635553">d</span>&nbsp;<span class="op" id="2635555">+=</span>&nbsp;<span class="ident" id="2635558">daysPer4Years</span>&nbsp;<span class="op" id="2635572">*</span>&nbsp;<span class="ident" id="2635574">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635578">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635605">n</span>&nbsp;<span class="op" id="2635607">=</span>&nbsp;<span class="ident" id="2635609">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635612">d</span>&nbsp;<span class="op" id="2635614">+=</span>&nbsp;<span class="num" id="2635617">365</span>&nbsp;<span class="op" id="2635621">*</span>&nbsp;<span class="ident" id="2635623">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635627">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635662">d</span>&nbsp;<span class="op" id="2635664">+=</span>&nbsp;<span class="ident" id="2635667">uint64</span><span class="op" id="2635673">(</span><span class="ident" id="2635674">daysBefore</span><span class="op" id="2635684">[</span><span class="ident" id="2635685">month</span><span class="op" id="2635690">-</span><span class="num" id="2635691">1</span><span class="op" id="2635692">]</span><span class="op" id="2635693">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2635696">if</span>&nbsp;<span class="ident" id="2635699">isLeap</span><span class="op" id="2635705">(</span><span class="ident" id="2635706">year</span><span class="op" id="2635710">)</span>&nbsp;<span class="op" id="2635712">&amp;&amp;</span>&nbsp;<span class="ident" id="2635715">month</span>&nbsp;<span class="op" id="2635721">&gt;=</span>&nbsp;<span class="ident" id="2635724">March</span>&nbsp;<span class="op" id="2635730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635734">d</span><span class="op" id="2635735">++</span>&nbsp;<span class="comment" id="2635738">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2635754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635758">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635788">d</span>&nbsp;<span class="op" id="2635790">+=</span>&nbsp;<span class="ident" id="2635793">uint64</span><span class="op" id="2635799">(</span><span class="ident" id="2635800">day</span>&nbsp;<span class="op" id="2635804">-</span>&nbsp;<span class="num" id="2635806">1</span><span class="op" id="2635807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635811">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635842">abs</span>&nbsp;<span class="op" id="2635846">:=</span>&nbsp;<span class="ident" id="2635849">d</span>&nbsp;<span class="op" id="2635851">*</span>&nbsp;<span class="ident" id="2635853">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635868">abs</span>&nbsp;<span class="op" id="2635872">+=</span>&nbsp;<span class="ident" id="2635875">uint64</span><span class="op" id="2635881">(</span><span class="ident" id="2635882">hour</span><span class="op" id="2635886">*</span><span class="ident" id="2635887">secondsPerHour</span>&nbsp;<span class="op" id="2635902">+</span>&nbsp;<span class="ident" id="2635904">min</span><span class="op" id="2635907">*</span><span class="ident" id="2635908">secondsPerMinute</span>&nbsp;<span class="op" id="2635925">+</span>&nbsp;<span class="ident" id="2635927">sec</span><span class="op" id="2635930">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635934">unix</span>&nbsp;<span class="op" id="2635939">:=</span>&nbsp;<span class="ident" id="2635942">int64</span><span class="op" id="2635947">(</span><span class="ident" id="2635948">abs</span><span class="op" id="2635951">)</span>&nbsp;<span class="op" id="2635953">+</span>&nbsp;<span class="op" id="2635955">(</span><span class="ident" id="2635956">absoluteToInternal</span>&nbsp;<span class="op" id="2635975">+</span>&nbsp;<span class="ident" id="2635977">internalToUnix</span><span class="op" id="2635991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2635995">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2636052">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2636109">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2636170">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2636200">_</span><span class="op" id="2636201">,</span>&nbsp;<span class="ident" id="2636203">offset</span><span class="op" id="2636209">,</span>&nbsp;<span class="ident" id="2636211">_</span><span class="op" id="2636212">,</span>&nbsp;<span class="ident" id="2636214">start</span><span class="op" id="2636219">,</span>&nbsp;<span class="ident" id="2636221">end</span>&nbsp;<span class="op" id="2636225">:=</span>&nbsp;<span class="ident" id="2636228">loc</span><span class="op" id="2636231">.</span><span class="ident" id="2636232">lookup</span><span class="op" id="2636238">(</span><span class="ident" id="2636239">unix</span><span class="op" id="2636243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636246">if</span>&nbsp;<span class="ident" id="2636249">offset</span>&nbsp;<span class="op" id="2636256">!=</span>&nbsp;<span class="num" id="2636259">0</span>&nbsp;<span class="op" id="2636261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636265">switch</span>&nbsp;<span class="ident" id="2636272">utc</span>&nbsp;<span class="op" id="2636276">:=</span>&nbsp;<span class="ident" id="2636279">unix</span>&nbsp;<span class="op" id="2636284">-</span>&nbsp;<span class="ident" id="2636286">int64</span><span class="op" id="2636291">(</span><span class="ident" id="2636292">offset</span><span class="op" id="2636298">)</span><span class="op" id="2636299">;</span>&nbsp;<span class="op" id="2636301">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636305">case</span>&nbsp;<span class="ident" id="2636310">utc</span>&nbsp;<span class="op" id="2636314">&lt;</span>&nbsp;<span class="ident" id="2636316">start</span><span class="op" id="2636321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2636326">_</span><span class="op" id="2636327">,</span>&nbsp;<span class="ident" id="2636329">offset</span><span class="op" id="2636335">,</span>&nbsp;<span class="ident" id="2636337">_</span><span class="op" id="2636338">,</span>&nbsp;<span class="ident" id="2636340">_</span><span class="op" id="2636341">,</span>&nbsp;<span class="ident" id="2636343">_</span>&nbsp;<span class="op" id="2636345">=</span>&nbsp;<span class="ident" id="2636347">loc</span><span class="op" id="2636350">.</span><span class="ident" id="2636351">lookup</span><span class="op" id="2636357">(</span><span class="ident" id="2636358">start</span>&nbsp;<span class="op" id="2636364">-</span>&nbsp;<span class="num" id="2636366">1</span><span class="op" id="2636367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636371">case</span>&nbsp;<span class="ident" id="2636376">utc</span>&nbsp;<span class="op" id="2636380">&gt;=</span>&nbsp;<span class="ident" id="2636383">end</span><span class="op" id="2636386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2636391">_</span><span class="op" id="2636392">,</span>&nbsp;<span class="ident" id="2636394">offset</span><span class="op" id="2636400">,</span>&nbsp;<span class="ident" id="2636402">_</span><span class="op" id="2636403">,</span>&nbsp;<span class="ident" id="2636405">_</span><span class="op" id="2636406">,</span>&nbsp;<span class="ident" id="2636408">_</span>&nbsp;<span class="op" id="2636410">=</span>&nbsp;<span class="ident" id="2636412">loc</span><span class="op" id="2636415">.</span><span class="ident" id="2636416">lookup</span><span class="op" id="2636422">(</span><span class="ident" id="2636423">end</span><span class="op" id="2636426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2636430">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2636434">unix</span>&nbsp;<span class="op" id="2636439">-=</span>&nbsp;<span class="ident" id="2636442">int64</span><span class="op" id="2636447">(</span><span class="ident" id="2636448">offset</span><span class="op" id="2636454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2636457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636461">return</span>&nbsp;<span class="ident" id="2636468">Time</span><span class="op" id="2636472">{</span><span class="ident" id="2636473">unix</span>&nbsp;<span class="op" id="2636478">+</span>&nbsp;<span class="ident" id="2636480">unixToInternal</span><span class="op" id="2636494">,</span>&nbsp;<span class="builtintype" id="2636496">int32</span><span class="op" id="2636501">(</span><span class="ident" id="2636502">nsec</span><span class="op" id="2636506">)</span><span class="op" id="2636507">,</span>&nbsp;<span class="ident" id="2636509">loc</span><span class="op" id="2636512">}</span><br>
<span class="lineno"></span><span class="op" id="2636514">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2636517">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2636609">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2636653">func</span>&nbsp;<span class="op" id="2636658">(</span><span class="ident" id="2636659">t</span>&nbsp;<span class="ident" id="2636661">Time</span><span class="op" id="2636665">)</span>&nbsp;<span class="ident" id="2636667">Truncate</span><span class="op" id="2636675">(</span><span class="ident" id="2636676">d</span>&nbsp;<span class="ident" id="2636678">Duration</span><span class="op" id="2636686">)</span>&nbsp;<span class="ident" id="2636688">Time</span>&nbsp;<span class="op" id="2636693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636696">if</span>&nbsp;<span class="ident" id="2636699">d</span>&nbsp;<span class="op" id="2636701">&lt;=</span>&nbsp;<span class="num" id="2636704">0</span>&nbsp;<span class="op" id="2636706">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636710">return</span>&nbsp;<span class="ident" id="2636717">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2636720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2636723">_</span><span class="op" id="2636724">,</span>&nbsp;<span class="ident" id="2636726">r</span>&nbsp;<span class="op" id="2636728">:=</span>&nbsp;<span class="ident" id="2636731">div</span><span class="op" id="2636734">(</span><span class="ident" id="2636735">t</span><span class="op" id="2636736">,</span>&nbsp;<span class="ident" id="2636738">d</span><span class="op" id="2636739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636742">return</span>&nbsp;<span class="ident" id="2636749">t</span><span class="op" id="2636750">.</span><span class="ident" id="2636751">Add</span><span class="op" id="2636754">(</span><span class="op" id="2636755">-</span><span class="ident" id="2636756">r</span><span class="op" id="2636757">)</span><br>
<span class="lineno"></span><span class="op" id="2636759">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2636762">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2636856">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2636916">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2636957">func</span>&nbsp;<span class="op" id="2636962">(</span><span class="ident" id="2636963">t</span>&nbsp;<span class="ident" id="2636965">Time</span><span class="op" id="2636969">)</span>&nbsp;<span class="ident" id="2636971">Round</span><span class="op" id="2636976">(</span><span class="ident" id="2636977">d</span>&nbsp;<span class="ident" id="2636979">Duration</span><span class="op" id="2636987">)</span>&nbsp;<span class="ident" id="2636989">Time</span>&nbsp;<span class="op" id="2636994">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2636997">if</span>&nbsp;<span class="ident" id="2637000">d</span>&nbsp;<span class="op" id="2637002">&lt;=</span>&nbsp;<span class="num" id="2637005">0</span>&nbsp;<span class="op" id="2637007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637011">return</span>&nbsp;<span class="ident" id="2637018">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637024">_</span><span class="op" id="2637025">,</span>&nbsp;<span class="ident" id="2637027">r</span>&nbsp;<span class="op" id="2637029">:=</span>&nbsp;<span class="ident" id="2637032">div</span><span class="op" id="2637035">(</span><span class="ident" id="2637036">t</span><span class="op" id="2637037">,</span>&nbsp;<span class="ident" id="2637039">d</span><span class="op" id="2637040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637043">if</span>&nbsp;<span class="ident" id="2637046">r</span><span class="op" id="2637047">+</span><span class="ident" id="2637048">r</span>&nbsp;<span class="op" id="2637050">&lt;</span>&nbsp;<span class="ident" id="2637052">d</span>&nbsp;<span class="op" id="2637054">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637058">return</span>&nbsp;<span class="ident" id="2637065">t</span><span class="op" id="2637066">.</span><span class="ident" id="2637067">Add</span><span class="op" id="2637070">(</span><span class="op" id="2637071">-</span><span class="ident" id="2637072">r</span><span class="op" id="2637073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637079">return</span>&nbsp;<span class="ident" id="2637086">t</span><span class="op" id="2637087">.</span><span class="ident" id="2637088">Add</span><span class="op" id="2637091">(</span><span class="ident" id="2637092">d</span>&nbsp;<span class="op" id="2637094">-</span>&nbsp;<span class="ident" id="2637096">r</span><span class="op" id="2637097">)</span><br>
<span class="lineno"></span><span class="op" id="2637099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2637102">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2637171">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2637256">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2637308">func</span>&nbsp;<span class="ident" id="2637313">div</span><span class="op" id="2637316">(</span><span class="ident" id="2637317">t</span>&nbsp;<span class="ident" id="2637319">Time</span><span class="op" id="2637323">,</span>&nbsp;<span class="ident" id="2637325">d</span>&nbsp;<span class="ident" id="2637327">Duration</span><span class="op" id="2637335">)</span>&nbsp;<span class="op" id="2637337">(</span><span class="ident" id="2637338">qmod2</span>&nbsp;<span class="builtintype" id="2637344">int</span><span class="op" id="2637347">,</span>&nbsp;<span class="ident" id="2637349">r</span>&nbsp;<span class="ident" id="2637351">Duration</span><span class="op" id="2637359">)</span>&nbsp;<span class="op" id="2637361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637364">neg</span>&nbsp;<span class="op" id="2637368">:=</span>&nbsp;<span class="builtintype" id="2637371">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637378">nsec</span>&nbsp;<span class="op" id="2637383">:=</span>&nbsp;<span class="builtintype" id="2637386">int32</span><span class="op" id="2637391">(</span><span class="ident" id="2637392">t</span><span class="op" id="2637393">.</span><span class="ident" id="2637394">nsec</span><span class="op" id="2637398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637401">if</span>&nbsp;<span class="ident" id="2637404">t</span><span class="op" id="2637405">.</span><span class="ident" id="2637406">sec</span>&nbsp;<span class="op" id="2637410">&lt;</span>&nbsp;<span class="num" id="2637412">0</span>&nbsp;<span class="op" id="2637414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637418">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637450">neg</span>&nbsp;<span class="op" id="2637454">=</span>&nbsp;<span class="builtintype" id="2637456">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637463">t</span><span class="op" id="2637464">.</span><span class="ident" id="2637465">sec</span>&nbsp;<span class="op" id="2637469">=</span>&nbsp;<span class="op" id="2637471">-</span><span class="ident" id="2637472">t</span><span class="op" id="2637473">.</span><span class="ident" id="2637474">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637480">nsec</span>&nbsp;<span class="op" id="2637485">=</span>&nbsp;<span class="op" id="2637487">-</span><span class="ident" id="2637488">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637495">if</span>&nbsp;<span class="ident" id="2637498">nsec</span>&nbsp;<span class="op" id="2637503">&lt;</span>&nbsp;<span class="num" id="2637505">0</span>&nbsp;<span class="op" id="2637507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637512">nsec</span>&nbsp;<span class="op" id="2637517">+=</span>&nbsp;<span class="num" id="2637520">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637527">t</span><span class="op" id="2637528">.</span><span class="ident" id="2637529">sec</span><span class="op" id="2637532">--</span>&nbsp;<span class="comment" id="2637535">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637573">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637580">switch</span>&nbsp;<span class="op" id="2637587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637590">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637629">case</span>&nbsp;<span class="ident" id="2637634">d</span>&nbsp;<span class="op" id="2637636">&lt;</span>&nbsp;<span class="ident" id="2637638">Second</span>&nbsp;<span class="op" id="2637645">&amp;&amp;</span>&nbsp;<span class="ident" id="2637648">Second</span><span class="op" id="2637654">%</span><span class="op" id="2637655">(</span><span class="ident" id="2637656">d</span><span class="op" id="2637657">+</span><span class="ident" id="2637658">d</span><span class="op" id="2637659">)</span>&nbsp;<span class="op" id="2637661">==</span>&nbsp;<span class="num" id="2637664">0</span><span class="op" id="2637665">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637669">qmod2</span>&nbsp;<span class="op" id="2637675">=</span>&nbsp;<span class="builtintype" id="2637677">int</span><span class="op" id="2637680">(</span><span class="ident" id="2637681">nsec</span><span class="op" id="2637685">/</span><span class="builtintype" id="2637686">int32</span><span class="op" id="2637691">(</span><span class="ident" id="2637692">d</span><span class="op" id="2637693">)</span><span class="op" id="2637694">)</span>&nbsp;<span class="op" id="2637696">&amp;</span>&nbsp;<span class="num" id="2637698">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637702">r</span>&nbsp;<span class="op" id="2637704">=</span>&nbsp;<span class="ident" id="2637706">Duration</span><span class="op" id="2637714">(</span><span class="ident" id="2637715">nsec</span>&nbsp;<span class="op" id="2637720">%</span>&nbsp;<span class="builtintype" id="2637722">int32</span><span class="op" id="2637727">(</span><span class="ident" id="2637728">d</span><span class="op" id="2637729">)</span><span class="op" id="2637730">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637734">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637781">case</span>&nbsp;<span class="ident" id="2637786">d</span><span class="op" id="2637787">%</span><span class="ident" id="2637788">Second</span>&nbsp;<span class="op" id="2637795">==</span>&nbsp;<span class="num" id="2637798">0</span><span class="op" id="2637799">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637803">d1</span>&nbsp;<span class="op" id="2637806">:=</span>&nbsp;<span class="ident" id="2637809">int64</span><span class="op" id="2637814">(</span><span class="ident" id="2637815">d</span>&nbsp;<span class="op" id="2637817">/</span>&nbsp;<span class="ident" id="2637819">Second</span><span class="op" id="2637825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637829">qmod2</span>&nbsp;<span class="op" id="2637835">=</span>&nbsp;<span class="builtintype" id="2637837">int</span><span class="op" id="2637840">(</span><span class="ident" id="2637841">t</span><span class="op" id="2637842">.</span><span class="ident" id="2637843">sec</span><span class="op" id="2637846">/</span><span class="ident" id="2637847">d1</span><span class="op" id="2637849">)</span>&nbsp;<span class="op" id="2637851">&amp;</span>&nbsp;<span class="num" id="2637853">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637857">r</span>&nbsp;<span class="op" id="2637859">=</span>&nbsp;<span class="ident" id="2637861">Duration</span><span class="op" id="2637869">(</span><span class="ident" id="2637870">t</span><span class="op" id="2637871">.</span><span class="ident" id="2637872">sec</span><span class="op" id="2637875">%</span><span class="ident" id="2637876">d1</span><span class="op" id="2637878">)</span><span class="op" id="2637879">*</span><span class="ident" id="2637880">Second</span>&nbsp;<span class="op" id="2637887">+</span>&nbsp;<span class="ident" id="2637889">Duration</span><span class="op" id="2637897">(</span><span class="ident" id="2637898">nsec</span><span class="op" id="2637902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637906">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637924">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2637982">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638059">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638099">default</span><span class="op" id="2638106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638110">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638154">sec</span>&nbsp;<span class="op" id="2638158">:=</span>&nbsp;<span class="ident" id="2638161">uint64</span><span class="op" id="2638167">(</span><span class="ident" id="2638168">t</span><span class="op" id="2638169">.</span><span class="ident" id="2638170">sec</span><span class="op" id="2638173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638177">tmp</span>&nbsp;<span class="op" id="2638181">:=</span>&nbsp;<span class="op" id="2638184">(</span><span class="ident" id="2638185">sec</span>&nbsp;<span class="op" id="2638189">&gt;&gt;</span>&nbsp;<span class="num" id="2638192">32</span><span class="op" id="2638194">)</span>&nbsp;<span class="op" id="2638196">*</span>&nbsp;<span class="num" id="2638198">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638204">u1</span>&nbsp;<span class="op" id="2638207">:=</span>&nbsp;<span class="ident" id="2638210">tmp</span>&nbsp;<span class="op" id="2638214">&gt;&gt;</span>&nbsp;<span class="num" id="2638217">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638222">u0</span>&nbsp;<span class="op" id="2638225">:=</span>&nbsp;<span class="ident" id="2638228">tmp</span>&nbsp;<span class="op" id="2638232">&lt;&lt;</span>&nbsp;<span class="num" id="2638235">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638240">tmp</span>&nbsp;<span class="op" id="2638244">=</span>&nbsp;<span class="ident" id="2638246">uint64</span><span class="op" id="2638252">(</span><span class="ident" id="2638253">sec</span><span class="op" id="2638256">&amp;</span><span class="num" id="2638257">0xFFFFFFFF</span><span class="op" id="2638267">)</span>&nbsp;<span class="op" id="2638269">*</span>&nbsp;<span class="num" id="2638271">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638277">u0x</span><span class="op" id="2638280">,</span>&nbsp;<span class="ident" id="2638282">u0</span>&nbsp;<span class="op" id="2638285">:=</span>&nbsp;<span class="ident" id="2638288">u0</span><span class="op" id="2638290">,</span>&nbsp;<span class="ident" id="2638292">u0</span><span class="op" id="2638294">+</span><span class="ident" id="2638295">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638301">if</span>&nbsp;<span class="ident" id="2638304">u0</span>&nbsp;<span class="op" id="2638307">&lt;</span>&nbsp;<span class="ident" id="2638309">u0x</span>&nbsp;<span class="op" id="2638313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638318">u1</span><span class="op" id="2638320">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638329">u0x</span><span class="op" id="2638332">,</span>&nbsp;<span class="ident" id="2638334">u0</span>&nbsp;<span class="op" id="2638337">=</span>&nbsp;<span class="ident" id="2638339">u0</span><span class="op" id="2638341">,</span>&nbsp;<span class="ident" id="2638343">u0</span><span class="op" id="2638345">+</span><span class="ident" id="2638346">uint64</span><span class="op" id="2638352">(</span><span class="ident" id="2638353">nsec</span><span class="op" id="2638357">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638361">if</span>&nbsp;<span class="ident" id="2638364">u0</span>&nbsp;<span class="op" id="2638367">&lt;</span>&nbsp;<span class="ident" id="2638369">u0x</span>&nbsp;<span class="op" id="2638373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638378">u1</span><span class="op" id="2638380">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638390">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638451">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638510">d1</span>&nbsp;<span class="op" id="2638513">:=</span>&nbsp;<span class="ident" id="2638516">uint64</span><span class="op" id="2638522">(</span><span class="ident" id="2638523">d</span><span class="op" id="2638524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638528">for</span>&nbsp;<span class="ident" id="2638532">d1</span><span class="op" id="2638534">&gt;&gt;</span><span class="num" id="2638536">63</span>&nbsp;<span class="op" id="2638539">!=</span>&nbsp;<span class="num" id="2638542">1</span>&nbsp;<span class="op" id="2638544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638549">d1</span>&nbsp;<span class="op" id="2638552">&lt;&lt;=</span>&nbsp;<span class="num" id="2638556">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638560">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638564">d0</span>&nbsp;<span class="op" id="2638567">:=</span>&nbsp;<span class="ident" id="2638570">uint64</span><span class="op" id="2638576">(</span><span class="num" id="2638577">0</span><span class="op" id="2638578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638582">for</span>&nbsp;<span class="op" id="2638586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638591">qmod2</span>&nbsp;<span class="op" id="2638597">=</span>&nbsp;<span class="num" id="2638599">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638604">if</span>&nbsp;<span class="ident" id="2638607">u1</span>&nbsp;<span class="op" id="2638610">&gt;</span>&nbsp;<span class="ident" id="2638612">d1</span>&nbsp;<span class="op" id="2638615">||</span>&nbsp;<span class="ident" id="2638618">u1</span>&nbsp;<span class="op" id="2638621">==</span>&nbsp;<span class="ident" id="2638624">d1</span>&nbsp;<span class="op" id="2638627">&amp;&amp;</span>&nbsp;<span class="ident" id="2638630">u0</span>&nbsp;<span class="op" id="2638633">&gt;=</span>&nbsp;<span class="ident" id="2638636">d0</span>&nbsp;<span class="op" id="2638639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638645">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638661">qmod2</span>&nbsp;<span class="op" id="2638667">=</span>&nbsp;<span class="num" id="2638669">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638675">u0x</span><span class="op" id="2638678">,</span>&nbsp;<span class="ident" id="2638680">u0</span>&nbsp;<span class="op" id="2638683">=</span>&nbsp;<span class="ident" id="2638685">u0</span><span class="op" id="2638687">,</span>&nbsp;<span class="ident" id="2638689">u0</span><span class="op" id="2638691">-</span><span class="ident" id="2638692">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638699">if</span>&nbsp;<span class="ident" id="2638702">u0</span>&nbsp;<span class="op" id="2638705">&gt;</span>&nbsp;<span class="ident" id="2638707">u0x</span>&nbsp;<span class="op" id="2638711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638718">u1</span><span class="op" id="2638720">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638727">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638733">u1</span>&nbsp;<span class="op" id="2638736">-=</span>&nbsp;<span class="ident" id="2638739">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638750">if</span>&nbsp;<span class="ident" id="2638753">d1</span>&nbsp;<span class="op" id="2638756">==</span>&nbsp;<span class="num" id="2638759">0</span>&nbsp;<span class="op" id="2638761">&amp;&amp;</span>&nbsp;<span class="ident" id="2638764">d0</span>&nbsp;<span class="op" id="2638767">==</span>&nbsp;<span class="ident" id="2638770">uint64</span><span class="op" id="2638776">(</span><span class="ident" id="2638777">d</span><span class="op" id="2638778">)</span>&nbsp;<span class="op" id="2638780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638786">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638795">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638800">d0</span>&nbsp;<span class="op" id="2638803">&gt;&gt;=</span>&nbsp;<span class="num" id="2638807">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638812">d0</span>&nbsp;<span class="op" id="2638815">|=</span>&nbsp;<span class="op" id="2638818">(</span><span class="ident" id="2638819">d1</span>&nbsp;<span class="op" id="2638822">&amp;</span>&nbsp;<span class="num" id="2638824">1</span><span class="op" id="2638825">)</span>&nbsp;<span class="op" id="2638827">&lt;&lt;</span>&nbsp;<span class="num" id="2638830">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638836">d1</span>&nbsp;<span class="op" id="2638839">&gt;&gt;=</span>&nbsp;<span class="num" id="2638843">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638851">r</span>&nbsp;<span class="op" id="2638853">=</span>&nbsp;<span class="ident" id="2638855">Duration</span><span class="op" id="2638863">(</span><span class="ident" id="2638864">u0</span><span class="op" id="2638866">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638873">if</span>&nbsp;<span class="ident" id="2638876">neg</span>&nbsp;<span class="op" id="2638880">&amp;&amp;</span>&nbsp;<span class="ident" id="2638883">r</span>&nbsp;<span class="op" id="2638885">!=</span>&nbsp;<span class="num" id="2638888">0</span>&nbsp;<span class="op" id="2638890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638894">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638980">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638998">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639051">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639069">//&nbsp;&nbsp;&nbsp;&nbsp-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2639087">//&nbsp;&nbsp;&nbsp;&nbsp-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639115">qmod2</span>&nbsp;<span class="op" id="2639121">^=</span>&nbsp;<span class="num" id="2639124">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639128">r</span>&nbsp;<span class="op" id="2639130">=</span>&nbsp;<span class="ident" id="2639132">d</span>&nbsp;<span class="op" id="2639134">-</span>&nbsp;<span class="ident" id="2639136">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639142">return</span><br>
<span class="lineno"></span><span class="op" id="2639149">}</span>
</div>
</body>
</html>
