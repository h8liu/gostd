<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6926055">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6926110">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6926164">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6926215">package</span>&nbsp;<span class="ident" id="6926223">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6926228">import</span>&nbsp;<span class="op" id="6926235">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926238">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926245">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926251">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926264">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926275">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6926286">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6926293">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6926296">func</span>&nbsp;<span class="ident" id="6926301">isTimeout</span><span class="op" id="6926310">(</span><span class="ident" id="6926311">err</span>&nbsp;<span class="builtintype" id="6926315">error</span><span class="op" id="6926320">)</span>&nbsp;<span class="builtintype" id="6926322">bool</span>&nbsp;<span class="op" id="6926327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926330">e</span><span class="op" id="6926331">,</span>&nbsp;<span class="ident" id="6926333">ok</span>&nbsp;<span class="op" id="6926336">:=</span>&nbsp;<span class="ident" id="6926339"><a href="/net/timeout_test.go.html#6926311">err</a></span><span class="op" id="6926342">.</span><span class="op" id="6926343">(</span><span class="ident" id="6926344"><a href="/net/net.go.html#2656629">Error</a></span><span class="op" id="6926349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926352">return</span>&nbsp;<span class="ident" id="6926359"><a href="/net/timeout_test.go.html#6926333">ok</a></span>&nbsp;<span class="op" id="6926362">&amp;&amp;</span>&nbsp;<span class="ident" id="6926365"><a href="/net/timeout_test.go.html#6926330">e</a></span><span class="op" id="6926366">.</span><span class="ident" id="6926367">Timeout</span><span class="op" id="6926374">(</span><span class="op" id="6926375">)</span><br>
<span class="lineno"></span><span class="op" id="6926377">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6926380">type</span>&nbsp;<span class="ident" id="6926385">copyRes</span>&nbsp;<span class="keyword" id="6926393">struct</span>&nbsp;<span class="op" id="6926400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926403">n</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6926407">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926414">err</span>&nbsp;<span class="builtintype" id="6926418">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926425">d</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6926429"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6926433">.</span><span class="ident" id="6926434">Duration</span><br>
<span class="lineno">25</span><span class="op" id="6926443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6926446">func</span>&nbsp;<span class="ident" id="6926451">TestAcceptTimeout</span><span class="op" id="6926468">(</span><span class="ident" id="6926469">t</span>&nbsp;<span class="op" id="6926471">*</span><span class="ident" id="6926472"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6926479">.</span><span class="ident" id="6926480">T</span><span class="op" id="6926481">)</span>&nbsp;<span class="op" id="6926483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926486">switch</span>&nbsp;<span class="ident" id="6926493"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6926500">.</span><span class="ident" id="6926501">GOOS</span>&nbsp;<span class="op" id="6926506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926509">case</span>&nbsp;<span class="string" id="6926514">&#34;plan9&#34;</span><span class="op" id="6926521">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926525"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6926526">.</span><span class="ident" id="6926527">Skipf</span><span class="op" id="6926532">(</span><span class="string" id="6926533">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6926554">,</span>&nbsp;<span class="ident" id="6926556"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6926563">.</span><span class="ident" id="6926564">GOOS</span><span class="op" id="6926568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926575">ln</span>&nbsp;<span class="op" id="6926578">:=</span>&nbsp;<span class="ident" id="6926581"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6926597">(</span><span class="ident" id="6926598"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6926599">)</span><span class="op" id="6926600">.</span><span class="op" id="6926601">(</span><span class="op" id="6926602">*</span><span class="ident" id="6926603"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6926614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926617">defer</span>&nbsp;<span class="ident" id="6926623"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926625">.</span><span class="ident" id="6926626">Close</span><span class="op" id="6926631">(</span><span class="op" id="6926632">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926635"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926637">.</span><span class="ident" id="6926638">SetDeadline</span><span class="op" id="6926649">(</span><span class="ident" id="6926650"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6926654">.</span><span class="ident" id="6926655">Now</span><span class="op" id="6926658">(</span><span class="op" id="6926659">)</span><span class="op" id="6926660">.</span><span class="ident" id="6926661">Add</span><span class="op" id="6926664">(</span><span class="op" id="6926665">-</span><span class="num" id="6926666">1</span>&nbsp;<span class="op" id="6926668">*</span>&nbsp;<span class="ident" id="6926670"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6926674">.</span><span class="ident" id="6926675">Second</span><span class="op" id="6926681">)</span><span class="op" id="6926682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926685">if</span>&nbsp;<span class="ident" id="6926688">_</span><span class="op" id="6926689">,</span>&nbsp;<span class="ident" id="6926691">err</span>&nbsp;<span class="op" id="6926695">:=</span>&nbsp;<span class="ident" id="6926698"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926700">.</span><span class="ident" id="6926701">Accept</span><span class="op" id="6926707">(</span><span class="op" id="6926708">)</span><span class="op" id="6926709">;</span>&nbsp;<span class="op" id="6926711">!</span><span class="ident" id="6926712"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6926721">(</span><span class="ident" id="6926722"><a href="/net/timeout_test.go.html#6926691">err</a></span><span class="op" id="6926725">)</span>&nbsp;<span class="op" id="6926727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926731"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6926732">.</span><span class="ident" id="6926733">Fatalf</span><span class="op" id="6926739">(</span><span class="string" id="6926740">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6926773">,</span>&nbsp;<span class="ident" id="6926775"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6926785">,</span>&nbsp;<span class="ident" id="6926787"><a href="/net/timeout_test.go.html#6926691">err</a></span><span class="op" id="6926790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926796">if</span>&nbsp;<span class="ident" id="6926799">_</span><span class="op" id="6926800">,</span>&nbsp;<span class="ident" id="6926802">err</span>&nbsp;<span class="op" id="6926806">:=</span>&nbsp;<span class="ident" id="6926809"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926811">.</span><span class="ident" id="6926812">Accept</span><span class="op" id="6926818">(</span><span class="op" id="6926819">)</span><span class="op" id="6926820">;</span>&nbsp;<span class="op" id="6926822">!</span><span class="ident" id="6926823"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6926832">(</span><span class="ident" id="6926833"><a href="/net/timeout_test.go.html#6926802">err</a></span><span class="op" id="6926836">)</span>&nbsp;<span class="op" id="6926838">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926842"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6926843">.</span><span class="ident" id="6926844">Fatalf</span><span class="op" id="6926850">(</span><span class="string" id="6926851">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6926884">,</span>&nbsp;<span class="ident" id="6926886"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6926896">,</span>&nbsp;<span class="ident" id="6926898"><a href="/net/timeout_test.go.html#6926802">err</a></span><span class="op" id="6926901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6926904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6926907"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926909">.</span><span class="ident" id="6926910">SetDeadline</span><span class="op" id="6926921">(</span><span class="ident" id="6926922"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6926926">.</span><span class="ident" id="6926927">Now</span><span class="op" id="6926930">(</span><span class="op" id="6926931">)</span><span class="op" id="6926932">.</span><span class="ident" id="6926933">Add</span><span class="op" id="6926936">(</span><span class="num" id="6926937">100</span>&nbsp;<span class="op" id="6926941">*</span>&nbsp;<span class="ident" id="6926943"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6926947">.</span><span class="ident" id="6926948">Millisecond</span><span class="op" id="6926959">)</span><span class="op" id="6926960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6926963">if</span>&nbsp;<span class="ident" id="6926966">_</span><span class="op" id="6926967">,</span>&nbsp;<span class="ident" id="6926969">err</span>&nbsp;<span class="op" id="6926973">:=</span>&nbsp;<span class="ident" id="6926976"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6926978">.</span><span class="ident" id="6926979">Accept</span><span class="op" id="6926985">(</span><span class="op" id="6926986">)</span><span class="op" id="6926987">;</span>&nbsp;<span class="op" id="6926989">!</span><span class="ident" id="6926990"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6926999">(</span><span class="ident" id="6927000"><a href="/net/timeout_test.go.html#6926969">err</a></span><span class="op" id="6927003">)</span>&nbsp;<span class="op" id="6927005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927009"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6927010">.</span><span class="ident" id="6927011">Fatalf</span><span class="op" id="6927017">(</span><span class="string" id="6927018">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6927051">,</span>&nbsp;<span class="ident" id="6927053"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6927063">,</span>&nbsp;<span class="ident" id="6927065"><a href="/net/timeout_test.go.html#6926969">err</a></span><span class="op" id="6927068">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927074">if</span>&nbsp;<span class="ident" id="6927077">_</span><span class="op" id="6927078">,</span>&nbsp;<span class="ident" id="6927080">err</span>&nbsp;<span class="op" id="6927084">:=</span>&nbsp;<span class="ident" id="6927087"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6927089">.</span><span class="ident" id="6927090">Accept</span><span class="op" id="6927096">(</span><span class="op" id="6927097">)</span><span class="op" id="6927098">;</span>&nbsp;<span class="op" id="6927100">!</span><span class="ident" id="6927101"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6927110">(</span><span class="ident" id="6927111"><a href="/net/timeout_test.go.html#6927080">err</a></span><span class="op" id="6927114">)</span>&nbsp;<span class="op" id="6927116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927120"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6927121">.</span><span class="ident" id="6927122">Fatalf</span><span class="op" id="6927128">(</span><span class="string" id="6927129">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6927162">,</span>&nbsp;<span class="ident" id="6927164"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6927174">,</span>&nbsp;<span class="ident" id="6927176"><a href="/net/timeout_test.go.html#6927080">err</a></span><span class="op" id="6927179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927185"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6927187">.</span><span class="ident" id="6927188">SetDeadline</span><span class="op" id="6927199">(</span><span class="ident" id="6927200"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="6927210">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927213">errc</span>&nbsp;<span class="op" id="6927218">:=</span>&nbsp;<span class="builtinfunc" id="6927221">make</span><span class="op" id="6927225">(</span><span class="keyword" id="6927226">chan</span>&nbsp;<span class="builtintype" id="6927231">error</span><span class="op" id="6927236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927239">go</span>&nbsp;<span class="keyword" id="6927242">func</span><span class="op" id="6927246">(</span><span class="op" id="6927247">)</span>&nbsp;<span class="op" id="6927249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927253">_</span><span class="op" id="6927254">,</span>&nbsp;<span class="ident" id="6927256">err</span>&nbsp;<span class="op" id="6927260">:=</span>&nbsp;<span class="ident" id="6927263"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6927265">.</span><span class="ident" id="6927266">Accept</span><span class="op" id="6927272">(</span><span class="op" id="6927273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927277"><a href="/net/timeout_test.go.html#6927213">errc</a></span>&nbsp;<span class="op" id="6927282">&lt;-</span>&nbsp;<span class="ident" id="6927285"><a href="/net/timeout_test.go.html#6927256">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927290">}</span><span class="op" id="6927291">(</span><span class="op" id="6927292">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927295"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6927299">.</span><span class="ident" id="6927300">Sleep</span><span class="op" id="6927305">(</span><span class="num" id="6927306">100</span>&nbsp;<span class="op" id="6927310">*</span>&nbsp;<span class="ident" id="6927312"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6927316">.</span><span class="ident" id="6927317">Millisecond</span><span class="op" id="6927328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927331">select</span>&nbsp;<span class="op" id="6927338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927341">case</span>&nbsp;<span class="ident" id="6927346">err</span>&nbsp;<span class="op" id="6927350">:=</span>&nbsp;<span class="op" id="6927353">&lt;-</span><span class="ident" id="6927355"><a href="/net/timeout_test.go.html#6927213">errc</a></span><span class="op" id="6927359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927363"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6927364">.</span><span class="ident" id="6927365">Fatalf</span><span class="op" id="6927371">(</span><span class="string" id="6927372">&#34;Expected&nbsp;Accept()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="6927432">,</span>&nbsp;<span class="ident" id="6927434"><a href="/net/timeout_test.go.html#6927346">err</a></span><span class="op" id="6927437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927440">default</span><span class="op" id="6927447">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927453"><a href="/net/timeout_test.go.html#6926575">ln</a></span><span class="op" id="6927455">.</span><span class="ident" id="6927456">Close</span><span class="op" id="6927461">(</span><span class="op" id="6927462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927465">switch</span>&nbsp;<span class="ident" id="6927472">nerr</span>&nbsp;<span class="op" id="6927477">:=</span>&nbsp;<span class="op" id="6927480">&lt;-</span><span class="ident" id="6927482"><a href="/net/timeout_test.go.html#6927213">errc</a></span><span class="op" id="6927486">;</span>&nbsp;<span class="ident" id="6927488">err</span>&nbsp;<span class="op" id="6927492">:=</span>&nbsp;<span class="ident" id="6927495"><a href="/net/timeout_test.go.html#6927472">nerr</a></span><span class="op" id="6927499">.</span><span class="op" id="6927500">(</span><span class="keyword" id="6927501">type</span><span class="op" id="6927505">)</span>&nbsp;<span class="op" id="6927507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927510">case</span>&nbsp;<span class="op" id="6927515">*</span><span class="ident" id="6927516"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="6927523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927527">if</span>&nbsp;<span class="ident" id="6927530"><a href="/net/timeout_test.go.html#6927488">err</a></span><span class="op" id="6927533">.</span><span class="ident" id="6927534">Err</span>&nbsp;<span class="op" id="6927538">!=</span>&nbsp;<span class="ident" id="6927541"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6927552">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927557"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6927558">.</span><span class="ident" id="6927559">Fatalf</span><span class="op" id="6927565">(</span><span class="string" id="6927566">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6927599">,</span>&nbsp;<span class="ident" id="6927601"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6927611">,</span>&nbsp;<span class="ident" id="6927613"><a href="/net/timeout_test.go.html#6927488">err</a></span><span class="op" id="6927616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927623">default</span><span class="op" id="6927630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927634">if</span>&nbsp;<span class="ident" id="6927637"><a href="/net/timeout_test.go.html#6927488">err</a></span>&nbsp;<span class="op" id="6927641">!=</span>&nbsp;<span class="ident" id="6927644"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6927655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927660"><a href="/net/timeout_test.go.html#6926469">t</a></span><span class="op" id="6927661">.</span><span class="ident" id="6927662">Fatalf</span><span class="op" id="6927668">(</span><span class="string" id="6927669">&#34;Accept:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6927702">,</span>&nbsp;<span class="ident" id="6927704"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6927714">,</span>&nbsp;<span class="ident" id="6927716"><a href="/net/timeout_test.go.html#6927488">err</a></span><span class="op" id="6927719">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927726">}</span><br>
<span class="lineno"></span><span class="op" id="6927728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6927731">func</span>&nbsp;<span class="ident" id="6927736">TestReadTimeout</span><span class="op" id="6927751">(</span><span class="ident" id="6927752">t</span>&nbsp;<span class="op" id="6927754">*</span><span class="ident" id="6927755"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6927762">.</span><span class="ident" id="6927763">T</span><span class="op" id="6927764">)</span>&nbsp;<span class="op" id="6927766">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927769">switch</span>&nbsp;<span class="ident" id="6927776"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6927783">.</span><span class="ident" id="6927784">GOOS</span>&nbsp;<span class="op" id="6927789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927792">case</span>&nbsp;<span class="string" id="6927797">&#34;plan9&#34;</span><span class="op" id="6927804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927808"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6927809">.</span><span class="ident" id="6927810">Skipf</span><span class="op" id="6927815">(</span><span class="string" id="6927816">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6927837">,</span>&nbsp;<span class="ident" id="6927839"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6927846">.</span><span class="ident" id="6927847">GOOS</span><span class="op" id="6927851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6927854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927858">ln</span>&nbsp;<span class="op" id="6927861">:=</span>&nbsp;<span class="ident" id="6927864"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6927880">(</span><span class="ident" id="6927881"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6927882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927885">defer</span>&nbsp;<span class="ident" id="6927891"><a href="/net/timeout_test.go.html#6927858">ln</a></span><span class="op" id="6927893">.</span><span class="ident" id="6927894">Close</span><span class="op" id="6927899">(</span><span class="op" id="6927900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927903">c</span><span class="op" id="6927904">,</span>&nbsp;<span class="ident" id="6927906">err</span>&nbsp;<span class="op" id="6927910">:=</span>&nbsp;<span class="ident" id="6927913"><a href="/net/tcpsock_posix.go.html#2696531">DialTCP</a></span><span class="op" id="6927920">(</span><span class="string" id="6927921">&#34;tcp&#34;</span><span class="op" id="6927926">,</span>&nbsp;<span class="ident" id="6927928">nil</span><span class="op" id="6927931">,</span>&nbsp;<span class="ident" id="6927933"><a href="/net/timeout_test.go.html#6927858">ln</a></span><span class="op" id="6927935">.</span><span class="ident" id="6927936">Addr</span><span class="op" id="6927940">(</span><span class="op" id="6927941">)</span><span class="op" id="6927942">.</span><span class="op" id="6927943">(</span><span class="op" id="6927944">*</span><span class="ident" id="6927945"><a href="/net/tcpsock.go.html#2691528">TCPAddr</a></span><span class="op" id="6927952">)</span><span class="op" id="6927953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6927956">if</span>&nbsp;<span class="ident" id="6927959"><a href="/net/timeout_test.go.html#6927906">err</a></span>&nbsp;<span class="op" id="6927963">!=</span>&nbsp;<span class="ident" id="6927966">nil</span>&nbsp;<span class="op" id="6927970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6927974"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6927975">.</span><span class="ident" id="6927976">Fatalf</span><span class="op" id="6927982">(</span><span class="string" id="6927983">&#34;Connect:&nbsp;%v&#34;</span><span class="op" id="6927996">,</span>&nbsp;<span class="ident" id="6927998"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928001">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928007">defer</span>&nbsp;<span class="ident" id="6928013"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928014">.</span><span class="ident" id="6928015">Close</span><span class="op" id="6928020">(</span><span class="op" id="6928021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928024"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928025">.</span><span class="ident" id="6928026">SetDeadline</span><span class="op" id="6928037">(</span><span class="ident" id="6928038"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928042">.</span><span class="ident" id="6928043">Now</span><span class="op" id="6928046">(</span><span class="op" id="6928047">)</span><span class="op" id="6928048">.</span><span class="ident" id="6928049">Add</span><span class="op" id="6928052">(</span><span class="ident" id="6928053"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928057">.</span><span class="ident" id="6928058">Hour</span><span class="op" id="6928062">)</span><span class="op" id="6928063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928066"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928067">.</span><span class="ident" id="6928068">SetReadDeadline</span><span class="op" id="6928083">(</span><span class="ident" id="6928084"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928088">.</span><span class="ident" id="6928089">Now</span><span class="op" id="6928092">(</span><span class="op" id="6928093">)</span><span class="op" id="6928094">.</span><span class="ident" id="6928095">Add</span><span class="op" id="6928098">(</span><span class="op" id="6928099">-</span><span class="num" id="6928100">1</span>&nbsp;<span class="op" id="6928102">*</span>&nbsp;<span class="ident" id="6928104"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928108">.</span><span class="ident" id="6928109">Second</span><span class="op" id="6928115">)</span><span class="op" id="6928116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928119">buf</span>&nbsp;<span class="op" id="6928123">:=</span>&nbsp;<span class="builtinfunc" id="6928126">make</span><span class="op" id="6928130">(</span><span class="op" id="6928131">[</span><span class="op" id="6928132">]</span><span class="builtintype" id="6928133">byte</span><span class="op" id="6928137">,</span>&nbsp;<span class="num" id="6928139">1</span><span class="op" id="6928140">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928143">if</span>&nbsp;<span class="ident" id="6928146">_</span><span class="op" id="6928147">,</span>&nbsp;<span class="ident" id="6928149"><a href="/net/timeout_test.go.html#6927906">err</a></span>&nbsp;<span class="op" id="6928153">=</span>&nbsp;<span class="ident" id="6928155"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928156">.</span><span class="ident" id="6928157">Read</span><span class="op" id="6928161">(</span><span class="ident" id="6928162"><a href="/net/timeout_test.go.html#6928119">buf</a></span><span class="op" id="6928165">)</span><span class="op" id="6928166">;</span>&nbsp;<span class="op" id="6928168">!</span><span class="ident" id="6928169"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6928178">(</span><span class="ident" id="6928179"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928182">)</span>&nbsp;<span class="op" id="6928184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928188"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6928189">.</span><span class="ident" id="6928190">Fatalf</span><span class="op" id="6928196">(</span><span class="string" id="6928197">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6928228">,</span>&nbsp;<span class="ident" id="6928230"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6928240">,</span>&nbsp;<span class="ident" id="6928242"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928251">if</span>&nbsp;<span class="ident" id="6928254">_</span><span class="op" id="6928255">,</span>&nbsp;<span class="ident" id="6928257"><a href="/net/timeout_test.go.html#6927906">err</a></span>&nbsp;<span class="op" id="6928261">=</span>&nbsp;<span class="ident" id="6928263"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928264">.</span><span class="ident" id="6928265">Read</span><span class="op" id="6928269">(</span><span class="ident" id="6928270"><a href="/net/timeout_test.go.html#6928119">buf</a></span><span class="op" id="6928273">)</span><span class="op" id="6928274">;</span>&nbsp;<span class="op" id="6928276">!</span><span class="ident" id="6928277"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6928286">(</span><span class="ident" id="6928287"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928290">)</span>&nbsp;<span class="op" id="6928292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928296"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6928297">.</span><span class="ident" id="6928298">Fatalf</span><span class="op" id="6928304">(</span><span class="string" id="6928305">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6928336">,</span>&nbsp;<span class="ident" id="6928338"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6928348">,</span>&nbsp;<span class="ident" id="6928350"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928353">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928359"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928360">.</span><span class="ident" id="6928361">SetDeadline</span><span class="op" id="6928372">(</span><span class="ident" id="6928373"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928377">.</span><span class="ident" id="6928378">Now</span><span class="op" id="6928381">(</span><span class="op" id="6928382">)</span><span class="op" id="6928383">.</span><span class="ident" id="6928384">Add</span><span class="op" id="6928387">(</span><span class="num" id="6928388">100</span>&nbsp;<span class="op" id="6928392">*</span>&nbsp;<span class="ident" id="6928394"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928398">.</span><span class="ident" id="6928399">Millisecond</span><span class="op" id="6928410">)</span><span class="op" id="6928411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928414">if</span>&nbsp;<span class="ident" id="6928417">_</span><span class="op" id="6928418">,</span>&nbsp;<span class="ident" id="6928420"><a href="/net/timeout_test.go.html#6927906">err</a></span>&nbsp;<span class="op" id="6928424">=</span>&nbsp;<span class="ident" id="6928426"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928427">.</span><span class="ident" id="6928428">Read</span><span class="op" id="6928432">(</span><span class="ident" id="6928433"><a href="/net/timeout_test.go.html#6928119">buf</a></span><span class="op" id="6928436">)</span><span class="op" id="6928437">;</span>&nbsp;<span class="op" id="6928439">!</span><span class="ident" id="6928440"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6928449">(</span><span class="ident" id="6928450"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928453">)</span>&nbsp;<span class="op" id="6928455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928459"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6928460">.</span><span class="ident" id="6928461">Fatalf</span><span class="op" id="6928467">(</span><span class="string" id="6928468">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6928499">,</span>&nbsp;<span class="ident" id="6928501"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6928511">,</span>&nbsp;<span class="ident" id="6928513"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928519">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928522">if</span>&nbsp;<span class="ident" id="6928525">_</span><span class="op" id="6928526">,</span>&nbsp;<span class="ident" id="6928528"><a href="/net/timeout_test.go.html#6927906">err</a></span>&nbsp;<span class="op" id="6928532">=</span>&nbsp;<span class="ident" id="6928534"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928535">.</span><span class="ident" id="6928536">Read</span><span class="op" id="6928540">(</span><span class="ident" id="6928541"><a href="/net/timeout_test.go.html#6928119">buf</a></span><span class="op" id="6928544">)</span><span class="op" id="6928545">;</span>&nbsp;<span class="op" id="6928547">!</span><span class="ident" id="6928548"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6928557">(</span><span class="ident" id="6928558"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928561">)</span>&nbsp;<span class="op" id="6928563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928567"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6928568">.</span><span class="ident" id="6928569">Fatalf</span><span class="op" id="6928575">(</span><span class="string" id="6928576">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6928607">,</span>&nbsp;<span class="ident" id="6928609"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6928619">,</span>&nbsp;<span class="ident" id="6928621"><a href="/net/timeout_test.go.html#6927906">err</a></span><span class="op" id="6928624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928630"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928631">.</span><span class="ident" id="6928632">SetReadDeadline</span><span class="op" id="6928647">(</span><span class="ident" id="6928648"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="6928658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928661"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928662">.</span><span class="ident" id="6928663">SetWriteDeadline</span><span class="op" id="6928679">(</span><span class="ident" id="6928680"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928684">.</span><span class="ident" id="6928685">Now</span><span class="op" id="6928688">(</span><span class="op" id="6928689">)</span><span class="op" id="6928690">.</span><span class="ident" id="6928691">Add</span><span class="op" id="6928694">(</span><span class="op" id="6928695">-</span><span class="num" id="6928696">1</span>&nbsp;<span class="op" id="6928698">*</span>&nbsp;<span class="ident" id="6928700"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928704">.</span><span class="ident" id="6928705">Second</span><span class="op" id="6928711">)</span><span class="op" id="6928712">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928715">errc</span>&nbsp;<span class="op" id="6928720">:=</span>&nbsp;<span class="builtinfunc" id="6928723">make</span><span class="op" id="6928727">(</span><span class="keyword" id="6928728">chan</span>&nbsp;<span class="builtintype" id="6928733">error</span><span class="op" id="6928738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928741">go</span>&nbsp;<span class="keyword" id="6928744">func</span><span class="op" id="6928748">(</span><span class="op" id="6928749">)</span>&nbsp;<span class="op" id="6928751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928755">_</span><span class="op" id="6928756">,</span>&nbsp;<span class="ident" id="6928758">err</span>&nbsp;<span class="op" id="6928762">:=</span>&nbsp;<span class="ident" id="6928765"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928766">.</span><span class="ident" id="6928767">Read</span><span class="op" id="6928771">(</span><span class="ident" id="6928772"><a href="/net/timeout_test.go.html#6928119">buf</a></span><span class="op" id="6928775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928779"><a href="/net/timeout_test.go.html#6928715">errc</a></span>&nbsp;<span class="op" id="6928784">&lt;-</span>&nbsp;<span class="ident" id="6928787"><a href="/net/timeout_test.go.html#6928758">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928792">}</span><span class="op" id="6928793">(</span><span class="op" id="6928794">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928797"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928801">.</span><span class="ident" id="6928802">Sleep</span><span class="op" id="6928807">(</span><span class="num" id="6928808">100</span>&nbsp;<span class="op" id="6928812">*</span>&nbsp;<span class="ident" id="6928814"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6928818">.</span><span class="ident" id="6928819">Millisecond</span><span class="op" id="6928830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928833">select</span>&nbsp;<span class="op" id="6928840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928843">case</span>&nbsp;<span class="ident" id="6928848">err</span>&nbsp;<span class="op" id="6928852">:=</span>&nbsp;<span class="op" id="6928855">&lt;-</span><span class="ident" id="6928857"><a href="/net/timeout_test.go.html#6928715">errc</a></span><span class="op" id="6928861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928865"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6928866">.</span><span class="ident" id="6928867">Fatalf</span><span class="op" id="6928873">(</span><span class="string" id="6928874">&#34;Expected&nbsp;Read()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="6928932">,</span>&nbsp;<span class="ident" id="6928934"><a href="/net/timeout_test.go.html#6928848">err</a></span><span class="op" id="6928937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928940">default</span><span class="op" id="6928947">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6928950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928953"><a href="/net/timeout_test.go.html#6927903">c</a></span><span class="op" id="6928954">.</span><span class="ident" id="6928955">Close</span><span class="op" id="6928960">(</span><span class="op" id="6928961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6928964">switch</span>&nbsp;<span class="ident" id="6928971">nerr</span>&nbsp;<span class="op" id="6928976">:=</span>&nbsp;<span class="op" id="6928979">&lt;-</span><span class="ident" id="6928981"><a href="/net/timeout_test.go.html#6928715">errc</a></span><span class="op" id="6928985">;</span>&nbsp;<span class="ident" id="6928987">err</span>&nbsp;<span class="op" id="6928991">:=</span>&nbsp;<span class="ident" id="6928994"><a href="/net/timeout_test.go.html#6928971">nerr</a></span><span class="op" id="6928998">.</span><span class="op" id="6928999">(</span><span class="keyword" id="6929000">type</span><span class="op" id="6929004">)</span>&nbsp;<span class="op" id="6929006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929009">case</span>&nbsp;<span class="op" id="6929014">*</span><span class="ident" id="6929015"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="6929022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929026">if</span>&nbsp;<span class="ident" id="6929029"><a href="/net/timeout_test.go.html#6928987">err</a></span><span class="op" id="6929032">.</span><span class="ident" id="6929033">Err</span>&nbsp;<span class="op" id="6929037">!=</span>&nbsp;<span class="ident" id="6929040"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6929051">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929056"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6929057">.</span><span class="ident" id="6929058">Fatalf</span><span class="op" id="6929064">(</span><span class="string" id="6929065">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6929096">,</span>&nbsp;<span class="ident" id="6929098"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6929108">,</span>&nbsp;<span class="ident" id="6929110"><a href="/net/timeout_test.go.html#6928987">err</a></span><span class="op" id="6929113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929120">default</span><span class="op" id="6929127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929131">if</span>&nbsp;<span class="ident" id="6929134"><a href="/net/timeout_test.go.html#6928987">err</a></span>&nbsp;<span class="op" id="6929138">==</span>&nbsp;<span class="ident" id="6929141"><a href="/net/timeout_test.go.html#6926245">io</a></span><span class="op" id="6929143">.</span><span class="ident" id="6929144">EOF</span>&nbsp;<span class="op" id="6929148">&amp;&amp;</span>&nbsp;<span class="ident" id="6929151"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6929158">.</span><span class="ident" id="6929159">GOOS</span>&nbsp;<span class="op" id="6929164">==</span>&nbsp;<span class="string" id="6929167">&#34;nacl&#34;</span>&nbsp;<span class="op" id="6929174">{</span>&nbsp;<span class="comment" id="6929176">//&nbsp;close&nbsp;enough;&nbsp;golang.org/issue/8044</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929218">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929230">if</span>&nbsp;<span class="ident" id="6929233"><a href="/net/timeout_test.go.html#6928987">err</a></span>&nbsp;<span class="op" id="6929237">!=</span>&nbsp;<span class="ident" id="6929240"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6929251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929256"><a href="/net/timeout_test.go.html#6927752">t</a></span><span class="op" id="6929257">.</span><span class="ident" id="6929258">Fatalf</span><span class="op" id="6929264">(</span><span class="string" id="6929265">&#34;Read:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6929296">,</span>&nbsp;<span class="ident" id="6929298"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6929308">,</span>&nbsp;<span class="ident" id="6929310"><a href="/net/timeout_test.go.html#6928987">err</a></span><span class="op" id="6929313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929320">}</span><br>
<span class="lineno">130</span><span class="op" id="6929322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6929325">func</span>&nbsp;<span class="ident" id="6929330">TestWriteTimeout</span><span class="op" id="6929346">(</span><span class="ident" id="6929347">t</span>&nbsp;<span class="op" id="6929349">*</span><span class="ident" id="6929350"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6929357">.</span><span class="ident" id="6929358">T</span><span class="op" id="6929359">)</span>&nbsp;<span class="op" id="6929361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929364">switch</span>&nbsp;<span class="ident" id="6929371"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6929378">.</span><span class="ident" id="6929379">GOOS</span>&nbsp;<span class="op" id="6929384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929387">case</span>&nbsp;<span class="string" id="6929392">&#34;plan9&#34;</span><span class="op" id="6929399">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929403"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6929404">.</span><span class="ident" id="6929405">Skipf</span><span class="op" id="6929410">(</span><span class="string" id="6929411">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6929432">,</span>&nbsp;<span class="ident" id="6929434"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6929441">.</span><span class="ident" id="6929442">GOOS</span><span class="op" id="6929446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929453">ln</span>&nbsp;<span class="op" id="6929456">:=</span>&nbsp;<span class="ident" id="6929459"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6929475">(</span><span class="ident" id="6929476"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6929477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929480">defer</span>&nbsp;<span class="ident" id="6929486"><a href="/net/timeout_test.go.html#6929453">ln</a></span><span class="op" id="6929488">.</span><span class="ident" id="6929489">Close</span><span class="op" id="6929494">(</span><span class="op" id="6929495">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929498">c</span><span class="op" id="6929499">,</span>&nbsp;<span class="ident" id="6929501">err</span>&nbsp;<span class="op" id="6929505">:=</span>&nbsp;<span class="ident" id="6929508"><a href="/net/tcpsock_posix.go.html#2696531">DialTCP</a></span><span class="op" id="6929515">(</span><span class="string" id="6929516">&#34;tcp&#34;</span><span class="op" id="6929521">,</span>&nbsp;<span class="ident" id="6929523">nil</span><span class="op" id="6929526">,</span>&nbsp;<span class="ident" id="6929528"><a href="/net/timeout_test.go.html#6929453">ln</a></span><span class="op" id="6929530">.</span><span class="ident" id="6929531">Addr</span><span class="op" id="6929535">(</span><span class="op" id="6929536">)</span><span class="op" id="6929537">.</span><span class="op" id="6929538">(</span><span class="op" id="6929539">*</span><span class="ident" id="6929540"><a href="/net/tcpsock.go.html#2691528">TCPAddr</a></span><span class="op" id="6929547">)</span><span class="op" id="6929548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929551">if</span>&nbsp;<span class="ident" id="6929554"><a href="/net/timeout_test.go.html#6929501">err</a></span>&nbsp;<span class="op" id="6929558">!=</span>&nbsp;<span class="ident" id="6929561">nil</span>&nbsp;<span class="op" id="6929565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929569"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6929570">.</span><span class="ident" id="6929571">Fatalf</span><span class="op" id="6929577">(</span><span class="string" id="6929578">&#34;Connect:&nbsp;%v&#34;</span><span class="op" id="6929591">,</span>&nbsp;<span class="ident" id="6929593"><a href="/net/timeout_test.go.html#6929501">err</a></span><span class="op" id="6929596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929602">defer</span>&nbsp;<span class="ident" id="6929608"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6929609">.</span><span class="ident" id="6929610">Close</span><span class="op" id="6929615">(</span><span class="op" id="6929616">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929619"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6929620">.</span><span class="ident" id="6929621">SetDeadline</span><span class="op" id="6929632">(</span><span class="ident" id="6929633"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6929637">.</span><span class="ident" id="6929638">Now</span><span class="op" id="6929641">(</span><span class="op" id="6929642">)</span><span class="op" id="6929643">.</span><span class="ident" id="6929644">Add</span><span class="op" id="6929647">(</span><span class="ident" id="6929648"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6929652">.</span><span class="ident" id="6929653">Hour</span><span class="op" id="6929657">)</span><span class="op" id="6929658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929661"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6929662">.</span><span class="ident" id="6929663">SetWriteDeadline</span><span class="op" id="6929679">(</span><span class="ident" id="6929680"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6929684">.</span><span class="ident" id="6929685">Now</span><span class="op" id="6929688">(</span><span class="op" id="6929689">)</span><span class="op" id="6929690">.</span><span class="ident" id="6929691">Add</span><span class="op" id="6929694">(</span><span class="op" id="6929695">-</span><span class="num" id="6929696">1</span>&nbsp;<span class="op" id="6929698">*</span>&nbsp;<span class="ident" id="6929700"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6929704">.</span><span class="ident" id="6929705">Second</span><span class="op" id="6929711">)</span><span class="op" id="6929712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929715">buf</span>&nbsp;<span class="op" id="6929719">:=</span>&nbsp;<span class="builtinfunc" id="6929722">make</span><span class="op" id="6929726">(</span><span class="op" id="6929727">[</span><span class="op" id="6929728">]</span><span class="builtintype" id="6929729">byte</span><span class="op" id="6929733">,</span>&nbsp;<span class="num" id="6929735">4096</span><span class="op" id="6929739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929742">writeUntilTimeout</span>&nbsp;<span class="op" id="6929760">:=</span>&nbsp;<span class="keyword" id="6929763">func</span><span class="op" id="6929767">(</span><span class="op" id="6929768">)</span>&nbsp;<span class="op" id="6929770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929774">for</span>&nbsp;<span class="op" id="6929778">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929783">_</span><span class="op" id="6929784">,</span>&nbsp;<span class="ident" id="6929786">err</span>&nbsp;<span class="op" id="6929790">:=</span>&nbsp;<span class="ident" id="6929793"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6929794">.</span><span class="ident" id="6929795">Write</span><span class="op" id="6929800">(</span><span class="ident" id="6929801"><a href="/net/timeout_test.go.html#6929715">buf</a></span><span class="op" id="6929804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929809">if</span>&nbsp;<span class="ident" id="6929812"><a href="/net/timeout_test.go.html#6929786">err</a></span>&nbsp;<span class="op" id="6929816">!=</span>&nbsp;<span class="ident" id="6929819">nil</span>&nbsp;<span class="op" id="6929823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929829">if</span>&nbsp;<span class="ident" id="6929832"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6929841">(</span><span class="ident" id="6929842"><a href="/net/timeout_test.go.html#6929786">err</a></span><span class="op" id="6929845">)</span>&nbsp;<span class="op" id="6929847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6929854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929865">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929871"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6929872">.</span><span class="ident" id="6929873">Fatalf</span><span class="op" id="6929879">(</span><span class="string" id="6929880">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6929912">,</span>&nbsp;<span class="ident" id="6929914"><a href="/net/net.go.html#2659253">errTimeout</a></span><span class="op" id="6929924">,</span>&nbsp;<span class="ident" id="6929926"><a href="/net/timeout_test.go.html#6929786">err</a></span><span class="op" id="6929929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929944"><a href="/net/timeout_test.go.html#6929742">writeUntilTimeout</a></span><span class="op" id="6929961">(</span><span class="op" id="6929962">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929965"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6929966">.</span><span class="ident" id="6929967">SetDeadline</span><span class="op" id="6929978">(</span><span class="ident" id="6929979"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6929983">.</span><span class="ident" id="6929984">Now</span><span class="op" id="6929987">(</span><span class="op" id="6929988">)</span><span class="op" id="6929989">.</span><span class="ident" id="6929990">Add</span><span class="op" id="6929993">(</span><span class="num" id="6929994">10</span>&nbsp;<span class="op" id="6929997">*</span>&nbsp;<span class="ident" id="6929999"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6930003">.</span><span class="ident" id="6930004">Millisecond</span><span class="op" id="6930015">)</span><span class="op" id="6930016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930019"><a href="/net/timeout_test.go.html#6929742">writeUntilTimeout</a></span><span class="op" id="6930036">(</span><span class="op" id="6930037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930040"><a href="/net/timeout_test.go.html#6929742">writeUntilTimeout</a></span><span class="op" id="6930057">(</span><span class="op" id="6930058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930061"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6930062">.</span><span class="ident" id="6930063">SetWriteDeadline</span><span class="op" id="6930079">(</span><span class="ident" id="6930080"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="6930090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930093"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6930094">.</span><span class="ident" id="6930095">SetReadDeadline</span><span class="op" id="6930110">(</span><span class="ident" id="6930111"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6930115">.</span><span class="ident" id="6930116">Now</span><span class="op" id="6930119">(</span><span class="op" id="6930120">)</span><span class="op" id="6930121">.</span><span class="ident" id="6930122">Add</span><span class="op" id="6930125">(</span><span class="op" id="6930126">-</span><span class="num" id="6930127">1</span>&nbsp;<span class="op" id="6930129">*</span>&nbsp;<span class="ident" id="6930131"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6930135">.</span><span class="ident" id="6930136">Second</span><span class="op" id="6930142">)</span><span class="op" id="6930143">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930146">errc</span>&nbsp;<span class="op" id="6930151">:=</span>&nbsp;<span class="builtinfunc" id="6930154">make</span><span class="op" id="6930158">(</span><span class="keyword" id="6930159">chan</span>&nbsp;<span class="builtintype" id="6930164">error</span><span class="op" id="6930169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930172">go</span>&nbsp;<span class="keyword" id="6930175">func</span><span class="op" id="6930179">(</span><span class="op" id="6930180">)</span>&nbsp;<span class="op" id="6930182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930186">for</span>&nbsp;<span class="op" id="6930190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930195">_</span><span class="op" id="6930196">,</span>&nbsp;<span class="ident" id="6930198">err</span>&nbsp;<span class="op" id="6930202">:=</span>&nbsp;<span class="ident" id="6930205"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6930206">.</span><span class="ident" id="6930207">Write</span><span class="op" id="6930212">(</span><span class="ident" id="6930213"><a href="/net/timeout_test.go.html#6929715">buf</a></span><span class="op" id="6930216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930221">if</span>&nbsp;<span class="ident" id="6930224"><a href="/net/timeout_test.go.html#6930198">err</a></span>&nbsp;<span class="op" id="6930228">!=</span>&nbsp;<span class="ident" id="6930231">nil</span>&nbsp;<span class="op" id="6930235">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930241"><a href="/net/timeout_test.go.html#6930146">errc</a></span>&nbsp;<span class="op" id="6930246">&lt;-</span>&nbsp;<span class="ident" id="6930249"><a href="/net/timeout_test.go.html#6930198">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930263">}</span><span class="op" id="6930264">(</span><span class="op" id="6930265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930268"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6930272">.</span><span class="ident" id="6930273">Sleep</span><span class="op" id="6930278">(</span><span class="num" id="6930279">100</span>&nbsp;<span class="op" id="6930283">*</span>&nbsp;<span class="ident" id="6930285"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6930289">.</span><span class="ident" id="6930290">Millisecond</span><span class="op" id="6930301">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930304">select</span>&nbsp;<span class="op" id="6930311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930314">case</span>&nbsp;<span class="ident" id="6930319">err</span>&nbsp;<span class="op" id="6930323">:=</span>&nbsp;<span class="op" id="6930326">&lt;-</span><span class="ident" id="6930328"><a href="/net/timeout_test.go.html#6930146">errc</a></span><span class="op" id="6930332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930336"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6930337">.</span><span class="ident" id="6930338">Fatalf</span><span class="op" id="6930344">(</span><span class="string" id="6930345">&#34;Expected&nbsp;Write()&nbsp;to&nbsp;not&nbsp;return,&nbsp;but&nbsp;it&nbsp;returned&nbsp;with&nbsp;%v\n&#34;</span><span class="op" id="6930404">,</span>&nbsp;<span class="ident" id="6930406"><a href="/net/timeout_test.go.html#6930319">err</a></span><span class="op" id="6930409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930412">default</span><span class="op" id="6930419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930422">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930425"><a href="/net/timeout_test.go.html#6929498">c</a></span><span class="op" id="6930426">.</span><span class="ident" id="6930427">Close</span><span class="op" id="6930432">(</span><span class="op" id="6930433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930436">switch</span>&nbsp;<span class="ident" id="6930443">nerr</span>&nbsp;<span class="op" id="6930448">:=</span>&nbsp;<span class="op" id="6930451">&lt;-</span><span class="ident" id="6930453"><a href="/net/timeout_test.go.html#6930146">errc</a></span><span class="op" id="6930457">;</span>&nbsp;<span class="ident" id="6930459">err</span>&nbsp;<span class="op" id="6930463">:=</span>&nbsp;<span class="ident" id="6930466"><a href="/net/timeout_test.go.html#6930443">nerr</a></span><span class="op" id="6930470">.</span><span class="op" id="6930471">(</span><span class="keyword" id="6930472">type</span><span class="op" id="6930476">)</span>&nbsp;<span class="op" id="6930478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930481">case</span>&nbsp;<span class="op" id="6930486">*</span><span class="ident" id="6930487"><a href="/net/net.go.html#2659621">OpError</a></span><span class="op" id="6930494">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930498">if</span>&nbsp;<span class="ident" id="6930501"><a href="/net/timeout_test.go.html#6930459">err</a></span><span class="op" id="6930504">.</span><span class="ident" id="6930505">Err</span>&nbsp;<span class="op" id="6930509">!=</span>&nbsp;<span class="ident" id="6930512"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6930523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930528"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6930529">.</span><span class="ident" id="6930530">Fatalf</span><span class="op" id="6930536">(</span><span class="string" id="6930537">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6930569">,</span>&nbsp;<span class="ident" id="6930571"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6930581">,</span>&nbsp;<span class="ident" id="6930583"><a href="/net/timeout_test.go.html#6930459">err</a></span><span class="op" id="6930586">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930593">default</span><span class="op" id="6930600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930604">if</span>&nbsp;<span class="ident" id="6930607"><a href="/net/timeout_test.go.html#6930459">err</a></span>&nbsp;<span class="op" id="6930611">!=</span>&nbsp;<span class="ident" id="6930614"><a href="/net/net.go.html#2659298">errClosing</a></span>&nbsp;<span class="op" id="6930625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930630"><a href="/net/timeout_test.go.html#6929347">t</a></span><span class="op" id="6930631">.</span><span class="ident" id="6930632">Fatalf</span><span class="op" id="6930638">(</span><span class="string" id="6930639">&#34;Write:&nbsp;expected&nbsp;err&nbsp;%v,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6930671">,</span>&nbsp;<span class="ident" id="6930673"><a href="/net/net.go.html#2659298">errClosing</a></span><span class="op" id="6930683">,</span>&nbsp;<span class="ident" id="6930685"><a href="/net/timeout_test.go.html#6930459">err</a></span><span class="op" id="6930688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930692">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930695">}</span><br>
<span class="lineno"></span><span class="op" id="6930697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6930700">func</span>&nbsp;<span class="ident" id="6930705">testTimeout</span><span class="op" id="6930716">(</span><span class="ident" id="6930717">t</span>&nbsp;<span class="op" id="6930719">*</span><span class="ident" id="6930720"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6930727">.</span><span class="ident" id="6930728">T</span><span class="op" id="6930729">,</span>&nbsp;<span class="ident" id="6930731">net</span><span class="op" id="6930734">,</span>&nbsp;<span class="ident" id="6930736">addr</span>&nbsp;<span class="builtintype" id="6930741">string</span><span class="op" id="6930747">,</span>&nbsp;<span class="ident" id="6930749">readFrom</span>&nbsp;<span class="builtintype" id="6930758">bool</span><span class="op" id="6930762">)</span>&nbsp;<span class="op" id="6930764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930767">c</span><span class="op" id="6930768">,</span>&nbsp;<span class="ident" id="6930770">err</span>&nbsp;<span class="op" id="6930774">:=</span>&nbsp;<span class="ident" id="6930777"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6930781">(</span><span class="ident" id="6930782"><a href="/net/timeout_test.go.html#6930731">net</a></span><span class="op" id="6930785">,</span>&nbsp;<span class="ident" id="6930787"><a href="/net/timeout_test.go.html#6930736">addr</a></span><span class="op" id="6930791">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930794">if</span>&nbsp;<span class="ident" id="6930797"><a href="/net/timeout_test.go.html#6930770">err</a></span>&nbsp;<span class="op" id="6930801">!=</span>&nbsp;<span class="ident" id="6930804">nil</span>&nbsp;<span class="op" id="6930808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930812"><a href="/net/timeout_test.go.html#6930717">t</a></span><span class="op" id="6930813">.</span><span class="ident" id="6930814">Errorf</span><span class="op" id="6930820">(</span><span class="string" id="6930821">&#34;Dial(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6930846">,</span>&nbsp;<span class="ident" id="6930848"><a href="/net/timeout_test.go.html#6930731">net</a></span><span class="op" id="6930851">,</span>&nbsp;<span class="ident" id="6930853"><a href="/net/timeout_test.go.html#6930736">addr</a></span><span class="op" id="6930857">,</span>&nbsp;<span class="ident" id="6930859"><a href="/net/timeout_test.go.html#6930770">err</a></span><span class="op" id="6930862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930866">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930877">defer</span>&nbsp;<span class="ident" id="6930883"><a href="/net/timeout_test.go.html#6930767">c</a></span><span class="op" id="6930884">.</span><span class="ident" id="6930885">Close</span><span class="op" id="6930890">(</span><span class="op" id="6930891">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930894">what</span>&nbsp;<span class="op" id="6930899">:=</span>&nbsp;<span class="string" id="6930902">&#34;Read&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930910">if</span>&nbsp;<span class="ident" id="6930913"><a href="/net/timeout_test.go.html#6930749">readFrom</a></span>&nbsp;<span class="op" id="6930922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930926"><a href="/net/timeout_test.go.html#6930894">what</a></span>&nbsp;<span class="op" id="6930931">=</span>&nbsp;<span class="string" id="6930933">&#34;ReadFrom&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930949">errc</span>&nbsp;<span class="op" id="6930954">:=</span>&nbsp;<span class="builtinfunc" id="6930957">make</span><span class="op" id="6930961">(</span><span class="keyword" id="6930962">chan</span>&nbsp;<span class="builtintype" id="6930967">error</span><span class="op" id="6930972">,</span>&nbsp;<span class="num" id="6930974">1</span><span class="op" id="6930975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930978">go</span>&nbsp;<span class="keyword" id="6930981">func</span><span class="op" id="6930985">(</span><span class="op" id="6930986">)</span>&nbsp;<span class="op" id="6930988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930992">t0</span>&nbsp;<span class="op" id="6930995">:=</span>&nbsp;<span class="ident" id="6930998"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931002">.</span><span class="ident" id="6931003">Now</span><span class="op" id="6931006">(</span><span class="op" id="6931007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931011"><a href="/net/timeout_test.go.html#6930767">c</a></span><span class="op" id="6931012">.</span><span class="ident" id="6931013">SetReadDeadline</span><span class="op" id="6931028">(</span><span class="ident" id="6931029"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931033">.</span><span class="ident" id="6931034">Now</span><span class="op" id="6931037">(</span><span class="op" id="6931038">)</span><span class="op" id="6931039">.</span><span class="ident" id="6931040">Add</span><span class="op" id="6931043">(</span><span class="num" id="6931044">100</span>&nbsp;<span class="op" id="6931048">*</span>&nbsp;<span class="ident" id="6931050"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931054">.</span><span class="ident" id="6931055">Millisecond</span><span class="op" id="6931066">)</span><span class="op" id="6931067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931071">var</span>&nbsp;<span class="ident" id="6931075">b</span>&nbsp;<span class="op" id="6931077">[</span><span class="num" id="6931078">100</span><span class="op" id="6931081">]</span><span class="builtintype" id="6931082">byte</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931089">var</span>&nbsp;<span class="ident" id="6931093">n</span>&nbsp;<span class="builtintype" id="6931095">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931101">var</span>&nbsp;<span class="ident" id="6931105">err</span>&nbsp;<span class="builtintype" id="6931109">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931117">if</span>&nbsp;<span class="ident" id="6931120"><a href="/net/timeout_test.go.html#6930749">readFrom</a></span>&nbsp;<span class="op" id="6931129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931134"><a href="/net/timeout_test.go.html#6931093">n</a></span><span class="op" id="6931135">,</span>&nbsp;<span class="ident" id="6931137">_</span><span class="op" id="6931138">,</span>&nbsp;<span class="ident" id="6931140"><a href="/net/timeout_test.go.html#6931105">err</a></span>&nbsp;<span class="op" id="6931144">=</span>&nbsp;<span class="ident" id="6931146"><a href="/net/timeout_test.go.html#6930767">c</a></span><span class="op" id="6931147">.</span><span class="op" id="6931148">(</span><span class="ident" id="6931149"><a href="/net/net.go.html#2656892">PacketConn</a></span><span class="op" id="6931159">)</span><span class="op" id="6931160">.</span><span class="ident" id="6931161">ReadFrom</span><span class="op" id="6931169">(</span><span class="ident" id="6931170"><a href="/net/timeout_test.go.html#6931075">b</a></span><span class="op" id="6931171">[</span><span class="num" id="6931172">0</span><span class="op" id="6931173">:</span><span class="op" id="6931174">]</span><span class="op" id="6931175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931179">}</span>&nbsp;<span class="keyword" id="6931181">else</span>&nbsp;<span class="op" id="6931186">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931191"><a href="/net/timeout_test.go.html#6931093">n</a></span><span class="op" id="6931192">,</span>&nbsp;<span class="ident" id="6931194"><a href="/net/timeout_test.go.html#6931105">err</a></span>&nbsp;<span class="op" id="6931198">=</span>&nbsp;<span class="ident" id="6931200"><a href="/net/timeout_test.go.html#6930767">c</a></span><span class="op" id="6931201">.</span><span class="ident" id="6931202">Read</span><span class="op" id="6931206">(</span><span class="ident" id="6931207"><a href="/net/timeout_test.go.html#6931075">b</a></span><span class="op" id="6931208">[</span><span class="num" id="6931209">0</span><span class="op" id="6931210">:</span><span class="op" id="6931211">]</span><span class="op" id="6931212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931220">t1</span>&nbsp;<span class="op" id="6931223">:=</span>&nbsp;<span class="ident" id="6931226"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931230">.</span><span class="ident" id="6931231">Now</span><span class="op" id="6931234">(</span><span class="op" id="6931235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931239">if</span>&nbsp;<span class="ident" id="6931242"><a href="/net/timeout_test.go.html#6931093">n</a></span>&nbsp;<span class="op" id="6931244">!=</span>&nbsp;<span class="num" id="6931247">0</span>&nbsp;<span class="op" id="6931249">||</span>&nbsp;<span class="ident" id="6931252"><a href="/net/timeout_test.go.html#6931105">err</a></span>&nbsp;<span class="op" id="6931256">==</span>&nbsp;<span class="ident" id="6931259">nil</span>&nbsp;<span class="op" id="6931263">||</span>&nbsp;<span class="op" id="6931266">!</span><span class="ident" id="6931267"><a href="/net/timeout_test.go.html#6931105">err</a></span><span class="op" id="6931270">.</span><span class="op" id="6931271">(</span><span class="ident" id="6931272"><a href="/net/net.go.html#2656629">Error</a></span><span class="op" id="6931277">)</span><span class="op" id="6931278">.</span><span class="ident" id="6931279">Timeout</span><span class="op" id="6931286">(</span><span class="op" id="6931287">)</span>&nbsp;<span class="op" id="6931289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931294"><a href="/net/timeout_test.go.html#6930949">errc</a></span>&nbsp;<span class="op" id="6931299">&lt;-</span>&nbsp;<span class="ident" id="6931302"><a href="/net/timeout_test.go.html#6926238">fmt</a></span><span class="op" id="6931305">.</span><span class="ident" id="6931306">Errorf</span><span class="op" id="6931312">(</span><span class="string" id="6931313">&#34;%s(%q,&nbsp;%q)&nbsp;did&nbsp;not&nbsp;return&nbsp;0,&nbsp;timeout:&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6931359">,</span>&nbsp;<span class="ident" id="6931361"><a href="/net/timeout_test.go.html#6930894">what</a></span><span class="op" id="6931365">,</span>&nbsp;<span class="ident" id="6931367"><a href="/net/timeout_test.go.html#6930731">net</a></span><span class="op" id="6931370">,</span>&nbsp;<span class="ident" id="6931372"><a href="/net/timeout_test.go.html#6930736">addr</a></span><span class="op" id="6931376">,</span>&nbsp;<span class="ident" id="6931378"><a href="/net/timeout_test.go.html#6931093">n</a></span><span class="op" id="6931379">,</span>&nbsp;<span class="ident" id="6931381"><a href="/net/timeout_test.go.html#6931105">err</a></span><span class="op" id="6931384">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931389">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931402">if</span>&nbsp;<span class="ident" id="6931405">dt</span>&nbsp;<span class="op" id="6931408">:=</span>&nbsp;<span class="ident" id="6931411"><a href="/net/timeout_test.go.html#6931220">t1</a></span><span class="op" id="6931413">.</span><span class="ident" id="6931414">Sub</span><span class="op" id="6931417">(</span><span class="ident" id="6931418"><a href="/net/timeout_test.go.html#6930992">t0</a></span><span class="op" id="6931420">)</span><span class="op" id="6931421">;</span>&nbsp;<span class="ident" id="6931423"><a href="/net/timeout_test.go.html#6931405">dt</a></span>&nbsp;<span class="op" id="6931426">&lt;</span>&nbsp;<span class="num" id="6931428">50</span><span class="op" id="6931430">*</span><span class="ident" id="6931431"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931435">.</span><span class="ident" id="6931436">Millisecond</span>&nbsp;<span class="op" id="6931448">||</span>&nbsp;<span class="op" id="6931451">!</span><span class="ident" id="6931452"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6931459">.</span><span class="ident" id="6931460">Short</span><span class="op" id="6931465">(</span><span class="op" id="6931466">)</span>&nbsp;<span class="op" id="6931468">&amp;&amp;</span>&nbsp;<span class="ident" id="6931471"><a href="/net/timeout_test.go.html#6931405">dt</a></span>&nbsp;<span class="op" id="6931474">&gt;</span>&nbsp;<span class="num" id="6931476">250</span><span class="op" id="6931479">*</span><span class="ident" id="6931480"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931484">.</span><span class="ident" id="6931485">Millisecond</span>&nbsp;<span class="op" id="6931497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931502"><a href="/net/timeout_test.go.html#6930949">errc</a></span>&nbsp;<span class="op" id="6931507">&lt;-</span>&nbsp;<span class="ident" id="6931510"><a href="/net/timeout_test.go.html#6926238">fmt</a></span><span class="op" id="6931513">.</span><span class="ident" id="6931514">Errorf</span><span class="op" id="6931520">(</span><span class="string" id="6931521">&#34;%s(%q,&nbsp;%q)&nbsp;took&nbsp;%s,&nbsp;expected&nbsp;0.1s&#34;</span><span class="op" id="6931556">,</span>&nbsp;<span class="ident" id="6931558"><a href="/net/timeout_test.go.html#6930894">what</a></span><span class="op" id="6931562">,</span>&nbsp;<span class="ident" id="6931564"><a href="/net/timeout_test.go.html#6930731">net</a></span><span class="op" id="6931567">,</span>&nbsp;<span class="ident" id="6931569"><a href="/net/timeout_test.go.html#6930736">addr</a></span><span class="op" id="6931573">,</span>&nbsp;<span class="ident" id="6931575"><a href="/net/timeout_test.go.html#6931405">dt</a></span><span class="op" id="6931577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931582">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931595"><a href="/net/timeout_test.go.html#6930949">errc</a></span>&nbsp;<span class="op" id="6931600">&lt;-</span>&nbsp;<span class="ident" id="6931603">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931608">}</span><span class="op" id="6931609">(</span><span class="op" id="6931610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931613">select</span>&nbsp;<span class="op" id="6931620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931623">case</span>&nbsp;<span class="ident" id="6931628">err</span>&nbsp;<span class="op" id="6931632">:=</span>&nbsp;<span class="op" id="6931635">&lt;-</span><span class="ident" id="6931637"><a href="/net/timeout_test.go.html#6930949">errc</a></span><span class="op" id="6931641">:</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931645">if</span>&nbsp;<span class="ident" id="6931648"><a href="/net/timeout_test.go.html#6931628">err</a></span>&nbsp;<span class="op" id="6931652">!=</span>&nbsp;<span class="ident" id="6931655">nil</span>&nbsp;<span class="op" id="6931659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931664"><a href="/net/timeout_test.go.html#6930717">t</a></span><span class="op" id="6931665">.</span><span class="ident" id="6931666">Error</span><span class="op" id="6931671">(</span><span class="ident" id="6931672"><a href="/net/timeout_test.go.html#6931628">err</a></span><span class="op" id="6931675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931682">case</span>&nbsp;<span class="op" id="6931687">&lt;-</span><span class="ident" id="6931689"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931693">.</span><span class="ident" id="6931694">After</span><span class="op" id="6931699">(</span><span class="num" id="6931700">1</span>&nbsp;<span class="op" id="6931702">*</span>&nbsp;<span class="ident" id="6931704"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6931708">.</span><span class="ident" id="6931709">Second</span><span class="op" id="6931715">)</span><span class="op" id="6931716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931720"><a href="/net/timeout_test.go.html#6930717">t</a></span><span class="op" id="6931721">.</span><span class="ident" id="6931722">Errorf</span><span class="op" id="6931728">(</span><span class="string" id="6931729">&#34;%s(%q,&nbsp;%q)&nbsp;took&nbsp;over&nbsp;1&nbsp;second,&nbsp;expected&nbsp;0.1s&#34;</span><span class="op" id="6931775">,</span>&nbsp;<span class="ident" id="6931777"><a href="/net/timeout_test.go.html#6930894">what</a></span><span class="op" id="6931781">,</span>&nbsp;<span class="ident" id="6931783"><a href="/net/timeout_test.go.html#6930731">net</a></span><span class="op" id="6931786">,</span>&nbsp;<span class="ident" id="6931788"><a href="/net/timeout_test.go.html#6930736">addr</a></span><span class="op" id="6931792">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931795">}</span><br>
<span class="lineno"></span><span class="op" id="6931797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6931800">func</span>&nbsp;<span class="ident" id="6931805">TestTimeoutUDP</span><span class="op" id="6931819">(</span><span class="ident" id="6931820">t</span>&nbsp;<span class="op" id="6931822">*</span><span class="ident" id="6931823"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6931830">.</span><span class="ident" id="6931831">T</span><span class="op" id="6931832">)</span>&nbsp;<span class="op" id="6931834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931837">switch</span>&nbsp;<span class="ident" id="6931844"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6931851">.</span><span class="ident" id="6931852">GOOS</span>&nbsp;<span class="op" id="6931857">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931860">case</span>&nbsp;<span class="string" id="6931865">&#34;plan9&#34;</span><span class="op" id="6931872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931876"><a href="/net/timeout_test.go.html#6931820">t</a></span><span class="op" id="6931877">.</span><span class="ident" id="6931878">Skipf</span><span class="op" id="6931883">(</span><span class="string" id="6931884">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6931905">,</span>&nbsp;<span class="ident" id="6931907"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6931914">.</span><span class="ident" id="6931915">GOOS</span><span class="op" id="6931919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6931926">//&nbsp;set&nbsp;up&nbsp;a&nbsp;listener&nbsp;that&nbsp;won&#39;t&nbsp;talk&nbsp;back</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931969">listening</span>&nbsp;<span class="op" id="6931979">:=</span>&nbsp;<span class="builtinfunc" id="6931982">make</span><span class="op" id="6931986">(</span><span class="keyword" id="6931987">chan</span>&nbsp;<span class="builtintype" id="6931992">string</span><span class="op" id="6931998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932001">done</span>&nbsp;<span class="op" id="6932006">:=</span>&nbsp;<span class="builtinfunc" id="6932009">make</span><span class="op" id="6932013">(</span><span class="keyword" id="6932014">chan</span>&nbsp;<span class="builtintype" id="6932019">int</span><span class="op" id="6932022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932025">go</span>&nbsp;<span class="ident" id="6932028"><a href="/net/server_test.go.html#6909302">runDatagramPacketConnServer</a></span><span class="op" id="6932055">(</span><span class="ident" id="6932056"><a href="/net/timeout_test.go.html#6931820">t</a></span><span class="op" id="6932057">,</span>&nbsp;<span class="string" id="6932059">&#34;udp&#34;</span><span class="op" id="6932064">,</span>&nbsp;<span class="string" id="6932066">&#34;127.0.0.1:0&#34;</span><span class="op" id="6932079">,</span>&nbsp;<span class="ident" id="6932081"><a href="/net/timeout_test.go.html#6931969">listening</a></span><span class="op" id="6932090">,</span>&nbsp;<span class="ident" id="6932092"><a href="/net/timeout_test.go.html#6932001">done</a></span><span class="op" id="6932096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932099">addr</span>&nbsp;<span class="op" id="6932104">:=</span>&nbsp;<span class="op" id="6932107">&lt;-</span><span class="ident" id="6932109"><a href="/net/timeout_test.go.html#6931969">listening</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932121"><a href="/net/timeout_test.go.html#6930705">testTimeout</a></span><span class="op" id="6932132">(</span><span class="ident" id="6932133"><a href="/net/timeout_test.go.html#6931820">t</a></span><span class="op" id="6932134">,</span>&nbsp;<span class="string" id="6932136">&#34;udp&#34;</span><span class="op" id="6932141">,</span>&nbsp;<span class="ident" id="6932143"><a href="/net/timeout_test.go.html#6932099">addr</a></span><span class="op" id="6932147">,</span>&nbsp;<span class="ident" id="6932149">false</span><span class="op" id="6932154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932157"><a href="/net/timeout_test.go.html#6930705">testTimeout</a></span><span class="op" id="6932168">(</span><span class="ident" id="6932169"><a href="/net/timeout_test.go.html#6931820">t</a></span><span class="op" id="6932170">,</span>&nbsp;<span class="string" id="6932172">&#34;udp&#34;</span><span class="op" id="6932177">,</span>&nbsp;<span class="ident" id="6932179"><a href="/net/timeout_test.go.html#6932099">addr</a></span><span class="op" id="6932183">,</span>&nbsp;<span class="ident" id="6932185">true</span><span class="op" id="6932189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932192">&lt;-</span><span class="ident" id="6932194"><a href="/net/timeout_test.go.html#6932001">done</a></span><br>
<span class="lineno"></span><span class="op" id="6932199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="6932202">func</span>&nbsp;<span class="ident" id="6932207">TestTimeoutTCP</span><span class="op" id="6932221">(</span><span class="ident" id="6932222">t</span>&nbsp;<span class="op" id="6932224">*</span><span class="ident" id="6932225"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6932232">.</span><span class="ident" id="6932233">T</span><span class="op" id="6932234">)</span>&nbsp;<span class="op" id="6932236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932239">switch</span>&nbsp;<span class="ident" id="6932246"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6932253">.</span><span class="ident" id="6932254">GOOS</span>&nbsp;<span class="op" id="6932259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932262">case</span>&nbsp;<span class="string" id="6932267">&#34;plan9&#34;</span><span class="op" id="6932274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932278"><a href="/net/timeout_test.go.html#6932222">t</a></span><span class="op" id="6932279">.</span><span class="ident" id="6932280">Skipf</span><span class="op" id="6932285">(</span><span class="string" id="6932286">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6932307">,</span>&nbsp;<span class="ident" id="6932309"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6932316">.</span><span class="ident" id="6932317">GOOS</span><span class="op" id="6932321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932324">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6932328">//&nbsp;set&nbsp;up&nbsp;a&nbsp;listener&nbsp;that&nbsp;won&#39;t&nbsp;talk&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932371">listening</span>&nbsp;<span class="op" id="6932381">:=</span>&nbsp;<span class="builtinfunc" id="6932384">make</span><span class="op" id="6932388">(</span><span class="keyword" id="6932389">chan</span>&nbsp;<span class="builtintype" id="6932394">string</span><span class="op" id="6932400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932403">done</span>&nbsp;<span class="op" id="6932408">:=</span>&nbsp;<span class="builtinfunc" id="6932411">make</span><span class="op" id="6932415">(</span><span class="keyword" id="6932416">chan</span>&nbsp;<span class="builtintype" id="6932421">int</span><span class="op" id="6932424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932427">go</span>&nbsp;<span class="ident" id="6932430"><a href="/net/server_test.go.html#6903014">runStreamConnServer</a></span><span class="op" id="6932449">(</span><span class="ident" id="6932450"><a href="/net/timeout_test.go.html#6932222">t</a></span><span class="op" id="6932451">,</span>&nbsp;<span class="string" id="6932453">&#34;tcp&#34;</span><span class="op" id="6932458">,</span>&nbsp;<span class="string" id="6932460">&#34;127.0.0.1:0&#34;</span><span class="op" id="6932473">,</span>&nbsp;<span class="ident" id="6932475"><a href="/net/timeout_test.go.html#6932371">listening</a></span><span class="op" id="6932484">,</span>&nbsp;<span class="ident" id="6932486"><a href="/net/timeout_test.go.html#6932403">done</a></span><span class="op" id="6932490">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932493">addr</span>&nbsp;<span class="op" id="6932498">:=</span>&nbsp;<span class="op" id="6932501">&lt;-</span><span class="ident" id="6932503"><a href="/net/timeout_test.go.html#6932371">listening</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932515"><a href="/net/timeout_test.go.html#6930705">testTimeout</a></span><span class="op" id="6932526">(</span><span class="ident" id="6932527"><a href="/net/timeout_test.go.html#6932222">t</a></span><span class="op" id="6932528">,</span>&nbsp;<span class="string" id="6932530">&#34;tcp&#34;</span><span class="op" id="6932535">,</span>&nbsp;<span class="ident" id="6932537"><a href="/net/timeout_test.go.html#6932493">addr</a></span><span class="op" id="6932541">,</span>&nbsp;<span class="ident" id="6932543">false</span><span class="op" id="6932548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932551">&lt;-</span><span class="ident" id="6932553"><a href="/net/timeout_test.go.html#6932403">done</a></span><br>
<span class="lineno"></span><span class="op" id="6932558">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="6932561">func</span>&nbsp;<span class="ident" id="6932566">TestDeadlineReset</span><span class="op" id="6932583">(</span><span class="ident" id="6932584">t</span>&nbsp;<span class="op" id="6932586">*</span><span class="ident" id="6932587"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6932594">.</span><span class="ident" id="6932595">T</span><span class="op" id="6932596">)</span>&nbsp;<span class="op" id="6932598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932601">switch</span>&nbsp;<span class="ident" id="6932608"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6932615">.</span><span class="ident" id="6932616">GOOS</span>&nbsp;<span class="op" id="6932621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932624">case</span>&nbsp;<span class="string" id="6932629">&#34;plan9&#34;</span><span class="op" id="6932636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932640"><a href="/net/timeout_test.go.html#6932584">t</a></span><span class="op" id="6932641">.</span><span class="ident" id="6932642">Skipf</span><span class="op" id="6932647">(</span><span class="string" id="6932648">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6932669">,</span>&nbsp;<span class="ident" id="6932671"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6932678">.</span><span class="ident" id="6932679">GOOS</span><span class="op" id="6932683">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932689">ln</span><span class="op" id="6932691">,</span>&nbsp;<span class="ident" id="6932693">err</span>&nbsp;<span class="op" id="6932697">:=</span>&nbsp;<span class="ident" id="6932700"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6932706">(</span><span class="string" id="6932707">&#34;tcp&#34;</span><span class="op" id="6932712">,</span>&nbsp;<span class="string" id="6932714">&#34;127.0.0.1:0&#34;</span><span class="op" id="6932727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932730">if</span>&nbsp;<span class="ident" id="6932733"><a href="/net/timeout_test.go.html#6932693">err</a></span>&nbsp;<span class="op" id="6932737">!=</span>&nbsp;<span class="ident" id="6932740">nil</span>&nbsp;<span class="op" id="6932744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932748"><a href="/net/timeout_test.go.html#6932584">t</a></span><span class="op" id="6932749">.</span><span class="ident" id="6932750">Fatal</span><span class="op" id="6932755">(</span><span class="ident" id="6932756"><a href="/net/timeout_test.go.html#6932693">err</a></span><span class="op" id="6932759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932762">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932765">defer</span>&nbsp;<span class="ident" id="6932771"><a href="/net/timeout_test.go.html#6932689">ln</a></span><span class="op" id="6932773">.</span><span class="ident" id="6932774">Close</span><span class="op" id="6932779">(</span><span class="op" id="6932780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932783">tl</span>&nbsp;<span class="op" id="6932786">:=</span>&nbsp;<span class="ident" id="6932789"><a href="/net/timeout_test.go.html#6932689">ln</a></span><span class="op" id="6932791">.</span><span class="op" id="6932792">(</span><span class="op" id="6932793">*</span><span class="ident" id="6932794"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6932805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932808"><a href="/net/timeout_test.go.html#6932783">tl</a></span><span class="op" id="6932810">.</span><span class="ident" id="6932811">SetDeadline</span><span class="op" id="6932822">(</span><span class="ident" id="6932823"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6932827">.</span><span class="ident" id="6932828">Now</span><span class="op" id="6932831">(</span><span class="op" id="6932832">)</span><span class="op" id="6932833">.</span><span class="ident" id="6932834">Add</span><span class="op" id="6932837">(</span><span class="num" id="6932838">1</span>&nbsp;<span class="op" id="6932840">*</span>&nbsp;<span class="ident" id="6932842"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6932846">.</span><span class="ident" id="6932847">Minute</span><span class="op" id="6932853">)</span><span class="op" id="6932854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932857"><a href="/net/timeout_test.go.html#6932783">tl</a></span><span class="op" id="6932859">.</span><span class="ident" id="6932860">SetDeadline</span><span class="op" id="6932871">(</span><span class="ident" id="6932872"><a href="/net/net.go.html#2660335">noDeadline</a></span><span class="op" id="6932882">)</span>&nbsp;<span class="comment" id="6932884">//&nbsp;reset&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932897">errc</span>&nbsp;<span class="op" id="6932902">:=</span>&nbsp;<span class="builtinfunc" id="6932905">make</span><span class="op" id="6932909">(</span><span class="keyword" id="6932910">chan</span>&nbsp;<span class="builtintype" id="6932915">error</span><span class="op" id="6932920">,</span>&nbsp;<span class="num" id="6932922">1</span><span class="op" id="6932923">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932926">go</span>&nbsp;<span class="keyword" id="6932929">func</span><span class="op" id="6932933">(</span><span class="op" id="6932934">)</span>&nbsp;<span class="op" id="6932936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932940">_</span><span class="op" id="6932941">,</span>&nbsp;<span class="ident" id="6932943">err</span>&nbsp;<span class="op" id="6932947">:=</span>&nbsp;<span class="ident" id="6932950"><a href="/net/timeout_test.go.html#6932689">ln</a></span><span class="op" id="6932952">.</span><span class="ident" id="6932953">Accept</span><span class="op" id="6932959">(</span><span class="op" id="6932960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932964"><a href="/net/timeout_test.go.html#6932897">errc</a></span>&nbsp;<span class="op" id="6932969">&lt;-</span>&nbsp;<span class="ident" id="6932972"><a href="/net/timeout_test.go.html#6932943">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932977">}</span><span class="op" id="6932978">(</span><span class="op" id="6932979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932982">select</span>&nbsp;<span class="op" id="6932989">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932992">case</span>&nbsp;<span class="op" id="6932997">&lt;-</span><span class="ident" id="6932999"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933003">.</span><span class="ident" id="6933004">After</span><span class="op" id="6933009">(</span><span class="num" id="6933010">50</span>&nbsp;<span class="op" id="6933013">*</span>&nbsp;<span class="ident" id="6933015"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933019">.</span><span class="ident" id="6933020">Millisecond</span><span class="op" id="6933031">)</span><span class="op" id="6933032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6933036">//&nbsp;Pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933046">case</span>&nbsp;<span class="ident" id="6933051">err</span>&nbsp;<span class="op" id="6933055">:=</span>&nbsp;<span class="op" id="6933058">&lt;-</span><span class="ident" id="6933060"><a href="/net/timeout_test.go.html#6932897">errc</a></span><span class="op" id="6933064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6933068">//&nbsp;Accept&nbsp;should&nbsp;never&nbsp;return;&nbsp;we&nbsp;never</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6933110">//&nbsp;connected&nbsp;to&nbsp;it.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933132"><a href="/net/timeout_test.go.html#6932584">t</a></span><span class="op" id="6933133">.</span><span class="ident" id="6933134">Errorf</span><span class="op" id="6933140">(</span><span class="string" id="6933141">&#34;unexpected&nbsp;return&nbsp;from&nbsp;Accept;&nbsp;err=%v&#34;</span><span class="op" id="6933180">,</span>&nbsp;<span class="ident" id="6933182"><a href="/net/timeout_test.go.html#6933051">err</a></span><span class="op" id="6933185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933188">}</span><br>
<span class="lineno"></span><span class="op" id="6933190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6933193">func</span>&nbsp;<span class="ident" id="6933198">TestTimeoutAccept</span><span class="op" id="6933215">(</span><span class="ident" id="6933216">t</span>&nbsp;<span class="op" id="6933218">*</span><span class="ident" id="6933219"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6933226">.</span><span class="ident" id="6933227">T</span><span class="op" id="6933228">)</span>&nbsp;<span class="op" id="6933230">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933233">switch</span>&nbsp;<span class="ident" id="6933240"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6933247">.</span><span class="ident" id="6933248">GOOS</span>&nbsp;<span class="op" id="6933253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933256">case</span>&nbsp;<span class="string" id="6933261">&#34;plan9&#34;</span><span class="op" id="6933268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933272"><a href="/net/timeout_test.go.html#6933216">t</a></span><span class="op" id="6933273">.</span><span class="ident" id="6933274">Skipf</span><span class="op" id="6933279">(</span><span class="string" id="6933280">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6933301">,</span>&nbsp;<span class="ident" id="6933303"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6933310">.</span><span class="ident" id="6933311">GOOS</span><span class="op" id="6933315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933321">ln</span><span class="op" id="6933323">,</span>&nbsp;<span class="ident" id="6933325">err</span>&nbsp;<span class="op" id="6933329">:=</span>&nbsp;<span class="ident" id="6933332"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6933338">(</span><span class="string" id="6933339">&#34;tcp&#34;</span><span class="op" id="6933344">,</span>&nbsp;<span class="string" id="6933346">&#34;127.0.0.1:0&#34;</span><span class="op" id="6933359">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933362">if</span>&nbsp;<span class="ident" id="6933365"><a href="/net/timeout_test.go.html#6933325">err</a></span>&nbsp;<span class="op" id="6933369">!=</span>&nbsp;<span class="ident" id="6933372">nil</span>&nbsp;<span class="op" id="6933376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933380"><a href="/net/timeout_test.go.html#6933216">t</a></span><span class="op" id="6933381">.</span><span class="ident" id="6933382">Fatal</span><span class="op" id="6933387">(</span><span class="ident" id="6933388"><a href="/net/timeout_test.go.html#6933325">err</a></span><span class="op" id="6933391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933397">defer</span>&nbsp;<span class="ident" id="6933403"><a href="/net/timeout_test.go.html#6933321">ln</a></span><span class="op" id="6933405">.</span><span class="ident" id="6933406">Close</span><span class="op" id="6933411">(</span><span class="op" id="6933412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933415">tl</span>&nbsp;<span class="op" id="6933418">:=</span>&nbsp;<span class="ident" id="6933421"><a href="/net/timeout_test.go.html#6933321">ln</a></span><span class="op" id="6933423">.</span><span class="op" id="6933424">(</span><span class="op" id="6933425">*</span><span class="ident" id="6933426"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6933437">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933440"><a href="/net/timeout_test.go.html#6933415">tl</a></span><span class="op" id="6933442">.</span><span class="ident" id="6933443">SetDeadline</span><span class="op" id="6933454">(</span><span class="ident" id="6933455"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933459">.</span><span class="ident" id="6933460">Now</span><span class="op" id="6933463">(</span><span class="op" id="6933464">)</span><span class="op" id="6933465">.</span><span class="ident" id="6933466">Add</span><span class="op" id="6933469">(</span><span class="num" id="6933470">100</span>&nbsp;<span class="op" id="6933474">*</span>&nbsp;<span class="ident" id="6933476"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933480">.</span><span class="ident" id="6933481">Millisecond</span><span class="op" id="6933492">)</span><span class="op" id="6933493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933496">errc</span>&nbsp;<span class="op" id="6933501">:=</span>&nbsp;<span class="builtinfunc" id="6933504">make</span><span class="op" id="6933508">(</span><span class="keyword" id="6933509">chan</span>&nbsp;<span class="builtintype" id="6933514">error</span><span class="op" id="6933519">,</span>&nbsp;<span class="num" id="6933521">1</span><span class="op" id="6933522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933525">go</span>&nbsp;<span class="keyword" id="6933528">func</span><span class="op" id="6933532">(</span><span class="op" id="6933533">)</span>&nbsp;<span class="op" id="6933535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933539">_</span><span class="op" id="6933540">,</span>&nbsp;<span class="ident" id="6933542">err</span>&nbsp;<span class="op" id="6933546">:=</span>&nbsp;<span class="ident" id="6933549"><a href="/net/timeout_test.go.html#6933321">ln</a></span><span class="op" id="6933551">.</span><span class="ident" id="6933552">Accept</span><span class="op" id="6933558">(</span><span class="op" id="6933559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933563"><a href="/net/timeout_test.go.html#6933496">errc</a></span>&nbsp;<span class="op" id="6933568">&lt;-</span>&nbsp;<span class="ident" id="6933571"><a href="/net/timeout_test.go.html#6933542">err</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933576">}</span><span class="op" id="6933577">(</span><span class="op" id="6933578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933581">select</span>&nbsp;<span class="op" id="6933588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933591">case</span>&nbsp;<span class="op" id="6933596">&lt;-</span><span class="ident" id="6933598"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933602">.</span><span class="ident" id="6933603">After</span><span class="op" id="6933608">(</span><span class="num" id="6933609">1</span>&nbsp;<span class="op" id="6933611">*</span>&nbsp;<span class="ident" id="6933613"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933617">.</span><span class="ident" id="6933618">Second</span><span class="op" id="6933624">)</span><span class="op" id="6933625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6933629">//&nbsp;Accept&nbsp;shouldn&#39;t&nbsp;block&nbsp;indefinitely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933670"><a href="/net/timeout_test.go.html#6933216">t</a></span><span class="op" id="6933671">.</span><span class="ident" id="6933672">Errorf</span><span class="op" id="6933678">(</span><span class="string" id="6933679">&#34;Accept&nbsp;didn&#39;t&nbsp;return&nbsp;in&nbsp;an&nbsp;expected&nbsp;time&#34;</span><span class="op" id="6933721">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933724">case</span>&nbsp;<span class="op" id="6933729">&lt;-</span><span class="ident" id="6933731"><a href="/net/timeout_test.go.html#6933496">errc</a></span><span class="op" id="6933735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6933739">//&nbsp;Pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933749">}</span><br>
<span class="lineno"></span><span class="op" id="6933751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="6933754">func</span>&nbsp;<span class="ident" id="6933759">TestReadWriteDeadline</span><span class="op" id="6933780">(</span><span class="ident" id="6933781">t</span>&nbsp;<span class="op" id="6933783">*</span><span class="ident" id="6933784"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6933791">.</span><span class="ident" id="6933792">T</span><span class="op" id="6933793">)</span>&nbsp;<span class="op" id="6933795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933798">switch</span>&nbsp;<span class="ident" id="6933805"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6933812">.</span><span class="ident" id="6933813">GOOS</span>&nbsp;<span class="op" id="6933818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933821">case</span>&nbsp;<span class="string" id="6933826">&#34;plan9&#34;</span><span class="op" id="6933833">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933837"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6933838">.</span><span class="ident" id="6933839">Skipf</span><span class="op" id="6933844">(</span><span class="string" id="6933845">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6933866">,</span>&nbsp;<span class="ident" id="6933868"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6933875">.</span><span class="ident" id="6933876">GOOS</span><span class="op" id="6933880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933883">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6933887">const</span>&nbsp;<span class="op" id="6933893">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933897">readTimeout</span>&nbsp;&nbsp;<span class="op" id="6933910">=</span>&nbsp;<span class="num" id="6933912">50</span>&nbsp;<span class="op" id="6933915">*</span>&nbsp;<span class="ident" id="6933917"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933921">.</span><span class="ident" id="6933922">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933936">writeTimeout</span>&nbsp;<span class="op" id="6933949">=</span>&nbsp;<span class="num" id="6933951">250</span>&nbsp;<span class="op" id="6933955">*</span>&nbsp;<span class="ident" id="6933957"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6933961">.</span><span class="ident" id="6933962">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6933975">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6933978">checkTimeout</span>&nbsp;<span class="op" id="6933991">:=</span>&nbsp;<span class="keyword" id="6933994">func</span><span class="op" id="6933998">(</span><span class="ident" id="6933999">command</span>&nbsp;<span class="builtintype" id="6934007">string</span><span class="op" id="6934013">,</span>&nbsp;<span class="ident" id="6934015">start</span>&nbsp;<span class="ident" id="6934021"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934025">.</span><span class="ident" id="6934026">Time</span><span class="op" id="6934030">,</span>&nbsp;<span class="ident" id="6934032">should</span>&nbsp;<span class="ident" id="6934039"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934043">.</span><span class="ident" id="6934044">Duration</span><span class="op" id="6934052">)</span>&nbsp;<span class="op" id="6934054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934058">is</span>&nbsp;<span class="op" id="6934061">:=</span>&nbsp;<span class="ident" id="6934064"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934068">.</span><span class="ident" id="6934069">Now</span><span class="op" id="6934072">(</span><span class="op" id="6934073">)</span><span class="op" id="6934074">.</span><span class="ident" id="6934075">Sub</span><span class="op" id="6934078">(</span><span class="ident" id="6934079"><a href="/net/timeout_test.go.html#6934015">start</a></span><span class="op" id="6934084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934088">d</span>&nbsp;<span class="op" id="6934090">:=</span>&nbsp;<span class="ident" id="6934093"><a href="/net/timeout_test.go.html#6934058">is</a></span>&nbsp;<span class="op" id="6934096">-</span>&nbsp;<span class="ident" id="6934098"><a href="/net/timeout_test.go.html#6934032">should</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934107">if</span>&nbsp;<span class="ident" id="6934110"><a href="/net/timeout_test.go.html#6934088">d</a></span>&nbsp;<span class="op" id="6934112">&lt;</span>&nbsp;<span class="op" id="6934114">-</span><span class="num" id="6934115">30</span><span class="op" id="6934117">*</span><span class="ident" id="6934118"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934122">.</span><span class="ident" id="6934123">Millisecond</span>&nbsp;<span class="op" id="6934135">||</span>&nbsp;<span class="op" id="6934138">!</span><span class="ident" id="6934139"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6934146">.</span><span class="ident" id="6934147">Short</span><span class="op" id="6934152">(</span><span class="op" id="6934153">)</span>&nbsp;<span class="op" id="6934155">&amp;&amp;</span>&nbsp;<span class="num" id="6934158">150</span><span class="op" id="6934161">*</span><span class="ident" id="6934162"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934166">.</span><span class="ident" id="6934167">Millisecond</span>&nbsp;<span class="op" id="6934179">&lt;</span>&nbsp;<span class="ident" id="6934181"><a href="/net/timeout_test.go.html#6934088">d</a></span>&nbsp;<span class="op" id="6934183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934188"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934189">.</span><span class="ident" id="6934190">Errorf</span><span class="op" id="6934196">(</span><span class="string" id="6934197">&#34;%s&nbsp;timeout&nbsp;test&nbsp;failed:&nbsp;is=%v&nbsp;should=%v\n&#34;</span><span class="op" id="6934240">,</span>&nbsp;<span class="ident" id="6934242"><a href="/net/timeout_test.go.html#6933999">command</a></span><span class="op" id="6934249">,</span>&nbsp;<span class="ident" id="6934251"><a href="/net/timeout_test.go.html#6934058">is</a></span><span class="op" id="6934253">,</span>&nbsp;<span class="ident" id="6934255"><a href="/net/timeout_test.go.html#6934032">should</a></span><span class="op" id="6934261">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934272">ln</span><span class="op" id="6934274">,</span>&nbsp;<span class="ident" id="6934276">err</span>&nbsp;<span class="op" id="6934280">:=</span>&nbsp;<span class="ident" id="6934283"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6934289">(</span><span class="string" id="6934290">&#34;tcp&#34;</span><span class="op" id="6934295">,</span>&nbsp;<span class="string" id="6934297">&#34;127.0.0.1:0&#34;</span><span class="op" id="6934310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934313">if</span>&nbsp;<span class="ident" id="6934316"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934320">!=</span>&nbsp;<span class="ident" id="6934323">nil</span>&nbsp;<span class="op" id="6934327">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934331"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934332">.</span><span class="ident" id="6934333">Fatalf</span><span class="op" id="6934339">(</span><span class="string" id="6934340">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6934361">,</span>&nbsp;<span class="ident" id="6934363"><a href="/net/timeout_test.go.html#6934276">err</a></span><span class="op" id="6934366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934372">defer</span>&nbsp;<span class="ident" id="6934378"><a href="/net/timeout_test.go.html#6934272">ln</a></span><span class="op" id="6934380">.</span><span class="ident" id="6934381">Close</span><span class="op" id="6934386">(</span><span class="op" id="6934387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934391">lnquit</span>&nbsp;<span class="op" id="6934398">:=</span>&nbsp;<span class="builtinfunc" id="6934401">make</span><span class="op" id="6934405">(</span><span class="keyword" id="6934406">chan</span>&nbsp;<span class="builtintype" id="6934411">bool</span><span class="op" id="6934415">)</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934419">go</span>&nbsp;<span class="keyword" id="6934422">func</span><span class="op" id="6934426">(</span><span class="op" id="6934427">)</span>&nbsp;<span class="op" id="6934429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934433">c</span><span class="op" id="6934434">,</span>&nbsp;<span class="ident" id="6934436">err</span>&nbsp;<span class="op" id="6934440">:=</span>&nbsp;<span class="ident" id="6934443"><a href="/net/timeout_test.go.html#6934272">ln</a></span><span class="op" id="6934445">.</span><span class="ident" id="6934446">Accept</span><span class="op" id="6934452">(</span><span class="op" id="6934453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934457">if</span>&nbsp;<span class="ident" id="6934460"><a href="/net/timeout_test.go.html#6934436">err</a></span>&nbsp;<span class="op" id="6934464">!=</span>&nbsp;<span class="ident" id="6934467">nil</span>&nbsp;<span class="op" id="6934471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934476"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934477">.</span><span class="ident" id="6934478">Errorf</span><span class="op" id="6934484">(</span><span class="string" id="6934485">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6934497">,</span>&nbsp;<span class="ident" id="6934499"><a href="/net/timeout_test.go.html#6934436">err</a></span><span class="op" id="6934502">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934507">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934520">defer</span>&nbsp;<span class="ident" id="6934526"><a href="/net/timeout_test.go.html#6934433">c</a></span><span class="op" id="6934527">.</span><span class="ident" id="6934528">Close</span><span class="op" id="6934533">(</span><span class="op" id="6934534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934538"><a href="/net/timeout_test.go.html#6934391">lnquit</a></span>&nbsp;<span class="op" id="6934545">&lt;-</span>&nbsp;<span class="ident" id="6934548">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934554">}</span><span class="op" id="6934555">(</span><span class="op" id="6934556">)</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934560">c</span><span class="op" id="6934561">,</span>&nbsp;<span class="ident" id="6934563"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934567">:=</span>&nbsp;<span class="ident" id="6934570"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6934574">(</span><span class="string" id="6934575">&#34;tcp&#34;</span><span class="op" id="6934580">,</span>&nbsp;<span class="ident" id="6934582"><a href="/net/timeout_test.go.html#6934272">ln</a></span><span class="op" id="6934584">.</span><span class="ident" id="6934585">Addr</span><span class="op" id="6934589">(</span><span class="op" id="6934590">)</span><span class="op" id="6934591">.</span><span class="ident" id="6934592">String</span><span class="op" id="6934598">(</span><span class="op" id="6934599">)</span><span class="op" id="6934600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934603">if</span>&nbsp;<span class="ident" id="6934606"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934610">!=</span>&nbsp;<span class="ident" id="6934613">nil</span>&nbsp;<span class="op" id="6934617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934621"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934622">.</span><span class="ident" id="6934623">Fatalf</span><span class="op" id="6934629">(</span><span class="string" id="6934630">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6934640">,</span>&nbsp;<span class="ident" id="6934642"><a href="/net/timeout_test.go.html#6934276">err</a></span><span class="op" id="6934645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934648">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934651">defer</span>&nbsp;<span class="ident" id="6934657"><a href="/net/timeout_test.go.html#6934560">c</a></span><span class="op" id="6934658">.</span><span class="ident" id="6934659">Close</span><span class="op" id="6934664">(</span><span class="op" id="6934665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934669">start</span>&nbsp;<span class="op" id="6934675">:=</span>&nbsp;<span class="ident" id="6934678"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6934682">.</span><span class="ident" id="6934683">Now</span><span class="op" id="6934686">(</span><span class="op" id="6934687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934690"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934694">=</span>&nbsp;<span class="ident" id="6934696"><a href="/net/timeout_test.go.html#6934560">c</a></span><span class="op" id="6934697">.</span><span class="ident" id="6934698">SetReadDeadline</span><span class="op" id="6934713">(</span><span class="ident" id="6934714"><a href="/net/timeout_test.go.html#6934669">start</a></span><span class="op" id="6934719">.</span><span class="ident" id="6934720">Add</span><span class="op" id="6934723">(</span><span class="ident" id="6934724"><a href="/net/timeout_test.go.html#6933897">readTimeout</a></span><span class="op" id="6934735">)</span><span class="op" id="6934736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934739">if</span>&nbsp;<span class="ident" id="6934742"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934746">!=</span>&nbsp;<span class="ident" id="6934749">nil</span>&nbsp;<span class="op" id="6934753">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934757"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934758">.</span><span class="ident" id="6934759">Fatalf</span><span class="op" id="6934765">(</span><span class="string" id="6934766">&#34;SetReadDeadline:&nbsp;%v&#34;</span><span class="op" id="6934787">,</span>&nbsp;<span class="ident" id="6934789"><a href="/net/timeout_test.go.html#6934276">err</a></span><span class="op" id="6934792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934798"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934802">=</span>&nbsp;<span class="ident" id="6934804"><a href="/net/timeout_test.go.html#6934560">c</a></span><span class="op" id="6934805">.</span><span class="ident" id="6934806">SetWriteDeadline</span><span class="op" id="6934822">(</span><span class="ident" id="6934823"><a href="/net/timeout_test.go.html#6934669">start</a></span><span class="op" id="6934828">.</span><span class="ident" id="6934829">Add</span><span class="op" id="6934832">(</span><span class="ident" id="6934833"><a href="/net/timeout_test.go.html#6933936">writeTimeout</a></span><span class="op" id="6934845">)</span><span class="op" id="6934846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934849">if</span>&nbsp;<span class="ident" id="6934852"><a href="/net/timeout_test.go.html#6934276">err</a></span>&nbsp;<span class="op" id="6934856">!=</span>&nbsp;<span class="ident" id="6934859">nil</span>&nbsp;<span class="op" id="6934863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934867"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6934868">.</span><span class="ident" id="6934869">Fatalf</span><span class="op" id="6934875">(</span><span class="string" id="6934876">&#34;SetWriteDeadline:&nbsp;%v&#34;</span><span class="op" id="6934898">,</span>&nbsp;<span class="ident" id="6934900"><a href="/net/timeout_test.go.html#6934276">err</a></span><span class="op" id="6934903">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6934906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934910">quit</span>&nbsp;<span class="op" id="6934915">:=</span>&nbsp;<span class="builtinfunc" id="6934918">make</span><span class="op" id="6934922">(</span><span class="keyword" id="6934923">chan</span>&nbsp;<span class="builtintype" id="6934928">bool</span><span class="op" id="6934932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934936">go</span>&nbsp;<span class="keyword" id="6934939">func</span><span class="op" id="6934943">(</span><span class="op" id="6934944">)</span>&nbsp;<span class="op" id="6934946">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934950">var</span>&nbsp;<span class="ident" id="6934954">buf</span>&nbsp;<span class="op" id="6934958">[</span><span class="num" id="6934959">10</span><span class="op" id="6934961">]</span><span class="builtintype" id="6934962">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6934969">_</span><span class="op" id="6934970">,</span>&nbsp;<span class="ident" id="6934972">err</span>&nbsp;<span class="op" id="6934976">:=</span>&nbsp;<span class="ident" id="6934979"><a href="/net/timeout_test.go.html#6934560">c</a></span><span class="op" id="6934980">.</span><span class="ident" id="6934981">Read</span><span class="op" id="6934985">(</span><span class="ident" id="6934986"><a href="/net/timeout_test.go.html#6934954">buf</a></span><span class="op" id="6934989">[</span><span class="op" id="6934990">:</span><span class="op" id="6934991">]</span><span class="op" id="6934992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6934996">if</span>&nbsp;<span class="ident" id="6934999"><a href="/net/timeout_test.go.html#6934972">err</a></span>&nbsp;<span class="op" id="6935003">==</span>&nbsp;<span class="ident" id="6935006">nil</span>&nbsp;<span class="op" id="6935010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935015"><a href="/net/timeout_test.go.html#6933781">t</a></span><span class="op" id="6935016">.</span><span class="ident" id="6935017">Errorf</span><span class="op" id="6935023">(</span><span class="string" id="6935024">&#34;Read&nbsp;should&nbsp;not&nbsp;succeed&#34;</span><span class="op" id="6935049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935053">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935057"><a href="/net/timeout_test.go.html#6933978">checkTimeout</a></span><span class="op" id="6935069">(</span><span class="string" id="6935070">&#34;Read&#34;</span><span class="op" id="6935076">,</span>&nbsp;<span class="ident" id="6935078"><a href="/net/timeout_test.go.html#6934669">start</a></span><span class="op" id="6935083">,</span>&nbsp;<span class="ident" id="6935085"><a href="/net/timeout_test.go.html#6933897">readTimeout</a></span><span class="op" id="6935096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935100"><a href="/net/timeout_test.go.html#6934910">quit</a></span>&nbsp;<span class="op" id="6935105">&lt;-</span>&nbsp;<span class="ident" id="6935108">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935114">}</span><span class="op" id="6935115">(</span><span class="op" id="6935116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935120">go</span>&nbsp;<span class="keyword" id="6935123">func</span><span class="op" id="6935127">(</span><span class="op" id="6935128">)</span>&nbsp;<span class="op" id="6935130">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935134">var</span>&nbsp;<span class="ident" id="6935138">buf</span>&nbsp;<span class="op" id="6935142">[</span><span class="num" id="6935143">10000</span><span class="op" id="6935148">]</span><span class="builtintype" id="6935149">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935156">for</span>&nbsp;<span class="op" id="6935160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935165">_</span><span class="op" id="6935166">,</span>&nbsp;<span class="ident" id="6935168">err</span>&nbsp;<span class="op" id="6935172">:=</span>&nbsp;<span class="ident" id="6935175"><a href="/net/timeout_test.go.html#6934560">c</a></span><span class="op" id="6935176">.</span><span class="ident" id="6935177">Write</span><span class="op" id="6935182">(</span><span class="ident" id="6935183"><a href="/net/timeout_test.go.html#6935138">buf</a></span><span class="op" id="6935186">[</span><span class="op" id="6935187">:</span><span class="op" id="6935188">]</span><span class="op" id="6935189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935194">if</span>&nbsp;<span class="ident" id="6935197"><a href="/net/timeout_test.go.html#6935168">err</a></span>&nbsp;<span class="op" id="6935201">!=</span>&nbsp;<span class="ident" id="6935204">nil</span>&nbsp;<span class="op" id="6935208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935214">break</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935231"><a href="/net/timeout_test.go.html#6933978">checkTimeout</a></span><span class="op" id="6935243">(</span><span class="string" id="6935244">&#34;Write&#34;</span><span class="op" id="6935251">,</span>&nbsp;<span class="ident" id="6935253"><a href="/net/timeout_test.go.html#6934669">start</a></span><span class="op" id="6935258">,</span>&nbsp;<span class="ident" id="6935260"><a href="/net/timeout_test.go.html#6933936">writeTimeout</a></span><span class="op" id="6935272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935276"><a href="/net/timeout_test.go.html#6934910">quit</a></span>&nbsp;<span class="op" id="6935281">&lt;-</span>&nbsp;<span class="ident" id="6935284">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935290">}</span><span class="op" id="6935291">(</span><span class="op" id="6935292">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935296">&lt;-</span><span class="ident" id="6935298"><a href="/net/timeout_test.go.html#6934910">quit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935304">&lt;-</span><span class="ident" id="6935306"><a href="/net/timeout_test.go.html#6934910">quit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935312">&lt;-</span><span class="ident" id="6935314"><a href="/net/timeout_test.go.html#6934391">lnquit</a></span><br>
<span class="lineno"></span><span class="op" id="6935321">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="6935324">type</span>&nbsp;<span class="ident" id="6935329">neverEnding</span>&nbsp;<span class="builtintype" id="6935341">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6935347">func</span>&nbsp;<span class="op" id="6935352">(</span><span class="ident" id="6935353">b</span>&nbsp;<span class="ident" id="6935355"><a href="/net/timeout_test.go.html#6935329">neverEnding</a></span><span class="op" id="6935366">)</span>&nbsp;<span class="ident" id="6935368">Read</span><span class="op" id="6935372">(</span><span class="ident" id="6935373">p</span>&nbsp;<span class="op" id="6935375">[</span><span class="op" id="6935376">]</span><span class="builtintype" id="6935377">byte</span><span class="op" id="6935381">)</span>&nbsp;<span class="op" id="6935383">(</span><span class="ident" id="6935384">n</span>&nbsp;<span class="builtintype" id="6935386">int</span><span class="op" id="6935389">,</span>&nbsp;<span class="ident" id="6935391">err</span>&nbsp;<span class="builtintype" id="6935395">error</span><span class="op" id="6935400">)</span>&nbsp;<span class="op" id="6935402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935405">for</span>&nbsp;<span class="ident" id="6935409">i</span>&nbsp;<span class="op" id="6935411">:=</span>&nbsp;<span class="keyword" id="6935414">range</span>&nbsp;<span class="ident" id="6935420"><a href="/net/timeout_test.go.html#6935373">p</a></span>&nbsp;<span class="op" id="6935422">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935426"><a href="/net/timeout_test.go.html#6935373">p</a></span><span class="op" id="6935427">[</span><span class="ident" id="6935428"><a href="/net/timeout_test.go.html#6935409">i</a></span><span class="op" id="6935429">]</span>&nbsp;<span class="op" id="6935431">=</span>&nbsp;<span class="builtintype" id="6935433">byte</span><span class="op" id="6935437">(</span><span class="ident" id="6935438"><a href="/net/timeout_test.go.html#6935353">b</a></span><span class="op" id="6935439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935445">return</span>&nbsp;<span class="builtinfunc" id="6935452">len</span><span class="op" id="6935455">(</span><span class="ident" id="6935456"><a href="/net/timeout_test.go.html#6935373">p</a></span><span class="op" id="6935457">)</span><span class="op" id="6935458">,</span>&nbsp;<span class="ident" id="6935460">nil</span><br>
<span class="lineno"></span><span class="op" id="6935464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="keyword" id="6935467">func</span>&nbsp;<span class="ident" id="6935472">TestVariousDeadlines1Proc</span><span class="op" id="6935497">(</span><span class="ident" id="6935498">t</span>&nbsp;<span class="op" id="6935500">*</span><span class="ident" id="6935501"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6935508">.</span><span class="ident" id="6935509">T</span><span class="op" id="6935510">)</span>&nbsp;<span class="op" id="6935512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935515"><a href="/net/timeout_test.go.html#6935628">testVariousDeadlines</a></span><span class="op" id="6935535">(</span><span class="ident" id="6935536"><a href="/net/timeout_test.go.html#6935498">t</a></span><span class="op" id="6935537">,</span>&nbsp;<span class="num" id="6935539">1</span><span class="op" id="6935540">)</span><br>
<span class="lineno"></span><span class="op" id="6935542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6935545">func</span>&nbsp;<span class="ident" id="6935550">TestVariousDeadlines4Proc</span><span class="op" id="6935575">(</span><span class="ident" id="6935576">t</span>&nbsp;<span class="op" id="6935578">*</span><span class="ident" id="6935579"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6935586">.</span><span class="ident" id="6935587">T</span><span class="op" id="6935588">)</span>&nbsp;<span class="op" id="6935590">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935593"><a href="/net/timeout_test.go.html#6935628">testVariousDeadlines</a></span><span class="op" id="6935613">(</span><span class="ident" id="6935614"><a href="/net/timeout_test.go.html#6935576">t</a></span><span class="op" id="6935615">,</span>&nbsp;<span class="num" id="6935617">4</span><span class="op" id="6935618">)</span><br>
<span class="lineno"></span><span class="op" id="6935620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6935623">func</span>&nbsp;<span class="ident" id="6935628">testVariousDeadlines</span><span class="op" id="6935648">(</span><span class="ident" id="6935649">t</span>&nbsp;<span class="op" id="6935651">*</span><span class="ident" id="6935652"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6935659">.</span><span class="ident" id="6935660">T</span><span class="op" id="6935661">,</span>&nbsp;<span class="ident" id="6935663">maxProcs</span>&nbsp;<span class="builtintype" id="6935672">int</span><span class="op" id="6935675">)</span>&nbsp;<span class="op" id="6935677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935680">switch</span>&nbsp;<span class="ident" id="6935687"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6935694">.</span><span class="ident" id="6935695">GOOS</span>&nbsp;<span class="op" id="6935700">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935703">case</span>&nbsp;<span class="string" id="6935708">&#34;plan9&#34;</span><span class="op" id="6935715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935719"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6935720">.</span><span class="ident" id="6935721">Skipf</span><span class="op" id="6935726">(</span><span class="string" id="6935727">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6935748">,</span>&nbsp;<span class="ident" id="6935750"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6935757">.</span><span class="ident" id="6935758">GOOS</span><span class="op" id="6935762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6935765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935769">defer</span>&nbsp;<span class="ident" id="6935775"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6935782">.</span><span class="ident" id="6935783">GOMAXPROCS</span><span class="op" id="6935793">(</span><span class="ident" id="6935794"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6935801">.</span><span class="ident" id="6935802">GOMAXPROCS</span><span class="op" id="6935812">(</span><span class="ident" id="6935813"><a href="/net/timeout_test.go.html#6935663">maxProcs</a></span><span class="op" id="6935821">)</span><span class="op" id="6935822">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935825">ln</span>&nbsp;<span class="op" id="6935828">:=</span>&nbsp;<span class="ident" id="6935831"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6935847">(</span><span class="ident" id="6935848"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6935849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6935852">defer</span>&nbsp;<span class="ident" id="6935858"><a href="/net/timeout_test.go.html#6935825">ln</a></span><span class="op" id="6935860">.</span><span class="ident" id="6935861">Close</span><span class="op" id="6935866">(</span><span class="op" id="6935867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935870">acceptc</span>&nbsp;<span class="op" id="6935878">:=</span>&nbsp;<span class="builtinfunc" id="6935881">make</span><span class="op" id="6935885">(</span><span class="keyword" id="6935886">chan</span>&nbsp;<span class="builtintype" id="6935891">error</span><span class="op" id="6935896">,</span>&nbsp;<span class="num" id="6935898">1</span><span class="op" id="6935899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6935903">//&nbsp;The&nbsp;server,&nbsp;with&nbsp;no&nbsp;timeouts&nbsp;of&nbsp;its&nbsp;own,&nbsp;sending&nbsp;bytes&nbsp;to&nbsp;clients</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6935973">//&nbsp;as&nbsp;fast&nbsp;as&nbsp;it&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6935996">servec</span>&nbsp;<span class="op" id="6936003">:=</span>&nbsp;<span class="builtinfunc" id="6936006">make</span><span class="op" id="6936010">(</span><span class="keyword" id="6936011">chan</span>&nbsp;<span class="ident" id="6936016"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6936023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936026">go</span>&nbsp;<span class="keyword" id="6936029">func</span><span class="op" id="6936033">(</span><span class="op" id="6936034">)</span>&nbsp;<span class="op" id="6936036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936040">for</span>&nbsp;<span class="op" id="6936044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936049">c</span><span class="op" id="6936050">,</span>&nbsp;<span class="ident" id="6936052">err</span>&nbsp;<span class="op" id="6936056">:=</span>&nbsp;<span class="ident" id="6936059"><a href="/net/timeout_test.go.html#6935825">ln</a></span><span class="op" id="6936061">.</span><span class="ident" id="6936062">Accept</span><span class="op" id="6936068">(</span><span class="op" id="6936069">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936074">if</span>&nbsp;<span class="ident" id="6936077"><a href="/net/timeout_test.go.html#6936052">err</a></span>&nbsp;<span class="op" id="6936081">!=</span>&nbsp;<span class="ident" id="6936084">nil</span>&nbsp;<span class="op" id="6936088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936094"><a href="/net/timeout_test.go.html#6935870">acceptc</a></span>&nbsp;<span class="op" id="6936102">&lt;-</span>&nbsp;<span class="ident" id="6936105"><a href="/net/timeout_test.go.html#6936052">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936113">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936128">go</span>&nbsp;<span class="keyword" id="6936131">func</span><span class="op" id="6936135">(</span><span class="op" id="6936136">)</span>&nbsp;<span class="op" id="6936138">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936144">t0</span>&nbsp;<span class="op" id="6936147">:=</span>&nbsp;<span class="ident" id="6936150"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936154">.</span><span class="ident" id="6936155">Now</span><span class="op" id="6936158">(</span><span class="op" id="6936159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936165">n</span><span class="op" id="6936166">,</span>&nbsp;<span class="ident" id="6936168">err</span>&nbsp;<span class="op" id="6936172">:=</span>&nbsp;<span class="ident" id="6936175"><a href="/net/timeout_test.go.html#6926245">io</a></span><span class="op" id="6936177">.</span><span class="ident" id="6936178">Copy</span><span class="op" id="6936182">(</span><span class="ident" id="6936183"><a href="/net/timeout_test.go.html#6936049">c</a></span><span class="op" id="6936184">,</span>&nbsp;<span class="ident" id="6936186"><a href="/net/timeout_test.go.html#6935329">neverEnding</a></span><span class="op" id="6936197">(</span><span class="string" id="6936198">&#39;a&#39;</span><span class="op" id="6936201">)</span><span class="op" id="6936202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936208">d</span>&nbsp;<span class="op" id="6936210">:=</span>&nbsp;<span class="ident" id="6936213"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936217">.</span><span class="ident" id="6936218">Since</span><span class="op" id="6936223">(</span><span class="ident" id="6936224"><a href="/net/timeout_test.go.html#6936144">t0</a></span><span class="op" id="6936226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936232"><a href="/net/timeout_test.go.html#6936049">c</a></span><span class="op" id="6936233">.</span><span class="ident" id="6936234">Close</span><span class="op" id="6936239">(</span><span class="op" id="6936240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936246"><a href="/net/timeout_test.go.html#6935996">servec</a></span>&nbsp;<span class="op" id="6936253">&lt;-</span>&nbsp;<span class="ident" id="6936256"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6936263">{</span><span class="ident" id="6936264"><a href="/net/timeout_test.go.html#6936165">n</a></span><span class="op" id="6936265">,</span>&nbsp;<span class="ident" id="6936267"><a href="/net/timeout_test.go.html#6936168">err</a></span><span class="op" id="6936270">,</span>&nbsp;<span class="ident" id="6936272"><a href="/net/timeout_test.go.html#6936208">d</a></span><span class="op" id="6936273">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936278">}</span><span class="op" id="6936279">(</span><span class="op" id="6936280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936287">}</span><span class="op" id="6936288">(</span><span class="op" id="6936289">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936293">for</span>&nbsp;<span class="ident" id="6936297">_</span><span class="op" id="6936298">,</span>&nbsp;<span class="ident" id="6936300">timeout</span>&nbsp;<span class="op" id="6936308">:=</span>&nbsp;<span class="keyword" id="6936311">range</span>&nbsp;<span class="op" id="6936317">[</span><span class="op" id="6936318">]</span><span class="ident" id="6936319"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936323">.</span><span class="ident" id="6936324">Duration</span><span class="op" id="6936332">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936336">1</span>&nbsp;<span class="op" id="6936338">*</span>&nbsp;<span class="ident" id="6936340"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936344">.</span><span class="ident" id="6936345">Nanosecond</span><span class="op" id="6936355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936359">2</span>&nbsp;<span class="op" id="6936361">*</span>&nbsp;<span class="ident" id="6936363"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936367">.</span><span class="ident" id="6936368">Nanosecond</span><span class="op" id="6936378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936382">5</span>&nbsp;<span class="op" id="6936384">*</span>&nbsp;<span class="ident" id="6936386"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936390">.</span><span class="ident" id="6936391">Nanosecond</span><span class="op" id="6936401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936405">50</span>&nbsp;<span class="op" id="6936408">*</span>&nbsp;<span class="ident" id="6936410"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936414">.</span><span class="ident" id="6936415">Nanosecond</span><span class="op" id="6936425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936429">100</span>&nbsp;<span class="op" id="6936433">*</span>&nbsp;<span class="ident" id="6936435"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936439">.</span><span class="ident" id="6936440">Nanosecond</span><span class="op" id="6936450">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936454">200</span>&nbsp;<span class="op" id="6936458">*</span>&nbsp;<span class="ident" id="6936460"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936464">.</span><span class="ident" id="6936465">Nanosecond</span><span class="op" id="6936475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936479">500</span>&nbsp;<span class="op" id="6936483">*</span>&nbsp;<span class="ident" id="6936485"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936489">.</span><span class="ident" id="6936490">Nanosecond</span><span class="op" id="6936500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936504">750</span>&nbsp;<span class="op" id="6936508">*</span>&nbsp;<span class="ident" id="6936510"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936514">.</span><span class="ident" id="6936515">Nanosecond</span><span class="op" id="6936525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936529">1</span>&nbsp;<span class="op" id="6936531">*</span>&nbsp;<span class="ident" id="6936533"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936537">.</span><span class="ident" id="6936538">Microsecond</span><span class="op" id="6936549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936553">5</span>&nbsp;<span class="op" id="6936555">*</span>&nbsp;<span class="ident" id="6936557"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936561">.</span><span class="ident" id="6936562">Microsecond</span><span class="op" id="6936573">,</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936577">25</span>&nbsp;<span class="op" id="6936580">*</span>&nbsp;<span class="ident" id="6936582"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936586">.</span><span class="ident" id="6936587">Microsecond</span><span class="op" id="6936598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936602">250</span>&nbsp;<span class="op" id="6936606">*</span>&nbsp;<span class="ident" id="6936608"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936612">.</span><span class="ident" id="6936613">Microsecond</span><span class="op" id="6936624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936628">500</span>&nbsp;<span class="op" id="6936632">*</span>&nbsp;<span class="ident" id="6936634"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936638">.</span><span class="ident" id="6936639">Microsecond</span><span class="op" id="6936650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936654">1</span>&nbsp;<span class="op" id="6936656">*</span>&nbsp;<span class="ident" id="6936658"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936662">.</span><span class="ident" id="6936663">Millisecond</span><span class="op" id="6936674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936678">5</span>&nbsp;<span class="op" id="6936680">*</span>&nbsp;<span class="ident" id="6936682"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936686">.</span><span class="ident" id="6936687">Millisecond</span><span class="op" id="6936698">,</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936702">100</span>&nbsp;<span class="op" id="6936706">*</span>&nbsp;<span class="ident" id="6936708"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936712">.</span><span class="ident" id="6936713">Millisecond</span><span class="op" id="6936724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936728">250</span>&nbsp;<span class="op" id="6936732">*</span>&nbsp;<span class="ident" id="6936734"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936738">.</span><span class="ident" id="6936739">Millisecond</span><span class="op" id="6936750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936754">500</span>&nbsp;<span class="op" id="6936758">*</span>&nbsp;<span class="ident" id="6936760"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936764">.</span><span class="ident" id="6936765">Millisecond</span><span class="op" id="6936776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6936780">1</span>&nbsp;<span class="op" id="6936782">*</span>&nbsp;<span class="ident" id="6936784"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936788">.</span><span class="ident" id="6936789">Second</span><span class="op" id="6936795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936798">}</span>&nbsp;<span class="op" id="6936800">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936804">numRuns</span>&nbsp;<span class="op" id="6936812">:=</span>&nbsp;<span class="num" id="6936815">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936819">if</span>&nbsp;<span class="ident" id="6936822"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6936829">.</span><span class="ident" id="6936830">Short</span><span class="op" id="6936835">(</span><span class="op" id="6936836">)</span>&nbsp;<span class="op" id="6936838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936843"><a href="/net/timeout_test.go.html#6936804">numRuns</a></span>&nbsp;<span class="op" id="6936851">=</span>&nbsp;<span class="num" id="6936853">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936858">if</span>&nbsp;<span class="ident" id="6936861"><a href="/net/timeout_test.go.html#6936300">timeout</a></span>&nbsp;<span class="op" id="6936869">&gt;</span>&nbsp;<span class="num" id="6936871">500</span><span class="op" id="6936874">*</span><span class="ident" id="6936875"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6936879">.</span><span class="ident" id="6936880">Microsecond</span>&nbsp;<span class="op" id="6936892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936898">continue</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6936914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6936918">for</span>&nbsp;<span class="ident" id="6936922">run</span>&nbsp;<span class="op" id="6936926">:=</span>&nbsp;<span class="num" id="6936929">0</span><span class="op" id="6936930">;</span>&nbsp;<span class="ident" id="6936932"><a href="/net/timeout_test.go.html#6936922">run</a></span>&nbsp;<span class="op" id="6936936">&lt;</span>&nbsp;<span class="ident" id="6936938"><a href="/net/timeout_test.go.html#6936804">numRuns</a></span><span class="op" id="6936945">;</span>&nbsp;<span class="ident" id="6936947"><a href="/net/timeout_test.go.html#6936922">run</a></span><span class="op" id="6936950">++</span>&nbsp;<span class="op" id="6936953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6936958">name</span>&nbsp;<span class="op" id="6936963">:=</span>&nbsp;<span class="ident" id="6936966"><a href="/net/timeout_test.go.html#6926238">fmt</a></span><span class="op" id="6936969">.</span><span class="ident" id="6936970">Sprintf</span><span class="op" id="6936977">(</span><span class="string" id="6936978">&#34;%v&nbsp;run&nbsp;%d/%d&#34;</span><span class="op" id="6936992">,</span>&nbsp;<span class="ident" id="6936994"><a href="/net/timeout_test.go.html#6936300">timeout</a></span><span class="op" id="6937001">,</span>&nbsp;<span class="ident" id="6937003"><a href="/net/timeout_test.go.html#6936922">run</a></span><span class="op" id="6937006">+</span><span class="num" id="6937007">1</span><span class="op" id="6937008">,</span>&nbsp;<span class="ident" id="6937010"><a href="/net/timeout_test.go.html#6936804">numRuns</a></span><span class="op" id="6937017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937022"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937023">.</span><span class="ident" id="6937024">Log</span><span class="op" id="6937027">(</span><span class="ident" id="6937028"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937032">)</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937038">c</span><span class="op" id="6937039">,</span>&nbsp;<span class="ident" id="6937041">err</span>&nbsp;<span class="op" id="6937045">:=</span>&nbsp;<span class="ident" id="6937048"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6937052">(</span><span class="string" id="6937053">&#34;tcp&#34;</span><span class="op" id="6937058">,</span>&nbsp;<span class="ident" id="6937060"><a href="/net/timeout_test.go.html#6935825">ln</a></span><span class="op" id="6937062">.</span><span class="ident" id="6937063">Addr</span><span class="op" id="6937067">(</span><span class="op" id="6937068">)</span><span class="op" id="6937069">.</span><span class="ident" id="6937070">String</span><span class="op" id="6937076">(</span><span class="op" id="6937077">)</span><span class="op" id="6937078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937083">if</span>&nbsp;<span class="ident" id="6937086"><a href="/net/timeout_test.go.html#6937041">err</a></span>&nbsp;<span class="op" id="6937090">!=</span>&nbsp;<span class="ident" id="6937093">nil</span>&nbsp;<span class="op" id="6937097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937103"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937104">.</span><span class="ident" id="6937105">Fatalf</span><span class="op" id="6937111">(</span><span class="string" id="6937112">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6937122">,</span>&nbsp;<span class="ident" id="6937124"><a href="/net/timeout_test.go.html#6937041">err</a></span><span class="op" id="6937127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6937132">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937137">clientc</span>&nbsp;<span class="op" id="6937145">:=</span>&nbsp;<span class="builtinfunc" id="6937148">make</span><span class="op" id="6937152">(</span><span class="keyword" id="6937153">chan</span>&nbsp;<span class="ident" id="6937158"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6937165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937170">go</span>&nbsp;<span class="keyword" id="6937173">func</span><span class="op" id="6937177">(</span><span class="op" id="6937178">)</span>&nbsp;<span class="op" id="6937180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937186">t0</span>&nbsp;<span class="op" id="6937189">:=</span>&nbsp;<span class="ident" id="6937192"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6937196">.</span><span class="ident" id="6937197">Now</span><span class="op" id="6937200">(</span><span class="op" id="6937201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937207"><a href="/net/timeout_test.go.html#6937038">c</a></span><span class="op" id="6937208">.</span><span class="ident" id="6937209">SetDeadline</span><span class="op" id="6937220">(</span><span class="ident" id="6937221"><a href="/net/timeout_test.go.html#6937186">t0</a></span><span class="op" id="6937223">.</span><span class="ident" id="6937224">Add</span><span class="op" id="6937227">(</span><span class="ident" id="6937228"><a href="/net/timeout_test.go.html#6936300">timeout</a></span><span class="op" id="6937235">)</span><span class="op" id="6937236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937242">n</span><span class="op" id="6937243">,</span>&nbsp;<span class="ident" id="6937245">err</span>&nbsp;<span class="op" id="6937249">:=</span>&nbsp;<span class="ident" id="6937252"><a href="/net/timeout_test.go.html#6926245">io</a></span><span class="op" id="6937254">.</span><span class="ident" id="6937255">Copy</span><span class="op" id="6937259">(</span><span class="ident" id="6937260"><a href="/net/timeout_test.go.html#6926251">ioutil</a></span><span class="op" id="6937266">.</span><span class="ident" id="6937267">Discard</span><span class="op" id="6937274">,</span>&nbsp;<span class="ident" id="6937276"><a href="/net/timeout_test.go.html#6937038">c</a></span><span class="op" id="6937277">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937283">d</span>&nbsp;<span class="op" id="6937285">:=</span>&nbsp;<span class="ident" id="6937288"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6937292">.</span><span class="ident" id="6937293">Since</span><span class="op" id="6937298">(</span><span class="ident" id="6937299"><a href="/net/timeout_test.go.html#6937186">t0</a></span><span class="op" id="6937301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937307"><a href="/net/timeout_test.go.html#6937038">c</a></span><span class="op" id="6937308">.</span><span class="ident" id="6937309">Close</span><span class="op" id="6937314">(</span><span class="op" id="6937315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937321"><a href="/net/timeout_test.go.html#6937137">clientc</a></span>&nbsp;<span class="op" id="6937329">&lt;-</span>&nbsp;<span class="ident" id="6937332"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6937339">{</span><span class="ident" id="6937340"><a href="/net/timeout_test.go.html#6937242">n</a></span><span class="op" id="6937341">,</span>&nbsp;<span class="ident" id="6937343"><a href="/net/timeout_test.go.html#6937245">err</a></span><span class="op" id="6937346">,</span>&nbsp;<span class="ident" id="6937348"><a href="/net/timeout_test.go.html#6937283">d</a></span><span class="op" id="6937349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6937354">}</span><span class="op" id="6937355">(</span><span class="op" id="6937356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937362">tooLong</span>&nbsp;<span class="op" id="6937370">:=</span>&nbsp;<span class="num" id="6937373">5</span>&nbsp;<span class="op" id="6937375">*</span>&nbsp;<span class="ident" id="6937377"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6937381">.</span><span class="ident" id="6937382">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937392">select</span>&nbsp;<span class="op" id="6937399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937404">case</span>&nbsp;<span class="ident" id="6937409">res</span>&nbsp;<span class="op" id="6937413">:=</span>&nbsp;<span class="op" id="6937416">&lt;-</span><span class="ident" id="6937418"><a href="/net/timeout_test.go.html#6937137">clientc</a></span><span class="op" id="6937425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937431">if</span>&nbsp;<span class="ident" id="6937434"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6937443">(</span><span class="ident" id="6937444"><a href="/net/timeout_test.go.html#6937409">res</a></span><span class="op" id="6937447">.</span><span class="ident" id="6937448">err</span><span class="op" id="6937451">)</span>&nbsp;<span class="op" id="6937453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937460"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937461">.</span><span class="ident" id="6937462">Logf</span><span class="op" id="6937466">(</span><span class="string" id="6937467">&#34;for&nbsp;%v,&nbsp;good&nbsp;client&nbsp;timeout&nbsp;after&nbsp;%v,&nbsp;reading&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="6937523">,</span>&nbsp;<span class="ident" id="6937525"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937529">,</span>&nbsp;<span class="ident" id="6937531"><a href="/net/timeout_test.go.html#6937409">res</a></span><span class="op" id="6937534">.</span><span class="ident" id="6937535">d</span><span class="op" id="6937536">,</span>&nbsp;<span class="ident" id="6937538"><a href="/net/timeout_test.go.html#6937409">res</a></span><span class="op" id="6937541">.</span><span class="ident" id="6937542">n</span><span class="op" id="6937543">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6937549">}</span>&nbsp;<span class="keyword" id="6937551">else</span>&nbsp;<span class="op" id="6937556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937563"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937564">.</span><span class="ident" id="6937565">Fatalf</span><span class="op" id="6937571">(</span><span class="string" id="6937572">&#34;for&nbsp;%v:&nbsp;client&nbsp;Copy&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;(want&nbsp;timeout)&#34;</span><span class="op" id="6937617">,</span>&nbsp;<span class="ident" id="6937619"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937623">,</span>&nbsp;<span class="ident" id="6937625"><a href="/net/timeout_test.go.html#6937409">res</a></span><span class="op" id="6937628">.</span><span class="ident" id="6937629">n</span><span class="op" id="6937630">,</span>&nbsp;<span class="ident" id="6937632"><a href="/net/timeout_test.go.html#6937409">res</a></span><span class="op" id="6937635">.</span><span class="ident" id="6937636">err</span><span class="op" id="6937639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6937645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937650">case</span>&nbsp;<span class="op" id="6937655">&lt;-</span><span class="ident" id="6937657"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6937661">.</span><span class="ident" id="6937662">After</span><span class="op" id="6937667">(</span><span class="ident" id="6937668"><a href="/net/timeout_test.go.html#6937362">tooLong</a></span><span class="op" id="6937675">)</span><span class="op" id="6937676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937682"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937683">.</span><span class="ident" id="6937684">Fatalf</span><span class="op" id="6937690">(</span><span class="string" id="6937691">&#34;for&nbsp;%v:&nbsp;timeout&nbsp;(%v)&nbsp;waiting&nbsp;for&nbsp;client&nbsp;to&nbsp;timeout&nbsp;(%v)&nbsp;reading&#34;</span><span class="op" id="6937756">,</span>&nbsp;<span class="ident" id="6937758"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937762">,</span>&nbsp;<span class="ident" id="6937764"><a href="/net/timeout_test.go.html#6937362">tooLong</a></span><span class="op" id="6937771">,</span>&nbsp;<span class="ident" id="6937773"><a href="/net/timeout_test.go.html#6936300">timeout</a></span><span class="op" id="6937780">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6937785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937791">select</span>&nbsp;<span class="op" id="6937798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937803">case</span>&nbsp;<span class="ident" id="6937808">res</span>&nbsp;<span class="op" id="6937812">:=</span>&nbsp;<span class="op" id="6937815">&lt;-</span><span class="ident" id="6937817"><a href="/net/timeout_test.go.html#6935996">servec</a></span><span class="op" id="6937823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937829"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937830">.</span><span class="ident" id="6937831">Logf</span><span class="op" id="6937835">(</span><span class="string" id="6937836">&#34;for&nbsp;%v:&nbsp;server&nbsp;in&nbsp;%v&nbsp;wrote&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6937871">,</span>&nbsp;<span class="ident" id="6937873"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937877">,</span>&nbsp;<span class="ident" id="6937879"><a href="/net/timeout_test.go.html#6937808">res</a></span><span class="op" id="6937882">.</span><span class="ident" id="6937883">d</span><span class="op" id="6937884">,</span>&nbsp;<span class="ident" id="6937886"><a href="/net/timeout_test.go.html#6937808">res</a></span><span class="op" id="6937889">.</span><span class="ident" id="6937890">n</span><span class="op" id="6937891">,</span>&nbsp;<span class="ident" id="6937893"><a href="/net/timeout_test.go.html#6937808">res</a></span><span class="op" id="6937896">.</span><span class="ident" id="6937897">err</span><span class="op" id="6937900">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937905">case</span>&nbsp;<span class="ident" id="6937910">err</span>&nbsp;<span class="op" id="6937914">:=</span>&nbsp;<span class="op" id="6937917">&lt;-</span><span class="ident" id="6937919"><a href="/net/timeout_test.go.html#6935870">acceptc</a></span><span class="op" id="6937926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937932"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6937933">.</span><span class="ident" id="6937934">Fatalf</span><span class="op" id="6937940">(</span><span class="string" id="6937941">&#34;for&nbsp;%v:&nbsp;server&nbsp;Accept&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6937969">,</span>&nbsp;<span class="ident" id="6937971"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6937975">,</span>&nbsp;<span class="ident" id="6937977"><a href="/net/timeout_test.go.html#6937910">err</a></span><span class="op" id="6937980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937985">case</span>&nbsp;<span class="op" id="6937990">&lt;-</span><span class="ident" id="6937992"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6937996">.</span><span class="ident" id="6937997">After</span><span class="op" id="6938002">(</span><span class="ident" id="6938003"><a href="/net/timeout_test.go.html#6937362">tooLong</a></span><span class="op" id="6938010">)</span><span class="op" id="6938011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938017"><a href="/net/timeout_test.go.html#6935649">t</a></span><span class="op" id="6938018">.</span><span class="ident" id="6938019">Fatalf</span><span class="op" id="6938025">(</span><span class="string" id="6938026">&#34;for&nbsp;%v,&nbsp;timeout&nbsp;waiting&nbsp;for&nbsp;server&nbsp;to&nbsp;finish&nbsp;writing&#34;</span><span class="op" id="6938080">,</span>&nbsp;<span class="ident" id="6938082"><a href="/net/timeout_test.go.html#6936958">name</a></span><span class="op" id="6938086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938091">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938098">}</span><br>
<span class="lineno"></span><span class="op" id="6938100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6938103">//&nbsp;TestReadDeadlineDataAvailable&nbsp;tests&nbsp;that&nbsp;read&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">525</span><span class="comment" id="6938173">//&nbsp;if&nbsp;there&#39;s&nbsp;data&nbsp;ready&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="6938210">func</span>&nbsp;<span class="ident" id="6938215">TestReadDeadlineDataAvailable</span><span class="op" id="6938244">(</span><span class="ident" id="6938245">t</span>&nbsp;<span class="op" id="6938247">*</span><span class="ident" id="6938248"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6938255">.</span><span class="ident" id="6938256">T</span><span class="op" id="6938257">)</span>&nbsp;<span class="op" id="6938259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938262">switch</span>&nbsp;<span class="ident" id="6938269"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6938276">.</span><span class="ident" id="6938277">GOOS</span>&nbsp;<span class="op" id="6938282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938285">case</span>&nbsp;<span class="string" id="6938290">&#34;plan9&#34;</span><span class="op" id="6938297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938301"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6938302">.</span><span class="ident" id="6938303">Skipf</span><span class="op" id="6938308">(</span><span class="string" id="6938309">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6938330">,</span>&nbsp;<span class="ident" id="6938332"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6938339">.</span><span class="ident" id="6938340">GOOS</span><span class="op" id="6938344">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938351">ln</span>&nbsp;<span class="op" id="6938354">:=</span>&nbsp;<span class="ident" id="6938357"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6938373">(</span><span class="ident" id="6938374"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6938375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938378">defer</span>&nbsp;<span class="ident" id="6938384"><a href="/net/timeout_test.go.html#6938351">ln</a></span><span class="op" id="6938386">.</span><span class="ident" id="6938387">Close</span><span class="op" id="6938392">(</span><span class="op" id="6938393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938397">servec</span>&nbsp;<span class="op" id="6938404">:=</span>&nbsp;<span class="builtinfunc" id="6938407">make</span><span class="op" id="6938411">(</span><span class="keyword" id="6938412">chan</span>&nbsp;<span class="ident" id="6938417"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6938424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938427">const</span>&nbsp;<span class="ident" id="6938433">msg</span>&nbsp;<span class="op" id="6938437">=</span>&nbsp;<span class="string" id="6938439">&#34;data&nbsp;client&nbsp;shouldn&#39;t&nbsp;read,&nbsp;even&nbsp;though&nbsp;it&#39;ll&nbsp;be&nbsp;waiting&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938499">go</span>&nbsp;<span class="keyword" id="6938502">func</span><span class="op" id="6938506">(</span><span class="op" id="6938507">)</span>&nbsp;<span class="op" id="6938509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938513">c</span><span class="op" id="6938514">,</span>&nbsp;<span class="ident" id="6938516">err</span>&nbsp;<span class="op" id="6938520">:=</span>&nbsp;<span class="ident" id="6938523"><a href="/net/timeout_test.go.html#6938351">ln</a></span><span class="op" id="6938525">.</span><span class="ident" id="6938526">Accept</span><span class="op" id="6938532">(</span><span class="op" id="6938533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938537">if</span>&nbsp;<span class="ident" id="6938540"><a href="/net/timeout_test.go.html#6938516">err</a></span>&nbsp;<span class="op" id="6938544">!=</span>&nbsp;<span class="ident" id="6938547">nil</span>&nbsp;<span class="op" id="6938551">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938556"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6938557">.</span><span class="ident" id="6938558">Errorf</span><span class="op" id="6938564">(</span><span class="string" id="6938565">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6938577">,</span>&nbsp;<span class="ident" id="6938579"><a href="/net/timeout_test.go.html#6938516">err</a></span><span class="op" id="6938582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938587">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938600">defer</span>&nbsp;<span class="ident" id="6938606"><a href="/net/timeout_test.go.html#6938513">c</a></span><span class="op" id="6938607">.</span><span class="ident" id="6938608">Close</span><span class="op" id="6938613">(</span><span class="op" id="6938614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938618">n</span><span class="op" id="6938619">,</span>&nbsp;<span class="ident" id="6938621"><a href="/net/timeout_test.go.html#6938516">err</a></span>&nbsp;<span class="op" id="6938625">:=</span>&nbsp;<span class="ident" id="6938628"><a href="/net/timeout_test.go.html#6938513">c</a></span><span class="op" id="6938629">.</span><span class="ident" id="6938630">Write</span><span class="op" id="6938635">(</span><span class="op" id="6938636">[</span><span class="op" id="6938637">]</span><span class="builtintype" id="6938638">byte</span><span class="op" id="6938642">(</span><span class="ident" id="6938643"><a href="/net/timeout_test.go.html#6938433">msg</a></span><span class="op" id="6938646">)</span><span class="op" id="6938647">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938651"><a href="/net/timeout_test.go.html#6938397">servec</a></span>&nbsp;<span class="op" id="6938658">&lt;-</span>&nbsp;<span class="ident" id="6938661"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6938668">{</span><span class="ident" id="6938669">n</span><span class="op" id="6938670">:</span>&nbsp;<span class="ident" id="6938672">int64</span><span class="op" id="6938677">(</span><span class="ident" id="6938678"><a href="/net/timeout_test.go.html#6938618">n</a></span><span class="op" id="6938679">)</span><span class="op" id="6938680">,</span>&nbsp;<span class="ident" id="6938682">err</span><span class="op" id="6938685">:</span>&nbsp;<span class="ident" id="6938687"><a href="/net/timeout_test.go.html#6938516">err</a></span><span class="op" id="6938690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938693">}</span><span class="op" id="6938694">(</span><span class="op" id="6938695">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938699">c</span><span class="op" id="6938700">,</span>&nbsp;<span class="ident" id="6938702">err</span>&nbsp;<span class="op" id="6938706">:=</span>&nbsp;<span class="ident" id="6938709"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6938713">(</span><span class="string" id="6938714">&#34;tcp&#34;</span><span class="op" id="6938719">,</span>&nbsp;<span class="ident" id="6938721"><a href="/net/timeout_test.go.html#6938351">ln</a></span><span class="op" id="6938723">.</span><span class="ident" id="6938724">Addr</span><span class="op" id="6938728">(</span><span class="op" id="6938729">)</span><span class="op" id="6938730">.</span><span class="ident" id="6938731">String</span><span class="op" id="6938737">(</span><span class="op" id="6938738">)</span><span class="op" id="6938739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938742">if</span>&nbsp;<span class="ident" id="6938745"><a href="/net/timeout_test.go.html#6938702">err</a></span>&nbsp;<span class="op" id="6938749">!=</span>&nbsp;<span class="ident" id="6938752">nil</span>&nbsp;<span class="op" id="6938756">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938760"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6938761">.</span><span class="ident" id="6938762">Fatalf</span><span class="op" id="6938768">(</span><span class="string" id="6938769">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6938779">,</span>&nbsp;<span class="ident" id="6938781"><a href="/net/timeout_test.go.html#6938702">err</a></span><span class="op" id="6938784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938790">defer</span>&nbsp;<span class="ident" id="6938796"><a href="/net/timeout_test.go.html#6938699">c</a></span><span class="op" id="6938797">.</span><span class="ident" id="6938798">Close</span><span class="op" id="6938803">(</span><span class="op" id="6938804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938807">if</span>&nbsp;<span class="ident" id="6938810">res</span>&nbsp;<span class="op" id="6938814">:=</span>&nbsp;<span class="op" id="6938817">&lt;-</span><span class="ident" id="6938819"><a href="/net/timeout_test.go.html#6938397">servec</a></span><span class="op" id="6938825">;</span>&nbsp;<span class="ident" id="6938827"><a href="/net/timeout_test.go.html#6938810">res</a></span><span class="op" id="6938830">.</span><span class="ident" id="6938831">err</span>&nbsp;<span class="op" id="6938835">!=</span>&nbsp;<span class="ident" id="6938838">nil</span>&nbsp;<span class="op" id="6938842">||</span>&nbsp;<span class="ident" id="6938845"><a href="/net/timeout_test.go.html#6938810">res</a></span><span class="op" id="6938848">.</span><span class="ident" id="6938849">n</span>&nbsp;<span class="op" id="6938851">!=</span>&nbsp;<span class="ident" id="6938854">int64</span><span class="op" id="6938859">(</span><span class="builtinfunc" id="6938860">len</span><span class="op" id="6938863">(</span><span class="ident" id="6938864"><a href="/net/timeout_test.go.html#6938433">msg</a></span><span class="op" id="6938867">)</span><span class="op" id="6938868">)</span>&nbsp;<span class="op" id="6938870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938874"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6938875">.</span><span class="ident" id="6938876">Fatalf</span><span class="op" id="6938882">(</span><span class="string" id="6938883">&#34;unexpected&nbsp;server&nbsp;Write:&nbsp;n=%d,&nbsp;err=%v;&nbsp;want&nbsp;n=%d,&nbsp;err=nil&#34;</span><span class="op" id="6938942">,</span>&nbsp;<span class="ident" id="6938944"><a href="/net/timeout_test.go.html#6938810">res</a></span><span class="op" id="6938947">.</span><span class="ident" id="6938948">n</span><span class="op" id="6938949">,</span>&nbsp;<span class="ident" id="6938951"><a href="/net/timeout_test.go.html#6938810">res</a></span><span class="op" id="6938954">.</span><span class="ident" id="6938955">err</span><span class="op" id="6938958">,</span>&nbsp;<span class="builtinfunc" id="6938960">len</span><span class="op" id="6938963">(</span><span class="ident" id="6938964"><a href="/net/timeout_test.go.html#6938433">msg</a></span><span class="op" id="6938967">)</span><span class="op" id="6938968">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938974"><a href="/net/timeout_test.go.html#6938699">c</a></span><span class="op" id="6938975">.</span><span class="ident" id="6938976">SetReadDeadline</span><span class="op" id="6938991">(</span><span class="ident" id="6938992"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6938996">.</span><span class="ident" id="6938997">Now</span><span class="op" id="6939000">(</span><span class="op" id="6939001">)</span><span class="op" id="6939002">.</span><span class="ident" id="6939003">Add</span><span class="op" id="6939006">(</span><span class="op" id="6939007">-</span><span class="num" id="6939008">5</span>&nbsp;<span class="op" id="6939010">*</span>&nbsp;<span class="ident" id="6939012"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6939016">.</span><span class="ident" id="6939017">Second</span><span class="op" id="6939023">)</span><span class="op" id="6939024">)</span>&nbsp;<span class="comment" id="6939026">//&nbsp;in&nbsp;the&nbsp;psat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939043">buf</span>&nbsp;<span class="op" id="6939047">:=</span>&nbsp;<span class="builtinfunc" id="6939050">make</span><span class="op" id="6939054">(</span><span class="op" id="6939055">[</span><span class="op" id="6939056">]</span><span class="builtintype" id="6939057">byte</span><span class="op" id="6939061">,</span>&nbsp;<span class="builtinfunc" id="6939063">len</span><span class="op" id="6939066">(</span><span class="ident" id="6939067"><a href="/net/timeout_test.go.html#6938433">msg</a></span><span class="op" id="6939070">)</span><span class="op" id="6939071">/</span><span class="num" id="6939072">2</span><span class="op" id="6939073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939076">n</span><span class="op" id="6939077">,</span>&nbsp;<span class="ident" id="6939079"><a href="/net/timeout_test.go.html#6938702">err</a></span>&nbsp;<span class="op" id="6939083">:=</span>&nbsp;<span class="ident" id="6939086"><a href="/net/timeout_test.go.html#6938699">c</a></span><span class="op" id="6939087">.</span><span class="ident" id="6939088">Read</span><span class="op" id="6939092">(</span><span class="ident" id="6939093"><a href="/net/timeout_test.go.html#6939043">buf</a></span><span class="op" id="6939096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939099">if</span>&nbsp;<span class="ident" id="6939102"><a href="/net/timeout_test.go.html#6939076">n</a></span>&nbsp;<span class="op" id="6939104">&gt;</span>&nbsp;<span class="num" id="6939106">0</span>&nbsp;<span class="op" id="6939108">||</span>&nbsp;<span class="op" id="6939111">!</span><span class="ident" id="6939112"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6939121">(</span><span class="ident" id="6939122"><a href="/net/timeout_test.go.html#6938702">err</a></span><span class="op" id="6939125">)</span>&nbsp;<span class="op" id="6939127">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939131"><a href="/net/timeout_test.go.html#6938245">t</a></span><span class="op" id="6939132">.</span><span class="ident" id="6939133">Fatalf</span><span class="op" id="6939139">(</span><span class="string" id="6939140">&#34;client&nbsp;read&nbsp;=&nbsp;%d&nbsp;(%q)&nbsp;err=%v;&nbsp;want&nbsp;0,&nbsp;timeout&#34;</span><span class="op" id="6939187">,</span>&nbsp;<span class="ident" id="6939189"><a href="/net/timeout_test.go.html#6939076">n</a></span><span class="op" id="6939190">,</span>&nbsp;<span class="ident" id="6939192"><a href="/net/timeout_test.go.html#6939043">buf</a></span><span class="op" id="6939195">[</span><span class="op" id="6939196">:</span><span class="ident" id="6939197"><a href="/net/timeout_test.go.html#6939076">n</a></span><span class="op" id="6939198">]</span><span class="op" id="6939199">,</span>&nbsp;<span class="ident" id="6939201"><a href="/net/timeout_test.go.html#6938702">err</a></span><span class="op" id="6939204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939207">}</span><br>
<span class="lineno"></span><span class="op" id="6939209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6939212">//&nbsp;TestWriteDeadlineBufferAvailable&nbsp;tests&nbsp;that&nbsp;write&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">565</span><span class="comment" id="6939286">//&nbsp;if&nbsp;there&#39;s&nbsp;buffer&nbsp;space&nbsp;available&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span><span class="keyword" id="6939333">func</span>&nbsp;<span class="ident" id="6939338">TestWriteDeadlineBufferAvailable</span><span class="op" id="6939370">(</span><span class="ident" id="6939371">t</span>&nbsp;<span class="op" id="6939373">*</span><span class="ident" id="6939374"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6939381">.</span><span class="ident" id="6939382">T</span><span class="op" id="6939383">)</span>&nbsp;<span class="op" id="6939385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939388">switch</span>&nbsp;<span class="ident" id="6939395"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6939402">.</span><span class="ident" id="6939403">GOOS</span>&nbsp;<span class="op" id="6939408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939411">case</span>&nbsp;<span class="string" id="6939416">&#34;plan9&#34;</span><span class="op" id="6939423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939427"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6939428">.</span><span class="ident" id="6939429">Skipf</span><span class="op" id="6939434">(</span><span class="string" id="6939435">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6939456">,</span>&nbsp;<span class="ident" id="6939458"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6939465">.</span><span class="ident" id="6939466">GOOS</span><span class="op" id="6939470">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939477">ln</span>&nbsp;<span class="op" id="6939480">:=</span>&nbsp;<span class="ident" id="6939483"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6939499">(</span><span class="ident" id="6939500"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6939501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939504">defer</span>&nbsp;<span class="ident" id="6939510"><a href="/net/timeout_test.go.html#6939477">ln</a></span><span class="op" id="6939512">.</span><span class="ident" id="6939513">Close</span><span class="op" id="6939518">(</span><span class="op" id="6939519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939523">servec</span>&nbsp;<span class="op" id="6939530">:=</span>&nbsp;<span class="builtinfunc" id="6939533">make</span><span class="op" id="6939537">(</span><span class="keyword" id="6939538">chan</span>&nbsp;<span class="ident" id="6939543"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6939550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939553">go</span>&nbsp;<span class="keyword" id="6939556">func</span><span class="op" id="6939560">(</span><span class="op" id="6939561">)</span>&nbsp;<span class="op" id="6939563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939567">c</span><span class="op" id="6939568">,</span>&nbsp;<span class="ident" id="6939570">err</span>&nbsp;<span class="op" id="6939574">:=</span>&nbsp;<span class="ident" id="6939577"><a href="/net/timeout_test.go.html#6939477">ln</a></span><span class="op" id="6939579">.</span><span class="ident" id="6939580">Accept</span><span class="op" id="6939586">(</span><span class="op" id="6939587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939591">if</span>&nbsp;<span class="ident" id="6939594"><a href="/net/timeout_test.go.html#6939570">err</a></span>&nbsp;<span class="op" id="6939598">!=</span>&nbsp;<span class="ident" id="6939601">nil</span>&nbsp;<span class="op" id="6939605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939610"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6939611">.</span><span class="ident" id="6939612">Errorf</span><span class="op" id="6939618">(</span><span class="string" id="6939619">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6939631">,</span>&nbsp;<span class="ident" id="6939633"><a href="/net/timeout_test.go.html#6939570">err</a></span><span class="op" id="6939636">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939641">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939654">defer</span>&nbsp;<span class="ident" id="6939660"><a href="/net/timeout_test.go.html#6939567">c</a></span><span class="op" id="6939661">.</span><span class="ident" id="6939662">Close</span><span class="op" id="6939667">(</span><span class="op" id="6939668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939672"><a href="/net/timeout_test.go.html#6939567">c</a></span><span class="op" id="6939673">.</span><span class="ident" id="6939674">SetWriteDeadline</span><span class="op" id="6939690">(</span><span class="ident" id="6939691"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6939695">.</span><span class="ident" id="6939696">Now</span><span class="op" id="6939699">(</span><span class="op" id="6939700">)</span><span class="op" id="6939701">.</span><span class="ident" id="6939702">Add</span><span class="op" id="6939705">(</span><span class="op" id="6939706">-</span><span class="num" id="6939707">5</span>&nbsp;<span class="op" id="6939709">*</span>&nbsp;<span class="ident" id="6939711"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6939715">.</span><span class="ident" id="6939716">Second</span><span class="op" id="6939722">)</span><span class="op" id="6939723">)</span>&nbsp;<span class="comment" id="6939725">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939742">n</span><span class="op" id="6939743">,</span>&nbsp;<span class="ident" id="6939745"><a href="/net/timeout_test.go.html#6939570">err</a></span>&nbsp;<span class="op" id="6939749">:=</span>&nbsp;<span class="ident" id="6939752"><a href="/net/timeout_test.go.html#6939567">c</a></span><span class="op" id="6939753">.</span><span class="ident" id="6939754">Write</span><span class="op" id="6939759">(</span><span class="op" id="6939760">[</span><span class="op" id="6939761">]</span><span class="builtintype" id="6939762">byte</span><span class="op" id="6939766">{</span><span class="string" id="6939767">&#39;x&#39;</span><span class="op" id="6939770">}</span><span class="op" id="6939771">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939775"><a href="/net/timeout_test.go.html#6939523">servec</a></span>&nbsp;<span class="op" id="6939782">&lt;-</span>&nbsp;<span class="ident" id="6939785"><a href="/net/timeout_test.go.html#6926385">copyRes</a></span><span class="op" id="6939792">{</span><span class="ident" id="6939793">n</span><span class="op" id="6939794">:</span>&nbsp;<span class="ident" id="6939796">int64</span><span class="op" id="6939801">(</span><span class="ident" id="6939802"><a href="/net/timeout_test.go.html#6939742">n</a></span><span class="op" id="6939803">)</span><span class="op" id="6939804">,</span>&nbsp;<span class="ident" id="6939806">err</span><span class="op" id="6939809">:</span>&nbsp;<span class="ident" id="6939811"><a href="/net/timeout_test.go.html#6939570">err</a></span><span class="op" id="6939814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939817">}</span><span class="op" id="6939818">(</span><span class="op" id="6939819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939823">c</span><span class="op" id="6939824">,</span>&nbsp;<span class="ident" id="6939826">err</span>&nbsp;<span class="op" id="6939830">:=</span>&nbsp;<span class="ident" id="6939833"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6939837">(</span><span class="string" id="6939838">&#34;tcp&#34;</span><span class="op" id="6939843">,</span>&nbsp;<span class="ident" id="6939845"><a href="/net/timeout_test.go.html#6939477">ln</a></span><span class="op" id="6939847">.</span><span class="ident" id="6939848">Addr</span><span class="op" id="6939852">(</span><span class="op" id="6939853">)</span><span class="op" id="6939854">.</span><span class="ident" id="6939855">String</span><span class="op" id="6939861">(</span><span class="op" id="6939862">)</span><span class="op" id="6939863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939866">if</span>&nbsp;<span class="ident" id="6939869"><a href="/net/timeout_test.go.html#6939826">err</a></span>&nbsp;<span class="op" id="6939873">!=</span>&nbsp;<span class="ident" id="6939876">nil</span>&nbsp;<span class="op" id="6939880">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939884"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6939885">.</span><span class="ident" id="6939886">Fatalf</span><span class="op" id="6939892">(</span><span class="string" id="6939893">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6939903">,</span>&nbsp;<span class="ident" id="6939905"><a href="/net/timeout_test.go.html#6939826">err</a></span><span class="op" id="6939908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939914">defer</span>&nbsp;<span class="ident" id="6939920"><a href="/net/timeout_test.go.html#6939823">c</a></span><span class="op" id="6939921">.</span><span class="ident" id="6939922">Close</span><span class="op" id="6939927">(</span><span class="op" id="6939928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939931">res</span>&nbsp;<span class="op" id="6939935">:=</span>&nbsp;<span class="op" id="6939938">&lt;-</span><span class="ident" id="6939940"><a href="/net/timeout_test.go.html#6939523">servec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939948">if</span>&nbsp;<span class="ident" id="6939951"><a href="/net/timeout_test.go.html#6939931">res</a></span><span class="op" id="6939954">.</span><span class="ident" id="6939955">n</span>&nbsp;<span class="op" id="6939957">!=</span>&nbsp;<span class="num" id="6939960">0</span>&nbsp;<span class="op" id="6939962">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939966"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6939967">.</span><span class="ident" id="6939968">Errorf</span><span class="op" id="6939974">(</span><span class="string" id="6939975">&#34;Write&nbsp;=&nbsp;%d;&nbsp;want&nbsp;0&#34;</span><span class="op" id="6939995">,</span>&nbsp;<span class="ident" id="6939997"><a href="/net/timeout_test.go.html#6939931">res</a></span><span class="op" id="6940000">.</span><span class="ident" id="6940001">n</span><span class="op" id="6940002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940008">if</span>&nbsp;<span class="op" id="6940011">!</span><span class="ident" id="6940012"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6940021">(</span><span class="ident" id="6940022"><a href="/net/timeout_test.go.html#6939931">res</a></span><span class="op" id="6940025">.</span><span class="ident" id="6940026">err</span><span class="op" id="6940029">)</span>&nbsp;<span class="op" id="6940031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940035"><a href="/net/timeout_test.go.html#6939371">t</a></span><span class="op" id="6940036">.</span><span class="ident" id="6940037">Errorf</span><span class="op" id="6940043">(</span><span class="string" id="6940044">&#34;Write&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="6940076">,</span>&nbsp;<span class="ident" id="6940078"><a href="/net/timeout_test.go.html#6939931">res</a></span><span class="op" id="6940081">.</span><span class="ident" id="6940082">err</span><span class="op" id="6940085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940088">}</span><br>
<span class="lineno">600</span><span class="op" id="6940090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6940093">//&nbsp;TestAcceptDeadlineConnectionAvailable&nbsp;tests&nbsp;that&nbsp;accept&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6940173">//&nbsp;if&nbsp;there&#39;s&nbsp;incoming&nbsp;connections&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="6940219">func</span>&nbsp;<span class="ident" id="6940224">TestAcceptDeadlineConnectionAvailable</span><span class="op" id="6940261">(</span><span class="ident" id="6940262">t</span>&nbsp;<span class="op" id="6940264">*</span><span class="ident" id="6940265"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6940272">.</span><span class="ident" id="6940273">T</span><span class="op" id="6940274">)</span>&nbsp;<span class="op" id="6940276">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940279">switch</span>&nbsp;<span class="ident" id="6940286"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6940293">.</span><span class="ident" id="6940294">GOOS</span>&nbsp;<span class="op" id="6940299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940302">case</span>&nbsp;<span class="string" id="6940307">&#34;plan9&#34;</span><span class="op" id="6940314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940318"><a href="/net/timeout_test.go.html#6940262">t</a></span><span class="op" id="6940319">.</span><span class="ident" id="6940320">Skipf</span><span class="op" id="6940325">(</span><span class="string" id="6940326">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6940347">,</span>&nbsp;<span class="ident" id="6940349"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6940356">.</span><span class="ident" id="6940357">GOOS</span><span class="op" id="6940361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940368">ln</span>&nbsp;<span class="op" id="6940371">:=</span>&nbsp;<span class="ident" id="6940374"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6940390">(</span><span class="ident" id="6940391"><a href="/net/timeout_test.go.html#6940262">t</a></span><span class="op" id="6940392">)</span><span class="op" id="6940393">.</span><span class="op" id="6940394">(</span><span class="op" id="6940395">*</span><span class="ident" id="6940396"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6940407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940410">defer</span>&nbsp;<span class="ident" id="6940416"><a href="/net/timeout_test.go.html#6940368">ln</a></span><span class="op" id="6940418">.</span><span class="ident" id="6940419">Close</span><span class="op" id="6940424">(</span><span class="op" id="6940425">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940429">go</span>&nbsp;<span class="keyword" id="6940432">func</span><span class="op" id="6940436">(</span><span class="op" id="6940437">)</span>&nbsp;<span class="op" id="6940439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940443">c</span><span class="op" id="6940444">,</span>&nbsp;<span class="ident" id="6940446">err</span>&nbsp;<span class="op" id="6940450">:=</span>&nbsp;<span class="ident" id="6940453"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6940457">(</span><span class="string" id="6940458">&#34;tcp&#34;</span><span class="op" id="6940463">,</span>&nbsp;<span class="ident" id="6940465"><a href="/net/timeout_test.go.html#6940368">ln</a></span><span class="op" id="6940467">.</span><span class="ident" id="6940468">Addr</span><span class="op" id="6940472">(</span><span class="op" id="6940473">)</span><span class="op" id="6940474">.</span><span class="ident" id="6940475">String</span><span class="op" id="6940481">(</span><span class="op" id="6940482">)</span><span class="op" id="6940483">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940487">if</span>&nbsp;<span class="ident" id="6940490"><a href="/net/timeout_test.go.html#6940446">err</a></span>&nbsp;<span class="op" id="6940494">!=</span>&nbsp;<span class="ident" id="6940497">nil</span>&nbsp;<span class="op" id="6940501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940506"><a href="/net/timeout_test.go.html#6940262">t</a></span><span class="op" id="6940507">.</span><span class="ident" id="6940508">Errorf</span><span class="op" id="6940514">(</span><span class="string" id="6940515">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6940525">,</span>&nbsp;<span class="ident" id="6940527"><a href="/net/timeout_test.go.html#6940446">err</a></span><span class="op" id="6940530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940535">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940548">defer</span>&nbsp;<span class="ident" id="6940554"><a href="/net/timeout_test.go.html#6940443">c</a></span><span class="op" id="6940555">.</span><span class="ident" id="6940556">Close</span><span class="op" id="6940561">(</span><span class="op" id="6940562">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940566">var</span>&nbsp;<span class="ident" id="6940570">buf</span>&nbsp;<span class="op" id="6940574">[</span><span class="num" id="6940575">1</span><span class="op" id="6940576">]</span><span class="builtintype" id="6940577">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940584"><a href="/net/timeout_test.go.html#6940443">c</a></span><span class="op" id="6940585">.</span><span class="ident" id="6940586">Read</span><span class="op" id="6940590">(</span><span class="ident" id="6940591"><a href="/net/timeout_test.go.html#6940570">buf</a></span><span class="op" id="6940594">[</span><span class="op" id="6940595">:</span><span class="op" id="6940596">]</span><span class="op" id="6940597">)</span>&nbsp;<span class="comment" id="6940599">//&nbsp;block&nbsp;until&nbsp;the&nbsp;connection&nbsp;or&nbsp;listener&nbsp;is&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940652">}</span><span class="op" id="6940653">(</span><span class="op" id="6940654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940657"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6940661">.</span><span class="ident" id="6940662">Sleep</span><span class="op" id="6940667">(</span><span class="num" id="6940668">10</span>&nbsp;<span class="op" id="6940671">*</span>&nbsp;<span class="ident" id="6940673"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6940677">.</span><span class="ident" id="6940678">Millisecond</span><span class="op" id="6940689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940692"><a href="/net/timeout_test.go.html#6940368">ln</a></span><span class="op" id="6940694">.</span><span class="ident" id="6940695">SetDeadline</span><span class="op" id="6940706">(</span><span class="ident" id="6940707"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6940711">.</span><span class="ident" id="6940712">Now</span><span class="op" id="6940715">(</span><span class="op" id="6940716">)</span><span class="op" id="6940717">.</span><span class="ident" id="6940718">Add</span><span class="op" id="6940721">(</span><span class="op" id="6940722">-</span><span class="num" id="6940723">5</span>&nbsp;<span class="op" id="6940725">*</span>&nbsp;<span class="ident" id="6940727"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6940731">.</span><span class="ident" id="6940732">Second</span><span class="op" id="6940738">)</span><span class="op" id="6940739">)</span>&nbsp;<span class="comment" id="6940741">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940757">c</span><span class="op" id="6940758">,</span>&nbsp;<span class="ident" id="6940760">err</span>&nbsp;<span class="op" id="6940764">:=</span>&nbsp;<span class="ident" id="6940767"><a href="/net/timeout_test.go.html#6940368">ln</a></span><span class="op" id="6940769">.</span><span class="ident" id="6940770">Accept</span><span class="op" id="6940776">(</span><span class="op" id="6940777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940780">if</span>&nbsp;<span class="ident" id="6940783"><a href="/net/timeout_test.go.html#6940760">err</a></span>&nbsp;<span class="op" id="6940787">==</span>&nbsp;<span class="ident" id="6940790">nil</span>&nbsp;<span class="op" id="6940794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940798">defer</span>&nbsp;<span class="ident" id="6940804"><a href="/net/timeout_test.go.html#6940757">c</a></span><span class="op" id="6940805">.</span><span class="ident" id="6940806">Close</span><span class="op" id="6940811">(</span><span class="op" id="6940812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940818">if</span>&nbsp;<span class="op" id="6940821">!</span><span class="ident" id="6940822"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6940831">(</span><span class="ident" id="6940832"><a href="/net/timeout_test.go.html#6940760">err</a></span><span class="op" id="6940835">)</span>&nbsp;<span class="op" id="6940837">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940841"><a href="/net/timeout_test.go.html#6940262">t</a></span><span class="op" id="6940842">.</span><span class="ident" id="6940843">Fatalf</span><span class="op" id="6940849">(</span><span class="string" id="6940850">&#34;Accept:&nbsp;got&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="6940880">,</span>&nbsp;<span class="ident" id="6940882"><a href="/net/timeout_test.go.html#6940760">err</a></span><span class="op" id="6940885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940888">}</span><br>
<span class="lineno"></span><span class="op" id="6940890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6940893">//&nbsp;TestConnectDeadlineInThePast&nbsp;tests&nbsp;that&nbsp;connect&nbsp;deadlines&nbsp;work,&nbsp;even</span><br>
<span class="lineno">635</span><span class="comment" id="6940965">//&nbsp;if&nbsp;the&nbsp;connection&nbsp;can&nbsp;be&nbsp;established&nbsp;w/o&nbsp;blocking.</span><br>
<span class="lineno"></span><span class="keyword" id="6941019">func</span>&nbsp;<span class="ident" id="6941024">TestConnectDeadlineInThePast</span><span class="op" id="6941052">(</span><span class="ident" id="6941053">t</span>&nbsp;<span class="op" id="6941055">*</span><span class="ident" id="6941056"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6941063">.</span><span class="ident" id="6941064">T</span><span class="op" id="6941065">)</span>&nbsp;<span class="op" id="6941067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941070">switch</span>&nbsp;<span class="ident" id="6941077"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6941084">.</span><span class="ident" id="6941085">GOOS</span>&nbsp;<span class="op" id="6941090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941093">case</span>&nbsp;<span class="string" id="6941098">&#34;plan9&#34;</span><span class="op" id="6941105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941109"><a href="/net/timeout_test.go.html#6941053">t</a></span><span class="op" id="6941110">.</span><span class="ident" id="6941111">Skipf</span><span class="op" id="6941116">(</span><span class="string" id="6941117">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6941138">,</span>&nbsp;<span class="ident" id="6941140"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6941147">.</span><span class="ident" id="6941148">GOOS</span><span class="op" id="6941152">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941159">ln</span>&nbsp;<span class="op" id="6941162">:=</span>&nbsp;<span class="ident" id="6941165"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6941181">(</span><span class="ident" id="6941182"><a href="/net/timeout_test.go.html#6941053">t</a></span><span class="op" id="6941183">)</span><span class="op" id="6941184">.</span><span class="op" id="6941185">(</span><span class="op" id="6941186">*</span><span class="ident" id="6941187"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6941198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941201">defer</span>&nbsp;<span class="ident" id="6941207"><a href="/net/timeout_test.go.html#6941159">ln</a></span><span class="op" id="6941209">.</span><span class="ident" id="6941210">Close</span><span class="op" id="6941215">(</span><span class="op" id="6941216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941220">go</span>&nbsp;<span class="keyword" id="6941223">func</span><span class="op" id="6941227">(</span><span class="op" id="6941228">)</span>&nbsp;<span class="op" id="6941230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941234">c</span><span class="op" id="6941235">,</span>&nbsp;<span class="ident" id="6941237">err</span>&nbsp;<span class="op" id="6941241">:=</span>&nbsp;<span class="ident" id="6941244"><a href="/net/timeout_test.go.html#6941159">ln</a></span><span class="op" id="6941246">.</span><span class="ident" id="6941247">Accept</span><span class="op" id="6941253">(</span><span class="op" id="6941254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941258">if</span>&nbsp;<span class="ident" id="6941261"><a href="/net/timeout_test.go.html#6941237">err</a></span>&nbsp;<span class="op" id="6941265">==</span>&nbsp;<span class="ident" id="6941268">nil</span>&nbsp;<span class="op" id="6941272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941277">defer</span>&nbsp;<span class="ident" id="6941283"><a href="/net/timeout_test.go.html#6941234">c</a></span><span class="op" id="6941284">.</span><span class="ident" id="6941285">Close</span><span class="op" id="6941290">(</span><span class="op" id="6941291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941295">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941298">}</span><span class="op" id="6941299">(</span><span class="op" id="6941300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941303"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6941307">.</span><span class="ident" id="6941308">Sleep</span><span class="op" id="6941313">(</span><span class="num" id="6941314">10</span>&nbsp;<span class="op" id="6941317">*</span>&nbsp;<span class="ident" id="6941319"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6941323">.</span><span class="ident" id="6941324">Millisecond</span><span class="op" id="6941335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941338">c</span><span class="op" id="6941339">,</span>&nbsp;<span class="ident" id="6941341">err</span>&nbsp;<span class="op" id="6941345">:=</span>&nbsp;<span class="ident" id="6941348"><a href="/net/dial.go.html#2521724">DialTimeout</a></span><span class="op" id="6941359">(</span><span class="string" id="6941360">&#34;tcp&#34;</span><span class="op" id="6941365">,</span>&nbsp;<span class="ident" id="6941367"><a href="/net/timeout_test.go.html#6941159">ln</a></span><span class="op" id="6941369">.</span><span class="ident" id="6941370">Addr</span><span class="op" id="6941374">(</span><span class="op" id="6941375">)</span><span class="op" id="6941376">.</span><span class="ident" id="6941377">String</span><span class="op" id="6941383">(</span><span class="op" id="6941384">)</span><span class="op" id="6941385">,</span>&nbsp;<span class="op" id="6941387">-</span><span class="num" id="6941388">5</span><span class="op" id="6941389">*</span><span class="ident" id="6941390"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6941394">.</span><span class="ident" id="6941395">Second</span><span class="op" id="6941401">)</span>&nbsp;<span class="comment" id="6941403">//&nbsp;in&nbsp;the&nbsp;past</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941419">if</span>&nbsp;<span class="ident" id="6941422"><a href="/net/timeout_test.go.html#6941341">err</a></span>&nbsp;<span class="op" id="6941426">==</span>&nbsp;<span class="ident" id="6941429">nil</span>&nbsp;<span class="op" id="6941433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941437">defer</span>&nbsp;<span class="ident" id="6941443"><a href="/net/timeout_test.go.html#6941338">c</a></span><span class="op" id="6941444">.</span><span class="ident" id="6941445">Close</span><span class="op" id="6941450">(</span><span class="op" id="6941451">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941457">if</span>&nbsp;<span class="op" id="6941460">!</span><span class="ident" id="6941461"><a href="/net/timeout_test.go.html#6926301">isTimeout</a></span><span class="op" id="6941470">(</span><span class="ident" id="6941471"><a href="/net/timeout_test.go.html#6941341">err</a></span><span class="op" id="6941474">)</span>&nbsp;<span class="op" id="6941476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941480"><a href="/net/timeout_test.go.html#6941053">t</a></span><span class="op" id="6941481">.</span><span class="ident" id="6941482">Fatalf</span><span class="op" id="6941488">(</span><span class="string" id="6941489">&#34;DialTimeout:&nbsp;got&nbsp;%v;&nbsp;want&nbsp;timeout&#34;</span><span class="op" id="6941524">,</span>&nbsp;<span class="ident" id="6941526"><a href="/net/timeout_test.go.html#6941341">err</a></span><span class="op" id="6941529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941532">}</span><br>
<span class="lineno"></span><span class="op" id="6941534">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="6941537">//&nbsp;TestProlongTimeout&nbsp;tests&nbsp;concurrent&nbsp;deadline&nbsp;modification.</span><br>
<span class="lineno"></span><span class="comment" id="6941599">//&nbsp;Known&nbsp;to&nbsp;cause&nbsp;data&nbsp;races&nbsp;in&nbsp;the&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="6941641">func</span>&nbsp;<span class="ident" id="6941646">TestProlongTimeout</span><span class="op" id="6941664">(</span><span class="ident" id="6941665">t</span>&nbsp;<span class="op" id="6941667">*</span><span class="ident" id="6941668"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6941675">.</span><span class="ident" id="6941676">T</span><span class="op" id="6941677">)</span>&nbsp;<span class="op" id="6941679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941682">switch</span>&nbsp;<span class="ident" id="6941689"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6941696">.</span><span class="ident" id="6941697">GOOS</span>&nbsp;<span class="op" id="6941702">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941705">case</span>&nbsp;<span class="string" id="6941710">&#34;plan9&#34;</span><span class="op" id="6941717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941721"><a href="/net/timeout_test.go.html#6941665">t</a></span><span class="op" id="6941722">.</span><span class="ident" id="6941723">Skipf</span><span class="op" id="6941728">(</span><span class="string" id="6941729">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6941750">,</span>&nbsp;<span class="ident" id="6941752"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6941759">.</span><span class="ident" id="6941760">GOOS</span><span class="op" id="6941764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941771">ln</span>&nbsp;<span class="op" id="6941774">:=</span>&nbsp;<span class="ident" id="6941777"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6941793">(</span><span class="ident" id="6941794"><a href="/net/timeout_test.go.html#6941665">t</a></span><span class="op" id="6941795">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941798">defer</span>&nbsp;<span class="ident" id="6941804"><a href="/net/timeout_test.go.html#6941771">ln</a></span><span class="op" id="6941806">.</span><span class="ident" id="6941807">Close</span><span class="op" id="6941812">(</span><span class="op" id="6941813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941816">connected</span>&nbsp;<span class="op" id="6941826">:=</span>&nbsp;<span class="builtinfunc" id="6941829">make</span><span class="op" id="6941833">(</span><span class="keyword" id="6941834">chan</span>&nbsp;<span class="builtintype" id="6941839">bool</span><span class="op" id="6941843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941846">go</span>&nbsp;<span class="keyword" id="6941849">func</span><span class="op" id="6941853">(</span><span class="op" id="6941854">)</span>&nbsp;<span class="op" id="6941856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941860">s</span><span class="op" id="6941861">,</span>&nbsp;<span class="ident" id="6941863">err</span>&nbsp;<span class="op" id="6941867">:=</span>&nbsp;<span class="ident" id="6941870"><a href="/net/timeout_test.go.html#6941771">ln</a></span><span class="op" id="6941872">.</span><span class="ident" id="6941873">Accept</span><span class="op" id="6941879">(</span><span class="op" id="6941880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941884"><a href="/net/timeout_test.go.html#6941816">connected</a></span>&nbsp;<span class="op" id="6941894">&lt;-</span>&nbsp;<span class="ident" id="6941897">true</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941904">if</span>&nbsp;<span class="ident" id="6941907"><a href="/net/timeout_test.go.html#6941863">err</a></span>&nbsp;<span class="op" id="6941911">!=</span>&nbsp;<span class="ident" id="6941914">nil</span>&nbsp;<span class="op" id="6941918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941923"><a href="/net/timeout_test.go.html#6941665">t</a></span><span class="op" id="6941924">.</span><span class="ident" id="6941925">Errorf</span><span class="op" id="6941931">(</span><span class="string" id="6941932">&#34;ln.Accept:&nbsp;%v&#34;</span><span class="op" id="6941947">,</span>&nbsp;<span class="ident" id="6941949"><a href="/net/timeout_test.go.html#6941863">err</a></span><span class="op" id="6941952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941957">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941970">defer</span>&nbsp;<span class="ident" id="6941976"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6941977">.</span><span class="ident" id="6941978">Close</span><span class="op" id="6941983">(</span><span class="op" id="6941984">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941988"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6941989">.</span><span class="ident" id="6941990">SetDeadline</span><span class="op" id="6942001">(</span><span class="ident" id="6942002"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942006">.</span><span class="ident" id="6942007">Now</span><span class="op" id="6942010">(</span><span class="op" id="6942011">)</span><span class="op" id="6942012">.</span><span class="ident" id="6942013">Add</span><span class="op" id="6942016">(</span><span class="ident" id="6942017"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942021">.</span><span class="ident" id="6942022">Hour</span><span class="op" id="6942026">)</span><span class="op" id="6942027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942031">go</span>&nbsp;<span class="keyword" id="6942034">func</span><span class="op" id="6942038">(</span><span class="op" id="6942039">)</span>&nbsp;<span class="op" id="6942041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942046">var</span>&nbsp;<span class="ident" id="6942050">buf</span>&nbsp;<span class="op" id="6942054">[</span><span class="num" id="6942055">4096</span><span class="op" id="6942059">]</span><span class="builtintype" id="6942060">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942068">for</span>&nbsp;<span class="op" id="6942072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942078">_</span><span class="op" id="6942079">,</span>&nbsp;<span class="ident" id="6942081">err</span>&nbsp;<span class="op" id="6942085">:=</span>&nbsp;<span class="ident" id="6942088"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6942089">.</span><span class="ident" id="6942090">Write</span><span class="op" id="6942095">(</span><span class="ident" id="6942096"><a href="/net/timeout_test.go.html#6942050">buf</a></span><span class="op" id="6942099">[</span><span class="op" id="6942100">:</span><span class="op" id="6942101">]</span><span class="op" id="6942102">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942108">if</span>&nbsp;<span class="ident" id="6942111"><a href="/net/timeout_test.go.html#6942081">err</a></span>&nbsp;<span class="op" id="6942115">!=</span>&nbsp;<span class="ident" id="6942118">nil</span>&nbsp;<span class="op" id="6942122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942129">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942145"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6942146">.</span><span class="ident" id="6942147">SetDeadline</span><span class="op" id="6942158">(</span><span class="ident" id="6942159"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942163">.</span><span class="ident" id="6942164">Now</span><span class="op" id="6942167">(</span><span class="op" id="6942168">)</span><span class="op" id="6942169">.</span><span class="ident" id="6942170">Add</span><span class="op" id="6942173">(</span><span class="ident" id="6942174"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942178">.</span><span class="ident" id="6942179">Hour</span><span class="op" id="6942183">)</span><span class="op" id="6942184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942189">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942193">}</span><span class="op" id="6942194">(</span><span class="op" id="6942195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942199">buf</span>&nbsp;<span class="op" id="6942203">:=</span>&nbsp;<span class="builtinfunc" id="6942206">make</span><span class="op" id="6942210">(</span><span class="op" id="6942211">[</span><span class="op" id="6942212">]</span><span class="builtintype" id="6942213">byte</span><span class="op" id="6942217">,</span>&nbsp;<span class="num" id="6942219">1</span><span class="op" id="6942220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942224">for</span>&nbsp;<span class="op" id="6942228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942233">_</span><span class="op" id="6942234">,</span>&nbsp;<span class="ident" id="6942236">err</span>&nbsp;<span class="op" id="6942240">:=</span>&nbsp;<span class="ident" id="6942243"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6942244">.</span><span class="ident" id="6942245">Read</span><span class="op" id="6942249">(</span><span class="ident" id="6942250"><a href="/net/timeout_test.go.html#6942199">buf</a></span><span class="op" id="6942253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942258">if</span>&nbsp;<span class="ident" id="6942261"><a href="/net/timeout_test.go.html#6942236">err</a></span>&nbsp;<span class="op" id="6942265">!=</span>&nbsp;<span class="ident" id="6942268">nil</span>&nbsp;<span class="op" id="6942272">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942278">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942292"><a href="/net/timeout_test.go.html#6941860">s</a></span><span class="op" id="6942293">.</span><span class="ident" id="6942294">SetDeadline</span><span class="op" id="6942305">(</span><span class="ident" id="6942306"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942310">.</span><span class="ident" id="6942311">Now</span><span class="op" id="6942314">(</span><span class="op" id="6942315">)</span><span class="op" id="6942316">.</span><span class="ident" id="6942317">Add</span><span class="op" id="6942320">(</span><span class="ident" id="6942321"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942325">.</span><span class="ident" id="6942326">Hour</span><span class="op" id="6942330">)</span><span class="op" id="6942331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942338">}</span><span class="op" id="6942339">(</span><span class="op" id="6942340">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942343">c</span><span class="op" id="6942344">,</span>&nbsp;<span class="ident" id="6942346">err</span>&nbsp;<span class="op" id="6942350">:=</span>&nbsp;<span class="ident" id="6942353"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6942357">(</span><span class="string" id="6942358">&#34;tcp&#34;</span><span class="op" id="6942363">,</span>&nbsp;<span class="ident" id="6942365"><a href="/net/timeout_test.go.html#6941771">ln</a></span><span class="op" id="6942367">.</span><span class="ident" id="6942368">Addr</span><span class="op" id="6942372">(</span><span class="op" id="6942373">)</span><span class="op" id="6942374">.</span><span class="ident" id="6942375">String</span><span class="op" id="6942381">(</span><span class="op" id="6942382">)</span><span class="op" id="6942383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942386">if</span>&nbsp;<span class="ident" id="6942389"><a href="/net/timeout_test.go.html#6942346">err</a></span>&nbsp;<span class="op" id="6942393">!=</span>&nbsp;<span class="ident" id="6942396">nil</span>&nbsp;<span class="op" id="6942400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942404"><a href="/net/timeout_test.go.html#6941665">t</a></span><span class="op" id="6942405">.</span><span class="ident" id="6942406">Fatalf</span><span class="op" id="6942412">(</span><span class="string" id="6942413">&#34;DialTCP:&nbsp;%v&#34;</span><span class="op" id="6942426">,</span>&nbsp;<span class="ident" id="6942428"><a href="/net/timeout_test.go.html#6942346">err</a></span><span class="op" id="6942431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942437">defer</span>&nbsp;<span class="ident" id="6942443"><a href="/net/timeout_test.go.html#6942343">c</a></span><span class="op" id="6942444">.</span><span class="ident" id="6942445">Close</span><span class="op" id="6942450">(</span><span class="op" id="6942451">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942454">&lt;-</span><span class="ident" id="6942456"><a href="/net/timeout_test.go.html#6941816">connected</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942467">for</span>&nbsp;<span class="ident" id="6942471">i</span>&nbsp;<span class="op" id="6942473">:=</span>&nbsp;<span class="num" id="6942476">0</span><span class="op" id="6942477">;</span>&nbsp;<span class="ident" id="6942479"><a href="/net/timeout_test.go.html#6942471">i</a></span>&nbsp;<span class="op" id="6942481">&lt;</span>&nbsp;<span class="num" id="6942483">1024</span><span class="op" id="6942487">;</span>&nbsp;<span class="ident" id="6942489"><a href="/net/timeout_test.go.html#6942471">i</a></span><span class="op" id="6942490">++</span>&nbsp;<span class="op" id="6942493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942497">var</span>&nbsp;<span class="ident" id="6942501">buf</span>&nbsp;<span class="op" id="6942505">[</span><span class="num" id="6942506">1</span><span class="op" id="6942507">]</span><span class="builtintype" id="6942508">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942515"><a href="/net/timeout_test.go.html#6942343">c</a></span><span class="op" id="6942516">.</span><span class="ident" id="6942517">Write</span><span class="op" id="6942522">(</span><span class="ident" id="6942523"><a href="/net/timeout_test.go.html#6942501">buf</a></span><span class="op" id="6942526">[</span><span class="op" id="6942527">:</span><span class="op" id="6942528">]</span><span class="op" id="6942529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942532">}</span><br>
<span class="lineno">710</span><span class="op" id="6942534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6942537">func</span>&nbsp;<span class="ident" id="6942542">TestDeadlineRace</span><span class="op" id="6942558">(</span><span class="ident" id="6942559">t</span>&nbsp;<span class="op" id="6942561">*</span><span class="ident" id="6942562"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6942569">.</span><span class="ident" id="6942570">T</span><span class="op" id="6942571">)</span>&nbsp;<span class="op" id="6942573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942576">switch</span>&nbsp;<span class="ident" id="6942583"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6942590">.</span><span class="ident" id="6942591">GOOS</span>&nbsp;<span class="op" id="6942596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942599">case</span>&nbsp;<span class="string" id="6942604">&#34;nacl&#34;</span><span class="op" id="6942610">,</span>&nbsp;<span class="string" id="6942612">&#34;plan9&#34;</span><span class="op" id="6942619">:</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942623"><a href="/net/timeout_test.go.html#6942559">t</a></span><span class="op" id="6942624">.</span><span class="ident" id="6942625">Skipf</span><span class="op" id="6942630">(</span><span class="string" id="6942631">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6942652">,</span>&nbsp;<span class="ident" id="6942654"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6942661">.</span><span class="ident" id="6942662">GOOS</span><span class="op" id="6942666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942673">N</span>&nbsp;<span class="op" id="6942675">:=</span>&nbsp;<span class="num" id="6942678">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942684">if</span>&nbsp;<span class="ident" id="6942687"><a href="/net/timeout_test.go.html#6926275">testing</a></span><span class="op" id="6942694">.</span><span class="ident" id="6942695">Short</span><span class="op" id="6942700">(</span><span class="op" id="6942701">)</span>&nbsp;<span class="op" id="6942703">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942707"><a href="/net/timeout_test.go.html#6942673">N</a></span>&nbsp;<span class="op" id="6942709">=</span>&nbsp;<span class="num" id="6942711">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942718">defer</span>&nbsp;<span class="ident" id="6942724"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6942731">.</span><span class="ident" id="6942732">GOMAXPROCS</span><span class="op" id="6942742">(</span><span class="ident" id="6942743"><a href="/net/timeout_test.go.html#6926264">runtime</a></span><span class="op" id="6942750">.</span><span class="ident" id="6942751">GOMAXPROCS</span><span class="op" id="6942761">(</span><span class="num" id="6942762">4</span><span class="op" id="6942763">)</span><span class="op" id="6942764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942767">ln</span>&nbsp;<span class="op" id="6942770">:=</span>&nbsp;<span class="ident" id="6942773"><a href="/net/dial_test.go.html#6770151">newLocalListener</a></span><span class="op" id="6942789">(</span><span class="ident" id="6942790"><a href="/net/timeout_test.go.html#6942559">t</a></span><span class="op" id="6942791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942794">defer</span>&nbsp;<span class="ident" id="6942800"><a href="/net/timeout_test.go.html#6942767">ln</a></span><span class="op" id="6942802">.</span><span class="ident" id="6942803">Close</span><span class="op" id="6942808">(</span><span class="op" id="6942809">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942812">c</span><span class="op" id="6942813">,</span>&nbsp;<span class="ident" id="6942815">err</span>&nbsp;<span class="op" id="6942819">:=</span>&nbsp;<span class="ident" id="6942822"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6942826">(</span><span class="string" id="6942827">&#34;tcp&#34;</span><span class="op" id="6942832">,</span>&nbsp;<span class="ident" id="6942834"><a href="/net/timeout_test.go.html#6942767">ln</a></span><span class="op" id="6942836">.</span><span class="ident" id="6942837">Addr</span><span class="op" id="6942841">(</span><span class="op" id="6942842">)</span><span class="op" id="6942843">.</span><span class="ident" id="6942844">String</span><span class="op" id="6942850">(</span><span class="op" id="6942851">)</span><span class="op" id="6942852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942855">if</span>&nbsp;<span class="ident" id="6942858"><a href="/net/timeout_test.go.html#6942815">err</a></span>&nbsp;<span class="op" id="6942862">!=</span>&nbsp;<span class="ident" id="6942865">nil</span>&nbsp;<span class="op" id="6942869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942873"><a href="/net/timeout_test.go.html#6942559">t</a></span><span class="op" id="6942874">.</span><span class="ident" id="6942875">Fatalf</span><span class="op" id="6942881">(</span><span class="string" id="6942882">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6942892">,</span>&nbsp;<span class="ident" id="6942894"><a href="/net/timeout_test.go.html#6942815">err</a></span><span class="op" id="6942897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942903">defer</span>&nbsp;<span class="ident" id="6942909"><a href="/net/timeout_test.go.html#6942812">c</a></span><span class="op" id="6942910">.</span><span class="ident" id="6942911">Close</span><span class="op" id="6942916">(</span><span class="op" id="6942917">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942920">done</span>&nbsp;<span class="op" id="6942925">:=</span>&nbsp;<span class="builtinfunc" id="6942928">make</span><span class="op" id="6942932">(</span><span class="keyword" id="6942933">chan</span>&nbsp;<span class="builtintype" id="6942938">bool</span><span class="op" id="6942942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942945">go</span>&nbsp;<span class="keyword" id="6942948">func</span><span class="op" id="6942952">(</span><span class="op" id="6942953">)</span>&nbsp;<span class="op" id="6942955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942959">t</span>&nbsp;<span class="op" id="6942961">:=</span>&nbsp;<span class="ident" id="6942964"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942968">.</span><span class="ident" id="6942969">NewTicker</span><span class="op" id="6942978">(</span><span class="num" id="6942979">2</span>&nbsp;<span class="op" id="6942981">*</span>&nbsp;<span class="ident" id="6942983"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6942987">.</span><span class="ident" id="6942988">Microsecond</span><span class="op" id="6942999">)</span><span class="op" id="6943000">.</span><span class="ident" id="6943001">C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943005">for</span>&nbsp;<span class="ident" id="6943009">i</span>&nbsp;<span class="op" id="6943011">:=</span>&nbsp;<span class="num" id="6943014">0</span><span class="op" id="6943015">;</span>&nbsp;<span class="ident" id="6943017"><a href="/net/timeout_test.go.html#6943009">i</a></span>&nbsp;<span class="op" id="6943019">&lt;</span>&nbsp;<span class="ident" id="6943021"><a href="/net/timeout_test.go.html#6942673">N</a></span><span class="op" id="6943022">;</span>&nbsp;<span class="ident" id="6943024"><a href="/net/timeout_test.go.html#6943009">i</a></span><span class="op" id="6943025">++</span>&nbsp;<span class="op" id="6943028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943033">if</span>&nbsp;<span class="ident" id="6943036">err</span>&nbsp;<span class="op" id="6943040">:=</span>&nbsp;<span class="ident" id="6943043"><a href="/net/timeout_test.go.html#6942812">c</a></span><span class="op" id="6943044">.</span><span class="ident" id="6943045">SetDeadline</span><span class="op" id="6943056">(</span><span class="ident" id="6943057"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6943061">.</span><span class="ident" id="6943062">Now</span><span class="op" id="6943065">(</span><span class="op" id="6943066">)</span><span class="op" id="6943067">.</span><span class="ident" id="6943068">Add</span><span class="op" id="6943071">(</span><span class="num" id="6943072">2</span>&nbsp;<span class="op" id="6943074">*</span>&nbsp;<span class="ident" id="6943076"><a href="/net/timeout_test.go.html#6926286">time</a></span><span class="op" id="6943080">.</span><span class="ident" id="6943081">Microsecond</span><span class="op" id="6943092">)</span><span class="op" id="6943093">)</span><span class="op" id="6943094">;</span>&nbsp;<span class="ident" id="6943096"><a href="/net/timeout_test.go.html#6943036">err</a></span>&nbsp;<span class="op" id="6943100">!=</span>&nbsp;<span class="ident" id="6943103">nil</span>&nbsp;<span class="op" id="6943107">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943113">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943127">&lt;-</span><span class="ident" id="6943129"><a href="/net/timeout_test.go.html#6942959">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943137"><a href="/net/timeout_test.go.html#6942920">done</a></span>&nbsp;<span class="op" id="6943142">&lt;-</span>&nbsp;<span class="ident" id="6943145">true</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943151">}</span><span class="op" id="6943152">(</span><span class="op" id="6943153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943156">var</span>&nbsp;<span class="ident" id="6943160">buf</span>&nbsp;<span class="op" id="6943164">[</span><span class="num" id="6943165">1</span><span class="op" id="6943166">]</span><span class="builtintype" id="6943167">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943173">for</span>&nbsp;<span class="ident" id="6943177">i</span>&nbsp;<span class="op" id="6943179">:=</span>&nbsp;<span class="num" id="6943182">0</span><span class="op" id="6943183">;</span>&nbsp;<span class="ident" id="6943185"><a href="/net/timeout_test.go.html#6943177">i</a></span>&nbsp;<span class="op" id="6943187">&lt;</span>&nbsp;<span class="ident" id="6943189"><a href="/net/timeout_test.go.html#6942673">N</a></span><span class="op" id="6943190">;</span>&nbsp;<span class="ident" id="6943192"><a href="/net/timeout_test.go.html#6943177">i</a></span><span class="op" id="6943193">++</span>&nbsp;<span class="op" id="6943196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943200"><a href="/net/timeout_test.go.html#6942812">c</a></span><span class="op" id="6943201">.</span><span class="ident" id="6943202">Read</span><span class="op" id="6943206">(</span><span class="ident" id="6943207"><a href="/net/timeout_test.go.html#6943160">buf</a></span><span class="op" id="6943210">[</span><span class="op" id="6943211">:</span><span class="op" id="6943212">]</span><span class="op" id="6943213">)</span>&nbsp;<span class="comment" id="6943215">//&nbsp;ignore&nbsp;possible&nbsp;timeout&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943250">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943253"><a href="/net/timeout_test.go.html#6942812">c</a></span><span class="op" id="6943254">.</span><span class="ident" id="6943255">Close</span><span class="op" id="6943260">(</span><span class="op" id="6943261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943264">&lt;-</span><span class="ident" id="6943266"><a href="/net/timeout_test.go.html#6942920">done</a></span><br>
<span class="lineno"></span><span class="op" id="6943271">}</span>
</div>
</body>
</html>
