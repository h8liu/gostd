<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6343300">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6343356">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6343410">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6343461">package</span>&nbsp;<span class="ident" id="6343469">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6343476">import</span>&nbsp;<span class="op" id="6343483">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6343486">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6343497">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6343505">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6343512">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6343515">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="6343580">type</span>&nbsp;<span class="ident" id="6343585">GCStats</span>&nbsp;<span class="keyword" id="6343593">struct</span>&nbsp;<span class="op" id="6343600">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343603">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343618">time</span><span class="op" id="6343622">.</span><span class="ident" id="6343623">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6343634">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343662">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343677">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6343693">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343727">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6343742">time</span><span class="op" id="6343746">.</span><span class="ident" id="6343747">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6343758">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343794">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6343809">[</span><span class="op" id="6343810">]</span><span class="ident" id="6343811">time</span><span class="op" id="6343815">.</span><span class="ident" id="6343816">Duration</span>&nbsp;<span class="comment" id="6343825">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343862">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6343877">[</span><span class="op" id="6343878">]</span><span class="ident" id="6343879">time</span><span class="op" id="6343883">.</span><span class="ident" id="6343884">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6343893">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6343940">PauseQuantiles</span>&nbsp;<span class="op" id="6343955">[</span><span class="op" id="6343956">]</span><span class="ident" id="6343957">time</span><span class="op" id="6343961">.</span><span class="ident" id="6343962">Duration</span><br>
<span class="lineno"></span><span class="op" id="6343971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6343974">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="6344043">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="6344110">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="6344186">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="6344253">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="6344330">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6344393">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="6344464">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="6344507">func</span>&nbsp;<span class="ident" id="6344512">ReadGCStats</span><span class="op" id="6344523">(</span><span class="ident" id="6344524">stats</span>&nbsp;<span class="op" id="6344530">*</span><span class="ident" id="6344531">GCStats</span><span class="op" id="6344538">)</span>&nbsp;<span class="op" id="6344540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344543">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344605">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344668">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344732">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344788">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344813">const</span>&nbsp;<span class="ident" id="6344819">maxPause</span>&nbsp;<span class="op" id="6344828">=</span>&nbsp;<span class="builtinfunc" id="6344830">len</span><span class="op" id="6344833">(</span><span class="op" id="6344834">(</span><span class="op" id="6344835">(</span><span class="op" id="6344836">*</span><span class="ident" id="6344837">runtime</span><span class="op" id="6344844">.</span><span class="ident" id="6344845">MemStats</span><span class="op" id="6344853">)</span><span class="op" id="6344854">(</span><span class="ident" id="6344855">nil</span><span class="op" id="6344858">)</span><span class="op" id="6344859">)</span><span class="op" id="6344860">.</span><span class="ident" id="6344861">PauseNs</span><span class="op" id="6344868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6344871">if</span>&nbsp;<span class="builtinfunc" id="6344874">cap</span><span class="op" id="6344877">(</span><span class="ident" id="6344878">stats</span><span class="op" id="6344883">.</span><span class="ident" id="6344884">Pause</span><span class="op" id="6344889">)</span>&nbsp;<span class="op" id="6344891">&lt;</span>&nbsp;<span class="num" id="6344893">2</span><span class="op" id="6344894">*</span><span class="ident" id="6344895">maxPause</span><span class="op" id="6344903">+</span><span class="num" id="6344904">3</span>&nbsp;<span class="op" id="6344906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6344910">stats</span><span class="op" id="6344915">.</span><span class="ident" id="6344916">Pause</span>&nbsp;<span class="op" id="6344922">=</span>&nbsp;<span class="builtinfunc" id="6344924">make</span><span class="op" id="6344928">(</span><span class="op" id="6344929">[</span><span class="op" id="6344930">]</span><span class="ident" id="6344931">time</span><span class="op" id="6344935">.</span><span class="ident" id="6344936">Duration</span><span class="op" id="6344944">,</span>&nbsp;<span class="num" id="6344946">2</span><span class="op" id="6344947">*</span><span class="ident" id="6344948">maxPause</span><span class="op" id="6344956">+</span><span class="num" id="6344957">3</span><span class="op" id="6344958">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6344961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6344965">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345031">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345099">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345162">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345221">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345289">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345309">readGCStats</span><span class="op" id="6345320">(</span><span class="op" id="6345321">&amp;</span><span class="ident" id="6345322">stats</span><span class="op" id="6345327">.</span><span class="ident" id="6345328">Pause</span><span class="op" id="6345333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345336">n</span>&nbsp;<span class="op" id="6345338">:=</span>&nbsp;<span class="builtinfunc" id="6345341">len</span><span class="op" id="6345344">(</span><span class="ident" id="6345345">stats</span><span class="op" id="6345350">.</span><span class="ident" id="6345351">Pause</span><span class="op" id="6345356">)</span>&nbsp;<span class="op" id="6345358">-</span>&nbsp;<span class="num" id="6345360">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345363">stats</span><span class="op" id="6345368">.</span><span class="ident" id="6345369">LastGC</span>&nbsp;<span class="op" id="6345376">=</span>&nbsp;<span class="ident" id="6345378">time</span><span class="op" id="6345382">.</span><span class="ident" id="6345383">Unix</span><span class="op" id="6345387">(</span><span class="num" id="6345388">0</span><span class="op" id="6345389">,</span>&nbsp;<span class="ident" id="6345391">int64</span><span class="op" id="6345396">(</span><span class="ident" id="6345397">stats</span><span class="op" id="6345402">.</span><span class="ident" id="6345403">Pause</span><span class="op" id="6345408">[</span><span class="ident" id="6345409">n</span><span class="op" id="6345410">]</span><span class="op" id="6345411">)</span><span class="op" id="6345412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345415">stats</span><span class="op" id="6345420">.</span><span class="ident" id="6345421">NumGC</span>&nbsp;<span class="op" id="6345427">=</span>&nbsp;<span class="ident" id="6345429">int64</span><span class="op" id="6345434">(</span><span class="ident" id="6345435">stats</span><span class="op" id="6345440">.</span><span class="ident" id="6345441">Pause</span><span class="op" id="6345446">[</span><span class="ident" id="6345447">n</span><span class="op" id="6345448">+</span><span class="num" id="6345449">1</span><span class="op" id="6345450">]</span><span class="op" id="6345451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345454">stats</span><span class="op" id="6345459">.</span><span class="ident" id="6345460">PauseTotal</span>&nbsp;<span class="op" id="6345471">=</span>&nbsp;<span class="ident" id="6345473">stats</span><span class="op" id="6345478">.</span><span class="ident" id="6345479">Pause</span><span class="op" id="6345484">[</span><span class="ident" id="6345485">n</span><span class="op" id="6345486">+</span><span class="num" id="6345487">2</span><span class="op" id="6345488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345491">n</span>&nbsp;<span class="op" id="6345493">/=</span>&nbsp;<span class="num" id="6345496">2</span>&nbsp;<span class="comment" id="6345498">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345536">stats</span><span class="op" id="6345541">.</span><span class="ident" id="6345542">Pause</span>&nbsp;<span class="op" id="6345548">=</span>&nbsp;<span class="ident" id="6345550">stats</span><span class="op" id="6345555">.</span><span class="ident" id="6345556">Pause</span><span class="op" id="6345561">[</span><span class="op" id="6345562">:</span><span class="ident" id="6345563">n</span><span class="op" id="6345564">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345568">if</span>&nbsp;<span class="builtinfunc" id="6345571">cap</span><span class="op" id="6345574">(</span><span class="ident" id="6345575">stats</span><span class="op" id="6345580">.</span><span class="ident" id="6345581">PauseEnd</span><span class="op" id="6345589">)</span>&nbsp;<span class="op" id="6345591">&lt;</span>&nbsp;<span class="ident" id="6345593">maxPause</span>&nbsp;<span class="op" id="6345602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345606">stats</span><span class="op" id="6345611">.</span><span class="ident" id="6345612">PauseEnd</span>&nbsp;<span class="op" id="6345621">=</span>&nbsp;<span class="builtinfunc" id="6345623">make</span><span class="op" id="6345627">(</span><span class="op" id="6345628">[</span><span class="op" id="6345629">]</span><span class="ident" id="6345630">time</span><span class="op" id="6345634">.</span><span class="ident" id="6345635">Time</span><span class="op" id="6345639">,</span>&nbsp;<span class="num" id="6345641">0</span><span class="op" id="6345642">,</span>&nbsp;<span class="ident" id="6345644">maxPause</span><span class="op" id="6345652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345658">stats</span><span class="op" id="6345663">.</span><span class="ident" id="6345664">PauseEnd</span>&nbsp;<span class="op" id="6345673">=</span>&nbsp;<span class="ident" id="6345675">stats</span><span class="op" id="6345680">.</span><span class="ident" id="6345681">PauseEnd</span><span class="op" id="6345689">[</span><span class="op" id="6345690">:</span><span class="num" id="6345691">0</span><span class="op" id="6345692">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345695">for</span>&nbsp;<span class="ident" id="6345699">_</span><span class="op" id="6345700">,</span>&nbsp;<span class="ident" id="6345702">ns</span>&nbsp;<span class="op" id="6345705">:=</span>&nbsp;<span class="keyword" id="6345708">range</span>&nbsp;<span class="ident" id="6345714">stats</span><span class="op" id="6345719">.</span><span class="ident" id="6345720">Pause</span><span class="op" id="6345725">[</span><span class="ident" id="6345726">n</span>&nbsp;<span class="op" id="6345728">:</span>&nbsp;<span class="ident" id="6345730">n</span><span class="op" id="6345731">+</span><span class="ident" id="6345732">n</span><span class="op" id="6345733">]</span>&nbsp;<span class="op" id="6345735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345739">stats</span><span class="op" id="6345744">.</span><span class="ident" id="6345745">PauseEnd</span>&nbsp;<span class="op" id="6345754">=</span>&nbsp;<span class="builtinfunc" id="6345756">append</span><span class="op" id="6345762">(</span><span class="ident" id="6345763">stats</span><span class="op" id="6345768">.</span><span class="ident" id="6345769">PauseEnd</span><span class="op" id="6345777">,</span>&nbsp;<span class="ident" id="6345779">time</span><span class="op" id="6345783">.</span><span class="ident" id="6345784">Unix</span><span class="op" id="6345788">(</span><span class="num" id="6345789">0</span><span class="op" id="6345790">,</span>&nbsp;<span class="ident" id="6345792">int64</span><span class="op" id="6345797">(</span><span class="ident" id="6345798">ns</span><span class="op" id="6345800">)</span><span class="op" id="6345801">)</span><span class="op" id="6345802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345809">if</span>&nbsp;<span class="builtinfunc" id="6345812">len</span><span class="op" id="6345815">(</span><span class="ident" id="6345816">stats</span><span class="op" id="6345821">.</span><span class="ident" id="6345822">PauseQuantiles</span><span class="op" id="6345836">)</span>&nbsp;<span class="op" id="6345838">&gt;</span>&nbsp;<span class="num" id="6345840">0</span>&nbsp;<span class="op" id="6345842">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345846">if</span>&nbsp;<span class="ident" id="6345849">n</span>&nbsp;<span class="op" id="6345851">==</span>&nbsp;<span class="num" id="6345854">0</span>&nbsp;<span class="op" id="6345856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345861">for</span>&nbsp;<span class="ident" id="6345865">i</span>&nbsp;<span class="op" id="6345867">:=</span>&nbsp;<span class="keyword" id="6345870">range</span>&nbsp;<span class="ident" id="6345876">stats</span><span class="op" id="6345881">.</span><span class="ident" id="6345882">PauseQuantiles</span>&nbsp;<span class="op" id="6345897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345903">stats</span><span class="op" id="6345908">.</span><span class="ident" id="6345909">PauseQuantiles</span><span class="op" id="6345923">[</span><span class="ident" id="6345924">i</span><span class="op" id="6345925">]</span>&nbsp;<span class="op" id="6345927">=</span>&nbsp;<span class="num" id="6345929">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345938">}</span>&nbsp;<span class="keyword" id="6345940">else</span>&nbsp;<span class="op" id="6345945">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6345950">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6346015">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346068">sorted</span>&nbsp;<span class="op" id="6346075">:=</span>&nbsp;<span class="ident" id="6346078">stats</span><span class="op" id="6346083">.</span><span class="ident" id="6346084">Pause</span><span class="op" id="6346089">[</span><span class="ident" id="6346090">n</span>&nbsp;<span class="op" id="6346092">:</span>&nbsp;<span class="ident" id="6346094">n</span><span class="op" id="6346095">+</span><span class="ident" id="6346096">n</span><span class="op" id="6346097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6346102">copy</span><span class="op" id="6346106">(</span><span class="ident" id="6346107">sorted</span><span class="op" id="6346113">,</span>&nbsp;<span class="ident" id="6346115">stats</span><span class="op" id="6346120">.</span><span class="ident" id="6346121">Pause</span><span class="op" id="6346126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346131">sort</span><span class="op" id="6346135">.</span><span class="ident" id="6346136">Sort</span><span class="op" id="6346140">(</span><span class="ident" id="6346141">byDuration</span><span class="op" id="6346151">(</span><span class="ident" id="6346152">sorted</span><span class="op" id="6346158">)</span><span class="op" id="6346159">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346164">nq</span>&nbsp;<span class="op" id="6346167">:=</span>&nbsp;<span class="builtinfunc" id="6346170">len</span><span class="op" id="6346173">(</span><span class="ident" id="6346174">stats</span><span class="op" id="6346179">.</span><span class="ident" id="6346180">PauseQuantiles</span><span class="op" id="6346194">)</span>&nbsp;<span class="op" id="6346196">-</span>&nbsp;<span class="num" id="6346198">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346203">for</span>&nbsp;<span class="ident" id="6346207">i</span>&nbsp;<span class="op" id="6346209">:=</span>&nbsp;<span class="num" id="6346212">0</span><span class="op" id="6346213">;</span>&nbsp;<span class="ident" id="6346215">i</span>&nbsp;<span class="op" id="6346217">&lt;</span>&nbsp;<span class="ident" id="6346219">nq</span><span class="op" id="6346221">;</span>&nbsp;<span class="ident" id="6346223">i</span><span class="op" id="6346224">++</span>&nbsp;<span class="op" id="6346227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346233">stats</span><span class="op" id="6346238">.</span><span class="ident" id="6346239">PauseQuantiles</span><span class="op" id="6346253">[</span><span class="ident" id="6346254">i</span><span class="op" id="6346255">]</span>&nbsp;<span class="op" id="6346257">=</span>&nbsp;<span class="ident" id="6346259">sorted</span><span class="op" id="6346265">[</span><span class="builtinfunc" id="6346266">len</span><span class="op" id="6346269">(</span><span class="ident" id="6346270">sorted</span><span class="op" id="6346276">)</span><span class="op" id="6346277">*</span><span class="ident" id="6346278">i</span><span class="op" id="6346279">/</span><span class="ident" id="6346280">nq</span><span class="op" id="6346282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346292">stats</span><span class="op" id="6346297">.</span><span class="ident" id="6346298">PauseQuantiles</span><span class="op" id="6346312">[</span><span class="ident" id="6346313">nq</span><span class="op" id="6346315">]</span>&nbsp;<span class="op" id="6346317">=</span>&nbsp;<span class="ident" id="6346319">sorted</span><span class="op" id="6346325">[</span><span class="builtinfunc" id="6346326">len</span><span class="op" id="6346329">(</span><span class="ident" id="6346330">sorted</span><span class="op" id="6346336">)</span><span class="op" id="6346337">-</span><span class="num" id="6346338">1</span><span class="op" id="6346339">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346346">}</span><br>
<span class="lineno"></span><span class="op" id="6346348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346351">type</span>&nbsp;<span class="ident" id="6346356">byDuration</span>&nbsp;<span class="op" id="6346367">[</span><span class="op" id="6346368">]</span><span class="ident" id="6346369">time</span><span class="op" id="6346373">.</span><span class="ident" id="6346374">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6346384">func</span>&nbsp;<span class="op" id="6346389">(</span><span class="ident" id="6346390">x</span>&nbsp;<span class="ident" id="6346392">byDuration</span><span class="op" id="6346402">)</span>&nbsp;<span class="ident" id="6346404">Len</span><span class="op" id="6346407">(</span><span class="op" id="6346408">)</span>&nbsp;<span class="builtintype" id="6346410">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6346424">{</span>&nbsp;<span class="keyword" id="6346426">return</span>&nbsp;<span class="builtinfunc" id="6346433">len</span><span class="op" id="6346436">(</span><span class="ident" id="6346437">x</span><span class="op" id="6346438">)</span>&nbsp;<span class="op" id="6346440">}</span><br>
<span class="lineno"></span><span class="keyword" id="6346442">func</span>&nbsp;<span class="op" id="6346447">(</span><span class="ident" id="6346448">x</span>&nbsp;<span class="ident" id="6346450">byDuration</span><span class="op" id="6346460">)</span>&nbsp;<span class="ident" id="6346462">Swap</span><span class="op" id="6346466">(</span><span class="ident" id="6346467">i</span><span class="op" id="6346468">,</span>&nbsp;<span class="ident" id="6346470">j</span>&nbsp;<span class="builtintype" id="6346472">int</span><span class="op" id="6346475">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6346482">{</span>&nbsp;<span class="ident" id="6346484">x</span><span class="op" id="6346485">[</span><span class="ident" id="6346486">i</span><span class="op" id="6346487">]</span><span class="op" id="6346488">,</span>&nbsp;<span class="ident" id="6346490">x</span><span class="op" id="6346491">[</span><span class="ident" id="6346492">j</span><span class="op" id="6346493">]</span>&nbsp;<span class="op" id="6346495">=</span>&nbsp;<span class="ident" id="6346497">x</span><span class="op" id="6346498">[</span><span class="ident" id="6346499">j</span><span class="op" id="6346500">]</span><span class="op" id="6346501">,</span>&nbsp;<span class="ident" id="6346503">x</span><span class="op" id="6346504">[</span><span class="ident" id="6346505">i</span><span class="op" id="6346506">]</span>&nbsp;<span class="op" id="6346508">}</span><br>
<span class="lineno"></span><span class="keyword" id="6346510">func</span>&nbsp;<span class="op" id="6346515">(</span><span class="ident" id="6346516">x</span>&nbsp;<span class="ident" id="6346518">byDuration</span><span class="op" id="6346528">)</span>&nbsp;<span class="ident" id="6346530">Less</span><span class="op" id="6346534">(</span><span class="ident" id="6346535">i</span><span class="op" id="6346536">,</span>&nbsp;<span class="ident" id="6346538">j</span>&nbsp;<span class="builtintype" id="6346540">int</span><span class="op" id="6346543">)</span>&nbsp;<span class="builtintype" id="6346545">bool</span>&nbsp;<span class="op" id="6346550">{</span>&nbsp;<span class="keyword" id="6346552">return</span>&nbsp;<span class="ident" id="6346559">x</span><span class="op" id="6346560">[</span><span class="ident" id="6346561">i</span><span class="op" id="6346562">]</span>&nbsp;<span class="op" id="6346564">&lt;</span>&nbsp;<span class="ident" id="6346566">x</span><span class="op" id="6346567">[</span><span class="ident" id="6346568">j</span><span class="op" id="6346569">]</span>&nbsp;<span class="op" id="6346571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6346574">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="6346637">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6346707">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="6346788">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6346834">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="6346903">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6346953">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="6347007">func</span>&nbsp;<span class="ident" id="6347012">SetGCPercent</span><span class="op" id="6347024">(</span><span class="ident" id="6347025">percent</span>&nbsp;<span class="builtintype" id="6347033">int</span><span class="op" id="6347036">)</span>&nbsp;<span class="builtintype" id="6347038">int</span>&nbsp;<span class="op" id="6347042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347045">old</span>&nbsp;<span class="op" id="6347049">:=</span>&nbsp;<span class="ident" id="6347052">setGCPercent</span><span class="op" id="6347064">(</span><span class="builtintype" id="6347065">int32</span><span class="op" id="6347070">(</span><span class="ident" id="6347071">percent</span><span class="op" id="6347078">)</span><span class="op" id="6347079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347082">runtime</span><span class="op" id="6347089">.</span><span class="ident" id="6347090">GC</span><span class="op" id="6347092">(</span><span class="op" id="6347093">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347096">return</span>&nbsp;<span class="builtintype" id="6347103">int</span><span class="op" id="6347106">(</span><span class="ident" id="6347107">old</span><span class="op" id="6347110">)</span><br>
<span class="lineno"></span><span class="op" id="6347112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347115">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6347174">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="6347234">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="6347301">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="6347366">func</span>&nbsp;<span class="ident" id="6347371">FreeOSMemory</span><span class="op" id="6347383">(</span><span class="op" id="6347384">)</span>&nbsp;<span class="op" id="6347386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347389">freeOSMemory</span><span class="op" id="6347401">(</span><span class="op" id="6347402">)</span><br>
<span class="lineno"></span><span class="op" id="6347404">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6347407">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="6347461">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="6347505">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="6347569">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="6347593">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6347638">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="6347714">//</span><br>
<span class="lineno"></span><span class="comment" id="6347717">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6347781">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="6347851">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="6347868">func</span>&nbsp;<span class="ident" id="6347873">SetMaxStack</span><span class="op" id="6347884">(</span><span class="ident" id="6347885">bytes</span>&nbsp;<span class="builtintype" id="6347891">int</span><span class="op" id="6347894">)</span>&nbsp;<span class="builtintype" id="6347896">int</span>&nbsp;<span class="op" id="6347900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347903">return</span>&nbsp;<span class="ident" id="6347910">setMaxStack</span><span class="op" id="6347921">(</span><span class="ident" id="6347922">bytes</span><span class="op" id="6347927">)</span><br>
<span class="lineno"></span><span class="op" id="6347929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6347932">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="6347993">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="6348065">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="6348100">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6348147">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="6348189">//</span><br>
<span class="lineno"></span><span class="comment" id="6348192">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="6348269">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="6348343">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="6348431">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="6348504">//</span><br>
<span class="lineno"></span><span class="comment" id="6348507">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6348573">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6348641">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="6348712">func</span>&nbsp;<span class="ident" id="6348717">SetMaxThreads</span><span class="op" id="6348730">(</span><span class="ident" id="6348731">threads</span>&nbsp;<span class="builtintype" id="6348739">int</span><span class="op" id="6348742">)</span>&nbsp;<span class="builtintype" id="6348744">int</span>&nbsp;<span class="op" id="6348748">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348751">return</span>&nbsp;<span class="ident" id="6348758">setMaxThreads</span><span class="op" id="6348771">(</span><span class="ident" id="6348772">threads</span><span class="op" id="6348779">)</span><br>
<span class="lineno"></span><span class="op" id="6348781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6348784">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="6348857">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="6348932">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="6349011">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="6349079">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="6349151">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="6349223">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="6349278">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="6349336">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="6349372">func</span>&nbsp;<span class="ident" id="6349377">SetPanicOnFault</span><span class="op" id="6349392">(</span><span class="ident" id="6349393">enabled</span>&nbsp;<span class="builtintype" id="6349401">bool</span><span class="op" id="6349405">)</span>&nbsp;<span class="builtintype" id="6349407">bool</span>&nbsp;<span class="op" id="6349412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6349415">return</span>&nbsp;<span class="ident" id="6349422">setPanicOnFault</span><span class="op" id="6349437">(</span><span class="ident" id="6349438">enabled</span><span class="op" id="6349445">)</span><br>
<span class="lineno"></span><span class="op" id="6349447">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="6349450">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6349519">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="6349555">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="6349627">func</span>&nbsp;<span class="ident" id="6349632">WriteHeapDump</span><span class="op" id="6349645">(</span><span class="ident" id="6349646">fd</span>&nbsp;<span class="builtintype" id="6349649">uintptr</span><span class="op" id="6349656">)</span>
</div>
</body>
</html>
