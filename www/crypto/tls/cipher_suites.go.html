<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3873270">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3873325">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3873379">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3873430">package</span>&nbsp;<span class="ident" id="3873438">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3873443">import</span>&nbsp;<span class="op" id="3873450">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873453">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873467">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873484">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873498">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873513">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873527">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873542">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3873557">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3873564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3873567">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3873646">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3873710">type</span>&nbsp;<span class="ident" id="3873715">keyAgreement</span>&nbsp;<span class="keyword" id="3873728">interface</span>&nbsp;<span class="op" id="3873738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873741">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873809">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873871">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873944">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873953">generateServerKeyExchange</span><span class="op" id="3873978">(</span><span class="op" id="3873979">*</span><span class="ident" id="3873980">Config</span><span class="op" id="3873986">,</span>&nbsp;<span class="op" id="3873988">*</span><span class="ident" id="3873989">Certificate</span><span class="op" id="3874000">,</span>&nbsp;<span class="op" id="3874002">*</span><span class="ident" id="3874003">clientHelloMsg</span><span class="op" id="3874017">,</span>&nbsp;<span class="op" id="3874019">*</span><span class="ident" id="3874020">serverHelloMsg</span><span class="op" id="3874034">)</span>&nbsp;<span class="op" id="3874036">(</span><span class="op" id="3874037">*</span><span class="ident" id="3874038">serverKeyExchangeMsg</span><span class="op" id="3874058">,</span>&nbsp;<span class="builtintype" id="3874060">error</span><span class="op" id="3874065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874068">processClientKeyExchange</span><span class="op" id="3874092">(</span><span class="op" id="3874093">*</span><span class="ident" id="3874094">Config</span><span class="op" id="3874100">,</span>&nbsp;<span class="op" id="3874102">*</span><span class="ident" id="3874103">Certificate</span><span class="op" id="3874114">,</span>&nbsp;<span class="op" id="3874116">*</span><span class="ident" id="3874117">clientKeyExchangeMsg</span><span class="op" id="3874137">,</span>&nbsp;<span class="builtintype" id="3874139">uint16</span><span class="op" id="3874145">)</span>&nbsp;<span class="op" id="3874147">(</span><span class="op" id="3874148">[</span><span class="op" id="3874149">]</span><span class="builtintype" id="3874150">byte</span><span class="op" id="3874154">,</span>&nbsp;<span class="builtintype" id="3874156">error</span><span class="op" id="3874161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874165">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874232">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874295">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874326">processServerKeyExchange</span><span class="op" id="3874350">(</span><span class="op" id="3874351">*</span><span class="ident" id="3874352">Config</span><span class="op" id="3874358">,</span>&nbsp;<span class="op" id="3874360">*</span><span class="ident" id="3874361">clientHelloMsg</span><span class="op" id="3874375">,</span>&nbsp;<span class="op" id="3874377">*</span><span class="ident" id="3874378">serverHelloMsg</span><span class="op" id="3874392">,</span>&nbsp;<span class="op" id="3874394">*</span><span class="ident" id="3874395">x509</span><span class="op" id="3874399">.</span><span class="ident" id="3874400">Certificate</span><span class="op" id="3874411">,</span>&nbsp;<span class="op" id="3874413">*</span><span class="ident" id="3874414">serverKeyExchangeMsg</span><span class="op" id="3874434">)</span>&nbsp;<span class="builtintype" id="3874436">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874443">generateClientKeyExchange</span><span class="op" id="3874468">(</span><span class="op" id="3874469">*</span><span class="ident" id="3874470">Config</span><span class="op" id="3874476">,</span>&nbsp;<span class="op" id="3874478">*</span><span class="ident" id="3874479">clientHelloMsg</span><span class="op" id="3874493">,</span>&nbsp;<span class="op" id="3874495">*</span><span class="ident" id="3874496">x509</span><span class="op" id="3874500">.</span><span class="ident" id="3874501">Certificate</span><span class="op" id="3874512">)</span>&nbsp;<span class="op" id="3874514">(</span><span class="op" id="3874515">[</span><span class="op" id="3874516">]</span><span class="builtintype" id="3874517">byte</span><span class="op" id="3874521">,</span>&nbsp;<span class="op" id="3874523">*</span><span class="ident" id="3874524">clientKeyExchangeMsg</span><span class="op" id="3874544">,</span>&nbsp;<span class="builtintype" id="3874546">error</span><span class="op" id="3874551">)</span><br>
<span class="lineno">35</span><span class="op" id="3874553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874556">const</span>&nbsp;<span class="op" id="3874562">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874565">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874635">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874707">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874779">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874806">suiteECDHE</span>&nbsp;<span class="op" id="3874817">=</span>&nbsp;<span class="num" id="3874819">1</span>&nbsp;<span class="op" id="3874821">&lt;&lt;</span>&nbsp;<span class="ident" id="3874824">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874830">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874895">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874962">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875032">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875047">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875059">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875132">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875169">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3875180">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3875183">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3875259">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3875326">type</span>&nbsp;<span class="ident" id="3875331">cipherSuite</span>&nbsp;<span class="keyword" id="3875343">struct</span>&nbsp;<span class="op" id="3875350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875353">id</span>&nbsp;<span class="builtintype" id="3875356">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875364">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875438">keyLen</span>&nbsp;<span class="builtintype" id="3875445">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875450">macLen</span>&nbsp;<span class="builtintype" id="3875457">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875462">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3875469">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875474">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875481">func</span><span class="op" id="3875485">(</span><span class="ident" id="3875486">version</span>&nbsp;<span class="builtintype" id="3875494">uint16</span><span class="op" id="3875500">)</span>&nbsp;<span class="ident" id="3875502">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875516">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875568">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3875575">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875580">cipher</span>&nbsp;<span class="keyword" id="3875587">func</span><span class="op" id="3875591">(</span><span class="ident" id="3875592">key</span><span class="op" id="3875595">,</span>&nbsp;<span class="ident" id="3875597">iv</span>&nbsp;<span class="op" id="3875600">[</span><span class="op" id="3875601">]</span><span class="builtintype" id="3875602">byte</span><span class="op" id="3875606">,</span>&nbsp;<span class="ident" id="3875608">isRead</span>&nbsp;<span class="builtintype" id="3875615">bool</span><span class="op" id="3875619">)</span>&nbsp;<span class="keyword" id="3875621">interface</span><span class="op" id="3875630">{</span><span class="op" id="3875631">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875634">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875641">func</span><span class="op" id="3875645">(</span><span class="ident" id="3875646">version</span>&nbsp;<span class="builtintype" id="3875654">uint16</span><span class="op" id="3875660">,</span>&nbsp;<span class="ident" id="3875662">macKey</span>&nbsp;<span class="op" id="3875669">[</span><span class="op" id="3875670">]</span><span class="builtintype" id="3875671">byte</span><span class="op" id="3875675">)</span>&nbsp;<span class="ident" id="3875677">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875690">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875697">func</span><span class="op" id="3875701">(</span><span class="ident" id="3875702">key</span><span class="op" id="3875705">,</span>&nbsp;<span class="ident" id="3875707">fixedNonce</span>&nbsp;<span class="op" id="3875718">[</span><span class="op" id="3875719">]</span><span class="builtintype" id="3875720">byte</span><span class="op" id="3875724">)</span>&nbsp;<span class="ident" id="3875726">cipher</span><span class="op" id="3875732">.</span><span class="ident" id="3875733">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3875738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3875741">var</span>&nbsp;<span class="ident" id="3875745">cipherSuites</span>&nbsp;<span class="op" id="3875758">=</span>&nbsp;<span class="op" id="3875760">[</span><span class="op" id="3875761">]</span><span class="op" id="3875762">*</span><span class="ident" id="3875763">cipherSuite</span><span class="op" id="3875774">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875777">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875846">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875908">{</span><span class="ident" id="3875909">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3875946">,</span>&nbsp;<span class="num" id="3875948">16</span><span class="op" id="3875950">,</span>&nbsp;<span class="num" id="3875952">0</span><span class="op" id="3875953">,</span>&nbsp;<span class="num" id="3875955">4</span><span class="op" id="3875956">,</span>&nbsp;<span class="ident" id="3875958">ecdheRSAKA</span><span class="op" id="3875968">,</span>&nbsp;<span class="ident" id="3875970">suiteECDHE</span>&nbsp;<span class="op" id="3875981">|</span>&nbsp;<span class="ident" id="3875983">suiteTLS12</span><span class="op" id="3875993">,</span>&nbsp;<span class="ident" id="3875995">nil</span><span class="op" id="3875998">,</span>&nbsp;<span class="ident" id="3876000">nil</span><span class="op" id="3876003">,</span>&nbsp;<span class="ident" id="3876005">aeadAESGCM</span><span class="op" id="3876015">}</span><span class="op" id="3876016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876019">{</span><span class="ident" id="3876020">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3876059">,</span>&nbsp;<span class="num" id="3876061">16</span><span class="op" id="3876063">,</span>&nbsp;<span class="num" id="3876065">0</span><span class="op" id="3876066">,</span>&nbsp;<span class="num" id="3876068">4</span><span class="op" id="3876069">,</span>&nbsp;<span class="ident" id="3876071">ecdheECDSAKA</span><span class="op" id="3876083">,</span>&nbsp;<span class="ident" id="3876085">suiteECDHE</span>&nbsp;<span class="op" id="3876096">|</span>&nbsp;<span class="ident" id="3876098">suiteECDSA</span>&nbsp;<span class="op" id="3876109">|</span>&nbsp;<span class="ident" id="3876111">suiteTLS12</span><span class="op" id="3876121">,</span>&nbsp;<span class="ident" id="3876123">nil</span><span class="op" id="3876126">,</span>&nbsp;<span class="ident" id="3876128">nil</span><span class="op" id="3876131">,</span>&nbsp;<span class="ident" id="3876133">aeadAESGCM</span><span class="op" id="3876143">}</span><span class="op" id="3876144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876147">{</span><span class="ident" id="3876148">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3876178">,</span>&nbsp;<span class="num" id="3876180">16</span><span class="op" id="3876182">,</span>&nbsp;<span class="num" id="3876184">20</span><span class="op" id="3876186">,</span>&nbsp;<span class="num" id="3876188">0</span><span class="op" id="3876189">,</span>&nbsp;<span class="ident" id="3876191">ecdheRSAKA</span><span class="op" id="3876201">,</span>&nbsp;<span class="ident" id="3876203">suiteECDHE</span><span class="op" id="3876213">,</span>&nbsp;<span class="ident" id="3876215">cipherRC4</span><span class="op" id="3876224">,</span>&nbsp;<span class="ident" id="3876226">macSHA1</span><span class="op" id="3876233">,</span>&nbsp;<span class="ident" id="3876235">nil</span><span class="op" id="3876238">}</span><span class="op" id="3876239">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876242">{</span><span class="ident" id="3876243">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3876275">,</span>&nbsp;<span class="num" id="3876277">16</span><span class="op" id="3876279">,</span>&nbsp;<span class="num" id="3876281">20</span><span class="op" id="3876283">,</span>&nbsp;<span class="num" id="3876285">0</span><span class="op" id="3876286">,</span>&nbsp;<span class="ident" id="3876288">ecdheECDSAKA</span><span class="op" id="3876300">,</span>&nbsp;<span class="ident" id="3876302">suiteECDHE</span>&nbsp;<span class="op" id="3876313">|</span>&nbsp;<span class="ident" id="3876315">suiteECDSA</span><span class="op" id="3876325">,</span>&nbsp;<span class="ident" id="3876327">cipherRC4</span><span class="op" id="3876336">,</span>&nbsp;<span class="ident" id="3876338">macSHA1</span><span class="op" id="3876345">,</span>&nbsp;<span class="ident" id="3876347">nil</span><span class="op" id="3876350">}</span><span class="op" id="3876351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876354">{</span><span class="ident" id="3876355">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3876389">,</span>&nbsp;<span class="num" id="3876391">16</span><span class="op" id="3876393">,</span>&nbsp;<span class="num" id="3876395">20</span><span class="op" id="3876397">,</span>&nbsp;<span class="num" id="3876399">16</span><span class="op" id="3876401">,</span>&nbsp;<span class="ident" id="3876403">ecdheRSAKA</span><span class="op" id="3876413">,</span>&nbsp;<span class="ident" id="3876415">suiteECDHE</span><span class="op" id="3876425">,</span>&nbsp;<span class="ident" id="3876427">cipherAES</span><span class="op" id="3876436">,</span>&nbsp;<span class="ident" id="3876438">macSHA1</span><span class="op" id="3876445">,</span>&nbsp;<span class="ident" id="3876447">nil</span><span class="op" id="3876450">}</span><span class="op" id="3876451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876454">{</span><span class="ident" id="3876455">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3876491">,</span>&nbsp;<span class="num" id="3876493">16</span><span class="op" id="3876495">,</span>&nbsp;<span class="num" id="3876497">20</span><span class="op" id="3876499">,</span>&nbsp;<span class="num" id="3876501">16</span><span class="op" id="3876503">,</span>&nbsp;<span class="ident" id="3876505">ecdheECDSAKA</span><span class="op" id="3876517">,</span>&nbsp;<span class="ident" id="3876519">suiteECDHE</span>&nbsp;<span class="op" id="3876530">|</span>&nbsp;<span class="ident" id="3876532">suiteECDSA</span><span class="op" id="3876542">,</span>&nbsp;<span class="ident" id="3876544">cipherAES</span><span class="op" id="3876553">,</span>&nbsp;<span class="ident" id="3876555">macSHA1</span><span class="op" id="3876562">,</span>&nbsp;<span class="ident" id="3876564">nil</span><span class="op" id="3876567">}</span><span class="op" id="3876568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876571">{</span><span class="ident" id="3876572">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3876606">,</span>&nbsp;<span class="num" id="3876608">32</span><span class="op" id="3876610">,</span>&nbsp;<span class="num" id="3876612">20</span><span class="op" id="3876614">,</span>&nbsp;<span class="num" id="3876616">16</span><span class="op" id="3876618">,</span>&nbsp;<span class="ident" id="3876620">ecdheRSAKA</span><span class="op" id="3876630">,</span>&nbsp;<span class="ident" id="3876632">suiteECDHE</span><span class="op" id="3876642">,</span>&nbsp;<span class="ident" id="3876644">cipherAES</span><span class="op" id="3876653">,</span>&nbsp;<span class="ident" id="3876655">macSHA1</span><span class="op" id="3876662">,</span>&nbsp;<span class="ident" id="3876664">nil</span><span class="op" id="3876667">}</span><span class="op" id="3876668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876671">{</span><span class="ident" id="3876672">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3876708">,</span>&nbsp;<span class="num" id="3876710">32</span><span class="op" id="3876712">,</span>&nbsp;<span class="num" id="3876714">20</span><span class="op" id="3876716">,</span>&nbsp;<span class="num" id="3876718">16</span><span class="op" id="3876720">,</span>&nbsp;<span class="ident" id="3876722">ecdheECDSAKA</span><span class="op" id="3876734">,</span>&nbsp;<span class="ident" id="3876736">suiteECDHE</span>&nbsp;<span class="op" id="3876747">|</span>&nbsp;<span class="ident" id="3876749">suiteECDSA</span><span class="op" id="3876759">,</span>&nbsp;<span class="ident" id="3876761">cipherAES</span><span class="op" id="3876770">,</span>&nbsp;<span class="ident" id="3876772">macSHA1</span><span class="op" id="3876779">,</span>&nbsp;<span class="ident" id="3876781">nil</span><span class="op" id="3876784">}</span><span class="op" id="3876785">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876788">{</span><span class="ident" id="3876789">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3876813">,</span>&nbsp;<span class="num" id="3876815">16</span><span class="op" id="3876817">,</span>&nbsp;<span class="num" id="3876819">20</span><span class="op" id="3876821">,</span>&nbsp;<span class="num" id="3876823">0</span><span class="op" id="3876824">,</span>&nbsp;<span class="ident" id="3876826">rsaKA</span><span class="op" id="3876831">,</span>&nbsp;<span class="num" id="3876833">0</span><span class="op" id="3876834">,</span>&nbsp;<span class="ident" id="3876836">cipherRC4</span><span class="op" id="3876845">,</span>&nbsp;<span class="ident" id="3876847">macSHA1</span><span class="op" id="3876854">,</span>&nbsp;<span class="ident" id="3876856">nil</span><span class="op" id="3876859">}</span><span class="op" id="3876860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876863">{</span><span class="ident" id="3876864">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3876892">,</span>&nbsp;<span class="num" id="3876894">16</span><span class="op" id="3876896">,</span>&nbsp;<span class="num" id="3876898">20</span><span class="op" id="3876900">,</span>&nbsp;<span class="num" id="3876902">16</span><span class="op" id="3876904">,</span>&nbsp;<span class="ident" id="3876906">rsaKA</span><span class="op" id="3876911">,</span>&nbsp;<span class="num" id="3876913">0</span><span class="op" id="3876914">,</span>&nbsp;<span class="ident" id="3876916">cipherAES</span><span class="op" id="3876925">,</span>&nbsp;<span class="ident" id="3876927">macSHA1</span><span class="op" id="3876934">,</span>&nbsp;<span class="ident" id="3876936">nil</span><span class="op" id="3876939">}</span><span class="op" id="3876940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876943">{</span><span class="ident" id="3876944">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3876972">,</span>&nbsp;<span class="num" id="3876974">32</span><span class="op" id="3876976">,</span>&nbsp;<span class="num" id="3876978">20</span><span class="op" id="3876980">,</span>&nbsp;<span class="num" id="3876982">16</span><span class="op" id="3876984">,</span>&nbsp;<span class="ident" id="3876986">rsaKA</span><span class="op" id="3876991">,</span>&nbsp;<span class="num" id="3876993">0</span><span class="op" id="3876994">,</span>&nbsp;<span class="ident" id="3876996">cipherAES</span><span class="op" id="3877005">,</span>&nbsp;<span class="ident" id="3877007">macSHA1</span><span class="op" id="3877014">,</span>&nbsp;<span class="ident" id="3877016">nil</span><span class="op" id="3877019">}</span><span class="op" id="3877020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877023">{</span><span class="ident" id="3877024">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3877059">,</span>&nbsp;<span class="num" id="3877061">24</span><span class="op" id="3877063">,</span>&nbsp;<span class="num" id="3877065">20</span><span class="op" id="3877067">,</span>&nbsp;<span class="num" id="3877069">8</span><span class="op" id="3877070">,</span>&nbsp;<span class="ident" id="3877072">ecdheRSAKA</span><span class="op" id="3877082">,</span>&nbsp;<span class="ident" id="3877084">suiteECDHE</span><span class="op" id="3877094">,</span>&nbsp;<span class="ident" id="3877096">cipher3DES</span><span class="op" id="3877106">,</span>&nbsp;<span class="ident" id="3877108">macSHA1</span><span class="op" id="3877115">,</span>&nbsp;<span class="ident" id="3877117">nil</span><span class="op" id="3877120">}</span><span class="op" id="3877121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877124">{</span><span class="ident" id="3877125">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3877154">,</span>&nbsp;<span class="num" id="3877156">24</span><span class="op" id="3877158">,</span>&nbsp;<span class="num" id="3877160">20</span><span class="op" id="3877162">,</span>&nbsp;<span class="num" id="3877164">8</span><span class="op" id="3877165">,</span>&nbsp;<span class="ident" id="3877167">rsaKA</span><span class="op" id="3877172">,</span>&nbsp;<span class="num" id="3877174">0</span><span class="op" id="3877175">,</span>&nbsp;<span class="ident" id="3877177">cipher3DES</span><span class="op" id="3877187">,</span>&nbsp;<span class="ident" id="3877189">macSHA1</span><span class="op" id="3877196">,</span>&nbsp;<span class="ident" id="3877198">nil</span><span class="op" id="3877201">}</span><span class="op" id="3877202">,</span><br>
<span class="lineno">85</span><span class="op" id="3877204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3877207">func</span>&nbsp;<span class="ident" id="3877212">cipherRC4</span><span class="op" id="3877221">(</span><span class="ident" id="3877222">key</span><span class="op" id="3877225">,</span>&nbsp;<span class="ident" id="3877227">iv</span>&nbsp;<span class="op" id="3877230">[</span><span class="op" id="3877231">]</span><span class="builtintype" id="3877232">byte</span><span class="op" id="3877236">,</span>&nbsp;<span class="ident" id="3877238">isRead</span>&nbsp;<span class="builtintype" id="3877245">bool</span><span class="op" id="3877249">)</span>&nbsp;<span class="keyword" id="3877251">interface</span><span class="op" id="3877260">{</span><span class="op" id="3877261">}</span>&nbsp;<span class="op" id="3877263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877266">cipher</span><span class="op" id="3877272">,</span>&nbsp;<span class="ident" id="3877274">_</span>&nbsp;<span class="op" id="3877276">:=</span>&nbsp;<span class="ident" id="3877279">rc4</span><span class="op" id="3877282">.</span><span class="ident" id="3877283">NewCipher</span><span class="op" id="3877292">(</span><span class="ident" id="3877293">key</span><span class="op" id="3877296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877299">return</span>&nbsp;<span class="ident" id="3877306">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3877313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3877316">func</span>&nbsp;<span class="ident" id="3877321">cipher3DES</span><span class="op" id="3877331">(</span><span class="ident" id="3877332">key</span><span class="op" id="3877335">,</span>&nbsp;<span class="ident" id="3877337">iv</span>&nbsp;<span class="op" id="3877340">[</span><span class="op" id="3877341">]</span><span class="builtintype" id="3877342">byte</span><span class="op" id="3877346">,</span>&nbsp;<span class="ident" id="3877348">isRead</span>&nbsp;<span class="builtintype" id="3877355">bool</span><span class="op" id="3877359">)</span>&nbsp;<span class="keyword" id="3877361">interface</span><span class="op" id="3877370">{</span><span class="op" id="3877371">}</span>&nbsp;<span class="op" id="3877373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877376">block</span><span class="op" id="3877381">,</span>&nbsp;<span class="ident" id="3877383">_</span>&nbsp;<span class="op" id="3877385">:=</span>&nbsp;<span class="ident" id="3877388">des</span><span class="op" id="3877391">.</span><span class="ident" id="3877392">NewTripleDESCipher</span><span class="op" id="3877410">(</span><span class="ident" id="3877411">key</span><span class="op" id="3877414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877417">if</span>&nbsp;<span class="ident" id="3877420">isRead</span>&nbsp;<span class="op" id="3877427">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877431">return</span>&nbsp;<span class="ident" id="3877438">cipher</span><span class="op" id="3877444">.</span><span class="ident" id="3877445">NewCBCDecrypter</span><span class="op" id="3877460">(</span><span class="ident" id="3877461">block</span><span class="op" id="3877466">,</span>&nbsp;<span class="ident" id="3877468">iv</span><span class="op" id="3877470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877476">return</span>&nbsp;<span class="ident" id="3877483">cipher</span><span class="op" id="3877489">.</span><span class="ident" id="3877490">NewCBCEncrypter</span><span class="op" id="3877505">(</span><span class="ident" id="3877506">block</span><span class="op" id="3877511">,</span>&nbsp;<span class="ident" id="3877513">iv</span><span class="op" id="3877515">)</span><br>
<span class="lineno"></span><span class="op" id="3877517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3877520">func</span>&nbsp;<span class="ident" id="3877525">cipherAES</span><span class="op" id="3877534">(</span><span class="ident" id="3877535">key</span><span class="op" id="3877538">,</span>&nbsp;<span class="ident" id="3877540">iv</span>&nbsp;<span class="op" id="3877543">[</span><span class="op" id="3877544">]</span><span class="builtintype" id="3877545">byte</span><span class="op" id="3877549">,</span>&nbsp;<span class="ident" id="3877551">isRead</span>&nbsp;<span class="builtintype" id="3877558">bool</span><span class="op" id="3877562">)</span>&nbsp;<span class="keyword" id="3877564">interface</span><span class="op" id="3877573">{</span><span class="op" id="3877574">}</span>&nbsp;<span class="op" id="3877576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877579">block</span><span class="op" id="3877584">,</span>&nbsp;<span class="ident" id="3877586">_</span>&nbsp;<span class="op" id="3877588">:=</span>&nbsp;<span class="ident" id="3877591">aes</span><span class="op" id="3877594">.</span><span class="ident" id="3877595">NewCipher</span><span class="op" id="3877604">(</span><span class="ident" id="3877605">key</span><span class="op" id="3877608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877611">if</span>&nbsp;<span class="ident" id="3877614">isRead</span>&nbsp;<span class="op" id="3877621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877625">return</span>&nbsp;<span class="ident" id="3877632">cipher</span><span class="op" id="3877638">.</span><span class="ident" id="3877639">NewCBCDecrypter</span><span class="op" id="3877654">(</span><span class="ident" id="3877655">block</span><span class="op" id="3877660">,</span>&nbsp;<span class="ident" id="3877662">iv</span><span class="op" id="3877664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877667">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877670">return</span>&nbsp;<span class="ident" id="3877677">cipher</span><span class="op" id="3877683">.</span><span class="ident" id="3877684">NewCBCEncrypter</span><span class="op" id="3877699">(</span><span class="ident" id="3877700">block</span><span class="op" id="3877705">,</span>&nbsp;<span class="ident" id="3877707">iv</span><span class="op" id="3877709">)</span><br>
<span class="lineno"></span><span class="op" id="3877711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3877714">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3877779">func</span>&nbsp;<span class="ident" id="3877784">macSHA1</span><span class="op" id="3877791">(</span><span class="ident" id="3877792">version</span>&nbsp;<span class="builtintype" id="3877800">uint16</span><span class="op" id="3877806">,</span>&nbsp;<span class="ident" id="3877808">key</span>&nbsp;<span class="op" id="3877812">[</span><span class="op" id="3877813">]</span><span class="builtintype" id="3877814">byte</span><span class="op" id="3877818">)</span>&nbsp;<span class="ident" id="3877820">macFunction</span>&nbsp;<span class="op" id="3877832">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877835">if</span>&nbsp;<span class="ident" id="3877838">version</span>&nbsp;<span class="op" id="3877846">==</span>&nbsp;<span class="ident" id="3877849">VersionSSL30</span>&nbsp;<span class="op" id="3877862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877866">mac</span>&nbsp;<span class="op" id="3877870">:=</span>&nbsp;<span class="ident" id="3877873">ssl30MAC</span><span class="op" id="3877881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877886">h</span><span class="op" id="3877887">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3877891">sha1</span><span class="op" id="3877895">.</span><span class="ident" id="3877896">New</span><span class="op" id="3877899">(</span><span class="op" id="3877900">)</span><span class="op" id="3877901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877906">key</span><span class="op" id="3877909">:</span>&nbsp;<span class="builtinfunc" id="3877911">make</span><span class="op" id="3877915">(</span><span class="op" id="3877916">[</span><span class="op" id="3877917">]</span><span class="builtintype" id="3877918">byte</span><span class="op" id="3877922">,</span>&nbsp;<span class="builtinfunc" id="3877924">len</span><span class="op" id="3877927">(</span><span class="ident" id="3877928">key</span><span class="op" id="3877931">)</span><span class="op" id="3877932">)</span><span class="op" id="3877933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877937">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3877941">copy</span><span class="op" id="3877945">(</span><span class="ident" id="3877946">mac</span><span class="op" id="3877949">.</span><span class="ident" id="3877950">key</span><span class="op" id="3877953">,</span>&nbsp;<span class="ident" id="3877955">key</span><span class="op" id="3877958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877962">return</span>&nbsp;<span class="ident" id="3877969">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877977">return</span>&nbsp;<span class="ident" id="3877984">tls10MAC</span><span class="op" id="3877992">{</span><span class="ident" id="3877993">hmac</span><span class="op" id="3877997">.</span><span class="ident" id="3877998">New</span><span class="op" id="3878001">(</span><span class="ident" id="3878002">sha1</span><span class="op" id="3878006">.</span><span class="ident" id="3878007">New</span><span class="op" id="3878010">,</span>&nbsp;<span class="ident" id="3878012">key</span><span class="op" id="3878015">)</span><span class="op" id="3878016">}</span><br>
<span class="lineno"></span><span class="op" id="3878018">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3878021">type</span>&nbsp;<span class="ident" id="3878026">macFunction</span>&nbsp;<span class="keyword" id="3878038">interface</span>&nbsp;<span class="op" id="3878048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878051">Size</span><span class="op" id="3878055">(</span><span class="op" id="3878056">)</span>&nbsp;<span class="builtintype" id="3878058">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878063">MAC</span><span class="op" id="3878066">(</span><span class="ident" id="3878067">digestBuf</span><span class="op" id="3878076">,</span>&nbsp;<span class="ident" id="3878078">seq</span><span class="op" id="3878081">,</span>&nbsp;<span class="ident" id="3878083">header</span><span class="op" id="3878089">,</span>&nbsp;<span class="ident" id="3878091">data</span>&nbsp;<span class="op" id="3878096">[</span><span class="op" id="3878097">]</span><span class="builtintype" id="3878098">byte</span><span class="op" id="3878102">)</span>&nbsp;<span class="op" id="3878104">[</span><span class="op" id="3878105">]</span><span class="builtintype" id="3878106">byte</span><br>
<span class="lineno"></span><span class="op" id="3878111">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3878114">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3878191">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3878205">type</span>&nbsp;<span class="ident" id="3878210">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3878225">struct</span>&nbsp;<span class="op" id="3878232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3878235">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3878306">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3878370">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878425">sealNonce</span><span class="op" id="3878434">,</span>&nbsp;<span class="ident" id="3878436">openNonce</span>&nbsp;<span class="op" id="3878446">[</span><span class="op" id="3878447">]</span><span class="builtintype" id="3878448">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878454">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878475">cipher</span><span class="op" id="3878481">.</span><span class="ident" id="3878482">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3878487">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3878490">func</span>&nbsp;<span class="op" id="3878495">(</span><span class="ident" id="3878496">f</span>&nbsp;<span class="op" id="3878498">*</span><span class="ident" id="3878499">fixedNonceAEAD</span><span class="op" id="3878513">)</span>&nbsp;<span class="ident" id="3878515">NonceSize</span><span class="op" id="3878524">(</span><span class="op" id="3878525">)</span>&nbsp;<span class="builtintype" id="3878527">int</span>&nbsp;<span class="op" id="3878531">{</span>&nbsp;<span class="keyword" id="3878533">return</span>&nbsp;<span class="num" id="3878540">8</span>&nbsp;<span class="op" id="3878542">}</span><br>
<span class="lineno"></span><span class="keyword" id="3878544">func</span>&nbsp;<span class="op" id="3878549">(</span><span class="ident" id="3878550">f</span>&nbsp;<span class="op" id="3878552">*</span><span class="ident" id="3878553">fixedNonceAEAD</span><span class="op" id="3878567">)</span>&nbsp;<span class="ident" id="3878569">Overhead</span><span class="op" id="3878577">(</span><span class="op" id="3878578">)</span>&nbsp;<span class="builtintype" id="3878580">int</span>&nbsp;&nbsp;<span class="op" id="3878585">{</span>&nbsp;<span class="keyword" id="3878587">return</span>&nbsp;<span class="ident" id="3878594">f</span><span class="op" id="3878595">.</span><span class="ident" id="3878596">aead</span><span class="op" id="3878600">.</span><span class="ident" id="3878601">Overhead</span><span class="op" id="3878609">(</span><span class="op" id="3878610">)</span>&nbsp;<span class="op" id="3878612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3878615">func</span>&nbsp;<span class="op" id="3878620">(</span><span class="ident" id="3878621">f</span>&nbsp;<span class="op" id="3878623">*</span><span class="ident" id="3878624">fixedNonceAEAD</span><span class="op" id="3878638">)</span>&nbsp;<span class="ident" id="3878640">Seal</span><span class="op" id="3878644">(</span><span class="ident" id="3878645">out</span><span class="op" id="3878648">,</span>&nbsp;<span class="ident" id="3878650">nonce</span><span class="op" id="3878655">,</span>&nbsp;<span class="ident" id="3878657">plaintext</span><span class="op" id="3878666">,</span>&nbsp;<span class="ident" id="3878668">additionalData</span>&nbsp;<span class="op" id="3878683">[</span><span class="op" id="3878684">]</span><span class="builtintype" id="3878685">byte</span><span class="op" id="3878689">)</span>&nbsp;<span class="op" id="3878691">[</span><span class="op" id="3878692">]</span><span class="builtintype" id="3878693">byte</span>&nbsp;<span class="op" id="3878698">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3878701">copy</span><span class="op" id="3878705">(</span><span class="ident" id="3878706">f</span><span class="op" id="3878707">.</span><span class="ident" id="3878708">sealNonce</span><span class="op" id="3878717">[</span><span class="builtinfunc" id="3878718">len</span><span class="op" id="3878721">(</span><span class="ident" id="3878722">f</span><span class="op" id="3878723">.</span><span class="ident" id="3878724">sealNonce</span><span class="op" id="3878733">)</span><span class="op" id="3878734">-</span><span class="num" id="3878735">8</span><span class="op" id="3878736">:</span><span class="op" id="3878737">]</span><span class="op" id="3878738">,</span>&nbsp;<span class="ident" id="3878740">nonce</span><span class="op" id="3878745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878748">return</span>&nbsp;<span class="ident" id="3878755">f</span><span class="op" id="3878756">.</span><span class="ident" id="3878757">aead</span><span class="op" id="3878761">.</span><span class="ident" id="3878762">Seal</span><span class="op" id="3878766">(</span><span class="ident" id="3878767">out</span><span class="op" id="3878770">,</span>&nbsp;<span class="ident" id="3878772">f</span><span class="op" id="3878773">.</span><span class="ident" id="3878774">sealNonce</span><span class="op" id="3878783">,</span>&nbsp;<span class="ident" id="3878785">plaintext</span><span class="op" id="3878794">,</span>&nbsp;<span class="ident" id="3878796">additionalData</span><span class="op" id="3878810">)</span><br>
<span class="lineno"></span><span class="op" id="3878812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3878815">func</span>&nbsp;<span class="op" id="3878820">(</span><span class="ident" id="3878821">f</span>&nbsp;<span class="op" id="3878823">*</span><span class="ident" id="3878824">fixedNonceAEAD</span><span class="op" id="3878838">)</span>&nbsp;<span class="ident" id="3878840">Open</span><span class="op" id="3878844">(</span><span class="ident" id="3878845">out</span><span class="op" id="3878848">,</span>&nbsp;<span class="ident" id="3878850">nonce</span><span class="op" id="3878855">,</span>&nbsp;<span class="ident" id="3878857">plaintext</span><span class="op" id="3878866">,</span>&nbsp;<span class="ident" id="3878868">additionalData</span>&nbsp;<span class="op" id="3878883">[</span><span class="op" id="3878884">]</span><span class="builtintype" id="3878885">byte</span><span class="op" id="3878889">)</span>&nbsp;<span class="op" id="3878891">(</span><span class="op" id="3878892">[</span><span class="op" id="3878893">]</span><span class="builtintype" id="3878894">byte</span><span class="op" id="3878898">,</span>&nbsp;<span class="builtintype" id="3878900">error</span><span class="op" id="3878905">)</span>&nbsp;<span class="op" id="3878907">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3878910">copy</span><span class="op" id="3878914">(</span><span class="ident" id="3878915">f</span><span class="op" id="3878916">.</span><span class="ident" id="3878917">openNonce</span><span class="op" id="3878926">[</span><span class="builtinfunc" id="3878927">len</span><span class="op" id="3878930">(</span><span class="ident" id="3878931">f</span><span class="op" id="3878932">.</span><span class="ident" id="3878933">openNonce</span><span class="op" id="3878942">)</span><span class="op" id="3878943">-</span><span class="num" id="3878944">8</span><span class="op" id="3878945">:</span><span class="op" id="3878946">]</span><span class="op" id="3878947">,</span>&nbsp;<span class="ident" id="3878949">nonce</span><span class="op" id="3878954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878957">return</span>&nbsp;<span class="ident" id="3878964">f</span><span class="op" id="3878965">.</span><span class="ident" id="3878966">aead</span><span class="op" id="3878970">.</span><span class="ident" id="3878971">Open</span><span class="op" id="3878975">(</span><span class="ident" id="3878976">out</span><span class="op" id="3878979">,</span>&nbsp;<span class="ident" id="3878981">f</span><span class="op" id="3878982">.</span><span class="ident" id="3878983">openNonce</span><span class="op" id="3878992">,</span>&nbsp;<span class="ident" id="3878994">plaintext</span><span class="op" id="3879003">,</span>&nbsp;<span class="ident" id="3879005">additionalData</span><span class="op" id="3879019">)</span><br>
<span class="lineno"></span><span class="op" id="3879021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3879024">func</span>&nbsp;<span class="ident" id="3879029">aeadAESGCM</span><span class="op" id="3879039">(</span><span class="ident" id="3879040">key</span><span class="op" id="3879043">,</span>&nbsp;<span class="ident" id="3879045">fixedNonce</span>&nbsp;<span class="op" id="3879056">[</span><span class="op" id="3879057">]</span><span class="builtintype" id="3879058">byte</span><span class="op" id="3879062">)</span>&nbsp;<span class="ident" id="3879064">cipher</span><span class="op" id="3879070">.</span><span class="ident" id="3879071">AEAD</span>&nbsp;<span class="op" id="3879076">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879079">aes</span><span class="op" id="3879082">,</span>&nbsp;<span class="ident" id="3879084">err</span>&nbsp;<span class="op" id="3879088">:=</span>&nbsp;<span class="ident" id="3879091">aes</span><span class="op" id="3879094">.</span><span class="ident" id="3879095">NewCipher</span><span class="op" id="3879104">(</span><span class="ident" id="3879105">key</span><span class="op" id="3879108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879111">if</span>&nbsp;<span class="ident" id="3879114">err</span>&nbsp;<span class="op" id="3879118">!=</span>&nbsp;<span class="ident" id="3879121">nil</span>&nbsp;<span class="op" id="3879125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3879129">panic</span><span class="op" id="3879134">(</span><span class="ident" id="3879135">err</span><span class="op" id="3879138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879144">aead</span><span class="op" id="3879148">,</span>&nbsp;<span class="ident" id="3879150">err</span>&nbsp;<span class="op" id="3879154">:=</span>&nbsp;<span class="ident" id="3879157">cipher</span><span class="op" id="3879163">.</span><span class="ident" id="3879164">NewGCM</span><span class="op" id="3879170">(</span><span class="ident" id="3879171">aes</span><span class="op" id="3879174">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879177">if</span>&nbsp;<span class="ident" id="3879180">err</span>&nbsp;<span class="op" id="3879184">!=</span>&nbsp;<span class="ident" id="3879187">nil</span>&nbsp;<span class="op" id="3879191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3879195">panic</span><span class="op" id="3879200">(</span><span class="ident" id="3879201">err</span><span class="op" id="3879204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879211">nonce1</span><span class="op" id="3879217">,</span>&nbsp;<span class="ident" id="3879219">nonce2</span>&nbsp;<span class="op" id="3879226">:=</span>&nbsp;<span class="builtinfunc" id="3879229">make</span><span class="op" id="3879233">(</span><span class="op" id="3879234">[</span><span class="op" id="3879235">]</span><span class="builtintype" id="3879236">byte</span><span class="op" id="3879240">,</span>&nbsp;<span class="num" id="3879242">12</span><span class="op" id="3879244">)</span><span class="op" id="3879245">,</span>&nbsp;<span class="builtinfunc" id="3879247">make</span><span class="op" id="3879251">(</span><span class="op" id="3879252">[</span><span class="op" id="3879253">]</span><span class="builtintype" id="3879254">byte</span><span class="op" id="3879258">,</span>&nbsp;<span class="num" id="3879260">12</span><span class="op" id="3879262">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3879265">copy</span><span class="op" id="3879269">(</span><span class="ident" id="3879270">nonce1</span><span class="op" id="3879276">,</span>&nbsp;<span class="ident" id="3879278">fixedNonce</span><span class="op" id="3879288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3879291">copy</span><span class="op" id="3879295">(</span><span class="ident" id="3879296">nonce2</span><span class="op" id="3879302">,</span>&nbsp;<span class="ident" id="3879304">fixedNonce</span><span class="op" id="3879314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879318">return</span>&nbsp;<span class="op" id="3879325">&amp;</span><span class="ident" id="3879326">fixedNonceAEAD</span><span class="op" id="3879340">{</span><span class="ident" id="3879341">nonce1</span><span class="op" id="3879347">,</span>&nbsp;<span class="ident" id="3879349">nonce2</span><span class="op" id="3879355">,</span>&nbsp;<span class="ident" id="3879357">aead</span><span class="op" id="3879361">}</span><br>
<span class="lineno"></span><span class="op" id="3879363">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3879366">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3879427">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3879505">type</span>&nbsp;<span class="ident" id="3879510">ssl30MAC</span>&nbsp;<span class="keyword" id="3879519">struct</span>&nbsp;<span class="op" id="3879526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879529">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3879533">hash</span><span class="op" id="3879537">.</span><span class="ident" id="3879538">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879544">key</span>&nbsp;<span class="op" id="3879548">[</span><span class="op" id="3879549">]</span><span class="builtintype" id="3879550">byte</span><br>
<span class="lineno"></span><span class="op" id="3879555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3879558">func</span>&nbsp;<span class="op" id="3879563">(</span><span class="ident" id="3879564">s</span>&nbsp;<span class="ident" id="3879566">ssl30MAC</span><span class="op" id="3879574">)</span>&nbsp;<span class="ident" id="3879576">Size</span><span class="op" id="3879580">(</span><span class="op" id="3879581">)</span>&nbsp;<span class="builtintype" id="3879583">int</span>&nbsp;<span class="op" id="3879587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879590">return</span>&nbsp;<span class="ident" id="3879597">s</span><span class="op" id="3879598">.</span><span class="ident" id="3879599">h</span><span class="op" id="3879600">.</span><span class="ident" id="3879601">Size</span><span class="op" id="3879605">(</span><span class="op" id="3879606">)</span><br>
<span class="lineno">175</span><span class="op" id="3879608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3879611">var</span>&nbsp;<span class="ident" id="3879615">ssl30Pad1</span>&nbsp;<span class="op" id="3879625">=</span>&nbsp;<span class="op" id="3879627">[</span><span class="num" id="3879628">48</span><span class="op" id="3879630">]</span><span class="builtintype" id="3879631">byte</span><span class="op" id="3879635">{</span><span class="num" id="3879636">0x36</span><span class="op" id="3879640">,</span>&nbsp;<span class="num" id="3879642">0x36</span><span class="op" id="3879646">,</span>&nbsp;<span class="num" id="3879648">0x36</span><span class="op" id="3879652">,</span>&nbsp;<span class="num" id="3879654">0x36</span><span class="op" id="3879658">,</span>&nbsp;<span class="num" id="3879660">0x36</span><span class="op" id="3879664">,</span>&nbsp;<span class="num" id="3879666">0x36</span><span class="op" id="3879670">,</span>&nbsp;<span class="num" id="3879672">0x36</span><span class="op" id="3879676">,</span>&nbsp;<span class="num" id="3879678">0x36</span><span class="op" id="3879682">,</span>&nbsp;<span class="num" id="3879684">0x36</span><span class="op" id="3879688">,</span>&nbsp;<span class="num" id="3879690">0x36</span><span class="op" id="3879694">,</span>&nbsp;<span class="num" id="3879696">0x36</span><span class="op" id="3879700">,</span>&nbsp;<span class="num" id="3879702">0x36</span><span class="op" id="3879706">,</span>&nbsp;<span class="num" id="3879708">0x36</span><span class="op" id="3879712">,</span>&nbsp;<span class="num" id="3879714">0x36</span><span class="op" id="3879718">,</span>&nbsp;<span class="num" id="3879720">0x36</span><span class="op" id="3879724">,</span>&nbsp;<span class="num" id="3879726">0x36</span><span class="op" id="3879730">,</span>&nbsp;<span class="num" id="3879732">0x36</span><span class="op" id="3879736">,</span>&nbsp;<span class="num" id="3879738">0x36</span><span class="op" id="3879742">,</span>&nbsp;<span class="num" id="3879744">0x36</span><span class="op" id="3879748">,</span>&nbsp;<span class="num" id="3879750">0x36</span><span class="op" id="3879754">,</span>&nbsp;<span class="num" id="3879756">0x36</span><span class="op" id="3879760">,</span>&nbsp;<span class="num" id="3879762">0x36</span><span class="op" id="3879766">,</span>&nbsp;<span class="num" id="3879768">0x36</span><span class="op" id="3879772">,</span>&nbsp;<span class="num" id="3879774">0x36</span><span class="op" id="3879778">,</span>&nbsp;<span class="num" id="3879780">0x36</span><span class="op" id="3879784">,</span>&nbsp;<span class="num" id="3879786">0x36</span><span class="op" id="3879790">,</span>&nbsp;<span class="num" id="3879792">0x36</span><span class="op" id="3879796">,</span>&nbsp;<span class="num" id="3879798">0x36</span><span class="op" id="3879802">,</span>&nbsp;<span class="num" id="3879804">0x36</span><span class="op" id="3879808">,</span>&nbsp;<span class="num" id="3879810">0x36</span><span class="op" id="3879814">,</span>&nbsp;<span class="num" id="3879816">0x36</span><span class="op" id="3879820">,</span>&nbsp;<span class="num" id="3879822">0x36</span><span class="op" id="3879826">,</span>&nbsp;<span class="num" id="3879828">0x36</span><span class="op" id="3879832">,</span>&nbsp;<span class="num" id="3879834">0x36</span><span class="op" id="3879838">,</span>&nbsp;<span class="num" id="3879840">0x36</span><span class="op" id="3879844">,</span>&nbsp;<span class="num" id="3879846">0x36</span><span class="op" id="3879850">,</span>&nbsp;<span class="num" id="3879852">0x36</span><span class="op" id="3879856">,</span>&nbsp;<span class="num" id="3879858">0x36</span><span class="op" id="3879862">,</span>&nbsp;<span class="num" id="3879864">0x36</span><span class="op" id="3879868">,</span>&nbsp;<span class="num" id="3879870">0x36</span><span class="op" id="3879874">,</span>&nbsp;<span class="num" id="3879876">0x36</span><span class="op" id="3879880">,</span>&nbsp;<span class="num" id="3879882">0x36</span><span class="op" id="3879886">,</span>&nbsp;<span class="num" id="3879888">0x36</span><span class="op" id="3879892">,</span>&nbsp;<span class="num" id="3879894">0x36</span><span class="op" id="3879898">,</span>&nbsp;<span class="num" id="3879900">0x36</span><span class="op" id="3879904">,</span>&nbsp;<span class="num" id="3879906">0x36</span><span class="op" id="3879910">,</span>&nbsp;<span class="num" id="3879912">0x36</span><span class="op" id="3879916">,</span>&nbsp;<span class="num" id="3879918">0x36</span><span class="op" id="3879922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3879925">var</span>&nbsp;<span class="ident" id="3879929">ssl30Pad2</span>&nbsp;<span class="op" id="3879939">=</span>&nbsp;<span class="op" id="3879941">[</span><span class="num" id="3879942">48</span><span class="op" id="3879944">]</span><span class="builtintype" id="3879945">byte</span><span class="op" id="3879949">{</span><span class="num" id="3879950">0x5c</span><span class="op" id="3879954">,</span>&nbsp;<span class="num" id="3879956">0x5c</span><span class="op" id="3879960">,</span>&nbsp;<span class="num" id="3879962">0x5c</span><span class="op" id="3879966">,</span>&nbsp;<span class="num" id="3879968">0x5c</span><span class="op" id="3879972">,</span>&nbsp;<span class="num" id="3879974">0x5c</span><span class="op" id="3879978">,</span>&nbsp;<span class="num" id="3879980">0x5c</span><span class="op" id="3879984">,</span>&nbsp;<span class="num" id="3879986">0x5c</span><span class="op" id="3879990">,</span>&nbsp;<span class="num" id="3879992">0x5c</span><span class="op" id="3879996">,</span>&nbsp;<span class="num" id="3879998">0x5c</span><span class="op" id="3880002">,</span>&nbsp;<span class="num" id="3880004">0x5c</span><span class="op" id="3880008">,</span>&nbsp;<span class="num" id="3880010">0x5c</span><span class="op" id="3880014">,</span>&nbsp;<span class="num" id="3880016">0x5c</span><span class="op" id="3880020">,</span>&nbsp;<span class="num" id="3880022">0x5c</span><span class="op" id="3880026">,</span>&nbsp;<span class="num" id="3880028">0x5c</span><span class="op" id="3880032">,</span>&nbsp;<span class="num" id="3880034">0x5c</span><span class="op" id="3880038">,</span>&nbsp;<span class="num" id="3880040">0x5c</span><span class="op" id="3880044">,</span>&nbsp;<span class="num" id="3880046">0x5c</span><span class="op" id="3880050">,</span>&nbsp;<span class="num" id="3880052">0x5c</span><span class="op" id="3880056">,</span>&nbsp;<span class="num" id="3880058">0x5c</span><span class="op" id="3880062">,</span>&nbsp;<span class="num" id="3880064">0x5c</span><span class="op" id="3880068">,</span>&nbsp;<span class="num" id="3880070">0x5c</span><span class="op" id="3880074">,</span>&nbsp;<span class="num" id="3880076">0x5c</span><span class="op" id="3880080">,</span>&nbsp;<span class="num" id="3880082">0x5c</span><span class="op" id="3880086">,</span>&nbsp;<span class="num" id="3880088">0x5c</span><span class="op" id="3880092">,</span>&nbsp;<span class="num" id="3880094">0x5c</span><span class="op" id="3880098">,</span>&nbsp;<span class="num" id="3880100">0x5c</span><span class="op" id="3880104">,</span>&nbsp;<span class="num" id="3880106">0x5c</span><span class="op" id="3880110">,</span>&nbsp;<span class="num" id="3880112">0x5c</span><span class="op" id="3880116">,</span>&nbsp;<span class="num" id="3880118">0x5c</span><span class="op" id="3880122">,</span>&nbsp;<span class="num" id="3880124">0x5c</span><span class="op" id="3880128">,</span>&nbsp;<span class="num" id="3880130">0x5c</span><span class="op" id="3880134">,</span>&nbsp;<span class="num" id="3880136">0x5c</span><span class="op" id="3880140">,</span>&nbsp;<span class="num" id="3880142">0x5c</span><span class="op" id="3880146">,</span>&nbsp;<span class="num" id="3880148">0x5c</span><span class="op" id="3880152">,</span>&nbsp;<span class="num" id="3880154">0x5c</span><span class="op" id="3880158">,</span>&nbsp;<span class="num" id="3880160">0x5c</span><span class="op" id="3880164">,</span>&nbsp;<span class="num" id="3880166">0x5c</span><span class="op" id="3880170">,</span>&nbsp;<span class="num" id="3880172">0x5c</span><span class="op" id="3880176">,</span>&nbsp;<span class="num" id="3880178">0x5c</span><span class="op" id="3880182">,</span>&nbsp;<span class="num" id="3880184">0x5c</span><span class="op" id="3880188">,</span>&nbsp;<span class="num" id="3880190">0x5c</span><span class="op" id="3880194">,</span>&nbsp;<span class="num" id="3880196">0x5c</span><span class="op" id="3880200">,</span>&nbsp;<span class="num" id="3880202">0x5c</span><span class="op" id="3880206">,</span>&nbsp;<span class="num" id="3880208">0x5c</span><span class="op" id="3880212">,</span>&nbsp;<span class="num" id="3880214">0x5c</span><span class="op" id="3880218">,</span>&nbsp;<span class="num" id="3880220">0x5c</span><span class="op" id="3880224">,</span>&nbsp;<span class="num" id="3880226">0x5c</span><span class="op" id="3880230">,</span>&nbsp;<span class="num" id="3880232">0x5c</span><span class="op" id="3880236">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3880239">func</span>&nbsp;<span class="op" id="3880244">(</span><span class="ident" id="3880245">s</span>&nbsp;<span class="ident" id="3880247">ssl30MAC</span><span class="op" id="3880255">)</span>&nbsp;<span class="ident" id="3880257">MAC</span><span class="op" id="3880260">(</span><span class="ident" id="3880261">digestBuf</span><span class="op" id="3880270">,</span>&nbsp;<span class="ident" id="3880272">seq</span><span class="op" id="3880275">,</span>&nbsp;<span class="ident" id="3880277">header</span><span class="op" id="3880283">,</span>&nbsp;<span class="ident" id="3880285">data</span>&nbsp;<span class="op" id="3880290">[</span><span class="op" id="3880291">]</span><span class="builtintype" id="3880292">byte</span><span class="op" id="3880296">)</span>&nbsp;<span class="op" id="3880298">[</span><span class="op" id="3880299">]</span><span class="builtintype" id="3880300">byte</span>&nbsp;<span class="op" id="3880305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880308">padLength</span>&nbsp;<span class="op" id="3880318">:=</span>&nbsp;<span class="num" id="3880321">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880325">if</span>&nbsp;<span class="ident" id="3880328">s</span><span class="op" id="3880329">.</span><span class="ident" id="3880330">h</span><span class="op" id="3880331">.</span><span class="ident" id="3880332">Size</span><span class="op" id="3880336">(</span><span class="op" id="3880337">)</span>&nbsp;<span class="op" id="3880339">==</span>&nbsp;<span class="num" id="3880342">20</span>&nbsp;<span class="op" id="3880345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880349">padLength</span>&nbsp;<span class="op" id="3880359">=</span>&nbsp;<span class="num" id="3880361">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880369">s</span><span class="op" id="3880370">.</span><span class="ident" id="3880371">h</span><span class="op" id="3880372">.</span><span class="ident" id="3880373">Reset</span><span class="op" id="3880378">(</span><span class="op" id="3880379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880382">s</span><span class="op" id="3880383">.</span><span class="ident" id="3880384">h</span><span class="op" id="3880385">.</span><span class="ident" id="3880386">Write</span><span class="op" id="3880391">(</span><span class="ident" id="3880392">s</span><span class="op" id="3880393">.</span><span class="ident" id="3880394">key</span><span class="op" id="3880397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880400">s</span><span class="op" id="3880401">.</span><span class="ident" id="3880402">h</span><span class="op" id="3880403">.</span><span class="ident" id="3880404">Write</span><span class="op" id="3880409">(</span><span class="ident" id="3880410">ssl30Pad1</span><span class="op" id="3880419">[</span><span class="op" id="3880420">:</span><span class="ident" id="3880421">padLength</span><span class="op" id="3880430">]</span><span class="op" id="3880431">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880434">s</span><span class="op" id="3880435">.</span><span class="ident" id="3880436">h</span><span class="op" id="3880437">.</span><span class="ident" id="3880438">Write</span><span class="op" id="3880443">(</span><span class="ident" id="3880444">seq</span><span class="op" id="3880447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880450">s</span><span class="op" id="3880451">.</span><span class="ident" id="3880452">h</span><span class="op" id="3880453">.</span><span class="ident" id="3880454">Write</span><span class="op" id="3880459">(</span><span class="ident" id="3880460">header</span><span class="op" id="3880466">[</span><span class="op" id="3880467">:</span><span class="num" id="3880468">1</span><span class="op" id="3880469">]</span><span class="op" id="3880470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880473">s</span><span class="op" id="3880474">.</span><span class="ident" id="3880475">h</span><span class="op" id="3880476">.</span><span class="ident" id="3880477">Write</span><span class="op" id="3880482">(</span><span class="ident" id="3880483">header</span><span class="op" id="3880489">[</span><span class="num" id="3880490">3</span><span class="op" id="3880491">:</span><span class="num" id="3880492">5</span><span class="op" id="3880493">]</span><span class="op" id="3880494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880497">s</span><span class="op" id="3880498">.</span><span class="ident" id="3880499">h</span><span class="op" id="3880500">.</span><span class="ident" id="3880501">Write</span><span class="op" id="3880506">(</span><span class="ident" id="3880507">data</span><span class="op" id="3880511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880514">digestBuf</span>&nbsp;<span class="op" id="3880524">=</span>&nbsp;<span class="ident" id="3880526">s</span><span class="op" id="3880527">.</span><span class="ident" id="3880528">h</span><span class="op" id="3880529">.</span><span class="ident" id="3880530">Sum</span><span class="op" id="3880533">(</span><span class="ident" id="3880534">digestBuf</span><span class="op" id="3880543">[</span><span class="op" id="3880544">:</span><span class="num" id="3880545">0</span><span class="op" id="3880546">]</span><span class="op" id="3880547">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880551">s</span><span class="op" id="3880552">.</span><span class="ident" id="3880553">h</span><span class="op" id="3880554">.</span><span class="ident" id="3880555">Reset</span><span class="op" id="3880560">(</span><span class="op" id="3880561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880564">s</span><span class="op" id="3880565">.</span><span class="ident" id="3880566">h</span><span class="op" id="3880567">.</span><span class="ident" id="3880568">Write</span><span class="op" id="3880573">(</span><span class="ident" id="3880574">s</span><span class="op" id="3880575">.</span><span class="ident" id="3880576">key</span><span class="op" id="3880579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880582">s</span><span class="op" id="3880583">.</span><span class="ident" id="3880584">h</span><span class="op" id="3880585">.</span><span class="ident" id="3880586">Write</span><span class="op" id="3880591">(</span><span class="ident" id="3880592">ssl30Pad2</span><span class="op" id="3880601">[</span><span class="op" id="3880602">:</span><span class="ident" id="3880603">padLength</span><span class="op" id="3880612">]</span><span class="op" id="3880613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880616">s</span><span class="op" id="3880617">.</span><span class="ident" id="3880618">h</span><span class="op" id="3880619">.</span><span class="ident" id="3880620">Write</span><span class="op" id="3880625">(</span><span class="ident" id="3880626">digestBuf</span><span class="op" id="3880635">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880638">return</span>&nbsp;<span class="ident" id="3880645">s</span><span class="op" id="3880646">.</span><span class="ident" id="3880647">h</span><span class="op" id="3880648">.</span><span class="ident" id="3880649">Sum</span><span class="op" id="3880652">(</span><span class="ident" id="3880653">digestBuf</span><span class="op" id="3880662">[</span><span class="op" id="3880663">:</span><span class="num" id="3880664">0</span><span class="op" id="3880665">]</span><span class="op" id="3880666">)</span><br>
<span class="lineno"></span><span class="op" id="3880668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880671">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3880745">type</span>&nbsp;<span class="ident" id="3880750">tls10MAC</span>&nbsp;<span class="keyword" id="3880759">struct</span>&nbsp;<span class="op" id="3880766">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880769">h</span>&nbsp;<span class="ident" id="3880771">hash</span><span class="op" id="3880775">.</span><span class="ident" id="3880776">Hash</span><br>
<span class="lineno"></span><span class="op" id="3880781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880784">func</span>&nbsp;<span class="op" id="3880789">(</span><span class="ident" id="3880790">s</span>&nbsp;<span class="ident" id="3880792">tls10MAC</span><span class="op" id="3880800">)</span>&nbsp;<span class="ident" id="3880802">Size</span><span class="op" id="3880806">(</span><span class="op" id="3880807">)</span>&nbsp;<span class="builtintype" id="3880809">int</span>&nbsp;<span class="op" id="3880813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880816">return</span>&nbsp;<span class="ident" id="3880823">s</span><span class="op" id="3880824">.</span><span class="ident" id="3880825">h</span><span class="op" id="3880826">.</span><span class="ident" id="3880827">Size</span><span class="op" id="3880831">(</span><span class="op" id="3880832">)</span><br>
<span class="lineno">210</span><span class="op" id="3880834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3880837">func</span>&nbsp;<span class="op" id="3880842">(</span><span class="ident" id="3880843">s</span>&nbsp;<span class="ident" id="3880845">tls10MAC</span><span class="op" id="3880853">)</span>&nbsp;<span class="ident" id="3880855">MAC</span><span class="op" id="3880858">(</span><span class="ident" id="3880859">digestBuf</span><span class="op" id="3880868">,</span>&nbsp;<span class="ident" id="3880870">seq</span><span class="op" id="3880873">,</span>&nbsp;<span class="ident" id="3880875">header</span><span class="op" id="3880881">,</span>&nbsp;<span class="ident" id="3880883">data</span>&nbsp;<span class="op" id="3880888">[</span><span class="op" id="3880889">]</span><span class="builtintype" id="3880890">byte</span><span class="op" id="3880894">)</span>&nbsp;<span class="op" id="3880896">[</span><span class="op" id="3880897">]</span><span class="builtintype" id="3880898">byte</span>&nbsp;<span class="op" id="3880903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880906">s</span><span class="op" id="3880907">.</span><span class="ident" id="3880908">h</span><span class="op" id="3880909">.</span><span class="ident" id="3880910">Reset</span><span class="op" id="3880915">(</span><span class="op" id="3880916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880919">s</span><span class="op" id="3880920">.</span><span class="ident" id="3880921">h</span><span class="op" id="3880922">.</span><span class="ident" id="3880923">Write</span><span class="op" id="3880928">(</span><span class="ident" id="3880929">seq</span><span class="op" id="3880932">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880935">s</span><span class="op" id="3880936">.</span><span class="ident" id="3880937">h</span><span class="op" id="3880938">.</span><span class="ident" id="3880939">Write</span><span class="op" id="3880944">(</span><span class="ident" id="3880945">header</span><span class="op" id="3880951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880954">s</span><span class="op" id="3880955">.</span><span class="ident" id="3880956">h</span><span class="op" id="3880957">.</span><span class="ident" id="3880958">Write</span><span class="op" id="3880963">(</span><span class="ident" id="3880964">data</span><span class="op" id="3880968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880971">return</span>&nbsp;<span class="ident" id="3880978">s</span><span class="op" id="3880979">.</span><span class="ident" id="3880980">h</span><span class="op" id="3880981">.</span><span class="ident" id="3880982">Sum</span><span class="op" id="3880985">(</span><span class="ident" id="3880986">digestBuf</span><span class="op" id="3880995">[</span><span class="op" id="3880996">:</span><span class="num" id="3880997">0</span><span class="op" id="3880998">]</span><span class="op" id="3880999">)</span><br>
<span class="lineno"></span><span class="op" id="3881001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3881004">func</span>&nbsp;<span class="ident" id="3881009">rsaKA</span><span class="op" id="3881014">(</span><span class="ident" id="3881015">version</span>&nbsp;<span class="builtintype" id="3881023">uint16</span><span class="op" id="3881029">)</span>&nbsp;<span class="ident" id="3881031">keyAgreement</span>&nbsp;<span class="op" id="3881044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881047">return</span>&nbsp;<span class="ident" id="3881054">rsaKeyAgreement</span><span class="op" id="3881069">{</span><span class="op" id="3881070">}</span><br>
<span class="lineno"></span><span class="op" id="3881072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3881075">func</span>&nbsp;<span class="ident" id="3881080">ecdheECDSAKA</span><span class="op" id="3881092">(</span><span class="ident" id="3881093">version</span>&nbsp;<span class="builtintype" id="3881101">uint16</span><span class="op" id="3881107">)</span>&nbsp;<span class="ident" id="3881109">keyAgreement</span>&nbsp;<span class="op" id="3881122">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881125">return</span>&nbsp;<span class="op" id="3881132">&amp;</span><span class="ident" id="3881133">ecdheKeyAgreement</span><span class="op" id="3881150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881154">sigType</span><span class="op" id="3881161">:</span>&nbsp;<span class="ident" id="3881163">signatureECDSA</span><span class="op" id="3881177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881181">version</span><span class="op" id="3881188">:</span>&nbsp;<span class="ident" id="3881190">version</span><span class="op" id="3881197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881200">}</span><br>
<span class="lineno"></span><span class="op" id="3881202">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3881205">func</span>&nbsp;<span class="ident" id="3881210">ecdheRSAKA</span><span class="op" id="3881220">(</span><span class="ident" id="3881221">version</span>&nbsp;<span class="builtintype" id="3881229">uint16</span><span class="op" id="3881235">)</span>&nbsp;<span class="ident" id="3881237">keyAgreement</span>&nbsp;<span class="op" id="3881250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881253">return</span>&nbsp;<span class="op" id="3881260">&amp;</span><span class="ident" id="3881261">ecdheKeyAgreement</span><span class="op" id="3881278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881282">sigType</span><span class="op" id="3881289">:</span>&nbsp;<span class="ident" id="3881291">signatureRSA</span><span class="op" id="3881303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881307">version</span><span class="op" id="3881314">:</span>&nbsp;<span class="ident" id="3881316">version</span><span class="op" id="3881323">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881326">}</span><br>
<span class="lineno"></span><span class="op" id="3881328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881331">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3881400">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3881450">func</span>&nbsp;<span class="ident" id="3881455">mutualCipherSuite</span><span class="op" id="3881472">(</span><span class="ident" id="3881473">have</span>&nbsp;<span class="op" id="3881478">[</span><span class="op" id="3881479">]</span><span class="builtintype" id="3881480">uint16</span><span class="op" id="3881486">,</span>&nbsp;<span class="ident" id="3881488">want</span>&nbsp;<span class="builtintype" id="3881493">uint16</span><span class="op" id="3881499">)</span>&nbsp;<span class="op" id="3881501">*</span><span class="ident" id="3881502">cipherSuite</span>&nbsp;<span class="op" id="3881514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881517">for</span>&nbsp;<span class="ident" id="3881521">_</span><span class="op" id="3881522">,</span>&nbsp;<span class="ident" id="3881524">id</span>&nbsp;<span class="op" id="3881527">:=</span>&nbsp;<span class="keyword" id="3881530">range</span>&nbsp;<span class="ident" id="3881536">have</span>&nbsp;<span class="op" id="3881541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881545">if</span>&nbsp;<span class="ident" id="3881548">id</span>&nbsp;<span class="op" id="3881551">==</span>&nbsp;<span class="ident" id="3881554">want</span>&nbsp;<span class="op" id="3881559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881564">for</span>&nbsp;<span class="ident" id="3881568">_</span><span class="op" id="3881569">,</span>&nbsp;<span class="ident" id="3881571">suite</span>&nbsp;<span class="op" id="3881577">:=</span>&nbsp;<span class="keyword" id="3881580">range</span>&nbsp;<span class="ident" id="3881586">cipherSuites</span>&nbsp;<span class="op" id="3881599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881605">if</span>&nbsp;<span class="ident" id="3881608">suite</span><span class="op" id="3881613">.</span><span class="ident" id="3881614">id</span>&nbsp;<span class="op" id="3881617">==</span>&nbsp;<span class="ident" id="3881620">want</span>&nbsp;<span class="op" id="3881625">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881632">return</span>&nbsp;<span class="ident" id="3881639">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881659">return</span>&nbsp;<span class="ident" id="3881666">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881672">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881678">return</span>&nbsp;<span class="ident" id="3881685">nil</span><br>
<span class="lineno"></span><span class="op" id="3881689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881692">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3881747">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3881816">const</span>&nbsp;<span class="op" id="3881822">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881825">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3881865">uint16</span>&nbsp;<span class="op" id="3881872">=</span>&nbsp;<span class="num" id="3881874">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881882">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3881922">uint16</span>&nbsp;<span class="op" id="3881929">=</span>&nbsp;<span class="num" id="3881931">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881939">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3881979">uint16</span>&nbsp;<span class="op" id="3881986">=</span>&nbsp;<span class="num" id="3881988">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881996">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882036">uint16</span>&nbsp;<span class="op" id="3882043">=</span>&nbsp;<span class="num" id="3882045">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882053">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882093">uint16</span>&nbsp;<span class="op" id="3882100">=</span>&nbsp;<span class="num" id="3882102">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882110">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882150">uint16</span>&nbsp;<span class="op" id="3882157">=</span>&nbsp;<span class="num" id="3882159">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882167">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882207">uint16</span>&nbsp;<span class="op" id="3882214">=</span>&nbsp;<span class="num" id="3882216">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882224">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882264">uint16</span>&nbsp;<span class="op" id="3882271">=</span>&nbsp;<span class="num" id="3882273">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882281">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882321">uint16</span>&nbsp;<span class="op" id="3882328">=</span>&nbsp;<span class="num" id="3882330">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882338">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882378">uint16</span>&nbsp;<span class="op" id="3882385">=</span>&nbsp;<span class="num" id="3882387">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882395">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882435">uint16</span>&nbsp;<span class="op" id="3882442">=</span>&nbsp;<span class="num" id="3882444">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882452">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3882492">uint16</span>&nbsp;<span class="op" id="3882499">=</span>&nbsp;<span class="num" id="3882501">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882509">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3882549">uint16</span>&nbsp;<span class="op" id="3882556">=</span>&nbsp;<span class="num" id="3882558">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3882567">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3882636">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3882687">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882753">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3882771">uint16</span>&nbsp;<span class="op" id="3882778">=</span>&nbsp;<span class="num" id="3882780">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3882787">)</span>
</div>
</body>
</html>
