<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html" class="current">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7069937">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7069993">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7070047">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7070098">package</span>&nbsp;<span class="ident" id="7070106">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070112">import</span>&nbsp;<span class="op" id="7070119">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070122">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070131">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070140">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070157">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070172">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070179">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070185">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070198">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070219">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070230">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070241">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070251">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070262">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7070272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070275">type</span>&nbsp;<span class="ident" id="7070280">respTest</span>&nbsp;<span class="keyword" id="7070289">struct</span>&nbsp;<span class="op" id="7070296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070299">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="7070304">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070312">Resp</span>&nbsp;<span class="ident" id="7070317">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070327">Body</span>&nbsp;<span class="builtintype" id="7070332">string</span><br>
<span class="lineno"></span><span class="op" id="7070339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070342">func</span>&nbsp;<span class="ident" id="7070347">dummyReq</span><span class="op" id="7070355">(</span><span class="ident" id="7070356">method</span>&nbsp;<span class="builtintype" id="7070363">string</span><span class="op" id="7070369">)</span>&nbsp;<span class="op" id="7070371">*</span><span class="ident" id="7070372">Request</span>&nbsp;<span class="op" id="7070380">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070383">return</span>&nbsp;<span class="op" id="7070390">&amp;</span><span class="ident" id="7070391">Request</span><span class="op" id="7070398">{</span><span class="ident" id="7070399">Method</span><span class="op" id="7070405">:</span>&nbsp;<span class="ident" id="7070407">method</span><span class="op" id="7070413">}</span><br>
<span class="lineno"></span><span class="op" id="7070415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070418">func</span>&nbsp;<span class="ident" id="7070423">dummyReq11</span><span class="op" id="7070433">(</span><span class="ident" id="7070434">method</span>&nbsp;<span class="builtintype" id="7070441">string</span><span class="op" id="7070447">)</span>&nbsp;<span class="op" id="7070449">*</span><span class="ident" id="7070450">Request</span>&nbsp;<span class="op" id="7070458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7070461">return</span>&nbsp;<span class="op" id="7070468">&amp;</span><span class="ident" id="7070469">Request</span><span class="op" id="7070476">{</span><span class="ident" id="7070477">Method</span><span class="op" id="7070483">:</span>&nbsp;<span class="ident" id="7070485">method</span><span class="op" id="7070491">,</span>&nbsp;<span class="ident" id="7070493">Proto</span><span class="op" id="7070498">:</span>&nbsp;<span class="string" id="7070500">&#34;HTTP/1.1&#34;</span><span class="op" id="7070510">,</span>&nbsp;<span class="ident" id="7070512">ProtoMajor</span><span class="op" id="7070522">:</span>&nbsp;<span class="num" id="7070524">1</span><span class="op" id="7070525">,</span>&nbsp;<span class="ident" id="7070527">ProtoMinor</span><span class="op" id="7070537">:</span>&nbsp;<span class="num" id="7070539">1</span><span class="op" id="7070540">}</span><br>
<span class="lineno">35</span><span class="op" id="7070542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7070545">var</span>&nbsp;<span class="ident" id="7070549">respTests</span>&nbsp;<span class="op" id="7070559">=</span>&nbsp;<span class="op" id="7070561">[</span><span class="op" id="7070562">]</span><span class="ident" id="7070563">respTest</span><span class="op" id="7070571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7070574">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070621">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070625">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7070647">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070652">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7070676">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070681">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7070688">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070693">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7070706">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070711">Response</span><span class="op" id="7070719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070724">Status</span><span class="op" id="7070730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7070736">&#34;200&nbsp;OK&#34;</span><span class="op" id="7070744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070749">StatusCode</span><span class="op" id="7070759">:</span>&nbsp;<span class="num" id="7070761">200</span><span class="op" id="7070764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070769">Proto</span><span class="op" id="7070774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7070781">&#34;HTTP/1.0&#34;</span><span class="op" id="7070791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070796">ProtoMajor</span><span class="op" id="7070806">:</span>&nbsp;<span class="num" id="7070808">1</span><span class="op" id="7070809">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070814">ProtoMinor</span><span class="op" id="7070824">:</span>&nbsp;<span class="num" id="7070826">0</span><span class="op" id="7070827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070832">Request</span><span class="op" id="7070839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7070844">dummyReq</span><span class="op" id="7070852">(</span><span class="string" id="7070853">&#34;GET&#34;</span><span class="op" id="7070858">)</span><span class="op" id="7070859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070864">Header</span><span class="op" id="7070870">:</span>&nbsp;<span class="ident" id="7070872">Header</span><span class="op" id="7070878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070884">&#34;Connection&#34;</span><span class="op" id="7070896">:</span>&nbsp;<span class="op" id="7070898">{</span><span class="string" id="7070899">&#34;close&#34;</span><span class="op" id="7070906">}</span><span class="op" id="7070907">,</span>&nbsp;<span class="comment" id="7070909">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070934">}</span><span class="op" id="7070935">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070940">Close</span><span class="op" id="7070945">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7070955">true</span><span class="op" id="7070959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070964">ContentLength</span><span class="op" id="7070977">:</span>&nbsp;<span class="op" id="7070979">-</span><span class="num" id="7070980">1</span><span class="op" id="7070981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070985">}</span><span class="op" id="7070986">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070991">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7071004">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071007">}</span><span class="op" id="7071008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7071012">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7071070">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071094">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071098">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7071120">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071125">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7071132">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071137">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7071150">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071155">Response</span><span class="op" id="7071163">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071168">Status</span><span class="op" id="7071174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071183">&#34;200&nbsp;OK&#34;</span><span class="op" id="7071191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071196">StatusCode</span><span class="op" id="7071206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071211">200</span><span class="op" id="7071214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071219">Proto</span><span class="op" id="7071224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071234">&#34;HTTP/1.1&#34;</span><span class="op" id="7071244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071249">ProtoMajor</span><span class="op" id="7071259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071264">1</span><span class="op" id="7071265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071270">ProtoMinor</span><span class="op" id="7071280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071285">1</span><span class="op" id="7071286">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071291">Header</span><span class="op" id="7071297">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071306">Header</span><span class="op" id="7071312">{</span><span class="op" id="7071313">}</span><span class="op" id="7071314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071319">Request</span><span class="op" id="7071326">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071334">dummyReq</span><span class="op" id="7071342">(</span><span class="string" id="7071343">&#34;GET&#34;</span><span class="op" id="7071348">)</span><span class="op" id="7071349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071354">Close</span><span class="op" id="7071359">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7071369">true</span><span class="op" id="7071373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071378">ContentLength</span><span class="op" id="7071391">:</span>&nbsp;<span class="op" id="7071393">-</span><span class="num" id="7071394">1</span><span class="op" id="7071395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071399">}</span><span class="op" id="7071400">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071405">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7071418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071421">}</span><span class="op" id="7071422">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7071426">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071490">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7071520">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071525">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7071532">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071537">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="7071565">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071570">Response</span><span class="op" id="7071578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071583">Status</span><span class="op" id="7071589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071598">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="7071614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071619">StatusCode</span><span class="op" id="7071629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071634">204</span><span class="op" id="7071637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071642">Proto</span><span class="op" id="7071647">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071657">&#34;HTTP/1.1&#34;</span><span class="op" id="7071667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071672">ProtoMajor</span><span class="op" id="7071682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071687">1</span><span class="op" id="7071688">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071693">ProtoMinor</span><span class="op" id="7071703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7071708">1</span><span class="op" id="7071709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071714">Header</span><span class="op" id="7071720">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071729">Header</span><span class="op" id="7071735">{</span><span class="op" id="7071736">}</span><span class="op" id="7071737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071742">Request</span><span class="op" id="7071749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7071757">dummyReq</span><span class="op" id="7071765">(</span><span class="string" id="7071766">&#34;GET&#34;</span><span class="op" id="7071771">)</span><span class="op" id="7071772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071777">Close</span><span class="op" id="7071782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7071792">false</span><span class="op" id="7071797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071802">ContentLength</span><span class="op" id="7071815">:</span>&nbsp;<span class="num" id="7071817">0</span><span class="op" id="7071818">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071822">}</span><span class="op" id="7071823">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071828">&#34;&#34;</span><span class="op" id="7071830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071833">}</span><span class="op" id="7071834">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7071838">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071886">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7071908">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071913">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7071938">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071943">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7071967">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071972">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7071979">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071984">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7071997">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072002">Response</span><span class="op" id="7072010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072015">Status</span><span class="op" id="7072021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7072027">&#34;200&nbsp;OK&#34;</span><span class="op" id="7072035">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072040">StatusCode</span><span class="op" id="7072050">:</span>&nbsp;<span class="num" id="7072052">200</span><span class="op" id="7072055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072060">Proto</span><span class="op" id="7072065">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7072072">&#34;HTTP/1.0&#34;</span><span class="op" id="7072082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072087">ProtoMajor</span><span class="op" id="7072097">:</span>&nbsp;<span class="num" id="7072099">1</span><span class="op" id="7072100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072105">ProtoMinor</span><span class="op" id="7072115">:</span>&nbsp;<span class="num" id="7072117">0</span><span class="op" id="7072118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072123">Request</span><span class="op" id="7072130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7072135">dummyReq</span><span class="op" id="7072143">(</span><span class="string" id="7072144">&#34;GET&#34;</span><span class="op" id="7072149">)</span><span class="op" id="7072150">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072155">Header</span><span class="op" id="7072161">:</span>&nbsp;<span class="ident" id="7072163">Header</span><span class="op" id="7072169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072175">&#34;Connection&#34;</span><span class="op" id="7072187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7072193">{</span><span class="string" id="7072194">&#34;close&#34;</span><span class="op" id="7072201">}</span><span class="op" id="7072202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072208">&#34;Content-Length&#34;</span><span class="op" id="7072224">:</span>&nbsp;<span class="op" id="7072226">{</span><span class="string" id="7072227">&#34;10&#34;</span><span class="op" id="7072231">}</span><span class="op" id="7072232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072237">}</span><span class="op" id="7072238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072243">Close</span><span class="op" id="7072248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7072258">true</span><span class="op" id="7072262">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072267">ContentLength</span><span class="op" id="7072280">:</span>&nbsp;<span class="num" id="7072282">10</span><span class="op" id="7072284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072288">}</span><span class="op" id="7072289">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072294">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7072307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072310">}</span><span class="op" id="7072311">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7072315">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072364">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7072386">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072391">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7072424">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072429">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7072436">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072441">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7072450">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072455">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7072473">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072478">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="7072487">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072492">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="7072508">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072513">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7072521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072526">&#34;\r\n&#34;</span><span class="op" id="7072532">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072537">Response</span><span class="op" id="7072545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072550">Status</span><span class="op" id="7072556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7072568">&#34;200&nbsp;OK&#34;</span><span class="op" id="7072576">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072581">StatusCode</span><span class="op" id="7072591">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7072599">200</span><span class="op" id="7072602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072607">Proto</span><span class="op" id="7072612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7072625">&#34;HTTP/1.1&#34;</span><span class="op" id="7072635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072640">ProtoMajor</span><span class="op" id="7072650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7072658">1</span><span class="op" id="7072659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072664">ProtoMinor</span><span class="op" id="7072674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7072682">1</span><span class="op" id="7072683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072688">Request</span><span class="op" id="7072695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7072706">dummyReq</span><span class="op" id="7072714">(</span><span class="string" id="7072715">&#34;GET&#34;</span><span class="op" id="7072720">)</span><span class="op" id="7072721">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072726">Header</span><span class="op" id="7072732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7072744">Header</span><span class="op" id="7072750">{</span><span class="op" id="7072751">}</span><span class="op" id="7072752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072757">Close</span><span class="op" id="7072762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7072775">false</span><span class="op" id="7072780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072785">ContentLength</span><span class="op" id="7072798">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7072803">-</span><span class="num" id="7072804">1</span><span class="op" id="7072805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072810">TransferEncoding</span><span class="op" id="7072826">:</span>&nbsp;<span class="op" id="7072828">[</span><span class="op" id="7072829">]</span><span class="builtintype" id="7072830">string</span><span class="op" id="7072836">{</span><span class="string" id="7072837">&#34;chunked&#34;</span><span class="op" id="7072846">}</span><span class="op" id="7072847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072851">}</span><span class="op" id="7072852">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072857">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="7072879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072882">}</span><span class="op" id="7072883">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7072887">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072933">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7072955">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072960">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7072993">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7072998">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7073023">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073028">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7073035">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073040">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7073049">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073054">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7073072">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073077">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7073085">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073090">&#34;\r\n&#34;</span><span class="op" id="7073096">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073101">Response</span><span class="op" id="7073109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073114">Status</span><span class="op" id="7073120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7073132">&#34;200&nbsp;OK&#34;</span><span class="op" id="7073140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073145">StatusCode</span><span class="op" id="7073155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073163">200</span><span class="op" id="7073166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073171">Proto</span><span class="op" id="7073176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7073189">&#34;HTTP/1.1&#34;</span><span class="op" id="7073199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073204">ProtoMajor</span><span class="op" id="7073214">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073222">1</span><span class="op" id="7073223">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073228">ProtoMinor</span><span class="op" id="7073238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073246">1</span><span class="op" id="7073247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073252">Request</span><span class="op" id="7073259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7073270">dummyReq</span><span class="op" id="7073278">(</span><span class="string" id="7073279">&#34;GET&#34;</span><span class="op" id="7073284">)</span><span class="op" id="7073285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073290">Header</span><span class="op" id="7073296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7073308">Header</span><span class="op" id="7073314">{</span><span class="op" id="7073315">}</span><span class="op" id="7073316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073321">Close</span><span class="op" id="7073326">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7073339">false</span><span class="op" id="7073344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073349">ContentLength</span><span class="op" id="7073362">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7073367">-</span><span class="num" id="7073368">1</span><span class="op" id="7073369">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073374">TransferEncoding</span><span class="op" id="7073390">:</span>&nbsp;<span class="op" id="7073392">[</span><span class="op" id="7073393">]</span><span class="builtintype" id="7073394">string</span><span class="op" id="7073400">{</span><span class="string" id="7073401">&#34;chunked&#34;</span><span class="op" id="7073410">}</span><span class="op" id="7073411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073415">}</span><span class="op" id="7073416">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073421">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7073434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073437">}</span><span class="op" id="7073438">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073442">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073497">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7073519">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073524">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7073557">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073562">&#34;\r\n&#34;</span><span class="op" id="7073568">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073573">Response</span><span class="op" id="7073581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073586">Status</span><span class="op" id="7073592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7073604">&#34;200&nbsp;OK&#34;</span><span class="op" id="7073612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073617">StatusCode</span><span class="op" id="7073627">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073635">200</span><span class="op" id="7073638">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073643">Proto</span><span class="op" id="7073648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7073661">&#34;HTTP/1.1&#34;</span><span class="op" id="7073671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073676">ProtoMajor</span><span class="op" id="7073686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073694">1</span><span class="op" id="7073695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073700">ProtoMinor</span><span class="op" id="7073710">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7073718">1</span><span class="op" id="7073719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073724">Request</span><span class="op" id="7073731">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7073742">dummyReq</span><span class="op" id="7073750">(</span><span class="string" id="7073751">&#34;HEAD&#34;</span><span class="op" id="7073757">)</span><span class="op" id="7073758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073763">Header</span><span class="op" id="7073769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7073781">Header</span><span class="op" id="7073787">{</span><span class="op" id="7073788">}</span><span class="op" id="7073789">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073794">TransferEncoding</span><span class="op" id="7073810">:</span>&nbsp;<span class="op" id="7073812">[</span><span class="op" id="7073813">]</span><span class="builtintype" id="7073814">string</span><span class="op" id="7073820">{</span><span class="string" id="7073821">&#34;chunked&#34;</span><span class="op" id="7073830">}</span><span class="op" id="7073831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073836">Close</span><span class="op" id="7073841">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7073854">false</span><span class="op" id="7073859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073864">ContentLength</span><span class="op" id="7073877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7073882">-</span><span class="num" id="7073883">1</span><span class="op" id="7073884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073888">}</span><span class="op" id="7073889">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073894">&#34;&#34;</span><span class="op" id="7073896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073899">}</span><span class="op" id="7073900">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073904">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073953">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073957">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7073979">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073984">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7074010">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074015">&#34;\r\n&#34;</span><span class="op" id="7074021">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074026">Response</span><span class="op" id="7074034">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074039">Status</span><span class="op" id="7074045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074057">&#34;200&nbsp;OK&#34;</span><span class="op" id="7074065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074070">StatusCode</span><span class="op" id="7074080">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074088">200</span><span class="op" id="7074091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074096">Proto</span><span class="op" id="7074101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074114">&#34;HTTP/1.0&#34;</span><span class="op" id="7074124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074129">ProtoMajor</span><span class="op" id="7074139">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074147">1</span><span class="op" id="7074148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074153">ProtoMinor</span><span class="op" id="7074163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074171">0</span><span class="op" id="7074172">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074177">Request</span><span class="op" id="7074184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074195">dummyReq</span><span class="op" id="7074203">(</span><span class="string" id="7074204">&#34;HEAD&#34;</span><span class="op" id="7074210">)</span><span class="op" id="7074211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074216">Header</span><span class="op" id="7074222">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074234">Header</span><span class="op" id="7074240">{</span><span class="string" id="7074241">&#34;Content-Length&#34;</span><span class="op" id="7074257">:</span>&nbsp;<span class="op" id="7074259">{</span><span class="string" id="7074260">&#34;256&#34;</span><span class="op" id="7074265">}</span><span class="op" id="7074266">}</span><span class="op" id="7074267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074272">TransferEncoding</span><span class="op" id="7074288">:</span>&nbsp;<span class="ident" id="7074290">nil</span><span class="op" id="7074293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074298">Close</span><span class="op" id="7074303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7074316">true</span><span class="op" id="7074320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074325">ContentLength</span><span class="op" id="7074338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074343">256</span><span class="op" id="7074346">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074350">}</span><span class="op" id="7074351">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074356">&#34;&#34;</span><span class="op" id="7074358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074361">}</span><span class="op" id="7074362">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074366">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074433">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7074455">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074460">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7074486">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074491">&#34;\r\n&#34;</span><span class="op" id="7074497">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074502">Response</span><span class="op" id="7074510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074515">Status</span><span class="op" id="7074521">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074533">&#34;200&nbsp;OK&#34;</span><span class="op" id="7074541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074546">StatusCode</span><span class="op" id="7074556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074564">200</span><span class="op" id="7074567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074572">Proto</span><span class="op" id="7074577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074590">&#34;HTTP/1.1&#34;</span><span class="op" id="7074600">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074605">ProtoMajor</span><span class="op" id="7074615">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074623">1</span><span class="op" id="7074624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074629">ProtoMinor</span><span class="op" id="7074639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074647">1</span><span class="op" id="7074648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074653">Request</span><span class="op" id="7074660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074671">dummyReq</span><span class="op" id="7074679">(</span><span class="string" id="7074680">&#34;HEAD&#34;</span><span class="op" id="7074686">)</span><span class="op" id="7074687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074692">Header</span><span class="op" id="7074698">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074710">Header</span><span class="op" id="7074716">{</span><span class="string" id="7074717">&#34;Content-Length&#34;</span><span class="op" id="7074733">:</span>&nbsp;<span class="op" id="7074735">{</span><span class="string" id="7074736">&#34;256&#34;</span><span class="op" id="7074741">}</span><span class="op" id="7074742">}</span><span class="op" id="7074743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074748">TransferEncoding</span><span class="op" id="7074764">:</span>&nbsp;<span class="ident" id="7074766">nil</span><span class="op" id="7074769">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074774">Close</span><span class="op" id="7074779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7074792">false</span><span class="op" id="7074797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074802">ContentLength</span><span class="op" id="7074815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7074820">256</span><span class="op" id="7074823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074827">}</span><span class="op" id="7074828">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074833">&#34;&#34;</span><span class="op" id="7074835">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074838">}</span><span class="op" id="7074839">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074843">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074910">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7074932">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7074937">&#34;\r\n&#34;</span><span class="op" id="7074943">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074948">Response</span><span class="op" id="7074956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074961">Status</span><span class="op" id="7074967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074979">&#34;200&nbsp;OK&#34;</span><span class="op" id="7074987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074992">StatusCode</span><span class="op" id="7075002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075010">200</span><span class="op" id="7075013">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075018">Proto</span><span class="op" id="7075023">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7075036">&#34;HTTP/1.0&#34;</span><span class="op" id="7075046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075051">ProtoMajor</span><span class="op" id="7075061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075069">1</span><span class="op" id="7075070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075075">ProtoMinor</span><span class="op" id="7075085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075093">0</span><span class="op" id="7075094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075099">Request</span><span class="op" id="7075106">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075117">dummyReq</span><span class="op" id="7075125">(</span><span class="string" id="7075126">&#34;HEAD&#34;</span><span class="op" id="7075132">)</span><span class="op" id="7075133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075138">Header</span><span class="op" id="7075144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075156">Header</span><span class="op" id="7075162">{</span><span class="op" id="7075163">}</span><span class="op" id="7075164">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075169">TransferEncoding</span><span class="op" id="7075185">:</span>&nbsp;<span class="ident" id="7075187">nil</span><span class="op" id="7075190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075195">Close</span><span class="op" id="7075200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7075213">true</span><span class="op" id="7075217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075222">ContentLength</span><span class="op" id="7075235">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075240">-</span><span class="num" id="7075241">1</span><span class="op" id="7075242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075246">}</span><span class="op" id="7075247">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075252">&#34;&#34;</span><span class="op" id="7075254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075257">}</span><span class="op" id="7075258">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7075262">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075296">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075300">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7075322">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075327">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7075351">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075356">&#34;\r\n&#34;</span><span class="op" id="7075362">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075367">Response</span><span class="op" id="7075375">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075380">Status</span><span class="op" id="7075386">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7075392">&#34;200&nbsp;OK&#34;</span><span class="op" id="7075400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075405">StatusCode</span><span class="op" id="7075415">:</span>&nbsp;<span class="num" id="7075417">200</span><span class="op" id="7075420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075425">Proto</span><span class="op" id="7075430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7075437">&#34;HTTP/1.1&#34;</span><span class="op" id="7075447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075452">ProtoMajor</span><span class="op" id="7075462">:</span>&nbsp;<span class="num" id="7075464">1</span><span class="op" id="7075465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075470">ProtoMinor</span><span class="op" id="7075480">:</span>&nbsp;<span class="num" id="7075482">1</span><span class="op" id="7075483">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075488">Request</span><span class="op" id="7075495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075500">dummyReq</span><span class="op" id="7075508">(</span><span class="string" id="7075509">&#34;GET&#34;</span><span class="op" id="7075514">)</span><span class="op" id="7075515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075520">Header</span><span class="op" id="7075526">:</span>&nbsp;<span class="ident" id="7075528">Header</span><span class="op" id="7075534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075540">&#34;Content-Length&#34;</span><span class="op" id="7075556">:</span>&nbsp;<span class="op" id="7075558">{</span><span class="string" id="7075559">&#34;0&#34;</span><span class="op" id="7075562">}</span><span class="op" id="7075563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075568">}</span><span class="op" id="7075569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075574">Close</span><span class="op" id="7075579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7075589">false</span><span class="op" id="7075594">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075599">ContentLength</span><span class="op" id="7075612">:</span>&nbsp;<span class="num" id="7075614">0</span><span class="op" id="7075615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075619">}</span><span class="op" id="7075620">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075625">&#34;&#34;</span><span class="op" id="7075627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075630">}</span><span class="op" id="7075631">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7075635">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7075696">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7075728">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="7075751">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075755">Response</span><span class="op" id="7075763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075768">Status</span><span class="op" id="7075774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7075783">&#34;303&nbsp;&#34;</span><span class="op" id="7075789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075794">StatusCode</span><span class="op" id="7075804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075809">303</span><span class="op" id="7075812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075817">Proto</span><span class="op" id="7075822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7075832">&#34;HTTP/1.0&#34;</span><span class="op" id="7075842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075847">ProtoMajor</span><span class="op" id="7075857">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075862">1</span><span class="op" id="7075863">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075868">ProtoMinor</span><span class="op" id="7075878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7075883">0</span><span class="op" id="7075884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075889">Request</span><span class="op" id="7075896">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075904">dummyReq</span><span class="op" id="7075912">(</span><span class="string" id="7075913">&#34;GET&#34;</span><span class="op" id="7075918">)</span><span class="op" id="7075919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075924">Header</span><span class="op" id="7075930">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075939">Header</span><span class="op" id="7075945">{</span><span class="op" id="7075946">}</span><span class="op" id="7075947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075952">Close</span><span class="op" id="7075957">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7075967">true</span><span class="op" id="7075971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075976">ContentLength</span><span class="op" id="7075989">:</span>&nbsp;<span class="op" id="7075991">-</span><span class="num" id="7075992">1</span><span class="op" id="7075993">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075997">}</span><span class="op" id="7075998">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076003">&#34;&#34;</span><span class="op" id="7076005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076008">}</span><span class="op" id="7076009">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7076013">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7076077">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076141">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="7076163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076167">Response</span><span class="op" id="7076175">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076180">Status</span><span class="op" id="7076186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7076195">&#34;303&nbsp;&#34;</span><span class="op" id="7076201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076206">StatusCode</span><span class="op" id="7076216">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7076221">303</span><span class="op" id="7076224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076229">Proto</span><span class="op" id="7076234">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7076244">&#34;HTTP/1.0&#34;</span><span class="op" id="7076254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076259">ProtoMajor</span><span class="op" id="7076269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7076274">1</span><span class="op" id="7076275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076280">ProtoMinor</span><span class="op" id="7076290">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7076295">0</span><span class="op" id="7076296">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076301">Request</span><span class="op" id="7076308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076316">dummyReq</span><span class="op" id="7076324">(</span><span class="string" id="7076325">&#34;GET&#34;</span><span class="op" id="7076330">)</span><span class="op" id="7076331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076336">Header</span><span class="op" id="7076342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076351">Header</span><span class="op" id="7076357">{</span><span class="op" id="7076358">}</span><span class="op" id="7076359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076364">Close</span><span class="op" id="7076369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7076379">true</span><span class="op" id="7076383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076388">ContentLength</span><span class="op" id="7076401">:</span>&nbsp;<span class="op" id="7076403">-</span><span class="num" id="7076404">1</span><span class="op" id="7076405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076409">}</span><span class="op" id="7076410">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076415">&#34;&#34;</span><span class="op" id="7076417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076420">}</span><span class="op" id="7076421">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7076425">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076506">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="7076627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076631">Response</span><span class="op" id="7076639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076644">Status</span><span class="op" id="7076650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7076656">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7076677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076682">StatusCode</span><span class="op" id="7076692">:</span>&nbsp;<span class="num" id="7076694">206</span><span class="op" id="7076697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076702">Proto</span><span class="op" id="7076707">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7076714">&#34;HTTP/1.1&#34;</span><span class="op" id="7076724">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076729">ProtoMajor</span><span class="op" id="7076739">:</span>&nbsp;<span class="num" id="7076741">1</span><span class="op" id="7076742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076747">ProtoMinor</span><span class="op" id="7076757">:</span>&nbsp;<span class="num" id="7076759">1</span><span class="op" id="7076760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076765">Request</span><span class="op" id="7076772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076777">dummyReq</span><span class="op" id="7076785">(</span><span class="string" id="7076786">&#34;GET&#34;</span><span class="op" id="7076791">)</span><span class="op" id="7076792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076797">Header</span><span class="op" id="7076803">:</span>&nbsp;<span class="ident" id="7076805">Header</span><span class="op" id="7076811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076817">&#34;Content-Type&#34;</span><span class="op" id="7076831">:</span>&nbsp;<span class="op" id="7076833">[</span><span class="op" id="7076834">]</span><span class="builtintype" id="7076835">string</span><span class="op" id="7076841">{</span><span class="string" id="7076842">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="7076891">}</span><span class="op" id="7076892">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076897">}</span><span class="op" id="7076898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076903">Close</span><span class="op" id="7076908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7076918">true</span><span class="op" id="7076922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7076927">ContentLength</span><span class="op" id="7076940">:</span>&nbsp;<span class="op" id="7076942">-</span><span class="num" id="7076943">1</span><span class="op" id="7076944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076948">}</span><span class="op" id="7076949">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7076954">&#34;some&nbsp;body&#34;</span><span class="op" id="7076965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7076968">}</span><span class="op" id="7076969">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7076973">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7077035">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077039">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7077061">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077066">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7077090">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077095">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7077102">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077107">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7077120">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077125">Response</span><span class="op" id="7077133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077138">Status</span><span class="op" id="7077144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7077150">&#34;200&nbsp;OK&#34;</span><span class="op" id="7077158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077163">StatusCode</span><span class="op" id="7077173">:</span>&nbsp;<span class="num" id="7077175">200</span><span class="op" id="7077178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077183">Proto</span><span class="op" id="7077188">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7077195">&#34;HTTP/1.0&#34;</span><span class="op" id="7077205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077210">ProtoMajor</span><span class="op" id="7077220">:</span>&nbsp;<span class="num" id="7077222">1</span><span class="op" id="7077223">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077228">ProtoMinor</span><span class="op" id="7077238">:</span>&nbsp;<span class="num" id="7077240">0</span><span class="op" id="7077241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077246">Header</span><span class="op" id="7077252">:</span>&nbsp;<span class="ident" id="7077254">Header</span><span class="op" id="7077260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077266">&#34;Connection&#34;</span><span class="op" id="7077278">:</span>&nbsp;<span class="op" id="7077280">{</span><span class="string" id="7077281">&#34;close&#34;</span><span class="op" id="7077288">}</span><span class="op" id="7077289">,</span>&nbsp;<span class="comment" id="7077291">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7077316">}</span><span class="op" id="7077317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077322">Close</span><span class="op" id="7077327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7077337">true</span><span class="op" id="7077341">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077346">ContentLength</span><span class="op" id="7077359">:</span>&nbsp;<span class="op" id="7077361">-</span><span class="num" id="7077362">1</span><span class="op" id="7077363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7077367">}</span><span class="op" id="7077368">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077373">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7077386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7077389">}</span><span class="op" id="7077390">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7077394">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7077441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077445">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7077480">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077485">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="7077531">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077536">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="7077563">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077568">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="7077604">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077609">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7077637">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077642">&#34;foobar&#34;</span><span class="op" id="7077650">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077655">Response</span><span class="op" id="7077663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077668">Status</span><span class="op" id="7077674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7077680">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7077701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077706">StatusCode</span><span class="op" id="7077716">:</span>&nbsp;<span class="num" id="7077718">206</span><span class="op" id="7077721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077726">Proto</span><span class="op" id="7077731">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7077738">&#34;HTTP/1.1&#34;</span><span class="op" id="7077748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077753">ProtoMajor</span><span class="op" id="7077763">:</span>&nbsp;<span class="num" id="7077765">1</span><span class="op" id="7077766">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077771">ProtoMinor</span><span class="op" id="7077781">:</span>&nbsp;<span class="num" id="7077783">1</span><span class="op" id="7077784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077789">Request</span><span class="op" id="7077796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077801">dummyReq</span><span class="op" id="7077809">(</span><span class="string" id="7077810">&#34;GET&#34;</span><span class="op" id="7077815">)</span><span class="op" id="7077816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7077821">Header</span><span class="op" id="7077827">:</span>&nbsp;<span class="ident" id="7077829">Header</span><span class="op" id="7077835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077841">&#34;Accept-Ranges&#34;</span><span class="op" id="7077856">:</span>&nbsp;&nbsp;<span class="op" id="7077859">[</span><span class="op" id="7077860">]</span><span class="builtintype" id="7077861">string</span><span class="op" id="7077867">{</span><span class="string" id="7077868">&#34;bytes&#34;</span><span class="op" id="7077875">}</span><span class="op" id="7077876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077882">&#34;Content-Length&#34;</span><span class="op" id="7077898">:</span>&nbsp;<span class="op" id="7077900">[</span><span class="op" id="7077901">]</span><span class="builtintype" id="7077902">string</span><span class="op" id="7077908">{</span><span class="string" id="7077909">&#34;6&#34;</span><span class="op" id="7077912">}</span><span class="op" id="7077913">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077919">&#34;Content-Type&#34;</span><span class="op" id="7077933">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7077937">[</span><span class="op" id="7077938">]</span><span class="builtintype" id="7077939">string</span><span class="op" id="7077945">{</span><span class="string" id="7077946">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="7077973">}</span><span class="op" id="7077974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7077980">&#34;Content-Range&#34;</span><span class="op" id="7077995">:</span>&nbsp;&nbsp;<span class="op" id="7077998">[</span><span class="op" id="7077999">]</span><span class="builtintype" id="7078000">string</span><span class="op" id="7078006">{</span><span class="string" id="7078007">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="7078023">}</span><span class="op" id="7078024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078029">}</span><span class="op" id="7078030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078035">ContentLength</span><span class="op" id="7078048">:</span>&nbsp;<span class="num" id="7078050">6</span><span class="op" id="7078051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078055">}</span><span class="op" id="7078056">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7078061">&#34;foobar&#34;</span><span class="op" id="7078069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078072">}</span><span class="op" id="7078073">,</span><br>
<span class="lineno"></span><span class="op" id="7078075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7078078">func</span>&nbsp;<span class="ident" id="7078083">TestReadResponse</span><span class="op" id="7078099">(</span><span class="ident" id="7078100">t</span>&nbsp;<span class="op" id="7078102">*</span><span class="ident" id="7078103">testing</span><span class="op" id="7078110">.</span><span class="ident" id="7078111">T</span><span class="op" id="7078112">)</span>&nbsp;<span class="op" id="7078114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078117">for</span>&nbsp;<span class="ident" id="7078121">i</span><span class="op" id="7078122">,</span>&nbsp;<span class="ident" id="7078124">tt</span>&nbsp;<span class="op" id="7078127">:=</span>&nbsp;<span class="keyword" id="7078130">range</span>&nbsp;<span class="ident" id="7078136">respTests</span>&nbsp;<span class="op" id="7078146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078150">resp</span><span class="op" id="7078154">,</span>&nbsp;<span class="ident" id="7078156">err</span>&nbsp;<span class="op" id="7078160">:=</span>&nbsp;<span class="ident" id="7078163">ReadResponse</span><span class="op" id="7078175">(</span><span class="ident" id="7078176">bufio</span><span class="op" id="7078181">.</span><span class="ident" id="7078182">NewReader</span><span class="op" id="7078191">(</span><span class="ident" id="7078192">strings</span><span class="op" id="7078199">.</span><span class="ident" id="7078200">NewReader</span><span class="op" id="7078209">(</span><span class="ident" id="7078210">tt</span><span class="op" id="7078212">.</span><span class="ident" id="7078213">Raw</span><span class="op" id="7078216">)</span><span class="op" id="7078217">)</span><span class="op" id="7078218">,</span>&nbsp;<span class="ident" id="7078220">tt</span><span class="op" id="7078222">.</span><span class="ident" id="7078223">Resp</span><span class="op" id="7078227">.</span><span class="ident" id="7078228">Request</span><span class="op" id="7078235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078239">if</span>&nbsp;<span class="ident" id="7078242">err</span>&nbsp;<span class="op" id="7078246">!=</span>&nbsp;<span class="ident" id="7078249">nil</span>&nbsp;<span class="op" id="7078253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078258">t</span><span class="op" id="7078259">.</span><span class="ident" id="7078260">Errorf</span><span class="op" id="7078266">(</span><span class="string" id="7078267">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7078276">,</span>&nbsp;<span class="ident" id="7078278">i</span><span class="op" id="7078279">,</span>&nbsp;<span class="ident" id="7078281">err</span><span class="op" id="7078284">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078289">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078304">rbody</span>&nbsp;<span class="op" id="7078310">:=</span>&nbsp;<span class="ident" id="7078313">resp</span><span class="op" id="7078317">.</span><span class="ident" id="7078318">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078325">resp</span><span class="op" id="7078329">.</span><span class="ident" id="7078330">Body</span>&nbsp;<span class="op" id="7078335">=</span>&nbsp;<span class="ident" id="7078337">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078343">diff</span><span class="op" id="7078347">(</span><span class="ident" id="7078348">t</span><span class="op" id="7078349">,</span>&nbsp;<span class="ident" id="7078351">fmt</span><span class="op" id="7078354">.</span><span class="ident" id="7078355">Sprintf</span><span class="op" id="7078362">(</span><span class="string" id="7078363">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="7078377">,</span>&nbsp;<span class="ident" id="7078379">i</span><span class="op" id="7078380">)</span><span class="op" id="7078381">,</span>&nbsp;<span class="ident" id="7078383">resp</span><span class="op" id="7078387">,</span>&nbsp;<span class="op" id="7078389">&amp;</span><span class="ident" id="7078390">tt</span><span class="op" id="7078392">.</span><span class="ident" id="7078393">Resp</span><span class="op" id="7078397">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078401">var</span>&nbsp;<span class="ident" id="7078405">bout</span>&nbsp;<span class="ident" id="7078410">bytes</span><span class="op" id="7078415">.</span><span class="ident" id="7078416">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078425">if</span>&nbsp;<span class="ident" id="7078428">rbody</span>&nbsp;<span class="op" id="7078434">!=</span>&nbsp;<span class="ident" id="7078437">nil</span>&nbsp;<span class="op" id="7078441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078446">_</span><span class="op" id="7078447">,</span>&nbsp;<span class="ident" id="7078449">err</span>&nbsp;<span class="op" id="7078453">=</span>&nbsp;<span class="ident" id="7078455">io</span><span class="op" id="7078457">.</span><span class="ident" id="7078458">Copy</span><span class="op" id="7078462">(</span><span class="op" id="7078463">&amp;</span><span class="ident" id="7078464">bout</span><span class="op" id="7078468">,</span>&nbsp;<span class="ident" id="7078470">rbody</span><span class="op" id="7078475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078480">if</span>&nbsp;<span class="ident" id="7078483">err</span>&nbsp;<span class="op" id="7078487">!=</span>&nbsp;<span class="ident" id="7078490">nil</span>&nbsp;<span class="op" id="7078494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078500">t</span><span class="op" id="7078501">.</span><span class="ident" id="7078502">Errorf</span><span class="op" id="7078508">(</span><span class="string" id="7078509">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7078518">,</span>&nbsp;<span class="ident" id="7078520">i</span><span class="op" id="7078521">,</span>&nbsp;<span class="ident" id="7078523">err</span><span class="op" id="7078526">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078532">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078549">rbody</span><span class="op" id="7078554">.</span><span class="ident" id="7078555">Close</span><span class="op" id="7078560">(</span><span class="op" id="7078561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078569">body</span>&nbsp;<span class="op" id="7078574">:=</span>&nbsp;<span class="ident" id="7078577">bout</span><span class="op" id="7078581">.</span><span class="ident" id="7078582">String</span><span class="op" id="7078588">(</span><span class="op" id="7078589">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078593">if</span>&nbsp;<span class="ident" id="7078596">body</span>&nbsp;<span class="op" id="7078601">!=</span>&nbsp;<span class="ident" id="7078604">tt</span><span class="op" id="7078606">.</span><span class="ident" id="7078607">Body</span>&nbsp;<span class="op" id="7078612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078617">t</span><span class="op" id="7078618">.</span><span class="ident" id="7078619">Errorf</span><span class="op" id="7078625">(</span><span class="string" id="7078626">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7078650">,</span>&nbsp;<span class="ident" id="7078652">i</span><span class="op" id="7078653">,</span>&nbsp;<span class="ident" id="7078655">body</span><span class="op" id="7078659">,</span>&nbsp;<span class="ident" id="7078661">tt</span><span class="op" id="7078663">.</span><span class="ident" id="7078664">Body</span><span class="op" id="7078668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078675">}</span><br>
<span class="lineno"></span><span class="op" id="7078677">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="7078680">func</span>&nbsp;<span class="ident" id="7078685">TestWriteResponse</span><span class="op" id="7078702">(</span><span class="ident" id="7078703">t</span>&nbsp;<span class="op" id="7078705">*</span><span class="ident" id="7078706">testing</span><span class="op" id="7078713">.</span><span class="ident" id="7078714">T</span><span class="op" id="7078715">)</span>&nbsp;<span class="op" id="7078717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078720">for</span>&nbsp;<span class="ident" id="7078724">i</span><span class="op" id="7078725">,</span>&nbsp;<span class="ident" id="7078727">tt</span>&nbsp;<span class="op" id="7078730">:=</span>&nbsp;<span class="keyword" id="7078733">range</span>&nbsp;<span class="ident" id="7078739">respTests</span>&nbsp;<span class="op" id="7078749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078753">resp</span><span class="op" id="7078757">,</span>&nbsp;<span class="ident" id="7078759">err</span>&nbsp;<span class="op" id="7078763">:=</span>&nbsp;<span class="ident" id="7078766">ReadResponse</span><span class="op" id="7078778">(</span><span class="ident" id="7078779">bufio</span><span class="op" id="7078784">.</span><span class="ident" id="7078785">NewReader</span><span class="op" id="7078794">(</span><span class="ident" id="7078795">strings</span><span class="op" id="7078802">.</span><span class="ident" id="7078803">NewReader</span><span class="op" id="7078812">(</span><span class="ident" id="7078813">tt</span><span class="op" id="7078815">.</span><span class="ident" id="7078816">Raw</span><span class="op" id="7078819">)</span><span class="op" id="7078820">)</span><span class="op" id="7078821">,</span>&nbsp;<span class="ident" id="7078823">tt</span><span class="op" id="7078825">.</span><span class="ident" id="7078826">Resp</span><span class="op" id="7078830">.</span><span class="ident" id="7078831">Request</span><span class="op" id="7078838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078842">if</span>&nbsp;<span class="ident" id="7078845">err</span>&nbsp;<span class="op" id="7078849">!=</span>&nbsp;<span class="ident" id="7078852">nil</span>&nbsp;<span class="op" id="7078856">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078861">t</span><span class="op" id="7078862">.</span><span class="ident" id="7078863">Errorf</span><span class="op" id="7078869">(</span><span class="string" id="7078870">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7078879">,</span>&nbsp;<span class="ident" id="7078881">i</span><span class="op" id="7078882">,</span>&nbsp;<span class="ident" id="7078884">err</span><span class="op" id="7078887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078892">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7078903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078907">err</span>&nbsp;<span class="op" id="7078911">=</span>&nbsp;<span class="ident" id="7078913">resp</span><span class="op" id="7078917">.</span><span class="ident" id="7078918">Write</span><span class="op" id="7078923">(</span><span class="ident" id="7078924">ioutil</span><span class="op" id="7078930">.</span><span class="ident" id="7078931">Discard</span><span class="op" id="7078938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078942">if</span>&nbsp;<span class="ident" id="7078945">err</span>&nbsp;<span class="op" id="7078949">!=</span>&nbsp;<span class="ident" id="7078952">nil</span>&nbsp;<span class="op" id="7078956">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7078961">t</span><span class="op" id="7078962">.</span><span class="ident" id="7078963">Errorf</span><span class="op" id="7078969">(</span><span class="string" id="7078970">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7078979">,</span>&nbsp;<span class="ident" id="7078981">i</span><span class="op" id="7078982">,</span>&nbsp;<span class="ident" id="7078984">err</span><span class="op" id="7078987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7078992">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079006">}</span><br>
<span class="lineno"></span><span class="op" id="7079008">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="7079011">var</span>&nbsp;<span class="ident" id="7079015">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7079046">=</span>&nbsp;<span class="op" id="7079048">[</span><span class="op" id="7079049">]</span><span class="keyword" id="7079050">struct</span>&nbsp;<span class="op" id="7079057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079060">chunked</span><span class="op" id="7079067">,</span>&nbsp;<span class="ident" id="7079069">compressed</span>&nbsp;<span class="builtintype" id="7079080">bool</span><br>
<span class="lineno"></span><span class="op" id="7079085">}</span><span class="op" id="7079086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079089">{</span><span class="builtintype" id="7079090">false</span><span class="op" id="7079095">,</span>&nbsp;<span class="builtintype" id="7079097">false</span><span class="op" id="7079102">}</span><span class="op" id="7079103">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079106">{</span><span class="builtintype" id="7079107">true</span><span class="op" id="7079111">,</span>&nbsp;<span class="builtintype" id="7079113">false</span><span class="op" id="7079118">}</span><span class="op" id="7079119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079122">{</span><span class="builtintype" id="7079123">true</span><span class="op" id="7079127">,</span>&nbsp;<span class="builtintype" id="7079129">true</span><span class="op" id="7079133">}</span><span class="op" id="7079134">,</span><br>
<span class="lineno"></span><span class="op" id="7079136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7079139">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="7079204">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="7079273">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="7079322">func</span>&nbsp;<span class="ident" id="7079327">TestReadResponseCloseInMiddle</span><span class="op" id="7079356">(</span><span class="ident" id="7079357">t</span>&nbsp;<span class="op" id="7079359">*</span><span class="ident" id="7079360">testing</span><span class="op" id="7079367">.</span><span class="ident" id="7079368">T</span><span class="op" id="7079369">)</span>&nbsp;<span class="op" id="7079371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079374">for</span>&nbsp;<span class="ident" id="7079378">_</span><span class="op" id="7079379">,</span>&nbsp;<span class="ident" id="7079381">test</span>&nbsp;<span class="op" id="7079386">:=</span>&nbsp;<span class="keyword" id="7079389">range</span>&nbsp;<span class="ident" id="7079395">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7079426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079430">fatalf</span>&nbsp;<span class="op" id="7079437">:=</span>&nbsp;<span class="keyword" id="7079440">func</span><span class="op" id="7079444">(</span><span class="ident" id="7079445">format</span>&nbsp;<span class="builtintype" id="7079452">string</span><span class="op" id="7079458">,</span>&nbsp;<span class="ident" id="7079460">args</span>&nbsp;<span class="op" id="7079465">...</span><span class="keyword" id="7079468">interface</span><span class="op" id="7079477">{</span><span class="op" id="7079478">}</span><span class="op" id="7079479">)</span>&nbsp;<span class="op" id="7079481">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079486">args</span>&nbsp;<span class="op" id="7079491">=</span>&nbsp;<span class="builtinfunc" id="7079493">append</span><span class="op" id="7079499">(</span><span class="op" id="7079500">[</span><span class="op" id="7079501">]</span><span class="keyword" id="7079502">interface</span><span class="op" id="7079511">{</span><span class="op" id="7079512">}</span><span class="op" id="7079513">{</span><span class="ident" id="7079514">test</span><span class="op" id="7079518">.</span><span class="ident" id="7079519">chunked</span><span class="op" id="7079526">,</span>&nbsp;<span class="ident" id="7079528">test</span><span class="op" id="7079532">.</span><span class="ident" id="7079533">compressed</span><span class="op" id="7079543">}</span><span class="op" id="7079544">,</span>&nbsp;<span class="ident" id="7079546">args</span><span class="op" id="7079550">...</span><span class="op" id="7079553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079558">t</span><span class="op" id="7079559">.</span><span class="ident" id="7079560">Fatalf</span><span class="op" id="7079566">(</span><span class="string" id="7079567">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="7079604">+</span><span class="ident" id="7079605">format</span><span class="op" id="7079611">,</span>&nbsp;<span class="ident" id="7079613">args</span><span class="op" id="7079617">...</span><span class="op" id="7079620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079628">checkErr</span>&nbsp;<span class="op" id="7079637">:=</span>&nbsp;<span class="keyword" id="7079640">func</span><span class="op" id="7079644">(</span><span class="ident" id="7079645">err</span>&nbsp;<span class="builtintype" id="7079649">error</span><span class="op" id="7079654">,</span>&nbsp;<span class="ident" id="7079656">msg</span>&nbsp;<span class="builtintype" id="7079660">string</span><span class="op" id="7079666">)</span>&nbsp;<span class="op" id="7079668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079673">if</span>&nbsp;<span class="ident" id="7079676">err</span>&nbsp;<span class="op" id="7079680">==</span>&nbsp;<span class="ident" id="7079683">nil</span>&nbsp;<span class="op" id="7079687">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079693">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079708">fatalf</span><span class="op" id="7079714">(</span><span class="ident" id="7079715">msg</span><span class="op" id="7079718">+</span><span class="string" id="7079719">&#34;:&nbsp;%v&#34;</span><span class="op" id="7079725">,</span>&nbsp;<span class="ident" id="7079727">err</span><span class="op" id="7079730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079738">var</span>&nbsp;<span class="ident" id="7079742">buf</span>&nbsp;<span class="ident" id="7079746">bytes</span><span class="op" id="7079751">.</span><span class="ident" id="7079752">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079761">buf</span><span class="op" id="7079764">.</span><span class="ident" id="7079765">WriteString</span><span class="op" id="7079776">(</span><span class="string" id="7079777">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="7079798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079802">if</span>&nbsp;<span class="ident" id="7079805">test</span><span class="op" id="7079809">.</span><span class="ident" id="7079810">chunked</span>&nbsp;<span class="op" id="7079818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079823">buf</span><span class="op" id="7079826">.</span><span class="ident" id="7079827">WriteString</span><span class="op" id="7079838">(</span><span class="string" id="7079839">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="7079871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079875">}</span>&nbsp;<span class="keyword" id="7079877">else</span>&nbsp;<span class="op" id="7079882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079887">buf</span><span class="op" id="7079890">.</span><span class="ident" id="7079891">WriteString</span><span class="op" id="7079902">(</span><span class="string" id="7079903">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="7079932">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7079936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079940">var</span>&nbsp;<span class="ident" id="7079944">wr</span>&nbsp;<span class="ident" id="7079947">io</span><span class="op" id="7079949">.</span><span class="ident" id="7079950">Writer</span>&nbsp;<span class="op" id="7079957">=</span>&nbsp;<span class="op" id="7079959">&amp;</span><span class="ident" id="7079960">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7079966">if</span>&nbsp;<span class="ident" id="7079969">test</span><span class="op" id="7079973">.</span><span class="ident" id="7079974">chunked</span>&nbsp;<span class="op" id="7079982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7079987">wr</span>&nbsp;<span class="op" id="7079990">=</span>&nbsp;<span class="ident" id="7079992">internal</span><span class="op" id="7080000">.</span><span class="ident" id="7080001">NewChunkedWriter</span><span class="op" id="7080017">(</span><span class="ident" id="7080018">wr</span><span class="op" id="7080020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080024">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080028">if</span>&nbsp;<span class="ident" id="7080031">test</span><span class="op" id="7080035">.</span><span class="ident" id="7080036">compressed</span>&nbsp;<span class="op" id="7080047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080052">buf</span><span class="op" id="7080055">.</span><span class="ident" id="7080056">WriteString</span><span class="op" id="7080067">(</span><span class="string" id="7080068">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="7080096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080101">wr</span>&nbsp;<span class="op" id="7080104">=</span>&nbsp;<span class="ident" id="7080106">gzip</span><span class="op" id="7080110">.</span><span class="ident" id="7080111">NewWriter</span><span class="op" id="7080120">(</span><span class="ident" id="7080121">wr</span><span class="op" id="7080123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080131">buf</span><span class="op" id="7080134">.</span><span class="ident" id="7080135">WriteString</span><span class="op" id="7080146">(</span><span class="string" id="7080147">&#34;\r\n&#34;</span><span class="op" id="7080153">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080158">chunk</span>&nbsp;<span class="op" id="7080164">:=</span>&nbsp;<span class="ident" id="7080167">bytes</span><span class="op" id="7080172">.</span><span class="ident" id="7080173">Repeat</span><span class="op" id="7080179">(</span><span class="op" id="7080180">[</span><span class="op" id="7080181">]</span><span class="builtintype" id="7080182">byte</span><span class="op" id="7080186">{</span><span class="string" id="7080187">&#39;x&#39;</span><span class="op" id="7080190">}</span><span class="op" id="7080191">,</span>&nbsp;<span class="num" id="7080193">1000</span><span class="op" id="7080197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080201">for</span>&nbsp;<span class="ident" id="7080205">i</span>&nbsp;<span class="op" id="7080207">:=</span>&nbsp;<span class="num" id="7080210">0</span><span class="op" id="7080211">;</span>&nbsp;<span class="ident" id="7080213">i</span>&nbsp;<span class="op" id="7080215">&lt;</span>&nbsp;<span class="num" id="7080217">1000</span><span class="op" id="7080221">;</span>&nbsp;<span class="ident" id="7080223">i</span><span class="op" id="7080224">++</span>&nbsp;<span class="op" id="7080227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080232">if</span>&nbsp;<span class="ident" id="7080235">test</span><span class="op" id="7080239">.</span><span class="ident" id="7080240">compressed</span>&nbsp;<span class="op" id="7080251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7080257">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080300">_</span><span class="op" id="7080301">,</span>&nbsp;<span class="ident" id="7080303">err</span>&nbsp;<span class="op" id="7080307">:=</span>&nbsp;<span class="ident" id="7080310">io</span><span class="op" id="7080312">.</span><span class="ident" id="7080313">ReadFull</span><span class="op" id="7080321">(</span><span class="ident" id="7080322">rand</span><span class="op" id="7080326">.</span><span class="ident" id="7080327">Reader</span><span class="op" id="7080333">,</span>&nbsp;<span class="ident" id="7080335">chunk</span><span class="op" id="7080340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080346">checkErr</span><span class="op" id="7080354">(</span><span class="ident" id="7080355">err</span><span class="op" id="7080358">,</span>&nbsp;<span class="string" id="7080360">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="7080382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080392">wr</span><span class="op" id="7080394">.</span><span class="ident" id="7080395">Write</span><span class="op" id="7080400">(</span><span class="ident" id="7080401">chunk</span><span class="op" id="7080406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080410">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080414">if</span>&nbsp;<span class="ident" id="7080417">test</span><span class="op" id="7080421">.</span><span class="ident" id="7080422">compressed</span>&nbsp;<span class="op" id="7080433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080438">err</span>&nbsp;<span class="op" id="7080442">:=</span>&nbsp;<span class="ident" id="7080445">wr</span><span class="op" id="7080447">.</span><span class="op" id="7080448">(</span><span class="op" id="7080449">*</span><span class="ident" id="7080450">gzip</span><span class="op" id="7080454">.</span><span class="ident" id="7080455">Writer</span><span class="op" id="7080461">)</span><span class="op" id="7080462">.</span><span class="ident" id="7080463">Close</span><span class="op" id="7080468">(</span><span class="op" id="7080469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080474">checkErr</span><span class="op" id="7080482">(</span><span class="ident" id="7080483">err</span><span class="op" id="7080486">,</span>&nbsp;<span class="string" id="7080488">&#34;compressor&nbsp;close&#34;</span><span class="op" id="7080506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080514">if</span>&nbsp;<span class="ident" id="7080517">test</span><span class="op" id="7080521">.</span><span class="ident" id="7080522">chunked</span>&nbsp;<span class="op" id="7080530">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080535">buf</span><span class="op" id="7080538">.</span><span class="ident" id="7080539">WriteString</span><span class="op" id="7080550">(</span><span class="string" id="7080551">&#34;0\r\n\r\n&#34;</span><span class="op" id="7080562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080570">buf</span><span class="op" id="7080573">.</span><span class="ident" id="7080574">WriteString</span><span class="op" id="7080585">(</span><span class="string" id="7080586">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7080605">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080610">bufr</span>&nbsp;<span class="op" id="7080615">:=</span>&nbsp;<span class="ident" id="7080618">bufio</span><span class="op" id="7080623">.</span><span class="ident" id="7080624">NewReader</span><span class="op" id="7080633">(</span><span class="op" id="7080634">&amp;</span><span class="ident" id="7080635">buf</span><span class="op" id="7080638">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080642">resp</span><span class="op" id="7080646">,</span>&nbsp;<span class="ident" id="7080648">err</span>&nbsp;<span class="op" id="7080652">:=</span>&nbsp;<span class="ident" id="7080655">ReadResponse</span><span class="op" id="7080667">(</span><span class="ident" id="7080668">bufr</span><span class="op" id="7080672">,</span>&nbsp;<span class="ident" id="7080674">dummyReq</span><span class="op" id="7080682">(</span><span class="string" id="7080683">&#34;GET&#34;</span><span class="op" id="7080688">)</span><span class="op" id="7080689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080693">checkErr</span><span class="op" id="7080701">(</span><span class="ident" id="7080702">err</span><span class="op" id="7080705">,</span>&nbsp;<span class="string" id="7080707">&#34;ReadResponse&#34;</span><span class="op" id="7080721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080725">expectedLength</span>&nbsp;<span class="op" id="7080740">:=</span>&nbsp;<span class="ident" id="7080743">int64</span><span class="op" id="7080748">(</span><span class="op" id="7080749">-</span><span class="num" id="7080750">1</span><span class="op" id="7080751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080755">if</span>&nbsp;<span class="op" id="7080758">!</span><span class="ident" id="7080759">test</span><span class="op" id="7080763">.</span><span class="ident" id="7080764">chunked</span>&nbsp;<span class="op" id="7080772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080777">expectedLength</span>&nbsp;<span class="op" id="7080792">=</span>&nbsp;<span class="num" id="7080794">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080808">if</span>&nbsp;<span class="ident" id="7080811">resp</span><span class="op" id="7080815">.</span><span class="ident" id="7080816">ContentLength</span>&nbsp;<span class="op" id="7080830">!=</span>&nbsp;<span class="ident" id="7080833">expectedLength</span>&nbsp;<span class="op" id="7080848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080853">fatalf</span><span class="op" id="7080859">(</span><span class="string" id="7080860">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7080897">,</span>&nbsp;<span class="ident" id="7080899">expectedLength</span><span class="op" id="7080913">,</span>&nbsp;<span class="ident" id="7080915">resp</span><span class="op" id="7080919">.</span><span class="ident" id="7080920">ContentLength</span><span class="op" id="7080933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080941">if</span>&nbsp;<span class="ident" id="7080944">resp</span><span class="op" id="7080948">.</span><span class="ident" id="7080949">Body</span>&nbsp;<span class="op" id="7080954">==</span>&nbsp;<span class="ident" id="7080957">nil</span>&nbsp;<span class="op" id="7080961">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7080966">fatalf</span><span class="op" id="7080972">(</span><span class="string" id="7080973">&#34;nil&nbsp;body&#34;</span><span class="op" id="7080983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7080987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7080991">if</span>&nbsp;<span class="ident" id="7080994">test</span><span class="op" id="7080998">.</span><span class="ident" id="7080999">compressed</span>&nbsp;<span class="op" id="7081010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081015">gzReader</span><span class="op" id="7081023">,</span>&nbsp;<span class="ident" id="7081025">err</span>&nbsp;<span class="op" id="7081029">:=</span>&nbsp;<span class="ident" id="7081032">gzip</span><span class="op" id="7081036">.</span><span class="ident" id="7081037">NewReader</span><span class="op" id="7081046">(</span><span class="ident" id="7081047">resp</span><span class="op" id="7081051">.</span><span class="ident" id="7081052">Body</span><span class="op" id="7081056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081061">checkErr</span><span class="op" id="7081069">(</span><span class="ident" id="7081070">err</span><span class="op" id="7081073">,</span>&nbsp;<span class="string" id="7081075">&#34;gzip.NewReader&#34;</span><span class="op" id="7081091">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081096">resp</span><span class="op" id="7081100">.</span><span class="ident" id="7081101">Body</span>&nbsp;<span class="op" id="7081106">=</span>&nbsp;<span class="op" id="7081108">&amp;</span><span class="ident" id="7081109">readerAndCloser</span><span class="op" id="7081124">{</span><span class="ident" id="7081125">gzReader</span><span class="op" id="7081133">,</span>&nbsp;<span class="ident" id="7081135">resp</span><span class="op" id="7081139">.</span><span class="ident" id="7081140">Body</span><span class="op" id="7081144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081153">rbuf</span>&nbsp;<span class="op" id="7081158">:=</span>&nbsp;<span class="builtinfunc" id="7081161">make</span><span class="op" id="7081165">(</span><span class="op" id="7081166">[</span><span class="op" id="7081167">]</span><span class="builtintype" id="7081168">byte</span><span class="op" id="7081172">,</span>&nbsp;<span class="num" id="7081174">2500</span><span class="op" id="7081178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081182">n</span><span class="op" id="7081183">,</span>&nbsp;<span class="ident" id="7081185">err</span>&nbsp;<span class="op" id="7081189">:=</span>&nbsp;<span class="ident" id="7081192">io</span><span class="op" id="7081194">.</span><span class="ident" id="7081195">ReadFull</span><span class="op" id="7081203">(</span><span class="ident" id="7081204">resp</span><span class="op" id="7081208">.</span><span class="ident" id="7081209">Body</span><span class="op" id="7081213">,</span>&nbsp;<span class="ident" id="7081215">rbuf</span><span class="op" id="7081219">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081223">checkErr</span><span class="op" id="7081231">(</span><span class="ident" id="7081232">err</span><span class="op" id="7081235">,</span>&nbsp;<span class="string" id="7081237">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="7081257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081261">if</span>&nbsp;<span class="ident" id="7081264">n</span>&nbsp;<span class="op" id="7081266">!=</span>&nbsp;<span class="num" id="7081269">2500</span>&nbsp;<span class="op" id="7081274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081279">fatalf</span><span class="op" id="7081285">(</span><span class="string" id="7081286">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="7081315">,</span>&nbsp;<span class="ident" id="7081317">n</span><span class="op" id="7081318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081326">if</span>&nbsp;<span class="ident" id="7081329">test</span><span class="op" id="7081333">.</span><span class="ident" id="7081334">compressed</span>&nbsp;<span class="op" id="7081345">==</span>&nbsp;<span class="builtintype" id="7081348">false</span>&nbsp;<span class="op" id="7081354">&amp;&amp;</span>&nbsp;<span class="op" id="7081357">!</span><span class="ident" id="7081358">bytes</span><span class="op" id="7081363">.</span><span class="ident" id="7081364">Equal</span><span class="op" id="7081369">(</span><span class="ident" id="7081370">bytes</span><span class="op" id="7081375">.</span><span class="ident" id="7081376">Repeat</span><span class="op" id="7081382">(</span><span class="op" id="7081383">[</span><span class="op" id="7081384">]</span><span class="builtintype" id="7081385">byte</span><span class="op" id="7081389">{</span><span class="string" id="7081390">&#39;x&#39;</span><span class="op" id="7081393">}</span><span class="op" id="7081394">,</span>&nbsp;<span class="num" id="7081396">2500</span><span class="op" id="7081400">)</span><span class="op" id="7081401">,</span>&nbsp;<span class="ident" id="7081403">rbuf</span><span class="op" id="7081407">)</span>&nbsp;<span class="op" id="7081409">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081414">fatalf</span><span class="op" id="7081420">(</span><span class="string" id="7081421">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7081460">,</span>&nbsp;<span class="builtintype" id="7081462">string</span><span class="op" id="7081468">(</span><span class="ident" id="7081469">rbuf</span><span class="op" id="7081473">)</span><span class="op" id="7081474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081482">resp</span><span class="op" id="7081486">.</span><span class="ident" id="7081487">Body</span><span class="op" id="7081491">.</span><span class="ident" id="7081492">Close</span><span class="op" id="7081497">(</span><span class="op" id="7081498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081503">rest</span><span class="op" id="7081507">,</span>&nbsp;<span class="ident" id="7081509">err</span>&nbsp;<span class="op" id="7081513">:=</span>&nbsp;<span class="ident" id="7081516">ioutil</span><span class="op" id="7081522">.</span><span class="ident" id="7081523">ReadAll</span><span class="op" id="7081530">(</span><span class="ident" id="7081531">bufr</span><span class="op" id="7081535">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081539">checkErr</span><span class="op" id="7081547">(</span><span class="ident" id="7081548">err</span><span class="op" id="7081551">,</span>&nbsp;<span class="string" id="7081553">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="7081575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081579">if</span>&nbsp;<span class="ident" id="7081582">e</span><span class="op" id="7081583">,</span>&nbsp;<span class="ident" id="7081585">g</span>&nbsp;<span class="op" id="7081587">:=</span>&nbsp;<span class="string" id="7081590">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7081609">,</span>&nbsp;<span class="builtintype" id="7081611">string</span><span class="op" id="7081617">(</span><span class="ident" id="7081618">rest</span><span class="op" id="7081622">)</span><span class="op" id="7081623">;</span>&nbsp;<span class="ident" id="7081625">e</span>&nbsp;<span class="op" id="7081627">!=</span>&nbsp;<span class="ident" id="7081630">g</span>&nbsp;<span class="op" id="7081632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081637">g</span>&nbsp;<span class="op" id="7081639">=</span>&nbsp;<span class="ident" id="7081641">regexp</span><span class="op" id="7081647">.</span><span class="ident" id="7081648">MustCompile</span><span class="op" id="7081659">(</span><span class="string" id="7081660">`(xx+)`</span><span class="op" id="7081667">)</span><span class="op" id="7081668">.</span><span class="ident" id="7081669">ReplaceAllStringFunc</span><span class="op" id="7081689">(</span><span class="ident" id="7081690">g</span><span class="op" id="7081691">,</span>&nbsp;<span class="keyword" id="7081693">func</span><span class="op" id="7081697">(</span><span class="ident" id="7081698">match</span>&nbsp;<span class="builtintype" id="7081704">string</span><span class="op" id="7081710">)</span>&nbsp;<span class="builtintype" id="7081712">string</span>&nbsp;<span class="op" id="7081719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081725">return</span>&nbsp;<span class="ident" id="7081732">fmt</span><span class="op" id="7081735">.</span><span class="ident" id="7081736">Sprintf</span><span class="op" id="7081743">(</span><span class="string" id="7081744">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="7081761">,</span>&nbsp;<span class="builtinfunc" id="7081763">len</span><span class="op" id="7081766">(</span><span class="ident" id="7081767">match</span><span class="op" id="7081772">)</span><span class="op" id="7081773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081778">}</span><span class="op" id="7081779">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081784">fatalf</span><span class="op" id="7081790">(</span><span class="string" id="7081791">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7081820">,</span>&nbsp;<span class="ident" id="7081822">g</span><span class="op" id="7081823">,</span>&nbsp;<span class="ident" id="7081825">e</span><span class="op" id="7081826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7081833">}</span><br>
<span class="lineno"></span><span class="op" id="7081835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="7081838">func</span>&nbsp;<span class="ident" id="7081843">diff</span><span class="op" id="7081847">(</span><span class="ident" id="7081848">t</span>&nbsp;<span class="op" id="7081850">*</span><span class="ident" id="7081851">testing</span><span class="op" id="7081858">.</span><span class="ident" id="7081859">T</span><span class="op" id="7081860">,</span>&nbsp;<span class="ident" id="7081862">prefix</span>&nbsp;<span class="builtintype" id="7081869">string</span><span class="op" id="7081875">,</span>&nbsp;<span class="ident" id="7081877">have</span><span class="op" id="7081881">,</span>&nbsp;<span class="ident" id="7081883">want</span>&nbsp;<span class="keyword" id="7081888">interface</span><span class="op" id="7081897">{</span><span class="op" id="7081898">}</span><span class="op" id="7081899">)</span>&nbsp;<span class="op" id="7081901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081904">hv</span>&nbsp;<span class="op" id="7081907">:=</span>&nbsp;<span class="ident" id="7081910">reflect</span><span class="op" id="7081917">.</span><span class="ident" id="7081918">ValueOf</span><span class="op" id="7081925">(</span><span class="ident" id="7081926">have</span><span class="op" id="7081930">)</span><span class="op" id="7081931">.</span><span class="ident" id="7081932">Elem</span><span class="op" id="7081936">(</span><span class="op" id="7081937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7081940">wv</span>&nbsp;<span class="op" id="7081943">:=</span>&nbsp;<span class="ident" id="7081946">reflect</span><span class="op" id="7081953">.</span><span class="ident" id="7081954">ValueOf</span><span class="op" id="7081961">(</span><span class="ident" id="7081962">want</span><span class="op" id="7081966">)</span><span class="op" id="7081967">.</span><span class="ident" id="7081968">Elem</span><span class="op" id="7081972">(</span><span class="op" id="7081973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7081976">if</span>&nbsp;<span class="ident" id="7081979">hv</span><span class="op" id="7081981">.</span><span class="ident" id="7081982">Type</span><span class="op" id="7081986">(</span><span class="op" id="7081987">)</span>&nbsp;<span class="op" id="7081989">!=</span>&nbsp;<span class="ident" id="7081992">wv</span><span class="op" id="7081994">.</span><span class="ident" id="7081995">Type</span><span class="op" id="7081999">(</span><span class="op" id="7082000">)</span>&nbsp;<span class="op" id="7082002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082006">t</span><span class="op" id="7082007">.</span><span class="ident" id="7082008">Errorf</span><span class="op" id="7082014">(</span><span class="string" id="7082015">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7082045">,</span>&nbsp;<span class="ident" id="7082047">prefix</span><span class="op" id="7082053">,</span>&nbsp;<span class="ident" id="7082055">hv</span><span class="op" id="7082057">.</span><span class="ident" id="7082058">Type</span><span class="op" id="7082062">(</span><span class="op" id="7082063">)</span><span class="op" id="7082064">,</span>&nbsp;<span class="ident" id="7082066">wv</span><span class="op" id="7082068">.</span><span class="ident" id="7082069">Type</span><span class="op" id="7082073">(</span><span class="op" id="7082074">)</span><span class="op" id="7082075">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7082081">for</span>&nbsp;<span class="ident" id="7082085">i</span>&nbsp;<span class="op" id="7082087">:=</span>&nbsp;<span class="num" id="7082090">0</span><span class="op" id="7082091">;</span>&nbsp;<span class="ident" id="7082093">i</span>&nbsp;<span class="op" id="7082095">&lt;</span>&nbsp;<span class="ident" id="7082097">hv</span><span class="op" id="7082099">.</span><span class="ident" id="7082100">NumField</span><span class="op" id="7082108">(</span><span class="op" id="7082109">)</span><span class="op" id="7082110">;</span>&nbsp;<span class="ident" id="7082112">i</span><span class="op" id="7082113">++</span>&nbsp;<span class="op" id="7082116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082120">hf</span>&nbsp;<span class="op" id="7082123">:=</span>&nbsp;<span class="ident" id="7082126">hv</span><span class="op" id="7082128">.</span><span class="ident" id="7082129">Field</span><span class="op" id="7082134">(</span><span class="ident" id="7082135">i</span><span class="op" id="7082136">)</span><span class="op" id="7082137">.</span><span class="ident" id="7082138">Interface</span><span class="op" id="7082147">(</span><span class="op" id="7082148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082152">wf</span>&nbsp;<span class="op" id="7082155">:=</span>&nbsp;<span class="ident" id="7082158">wv</span><span class="op" id="7082160">.</span><span class="ident" id="7082161">Field</span><span class="op" id="7082166">(</span><span class="ident" id="7082167">i</span><span class="op" id="7082168">)</span><span class="op" id="7082169">.</span><span class="ident" id="7082170">Interface</span><span class="op" id="7082179">(</span><span class="op" id="7082180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7082184">if</span>&nbsp;<span class="op" id="7082187">!</span><span class="ident" id="7082188">reflect</span><span class="op" id="7082195">.</span><span class="ident" id="7082196">DeepEqual</span><span class="op" id="7082205">(</span><span class="ident" id="7082206">hf</span><span class="op" id="7082208">,</span>&nbsp;<span class="ident" id="7082210">wf</span><span class="op" id="7082212">)</span>&nbsp;<span class="op" id="7082214">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082219">t</span><span class="op" id="7082220">.</span><span class="ident" id="7082221">Errorf</span><span class="op" id="7082227">(</span><span class="string" id="7082228">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7082249">,</span>&nbsp;<span class="ident" id="7082251">prefix</span><span class="op" id="7082257">,</span>&nbsp;<span class="ident" id="7082259">hv</span><span class="op" id="7082261">.</span><span class="ident" id="7082262">Type</span><span class="op" id="7082266">(</span><span class="op" id="7082267">)</span><span class="op" id="7082268">.</span><span class="ident" id="7082269">Field</span><span class="op" id="7082274">(</span><span class="ident" id="7082275">i</span><span class="op" id="7082276">)</span><span class="op" id="7082277">.</span><span class="ident" id="7082278">Name</span><span class="op" id="7082282">,</span>&nbsp;<span class="ident" id="7082284">hf</span><span class="op" id="7082286">,</span>&nbsp;<span class="ident" id="7082288">wf</span><span class="op" id="7082290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082297">}</span><br>
<span class="lineno"></span><span class="op" id="7082299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="7082302">type</span>&nbsp;<span class="ident" id="7082307">responseLocationTest</span>&nbsp;<span class="keyword" id="7082328">struct</span>&nbsp;<span class="op" id="7082335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082338">location</span>&nbsp;<span class="builtintype" id="7082347">string</span>&nbsp;<span class="comment" id="7082354">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082391">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7082400">string</span>&nbsp;<span class="comment" id="7082407">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082438">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7082447">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082455">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="7082464">error</span><br>
<span class="lineno">570</span><span class="op" id="7082470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7082473">var</span>&nbsp;<span class="ident" id="7082477">responseLocationTests</span>&nbsp;<span class="op" id="7082499">=</span>&nbsp;<span class="op" id="7082501">[</span><span class="op" id="7082502">]</span><span class="ident" id="7082503">responseLocationTest</span><span class="op" id="7082523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082526">{</span><span class="string" id="7082527">&#34;/foo&#34;</span><span class="op" id="7082533">,</span>&nbsp;<span class="string" id="7082535">&#34;http://bar.com/baz&#34;</span><span class="op" id="7082555">,</span>&nbsp;<span class="string" id="7082557">&#34;http://bar.com/foo&#34;</span><span class="op" id="7082577">,</span>&nbsp;<span class="ident" id="7082579">nil</span><span class="op" id="7082582">}</span><span class="op" id="7082583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082586">{</span><span class="string" id="7082587">&#34;http://foo.com/&#34;</span><span class="op" id="7082604">,</span>&nbsp;<span class="string" id="7082606">&#34;http://bar.com/baz&#34;</span><span class="op" id="7082626">,</span>&nbsp;<span class="string" id="7082628">&#34;http://foo.com/&#34;</span><span class="op" id="7082645">,</span>&nbsp;<span class="ident" id="7082647">nil</span><span class="op" id="7082650">}</span><span class="op" id="7082651">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7082654">{</span><span class="string" id="7082655">&#34;&#34;</span><span class="op" id="7082657">,</span>&nbsp;<span class="string" id="7082659">&#34;http://bar.com/baz&#34;</span><span class="op" id="7082679">,</span>&nbsp;<span class="string" id="7082681">&#34;&#34;</span><span class="op" id="7082683">,</span>&nbsp;<span class="ident" id="7082685">ErrNoLocation</span><span class="op" id="7082698">}</span><span class="op" id="7082699">,</span><br>
<span class="lineno"></span><span class="op" id="7082701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7082704">func</span>&nbsp;<span class="ident" id="7082709">TestLocationResponse</span><span class="op" id="7082729">(</span><span class="ident" id="7082730">t</span>&nbsp;<span class="op" id="7082732">*</span><span class="ident" id="7082733">testing</span><span class="op" id="7082740">.</span><span class="ident" id="7082741">T</span><span class="op" id="7082742">)</span>&nbsp;<span class="op" id="7082744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7082747">for</span>&nbsp;<span class="ident" id="7082751">i</span><span class="op" id="7082752">,</span>&nbsp;<span class="ident" id="7082754">tt</span>&nbsp;<span class="op" id="7082757">:=</span>&nbsp;<span class="keyword" id="7082760">range</span>&nbsp;<span class="ident" id="7082766">responseLocationTests</span>&nbsp;<span class="op" id="7082788">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082792">res</span>&nbsp;<span class="op" id="7082796">:=</span>&nbsp;<span class="builtinfunc" id="7082799">new</span><span class="op" id="7082802">(</span><span class="ident" id="7082803">Response</span><span class="op" id="7082811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082815">res</span><span class="op" id="7082818">.</span><span class="ident" id="7082819">Header</span>&nbsp;<span class="op" id="7082826">=</span>&nbsp;<span class="builtinfunc" id="7082828">make</span><span class="op" id="7082832">(</span><span class="ident" id="7082833">Header</span><span class="op" id="7082839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082843">res</span><span class="op" id="7082846">.</span><span class="ident" id="7082847">Header</span><span class="op" id="7082853">.</span><span class="ident" id="7082854">Set</span><span class="op" id="7082857">(</span><span class="string" id="7082858">&#34;Location&#34;</span><span class="op" id="7082868">,</span>&nbsp;<span class="ident" id="7082870">tt</span><span class="op" id="7082872">.</span><span class="ident" id="7082873">location</span><span class="op" id="7082881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7082885">if</span>&nbsp;<span class="ident" id="7082888">tt</span><span class="op" id="7082890">.</span><span class="ident" id="7082891">requrl</span>&nbsp;<span class="op" id="7082898">!=</span>&nbsp;<span class="string" id="7082901">&#34;&#34;</span>&nbsp;<span class="op" id="7082904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082909">res</span><span class="op" id="7082912">.</span><span class="ident" id="7082913">Request</span>&nbsp;<span class="op" id="7082921">=</span>&nbsp;<span class="op" id="7082923">&amp;</span><span class="ident" id="7082924">Request</span><span class="op" id="7082931">{</span><span class="op" id="7082932">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7082937">var</span>&nbsp;<span class="ident" id="7082941">err</span>&nbsp;<span class="builtintype" id="7082945">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7082954">res</span><span class="op" id="7082957">.</span><span class="ident" id="7082958">Request</span><span class="op" id="7082965">.</span><span class="ident" id="7082966">URL</span><span class="op" id="7082969">,</span>&nbsp;<span class="ident" id="7082971">err</span>&nbsp;<span class="op" id="7082975">=</span>&nbsp;<span class="ident" id="7082977">url</span><span class="op" id="7082980">.</span><span class="ident" id="7082981">Parse</span><span class="op" id="7082986">(</span><span class="ident" id="7082987">tt</span><span class="op" id="7082989">.</span><span class="ident" id="7082990">requrl</span><span class="op" id="7082996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083001">if</span>&nbsp;<span class="ident" id="7083004">err</span>&nbsp;<span class="op" id="7083008">!=</span>&nbsp;<span class="ident" id="7083011">nil</span>&nbsp;<span class="op" id="7083015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083021">t</span><span class="op" id="7083022">.</span><span class="ident" id="7083023">Fatalf</span><span class="op" id="7083029">(</span><span class="string" id="7083030">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7083051">,</span>&nbsp;<span class="ident" id="7083053">tt</span><span class="op" id="7083055">.</span><span class="ident" id="7083056">requrl</span><span class="op" id="7083062">,</span>&nbsp;<span class="ident" id="7083064">err</span><span class="op" id="7083067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083072">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083081">got</span><span class="op" id="7083084">,</span>&nbsp;<span class="ident" id="7083086">err</span>&nbsp;<span class="op" id="7083090">:=</span>&nbsp;<span class="ident" id="7083093">res</span><span class="op" id="7083096">.</span><span class="ident" id="7083097">Location</span><span class="op" id="7083105">(</span><span class="op" id="7083106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083110">if</span>&nbsp;<span class="ident" id="7083113">tt</span><span class="op" id="7083115">.</span><span class="ident" id="7083116">wantErr</span>&nbsp;<span class="op" id="7083124">!=</span>&nbsp;<span class="ident" id="7083127">nil</span>&nbsp;<span class="op" id="7083131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083136">if</span>&nbsp;<span class="ident" id="7083139">err</span>&nbsp;<span class="op" id="7083143">==</span>&nbsp;<span class="ident" id="7083146">nil</span>&nbsp;<span class="op" id="7083150">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083156">t</span><span class="op" id="7083157">.</span><span class="ident" id="7083158">Errorf</span><span class="op" id="7083164">(</span><span class="string" id="7083165">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7083187">,</span>&nbsp;<span class="ident" id="7083189">i</span><span class="op" id="7083190">,</span>&nbsp;<span class="ident" id="7083192">tt</span><span class="op" id="7083194">.</span><span class="ident" id="7083195">wantErr</span><span class="op" id="7083202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083225">if</span>&nbsp;<span class="ident" id="7083228">g</span><span class="op" id="7083229">,</span>&nbsp;<span class="ident" id="7083231">e</span>&nbsp;<span class="op" id="7083233">:=</span>&nbsp;<span class="ident" id="7083236">err</span><span class="op" id="7083239">.</span><span class="ident" id="7083240">Error</span><span class="op" id="7083245">(</span><span class="op" id="7083246">)</span><span class="op" id="7083247">,</span>&nbsp;<span class="ident" id="7083249">tt</span><span class="op" id="7083251">.</span><span class="ident" id="7083252">wantErr</span><span class="op" id="7083259">.</span><span class="ident" id="7083260">Error</span><span class="op" id="7083265">(</span><span class="op" id="7083266">)</span><span class="op" id="7083267">;</span>&nbsp;<span class="ident" id="7083269">g</span>&nbsp;<span class="op" id="7083271">!=</span>&nbsp;<span class="ident" id="7083274">e</span>&nbsp;<span class="op" id="7083276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083282">t</span><span class="op" id="7083283">.</span><span class="ident" id="7083284">Errorf</span><span class="op" id="7083290">(</span><span class="string" id="7083291">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7083312">,</span>&nbsp;<span class="ident" id="7083314">i</span><span class="op" id="7083315">,</span>&nbsp;<span class="ident" id="7083317">g</span><span class="op" id="7083318">,</span>&nbsp;<span class="ident" id="7083320">e</span><span class="op" id="7083321">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083327">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083344">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083359">if</span>&nbsp;<span class="ident" id="7083362">err</span>&nbsp;<span class="op" id="7083366">!=</span>&nbsp;<span class="ident" id="7083369">nil</span>&nbsp;<span class="op" id="7083373">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083378">t</span><span class="op" id="7083379">.</span><span class="ident" id="7083380">Errorf</span><span class="op" id="7083386">(</span><span class="string" id="7083387">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="7083399">,</span>&nbsp;<span class="ident" id="7083401">i</span><span class="op" id="7083402">,</span>&nbsp;<span class="ident" id="7083404">err</span><span class="op" id="7083407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083412">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083427">if</span>&nbsp;<span class="ident" id="7083430">g</span><span class="op" id="7083431">,</span>&nbsp;<span class="ident" id="7083433">e</span>&nbsp;<span class="op" id="7083435">:=</span>&nbsp;<span class="ident" id="7083438">got</span><span class="op" id="7083441">.</span><span class="ident" id="7083442">String</span><span class="op" id="7083448">(</span><span class="op" id="7083449">)</span><span class="op" id="7083450">,</span>&nbsp;<span class="ident" id="7083452">tt</span><span class="op" id="7083454">.</span><span class="ident" id="7083455">want</span><span class="op" id="7083459">;</span>&nbsp;<span class="ident" id="7083461">g</span>&nbsp;<span class="op" id="7083463">!=</span>&nbsp;<span class="ident" id="7083466">e</span>&nbsp;<span class="op" id="7083468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083473">t</span><span class="op" id="7083474">.</span><span class="ident" id="7083475">Errorf</span><span class="op" id="7083481">(</span><span class="string" id="7083482">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7083508">,</span>&nbsp;<span class="ident" id="7083510">i</span><span class="op" id="7083511">,</span>&nbsp;<span class="ident" id="7083513">g</span><span class="op" id="7083514">,</span>&nbsp;<span class="ident" id="7083516">e</span><span class="op" id="7083517">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083524">}</span><br>
<span class="lineno"></span><span class="op" id="7083526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7083529">func</span>&nbsp;<span class="ident" id="7083534">TestResponseStatusStutter</span><span class="op" id="7083559">(</span><span class="ident" id="7083560">t</span>&nbsp;<span class="op" id="7083562">*</span><span class="ident" id="7083563">testing</span><span class="op" id="7083570">.</span><span class="ident" id="7083571">T</span><span class="op" id="7083572">)</span>&nbsp;<span class="op" id="7083574">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083577">r</span>&nbsp;<span class="op" id="7083579">:=</span>&nbsp;<span class="op" id="7083582">&amp;</span><span class="ident" id="7083583">Response</span><span class="op" id="7083591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083595">Status</span><span class="op" id="7083601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7083607">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="7083624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083628">StatusCode</span><span class="op" id="7083638">:</span>&nbsp;<span class="num" id="7083640">123</span><span class="op" id="7083643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083647">ProtoMajor</span><span class="op" id="7083657">:</span>&nbsp;<span class="num" id="7083659">1</span><span class="op" id="7083660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083664">ProtoMinor</span><span class="op" id="7083674">:</span>&nbsp;<span class="num" id="7083676">3</span><span class="op" id="7083677">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083683">var</span>&nbsp;<span class="ident" id="7083687">buf</span>&nbsp;<span class="ident" id="7083691">bytes</span><span class="op" id="7083696">.</span><span class="ident" id="7083697">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083705">r</span><span class="op" id="7083706">.</span><span class="ident" id="7083707">Write</span><span class="op" id="7083712">(</span><span class="op" id="7083713">&amp;</span><span class="ident" id="7083714">buf</span><span class="op" id="7083717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083720">if</span>&nbsp;<span class="ident" id="7083723">strings</span><span class="op" id="7083730">.</span><span class="ident" id="7083731">Contains</span><span class="op" id="7083739">(</span><span class="ident" id="7083740">buf</span><span class="op" id="7083743">.</span><span class="ident" id="7083744">String</span><span class="op" id="7083750">(</span><span class="op" id="7083751">)</span><span class="op" id="7083752">,</span>&nbsp;<span class="string" id="7083754">&#34;123&nbsp;123&#34;</span><span class="op" id="7083763">)</span>&nbsp;<span class="op" id="7083765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083769">t</span><span class="op" id="7083770">.</span><span class="ident" id="7083771">Errorf</span><span class="op" id="7083777">(</span><span class="string" id="7083778">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="7083801">,</span>&nbsp;<span class="ident" id="7083803">buf</span><span class="op" id="7083806">.</span><span class="ident" id="7083807">String</span><span class="op" id="7083813">(</span><span class="op" id="7083814">)</span><span class="op" id="7083815">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7083818">}</span><br>
<span class="lineno"></span><span class="op" id="7083820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7083823">func</span>&nbsp;<span class="ident" id="7083828">TestResponseContentLengthShortBody</span><span class="op" id="7083862">(</span><span class="ident" id="7083863">t</span>&nbsp;<span class="op" id="7083865">*</span><span class="ident" id="7083866">testing</span><span class="op" id="7083873">.</span><span class="ident" id="7083874">T</span><span class="op" id="7083875">)</span>&nbsp;<span class="op" id="7083877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7083880">const</span>&nbsp;<span class="ident" id="7083886">shortBody</span>&nbsp;<span class="op" id="7083896">=</span>&nbsp;<span class="string" id="7083898">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7083928">br</span>&nbsp;<span class="op" id="7083931">:=</span>&nbsp;<span class="ident" id="7083934">bufio</span><span class="op" id="7083939">.</span><span class="ident" id="7083940">NewReader</span><span class="op" id="7083949">(</span><span class="ident" id="7083950">strings</span><span class="op" id="7083957">.</span><span class="ident" id="7083958">NewReader</span><span class="op" id="7083967">(</span><span class="string" id="7083968">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7083990">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7083994">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="7084020">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7084024">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7084031">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084035">shortBody</span><span class="op" id="7084044">)</span><span class="op" id="7084045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084048">res</span><span class="op" id="7084051">,</span>&nbsp;<span class="ident" id="7084053">err</span>&nbsp;<span class="op" id="7084057">:=</span>&nbsp;<span class="ident" id="7084060">ReadResponse</span><span class="op" id="7084072">(</span><span class="ident" id="7084073">br</span><span class="op" id="7084075">,</span>&nbsp;<span class="op" id="7084077">&amp;</span><span class="ident" id="7084078">Request</span><span class="op" id="7084085">{</span><span class="ident" id="7084086">Method</span><span class="op" id="7084092">:</span>&nbsp;<span class="string" id="7084094">&#34;GET&#34;</span><span class="op" id="7084099">}</span><span class="op" id="7084100">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084103">if</span>&nbsp;<span class="ident" id="7084106">err</span>&nbsp;<span class="op" id="7084110">!=</span>&nbsp;<span class="ident" id="7084113">nil</span>&nbsp;<span class="op" id="7084117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084121">t</span><span class="op" id="7084122">.</span><span class="ident" id="7084123">Fatal</span><span class="op" id="7084128">(</span><span class="ident" id="7084129">err</span><span class="op" id="7084132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084138">if</span>&nbsp;<span class="ident" id="7084141">res</span><span class="op" id="7084144">.</span><span class="ident" id="7084145">ContentLength</span>&nbsp;<span class="op" id="7084159">!=</span>&nbsp;<span class="num" id="7084162">123</span>&nbsp;<span class="op" id="7084166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084170">t</span><span class="op" id="7084171">.</span><span class="ident" id="7084172">Fatalf</span><span class="op" id="7084178">(</span><span class="string" id="7084179">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="7084210">,</span>&nbsp;<span class="ident" id="7084212">res</span><span class="op" id="7084215">.</span><span class="ident" id="7084216">ContentLength</span><span class="op" id="7084229">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084235">var</span>&nbsp;<span class="ident" id="7084239">buf</span>&nbsp;<span class="ident" id="7084243">bytes</span><span class="op" id="7084248">.</span><span class="ident" id="7084249">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084257">n</span><span class="op" id="7084258">,</span>&nbsp;<span class="ident" id="7084260">err</span>&nbsp;<span class="op" id="7084264">:=</span>&nbsp;<span class="ident" id="7084267">io</span><span class="op" id="7084269">.</span><span class="ident" id="7084270">Copy</span><span class="op" id="7084274">(</span><span class="op" id="7084275">&amp;</span><span class="ident" id="7084276">buf</span><span class="op" id="7084279">,</span>&nbsp;<span class="ident" id="7084281">res</span><span class="op" id="7084284">.</span><span class="ident" id="7084285">Body</span><span class="op" id="7084289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084292">if</span>&nbsp;<span class="ident" id="7084295">n</span>&nbsp;<span class="op" id="7084297">!=</span>&nbsp;<span class="ident" id="7084300">int64</span><span class="op" id="7084305">(</span><span class="builtinfunc" id="7084306">len</span><span class="op" id="7084309">(</span><span class="ident" id="7084310">shortBody</span><span class="op" id="7084319">)</span><span class="op" id="7084320">)</span>&nbsp;<span class="op" id="7084322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084326">t</span><span class="op" id="7084327">.</span><span class="ident" id="7084328">Errorf</span><span class="op" id="7084334">(</span><span class="string" id="7084335">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="7084370">,</span>&nbsp;<span class="ident" id="7084372">n</span><span class="op" id="7084373">,</span>&nbsp;<span class="builtinfunc" id="7084375">len</span><span class="op" id="7084378">(</span><span class="ident" id="7084379">shortBody</span><span class="op" id="7084388">)</span><span class="op" id="7084389">,</span>&nbsp;<span class="ident" id="7084391">shortBody</span><span class="op" id="7084400">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084406">if</span>&nbsp;<span class="ident" id="7084409">buf</span><span class="op" id="7084412">.</span><span class="ident" id="7084413">String</span><span class="op" id="7084419">(</span><span class="op" id="7084420">)</span>&nbsp;<span class="op" id="7084422">!=</span>&nbsp;<span class="ident" id="7084425">shortBody</span>&nbsp;<span class="op" id="7084435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084439">t</span><span class="op" id="7084440">.</span><span class="ident" id="7084441">Errorf</span><span class="op" id="7084447">(</span><span class="string" id="7084448">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7084471">,</span>&nbsp;<span class="ident" id="7084473">buf</span><span class="op" id="7084476">.</span><span class="ident" id="7084477">String</span><span class="op" id="7084483">(</span><span class="op" id="7084484">)</span><span class="op" id="7084485">,</span>&nbsp;<span class="ident" id="7084487">shortBody</span><span class="op" id="7084496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084502">if</span>&nbsp;<span class="ident" id="7084505">err</span>&nbsp;<span class="op" id="7084509">!=</span>&nbsp;<span class="ident" id="7084512">io</span><span class="op" id="7084514">.</span><span class="ident" id="7084515">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7084532">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084536">t</span><span class="op" id="7084537">.</span><span class="ident" id="7084538">Errorf</span><span class="op" id="7084544">(</span><span class="string" id="7084545">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7084592">,</span>&nbsp;<span class="ident" id="7084594">err</span><span class="op" id="7084597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084600">}</span><br>
<span class="lineno"></span><span class="op" id="7084602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7084605">func</span>&nbsp;<span class="ident" id="7084610">TestReadResponseUnexpectedEOF</span><span class="op" id="7084639">(</span><span class="ident" id="7084640">t</span>&nbsp;<span class="op" id="7084642">*</span><span class="ident" id="7084643">testing</span><span class="op" id="7084650">.</span><span class="ident" id="7084651">T</span><span class="op" id="7084652">)</span>&nbsp;<span class="op" id="7084654">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084657">br</span>&nbsp;<span class="op" id="7084660">:=</span>&nbsp;<span class="ident" id="7084663">bufio</span><span class="op" id="7084668">.</span><span class="ident" id="7084669">NewReader</span><span class="op" id="7084678">(</span><span class="ident" id="7084679">strings</span><span class="op" id="7084686">.</span><span class="ident" id="7084687">NewReader</span><span class="op" id="7084696">(</span><span class="string" id="7084697">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="7084734">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7084738">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="7084768">)</span><span class="op" id="7084769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084772">_</span><span class="op" id="7084773">,</span>&nbsp;<span class="ident" id="7084775">err</span>&nbsp;<span class="op" id="7084779">:=</span>&nbsp;<span class="ident" id="7084782">ReadResponse</span><span class="op" id="7084794">(</span><span class="ident" id="7084795">br</span><span class="op" id="7084797">,</span>&nbsp;<span class="ident" id="7084799">nil</span><span class="op" id="7084802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7084805">if</span>&nbsp;<span class="ident" id="7084808">err</span>&nbsp;<span class="op" id="7084812">!=</span>&nbsp;<span class="ident" id="7084815">io</span><span class="op" id="7084817">.</span><span class="ident" id="7084818">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7084835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084839">t</span><span class="op" id="7084840">.</span><span class="ident" id="7084841">Errorf</span><span class="op" id="7084847">(</span><span class="string" id="7084848">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7084893">,</span>&nbsp;<span class="ident" id="7084895">err</span><span class="op" id="7084898">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7084901">}</span><br>
<span class="lineno"></span><span class="op" id="7084903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7084906">func</span>&nbsp;<span class="ident" id="7084911">TestNeedsSniff</span><span class="op" id="7084925">(</span><span class="ident" id="7084926">t</span>&nbsp;<span class="op" id="7084928">*</span><span class="ident" id="7084929">testing</span><span class="op" id="7084936">.</span><span class="ident" id="7084937">T</span><span class="op" id="7084938">)</span>&nbsp;<span class="op" id="7084940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7084943">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7084995">r</span>&nbsp;<span class="op" id="7084997">:=</span>&nbsp;<span class="op" id="7085000">&amp;</span><span class="ident" id="7085001">response</span><span class="op" id="7085009">{</span><span class="op" id="7085010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085013">if</span>&nbsp;<span class="ident" id="7085016">got</span><span class="op" id="7085019">,</span>&nbsp;<span class="ident" id="7085021">want</span>&nbsp;<span class="op" id="7085026">:=</span>&nbsp;<span class="ident" id="7085029">r</span><span class="op" id="7085030">.</span><span class="ident" id="7085031">needsSniff</span><span class="op" id="7085041">(</span><span class="op" id="7085042">)</span><span class="op" id="7085043">,</span>&nbsp;<span class="builtintype" id="7085045">true</span><span class="op" id="7085049">;</span>&nbsp;<span class="ident" id="7085051">got</span>&nbsp;<span class="op" id="7085055">!=</span>&nbsp;<span class="ident" id="7085058">want</span>&nbsp;<span class="op" id="7085063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085067">t</span><span class="op" id="7085068">.</span><span class="ident" id="7085069">Errorf</span><span class="op" id="7085075">(</span><span class="string" id="7085076">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7085102">,</span>&nbsp;<span class="ident" id="7085104">got</span><span class="op" id="7085107">,</span>&nbsp;<span class="ident" id="7085109">want</span><span class="op" id="7085113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7085119">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085173">r</span><span class="op" id="7085174">.</span><span class="ident" id="7085175">handlerHeader</span>&nbsp;<span class="op" id="7085189">=</span>&nbsp;<span class="ident" id="7085191">Header</span><span class="op" id="7085197">{</span><span class="string" id="7085198">&#34;Content-Type&#34;</span><span class="op" id="7085212">:</span>&nbsp;<span class="ident" id="7085214">nil</span><span class="op" id="7085217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7085220">if</span>&nbsp;<span class="ident" id="7085223">got</span><span class="op" id="7085226">,</span>&nbsp;<span class="ident" id="7085228">want</span>&nbsp;<span class="op" id="7085233">:=</span>&nbsp;<span class="ident" id="7085236">r</span><span class="op" id="7085237">.</span><span class="ident" id="7085238">needsSniff</span><span class="op" id="7085248">(</span><span class="op" id="7085249">)</span><span class="op" id="7085250">,</span>&nbsp;<span class="builtintype" id="7085252">false</span><span class="op" id="7085257">;</span>&nbsp;<span class="ident" id="7085259">got</span>&nbsp;<span class="op" id="7085263">!=</span>&nbsp;<span class="ident" id="7085266">want</span>&nbsp;<span class="op" id="7085271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7085275">t</span><span class="op" id="7085276">.</span><span class="ident" id="7085277">Errorf</span><span class="op" id="7085283">(</span><span class="string" id="7085284">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7085329">,</span>&nbsp;<span class="ident" id="7085331">got</span><span class="op" id="7085334">,</span>&nbsp;<span class="ident" id="7085336">want</span><span class="op" id="7085340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7085343">}</span><br>
<span class="lineno"></span><span class="op" id="7085345">}</span>
</div>
</body>
</html>
