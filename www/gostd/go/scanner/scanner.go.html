<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/scanner</h2>
<ul>
<li><a href="/gostd/go/scanner/errors.go.html">errors.go</a></li>
<li><a href="/gostd/go/scanner/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/go/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3360781">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3360836">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3360890">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3360941">//&nbsp;Package&nbsp;scanner&nbsp;implements&nbsp;a&nbsp;scanner&nbsp;for&nbsp;Go&nbsp;source&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3361001">//&nbsp;It&nbsp;takes&nbsp;a&nbsp;[]byte&nbsp;as&nbsp;source&nbsp;which&nbsp;can&nbsp;then&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="3361060">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="3361106">//</span><br>
<span class="lineno"></span><span class="keyword" id="3361109">package</span>&nbsp;<span class="ident" id="3361117">scanner</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3361126">import</span>&nbsp;<span class="op" id="3361133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361136">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361145">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361152">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361164">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361181">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361192">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3361203">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3361218">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3361221">//&nbsp;An&nbsp;ErrorHandler&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Scanner.Init.&nbsp;If&nbsp;a&nbsp;syntax&nbsp;error&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3361294">//&nbsp;encountered&nbsp;and&nbsp;a&nbsp;handler&nbsp;was&nbsp;installed,&nbsp;the&nbsp;handler&nbsp;is&nbsp;called&nbsp;with&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3361367">//&nbsp;position&nbsp;and&nbsp;an&nbsp;error&nbsp;message.&nbsp;The&nbsp;position&nbsp;points&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3361441">//&nbsp;the&nbsp;offending&nbsp;token.</span><br>
<span class="lineno">25</span><span class="comment" id="3361465">//</span><br>
<span class="lineno"></span><span class="keyword" id="3361468">type</span>&nbsp;<span class="ident" id="3361473">ErrorHandler</span>&nbsp;<span class="keyword" id="3361486">func</span><span class="op" id="3361490">(</span><span class="ident" id="3361491">pos</span>&nbsp;<span class="ident" id="3361495">token</span><span class="op" id="3361500">.</span><span class="ident" id="3361501">Position</span><span class="op" id="3361509">,</span>&nbsp;<span class="ident" id="3361511">msg</span>&nbsp;<span class="builtintype" id="3361515">string</span><span class="op" id="3361521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3361524">//&nbsp;A&nbsp;Scanner&nbsp;holds&nbsp;the&nbsp;scanner&#39;s&nbsp;internal&nbsp;state&nbsp;while&nbsp;processing</span><br>
<span class="lineno"></span><span class="comment" id="3361589">//&nbsp;a&nbsp;given&nbsp;text.&nbsp;&nbsp;It&nbsp;can&nbsp;be&nbsp;allocated&nbsp;as&nbsp;part&nbsp;of&nbsp;another&nbsp;data</span><br>
<span class="lineno">30</span><span class="comment" id="3361651">//&nbsp;structure&nbsp;but&nbsp;must&nbsp;be&nbsp;initialized&nbsp;via&nbsp;Init&nbsp;before&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="3361709">//</span><br>
<span class="lineno"></span><span class="keyword" id="3361712">type</span>&nbsp;<span class="ident" id="3361717">Scanner</span>&nbsp;<span class="keyword" id="3361725">struct</span>&nbsp;<span class="op" id="3361732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361735">//&nbsp;immutable&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361755">file</span>&nbsp;<span class="op" id="3361760">*</span><span class="ident" id="3361761">token</span><span class="op" id="3361766">.</span><span class="ident" id="3361767">File</span>&nbsp;&nbsp;<span class="comment" id="3361773">//&nbsp;source&nbsp;file&nbsp;handle</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361796">dir</span>&nbsp;&nbsp;<span class="builtintype" id="3361801">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361814">//&nbsp;directory&nbsp;portion&nbsp;of&nbsp;file.Name()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361851">src</span>&nbsp;&nbsp;<span class="op" id="3361856">[</span><span class="op" id="3361857">]</span><span class="builtintype" id="3361858">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361869">//&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361880">err</span>&nbsp;&nbsp;<span class="ident" id="3361885">ErrorHandler</span>&nbsp;<span class="comment" id="3361898">//&nbsp;error&nbsp;reporting;&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361926">mode</span>&nbsp;<span class="ident" id="3361931">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361944">//&nbsp;scanning&nbsp;mode</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3361963">//&nbsp;scanning&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3361982">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3361993">rune</span>&nbsp;<span class="comment" id="3361998">//&nbsp;current&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362020">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3362031">int</span>&nbsp;&nbsp;<span class="comment" id="3362036">//&nbsp;character&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362057">rdOffset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3362068">int</span>&nbsp;&nbsp;<span class="comment" id="3362073">//&nbsp;reading&nbsp;offset&nbsp;(position&nbsp;after&nbsp;current&nbsp;character)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362127">lineOffset</span>&nbsp;<span class="builtintype" id="3362138">int</span>&nbsp;&nbsp;<span class="comment" id="3362143">//&nbsp;current&nbsp;line&nbsp;offset</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362167">insertSemi</span>&nbsp;<span class="builtintype" id="3362178">bool</span>&nbsp;<span class="comment" id="3362183">//&nbsp;insert&nbsp;a&nbsp;semicolon&nbsp;before&nbsp;next&nbsp;newline</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362227">//&nbsp;public&nbsp;state&nbsp;-&nbsp;ok&nbsp;to&nbsp;modify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362259">ErrorCount</span>&nbsp;<span class="builtintype" id="3362270">int</span>&nbsp;<span class="comment" id="3362274">//&nbsp;number&nbsp;of&nbsp;errors&nbsp;encountered</span><br>
<span class="lineno"></span><span class="op" id="3362306">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3362309">const</span>&nbsp;<span class="ident" id="3362315">bom</span>&nbsp;<span class="op" id="3362319">=</span>&nbsp;<span class="num" id="3362321">0xFEFF</span>&nbsp;<span class="comment" id="3362328">//&nbsp;byte&nbsp;order&nbsp;mark,&nbsp;only&nbsp;permitted&nbsp;as&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3362388">//&nbsp;Read&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;char&nbsp;into&nbsp;s.ch.</span><br>
<span class="lineno"></span><span class="comment" id="3362429">//&nbsp;s.ch&nbsp;&lt;&nbsp;0&nbsp;means&nbsp;end-of-file.</span><br>
<span class="lineno">55</span><span class="comment" id="3362460">//</span><br>
<span class="lineno"></span><span class="keyword" id="3362463">func</span>&nbsp;<span class="op" id="3362468">(</span><span class="ident" id="3362469">s</span>&nbsp;<span class="op" id="3362471">*</span><span class="ident" id="3362472">Scanner</span><span class="op" id="3362479">)</span>&nbsp;<span class="ident" id="3362481">next</span><span class="op" id="3362485">(</span><span class="op" id="3362486">)</span>&nbsp;<span class="op" id="3362488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362491">if</span>&nbsp;<span class="ident" id="3362494">s</span><span class="op" id="3362495">.</span><span class="ident" id="3362496">rdOffset</span>&nbsp;<span class="op" id="3362505">&lt;</span>&nbsp;<span class="builtinfunc" id="3362507">len</span><span class="op" id="3362510">(</span><span class="ident" id="3362511">s</span><span class="op" id="3362512">.</span><span class="ident" id="3362513">src</span><span class="op" id="3362516">)</span>&nbsp;<span class="op" id="3362518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362522">s</span><span class="op" id="3362523">.</span><span class="ident" id="3362524">offset</span>&nbsp;<span class="op" id="3362531">=</span>&nbsp;<span class="ident" id="3362533">s</span><span class="op" id="3362534">.</span><span class="ident" id="3362535">rdOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362546">if</span>&nbsp;<span class="ident" id="3362549">s</span><span class="op" id="3362550">.</span><span class="ident" id="3362551">ch</span>&nbsp;<span class="op" id="3362554">==</span>&nbsp;<span class="string" id="3362557">&#39;\n&#39;</span>&nbsp;<span class="op" id="3362562">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362567">s</span><span class="op" id="3362568">.</span><span class="ident" id="3362569">lineOffset</span>&nbsp;<span class="op" id="3362580">=</span>&nbsp;<span class="ident" id="3362582">s</span><span class="op" id="3362583">.</span><span class="ident" id="3362584">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362594">s</span><span class="op" id="3362595">.</span><span class="ident" id="3362596">file</span><span class="op" id="3362600">.</span><span class="ident" id="3362601">AddLine</span><span class="op" id="3362608">(</span><span class="ident" id="3362609">s</span><span class="op" id="3362610">.</span><span class="ident" id="3362611">offset</span><span class="op" id="3362617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362625">r</span><span class="op" id="3362626">,</span>&nbsp;<span class="ident" id="3362628">w</span>&nbsp;<span class="op" id="3362630">:=</span>&nbsp;<span class="builtintype" id="3362633">rune</span><span class="op" id="3362637">(</span><span class="ident" id="3362638">s</span><span class="op" id="3362639">.</span><span class="ident" id="3362640">src</span><span class="op" id="3362643">[</span><span class="ident" id="3362644">s</span><span class="op" id="3362645">.</span><span class="ident" id="3362646">rdOffset</span><span class="op" id="3362654">]</span><span class="op" id="3362655">)</span><span class="op" id="3362656">,</span>&nbsp;<span class="num" id="3362658">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362662">switch</span>&nbsp;<span class="op" id="3362669">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362673">case</span>&nbsp;<span class="ident" id="3362678">r</span>&nbsp;<span class="op" id="3362680">==</span>&nbsp;<span class="num" id="3362683">0</span><span class="op" id="3362684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362689">s</span><span class="op" id="3362690">.</span><span class="builtintype" id="3362691">error</span><span class="op" id="3362696">(</span><span class="ident" id="3362697">s</span><span class="op" id="3362698">.</span><span class="ident" id="3362699">offset</span><span class="op" id="3362705">,</span>&nbsp;<span class="string" id="3362707">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="3362730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362734">case</span>&nbsp;<span class="ident" id="3362739">r</span>&nbsp;<span class="op" id="3362741">&gt;=</span>&nbsp;<span class="num" id="3362744">0x80</span><span class="op" id="3362748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3362753">//&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362769">r</span><span class="op" id="3362770">,</span>&nbsp;<span class="ident" id="3362772">w</span>&nbsp;<span class="op" id="3362774">=</span>&nbsp;<span class="ident" id="3362776">utf8</span><span class="op" id="3362780">.</span><span class="ident" id="3362781">DecodeRune</span><span class="op" id="3362791">(</span><span class="ident" id="3362792">s</span><span class="op" id="3362793">.</span><span class="ident" id="3362794">src</span><span class="op" id="3362797">[</span><span class="ident" id="3362798">s</span><span class="op" id="3362799">.</span><span class="ident" id="3362800">rdOffset</span><span class="op" id="3362808">:</span><span class="op" id="3362809">]</span><span class="op" id="3362810">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3362815">if</span>&nbsp;<span class="ident" id="3362818">r</span>&nbsp;<span class="op" id="3362820">==</span>&nbsp;<span class="ident" id="3362823">utf8</span><span class="op" id="3362827">.</span><span class="ident" id="3362828">RuneError</span>&nbsp;<span class="op" id="3362838">&amp;&amp;</span>&nbsp;<span class="ident" id="3362841">w</span>&nbsp;<span class="op" id="3362843">==</span>&nbsp;<span class="num" id="3362846">1</span>&nbsp;<span class="op" id="3362848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362854">s</span><span class="op" id="3362855">.</span><span class="builtintype" id="3362856">error</span><span class="op" id="3362861">(</span><span class="ident" id="3362862">s</span><span class="op" id="3362863">.</span><span class="ident" id="3362864">offset</span><span class="op" id="3362870">,</span>&nbsp;<span class="string" id="3362872">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="3362896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362901">}</span>&nbsp;<span class="keyword" id="3362903">else</span>&nbsp;<span class="keyword" id="3362908">if</span>&nbsp;<span class="ident" id="3362911">r</span>&nbsp;<span class="op" id="3362913">==</span>&nbsp;<span class="ident" id="3362916">bom</span>&nbsp;<span class="op" id="3362920">&amp;&amp;</span>&nbsp;<span class="ident" id="3362923">s</span><span class="op" id="3362924">.</span><span class="ident" id="3362925">offset</span>&nbsp;<span class="op" id="3362932">&gt;</span>&nbsp;<span class="num" id="3362934">0</span>&nbsp;<span class="op" id="3362936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362942">s</span><span class="op" id="3362943">.</span><span class="builtintype" id="3362944">error</span><span class="op" id="3362949">(</span><span class="ident" id="3362950">s</span><span class="op" id="3362951">.</span><span class="ident" id="3362952">offset</span><span class="op" id="3362958">,</span>&nbsp;<span class="string" id="3362960">&#34;illegal&nbsp;byte&nbsp;order&nbsp;mark&#34;</span><span class="op" id="3362985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362990">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3362994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3362998">s</span><span class="op" id="3362999">.</span><span class="ident" id="3363000">rdOffset</span>&nbsp;<span class="op" id="3363009">+=</span>&nbsp;<span class="ident" id="3363012">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363016">s</span><span class="op" id="3363017">.</span><span class="ident" id="3363018">ch</span>&nbsp;<span class="op" id="3363021">=</span>&nbsp;<span class="ident" id="3363023">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363026">}</span>&nbsp;<span class="keyword" id="3363028">else</span>&nbsp;<span class="op" id="3363033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363037">s</span><span class="op" id="3363038">.</span><span class="ident" id="3363039">offset</span>&nbsp;<span class="op" id="3363046">=</span>&nbsp;<span class="builtinfunc" id="3363048">len</span><span class="op" id="3363051">(</span><span class="ident" id="3363052">s</span><span class="op" id="3363053">.</span><span class="ident" id="3363054">src</span><span class="op" id="3363057">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3363061">if</span>&nbsp;<span class="ident" id="3363064">s</span><span class="op" id="3363065">.</span><span class="ident" id="3363066">ch</span>&nbsp;<span class="op" id="3363069">==</span>&nbsp;<span class="string" id="3363072">&#39;\n&#39;</span>&nbsp;<span class="op" id="3363077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363082">s</span><span class="op" id="3363083">.</span><span class="ident" id="3363084">lineOffset</span>&nbsp;<span class="op" id="3363095">=</span>&nbsp;<span class="ident" id="3363097">s</span><span class="op" id="3363098">.</span><span class="ident" id="3363099">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363109">s</span><span class="op" id="3363110">.</span><span class="ident" id="3363111">file</span><span class="op" id="3363115">.</span><span class="ident" id="3363116">AddLine</span><span class="op" id="3363123">(</span><span class="ident" id="3363124">s</span><span class="op" id="3363125">.</span><span class="ident" id="3363126">offset</span><span class="op" id="3363132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363140">s</span><span class="op" id="3363141">.</span><span class="ident" id="3363142">ch</span>&nbsp;<span class="op" id="3363145">=</span>&nbsp;<span class="op" id="3363147">-</span><span class="num" id="3363148">1</span>&nbsp;<span class="comment" id="3363150">//&nbsp;eof</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363158">}</span><br>
<span class="lineno"></span><span class="op" id="3363160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3363163">//&nbsp;A&nbsp;mode&nbsp;value&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;flags&nbsp;(or&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="3363205">//&nbsp;They&nbsp;control&nbsp;scanner&nbsp;behavior.</span><br>
<span class="lineno">90</span><span class="comment" id="3363239">//</span><br>
<span class="lineno"></span><span class="keyword" id="3363242">type</span>&nbsp;<span class="ident" id="3363247">Mode</span>&nbsp;<span class="builtintype" id="3363252">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3363258">const</span>&nbsp;<span class="op" id="3363264">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363267">ScanComments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363283">Mode</span>&nbsp;<span class="op" id="3363288">=</span>&nbsp;<span class="num" id="3363290">1</span>&nbsp;<span class="op" id="3363292">&lt;&lt;</span>&nbsp;<span class="ident" id="3363295">iota</span>&nbsp;<span class="comment" id="3363300">//&nbsp;return&nbsp;comments&nbsp;as&nbsp;COMMENT&nbsp;tokens</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363338">dontInsertSemis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363371">//&nbsp;do&nbsp;not&nbsp;automatically&nbsp;insert&nbsp;semicolons&nbsp;-&nbsp;for&nbsp;testing&nbsp;only</span><br>
<span class="lineno"></span><span class="op" id="3363432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3363435">//&nbsp;Init&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;s&nbsp;to&nbsp;tokenize&nbsp;the&nbsp;text&nbsp;src&nbsp;by&nbsp;setting&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3363506">//&nbsp;scanner&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;src.&nbsp;The&nbsp;scanner&nbsp;uses&nbsp;the&nbsp;file&nbsp;set&nbsp;file</span><br>
<span class="lineno">100</span><span class="comment" id="3363577">//&nbsp;for&nbsp;position&nbsp;information&nbsp;and&nbsp;it&nbsp;adds&nbsp;line&nbsp;information&nbsp;for&nbsp;each&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="3363649">//&nbsp;It&nbsp;is&nbsp;ok&nbsp;to&nbsp;re-use&nbsp;the&nbsp;same&nbsp;file&nbsp;when&nbsp;re-scanning&nbsp;the&nbsp;same&nbsp;file&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3363719">//&nbsp;line&nbsp;information&nbsp;which&nbsp;is&nbsp;already&nbsp;present&nbsp;is&nbsp;ignored.&nbsp;Init&nbsp;causes&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3363790">//&nbsp;panic&nbsp;if&nbsp;the&nbsp;file&nbsp;size&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;src&nbsp;size.</span><br>
<span class="lineno"></span><span class="comment" id="3363845">//</span><br>
<span class="lineno">105</span><span class="comment" id="3363848">//&nbsp;Calls&nbsp;to&nbsp;Scan&nbsp;will&nbsp;invoke&nbsp;the&nbsp;error&nbsp;handler&nbsp;err&nbsp;if&nbsp;they&nbsp;encounter&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3363919">//&nbsp;syntax&nbsp;error&nbsp;and&nbsp;err&nbsp;is&nbsp;not&nbsp;nil.&nbsp;Also,&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered,</span><br>
<span class="lineno"></span><span class="comment" id="3363989">//&nbsp;the&nbsp;Scanner&nbsp;field&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one.&nbsp;The&nbsp;mode&nbsp;parameter</span><br>
<span class="lineno"></span><span class="comment" id="3364063">//&nbsp;determines&nbsp;how&nbsp;comments&nbsp;are&nbsp;handled.</span><br>
<span class="lineno"></span><span class="comment" id="3364103">//</span><br>
<span class="lineno">110</span><span class="comment" id="3364106">//&nbsp;Note&nbsp;that&nbsp;Init&nbsp;may&nbsp;call&nbsp;err&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3364181">//&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3364197">//</span><br>
<span class="lineno"></span><span class="keyword" id="3364200">func</span>&nbsp;<span class="op" id="3364205">(</span><span class="ident" id="3364206">s</span>&nbsp;<span class="op" id="3364208">*</span><span class="ident" id="3364209">Scanner</span><span class="op" id="3364216">)</span>&nbsp;<span class="ident" id="3364218">Init</span><span class="op" id="3364222">(</span><span class="ident" id="3364223">file</span>&nbsp;<span class="op" id="3364228">*</span><span class="ident" id="3364229">token</span><span class="op" id="3364234">.</span><span class="ident" id="3364235">File</span><span class="op" id="3364239">,</span>&nbsp;<span class="ident" id="3364241">src</span>&nbsp;<span class="op" id="3364245">[</span><span class="op" id="3364246">]</span><span class="builtintype" id="3364247">byte</span><span class="op" id="3364251">,</span>&nbsp;<span class="ident" id="3364253">err</span>&nbsp;<span class="ident" id="3364257">ErrorHandler</span><span class="op" id="3364269">,</span>&nbsp;<span class="ident" id="3364271">mode</span>&nbsp;<span class="ident" id="3364276">Mode</span><span class="op" id="3364280">)</span>&nbsp;<span class="op" id="3364282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364285">//&nbsp;Explicitly&nbsp;initialize&nbsp;all&nbsp;fields&nbsp;since&nbsp;a&nbsp;scanner&nbsp;may&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364353">if</span>&nbsp;<span class="ident" id="3364356">file</span><span class="op" id="3364360">.</span><span class="ident" id="3364361">Size</span><span class="op" id="3364365">(</span><span class="op" id="3364366">)</span>&nbsp;<span class="op" id="3364368">!=</span>&nbsp;<span class="builtinfunc" id="3364371">len</span><span class="op" id="3364374">(</span><span class="ident" id="3364375">src</span><span class="op" id="3364378">)</span>&nbsp;<span class="op" id="3364380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3364384">panic</span><span class="op" id="3364389">(</span><span class="ident" id="3364390">fmt</span><span class="op" id="3364393">.</span><span class="ident" id="3364394">Sprintf</span><span class="op" id="3364401">(</span><span class="string" id="3364402">&#34;file&nbsp;size&nbsp;(%d)&nbsp;does&nbsp;not&nbsp;match&nbsp;src&nbsp;len&nbsp;(%d)&#34;</span><span class="op" id="3364446">,</span>&nbsp;<span class="ident" id="3364448">file</span><span class="op" id="3364452">.</span><span class="ident" id="3364453">Size</span><span class="op" id="3364457">(</span><span class="op" id="3364458">)</span><span class="op" id="3364459">,</span>&nbsp;<span class="builtinfunc" id="3364461">len</span><span class="op" id="3364464">(</span><span class="ident" id="3364465">src</span><span class="op" id="3364468">)</span><span class="op" id="3364469">)</span><span class="op" id="3364470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364476">s</span><span class="op" id="3364477">.</span><span class="ident" id="3364478">file</span>&nbsp;<span class="op" id="3364483">=</span>&nbsp;<span class="ident" id="3364485">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364491">s</span><span class="op" id="3364492">.</span><span class="ident" id="3364493">dir</span><span class="op" id="3364496">,</span>&nbsp;<span class="ident" id="3364498">_</span>&nbsp;<span class="op" id="3364500">=</span>&nbsp;<span class="ident" id="3364502">filepath</span><span class="op" id="3364510">.</span><span class="ident" id="3364511">Split</span><span class="op" id="3364516">(</span><span class="ident" id="3364517">file</span><span class="op" id="3364521">.</span><span class="ident" id="3364522">Name</span><span class="op" id="3364526">(</span><span class="op" id="3364527">)</span><span class="op" id="3364528">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364531">s</span><span class="op" id="3364532">.</span><span class="ident" id="3364533">src</span>&nbsp;<span class="op" id="3364537">=</span>&nbsp;<span class="ident" id="3364539">src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364544">s</span><span class="op" id="3364545">.</span><span class="ident" id="3364546">err</span>&nbsp;<span class="op" id="3364550">=</span>&nbsp;<span class="ident" id="3364552">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364557">s</span><span class="op" id="3364558">.</span><span class="ident" id="3364559">mode</span>&nbsp;<span class="op" id="3364564">=</span>&nbsp;<span class="ident" id="3364566">mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364573">s</span><span class="op" id="3364574">.</span><span class="ident" id="3364575">ch</span>&nbsp;<span class="op" id="3364578">=</span>&nbsp;<span class="string" id="3364580">&#39;&nbsp;&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364585">s</span><span class="op" id="3364586">.</span><span class="ident" id="3364587">offset</span>&nbsp;<span class="op" id="3364594">=</span>&nbsp;<span class="num" id="3364596">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364599">s</span><span class="op" id="3364600">.</span><span class="ident" id="3364601">rdOffset</span>&nbsp;<span class="op" id="3364610">=</span>&nbsp;<span class="num" id="3364612">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364615">s</span><span class="op" id="3364616">.</span><span class="ident" id="3364617">lineOffset</span>&nbsp;<span class="op" id="3364628">=</span>&nbsp;<span class="num" id="3364630">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364633">s</span><span class="op" id="3364634">.</span><span class="ident" id="3364635">insertSemi</span>&nbsp;<span class="op" id="3364646">=</span>&nbsp;<span class="builtintype" id="3364648">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364655">s</span><span class="op" id="3364656">.</span><span class="ident" id="3364657">ErrorCount</span>&nbsp;<span class="op" id="3364668">=</span>&nbsp;<span class="num" id="3364670">0</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364674">s</span><span class="op" id="3364675">.</span><span class="ident" id="3364676">next</span><span class="op" id="3364680">(</span><span class="op" id="3364681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364684">if</span>&nbsp;<span class="ident" id="3364687">s</span><span class="op" id="3364688">.</span><span class="ident" id="3364689">ch</span>&nbsp;<span class="op" id="3364692">==</span>&nbsp;<span class="ident" id="3364695">bom</span>&nbsp;<span class="op" id="3364699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364703">s</span><span class="op" id="3364704">.</span><span class="ident" id="3364705">next</span><span class="op" id="3364709">(</span><span class="op" id="3364710">)</span>&nbsp;<span class="comment" id="3364712">//&nbsp;ignore&nbsp;BOM&nbsp;at&nbsp;file&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364745">}</span><br>
<span class="lineno">135</span><span class="op" id="3364747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364750">func</span>&nbsp;<span class="op" id="3364755">(</span><span class="ident" id="3364756">s</span>&nbsp;<span class="op" id="3364758">*</span><span class="ident" id="3364759">Scanner</span><span class="op" id="3364766">)</span>&nbsp;<span class="builtintype" id="3364768">error</span><span class="op" id="3364773">(</span><span class="ident" id="3364774">offs</span>&nbsp;<span class="builtintype" id="3364779">int</span><span class="op" id="3364782">,</span>&nbsp;<span class="ident" id="3364784">msg</span>&nbsp;<span class="builtintype" id="3364788">string</span><span class="op" id="3364794">)</span>&nbsp;<span class="op" id="3364796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364799">if</span>&nbsp;<span class="ident" id="3364802">s</span><span class="op" id="3364803">.</span><span class="ident" id="3364804">err</span>&nbsp;<span class="op" id="3364808">!=</span>&nbsp;<span class="ident" id="3364811">nil</span>&nbsp;<span class="op" id="3364815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364819">s</span><span class="op" id="3364820">.</span><span class="ident" id="3364821">err</span><span class="op" id="3364824">(</span><span class="ident" id="3364825">s</span><span class="op" id="3364826">.</span><span class="ident" id="3364827">file</span><span class="op" id="3364831">.</span><span class="ident" id="3364832">Position</span><span class="op" id="3364840">(</span><span class="ident" id="3364841">s</span><span class="op" id="3364842">.</span><span class="ident" id="3364843">file</span><span class="op" id="3364847">.</span><span class="ident" id="3364848">Pos</span><span class="op" id="3364851">(</span><span class="ident" id="3364852">offs</span><span class="op" id="3364856">)</span><span class="op" id="3364857">)</span><span class="op" id="3364858">,</span>&nbsp;<span class="ident" id="3364860">msg</span><span class="op" id="3364863">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3364866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3364869">s</span><span class="op" id="3364870">.</span><span class="ident" id="3364871">ErrorCount</span><span class="op" id="3364881">++</span><br>
<span class="lineno"></span><span class="op" id="3364884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3364887">var</span>&nbsp;<span class="ident" id="3364891">prefix</span>&nbsp;<span class="op" id="3364898">=</span>&nbsp;<span class="op" id="3364900">[</span><span class="op" id="3364901">]</span><span class="builtintype" id="3364902">byte</span><span class="op" id="3364906">(</span><span class="string" id="3364907">&#34;//line&nbsp;&#34;</span><span class="op" id="3364916">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3364919">func</span>&nbsp;<span class="op" id="3364924">(</span><span class="ident" id="3364925">s</span>&nbsp;<span class="op" id="3364927">*</span><span class="ident" id="3364928">Scanner</span><span class="op" id="3364935">)</span>&nbsp;<span class="ident" id="3364937">interpretLineComment</span><span class="op" id="3364957">(</span><span class="ident" id="3364958">text</span>&nbsp;<span class="op" id="3364963">[</span><span class="op" id="3364964">]</span><span class="builtintype" id="3364965">byte</span><span class="op" id="3364969">)</span>&nbsp;<span class="op" id="3364971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3364974">if</span>&nbsp;<span class="ident" id="3364977">bytes</span><span class="op" id="3364982">.</span><span class="ident" id="3364983">HasPrefix</span><span class="op" id="3364992">(</span><span class="ident" id="3364993">text</span><span class="op" id="3364997">,</span>&nbsp;<span class="ident" id="3364999">prefix</span><span class="op" id="3365005">)</span>&nbsp;<span class="op" id="3365007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365011">//&nbsp;get&nbsp;filename&nbsp;and&nbsp;line&nbsp;number,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365053">if</span>&nbsp;<span class="ident" id="3365056">i</span>&nbsp;<span class="op" id="3365058">:=</span>&nbsp;<span class="ident" id="3365061">bytes</span><span class="op" id="3365066">.</span><span class="ident" id="3365067">LastIndex</span><span class="op" id="3365076">(</span><span class="ident" id="3365077">text</span><span class="op" id="3365081">,</span>&nbsp;<span class="op" id="3365083">[</span><span class="op" id="3365084">]</span><span class="builtintype" id="3365085">byte</span><span class="op" id="3365089">{</span><span class="string" id="3365090">&#39;:&#39;</span><span class="op" id="3365093">}</span><span class="op" id="3365094">)</span><span class="op" id="3365095">;</span>&nbsp;<span class="ident" id="3365097">i</span>&nbsp;<span class="op" id="3365099">&gt;</span>&nbsp;<span class="num" id="3365101">0</span>&nbsp;<span class="op" id="3365103">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365108">if</span>&nbsp;<span class="ident" id="3365111">line</span><span class="op" id="3365115">,</span>&nbsp;<span class="ident" id="3365117">err</span>&nbsp;<span class="op" id="3365121">:=</span>&nbsp;<span class="ident" id="3365124">strconv</span><span class="op" id="3365131">.</span><span class="ident" id="3365132">Atoi</span><span class="op" id="3365136">(</span><span class="builtintype" id="3365137">string</span><span class="op" id="3365143">(</span><span class="ident" id="3365144">text</span><span class="op" id="3365148">[</span><span class="ident" id="3365149">i</span><span class="op" id="3365150">+</span><span class="num" id="3365151">1</span><span class="op" id="3365152">:</span><span class="op" id="3365153">]</span><span class="op" id="3365154">)</span><span class="op" id="3365155">)</span><span class="op" id="3365156">;</span>&nbsp;<span class="ident" id="3365158">err</span>&nbsp;<span class="op" id="3365162">==</span>&nbsp;<span class="ident" id="3365165">nil</span>&nbsp;<span class="op" id="3365169">&amp;&amp;</span>&nbsp;<span class="ident" id="3365172">line</span>&nbsp;<span class="op" id="3365177">&gt;</span>&nbsp;<span class="num" id="3365179">0</span>&nbsp;<span class="op" id="3365181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365187">//&nbsp;valid&nbsp;//line&nbsp;filename:line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365229">filename</span>&nbsp;<span class="op" id="3365238">:=</span>&nbsp;<span class="builtintype" id="3365241">string</span><span class="op" id="3365247">(</span><span class="ident" id="3365248">bytes</span><span class="op" id="3365253">.</span><span class="ident" id="3365254">TrimSpace</span><span class="op" id="3365263">(</span><span class="ident" id="3365264">text</span><span class="op" id="3365268">[</span><span class="builtinfunc" id="3365269">len</span><span class="op" id="3365272">(</span><span class="ident" id="3365273">prefix</span><span class="op" id="3365279">)</span><span class="op" id="3365280">:</span><span class="ident" id="3365281">i</span><span class="op" id="3365282">]</span><span class="op" id="3365283">)</span><span class="op" id="3365284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365290">if</span>&nbsp;<span class="ident" id="3365293">filename</span>&nbsp;<span class="op" id="3365302">!=</span>&nbsp;<span class="string" id="3365305">&#34;&#34;</span>&nbsp;<span class="op" id="3365308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365315">filename</span>&nbsp;<span class="op" id="3365324">=</span>&nbsp;<span class="ident" id="3365326">filepath</span><span class="op" id="3365334">.</span><span class="ident" id="3365335">Clean</span><span class="op" id="3365340">(</span><span class="ident" id="3365341">filename</span><span class="op" id="3365349">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365356">if</span>&nbsp;<span class="op" id="3365359">!</span><span class="ident" id="3365360">filepath</span><span class="op" id="3365368">.</span><span class="ident" id="3365369">IsAbs</span><span class="op" id="3365374">(</span><span class="ident" id="3365375">filename</span><span class="op" id="3365383">)</span>&nbsp;<span class="op" id="3365385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365393">//&nbsp;make&nbsp;filename&nbsp;relative&nbsp;to&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365446">filename</span>&nbsp;<span class="op" id="3365455">=</span>&nbsp;<span class="ident" id="3365457">filepath</span><span class="op" id="3365465">.</span><span class="ident" id="3365466">Join</span><span class="op" id="3365470">(</span><span class="ident" id="3365471">s</span><span class="op" id="3365472">.</span><span class="ident" id="3365473">dir</span><span class="op" id="3365476">,</span>&nbsp;<span class="ident" id="3365478">filename</span><span class="op" id="3365486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365499">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365505">//&nbsp;update&nbsp;scanner&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365536">s</span><span class="op" id="3365537">.</span><span class="ident" id="3365538">file</span><span class="op" id="3365542">.</span><span class="ident" id="3365543">AddLineInfo</span><span class="op" id="3365554">(</span><span class="ident" id="3365555">s</span><span class="op" id="3365556">.</span><span class="ident" id="3365557">lineOffset</span><span class="op" id="3365567">+</span><span class="builtinfunc" id="3365568">len</span><span class="op" id="3365571">(</span><span class="ident" id="3365572">text</span><span class="op" id="3365576">)</span><span class="op" id="3365577">+</span><span class="num" id="3365578">1</span><span class="op" id="3365579">,</span>&nbsp;<span class="ident" id="3365581">filename</span><span class="op" id="3365589">,</span>&nbsp;<span class="ident" id="3365591">line</span><span class="op" id="3365595">)</span>&nbsp;<span class="comment" id="3365597">//&nbsp;+len(text)+1&nbsp;since&nbsp;comment&nbsp;applies&nbsp;to&nbsp;next&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365658">}</span><br>
<span class="lineno">165</span><span class="op" id="3365660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3365663">func</span>&nbsp;<span class="op" id="3365668">(</span><span class="ident" id="3365669">s</span>&nbsp;<span class="op" id="3365671">*</span><span class="ident" id="3365672">Scanner</span><span class="op" id="3365679">)</span>&nbsp;<span class="ident" id="3365681">scanComment</span><span class="op" id="3365692">(</span><span class="op" id="3365693">)</span>&nbsp;<span class="builtintype" id="3365695">string</span>&nbsp;<span class="op" id="3365702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365705">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed;&nbsp;s.ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;s.ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365766">offs</span>&nbsp;<span class="op" id="3365771">:=</span>&nbsp;<span class="ident" id="3365774">s</span><span class="op" id="3365775">.</span><span class="ident" id="3365776">offset</span>&nbsp;<span class="op" id="3365783">-</span>&nbsp;<span class="num" id="3365785">1</span>&nbsp;<span class="comment" id="3365787">//&nbsp;position&nbsp;of&nbsp;initial&nbsp;&#39;/&#39;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365815">hasCR</span>&nbsp;<span class="op" id="3365821">:=</span>&nbsp;<span class="builtintype" id="3365824">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365832">if</span>&nbsp;<span class="ident" id="3365835">s</span><span class="op" id="3365836">.</span><span class="ident" id="3365837">ch</span>&nbsp;<span class="op" id="3365840">==</span>&nbsp;<span class="string" id="3365843">&#39;/&#39;</span>&nbsp;<span class="op" id="3365847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3365851">//-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365870">s</span><span class="op" id="3365871">.</span><span class="ident" id="3365872">next</span><span class="op" id="3365876">(</span><span class="op" id="3365877">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365881">for</span>&nbsp;<span class="ident" id="3365885">s</span><span class="op" id="3365886">.</span><span class="ident" id="3365887">ch</span>&nbsp;<span class="op" id="3365890">!=</span>&nbsp;<span class="string" id="3365893">&#39;\n&#39;</span>&nbsp;<span class="op" id="3365898">&amp;&amp;</span>&nbsp;<span class="ident" id="3365901">s</span><span class="op" id="3365902">.</span><span class="ident" id="3365903">ch</span>&nbsp;<span class="op" id="3365906">&gt;=</span>&nbsp;<span class="num" id="3365909">0</span>&nbsp;<span class="op" id="3365911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365916">if</span>&nbsp;<span class="ident" id="3365919">s</span><span class="op" id="3365920">.</span><span class="ident" id="3365921">ch</span>&nbsp;<span class="op" id="3365924">==</span>&nbsp;<span class="string" id="3365927">&#39;\r&#39;</span>&nbsp;<span class="op" id="3365932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365938">hasCR</span>&nbsp;<span class="op" id="3365944">=</span>&nbsp;<span class="builtintype" id="3365946">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365959">s</span><span class="op" id="3365960">.</span><span class="ident" id="3365961">next</span><span class="op" id="3365965">(</span><span class="op" id="3365966">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3365974">if</span>&nbsp;<span class="ident" id="3365977">offs</span>&nbsp;<span class="op" id="3365982">==</span>&nbsp;<span class="ident" id="3365985">s</span><span class="op" id="3365986">.</span><span class="ident" id="3365987">lineOffset</span>&nbsp;<span class="op" id="3365998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366003">//&nbsp;comment&nbsp;starts&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;current&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366061">s</span><span class="op" id="3366062">.</span><span class="ident" id="3366063">interpretLineComment</span><span class="op" id="3366083">(</span><span class="ident" id="3366084">s</span><span class="op" id="3366085">.</span><span class="ident" id="3366086">src</span><span class="op" id="3366089">[</span><span class="ident" id="3366090">offs</span><span class="op" id="3366094">:</span><span class="ident" id="3366095">s</span><span class="op" id="3366096">.</span><span class="ident" id="3366097">offset</span><span class="op" id="3366103">]</span><span class="op" id="3366104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366108">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366112">goto</span>&nbsp;<span class="ident" id="3366117">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366127">/*-style&nbsp;comment&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366148">s</span><span class="op" id="3366149">.</span><span class="ident" id="3366150">next</span><span class="op" id="3366154">(</span><span class="op" id="3366155">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366158">for</span>&nbsp;<span class="ident" id="3366162">s</span><span class="op" id="3366163">.</span><span class="ident" id="3366164">ch</span>&nbsp;<span class="op" id="3366167">&gt;=</span>&nbsp;<span class="num" id="3366170">0</span>&nbsp;<span class="op" id="3366172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366176">ch</span>&nbsp;<span class="op" id="3366179">:=</span>&nbsp;<span class="ident" id="3366182">s</span><span class="op" id="3366183">.</span><span class="ident" id="3366184">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366189">if</span>&nbsp;<span class="ident" id="3366192">ch</span>&nbsp;<span class="op" id="3366195">==</span>&nbsp;<span class="string" id="3366198">&#39;\r&#39;</span>&nbsp;<span class="op" id="3366203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366208">hasCR</span>&nbsp;<span class="op" id="3366214">=</span>&nbsp;<span class="builtintype" id="3366216">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366223">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366227">s</span><span class="op" id="3366228">.</span><span class="ident" id="3366229">next</span><span class="op" id="3366233">(</span><span class="op" id="3366234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366238">if</span>&nbsp;<span class="ident" id="3366241">ch</span>&nbsp;<span class="op" id="3366244">==</span>&nbsp;<span class="string" id="3366247">&#39;*&#39;</span>&nbsp;<span class="op" id="3366251">&amp;&amp;</span>&nbsp;<span class="ident" id="3366254">s</span><span class="op" id="3366255">.</span><span class="ident" id="3366256">ch</span>&nbsp;<span class="op" id="3366259">==</span>&nbsp;<span class="string" id="3366262">&#39;/&#39;</span>&nbsp;<span class="op" id="3366266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366271">s</span><span class="op" id="3366272">.</span><span class="ident" id="3366273">next</span><span class="op" id="3366277">(</span><span class="op" id="3366278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366283">goto</span>&nbsp;<span class="ident" id="3366288">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366295">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366302">s</span><span class="op" id="3366303">.</span><span class="builtintype" id="3366304">error</span><span class="op" id="3366309">(</span><span class="ident" id="3366310">offs</span><span class="op" id="3366314">,</span>&nbsp;<span class="string" id="3366316">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3366340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="3366343">exit</span><span class="op" id="3366347">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366350">lit</span>&nbsp;<span class="op" id="3366354">:=</span>&nbsp;<span class="ident" id="3366357">s</span><span class="op" id="3366358">.</span><span class="ident" id="3366359">src</span><span class="op" id="3366362">[</span><span class="ident" id="3366363">offs</span><span class="op" id="3366367">:</span><span class="ident" id="3366368">s</span><span class="op" id="3366369">.</span><span class="ident" id="3366370">offset</span><span class="op" id="3366376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366379">if</span>&nbsp;<span class="ident" id="3366382">hasCR</span>&nbsp;<span class="op" id="3366388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366392">lit</span>&nbsp;<span class="op" id="3366396">=</span>&nbsp;<span class="ident" id="3366398">stripCR</span><span class="op" id="3366405">(</span><span class="ident" id="3366406">lit</span><span class="op" id="3366409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366416">return</span>&nbsp;<span class="builtintype" id="3366423">string</span><span class="op" id="3366429">(</span><span class="ident" id="3366430">lit</span><span class="op" id="3366433">)</span><br>
<span class="lineno"></span><span class="op" id="3366435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3366438">func</span>&nbsp;<span class="op" id="3366443">(</span><span class="ident" id="3366444">s</span>&nbsp;<span class="op" id="3366446">*</span><span class="ident" id="3366447">Scanner</span><span class="op" id="3366454">)</span>&nbsp;<span class="ident" id="3366456">findLineEnd</span><span class="op" id="3366467">(</span><span class="op" id="3366468">)</span>&nbsp;<span class="builtintype" id="3366470">bool</span>&nbsp;<span class="op" id="3366475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366478">//&nbsp;initial&nbsp;&#39;/&#39;&nbsp;already&nbsp;consumed</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366512">defer</span>&nbsp;<span class="keyword" id="3366518">func</span><span class="op" id="3366522">(</span><span class="ident" id="3366523">offs</span>&nbsp;<span class="builtintype" id="3366528">int</span><span class="op" id="3366531">)</span>&nbsp;<span class="op" id="3366533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366537">//&nbsp;reset&nbsp;scanner&nbsp;state&nbsp;to&nbsp;where&nbsp;it&nbsp;was&nbsp;upon&nbsp;calling&nbsp;findLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366603">s</span><span class="op" id="3366604">.</span><span class="ident" id="3366605">ch</span>&nbsp;<span class="op" id="3366608">=</span>&nbsp;<span class="string" id="3366610">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366616">s</span><span class="op" id="3366617">.</span><span class="ident" id="3366618">offset</span>&nbsp;<span class="op" id="3366625">=</span>&nbsp;<span class="ident" id="3366627">offs</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366634">s</span><span class="op" id="3366635">.</span><span class="ident" id="3366636">rdOffset</span>&nbsp;<span class="op" id="3366645">=</span>&nbsp;<span class="ident" id="3366647">offs</span>&nbsp;<span class="op" id="3366652">+</span>&nbsp;<span class="num" id="3366654">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366658">s</span><span class="op" id="3366659">.</span><span class="ident" id="3366660">next</span><span class="op" id="3366664">(</span><span class="op" id="3366665">)</span>&nbsp;<span class="comment" id="3366667">//&nbsp;consume&nbsp;initial&nbsp;&#39;/&#39;&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366697">}</span><span class="op" id="3366698">(</span><span class="ident" id="3366699">s</span><span class="op" id="3366700">.</span><span class="ident" id="3366701">offset</span>&nbsp;<span class="op" id="3366708">-</span>&nbsp;<span class="num" id="3366710">1</span><span class="op" id="3366711">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366715">//&nbsp;read&nbsp;ahead&nbsp;until&nbsp;a&nbsp;newline,&nbsp;EOF,&nbsp;or&nbsp;non-comment&nbsp;token&nbsp;is&nbsp;found</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366782">for</span>&nbsp;<span class="ident" id="3366786">s</span><span class="op" id="3366787">.</span><span class="ident" id="3366788">ch</span>&nbsp;<span class="op" id="3366791">==</span>&nbsp;<span class="string" id="3366794">&#39;/&#39;</span>&nbsp;<span class="op" id="3366798">||</span>&nbsp;<span class="ident" id="3366801">s</span><span class="op" id="3366802">.</span><span class="ident" id="3366803">ch</span>&nbsp;<span class="op" id="3366806">==</span>&nbsp;<span class="string" id="3366809">&#39;*&#39;</span>&nbsp;<span class="op" id="3366813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366817">if</span>&nbsp;<span class="ident" id="3366820">s</span><span class="op" id="3366821">.</span><span class="ident" id="3366822">ch</span>&nbsp;<span class="op" id="3366825">==</span>&nbsp;<span class="string" id="3366828">&#39;/&#39;</span>&nbsp;<span class="op" id="3366832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366837">//-style&nbsp;comment&nbsp;always&nbsp;contains&nbsp;a&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366883">return</span>&nbsp;<span class="builtintype" id="3366890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3366897">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3366901">/*-style&nbsp;comment:&nbsp;look&nbsp;for&nbsp;newline&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366941">s</span><span class="op" id="3366942">.</span><span class="ident" id="3366943">next</span><span class="op" id="3366947">(</span><span class="op" id="3366948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366952">for</span>&nbsp;<span class="ident" id="3366956">s</span><span class="op" id="3366957">.</span><span class="ident" id="3366958">ch</span>&nbsp;<span class="op" id="3366961">&gt;=</span>&nbsp;<span class="num" id="3366964">0</span>&nbsp;<span class="op" id="3366966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3366971">ch</span>&nbsp;<span class="op" id="3366974">:=</span>&nbsp;<span class="ident" id="3366977">s</span><span class="op" id="3366978">.</span><span class="ident" id="3366979">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3366985">if</span>&nbsp;<span class="ident" id="3366988">ch</span>&nbsp;<span class="op" id="3366991">==</span>&nbsp;<span class="string" id="3366994">&#39;\n&#39;</span>&nbsp;<span class="op" id="3366999">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367005">return</span>&nbsp;<span class="builtintype" id="3367012">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367025">s</span><span class="op" id="3367026">.</span><span class="ident" id="3367027">next</span><span class="op" id="3367031">(</span><span class="op" id="3367032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367037">if</span>&nbsp;<span class="ident" id="3367040">ch</span>&nbsp;<span class="op" id="3367043">==</span>&nbsp;<span class="string" id="3367046">&#39;*&#39;</span>&nbsp;<span class="op" id="3367050">&amp;&amp;</span>&nbsp;<span class="ident" id="3367053">s</span><span class="op" id="3367054">.</span><span class="ident" id="3367055">ch</span>&nbsp;<span class="op" id="3367058">==</span>&nbsp;<span class="string" id="3367061">&#39;/&#39;</span>&nbsp;<span class="op" id="3367065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367071">s</span><span class="op" id="3367072">.</span><span class="ident" id="3367073">next</span><span class="op" id="3367077">(</span><span class="op" id="3367078">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367084">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367101">s</span><span class="op" id="3367102">.</span><span class="ident" id="3367103">skipWhitespace</span><span class="op" id="3367117">(</span><span class="op" id="3367118">)</span>&nbsp;<span class="comment" id="3367120">//&nbsp;s.insertSemi&nbsp;is&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367145">if</span>&nbsp;<span class="ident" id="3367148">s</span><span class="op" id="3367149">.</span><span class="ident" id="3367150">ch</span>&nbsp;<span class="op" id="3367153">&lt;</span>&nbsp;<span class="num" id="3367155">0</span>&nbsp;<span class="op" id="3367157">||</span>&nbsp;<span class="ident" id="3367160">s</span><span class="op" id="3367161">.</span><span class="ident" id="3367162">ch</span>&nbsp;<span class="op" id="3367165">==</span>&nbsp;<span class="string" id="3367168">&#39;\n&#39;</span>&nbsp;<span class="op" id="3367173">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367178">return</span>&nbsp;<span class="builtintype" id="3367185">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367196">if</span>&nbsp;<span class="ident" id="3367199">s</span><span class="op" id="3367200">.</span><span class="ident" id="3367201">ch</span>&nbsp;<span class="op" id="3367204">!=</span>&nbsp;<span class="string" id="3367207">&#39;/&#39;</span>&nbsp;<span class="op" id="3367211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3367216">//&nbsp;non-comment&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367240">return</span>&nbsp;<span class="builtintype" id="3367247">false</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367259">s</span><span class="op" id="3367260">.</span><span class="ident" id="3367261">next</span><span class="op" id="3367265">(</span><span class="op" id="3367266">)</span>&nbsp;<span class="comment" id="3367268">//&nbsp;consume&nbsp;&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367288">return</span>&nbsp;<span class="builtintype" id="3367295">false</span><br>
<span class="lineno">255</span><span class="op" id="3367301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3367304">func</span>&nbsp;<span class="ident" id="3367309">isLetter</span><span class="op" id="3367317">(</span><span class="ident" id="3367318">ch</span>&nbsp;<span class="builtintype" id="3367321">rune</span><span class="op" id="3367325">)</span>&nbsp;<span class="builtintype" id="3367327">bool</span>&nbsp;<span class="op" id="3367332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367335">return</span>&nbsp;<span class="string" id="3367342">&#39;a&#39;</span>&nbsp;<span class="op" id="3367346">&lt;=</span>&nbsp;<span class="ident" id="3367349">ch</span>&nbsp;<span class="op" id="3367352">&amp;&amp;</span>&nbsp;<span class="ident" id="3367355">ch</span>&nbsp;<span class="op" id="3367358">&lt;=</span>&nbsp;<span class="string" id="3367361">&#39;z&#39;</span>&nbsp;<span class="op" id="3367365">||</span>&nbsp;<span class="string" id="3367368">&#39;A&#39;</span>&nbsp;<span class="op" id="3367372">&lt;=</span>&nbsp;<span class="ident" id="3367375">ch</span>&nbsp;<span class="op" id="3367378">&amp;&amp;</span>&nbsp;<span class="ident" id="3367381">ch</span>&nbsp;<span class="op" id="3367384">&lt;=</span>&nbsp;<span class="string" id="3367387">&#39;Z&#39;</span>&nbsp;<span class="op" id="3367391">||</span>&nbsp;<span class="ident" id="3367394">ch</span>&nbsp;<span class="op" id="3367397">==</span>&nbsp;<span class="string" id="3367400">&#39;_&#39;</span>&nbsp;<span class="op" id="3367404">||</span>&nbsp;<span class="ident" id="3367407">ch</span>&nbsp;<span class="op" id="3367410">&gt;=</span>&nbsp;<span class="num" id="3367413">0x80</span>&nbsp;<span class="op" id="3367418">&amp;&amp;</span>&nbsp;<span class="ident" id="3367421">unicode</span><span class="op" id="3367428">.</span><span class="ident" id="3367429">IsLetter</span><span class="op" id="3367437">(</span><span class="ident" id="3367438">ch</span><span class="op" id="3367440">)</span><br>
<span class="lineno"></span><span class="op" id="3367442">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="3367445">func</span>&nbsp;<span class="ident" id="3367450">isDigit</span><span class="op" id="3367457">(</span><span class="ident" id="3367458">ch</span>&nbsp;<span class="builtintype" id="3367461">rune</span><span class="op" id="3367465">)</span>&nbsp;<span class="builtintype" id="3367467">bool</span>&nbsp;<span class="op" id="3367472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367475">return</span>&nbsp;<span class="string" id="3367482">&#39;0&#39;</span>&nbsp;<span class="op" id="3367486">&lt;=</span>&nbsp;<span class="ident" id="3367489">ch</span>&nbsp;<span class="op" id="3367492">&amp;&amp;</span>&nbsp;<span class="ident" id="3367495">ch</span>&nbsp;<span class="op" id="3367498">&lt;=</span>&nbsp;<span class="string" id="3367501">&#39;9&#39;</span>&nbsp;<span class="op" id="3367505">||</span>&nbsp;<span class="ident" id="3367508">ch</span>&nbsp;<span class="op" id="3367511">&gt;=</span>&nbsp;<span class="num" id="3367514">0x80</span>&nbsp;<span class="op" id="3367519">&amp;&amp;</span>&nbsp;<span class="ident" id="3367522">unicode</span><span class="op" id="3367529">.</span><span class="ident" id="3367530">IsDigit</span><span class="op" id="3367537">(</span><span class="ident" id="3367538">ch</span><span class="op" id="3367540">)</span><br>
<span class="lineno"></span><span class="op" id="3367542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3367545">func</span>&nbsp;<span class="op" id="3367550">(</span><span class="ident" id="3367551">s</span>&nbsp;<span class="op" id="3367553">*</span><span class="ident" id="3367554">Scanner</span><span class="op" id="3367561">)</span>&nbsp;<span class="ident" id="3367563">scanIdentifier</span><span class="op" id="3367577">(</span><span class="op" id="3367578">)</span>&nbsp;<span class="builtintype" id="3367580">string</span>&nbsp;<span class="op" id="3367587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367590">offs</span>&nbsp;<span class="op" id="3367595">:=</span>&nbsp;<span class="ident" id="3367598">s</span><span class="op" id="3367599">.</span><span class="ident" id="3367600">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367608">for</span>&nbsp;<span class="ident" id="3367612">isLetter</span><span class="op" id="3367620">(</span><span class="ident" id="3367621">s</span><span class="op" id="3367622">.</span><span class="ident" id="3367623">ch</span><span class="op" id="3367625">)</span>&nbsp;<span class="op" id="3367627">||</span>&nbsp;<span class="ident" id="3367630">isDigit</span><span class="op" id="3367637">(</span><span class="ident" id="3367638">s</span><span class="op" id="3367639">.</span><span class="ident" id="3367640">ch</span><span class="op" id="3367642">)</span>&nbsp;<span class="op" id="3367644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3367648">s</span><span class="op" id="3367649">.</span><span class="ident" id="3367650">next</span><span class="op" id="3367654">(</span><span class="op" id="3367655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367658">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367661">return</span>&nbsp;<span class="builtintype" id="3367668">string</span><span class="op" id="3367674">(</span><span class="ident" id="3367675">s</span><span class="op" id="3367676">.</span><span class="ident" id="3367677">src</span><span class="op" id="3367680">[</span><span class="ident" id="3367681">offs</span><span class="op" id="3367685">:</span><span class="ident" id="3367686">s</span><span class="op" id="3367687">.</span><span class="ident" id="3367688">offset</span><span class="op" id="3367694">]</span><span class="op" id="3367695">)</span><br>
<span class="lineno"></span><span class="op" id="3367697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3367700">func</span>&nbsp;<span class="ident" id="3367705">digitVal</span><span class="op" id="3367713">(</span><span class="ident" id="3367714">ch</span>&nbsp;<span class="builtintype" id="3367717">rune</span><span class="op" id="3367721">)</span>&nbsp;<span class="builtintype" id="3367723">int</span>&nbsp;<span class="op" id="3367727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367730">switch</span>&nbsp;<span class="op" id="3367737">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367740">case</span>&nbsp;<span class="string" id="3367745">&#39;0&#39;</span>&nbsp;<span class="op" id="3367749">&lt;=</span>&nbsp;<span class="ident" id="3367752">ch</span>&nbsp;<span class="op" id="3367755">&amp;&amp;</span>&nbsp;<span class="ident" id="3367758">ch</span>&nbsp;<span class="op" id="3367761">&lt;=</span>&nbsp;<span class="string" id="3367764">&#39;9&#39;</span><span class="op" id="3367767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367771">return</span>&nbsp;<span class="builtintype" id="3367778">int</span><span class="op" id="3367781">(</span><span class="ident" id="3367782">ch</span>&nbsp;<span class="op" id="3367785">-</span>&nbsp;<span class="string" id="3367787">&#39;0&#39;</span><span class="op" id="3367790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367793">case</span>&nbsp;<span class="string" id="3367798">&#39;a&#39;</span>&nbsp;<span class="op" id="3367802">&lt;=</span>&nbsp;<span class="ident" id="3367805">ch</span>&nbsp;<span class="op" id="3367808">&amp;&amp;</span>&nbsp;<span class="ident" id="3367811">ch</span>&nbsp;<span class="op" id="3367814">&lt;=</span>&nbsp;<span class="string" id="3367817">&#39;f&#39;</span><span class="op" id="3367820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367824">return</span>&nbsp;<span class="builtintype" id="3367831">int</span><span class="op" id="3367834">(</span><span class="ident" id="3367835">ch</span>&nbsp;<span class="op" id="3367838">-</span>&nbsp;<span class="string" id="3367840">&#39;a&#39;</span>&nbsp;<span class="op" id="3367844">+</span>&nbsp;<span class="num" id="3367846">10</span><span class="op" id="3367848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367851">case</span>&nbsp;<span class="string" id="3367856">&#39;A&#39;</span>&nbsp;<span class="op" id="3367860">&lt;=</span>&nbsp;<span class="ident" id="3367863">ch</span>&nbsp;<span class="op" id="3367866">&amp;&amp;</span>&nbsp;<span class="ident" id="3367869">ch</span>&nbsp;<span class="op" id="3367872">&lt;=</span>&nbsp;<span class="string" id="3367875">&#39;F&#39;</span><span class="op" id="3367878">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367882">return</span>&nbsp;<span class="builtintype" id="3367889">int</span><span class="op" id="3367892">(</span><span class="ident" id="3367893">ch</span>&nbsp;<span class="op" id="3367896">-</span>&nbsp;<span class="string" id="3367898">&#39;A&#39;</span>&nbsp;<span class="op" id="3367902">+</span>&nbsp;<span class="num" id="3367904">10</span><span class="op" id="3367906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3367909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3367912">return</span>&nbsp;<span class="num" id="3367919">16</span>&nbsp;<span class="comment" id="3367922">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="3367957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3367960">func</span>&nbsp;<span class="op" id="3367965">(</span><span class="ident" id="3367966">s</span>&nbsp;<span class="op" id="3367968">*</span><span class="ident" id="3367969">Scanner</span><span class="op" id="3367976">)</span>&nbsp;<span class="ident" id="3367978">scanMantissa</span><span class="op" id="3367990">(</span><span class="ident" id="3367991">base</span>&nbsp;<span class="builtintype" id="3367996">int</span><span class="op" id="3367999">)</span>&nbsp;<span class="op" id="3368001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368004">for</span>&nbsp;<span class="ident" id="3368008">digitVal</span><span class="op" id="3368016">(</span><span class="ident" id="3368017">s</span><span class="op" id="3368018">.</span><span class="ident" id="3368019">ch</span><span class="op" id="3368021">)</span>&nbsp;<span class="op" id="3368023">&lt;</span>&nbsp;<span class="ident" id="3368025">base</span>&nbsp;<span class="op" id="3368030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368034">s</span><span class="op" id="3368035">.</span><span class="ident" id="3368036">next</span><span class="op" id="3368040">(</span><span class="op" id="3368041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368044">}</span><br>
<span class="lineno"></span><span class="op" id="3368046">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="3368049">func</span>&nbsp;<span class="op" id="3368054">(</span><span class="ident" id="3368055">s</span>&nbsp;<span class="op" id="3368057">*</span><span class="ident" id="3368058">Scanner</span><span class="op" id="3368065">)</span>&nbsp;<span class="ident" id="3368067">scanNumber</span><span class="op" id="3368077">(</span><span class="ident" id="3368078">seenDecimalPoint</span>&nbsp;<span class="builtintype" id="3368095">bool</span><span class="op" id="3368099">)</span>&nbsp;<span class="op" id="3368101">(</span><span class="ident" id="3368102">token</span><span class="op" id="3368107">.</span><span class="ident" id="3368108">Token</span><span class="op" id="3368113">,</span>&nbsp;<span class="builtintype" id="3368115">string</span><span class="op" id="3368121">)</span>&nbsp;<span class="op" id="3368123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368126">//&nbsp;digitVal(s.ch)&nbsp;&lt;&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368150">offs</span>&nbsp;<span class="op" id="3368155">:=</span>&nbsp;<span class="ident" id="3368158">s</span><span class="op" id="3368159">.</span><span class="ident" id="3368160">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368168">tok</span>&nbsp;<span class="op" id="3368172">:=</span>&nbsp;<span class="ident" id="3368175">token</span><span class="op" id="3368180">.</span><span class="ident" id="3368181">INT</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368187">if</span>&nbsp;<span class="ident" id="3368190">seenDecimalPoint</span>&nbsp;<span class="op" id="3368207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368211">offs</span><span class="op" id="3368215">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368220">tok</span>&nbsp;<span class="op" id="3368224">=</span>&nbsp;<span class="ident" id="3368226">token</span><span class="op" id="3368231">.</span><span class="ident" id="3368232">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368240">s</span><span class="op" id="3368241">.</span><span class="ident" id="3368242">scanMantissa</span><span class="op" id="3368254">(</span><span class="num" id="3368255">10</span><span class="op" id="3368257">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368261">goto</span>&nbsp;<span class="ident" id="3368266">exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368280">if</span>&nbsp;<span class="ident" id="3368283">s</span><span class="op" id="3368284">.</span><span class="ident" id="3368285">ch</span>&nbsp;<span class="op" id="3368288">==</span>&nbsp;<span class="string" id="3368291">&#39;0&#39;</span>&nbsp;<span class="op" id="3368295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368299">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368317">offs</span>&nbsp;<span class="op" id="3368322">:=</span>&nbsp;<span class="ident" id="3368325">s</span><span class="op" id="3368326">.</span><span class="ident" id="3368327">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368336">s</span><span class="op" id="3368337">.</span><span class="ident" id="3368338">next</span><span class="op" id="3368342">(</span><span class="op" id="3368343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368347">if</span>&nbsp;<span class="ident" id="3368350">s</span><span class="op" id="3368351">.</span><span class="ident" id="3368352">ch</span>&nbsp;<span class="op" id="3368355">==</span>&nbsp;<span class="string" id="3368358">&#39;x&#39;</span>&nbsp;<span class="op" id="3368362">||</span>&nbsp;<span class="ident" id="3368365">s</span><span class="op" id="3368366">.</span><span class="ident" id="3368367">ch</span>&nbsp;<span class="op" id="3368370">==</span>&nbsp;<span class="string" id="3368373">&#39;X&#39;</span>&nbsp;<span class="op" id="3368377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368382">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368404">s</span><span class="op" id="3368405">.</span><span class="ident" id="3368406">next</span><span class="op" id="3368410">(</span><span class="op" id="3368411">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368416">s</span><span class="op" id="3368417">.</span><span class="ident" id="3368418">scanMantissa</span><span class="op" id="3368430">(</span><span class="num" id="3368431">16</span><span class="op" id="3368433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368438">if</span>&nbsp;<span class="ident" id="3368441">s</span><span class="op" id="3368442">.</span><span class="ident" id="3368443">offset</span><span class="op" id="3368449">-</span><span class="ident" id="3368450">offs</span>&nbsp;<span class="op" id="3368455">&lt;=</span>&nbsp;<span class="num" id="3368458">2</span>&nbsp;<span class="op" id="3368460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368466">//&nbsp;only&nbsp;scanned&nbsp;&#34;0x&#34;&nbsp;or&nbsp;&#34;0X&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368499">s</span><span class="op" id="3368500">.</span><span class="builtintype" id="3368501">error</span><span class="op" id="3368506">(</span><span class="ident" id="3368507">offs</span><span class="op" id="3368511">,</span>&nbsp;<span class="string" id="3368513">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="3368541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368546">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368550">}</span>&nbsp;<span class="keyword" id="3368552">else</span>&nbsp;<span class="op" id="3368557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368562">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368587">seenDecimalDigit</span>&nbsp;<span class="op" id="3368604">:=</span>&nbsp;<span class="builtintype" id="3368607">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368616">s</span><span class="op" id="3368617">.</span><span class="ident" id="3368618">scanMantissa</span><span class="op" id="3368630">(</span><span class="num" id="3368631">8</span><span class="op" id="3368632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368637">if</span>&nbsp;<span class="ident" id="3368640">s</span><span class="op" id="3368641">.</span><span class="ident" id="3368642">ch</span>&nbsp;<span class="op" id="3368645">==</span>&nbsp;<span class="string" id="3368648">&#39;8&#39;</span>&nbsp;<span class="op" id="3368652">||</span>&nbsp;<span class="ident" id="3368655">s</span><span class="op" id="3368656">.</span><span class="ident" id="3368657">ch</span>&nbsp;<span class="op" id="3368660">==</span>&nbsp;<span class="string" id="3368663">&#39;9&#39;</span>&nbsp;<span class="op" id="3368667">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368673">//&nbsp;illegal&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368707">seenDecimalDigit</span>&nbsp;<span class="op" id="3368724">=</span>&nbsp;<span class="builtintype" id="3368726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368735">s</span><span class="op" id="3368736">.</span><span class="ident" id="3368737">scanMantissa</span><span class="op" id="3368749">(</span><span class="num" id="3368750">10</span><span class="op" id="3368752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368762">if</span>&nbsp;<span class="ident" id="3368765">s</span><span class="op" id="3368766">.</span><span class="ident" id="3368767">ch</span>&nbsp;<span class="op" id="3368770">==</span>&nbsp;<span class="string" id="3368773">&#39;.&#39;</span>&nbsp;<span class="op" id="3368777">||</span>&nbsp;<span class="ident" id="3368780">s</span><span class="op" id="3368781">.</span><span class="ident" id="3368782">ch</span>&nbsp;<span class="op" id="3368785">==</span>&nbsp;<span class="string" id="3368788">&#39;e&#39;</span>&nbsp;<span class="op" id="3368792">||</span>&nbsp;<span class="ident" id="3368795">s</span><span class="op" id="3368796">.</span><span class="ident" id="3368797">ch</span>&nbsp;<span class="op" id="3368800">==</span>&nbsp;<span class="string" id="3368803">&#39;E&#39;</span>&nbsp;<span class="op" id="3368807">||</span>&nbsp;<span class="ident" id="3368810">s</span><span class="op" id="3368811">.</span><span class="ident" id="3368812">ch</span>&nbsp;<span class="op" id="3368815">==</span>&nbsp;<span class="string" id="3368818">&#39;i&#39;</span>&nbsp;<span class="op" id="3368822">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368828">goto</span>&nbsp;<span class="ident" id="3368833">fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368850">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368866">if</span>&nbsp;<span class="ident" id="3368869">seenDecimalDigit</span>&nbsp;<span class="op" id="3368886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368892">s</span><span class="op" id="3368893">.</span><span class="builtintype" id="3368894">error</span><span class="op" id="3368899">(</span><span class="ident" id="3368900">offs</span><span class="op" id="3368904">,</span>&nbsp;<span class="string" id="3368906">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="3368928">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3368941">goto</span>&nbsp;<span class="ident" id="3368946">exit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3368952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3368956">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3368981">s</span><span class="op" id="3368982">.</span><span class="ident" id="3368983">scanMantissa</span><span class="op" id="3368995">(</span><span class="num" id="3368996">10</span><span class="op" id="3368998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="3369001">fraction</span><span class="op" id="3369009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369012">if</span>&nbsp;<span class="ident" id="3369015">s</span><span class="op" id="3369016">.</span><span class="ident" id="3369017">ch</span>&nbsp;<span class="op" id="3369020">==</span>&nbsp;<span class="string" id="3369023">&#39;.&#39;</span>&nbsp;<span class="op" id="3369027">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369031">tok</span>&nbsp;<span class="op" id="3369035">=</span>&nbsp;<span class="ident" id="3369037">token</span><span class="op" id="3369042">.</span><span class="ident" id="3369043">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369051">s</span><span class="op" id="3369052">.</span><span class="ident" id="3369053">next</span><span class="op" id="3369057">(</span><span class="op" id="3369058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369062">s</span><span class="op" id="3369063">.</span><span class="ident" id="3369064">scanMantissa</span><span class="op" id="3369076">(</span><span class="num" id="3369077">10</span><span class="op" id="3369079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="ident" id="3369085">exponent</span><span class="op" id="3369093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369096">if</span>&nbsp;<span class="ident" id="3369099">s</span><span class="op" id="3369100">.</span><span class="ident" id="3369101">ch</span>&nbsp;<span class="op" id="3369104">==</span>&nbsp;<span class="string" id="3369107">&#39;e&#39;</span>&nbsp;<span class="op" id="3369111">||</span>&nbsp;<span class="ident" id="3369114">s</span><span class="op" id="3369115">.</span><span class="ident" id="3369116">ch</span>&nbsp;<span class="op" id="3369119">==</span>&nbsp;<span class="string" id="3369122">&#39;E&#39;</span>&nbsp;<span class="op" id="3369126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369130">tok</span>&nbsp;<span class="op" id="3369134">=</span>&nbsp;<span class="ident" id="3369136">token</span><span class="op" id="3369141">.</span><span class="ident" id="3369142">FLOAT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369150">s</span><span class="op" id="3369151">.</span><span class="ident" id="3369152">next</span><span class="op" id="3369156">(</span><span class="op" id="3369157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369161">if</span>&nbsp;<span class="ident" id="3369164">s</span><span class="op" id="3369165">.</span><span class="ident" id="3369166">ch</span>&nbsp;<span class="op" id="3369169">==</span>&nbsp;<span class="string" id="3369172">&#39;-&#39;</span>&nbsp;<span class="op" id="3369176">||</span>&nbsp;<span class="ident" id="3369179">s</span><span class="op" id="3369180">.</span><span class="ident" id="3369181">ch</span>&nbsp;<span class="op" id="3369184">==</span>&nbsp;<span class="string" id="3369187">&#39;+&#39;</span>&nbsp;<span class="op" id="3369191">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369196">s</span><span class="op" id="3369197">.</span><span class="ident" id="3369198">next</span><span class="op" id="3369202">(</span><span class="op" id="3369203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369211">s</span><span class="op" id="3369212">.</span><span class="ident" id="3369213">scanMantissa</span><span class="op" id="3369225">(</span><span class="num" id="3369226">10</span><span class="op" id="3369228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369235">if</span>&nbsp;<span class="ident" id="3369238">s</span><span class="op" id="3369239">.</span><span class="ident" id="3369240">ch</span>&nbsp;<span class="op" id="3369243">==</span>&nbsp;<span class="string" id="3369246">&#39;i&#39;</span>&nbsp;<span class="op" id="3369250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369254">tok</span>&nbsp;<span class="op" id="3369258">=</span>&nbsp;<span class="ident" id="3369260">token</span><span class="op" id="3369265">.</span><span class="ident" id="3369266">IMAG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369273">s</span><span class="op" id="3369274">.</span><span class="ident" id="3369275">next</span><span class="op" id="3369279">(</span><span class="op" id="3369280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3369283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="ident" id="3369286">exit</span><span class="op" id="3369290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369293">return</span>&nbsp;<span class="ident" id="3369300">tok</span><span class="op" id="3369303">,</span>&nbsp;<span class="builtintype" id="3369305">string</span><span class="op" id="3369311">(</span><span class="ident" id="3369312">s</span><span class="op" id="3369313">.</span><span class="ident" id="3369314">src</span><span class="op" id="3369317">[</span><span class="ident" id="3369318">offs</span><span class="op" id="3369322">:</span><span class="ident" id="3369323">s</span><span class="op" id="3369324">.</span><span class="ident" id="3369325">offset</span><span class="op" id="3369331">]</span><span class="op" id="3369332">)</span><br>
<span class="lineno"></span><span class="op" id="3369334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3369337">//&nbsp;scanEscape&nbsp;parses&nbsp;an&nbsp;escape&nbsp;sequence&nbsp;where&nbsp;rune&nbsp;is&nbsp;the&nbsp;accepted</span><br>
<span class="lineno">365</span><span class="comment" id="3369404">//&nbsp;escaped&nbsp;quote.&nbsp;In&nbsp;case&nbsp;of&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;it&nbsp;stops&nbsp;at&nbsp;the&nbsp;offending</span><br>
<span class="lineno"></span><span class="comment" id="3369475">//&nbsp;character&nbsp;(without&nbsp;consuming&nbsp;it)&nbsp;and&nbsp;returns&nbsp;false.&nbsp;Otherwise</span><br>
<span class="lineno"></span><span class="comment" id="3369540">//&nbsp;it&nbsp;returns&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3369560">func</span>&nbsp;<span class="op" id="3369565">(</span><span class="ident" id="3369566">s</span>&nbsp;<span class="op" id="3369568">*</span><span class="ident" id="3369569">Scanner</span><span class="op" id="3369576">)</span>&nbsp;<span class="ident" id="3369578">scanEscape</span><span class="op" id="3369588">(</span><span class="ident" id="3369589">quote</span>&nbsp;<span class="builtintype" id="3369595">rune</span><span class="op" id="3369599">)</span>&nbsp;<span class="builtintype" id="3369601">bool</span>&nbsp;<span class="op" id="3369606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369609">offs</span>&nbsp;<span class="op" id="3369614">:=</span>&nbsp;<span class="ident" id="3369617">s</span><span class="op" id="3369618">.</span><span class="ident" id="3369619">offset</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369628">var</span>&nbsp;<span class="ident" id="3369632">n</span>&nbsp;<span class="builtintype" id="3369634">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369639">var</span>&nbsp;<span class="ident" id="3369643">base</span><span class="op" id="3369647">,</span>&nbsp;<span class="ident" id="3369649">max</span>&nbsp;<span class="builtintype" id="3369653">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369661">switch</span>&nbsp;<span class="ident" id="3369668">s</span><span class="op" id="3369669">.</span><span class="ident" id="3369670">ch</span>&nbsp;<span class="op" id="3369673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369676">case</span>&nbsp;<span class="string" id="3369681">&#39;a&#39;</span><span class="op" id="3369684">,</span>&nbsp;<span class="string" id="3369686">&#39;b&#39;</span><span class="op" id="3369689">,</span>&nbsp;<span class="string" id="3369691">&#39;f&#39;</span><span class="op" id="3369694">,</span>&nbsp;<span class="string" id="3369696">&#39;n&#39;</span><span class="op" id="3369699">,</span>&nbsp;<span class="string" id="3369701">&#39;r&#39;</span><span class="op" id="3369704">,</span>&nbsp;<span class="string" id="3369706">&#39;t&#39;</span><span class="op" id="3369709">,</span>&nbsp;<span class="string" id="3369711">&#39;v&#39;</span><span class="op" id="3369714">,</span>&nbsp;<span class="string" id="3369716">&#39;\\&#39;</span><span class="op" id="3369720">,</span>&nbsp;<span class="ident" id="3369722">quote</span><span class="op" id="3369727">:</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369731">s</span><span class="op" id="3369732">.</span><span class="ident" id="3369733">next</span><span class="op" id="3369737">(</span><span class="op" id="3369738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369742">return</span>&nbsp;<span class="builtintype" id="3369749">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369755">case</span>&nbsp;<span class="string" id="3369760">&#39;0&#39;</span><span class="op" id="3369763">,</span>&nbsp;<span class="string" id="3369765">&#39;1&#39;</span><span class="op" id="3369768">,</span>&nbsp;<span class="string" id="3369770">&#39;2&#39;</span><span class="op" id="3369773">,</span>&nbsp;<span class="string" id="3369775">&#39;3&#39;</span><span class="op" id="3369778">,</span>&nbsp;<span class="string" id="3369780">&#39;4&#39;</span><span class="op" id="3369783">,</span>&nbsp;<span class="string" id="3369785">&#39;5&#39;</span><span class="op" id="3369788">,</span>&nbsp;<span class="string" id="3369790">&#39;6&#39;</span><span class="op" id="3369793">,</span>&nbsp;<span class="string" id="3369795">&#39;7&#39;</span><span class="op" id="3369798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369802">n</span><span class="op" id="3369803">,</span>&nbsp;<span class="ident" id="3369805">base</span><span class="op" id="3369809">,</span>&nbsp;<span class="ident" id="3369811">max</span>&nbsp;<span class="op" id="3369815">=</span>&nbsp;<span class="num" id="3369817">3</span><span class="op" id="3369818">,</span>&nbsp;<span class="num" id="3369820">8</span><span class="op" id="3369821">,</span>&nbsp;<span class="num" id="3369823">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369828">case</span>&nbsp;<span class="string" id="3369833">&#39;x&#39;</span><span class="op" id="3369836">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369840">s</span><span class="op" id="3369841">.</span><span class="ident" id="3369842">next</span><span class="op" id="3369846">(</span><span class="op" id="3369847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369851">n</span><span class="op" id="3369852">,</span>&nbsp;<span class="ident" id="3369854">base</span><span class="op" id="3369858">,</span>&nbsp;<span class="ident" id="3369860">max</span>&nbsp;<span class="op" id="3369864">=</span>&nbsp;<span class="num" id="3369866">2</span><span class="op" id="3369867">,</span>&nbsp;<span class="num" id="3369869">16</span><span class="op" id="3369871">,</span>&nbsp;<span class="num" id="3369873">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369878">case</span>&nbsp;<span class="string" id="3369883">&#39;u&#39;</span><span class="op" id="3369886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369890">s</span><span class="op" id="3369891">.</span><span class="ident" id="3369892">next</span><span class="op" id="3369896">(</span><span class="op" id="3369897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369901">n</span><span class="op" id="3369902">,</span>&nbsp;<span class="ident" id="3369904">base</span><span class="op" id="3369908">,</span>&nbsp;<span class="ident" id="3369910">max</span>&nbsp;<span class="op" id="3369914">=</span>&nbsp;<span class="num" id="3369916">4</span><span class="op" id="3369917">,</span>&nbsp;<span class="num" id="3369919">16</span><span class="op" id="3369921">,</span>&nbsp;<span class="ident" id="3369923">unicode</span><span class="op" id="3369930">.</span><span class="ident" id="3369931">MaxRune</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3369940">case</span>&nbsp;<span class="string" id="3369945">&#39;U&#39;</span><span class="op" id="3369948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369952">s</span><span class="op" id="3369953">.</span><span class="ident" id="3369954">next</span><span class="op" id="3369958">(</span><span class="op" id="3369959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3369963">n</span><span class="op" id="3369964">,</span>&nbsp;<span class="ident" id="3369966">base</span><span class="op" id="3369970">,</span>&nbsp;<span class="ident" id="3369972">max</span>&nbsp;<span class="op" id="3369976">=</span>&nbsp;<span class="num" id="3369978">8</span><span class="op" id="3369979">,</span>&nbsp;<span class="num" id="3369981">16</span><span class="op" id="3369983">,</span>&nbsp;<span class="ident" id="3369985">unicode</span><span class="op" id="3369992">.</span><span class="ident" id="3369993">MaxRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370002">default</span><span class="op" id="3370009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370013">msg</span>&nbsp;<span class="op" id="3370017">:=</span>&nbsp;<span class="string" id="3370020">&#34;unknown&nbsp;escape&nbsp;sequence&#34;</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370048">if</span>&nbsp;<span class="ident" id="3370051">s</span><span class="op" id="3370052">.</span><span class="ident" id="3370053">ch</span>&nbsp;<span class="op" id="3370056">&lt;</span>&nbsp;<span class="num" id="3370058">0</span>&nbsp;<span class="op" id="3370060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370065">msg</span>&nbsp;<span class="op" id="3370069">=</span>&nbsp;<span class="string" id="3370071">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370110">s</span><span class="op" id="3370111">.</span><span class="builtintype" id="3370112">error</span><span class="op" id="3370117">(</span><span class="ident" id="3370118">offs</span><span class="op" id="3370122">,</span>&nbsp;<span class="ident" id="3370124">msg</span><span class="op" id="3370127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370131">return</span>&nbsp;<span class="builtintype" id="3370138">false</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370149">var</span>&nbsp;<span class="ident" id="3370153">x</span>&nbsp;<span class="builtintype" id="3370155">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370163">for</span>&nbsp;<span class="ident" id="3370167">n</span>&nbsp;<span class="op" id="3370169">&gt;</span>&nbsp;<span class="num" id="3370171">0</span>&nbsp;<span class="op" id="3370173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370177">d</span>&nbsp;<span class="op" id="3370179">:=</span>&nbsp;<span class="builtintype" id="3370182">uint32</span><span class="op" id="3370188">(</span><span class="ident" id="3370189">digitVal</span><span class="op" id="3370197">(</span><span class="ident" id="3370198">s</span><span class="op" id="3370199">.</span><span class="ident" id="3370200">ch</span><span class="op" id="3370202">)</span><span class="op" id="3370203">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370207">if</span>&nbsp;<span class="ident" id="3370210">d</span>&nbsp;<span class="op" id="3370212">&gt;=</span>&nbsp;<span class="ident" id="3370215">base</span>&nbsp;<span class="op" id="3370220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370225">msg</span>&nbsp;<span class="op" id="3370229">:=</span>&nbsp;<span class="ident" id="3370232">fmt</span><span class="op" id="3370235">.</span><span class="ident" id="3370236">Sprintf</span><span class="op" id="3370243">(</span><span class="string" id="3370244">&#34;illegal&nbsp;character&nbsp;%#U&nbsp;in&nbsp;escape&nbsp;sequence&#34;</span><span class="op" id="3370286">,</span>&nbsp;<span class="ident" id="3370288">s</span><span class="op" id="3370289">.</span><span class="ident" id="3370290">ch</span><span class="op" id="3370292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370297">if</span>&nbsp;<span class="ident" id="3370300">s</span><span class="op" id="3370301">.</span><span class="ident" id="3370302">ch</span>&nbsp;<span class="op" id="3370305">&lt;</span>&nbsp;<span class="num" id="3370307">0</span>&nbsp;<span class="op" id="3370309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370315">msg</span>&nbsp;<span class="op" id="3370319">=</span>&nbsp;<span class="string" id="3370321">&#34;escape&nbsp;sequence&nbsp;not&nbsp;terminated&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370357">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370362">s</span><span class="op" id="3370363">.</span><span class="builtintype" id="3370364">error</span><span class="op" id="3370369">(</span><span class="ident" id="3370370">s</span><span class="op" id="3370371">.</span><span class="ident" id="3370372">offset</span><span class="op" id="3370378">,</span>&nbsp;<span class="ident" id="3370380">msg</span><span class="op" id="3370383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370388">return</span>&nbsp;<span class="builtintype" id="3370395">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370407">x</span>&nbsp;<span class="op" id="3370409">=</span>&nbsp;<span class="ident" id="3370411">x</span><span class="op" id="3370412">*</span><span class="ident" id="3370413">base</span>&nbsp;<span class="op" id="3370418">+</span>&nbsp;<span class="ident" id="3370420">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370424">s</span><span class="op" id="3370425">.</span><span class="ident" id="3370426">next</span><span class="op" id="3370430">(</span><span class="op" id="3370431">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370435">n</span><span class="op" id="3370436">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370444">if</span>&nbsp;<span class="ident" id="3370447">x</span>&nbsp;<span class="op" id="3370449">&gt;</span>&nbsp;<span class="ident" id="3370451">max</span>&nbsp;<span class="op" id="3370455">||</span>&nbsp;<span class="num" id="3370458">0xD800</span>&nbsp;<span class="op" id="3370465">&lt;=</span>&nbsp;<span class="ident" id="3370468">x</span>&nbsp;<span class="op" id="3370470">&amp;&amp;</span>&nbsp;<span class="ident" id="3370473">x</span>&nbsp;<span class="op" id="3370475">&lt;</span>&nbsp;<span class="num" id="3370477">0xE000</span>&nbsp;<span class="op" id="3370484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370488">s</span><span class="op" id="3370489">.</span><span class="builtintype" id="3370490">error</span><span class="op" id="3370495">(</span><span class="ident" id="3370496">offs</span><span class="op" id="3370500">,</span>&nbsp;<span class="string" id="3370502">&#34;escape&nbsp;sequence&nbsp;is&nbsp;invalid&nbsp;Unicode&nbsp;code&nbsp;point&#34;</span><span class="op" id="3370549">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370553">return</span>&nbsp;<span class="builtintype" id="3370560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370571">return</span>&nbsp;<span class="builtintype" id="3370578">true</span><br>
<span class="lineno"></span><span class="op" id="3370583">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="keyword" id="3370586">func</span>&nbsp;<span class="op" id="3370591">(</span><span class="ident" id="3370592">s</span>&nbsp;<span class="op" id="3370594">*</span><span class="ident" id="3370595">Scanner</span><span class="op" id="3370602">)</span>&nbsp;<span class="ident" id="3370604">scanRune</span><span class="op" id="3370612">(</span><span class="op" id="3370613">)</span>&nbsp;<span class="builtintype" id="3370615">string</span>&nbsp;<span class="op" id="3370622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3370625">//&nbsp;&#39;\&#39;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370659">offs</span>&nbsp;<span class="op" id="3370664">:=</span>&nbsp;<span class="ident" id="3370667">s</span><span class="op" id="3370668">.</span><span class="ident" id="3370669">offset</span>&nbsp;<span class="op" id="3370676">-</span>&nbsp;<span class="num" id="3370678">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370682">valid</span>&nbsp;<span class="op" id="3370688">:=</span>&nbsp;<span class="builtintype" id="3370691">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370697">n</span>&nbsp;<span class="op" id="3370699">:=</span>&nbsp;<span class="num" id="3370702">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370705">for</span>&nbsp;<span class="op" id="3370709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370713">ch</span>&nbsp;<span class="op" id="3370716">:=</span>&nbsp;<span class="ident" id="3370719">s</span><span class="op" id="3370720">.</span><span class="ident" id="3370721">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370726">if</span>&nbsp;<span class="ident" id="3370729">ch</span>&nbsp;<span class="op" id="3370732">==</span>&nbsp;<span class="string" id="3370735">&#39;\n&#39;</span>&nbsp;<span class="op" id="3370740">||</span>&nbsp;<span class="ident" id="3370743">ch</span>&nbsp;<span class="op" id="3370746">&lt;</span>&nbsp;<span class="num" id="3370748">0</span>&nbsp;<span class="op" id="3370750">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3370755">//&nbsp;only&nbsp;report&nbsp;error&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;one&nbsp;already</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370808">if</span>&nbsp;<span class="ident" id="3370811">valid</span>&nbsp;<span class="op" id="3370817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370823">s</span><span class="op" id="3370824">.</span><span class="builtintype" id="3370825">error</span><span class="op" id="3370830">(</span><span class="ident" id="3370831">offs</span><span class="op" id="3370835">,</span>&nbsp;<span class="string" id="3370837">&#34;rune&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3370866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370872">valid</span>&nbsp;<span class="op" id="3370878">=</span>&nbsp;<span class="builtintype" id="3370880">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370889">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370894">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370906">s</span><span class="op" id="3370907">.</span><span class="ident" id="3370908">next</span><span class="op" id="3370912">(</span><span class="op" id="3370913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370917">if</span>&nbsp;<span class="ident" id="3370920">ch</span>&nbsp;<span class="op" id="3370923">==</span>&nbsp;<span class="string" id="3370926">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3370931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370936">break</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3370944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3370948">n</span><span class="op" id="3370949">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370954">if</span>&nbsp;<span class="ident" id="3370957">ch</span>&nbsp;<span class="op" id="3370960">==</span>&nbsp;<span class="string" id="3370963">&#39;\\&#39;</span>&nbsp;<span class="op" id="3370968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3370973">if</span>&nbsp;<span class="op" id="3370976">!</span><span class="ident" id="3370977">s</span><span class="op" id="3370978">.</span><span class="ident" id="3370979">scanEscape</span><span class="op" id="3370989">(</span><span class="string" id="3370990">&#39;\&#39;&#39;</span><span class="op" id="3370994">)</span>&nbsp;<span class="op" id="3370996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371002">valid</span>&nbsp;<span class="op" id="3371008">=</span>&nbsp;<span class="builtintype" id="3371010">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3371024">//&nbsp;continue&nbsp;to&nbsp;read&nbsp;to&nbsp;closing&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371070">if</span>&nbsp;<span class="ident" id="3371073">valid</span>&nbsp;<span class="op" id="3371079">&amp;&amp;</span>&nbsp;<span class="ident" id="3371082">n</span>&nbsp;<span class="op" id="3371084">!=</span>&nbsp;<span class="num" id="3371087">1</span>&nbsp;<span class="op" id="3371089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371093">s</span><span class="op" id="3371094">.</span><span class="builtintype" id="3371095">error</span><span class="op" id="3371100">(</span><span class="ident" id="3371101">offs</span><span class="op" id="3371105">,</span>&nbsp;<span class="string" id="3371107">&#34;illegal&nbsp;rune&nbsp;literal&#34;</span><span class="op" id="3371129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371136">return</span>&nbsp;<span class="builtintype" id="3371143">string</span><span class="op" id="3371149">(</span><span class="ident" id="3371150">s</span><span class="op" id="3371151">.</span><span class="ident" id="3371152">src</span><span class="op" id="3371155">[</span><span class="ident" id="3371156">offs</span><span class="op" id="3371160">:</span><span class="ident" id="3371161">s</span><span class="op" id="3371162">.</span><span class="ident" id="3371163">offset</span><span class="op" id="3371169">]</span><span class="op" id="3371170">)</span><br>
<span class="lineno">455</span><span class="op" id="3371172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3371175">func</span>&nbsp;<span class="op" id="3371180">(</span><span class="ident" id="3371181">s</span>&nbsp;<span class="op" id="3371183">*</span><span class="ident" id="3371184">Scanner</span><span class="op" id="3371191">)</span>&nbsp;<span class="ident" id="3371193">scanString</span><span class="op" id="3371203">(</span><span class="op" id="3371204">)</span>&nbsp;<span class="builtintype" id="3371206">string</span>&nbsp;<span class="op" id="3371213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3371216">//&nbsp;&#39;&#34;&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371249">offs</span>&nbsp;<span class="op" id="3371254">:=</span>&nbsp;<span class="ident" id="3371257">s</span><span class="op" id="3371258">.</span><span class="ident" id="3371259">offset</span>&nbsp;<span class="op" id="3371266">-</span>&nbsp;<span class="num" id="3371268">1</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371272">for</span>&nbsp;<span class="op" id="3371276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371280">ch</span>&nbsp;<span class="op" id="3371283">:=</span>&nbsp;<span class="ident" id="3371286">s</span><span class="op" id="3371287">.</span><span class="ident" id="3371288">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371293">if</span>&nbsp;<span class="ident" id="3371296">ch</span>&nbsp;<span class="op" id="3371299">==</span>&nbsp;<span class="string" id="3371302">&#39;\n&#39;</span>&nbsp;<span class="op" id="3371307">||</span>&nbsp;<span class="ident" id="3371310">ch</span>&nbsp;<span class="op" id="3371313">&lt;</span>&nbsp;<span class="num" id="3371315">0</span>&nbsp;<span class="op" id="3371317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371322">s</span><span class="op" id="3371323">.</span><span class="builtintype" id="3371324">error</span><span class="op" id="3371329">(</span><span class="ident" id="3371330">offs</span><span class="op" id="3371334">,</span>&nbsp;<span class="string" id="3371336">&#34;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3371367">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371372">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371384">s</span><span class="op" id="3371385">.</span><span class="ident" id="3371386">next</span><span class="op" id="3371390">(</span><span class="op" id="3371391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371395">if</span>&nbsp;<span class="ident" id="3371398">ch</span>&nbsp;<span class="op" id="3371401">==</span>&nbsp;<span class="string" id="3371404">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3371408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371413">break</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371425">if</span>&nbsp;<span class="ident" id="3371428">ch</span>&nbsp;<span class="op" id="3371431">==</span>&nbsp;<span class="string" id="3371434">&#39;\\&#39;</span>&nbsp;<span class="op" id="3371439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371444">s</span><span class="op" id="3371445">.</span><span class="ident" id="3371446">scanEscape</span><span class="op" id="3371456">(</span><span class="string" id="3371457">&#39;&#34;&#39;</span><span class="op" id="3371460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371467">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371471">return</span>&nbsp;<span class="builtintype" id="3371478">string</span><span class="op" id="3371484">(</span><span class="ident" id="3371485">s</span><span class="op" id="3371486">.</span><span class="ident" id="3371487">src</span><span class="op" id="3371490">[</span><span class="ident" id="3371491">offs</span><span class="op" id="3371495">:</span><span class="ident" id="3371496">s</span><span class="op" id="3371497">.</span><span class="ident" id="3371498">offset</span><span class="op" id="3371504">]</span><span class="op" id="3371505">)</span><br>
<span class="lineno"></span><span class="op" id="3371507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3371510">func</span>&nbsp;<span class="ident" id="3371515">stripCR</span><span class="op" id="3371522">(</span><span class="ident" id="3371523">b</span>&nbsp;<span class="op" id="3371525">[</span><span class="op" id="3371526">]</span><span class="builtintype" id="3371527">byte</span><span class="op" id="3371531">)</span>&nbsp;<span class="op" id="3371533">[</span><span class="op" id="3371534">]</span><span class="builtintype" id="3371535">byte</span>&nbsp;<span class="op" id="3371540">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371543">c</span>&nbsp;<span class="op" id="3371545">:=</span>&nbsp;<span class="builtinfunc" id="3371548">make</span><span class="op" id="3371552">(</span><span class="op" id="3371553">[</span><span class="op" id="3371554">]</span><span class="builtintype" id="3371555">byte</span><span class="op" id="3371559">,</span>&nbsp;<span class="builtinfunc" id="3371561">len</span><span class="op" id="3371564">(</span><span class="ident" id="3371565">b</span><span class="op" id="3371566">)</span><span class="op" id="3371567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371570">i</span>&nbsp;<span class="op" id="3371572">:=</span>&nbsp;<span class="num" id="3371575">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371578">for</span>&nbsp;<span class="ident" id="3371582">_</span><span class="op" id="3371583">,</span>&nbsp;<span class="ident" id="3371585">ch</span>&nbsp;<span class="op" id="3371588">:=</span>&nbsp;<span class="keyword" id="3371591">range</span>&nbsp;<span class="ident" id="3371597">b</span>&nbsp;<span class="op" id="3371599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371603">if</span>&nbsp;<span class="ident" id="3371606">ch</span>&nbsp;<span class="op" id="3371609">!=</span>&nbsp;<span class="string" id="3371612">&#39;\r&#39;</span>&nbsp;<span class="op" id="3371617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371622">c</span><span class="op" id="3371623">[</span><span class="ident" id="3371624">i</span><span class="op" id="3371625">]</span>&nbsp;<span class="op" id="3371627">=</span>&nbsp;<span class="ident" id="3371629">ch</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371635">i</span><span class="op" id="3371636">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371647">return</span>&nbsp;<span class="ident" id="3371654">c</span><span class="op" id="3371655">[</span><span class="op" id="3371656">:</span><span class="ident" id="3371657">i</span><span class="op" id="3371658">]</span><br>
<span class="lineno"></span><span class="op" id="3371660">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span><span class="keyword" id="3371663">func</span>&nbsp;<span class="op" id="3371668">(</span><span class="ident" id="3371669">s</span>&nbsp;<span class="op" id="3371671">*</span><span class="ident" id="3371672">Scanner</span><span class="op" id="3371679">)</span>&nbsp;<span class="ident" id="3371681">scanRawString</span><span class="op" id="3371694">(</span><span class="op" id="3371695">)</span>&nbsp;<span class="builtintype" id="3371697">string</span>&nbsp;<span class="op" id="3371704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3371707">//&nbsp;&#39;`&#39;&nbsp;opening&nbsp;already&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371740">offs</span>&nbsp;<span class="op" id="3371745">:=</span>&nbsp;<span class="ident" id="3371748">s</span><span class="op" id="3371749">.</span><span class="ident" id="3371750">offset</span>&nbsp;<span class="op" id="3371757">-</span>&nbsp;<span class="num" id="3371759">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371763">hasCR</span>&nbsp;<span class="op" id="3371769">:=</span>&nbsp;<span class="builtintype" id="3371772">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371779">for</span>&nbsp;<span class="op" id="3371783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371787">ch</span>&nbsp;<span class="op" id="3371790">:=</span>&nbsp;<span class="ident" id="3371793">s</span><span class="op" id="3371794">.</span><span class="ident" id="3371795">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371800">if</span>&nbsp;<span class="ident" id="3371803">ch</span>&nbsp;<span class="op" id="3371806">&lt;</span>&nbsp;<span class="num" id="3371808">0</span>&nbsp;<span class="op" id="3371810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371815">s</span><span class="op" id="3371816">.</span><span class="builtintype" id="3371817">error</span><span class="op" id="3371822">(</span><span class="ident" id="3371823">offs</span><span class="op" id="3371827">,</span>&nbsp;<span class="string" id="3371829">&#34;raw&nbsp;string&nbsp;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="3371864">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371869">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371881">s</span><span class="op" id="3371882">.</span><span class="ident" id="3371883">next</span><span class="op" id="3371887">(</span><span class="op" id="3371888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371892">if</span>&nbsp;<span class="ident" id="3371895">ch</span>&nbsp;<span class="op" id="3371898">==</span>&nbsp;<span class="string" id="3371901">&#39;`&#39;</span>&nbsp;<span class="op" id="3371905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371910">break</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371922">if</span>&nbsp;<span class="ident" id="3371925">ch</span>&nbsp;<span class="op" id="3371928">==</span>&nbsp;<span class="string" id="3371931">&#39;\r&#39;</span>&nbsp;<span class="op" id="3371936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371941">hasCR</span>&nbsp;<span class="op" id="3371947">=</span>&nbsp;<span class="builtintype" id="3371949">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3371959">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3371963">lit</span>&nbsp;<span class="op" id="3371967">:=</span>&nbsp;<span class="ident" id="3371970">s</span><span class="op" id="3371971">.</span><span class="ident" id="3371972">src</span><span class="op" id="3371975">[</span><span class="ident" id="3371976">offs</span><span class="op" id="3371980">:</span><span class="ident" id="3371981">s</span><span class="op" id="3371982">.</span><span class="ident" id="3371983">offset</span><span class="op" id="3371989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3371992">if</span>&nbsp;<span class="ident" id="3371995">hasCR</span>&nbsp;<span class="op" id="3372001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372005">lit</span>&nbsp;<span class="op" id="3372009">=</span>&nbsp;<span class="ident" id="3372011">stripCR</span><span class="op" id="3372018">(</span><span class="ident" id="3372019">lit</span><span class="op" id="3372022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372025">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372029">return</span>&nbsp;<span class="builtintype" id="3372036">string</span><span class="op" id="3372042">(</span><span class="ident" id="3372043">lit</span><span class="op" id="3372046">)</span><br>
<span class="lineno"></span><span class="op" id="3372048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3372051">func</span>&nbsp;<span class="op" id="3372056">(</span><span class="ident" id="3372057">s</span>&nbsp;<span class="op" id="3372059">*</span><span class="ident" id="3372060">Scanner</span><span class="op" id="3372067">)</span>&nbsp;<span class="ident" id="3372069">skipWhitespace</span><span class="op" id="3372083">(</span><span class="op" id="3372084">)</span>&nbsp;<span class="op" id="3372086">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372089">for</span>&nbsp;<span class="ident" id="3372093">s</span><span class="op" id="3372094">.</span><span class="ident" id="3372095">ch</span>&nbsp;<span class="op" id="3372098">==</span>&nbsp;<span class="string" id="3372101">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3372105">||</span>&nbsp;<span class="ident" id="3372108">s</span><span class="op" id="3372109">.</span><span class="ident" id="3372110">ch</span>&nbsp;<span class="op" id="3372113">==</span>&nbsp;<span class="string" id="3372116">&#39;\t&#39;</span>&nbsp;<span class="op" id="3372121">||</span>&nbsp;<span class="ident" id="3372124">s</span><span class="op" id="3372125">.</span><span class="ident" id="3372126">ch</span>&nbsp;<span class="op" id="3372129">==</span>&nbsp;<span class="string" id="3372132">&#39;\n&#39;</span>&nbsp;<span class="op" id="3372137">&amp;&amp;</span>&nbsp;<span class="op" id="3372140">!</span><span class="ident" id="3372141">s</span><span class="op" id="3372142">.</span><span class="ident" id="3372143">insertSemi</span>&nbsp;<span class="op" id="3372154">||</span>&nbsp;<span class="ident" id="3372157">s</span><span class="op" id="3372158">.</span><span class="ident" id="3372159">ch</span>&nbsp;<span class="op" id="3372162">==</span>&nbsp;<span class="string" id="3372165">&#39;\r&#39;</span>&nbsp;<span class="op" id="3372170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372174">s</span><span class="op" id="3372175">.</span><span class="ident" id="3372176">next</span><span class="op" id="3372180">(</span><span class="op" id="3372181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372184">}</span><br>
<span class="lineno"></span><span class="op" id="3372186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3372189">//&nbsp;Helper&nbsp;functions&nbsp;for&nbsp;scanning&nbsp;multi-byte&nbsp;tokens&nbsp;such&nbsp;as&nbsp;&gt;&gt;&nbsp;+=&nbsp;&gt;&gt;=&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="3372260">//&nbsp;Different&nbsp;routines&nbsp;recognize&nbsp;different&nbsp;length&nbsp;tok_i&nbsp;based&nbsp;on&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="3372332">//&nbsp;of&nbsp;ch_i.&nbsp;If&nbsp;a&nbsp;token&nbsp;ends&nbsp;in&nbsp;&#39;=&#39;,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok1&nbsp;or&nbsp;tok3</span><br>
<span class="lineno"></span><span class="comment" id="3372395">//&nbsp;respectively.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;tok0&nbsp;if&nbsp;there&nbsp;was&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="3372464">//&nbsp;matching&nbsp;character,&nbsp;or&nbsp;tok2&nbsp;if&nbsp;the&nbsp;matching&nbsp;character&nbsp;was&nbsp;ch2.</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="3372531">func</span>&nbsp;<span class="op" id="3372536">(</span><span class="ident" id="3372537">s</span>&nbsp;<span class="op" id="3372539">*</span><span class="ident" id="3372540">Scanner</span><span class="op" id="3372547">)</span>&nbsp;<span class="ident" id="3372549">switch2</span><span class="op" id="3372556">(</span><span class="ident" id="3372557">tok0</span><span class="op" id="3372561">,</span>&nbsp;<span class="ident" id="3372563">tok1</span>&nbsp;<span class="ident" id="3372568">token</span><span class="op" id="3372573">.</span><span class="ident" id="3372574">Token</span><span class="op" id="3372579">)</span>&nbsp;<span class="ident" id="3372581">token</span><span class="op" id="3372586">.</span><span class="ident" id="3372587">Token</span>&nbsp;<span class="op" id="3372593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372596">if</span>&nbsp;<span class="ident" id="3372599">s</span><span class="op" id="3372600">.</span><span class="ident" id="3372601">ch</span>&nbsp;<span class="op" id="3372604">==</span>&nbsp;<span class="string" id="3372607">&#39;=&#39;</span>&nbsp;<span class="op" id="3372611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372615">s</span><span class="op" id="3372616">.</span><span class="ident" id="3372617">next</span><span class="op" id="3372621">(</span><span class="op" id="3372622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372626">return</span>&nbsp;<span class="ident" id="3372633">tok1</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372642">return</span>&nbsp;<span class="ident" id="3372649">tok0</span><br>
<span class="lineno"></span><span class="op" id="3372654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3372657">func</span>&nbsp;<span class="op" id="3372662">(</span><span class="ident" id="3372663">s</span>&nbsp;<span class="op" id="3372665">*</span><span class="ident" id="3372666">Scanner</span><span class="op" id="3372673">)</span>&nbsp;<span class="ident" id="3372675">switch3</span><span class="op" id="3372682">(</span><span class="ident" id="3372683">tok0</span><span class="op" id="3372687">,</span>&nbsp;<span class="ident" id="3372689">tok1</span>&nbsp;<span class="ident" id="3372694">token</span><span class="op" id="3372699">.</span><span class="ident" id="3372700">Token</span><span class="op" id="3372705">,</span>&nbsp;<span class="ident" id="3372707">ch2</span>&nbsp;<span class="builtintype" id="3372711">rune</span><span class="op" id="3372715">,</span>&nbsp;<span class="ident" id="3372717">tok2</span>&nbsp;<span class="ident" id="3372722">token</span><span class="op" id="3372727">.</span><span class="ident" id="3372728">Token</span><span class="op" id="3372733">)</span>&nbsp;<span class="ident" id="3372735">token</span><span class="op" id="3372740">.</span><span class="ident" id="3372741">Token</span>&nbsp;<span class="op" id="3372747">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372750">if</span>&nbsp;<span class="ident" id="3372753">s</span><span class="op" id="3372754">.</span><span class="ident" id="3372755">ch</span>&nbsp;<span class="op" id="3372758">==</span>&nbsp;<span class="string" id="3372761">&#39;=&#39;</span>&nbsp;<span class="op" id="3372765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372769">s</span><span class="op" id="3372770">.</span><span class="ident" id="3372771">next</span><span class="op" id="3372775">(</span><span class="op" id="3372776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372780">return</span>&nbsp;<span class="ident" id="3372787">tok1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372796">if</span>&nbsp;<span class="ident" id="3372799">s</span><span class="op" id="3372800">.</span><span class="ident" id="3372801">ch</span>&nbsp;<span class="op" id="3372804">==</span>&nbsp;<span class="ident" id="3372807">ch2</span>&nbsp;<span class="op" id="3372811">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372815">s</span><span class="op" id="3372816">.</span><span class="ident" id="3372817">next</span><span class="op" id="3372821">(</span><span class="op" id="3372822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372826">return</span>&nbsp;<span class="ident" id="3372833">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372842">return</span>&nbsp;<span class="ident" id="3372849">tok0</span><br>
<span class="lineno"></span><span class="op" id="3372854">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="3372857">func</span>&nbsp;<span class="op" id="3372862">(</span><span class="ident" id="3372863">s</span>&nbsp;<span class="op" id="3372865">*</span><span class="ident" id="3372866">Scanner</span><span class="op" id="3372873">)</span>&nbsp;<span class="ident" id="3372875">switch4</span><span class="op" id="3372882">(</span><span class="ident" id="3372883">tok0</span><span class="op" id="3372887">,</span>&nbsp;<span class="ident" id="3372889">tok1</span>&nbsp;<span class="ident" id="3372894">token</span><span class="op" id="3372899">.</span><span class="ident" id="3372900">Token</span><span class="op" id="3372905">,</span>&nbsp;<span class="ident" id="3372907">ch2</span>&nbsp;<span class="builtintype" id="3372911">rune</span><span class="op" id="3372915">,</span>&nbsp;<span class="ident" id="3372917">tok2</span><span class="op" id="3372921">,</span>&nbsp;<span class="ident" id="3372923">tok3</span>&nbsp;<span class="ident" id="3372928">token</span><span class="op" id="3372933">.</span><span class="ident" id="3372934">Token</span><span class="op" id="3372939">)</span>&nbsp;<span class="ident" id="3372941">token</span><span class="op" id="3372946">.</span><span class="ident" id="3372947">Token</span>&nbsp;<span class="op" id="3372953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372956">if</span>&nbsp;<span class="ident" id="3372959">s</span><span class="op" id="3372960">.</span><span class="ident" id="3372961">ch</span>&nbsp;<span class="op" id="3372964">==</span>&nbsp;<span class="string" id="3372967">&#39;=&#39;</span>&nbsp;<span class="op" id="3372971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3372975">s</span><span class="op" id="3372976">.</span><span class="ident" id="3372977">next</span><span class="op" id="3372981">(</span><span class="op" id="3372982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3372986">return</span>&nbsp;<span class="ident" id="3372993">tok1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3372999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373002">if</span>&nbsp;<span class="ident" id="3373005">s</span><span class="op" id="3373006">.</span><span class="ident" id="3373007">ch</span>&nbsp;<span class="op" id="3373010">==</span>&nbsp;<span class="ident" id="3373013">ch2</span>&nbsp;<span class="op" id="3373017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373021">s</span><span class="op" id="3373022">.</span><span class="ident" id="3373023">next</span><span class="op" id="3373027">(</span><span class="op" id="3373028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373032">if</span>&nbsp;<span class="ident" id="3373035">s</span><span class="op" id="3373036">.</span><span class="ident" id="3373037">ch</span>&nbsp;<span class="op" id="3373040">==</span>&nbsp;<span class="string" id="3373043">&#39;=&#39;</span>&nbsp;<span class="op" id="3373047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3373052">s</span><span class="op" id="3373053">.</span><span class="ident" id="3373054">next</span><span class="op" id="3373058">(</span><span class="op" id="3373059">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373064">return</span>&nbsp;<span class="ident" id="3373071">tok3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373082">return</span>&nbsp;<span class="ident" id="3373089">tok2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3373095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3373098">return</span>&nbsp;<span class="ident" id="3373105">tok0</span><br>
<span class="lineno">565</span><span class="op" id="3373110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3373113">//&nbsp;Scan&nbsp;scans&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;returns&nbsp;the&nbsp;token&nbsp;position,&nbsp;the&nbsp;token,</span><br>
<span class="lineno"></span><span class="comment" id="3373185">//&nbsp;and&nbsp;its&nbsp;literal&nbsp;string&nbsp;if&nbsp;applicable.&nbsp;The&nbsp;source&nbsp;end&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3373257">//&nbsp;token.EOF.</span><br>
<span class="lineno">570</span><span class="comment" id="3373271">//</span><br>
<span class="lineno"></span><span class="comment" id="3373274">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;literal&nbsp;(token.IDENT,&nbsp;token.INT,&nbsp;token.FLOAT,</span><br>
<span class="lineno"></span><span class="comment" id="3373350">//&nbsp;token.IMAG,&nbsp;token.CHAR,&nbsp;token.STRING)&nbsp;or&nbsp;token.COMMENT,&nbsp;the&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="3373428">//&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3373460">//</span><br>
<span class="lineno">575</span><span class="comment" id="3373463">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;a&nbsp;keyword,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the&nbsp;keyword.</span><br>
<span class="lineno"></span><span class="comment" id="3373537">//</span><br>
<span class="lineno"></span><span class="comment" id="3373540">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.SEMICOLON,&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3373603">//&nbsp;literal&nbsp;string&nbsp;is&nbsp;&#34;;&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;present&nbsp;in&nbsp;the&nbsp;source,</span><br>
<span class="lineno"></span><span class="comment" id="3373672">//&nbsp;and&nbsp;&#34;\n&#34;&nbsp;if&nbsp;the&nbsp;semicolon&nbsp;was&nbsp;inserted&nbsp;because&nbsp;of&nbsp;a&nbsp;newline&nbsp;or</span><br>
<span class="lineno">580</span><span class="comment" id="3373738">//&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="3373749">//</span><br>
<span class="lineno"></span><span class="comment" id="3373752">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;token&nbsp;is&nbsp;token.ILLEGAL,&nbsp;the&nbsp;literal&nbsp;string&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3373821">//&nbsp;offending&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3373845">//</span><br>
<span class="lineno">585</span><span class="comment" id="3373848">//&nbsp;In&nbsp;all&nbsp;other&nbsp;cases,&nbsp;Scan&nbsp;returns&nbsp;an&nbsp;empty&nbsp;literal&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3373909">//</span><br>
<span class="lineno"></span><span class="comment" id="3373912">//&nbsp;For&nbsp;more&nbsp;tolerant&nbsp;parsing,&nbsp;Scan&nbsp;will&nbsp;return&nbsp;a&nbsp;valid&nbsp;token&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3373976">//&nbsp;possible&nbsp;even&nbsp;if&nbsp;a&nbsp;syntax&nbsp;error&nbsp;was&nbsp;encountered.&nbsp;Thus,&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="3374039">//&nbsp;if&nbsp;the&nbsp;resulting&nbsp;token&nbsp;sequence&nbsp;contains&nbsp;no&nbsp;illegal&nbsp;tokens,</span><br>
<span class="lineno">590</span><span class="comment" id="3374102">//&nbsp;a&nbsp;client&nbsp;may&nbsp;not&nbsp;assume&nbsp;that&nbsp;no&nbsp;error&nbsp;occurred.&nbsp;Instead&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3374164">//&nbsp;must&nbsp;check&nbsp;the&nbsp;scanner&#39;s&nbsp;ErrorCount&nbsp;or&nbsp;the&nbsp;number&nbsp;of&nbsp;calls</span><br>
<span class="lineno"></span><span class="comment" id="3374226">//&nbsp;of&nbsp;the&nbsp;error&nbsp;handler,&nbsp;if&nbsp;there&nbsp;was&nbsp;one&nbsp;installed.</span><br>
<span class="lineno"></span><span class="comment" id="3374279">//</span><br>
<span class="lineno"></span><span class="comment" id="3374282">//&nbsp;Scan&nbsp;adds&nbsp;line&nbsp;information&nbsp;to&nbsp;the&nbsp;file&nbsp;added&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno">595</span><span class="comment" id="3374342">//&nbsp;set&nbsp;with&nbsp;Init.&nbsp;Token&nbsp;positions&nbsp;are&nbsp;relative&nbsp;to&nbsp;that&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="3374402">//&nbsp;and&nbsp;thus&nbsp;relative&nbsp;to&nbsp;the&nbsp;file&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="3374440">//</span><br>
<span class="lineno"></span><span class="keyword" id="3374443">func</span>&nbsp;<span class="op" id="3374448">(</span><span class="ident" id="3374449">s</span>&nbsp;<span class="op" id="3374451">*</span><span class="ident" id="3374452">Scanner</span><span class="op" id="3374459">)</span>&nbsp;<span class="ident" id="3374461">Scan</span><span class="op" id="3374465">(</span><span class="op" id="3374466">)</span>&nbsp;<span class="op" id="3374468">(</span><span class="ident" id="3374469">pos</span>&nbsp;<span class="ident" id="3374473">token</span><span class="op" id="3374478">.</span><span class="ident" id="3374479">Pos</span><span class="op" id="3374482">,</span>&nbsp;<span class="ident" id="3374484">tok</span>&nbsp;<span class="ident" id="3374488">token</span><span class="op" id="3374493">.</span><span class="ident" id="3374494">Token</span><span class="op" id="3374499">,</span>&nbsp;<span class="ident" id="3374501">lit</span>&nbsp;<span class="builtintype" id="3374505">string</span><span class="op" id="3374511">)</span>&nbsp;<span class="op" id="3374513">{</span><br>
<span class="lineno"></span><span class="ident" id="3374515">scanAgain</span><span class="op" id="3374524">:</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374527">s</span><span class="op" id="3374528">.</span><span class="ident" id="3374529">skipWhitespace</span><span class="op" id="3374543">(</span><span class="op" id="3374544">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3374548">//&nbsp;current&nbsp;token&nbsp;start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374572">pos</span>&nbsp;<span class="op" id="3374576">=</span>&nbsp;<span class="ident" id="3374578">s</span><span class="op" id="3374579">.</span><span class="ident" id="3374580">file</span><span class="op" id="3374584">.</span><span class="ident" id="3374585">Pos</span><span class="op" id="3374588">(</span><span class="ident" id="3374589">s</span><span class="op" id="3374590">.</span><span class="ident" id="3374591">offset</span><span class="op" id="3374597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3374601">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374627">insertSemi</span>&nbsp;<span class="op" id="3374638">:=</span>&nbsp;<span class="builtintype" id="3374641">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374648">switch</span>&nbsp;<span class="ident" id="3374655">ch</span>&nbsp;<span class="op" id="3374658">:=</span>&nbsp;<span class="ident" id="3374661">s</span><span class="op" id="3374662">.</span><span class="ident" id="3374663">ch</span><span class="op" id="3374665">;</span>&nbsp;<span class="op" id="3374667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374670">case</span>&nbsp;<span class="ident" id="3374675">isLetter</span><span class="op" id="3374683">(</span><span class="ident" id="3374684">ch</span><span class="op" id="3374686">)</span><span class="op" id="3374687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374691">lit</span>&nbsp;<span class="op" id="3374695">=</span>&nbsp;<span class="ident" id="3374697">s</span><span class="op" id="3374698">.</span><span class="ident" id="3374699">scanIdentifier</span><span class="op" id="3374713">(</span><span class="op" id="3374714">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374718">if</span>&nbsp;<span class="builtinfunc" id="3374721">len</span><span class="op" id="3374724">(</span><span class="ident" id="3374725">lit</span><span class="op" id="3374728">)</span>&nbsp;<span class="op" id="3374730">&gt;</span>&nbsp;<span class="num" id="3374732">1</span>&nbsp;<span class="op" id="3374734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3374739">//&nbsp;keywords&nbsp;are&nbsp;longer&nbsp;than&nbsp;one&nbsp;letter&nbsp;-&nbsp;avoid&nbsp;lookup&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374806">tok</span>&nbsp;<span class="op" id="3374810">=</span>&nbsp;<span class="ident" id="3374812">token</span><span class="op" id="3374817">.</span><span class="ident" id="3374818">Lookup</span><span class="op" id="3374824">(</span><span class="ident" id="3374825">lit</span><span class="op" id="3374828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374833">switch</span>&nbsp;<span class="ident" id="3374840">tok</span>&nbsp;<span class="op" id="3374844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3374849">case</span>&nbsp;<span class="ident" id="3374854">token</span><span class="op" id="3374859">.</span><span class="ident" id="3374860">IDENT</span><span class="op" id="3374865">,</span>&nbsp;<span class="ident" id="3374867">token</span><span class="op" id="3374872">.</span><span class="ident" id="3374873">BREAK</span><span class="op" id="3374878">,</span>&nbsp;<span class="ident" id="3374880">token</span><span class="op" id="3374885">.</span><span class="ident" id="3374886">CONTINUE</span><span class="op" id="3374894">,</span>&nbsp;<span class="ident" id="3374896">token</span><span class="op" id="3374901">.</span><span class="ident" id="3374902">FALLTHROUGH</span><span class="op" id="3374913">,</span>&nbsp;<span class="ident" id="3374915">token</span><span class="op" id="3374920">.</span><span class="ident" id="3374921">RETURN</span><span class="op" id="3374927">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374933">insertSemi</span>&nbsp;<span class="op" id="3374944">=</span>&nbsp;<span class="builtintype" id="3374946">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3374958">}</span>&nbsp;<span class="keyword" id="3374960">else</span>&nbsp;<span class="op" id="3374965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374970">insertSemi</span>&nbsp;<span class="op" id="3374981">=</span>&nbsp;<span class="builtintype" id="3374983">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3374991">tok</span>&nbsp;<span class="op" id="3374995">=</span>&nbsp;<span class="ident" id="3374997">token</span><span class="op" id="3375002">.</span><span class="ident" id="3375003">IDENT</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375014">case</span>&nbsp;<span class="string" id="3375019">&#39;0&#39;</span>&nbsp;<span class="op" id="3375023">&lt;=</span>&nbsp;<span class="ident" id="3375026">ch</span>&nbsp;<span class="op" id="3375029">&amp;&amp;</span>&nbsp;<span class="ident" id="3375032">ch</span>&nbsp;<span class="op" id="3375035">&lt;=</span>&nbsp;<span class="string" id="3375038">&#39;9&#39;</span><span class="op" id="3375041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375045">insertSemi</span>&nbsp;<span class="op" id="3375056">=</span>&nbsp;<span class="builtintype" id="3375058">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375065">tok</span><span class="op" id="3375068">,</span>&nbsp;<span class="ident" id="3375070">lit</span>&nbsp;<span class="op" id="3375074">=</span>&nbsp;<span class="ident" id="3375076">s</span><span class="op" id="3375077">.</span><span class="ident" id="3375078">scanNumber</span><span class="op" id="3375088">(</span><span class="builtintype" id="3375089">false</span><span class="op" id="3375094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375097">default</span><span class="op" id="3375104">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375108">s</span><span class="op" id="3375109">.</span><span class="ident" id="3375110">next</span><span class="op" id="3375114">(</span><span class="op" id="3375115">)</span>&nbsp;<span class="comment" id="3375117">//&nbsp;always&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375143">switch</span>&nbsp;<span class="ident" id="3375150">ch</span>&nbsp;<span class="op" id="3375153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375157">case</span>&nbsp;<span class="op" id="3375162">-</span><span class="num" id="3375163">1</span><span class="op" id="3375164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375169">if</span>&nbsp;<span class="ident" id="3375172">s</span><span class="op" id="3375173">.</span><span class="ident" id="3375174">insertSemi</span>&nbsp;<span class="op" id="3375185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375191">s</span><span class="op" id="3375192">.</span><span class="ident" id="3375193">insertSemi</span>&nbsp;<span class="op" id="3375204">=</span>&nbsp;<span class="builtintype" id="3375206">false</span>&nbsp;<span class="comment" id="3375212">//&nbsp;EOF&nbsp;consumed</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375232">return</span>&nbsp;<span class="ident" id="3375239">pos</span><span class="op" id="3375242">,</span>&nbsp;<span class="ident" id="3375244">token</span><span class="op" id="3375249">.</span><span class="ident" id="3375250">SEMICOLON</span><span class="op" id="3375259">,</span>&nbsp;<span class="string" id="3375261">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375274">tok</span>&nbsp;<span class="op" id="3375278">=</span>&nbsp;<span class="ident" id="3375280">token</span><span class="op" id="3375285">.</span><span class="ident" id="3375286">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375292">case</span>&nbsp;<span class="string" id="3375297">&#39;\n&#39;</span><span class="op" id="3375301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375306">//&nbsp;we&nbsp;only&nbsp;reach&nbsp;here&nbsp;if&nbsp;s.insertSemi&nbsp;was</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375351">//&nbsp;set&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;and&nbsp;exited&nbsp;early</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3375397">//&nbsp;from&nbsp;s.skipWhitespace()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375427">s</span><span class="op" id="3375428">.</span><span class="ident" id="3375429">insertSemi</span>&nbsp;<span class="op" id="3375440">=</span>&nbsp;<span class="builtintype" id="3375442">false</span>&nbsp;<span class="comment" id="3375448">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375471">return</span>&nbsp;<span class="ident" id="3375478">pos</span><span class="op" id="3375481">,</span>&nbsp;<span class="ident" id="3375483">token</span><span class="op" id="3375488">.</span><span class="ident" id="3375489">SEMICOLON</span><span class="op" id="3375498">,</span>&nbsp;<span class="string" id="3375500">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375507">case</span>&nbsp;<span class="string" id="3375512">&#39;&#34;&#39;</span><span class="op" id="3375515">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375520">insertSemi</span>&nbsp;<span class="op" id="3375531">=</span>&nbsp;<span class="builtintype" id="3375533">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375541">tok</span>&nbsp;<span class="op" id="3375545">=</span>&nbsp;<span class="ident" id="3375547">token</span><span class="op" id="3375552">.</span><span class="ident" id="3375553">STRING</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375563">lit</span>&nbsp;<span class="op" id="3375567">=</span>&nbsp;<span class="ident" id="3375569">s</span><span class="op" id="3375570">.</span><span class="ident" id="3375571">scanString</span><span class="op" id="3375581">(</span><span class="op" id="3375582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375586">case</span>&nbsp;<span class="string" id="3375591">&#39;\&#39;&#39;</span><span class="op" id="3375595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375600">insertSemi</span>&nbsp;<span class="op" id="3375611">=</span>&nbsp;<span class="builtintype" id="3375613">true</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375621">tok</span>&nbsp;<span class="op" id="3375625">=</span>&nbsp;<span class="ident" id="3375627">token</span><span class="op" id="3375632">.</span><span class="ident" id="3375633">CHAR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375641">lit</span>&nbsp;<span class="op" id="3375645">=</span>&nbsp;<span class="ident" id="3375647">s</span><span class="op" id="3375648">.</span><span class="ident" id="3375649">scanRune</span><span class="op" id="3375657">(</span><span class="op" id="3375658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375662">case</span>&nbsp;<span class="string" id="3375667">&#39;`&#39;</span><span class="op" id="3375670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375675">insertSemi</span>&nbsp;<span class="op" id="3375686">=</span>&nbsp;<span class="builtintype" id="3375688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375696">tok</span>&nbsp;<span class="op" id="3375700">=</span>&nbsp;<span class="ident" id="3375702">token</span><span class="op" id="3375707">.</span><span class="ident" id="3375708">STRING</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375718">lit</span>&nbsp;<span class="op" id="3375722">=</span>&nbsp;<span class="ident" id="3375724">s</span><span class="op" id="3375725">.</span><span class="ident" id="3375726">scanRawString</span><span class="op" id="3375739">(</span><span class="op" id="3375740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375744">case</span>&nbsp;<span class="string" id="3375749">&#39;:&#39;</span><span class="op" id="3375752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375757">tok</span>&nbsp;<span class="op" id="3375761">=</span>&nbsp;<span class="ident" id="3375763">s</span><span class="op" id="3375764">.</span><span class="ident" id="3375765">switch2</span><span class="op" id="3375772">(</span><span class="ident" id="3375773">token</span><span class="op" id="3375778">.</span><span class="ident" id="3375779">COLON</span><span class="op" id="3375784">,</span>&nbsp;<span class="ident" id="3375786">token</span><span class="op" id="3375791">.</span><span class="ident" id="3375792">DEFINE</span><span class="op" id="3375798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375802">case</span>&nbsp;<span class="string" id="3375807">&#39;.&#39;</span><span class="op" id="3375810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375815">if</span>&nbsp;<span class="string" id="3375818">&#39;0&#39;</span>&nbsp;<span class="op" id="3375822">&lt;=</span>&nbsp;<span class="ident" id="3375825">s</span><span class="op" id="3375826">.</span><span class="ident" id="3375827">ch</span>&nbsp;<span class="op" id="3375830">&amp;&amp;</span>&nbsp;<span class="ident" id="3375833">s</span><span class="op" id="3375834">.</span><span class="ident" id="3375835">ch</span>&nbsp;<span class="op" id="3375838">&lt;=</span>&nbsp;<span class="string" id="3375841">&#39;9&#39;</span>&nbsp;<span class="op" id="3375845">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375851">insertSemi</span>&nbsp;<span class="op" id="3375862">=</span>&nbsp;<span class="builtintype" id="3375864">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375873">tok</span><span class="op" id="3375876">,</span>&nbsp;<span class="ident" id="3375878">lit</span>&nbsp;<span class="op" id="3375882">=</span>&nbsp;<span class="ident" id="3375884">s</span><span class="op" id="3375885">.</span><span class="ident" id="3375886">scanNumber</span><span class="op" id="3375896">(</span><span class="builtintype" id="3375897">true</span><span class="op" id="3375901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3375906">}</span>&nbsp;<span class="keyword" id="3375908">else</span>&nbsp;<span class="keyword" id="3375913">if</span>&nbsp;<span class="ident" id="3375916">s</span><span class="op" id="3375917">.</span><span class="ident" id="3375918">ch</span>&nbsp;<span class="op" id="3375921">==</span>&nbsp;<span class="string" id="3375924">&#39;.&#39;</span>&nbsp;<span class="op" id="3375928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375934">s</span><span class="op" id="3375935">.</span><span class="ident" id="3375936">next</span><span class="op" id="3375940">(</span><span class="op" id="3375941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3375947">if</span>&nbsp;<span class="ident" id="3375950">s</span><span class="op" id="3375951">.</span><span class="ident" id="3375952">ch</span>&nbsp;<span class="op" id="3375955">==</span>&nbsp;<span class="string" id="3375958">&#39;.&#39;</span>&nbsp;<span class="op" id="3375962">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375969">s</span><span class="op" id="3375970">.</span><span class="ident" id="3375971">next</span><span class="op" id="3375975">(</span><span class="op" id="3375976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3375983">tok</span>&nbsp;<span class="op" id="3375987">=</span>&nbsp;<span class="ident" id="3375989">token</span><span class="op" id="3375994">.</span><span class="ident" id="3375995">ELLIPSIS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376013">}</span>&nbsp;<span class="keyword" id="3376015">else</span>&nbsp;<span class="op" id="3376020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376026">tok</span>&nbsp;<span class="op" id="3376030">=</span>&nbsp;<span class="ident" id="3376032">token</span><span class="op" id="3376037">.</span><span class="ident" id="3376038">PERIOD</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376052">case</span>&nbsp;<span class="string" id="3376057">&#39;,&#39;</span><span class="op" id="3376060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376065">tok</span>&nbsp;<span class="op" id="3376069">=</span>&nbsp;<span class="ident" id="3376071">token</span><span class="op" id="3376076">.</span><span class="ident" id="3376077">COMMA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376085">case</span>&nbsp;<span class="string" id="3376090">&#39;;&#39;</span><span class="op" id="3376093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376098">tok</span>&nbsp;<span class="op" id="3376102">=</span>&nbsp;<span class="ident" id="3376104">token</span><span class="op" id="3376109">.</span><span class="ident" id="3376110">SEMICOLON</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376123">lit</span>&nbsp;<span class="op" id="3376127">=</span>&nbsp;<span class="string" id="3376129">&#34;;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376135">case</span>&nbsp;<span class="string" id="3376140">&#39;(&#39;</span><span class="op" id="3376143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376148">tok</span>&nbsp;<span class="op" id="3376152">=</span>&nbsp;<span class="ident" id="3376154">token</span><span class="op" id="3376159">.</span><span class="ident" id="3376160">LPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376169">case</span>&nbsp;<span class="string" id="3376174">&#39;)&#39;</span><span class="op" id="3376177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376182">insertSemi</span>&nbsp;<span class="op" id="3376193">=</span>&nbsp;<span class="builtintype" id="3376195">true</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376203">tok</span>&nbsp;<span class="op" id="3376207">=</span>&nbsp;<span class="ident" id="3376209">token</span><span class="op" id="3376214">.</span><span class="ident" id="3376215">RPAREN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376224">case</span>&nbsp;<span class="string" id="3376229">&#39;[&#39;</span><span class="op" id="3376232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376237">tok</span>&nbsp;<span class="op" id="3376241">=</span>&nbsp;<span class="ident" id="3376243">token</span><span class="op" id="3376248">.</span><span class="ident" id="3376249">LBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376258">case</span>&nbsp;<span class="string" id="3376263">&#39;]&#39;</span><span class="op" id="3376266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376271">insertSemi</span>&nbsp;<span class="op" id="3376282">=</span>&nbsp;<span class="builtintype" id="3376284">true</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376292">tok</span>&nbsp;<span class="op" id="3376296">=</span>&nbsp;<span class="ident" id="3376298">token</span><span class="op" id="3376303">.</span><span class="ident" id="3376304">RBRACK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376313">case</span>&nbsp;<span class="string" id="3376318">&#39;{&#39;</span><span class="op" id="3376321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376326">tok</span>&nbsp;<span class="op" id="3376330">=</span>&nbsp;<span class="ident" id="3376332">token</span><span class="op" id="3376337">.</span><span class="ident" id="3376338">LBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376347">case</span>&nbsp;<span class="string" id="3376352">&#39;}&#39;</span><span class="op" id="3376355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376360">insertSemi</span>&nbsp;<span class="op" id="3376371">=</span>&nbsp;<span class="builtintype" id="3376373">true</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376381">tok</span>&nbsp;<span class="op" id="3376385">=</span>&nbsp;<span class="ident" id="3376387">token</span><span class="op" id="3376392">.</span><span class="ident" id="3376393">RBRACE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376402">case</span>&nbsp;<span class="string" id="3376407">&#39;+&#39;</span><span class="op" id="3376410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376415">tok</span>&nbsp;<span class="op" id="3376419">=</span>&nbsp;<span class="ident" id="3376421">s</span><span class="op" id="3376422">.</span><span class="ident" id="3376423">switch3</span><span class="op" id="3376430">(</span><span class="ident" id="3376431">token</span><span class="op" id="3376436">.</span><span class="ident" id="3376437">ADD</span><span class="op" id="3376440">,</span>&nbsp;<span class="ident" id="3376442">token</span><span class="op" id="3376447">.</span><span class="ident" id="3376448">ADD_ASSIGN</span><span class="op" id="3376458">,</span>&nbsp;<span class="string" id="3376460">&#39;+&#39;</span><span class="op" id="3376463">,</span>&nbsp;<span class="ident" id="3376465">token</span><span class="op" id="3376470">.</span><span class="ident" id="3376471">INC</span><span class="op" id="3376474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376479">if</span>&nbsp;<span class="ident" id="3376482">tok</span>&nbsp;<span class="op" id="3376486">==</span>&nbsp;<span class="ident" id="3376489">token</span><span class="op" id="3376494">.</span><span class="ident" id="3376495">INC</span>&nbsp;<span class="op" id="3376499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376505">insertSemi</span>&nbsp;<span class="op" id="3376516">=</span>&nbsp;<span class="builtintype" id="3376518">true</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376530">case</span>&nbsp;<span class="string" id="3376535">&#39;-&#39;</span><span class="op" id="3376538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376543">tok</span>&nbsp;<span class="op" id="3376547">=</span>&nbsp;<span class="ident" id="3376549">s</span><span class="op" id="3376550">.</span><span class="ident" id="3376551">switch3</span><span class="op" id="3376558">(</span><span class="ident" id="3376559">token</span><span class="op" id="3376564">.</span><span class="ident" id="3376565">SUB</span><span class="op" id="3376568">,</span>&nbsp;<span class="ident" id="3376570">token</span><span class="op" id="3376575">.</span><span class="ident" id="3376576">SUB_ASSIGN</span><span class="op" id="3376586">,</span>&nbsp;<span class="string" id="3376588">&#39;-&#39;</span><span class="op" id="3376591">,</span>&nbsp;<span class="ident" id="3376593">token</span><span class="op" id="3376598">.</span><span class="ident" id="3376599">DEC</span><span class="op" id="3376602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376607">if</span>&nbsp;<span class="ident" id="3376610">tok</span>&nbsp;<span class="op" id="3376614">==</span>&nbsp;<span class="ident" id="3376617">token</span><span class="op" id="3376622">.</span><span class="ident" id="3376623">DEC</span>&nbsp;<span class="op" id="3376627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376633">insertSemi</span>&nbsp;<span class="op" id="3376644">=</span>&nbsp;<span class="builtintype" id="3376646">true</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3376654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376658">case</span>&nbsp;<span class="string" id="3376663">&#39;*&#39;</span><span class="op" id="3376666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376671">tok</span>&nbsp;<span class="op" id="3376675">=</span>&nbsp;<span class="ident" id="3376677">s</span><span class="op" id="3376678">.</span><span class="ident" id="3376679">switch2</span><span class="op" id="3376686">(</span><span class="ident" id="3376687">token</span><span class="op" id="3376692">.</span><span class="ident" id="3376693">MUL</span><span class="op" id="3376696">,</span>&nbsp;<span class="ident" id="3376698">token</span><span class="op" id="3376703">.</span><span class="ident" id="3376704">MUL_ASSIGN</span><span class="op" id="3376714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376718">case</span>&nbsp;<span class="string" id="3376723">&#39;/&#39;</span><span class="op" id="3376726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376731">if</span>&nbsp;<span class="ident" id="3376734">s</span><span class="op" id="3376735">.</span><span class="ident" id="3376736">ch</span>&nbsp;<span class="op" id="3376739">==</span>&nbsp;<span class="string" id="3376742">&#39;/&#39;</span>&nbsp;<span class="op" id="3376746">||</span>&nbsp;<span class="ident" id="3376749">s</span><span class="op" id="3376750">.</span><span class="ident" id="3376751">ch</span>&nbsp;<span class="op" id="3376754">==</span>&nbsp;<span class="string" id="3376757">&#39;*&#39;</span>&nbsp;<span class="op" id="3376761">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376767">//&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3376782">if</span>&nbsp;<span class="ident" id="3376785">s</span><span class="op" id="3376786">.</span><span class="ident" id="3376787">insertSemi</span>&nbsp;<span class="op" id="3376798">&amp;&amp;</span>&nbsp;<span class="ident" id="3376801">s</span><span class="op" id="3376802">.</span><span class="ident" id="3376803">findLineEnd</span><span class="op" id="3376814">(</span><span class="op" id="3376815">)</span>&nbsp;<span class="op" id="3376817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3376824">//&nbsp;reset&nbsp;position&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376879">s</span><span class="op" id="3376880">.</span><span class="ident" id="3376881">ch</span>&nbsp;<span class="op" id="3376884">=</span>&nbsp;<span class="string" id="3376886">&#39;/&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376895">s</span><span class="op" id="3376896">.</span><span class="ident" id="3376897">offset</span>&nbsp;<span class="op" id="3376904">=</span>&nbsp;<span class="ident" id="3376906">s</span><span class="op" id="3376907">.</span><span class="ident" id="3376908">file</span><span class="op" id="3376912">.</span><span class="ident" id="3376913">Offset</span><span class="op" id="3376919">(</span><span class="ident" id="3376920">pos</span><span class="op" id="3376923">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376930">s</span><span class="op" id="3376931">.</span><span class="ident" id="3376932">rdOffset</span>&nbsp;<span class="op" id="3376941">=</span>&nbsp;<span class="ident" id="3376943">s</span><span class="op" id="3376944">.</span><span class="ident" id="3376945">offset</span>&nbsp;<span class="op" id="3376952">+</span>&nbsp;<span class="num" id="3376954">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3376961">s</span><span class="op" id="3376962">.</span><span class="ident" id="3376963">insertSemi</span>&nbsp;<span class="op" id="3376974">=</span>&nbsp;<span class="builtintype" id="3376976">false</span>&nbsp;<span class="comment" id="3376982">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377007">return</span>&nbsp;<span class="ident" id="3377014">pos</span><span class="op" id="3377017">,</span>&nbsp;<span class="ident" id="3377019">token</span><span class="op" id="3377024">.</span><span class="ident" id="3377025">SEMICOLON</span><span class="op" id="3377034">,</span>&nbsp;<span class="string" id="3377036">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377051">lit</span>&nbsp;<span class="op" id="3377055">=</span>&nbsp;<span class="ident" id="3377057">s</span><span class="op" id="3377058">.</span><span class="ident" id="3377059">scanComment</span><span class="op" id="3377070">(</span><span class="op" id="3377071">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377077">if</span>&nbsp;<span class="ident" id="3377080">s</span><span class="op" id="3377081">.</span><span class="ident" id="3377082">mode</span><span class="op" id="3377086">&amp;</span><span class="ident" id="3377087">ScanComments</span>&nbsp;<span class="op" id="3377100">==</span>&nbsp;<span class="num" id="3377103">0</span>&nbsp;<span class="op" id="3377105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3377112">//&nbsp;skip&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377133">s</span><span class="op" id="3377134">.</span><span class="ident" id="3377135">insertSemi</span>&nbsp;<span class="op" id="3377146">=</span>&nbsp;<span class="builtintype" id="3377148">false</span>&nbsp;<span class="comment" id="3377154">//&nbsp;newline&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377179">goto</span>&nbsp;<span class="ident" id="3377184">scanAgain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377198">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377204">tok</span>&nbsp;<span class="op" id="3377208">=</span>&nbsp;<span class="ident" id="3377210">token</span><span class="op" id="3377215">.</span><span class="ident" id="3377216">COMMENT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377227">}</span>&nbsp;<span class="keyword" id="3377229">else</span>&nbsp;<span class="op" id="3377234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377240">tok</span>&nbsp;<span class="op" id="3377244">=</span>&nbsp;<span class="ident" id="3377246">s</span><span class="op" id="3377247">.</span><span class="ident" id="3377248">switch2</span><span class="op" id="3377255">(</span><span class="ident" id="3377256">token</span><span class="op" id="3377261">.</span><span class="ident" id="3377262">QUO</span><span class="op" id="3377265">,</span>&nbsp;<span class="ident" id="3377267">token</span><span class="op" id="3377272">.</span><span class="ident" id="3377273">QUO_ASSIGN</span><span class="op" id="3377283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377292">case</span>&nbsp;<span class="string" id="3377297">&#39;%&#39;</span><span class="op" id="3377300">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377305">tok</span>&nbsp;<span class="op" id="3377309">=</span>&nbsp;<span class="ident" id="3377311">s</span><span class="op" id="3377312">.</span><span class="ident" id="3377313">switch2</span><span class="op" id="3377320">(</span><span class="ident" id="3377321">token</span><span class="op" id="3377326">.</span><span class="ident" id="3377327">REM</span><span class="op" id="3377330">,</span>&nbsp;<span class="ident" id="3377332">token</span><span class="op" id="3377337">.</span><span class="ident" id="3377338">REM_ASSIGN</span><span class="op" id="3377348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377352">case</span>&nbsp;<span class="string" id="3377357">&#39;^&#39;</span><span class="op" id="3377360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377365">tok</span>&nbsp;<span class="op" id="3377369">=</span>&nbsp;<span class="ident" id="3377371">s</span><span class="op" id="3377372">.</span><span class="ident" id="3377373">switch2</span><span class="op" id="3377380">(</span><span class="ident" id="3377381">token</span><span class="op" id="3377386">.</span><span class="ident" id="3377387">XOR</span><span class="op" id="3377390">,</span>&nbsp;<span class="ident" id="3377392">token</span><span class="op" id="3377397">.</span><span class="ident" id="3377398">XOR_ASSIGN</span><span class="op" id="3377408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377412">case</span>&nbsp;<span class="string" id="3377417">&#39;&lt;&#39;</span><span class="op" id="3377420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377425">if</span>&nbsp;<span class="ident" id="3377428">s</span><span class="op" id="3377429">.</span><span class="ident" id="3377430">ch</span>&nbsp;<span class="op" id="3377433">==</span>&nbsp;<span class="string" id="3377436">&#39;-&#39;</span>&nbsp;<span class="op" id="3377440">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377446">s</span><span class="op" id="3377447">.</span><span class="ident" id="3377448">next</span><span class="op" id="3377452">(</span><span class="op" id="3377453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377459">tok</span>&nbsp;<span class="op" id="3377463">=</span>&nbsp;<span class="ident" id="3377465">token</span><span class="op" id="3377470">.</span><span class="ident" id="3377471">ARROW</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377480">}</span>&nbsp;<span class="keyword" id="3377482">else</span>&nbsp;<span class="op" id="3377487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377493">tok</span>&nbsp;<span class="op" id="3377497">=</span>&nbsp;<span class="ident" id="3377499">s</span><span class="op" id="3377500">.</span><span class="ident" id="3377501">switch4</span><span class="op" id="3377508">(</span><span class="ident" id="3377509">token</span><span class="op" id="3377514">.</span><span class="ident" id="3377515">LSS</span><span class="op" id="3377518">,</span>&nbsp;<span class="ident" id="3377520">token</span><span class="op" id="3377525">.</span><span class="ident" id="3377526">LEQ</span><span class="op" id="3377529">,</span>&nbsp;<span class="string" id="3377531">&#39;&lt;&#39;</span><span class="op" id="3377534">,</span>&nbsp;<span class="ident" id="3377536">token</span><span class="op" id="3377541">.</span><span class="ident" id="3377542">SHL</span><span class="op" id="3377545">,</span>&nbsp;<span class="ident" id="3377547">token</span><span class="op" id="3377552">.</span><span class="ident" id="3377553">SHL_ASSIGN</span><span class="op" id="3377563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377568">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377572">case</span>&nbsp;<span class="string" id="3377577">&#39;&gt;&#39;</span><span class="op" id="3377580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377585">tok</span>&nbsp;<span class="op" id="3377589">=</span>&nbsp;<span class="ident" id="3377591">s</span><span class="op" id="3377592">.</span><span class="ident" id="3377593">switch4</span><span class="op" id="3377600">(</span><span class="ident" id="3377601">token</span><span class="op" id="3377606">.</span><span class="ident" id="3377607">GTR</span><span class="op" id="3377610">,</span>&nbsp;<span class="ident" id="3377612">token</span><span class="op" id="3377617">.</span><span class="ident" id="3377618">GEQ</span><span class="op" id="3377621">,</span>&nbsp;<span class="string" id="3377623">&#39;&gt;&#39;</span><span class="op" id="3377626">,</span>&nbsp;<span class="ident" id="3377628">token</span><span class="op" id="3377633">.</span><span class="ident" id="3377634">SHR</span><span class="op" id="3377637">,</span>&nbsp;<span class="ident" id="3377639">token</span><span class="op" id="3377644">.</span><span class="ident" id="3377645">SHR_ASSIGN</span><span class="op" id="3377655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377659">case</span>&nbsp;<span class="string" id="3377664">&#39;=&#39;</span><span class="op" id="3377667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377672">tok</span>&nbsp;<span class="op" id="3377676">=</span>&nbsp;<span class="ident" id="3377678">s</span><span class="op" id="3377679">.</span><span class="ident" id="3377680">switch2</span><span class="op" id="3377687">(</span><span class="ident" id="3377688">token</span><span class="op" id="3377693">.</span><span class="ident" id="3377694">ASSIGN</span><span class="op" id="3377700">,</span>&nbsp;<span class="ident" id="3377702">token</span><span class="op" id="3377707">.</span><span class="ident" id="3377708">EQL</span><span class="op" id="3377711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377715">case</span>&nbsp;<span class="string" id="3377720">&#39;!&#39;</span><span class="op" id="3377723">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377728">tok</span>&nbsp;<span class="op" id="3377732">=</span>&nbsp;<span class="ident" id="3377734">s</span><span class="op" id="3377735">.</span><span class="ident" id="3377736">switch2</span><span class="op" id="3377743">(</span><span class="ident" id="3377744">token</span><span class="op" id="3377749">.</span><span class="ident" id="3377750">NOT</span><span class="op" id="3377753">,</span>&nbsp;<span class="ident" id="3377755">token</span><span class="op" id="3377760">.</span><span class="ident" id="3377761">NEQ</span><span class="op" id="3377764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377768">case</span>&nbsp;<span class="string" id="3377773">&#39;&amp;&#39;</span><span class="op" id="3377776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377781">if</span>&nbsp;<span class="ident" id="3377784">s</span><span class="op" id="3377785">.</span><span class="ident" id="3377786">ch</span>&nbsp;<span class="op" id="3377789">==</span>&nbsp;<span class="string" id="3377792">&#39;^&#39;</span>&nbsp;<span class="op" id="3377796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377802">s</span><span class="op" id="3377803">.</span><span class="ident" id="3377804">next</span><span class="op" id="3377808">(</span><span class="op" id="3377809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377815">tok</span>&nbsp;<span class="op" id="3377819">=</span>&nbsp;<span class="ident" id="3377821">s</span><span class="op" id="3377822">.</span><span class="ident" id="3377823">switch2</span><span class="op" id="3377830">(</span><span class="ident" id="3377831">token</span><span class="op" id="3377836">.</span><span class="ident" id="3377837">AND_NOT</span><span class="op" id="3377844">,</span>&nbsp;<span class="ident" id="3377846">token</span><span class="op" id="3377851">.</span><span class="ident" id="3377852">AND_NOT_ASSIGN</span><span class="op" id="3377866">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377871">}</span>&nbsp;<span class="keyword" id="3377873">else</span>&nbsp;<span class="op" id="3377878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377884">tok</span>&nbsp;<span class="op" id="3377888">=</span>&nbsp;<span class="ident" id="3377890">s</span><span class="op" id="3377891">.</span><span class="ident" id="3377892">switch3</span><span class="op" id="3377899">(</span><span class="ident" id="3377900">token</span><span class="op" id="3377905">.</span><span class="ident" id="3377906">AND</span><span class="op" id="3377909">,</span>&nbsp;<span class="ident" id="3377911">token</span><span class="op" id="3377916">.</span><span class="ident" id="3377917">AND_ASSIGN</span><span class="op" id="3377927">,</span>&nbsp;<span class="string" id="3377929">&#39;&amp;&#39;</span><span class="op" id="3377932">,</span>&nbsp;<span class="ident" id="3377934">token</span><span class="op" id="3377939">.</span><span class="ident" id="3377940">LAND</span><span class="op" id="3377944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3377949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3377953">case</span>&nbsp;<span class="string" id="3377958">&#39;|&#39;</span><span class="op" id="3377961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3377966">tok</span>&nbsp;<span class="op" id="3377970">=</span>&nbsp;<span class="ident" id="3377972">s</span><span class="op" id="3377973">.</span><span class="ident" id="3377974">switch3</span><span class="op" id="3377981">(</span><span class="ident" id="3377982">token</span><span class="op" id="3377987">.</span><span class="ident" id="3377988">OR</span><span class="op" id="3377990">,</span>&nbsp;<span class="ident" id="3377992">token</span><span class="op" id="3377997">.</span><span class="ident" id="3377998">OR_ASSIGN</span><span class="op" id="3378007">,</span>&nbsp;<span class="string" id="3378009">&#39;|&#39;</span><span class="op" id="3378012">,</span>&nbsp;<span class="ident" id="3378014">token</span><span class="op" id="3378019">.</span><span class="ident" id="3378020">LOR</span><span class="op" id="3378023">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378027">default</span><span class="op" id="3378034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3378039">//&nbsp;next&nbsp;reports&nbsp;unexpected&nbsp;BOMs&nbsp;-&nbsp;don&#39;t&nbsp;repeat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378089">if</span>&nbsp;<span class="ident" id="3378092">ch</span>&nbsp;<span class="op" id="3378095">!=</span>&nbsp;<span class="ident" id="3378098">bom</span>&nbsp;<span class="op" id="3378102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378108">s</span><span class="op" id="3378109">.</span><span class="builtintype" id="3378110">error</span><span class="op" id="3378115">(</span><span class="ident" id="3378116">s</span><span class="op" id="3378117">.</span><span class="ident" id="3378118">file</span><span class="op" id="3378122">.</span><span class="ident" id="3378123">Offset</span><span class="op" id="3378129">(</span><span class="ident" id="3378130">pos</span><span class="op" id="3378133">)</span><span class="op" id="3378134">,</span>&nbsp;<span class="ident" id="3378136">fmt</span><span class="op" id="3378139">.</span><span class="ident" id="3378140">Sprintf</span><span class="op" id="3378147">(</span><span class="string" id="3378148">&#34;illegal&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3378171">,</span>&nbsp;<span class="ident" id="3378173">ch</span><span class="op" id="3378175">)</span><span class="op" id="3378176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378181">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378186">insertSemi</span>&nbsp;<span class="op" id="3378197">=</span>&nbsp;<span class="ident" id="3378199">s</span><span class="op" id="3378200">.</span><span class="ident" id="3378201">insertSemi</span>&nbsp;<span class="comment" id="3378212">//&nbsp;preserve&nbsp;insertSemi&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378243">tok</span>&nbsp;<span class="op" id="3378247">=</span>&nbsp;<span class="ident" id="3378249">token</span><span class="op" id="3378254">.</span><span class="ident" id="3378255">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378266">lit</span>&nbsp;<span class="op" id="3378270">=</span>&nbsp;<span class="builtintype" id="3378272">string</span><span class="op" id="3378278">(</span><span class="ident" id="3378279">ch</span><span class="op" id="3378281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378288">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378291">if</span>&nbsp;<span class="ident" id="3378294">s</span><span class="op" id="3378295">.</span><span class="ident" id="3378296">mode</span><span class="op" id="3378300">&amp;</span><span class="ident" id="3378301">dontInsertSemis</span>&nbsp;<span class="op" id="3378317">==</span>&nbsp;<span class="num" id="3378320">0</span>&nbsp;<span class="op" id="3378322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3378326">s</span><span class="op" id="3378327">.</span><span class="ident" id="3378328">insertSemi</span>&nbsp;<span class="op" id="3378339">=</span>&nbsp;<span class="ident" id="3378341">insertSemi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3378353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3378357">return</span><br>
<span class="lineno">760</span><span class="op" id="3378364">}</span>
</div>
</body>
</html>
