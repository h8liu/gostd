<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7280560">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7280615">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7280669">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7280720">package</span>&nbsp;<span class="ident" id="7280728">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7280734">import</span>&nbsp;<span class="op" id="7280741">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280744">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280753">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280767">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280783">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280802">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280817">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280831">_</span>&nbsp;<span class="string" id="7280833">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7280850">_</span>&nbsp;<span class="string" id="7280852">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280869">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280889">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280906">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280925">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280941">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280957">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280969">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280976">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280987">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7280998">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281009">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7281020">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7281027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7281030">func</span>&nbsp;<span class="ident" id="7281035">TestParsePKCS1PrivateKey</span><span class="op" id="7281059">(</span><span class="ident" id="7281060">t</span>&nbsp;<span class="op" id="7281062">*</span><span class="ident" id="7281063">testing</span><span class="op" id="7281070">.</span><span class="ident" id="7281071">T</span><span class="op" id="7281072">)</span>&nbsp;<span class="op" id="7281074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281077">block</span><span class="op" id="7281082">,</span>&nbsp;<span class="ident" id="7281084">_</span>&nbsp;<span class="op" id="7281086">:=</span>&nbsp;<span class="ident" id="7281089">pem</span><span class="op" id="7281092">.</span><span class="ident" id="7281093">Decode</span><span class="op" id="7281099">(</span><span class="op" id="7281100">[</span><span class="op" id="7281101">]</span><span class="builtintype" id="7281102">byte</span><span class="op" id="7281106">(</span><span class="ident" id="7281107">pemPrivateKey</span><span class="op" id="7281120">)</span><span class="op" id="7281121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281124">priv</span><span class="op" id="7281128">,</span>&nbsp;<span class="ident" id="7281130">err</span>&nbsp;<span class="op" id="7281134">:=</span>&nbsp;<span class="ident" id="7281137">ParsePKCS1PrivateKey</span><span class="op" id="7281157">(</span><span class="ident" id="7281158">block</span><span class="op" id="7281163">.</span><span class="ident" id="7281164">Bytes</span><span class="op" id="7281169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281172">if</span>&nbsp;<span class="ident" id="7281175">err</span>&nbsp;<span class="op" id="7281179">!=</span>&nbsp;<span class="ident" id="7281182">nil</span>&nbsp;<span class="op" id="7281186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281190">t</span><span class="op" id="7281191">.</span><span class="ident" id="7281192">Errorf</span><span class="op" id="7281198">(</span><span class="string" id="7281199">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7281232">,</span>&nbsp;<span class="ident" id="7281234">err</span><span class="op" id="7281237">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281241">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7281249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281252">if</span>&nbsp;<span class="ident" id="7281255">priv</span><span class="op" id="7281259">.</span><span class="ident" id="7281260">PublicKey</span><span class="op" id="7281269">.</span><span class="ident" id="7281270">N</span><span class="op" id="7281271">.</span><span class="ident" id="7281272">Cmp</span><span class="op" id="7281275">(</span><span class="ident" id="7281276">rsaPrivateKey</span><span class="op" id="7281289">.</span><span class="ident" id="7281290">PublicKey</span><span class="op" id="7281299">.</span><span class="ident" id="7281300">N</span><span class="op" id="7281301">)</span>&nbsp;<span class="op" id="7281303">!=</span>&nbsp;<span class="num" id="7281306">0</span>&nbsp;<span class="op" id="7281308">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281313">priv</span><span class="op" id="7281317">.</span><span class="ident" id="7281318">PublicKey</span><span class="op" id="7281327">.</span><span class="ident" id="7281328">E</span>&nbsp;<span class="op" id="7281330">!=</span>&nbsp;<span class="ident" id="7281333">rsaPrivateKey</span><span class="op" id="7281346">.</span><span class="ident" id="7281347">PublicKey</span><span class="op" id="7281356">.</span><span class="ident" id="7281357">E</span>&nbsp;<span class="op" id="7281359">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281364">priv</span><span class="op" id="7281368">.</span><span class="ident" id="7281369">D</span><span class="op" id="7281370">.</span><span class="ident" id="7281371">Cmp</span><span class="op" id="7281374">(</span><span class="ident" id="7281375">rsaPrivateKey</span><span class="op" id="7281388">.</span><span class="ident" id="7281389">D</span><span class="op" id="7281390">)</span>&nbsp;<span class="op" id="7281392">!=</span>&nbsp;<span class="num" id="7281395">0</span>&nbsp;<span class="op" id="7281397">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281402">priv</span><span class="op" id="7281406">.</span><span class="ident" id="7281407">Primes</span><span class="op" id="7281413">[</span><span class="num" id="7281414">0</span><span class="op" id="7281415">]</span><span class="op" id="7281416">.</span><span class="ident" id="7281417">Cmp</span><span class="op" id="7281420">(</span><span class="ident" id="7281421">rsaPrivateKey</span><span class="op" id="7281434">.</span><span class="ident" id="7281435">Primes</span><span class="op" id="7281441">[</span><span class="num" id="7281442">0</span><span class="op" id="7281443">]</span><span class="op" id="7281444">)</span>&nbsp;<span class="op" id="7281446">!=</span>&nbsp;<span class="num" id="7281449">0</span>&nbsp;<span class="op" id="7281451">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281456">priv</span><span class="op" id="7281460">.</span><span class="ident" id="7281461">Primes</span><span class="op" id="7281467">[</span><span class="num" id="7281468">1</span><span class="op" id="7281469">]</span><span class="op" id="7281470">.</span><span class="ident" id="7281471">Cmp</span><span class="op" id="7281474">(</span><span class="ident" id="7281475">rsaPrivateKey</span><span class="op" id="7281488">.</span><span class="ident" id="7281489">Primes</span><span class="op" id="7281495">[</span><span class="num" id="7281496">1</span><span class="op" id="7281497">]</span><span class="op" id="7281498">)</span>&nbsp;<span class="op" id="7281500">!=</span>&nbsp;<span class="num" id="7281503">0</span>&nbsp;<span class="op" id="7281505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281509">t</span><span class="op" id="7281510">.</span><span class="ident" id="7281511">Errorf</span><span class="op" id="7281517">(</span><span class="string" id="7281518">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7281536">,</span>&nbsp;<span class="ident" id="7281538">priv</span><span class="op" id="7281542">,</span>&nbsp;<span class="ident" id="7281544">rsaPrivateKey</span><span class="op" id="7281557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7281560">}</span><br>
<span class="lineno"></span><span class="op" id="7281562">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7281565">func</span>&nbsp;<span class="ident" id="7281570">TestParsePKIXPublicKey</span><span class="op" id="7281592">(</span><span class="ident" id="7281593">t</span>&nbsp;<span class="op" id="7281595">*</span><span class="ident" id="7281596">testing</span><span class="op" id="7281603">.</span><span class="ident" id="7281604">T</span><span class="op" id="7281605">)</span>&nbsp;<span class="op" id="7281607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281610">block</span><span class="op" id="7281615">,</span>&nbsp;<span class="ident" id="7281617">_</span>&nbsp;<span class="op" id="7281619">:=</span>&nbsp;<span class="ident" id="7281622">pem</span><span class="op" id="7281625">.</span><span class="ident" id="7281626">Decode</span><span class="op" id="7281632">(</span><span class="op" id="7281633">[</span><span class="op" id="7281634">]</span><span class="builtintype" id="7281635">byte</span><span class="op" id="7281639">(</span><span class="ident" id="7281640">pemPublicKey</span><span class="op" id="7281652">)</span><span class="op" id="7281653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281656">pub</span><span class="op" id="7281659">,</span>&nbsp;<span class="ident" id="7281661">err</span>&nbsp;<span class="op" id="7281665">:=</span>&nbsp;<span class="ident" id="7281668">ParsePKIXPublicKey</span><span class="op" id="7281686">(</span><span class="ident" id="7281687">block</span><span class="op" id="7281692">.</span><span class="ident" id="7281693">Bytes</span><span class="op" id="7281698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281701">if</span>&nbsp;<span class="ident" id="7281704">err</span>&nbsp;<span class="op" id="7281708">!=</span>&nbsp;<span class="ident" id="7281711">nil</span>&nbsp;<span class="op" id="7281715">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281719">t</span><span class="op" id="7281720">.</span><span class="ident" id="7281721">Errorf</span><span class="op" id="7281727">(</span><span class="string" id="7281728">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7281764">,</span>&nbsp;<span class="ident" id="7281766">err</span><span class="op" id="7281769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281773">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7281781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281784">rsaPub</span><span class="op" id="7281790">,</span>&nbsp;<span class="ident" id="7281792">ok</span>&nbsp;<span class="op" id="7281795">:=</span>&nbsp;<span class="ident" id="7281798">pub</span><span class="op" id="7281801">.</span><span class="op" id="7281802">(</span><span class="op" id="7281803">*</span><span class="ident" id="7281804">rsa</span><span class="op" id="7281807">.</span><span class="ident" id="7281808">PublicKey</span><span class="op" id="7281817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281820">if</span>&nbsp;<span class="op" id="7281823">!</span><span class="ident" id="7281824">ok</span>&nbsp;<span class="op" id="7281827">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281831">t</span><span class="op" id="7281832">.</span><span class="ident" id="7281833">Errorf</span><span class="op" id="7281839">(</span><span class="string" id="7281840">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7281906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281910">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7281918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281922">pubBytes2</span><span class="op" id="7281931">,</span>&nbsp;<span class="ident" id="7281933">err</span>&nbsp;<span class="op" id="7281937">:=</span>&nbsp;<span class="ident" id="7281940">MarshalPKIXPublicKey</span><span class="op" id="7281960">(</span><span class="ident" id="7281961">rsaPub</span><span class="op" id="7281967">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7281970">if</span>&nbsp;<span class="ident" id="7281973">err</span>&nbsp;<span class="op" id="7281977">!=</span>&nbsp;<span class="ident" id="7281980">nil</span>&nbsp;<span class="op" id="7281984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7281988">t</span><span class="op" id="7281989">.</span><span class="ident" id="7281990">Errorf</span><span class="op" id="7281996">(</span><span class="string" id="7281997">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7282055">,</span>&nbsp;<span class="ident" id="7282057">err</span><span class="op" id="7282060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282064">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7282075">if</span>&nbsp;<span class="op" id="7282078">!</span><span class="ident" id="7282079">bytes</span><span class="op" id="7282084">.</span><span class="ident" id="7282085">Equal</span><span class="op" id="7282090">(</span><span class="ident" id="7282091">pubBytes2</span><span class="op" id="7282100">,</span>&nbsp;<span class="ident" id="7282102">block</span><span class="op" id="7282107">.</span><span class="ident" id="7282108">Bytes</span><span class="op" id="7282113">)</span>&nbsp;<span class="op" id="7282115">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7282119">t</span><span class="op" id="7282120">.</span><span class="ident" id="7282121">Errorf</span><span class="op" id="7282127">(</span><span class="string" id="7282128">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7282189">,</span>&nbsp;<span class="ident" id="7282191">pubBytes2</span><span class="op" id="7282200">,</span>&nbsp;<span class="ident" id="7282202">block</span><span class="op" id="7282207">.</span><span class="ident" id="7282208">Bytes</span><span class="op" id="7282213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7282216">}</span><br>
<span class="lineno"></span><span class="op" id="7282218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7282221">var</span>&nbsp;<span class="ident" id="7282225">pemPublicKey</span>&nbsp;<span class="op" id="7282238">=</span>&nbsp;<span class="string" id="7282240">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7282695">var</span>&nbsp;<span class="ident" id="7282699">pemPrivateKey</span>&nbsp;<span class="op" id="7282713">=</span>&nbsp;<span class="string" id="7282715">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7283212">func</span>&nbsp;<span class="ident" id="7283217">bigFromString</span><span class="op" id="7283230">(</span><span class="ident" id="7283231">s</span>&nbsp;<span class="builtintype" id="7283233">string</span><span class="op" id="7283239">)</span>&nbsp;<span class="op" id="7283241">*</span><span class="ident" id="7283242">big</span><span class="op" id="7283245">.</span><span class="ident" id="7283246">Int</span>&nbsp;<span class="op" id="7283250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283253">ret</span>&nbsp;<span class="op" id="7283257">:=</span>&nbsp;<span class="builtinfunc" id="7283260">new</span><span class="op" id="7283263">(</span><span class="ident" id="7283264">big</span><span class="op" id="7283267">.</span><span class="ident" id="7283268">Int</span><span class="op" id="7283271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283274">ret</span><span class="op" id="7283277">.</span><span class="ident" id="7283278">SetString</span><span class="op" id="7283287">(</span><span class="ident" id="7283288">s</span><span class="op" id="7283289">,</span>&nbsp;<span class="num" id="7283291">10</span><span class="op" id="7283293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283296">return</span>&nbsp;<span class="ident" id="7283303">ret</span><br>
<span class="lineno">95</span><span class="op" id="7283307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283310">func</span>&nbsp;<span class="ident" id="7283315">fromBase10</span><span class="op" id="7283325">(</span><span class="ident" id="7283326">base10</span>&nbsp;<span class="builtintype" id="7283333">string</span><span class="op" id="7283339">)</span>&nbsp;<span class="op" id="7283341">*</span><span class="ident" id="7283342">big</span><span class="op" id="7283345">.</span><span class="ident" id="7283346">Int</span>&nbsp;<span class="op" id="7283350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283353">i</span>&nbsp;<span class="op" id="7283355">:=</span>&nbsp;<span class="builtinfunc" id="7283358">new</span><span class="op" id="7283361">(</span><span class="ident" id="7283362">big</span><span class="op" id="7283365">.</span><span class="ident" id="7283366">Int</span><span class="op" id="7283369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283372">i</span><span class="op" id="7283373">.</span><span class="ident" id="7283374">SetString</span><span class="op" id="7283383">(</span><span class="ident" id="7283384">base10</span><span class="op" id="7283390">,</span>&nbsp;<span class="num" id="7283392">10</span><span class="op" id="7283394">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283397">return</span>&nbsp;<span class="ident" id="7283404">i</span><br>
<span class="lineno"></span><span class="op" id="7283406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283409">func</span>&nbsp;<span class="ident" id="7283414">bigFromHexString</span><span class="op" id="7283430">(</span><span class="ident" id="7283431">s</span>&nbsp;<span class="builtintype" id="7283433">string</span><span class="op" id="7283439">)</span>&nbsp;<span class="op" id="7283441">*</span><span class="ident" id="7283442">big</span><span class="op" id="7283445">.</span><span class="ident" id="7283446">Int</span>&nbsp;<span class="op" id="7283450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283453">ret</span>&nbsp;<span class="op" id="7283457">:=</span>&nbsp;<span class="builtinfunc" id="7283460">new</span><span class="op" id="7283463">(</span><span class="ident" id="7283464">big</span><span class="op" id="7283467">.</span><span class="ident" id="7283468">Int</span><span class="op" id="7283471">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283474">ret</span><span class="op" id="7283477">.</span><span class="ident" id="7283478">SetString</span><span class="op" id="7283487">(</span><span class="ident" id="7283488">s</span><span class="op" id="7283489">,</span>&nbsp;<span class="num" id="7283491">16</span><span class="op" id="7283493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7283496">return</span>&nbsp;<span class="ident" id="7283503">ret</span><br>
<span class="lineno"></span><span class="op" id="7283507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283510">var</span>&nbsp;<span class="ident" id="7283514">rsaPrivateKey</span>&nbsp;<span class="op" id="7283528">=</span>&nbsp;<span class="op" id="7283530">&amp;</span><span class="ident" id="7283531">rsa</span><span class="op" id="7283534">.</span><span class="ident" id="7283535">PrivateKey</span><span class="op" id="7283545">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283548">PublicKey</span><span class="op" id="7283557">:</span>&nbsp;<span class="ident" id="7283559">rsa</span><span class="op" id="7283562">.</span><span class="ident" id="7283563">PublicKey</span><span class="op" id="7283572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283576">N</span><span class="op" id="7283577">:</span>&nbsp;<span class="ident" id="7283579">bigFromString</span><span class="op" id="7283592">(</span><span class="string" id="7283593">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7283749">)</span><span class="op" id="7283750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283754">E</span><span class="op" id="7283755">:</span>&nbsp;<span class="num" id="7283757">65537</span><span class="op" id="7283762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7283765">}</span><span class="op" id="7283766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283769">D</span><span class="op" id="7283770">:</span>&nbsp;<span class="ident" id="7283772">bigFromString</span><span class="op" id="7283785">(</span><span class="string" id="7283786">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7283942">)</span><span class="op" id="7283943">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283946">Primes</span><span class="op" id="7283952">:</span>&nbsp;<span class="op" id="7283954">[</span><span class="op" id="7283955">]</span><span class="op" id="7283956">*</span><span class="ident" id="7283957">big</span><span class="op" id="7283960">.</span><span class="ident" id="7283961">Int</span><span class="op" id="7283964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7283968">bigFromString</span><span class="op" id="7283981">(</span><span class="string" id="7283982">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7284061">)</span><span class="op" id="7284062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284066">bigFromString</span><span class="op" id="7284079">(</span><span class="string" id="7284080">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7284159">)</span><span class="op" id="7284160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284163">}</span><span class="op" id="7284164">,</span><br>
<span class="lineno"></span><span class="op" id="7284166">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7284169">func</span>&nbsp;<span class="ident" id="7284174">TestMarshalRSAPrivateKey</span><span class="op" id="7284198">(</span><span class="ident" id="7284199">t</span>&nbsp;<span class="op" id="7284201">*</span><span class="ident" id="7284202">testing</span><span class="op" id="7284209">.</span><span class="ident" id="7284210">T</span><span class="op" id="7284211">)</span>&nbsp;<span class="op" id="7284213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284216">priv</span>&nbsp;<span class="op" id="7284221">:=</span>&nbsp;<span class="op" id="7284224">&amp;</span><span class="ident" id="7284225">rsa</span><span class="op" id="7284228">.</span><span class="ident" id="7284229">PrivateKey</span><span class="op" id="7284239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284243">PublicKey</span><span class="op" id="7284252">:</span>&nbsp;<span class="ident" id="7284254">rsa</span><span class="op" id="7284257">.</span><span class="ident" id="7284258">PublicKey</span><span class="op" id="7284267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284272">N</span><span class="op" id="7284273">:</span>&nbsp;<span class="ident" id="7284275">fromBase10</span><span class="op" id="7284285">(</span><span class="string" id="7284286">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7284905">)</span><span class="op" id="7284906">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284911">E</span><span class="op" id="7284912">:</span>&nbsp;<span class="num" id="7284914">3</span><span class="op" id="7284915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284919">}</span><span class="op" id="7284920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284924">D</span><span class="op" id="7284925">:</span>&nbsp;<span class="ident" id="7284927">fromBase10</span><span class="op" id="7284937">(</span><span class="string" id="7284938">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7285557">)</span><span class="op" id="7285558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285562">Primes</span><span class="op" id="7285568">:</span>&nbsp;<span class="op" id="7285570">[</span><span class="op" id="7285571">]</span><span class="op" id="7285572">*</span><span class="ident" id="7285573">big</span><span class="op" id="7285576">.</span><span class="ident" id="7285577">Int</span><span class="op" id="7285580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285585">fromBase10</span><span class="op" id="7285595">(</span><span class="string" id="7285596">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7285806">)</span><span class="op" id="7285807">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285812">fromBase10</span><span class="op" id="7285822">(</span><span class="string" id="7285823">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7286030">)</span><span class="op" id="7286031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286036">fromBase10</span><span class="op" id="7286046">(</span><span class="string" id="7286047">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7286254">)</span><span class="op" id="7286255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286259">}</span><span class="op" id="7286260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286267">derBytes</span>&nbsp;<span class="op" id="7286276">:=</span>&nbsp;<span class="ident" id="7286279">MarshalPKCS1PrivateKey</span><span class="op" id="7286301">(</span><span class="ident" id="7286302">priv</span><span class="op" id="7286306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286310">priv2</span><span class="op" id="7286315">,</span>&nbsp;<span class="ident" id="7286317">err</span>&nbsp;<span class="op" id="7286321">:=</span>&nbsp;<span class="ident" id="7286324">ParsePKCS1PrivateKey</span><span class="op" id="7286344">(</span><span class="ident" id="7286345">derBytes</span><span class="op" id="7286353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286356">if</span>&nbsp;<span class="ident" id="7286359">err</span>&nbsp;<span class="op" id="7286363">!=</span>&nbsp;<span class="ident" id="7286366">nil</span>&nbsp;<span class="op" id="7286370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286374">t</span><span class="op" id="7286375">.</span><span class="ident" id="7286376">Errorf</span><span class="op" id="7286382">(</span><span class="string" id="7286383">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7286417">,</span>&nbsp;<span class="ident" id="7286419">err</span><span class="op" id="7286422">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286426">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286437">if</span>&nbsp;<span class="ident" id="7286440">priv</span><span class="op" id="7286444">.</span><span class="ident" id="7286445">PublicKey</span><span class="op" id="7286454">.</span><span class="ident" id="7286455">N</span><span class="op" id="7286456">.</span><span class="ident" id="7286457">Cmp</span><span class="op" id="7286460">(</span><span class="ident" id="7286461">priv2</span><span class="op" id="7286466">.</span><span class="ident" id="7286467">PublicKey</span><span class="op" id="7286476">.</span><span class="ident" id="7286477">N</span><span class="op" id="7286478">)</span>&nbsp;<span class="op" id="7286480">!=</span>&nbsp;<span class="num" id="7286483">0</span>&nbsp;<span class="op" id="7286485">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286490">priv</span><span class="op" id="7286494">.</span><span class="ident" id="7286495">PublicKey</span><span class="op" id="7286504">.</span><span class="ident" id="7286505">E</span>&nbsp;<span class="op" id="7286507">!=</span>&nbsp;<span class="ident" id="7286510">priv2</span><span class="op" id="7286515">.</span><span class="ident" id="7286516">PublicKey</span><span class="op" id="7286525">.</span><span class="ident" id="7286526">E</span>&nbsp;<span class="op" id="7286528">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286533">priv</span><span class="op" id="7286537">.</span><span class="ident" id="7286538">D</span><span class="op" id="7286539">.</span><span class="ident" id="7286540">Cmp</span><span class="op" id="7286543">(</span><span class="ident" id="7286544">priv2</span><span class="op" id="7286549">.</span><span class="ident" id="7286550">D</span><span class="op" id="7286551">)</span>&nbsp;<span class="op" id="7286553">!=</span>&nbsp;<span class="num" id="7286556">0</span>&nbsp;<span class="op" id="7286558">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7286563">len</span><span class="op" id="7286566">(</span><span class="ident" id="7286567">priv2</span><span class="op" id="7286572">.</span><span class="ident" id="7286573">Primes</span><span class="op" id="7286579">)</span>&nbsp;<span class="op" id="7286581">!=</span>&nbsp;<span class="num" id="7286584">3</span>&nbsp;<span class="op" id="7286586">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286591">priv</span><span class="op" id="7286595">.</span><span class="ident" id="7286596">Primes</span><span class="op" id="7286602">[</span><span class="num" id="7286603">0</span><span class="op" id="7286604">]</span><span class="op" id="7286605">.</span><span class="ident" id="7286606">Cmp</span><span class="op" id="7286609">(</span><span class="ident" id="7286610">priv2</span><span class="op" id="7286615">.</span><span class="ident" id="7286616">Primes</span><span class="op" id="7286622">[</span><span class="num" id="7286623">0</span><span class="op" id="7286624">]</span><span class="op" id="7286625">)</span>&nbsp;<span class="op" id="7286627">!=</span>&nbsp;<span class="num" id="7286630">0</span>&nbsp;<span class="op" id="7286632">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286637">priv</span><span class="op" id="7286641">.</span><span class="ident" id="7286642">Primes</span><span class="op" id="7286648">[</span><span class="num" id="7286649">1</span><span class="op" id="7286650">]</span><span class="op" id="7286651">.</span><span class="ident" id="7286652">Cmp</span><span class="op" id="7286655">(</span><span class="ident" id="7286656">priv2</span><span class="op" id="7286661">.</span><span class="ident" id="7286662">Primes</span><span class="op" id="7286668">[</span><span class="num" id="7286669">1</span><span class="op" id="7286670">]</span><span class="op" id="7286671">)</span>&nbsp;<span class="op" id="7286673">!=</span>&nbsp;<span class="num" id="7286676">0</span>&nbsp;<span class="op" id="7286678">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286683">priv</span><span class="op" id="7286687">.</span><span class="ident" id="7286688">Primes</span><span class="op" id="7286694">[</span><span class="num" id="7286695">2</span><span class="op" id="7286696">]</span><span class="op" id="7286697">.</span><span class="ident" id="7286698">Cmp</span><span class="op" id="7286701">(</span><span class="ident" id="7286702">priv2</span><span class="op" id="7286707">.</span><span class="ident" id="7286708">Primes</span><span class="op" id="7286714">[</span><span class="num" id="7286715">2</span><span class="op" id="7286716">]</span><span class="op" id="7286717">)</span>&nbsp;<span class="op" id="7286719">!=</span>&nbsp;<span class="num" id="7286722">0</span>&nbsp;<span class="op" id="7286724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286728">t</span><span class="op" id="7286729">.</span><span class="ident" id="7286730">Errorf</span><span class="op" id="7286736">(</span><span class="string" id="7286737">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7286755">,</span>&nbsp;<span class="ident" id="7286757">priv</span><span class="op" id="7286761">,</span>&nbsp;<span class="ident" id="7286763">priv2</span><span class="op" id="7286768">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286771">}</span><br>
<span class="lineno"></span><span class="op" id="7286773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7286776">type</span>&nbsp;<span class="ident" id="7286781">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7286800">struct</span>&nbsp;<span class="op" id="7286807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286810">pattern</span><span class="op" id="7286817">,</span>&nbsp;<span class="ident" id="7286819">host</span>&nbsp;<span class="builtintype" id="7286824">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286832">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7286846">bool</span><br>
<span class="lineno"></span><span class="op" id="7286851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7286854">var</span>&nbsp;<span class="ident" id="7286858">matchHostnamesTests</span>&nbsp;<span class="op" id="7286878">=</span>&nbsp;<span class="op" id="7286880">[</span><span class="op" id="7286881">]</span><span class="ident" id="7286882">matchHostnamesTest</span><span class="op" id="7286900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286903">{</span><span class="string" id="7286904">&#34;a.b.c&#34;</span><span class="op" id="7286911">,</span>&nbsp;<span class="string" id="7286913">&#34;a.b.c&#34;</span><span class="op" id="7286920">,</span>&nbsp;<span class="builtintype" id="7286922">true</span><span class="op" id="7286926">}</span><span class="op" id="7286927">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286930">{</span><span class="string" id="7286931">&#34;a.b.c&#34;</span><span class="op" id="7286938">,</span>&nbsp;<span class="string" id="7286940">&#34;b.b.c&#34;</span><span class="op" id="7286947">,</span>&nbsp;<span class="builtintype" id="7286949">false</span><span class="op" id="7286954">}</span><span class="op" id="7286955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286958">{</span><span class="string" id="7286959">&#34;&#34;</span><span class="op" id="7286961">,</span>&nbsp;<span class="string" id="7286963">&#34;b.b.c&#34;</span><span class="op" id="7286970">,</span>&nbsp;<span class="builtintype" id="7286972">false</span><span class="op" id="7286977">}</span><span class="op" id="7286978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286981">{</span><span class="string" id="7286982">&#34;a.b.c&#34;</span><span class="op" id="7286989">,</span>&nbsp;<span class="string" id="7286991">&#34;&#34;</span><span class="op" id="7286993">,</span>&nbsp;<span class="builtintype" id="7286995">false</span><span class="op" id="7287000">}</span><span class="op" id="7287001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287004">{</span><span class="string" id="7287005">&#34;example.com&#34;</span><span class="op" id="7287018">,</span>&nbsp;<span class="string" id="7287020">&#34;example.com&#34;</span><span class="op" id="7287033">,</span>&nbsp;<span class="builtintype" id="7287035">true</span><span class="op" id="7287039">}</span><span class="op" id="7287040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287043">{</span><span class="string" id="7287044">&#34;example.com&#34;</span><span class="op" id="7287057">,</span>&nbsp;<span class="string" id="7287059">&#34;www.example.com&#34;</span><span class="op" id="7287076">,</span>&nbsp;<span class="builtintype" id="7287078">false</span><span class="op" id="7287083">}</span><span class="op" id="7287084">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287087">{</span><span class="string" id="7287088">&#34;*.example.com&#34;</span><span class="op" id="7287103">,</span>&nbsp;<span class="string" id="7287105">&#34;www.example.com&#34;</span><span class="op" id="7287122">,</span>&nbsp;<span class="builtintype" id="7287124">true</span><span class="op" id="7287128">}</span><span class="op" id="7287129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287132">{</span><span class="string" id="7287133">&#34;*.example.com&#34;</span><span class="op" id="7287148">,</span>&nbsp;<span class="string" id="7287150">&#34;xyz.www.example.com&#34;</span><span class="op" id="7287171">,</span>&nbsp;<span class="builtintype" id="7287173">false</span><span class="op" id="7287178">}</span><span class="op" id="7287179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287182">{</span><span class="string" id="7287183">&#34;*.*.example.com&#34;</span><span class="op" id="7287200">,</span>&nbsp;<span class="string" id="7287202">&#34;xyz.www.example.com&#34;</span><span class="op" id="7287223">,</span>&nbsp;<span class="builtintype" id="7287225">true</span><span class="op" id="7287229">}</span><span class="op" id="7287230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287233">{</span><span class="string" id="7287234">&#34;*.www.*.com&#34;</span><span class="op" id="7287247">,</span>&nbsp;<span class="string" id="7287249">&#34;xyz.www.example.com&#34;</span><span class="op" id="7287270">,</span>&nbsp;<span class="builtintype" id="7287272">true</span><span class="op" id="7287276">}</span><span class="op" id="7287277">,</span><br>
<span class="lineno"></span><span class="op" id="7287279">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7287282">func</span>&nbsp;<span class="ident" id="7287287">TestMatchHostnames</span><span class="op" id="7287305">(</span><span class="ident" id="7287306">t</span>&nbsp;<span class="op" id="7287308">*</span><span class="ident" id="7287309">testing</span><span class="op" id="7287316">.</span><span class="ident" id="7287317">T</span><span class="op" id="7287318">)</span>&nbsp;<span class="op" id="7287320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287323">for</span>&nbsp;<span class="ident" id="7287327">i</span><span class="op" id="7287328">,</span>&nbsp;<span class="ident" id="7287330">test</span>&nbsp;<span class="op" id="7287335">:=</span>&nbsp;<span class="keyword" id="7287338">range</span>&nbsp;<span class="ident" id="7287344">matchHostnamesTests</span>&nbsp;<span class="op" id="7287364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287368">r</span>&nbsp;<span class="op" id="7287370">:=</span>&nbsp;<span class="ident" id="7287373">matchHostnames</span><span class="op" id="7287387">(</span><span class="ident" id="7287388">test</span><span class="op" id="7287392">.</span><span class="ident" id="7287393">pattern</span><span class="op" id="7287400">,</span>&nbsp;<span class="ident" id="7287402">test</span><span class="op" id="7287406">.</span><span class="ident" id="7287407">host</span><span class="op" id="7287411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287415">if</span>&nbsp;<span class="ident" id="7287418">r</span>&nbsp;<span class="op" id="7287420">!=</span>&nbsp;<span class="ident" id="7287423">test</span><span class="op" id="7287427">.</span><span class="ident" id="7287428">ok</span>&nbsp;<span class="op" id="7287431">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287436">t</span><span class="op" id="7287437">.</span><span class="ident" id="7287438">Errorf</span><span class="op" id="7287444">(</span><span class="string" id="7287445">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7287476">,</span>&nbsp;<span class="ident" id="7287478">i</span><span class="op" id="7287479">,</span>&nbsp;<span class="ident" id="7287481">r</span><span class="op" id="7287482">,</span>&nbsp;<span class="ident" id="7287484">test</span><span class="op" id="7287488">.</span><span class="ident" id="7287489">ok</span><span class="op" id="7287491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287498">}</span><br>
<span class="lineno"></span><span class="op" id="7287500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7287503">func</span>&nbsp;<span class="ident" id="7287508">TestMatchIP</span><span class="op" id="7287519">(</span><span class="ident" id="7287520">t</span>&nbsp;<span class="op" id="7287522">*</span><span class="ident" id="7287523">testing</span><span class="op" id="7287530">.</span><span class="ident" id="7287531">T</span><span class="op" id="7287532">)</span>&nbsp;<span class="op" id="7287534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7287537">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287581">c</span>&nbsp;<span class="op" id="7287583">:=</span>&nbsp;<span class="op" id="7287586">&amp;</span><span class="ident" id="7287587">Certificate</span><span class="op" id="7287598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287602">DNSNames</span><span class="op" id="7287610">:</span>&nbsp;<span class="op" id="7287612">[</span><span class="op" id="7287613">]</span><span class="builtintype" id="7287614">string</span><span class="op" id="7287620">{</span><span class="string" id="7287621">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7287636">}</span><span class="op" id="7287637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287641">Subject</span><span class="op" id="7287648">:</span>&nbsp;<span class="ident" id="7287650">pkix</span><span class="op" id="7287654">.</span><span class="ident" id="7287655">Name</span><span class="op" id="7287659">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287664">CommonName</span><span class="op" id="7287674">:</span>&nbsp;<span class="string" id="7287676">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7287691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287695">}</span><span class="op" id="7287696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287702">err</span>&nbsp;<span class="op" id="7287706">:=</span>&nbsp;<span class="ident" id="7287709">c</span><span class="op" id="7287710">.</span><span class="ident" id="7287711">VerifyHostname</span><span class="op" id="7287725">(</span><span class="string" id="7287726">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7287744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287747">if</span>&nbsp;<span class="ident" id="7287750">err</span>&nbsp;<span class="op" id="7287754">!=</span>&nbsp;<span class="ident" id="7287757">nil</span>&nbsp;<span class="op" id="7287761">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287765">t</span><span class="op" id="7287766">.</span><span class="ident" id="7287767">Fatalf</span><span class="op" id="7287773">(</span><span class="string" id="7287774">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7287812">,</span>&nbsp;<span class="ident" id="7287814">err</span><span class="op" id="7287817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7287824">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7287897">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287917">c</span>&nbsp;<span class="op" id="7287919">=</span>&nbsp;<span class="op" id="7287921">&amp;</span><span class="ident" id="7287922">Certificate</span><span class="op" id="7287933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287937">DNSNames</span><span class="op" id="7287945">:</span>&nbsp;<span class="op" id="7287947">[</span><span class="op" id="7287948">]</span><span class="builtintype" id="7287949">string</span><span class="op" id="7287955">{</span><span class="string" id="7287956">&#34;*.2.3.4&#34;</span><span class="op" id="7287965">}</span><span class="op" id="7287966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287970">Subject</span><span class="op" id="7287977">:</span>&nbsp;<span class="ident" id="7287979">pkix</span><span class="op" id="7287983">.</span><span class="ident" id="7287984">Name</span><span class="op" id="7287988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287993">CommonName</span><span class="op" id="7288003">:</span>&nbsp;<span class="string" id="7288005">&#34;*.2.3.4&#34;</span><span class="op" id="7288014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288018">}</span><span class="op" id="7288019">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288025">err</span>&nbsp;<span class="op" id="7288029">=</span>&nbsp;<span class="ident" id="7288031">c</span><span class="op" id="7288032">.</span><span class="ident" id="7288033">VerifyHostname</span><span class="op" id="7288047">(</span><span class="string" id="7288048">&#34;1.2.3.4&#34;</span><span class="op" id="7288057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288060">if</span>&nbsp;<span class="ident" id="7288063">err</span>&nbsp;<span class="op" id="7288067">==</span>&nbsp;<span class="ident" id="7288070">nil</span>&nbsp;<span class="op" id="7288074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288078">t</span><span class="op" id="7288079">.</span><span class="ident" id="7288080">Fatalf</span><span class="op" id="7288086">(</span><span class="string" id="7288087">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7288140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288143">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288147">c</span>&nbsp;<span class="op" id="7288149">=</span>&nbsp;<span class="op" id="7288151">&amp;</span><span class="ident" id="7288152">Certificate</span><span class="op" id="7288163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288167">IPAddresses</span><span class="op" id="7288178">:</span>&nbsp;<span class="op" id="7288180">[</span><span class="op" id="7288181">]</span><span class="ident" id="7288182">net</span><span class="op" id="7288185">.</span><span class="ident" id="7288186">IP</span><span class="op" id="7288188">{</span><span class="ident" id="7288189">net</span><span class="op" id="7288192">.</span><span class="ident" id="7288193">ParseIP</span><span class="op" id="7288200">(</span><span class="string" id="7288201">&#34;127.0.0.1&#34;</span><span class="op" id="7288212">)</span><span class="op" id="7288213">,</span>&nbsp;<span class="ident" id="7288215">net</span><span class="op" id="7288218">.</span><span class="ident" id="7288219">ParseIP</span><span class="op" id="7288226">(</span><span class="string" id="7288227">&#34;::1&#34;</span><span class="op" id="7288232">)</span><span class="op" id="7288233">}</span><span class="op" id="7288234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288240">err</span>&nbsp;<span class="op" id="7288244">=</span>&nbsp;<span class="ident" id="7288246">c</span><span class="op" id="7288247">.</span><span class="ident" id="7288248">VerifyHostname</span><span class="op" id="7288262">(</span><span class="string" id="7288263">&#34;127.0.0.1&#34;</span><span class="op" id="7288274">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288277">if</span>&nbsp;<span class="ident" id="7288280">err</span>&nbsp;<span class="op" id="7288284">!=</span>&nbsp;<span class="ident" id="7288287">nil</span>&nbsp;<span class="op" id="7288291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288295">t</span><span class="op" id="7288296">.</span><span class="ident" id="7288297">Fatalf</span><span class="op" id="7288303">(</span><span class="string" id="7288304">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7288335">,</span>&nbsp;<span class="ident" id="7288337">err</span><span class="op" id="7288340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288346">err</span>&nbsp;<span class="op" id="7288350">=</span>&nbsp;<span class="ident" id="7288352">c</span><span class="op" id="7288353">.</span><span class="ident" id="7288354">VerifyHostname</span><span class="op" id="7288368">(</span><span class="string" id="7288369">&#34;::1&#34;</span><span class="op" id="7288374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288377">if</span>&nbsp;<span class="ident" id="7288380">err</span>&nbsp;<span class="op" id="7288384">!=</span>&nbsp;<span class="ident" id="7288387">nil</span>&nbsp;<span class="op" id="7288391">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288395">t</span><span class="op" id="7288396">.</span><span class="ident" id="7288397">Fatalf</span><span class="op" id="7288403">(</span><span class="string" id="7288404">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7288429">,</span>&nbsp;<span class="ident" id="7288431">err</span><span class="op" id="7288434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288440">err</span>&nbsp;<span class="op" id="7288444">=</span>&nbsp;<span class="ident" id="7288446">c</span><span class="op" id="7288447">.</span><span class="ident" id="7288448">VerifyHostname</span><span class="op" id="7288462">(</span><span class="string" id="7288463">&#34;[::1]&#34;</span><span class="op" id="7288470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288473">if</span>&nbsp;<span class="ident" id="7288476">err</span>&nbsp;<span class="op" id="7288480">!=</span>&nbsp;<span class="ident" id="7288483">nil</span>&nbsp;<span class="op" id="7288487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288491">t</span><span class="op" id="7288492">.</span><span class="ident" id="7288493">Fatalf</span><span class="op" id="7288499">(</span><span class="string" id="7288500">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7288527">,</span>&nbsp;<span class="ident" id="7288529">err</span><span class="op" id="7288532">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288535">}</span><br>
<span class="lineno"></span><span class="op" id="7288537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7288540">func</span>&nbsp;<span class="ident" id="7288545">TestCertificateParse</span><span class="op" id="7288565">(</span><span class="ident" id="7288566">t</span>&nbsp;<span class="op" id="7288568">*</span><span class="ident" id="7288569">testing</span><span class="op" id="7288576">.</span><span class="ident" id="7288577">T</span><span class="op" id="7288578">)</span>&nbsp;<span class="op" id="7288580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288583">s</span><span class="op" id="7288584">,</span>&nbsp;<span class="ident" id="7288586">_</span>&nbsp;<span class="op" id="7288588">:=</span>&nbsp;<span class="ident" id="7288591">hex</span><span class="op" id="7288594">.</span><span class="ident" id="7288595">DecodeString</span><span class="op" id="7288607">(</span><span class="ident" id="7288608">certBytes</span><span class="op" id="7288617">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288620">certs</span><span class="op" id="7288625">,</span>&nbsp;<span class="ident" id="7288627">err</span>&nbsp;<span class="op" id="7288631">:=</span>&nbsp;<span class="ident" id="7288634">ParseCertificates</span><span class="op" id="7288651">(</span><span class="ident" id="7288652">s</span><span class="op" id="7288653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288656">if</span>&nbsp;<span class="ident" id="7288659">err</span>&nbsp;<span class="op" id="7288663">!=</span>&nbsp;<span class="ident" id="7288666">nil</span>&nbsp;<span class="op" id="7288670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288674">t</span><span class="op" id="7288675">.</span><span class="ident" id="7288676">Error</span><span class="op" id="7288681">(</span><span class="ident" id="7288682">err</span><span class="op" id="7288685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288691">if</span>&nbsp;<span class="builtinfunc" id="7288694">len</span><span class="op" id="7288697">(</span><span class="ident" id="7288698">certs</span><span class="op" id="7288703">)</span>&nbsp;<span class="op" id="7288705">!=</span>&nbsp;<span class="num" id="7288708">2</span>&nbsp;<span class="op" id="7288710">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288714">t</span><span class="op" id="7288715">.</span><span class="ident" id="7288716">Errorf</span><span class="op" id="7288722">(</span><span class="string" id="7288723">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7288761">,</span>&nbsp;<span class="builtinfunc" id="7288763">len</span><span class="op" id="7288766">(</span><span class="ident" id="7288767">certs</span><span class="op" id="7288772">)</span><span class="op" id="7288773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288777">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288789">err</span>&nbsp;<span class="op" id="7288793">=</span>&nbsp;<span class="ident" id="7288795">certs</span><span class="op" id="7288800">[</span><span class="num" id="7288801">0</span><span class="op" id="7288802">]</span><span class="op" id="7288803">.</span><span class="ident" id="7288804">CheckSignatureFrom</span><span class="op" id="7288822">(</span><span class="ident" id="7288823">certs</span><span class="op" id="7288828">[</span><span class="num" id="7288829">1</span><span class="op" id="7288830">]</span><span class="op" id="7288831">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288834">if</span>&nbsp;<span class="ident" id="7288837">err</span>&nbsp;<span class="op" id="7288841">!=</span>&nbsp;<span class="ident" id="7288844">nil</span>&nbsp;<span class="op" id="7288848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288852">t</span><span class="op" id="7288853">.</span><span class="ident" id="7288854">Error</span><span class="op" id="7288859">(</span><span class="ident" id="7288860">err</span><span class="op" id="7288863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288870">if</span>&nbsp;<span class="ident" id="7288873">err</span>&nbsp;<span class="op" id="7288877">:=</span>&nbsp;<span class="ident" id="7288880">certs</span><span class="op" id="7288885">[</span><span class="num" id="7288886">0</span><span class="op" id="7288887">]</span><span class="op" id="7288888">.</span><span class="ident" id="7288889">VerifyHostname</span><span class="op" id="7288903">(</span><span class="string" id="7288904">&#34;mail.google.com&#34;</span><span class="op" id="7288921">)</span><span class="op" id="7288922">;</span>&nbsp;<span class="ident" id="7288924">err</span>&nbsp;<span class="op" id="7288928">!=</span>&nbsp;<span class="ident" id="7288931">nil</span>&nbsp;<span class="op" id="7288935">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288939">t</span><span class="op" id="7288940">.</span><span class="ident" id="7288941">Error</span><span class="op" id="7288946">(</span><span class="ident" id="7288947">err</span><span class="op" id="7288950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288957">const</span>&nbsp;<span class="ident" id="7288963">expectedExtensions</span>&nbsp;<span class="op" id="7288982">=</span>&nbsp;<span class="num" id="7288984">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288987">if</span>&nbsp;<span class="ident" id="7288990">n</span>&nbsp;<span class="op" id="7288992">:=</span>&nbsp;<span class="builtinfunc" id="7288995">len</span><span class="op" id="7288998">(</span><span class="ident" id="7288999">certs</span><span class="op" id="7289004">[</span><span class="num" id="7289005">0</span><span class="op" id="7289006">]</span><span class="op" id="7289007">.</span><span class="ident" id="7289008">Extensions</span><span class="op" id="7289018">)</span><span class="op" id="7289019">;</span>&nbsp;<span class="ident" id="7289021">n</span>&nbsp;<span class="op" id="7289023">!=</span>&nbsp;<span class="ident" id="7289026">expectedExtensions</span>&nbsp;<span class="op" id="7289045">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289049">t</span><span class="op" id="7289050">.</span><span class="ident" id="7289051">Errorf</span><span class="op" id="7289057">(</span><span class="string" id="7289058">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7289086">,</span>&nbsp;<span class="ident" id="7289088">expectedExtensions</span><span class="op" id="7289106">,</span>&nbsp;<span class="ident" id="7289108">n</span><span class="op" id="7289109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289112">}</span><br>
<span class="lineno"></span><span class="op" id="7289114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7289117">var</span>&nbsp;<span class="ident" id="7289121">certBytes</span>&nbsp;<span class="op" id="7289131">=</span>&nbsp;<span class="string" id="7289133">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7289214">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289217">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7289298">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289301">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7289382">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289385">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7289466">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289469">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7289550">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289553">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7289634">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289637">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7289718">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289721">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7289802">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289805">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7289886">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289889">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7289970">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289973">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7290054">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290057">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7290138">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290141">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7290222">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290225">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7290306">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290309">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7290390">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290393">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7290474">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290477">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7290558">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290561">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7290642">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290645">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7290726">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290729">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7290810">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290813">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7290894">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290897">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7290978">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290981">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7291062">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291065">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7291146">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291149">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7291230">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291233">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7291314">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291317">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7291398">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291401">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7291482">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291485">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7291566">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291569">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7291650">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291653">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7291734">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291737">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7291818">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291821">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7291902">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291905">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7291986">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291989">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7292070">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292073">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7292154">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292157">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7292238">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292241">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7292322">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292325">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7292406">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292409">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7292490">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292493">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7292574">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292577">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7292609">func</span>&nbsp;<span class="ident" id="7292614">TestCreateSelfSignedCertificate</span><span class="op" id="7292645">(</span><span class="ident" id="7292646">t</span>&nbsp;<span class="op" id="7292648">*</span><span class="ident" id="7292649">testing</span><span class="op" id="7292656">.</span><span class="ident" id="7292657">T</span><span class="op" id="7292658">)</span>&nbsp;<span class="op" id="7292660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292663">random</span>&nbsp;<span class="op" id="7292670">:=</span>&nbsp;<span class="ident" id="7292673">rand</span><span class="op" id="7292677">.</span><span class="ident" id="7292678">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292687">block</span><span class="op" id="7292692">,</span>&nbsp;<span class="ident" id="7292694">_</span>&nbsp;<span class="op" id="7292696">:=</span>&nbsp;<span class="ident" id="7292699">pem</span><span class="op" id="7292702">.</span><span class="ident" id="7292703">Decode</span><span class="op" id="7292709">(</span><span class="op" id="7292710">[</span><span class="op" id="7292711">]</span><span class="builtintype" id="7292712">byte</span><span class="op" id="7292716">(</span><span class="ident" id="7292717">pemPrivateKey</span><span class="op" id="7292730">)</span><span class="op" id="7292731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292734">rsaPriv</span><span class="op" id="7292741">,</span>&nbsp;<span class="ident" id="7292743">err</span>&nbsp;<span class="op" id="7292747">:=</span>&nbsp;<span class="ident" id="7292750">ParsePKCS1PrivateKey</span><span class="op" id="7292770">(</span><span class="ident" id="7292771">block</span><span class="op" id="7292776">.</span><span class="ident" id="7292777">Bytes</span><span class="op" id="7292782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292785">if</span>&nbsp;<span class="ident" id="7292788">err</span>&nbsp;<span class="op" id="7292792">!=</span>&nbsp;<span class="ident" id="7292795">nil</span>&nbsp;<span class="op" id="7292799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292803">t</span><span class="op" id="7292804">.</span><span class="ident" id="7292805">Fatalf</span><span class="op" id="7292811">(</span><span class="string" id="7292812">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7292845">,</span>&nbsp;<span class="ident" id="7292847">err</span><span class="op" id="7292850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292853">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292857">ecdsaPriv</span><span class="op" id="7292866">,</span>&nbsp;<span class="ident" id="7292868">err</span>&nbsp;<span class="op" id="7292872">:=</span>&nbsp;<span class="ident" id="7292875">ecdsa</span><span class="op" id="7292880">.</span><span class="ident" id="7292881">GenerateKey</span><span class="op" id="7292892">(</span><span class="ident" id="7292893">elliptic</span><span class="op" id="7292901">.</span><span class="ident" id="7292902">P256</span><span class="op" id="7292906">(</span><span class="op" id="7292907">)</span><span class="op" id="7292908">,</span>&nbsp;<span class="ident" id="7292910">rand</span><span class="op" id="7292914">.</span><span class="ident" id="7292915">Reader</span><span class="op" id="7292921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292924">if</span>&nbsp;<span class="ident" id="7292927">err</span>&nbsp;<span class="op" id="7292931">!=</span>&nbsp;<span class="ident" id="7292934">nil</span>&nbsp;<span class="op" id="7292938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292942">t</span><span class="op" id="7292943">.</span><span class="ident" id="7292944">Fatalf</span><span class="op" id="7292950">(</span><span class="string" id="7292951">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7292985">,</span>&nbsp;<span class="ident" id="7292987">err</span><span class="op" id="7292990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292993">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292997">tests</span>&nbsp;<span class="op" id="7293003">:=</span>&nbsp;<span class="op" id="7293006">[</span><span class="op" id="7293007">]</span><span class="keyword" id="7293008">struct</span>&nbsp;<span class="op" id="7293015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293019">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7293029">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293038">pub</span><span class="op" id="7293041">,</span>&nbsp;<span class="ident" id="7293043">priv</span>&nbsp;<span class="keyword" id="7293048">interface</span><span class="op" id="7293057">{</span><span class="op" id="7293058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293062">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7293072">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293079">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7293089">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293109">}</span><span class="op" id="7293110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293114">{</span><span class="string" id="7293115">&#34;RSA/RSA&#34;</span><span class="op" id="7293124">,</span>&nbsp;<span class="op" id="7293126">&amp;</span><span class="ident" id="7293127">rsaPriv</span><span class="op" id="7293134">.</span><span class="ident" id="7293135">PublicKey</span><span class="op" id="7293144">,</span>&nbsp;<span class="ident" id="7293146">rsaPriv</span><span class="op" id="7293153">,</span>&nbsp;<span class="builtintype" id="7293155">true</span><span class="op" id="7293159">,</span>&nbsp;<span class="ident" id="7293161">SHA1WithRSA</span><span class="op" id="7293172">}</span><span class="op" id="7293173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293177">{</span><span class="string" id="7293178">&#34;RSA/ECDSA&#34;</span><span class="op" id="7293189">,</span>&nbsp;<span class="op" id="7293191">&amp;</span><span class="ident" id="7293192">rsaPriv</span><span class="op" id="7293199">.</span><span class="ident" id="7293200">PublicKey</span><span class="op" id="7293209">,</span>&nbsp;<span class="ident" id="7293211">ecdsaPriv</span><span class="op" id="7293220">,</span>&nbsp;<span class="builtintype" id="7293222">false</span><span class="op" id="7293227">,</span>&nbsp;<span class="ident" id="7293229">ECDSAWithSHA384</span><span class="op" id="7293244">}</span><span class="op" id="7293245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293249">{</span><span class="string" id="7293250">&#34;ECDSA/RSA&#34;</span><span class="op" id="7293261">,</span>&nbsp;<span class="op" id="7293263">&amp;</span><span class="ident" id="7293264">ecdsaPriv</span><span class="op" id="7293273">.</span><span class="ident" id="7293274">PublicKey</span><span class="op" id="7293283">,</span>&nbsp;<span class="ident" id="7293285">rsaPriv</span><span class="op" id="7293292">,</span>&nbsp;<span class="builtintype" id="7293294">false</span><span class="op" id="7293299">,</span>&nbsp;<span class="ident" id="7293301">SHA256WithRSA</span><span class="op" id="7293314">}</span><span class="op" id="7293315">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293319">{</span><span class="string" id="7293320">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7293333">,</span>&nbsp;<span class="op" id="7293335">&amp;</span><span class="ident" id="7293336">ecdsaPriv</span><span class="op" id="7293345">.</span><span class="ident" id="7293346">PublicKey</span><span class="op" id="7293355">,</span>&nbsp;<span class="ident" id="7293357">ecdsaPriv</span><span class="op" id="7293366">,</span>&nbsp;<span class="builtintype" id="7293368">true</span><span class="op" id="7293372">,</span>&nbsp;<span class="ident" id="7293374">ECDSAWithSHA1</span><span class="op" id="7293387">}</span><span class="op" id="7293388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293395">testExtKeyUsage</span>&nbsp;<span class="op" id="7293411">:=</span>&nbsp;<span class="op" id="7293414">[</span><span class="op" id="7293415">]</span><span class="ident" id="7293416">ExtKeyUsage</span><span class="op" id="7293427">{</span><span class="ident" id="7293428">ExtKeyUsageClientAuth</span><span class="op" id="7293449">,</span>&nbsp;<span class="ident" id="7293451">ExtKeyUsageServerAuth</span><span class="op" id="7293472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293475">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7293498">:=</span>&nbsp;<span class="op" id="7293501">[</span><span class="op" id="7293502">]</span><span class="ident" id="7293503">asn1</span><span class="op" id="7293507">.</span><span class="ident" id="7293508">ObjectIdentifier</span><span class="op" id="7293524">{</span><span class="op" id="7293525">[</span><span class="op" id="7293526">]</span><span class="builtintype" id="7293527">int</span><span class="op" id="7293530">{</span><span class="num" id="7293531">1</span><span class="op" id="7293532">,</span>&nbsp;<span class="num" id="7293534">2</span><span class="op" id="7293535">,</span>&nbsp;<span class="num" id="7293537">3</span><span class="op" id="7293538">}</span><span class="op" id="7293539">,</span>&nbsp;<span class="op" id="7293541">[</span><span class="op" id="7293542">]</span><span class="builtintype" id="7293543">int</span><span class="op" id="7293546">{</span><span class="num" id="7293547">2</span><span class="op" id="7293548">,</span>&nbsp;<span class="num" id="7293550">59</span><span class="op" id="7293552">,</span>&nbsp;<span class="num" id="7293554">1</span><span class="op" id="7293555">}</span><span class="op" id="7293556">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293559">extraExtensionData</span>&nbsp;<span class="op" id="7293578">:=</span>&nbsp;<span class="op" id="7293581">[</span><span class="op" id="7293582">]</span><span class="builtintype" id="7293583">byte</span><span class="op" id="7293587">(</span><span class="string" id="7293588">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7293605">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293609">for</span>&nbsp;<span class="ident" id="7293613">_</span><span class="op" id="7293614">,</span>&nbsp;<span class="ident" id="7293616">test</span>&nbsp;<span class="op" id="7293621">:=</span>&nbsp;<span class="keyword" id="7293624">range</span>&nbsp;<span class="ident" id="7293630">tests</span>&nbsp;<span class="op" id="7293636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293640">commonName</span>&nbsp;<span class="op" id="7293651">:=</span>&nbsp;<span class="string" id="7293654">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293675">template</span>&nbsp;<span class="op" id="7293684">:=</span>&nbsp;<span class="ident" id="7293687">Certificate</span><span class="op" id="7293698">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293703">SerialNumber</span><span class="op" id="7293715">:</span>&nbsp;<span class="ident" id="7293717">big</span><span class="op" id="7293720">.</span><span class="ident" id="7293721">NewInt</span><span class="op" id="7293727">(</span><span class="num" id="7293728">1</span><span class="op" id="7293729">)</span><span class="op" id="7293730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293735">Subject</span><span class="op" id="7293742">:</span>&nbsp;<span class="ident" id="7293744">pkix</span><span class="op" id="7293748">.</span><span class="ident" id="7293749">Name</span><span class="op" id="7293753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293759">CommonName</span><span class="op" id="7293769">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7293773">commonName</span><span class="op" id="7293783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293789">Organization</span><span class="op" id="7293801">:</span>&nbsp;<span class="op" id="7293803">[</span><span class="op" id="7293804">]</span><span class="builtintype" id="7293805">string</span><span class="op" id="7293811">{</span><span class="string" id="7293812">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7293824">}</span><span class="op" id="7293825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293830">}</span><span class="op" id="7293831">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293836">NotBefore</span><span class="op" id="7293845">:</span>&nbsp;<span class="ident" id="7293847">time</span><span class="op" id="7293851">.</span><span class="ident" id="7293852">Unix</span><span class="op" id="7293856">(</span><span class="num" id="7293857">1000</span><span class="op" id="7293861">,</span>&nbsp;<span class="num" id="7293863">0</span><span class="op" id="7293864">)</span><span class="op" id="7293865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293870">NotAfter</span><span class="op" id="7293878">:</span>&nbsp;&nbsp;<span class="ident" id="7293881">time</span><span class="op" id="7293885">.</span><span class="ident" id="7293886">Unix</span><span class="op" id="7293890">(</span><span class="num" id="7293891">100000</span><span class="op" id="7293897">,</span>&nbsp;<span class="num" id="7293899">0</span><span class="op" id="7293900">)</span><span class="op" id="7293901">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293907">SignatureAlgorithm</span><span class="op" id="7293925">:</span>&nbsp;<span class="ident" id="7293927">test</span><span class="op" id="7293931">.</span><span class="ident" id="7293932">sigAlgo</span><span class="op" id="7293939">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293945">SubjectKeyId</span><span class="op" id="7293957">:</span>&nbsp;<span class="op" id="7293959">[</span><span class="op" id="7293960">]</span><span class="builtintype" id="7293961">byte</span><span class="op" id="7293965">{</span><span class="num" id="7293966">1</span><span class="op" id="7293967">,</span>&nbsp;<span class="num" id="7293969">2</span><span class="op" id="7293970">,</span>&nbsp;<span class="num" id="7293972">3</span><span class="op" id="7293973">,</span>&nbsp;<span class="num" id="7293975">4</span><span class="op" id="7293976">}</span><span class="op" id="7293977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293982">KeyUsage</span><span class="op" id="7293990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7293996">KeyUsageCertSign</span><span class="op" id="7294012">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294018">ExtKeyUsage</span><span class="op" id="7294029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7294038">testExtKeyUsage</span><span class="op" id="7294053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294058">UnknownExtKeyUsage</span><span class="op" id="7294076">:</span>&nbsp;<span class="ident" id="7294078">testUnknownExtKeyUsage</span><span class="op" id="7294100">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294106">BasicConstraintsValid</span><span class="op" id="7294127">:</span>&nbsp;<span class="builtintype" id="7294129">true</span><span class="op" id="7294133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294138">IsCA</span><span class="op" id="7294142">:</span>&nbsp;<span class="builtintype" id="7294144">true</span><span class="op" id="7294148">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294154">OCSPServer</span><span class="op" id="7294164">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7294177">[</span><span class="op" id="7294178">]</span><span class="builtintype" id="7294179">string</span><span class="op" id="7294185">{</span><span class="string" id="7294186">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7294211">}</span><span class="op" id="7294212">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294217">IssuingCertificateURL</span><span class="op" id="7294238">:</span>&nbsp;<span class="op" id="7294240">[</span><span class="op" id="7294241">]</span><span class="builtintype" id="7294242">string</span><span class="op" id="7294248">{</span><span class="string" id="7294249">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7294281">}</span><span class="op" id="7294282">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294288">DNSNames</span><span class="op" id="7294296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7294304">[</span><span class="op" id="7294305">]</span><span class="builtintype" id="7294306">string</span><span class="op" id="7294312">{</span><span class="string" id="7294313">&#34;test.example.com&#34;</span><span class="op" id="7294331">}</span><span class="op" id="7294332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294337">EmailAddresses</span><span class="op" id="7294351">:</span>&nbsp;<span class="op" id="7294353">[</span><span class="op" id="7294354">]</span><span class="builtintype" id="7294355">string</span><span class="op" id="7294361">{</span><span class="string" id="7294362">&#34;gopher@golang.org&#34;</span><span class="op" id="7294381">}</span><span class="op" id="7294382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294387">IPAddresses</span><span class="op" id="7294398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7294403">[</span><span class="op" id="7294404">]</span><span class="ident" id="7294405">net</span><span class="op" id="7294408">.</span><span class="ident" id="7294409">IP</span><span class="op" id="7294411">{</span><span class="ident" id="7294412">net</span><span class="op" id="7294415">.</span><span class="ident" id="7294416">IPv4</span><span class="op" id="7294420">(</span><span class="num" id="7294421">127</span><span class="op" id="7294424">,</span>&nbsp;<span class="num" id="7294426">0</span><span class="op" id="7294427">,</span>&nbsp;<span class="num" id="7294429">0</span><span class="op" id="7294430">,</span>&nbsp;<span class="num" id="7294432">1</span><span class="op" id="7294433">)</span><span class="op" id="7294434">.</span><span class="ident" id="7294435">To4</span><span class="op" id="7294438">(</span><span class="op" id="7294439">)</span><span class="op" id="7294440">,</span>&nbsp;<span class="ident" id="7294442">net</span><span class="op" id="7294445">.</span><span class="ident" id="7294446">ParseIP</span><span class="op" id="7294453">(</span><span class="string" id="7294454">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7294476">)</span><span class="op" id="7294477">}</span><span class="op" id="7294478">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294484">PolicyIdentifiers</span><span class="op" id="7294501">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7294505">[</span><span class="op" id="7294506">]</span><span class="ident" id="7294507">asn1</span><span class="op" id="7294511">.</span><span class="ident" id="7294512">ObjectIdentifier</span><span class="op" id="7294528">{</span><span class="op" id="7294529">[</span><span class="op" id="7294530">]</span><span class="builtintype" id="7294531">int</span><span class="op" id="7294534">{</span><span class="num" id="7294535">1</span><span class="op" id="7294536">,</span>&nbsp;<span class="num" id="7294538">2</span><span class="op" id="7294539">,</span>&nbsp;<span class="num" id="7294541">3</span><span class="op" id="7294542">}</span><span class="op" id="7294543">}</span><span class="op" id="7294544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294549">PermittedDNSDomains</span><span class="op" id="7294568">:</span>&nbsp;<span class="op" id="7294570">[</span><span class="op" id="7294571">]</span><span class="builtintype" id="7294572">string</span><span class="op" id="7294578">{</span><span class="string" id="7294579">&#34;.example.com&#34;</span><span class="op" id="7294593">,</span>&nbsp;<span class="string" id="7294595">&#34;example.com&#34;</span><span class="op" id="7294608">}</span><span class="op" id="7294609">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294615">CRLDistributionPoints</span><span class="op" id="7294636">:</span>&nbsp;<span class="op" id="7294638">[</span><span class="op" id="7294639">]</span><span class="builtintype" id="7294640">string</span><span class="op" id="7294646">{</span><span class="string" id="7294647">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7294680">,</span>&nbsp;<span class="string" id="7294682">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7294715">}</span><span class="op" id="7294716">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294722">ExtraExtensions</span><span class="op" id="7294737">:</span>&nbsp;<span class="op" id="7294739">[</span><span class="op" id="7294740">]</span><span class="ident" id="7294741">pkix</span><span class="op" id="7294745">.</span><span class="ident" id="7294746">Extension</span><span class="op" id="7294755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294768">Id</span><span class="op" id="7294770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7294775">[</span><span class="op" id="7294776">]</span><span class="builtintype" id="7294777">int</span><span class="op" id="7294780">{</span><span class="num" id="7294781">1</span><span class="op" id="7294782">,</span>&nbsp;<span class="num" id="7294784">2</span><span class="op" id="7294785">,</span>&nbsp;<span class="num" id="7294787">3</span><span class="op" id="7294788">,</span>&nbsp;<span class="num" id="7294790">4</span><span class="op" id="7294791">}</span><span class="op" id="7294792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294799">Value</span><span class="op" id="7294804">:</span>&nbsp;<span class="ident" id="7294806">extraExtensionData</span><span class="op" id="7294824">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294830">}</span><span class="op" id="7294831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294837">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294907">Id</span><span class="op" id="7294909">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7294917">oidExtensionSubjectKeyId</span><span class="op" id="7294941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294948">Critical</span><span class="op" id="7294956">:</span>&nbsp;<span class="builtintype" id="7294958">false</span><span class="op" id="7294963">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294970">Value</span><span class="op" id="7294975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7294980">[</span><span class="op" id="7294981">]</span><span class="builtintype" id="7294982">byte</span><span class="op" id="7294986">{</span><span class="num" id="7294987">0x04</span><span class="op" id="7294991">,</span>&nbsp;<span class="num" id="7294993">0x04</span><span class="op" id="7294997">,</span>&nbsp;<span class="num" id="7294999">4</span><span class="op" id="7295000">,</span>&nbsp;<span class="num" id="7295002">3</span><span class="op" id="7295003">,</span>&nbsp;<span class="num" id="7295005">2</span><span class="op" id="7295006">,</span>&nbsp;<span class="num" id="7295008">1</span><span class="op" id="7295009">}</span><span class="op" id="7295010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295016">}</span><span class="op" id="7295017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295022">}</span><span class="op" id="7295023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295032">derBytes</span><span class="op" id="7295040">,</span>&nbsp;<span class="ident" id="7295042">err</span>&nbsp;<span class="op" id="7295046">:=</span>&nbsp;<span class="ident" id="7295049">CreateCertificate</span><span class="op" id="7295066">(</span><span class="ident" id="7295067">random</span><span class="op" id="7295073">,</span>&nbsp;<span class="op" id="7295075">&amp;</span><span class="ident" id="7295076">template</span><span class="op" id="7295084">,</span>&nbsp;<span class="op" id="7295086">&amp;</span><span class="ident" id="7295087">template</span><span class="op" id="7295095">,</span>&nbsp;<span class="ident" id="7295097">test</span><span class="op" id="7295101">.</span><span class="ident" id="7295102">pub</span><span class="op" id="7295105">,</span>&nbsp;<span class="ident" id="7295107">test</span><span class="op" id="7295111">.</span><span class="ident" id="7295112">priv</span><span class="op" id="7295116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295120">if</span>&nbsp;<span class="ident" id="7295123">err</span>&nbsp;<span class="op" id="7295127">!=</span>&nbsp;<span class="ident" id="7295130">nil</span>&nbsp;<span class="op" id="7295134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295139">t</span><span class="op" id="7295140">.</span><span class="ident" id="7295141">Errorf</span><span class="op" id="7295147">(</span><span class="string" id="7295148">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7295186">,</span>&nbsp;<span class="ident" id="7295188">test</span><span class="op" id="7295192">.</span><span class="ident" id="7295193">name</span><span class="op" id="7295197">,</span>&nbsp;<span class="ident" id="7295199">err</span><span class="op" id="7295202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295207">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295218">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295223">cert</span><span class="op" id="7295227">,</span>&nbsp;<span class="ident" id="7295229">err</span>&nbsp;<span class="op" id="7295233">:=</span>&nbsp;<span class="ident" id="7295236">ParseCertificate</span><span class="op" id="7295252">(</span><span class="ident" id="7295253">derBytes</span><span class="op" id="7295261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295265">if</span>&nbsp;<span class="ident" id="7295268">err</span>&nbsp;<span class="op" id="7295272">!=</span>&nbsp;<span class="ident" id="7295275">nil</span>&nbsp;<span class="op" id="7295279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295284">t</span><span class="op" id="7295285">.</span><span class="ident" id="7295286">Errorf</span><span class="op" id="7295292">(</span><span class="string" id="7295293">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7295330">,</span>&nbsp;<span class="ident" id="7295332">test</span><span class="op" id="7295336">.</span><span class="ident" id="7295337">name</span><span class="op" id="7295341">,</span>&nbsp;<span class="ident" id="7295343">err</span><span class="op" id="7295346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295351">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295367">if</span>&nbsp;<span class="builtinfunc" id="7295370">len</span><span class="op" id="7295373">(</span><span class="ident" id="7295374">cert</span><span class="op" id="7295378">.</span><span class="ident" id="7295379">PolicyIdentifiers</span><span class="op" id="7295396">)</span>&nbsp;<span class="op" id="7295398">!=</span>&nbsp;<span class="num" id="7295401">1</span>&nbsp;<span class="op" id="7295403">||</span>&nbsp;<span class="op" id="7295406">!</span><span class="ident" id="7295407">cert</span><span class="op" id="7295411">.</span><span class="ident" id="7295412">PolicyIdentifiers</span><span class="op" id="7295429">[</span><span class="num" id="7295430">0</span><span class="op" id="7295431">]</span><span class="op" id="7295432">.</span><span class="ident" id="7295433">Equal</span><span class="op" id="7295438">(</span><span class="ident" id="7295439">template</span><span class="op" id="7295447">.</span><span class="ident" id="7295448">PolicyIdentifiers</span><span class="op" id="7295465">[</span><span class="num" id="7295466">0</span><span class="op" id="7295467">]</span><span class="op" id="7295468">)</span>&nbsp;<span class="op" id="7295470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295475">t</span><span class="op" id="7295476">.</span><span class="ident" id="7295477">Errorf</span><span class="op" id="7295483">(</span><span class="string" id="7295484">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7295542">,</span>&nbsp;<span class="ident" id="7295544">test</span><span class="op" id="7295548">.</span><span class="ident" id="7295549">name</span><span class="op" id="7295553">,</span>&nbsp;<span class="ident" id="7295555">cert</span><span class="op" id="7295559">.</span><span class="ident" id="7295560">PolicyIdentifiers</span><span class="op" id="7295577">,</span>&nbsp;<span class="ident" id="7295579">template</span><span class="op" id="7295587">.</span><span class="ident" id="7295588">PolicyIdentifiers</span><span class="op" id="7295605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295609">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295614">if</span>&nbsp;<span class="builtinfunc" id="7295617">len</span><span class="op" id="7295620">(</span><span class="ident" id="7295621">cert</span><span class="op" id="7295625">.</span><span class="ident" id="7295626">PermittedDNSDomains</span><span class="op" id="7295645">)</span>&nbsp;<span class="op" id="7295647">!=</span>&nbsp;<span class="num" id="7295650">2</span>&nbsp;<span class="op" id="7295652">||</span>&nbsp;<span class="ident" id="7295655">cert</span><span class="op" id="7295659">.</span><span class="ident" id="7295660">PermittedDNSDomains</span><span class="op" id="7295679">[</span><span class="num" id="7295680">0</span><span class="op" id="7295681">]</span>&nbsp;<span class="op" id="7295683">!=</span>&nbsp;<span class="string" id="7295686">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7295701">||</span>&nbsp;<span class="ident" id="7295704">cert</span><span class="op" id="7295708">.</span><span class="ident" id="7295709">PermittedDNSDomains</span><span class="op" id="7295728">[</span><span class="num" id="7295729">1</span><span class="op" id="7295730">]</span>&nbsp;<span class="op" id="7295732">!=</span>&nbsp;<span class="string" id="7295735">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7295749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295754">t</span><span class="op" id="7295755">.</span><span class="ident" id="7295756">Errorf</span><span class="op" id="7295762">(</span><span class="string" id="7295763">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7295806">,</span>&nbsp;<span class="ident" id="7295808">test</span><span class="op" id="7295812">.</span><span class="ident" id="7295813">name</span><span class="op" id="7295817">,</span>&nbsp;<span class="ident" id="7295819">cert</span><span class="op" id="7295823">.</span><span class="ident" id="7295824">PermittedDNSDomains</span><span class="op" id="7295843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295852">if</span>&nbsp;<span class="ident" id="7295855">cert</span><span class="op" id="7295859">.</span><span class="ident" id="7295860">Subject</span><span class="op" id="7295867">.</span><span class="ident" id="7295868">CommonName</span>&nbsp;<span class="op" id="7295879">!=</span>&nbsp;<span class="ident" id="7295882">commonName</span>&nbsp;<span class="op" id="7295893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295898">t</span><span class="op" id="7295899">.</span><span class="ident" id="7295900">Errorf</span><span class="op" id="7295906">(</span><span class="string" id="7295907">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7295979">,</span>&nbsp;<span class="ident" id="7295981">test</span><span class="op" id="7295985">.</span><span class="ident" id="7295986">name</span><span class="op" id="7295990">,</span>&nbsp;<span class="ident" id="7295992">cert</span><span class="op" id="7295996">.</span><span class="ident" id="7295997">Subject</span><span class="op" id="7296004">.</span><span class="ident" id="7296005">CommonName</span><span class="op" id="7296015">,</span>&nbsp;<span class="ident" id="7296017">commonName</span><span class="op" id="7296027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296036">if</span>&nbsp;<span class="ident" id="7296039">cert</span><span class="op" id="7296043">.</span><span class="ident" id="7296044">Issuer</span><span class="op" id="7296050">.</span><span class="ident" id="7296051">CommonName</span>&nbsp;<span class="op" id="7296062">!=</span>&nbsp;<span class="ident" id="7296065">commonName</span>&nbsp;<span class="op" id="7296076">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296081">t</span><span class="op" id="7296082">.</span><span class="ident" id="7296083">Errorf</span><span class="op" id="7296089">(</span><span class="string" id="7296090">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7296161">,</span>&nbsp;<span class="ident" id="7296163">test</span><span class="op" id="7296167">.</span><span class="ident" id="7296168">name</span><span class="op" id="7296172">,</span>&nbsp;<span class="ident" id="7296174">cert</span><span class="op" id="7296178">.</span><span class="ident" id="7296179">Issuer</span><span class="op" id="7296185">.</span><span class="ident" id="7296186">CommonName</span><span class="op" id="7296196">,</span>&nbsp;<span class="ident" id="7296198">commonName</span><span class="op" id="7296208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296217">if</span>&nbsp;<span class="ident" id="7296220">cert</span><span class="op" id="7296224">.</span><span class="ident" id="7296225">SignatureAlgorithm</span>&nbsp;<span class="op" id="7296244">!=</span>&nbsp;<span class="ident" id="7296247">test</span><span class="op" id="7296251">.</span><span class="ident" id="7296252">sigAlgo</span>&nbsp;<span class="op" id="7296260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296265">t</span><span class="op" id="7296266">.</span><span class="ident" id="7296267">Errorf</span><span class="op" id="7296273">(</span><span class="string" id="7296274">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7296343">,</span>&nbsp;<span class="ident" id="7296345">test</span><span class="op" id="7296349">.</span><span class="ident" id="7296350">name</span><span class="op" id="7296354">,</span>&nbsp;<span class="ident" id="7296356">cert</span><span class="op" id="7296360">.</span><span class="ident" id="7296361">SignatureAlgorithm</span><span class="op" id="7296379">,</span>&nbsp;<span class="ident" id="7296381">test</span><span class="op" id="7296385">.</span><span class="ident" id="7296386">sigAlgo</span><span class="op" id="7296393">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296402">if</span>&nbsp;<span class="op" id="7296405">!</span><span class="ident" id="7296406">reflect</span><span class="op" id="7296413">.</span><span class="ident" id="7296414">DeepEqual</span><span class="op" id="7296423">(</span><span class="ident" id="7296424">cert</span><span class="op" id="7296428">.</span><span class="ident" id="7296429">ExtKeyUsage</span><span class="op" id="7296440">,</span>&nbsp;<span class="ident" id="7296442">testExtKeyUsage</span><span class="op" id="7296457">)</span>&nbsp;<span class="op" id="7296459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296464">t</span><span class="op" id="7296465">.</span><span class="ident" id="7296466">Errorf</span><span class="op" id="7296472">(</span><span class="string" id="7296473">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7296549">,</span>&nbsp;<span class="ident" id="7296551">test</span><span class="op" id="7296555">.</span><span class="ident" id="7296556">name</span><span class="op" id="7296560">,</span>&nbsp;<span class="ident" id="7296562">cert</span><span class="op" id="7296566">.</span><span class="ident" id="7296567">ExtKeyUsage</span><span class="op" id="7296578">,</span>&nbsp;<span class="ident" id="7296580">testExtKeyUsage</span><span class="op" id="7296595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296599">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296604">if</span>&nbsp;<span class="op" id="7296607">!</span><span class="ident" id="7296608">reflect</span><span class="op" id="7296615">.</span><span class="ident" id="7296616">DeepEqual</span><span class="op" id="7296625">(</span><span class="ident" id="7296626">cert</span><span class="op" id="7296630">.</span><span class="ident" id="7296631">UnknownExtKeyUsage</span><span class="op" id="7296649">,</span>&nbsp;<span class="ident" id="7296651">testUnknownExtKeyUsage</span><span class="op" id="7296673">)</span>&nbsp;<span class="op" id="7296675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296680">t</span><span class="op" id="7296681">.</span><span class="ident" id="7296682">Errorf</span><span class="op" id="7296688">(</span><span class="string" id="7296689">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7296773">,</span>&nbsp;<span class="ident" id="7296775">test</span><span class="op" id="7296779">.</span><span class="ident" id="7296780">name</span><span class="op" id="7296784">,</span>&nbsp;<span class="ident" id="7296786">cert</span><span class="op" id="7296790">.</span><span class="ident" id="7296791">UnknownExtKeyUsage</span><span class="op" id="7296809">,</span>&nbsp;<span class="ident" id="7296811">testUnknownExtKeyUsage</span><span class="op" id="7296833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296842">if</span>&nbsp;<span class="op" id="7296845">!</span><span class="ident" id="7296846">reflect</span><span class="op" id="7296853">.</span><span class="ident" id="7296854">DeepEqual</span><span class="op" id="7296863">(</span><span class="ident" id="7296864">cert</span><span class="op" id="7296868">.</span><span class="ident" id="7296869">OCSPServer</span><span class="op" id="7296879">,</span>&nbsp;<span class="ident" id="7296881">template</span><span class="op" id="7296889">.</span><span class="ident" id="7296890">OCSPServer</span><span class="op" id="7296900">)</span>&nbsp;<span class="op" id="7296902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296907">t</span><span class="op" id="7296908">.</span><span class="ident" id="7296909">Errorf</span><span class="op" id="7296915">(</span><span class="string" id="7296916">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7296972">,</span>&nbsp;<span class="ident" id="7296974">test</span><span class="op" id="7296978">.</span><span class="ident" id="7296979">name</span><span class="op" id="7296983">,</span>&nbsp;<span class="ident" id="7296985">cert</span><span class="op" id="7296989">.</span><span class="ident" id="7296990">OCSPServer</span><span class="op" id="7297000">,</span>&nbsp;<span class="ident" id="7297002">template</span><span class="op" id="7297010">.</span><span class="ident" id="7297011">OCSPServer</span><span class="op" id="7297021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297030">if</span>&nbsp;<span class="op" id="7297033">!</span><span class="ident" id="7297034">reflect</span><span class="op" id="7297041">.</span><span class="ident" id="7297042">DeepEqual</span><span class="op" id="7297051">(</span><span class="ident" id="7297052">cert</span><span class="op" id="7297056">.</span><span class="ident" id="7297057">IssuingCertificateURL</span><span class="op" id="7297078">,</span>&nbsp;<span class="ident" id="7297080">template</span><span class="op" id="7297088">.</span><span class="ident" id="7297089">IssuingCertificateURL</span><span class="op" id="7297110">)</span>&nbsp;<span class="op" id="7297112">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297117">t</span><span class="op" id="7297118">.</span><span class="ident" id="7297119">Errorf</span><span class="op" id="7297125">(</span><span class="string" id="7297126">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7297194">,</span>&nbsp;<span class="ident" id="7297196">test</span><span class="op" id="7297200">.</span><span class="ident" id="7297201">name</span><span class="op" id="7297205">,</span>&nbsp;<span class="ident" id="7297207">cert</span><span class="op" id="7297211">.</span><span class="ident" id="7297212">IssuingCertificateURL</span><span class="op" id="7297233">,</span>&nbsp;<span class="ident" id="7297235">template</span><span class="op" id="7297243">.</span><span class="ident" id="7297244">IssuingCertificateURL</span><span class="op" id="7297265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297274">if</span>&nbsp;<span class="op" id="7297277">!</span><span class="ident" id="7297278">reflect</span><span class="op" id="7297285">.</span><span class="ident" id="7297286">DeepEqual</span><span class="op" id="7297295">(</span><span class="ident" id="7297296">cert</span><span class="op" id="7297300">.</span><span class="ident" id="7297301">DNSNames</span><span class="op" id="7297309">,</span>&nbsp;<span class="ident" id="7297311">template</span><span class="op" id="7297319">.</span><span class="ident" id="7297320">DNSNames</span><span class="op" id="7297328">)</span>&nbsp;<span class="op" id="7297330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297335">t</span><span class="op" id="7297336">.</span><span class="ident" id="7297337">Errorf</span><span class="op" id="7297343">(</span><span class="string" id="7297344">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7297401">,</span>&nbsp;<span class="ident" id="7297403">test</span><span class="op" id="7297407">.</span><span class="ident" id="7297408">name</span><span class="op" id="7297412">,</span>&nbsp;<span class="ident" id="7297414">cert</span><span class="op" id="7297418">.</span><span class="ident" id="7297419">DNSNames</span><span class="op" id="7297427">,</span>&nbsp;<span class="ident" id="7297429">template</span><span class="op" id="7297437">.</span><span class="ident" id="7297438">DNSNames</span><span class="op" id="7297446">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297455">if</span>&nbsp;<span class="op" id="7297458">!</span><span class="ident" id="7297459">reflect</span><span class="op" id="7297466">.</span><span class="ident" id="7297467">DeepEqual</span><span class="op" id="7297476">(</span><span class="ident" id="7297477">cert</span><span class="op" id="7297481">.</span><span class="ident" id="7297482">EmailAddresses</span><span class="op" id="7297496">,</span>&nbsp;<span class="ident" id="7297498">template</span><span class="op" id="7297506">.</span><span class="ident" id="7297507">EmailAddresses</span><span class="op" id="7297521">)</span>&nbsp;<span class="op" id="7297523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297528">t</span><span class="op" id="7297529">.</span><span class="ident" id="7297530">Errorf</span><span class="op" id="7297536">(</span><span class="string" id="7297537">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7297591">,</span>&nbsp;<span class="ident" id="7297593">test</span><span class="op" id="7297597">.</span><span class="ident" id="7297598">name</span><span class="op" id="7297602">,</span>&nbsp;<span class="ident" id="7297604">cert</span><span class="op" id="7297608">.</span><span class="ident" id="7297609">EmailAddresses</span><span class="op" id="7297623">,</span>&nbsp;<span class="ident" id="7297625">template</span><span class="op" id="7297633">.</span><span class="ident" id="7297634">EmailAddresses</span><span class="op" id="7297648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297652">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297657">if</span>&nbsp;<span class="op" id="7297660">!</span><span class="ident" id="7297661">reflect</span><span class="op" id="7297668">.</span><span class="ident" id="7297669">DeepEqual</span><span class="op" id="7297678">(</span><span class="ident" id="7297679">cert</span><span class="op" id="7297683">.</span><span class="ident" id="7297684">IPAddresses</span><span class="op" id="7297695">,</span>&nbsp;<span class="ident" id="7297697">template</span><span class="op" id="7297705">.</span><span class="ident" id="7297706">IPAddresses</span><span class="op" id="7297717">)</span>&nbsp;<span class="op" id="7297719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297724">t</span><span class="op" id="7297725">.</span><span class="ident" id="7297726">Errorf</span><span class="op" id="7297732">(</span><span class="string" id="7297733">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7297784">,</span>&nbsp;<span class="ident" id="7297786">test</span><span class="op" id="7297790">.</span><span class="ident" id="7297791">name</span><span class="op" id="7297795">,</span>&nbsp;<span class="ident" id="7297797">cert</span><span class="op" id="7297801">.</span><span class="ident" id="7297802">IPAddresses</span><span class="op" id="7297813">,</span>&nbsp;<span class="ident" id="7297815">template</span><span class="op" id="7297823">.</span><span class="ident" id="7297824">IPAddresses</span><span class="op" id="7297835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297844">if</span>&nbsp;<span class="op" id="7297847">!</span><span class="ident" id="7297848">reflect</span><span class="op" id="7297855">.</span><span class="ident" id="7297856">DeepEqual</span><span class="op" id="7297865">(</span><span class="ident" id="7297866">cert</span><span class="op" id="7297870">.</span><span class="ident" id="7297871">CRLDistributionPoints</span><span class="op" id="7297892">,</span>&nbsp;<span class="ident" id="7297894">template</span><span class="op" id="7297902">.</span><span class="ident" id="7297903">CRLDistributionPoints</span><span class="op" id="7297924">)</span>&nbsp;<span class="op" id="7297926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297931">t</span><span class="op" id="7297932">.</span><span class="ident" id="7297933">Errorf</span><span class="op" id="7297939">(</span><span class="string" id="7297940">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7298007">,</span>&nbsp;<span class="ident" id="7298009">test</span><span class="op" id="7298013">.</span><span class="ident" id="7298014">name</span><span class="op" id="7298018">,</span>&nbsp;<span class="ident" id="7298020">cert</span><span class="op" id="7298024">.</span><span class="ident" id="7298025">CRLDistributionPoints</span><span class="op" id="7298046">,</span>&nbsp;<span class="ident" id="7298048">template</span><span class="op" id="7298056">.</span><span class="ident" id="7298057">CRLDistributionPoints</span><span class="op" id="7298078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298087">if</span>&nbsp;<span class="op" id="7298090">!</span><span class="ident" id="7298091">bytes</span><span class="op" id="7298096">.</span><span class="ident" id="7298097">Equal</span><span class="op" id="7298102">(</span><span class="ident" id="7298103">cert</span><span class="op" id="7298107">.</span><span class="ident" id="7298108">SubjectKeyId</span><span class="op" id="7298120">,</span>&nbsp;<span class="op" id="7298122">[</span><span class="op" id="7298123">]</span><span class="builtintype" id="7298124">byte</span><span class="op" id="7298128">{</span><span class="num" id="7298129">4</span><span class="op" id="7298130">,</span>&nbsp;<span class="num" id="7298132">3</span><span class="op" id="7298133">,</span>&nbsp;<span class="num" id="7298135">2</span><span class="op" id="7298136">,</span>&nbsp;<span class="num" id="7298138">1</span><span class="op" id="7298139">}</span><span class="op" id="7298140">)</span>&nbsp;<span class="op" id="7298142">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298147">t</span><span class="op" id="7298148">.</span><span class="ident" id="7298149">Errorf</span><span class="op" id="7298155">(</span><span class="string" id="7298156">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7298206">,</span>&nbsp;<span class="ident" id="7298208">test</span><span class="op" id="7298212">.</span><span class="ident" id="7298213">name</span><span class="op" id="7298217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298226">if</span>&nbsp;<span class="ident" id="7298229">bytes</span><span class="op" id="7298234">.</span><span class="ident" id="7298235">Index</span><span class="op" id="7298240">(</span><span class="ident" id="7298241">derBytes</span><span class="op" id="7298249">,</span>&nbsp;<span class="ident" id="7298251">extraExtensionData</span><span class="op" id="7298269">)</span>&nbsp;<span class="op" id="7298271">==</span>&nbsp;<span class="op" id="7298274">-</span><span class="num" id="7298275">1</span>&nbsp;<span class="op" id="7298277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298282">t</span><span class="op" id="7298283">.</span><span class="ident" id="7298284">Errorf</span><span class="op" id="7298290">(</span><span class="string" id="7298291">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7298338">,</span>&nbsp;<span class="ident" id="7298340">test</span><span class="op" id="7298344">.</span><span class="ident" id="7298345">name</span><span class="op" id="7298349">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298358">if</span>&nbsp;<span class="ident" id="7298361">test</span><span class="op" id="7298365">.</span><span class="ident" id="7298366">checkSig</span>&nbsp;<span class="op" id="7298375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298380">err</span>&nbsp;<span class="op" id="7298384">=</span>&nbsp;<span class="ident" id="7298386">cert</span><span class="op" id="7298390">.</span><span class="ident" id="7298391">CheckSignatureFrom</span><span class="op" id="7298409">(</span><span class="ident" id="7298410">cert</span><span class="op" id="7298414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298419">if</span>&nbsp;<span class="ident" id="7298422">err</span>&nbsp;<span class="op" id="7298426">!=</span>&nbsp;<span class="ident" id="7298429">nil</span>&nbsp;<span class="op" id="7298433">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298439">t</span><span class="op" id="7298440">.</span><span class="ident" id="7298441">Errorf</span><span class="op" id="7298447">(</span><span class="string" id="7298448">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7298487">,</span>&nbsp;<span class="ident" id="7298489">test</span><span class="op" id="7298493">.</span><span class="ident" id="7298494">name</span><span class="op" id="7298498">,</span>&nbsp;<span class="ident" id="7298500">err</span><span class="op" id="7298503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298515">}</span><br>
<span class="lineno"></span><span class="op" id="7298517">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7298520">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7298581">var</span>&nbsp;<span class="ident" id="7298585">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7298602">=</span>&nbsp;<span class="string" id="7298604">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7299383">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7299446">var</span>&nbsp;<span class="ident" id="7299450">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7299473">=</span>&nbsp;<span class="string" id="7299475">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7300254">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7300317">var</span>&nbsp;<span class="ident" id="7300321">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7300344">=</span>&nbsp;<span class="string" id="7300346">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7301206">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7301269">var</span>&nbsp;<span class="ident" id="7301273">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7301296">=</span>&nbsp;<span class="string" id="7301298">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7302259">var</span>&nbsp;<span class="ident" id="7302263">ecdsaTests</span>&nbsp;<span class="op" id="7302274">=</span>&nbsp;<span class="op" id="7302276">[</span><span class="op" id="7302277">]</span><span class="keyword" id="7302278">struct</span>&nbsp;<span class="op" id="7302285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302288">sigAlgo</span>&nbsp;<span class="ident" id="7302296">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302316">pemCert</span>&nbsp;<span class="builtintype" id="7302324">string</span><br>
<span class="lineno"></span><span class="op" id="7302331">}</span><span class="op" id="7302332">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302335">{</span><span class="ident" id="7302336">ECDSAWithSHA1</span><span class="op" id="7302349">,</span>&nbsp;<span class="ident" id="7302351">ecdsaSHA1CertPem</span><span class="op" id="7302367">}</span><span class="op" id="7302368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302371">{</span><span class="ident" id="7302372">ECDSAWithSHA256</span><span class="op" id="7302387">,</span>&nbsp;<span class="ident" id="7302389">ecdsaSHA256p256CertPem</span><span class="op" id="7302411">}</span><span class="op" id="7302412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302415">{</span><span class="ident" id="7302416">ECDSAWithSHA256</span><span class="op" id="7302431">,</span>&nbsp;<span class="ident" id="7302433">ecdsaSHA256p384CertPem</span><span class="op" id="7302455">}</span><span class="op" id="7302456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302459">{</span><span class="ident" id="7302460">ECDSAWithSHA384</span><span class="op" id="7302475">,</span>&nbsp;<span class="ident" id="7302477">ecdsaSHA384p521CertPem</span><span class="op" id="7302499">}</span><span class="op" id="7302500">,</span><br>
<span class="lineno"></span><span class="op" id="7302502">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7302505">func</span>&nbsp;<span class="ident" id="7302510">TestECDSA</span><span class="op" id="7302519">(</span><span class="ident" id="7302520">t</span>&nbsp;<span class="op" id="7302522">*</span><span class="ident" id="7302523">testing</span><span class="op" id="7302530">.</span><span class="ident" id="7302531">T</span><span class="op" id="7302532">)</span>&nbsp;<span class="op" id="7302534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302537">for</span>&nbsp;<span class="ident" id="7302541">i</span><span class="op" id="7302542">,</span>&nbsp;<span class="ident" id="7302544">test</span>&nbsp;<span class="op" id="7302549">:=</span>&nbsp;<span class="keyword" id="7302552">range</span>&nbsp;<span class="ident" id="7302558">ecdsaTests</span>&nbsp;<span class="op" id="7302569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302573">pemBlock</span><span class="op" id="7302581">,</span>&nbsp;<span class="ident" id="7302583">_</span>&nbsp;<span class="op" id="7302585">:=</span>&nbsp;<span class="ident" id="7302588">pem</span><span class="op" id="7302591">.</span><span class="ident" id="7302592">Decode</span><span class="op" id="7302598">(</span><span class="op" id="7302599">[</span><span class="op" id="7302600">]</span><span class="builtintype" id="7302601">byte</span><span class="op" id="7302605">(</span><span class="ident" id="7302606">test</span><span class="op" id="7302610">.</span><span class="ident" id="7302611">pemCert</span><span class="op" id="7302618">)</span><span class="op" id="7302619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302623">cert</span><span class="op" id="7302627">,</span>&nbsp;<span class="ident" id="7302629">err</span>&nbsp;<span class="op" id="7302633">:=</span>&nbsp;<span class="ident" id="7302636">ParseCertificate</span><span class="op" id="7302652">(</span><span class="ident" id="7302653">pemBlock</span><span class="op" id="7302661">.</span><span class="ident" id="7302662">Bytes</span><span class="op" id="7302667">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302671">if</span>&nbsp;<span class="ident" id="7302674">err</span>&nbsp;<span class="op" id="7302678">!=</span>&nbsp;<span class="ident" id="7302681">nil</span>&nbsp;<span class="op" id="7302685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302690">t</span><span class="op" id="7302691">.</span><span class="ident" id="7302692">Errorf</span><span class="op" id="7302698">(</span><span class="string" id="7302699">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7302736">,</span>&nbsp;<span class="ident" id="7302738">i</span><span class="op" id="7302739">,</span>&nbsp;<span class="ident" id="7302741">err</span><span class="op" id="7302744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302749">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302764">if</span>&nbsp;<span class="ident" id="7302767">sa</span>&nbsp;<span class="op" id="7302770">:=</span>&nbsp;<span class="ident" id="7302773">cert</span><span class="op" id="7302777">.</span><span class="ident" id="7302778">SignatureAlgorithm</span><span class="op" id="7302796">;</span>&nbsp;<span class="ident" id="7302798">sa</span>&nbsp;<span class="op" id="7302801">!=</span>&nbsp;<span class="ident" id="7302804">test</span><span class="op" id="7302808">.</span><span class="ident" id="7302809">sigAlgo</span>&nbsp;<span class="op" id="7302817">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302822">t</span><span class="op" id="7302823">.</span><span class="ident" id="7302824">Errorf</span><span class="op" id="7302830">(</span><span class="string" id="7302831">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7302871">,</span>&nbsp;<span class="ident" id="7302873">i</span><span class="op" id="7302874">,</span>&nbsp;<span class="ident" id="7302876">sa</span><span class="op" id="7302878">,</span>&nbsp;<span class="ident" id="7302880">test</span><span class="op" id="7302884">.</span><span class="ident" id="7302885">sigAlgo</span><span class="op" id="7302892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7302896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7302900">if</span>&nbsp;<span class="ident" id="7302903">parsedKey</span><span class="op" id="7302912">,</span>&nbsp;<span class="ident" id="7302914">ok</span>&nbsp;<span class="op" id="7302917">:=</span>&nbsp;<span class="ident" id="7302920">cert</span><span class="op" id="7302924">.</span><span class="ident" id="7302925">PublicKey</span><span class="op" id="7302934">.</span><span class="op" id="7302935">(</span><span class="op" id="7302936">*</span><span class="ident" id="7302937">ecdsa</span><span class="op" id="7302942">.</span><span class="ident" id="7302943">PublicKey</span><span class="op" id="7302952">)</span><span class="op" id="7302953">;</span>&nbsp;<span class="op" id="7302955">!</span><span class="ident" id="7302956">ok</span>&nbsp;<span class="op" id="7302959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302964">t</span><span class="op" id="7302965">.</span><span class="ident" id="7302966">Errorf</span><span class="op" id="7302972">(</span><span class="string" id="7302973">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7303020">,</span>&nbsp;<span class="ident" id="7303022">i</span><span class="op" id="7303023">,</span>&nbsp;<span class="ident" id="7303025">parsedKey</span><span class="op" id="7303034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303038">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7303042">if</span>&nbsp;<span class="ident" id="7303045">pka</span>&nbsp;<span class="op" id="7303049">:=</span>&nbsp;<span class="ident" id="7303052">cert</span><span class="op" id="7303056">.</span><span class="ident" id="7303057">PublicKeyAlgorithm</span><span class="op" id="7303075">;</span>&nbsp;<span class="ident" id="7303077">pka</span>&nbsp;<span class="op" id="7303081">!=</span>&nbsp;<span class="ident" id="7303084">ECDSA</span>&nbsp;<span class="op" id="7303090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303095">t</span><span class="op" id="7303096">.</span><span class="ident" id="7303097">Errorf</span><span class="op" id="7303103">(</span><span class="string" id="7303104">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7303148">,</span>&nbsp;<span class="ident" id="7303150">i</span><span class="op" id="7303151">,</span>&nbsp;<span class="ident" id="7303153">pka</span><span class="op" id="7303156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7303164">if</span>&nbsp;<span class="ident" id="7303167">err</span>&nbsp;<span class="op" id="7303171">=</span>&nbsp;<span class="ident" id="7303173">cert</span><span class="op" id="7303177">.</span><span class="ident" id="7303178">CheckSignatureFrom</span><span class="op" id="7303196">(</span><span class="ident" id="7303197">cert</span><span class="op" id="7303201">)</span><span class="op" id="7303202">;</span>&nbsp;<span class="ident" id="7303204">err</span>&nbsp;<span class="op" id="7303208">!=</span>&nbsp;<span class="ident" id="7303211">nil</span>&nbsp;<span class="op" id="7303215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7303220">t</span><span class="op" id="7303221">.</span><span class="ident" id="7303222">Errorf</span><span class="op" id="7303228">(</span><span class="string" id="7303229">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7303270">,</span>&nbsp;<span class="ident" id="7303272">i</span><span class="op" id="7303273">,</span>&nbsp;<span class="ident" id="7303275">err</span><span class="op" id="7303278">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7303285">}</span><br>
<span class="lineno"></span><span class="op" id="7303287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7303290">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7303337">var</span>&nbsp;<span class="ident" id="7303341">dsaCertPem</span>&nbsp;<span class="op" id="7303352">=</span>&nbsp;<span class="string" id="7303354">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7304822">func</span>&nbsp;<span class="ident" id="7304827">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7304863">(</span><span class="ident" id="7304864">t</span>&nbsp;<span class="op" id="7304866">*</span><span class="ident" id="7304867">testing</span><span class="op" id="7304874">.</span><span class="ident" id="7304875">T</span><span class="op" id="7304876">)</span>&nbsp;<span class="op" id="7304878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304881">expectedKey</span>&nbsp;<span class="op" id="7304893">:=</span>&nbsp;<span class="op" id="7304896">&amp;</span><span class="ident" id="7304897">dsa</span><span class="op" id="7304900">.</span><span class="ident" id="7304901">PublicKey</span><span class="op" id="7304910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304914">Parameters</span><span class="op" id="7304924">:</span>&nbsp;<span class="ident" id="7304926">dsa</span><span class="op" id="7304929">.</span><span class="ident" id="7304930">Parameters</span><span class="op" id="7304940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7304945">P</span><span class="op" id="7304946">:</span>&nbsp;<span class="ident" id="7304948">bigFromHexString</span><span class="op" id="7304964">(</span><span class="string" id="7304965">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7305225">)</span><span class="op" id="7305226">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305231">Q</span><span class="op" id="7305232">:</span>&nbsp;<span class="ident" id="7305234">bigFromHexString</span><span class="op" id="7305250">(</span><span class="string" id="7305251">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7305295">)</span><span class="op" id="7305296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305301">G</span><span class="op" id="7305302">:</span>&nbsp;<span class="ident" id="7305304">bigFromHexString</span><span class="op" id="7305320">(</span><span class="string" id="7305321">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7305581">)</span><span class="op" id="7305582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305586">}</span><span class="op" id="7305587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305591">Y</span><span class="op" id="7305592">:</span>&nbsp;<span class="ident" id="7305594">bigFromHexString</span><span class="op" id="7305610">(</span><span class="string" id="7305611">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7305869">)</span><span class="op" id="7305870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305873">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305876">pemBlock</span><span class="op" id="7305884">,</span>&nbsp;<span class="ident" id="7305886">_</span>&nbsp;<span class="op" id="7305888">:=</span>&nbsp;<span class="ident" id="7305891">pem</span><span class="op" id="7305894">.</span><span class="ident" id="7305895">Decode</span><span class="op" id="7305901">(</span><span class="op" id="7305902">[</span><span class="op" id="7305903">]</span><span class="builtintype" id="7305904">byte</span><span class="op" id="7305908">(</span><span class="ident" id="7305909">dsaCertPem</span><span class="op" id="7305919">)</span><span class="op" id="7305920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305923">cert</span><span class="op" id="7305927">,</span>&nbsp;<span class="ident" id="7305929">err</span>&nbsp;<span class="op" id="7305933">:=</span>&nbsp;<span class="ident" id="7305936">ParseCertificate</span><span class="op" id="7305952">(</span><span class="ident" id="7305953">pemBlock</span><span class="op" id="7305961">.</span><span class="ident" id="7305962">Bytes</span><span class="op" id="7305967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305970">if</span>&nbsp;<span class="ident" id="7305973">err</span>&nbsp;<span class="op" id="7305977">!=</span>&nbsp;<span class="ident" id="7305980">nil</span>&nbsp;<span class="op" id="7305984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305988">t</span><span class="op" id="7305989">.</span><span class="ident" id="7305990">Fatalf</span><span class="op" id="7305996">(</span><span class="string" id="7305997">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7306030">,</span>&nbsp;<span class="ident" id="7306032">err</span><span class="op" id="7306035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306038">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306041">if</span>&nbsp;<span class="ident" id="7306044">cert</span><span class="op" id="7306048">.</span><span class="ident" id="7306049">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7306068">!=</span>&nbsp;<span class="ident" id="7306071">DSA</span>&nbsp;<span class="op" id="7306075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306079">t</span><span class="op" id="7306080">.</span><span class="ident" id="7306081">Errorf</span><span class="op" id="7306087">(</span><span class="string" id="7306088">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7306122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306128">parsedKey</span><span class="op" id="7306137">,</span>&nbsp;<span class="ident" id="7306139">ok</span>&nbsp;<span class="op" id="7306142">:=</span>&nbsp;<span class="ident" id="7306145">cert</span><span class="op" id="7306149">.</span><span class="ident" id="7306150">PublicKey</span><span class="op" id="7306159">.</span><span class="op" id="7306160">(</span><span class="op" id="7306161">*</span><span class="ident" id="7306162">dsa</span><span class="op" id="7306165">.</span><span class="ident" id="7306166">PublicKey</span><span class="op" id="7306175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306178">if</span>&nbsp;<span class="op" id="7306181">!</span><span class="ident" id="7306182">ok</span>&nbsp;<span class="op" id="7306185">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306189">t</span><span class="op" id="7306190">.</span><span class="ident" id="7306191">Fatalf</span><span class="op" id="7306197">(</span><span class="string" id="7306198">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7306232">,</span>&nbsp;<span class="ident" id="7306234">err</span><span class="op" id="7306237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306243">if</span>&nbsp;<span class="ident" id="7306246">expectedKey</span><span class="op" id="7306257">.</span><span class="ident" id="7306258">Y</span><span class="op" id="7306259">.</span><span class="ident" id="7306260">Cmp</span><span class="op" id="7306263">(</span><span class="ident" id="7306264">parsedKey</span><span class="op" id="7306273">.</span><span class="ident" id="7306274">Y</span><span class="op" id="7306275">)</span>&nbsp;<span class="op" id="7306277">!=</span>&nbsp;<span class="num" id="7306280">0</span>&nbsp;<span class="op" id="7306282">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306287">expectedKey</span><span class="op" id="7306298">.</span><span class="ident" id="7306299">P</span><span class="op" id="7306300">.</span><span class="ident" id="7306301">Cmp</span><span class="op" id="7306304">(</span><span class="ident" id="7306305">parsedKey</span><span class="op" id="7306314">.</span><span class="ident" id="7306315">P</span><span class="op" id="7306316">)</span>&nbsp;<span class="op" id="7306318">!=</span>&nbsp;<span class="num" id="7306321">0</span>&nbsp;<span class="op" id="7306323">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306328">expectedKey</span><span class="op" id="7306339">.</span><span class="ident" id="7306340">Q</span><span class="op" id="7306341">.</span><span class="ident" id="7306342">Cmp</span><span class="op" id="7306345">(</span><span class="ident" id="7306346">parsedKey</span><span class="op" id="7306355">.</span><span class="ident" id="7306356">Q</span><span class="op" id="7306357">)</span>&nbsp;<span class="op" id="7306359">!=</span>&nbsp;<span class="num" id="7306362">0</span>&nbsp;<span class="op" id="7306364">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306369">expectedKey</span><span class="op" id="7306380">.</span><span class="ident" id="7306381">G</span><span class="op" id="7306382">.</span><span class="ident" id="7306383">Cmp</span><span class="op" id="7306386">(</span><span class="ident" id="7306387">parsedKey</span><span class="op" id="7306396">.</span><span class="ident" id="7306397">G</span><span class="op" id="7306398">)</span>&nbsp;<span class="op" id="7306400">!=</span>&nbsp;<span class="num" id="7306403">0</span>&nbsp;<span class="op" id="7306405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306409">t</span><span class="op" id="7306410">.</span><span class="ident" id="7306411">Fatal</span><span class="op" id="7306416">(</span><span class="string" id="7306417">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7306455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306458">}</span><br>
<span class="lineno"></span><span class="op" id="7306460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7306463">func</span>&nbsp;<span class="ident" id="7306468">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7306513">(</span><span class="ident" id="7306514">t</span>&nbsp;<span class="op" id="7306516">*</span><span class="ident" id="7306517">testing</span><span class="op" id="7306524">.</span><span class="ident" id="7306525">T</span><span class="op" id="7306526">)</span>&nbsp;<span class="op" id="7306528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306531">pemBlock</span><span class="op" id="7306539">,</span>&nbsp;<span class="ident" id="7306541">_</span>&nbsp;<span class="op" id="7306543">:=</span>&nbsp;<span class="ident" id="7306546">pem</span><span class="op" id="7306549">.</span><span class="ident" id="7306550">Decode</span><span class="op" id="7306556">(</span><span class="op" id="7306557">[</span><span class="op" id="7306558">]</span><span class="builtintype" id="7306559">byte</span><span class="op" id="7306563">(</span><span class="ident" id="7306564">dsaCertPem</span><span class="op" id="7306574">)</span><span class="op" id="7306575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306578">cert</span><span class="op" id="7306582">,</span>&nbsp;<span class="ident" id="7306584">err</span>&nbsp;<span class="op" id="7306588">:=</span>&nbsp;<span class="ident" id="7306591">ParseCertificate</span><span class="op" id="7306607">(</span><span class="ident" id="7306608">pemBlock</span><span class="op" id="7306616">.</span><span class="ident" id="7306617">Bytes</span><span class="op" id="7306622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306625">if</span>&nbsp;<span class="ident" id="7306628">err</span>&nbsp;<span class="op" id="7306632">!=</span>&nbsp;<span class="ident" id="7306635">nil</span>&nbsp;<span class="op" id="7306639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306643">t</span><span class="op" id="7306644">.</span><span class="ident" id="7306645">Fatalf</span><span class="op" id="7306651">(</span><span class="string" id="7306652">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7306685">,</span>&nbsp;<span class="ident" id="7306687">err</span><span class="op" id="7306690">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306696">if</span>&nbsp;<span class="ident" id="7306699">cert</span><span class="op" id="7306703">.</span><span class="ident" id="7306704">SignatureAlgorithm</span>&nbsp;<span class="op" id="7306723">!=</span>&nbsp;<span class="ident" id="7306726">DSAWithSHA1</span>&nbsp;<span class="op" id="7306738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306742">t</span><span class="op" id="7306743">.</span><span class="ident" id="7306744">Errorf</span><span class="op" id="7306750">(</span><span class="string" id="7306751">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7306799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306802">}</span><br>
<span class="lineno"></span><span class="op" id="7306804">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7306807">func</span>&nbsp;<span class="ident" id="7306812">TestVerifyCertificateWithDSASignature</span><span class="op" id="7306849">(</span><span class="ident" id="7306850">t</span>&nbsp;<span class="op" id="7306852">*</span><span class="ident" id="7306853">testing</span><span class="op" id="7306860">.</span><span class="ident" id="7306861">T</span><span class="op" id="7306862">)</span>&nbsp;<span class="op" id="7306864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306867">pemBlock</span><span class="op" id="7306875">,</span>&nbsp;<span class="ident" id="7306877">_</span>&nbsp;<span class="op" id="7306879">:=</span>&nbsp;<span class="ident" id="7306882">pem</span><span class="op" id="7306885">.</span><span class="ident" id="7306886">Decode</span><span class="op" id="7306892">(</span><span class="op" id="7306893">[</span><span class="op" id="7306894">]</span><span class="builtintype" id="7306895">byte</span><span class="op" id="7306899">(</span><span class="ident" id="7306900">dsaCertPem</span><span class="op" id="7306910">)</span><span class="op" id="7306911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306914">cert</span><span class="op" id="7306918">,</span>&nbsp;<span class="ident" id="7306920">err</span>&nbsp;<span class="op" id="7306924">:=</span>&nbsp;<span class="ident" id="7306927">ParseCertificate</span><span class="op" id="7306943">(</span><span class="ident" id="7306944">pemBlock</span><span class="op" id="7306952">.</span><span class="ident" id="7306953">Bytes</span><span class="op" id="7306958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7306961">if</span>&nbsp;<span class="ident" id="7306964">err</span>&nbsp;<span class="op" id="7306968">!=</span>&nbsp;<span class="ident" id="7306971">nil</span>&nbsp;<span class="op" id="7306975">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306979">t</span><span class="op" id="7306980">.</span><span class="ident" id="7306981">Fatalf</span><span class="op" id="7306987">(</span><span class="string" id="7306988">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7307021">,</span>&nbsp;<span class="ident" id="7307023">err</span><span class="op" id="7307026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7307032">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307061">if</span>&nbsp;<span class="ident" id="7307064">err</span>&nbsp;<span class="op" id="7307068">=</span>&nbsp;<span class="ident" id="7307070">cert</span><span class="op" id="7307074">.</span><span class="ident" id="7307075">CheckSignatureFrom</span><span class="op" id="7307093">(</span><span class="ident" id="7307094">cert</span><span class="op" id="7307098">)</span><span class="op" id="7307099">;</span>&nbsp;<span class="ident" id="7307101">err</span>&nbsp;<span class="op" id="7307105">!=</span>&nbsp;<span class="ident" id="7307108">nil</span>&nbsp;<span class="op" id="7307112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307116">t</span><span class="op" id="7307117">.</span><span class="ident" id="7307118">Fatalf</span><span class="op" id="7307124">(</span><span class="string" id="7307125">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7307166">,</span>&nbsp;<span class="ident" id="7307168">err</span><span class="op" id="7307171">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307174">}</span><br>
<span class="lineno"></span><span class="op" id="7307176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7307179">const</span>&nbsp;<span class="ident" id="7307185">pemCertificate</span>&nbsp;<span class="op" id="7307200">=</span>&nbsp;<span class="string" id="7307202">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7307920">func</span>&nbsp;<span class="ident" id="7307925">TestCRLCreation</span><span class="op" id="7307940">(</span><span class="ident" id="7307941">t</span>&nbsp;<span class="op" id="7307943">*</span><span class="ident" id="7307944">testing</span><span class="op" id="7307951">.</span><span class="ident" id="7307952">T</span><span class="op" id="7307953">)</span>&nbsp;<span class="op" id="7307955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307958">block</span><span class="op" id="7307963">,</span>&nbsp;<span class="ident" id="7307965">_</span>&nbsp;<span class="op" id="7307967">:=</span>&nbsp;<span class="ident" id="7307970">pem</span><span class="op" id="7307973">.</span><span class="ident" id="7307974">Decode</span><span class="op" id="7307980">(</span><span class="op" id="7307981">[</span><span class="op" id="7307982">]</span><span class="builtintype" id="7307983">byte</span><span class="op" id="7307987">(</span><span class="ident" id="7307988">pemPrivateKey</span><span class="op" id="7308001">)</span><span class="op" id="7308002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308005">priv</span><span class="op" id="7308009">,</span>&nbsp;<span class="ident" id="7308011">_</span>&nbsp;<span class="op" id="7308013">:=</span>&nbsp;<span class="ident" id="7308016">ParsePKCS1PrivateKey</span><span class="op" id="7308036">(</span><span class="ident" id="7308037">block</span><span class="op" id="7308042">.</span><span class="ident" id="7308043">Bytes</span><span class="op" id="7308048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308051">block</span><span class="op" id="7308056">,</span>&nbsp;<span class="ident" id="7308058">_</span>&nbsp;<span class="op" id="7308060">=</span>&nbsp;<span class="ident" id="7308062">pem</span><span class="op" id="7308065">.</span><span class="ident" id="7308066">Decode</span><span class="op" id="7308072">(</span><span class="op" id="7308073">[</span><span class="op" id="7308074">]</span><span class="builtintype" id="7308075">byte</span><span class="op" id="7308079">(</span><span class="ident" id="7308080">pemCertificate</span><span class="op" id="7308094">)</span><span class="op" id="7308095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308098">cert</span><span class="op" id="7308102">,</span>&nbsp;<span class="ident" id="7308104">_</span>&nbsp;<span class="op" id="7308106">:=</span>&nbsp;<span class="ident" id="7308109">ParseCertificate</span><span class="op" id="7308125">(</span><span class="ident" id="7308126">block</span><span class="op" id="7308131">.</span><span class="ident" id="7308132">Bytes</span><span class="op" id="7308137">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308141">now</span>&nbsp;<span class="op" id="7308145">:=</span>&nbsp;<span class="ident" id="7308148">time</span><span class="op" id="7308152">.</span><span class="ident" id="7308153">Unix</span><span class="op" id="7308157">(</span><span class="num" id="7308158">1000</span><span class="op" id="7308162">,</span>&nbsp;<span class="num" id="7308164">0</span><span class="op" id="7308165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308168">expiry</span>&nbsp;<span class="op" id="7308175">:=</span>&nbsp;<span class="ident" id="7308178">time</span><span class="op" id="7308182">.</span><span class="ident" id="7308183">Unix</span><span class="op" id="7308187">(</span><span class="num" id="7308188">10000</span><span class="op" id="7308193">,</span>&nbsp;<span class="num" id="7308195">0</span><span class="op" id="7308196">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308200">revokedCerts</span>&nbsp;<span class="op" id="7308213">:=</span>&nbsp;<span class="op" id="7308216">[</span><span class="op" id="7308217">]</span><span class="ident" id="7308218">pkix</span><span class="op" id="7308222">.</span><span class="ident" id="7308223">RevokedCertificate</span><span class="op" id="7308241">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308250">SerialNumber</span><span class="op" id="7308262">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7308266">big</span><span class="op" id="7308269">.</span><span class="ident" id="7308270">NewInt</span><span class="op" id="7308276">(</span><span class="num" id="7308277">1</span><span class="op" id="7308278">)</span><span class="op" id="7308279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308284">RevocationTime</span><span class="op" id="7308298">:</span>&nbsp;<span class="ident" id="7308300">now</span><span class="op" id="7308303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308307">}</span><span class="op" id="7308308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308312">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308317">SerialNumber</span><span class="op" id="7308329">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7308333">big</span><span class="op" id="7308336">.</span><span class="ident" id="7308337">NewInt</span><span class="op" id="7308343">(</span><span class="num" id="7308344">42</span><span class="op" id="7308346">)</span><span class="op" id="7308347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308352">RevocationTime</span><span class="op" id="7308366">:</span>&nbsp;<span class="ident" id="7308368">now</span><span class="op" id="7308371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308375">}</span><span class="op" id="7308376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308383">crlBytes</span><span class="op" id="7308391">,</span>&nbsp;<span class="ident" id="7308393">err</span>&nbsp;<span class="op" id="7308397">:=</span>&nbsp;<span class="ident" id="7308400">cert</span><span class="op" id="7308404">.</span><span class="ident" id="7308405">CreateCRL</span><span class="op" id="7308414">(</span><span class="ident" id="7308415">rand</span><span class="op" id="7308419">.</span><span class="ident" id="7308420">Reader</span><span class="op" id="7308426">,</span>&nbsp;<span class="ident" id="7308428">priv</span><span class="op" id="7308432">,</span>&nbsp;<span class="ident" id="7308434">revokedCerts</span><span class="op" id="7308446">,</span>&nbsp;<span class="ident" id="7308448">now</span><span class="op" id="7308451">,</span>&nbsp;<span class="ident" id="7308453">expiry</span><span class="op" id="7308459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308462">if</span>&nbsp;<span class="ident" id="7308465">err</span>&nbsp;<span class="op" id="7308469">!=</span>&nbsp;<span class="ident" id="7308472">nil</span>&nbsp;<span class="op" id="7308476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308480">t</span><span class="op" id="7308481">.</span><span class="ident" id="7308482">Errorf</span><span class="op" id="7308488">(</span><span class="string" id="7308489">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7308513">,</span>&nbsp;<span class="ident" id="7308515">err</span><span class="op" id="7308518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308525">_</span><span class="op" id="7308526">,</span>&nbsp;<span class="ident" id="7308528">err</span>&nbsp;<span class="op" id="7308532">=</span>&nbsp;<span class="ident" id="7308534">ParseDERCRL</span><span class="op" id="7308545">(</span><span class="ident" id="7308546">crlBytes</span><span class="op" id="7308554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308557">if</span>&nbsp;<span class="ident" id="7308560">err</span>&nbsp;<span class="op" id="7308564">!=</span>&nbsp;<span class="ident" id="7308567">nil</span>&nbsp;<span class="op" id="7308571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308575">t</span><span class="op" id="7308576">.</span><span class="ident" id="7308577">Errorf</span><span class="op" id="7308583">(</span><span class="string" id="7308584">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7308609">,</span>&nbsp;<span class="ident" id="7308611">err</span><span class="op" id="7308614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308617">}</span><br>
<span class="lineno"></span><span class="op" id="7308619">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7308622">func</span>&nbsp;<span class="ident" id="7308627">fromBase64</span><span class="op" id="7308637">(</span><span class="ident" id="7308638">in</span>&nbsp;<span class="builtintype" id="7308641">string</span><span class="op" id="7308647">)</span>&nbsp;<span class="op" id="7308649">[</span><span class="op" id="7308650">]</span><span class="builtintype" id="7308651">byte</span>&nbsp;<span class="op" id="7308656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308659">out</span>&nbsp;<span class="op" id="7308663">:=</span>&nbsp;<span class="builtinfunc" id="7308666">make</span><span class="op" id="7308670">(</span><span class="op" id="7308671">[</span><span class="op" id="7308672">]</span><span class="builtintype" id="7308673">byte</span><span class="op" id="7308677">,</span>&nbsp;<span class="ident" id="7308679">base64</span><span class="op" id="7308685">.</span><span class="ident" id="7308686">StdEncoding</span><span class="op" id="7308697">.</span><span class="ident" id="7308698">DecodedLen</span><span class="op" id="7308708">(</span><span class="builtinfunc" id="7308709">len</span><span class="op" id="7308712">(</span><span class="ident" id="7308713">in</span><span class="op" id="7308715">)</span><span class="op" id="7308716">)</span><span class="op" id="7308717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308720">n</span><span class="op" id="7308721">,</span>&nbsp;<span class="ident" id="7308723">err</span>&nbsp;<span class="op" id="7308727">:=</span>&nbsp;<span class="ident" id="7308730">base64</span><span class="op" id="7308736">.</span><span class="ident" id="7308737">StdEncoding</span><span class="op" id="7308748">.</span><span class="ident" id="7308749">Decode</span><span class="op" id="7308755">(</span><span class="ident" id="7308756">out</span><span class="op" id="7308759">,</span>&nbsp;<span class="op" id="7308761">[</span><span class="op" id="7308762">]</span><span class="builtintype" id="7308763">byte</span><span class="op" id="7308767">(</span><span class="ident" id="7308768">in</span><span class="op" id="7308770">)</span><span class="op" id="7308771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308774">if</span>&nbsp;<span class="ident" id="7308777">err</span>&nbsp;<span class="op" id="7308781">!=</span>&nbsp;<span class="ident" id="7308784">nil</span>&nbsp;<span class="op" id="7308788">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7308792">panic</span><span class="op" id="7308797">(</span><span class="string" id="7308798">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7308823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308829">return</span>&nbsp;<span class="ident" id="7308836">out</span><span class="op" id="7308839">[</span><span class="op" id="7308840">:</span><span class="ident" id="7308841">n</span><span class="op" id="7308842">]</span><br>
<span class="lineno"></span><span class="op" id="7308844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7308847">func</span>&nbsp;<span class="ident" id="7308852">TestParseDERCRL</span><span class="op" id="7308867">(</span><span class="ident" id="7308868">t</span>&nbsp;<span class="op" id="7308870">*</span><span class="ident" id="7308871">testing</span><span class="op" id="7308878">.</span><span class="ident" id="7308879">T</span><span class="op" id="7308880">)</span>&nbsp;<span class="op" id="7308882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308885">derBytes</span>&nbsp;<span class="op" id="7308894">:=</span>&nbsp;<span class="ident" id="7308897">fromBase64</span><span class="op" id="7308907">(</span><span class="ident" id="7308908">derCRLBase64</span><span class="op" id="7308920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308923">certList</span><span class="op" id="7308931">,</span>&nbsp;<span class="ident" id="7308933">err</span>&nbsp;<span class="op" id="7308937">:=</span>&nbsp;<span class="ident" id="7308940">ParseDERCRL</span><span class="op" id="7308951">(</span><span class="ident" id="7308952">derBytes</span><span class="op" id="7308960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308963">if</span>&nbsp;<span class="ident" id="7308966">err</span>&nbsp;<span class="op" id="7308970">!=</span>&nbsp;<span class="ident" id="7308973">nil</span>&nbsp;<span class="op" id="7308977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308981">t</span><span class="op" id="7308982">.</span><span class="ident" id="7308983">Errorf</span><span class="op" id="7308989">(</span><span class="string" id="7308990">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7309009">,</span>&nbsp;<span class="ident" id="7309011">err</span><span class="op" id="7309014">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309029">numCerts</span>&nbsp;<span class="op" id="7309038">:=</span>&nbsp;<span class="builtinfunc" id="7309041">len</span><span class="op" id="7309044">(</span><span class="ident" id="7309045">certList</span><span class="op" id="7309053">.</span><span class="ident" id="7309054">TBSCertList</span><span class="op" id="7309065">.</span><span class="ident" id="7309066">RevokedCertificates</span><span class="op" id="7309085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309088">expected</span>&nbsp;<span class="op" id="7309097">:=</span>&nbsp;<span class="num" id="7309100">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309104">if</span>&nbsp;<span class="ident" id="7309107">numCerts</span>&nbsp;<span class="op" id="7309116">!=</span>&nbsp;<span class="ident" id="7309119">expected</span>&nbsp;<span class="op" id="7309128">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309132">t</span><span class="op" id="7309133">.</span><span class="ident" id="7309134">Errorf</span><span class="op" id="7309140">(</span><span class="string" id="7309141">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7309195">,</span>&nbsp;<span class="ident" id="7309197">numCerts</span><span class="op" id="7309205">,</span>&nbsp;<span class="ident" id="7309207">expected</span><span class="op" id="7309215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309222">if</span>&nbsp;<span class="ident" id="7309225">certList</span><span class="op" id="7309233">.</span><span class="ident" id="7309234">HasExpired</span><span class="op" id="7309244">(</span><span class="ident" id="7309245">time</span><span class="op" id="7309249">.</span><span class="ident" id="7309250">Unix</span><span class="op" id="7309254">(</span><span class="num" id="7309255">1302517272</span><span class="op" id="7309265">,</span>&nbsp;<span class="num" id="7309267">0</span><span class="op" id="7309268">)</span><span class="op" id="7309269">)</span>&nbsp;<span class="op" id="7309271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309275">t</span><span class="op" id="7309276">.</span><span class="ident" id="7309277">Errorf</span><span class="op" id="7309283">(</span><span class="string" id="7309284">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7309322">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7309329">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7309388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7309391">func</span>&nbsp;<span class="ident" id="7309396">TestCRLWithoutExpiry</span><span class="op" id="7309416">(</span><span class="ident" id="7309417">t</span>&nbsp;<span class="op" id="7309419">*</span><span class="ident" id="7309420">testing</span><span class="op" id="7309427">.</span><span class="ident" id="7309428">T</span><span class="op" id="7309429">)</span>&nbsp;<span class="op" id="7309431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309434">derBytes</span>&nbsp;<span class="op" id="7309443">:=</span>&nbsp;<span class="ident" id="7309446">fromBase64</span><span class="op" id="7309456">(</span><span class="string" id="7309457">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7309751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309754">certList</span><span class="op" id="7309762">,</span>&nbsp;<span class="ident" id="7309764">err</span>&nbsp;<span class="op" id="7309768">:=</span>&nbsp;<span class="ident" id="7309771">ParseDERCRL</span><span class="op" id="7309782">(</span><span class="ident" id="7309783">derBytes</span><span class="op" id="7309791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309794">if</span>&nbsp;<span class="ident" id="7309797">err</span>&nbsp;<span class="op" id="7309801">!=</span>&nbsp;<span class="ident" id="7309804">nil</span>&nbsp;<span class="op" id="7309808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309812">t</span><span class="op" id="7309813">.</span><span class="ident" id="7309814">Fatal</span><span class="op" id="7309819">(</span><span class="ident" id="7309820">err</span><span class="op" id="7309823">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309829">if</span>&nbsp;<span class="op" id="7309832">!</span><span class="ident" id="7309833">certList</span><span class="op" id="7309841">.</span><span class="ident" id="7309842">TBSCertList</span><span class="op" id="7309853">.</span><span class="ident" id="7309854">NextUpdate</span><span class="op" id="7309864">.</span><span class="ident" id="7309865">IsZero</span><span class="op" id="7309871">(</span><span class="op" id="7309872">)</span>&nbsp;<span class="op" id="7309874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309878">t</span><span class="op" id="7309879">.</span><span class="ident" id="7309880">Errorf</span><span class="op" id="7309886">(</span><span class="string" id="7309887">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7309921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309924">}</span><br>
<span class="lineno"></span><span class="op" id="7309926">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7309929">func</span>&nbsp;<span class="ident" id="7309934">TestParsePEMCRL</span><span class="op" id="7309949">(</span><span class="ident" id="7309950">t</span>&nbsp;<span class="op" id="7309952">*</span><span class="ident" id="7309953">testing</span><span class="op" id="7309960">.</span><span class="ident" id="7309961">T</span><span class="op" id="7309962">)</span>&nbsp;<span class="op" id="7309964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309967">pemBytes</span>&nbsp;<span class="op" id="7309976">:=</span>&nbsp;<span class="ident" id="7309979">fromBase64</span><span class="op" id="7309989">(</span><span class="ident" id="7309990">pemCRLBase64</span><span class="op" id="7310002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310005">certList</span><span class="op" id="7310013">,</span>&nbsp;<span class="ident" id="7310015">err</span>&nbsp;<span class="op" id="7310019">:=</span>&nbsp;<span class="ident" id="7310022">ParseCRL</span><span class="op" id="7310030">(</span><span class="ident" id="7310031">pemBytes</span><span class="op" id="7310039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310042">if</span>&nbsp;<span class="ident" id="7310045">err</span>&nbsp;<span class="op" id="7310049">!=</span>&nbsp;<span class="ident" id="7310052">nil</span>&nbsp;<span class="op" id="7310056">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310060">t</span><span class="op" id="7310061">.</span><span class="ident" id="7310062">Errorf</span><span class="op" id="7310068">(</span><span class="string" id="7310069">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7310088">,</span>&nbsp;<span class="ident" id="7310090">err</span><span class="op" id="7310093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310097">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310108">numCerts</span>&nbsp;<span class="op" id="7310117">:=</span>&nbsp;<span class="builtinfunc" id="7310120">len</span><span class="op" id="7310123">(</span><span class="ident" id="7310124">certList</span><span class="op" id="7310132">.</span><span class="ident" id="7310133">TBSCertList</span><span class="op" id="7310144">.</span><span class="ident" id="7310145">RevokedCertificates</span><span class="op" id="7310164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310167">expected</span>&nbsp;<span class="op" id="7310176">:=</span>&nbsp;<span class="num" id="7310179">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310182">if</span>&nbsp;<span class="ident" id="7310185">numCerts</span>&nbsp;<span class="op" id="7310194">!=</span>&nbsp;<span class="ident" id="7310197">expected</span>&nbsp;<span class="op" id="7310206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310210">t</span><span class="op" id="7310211">.</span><span class="ident" id="7310212">Errorf</span><span class="op" id="7310218">(</span><span class="string" id="7310219">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7310273">,</span>&nbsp;<span class="ident" id="7310275">numCerts</span><span class="op" id="7310283">,</span>&nbsp;<span class="ident" id="7310285">expected</span><span class="op" id="7310293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310300">if</span>&nbsp;<span class="ident" id="7310303">certList</span><span class="op" id="7310311">.</span><span class="ident" id="7310312">HasExpired</span><span class="op" id="7310322">(</span><span class="ident" id="7310323">time</span><span class="op" id="7310327">.</span><span class="ident" id="7310328">Unix</span><span class="op" id="7310332">(</span><span class="num" id="7310333">1302517272</span><span class="op" id="7310343">,</span>&nbsp;<span class="num" id="7310345">0</span><span class="op" id="7310346">)</span><span class="op" id="7310347">)</span>&nbsp;<span class="op" id="7310349">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310353">t</span><span class="op" id="7310354">.</span><span class="ident" id="7310355">Errorf</span><span class="op" id="7310361">(</span><span class="string" id="7310362">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7310400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7310407">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7310466">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7310469">func</span>&nbsp;<span class="ident" id="7310474">TestImports</span><span class="op" id="7310485">(</span><span class="ident" id="7310486">t</span>&nbsp;<span class="op" id="7310488">*</span><span class="ident" id="7310489">testing</span><span class="op" id="7310496">.</span><span class="ident" id="7310497">T</span><span class="op" id="7310498">)</span>&nbsp;<span class="op" id="7310500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310503">switch</span>&nbsp;<span class="ident" id="7310510">runtime</span><span class="op" id="7310517">.</span><span class="ident" id="7310518">GOOS</span>&nbsp;<span class="op" id="7310523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310526">case</span>&nbsp;<span class="string" id="7310531">&#34;android&#34;</span><span class="op" id="7310540">,</span>&nbsp;<span class="string" id="7310542">&#34;nacl&#34;</span><span class="op" id="7310548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310552">t</span><span class="op" id="7310553">.</span><span class="ident" id="7310554">Skipf</span><span class="op" id="7310559">(</span><span class="string" id="7310560">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7310576">,</span>&nbsp;<span class="ident" id="7310578">runtime</span><span class="op" id="7310585">.</span><span class="ident" id="7310586">GOOS</span><span class="op" id="7310590">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310597">if</span>&nbsp;<span class="ident" id="7310600">err</span>&nbsp;<span class="op" id="7310604">:=</span>&nbsp;<span class="ident" id="7310607">exec</span><span class="op" id="7310611">.</span><span class="ident" id="7310612">Command</span><span class="op" id="7310619">(</span><span class="string" id="7310620">&#34;go&#34;</span><span class="op" id="7310624">,</span>&nbsp;<span class="string" id="7310626">&#34;run&#34;</span><span class="op" id="7310631">,</span>&nbsp;<span class="string" id="7310633">&#34;x509_test_import.go&#34;</span><span class="op" id="7310654">)</span><span class="op" id="7310655">.</span><span class="ident" id="7310656">Run</span><span class="op" id="7310659">(</span><span class="op" id="7310660">)</span><span class="op" id="7310661">;</span>&nbsp;<span class="ident" id="7310663">err</span>&nbsp;<span class="op" id="7310667">!=</span>&nbsp;<span class="ident" id="7310670">nil</span>&nbsp;<span class="op" id="7310674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310678">t</span><span class="op" id="7310679">.</span><span class="ident" id="7310680">Errorf</span><span class="op" id="7310686">(</span><span class="string" id="7310687">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7310726">,</span>&nbsp;<span class="ident" id="7310728">err</span><span class="op" id="7310731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310734">}</span><br>
<span class="lineno">750</span><span class="op" id="7310736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7310739">const</span>&nbsp;<span class="ident" id="7310745">derCRLBase64</span>&nbsp;<span class="op" id="7310758">=</span>&nbsp;<span class="string" id="7310760">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7315436">const</span>&nbsp;<span class="ident" id="7315442">pemCRLBase64</span>&nbsp;<span class="op" id="7315455">=</span>&nbsp;<span class="string" id="7315457">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7316461">func</span>&nbsp;<span class="ident" id="7316466">TestCreateCertificateRequest</span><span class="op" id="7316494">(</span><span class="ident" id="7316495">t</span>&nbsp;<span class="op" id="7316497">*</span><span class="ident" id="7316498">testing</span><span class="op" id="7316505">.</span><span class="ident" id="7316506">T</span><span class="op" id="7316507">)</span>&nbsp;<span class="op" id="7316509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316512">random</span>&nbsp;<span class="op" id="7316519">:=</span>&nbsp;<span class="ident" id="7316522">rand</span><span class="op" id="7316526">.</span><span class="ident" id="7316527">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316536">block</span><span class="op" id="7316541">,</span>&nbsp;<span class="ident" id="7316543">_</span>&nbsp;<span class="op" id="7316545">:=</span>&nbsp;<span class="ident" id="7316548">pem</span><span class="op" id="7316551">.</span><span class="ident" id="7316552">Decode</span><span class="op" id="7316558">(</span><span class="op" id="7316559">[</span><span class="op" id="7316560">]</span><span class="builtintype" id="7316561">byte</span><span class="op" id="7316565">(</span><span class="ident" id="7316566">pemPrivateKey</span><span class="op" id="7316579">)</span><span class="op" id="7316580">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316583">rsaPriv</span><span class="op" id="7316590">,</span>&nbsp;<span class="ident" id="7316592">err</span>&nbsp;<span class="op" id="7316596">:=</span>&nbsp;<span class="ident" id="7316599">ParsePKCS1PrivateKey</span><span class="op" id="7316619">(</span><span class="ident" id="7316620">block</span><span class="op" id="7316625">.</span><span class="ident" id="7316626">Bytes</span><span class="op" id="7316631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316634">if</span>&nbsp;<span class="ident" id="7316637">err</span>&nbsp;<span class="op" id="7316641">!=</span>&nbsp;<span class="ident" id="7316644">nil</span>&nbsp;<span class="op" id="7316648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316652">t</span><span class="op" id="7316653">.</span><span class="ident" id="7316654">Fatalf</span><span class="op" id="7316660">(</span><span class="string" id="7316661">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7316694">,</span>&nbsp;<span class="ident" id="7316696">err</span><span class="op" id="7316699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316706">ecdsa256Priv</span><span class="op" id="7316718">,</span>&nbsp;<span class="ident" id="7316720">err</span>&nbsp;<span class="op" id="7316724">:=</span>&nbsp;<span class="ident" id="7316727">ecdsa</span><span class="op" id="7316732">.</span><span class="ident" id="7316733">GenerateKey</span><span class="op" id="7316744">(</span><span class="ident" id="7316745">elliptic</span><span class="op" id="7316753">.</span><span class="ident" id="7316754">P256</span><span class="op" id="7316758">(</span><span class="op" id="7316759">)</span><span class="op" id="7316760">,</span>&nbsp;<span class="ident" id="7316762">rand</span><span class="op" id="7316766">.</span><span class="ident" id="7316767">Reader</span><span class="op" id="7316773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316776">if</span>&nbsp;<span class="ident" id="7316779">err</span>&nbsp;<span class="op" id="7316783">!=</span>&nbsp;<span class="ident" id="7316786">nil</span>&nbsp;<span class="op" id="7316790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316794">t</span><span class="op" id="7316795">.</span><span class="ident" id="7316796">Fatalf</span><span class="op" id="7316802">(</span><span class="string" id="7316803">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7316837">,</span>&nbsp;<span class="ident" id="7316839">err</span><span class="op" id="7316842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316849">ecdsa384Priv</span><span class="op" id="7316861">,</span>&nbsp;<span class="ident" id="7316863">err</span>&nbsp;<span class="op" id="7316867">:=</span>&nbsp;<span class="ident" id="7316870">ecdsa</span><span class="op" id="7316875">.</span><span class="ident" id="7316876">GenerateKey</span><span class="op" id="7316887">(</span><span class="ident" id="7316888">elliptic</span><span class="op" id="7316896">.</span><span class="ident" id="7316897">P384</span><span class="op" id="7316901">(</span><span class="op" id="7316902">)</span><span class="op" id="7316903">,</span>&nbsp;<span class="ident" id="7316905">rand</span><span class="op" id="7316909">.</span><span class="ident" id="7316910">Reader</span><span class="op" id="7316916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7316919">if</span>&nbsp;<span class="ident" id="7316922">err</span>&nbsp;<span class="op" id="7316926">!=</span>&nbsp;<span class="ident" id="7316929">nil</span>&nbsp;<span class="op" id="7316933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316937">t</span><span class="op" id="7316938">.</span><span class="ident" id="7316939">Fatalf</span><span class="op" id="7316945">(</span><span class="string" id="7316946">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7316980">,</span>&nbsp;<span class="ident" id="7316982">err</span><span class="op" id="7316985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7316988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7316992">ecdsa521Priv</span><span class="op" id="7317004">,</span>&nbsp;<span class="ident" id="7317006">err</span>&nbsp;<span class="op" id="7317010">:=</span>&nbsp;<span class="ident" id="7317013">ecdsa</span><span class="op" id="7317018">.</span><span class="ident" id="7317019">GenerateKey</span><span class="op" id="7317030">(</span><span class="ident" id="7317031">elliptic</span><span class="op" id="7317039">.</span><span class="ident" id="7317040">P521</span><span class="op" id="7317044">(</span><span class="op" id="7317045">)</span><span class="op" id="7317046">,</span>&nbsp;<span class="ident" id="7317048">rand</span><span class="op" id="7317052">.</span><span class="ident" id="7317053">Reader</span><span class="op" id="7317059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7317062">if</span>&nbsp;<span class="ident" id="7317065">err</span>&nbsp;<span class="op" id="7317069">!=</span>&nbsp;<span class="ident" id="7317072">nil</span>&nbsp;<span class="op" id="7317076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317080">t</span><span class="op" id="7317081">.</span><span class="ident" id="7317082">Fatalf</span><span class="op" id="7317088">(</span><span class="string" id="7317089">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7317123">,</span>&nbsp;<span class="ident" id="7317125">err</span><span class="op" id="7317128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317135">tests</span>&nbsp;<span class="op" id="7317141">:=</span>&nbsp;<span class="op" id="7317144">[</span><span class="op" id="7317145">]</span><span class="keyword" id="7317146">struct</span>&nbsp;<span class="op" id="7317153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317157">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7317165">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317174">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317182">interface</span><span class="op" id="7317191">{</span><span class="op" id="7317192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317196">sigAlgo</span>&nbsp;<span class="ident" id="7317204">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317224">}</span><span class="op" id="7317225">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317229">{</span><span class="string" id="7317230">&#34;RSA&#34;</span><span class="op" id="7317235">,</span>&nbsp;<span class="ident" id="7317237">rsaPriv</span><span class="op" id="7317244">,</span>&nbsp;<span class="ident" id="7317246">SHA1WithRSA</span><span class="op" id="7317257">}</span><span class="op" id="7317258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317262">{</span><span class="string" id="7317263">&#34;ECDSA-256&#34;</span><span class="op" id="7317274">,</span>&nbsp;<span class="ident" id="7317276">ecdsa256Priv</span><span class="op" id="7317288">,</span>&nbsp;<span class="ident" id="7317290">ECDSAWithSHA1</span><span class="op" id="7317303">}</span><span class="op" id="7317304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317308">{</span><span class="string" id="7317309">&#34;ECDSA-384&#34;</span><span class="op" id="7317320">,</span>&nbsp;<span class="ident" id="7317322">ecdsa384Priv</span><span class="op" id="7317334">,</span>&nbsp;<span class="ident" id="7317336">ECDSAWithSHA1</span><span class="op" id="7317349">}</span><span class="op" id="7317350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317354">{</span><span class="string" id="7317355">&#34;ECDSA-521&#34;</span><span class="op" id="7317366">,</span>&nbsp;<span class="ident" id="7317368">ecdsa521Priv</span><span class="op" id="7317380">,</span>&nbsp;<span class="ident" id="7317382">ECDSAWithSHA1</span><span class="op" id="7317395">}</span><span class="op" id="7317396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317399">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7317403">for</span>&nbsp;<span class="ident" id="7317407">_</span><span class="op" id="7317408">,</span>&nbsp;<span class="ident" id="7317410">test</span>&nbsp;<span class="op" id="7317415">:=</span>&nbsp;<span class="keyword" id="7317418">range</span>&nbsp;<span class="ident" id="7317424">tests</span>&nbsp;<span class="op" id="7317430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317434">template</span>&nbsp;<span class="op" id="7317443">:=</span>&nbsp;<span class="ident" id="7317446">CertificateRequest</span><span class="op" id="7317464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317469">Subject</span><span class="op" id="7317476">:</span>&nbsp;<span class="ident" id="7317478">pkix</span><span class="op" id="7317482">.</span><span class="ident" id="7317483">Name</span><span class="op" id="7317487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317493">CommonName</span><span class="op" id="7317503">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7317507">&#34;test.example.com&#34;</span><span class="op" id="7317525">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317531">Organization</span><span class="op" id="7317543">:</span>&nbsp;<span class="op" id="7317545">[</span><span class="op" id="7317546">]</span><span class="builtintype" id="7317547">string</span><span class="op" id="7317553">{</span><span class="string" id="7317554">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7317566">}</span><span class="op" id="7317567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317572">}</span><span class="op" id="7317573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317578">SignatureAlgorithm</span><span class="op" id="7317596">:</span>&nbsp;<span class="ident" id="7317598">test</span><span class="op" id="7317602">.</span><span class="ident" id="7317603">sigAlgo</span><span class="op" id="7317610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317615">DNSNames</span><span class="op" id="7317623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317635">[</span><span class="op" id="7317636">]</span><span class="builtintype" id="7317637">string</span><span class="op" id="7317643">{</span><span class="string" id="7317644">&#34;test.example.com&#34;</span><span class="op" id="7317662">}</span><span class="op" id="7317663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317668">EmailAddresses</span><span class="op" id="7317682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317688">[</span><span class="op" id="7317689">]</span><span class="builtintype" id="7317690">string</span><span class="op" id="7317696">{</span><span class="string" id="7317697">&#34;gopher@golang.org&#34;</span><span class="op" id="7317716">}</span><span class="op" id="7317717">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317722">IPAddresses</span><span class="op" id="7317733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317742">[</span><span class="op" id="7317743">]</span><span class="ident" id="7317744">net</span><span class="op" id="7317747">.</span><span class="ident" id="7317748">IP</span><span class="op" id="7317750">{</span><span class="ident" id="7317751">net</span><span class="op" id="7317754">.</span><span class="ident" id="7317755">IPv4</span><span class="op" id="7317759">(</span><span class="num" id="7317760">127</span><span class="op" id="7317763">,</span>&nbsp;<span class="num" id="7317765">0</span><span class="op" id="7317766">,</span>&nbsp;<span class="num" id="7317768">0</span><span class="op" id="7317769">,</span>&nbsp;<span class="num" id="7317771">1</span><span class="op" id="7317772">)</span><span class="op" id="7317773">.</span><span class="ident" id="7317774">To4</span><span class="op" id="7317777">(</span><span class="op" id="7317778">)</span><span class="op" id="7317779">,</span>&nbsp;<span class="ident" id="7317781">net</span><span class="op" id="7317784">.</span><span class="ident" id="7317785">ParseIP</span><span class="op" id="7317792">(</span><span class="string" id="7317793">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7317815">)</span><span class="op" id="7317816">}</span><span class="op" id="7317817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317826">derBytes</span><span class="op" id="7317834">,</span>&nbsp;<span class="ident" id="7317836">err</span>&nbsp;<span class="op" id="7317840">:=</span>&nbsp;<span class="ident" id="7317843">CreateCertificateRequest</span><span class="op" id="7317867">(</span><span class="ident" id="7317868">random</span><span class="op" id="7317874">,</span>&nbsp;<span class="op" id="7317876">&amp;</span><span class="ident" id="7317877">template</span><span class="op" id="7317885">,</span>&nbsp;<span class="ident" id="7317887">test</span><span class="op" id="7317891">.</span><span class="ident" id="7317892">priv</span><span class="op" id="7317896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7317900">if</span>&nbsp;<span class="ident" id="7317903">err</span>&nbsp;<span class="op" id="7317907">!=</span>&nbsp;<span class="ident" id="7317910">nil</span>&nbsp;<span class="op" id="7317914">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317919">t</span><span class="op" id="7317920">.</span><span class="ident" id="7317921">Errorf</span><span class="op" id="7317927">(</span><span class="string" id="7317928">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7317974">,</span>&nbsp;<span class="ident" id="7317976">test</span><span class="op" id="7317980">.</span><span class="ident" id="7317981">name</span><span class="op" id="7317985">,</span>&nbsp;<span class="ident" id="7317987">err</span><span class="op" id="7317990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7317995">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318011">out</span><span class="op" id="7318014">,</span>&nbsp;<span class="ident" id="7318016">err</span>&nbsp;<span class="op" id="7318020">:=</span>&nbsp;<span class="ident" id="7318023">ParseCertificateRequest</span><span class="op" id="7318046">(</span><span class="ident" id="7318047">derBytes</span><span class="op" id="7318055">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318059">if</span>&nbsp;<span class="ident" id="7318062">err</span>&nbsp;<span class="op" id="7318066">!=</span>&nbsp;<span class="ident" id="7318069">nil</span>&nbsp;<span class="op" id="7318073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318078">t</span><span class="op" id="7318079">.</span><span class="ident" id="7318080">Errorf</span><span class="op" id="7318086">(</span><span class="string" id="7318087">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7318133">,</span>&nbsp;<span class="ident" id="7318135">test</span><span class="op" id="7318139">.</span><span class="ident" id="7318140">name</span><span class="op" id="7318144">,</span>&nbsp;<span class="ident" id="7318146">err</span><span class="op" id="7318149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318154">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318170">if</span>&nbsp;<span class="ident" id="7318173">out</span><span class="op" id="7318176">.</span><span class="ident" id="7318177">Subject</span><span class="op" id="7318184">.</span><span class="ident" id="7318185">CommonName</span>&nbsp;<span class="op" id="7318196">!=</span>&nbsp;<span class="ident" id="7318199">template</span><span class="op" id="7318207">.</span><span class="ident" id="7318208">Subject</span><span class="op" id="7318215">.</span><span class="ident" id="7318216">CommonName</span>&nbsp;<span class="op" id="7318227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318232">t</span><span class="op" id="7318233">.</span><span class="ident" id="7318234">Errorf</span><span class="op" id="7318240">(</span><span class="string" id="7318241">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7318318">,</span>&nbsp;<span class="ident" id="7318320">test</span><span class="op" id="7318324">.</span><span class="ident" id="7318325">name</span><span class="op" id="7318329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318333">}</span>&nbsp;<span class="keyword" id="7318335">else</span>&nbsp;<span class="keyword" id="7318340">if</span>&nbsp;<span class="builtinfunc" id="7318343">len</span><span class="op" id="7318346">(</span><span class="ident" id="7318347">out</span><span class="op" id="7318350">.</span><span class="ident" id="7318351">Subject</span><span class="op" id="7318358">.</span><span class="ident" id="7318359">Organization</span><span class="op" id="7318371">)</span>&nbsp;<span class="op" id="7318373">!=</span>&nbsp;<span class="builtinfunc" id="7318376">len</span><span class="op" id="7318379">(</span><span class="ident" id="7318380">template</span><span class="op" id="7318388">.</span><span class="ident" id="7318389">Subject</span><span class="op" id="7318396">.</span><span class="ident" id="7318397">Organization</span><span class="op" id="7318409">)</span>&nbsp;<span class="op" id="7318411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318416">t</span><span class="op" id="7318417">.</span><span class="ident" id="7318418">Errorf</span><span class="op" id="7318424">(</span><span class="string" id="7318425">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7318504">,</span>&nbsp;<span class="ident" id="7318506">test</span><span class="op" id="7318510">.</span><span class="ident" id="7318511">name</span><span class="op" id="7318515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318519">}</span>&nbsp;<span class="keyword" id="7318521">else</span>&nbsp;<span class="keyword" id="7318526">if</span>&nbsp;<span class="builtinfunc" id="7318529">len</span><span class="op" id="7318532">(</span><span class="ident" id="7318533">out</span><span class="op" id="7318536">.</span><span class="ident" id="7318537">DNSNames</span><span class="op" id="7318545">)</span>&nbsp;<span class="op" id="7318547">!=</span>&nbsp;<span class="builtinfunc" id="7318550">len</span><span class="op" id="7318553">(</span><span class="ident" id="7318554">template</span><span class="op" id="7318562">.</span><span class="ident" id="7318563">DNSNames</span><span class="op" id="7318571">)</span>&nbsp;<span class="op" id="7318573">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318578">t</span><span class="op" id="7318579">.</span><span class="ident" id="7318580">Errorf</span><span class="op" id="7318586">(</span><span class="string" id="7318587">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7318644">,</span>&nbsp;<span class="ident" id="7318646">test</span><span class="op" id="7318650">.</span><span class="ident" id="7318651">name</span><span class="op" id="7318655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318659">}</span>&nbsp;<span class="keyword" id="7318661">else</span>&nbsp;<span class="keyword" id="7318666">if</span>&nbsp;<span class="builtinfunc" id="7318669">len</span><span class="op" id="7318672">(</span><span class="ident" id="7318673">out</span><span class="op" id="7318676">.</span><span class="ident" id="7318677">EmailAddresses</span><span class="op" id="7318691">)</span>&nbsp;<span class="op" id="7318693">!=</span>&nbsp;<span class="builtinfunc" id="7318696">len</span><span class="op" id="7318699">(</span><span class="ident" id="7318700">template</span><span class="op" id="7318708">.</span><span class="ident" id="7318709">EmailAddresses</span><span class="op" id="7318723">)</span>&nbsp;<span class="op" id="7318725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318730">t</span><span class="op" id="7318731">.</span><span class="ident" id="7318732">Errorf</span><span class="op" id="7318738">(</span><span class="string" id="7318739">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7318808">,</span>&nbsp;<span class="ident" id="7318810">test</span><span class="op" id="7318814">.</span><span class="ident" id="7318815">name</span><span class="op" id="7318819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318823">}</span>&nbsp;<span class="keyword" id="7318825">else</span>&nbsp;<span class="keyword" id="7318830">if</span>&nbsp;<span class="builtinfunc" id="7318833">len</span><span class="op" id="7318836">(</span><span class="ident" id="7318837">out</span><span class="op" id="7318840">.</span><span class="ident" id="7318841">IPAddresses</span><span class="op" id="7318852">)</span>&nbsp;<span class="op" id="7318854">!=</span>&nbsp;<span class="builtinfunc" id="7318857">len</span><span class="op" id="7318860">(</span><span class="ident" id="7318861">template</span><span class="op" id="7318869">.</span><span class="ident" id="7318870">IPAddresses</span><span class="op" id="7318881">)</span>&nbsp;<span class="op" id="7318883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318888">t</span><span class="op" id="7318889">.</span><span class="ident" id="7318890">Errorf</span><span class="op" id="7318896">(</span><span class="string" id="7318897">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7318966">,</span>&nbsp;<span class="ident" id="7318968">test</span><span class="op" id="7318972">.</span><span class="ident" id="7318973">name</span><span class="op" id="7318977">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318984">}</span><br>
<span class="lineno"></span><span class="op" id="7318986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7318989">func</span>&nbsp;<span class="ident" id="7318994">marshalAndParseCSR</span><span class="op" id="7319012">(</span><span class="ident" id="7319013">t</span>&nbsp;<span class="op" id="7319015">*</span><span class="ident" id="7319016">testing</span><span class="op" id="7319023">.</span><span class="ident" id="7319024">T</span><span class="op" id="7319025">,</span>&nbsp;<span class="ident" id="7319027">template</span>&nbsp;<span class="op" id="7319036">*</span><span class="ident" id="7319037">CertificateRequest</span><span class="op" id="7319055">)</span>&nbsp;<span class="op" id="7319057">*</span><span class="ident" id="7319058">CertificateRequest</span>&nbsp;<span class="op" id="7319077">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319080">block</span><span class="op" id="7319085">,</span>&nbsp;<span class="ident" id="7319087">_</span>&nbsp;<span class="op" id="7319089">:=</span>&nbsp;<span class="ident" id="7319092">pem</span><span class="op" id="7319095">.</span><span class="ident" id="7319096">Decode</span><span class="op" id="7319102">(</span><span class="op" id="7319103">[</span><span class="op" id="7319104">]</span><span class="builtintype" id="7319105">byte</span><span class="op" id="7319109">(</span><span class="ident" id="7319110">pemPrivateKey</span><span class="op" id="7319123">)</span><span class="op" id="7319124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319127">rsaPriv</span><span class="op" id="7319134">,</span>&nbsp;<span class="ident" id="7319136">err</span>&nbsp;<span class="op" id="7319140">:=</span>&nbsp;<span class="ident" id="7319143">ParsePKCS1PrivateKey</span><span class="op" id="7319163">(</span><span class="ident" id="7319164">block</span><span class="op" id="7319169">.</span><span class="ident" id="7319170">Bytes</span><span class="op" id="7319175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319178">if</span>&nbsp;<span class="ident" id="7319181">err</span>&nbsp;<span class="op" id="7319185">!=</span>&nbsp;<span class="ident" id="7319188">nil</span>&nbsp;<span class="op" id="7319192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319196">t</span><span class="op" id="7319197">.</span><span class="ident" id="7319198">Fatal</span><span class="op" id="7319203">(</span><span class="ident" id="7319204">err</span><span class="op" id="7319207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319210">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319214">derBytes</span><span class="op" id="7319222">,</span>&nbsp;<span class="ident" id="7319224">err</span>&nbsp;<span class="op" id="7319228">:=</span>&nbsp;<span class="ident" id="7319231">CreateCertificateRequest</span><span class="op" id="7319255">(</span><span class="ident" id="7319256">rand</span><span class="op" id="7319260">.</span><span class="ident" id="7319261">Reader</span><span class="op" id="7319267">,</span>&nbsp;<span class="ident" id="7319269">template</span><span class="op" id="7319277">,</span>&nbsp;<span class="ident" id="7319279">rsaPriv</span><span class="op" id="7319286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319289">if</span>&nbsp;<span class="ident" id="7319292">err</span>&nbsp;<span class="op" id="7319296">!=</span>&nbsp;<span class="ident" id="7319299">nil</span>&nbsp;<span class="op" id="7319303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319307">t</span><span class="op" id="7319308">.</span><span class="ident" id="7319309">Fatal</span><span class="op" id="7319314">(</span><span class="ident" id="7319315">err</span><span class="op" id="7319318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319321">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319325">csr</span><span class="op" id="7319328">,</span>&nbsp;<span class="ident" id="7319330">err</span>&nbsp;<span class="op" id="7319334">:=</span>&nbsp;<span class="ident" id="7319337">ParseCertificateRequest</span><span class="op" id="7319360">(</span><span class="ident" id="7319361">derBytes</span><span class="op" id="7319369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319372">if</span>&nbsp;<span class="ident" id="7319375">err</span>&nbsp;<span class="op" id="7319379">!=</span>&nbsp;<span class="ident" id="7319382">nil</span>&nbsp;<span class="op" id="7319386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319390">t</span><span class="op" id="7319391">.</span><span class="ident" id="7319392">Fatal</span><span class="op" id="7319397">(</span><span class="ident" id="7319398">err</span><span class="op" id="7319401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319404">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319408">return</span>&nbsp;<span class="ident" id="7319415">csr</span><br>
<span class="lineno"></span><span class="op" id="7319419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7319422">func</span>&nbsp;<span class="ident" id="7319427">TestCertificateRequestOverrides</span><span class="op" id="7319458">(</span><span class="ident" id="7319459">t</span>&nbsp;<span class="op" id="7319461">*</span><span class="ident" id="7319462">testing</span><span class="op" id="7319469">.</span><span class="ident" id="7319470">T</span><span class="op" id="7319471">)</span>&nbsp;<span class="op" id="7319473">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319476">sanContents</span><span class="op" id="7319487">,</span>&nbsp;<span class="ident" id="7319489">err</span>&nbsp;<span class="op" id="7319493">:=</span>&nbsp;<span class="ident" id="7319496">marshalSANs</span><span class="op" id="7319507">(</span><span class="op" id="7319508">[</span><span class="op" id="7319509">]</span><span class="builtintype" id="7319510">string</span><span class="op" id="7319516">{</span><span class="string" id="7319517">&#34;foo.example.com&#34;</span><span class="op" id="7319534">}</span><span class="op" id="7319535">,</span>&nbsp;<span class="ident" id="7319537">nil</span><span class="op" id="7319540">,</span>&nbsp;<span class="ident" id="7319542">nil</span><span class="op" id="7319545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319548">if</span>&nbsp;<span class="ident" id="7319551">err</span>&nbsp;<span class="op" id="7319555">!=</span>&nbsp;<span class="ident" id="7319558">nil</span>&nbsp;<span class="op" id="7319562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319566">t</span><span class="op" id="7319567">.</span><span class="ident" id="7319568">Fatal</span><span class="op" id="7319573">(</span><span class="ident" id="7319574">err</span><span class="op" id="7319577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319584">template</span>&nbsp;<span class="op" id="7319593">:=</span>&nbsp;<span class="ident" id="7319596">CertificateRequest</span><span class="op" id="7319614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319618">Subject</span><span class="op" id="7319625">:</span>&nbsp;<span class="ident" id="7319627">pkix</span><span class="op" id="7319631">.</span><span class="ident" id="7319632">Name</span><span class="op" id="7319636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319641">CommonName</span><span class="op" id="7319651">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7319655">&#34;test.example.com&#34;</span><span class="op" id="7319673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319678">Organization</span><span class="op" id="7319690">:</span>&nbsp;<span class="op" id="7319692">[</span><span class="op" id="7319693">]</span><span class="builtintype" id="7319694">string</span><span class="op" id="7319700">{</span><span class="string" id="7319701">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7319713">}</span><span class="op" id="7319714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319718">}</span><span class="op" id="7319719">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319723">DNSNames</span><span class="op" id="7319731">:</span>&nbsp;<span class="op" id="7319733">[</span><span class="op" id="7319734">]</span><span class="builtintype" id="7319735">string</span><span class="op" id="7319741">{</span><span class="string" id="7319742">&#34;test.example.com&#34;</span><span class="op" id="7319760">}</span><span class="op" id="7319761">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7319766">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7319831">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319846">ExtraExtensions</span><span class="op" id="7319861">:</span>&nbsp;<span class="op" id="7319863">[</span><span class="op" id="7319864">]</span><span class="ident" id="7319865">pkix</span><span class="op" id="7319869">.</span><span class="ident" id="7319870">Extension</span><span class="op" id="7319879">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319890">Id</span><span class="op" id="7319892">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7319897">oidExtensionSubjectAltName</span><span class="op" id="7319923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319929">Value</span><span class="op" id="7319934">:</span>&nbsp;<span class="ident" id="7319936">sanContents</span><span class="op" id="7319947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319952">}</span><span class="op" id="7319953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319957">}</span><span class="op" id="7319958">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319965">csr</span>&nbsp;<span class="op" id="7319969">:=</span>&nbsp;<span class="ident" id="7319972">marshalAndParseCSR</span><span class="op" id="7319990">(</span><span class="ident" id="7319991">t</span><span class="op" id="7319992">,</span>&nbsp;<span class="op" id="7319994">&amp;</span><span class="ident" id="7319995">template</span><span class="op" id="7320003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320007">if</span>&nbsp;<span class="builtinfunc" id="7320010">len</span><span class="op" id="7320013">(</span><span class="ident" id="7320014">csr</span><span class="op" id="7320017">.</span><span class="ident" id="7320018">DNSNames</span><span class="op" id="7320026">)</span>&nbsp;<span class="op" id="7320028">!=</span>&nbsp;<span class="num" id="7320031">1</span>&nbsp;<span class="op" id="7320033">||</span>&nbsp;<span class="ident" id="7320036">csr</span><span class="op" id="7320039">.</span><span class="ident" id="7320040">DNSNames</span><span class="op" id="7320048">[</span><span class="num" id="7320049">0</span><span class="op" id="7320050">]</span>&nbsp;<span class="op" id="7320052">!=</span>&nbsp;<span class="string" id="7320055">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7320073">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320077">t</span><span class="op" id="7320078">.</span><span class="ident" id="7320079">Errorf</span><span class="op" id="7320085">(</span><span class="string" id="7320086">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7320133">,</span>&nbsp;<span class="ident" id="7320135">csr</span><span class="op" id="7320138">.</span><span class="ident" id="7320139">DNSNames</span><span class="op" id="7320147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7320154">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7320222">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7320292">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320328">template</span><span class="op" id="7320336">.</span><span class="ident" id="7320337">Attributes</span>&nbsp;<span class="op" id="7320348">=</span>&nbsp;<span class="op" id="7320350">[</span><span class="op" id="7320351">]</span><span class="ident" id="7320352">pkix</span><span class="op" id="7320356">.</span><span class="ident" id="7320357">AttributeTypeAndValueSET</span><span class="op" id="7320381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320390">Type</span><span class="op" id="7320394">:</span>&nbsp;<span class="ident" id="7320396">oidExtensionRequest</span><span class="op" id="7320415">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320420">Value</span><span class="op" id="7320425">:</span>&nbsp;<span class="op" id="7320427">[</span><span class="op" id="7320428">]</span><span class="op" id="7320429">[</span><span class="op" id="7320430">]</span><span class="ident" id="7320431">pkix</span><span class="op" id="7320435">.</span><span class="ident" id="7320436">AttributeTypeAndValue</span><span class="op" id="7320457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320478">Type</span><span class="op" id="7320482">:</span>&nbsp;&nbsp;<span class="ident" id="7320485">oidExtensionAuthorityInfoAccess</span><span class="op" id="7320516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320524">Value</span><span class="op" id="7320529">:</span>&nbsp;<span class="op" id="7320531">[</span><span class="op" id="7320532">]</span><span class="builtintype" id="7320533">byte</span><span class="op" id="7320537">(</span><span class="string" id="7320538">&#34;foo&#34;</span><span class="op" id="7320543">)</span><span class="op" id="7320544">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320551">}</span><span class="op" id="7320552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320558">}</span><span class="op" id="7320559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320564">}</span><span class="op" id="7320565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320569">}</span><span class="op" id="7320570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320573">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320577">csr</span>&nbsp;<span class="op" id="7320581">=</span>&nbsp;<span class="ident" id="7320583">marshalAndParseCSR</span><span class="op" id="7320601">(</span><span class="ident" id="7320602">t</span><span class="op" id="7320603">,</span>&nbsp;<span class="op" id="7320605">&amp;</span><span class="ident" id="7320606">template</span><span class="op" id="7320614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320617">if</span>&nbsp;<span class="ident" id="7320620">l</span>&nbsp;<span class="op" id="7320622">:=</span>&nbsp;<span class="builtinfunc" id="7320625">len</span><span class="op" id="7320628">(</span><span class="ident" id="7320629">csr</span><span class="op" id="7320632">.</span><span class="ident" id="7320633">Attributes</span><span class="op" id="7320643">)</span><span class="op" id="7320644">;</span>&nbsp;<span class="ident" id="7320646">l</span>&nbsp;<span class="op" id="7320648">!=</span>&nbsp;<span class="num" id="7320651">1</span>&nbsp;<span class="op" id="7320653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320657">t</span><span class="op" id="7320658">.</span><span class="ident" id="7320659">Errorf</span><span class="op" id="7320665">(</span><span class="string" id="7320666">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7320704">,</span>&nbsp;<span class="ident" id="7320706">l</span><span class="op" id="7320707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320710">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320714">if</span>&nbsp;<span class="op" id="7320717">!</span><span class="ident" id="7320718">csr</span><span class="op" id="7320721">.</span><span class="ident" id="7320722">Attributes</span><span class="op" id="7320732">[</span><span class="num" id="7320733">0</span><span class="op" id="7320734">]</span><span class="op" id="7320735">.</span><span class="ident" id="7320736">Type</span><span class="op" id="7320740">.</span><span class="ident" id="7320741">Equal</span><span class="op" id="7320746">(</span><span class="ident" id="7320747">oidExtensionRequest</span><span class="op" id="7320766">)</span>&nbsp;<span class="op" id="7320768">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7320773">len</span><span class="op" id="7320776">(</span><span class="ident" id="7320777">csr</span><span class="op" id="7320780">.</span><span class="ident" id="7320781">Attributes</span><span class="op" id="7320791">[</span><span class="num" id="7320792">0</span><span class="op" id="7320793">]</span><span class="op" id="7320794">.</span><span class="ident" id="7320795">Value</span><span class="op" id="7320800">)</span>&nbsp;<span class="op" id="7320802">!=</span>&nbsp;<span class="num" id="7320805">1</span>&nbsp;<span class="op" id="7320807">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7320812">len</span><span class="op" id="7320815">(</span><span class="ident" id="7320816">csr</span><span class="op" id="7320819">.</span><span class="ident" id="7320820">Attributes</span><span class="op" id="7320830">[</span><span class="num" id="7320831">0</span><span class="op" id="7320832">]</span><span class="op" id="7320833">.</span><span class="ident" id="7320834">Value</span><span class="op" id="7320839">[</span><span class="num" id="7320840">0</span><span class="op" id="7320841">]</span><span class="op" id="7320842">)</span>&nbsp;<span class="op" id="7320844">!=</span>&nbsp;<span class="num" id="7320847">2</span>&nbsp;<span class="op" id="7320849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320853">t</span><span class="op" id="7320854">.</span><span class="ident" id="7320855">Errorf</span><span class="op" id="7320861">(</span><span class="string" id="7320862">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7320885">,</span>&nbsp;<span class="ident" id="7320887">csr</span><span class="op" id="7320890">.</span><span class="ident" id="7320891">Attributes</span><span class="op" id="7320901">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320908">sanContents2</span><span class="op" id="7320920">,</span>&nbsp;<span class="ident" id="7320922">err</span>&nbsp;<span class="op" id="7320926">:=</span>&nbsp;<span class="ident" id="7320929">marshalSANs</span><span class="op" id="7320940">(</span><span class="op" id="7320941">[</span><span class="op" id="7320942">]</span><span class="builtintype" id="7320943">string</span><span class="op" id="7320949">{</span><span class="string" id="7320950">&#34;foo2.example.com&#34;</span><span class="op" id="7320968">}</span><span class="op" id="7320969">,</span>&nbsp;<span class="ident" id="7320971">nil</span><span class="op" id="7320974">,</span>&nbsp;<span class="ident" id="7320976">nil</span><span class="op" id="7320979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320982">if</span>&nbsp;<span class="ident" id="7320985">err</span>&nbsp;<span class="op" id="7320989">!=</span>&nbsp;<span class="ident" id="7320992">nil</span>&nbsp;<span class="op" id="7320996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321000">t</span><span class="op" id="7321001">.</span><span class="ident" id="7321002">Fatal</span><span class="op" id="7321007">(</span><span class="ident" id="7321008">err</span><span class="op" id="7321011">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7321018">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321089">template</span><span class="op" id="7321097">.</span><span class="ident" id="7321098">Attributes</span><span class="op" id="7321108">[</span><span class="num" id="7321109">0</span><span class="op" id="7321110">]</span><span class="op" id="7321111">.</span><span class="ident" id="7321112">Value</span><span class="op" id="7321117">[</span><span class="num" id="7321118">0</span><span class="op" id="7321119">]</span>&nbsp;<span class="op" id="7321121">=</span>&nbsp;<span class="builtinfunc" id="7321123">append</span><span class="op" id="7321129">(</span><span class="ident" id="7321130">template</span><span class="op" id="7321138">.</span><span class="ident" id="7321139">Attributes</span><span class="op" id="7321149">[</span><span class="num" id="7321150">0</span><span class="op" id="7321151">]</span><span class="op" id="7321152">.</span><span class="ident" id="7321153">Value</span><span class="op" id="7321158">[</span><span class="num" id="7321159">0</span><span class="op" id="7321160">]</span><span class="op" id="7321161">,</span>&nbsp;<span class="ident" id="7321163">pkix</span><span class="op" id="7321167">.</span><span class="ident" id="7321168">AttributeTypeAndValue</span><span class="op" id="7321189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321193">Type</span><span class="op" id="7321197">:</span>&nbsp;&nbsp;<span class="ident" id="7321200">oidExtensionSubjectAltName</span><span class="op" id="7321226">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321230">Value</span><span class="op" id="7321235">:</span>&nbsp;<span class="ident" id="7321237">sanContents2</span><span class="op" id="7321249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321252">}</span><span class="op" id="7321253">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321257">csr</span>&nbsp;<span class="op" id="7321261">=</span>&nbsp;<span class="ident" id="7321263">marshalAndParseCSR</span><span class="op" id="7321281">(</span><span class="ident" id="7321282">t</span><span class="op" id="7321283">,</span>&nbsp;<span class="op" id="7321285">&amp;</span><span class="ident" id="7321286">template</span><span class="op" id="7321294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321298">if</span>&nbsp;<span class="builtinfunc" id="7321301">len</span><span class="op" id="7321304">(</span><span class="ident" id="7321305">csr</span><span class="op" id="7321308">.</span><span class="ident" id="7321309">DNSNames</span><span class="op" id="7321317">)</span>&nbsp;<span class="op" id="7321319">!=</span>&nbsp;<span class="num" id="7321322">1</span>&nbsp;<span class="op" id="7321324">||</span>&nbsp;<span class="ident" id="7321327">csr</span><span class="op" id="7321330">.</span><span class="ident" id="7321331">DNSNames</span><span class="op" id="7321339">[</span><span class="num" id="7321340">0</span><span class="op" id="7321341">]</span>&nbsp;<span class="op" id="7321343">!=</span>&nbsp;<span class="string" id="7321346">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7321365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321369">t</span><span class="op" id="7321370">.</span><span class="ident" id="7321371">Errorf</span><span class="op" id="7321377">(</span><span class="string" id="7321378">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7321433">,</span>&nbsp;<span class="ident" id="7321435">csr</span><span class="op" id="7321438">.</span><span class="ident" id="7321439">DNSNames</span><span class="op" id="7321447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321450">}</span><br>
<span class="lineno"></span><span class="op" id="7321452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7321455">func</span>&nbsp;<span class="ident" id="7321460">TestParseCertificateRequest</span><span class="op" id="7321487">(</span><span class="ident" id="7321488">t</span>&nbsp;<span class="op" id="7321490">*</span><span class="ident" id="7321491">testing</span><span class="op" id="7321498">.</span><span class="ident" id="7321499">T</span><span class="op" id="7321500">)</span>&nbsp;<span class="op" id="7321502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321505">csrBytes</span>&nbsp;<span class="op" id="7321514">:=</span>&nbsp;<span class="ident" id="7321517">fromBase64</span><span class="op" id="7321527">(</span><span class="ident" id="7321528">csrBase64</span><span class="op" id="7321537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321540">csr</span><span class="op" id="7321543">,</span>&nbsp;<span class="ident" id="7321545">err</span>&nbsp;<span class="op" id="7321549">:=</span>&nbsp;<span class="ident" id="7321552">ParseCertificateRequest</span><span class="op" id="7321575">(</span><span class="ident" id="7321576">csrBytes</span><span class="op" id="7321584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321587">if</span>&nbsp;<span class="ident" id="7321590">err</span>&nbsp;<span class="op" id="7321594">!=</span>&nbsp;<span class="ident" id="7321597">nil</span>&nbsp;<span class="op" id="7321601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321605">t</span><span class="op" id="7321606">.</span><span class="ident" id="7321607">Fatalf</span><span class="op" id="7321613">(</span><span class="string" id="7321614">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7321639">,</span>&nbsp;<span class="ident" id="7321641">err</span><span class="op" id="7321644">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321651">if</span>&nbsp;<span class="builtinfunc" id="7321654">len</span><span class="op" id="7321657">(</span><span class="ident" id="7321658">csr</span><span class="op" id="7321661">.</span><span class="ident" id="7321662">EmailAddresses</span><span class="op" id="7321676">)</span>&nbsp;<span class="op" id="7321678">!=</span>&nbsp;<span class="num" id="7321681">1</span>&nbsp;<span class="op" id="7321683">||</span>&nbsp;<span class="ident" id="7321686">csr</span><span class="op" id="7321689">.</span><span class="ident" id="7321690">EmailAddresses</span><span class="op" id="7321704">[</span><span class="num" id="7321705">0</span><span class="op" id="7321706">]</span>&nbsp;<span class="op" id="7321708">!=</span>&nbsp;<span class="string" id="7321711">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7321731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321735">t</span><span class="op" id="7321736">.</span><span class="ident" id="7321737">Errorf</span><span class="op" id="7321743">(</span><span class="string" id="7321744">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7321781">,</span>&nbsp;<span class="ident" id="7321783">csr</span><span class="op" id="7321786">.</span><span class="ident" id="7321787">EmailAddresses</span><span class="op" id="7321801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321804">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321808">if</span>&nbsp;<span class="builtinfunc" id="7321811">len</span><span class="op" id="7321814">(</span><span class="ident" id="7321815">csr</span><span class="op" id="7321818">.</span><span class="ident" id="7321819">DNSNames</span><span class="op" id="7321827">)</span>&nbsp;<span class="op" id="7321829">!=</span>&nbsp;<span class="num" id="7321832">1</span>&nbsp;<span class="op" id="7321834">||</span>&nbsp;<span class="ident" id="7321837">csr</span><span class="op" id="7321840">.</span><span class="ident" id="7321841">DNSNames</span><span class="op" id="7321849">[</span><span class="num" id="7321850">0</span><span class="op" id="7321851">]</span>&nbsp;<span class="op" id="7321853">!=</span>&nbsp;<span class="string" id="7321856">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7321875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321879">t</span><span class="op" id="7321880">.</span><span class="ident" id="7321881">Errorf</span><span class="op" id="7321887">(</span><span class="string" id="7321888">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7321919">,</span>&nbsp;<span class="ident" id="7321921">csr</span><span class="op" id="7321924">.</span><span class="ident" id="7321925">DNSNames</span><span class="op" id="7321933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321940">if</span>&nbsp;<span class="builtinfunc" id="7321943">len</span><span class="op" id="7321946">(</span><span class="ident" id="7321947">csr</span><span class="op" id="7321950">.</span><span class="ident" id="7321951">Subject</span><span class="op" id="7321958">.</span><span class="ident" id="7321959">Country</span><span class="op" id="7321966">)</span>&nbsp;<span class="op" id="7321968">!=</span>&nbsp;<span class="num" id="7321971">1</span>&nbsp;<span class="op" id="7321973">||</span>&nbsp;<span class="ident" id="7321976">csr</span><span class="op" id="7321979">.</span><span class="ident" id="7321980">Subject</span><span class="op" id="7321987">.</span><span class="ident" id="7321988">Country</span><span class="op" id="7321995">[</span><span class="num" id="7321996">0</span><span class="op" id="7321997">]</span>&nbsp;<span class="op" id="7321999">!=</span>&nbsp;<span class="string" id="7322002">&#34;AU&#34;</span>&nbsp;<span class="op" id="7322007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322011">t</span><span class="op" id="7322012">.</span><span class="ident" id="7322013">Errorf</span><span class="op" id="7322019">(</span><span class="string" id="7322020">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7322048">,</span>&nbsp;<span class="ident" id="7322050">csr</span><span class="op" id="7322053">.</span><span class="ident" id="7322054">Subject</span><span class="op" id="7322061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322068">found</span>&nbsp;<span class="op" id="7322074">:=</span>&nbsp;<span class="builtintype" id="7322077">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322084">for</span>&nbsp;<span class="ident" id="7322088">_</span><span class="op" id="7322089">,</span>&nbsp;<span class="ident" id="7322091">e</span>&nbsp;<span class="op" id="7322093">:=</span>&nbsp;<span class="keyword" id="7322096">range</span>&nbsp;<span class="ident" id="7322102">csr</span><span class="op" id="7322105">.</span><span class="ident" id="7322106">Extensions</span>&nbsp;<span class="op" id="7322117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322121">if</span>&nbsp;<span class="ident" id="7322124">e</span><span class="op" id="7322125">.</span><span class="ident" id="7322126">Id</span><span class="op" id="7322128">.</span><span class="ident" id="7322129">Equal</span><span class="op" id="7322134">(</span><span class="ident" id="7322135">oidExtensionBasicConstraints</span><span class="op" id="7322163">)</span>&nbsp;<span class="op" id="7322165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322170">found</span>&nbsp;<span class="op" id="7322176">=</span>&nbsp;<span class="builtintype" id="7322178">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322186">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322194">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322200">if</span>&nbsp;<span class="op" id="7322203">!</span><span class="ident" id="7322204">found</span>&nbsp;<span class="op" id="7322210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322214">t</span><span class="op" id="7322215">.</span><span class="ident" id="7322216">Errorf</span><span class="op" id="7322222">(</span><span class="string" id="7322223">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7322269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322272">}</span><br>
<span class="lineno"></span><span class="op" id="7322274">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7322277">func</span>&nbsp;<span class="ident" id="7322282">TestMaxPathLen</span><span class="op" id="7322296">(</span><span class="ident" id="7322297">t</span>&nbsp;<span class="op" id="7322299">*</span><span class="ident" id="7322300">testing</span><span class="op" id="7322307">.</span><span class="ident" id="7322308">T</span><span class="op" id="7322309">)</span>&nbsp;<span class="op" id="7322311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322314">block</span><span class="op" id="7322319">,</span>&nbsp;<span class="ident" id="7322321">_</span>&nbsp;<span class="op" id="7322323">:=</span>&nbsp;<span class="ident" id="7322326">pem</span><span class="op" id="7322329">.</span><span class="ident" id="7322330">Decode</span><span class="op" id="7322336">(</span><span class="op" id="7322337">[</span><span class="op" id="7322338">]</span><span class="builtintype" id="7322339">byte</span><span class="op" id="7322343">(</span><span class="ident" id="7322344">pemPrivateKey</span><span class="op" id="7322357">)</span><span class="op" id="7322358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322361">rsaPriv</span><span class="op" id="7322368">,</span>&nbsp;<span class="ident" id="7322370">err</span>&nbsp;<span class="op" id="7322374">:=</span>&nbsp;<span class="ident" id="7322377">ParsePKCS1PrivateKey</span><span class="op" id="7322397">(</span><span class="ident" id="7322398">block</span><span class="op" id="7322403">.</span><span class="ident" id="7322404">Bytes</span><span class="op" id="7322409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322412">if</span>&nbsp;<span class="ident" id="7322415">err</span>&nbsp;<span class="op" id="7322419">!=</span>&nbsp;<span class="ident" id="7322422">nil</span>&nbsp;<span class="op" id="7322426">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322430">t</span><span class="op" id="7322431">.</span><span class="ident" id="7322432">Fatalf</span><span class="op" id="7322438">(</span><span class="string" id="7322439">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7322472">,</span>&nbsp;<span class="ident" id="7322474">err</span><span class="op" id="7322477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322484">template</span>&nbsp;<span class="op" id="7322493">:=</span>&nbsp;<span class="op" id="7322496">&amp;</span><span class="ident" id="7322497">Certificate</span><span class="op" id="7322508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322512">SerialNumber</span><span class="op" id="7322524">:</span>&nbsp;<span class="ident" id="7322526">big</span><span class="op" id="7322529">.</span><span class="ident" id="7322530">NewInt</span><span class="op" id="7322536">(</span><span class="num" id="7322537">1</span><span class="op" id="7322538">)</span><span class="op" id="7322539">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322543">Subject</span><span class="op" id="7322550">:</span>&nbsp;<span class="ident" id="7322552">pkix</span><span class="op" id="7322556">.</span><span class="ident" id="7322557">Name</span><span class="op" id="7322561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322566">CommonName</span><span class="op" id="7322576">:</span>&nbsp;<span class="string" id="7322578">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7322590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322594">}</span><span class="op" id="7322595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322599">NotBefore</span><span class="op" id="7322608">:</span>&nbsp;<span class="ident" id="7322610">time</span><span class="op" id="7322614">.</span><span class="ident" id="7322615">Unix</span><span class="op" id="7322619">(</span><span class="num" id="7322620">1000</span><span class="op" id="7322624">,</span>&nbsp;<span class="num" id="7322626">0</span><span class="op" id="7322627">)</span><span class="op" id="7322628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322632">NotAfter</span><span class="op" id="7322640">:</span>&nbsp;&nbsp;<span class="ident" id="7322643">time</span><span class="op" id="7322647">.</span><span class="ident" id="7322648">Unix</span><span class="op" id="7322652">(</span><span class="num" id="7322653">100000</span><span class="op" id="7322659">,</span>&nbsp;<span class="num" id="7322661">0</span><span class="op" id="7322662">)</span><span class="op" id="7322663">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322668">BasicConstraintsValid</span><span class="op" id="7322689">:</span>&nbsp;<span class="builtintype" id="7322691">true</span><span class="op" id="7322695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322699">IsCA</span><span class="op" id="7322703">:</span>&nbsp;<span class="builtintype" id="7322705">true</span><span class="op" id="7322709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322716">serialiseAndParse</span>&nbsp;<span class="op" id="7322734">:=</span>&nbsp;<span class="keyword" id="7322737">func</span><span class="op" id="7322741">(</span><span class="ident" id="7322742">template</span>&nbsp;<span class="op" id="7322751">*</span><span class="ident" id="7322752">Certificate</span><span class="op" id="7322763">)</span>&nbsp;<span class="op" id="7322765">*</span><span class="ident" id="7322766">Certificate</span>&nbsp;<span class="op" id="7322778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322782">derBytes</span><span class="op" id="7322790">,</span>&nbsp;<span class="ident" id="7322792">err</span>&nbsp;<span class="op" id="7322796">:=</span>&nbsp;<span class="ident" id="7322799">CreateCertificate</span><span class="op" id="7322816">(</span><span class="ident" id="7322817">rand</span><span class="op" id="7322821">.</span><span class="ident" id="7322822">Reader</span><span class="op" id="7322828">,</span>&nbsp;<span class="ident" id="7322830">template</span><span class="op" id="7322838">,</span>&nbsp;<span class="ident" id="7322840">template</span><span class="op" id="7322848">,</span>&nbsp;<span class="op" id="7322850">&amp;</span><span class="ident" id="7322851">rsaPriv</span><span class="op" id="7322858">.</span><span class="ident" id="7322859">PublicKey</span><span class="op" id="7322868">,</span>&nbsp;<span class="ident" id="7322870">rsaPriv</span><span class="op" id="7322877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322881">if</span>&nbsp;<span class="ident" id="7322884">err</span>&nbsp;<span class="op" id="7322888">!=</span>&nbsp;<span class="ident" id="7322891">nil</span>&nbsp;<span class="op" id="7322895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322900">t</span><span class="op" id="7322901">.</span><span class="ident" id="7322902">Fatalf</span><span class="op" id="7322908">(</span><span class="string" id="7322909">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7322943">,</span>&nbsp;<span class="ident" id="7322945">err</span><span class="op" id="7322948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322953">return</span>&nbsp;<span class="ident" id="7322960">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322971">cert</span><span class="op" id="7322975">,</span>&nbsp;<span class="ident" id="7322977">err</span>&nbsp;<span class="op" id="7322981">:=</span>&nbsp;<span class="ident" id="7322984">ParseCertificate</span><span class="op" id="7323000">(</span><span class="ident" id="7323001">derBytes</span><span class="op" id="7323009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323013">if</span>&nbsp;<span class="ident" id="7323016">err</span>&nbsp;<span class="op" id="7323020">!=</span>&nbsp;<span class="ident" id="7323023">nil</span>&nbsp;<span class="op" id="7323027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323032">t</span><span class="op" id="7323033">.</span><span class="ident" id="7323034">Fatalf</span><span class="op" id="7323040">(</span><span class="string" id="7323041">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7323074">,</span>&nbsp;<span class="ident" id="7323076">err</span><span class="op" id="7323079">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323084">return</span>&nbsp;<span class="ident" id="7323091">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323102">return</span>&nbsp;<span class="ident" id="7323109">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323115">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323119">cert1</span>&nbsp;<span class="op" id="7323125">:=</span>&nbsp;<span class="ident" id="7323128">serialiseAndParse</span><span class="op" id="7323145">(</span><span class="ident" id="7323146">template</span><span class="op" id="7323154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323157">if</span>&nbsp;<span class="ident" id="7323160">m</span>&nbsp;<span class="op" id="7323162">:=</span>&nbsp;<span class="ident" id="7323165">cert1</span><span class="op" id="7323170">.</span><span class="ident" id="7323171">MaxPathLen</span><span class="op" id="7323181">;</span>&nbsp;<span class="ident" id="7323183">m</span>&nbsp;<span class="op" id="7323185">!=</span>&nbsp;<span class="op" id="7323188">-</span><span class="num" id="7323189">1</span>&nbsp;<span class="op" id="7323191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323195">t</span><span class="op" id="7323196">.</span><span class="ident" id="7323197">Errorf</span><span class="op" id="7323203">(</span><span class="string" id="7323204">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7323253">,</span>&nbsp;<span class="ident" id="7323255">m</span><span class="op" id="7323256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323259">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323262">if</span>&nbsp;<span class="ident" id="7323265">cert1</span><span class="op" id="7323270">.</span><span class="ident" id="7323271">MaxPathLenZero</span>&nbsp;<span class="op" id="7323286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323290">t</span><span class="op" id="7323291">.</span><span class="ident" id="7323292">Errorf</span><span class="op" id="7323298">(</span><span class="string" id="7323299">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7323347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323354">template</span><span class="op" id="7323362">.</span><span class="ident" id="7323363">MaxPathLen</span>&nbsp;<span class="op" id="7323374">=</span>&nbsp;<span class="num" id="7323376">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323379">cert2</span>&nbsp;<span class="op" id="7323385">:=</span>&nbsp;<span class="ident" id="7323388">serialiseAndParse</span><span class="op" id="7323405">(</span><span class="ident" id="7323406">template</span><span class="op" id="7323414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323417">if</span>&nbsp;<span class="ident" id="7323420">m</span>&nbsp;<span class="op" id="7323422">:=</span>&nbsp;<span class="ident" id="7323425">cert2</span><span class="op" id="7323430">.</span><span class="ident" id="7323431">MaxPathLen</span><span class="op" id="7323441">;</span>&nbsp;<span class="ident" id="7323443">m</span>&nbsp;<span class="op" id="7323445">!=</span>&nbsp;<span class="num" id="7323448">1</span>&nbsp;<span class="op" id="7323450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323454">t</span><span class="op" id="7323455">.</span><span class="ident" id="7323456">Errorf</span><span class="op" id="7323462">(</span><span class="string" id="7323463">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7323513">,</span>&nbsp;<span class="ident" id="7323515">m</span><span class="op" id="7323516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323522">if</span>&nbsp;<span class="ident" id="7323525">cert2</span><span class="op" id="7323530">.</span><span class="ident" id="7323531">MaxPathLenZero</span>&nbsp;<span class="op" id="7323546">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323550">t</span><span class="op" id="7323551">.</span><span class="ident" id="7323552">Errorf</span><span class="op" id="7323558">(</span><span class="string" id="7323559">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7323606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323613">template</span><span class="op" id="7323621">.</span><span class="ident" id="7323622">MaxPathLen</span>&nbsp;<span class="op" id="7323633">=</span>&nbsp;<span class="num" id="7323635">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323638">template</span><span class="op" id="7323646">.</span><span class="ident" id="7323647">MaxPathLenZero</span>&nbsp;<span class="op" id="7323662">=</span>&nbsp;<span class="builtintype" id="7323664">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323670">cert3</span>&nbsp;<span class="op" id="7323676">:=</span>&nbsp;<span class="ident" id="7323679">serialiseAndParse</span><span class="op" id="7323696">(</span><span class="ident" id="7323697">template</span><span class="op" id="7323705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323708">if</span>&nbsp;<span class="ident" id="7323711">m</span>&nbsp;<span class="op" id="7323713">:=</span>&nbsp;<span class="ident" id="7323716">cert3</span><span class="op" id="7323721">.</span><span class="ident" id="7323722">MaxPathLen</span><span class="op" id="7323732">;</span>&nbsp;<span class="ident" id="7323734">m</span>&nbsp;<span class="op" id="7323736">!=</span>&nbsp;<span class="num" id="7323739">0</span>&nbsp;<span class="op" id="7323741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323745">t</span><span class="op" id="7323746">.</span><span class="ident" id="7323747">Errorf</span><span class="op" id="7323753">(</span><span class="string" id="7323754">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7323798">,</span>&nbsp;<span class="ident" id="7323800">m</span><span class="op" id="7323801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7323807">if</span>&nbsp;<span class="op" id="7323810">!</span><span class="ident" id="7323811">cert3</span><span class="op" id="7323816">.</span><span class="ident" id="7323817">MaxPathLenZero</span>&nbsp;<span class="op" id="7323832">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323836">t</span><span class="op" id="7323837">.</span><span class="ident" id="7323838">Errorf</span><span class="op" id="7323844">(</span><span class="string" id="7323845">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7323905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323908">}</span><br>
<span class="lineno"></span><span class="op" id="7323910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7323913">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7323953">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7324054">//</span><br>
<span class="lineno"></span><span class="comment" id="7324057">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7324107">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7324123">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7324156">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7324222">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7324289">const</span>&nbsp;<span class="ident" id="7324295">csrBase64</span>&nbsp;<span class="op" id="7324305">=</span>&nbsp;<span class="string" id="7324307">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
