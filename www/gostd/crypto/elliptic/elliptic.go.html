<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html" class="current">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4878286">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4878341">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4878395">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4878446">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4878521">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4878532">package</span>&nbsp;<span class="ident" id="4878540">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4878550">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4878625">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4878700">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4878780">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4878855">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4878929">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4878994">import</span>&nbsp;<span class="op" id="4879001">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4879004">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4879010">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4879022">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4879029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4879032">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4879096">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4879157">type</span>&nbsp;<span class="ident" id="4879162">Curve</span>&nbsp;<span class="keyword" id="4879168">interface</span>&nbsp;<span class="op" id="4879178">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879181">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879230">Params</span><span class="op" id="4879236">(</span><span class="op" id="4879237">)</span>&nbsp;<span class="op" id="4879239">*</span><span class="ident" id="4879240">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879253">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879318">IsOnCurve</span><span class="op" id="4879327">(</span><span class="ident" id="4879328">x</span><span class="op" id="4879329">,</span>&nbsp;<span class="ident" id="4879331">y</span>&nbsp;<span class="op" id="4879333">*</span><span class="ident" id="4879334">big</span><span class="op" id="4879337">.</span><span class="ident" id="4879338">Int</span><span class="op" id="4879341">)</span>&nbsp;<span class="builtintype" id="4879343">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879349">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879396">Add</span><span class="op" id="4879399">(</span><span class="ident" id="4879400">x1</span><span class="op" id="4879402">,</span>&nbsp;<span class="ident" id="4879404">y1</span><span class="op" id="4879406">,</span>&nbsp;<span class="ident" id="4879408">x2</span><span class="op" id="4879410">,</span>&nbsp;<span class="ident" id="4879412">y2</span>&nbsp;<span class="op" id="4879415">*</span><span class="ident" id="4879416">big</span><span class="op" id="4879419">.</span><span class="ident" id="4879420">Int</span><span class="op" id="4879423">)</span>&nbsp;<span class="op" id="4879425">(</span><span class="ident" id="4879426">x</span><span class="op" id="4879427">,</span>&nbsp;<span class="ident" id="4879429">y</span>&nbsp;<span class="op" id="4879431">*</span><span class="ident" id="4879432">big</span><span class="op" id="4879435">.</span><span class="ident" id="4879436">Int</span><span class="op" id="4879439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879442">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879469">Double</span><span class="op" id="4879475">(</span><span class="ident" id="4879476">x1</span><span class="op" id="4879478">,</span>&nbsp;<span class="ident" id="4879480">y1</span>&nbsp;<span class="op" id="4879483">*</span><span class="ident" id="4879484">big</span><span class="op" id="4879487">.</span><span class="ident" id="4879488">Int</span><span class="op" id="4879491">)</span>&nbsp;<span class="op" id="4879493">(</span><span class="ident" id="4879494">x</span><span class="op" id="4879495">,</span>&nbsp;<span class="ident" id="4879497">y</span>&nbsp;<span class="op" id="4879499">*</span><span class="ident" id="4879500">big</span><span class="op" id="4879503">.</span><span class="ident" id="4879504">Int</span><span class="op" id="4879507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879510">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879583">ScalarMult</span><span class="op" id="4879593">(</span><span class="ident" id="4879594">x1</span><span class="op" id="4879596">,</span>&nbsp;<span class="ident" id="4879598">y1</span>&nbsp;<span class="op" id="4879601">*</span><span class="ident" id="4879602">big</span><span class="op" id="4879605">.</span><span class="ident" id="4879606">Int</span><span class="op" id="4879609">,</span>&nbsp;<span class="ident" id="4879611">k</span>&nbsp;<span class="op" id="4879613">[</span><span class="op" id="4879614">]</span><span class="builtintype" id="4879615">byte</span><span class="op" id="4879619">)</span>&nbsp;<span class="op" id="4879621">(</span><span class="ident" id="4879622">x</span><span class="op" id="4879623">,</span>&nbsp;<span class="ident" id="4879625">y</span>&nbsp;<span class="op" id="4879627">*</span><span class="ident" id="4879628">big</span><span class="op" id="4879631">.</span><span class="ident" id="4879632">Int</span><span class="op" id="4879635">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879638">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879709">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879753">ScalarBaseMult</span><span class="op" id="4879767">(</span><span class="ident" id="4879768">k</span>&nbsp;<span class="op" id="4879770">[</span><span class="op" id="4879771">]</span><span class="builtintype" id="4879772">byte</span><span class="op" id="4879776">)</span>&nbsp;<span class="op" id="4879778">(</span><span class="ident" id="4879779">x</span><span class="op" id="4879780">,</span>&nbsp;<span class="ident" id="4879782">y</span>&nbsp;<span class="op" id="4879784">*</span><span class="ident" id="4879785">big</span><span class="op" id="4879788">.</span><span class="ident" id="4879789">Int</span><span class="op" id="4879792">)</span><br>
<span class="lineno"></span><span class="op" id="4879794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4879797">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4879875">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4879932">type</span>&nbsp;<span class="ident" id="4879937">CurveParams</span>&nbsp;<span class="keyword" id="4879949">struct</span>&nbsp;<span class="op" id="4879956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879959">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879967">*</span><span class="ident" id="4879968">big</span><span class="op" id="4879971">.</span><span class="ident" id="4879972">Int</span>&nbsp;<span class="comment" id="4879976">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880014">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4880022">*</span><span class="ident" id="4880023">big</span><span class="op" id="4880026">.</span><span class="ident" id="4880027">Int</span>&nbsp;<span class="comment" id="4880031">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880063">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4880071">*</span><span class="ident" id="4880072">big</span><span class="op" id="4880075">.</span><span class="ident" id="4880076">Int</span>&nbsp;<span class="comment" id="4880080">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880119">Gx</span><span class="op" id="4880121">,</span>&nbsp;<span class="ident" id="4880123">Gy</span>&nbsp;&nbsp;<span class="op" id="4880127">*</span><span class="ident" id="4880128">big</span><span class="op" id="4880131">.</span><span class="ident" id="4880132">Int</span>&nbsp;<span class="comment" id="4880136">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880164">BitSize</span>&nbsp;<span class="builtintype" id="4880172">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880181">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4880217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4880220">func</span>&nbsp;<span class="op" id="4880225">(</span><span class="ident" id="4880226">curve</span>&nbsp;<span class="op" id="4880232">*</span><span class="ident" id="4880233">CurveParams</span><span class="op" id="4880244">)</span>&nbsp;<span class="ident" id="4880246">Params</span><span class="op" id="4880252">(</span><span class="op" id="4880253">)</span>&nbsp;<span class="op" id="4880255">*</span><span class="ident" id="4880256">CurveParams</span>&nbsp;<span class="op" id="4880268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880271">return</span>&nbsp;<span class="ident" id="4880278">curve</span><br>
<span class="lineno"></span><span class="op" id="4880284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4880287">func</span>&nbsp;<span class="op" id="4880292">(</span><span class="ident" id="4880293">curve</span>&nbsp;<span class="op" id="4880299">*</span><span class="ident" id="4880300">CurveParams</span><span class="op" id="4880311">)</span>&nbsp;<span class="ident" id="4880313">IsOnCurve</span><span class="op" id="4880322">(</span><span class="ident" id="4880323">x</span><span class="op" id="4880324">,</span>&nbsp;<span class="ident" id="4880326">y</span>&nbsp;<span class="op" id="4880328">*</span><span class="ident" id="4880329">big</span><span class="op" id="4880332">.</span><span class="ident" id="4880333">Int</span><span class="op" id="4880336">)</span>&nbsp;<span class="builtintype" id="4880338">bool</span>&nbsp;<span class="op" id="4880343">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4880346">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880369">y2</span>&nbsp;<span class="op" id="4880372">:=</span>&nbsp;<span class="builtinfunc" id="4880375">new</span><span class="op" id="4880378">(</span><span class="ident" id="4880379">big</span><span class="op" id="4880382">.</span><span class="ident" id="4880383">Int</span><span class="op" id="4880386">)</span><span class="op" id="4880387">.</span><span class="ident" id="4880388">Mul</span><span class="op" id="4880391">(</span><span class="ident" id="4880392">y</span><span class="op" id="4880393">,</span>&nbsp;<span class="ident" id="4880395">y</span><span class="op" id="4880396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880399">y2</span><span class="op" id="4880401">.</span><span class="ident" id="4880402">Mod</span><span class="op" id="4880405">(</span><span class="ident" id="4880406">y2</span><span class="op" id="4880408">,</span>&nbsp;<span class="ident" id="4880410">curve</span><span class="op" id="4880415">.</span><span class="ident" id="4880416">P</span><span class="op" id="4880417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880421">x3</span>&nbsp;<span class="op" id="4880424">:=</span>&nbsp;<span class="builtinfunc" id="4880427">new</span><span class="op" id="4880430">(</span><span class="ident" id="4880431">big</span><span class="op" id="4880434">.</span><span class="ident" id="4880435">Int</span><span class="op" id="4880438">)</span><span class="op" id="4880439">.</span><span class="ident" id="4880440">Mul</span><span class="op" id="4880443">(</span><span class="ident" id="4880444">x</span><span class="op" id="4880445">,</span>&nbsp;<span class="ident" id="4880447">x</span><span class="op" id="4880448">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880451">x3</span><span class="op" id="4880453">.</span><span class="ident" id="4880454">Mul</span><span class="op" id="4880457">(</span><span class="ident" id="4880458">x3</span><span class="op" id="4880460">,</span>&nbsp;<span class="ident" id="4880462">x</span><span class="op" id="4880463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880467">threeX</span>&nbsp;<span class="op" id="4880474">:=</span>&nbsp;<span class="builtinfunc" id="4880477">new</span><span class="op" id="4880480">(</span><span class="ident" id="4880481">big</span><span class="op" id="4880484">.</span><span class="ident" id="4880485">Int</span><span class="op" id="4880488">)</span><span class="op" id="4880489">.</span><span class="ident" id="4880490">Lsh</span><span class="op" id="4880493">(</span><span class="ident" id="4880494">x</span><span class="op" id="4880495">,</span>&nbsp;<span class="num" id="4880497">1</span><span class="op" id="4880498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880501">threeX</span><span class="op" id="4880507">.</span><span class="ident" id="4880508">Add</span><span class="op" id="4880511">(</span><span class="ident" id="4880512">threeX</span><span class="op" id="4880518">,</span>&nbsp;<span class="ident" id="4880520">x</span><span class="op" id="4880521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880525">x3</span><span class="op" id="4880527">.</span><span class="ident" id="4880528">Sub</span><span class="op" id="4880531">(</span><span class="ident" id="4880532">x3</span><span class="op" id="4880534">,</span>&nbsp;<span class="ident" id="4880536">threeX</span><span class="op" id="4880542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880545">x3</span><span class="op" id="4880547">.</span><span class="ident" id="4880548">Add</span><span class="op" id="4880551">(</span><span class="ident" id="4880552">x3</span><span class="op" id="4880554">,</span>&nbsp;<span class="ident" id="4880556">curve</span><span class="op" id="4880561">.</span><span class="ident" id="4880562">B</span><span class="op" id="4880563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880566">x3</span><span class="op" id="4880568">.</span><span class="ident" id="4880569">Mod</span><span class="op" id="4880572">(</span><span class="ident" id="4880573">x3</span><span class="op" id="4880575">,</span>&nbsp;<span class="ident" id="4880577">curve</span><span class="op" id="4880582">.</span><span class="ident" id="4880583">P</span><span class="op" id="4880584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880588">return</span>&nbsp;<span class="ident" id="4880595">x3</span><span class="op" id="4880597">.</span><span class="ident" id="4880598">Cmp</span><span class="op" id="4880601">(</span><span class="ident" id="4880602">y2</span><span class="op" id="4880604">)</span>&nbsp;<span class="op" id="4880606">==</span>&nbsp;<span class="num" id="4880609">0</span><br>
<span class="lineno">70</span><span class="op" id="4880611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4880614">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4880693">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4880773">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4880825">func</span>&nbsp;<span class="ident" id="4880830">zForAffine</span><span class="op" id="4880840">(</span><span class="ident" id="4880841">x</span><span class="op" id="4880842">,</span>&nbsp;<span class="ident" id="4880844">y</span>&nbsp;<span class="op" id="4880846">*</span><span class="ident" id="4880847">big</span><span class="op" id="4880850">.</span><span class="ident" id="4880851">Int</span><span class="op" id="4880854">)</span>&nbsp;<span class="op" id="4880856">*</span><span class="ident" id="4880857">big</span><span class="op" id="4880860">.</span><span class="ident" id="4880861">Int</span>&nbsp;<span class="op" id="4880865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880868">z</span>&nbsp;<span class="op" id="4880870">:=</span>&nbsp;<span class="builtinfunc" id="4880873">new</span><span class="op" id="4880876">(</span><span class="ident" id="4880877">big</span><span class="op" id="4880880">.</span><span class="ident" id="4880881">Int</span><span class="op" id="4880884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880887">if</span>&nbsp;<span class="ident" id="4880890">x</span><span class="op" id="4880891">.</span><span class="ident" id="4880892">Sign</span><span class="op" id="4880896">(</span><span class="op" id="4880897">)</span>&nbsp;<span class="op" id="4880899">!=</span>&nbsp;<span class="num" id="4880902">0</span>&nbsp;<span class="op" id="4880904">||</span>&nbsp;<span class="ident" id="4880907">y</span><span class="op" id="4880908">.</span><span class="ident" id="4880909">Sign</span><span class="op" id="4880913">(</span><span class="op" id="4880914">)</span>&nbsp;<span class="op" id="4880916">!=</span>&nbsp;<span class="num" id="4880919">0</span>&nbsp;<span class="op" id="4880921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880925">z</span><span class="op" id="4880926">.</span><span class="ident" id="4880927">SetInt64</span><span class="op" id="4880935">(</span><span class="num" id="4880936">1</span><span class="op" id="4880937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880940">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880943">return</span>&nbsp;<span class="ident" id="4880950">z</span><br>
<span class="lineno"></span><span class="op" id="4880952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4880955">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4881033">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4881090">func</span>&nbsp;<span class="op" id="4881095">(</span><span class="ident" id="4881096">curve</span>&nbsp;<span class="op" id="4881102">*</span><span class="ident" id="4881103">CurveParams</span><span class="op" id="4881114">)</span>&nbsp;<span class="ident" id="4881116">affineFromJacobian</span><span class="op" id="4881134">(</span><span class="ident" id="4881135">x</span><span class="op" id="4881136">,</span>&nbsp;<span class="ident" id="4881138">y</span><span class="op" id="4881139">,</span>&nbsp;<span class="ident" id="4881141">z</span>&nbsp;<span class="op" id="4881143">*</span><span class="ident" id="4881144">big</span><span class="op" id="4881147">.</span><span class="ident" id="4881148">Int</span><span class="op" id="4881151">)</span>&nbsp;<span class="op" id="4881153">(</span><span class="ident" id="4881154">xOut</span><span class="op" id="4881158">,</span>&nbsp;<span class="ident" id="4881160">yOut</span>&nbsp;<span class="op" id="4881165">*</span><span class="ident" id="4881166">big</span><span class="op" id="4881169">.</span><span class="ident" id="4881170">Int</span><span class="op" id="4881173">)</span>&nbsp;<span class="op" id="4881175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881178">if</span>&nbsp;<span class="ident" id="4881181">z</span><span class="op" id="4881182">.</span><span class="ident" id="4881183">Sign</span><span class="op" id="4881187">(</span><span class="op" id="4881188">)</span>&nbsp;<span class="op" id="4881190">==</span>&nbsp;<span class="num" id="4881193">0</span>&nbsp;<span class="op" id="4881195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881199">return</span>&nbsp;<span class="builtinfunc" id="4881206">new</span><span class="op" id="4881209">(</span><span class="ident" id="4881210">big</span><span class="op" id="4881213">.</span><span class="ident" id="4881214">Int</span><span class="op" id="4881217">)</span><span class="op" id="4881218">,</span>&nbsp;<span class="builtinfunc" id="4881220">new</span><span class="op" id="4881223">(</span><span class="ident" id="4881224">big</span><span class="op" id="4881227">.</span><span class="ident" id="4881228">Int</span><span class="op" id="4881231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881238">zinv</span>&nbsp;<span class="op" id="4881243">:=</span>&nbsp;<span class="builtinfunc" id="4881246">new</span><span class="op" id="4881249">(</span><span class="ident" id="4881250">big</span><span class="op" id="4881253">.</span><span class="ident" id="4881254">Int</span><span class="op" id="4881257">)</span><span class="op" id="4881258">.</span><span class="ident" id="4881259">ModInverse</span><span class="op" id="4881269">(</span><span class="ident" id="4881270">z</span><span class="op" id="4881271">,</span>&nbsp;<span class="ident" id="4881273">curve</span><span class="op" id="4881278">.</span><span class="ident" id="4881279">P</span><span class="op" id="4881280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881283">zinvsq</span>&nbsp;<span class="op" id="4881290">:=</span>&nbsp;<span class="builtinfunc" id="4881293">new</span><span class="op" id="4881296">(</span><span class="ident" id="4881297">big</span><span class="op" id="4881300">.</span><span class="ident" id="4881301">Int</span><span class="op" id="4881304">)</span><span class="op" id="4881305">.</span><span class="ident" id="4881306">Mul</span><span class="op" id="4881309">(</span><span class="ident" id="4881310">zinv</span><span class="op" id="4881314">,</span>&nbsp;<span class="ident" id="4881316">zinv</span><span class="op" id="4881320">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881324">xOut</span>&nbsp;<span class="op" id="4881329">=</span>&nbsp;<span class="builtinfunc" id="4881331">new</span><span class="op" id="4881334">(</span><span class="ident" id="4881335">big</span><span class="op" id="4881338">.</span><span class="ident" id="4881339">Int</span><span class="op" id="4881342">)</span><span class="op" id="4881343">.</span><span class="ident" id="4881344">Mul</span><span class="op" id="4881347">(</span><span class="ident" id="4881348">x</span><span class="op" id="4881349">,</span>&nbsp;<span class="ident" id="4881351">zinvsq</span><span class="op" id="4881357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881360">xOut</span><span class="op" id="4881364">.</span><span class="ident" id="4881365">Mod</span><span class="op" id="4881368">(</span><span class="ident" id="4881369">xOut</span><span class="op" id="4881373">,</span>&nbsp;<span class="ident" id="4881375">curve</span><span class="op" id="4881380">.</span><span class="ident" id="4881381">P</span><span class="op" id="4881382">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881385">zinvsq</span><span class="op" id="4881391">.</span><span class="ident" id="4881392">Mul</span><span class="op" id="4881395">(</span><span class="ident" id="4881396">zinvsq</span><span class="op" id="4881402">,</span>&nbsp;<span class="ident" id="4881404">zinv</span><span class="op" id="4881408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881411">yOut</span>&nbsp;<span class="op" id="4881416">=</span>&nbsp;<span class="builtinfunc" id="4881418">new</span><span class="op" id="4881421">(</span><span class="ident" id="4881422">big</span><span class="op" id="4881425">.</span><span class="ident" id="4881426">Int</span><span class="op" id="4881429">)</span><span class="op" id="4881430">.</span><span class="ident" id="4881431">Mul</span><span class="op" id="4881434">(</span><span class="ident" id="4881435">y</span><span class="op" id="4881436">,</span>&nbsp;<span class="ident" id="4881438">zinvsq</span><span class="op" id="4881444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881447">yOut</span><span class="op" id="4881451">.</span><span class="ident" id="4881452">Mod</span><span class="op" id="4881455">(</span><span class="ident" id="4881456">yOut</span><span class="op" id="4881460">,</span>&nbsp;<span class="ident" id="4881462">curve</span><span class="op" id="4881467">.</span><span class="ident" id="4881468">P</span><span class="op" id="4881469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881472">return</span><br>
<span class="lineno"></span><span class="op" id="4881479">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4881482">func</span>&nbsp;<span class="op" id="4881487">(</span><span class="ident" id="4881488">curve</span>&nbsp;<span class="op" id="4881494">*</span><span class="ident" id="4881495">CurveParams</span><span class="op" id="4881506">)</span>&nbsp;<span class="ident" id="4881508">Add</span><span class="op" id="4881511">(</span><span class="ident" id="4881512">x1</span><span class="op" id="4881514">,</span>&nbsp;<span class="ident" id="4881516">y1</span><span class="op" id="4881518">,</span>&nbsp;<span class="ident" id="4881520">x2</span><span class="op" id="4881522">,</span>&nbsp;<span class="ident" id="4881524">y2</span>&nbsp;<span class="op" id="4881527">*</span><span class="ident" id="4881528">big</span><span class="op" id="4881531">.</span><span class="ident" id="4881532">Int</span><span class="op" id="4881535">)</span>&nbsp;<span class="op" id="4881537">(</span><span class="op" id="4881538">*</span><span class="ident" id="4881539">big</span><span class="op" id="4881542">.</span><span class="ident" id="4881543">Int</span><span class="op" id="4881546">,</span>&nbsp;<span class="op" id="4881548">*</span><span class="ident" id="4881549">big</span><span class="op" id="4881552">.</span><span class="ident" id="4881553">Int</span><span class="op" id="4881556">)</span>&nbsp;<span class="op" id="4881558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881561">z1</span>&nbsp;<span class="op" id="4881564">:=</span>&nbsp;<span class="ident" id="4881567">zForAffine</span><span class="op" id="4881577">(</span><span class="ident" id="4881578">x1</span><span class="op" id="4881580">,</span>&nbsp;<span class="ident" id="4881582">y1</span><span class="op" id="4881584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881587">z2</span>&nbsp;<span class="op" id="4881590">:=</span>&nbsp;<span class="ident" id="4881593">zForAffine</span><span class="op" id="4881603">(</span><span class="ident" id="4881604">x2</span><span class="op" id="4881606">,</span>&nbsp;<span class="ident" id="4881608">y2</span><span class="op" id="4881610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881613">return</span>&nbsp;<span class="ident" id="4881620">curve</span><span class="op" id="4881625">.</span><span class="ident" id="4881626">affineFromJacobian</span><span class="op" id="4881644">(</span><span class="ident" id="4881645">curve</span><span class="op" id="4881650">.</span><span class="ident" id="4881651">addJacobian</span><span class="op" id="4881662">(</span><span class="ident" id="4881663">x1</span><span class="op" id="4881665">,</span>&nbsp;<span class="ident" id="4881667">y1</span><span class="op" id="4881669">,</span>&nbsp;<span class="ident" id="4881671">z1</span><span class="op" id="4881673">,</span>&nbsp;<span class="ident" id="4881675">x2</span><span class="op" id="4881677">,</span>&nbsp;<span class="ident" id="4881679">y2</span><span class="op" id="4881681">,</span>&nbsp;<span class="ident" id="4881683">z2</span><span class="op" id="4881685">)</span><span class="op" id="4881686">)</span><br>
<span class="lineno">105</span><span class="op" id="4881688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4881691">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4881765">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4881827">func</span>&nbsp;<span class="op" id="4881832">(</span><span class="ident" id="4881833">curve</span>&nbsp;<span class="op" id="4881839">*</span><span class="ident" id="4881840">CurveParams</span><span class="op" id="4881851">)</span>&nbsp;<span class="ident" id="4881853">addJacobian</span><span class="op" id="4881864">(</span><span class="ident" id="4881865">x1</span><span class="op" id="4881867">,</span>&nbsp;<span class="ident" id="4881869">y1</span><span class="op" id="4881871">,</span>&nbsp;<span class="ident" id="4881873">z1</span><span class="op" id="4881875">,</span>&nbsp;<span class="ident" id="4881877">x2</span><span class="op" id="4881879">,</span>&nbsp;<span class="ident" id="4881881">y2</span><span class="op" id="4881883">,</span>&nbsp;<span class="ident" id="4881885">z2</span>&nbsp;<span class="op" id="4881888">*</span><span class="ident" id="4881889">big</span><span class="op" id="4881892">.</span><span class="ident" id="4881893">Int</span><span class="op" id="4881896">)</span>&nbsp;<span class="op" id="4881898">(</span><span class="op" id="4881899">*</span><span class="ident" id="4881900">big</span><span class="op" id="4881903">.</span><span class="ident" id="4881904">Int</span><span class="op" id="4881907">,</span>&nbsp;<span class="op" id="4881909">*</span><span class="ident" id="4881910">big</span><span class="op" id="4881913">.</span><span class="ident" id="4881914">Int</span><span class="op" id="4881917">,</span>&nbsp;<span class="op" id="4881919">*</span><span class="ident" id="4881920">big</span><span class="op" id="4881923">.</span><span class="ident" id="4881924">Int</span><span class="op" id="4881927">)</span>&nbsp;<span class="op" id="4881929">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4881932">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882022">x3</span><span class="op" id="4882024">,</span>&nbsp;<span class="ident" id="4882026">y3</span><span class="op" id="4882028">,</span>&nbsp;<span class="ident" id="4882030">z3</span>&nbsp;<span class="op" id="4882033">:=</span>&nbsp;<span class="builtinfunc" id="4882036">new</span><span class="op" id="4882039">(</span><span class="ident" id="4882040">big</span><span class="op" id="4882043">.</span><span class="ident" id="4882044">Int</span><span class="op" id="4882047">)</span><span class="op" id="4882048">,</span>&nbsp;<span class="builtinfunc" id="4882050">new</span><span class="op" id="4882053">(</span><span class="ident" id="4882054">big</span><span class="op" id="4882057">.</span><span class="ident" id="4882058">Int</span><span class="op" id="4882061">)</span><span class="op" id="4882062">,</span>&nbsp;<span class="builtinfunc" id="4882064">new</span><span class="op" id="4882067">(</span><span class="ident" id="4882068">big</span><span class="op" id="4882071">.</span><span class="ident" id="4882072">Int</span><span class="op" id="4882075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882078">if</span>&nbsp;<span class="ident" id="4882081">z1</span><span class="op" id="4882083">.</span><span class="ident" id="4882084">Sign</span><span class="op" id="4882088">(</span><span class="op" id="4882089">)</span>&nbsp;<span class="op" id="4882091">==</span>&nbsp;<span class="num" id="4882094">0</span>&nbsp;<span class="op" id="4882096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882100">x3</span><span class="op" id="4882102">.</span><span class="ident" id="4882103">Set</span><span class="op" id="4882106">(</span><span class="ident" id="4882107">x2</span><span class="op" id="4882109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882113">y3</span><span class="op" id="4882115">.</span><span class="ident" id="4882116">Set</span><span class="op" id="4882119">(</span><span class="ident" id="4882120">y2</span><span class="op" id="4882122">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882126">z3</span><span class="op" id="4882128">.</span><span class="ident" id="4882129">Set</span><span class="op" id="4882132">(</span><span class="ident" id="4882133">z2</span><span class="op" id="4882135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882139">return</span>&nbsp;<span class="ident" id="4882146">x3</span><span class="op" id="4882148">,</span>&nbsp;<span class="ident" id="4882150">y3</span><span class="op" id="4882152">,</span>&nbsp;<span class="ident" id="4882154">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882161">if</span>&nbsp;<span class="ident" id="4882164">z2</span><span class="op" id="4882166">.</span><span class="ident" id="4882167">Sign</span><span class="op" id="4882171">(</span><span class="op" id="4882172">)</span>&nbsp;<span class="op" id="4882174">==</span>&nbsp;<span class="num" id="4882177">0</span>&nbsp;<span class="op" id="4882179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882183">x3</span><span class="op" id="4882185">.</span><span class="ident" id="4882186">Set</span><span class="op" id="4882189">(</span><span class="ident" id="4882190">x1</span><span class="op" id="4882192">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882196">y3</span><span class="op" id="4882198">.</span><span class="ident" id="4882199">Set</span><span class="op" id="4882202">(</span><span class="ident" id="4882203">y1</span><span class="op" id="4882205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882209">z3</span><span class="op" id="4882211">.</span><span class="ident" id="4882212">Set</span><span class="op" id="4882215">(</span><span class="ident" id="4882216">z1</span><span class="op" id="4882218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882222">return</span>&nbsp;<span class="ident" id="4882229">x3</span><span class="op" id="4882231">,</span>&nbsp;<span class="ident" id="4882233">y3</span><span class="op" id="4882235">,</span>&nbsp;<span class="ident" id="4882237">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882245">z1z1</span>&nbsp;<span class="op" id="4882250">:=</span>&nbsp;<span class="builtinfunc" id="4882253">new</span><span class="op" id="4882256">(</span><span class="ident" id="4882257">big</span><span class="op" id="4882260">.</span><span class="ident" id="4882261">Int</span><span class="op" id="4882264">)</span><span class="op" id="4882265">.</span><span class="ident" id="4882266">Mul</span><span class="op" id="4882269">(</span><span class="ident" id="4882270">z1</span><span class="op" id="4882272">,</span>&nbsp;<span class="ident" id="4882274">z1</span><span class="op" id="4882276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882279">z1z1</span><span class="op" id="4882283">.</span><span class="ident" id="4882284">Mod</span><span class="op" id="4882287">(</span><span class="ident" id="4882288">z1z1</span><span class="op" id="4882292">,</span>&nbsp;<span class="ident" id="4882294">curve</span><span class="op" id="4882299">.</span><span class="ident" id="4882300">P</span><span class="op" id="4882301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882304">z2z2</span>&nbsp;<span class="op" id="4882309">:=</span>&nbsp;<span class="builtinfunc" id="4882312">new</span><span class="op" id="4882315">(</span><span class="ident" id="4882316">big</span><span class="op" id="4882319">.</span><span class="ident" id="4882320">Int</span><span class="op" id="4882323">)</span><span class="op" id="4882324">.</span><span class="ident" id="4882325">Mul</span><span class="op" id="4882328">(</span><span class="ident" id="4882329">z2</span><span class="op" id="4882331">,</span>&nbsp;<span class="ident" id="4882333">z2</span><span class="op" id="4882335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882338">z2z2</span><span class="op" id="4882342">.</span><span class="ident" id="4882343">Mod</span><span class="op" id="4882346">(</span><span class="ident" id="4882347">z2z2</span><span class="op" id="4882351">,</span>&nbsp;<span class="ident" id="4882353">curve</span><span class="op" id="4882358">.</span><span class="ident" id="4882359">P</span><span class="op" id="4882360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882364">u1</span>&nbsp;<span class="op" id="4882367">:=</span>&nbsp;<span class="builtinfunc" id="4882370">new</span><span class="op" id="4882373">(</span><span class="ident" id="4882374">big</span><span class="op" id="4882377">.</span><span class="ident" id="4882378">Int</span><span class="op" id="4882381">)</span><span class="op" id="4882382">.</span><span class="ident" id="4882383">Mul</span><span class="op" id="4882386">(</span><span class="ident" id="4882387">x1</span><span class="op" id="4882389">,</span>&nbsp;<span class="ident" id="4882391">z2z2</span><span class="op" id="4882395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882398">u1</span><span class="op" id="4882400">.</span><span class="ident" id="4882401">Mod</span><span class="op" id="4882404">(</span><span class="ident" id="4882405">u1</span><span class="op" id="4882407">,</span>&nbsp;<span class="ident" id="4882409">curve</span><span class="op" id="4882414">.</span><span class="ident" id="4882415">P</span><span class="op" id="4882416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882419">u2</span>&nbsp;<span class="op" id="4882422">:=</span>&nbsp;<span class="builtinfunc" id="4882425">new</span><span class="op" id="4882428">(</span><span class="ident" id="4882429">big</span><span class="op" id="4882432">.</span><span class="ident" id="4882433">Int</span><span class="op" id="4882436">)</span><span class="op" id="4882437">.</span><span class="ident" id="4882438">Mul</span><span class="op" id="4882441">(</span><span class="ident" id="4882442">x2</span><span class="op" id="4882444">,</span>&nbsp;<span class="ident" id="4882446">z1z1</span><span class="op" id="4882450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882453">u2</span><span class="op" id="4882455">.</span><span class="ident" id="4882456">Mod</span><span class="op" id="4882459">(</span><span class="ident" id="4882460">u2</span><span class="op" id="4882462">,</span>&nbsp;<span class="ident" id="4882464">curve</span><span class="op" id="4882469">.</span><span class="ident" id="4882470">P</span><span class="op" id="4882471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882474">h</span>&nbsp;<span class="op" id="4882476">:=</span>&nbsp;<span class="builtinfunc" id="4882479">new</span><span class="op" id="4882482">(</span><span class="ident" id="4882483">big</span><span class="op" id="4882486">.</span><span class="ident" id="4882487">Int</span><span class="op" id="4882490">)</span><span class="op" id="4882491">.</span><span class="ident" id="4882492">Sub</span><span class="op" id="4882495">(</span><span class="ident" id="4882496">u2</span><span class="op" id="4882498">,</span>&nbsp;<span class="ident" id="4882500">u1</span><span class="op" id="4882502">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882505">xEqual</span>&nbsp;<span class="op" id="4882512">:=</span>&nbsp;<span class="ident" id="4882515">h</span><span class="op" id="4882516">.</span><span class="ident" id="4882517">Sign</span><span class="op" id="4882521">(</span><span class="op" id="4882522">)</span>&nbsp;<span class="op" id="4882524">==</span>&nbsp;<span class="num" id="4882527">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882530">if</span>&nbsp;<span class="ident" id="4882533">h</span><span class="op" id="4882534">.</span><span class="ident" id="4882535">Sign</span><span class="op" id="4882539">(</span><span class="op" id="4882540">)</span>&nbsp;<span class="op" id="4882542">==</span>&nbsp;<span class="op" id="4882545">-</span><span class="num" id="4882546">1</span>&nbsp;<span class="op" id="4882548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882552">h</span><span class="op" id="4882553">.</span><span class="ident" id="4882554">Add</span><span class="op" id="4882557">(</span><span class="ident" id="4882558">h</span><span class="op" id="4882559">,</span>&nbsp;<span class="ident" id="4882561">curve</span><span class="op" id="4882566">.</span><span class="ident" id="4882567">P</span><span class="op" id="4882568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882574">i</span>&nbsp;<span class="op" id="4882576">:=</span>&nbsp;<span class="builtinfunc" id="4882579">new</span><span class="op" id="4882582">(</span><span class="ident" id="4882583">big</span><span class="op" id="4882586">.</span><span class="ident" id="4882587">Int</span><span class="op" id="4882590">)</span><span class="op" id="4882591">.</span><span class="ident" id="4882592">Lsh</span><span class="op" id="4882595">(</span><span class="ident" id="4882596">h</span><span class="op" id="4882597">,</span>&nbsp;<span class="num" id="4882599">1</span><span class="op" id="4882600">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882603">i</span><span class="op" id="4882604">.</span><span class="ident" id="4882605">Mul</span><span class="op" id="4882608">(</span><span class="ident" id="4882609">i</span><span class="op" id="4882610">,</span>&nbsp;<span class="ident" id="4882612">i</span><span class="op" id="4882613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882616">j</span>&nbsp;<span class="op" id="4882618">:=</span>&nbsp;<span class="builtinfunc" id="4882621">new</span><span class="op" id="4882624">(</span><span class="ident" id="4882625">big</span><span class="op" id="4882628">.</span><span class="ident" id="4882629">Int</span><span class="op" id="4882632">)</span><span class="op" id="4882633">.</span><span class="ident" id="4882634">Mul</span><span class="op" id="4882637">(</span><span class="ident" id="4882638">h</span><span class="op" id="4882639">,</span>&nbsp;<span class="ident" id="4882641">i</span><span class="op" id="4882642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882646">s1</span>&nbsp;<span class="op" id="4882649">:=</span>&nbsp;<span class="builtinfunc" id="4882652">new</span><span class="op" id="4882655">(</span><span class="ident" id="4882656">big</span><span class="op" id="4882659">.</span><span class="ident" id="4882660">Int</span><span class="op" id="4882663">)</span><span class="op" id="4882664">.</span><span class="ident" id="4882665">Mul</span><span class="op" id="4882668">(</span><span class="ident" id="4882669">y1</span><span class="op" id="4882671">,</span>&nbsp;<span class="ident" id="4882673">z2</span><span class="op" id="4882675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882678">s1</span><span class="op" id="4882680">.</span><span class="ident" id="4882681">Mul</span><span class="op" id="4882684">(</span><span class="ident" id="4882685">s1</span><span class="op" id="4882687">,</span>&nbsp;<span class="ident" id="4882689">z2z2</span><span class="op" id="4882693">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882696">s1</span><span class="op" id="4882698">.</span><span class="ident" id="4882699">Mod</span><span class="op" id="4882702">(</span><span class="ident" id="4882703">s1</span><span class="op" id="4882705">,</span>&nbsp;<span class="ident" id="4882707">curve</span><span class="op" id="4882712">.</span><span class="ident" id="4882713">P</span><span class="op" id="4882714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882717">s2</span>&nbsp;<span class="op" id="4882720">:=</span>&nbsp;<span class="builtinfunc" id="4882723">new</span><span class="op" id="4882726">(</span><span class="ident" id="4882727">big</span><span class="op" id="4882730">.</span><span class="ident" id="4882731">Int</span><span class="op" id="4882734">)</span><span class="op" id="4882735">.</span><span class="ident" id="4882736">Mul</span><span class="op" id="4882739">(</span><span class="ident" id="4882740">y2</span><span class="op" id="4882742">,</span>&nbsp;<span class="ident" id="4882744">z1</span><span class="op" id="4882746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882749">s2</span><span class="op" id="4882751">.</span><span class="ident" id="4882752">Mul</span><span class="op" id="4882755">(</span><span class="ident" id="4882756">s2</span><span class="op" id="4882758">,</span>&nbsp;<span class="ident" id="4882760">z1z1</span><span class="op" id="4882764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882767">s2</span><span class="op" id="4882769">.</span><span class="ident" id="4882770">Mod</span><span class="op" id="4882773">(</span><span class="ident" id="4882774">s2</span><span class="op" id="4882776">,</span>&nbsp;<span class="ident" id="4882778">curve</span><span class="op" id="4882783">.</span><span class="ident" id="4882784">P</span><span class="op" id="4882785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882788">r</span>&nbsp;<span class="op" id="4882790">:=</span>&nbsp;<span class="builtinfunc" id="4882793">new</span><span class="op" id="4882796">(</span><span class="ident" id="4882797">big</span><span class="op" id="4882800">.</span><span class="ident" id="4882801">Int</span><span class="op" id="4882804">)</span><span class="op" id="4882805">.</span><span class="ident" id="4882806">Sub</span><span class="op" id="4882809">(</span><span class="ident" id="4882810">s2</span><span class="op" id="4882812">,</span>&nbsp;<span class="ident" id="4882814">s1</span><span class="op" id="4882816">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882819">if</span>&nbsp;<span class="ident" id="4882822">r</span><span class="op" id="4882823">.</span><span class="ident" id="4882824">Sign</span><span class="op" id="4882828">(</span><span class="op" id="4882829">)</span>&nbsp;<span class="op" id="4882831">==</span>&nbsp;<span class="op" id="4882834">-</span><span class="num" id="4882835">1</span>&nbsp;<span class="op" id="4882837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882841">r</span><span class="op" id="4882842">.</span><span class="ident" id="4882843">Add</span><span class="op" id="4882846">(</span><span class="ident" id="4882847">r</span><span class="op" id="4882848">,</span>&nbsp;<span class="ident" id="4882850">curve</span><span class="op" id="4882855">.</span><span class="ident" id="4882856">P</span><span class="op" id="4882857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882863">yEqual</span>&nbsp;<span class="op" id="4882870">:=</span>&nbsp;<span class="ident" id="4882873">r</span><span class="op" id="4882874">.</span><span class="ident" id="4882875">Sign</span><span class="op" id="4882879">(</span><span class="op" id="4882880">)</span>&nbsp;<span class="op" id="4882882">==</span>&nbsp;<span class="num" id="4882885">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882888">if</span>&nbsp;<span class="ident" id="4882891">xEqual</span>&nbsp;<span class="op" id="4882898">&amp;&amp;</span>&nbsp;<span class="ident" id="4882901">yEqual</span>&nbsp;<span class="op" id="4882908">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882912">return</span>&nbsp;<span class="ident" id="4882919">curve</span><span class="op" id="4882924">.</span><span class="ident" id="4882925">doubleJacobian</span><span class="op" id="4882939">(</span><span class="ident" id="4882940">x1</span><span class="op" id="4882942">,</span>&nbsp;<span class="ident" id="4882944">y1</span><span class="op" id="4882946">,</span>&nbsp;<span class="ident" id="4882948">z1</span><span class="op" id="4882950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882956">r</span><span class="op" id="4882957">.</span><span class="ident" id="4882958">Lsh</span><span class="op" id="4882961">(</span><span class="ident" id="4882962">r</span><span class="op" id="4882963">,</span>&nbsp;<span class="num" id="4882965">1</span><span class="op" id="4882966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882969">v</span>&nbsp;<span class="op" id="4882971">:=</span>&nbsp;<span class="builtinfunc" id="4882974">new</span><span class="op" id="4882977">(</span><span class="ident" id="4882978">big</span><span class="op" id="4882981">.</span><span class="ident" id="4882982">Int</span><span class="op" id="4882985">)</span><span class="op" id="4882986">.</span><span class="ident" id="4882987">Mul</span><span class="op" id="4882990">(</span><span class="ident" id="4882991">u1</span><span class="op" id="4882993">,</span>&nbsp;<span class="ident" id="4882995">i</span><span class="op" id="4882996">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883000">x3</span><span class="op" id="4883002">.</span><span class="ident" id="4883003">Set</span><span class="op" id="4883006">(</span><span class="ident" id="4883007">r</span><span class="op" id="4883008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883011">x3</span><span class="op" id="4883013">.</span><span class="ident" id="4883014">Mul</span><span class="op" id="4883017">(</span><span class="ident" id="4883018">x3</span><span class="op" id="4883020">,</span>&nbsp;<span class="ident" id="4883022">x3</span><span class="op" id="4883024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883027">x3</span><span class="op" id="4883029">.</span><span class="ident" id="4883030">Sub</span><span class="op" id="4883033">(</span><span class="ident" id="4883034">x3</span><span class="op" id="4883036">,</span>&nbsp;<span class="ident" id="4883038">j</span><span class="op" id="4883039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883042">x3</span><span class="op" id="4883044">.</span><span class="ident" id="4883045">Sub</span><span class="op" id="4883048">(</span><span class="ident" id="4883049">x3</span><span class="op" id="4883051">,</span>&nbsp;<span class="ident" id="4883053">v</span><span class="op" id="4883054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883057">x3</span><span class="op" id="4883059">.</span><span class="ident" id="4883060">Sub</span><span class="op" id="4883063">(</span><span class="ident" id="4883064">x3</span><span class="op" id="4883066">,</span>&nbsp;<span class="ident" id="4883068">v</span><span class="op" id="4883069">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883072">x3</span><span class="op" id="4883074">.</span><span class="ident" id="4883075">Mod</span><span class="op" id="4883078">(</span><span class="ident" id="4883079">x3</span><span class="op" id="4883081">,</span>&nbsp;<span class="ident" id="4883083">curve</span><span class="op" id="4883088">.</span><span class="ident" id="4883089">P</span><span class="op" id="4883090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883094">y3</span><span class="op" id="4883096">.</span><span class="ident" id="4883097">Set</span><span class="op" id="4883100">(</span><span class="ident" id="4883101">r</span><span class="op" id="4883102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883105">v</span><span class="op" id="4883106">.</span><span class="ident" id="4883107">Sub</span><span class="op" id="4883110">(</span><span class="ident" id="4883111">v</span><span class="op" id="4883112">,</span>&nbsp;<span class="ident" id="4883114">x3</span><span class="op" id="4883116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883119">y3</span><span class="op" id="4883121">.</span><span class="ident" id="4883122">Mul</span><span class="op" id="4883125">(</span><span class="ident" id="4883126">y3</span><span class="op" id="4883128">,</span>&nbsp;<span class="ident" id="4883130">v</span><span class="op" id="4883131">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883134">s1</span><span class="op" id="4883136">.</span><span class="ident" id="4883137">Mul</span><span class="op" id="4883140">(</span><span class="ident" id="4883141">s1</span><span class="op" id="4883143">,</span>&nbsp;<span class="ident" id="4883145">j</span><span class="op" id="4883146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883149">s1</span><span class="op" id="4883151">.</span><span class="ident" id="4883152">Lsh</span><span class="op" id="4883155">(</span><span class="ident" id="4883156">s1</span><span class="op" id="4883158">,</span>&nbsp;<span class="num" id="4883160">1</span><span class="op" id="4883161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883164">y3</span><span class="op" id="4883166">.</span><span class="ident" id="4883167">Sub</span><span class="op" id="4883170">(</span><span class="ident" id="4883171">y3</span><span class="op" id="4883173">,</span>&nbsp;<span class="ident" id="4883175">s1</span><span class="op" id="4883177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883180">y3</span><span class="op" id="4883182">.</span><span class="ident" id="4883183">Mod</span><span class="op" id="4883186">(</span><span class="ident" id="4883187">y3</span><span class="op" id="4883189">,</span>&nbsp;<span class="ident" id="4883191">curve</span><span class="op" id="4883196">.</span><span class="ident" id="4883197">P</span><span class="op" id="4883198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883202">z3</span><span class="op" id="4883204">.</span><span class="ident" id="4883205">Add</span><span class="op" id="4883208">(</span><span class="ident" id="4883209">z1</span><span class="op" id="4883211">,</span>&nbsp;<span class="ident" id="4883213">z2</span><span class="op" id="4883215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883218">z3</span><span class="op" id="4883220">.</span><span class="ident" id="4883221">Mul</span><span class="op" id="4883224">(</span><span class="ident" id="4883225">z3</span><span class="op" id="4883227">,</span>&nbsp;<span class="ident" id="4883229">z3</span><span class="op" id="4883231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883234">z3</span><span class="op" id="4883236">.</span><span class="ident" id="4883237">Sub</span><span class="op" id="4883240">(</span><span class="ident" id="4883241">z3</span><span class="op" id="4883243">,</span>&nbsp;<span class="ident" id="4883245">z1z1</span><span class="op" id="4883249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883252">z3</span><span class="op" id="4883254">.</span><span class="ident" id="4883255">Sub</span><span class="op" id="4883258">(</span><span class="ident" id="4883259">z3</span><span class="op" id="4883261">,</span>&nbsp;<span class="ident" id="4883263">z2z2</span><span class="op" id="4883267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883270">z3</span><span class="op" id="4883272">.</span><span class="ident" id="4883273">Mul</span><span class="op" id="4883276">(</span><span class="ident" id="4883277">z3</span><span class="op" id="4883279">,</span>&nbsp;<span class="ident" id="4883281">h</span><span class="op" id="4883282">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883285">z3</span><span class="op" id="4883287">.</span><span class="ident" id="4883288">Mod</span><span class="op" id="4883291">(</span><span class="ident" id="4883292">z3</span><span class="op" id="4883294">,</span>&nbsp;<span class="ident" id="4883296">curve</span><span class="op" id="4883301">.</span><span class="ident" id="4883302">P</span><span class="op" id="4883303">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883307">return</span>&nbsp;<span class="ident" id="4883314">x3</span><span class="op" id="4883316">,</span>&nbsp;<span class="ident" id="4883318">y3</span><span class="op" id="4883320">,</span>&nbsp;<span class="ident" id="4883322">z3</span><br>
<span class="lineno"></span><span class="op" id="4883325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4883328">func</span>&nbsp;<span class="op" id="4883333">(</span><span class="ident" id="4883334">curve</span>&nbsp;<span class="op" id="4883340">*</span><span class="ident" id="4883341">CurveParams</span><span class="op" id="4883352">)</span>&nbsp;<span class="ident" id="4883354">Double</span><span class="op" id="4883360">(</span><span class="ident" id="4883361">x1</span><span class="op" id="4883363">,</span>&nbsp;<span class="ident" id="4883365">y1</span>&nbsp;<span class="op" id="4883368">*</span><span class="ident" id="4883369">big</span><span class="op" id="4883372">.</span><span class="ident" id="4883373">Int</span><span class="op" id="4883376">)</span>&nbsp;<span class="op" id="4883378">(</span><span class="op" id="4883379">*</span><span class="ident" id="4883380">big</span><span class="op" id="4883383">.</span><span class="ident" id="4883384">Int</span><span class="op" id="4883387">,</span>&nbsp;<span class="op" id="4883389">*</span><span class="ident" id="4883390">big</span><span class="op" id="4883393">.</span><span class="ident" id="4883394">Int</span><span class="op" id="4883397">)</span>&nbsp;<span class="op" id="4883399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883402">z1</span>&nbsp;<span class="op" id="4883405">:=</span>&nbsp;<span class="ident" id="4883408">zForAffine</span><span class="op" id="4883418">(</span><span class="ident" id="4883419">x1</span><span class="op" id="4883421">,</span>&nbsp;<span class="ident" id="4883423">y1</span><span class="op" id="4883425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883428">return</span>&nbsp;<span class="ident" id="4883435">curve</span><span class="op" id="4883440">.</span><span class="ident" id="4883441">affineFromJacobian</span><span class="op" id="4883459">(</span><span class="ident" id="4883460">curve</span><span class="op" id="4883465">.</span><span class="ident" id="4883466">doubleJacobian</span><span class="op" id="4883480">(</span><span class="ident" id="4883481">x1</span><span class="op" id="4883483">,</span>&nbsp;<span class="ident" id="4883485">y1</span><span class="op" id="4883487">,</span>&nbsp;<span class="ident" id="4883489">z1</span><span class="op" id="4883491">)</span><span class="op" id="4883492">)</span><br>
<span class="lineno"></span><span class="op" id="4883494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4883497">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4883569">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4883615">func</span>&nbsp;<span class="op" id="4883620">(</span><span class="ident" id="4883621">curve</span>&nbsp;<span class="op" id="4883627">*</span><span class="ident" id="4883628">CurveParams</span><span class="op" id="4883639">)</span>&nbsp;<span class="ident" id="4883641">doubleJacobian</span><span class="op" id="4883655">(</span><span class="ident" id="4883656">x</span><span class="op" id="4883657">,</span>&nbsp;<span class="ident" id="4883659">y</span><span class="op" id="4883660">,</span>&nbsp;<span class="ident" id="4883662">z</span>&nbsp;<span class="op" id="4883664">*</span><span class="ident" id="4883665">big</span><span class="op" id="4883668">.</span><span class="ident" id="4883669">Int</span><span class="op" id="4883672">)</span>&nbsp;<span class="op" id="4883674">(</span><span class="op" id="4883675">*</span><span class="ident" id="4883676">big</span><span class="op" id="4883679">.</span><span class="ident" id="4883680">Int</span><span class="op" id="4883683">,</span>&nbsp;<span class="op" id="4883685">*</span><span class="ident" id="4883686">big</span><span class="op" id="4883689">.</span><span class="ident" id="4883690">Int</span><span class="op" id="4883693">,</span>&nbsp;<span class="op" id="4883695">*</span><span class="ident" id="4883696">big</span><span class="op" id="4883699">.</span><span class="ident" id="4883700">Int</span><span class="op" id="4883703">)</span>&nbsp;<span class="op" id="4883705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4883708">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883797">delta</span>&nbsp;<span class="op" id="4883803">:=</span>&nbsp;<span class="builtinfunc" id="4883806">new</span><span class="op" id="4883809">(</span><span class="ident" id="4883810">big</span><span class="op" id="4883813">.</span><span class="ident" id="4883814">Int</span><span class="op" id="4883817">)</span><span class="op" id="4883818">.</span><span class="ident" id="4883819">Mul</span><span class="op" id="4883822">(</span><span class="ident" id="4883823">z</span><span class="op" id="4883824">,</span>&nbsp;<span class="ident" id="4883826">z</span><span class="op" id="4883827">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883830">delta</span><span class="op" id="4883835">.</span><span class="ident" id="4883836">Mod</span><span class="op" id="4883839">(</span><span class="ident" id="4883840">delta</span><span class="op" id="4883845">,</span>&nbsp;<span class="ident" id="4883847">curve</span><span class="op" id="4883852">.</span><span class="ident" id="4883853">P</span><span class="op" id="4883854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883857">gamma</span>&nbsp;<span class="op" id="4883863">:=</span>&nbsp;<span class="builtinfunc" id="4883866">new</span><span class="op" id="4883869">(</span><span class="ident" id="4883870">big</span><span class="op" id="4883873">.</span><span class="ident" id="4883874">Int</span><span class="op" id="4883877">)</span><span class="op" id="4883878">.</span><span class="ident" id="4883879">Mul</span><span class="op" id="4883882">(</span><span class="ident" id="4883883">y</span><span class="op" id="4883884">,</span>&nbsp;<span class="ident" id="4883886">y</span><span class="op" id="4883887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883890">gamma</span><span class="op" id="4883895">.</span><span class="ident" id="4883896">Mod</span><span class="op" id="4883899">(</span><span class="ident" id="4883900">gamma</span><span class="op" id="4883905">,</span>&nbsp;<span class="ident" id="4883907">curve</span><span class="op" id="4883912">.</span><span class="ident" id="4883913">P</span><span class="op" id="4883914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883917">alpha</span>&nbsp;<span class="op" id="4883923">:=</span>&nbsp;<span class="builtinfunc" id="4883926">new</span><span class="op" id="4883929">(</span><span class="ident" id="4883930">big</span><span class="op" id="4883933">.</span><span class="ident" id="4883934">Int</span><span class="op" id="4883937">)</span><span class="op" id="4883938">.</span><span class="ident" id="4883939">Sub</span><span class="op" id="4883942">(</span><span class="ident" id="4883943">x</span><span class="op" id="4883944">,</span>&nbsp;<span class="ident" id="4883946">delta</span><span class="op" id="4883951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883954">if</span>&nbsp;<span class="ident" id="4883957">alpha</span><span class="op" id="4883962">.</span><span class="ident" id="4883963">Sign</span><span class="op" id="4883967">(</span><span class="op" id="4883968">)</span>&nbsp;<span class="op" id="4883970">==</span>&nbsp;<span class="op" id="4883973">-</span><span class="num" id="4883974">1</span>&nbsp;<span class="op" id="4883976">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883980">alpha</span><span class="op" id="4883985">.</span><span class="ident" id="4883986">Add</span><span class="op" id="4883989">(</span><span class="ident" id="4883990">alpha</span><span class="op" id="4883995">,</span>&nbsp;<span class="ident" id="4883997">curve</span><span class="op" id="4884002">.</span><span class="ident" id="4884003">P</span><span class="op" id="4884004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884010">alpha2</span>&nbsp;<span class="op" id="4884017">:=</span>&nbsp;<span class="builtinfunc" id="4884020">new</span><span class="op" id="4884023">(</span><span class="ident" id="4884024">big</span><span class="op" id="4884027">.</span><span class="ident" id="4884028">Int</span><span class="op" id="4884031">)</span><span class="op" id="4884032">.</span><span class="ident" id="4884033">Add</span><span class="op" id="4884036">(</span><span class="ident" id="4884037">x</span><span class="op" id="4884038">,</span>&nbsp;<span class="ident" id="4884040">delta</span><span class="op" id="4884045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884048">alpha</span><span class="op" id="4884053">.</span><span class="ident" id="4884054">Mul</span><span class="op" id="4884057">(</span><span class="ident" id="4884058">alpha</span><span class="op" id="4884063">,</span>&nbsp;<span class="ident" id="4884065">alpha2</span><span class="op" id="4884071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884074">alpha2</span><span class="op" id="4884080">.</span><span class="ident" id="4884081">Set</span><span class="op" id="4884084">(</span><span class="ident" id="4884085">alpha</span><span class="op" id="4884090">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884093">alpha</span><span class="op" id="4884098">.</span><span class="ident" id="4884099">Lsh</span><span class="op" id="4884102">(</span><span class="ident" id="4884103">alpha</span><span class="op" id="4884108">,</span>&nbsp;<span class="num" id="4884110">1</span><span class="op" id="4884111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884114">alpha</span><span class="op" id="4884119">.</span><span class="ident" id="4884120">Add</span><span class="op" id="4884123">(</span><span class="ident" id="4884124">alpha</span><span class="op" id="4884129">,</span>&nbsp;<span class="ident" id="4884131">alpha2</span><span class="op" id="4884137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884141">beta</span>&nbsp;<span class="op" id="4884146">:=</span>&nbsp;<span class="ident" id="4884149">alpha2</span><span class="op" id="4884155">.</span><span class="ident" id="4884156">Mul</span><span class="op" id="4884159">(</span><span class="ident" id="4884160">x</span><span class="op" id="4884161">,</span>&nbsp;<span class="ident" id="4884163">gamma</span><span class="op" id="4884168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884172">x3</span>&nbsp;<span class="op" id="4884175">:=</span>&nbsp;<span class="builtinfunc" id="4884178">new</span><span class="op" id="4884181">(</span><span class="ident" id="4884182">big</span><span class="op" id="4884185">.</span><span class="ident" id="4884186">Int</span><span class="op" id="4884189">)</span><span class="op" id="4884190">.</span><span class="ident" id="4884191">Mul</span><span class="op" id="4884194">(</span><span class="ident" id="4884195">alpha</span><span class="op" id="4884200">,</span>&nbsp;<span class="ident" id="4884202">alpha</span><span class="op" id="4884207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884210">beta8</span>&nbsp;<span class="op" id="4884216">:=</span>&nbsp;<span class="builtinfunc" id="4884219">new</span><span class="op" id="4884222">(</span><span class="ident" id="4884223">big</span><span class="op" id="4884226">.</span><span class="ident" id="4884227">Int</span><span class="op" id="4884230">)</span><span class="op" id="4884231">.</span><span class="ident" id="4884232">Lsh</span><span class="op" id="4884235">(</span><span class="ident" id="4884236">beta</span><span class="op" id="4884240">,</span>&nbsp;<span class="num" id="4884242">3</span><span class="op" id="4884243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884246">x3</span><span class="op" id="4884248">.</span><span class="ident" id="4884249">Sub</span><span class="op" id="4884252">(</span><span class="ident" id="4884253">x3</span><span class="op" id="4884255">,</span>&nbsp;<span class="ident" id="4884257">beta8</span><span class="op" id="4884262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884265">for</span>&nbsp;<span class="ident" id="4884269">x3</span><span class="op" id="4884271">.</span><span class="ident" id="4884272">Sign</span><span class="op" id="4884276">(</span><span class="op" id="4884277">)</span>&nbsp;<span class="op" id="4884279">==</span>&nbsp;<span class="op" id="4884282">-</span><span class="num" id="4884283">1</span>&nbsp;<span class="op" id="4884285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884289">x3</span><span class="op" id="4884291">.</span><span class="ident" id="4884292">Add</span><span class="op" id="4884295">(</span><span class="ident" id="4884296">x3</span><span class="op" id="4884298">,</span>&nbsp;<span class="ident" id="4884300">curve</span><span class="op" id="4884305">.</span><span class="ident" id="4884306">P</span><span class="op" id="4884307">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884313">x3</span><span class="op" id="4884315">.</span><span class="ident" id="4884316">Mod</span><span class="op" id="4884319">(</span><span class="ident" id="4884320">x3</span><span class="op" id="4884322">,</span>&nbsp;<span class="ident" id="4884324">curve</span><span class="op" id="4884329">.</span><span class="ident" id="4884330">P</span><span class="op" id="4884331">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884335">z3</span>&nbsp;<span class="op" id="4884338">:=</span>&nbsp;<span class="builtinfunc" id="4884341">new</span><span class="op" id="4884344">(</span><span class="ident" id="4884345">big</span><span class="op" id="4884348">.</span><span class="ident" id="4884349">Int</span><span class="op" id="4884352">)</span><span class="op" id="4884353">.</span><span class="ident" id="4884354">Add</span><span class="op" id="4884357">(</span><span class="ident" id="4884358">y</span><span class="op" id="4884359">,</span>&nbsp;<span class="ident" id="4884361">z</span><span class="op" id="4884362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884365">z3</span><span class="op" id="4884367">.</span><span class="ident" id="4884368">Mul</span><span class="op" id="4884371">(</span><span class="ident" id="4884372">z3</span><span class="op" id="4884374">,</span>&nbsp;<span class="ident" id="4884376">z3</span><span class="op" id="4884378">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884381">z3</span><span class="op" id="4884383">.</span><span class="ident" id="4884384">Sub</span><span class="op" id="4884387">(</span><span class="ident" id="4884388">z3</span><span class="op" id="4884390">,</span>&nbsp;<span class="ident" id="4884392">gamma</span><span class="op" id="4884397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884400">if</span>&nbsp;<span class="ident" id="4884403">z3</span><span class="op" id="4884405">.</span><span class="ident" id="4884406">Sign</span><span class="op" id="4884410">(</span><span class="op" id="4884411">)</span>&nbsp;<span class="op" id="4884413">==</span>&nbsp;<span class="op" id="4884416">-</span><span class="num" id="4884417">1</span>&nbsp;<span class="op" id="4884419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884423">z3</span><span class="op" id="4884425">.</span><span class="ident" id="4884426">Add</span><span class="op" id="4884429">(</span><span class="ident" id="4884430">z3</span><span class="op" id="4884432">,</span>&nbsp;<span class="ident" id="4884434">curve</span><span class="op" id="4884439">.</span><span class="ident" id="4884440">P</span><span class="op" id="4884441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884447">z3</span><span class="op" id="4884449">.</span><span class="ident" id="4884450">Sub</span><span class="op" id="4884453">(</span><span class="ident" id="4884454">z3</span><span class="op" id="4884456">,</span>&nbsp;<span class="ident" id="4884458">delta</span><span class="op" id="4884463">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884466">if</span>&nbsp;<span class="ident" id="4884469">z3</span><span class="op" id="4884471">.</span><span class="ident" id="4884472">Sign</span><span class="op" id="4884476">(</span><span class="op" id="4884477">)</span>&nbsp;<span class="op" id="4884479">==</span>&nbsp;<span class="op" id="4884482">-</span><span class="num" id="4884483">1</span>&nbsp;<span class="op" id="4884485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884489">z3</span><span class="op" id="4884491">.</span><span class="ident" id="4884492">Add</span><span class="op" id="4884495">(</span><span class="ident" id="4884496">z3</span><span class="op" id="4884498">,</span>&nbsp;<span class="ident" id="4884500">curve</span><span class="op" id="4884505">.</span><span class="ident" id="4884506">P</span><span class="op" id="4884507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884513">z3</span><span class="op" id="4884515">.</span><span class="ident" id="4884516">Mod</span><span class="op" id="4884519">(</span><span class="ident" id="4884520">z3</span><span class="op" id="4884522">,</span>&nbsp;<span class="ident" id="4884524">curve</span><span class="op" id="4884529">.</span><span class="ident" id="4884530">P</span><span class="op" id="4884531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884535">beta</span><span class="op" id="4884539">.</span><span class="ident" id="4884540">Lsh</span><span class="op" id="4884543">(</span><span class="ident" id="4884544">beta</span><span class="op" id="4884548">,</span>&nbsp;<span class="num" id="4884550">2</span><span class="op" id="4884551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884554">beta</span><span class="op" id="4884558">.</span><span class="ident" id="4884559">Sub</span><span class="op" id="4884562">(</span><span class="ident" id="4884563">beta</span><span class="op" id="4884567">,</span>&nbsp;<span class="ident" id="4884569">x3</span><span class="op" id="4884571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884574">if</span>&nbsp;<span class="ident" id="4884577">beta</span><span class="op" id="4884581">.</span><span class="ident" id="4884582">Sign</span><span class="op" id="4884586">(</span><span class="op" id="4884587">)</span>&nbsp;<span class="op" id="4884589">==</span>&nbsp;<span class="op" id="4884592">-</span><span class="num" id="4884593">1</span>&nbsp;<span class="op" id="4884595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884599">beta</span><span class="op" id="4884603">.</span><span class="ident" id="4884604">Add</span><span class="op" id="4884607">(</span><span class="ident" id="4884608">beta</span><span class="op" id="4884612">,</span>&nbsp;<span class="ident" id="4884614">curve</span><span class="op" id="4884619">.</span><span class="ident" id="4884620">P</span><span class="op" id="4884621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884624">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884627">y3</span>&nbsp;<span class="op" id="4884630">:=</span>&nbsp;<span class="ident" id="4884633">alpha</span><span class="op" id="4884638">.</span><span class="ident" id="4884639">Mul</span><span class="op" id="4884642">(</span><span class="ident" id="4884643">alpha</span><span class="op" id="4884648">,</span>&nbsp;<span class="ident" id="4884650">beta</span><span class="op" id="4884654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884658">gamma</span><span class="op" id="4884663">.</span><span class="ident" id="4884664">Mul</span><span class="op" id="4884667">(</span><span class="ident" id="4884668">gamma</span><span class="op" id="4884673">,</span>&nbsp;<span class="ident" id="4884675">gamma</span><span class="op" id="4884680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884683">gamma</span><span class="op" id="4884688">.</span><span class="ident" id="4884689">Lsh</span><span class="op" id="4884692">(</span><span class="ident" id="4884693">gamma</span><span class="op" id="4884698">,</span>&nbsp;<span class="num" id="4884700">3</span><span class="op" id="4884701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884704">gamma</span><span class="op" id="4884709">.</span><span class="ident" id="4884710">Mod</span><span class="op" id="4884713">(</span><span class="ident" id="4884714">gamma</span><span class="op" id="4884719">,</span>&nbsp;<span class="ident" id="4884721">curve</span><span class="op" id="4884726">.</span><span class="ident" id="4884727">P</span><span class="op" id="4884728">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884732">y3</span><span class="op" id="4884734">.</span><span class="ident" id="4884735">Sub</span><span class="op" id="4884738">(</span><span class="ident" id="4884739">y3</span><span class="op" id="4884741">,</span>&nbsp;<span class="ident" id="4884743">gamma</span><span class="op" id="4884748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884751">if</span>&nbsp;<span class="ident" id="4884754">y3</span><span class="op" id="4884756">.</span><span class="ident" id="4884757">Sign</span><span class="op" id="4884761">(</span><span class="op" id="4884762">)</span>&nbsp;<span class="op" id="4884764">==</span>&nbsp;<span class="op" id="4884767">-</span><span class="num" id="4884768">1</span>&nbsp;<span class="op" id="4884770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884774">y3</span><span class="op" id="4884776">.</span><span class="ident" id="4884777">Add</span><span class="op" id="4884780">(</span><span class="ident" id="4884781">y3</span><span class="op" id="4884783">,</span>&nbsp;<span class="ident" id="4884785">curve</span><span class="op" id="4884790">.</span><span class="ident" id="4884791">P</span><span class="op" id="4884792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884795">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884798">y3</span><span class="op" id="4884800">.</span><span class="ident" id="4884801">Mod</span><span class="op" id="4884804">(</span><span class="ident" id="4884805">y3</span><span class="op" id="4884807">,</span>&nbsp;<span class="ident" id="4884809">curve</span><span class="op" id="4884814">.</span><span class="ident" id="4884815">P</span><span class="op" id="4884816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884820">return</span>&nbsp;<span class="ident" id="4884827">x3</span><span class="op" id="4884829">,</span>&nbsp;<span class="ident" id="4884831">y3</span><span class="op" id="4884833">,</span>&nbsp;<span class="ident" id="4884835">z3</span><br>
<span class="lineno"></span><span class="op" id="4884838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4884841">func</span>&nbsp;<span class="op" id="4884846">(</span><span class="ident" id="4884847">curve</span>&nbsp;<span class="op" id="4884853">*</span><span class="ident" id="4884854">CurveParams</span><span class="op" id="4884865">)</span>&nbsp;<span class="ident" id="4884867">ScalarMult</span><span class="op" id="4884877">(</span><span class="ident" id="4884878">Bx</span><span class="op" id="4884880">,</span>&nbsp;<span class="ident" id="4884882">By</span>&nbsp;<span class="op" id="4884885">*</span><span class="ident" id="4884886">big</span><span class="op" id="4884889">.</span><span class="ident" id="4884890">Int</span><span class="op" id="4884893">,</span>&nbsp;<span class="ident" id="4884895">k</span>&nbsp;<span class="op" id="4884897">[</span><span class="op" id="4884898">]</span><span class="builtintype" id="4884899">byte</span><span class="op" id="4884903">)</span>&nbsp;<span class="op" id="4884905">(</span><span class="op" id="4884906">*</span><span class="ident" id="4884907">big</span><span class="op" id="4884910">.</span><span class="ident" id="4884911">Int</span><span class="op" id="4884914">,</span>&nbsp;<span class="op" id="4884916">*</span><span class="ident" id="4884917">big</span><span class="op" id="4884920">.</span><span class="ident" id="4884921">Int</span><span class="op" id="4884924">)</span>&nbsp;<span class="op" id="4884926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884929">Bz</span>&nbsp;<span class="op" id="4884932">:=</span>&nbsp;<span class="builtinfunc" id="4884935">new</span><span class="op" id="4884938">(</span><span class="ident" id="4884939">big</span><span class="op" id="4884942">.</span><span class="ident" id="4884943">Int</span><span class="op" id="4884946">)</span><span class="op" id="4884947">.</span><span class="ident" id="4884948">SetInt64</span><span class="op" id="4884956">(</span><span class="num" id="4884957">1</span><span class="op" id="4884958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884961">x</span><span class="op" id="4884962">,</span>&nbsp;<span class="ident" id="4884964">y</span><span class="op" id="4884965">,</span>&nbsp;<span class="ident" id="4884967">z</span>&nbsp;<span class="op" id="4884969">:=</span>&nbsp;<span class="builtinfunc" id="4884972">new</span><span class="op" id="4884975">(</span><span class="ident" id="4884976">big</span><span class="op" id="4884979">.</span><span class="ident" id="4884980">Int</span><span class="op" id="4884983">)</span><span class="op" id="4884984">,</span>&nbsp;<span class="builtinfunc" id="4884986">new</span><span class="op" id="4884989">(</span><span class="ident" id="4884990">big</span><span class="op" id="4884993">.</span><span class="ident" id="4884994">Int</span><span class="op" id="4884997">)</span><span class="op" id="4884998">,</span>&nbsp;<span class="builtinfunc" id="4885000">new</span><span class="op" id="4885003">(</span><span class="ident" id="4885004">big</span><span class="op" id="4885007">.</span><span class="ident" id="4885008">Int</span><span class="op" id="4885011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885015">for</span>&nbsp;<span class="ident" id="4885019">_</span><span class="op" id="4885020">,</span>&nbsp;<span class="builtintype" id="4885022">byte</span>&nbsp;<span class="op" id="4885027">:=</span>&nbsp;<span class="keyword" id="4885030">range</span>&nbsp;<span class="ident" id="4885036">k</span>&nbsp;<span class="op" id="4885038">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885042">for</span>&nbsp;<span class="ident" id="4885046">bitNum</span>&nbsp;<span class="op" id="4885053">:=</span>&nbsp;<span class="num" id="4885056">0</span><span class="op" id="4885057">;</span>&nbsp;<span class="ident" id="4885059">bitNum</span>&nbsp;<span class="op" id="4885066">&lt;</span>&nbsp;<span class="num" id="4885068">8</span><span class="op" id="4885069">;</span>&nbsp;<span class="ident" id="4885071">bitNum</span><span class="op" id="4885077">++</span>&nbsp;<span class="op" id="4885080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885085">x</span><span class="op" id="4885086">,</span>&nbsp;<span class="ident" id="4885088">y</span><span class="op" id="4885089">,</span>&nbsp;<span class="ident" id="4885091">z</span>&nbsp;<span class="op" id="4885093">=</span>&nbsp;<span class="ident" id="4885095">curve</span><span class="op" id="4885100">.</span><span class="ident" id="4885101">doubleJacobian</span><span class="op" id="4885115">(</span><span class="ident" id="4885116">x</span><span class="op" id="4885117">,</span>&nbsp;<span class="ident" id="4885119">y</span><span class="op" id="4885120">,</span>&nbsp;<span class="ident" id="4885122">z</span><span class="op" id="4885123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885128">if</span>&nbsp;<span class="builtintype" id="4885131">byte</span><span class="op" id="4885135">&amp;</span><span class="num" id="4885136">0x80</span>&nbsp;<span class="op" id="4885141">==</span>&nbsp;<span class="num" id="4885144">0x80</span>&nbsp;<span class="op" id="4885149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885155">x</span><span class="op" id="4885156">,</span>&nbsp;<span class="ident" id="4885158">y</span><span class="op" id="4885159">,</span>&nbsp;<span class="ident" id="4885161">z</span>&nbsp;<span class="op" id="4885163">=</span>&nbsp;<span class="ident" id="4885165">curve</span><span class="op" id="4885170">.</span><span class="ident" id="4885171">addJacobian</span><span class="op" id="4885182">(</span><span class="ident" id="4885183">Bx</span><span class="op" id="4885185">,</span>&nbsp;<span class="ident" id="4885187">By</span><span class="op" id="4885189">,</span>&nbsp;<span class="ident" id="4885191">Bz</span><span class="op" id="4885193">,</span>&nbsp;<span class="ident" id="4885195">x</span><span class="op" id="4885196">,</span>&nbsp;<span class="ident" id="4885198">y</span><span class="op" id="4885199">,</span>&nbsp;<span class="ident" id="4885201">z</span><span class="op" id="4885202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4885207">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4885212">byte</span>&nbsp;<span class="op" id="4885217">&lt;&lt;=</span>&nbsp;<span class="num" id="4885221">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4885225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4885228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885232">return</span>&nbsp;<span class="ident" id="4885239">curve</span><span class="op" id="4885244">.</span><span class="ident" id="4885245">affineFromJacobian</span><span class="op" id="4885263">(</span><span class="ident" id="4885264">x</span><span class="op" id="4885265">,</span>&nbsp;<span class="ident" id="4885267">y</span><span class="op" id="4885268">,</span>&nbsp;<span class="ident" id="4885270">z</span><span class="op" id="4885271">)</span><br>
<span class="lineno">265</span><span class="op" id="4885273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4885276">func</span>&nbsp;<span class="op" id="4885281">(</span><span class="ident" id="4885282">curve</span>&nbsp;<span class="op" id="4885288">*</span><span class="ident" id="4885289">CurveParams</span><span class="op" id="4885300">)</span>&nbsp;<span class="ident" id="4885302">ScalarBaseMult</span><span class="op" id="4885316">(</span><span class="ident" id="4885317">k</span>&nbsp;<span class="op" id="4885319">[</span><span class="op" id="4885320">]</span><span class="builtintype" id="4885321">byte</span><span class="op" id="4885325">)</span>&nbsp;<span class="op" id="4885327">(</span><span class="op" id="4885328">*</span><span class="ident" id="4885329">big</span><span class="op" id="4885332">.</span><span class="ident" id="4885333">Int</span><span class="op" id="4885336">,</span>&nbsp;<span class="op" id="4885338">*</span><span class="ident" id="4885339">big</span><span class="op" id="4885342">.</span><span class="ident" id="4885343">Int</span><span class="op" id="4885346">)</span>&nbsp;<span class="op" id="4885348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885351">return</span>&nbsp;<span class="ident" id="4885358">curve</span><span class="op" id="4885363">.</span><span class="ident" id="4885364">ScalarMult</span><span class="op" id="4885374">(</span><span class="ident" id="4885375">curve</span><span class="op" id="4885380">.</span><span class="ident" id="4885381">Gx</span><span class="op" id="4885383">,</span>&nbsp;<span class="ident" id="4885385">curve</span><span class="op" id="4885390">.</span><span class="ident" id="4885391">Gy</span><span class="op" id="4885393">,</span>&nbsp;<span class="ident" id="4885395">k</span><span class="op" id="4885396">)</span><br>
<span class="lineno"></span><span class="op" id="4885398">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4885401">var</span>&nbsp;<span class="ident" id="4885405">mask</span>&nbsp;<span class="op" id="4885410">=</span>&nbsp;<span class="op" id="4885412">[</span><span class="op" id="4885413">]</span><span class="builtintype" id="4885414">byte</span><span class="op" id="4885418">{</span><span class="num" id="4885419">0xff</span><span class="op" id="4885423">,</span>&nbsp;<span class="num" id="4885425">0x1</span><span class="op" id="4885428">,</span>&nbsp;<span class="num" id="4885430">0x3</span><span class="op" id="4885433">,</span>&nbsp;<span class="num" id="4885435">0x7</span><span class="op" id="4885438">,</span>&nbsp;<span class="num" id="4885440">0xf</span><span class="op" id="4885443">,</span>&nbsp;<span class="num" id="4885445">0x1f</span><span class="op" id="4885449">,</span>&nbsp;<span class="num" id="4885451">0x3f</span><span class="op" id="4885455">,</span>&nbsp;<span class="num" id="4885457">0x7f</span><span class="op" id="4885461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4885464">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4885533">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4885601">func</span>&nbsp;<span class="ident" id="4885606">GenerateKey</span><span class="op" id="4885617">(</span><span class="ident" id="4885618">curve</span>&nbsp;<span class="ident" id="4885624">Curve</span><span class="op" id="4885629">,</span>&nbsp;<span class="ident" id="4885631">rand</span>&nbsp;<span class="ident" id="4885636">io</span><span class="op" id="4885638">.</span><span class="ident" id="4885639">Reader</span><span class="op" id="4885645">)</span>&nbsp;<span class="op" id="4885647">(</span><span class="ident" id="4885648">priv</span>&nbsp;<span class="op" id="4885653">[</span><span class="op" id="4885654">]</span><span class="builtintype" id="4885655">byte</span><span class="op" id="4885659">,</span>&nbsp;<span class="ident" id="4885661">x</span><span class="op" id="4885662">,</span>&nbsp;<span class="ident" id="4885664">y</span>&nbsp;<span class="op" id="4885666">*</span><span class="ident" id="4885667">big</span><span class="op" id="4885670">.</span><span class="ident" id="4885671">Int</span><span class="op" id="4885674">,</span>&nbsp;<span class="ident" id="4885676">err</span>&nbsp;<span class="builtintype" id="4885680">error</span><span class="op" id="4885685">)</span>&nbsp;<span class="op" id="4885687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885690">bitSize</span>&nbsp;<span class="op" id="4885698">:=</span>&nbsp;<span class="ident" id="4885701">curve</span><span class="op" id="4885706">.</span><span class="ident" id="4885707">Params</span><span class="op" id="4885713">(</span><span class="op" id="4885714">)</span><span class="op" id="4885715">.</span><span class="ident" id="4885716">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885725">byteLen</span>&nbsp;<span class="op" id="4885733">:=</span>&nbsp;<span class="op" id="4885736">(</span><span class="ident" id="4885737">bitSize</span>&nbsp;<span class="op" id="4885745">+</span>&nbsp;<span class="num" id="4885747">7</span><span class="op" id="4885748">)</span>&nbsp;<span class="op" id="4885750">&gt;&gt;</span>&nbsp;<span class="num" id="4885753">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885756">priv</span>&nbsp;<span class="op" id="4885761">=</span>&nbsp;<span class="builtinfunc" id="4885763">make</span><span class="op" id="4885767">(</span><span class="op" id="4885768">[</span><span class="op" id="4885769">]</span><span class="builtintype" id="4885770">byte</span><span class="op" id="4885774">,</span>&nbsp;<span class="ident" id="4885776">byteLen</span><span class="op" id="4885783">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885787">for</span>&nbsp;<span class="ident" id="4885791">x</span>&nbsp;<span class="op" id="4885793">==</span>&nbsp;<span class="ident" id="4885796">nil</span>&nbsp;<span class="op" id="4885800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885804">_</span><span class="op" id="4885805">,</span>&nbsp;<span class="ident" id="4885807">err</span>&nbsp;<span class="op" id="4885811">=</span>&nbsp;<span class="ident" id="4885813">io</span><span class="op" id="4885815">.</span><span class="ident" id="4885816">ReadFull</span><span class="op" id="4885824">(</span><span class="ident" id="4885825">rand</span><span class="op" id="4885829">,</span>&nbsp;<span class="ident" id="4885831">priv</span><span class="op" id="4885835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885839">if</span>&nbsp;<span class="ident" id="4885842">err</span>&nbsp;<span class="op" id="4885846">!=</span>&nbsp;<span class="ident" id="4885849">nil</span>&nbsp;<span class="op" id="4885853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4885858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4885867">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4885871">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4885945">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885999">priv</span><span class="op" id="4886003">[</span><span class="num" id="4886004">0</span><span class="op" id="4886005">]</span>&nbsp;<span class="op" id="4886007">&amp;=</span>&nbsp;<span class="ident" id="4886010">mask</span><span class="op" id="4886014">[</span><span class="ident" id="4886015">bitSize</span><span class="op" id="4886022">%</span><span class="num" id="4886023">8</span><span class="op" id="4886024">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4886028">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4886100">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886157">priv</span><span class="op" id="4886161">[</span><span class="num" id="4886162">1</span><span class="op" id="4886163">]</span>&nbsp;<span class="op" id="4886165">^=</span>&nbsp;<span class="num" id="4886168">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886175">x</span><span class="op" id="4886176">,</span>&nbsp;<span class="ident" id="4886178">y</span>&nbsp;<span class="op" id="4886180">=</span>&nbsp;<span class="ident" id="4886182">curve</span><span class="op" id="4886187">.</span><span class="ident" id="4886188">ScalarBaseMult</span><span class="op" id="4886202">(</span><span class="ident" id="4886203">priv</span><span class="op" id="4886207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886213">return</span><br>
<span class="lineno"></span><span class="op" id="4886220">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4886223">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4886307">func</span>&nbsp;<span class="ident" id="4886312">Marshal</span><span class="op" id="4886319">(</span><span class="ident" id="4886320">curve</span>&nbsp;<span class="ident" id="4886326">Curve</span><span class="op" id="4886331">,</span>&nbsp;<span class="ident" id="4886333">x</span><span class="op" id="4886334">,</span>&nbsp;<span class="ident" id="4886336">y</span>&nbsp;<span class="op" id="4886338">*</span><span class="ident" id="4886339">big</span><span class="op" id="4886342">.</span><span class="ident" id="4886343">Int</span><span class="op" id="4886346">)</span>&nbsp;<span class="op" id="4886348">[</span><span class="op" id="4886349">]</span><span class="builtintype" id="4886350">byte</span>&nbsp;<span class="op" id="4886355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886358">byteLen</span>&nbsp;<span class="op" id="4886366">:=</span>&nbsp;<span class="op" id="4886369">(</span><span class="ident" id="4886370">curve</span><span class="op" id="4886375">.</span><span class="ident" id="4886376">Params</span><span class="op" id="4886382">(</span><span class="op" id="4886383">)</span><span class="op" id="4886384">.</span><span class="ident" id="4886385">BitSize</span>&nbsp;<span class="op" id="4886393">+</span>&nbsp;<span class="num" id="4886395">7</span><span class="op" id="4886396">)</span>&nbsp;<span class="op" id="4886398">&gt;&gt;</span>&nbsp;<span class="num" id="4886401">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886405">ret</span>&nbsp;<span class="op" id="4886409">:=</span>&nbsp;<span class="builtinfunc" id="4886412">make</span><span class="op" id="4886416">(</span><span class="op" id="4886417">[</span><span class="op" id="4886418">]</span><span class="builtintype" id="4886419">byte</span><span class="op" id="4886423">,</span>&nbsp;<span class="num" id="4886425">1</span><span class="op" id="4886426">+</span><span class="num" id="4886427">2</span><span class="op" id="4886428">*</span><span class="ident" id="4886429">byteLen</span><span class="op" id="4886436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886439">ret</span><span class="op" id="4886442">[</span><span class="num" id="4886443">0</span><span class="op" id="4886444">]</span>&nbsp;<span class="op" id="4886446">=</span>&nbsp;<span class="num" id="4886448">4</span>&nbsp;<span class="comment" id="4886450">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886474">xBytes</span>&nbsp;<span class="op" id="4886481">:=</span>&nbsp;<span class="ident" id="4886484">x</span><span class="op" id="4886485">.</span><span class="ident" id="4886486">Bytes</span><span class="op" id="4886491">(</span><span class="op" id="4886492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4886495">copy</span><span class="op" id="4886499">(</span><span class="ident" id="4886500">ret</span><span class="op" id="4886503">[</span><span class="num" id="4886504">1</span><span class="op" id="4886505">+</span><span class="ident" id="4886506">byteLen</span><span class="op" id="4886513">-</span><span class="builtinfunc" id="4886514">len</span><span class="op" id="4886517">(</span><span class="ident" id="4886518">xBytes</span><span class="op" id="4886524">)</span><span class="op" id="4886525">:</span><span class="op" id="4886526">]</span><span class="op" id="4886527">,</span>&nbsp;<span class="ident" id="4886529">xBytes</span><span class="op" id="4886535">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886538">yBytes</span>&nbsp;<span class="op" id="4886545">:=</span>&nbsp;<span class="ident" id="4886548">y</span><span class="op" id="4886549">.</span><span class="ident" id="4886550">Bytes</span><span class="op" id="4886555">(</span><span class="op" id="4886556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4886559">copy</span><span class="op" id="4886563">(</span><span class="ident" id="4886564">ret</span><span class="op" id="4886567">[</span><span class="num" id="4886568">1</span><span class="op" id="4886569">+</span><span class="num" id="4886570">2</span><span class="op" id="4886571">*</span><span class="ident" id="4886572">byteLen</span><span class="op" id="4886579">-</span><span class="builtinfunc" id="4886580">len</span><span class="op" id="4886583">(</span><span class="ident" id="4886584">yBytes</span><span class="op" id="4886590">)</span><span class="op" id="4886591">:</span><span class="op" id="4886592">]</span><span class="op" id="4886593">,</span>&nbsp;<span class="ident" id="4886595">yBytes</span><span class="op" id="4886601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886604">return</span>&nbsp;<span class="ident" id="4886611">ret</span><br>
<span class="lineno"></span><span class="op" id="4886615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4886618">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4886710">func</span>&nbsp;<span class="ident" id="4886715">Unmarshal</span><span class="op" id="4886724">(</span><span class="ident" id="4886725">curve</span>&nbsp;<span class="ident" id="4886731">Curve</span><span class="op" id="4886736">,</span>&nbsp;<span class="ident" id="4886738">data</span>&nbsp;<span class="op" id="4886743">[</span><span class="op" id="4886744">]</span><span class="builtintype" id="4886745">byte</span><span class="op" id="4886749">)</span>&nbsp;<span class="op" id="4886751">(</span><span class="ident" id="4886752">x</span><span class="op" id="4886753">,</span>&nbsp;<span class="ident" id="4886755">y</span>&nbsp;<span class="op" id="4886757">*</span><span class="ident" id="4886758">big</span><span class="op" id="4886761">.</span><span class="ident" id="4886762">Int</span><span class="op" id="4886765">)</span>&nbsp;<span class="op" id="4886767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886770">byteLen</span>&nbsp;<span class="op" id="4886778">:=</span>&nbsp;<span class="op" id="4886781">(</span><span class="ident" id="4886782">curve</span><span class="op" id="4886787">.</span><span class="ident" id="4886788">Params</span><span class="op" id="4886794">(</span><span class="op" id="4886795">)</span><span class="op" id="4886796">.</span><span class="ident" id="4886797">BitSize</span>&nbsp;<span class="op" id="4886805">+</span>&nbsp;<span class="num" id="4886807">7</span><span class="op" id="4886808">)</span>&nbsp;<span class="op" id="4886810">&gt;&gt;</span>&nbsp;<span class="num" id="4886813">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886816">if</span>&nbsp;<span class="builtinfunc" id="4886819">len</span><span class="op" id="4886822">(</span><span class="ident" id="4886823">data</span><span class="op" id="4886827">)</span>&nbsp;<span class="op" id="4886829">!=</span>&nbsp;<span class="num" id="4886832">1</span><span class="op" id="4886833">+</span><span class="num" id="4886834">2</span><span class="op" id="4886835">*</span><span class="ident" id="4886836">byteLen</span>&nbsp;<span class="op" id="4886844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886848">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886859">if</span>&nbsp;<span class="ident" id="4886862">data</span><span class="op" id="4886866">[</span><span class="num" id="4886867">0</span><span class="op" id="4886868">]</span>&nbsp;<span class="op" id="4886870">!=</span>&nbsp;<span class="num" id="4886873">4</span>&nbsp;<span class="op" id="4886875">{</span>&nbsp;<span class="comment" id="4886877">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886911">x</span>&nbsp;<span class="op" id="4886913">=</span>&nbsp;<span class="builtinfunc" id="4886915">new</span><span class="op" id="4886918">(</span><span class="ident" id="4886919">big</span><span class="op" id="4886922">.</span><span class="ident" id="4886923">Int</span><span class="op" id="4886926">)</span><span class="op" id="4886927">.</span><span class="ident" id="4886928">SetBytes</span><span class="op" id="4886936">(</span><span class="ident" id="4886937">data</span><span class="op" id="4886941">[</span><span class="num" id="4886942">1</span>&nbsp;<span class="op" id="4886944">:</span>&nbsp;<span class="num" id="4886946">1</span><span class="op" id="4886947">+</span><span class="ident" id="4886948">byteLen</span><span class="op" id="4886955">]</span><span class="op" id="4886956">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886959">y</span>&nbsp;<span class="op" id="4886961">=</span>&nbsp;<span class="builtinfunc" id="4886963">new</span><span class="op" id="4886966">(</span><span class="ident" id="4886967">big</span><span class="op" id="4886970">.</span><span class="ident" id="4886971">Int</span><span class="op" id="4886974">)</span><span class="op" id="4886975">.</span><span class="ident" id="4886976">SetBytes</span><span class="op" id="4886984">(</span><span class="ident" id="4886985">data</span><span class="op" id="4886989">[</span><span class="num" id="4886990">1</span><span class="op" id="4886991">+</span><span class="ident" id="4886992">byteLen</span><span class="op" id="4886999">:</span><span class="op" id="4887000">]</span><span class="op" id="4887001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4887004">return</span><br>
<span class="lineno"></span><span class="op" id="4887011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4887014">var</span>&nbsp;<span class="ident" id="4887018">initonce</span>&nbsp;<span class="ident" id="4887027">sync</span><span class="op" id="4887031">.</span><span class="ident" id="4887032">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4887037">var</span>&nbsp;<span class="ident" id="4887041">p384</span>&nbsp;<span class="op" id="4887046">*</span><span class="ident" id="4887047">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4887059">var</span>&nbsp;<span class="ident" id="4887063">p521</span>&nbsp;<span class="op" id="4887068">*</span><span class="ident" id="4887069">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4887082">func</span>&nbsp;<span class="ident" id="4887087">initAll</span><span class="op" id="4887094">(</span><span class="op" id="4887095">)</span>&nbsp;<span class="op" id="4887097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887100">initP224</span><span class="op" id="4887108">(</span><span class="op" id="4887109">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887112">initP256</span><span class="op" id="4887120">(</span><span class="op" id="4887121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887124">initP384</span><span class="op" id="4887132">(</span><span class="op" id="4887133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887136">initP521</span><span class="op" id="4887144">(</span><span class="op" id="4887145">)</span><br>
<span class="lineno"></span><span class="op" id="4887147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4887150">func</span>&nbsp;<span class="ident" id="4887155">initP384</span><span class="op" id="4887163">(</span><span class="op" id="4887164">)</span>&nbsp;<span class="op" id="4887166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4887169">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887203">p384</span>&nbsp;<span class="op" id="4887208">=</span>&nbsp;<span class="builtinfunc" id="4887210">new</span><span class="op" id="4887213">(</span><span class="ident" id="4887214">CurveParams</span><span class="op" id="4887225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887228">p384</span><span class="op" id="4887232">.</span><span class="ident" id="4887233">P</span><span class="op" id="4887234">,</span>&nbsp;<span class="ident" id="4887236">_</span>&nbsp;<span class="op" id="4887238">=</span>&nbsp;<span class="builtinfunc" id="4887240">new</span><span class="op" id="4887243">(</span><span class="ident" id="4887244">big</span><span class="op" id="4887247">.</span><span class="ident" id="4887248">Int</span><span class="op" id="4887251">)</span><span class="op" id="4887252">.</span><span class="ident" id="4887253">SetString</span><span class="op" id="4887262">(</span><span class="string" id="4887263">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4887381">,</span>&nbsp;<span class="num" id="4887383">10</span><span class="op" id="4887385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887388">p384</span><span class="op" id="4887392">.</span><span class="ident" id="4887393">N</span><span class="op" id="4887394">,</span>&nbsp;<span class="ident" id="4887396">_</span>&nbsp;<span class="op" id="4887398">=</span>&nbsp;<span class="builtinfunc" id="4887400">new</span><span class="op" id="4887403">(</span><span class="ident" id="4887404">big</span><span class="op" id="4887407">.</span><span class="ident" id="4887408">Int</span><span class="op" id="4887411">)</span><span class="op" id="4887412">.</span><span class="ident" id="4887413">SetString</span><span class="op" id="4887422">(</span><span class="string" id="4887423">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4887541">,</span>&nbsp;<span class="num" id="4887543">10</span><span class="op" id="4887545">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887548">p384</span><span class="op" id="4887552">.</span><span class="ident" id="4887553">B</span><span class="op" id="4887554">,</span>&nbsp;<span class="ident" id="4887556">_</span>&nbsp;<span class="op" id="4887558">=</span>&nbsp;<span class="builtinfunc" id="4887560">new</span><span class="op" id="4887563">(</span><span class="ident" id="4887564">big</span><span class="op" id="4887567">.</span><span class="ident" id="4887568">Int</span><span class="op" id="4887571">)</span><span class="op" id="4887572">.</span><span class="ident" id="4887573">SetString</span><span class="op" id="4887582">(</span><span class="string" id="4887583">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4887681">,</span>&nbsp;<span class="num" id="4887683">16</span><span class="op" id="4887685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887688">p384</span><span class="op" id="4887692">.</span><span class="ident" id="4887693">Gx</span><span class="op" id="4887695">,</span>&nbsp;<span class="ident" id="4887697">_</span>&nbsp;<span class="op" id="4887699">=</span>&nbsp;<span class="builtinfunc" id="4887701">new</span><span class="op" id="4887704">(</span><span class="ident" id="4887705">big</span><span class="op" id="4887708">.</span><span class="ident" id="4887709">Int</span><span class="op" id="4887712">)</span><span class="op" id="4887713">.</span><span class="ident" id="4887714">SetString</span><span class="op" id="4887723">(</span><span class="string" id="4887724">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4887822">,</span>&nbsp;<span class="num" id="4887824">16</span><span class="op" id="4887826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887829">p384</span><span class="op" id="4887833">.</span><span class="ident" id="4887834">Gy</span><span class="op" id="4887836">,</span>&nbsp;<span class="ident" id="4887838">_</span>&nbsp;<span class="op" id="4887840">=</span>&nbsp;<span class="builtinfunc" id="4887842">new</span><span class="op" id="4887845">(</span><span class="ident" id="4887846">big</span><span class="op" id="4887849">.</span><span class="ident" id="4887850">Int</span><span class="op" id="4887853">)</span><span class="op" id="4887854">.</span><span class="ident" id="4887855">SetString</span><span class="op" id="4887864">(</span><span class="string" id="4887865">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4887963">,</span>&nbsp;<span class="num" id="4887965">16</span><span class="op" id="4887967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887970">p384</span><span class="op" id="4887974">.</span><span class="ident" id="4887975">BitSize</span>&nbsp;<span class="op" id="4887983">=</span>&nbsp;<span class="num" id="4887985">384</span><br>
<span class="lineno"></span><span class="op" id="4887989">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4887992">func</span>&nbsp;<span class="ident" id="4887997">initP521</span><span class="op" id="4888005">(</span><span class="op" id="4888006">)</span>&nbsp;<span class="op" id="4888008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4888011">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888045">p521</span>&nbsp;<span class="op" id="4888050">=</span>&nbsp;<span class="builtinfunc" id="4888052">new</span><span class="op" id="4888055">(</span><span class="ident" id="4888056">CurveParams</span><span class="op" id="4888067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888070">p521</span><span class="op" id="4888074">.</span><span class="ident" id="4888075">P</span><span class="op" id="4888076">,</span>&nbsp;<span class="ident" id="4888078">_</span>&nbsp;<span class="op" id="4888080">=</span>&nbsp;<span class="builtinfunc" id="4888082">new</span><span class="op" id="4888085">(</span><span class="ident" id="4888086">big</span><span class="op" id="4888089">.</span><span class="ident" id="4888090">Int</span><span class="op" id="4888093">)</span><span class="op" id="4888094">.</span><span class="ident" id="4888095">SetString</span><span class="op" id="4888104">(</span><span class="string" id="4888105">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4888264">,</span>&nbsp;<span class="num" id="4888266">10</span><span class="op" id="4888268">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888271">p521</span><span class="op" id="4888275">.</span><span class="ident" id="4888276">N</span><span class="op" id="4888277">,</span>&nbsp;<span class="ident" id="4888279">_</span>&nbsp;<span class="op" id="4888281">=</span>&nbsp;<span class="builtinfunc" id="4888283">new</span><span class="op" id="4888286">(</span><span class="ident" id="4888287">big</span><span class="op" id="4888290">.</span><span class="ident" id="4888291">Int</span><span class="op" id="4888294">)</span><span class="op" id="4888295">.</span><span class="ident" id="4888296">SetString</span><span class="op" id="4888305">(</span><span class="string" id="4888306">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4888465">,</span>&nbsp;<span class="num" id="4888467">10</span><span class="op" id="4888469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888472">p521</span><span class="op" id="4888476">.</span><span class="ident" id="4888477">B</span><span class="op" id="4888478">,</span>&nbsp;<span class="ident" id="4888480">_</span>&nbsp;<span class="op" id="4888482">=</span>&nbsp;<span class="builtinfunc" id="4888484">new</span><span class="op" id="4888487">(</span><span class="ident" id="4888488">big</span><span class="op" id="4888491">.</span><span class="ident" id="4888492">Int</span><span class="op" id="4888495">)</span><span class="op" id="4888496">.</span><span class="ident" id="4888497">SetString</span><span class="op" id="4888506">(</span><span class="string" id="4888507">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4888640">,</span>&nbsp;<span class="num" id="4888642">16</span><span class="op" id="4888644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888647">p521</span><span class="op" id="4888651">.</span><span class="ident" id="4888652">Gx</span><span class="op" id="4888654">,</span>&nbsp;<span class="ident" id="4888656">_</span>&nbsp;<span class="op" id="4888658">=</span>&nbsp;<span class="builtinfunc" id="4888660">new</span><span class="op" id="4888663">(</span><span class="ident" id="4888664">big</span><span class="op" id="4888667">.</span><span class="ident" id="4888668">Int</span><span class="op" id="4888671">)</span><span class="op" id="4888672">.</span><span class="ident" id="4888673">SetString</span><span class="op" id="4888682">(</span><span class="string" id="4888683">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4888815">,</span>&nbsp;<span class="num" id="4888817">16</span><span class="op" id="4888819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888822">p521</span><span class="op" id="4888826">.</span><span class="ident" id="4888827">Gy</span><span class="op" id="4888829">,</span>&nbsp;<span class="ident" id="4888831">_</span>&nbsp;<span class="op" id="4888833">=</span>&nbsp;<span class="builtinfunc" id="4888835">new</span><span class="op" id="4888838">(</span><span class="ident" id="4888839">big</span><span class="op" id="4888842">.</span><span class="ident" id="4888843">Int</span><span class="op" id="4888846">)</span><span class="op" id="4888847">.</span><span class="ident" id="4888848">SetString</span><span class="op" id="4888857">(</span><span class="string" id="4888858">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4888991">,</span>&nbsp;<span class="num" id="4888993">16</span><span class="op" id="4888995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888998">p521</span><span class="op" id="4889002">.</span><span class="ident" id="4889003">BitSize</span>&nbsp;<span class="op" id="4889011">=</span>&nbsp;<span class="num" id="4889013">521</span><br>
<span class="lineno">355</span><span class="op" id="4889017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889020">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4889099">func</span>&nbsp;<span class="ident" id="4889104">P256</span><span class="op" id="4889108">(</span><span class="op" id="4889109">)</span>&nbsp;<span class="ident" id="4889111">Curve</span>&nbsp;<span class="op" id="4889117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889120">initonce</span><span class="op" id="4889128">.</span><span class="ident" id="4889129">Do</span><span class="op" id="4889131">(</span><span class="ident" id="4889132">initAll</span><span class="op" id="4889139">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4889142">return</span>&nbsp;<span class="ident" id="4889149">p256</span><br>
<span class="lineno"></span><span class="op" id="4889154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889157">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4889236">func</span>&nbsp;<span class="ident" id="4889241">P384</span><span class="op" id="4889245">(</span><span class="op" id="4889246">)</span>&nbsp;<span class="ident" id="4889248">Curve</span>&nbsp;<span class="op" id="4889254">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889257">initonce</span><span class="op" id="4889265">.</span><span class="ident" id="4889266">Do</span><span class="op" id="4889268">(</span><span class="ident" id="4889269">initAll</span><span class="op" id="4889276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4889279">return</span>&nbsp;<span class="ident" id="4889286">p384</span><br>
<span class="lineno"></span><span class="op" id="4889291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889294">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4889373">func</span>&nbsp;<span class="ident" id="4889378">P521</span><span class="op" id="4889382">(</span><span class="op" id="4889383">)</span>&nbsp;<span class="ident" id="4889385">Curve</span>&nbsp;<span class="op" id="4889391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889394">initonce</span><span class="op" id="4889402">.</span><span class="ident" id="4889403">Do</span><span class="op" id="4889405">(</span><span class="ident" id="4889406">initAll</span><span class="op" id="4889413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4889416">return</span>&nbsp;<span class="ident" id="4889423">p521</span><br>
<span class="lineno"></span><span class="op" id="4889428">}</span>
</div>
</body>
</html>
