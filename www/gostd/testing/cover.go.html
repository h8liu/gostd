<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5956801">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5956856">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5956910">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5956961">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5956992">package</span>&nbsp;<span class="ident" id="5957000">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5957009">import</span>&nbsp;<span class="op" id="5957016">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5957019">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5957026">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5957032">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="5957046">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5957049">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="5957115">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="5957194">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5957259">type</span>&nbsp;<span class="ident" id="5957264">CoverBlock</span>&nbsp;<span class="keyword" id="5957275">struct</span>&nbsp;<span class="op" id="5957282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957285">Line0</span>&nbsp;<span class="builtintype" id="5957291">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957299">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="5957305">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957313">Line1</span>&nbsp;<span class="builtintype" id="5957319">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957327">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="5957333">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957341">Stmts</span>&nbsp;<span class="builtintype" id="5957347">uint16</span><br>
<span class="lineno"></span><span class="op" id="5957354">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5957357">var</span>&nbsp;<span class="ident" id="5957361">cover</span>&nbsp;<span class="ident" id="5957367">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5957374">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="5957433">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="5957512">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5957577">type</span>&nbsp;<span class="ident" id="5957582">Cover</span>&nbsp;<span class="keyword" id="5957588">struct</span>&nbsp;<span class="op" id="5957595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957598">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5957614">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957622">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5957638">map</span><span class="op" id="5957641">[</span><span class="builtintype" id="5957642">string</span><span class="op" id="5957648">]</span><span class="op" id="5957649">[</span><span class="op" id="5957650">]</span><span class="builtintype" id="5957651">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957659">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5957675">map</span><span class="op" id="5957678">[</span><span class="builtintype" id="5957679">string</span><span class="op" id="5957685">]</span><span class="op" id="5957686">[</span><span class="op" id="5957687">]</span><span class="ident" id="5957688">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5957700">CoveredPackages</span>&nbsp;<span class="builtintype" id="5957716">string</span><br>
<span class="lineno"></span><span class="op" id="5957723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5957726">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="5957807">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="5957858">//</span><br>
<span class="lineno"></span><span class="comment" id="5957861">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5957948">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="5958023">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5958100">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="5958120">func</span>&nbsp;<span class="ident" id="5958125">Coverage</span><span class="op" id="5958133">(</span><span class="op" id="5958134">)</span>&nbsp;<span class="builtintype" id="5958136">float64</span>&nbsp;<span class="op" id="5958144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958147">var</span>&nbsp;<span class="ident" id="5958151">n</span><span class="op" id="5958152">,</span>&nbsp;<span class="ident" id="5958154">d</span>&nbsp;<span class="ident" id="5958156">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958163">for</span>&nbsp;<span class="ident" id="5958167">_</span><span class="op" id="5958168">,</span>&nbsp;<span class="ident" id="5958170">counters</span>&nbsp;<span class="op" id="5958179">:=</span>&nbsp;<span class="keyword" id="5958182">range</span>&nbsp;<span class="ident" id="5958188">cover</span><span class="op" id="5958193">.</span><span class="ident" id="5958194">Counters</span>&nbsp;<span class="op" id="5958203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958207">for</span>&nbsp;<span class="ident" id="5958211">i</span>&nbsp;<span class="op" id="5958213">:=</span>&nbsp;<span class="keyword" id="5958216">range</span>&nbsp;<span class="ident" id="5958222">counters</span>&nbsp;<span class="op" id="5958231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958236">if</span>&nbsp;<span class="ident" id="5958239">atomic</span><span class="op" id="5958245">.</span><span class="ident" id="5958246">LoadUint32</span><span class="op" id="5958256">(</span><span class="op" id="5958257">&amp;</span><span class="ident" id="5958258">counters</span><span class="op" id="5958266">[</span><span class="ident" id="5958267">i</span><span class="op" id="5958268">]</span><span class="op" id="5958269">)</span>&nbsp;<span class="op" id="5958271">&gt;</span>&nbsp;<span class="num" id="5958273">0</span>&nbsp;<span class="op" id="5958275">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958281">n</span><span class="op" id="5958282">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5958288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958293">d</span><span class="op" id="5958294">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5958299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5958302">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958305">if</span>&nbsp;<span class="ident" id="5958308">d</span>&nbsp;<span class="op" id="5958310">==</span>&nbsp;<span class="num" id="5958313">0</span>&nbsp;<span class="op" id="5958315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958319">return</span>&nbsp;<span class="num" id="5958326">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5958329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958332">return</span>&nbsp;<span class="builtintype" id="5958339">float64</span><span class="op" id="5958346">(</span><span class="ident" id="5958347">n</span><span class="op" id="5958348">)</span>&nbsp;<span class="op" id="5958350">/</span>&nbsp;<span class="builtintype" id="5958352">float64</span><span class="op" id="5958359">(</span><span class="ident" id="5958360">d</span><span class="op" id="5958361">)</span><br>
<span class="lineno"></span><span class="op" id="5958363">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5958366">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="5958437">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="5958518">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5958583">func</span>&nbsp;<span class="ident" id="5958588">RegisterCover</span><span class="op" id="5958601">(</span><span class="ident" id="5958602">c</span>&nbsp;<span class="ident" id="5958604">Cover</span><span class="op" id="5958609">)</span>&nbsp;<span class="op" id="5958611">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958614">cover</span>&nbsp;<span class="op" id="5958620">=</span>&nbsp;<span class="ident" id="5958622">c</span><br>
<span class="lineno"></span><span class="op" id="5958624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5958627">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5958696">func</span>&nbsp;<span class="ident" id="5958701">mustBeNil</span><span class="op" id="5958710">(</span><span class="ident" id="5958711">err</span>&nbsp;<span class="builtintype" id="5958715">error</span><span class="op" id="5958720">)</span>&nbsp;<span class="op" id="5958722">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958725">if</span>&nbsp;<span class="ident" id="5958728">err</span>&nbsp;<span class="op" id="5958732">!=</span>&nbsp;<span class="ident" id="5958735">nil</span>&nbsp;<span class="op" id="5958739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958743">fmt</span><span class="op" id="5958746">.</span><span class="ident" id="5958747">Fprintf</span><span class="op" id="5958754">(</span><span class="ident" id="5958755">os</span><span class="op" id="5958757">.</span><span class="ident" id="5958758">Stderr</span><span class="op" id="5958764">,</span>&nbsp;<span class="string" id="5958766">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="5958781">,</span>&nbsp;<span class="ident" id="5958783">err</span><span class="op" id="5958786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958790">os</span><span class="op" id="5958792">.</span><span class="ident" id="5958793">Exit</span><span class="op" id="5958797">(</span><span class="num" id="5958798">2</span><span class="op" id="5958799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5958802">}</span><br>
<span class="lineno"></span><span class="op" id="5958804">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5958807">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="5958898">func</span>&nbsp;<span class="ident" id="5958903">coverReport</span><span class="op" id="5958914">(</span><span class="op" id="5958915">)</span>&nbsp;<span class="op" id="5958917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958920">var</span>&nbsp;<span class="ident" id="5958924">f</span>&nbsp;<span class="op" id="5958926">*</span><span class="ident" id="5958927">os</span><span class="op" id="5958929">.</span><span class="ident" id="5958930">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958936">var</span>&nbsp;<span class="ident" id="5958940">err</span>&nbsp;<span class="builtintype" id="5958944">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5958951">if</span>&nbsp;<span class="op" id="5958954">*</span><span class="ident" id="5958955">coverProfile</span>&nbsp;<span class="op" id="5958968">!=</span>&nbsp;<span class="string" id="5958971">&#34;&#34;</span>&nbsp;<span class="op" id="5958974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5958978">f</span><span class="op" id="5958979">,</span>&nbsp;<span class="ident" id="5958981">err</span>&nbsp;<span class="op" id="5958985">=</span>&nbsp;<span class="ident" id="5958987">os</span><span class="op" id="5958989">.</span><span class="ident" id="5958990">Create</span><span class="op" id="5958996">(</span><span class="ident" id="5958997">toOutputDir</span><span class="op" id="5959008">(</span><span class="op" id="5959009">*</span><span class="ident" id="5959010">coverProfile</span><span class="op" id="5959022">)</span><span class="op" id="5959023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959027">mustBeNil</span><span class="op" id="5959036">(</span><span class="ident" id="5959037">err</span><span class="op" id="5959040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959044">fmt</span><span class="op" id="5959047">.</span><span class="ident" id="5959048">Fprintf</span><span class="op" id="5959055">(</span><span class="ident" id="5959056">f</span><span class="op" id="5959057">,</span>&nbsp;<span class="string" id="5959059">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="5959071">,</span>&nbsp;<span class="ident" id="5959073">cover</span><span class="op" id="5959078">.</span><span class="ident" id="5959079">Mode</span><span class="op" id="5959083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959087">defer</span>&nbsp;<span class="keyword" id="5959093">func</span><span class="op" id="5959097">(</span><span class="op" id="5959098">)</span>&nbsp;<span class="op" id="5959100">{</span>&nbsp;<span class="ident" id="5959102">mustBeNil</span><span class="op" id="5959111">(</span><span class="ident" id="5959112">f</span><span class="op" id="5959113">.</span><span class="ident" id="5959114">Close</span><span class="op" id="5959119">(</span><span class="op" id="5959120">)</span><span class="op" id="5959121">)</span>&nbsp;<span class="op" id="5959123">}</span><span class="op" id="5959124">(</span><span class="op" id="5959125">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959132">var</span>&nbsp;<span class="ident" id="5959136">active</span><span class="op" id="5959142">,</span>&nbsp;<span class="ident" id="5959144">total</span>&nbsp;<span class="ident" id="5959150">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959157">var</span>&nbsp;<span class="ident" id="5959161">count</span>&nbsp;<span class="builtintype" id="5959167">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959175">for</span>&nbsp;<span class="ident" id="5959179">name</span><span class="op" id="5959183">,</span>&nbsp;<span class="ident" id="5959185">counts</span>&nbsp;<span class="op" id="5959192">:=</span>&nbsp;<span class="keyword" id="5959195">range</span>&nbsp;<span class="ident" id="5959201">cover</span><span class="op" id="5959206">.</span><span class="ident" id="5959207">Counters</span>&nbsp;<span class="op" id="5959216">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959220">blocks</span>&nbsp;<span class="op" id="5959227">:=</span>&nbsp;<span class="ident" id="5959230">cover</span><span class="op" id="5959235">.</span><span class="ident" id="5959236">Blocks</span><span class="op" id="5959242">[</span><span class="ident" id="5959243">name</span><span class="op" id="5959247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959251">for</span>&nbsp;<span class="ident" id="5959255">i</span>&nbsp;<span class="op" id="5959257">:=</span>&nbsp;<span class="keyword" id="5959260">range</span>&nbsp;<span class="ident" id="5959266">counts</span>&nbsp;<span class="op" id="5959273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959278">stmts</span>&nbsp;<span class="op" id="5959284">:=</span>&nbsp;<span class="ident" id="5959287">int64</span><span class="op" id="5959292">(</span><span class="ident" id="5959293">blocks</span><span class="op" id="5959299">[</span><span class="ident" id="5959300">i</span><span class="op" id="5959301">]</span><span class="op" id="5959302">.</span><span class="ident" id="5959303">Stmts</span><span class="op" id="5959308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959313">total</span>&nbsp;<span class="op" id="5959319">+=</span>&nbsp;<span class="ident" id="5959322">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959331">count</span>&nbsp;<span class="op" id="5959337">=</span>&nbsp;<span class="ident" id="5959339">atomic</span><span class="op" id="5959345">.</span><span class="ident" id="5959346">LoadUint32</span><span class="op" id="5959356">(</span><span class="op" id="5959357">&amp;</span><span class="ident" id="5959358">counts</span><span class="op" id="5959364">[</span><span class="ident" id="5959365">i</span><span class="op" id="5959366">]</span><span class="op" id="5959367">)</span>&nbsp;<span class="comment" id="5959369">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959393">if</span>&nbsp;<span class="ident" id="5959396">count</span>&nbsp;<span class="op" id="5959402">&gt;</span>&nbsp;<span class="num" id="5959404">0</span>&nbsp;<span class="op" id="5959406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959412">active</span>&nbsp;<span class="op" id="5959419">+=</span>&nbsp;<span class="ident" id="5959422">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959436">if</span>&nbsp;<span class="ident" id="5959439">f</span>&nbsp;<span class="op" id="5959441">!=</span>&nbsp;<span class="ident" id="5959444">nil</span>&nbsp;<span class="op" id="5959448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959454">_</span><span class="op" id="5959455">,</span>&nbsp;<span class="ident" id="5959457">err</span>&nbsp;<span class="op" id="5959461">:=</span>&nbsp;<span class="ident" id="5959464">fmt</span><span class="op" id="5959467">.</span><span class="ident" id="5959468">Fprintf</span><span class="op" id="5959475">(</span><span class="ident" id="5959476">f</span><span class="op" id="5959477">,</span>&nbsp;<span class="string" id="5959479">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="5959503">,</span>&nbsp;<span class="ident" id="5959505">name</span><span class="op" id="5959509">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959516">blocks</span><span class="op" id="5959522">[</span><span class="ident" id="5959523">i</span><span class="op" id="5959524">]</span><span class="op" id="5959525">.</span><span class="ident" id="5959526">Line0</span><span class="op" id="5959531">,</span>&nbsp;<span class="ident" id="5959533">blocks</span><span class="op" id="5959539">[</span><span class="ident" id="5959540">i</span><span class="op" id="5959541">]</span><span class="op" id="5959542">.</span><span class="ident" id="5959543">Col0</span><span class="op" id="5959547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959554">blocks</span><span class="op" id="5959560">[</span><span class="ident" id="5959561">i</span><span class="op" id="5959562">]</span><span class="op" id="5959563">.</span><span class="ident" id="5959564">Line1</span><span class="op" id="5959569">,</span>&nbsp;<span class="ident" id="5959571">blocks</span><span class="op" id="5959577">[</span><span class="ident" id="5959578">i</span><span class="op" id="5959579">]</span><span class="op" id="5959580">.</span><span class="ident" id="5959581">Col1</span><span class="op" id="5959585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959592">stmts</span><span class="op" id="5959597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959604">count</span><span class="op" id="5959609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959615">mustBeNil</span><span class="op" id="5959624">(</span><span class="ident" id="5959625">err</span><span class="op" id="5959628">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5959643">if</span>&nbsp;<span class="ident" id="5959646">total</span>&nbsp;<span class="op" id="5959652">==</span>&nbsp;<span class="num" id="5959655">0</span>&nbsp;<span class="op" id="5959657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959661">total</span>&nbsp;<span class="op" id="5959667">=</span>&nbsp;<span class="num" id="5959669">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5959672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5959675">fmt</span><span class="op" id="5959678">.</span><span class="ident" id="5959679">Printf</span><span class="op" id="5959685">(</span><span class="string" id="5959686">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="5959722">,</span>&nbsp;<span class="num" id="5959724">100</span><span class="op" id="5959727">*</span><span class="builtintype" id="5959728">float64</span><span class="op" id="5959735">(</span><span class="ident" id="5959736">active</span><span class="op" id="5959742">)</span><span class="op" id="5959743">/</span><span class="builtintype" id="5959744">float64</span><span class="op" id="5959751">(</span><span class="ident" id="5959752">total</span><span class="op" id="5959757">)</span><span class="op" id="5959758">,</span>&nbsp;<span class="ident" id="5959760">cover</span><span class="op" id="5959765">.</span><span class="ident" id="5959766">CoveredPackages</span><span class="op" id="5959781">)</span><br>
<span class="lineno"></span><span class="op" id="5959783">}</span>
</div>
</body>
</html>
