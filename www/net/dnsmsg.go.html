<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1358693">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1358748">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1358802">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1358853">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="1358892">//</span><br>
<span class="lineno"></span><span class="comment" id="1358895">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="1358955">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="1358994">//</span><br>
<span class="lineno">10</span><span class="comment" id="1358997">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1359057">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="1359122">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1359189">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="1359213">//</span><br>
<span class="lineno">15</span><span class="comment" id="1359216">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="1359280">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="1359350">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1359413">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="1359446">//</span><br>
<span class="lineno">20</span><span class="comment" id="1359449">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1359525">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1359592">package</span>&nbsp;<span class="ident" id="1359600">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1359605">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1359624">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="1359643">const</span>&nbsp;<span class="op" id="1359649">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359652">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359704">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359717">=</span>&nbsp;<span class="num" id="1359719">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359722">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359735">=</span>&nbsp;<span class="num" id="1359737">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359740">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359753">=</span>&nbsp;<span class="num" id="1359755">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359758">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359771">=</span>&nbsp;<span class="num" id="1359773">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359776">dnsTypeCNAME</span>&nbsp;<span class="op" id="1359789">=</span>&nbsp;<span class="num" id="1359791">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359794">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1359807">=</span>&nbsp;<span class="num" id="1359809">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359812">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359825">=</span>&nbsp;<span class="num" id="1359827">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359830">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359843">=</span>&nbsp;<span class="num" id="1359845">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359848">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359861">=</span>&nbsp;<span class="num" id="1359863">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359866">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="1359879">=</span>&nbsp;<span class="num" id="1359881">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359885">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1359898">=</span>&nbsp;<span class="num" id="1359900">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359904">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1359917">=</span>&nbsp;<span class="num" id="1359919">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359923">dnsTypeHINFO</span>&nbsp;<span class="op" id="1359936">=</span>&nbsp;<span class="num" id="1359938">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359942">dnsTypeMINFO</span>&nbsp;<span class="op" id="1359955">=</span>&nbsp;<span class="num" id="1359957">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359961">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1359974">=</span>&nbsp;<span class="num" id="1359976">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359980">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1359993">=</span>&nbsp;<span class="num" id="1359995">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359999">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="1360012">=</span>&nbsp;<span class="num" id="1360014">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360018">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1360031">=</span>&nbsp;<span class="num" id="1360033">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360038">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360071">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="1360084">=</span>&nbsp;<span class="num" id="1360086">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360091">dnsTypeMAILB</span>&nbsp;<span class="op" id="1360104">=</span>&nbsp;<span class="num" id="1360106">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360111">dnsTypeMAILA</span>&nbsp;<span class="op" id="1360124">=</span>&nbsp;<span class="num" id="1360126">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360131">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1360144">=</span>&nbsp;<span class="num" id="1360146">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360152">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360181">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1360196">=</span>&nbsp;<span class="num" id="1360198">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360201">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="1360216">=</span>&nbsp;<span class="num" id="1360218">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360221">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="1360236">=</span>&nbsp;<span class="num" id="1360238">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360241">dnsClassHESIOD</span>&nbsp;<span class="op" id="1360256">=</span>&nbsp;<span class="num" id="1360258">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360261">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360276">=</span>&nbsp;<span class="num" id="1360278">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360284">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360301">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360324">=</span>&nbsp;<span class="num" id="1360326">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360329">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360352">=</span>&nbsp;<span class="num" id="1360354">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360357">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="1360380">=</span>&nbsp;<span class="num" id="1360382">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360385">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360408">=</span>&nbsp;<span class="num" id="1360410">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360413">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="1360436">=</span>&nbsp;<span class="num" id="1360438">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360441">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1360464">=</span>&nbsp;<span class="num" id="1360466">5</span><br>
<span class="lineno"></span><span class="op" id="1360468">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="1360471">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="1360538">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="1360565">type</span>&nbsp;<span class="ident" id="1360570">dnsStruct</span>&nbsp;<span class="keyword" id="1360580">interface</span>&nbsp;<span class="op" id="1360590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360593">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360650">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360708">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360764">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360814">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360870">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360912">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360968">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361006">Walk</span><span class="op" id="1361010">(</span><span class="ident" id="1361011">f</span>&nbsp;<span class="keyword" id="1361013">func</span><span class="op" id="1361017">(</span><span class="ident" id="1361018">v</span>&nbsp;<span class="keyword" id="1361020">interface</span><span class="op" id="1361029">{</span><span class="op" id="1361030">}</span><span class="op" id="1361031">,</span>&nbsp;<span class="ident" id="1361033">name</span><span class="op" id="1361037">,</span>&nbsp;<span class="ident" id="1361039">tag</span>&nbsp;<span class="builtintype" id="1361043">string</span><span class="op" id="1361049">)</span>&nbsp;<span class="op" id="1361051">(</span><span class="ident" id="1361052">ok</span>&nbsp;<span class="builtintype" id="1361055">bool</span><span class="op" id="1361059">)</span><span class="op" id="1361060">)</span>&nbsp;<span class="op" id="1361062">(</span><span class="ident" id="1361063">ok</span>&nbsp;<span class="builtintype" id="1361066">bool</span><span class="op" id="1361070">)</span><br>
<span class="lineno"></span><span class="op" id="1361072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1361075">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="1361121">type</span>&nbsp;<span class="ident" id="1361126">dnsHeader</span>&nbsp;<span class="keyword" id="1361136">struct</span>&nbsp;<span class="op" id="1361143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361146">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1361181">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361189">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1361224">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361232">Qdcount</span><span class="op" id="1361239">,</span>&nbsp;<span class="ident" id="1361241">Ancount</span><span class="op" id="1361248">,</span>&nbsp;<span class="ident" id="1361250">Nscount</span><span class="op" id="1361257">,</span>&nbsp;<span class="ident" id="1361259">Arcount</span>&nbsp;<span class="builtintype" id="1361267">uint16</span><br>
<span class="lineno">90</span><span class="op" id="1361274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1361277">func</span>&nbsp;<span class="op" id="1361282">(</span><span class="ident" id="1361283">h</span>&nbsp;<span class="op" id="1361285">*</span><span class="ident" id="1361286"><a href="/net/dnsmsg.go.html#1361126">dnsHeader</a></span><span class="op" id="1361295">)</span>&nbsp;<span class="ident" id="1361297">Walk</span><span class="op" id="1361301">(</span><span class="ident" id="1361302">f</span>&nbsp;<span class="keyword" id="1361304">func</span><span class="op" id="1361308">(</span><span class="ident" id="1361309">v</span>&nbsp;<span class="keyword" id="1361311">interface</span><span class="op" id="1361320">{</span><span class="op" id="1361321">}</span><span class="op" id="1361322">,</span>&nbsp;<span class="ident" id="1361324">name</span><span class="op" id="1361328">,</span>&nbsp;<span class="ident" id="1361330">tag</span>&nbsp;<span class="builtintype" id="1361334">string</span><span class="op" id="1361340">)</span>&nbsp;<span class="builtintype" id="1361342">bool</span><span class="op" id="1361346">)</span>&nbsp;<span class="builtintype" id="1361348">bool</span>&nbsp;<span class="op" id="1361353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361356">return</span>&nbsp;<span class="ident" id="1361363"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361364">(</span><span class="op" id="1361365">&amp;</span><span class="ident" id="1361366"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361367">.</span><span class="ident" id="1361368">Id</span><span class="op" id="1361370">,</span>&nbsp;<span class="string" id="1361372">&#34;Id&#34;</span><span class="op" id="1361376">,</span>&nbsp;<span class="string" id="1361378">&#34;&#34;</span><span class="op" id="1361380">)</span>&nbsp;<span class="op" id="1361382">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361387"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361388">(</span><span class="op" id="1361389">&amp;</span><span class="ident" id="1361390"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361391">.</span><span class="ident" id="1361392">Bits</span><span class="op" id="1361396">,</span>&nbsp;<span class="string" id="1361398">&#34;Bits&#34;</span><span class="op" id="1361404">,</span>&nbsp;<span class="string" id="1361406">&#34;&#34;</span><span class="op" id="1361408">)</span>&nbsp;<span class="op" id="1361410">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361415"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361416">(</span><span class="op" id="1361417">&amp;</span><span class="ident" id="1361418"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361419">.</span><span class="ident" id="1361420">Qdcount</span><span class="op" id="1361427">,</span>&nbsp;<span class="string" id="1361429">&#34;Qdcount&#34;</span><span class="op" id="1361438">,</span>&nbsp;<span class="string" id="1361440">&#34;&#34;</span><span class="op" id="1361442">)</span>&nbsp;<span class="op" id="1361444">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361449"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361450">(</span><span class="op" id="1361451">&amp;</span><span class="ident" id="1361452"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361453">.</span><span class="ident" id="1361454">Ancount</span><span class="op" id="1361461">,</span>&nbsp;<span class="string" id="1361463">&#34;Ancount&#34;</span><span class="op" id="1361472">,</span>&nbsp;<span class="string" id="1361474">&#34;&#34;</span><span class="op" id="1361476">)</span>&nbsp;<span class="op" id="1361478">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361483"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361484">(</span><span class="op" id="1361485">&amp;</span><span class="ident" id="1361486"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361487">.</span><span class="ident" id="1361488">Nscount</span><span class="op" id="1361495">,</span>&nbsp;<span class="string" id="1361497">&#34;Nscount&#34;</span><span class="op" id="1361506">,</span>&nbsp;<span class="string" id="1361508">&#34;&#34;</span><span class="op" id="1361510">)</span>&nbsp;<span class="op" id="1361512">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361517"><a href="/net/dnsmsg.go.html#1361302">f</a></span><span class="op" id="1361518">(</span><span class="op" id="1361519">&amp;</span><span class="ident" id="1361520"><a href="/net/dnsmsg.go.html#1361283">h</a></span><span class="op" id="1361521">.</span><span class="ident" id="1361522">Arcount</span><span class="op" id="1361529">,</span>&nbsp;<span class="string" id="1361531">&#34;Arcount&#34;</span><span class="op" id="1361540">,</span>&nbsp;<span class="string" id="1361542">&#34;&#34;</span><span class="op" id="1361544">)</span><br>
<span class="lineno"></span><span class="op" id="1361546">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="1361549">const</span>&nbsp;<span class="op" id="1361555">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1361558">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361577">_QR</span>&nbsp;<span class="op" id="1361581">=</span>&nbsp;<span class="num" id="1361583">1</span>&nbsp;<span class="op" id="1361585">&lt;&lt;</span>&nbsp;<span class="num" id="1361588">15</span>&nbsp;<span class="comment" id="1361591">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361623">_AA</span>&nbsp;<span class="op" id="1361627">=</span>&nbsp;<span class="num" id="1361629">1</span>&nbsp;<span class="op" id="1361631">&lt;&lt;</span>&nbsp;<span class="num" id="1361634">10</span>&nbsp;<span class="comment" id="1361637">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361655">_TC</span>&nbsp;<span class="op" id="1361659">=</span>&nbsp;<span class="num" id="1361661">1</span>&nbsp;<span class="op" id="1361663">&lt;&lt;</span>&nbsp;<span class="num" id="1361666">9</span>&nbsp;&nbsp;<span class="comment" id="1361669">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361683">_RD</span>&nbsp;<span class="op" id="1361687">=</span>&nbsp;<span class="num" id="1361689">1</span>&nbsp;<span class="op" id="1361691">&lt;&lt;</span>&nbsp;<span class="num" id="1361694">8</span>&nbsp;&nbsp;<span class="comment" id="1361697">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361719">_RA</span>&nbsp;<span class="op" id="1361723">=</span>&nbsp;<span class="num" id="1361725">1</span>&nbsp;<span class="op" id="1361727">&lt;&lt;</span>&nbsp;<span class="num" id="1361730">7</span>&nbsp;&nbsp;<span class="comment" id="1361733">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="1361756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1361759">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="1361775">type</span>&nbsp;<span class="ident" id="1361780">dnsQuestion</span>&nbsp;<span class="keyword" id="1361792">struct</span>&nbsp;<span class="op" id="1361799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361802">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1361809">string</span>&nbsp;<span class="string" id="1361816">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="1361836">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361898">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="1361905">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361913">Qclass</span>&nbsp;<span class="builtintype" id="1361920">uint16</span><br>
<span class="lineno">115</span><span class="op" id="1361927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1361930">func</span>&nbsp;<span class="op" id="1361935">(</span><span class="ident" id="1361936">q</span>&nbsp;<span class="op" id="1361938">*</span><span class="ident" id="1361939"><a href="/net/dnsmsg.go.html#1361780">dnsQuestion</a></span><span class="op" id="1361950">)</span>&nbsp;<span class="ident" id="1361952">Walk</span><span class="op" id="1361956">(</span><span class="ident" id="1361957">f</span>&nbsp;<span class="keyword" id="1361959">func</span><span class="op" id="1361963">(</span><span class="ident" id="1361964">v</span>&nbsp;<span class="keyword" id="1361966">interface</span><span class="op" id="1361975">{</span><span class="op" id="1361976">}</span><span class="op" id="1361977">,</span>&nbsp;<span class="ident" id="1361979">name</span><span class="op" id="1361983">,</span>&nbsp;<span class="ident" id="1361985">tag</span>&nbsp;<span class="builtintype" id="1361989">string</span><span class="op" id="1361995">)</span>&nbsp;<span class="builtintype" id="1361997">bool</span><span class="op" id="1362001">)</span>&nbsp;<span class="builtintype" id="1362003">bool</span>&nbsp;<span class="op" id="1362008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362011">return</span>&nbsp;<span class="ident" id="1362018"><a href="/net/dnsmsg.go.html#1361957">f</a></span><span class="op" id="1362019">(</span><span class="op" id="1362020">&amp;</span><span class="ident" id="1362021"><a href="/net/dnsmsg.go.html#1361936">q</a></span><span class="op" id="1362022">.</span><span class="ident" id="1362023">Name</span><span class="op" id="1362027">,</span>&nbsp;<span class="string" id="1362029">&#34;Name&#34;</span><span class="op" id="1362035">,</span>&nbsp;<span class="string" id="1362037">&#34;domain&#34;</span><span class="op" id="1362045">)</span>&nbsp;<span class="op" id="1362047">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362052"><a href="/net/dnsmsg.go.html#1361957">f</a></span><span class="op" id="1362053">(</span><span class="op" id="1362054">&amp;</span><span class="ident" id="1362055"><a href="/net/dnsmsg.go.html#1361936">q</a></span><span class="op" id="1362056">.</span><span class="ident" id="1362057">Qtype</span><span class="op" id="1362062">,</span>&nbsp;<span class="string" id="1362064">&#34;Qtype&#34;</span><span class="op" id="1362071">,</span>&nbsp;<span class="string" id="1362073">&#34;&#34;</span><span class="op" id="1362075">)</span>&nbsp;<span class="op" id="1362077">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362082"><a href="/net/dnsmsg.go.html#1361957">f</a></span><span class="op" id="1362083">(</span><span class="op" id="1362084">&amp;</span><span class="ident" id="1362085"><a href="/net/dnsmsg.go.html#1361936">q</a></span><span class="op" id="1362086">.</span><span class="ident" id="1362087">Qclass</span><span class="op" id="1362093">,</span>&nbsp;<span class="string" id="1362095">&#34;Qclass&#34;</span><span class="op" id="1362103">,</span>&nbsp;<span class="string" id="1362105">&#34;&#34;</span><span class="op" id="1362107">)</span><br>
<span class="lineno"></span><span class="op" id="1362109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1362112">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="1362149">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="1362186">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="1362225">type</span>&nbsp;<span class="ident" id="1362230">dnsRR_Header</span>&nbsp;<span class="keyword" id="1362243">struct</span>&nbsp;<span class="op" id="1362250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362253">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1362262">string</span>&nbsp;<span class="string" id="1362269">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362290">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1362299">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362307">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1362316">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362324">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1362333">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362341">Rdlength</span>&nbsp;<span class="builtintype" id="1362350">uint16</span>&nbsp;<span class="comment" id="1362357">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="1362388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1362391">func</span>&nbsp;<span class="op" id="1362396">(</span><span class="ident" id="1362397">h</span>&nbsp;<span class="op" id="1362399">*</span><span class="ident" id="1362400"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><span class="op" id="1362412">)</span>&nbsp;<span class="ident" id="1362414">Header</span><span class="op" id="1362420">(</span><span class="op" id="1362421">)</span>&nbsp;<span class="op" id="1362423">*</span><span class="ident" id="1362424"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1362437">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362440">return</span>&nbsp;<span class="ident" id="1362447"><a href="/net/dnsmsg.go.html#1362397">h</a></span><br>
<span class="lineno"></span><span class="op" id="1362449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1362452">func</span>&nbsp;<span class="op" id="1362457">(</span><span class="ident" id="1362458">h</span>&nbsp;<span class="op" id="1362460">*</span><span class="ident" id="1362461"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><span class="op" id="1362473">)</span>&nbsp;<span class="ident" id="1362475">Walk</span><span class="op" id="1362479">(</span><span class="ident" id="1362480">f</span>&nbsp;<span class="keyword" id="1362482">func</span><span class="op" id="1362486">(</span><span class="ident" id="1362487">v</span>&nbsp;<span class="keyword" id="1362489">interface</span><span class="op" id="1362498">{</span><span class="op" id="1362499">}</span><span class="op" id="1362500">,</span>&nbsp;<span class="ident" id="1362502">name</span><span class="op" id="1362506">,</span>&nbsp;<span class="ident" id="1362508">tag</span>&nbsp;<span class="builtintype" id="1362512">string</span><span class="op" id="1362518">)</span>&nbsp;<span class="builtintype" id="1362520">bool</span><span class="op" id="1362524">)</span>&nbsp;<span class="builtintype" id="1362526">bool</span>&nbsp;<span class="op" id="1362531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362534">return</span>&nbsp;<span class="ident" id="1362541"><a href="/net/dnsmsg.go.html#1362480">f</a></span><span class="op" id="1362542">(</span><span class="op" id="1362543">&amp;</span><span class="ident" id="1362544"><a href="/net/dnsmsg.go.html#1362458">h</a></span><span class="op" id="1362545">.</span><span class="ident" id="1362546">Name</span><span class="op" id="1362550">,</span>&nbsp;<span class="string" id="1362552">&#34;Name&#34;</span><span class="op" id="1362558">,</span>&nbsp;<span class="string" id="1362560">&#34;domain&#34;</span><span class="op" id="1362568">)</span>&nbsp;<span class="op" id="1362570">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362575"><a href="/net/dnsmsg.go.html#1362480">f</a></span><span class="op" id="1362576">(</span><span class="op" id="1362577">&amp;</span><span class="ident" id="1362578"><a href="/net/dnsmsg.go.html#1362458">h</a></span><span class="op" id="1362579">.</span><span class="ident" id="1362580">Rrtype</span><span class="op" id="1362586">,</span>&nbsp;<span class="string" id="1362588">&#34;Rrtype&#34;</span><span class="op" id="1362596">,</span>&nbsp;<span class="string" id="1362598">&#34;&#34;</span><span class="op" id="1362600">)</span>&nbsp;<span class="op" id="1362602">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362607"><a href="/net/dnsmsg.go.html#1362480">f</a></span><span class="op" id="1362608">(</span><span class="op" id="1362609">&amp;</span><span class="ident" id="1362610"><a href="/net/dnsmsg.go.html#1362458">h</a></span><span class="op" id="1362611">.</span><span class="ident" id="1362612">Class</span><span class="op" id="1362617">,</span>&nbsp;<span class="string" id="1362619">&#34;Class&#34;</span><span class="op" id="1362626">,</span>&nbsp;<span class="string" id="1362628">&#34;&#34;</span><span class="op" id="1362630">)</span>&nbsp;<span class="op" id="1362632">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362637"><a href="/net/dnsmsg.go.html#1362480">f</a></span><span class="op" id="1362638">(</span><span class="op" id="1362639">&amp;</span><span class="ident" id="1362640"><a href="/net/dnsmsg.go.html#1362458">h</a></span><span class="op" id="1362641">.</span><span class="ident" id="1362642">Ttl</span><span class="op" id="1362645">,</span>&nbsp;<span class="string" id="1362647">&#34;Ttl&#34;</span><span class="op" id="1362652">,</span>&nbsp;<span class="string" id="1362654">&#34;&#34;</span><span class="op" id="1362656">)</span>&nbsp;<span class="op" id="1362658">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362663"><a href="/net/dnsmsg.go.html#1362480">f</a></span><span class="op" id="1362664">(</span><span class="op" id="1362665">&amp;</span><span class="ident" id="1362666"><a href="/net/dnsmsg.go.html#1362458">h</a></span><span class="op" id="1362667">.</span><span class="ident" id="1362668">Rdlength</span><span class="op" id="1362676">,</span>&nbsp;<span class="string" id="1362678">&#34;Rdlength&#34;</span><span class="op" id="1362688">,</span>&nbsp;<span class="string" id="1362690">&#34;&#34;</span><span class="op" id="1362692">)</span><br>
<span class="lineno"></span><span class="op" id="1362694">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="1362697">type</span>&nbsp;<span class="ident" id="1362702">dnsRR</span>&nbsp;<span class="keyword" id="1362708">interface</span>&nbsp;<span class="op" id="1362718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362721"><a href="/net/dnsmsg.go.html#1360570">dnsStruct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362732">Header</span><span class="op" id="1362738">(</span><span class="op" id="1362739">)</span>&nbsp;<span class="op" id="1362741">*</span><span class="ident" id="1362742"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span><span class="op" id="1362755">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="1362758">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1362807">type</span>&nbsp;<span class="ident" id="1362812">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="1362824">struct</span>&nbsp;<span class="op" id="1362831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362834">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1362840"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1362854">Cname</span>&nbsp;<span class="builtintype" id="1362860">string</span>&nbsp;<span class="string" id="1362867">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1362887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1362890">func</span>&nbsp;<span class="op" id="1362895">(</span><span class="ident" id="1362896">rr</span>&nbsp;<span class="op" id="1362899">*</span><span class="ident" id="1362900"><a href="/net/dnsmsg.go.html#1362812">dnsRR_CNAME</a></span><span class="op" id="1362911">)</span>&nbsp;<span class="ident" id="1362913">Header</span><span class="op" id="1362919">(</span><span class="op" id="1362920">)</span>&nbsp;<span class="op" id="1362922">*</span><span class="ident" id="1362923"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1362936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362939">return</span>&nbsp;<span class="op" id="1362946">&amp;</span><span class="ident" id="1362947"><a href="/net/dnsmsg.go.html#1362896">rr</a></span><span class="op" id="1362949">.</span><span class="ident" id="1362950">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="1362954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1362957">func</span>&nbsp;<span class="op" id="1362962">(</span><span class="ident" id="1362963">rr</span>&nbsp;<span class="op" id="1362966">*</span><span class="ident" id="1362967"><a href="/net/dnsmsg.go.html#1362812">dnsRR_CNAME</a></span><span class="op" id="1362978">)</span>&nbsp;<span class="ident" id="1362980">Walk</span><span class="op" id="1362984">(</span><span class="ident" id="1362985">f</span>&nbsp;<span class="keyword" id="1362987">func</span><span class="op" id="1362991">(</span><span class="ident" id="1362992">v</span>&nbsp;<span class="keyword" id="1362994">interface</span><span class="op" id="1363003">{</span><span class="op" id="1363004">}</span><span class="op" id="1363005">,</span>&nbsp;<span class="ident" id="1363007">name</span><span class="op" id="1363011">,</span>&nbsp;<span class="ident" id="1363013">tag</span>&nbsp;<span class="builtintype" id="1363017">string</span><span class="op" id="1363023">)</span>&nbsp;<span class="builtintype" id="1363025">bool</span><span class="op" id="1363029">)</span>&nbsp;<span class="builtintype" id="1363031">bool</span>&nbsp;<span class="op" id="1363036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363039">return</span>&nbsp;<span class="ident" id="1363046"><a href="/net/dnsmsg.go.html#1362963">rr</a></span><span class="op" id="1363048">.</span><span class="ident" id="1363049">Hdr</span><span class="op" id="1363052">.</span><span class="ident" id="1363053">Walk</span><span class="op" id="1363057">(</span><span class="ident" id="1363058"><a href="/net/dnsmsg.go.html#1362985">f</a></span><span class="op" id="1363059">)</span>&nbsp;<span class="op" id="1363061">&amp;&amp;</span>&nbsp;<span class="ident" id="1363064"><a href="/net/dnsmsg.go.html#1362985">f</a></span><span class="op" id="1363065">(</span><span class="op" id="1363066">&amp;</span><span class="ident" id="1363067"><a href="/net/dnsmsg.go.html#1362963">rr</a></span><span class="op" id="1363069">.</span><span class="ident" id="1363070">Cname</span><span class="op" id="1363075">,</span>&nbsp;<span class="string" id="1363077">&#34;Cname&#34;</span><span class="op" id="1363084">,</span>&nbsp;<span class="string" id="1363086">&#34;domain&#34;</span><span class="op" id="1363094">)</span><br>
<span class="lineno"></span><span class="op" id="1363096">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="1363099">type</span>&nbsp;<span class="ident" id="1363104">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="1363116">struct</span>&nbsp;<span class="op" id="1363123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363126">Hdr</span>&nbsp;<span class="ident" id="1363130"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363144">Cpu</span>&nbsp;<span class="builtintype" id="1363148">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363156">Os</span>&nbsp;&nbsp;<span class="builtintype" id="1363160">string</span><br>
<span class="lineno">170</span><span class="op" id="1363167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1363170">func</span>&nbsp;<span class="op" id="1363175">(</span><span class="ident" id="1363176">rr</span>&nbsp;<span class="op" id="1363179">*</span><span class="ident" id="1363180"><a href="/net/dnsmsg.go.html#1363104">dnsRR_HINFO</a></span><span class="op" id="1363191">)</span>&nbsp;<span class="ident" id="1363193">Header</span><span class="op" id="1363199">(</span><span class="op" id="1363200">)</span>&nbsp;<span class="op" id="1363202">*</span><span class="ident" id="1363203"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1363216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363219">return</span>&nbsp;<span class="op" id="1363226">&amp;</span><span class="ident" id="1363227"><a href="/net/dnsmsg.go.html#1363176">rr</a></span><span class="op" id="1363229">.</span><span class="ident" id="1363230">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1363234">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="1363237">func</span>&nbsp;<span class="op" id="1363242">(</span><span class="ident" id="1363243">rr</span>&nbsp;<span class="op" id="1363246">*</span><span class="ident" id="1363247"><a href="/net/dnsmsg.go.html#1363104">dnsRR_HINFO</a></span><span class="op" id="1363258">)</span>&nbsp;<span class="ident" id="1363260">Walk</span><span class="op" id="1363264">(</span><span class="ident" id="1363265">f</span>&nbsp;<span class="keyword" id="1363267">func</span><span class="op" id="1363271">(</span><span class="ident" id="1363272">v</span>&nbsp;<span class="keyword" id="1363274">interface</span><span class="op" id="1363283">{</span><span class="op" id="1363284">}</span><span class="op" id="1363285">,</span>&nbsp;<span class="ident" id="1363287">name</span><span class="op" id="1363291">,</span>&nbsp;<span class="ident" id="1363293">tag</span>&nbsp;<span class="builtintype" id="1363297">string</span><span class="op" id="1363303">)</span>&nbsp;<span class="builtintype" id="1363305">bool</span><span class="op" id="1363309">)</span>&nbsp;<span class="builtintype" id="1363311">bool</span>&nbsp;<span class="op" id="1363316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363319">return</span>&nbsp;<span class="ident" id="1363326"><a href="/net/dnsmsg.go.html#1363243">rr</a></span><span class="op" id="1363328">.</span><span class="ident" id="1363329">Hdr</span><span class="op" id="1363332">.</span><span class="ident" id="1363333">Walk</span><span class="op" id="1363337">(</span><span class="ident" id="1363338"><a href="/net/dnsmsg.go.html#1363265">f</a></span><span class="op" id="1363339">)</span>&nbsp;<span class="op" id="1363341">&amp;&amp;</span>&nbsp;<span class="ident" id="1363344"><a href="/net/dnsmsg.go.html#1363265">f</a></span><span class="op" id="1363345">(</span><span class="op" id="1363346">&amp;</span><span class="ident" id="1363347"><a href="/net/dnsmsg.go.html#1363243">rr</a></span><span class="op" id="1363349">.</span><span class="ident" id="1363350">Cpu</span><span class="op" id="1363353">,</span>&nbsp;<span class="string" id="1363355">&#34;Cpu&#34;</span><span class="op" id="1363360">,</span>&nbsp;<span class="string" id="1363362">&#34;&#34;</span><span class="op" id="1363364">)</span>&nbsp;<span class="op" id="1363366">&amp;&amp;</span>&nbsp;<span class="ident" id="1363369"><a href="/net/dnsmsg.go.html#1363265">f</a></span><span class="op" id="1363370">(</span><span class="op" id="1363371">&amp;</span><span class="ident" id="1363372"><a href="/net/dnsmsg.go.html#1363243">rr</a></span><span class="op" id="1363374">.</span><span class="ident" id="1363375">Os</span><span class="op" id="1363377">,</span>&nbsp;<span class="string" id="1363379">&#34;Os&#34;</span><span class="op" id="1363383">,</span>&nbsp;<span class="string" id="1363385">&#34;&#34;</span><span class="op" id="1363387">)</span><br>
<span class="lineno"></span><span class="op" id="1363389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="1363392">type</span>&nbsp;<span class="ident" id="1363397">dnsRR_MB</span>&nbsp;<span class="keyword" id="1363406">struct</span>&nbsp;<span class="op" id="1363413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363416">Hdr</span>&nbsp;<span class="ident" id="1363420"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363434">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="1363438">string</span>&nbsp;<span class="string" id="1363445">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1363465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="1363468">func</span>&nbsp;<span class="op" id="1363473">(</span><span class="ident" id="1363474">rr</span>&nbsp;<span class="op" id="1363477">*</span><span class="ident" id="1363478"><a href="/net/dnsmsg.go.html#1363397">dnsRR_MB</a></span><span class="op" id="1363486">)</span>&nbsp;<span class="ident" id="1363488">Header</span><span class="op" id="1363494">(</span><span class="op" id="1363495">)</span>&nbsp;<span class="op" id="1363497">*</span><span class="ident" id="1363498"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1363511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363514">return</span>&nbsp;<span class="op" id="1363521">&amp;</span><span class="ident" id="1363522"><a href="/net/dnsmsg.go.html#1363474">rr</a></span><span class="op" id="1363524">.</span><span class="ident" id="1363525">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1363529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1363532">func</span>&nbsp;<span class="op" id="1363537">(</span><span class="ident" id="1363538">rr</span>&nbsp;<span class="op" id="1363541">*</span><span class="ident" id="1363542"><a href="/net/dnsmsg.go.html#1363397">dnsRR_MB</a></span><span class="op" id="1363550">)</span>&nbsp;<span class="ident" id="1363552">Walk</span><span class="op" id="1363556">(</span><span class="ident" id="1363557">f</span>&nbsp;<span class="keyword" id="1363559">func</span><span class="op" id="1363563">(</span><span class="ident" id="1363564">v</span>&nbsp;<span class="keyword" id="1363566">interface</span><span class="op" id="1363575">{</span><span class="op" id="1363576">}</span><span class="op" id="1363577">,</span>&nbsp;<span class="ident" id="1363579">name</span><span class="op" id="1363583">,</span>&nbsp;<span class="ident" id="1363585">tag</span>&nbsp;<span class="builtintype" id="1363589">string</span><span class="op" id="1363595">)</span>&nbsp;<span class="builtintype" id="1363597">bool</span><span class="op" id="1363601">)</span>&nbsp;<span class="builtintype" id="1363603">bool</span>&nbsp;<span class="op" id="1363608">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363611">return</span>&nbsp;<span class="ident" id="1363618"><a href="/net/dnsmsg.go.html#1363538">rr</a></span><span class="op" id="1363620">.</span><span class="ident" id="1363621">Hdr</span><span class="op" id="1363624">.</span><span class="ident" id="1363625">Walk</span><span class="op" id="1363629">(</span><span class="ident" id="1363630"><a href="/net/dnsmsg.go.html#1363557">f</a></span><span class="op" id="1363631">)</span>&nbsp;<span class="op" id="1363633">&amp;&amp;</span>&nbsp;<span class="ident" id="1363636"><a href="/net/dnsmsg.go.html#1363557">f</a></span><span class="op" id="1363637">(</span><span class="op" id="1363638">&amp;</span><span class="ident" id="1363639"><a href="/net/dnsmsg.go.html#1363538">rr</a></span><span class="op" id="1363641">.</span><span class="ident" id="1363642">Mb</span><span class="op" id="1363644">,</span>&nbsp;<span class="string" id="1363646">&#34;Mb&#34;</span><span class="op" id="1363650">,</span>&nbsp;<span class="string" id="1363652">&#34;domain&#34;</span><span class="op" id="1363660">)</span><br>
<span class="lineno"></span><span class="op" id="1363662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1363665">type</span>&nbsp;<span class="ident" id="1363670">dnsRR_MG</span>&nbsp;<span class="keyword" id="1363679">struct</span>&nbsp;<span class="op" id="1363686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363689">Hdr</span>&nbsp;<span class="ident" id="1363693"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363707">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="1363711">string</span>&nbsp;<span class="string" id="1363718">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1363738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1363741">func</span>&nbsp;<span class="op" id="1363746">(</span><span class="ident" id="1363747">rr</span>&nbsp;<span class="op" id="1363750">*</span><span class="ident" id="1363751"><a href="/net/dnsmsg.go.html#1363670">dnsRR_MG</a></span><span class="op" id="1363759">)</span>&nbsp;<span class="ident" id="1363761">Header</span><span class="op" id="1363767">(</span><span class="op" id="1363768">)</span>&nbsp;<span class="op" id="1363770">*</span><span class="ident" id="1363771"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1363784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363787">return</span>&nbsp;<span class="op" id="1363794">&amp;</span><span class="ident" id="1363795"><a href="/net/dnsmsg.go.html#1363747">rr</a></span><span class="op" id="1363797">.</span><span class="ident" id="1363798">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="1363802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1363805">func</span>&nbsp;<span class="op" id="1363810">(</span><span class="ident" id="1363811">rr</span>&nbsp;<span class="op" id="1363814">*</span><span class="ident" id="1363815"><a href="/net/dnsmsg.go.html#1363670">dnsRR_MG</a></span><span class="op" id="1363823">)</span>&nbsp;<span class="ident" id="1363825">Walk</span><span class="op" id="1363829">(</span><span class="ident" id="1363830">f</span>&nbsp;<span class="keyword" id="1363832">func</span><span class="op" id="1363836">(</span><span class="ident" id="1363837">v</span>&nbsp;<span class="keyword" id="1363839">interface</span><span class="op" id="1363848">{</span><span class="op" id="1363849">}</span><span class="op" id="1363850">,</span>&nbsp;<span class="ident" id="1363852">name</span><span class="op" id="1363856">,</span>&nbsp;<span class="ident" id="1363858">tag</span>&nbsp;<span class="builtintype" id="1363862">string</span><span class="op" id="1363868">)</span>&nbsp;<span class="builtintype" id="1363870">bool</span><span class="op" id="1363874">)</span>&nbsp;<span class="builtintype" id="1363876">bool</span>&nbsp;<span class="op" id="1363881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363884">return</span>&nbsp;<span class="ident" id="1363891"><a href="/net/dnsmsg.go.html#1363811">rr</a></span><span class="op" id="1363893">.</span><span class="ident" id="1363894">Hdr</span><span class="op" id="1363897">.</span><span class="ident" id="1363898">Walk</span><span class="op" id="1363902">(</span><span class="ident" id="1363903"><a href="/net/dnsmsg.go.html#1363830">f</a></span><span class="op" id="1363904">)</span>&nbsp;<span class="op" id="1363906">&amp;&amp;</span>&nbsp;<span class="ident" id="1363909"><a href="/net/dnsmsg.go.html#1363830">f</a></span><span class="op" id="1363910">(</span><span class="op" id="1363911">&amp;</span><span class="ident" id="1363912"><a href="/net/dnsmsg.go.html#1363811">rr</a></span><span class="op" id="1363914">.</span><span class="ident" id="1363915">Mg</span><span class="op" id="1363917">,</span>&nbsp;<span class="string" id="1363919">&#34;Mg&#34;</span><span class="op" id="1363923">,</span>&nbsp;<span class="string" id="1363925">&#34;domain&#34;</span><span class="op" id="1363933">)</span><br>
<span class="lineno"></span><span class="op" id="1363935">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="1363938">type</span>&nbsp;<span class="ident" id="1363943">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="1363955">struct</span>&nbsp;<span class="op" id="1363962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363965">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1363971"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1363985">Rmail</span>&nbsp;<span class="builtintype" id="1363991">string</span>&nbsp;<span class="string" id="1363998">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364019">Email</span>&nbsp;<span class="builtintype" id="1364025">string</span>&nbsp;<span class="string" id="1364032">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="1364052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364055">func</span>&nbsp;<span class="op" id="1364060">(</span><span class="ident" id="1364061">rr</span>&nbsp;<span class="op" id="1364064">*</span><span class="ident" id="1364065"><a href="/net/dnsmsg.go.html#1363943">dnsRR_MINFO</a></span><span class="op" id="1364076">)</span>&nbsp;<span class="ident" id="1364078">Header</span><span class="op" id="1364084">(</span><span class="op" id="1364085">)</span>&nbsp;<span class="op" id="1364087">*</span><span class="ident" id="1364088"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1364101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364104">return</span>&nbsp;<span class="op" id="1364111">&amp;</span><span class="ident" id="1364112"><a href="/net/dnsmsg.go.html#1364061">rr</a></span><span class="op" id="1364114">.</span><span class="ident" id="1364115">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1364119">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="1364122">func</span>&nbsp;<span class="op" id="1364127">(</span><span class="ident" id="1364128">rr</span>&nbsp;<span class="op" id="1364131">*</span><span class="ident" id="1364132"><a href="/net/dnsmsg.go.html#1363943">dnsRR_MINFO</a></span><span class="op" id="1364143">)</span>&nbsp;<span class="ident" id="1364145">Walk</span><span class="op" id="1364149">(</span><span class="ident" id="1364150">f</span>&nbsp;<span class="keyword" id="1364152">func</span><span class="op" id="1364156">(</span><span class="ident" id="1364157">v</span>&nbsp;<span class="keyword" id="1364159">interface</span><span class="op" id="1364168">{</span><span class="op" id="1364169">}</span><span class="op" id="1364170">,</span>&nbsp;<span class="ident" id="1364172">name</span><span class="op" id="1364176">,</span>&nbsp;<span class="ident" id="1364178">tag</span>&nbsp;<span class="builtintype" id="1364182">string</span><span class="op" id="1364188">)</span>&nbsp;<span class="builtintype" id="1364190">bool</span><span class="op" id="1364194">)</span>&nbsp;<span class="builtintype" id="1364196">bool</span>&nbsp;<span class="op" id="1364201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364204">return</span>&nbsp;<span class="ident" id="1364211"><a href="/net/dnsmsg.go.html#1364128">rr</a></span><span class="op" id="1364213">.</span><span class="ident" id="1364214">Hdr</span><span class="op" id="1364217">.</span><span class="ident" id="1364218">Walk</span><span class="op" id="1364222">(</span><span class="ident" id="1364223"><a href="/net/dnsmsg.go.html#1364150">f</a></span><span class="op" id="1364224">)</span>&nbsp;<span class="op" id="1364226">&amp;&amp;</span>&nbsp;<span class="ident" id="1364229"><a href="/net/dnsmsg.go.html#1364150">f</a></span><span class="op" id="1364230">(</span><span class="op" id="1364231">&amp;</span><span class="ident" id="1364232"><a href="/net/dnsmsg.go.html#1364128">rr</a></span><span class="op" id="1364234">.</span><span class="ident" id="1364235">Rmail</span><span class="op" id="1364240">,</span>&nbsp;<span class="string" id="1364242">&#34;Rmail&#34;</span><span class="op" id="1364249">,</span>&nbsp;<span class="string" id="1364251">&#34;domain&#34;</span><span class="op" id="1364259">)</span>&nbsp;<span class="op" id="1364261">&amp;&amp;</span>&nbsp;<span class="ident" id="1364264"><a href="/net/dnsmsg.go.html#1364150">f</a></span><span class="op" id="1364265">(</span><span class="op" id="1364266">&amp;</span><span class="ident" id="1364267"><a href="/net/dnsmsg.go.html#1364128">rr</a></span><span class="op" id="1364269">.</span><span class="ident" id="1364270">Email</span><span class="op" id="1364275">,</span>&nbsp;<span class="string" id="1364277">&#34;Email&#34;</span><span class="op" id="1364284">,</span>&nbsp;<span class="string" id="1364286">&#34;domain&#34;</span><span class="op" id="1364294">)</span><br>
<span class="lineno"></span><span class="op" id="1364296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="1364299">type</span>&nbsp;<span class="ident" id="1364304">dnsRR_MR</span>&nbsp;<span class="keyword" id="1364313">struct</span>&nbsp;<span class="op" id="1364320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364323">Hdr</span>&nbsp;<span class="ident" id="1364327"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364341">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="1364345">string</span>&nbsp;<span class="string" id="1364352">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1364372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="1364375">func</span>&nbsp;<span class="op" id="1364380">(</span><span class="ident" id="1364381">rr</span>&nbsp;<span class="op" id="1364384">*</span><span class="ident" id="1364385"><a href="/net/dnsmsg.go.html#1364304">dnsRR_MR</a></span><span class="op" id="1364393">)</span>&nbsp;<span class="ident" id="1364395">Header</span><span class="op" id="1364401">(</span><span class="op" id="1364402">)</span>&nbsp;<span class="op" id="1364404">*</span><span class="ident" id="1364405"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1364418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364421">return</span>&nbsp;<span class="op" id="1364428">&amp;</span><span class="ident" id="1364429"><a href="/net/dnsmsg.go.html#1364381">rr</a></span><span class="op" id="1364431">.</span><span class="ident" id="1364432">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1364436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364439">func</span>&nbsp;<span class="op" id="1364444">(</span><span class="ident" id="1364445">rr</span>&nbsp;<span class="op" id="1364448">*</span><span class="ident" id="1364449"><a href="/net/dnsmsg.go.html#1364304">dnsRR_MR</a></span><span class="op" id="1364457">)</span>&nbsp;<span class="ident" id="1364459">Walk</span><span class="op" id="1364463">(</span><span class="ident" id="1364464">f</span>&nbsp;<span class="keyword" id="1364466">func</span><span class="op" id="1364470">(</span><span class="ident" id="1364471">v</span>&nbsp;<span class="keyword" id="1364473">interface</span><span class="op" id="1364482">{</span><span class="op" id="1364483">}</span><span class="op" id="1364484">,</span>&nbsp;<span class="ident" id="1364486">name</span><span class="op" id="1364490">,</span>&nbsp;<span class="ident" id="1364492">tag</span>&nbsp;<span class="builtintype" id="1364496">string</span><span class="op" id="1364502">)</span>&nbsp;<span class="builtintype" id="1364504">bool</span><span class="op" id="1364508">)</span>&nbsp;<span class="builtintype" id="1364510">bool</span>&nbsp;<span class="op" id="1364515">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364518">return</span>&nbsp;<span class="ident" id="1364525"><a href="/net/dnsmsg.go.html#1364445">rr</a></span><span class="op" id="1364527">.</span><span class="ident" id="1364528">Hdr</span><span class="op" id="1364531">.</span><span class="ident" id="1364532">Walk</span><span class="op" id="1364536">(</span><span class="ident" id="1364537"><a href="/net/dnsmsg.go.html#1364464">f</a></span><span class="op" id="1364538">)</span>&nbsp;<span class="op" id="1364540">&amp;&amp;</span>&nbsp;<span class="ident" id="1364543"><a href="/net/dnsmsg.go.html#1364464">f</a></span><span class="op" id="1364544">(</span><span class="op" id="1364545">&amp;</span><span class="ident" id="1364546"><a href="/net/dnsmsg.go.html#1364445">rr</a></span><span class="op" id="1364548">.</span><span class="ident" id="1364549">Mr</span><span class="op" id="1364551">,</span>&nbsp;<span class="string" id="1364553">&#34;Mr&#34;</span><span class="op" id="1364557">,</span>&nbsp;<span class="string" id="1364559">&#34;domain&#34;</span><span class="op" id="1364567">)</span><br>
<span class="lineno"></span><span class="op" id="1364569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364572">type</span>&nbsp;<span class="ident" id="1364577">dnsRR_MX</span>&nbsp;<span class="keyword" id="1364586">struct</span>&nbsp;<span class="op" id="1364593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364596">Hdr</span>&nbsp;&nbsp;<span class="ident" id="1364601"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364615">Pref</span>&nbsp;<span class="builtintype" id="1364620">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364628">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1364633">string</span>&nbsp;<span class="string" id="1364640">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1364660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364663">func</span>&nbsp;<span class="op" id="1364668">(</span><span class="ident" id="1364669">rr</span>&nbsp;<span class="op" id="1364672">*</span><span class="ident" id="1364673"><a href="/net/dnsmsg.go.html#1364577">dnsRR_MX</a></span><span class="op" id="1364681">)</span>&nbsp;<span class="ident" id="1364683">Header</span><span class="op" id="1364689">(</span><span class="op" id="1364690">)</span>&nbsp;<span class="op" id="1364692">*</span><span class="ident" id="1364693"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1364706">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364709">return</span>&nbsp;<span class="op" id="1364716">&amp;</span><span class="ident" id="1364717"><a href="/net/dnsmsg.go.html#1364669">rr</a></span><span class="op" id="1364719">.</span><span class="ident" id="1364720">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1364724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364727">func</span>&nbsp;<span class="op" id="1364732">(</span><span class="ident" id="1364733">rr</span>&nbsp;<span class="op" id="1364736">*</span><span class="ident" id="1364737"><a href="/net/dnsmsg.go.html#1364577">dnsRR_MX</a></span><span class="op" id="1364745">)</span>&nbsp;<span class="ident" id="1364747">Walk</span><span class="op" id="1364751">(</span><span class="ident" id="1364752">f</span>&nbsp;<span class="keyword" id="1364754">func</span><span class="op" id="1364758">(</span><span class="ident" id="1364759">v</span>&nbsp;<span class="keyword" id="1364761">interface</span><span class="op" id="1364770">{</span><span class="op" id="1364771">}</span><span class="op" id="1364772">,</span>&nbsp;<span class="ident" id="1364774">name</span><span class="op" id="1364778">,</span>&nbsp;<span class="ident" id="1364780">tag</span>&nbsp;<span class="builtintype" id="1364784">string</span><span class="op" id="1364790">)</span>&nbsp;<span class="builtintype" id="1364792">bool</span><span class="op" id="1364796">)</span>&nbsp;<span class="builtintype" id="1364798">bool</span>&nbsp;<span class="op" id="1364803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364806">return</span>&nbsp;<span class="ident" id="1364813"><a href="/net/dnsmsg.go.html#1364733">rr</a></span><span class="op" id="1364815">.</span><span class="ident" id="1364816">Hdr</span><span class="op" id="1364819">.</span><span class="ident" id="1364820">Walk</span><span class="op" id="1364824">(</span><span class="ident" id="1364825"><a href="/net/dnsmsg.go.html#1364752">f</a></span><span class="op" id="1364826">)</span>&nbsp;<span class="op" id="1364828">&amp;&amp;</span>&nbsp;<span class="ident" id="1364831"><a href="/net/dnsmsg.go.html#1364752">f</a></span><span class="op" id="1364832">(</span><span class="op" id="1364833">&amp;</span><span class="ident" id="1364834"><a href="/net/dnsmsg.go.html#1364733">rr</a></span><span class="op" id="1364836">.</span><span class="ident" id="1364837">Pref</span><span class="op" id="1364841">,</span>&nbsp;<span class="string" id="1364843">&#34;Pref&#34;</span><span class="op" id="1364849">,</span>&nbsp;<span class="string" id="1364851">&#34;&#34;</span><span class="op" id="1364853">)</span>&nbsp;<span class="op" id="1364855">&amp;&amp;</span>&nbsp;<span class="ident" id="1364858"><a href="/net/dnsmsg.go.html#1364752">f</a></span><span class="op" id="1364859">(</span><span class="op" id="1364860">&amp;</span><span class="ident" id="1364861"><a href="/net/dnsmsg.go.html#1364733">rr</a></span><span class="op" id="1364863">.</span><span class="ident" id="1364864">Mx</span><span class="op" id="1364866">,</span>&nbsp;<span class="string" id="1364868">&#34;Mx&#34;</span><span class="op" id="1364872">,</span>&nbsp;<span class="string" id="1364874">&#34;domain&#34;</span><span class="op" id="1364882">)</span><br>
<span class="lineno">245</span><span class="op" id="1364884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364887">type</span>&nbsp;<span class="ident" id="1364892">dnsRR_NS</span>&nbsp;<span class="keyword" id="1364901">struct</span>&nbsp;<span class="op" id="1364908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364911">Hdr</span>&nbsp;<span class="ident" id="1364915"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364929">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="1364933">string</span>&nbsp;<span class="string" id="1364940">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="1364960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1364963">func</span>&nbsp;<span class="op" id="1364968">(</span><span class="ident" id="1364969">rr</span>&nbsp;<span class="op" id="1364972">*</span><span class="ident" id="1364973"><a href="/net/dnsmsg.go.html#1364892">dnsRR_NS</a></span><span class="op" id="1364981">)</span>&nbsp;<span class="ident" id="1364983">Header</span><span class="op" id="1364989">(</span><span class="op" id="1364990">)</span>&nbsp;<span class="op" id="1364992">*</span><span class="ident" id="1364993"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1365006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365009">return</span>&nbsp;<span class="op" id="1365016">&amp;</span><span class="ident" id="1365017"><a href="/net/dnsmsg.go.html#1364969">rr</a></span><span class="op" id="1365019">.</span><span class="ident" id="1365020">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1365024">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="1365027">func</span>&nbsp;<span class="op" id="1365032">(</span><span class="ident" id="1365033">rr</span>&nbsp;<span class="op" id="1365036">*</span><span class="ident" id="1365037"><a href="/net/dnsmsg.go.html#1364892">dnsRR_NS</a></span><span class="op" id="1365045">)</span>&nbsp;<span class="ident" id="1365047">Walk</span><span class="op" id="1365051">(</span><span class="ident" id="1365052">f</span>&nbsp;<span class="keyword" id="1365054">func</span><span class="op" id="1365058">(</span><span class="ident" id="1365059">v</span>&nbsp;<span class="keyword" id="1365061">interface</span><span class="op" id="1365070">{</span><span class="op" id="1365071">}</span><span class="op" id="1365072">,</span>&nbsp;<span class="ident" id="1365074">name</span><span class="op" id="1365078">,</span>&nbsp;<span class="ident" id="1365080">tag</span>&nbsp;<span class="builtintype" id="1365084">string</span><span class="op" id="1365090">)</span>&nbsp;<span class="builtintype" id="1365092">bool</span><span class="op" id="1365096">)</span>&nbsp;<span class="builtintype" id="1365098">bool</span>&nbsp;<span class="op" id="1365103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365106">return</span>&nbsp;<span class="ident" id="1365113"><a href="/net/dnsmsg.go.html#1365033">rr</a></span><span class="op" id="1365115">.</span><span class="ident" id="1365116">Hdr</span><span class="op" id="1365119">.</span><span class="ident" id="1365120">Walk</span><span class="op" id="1365124">(</span><span class="ident" id="1365125"><a href="/net/dnsmsg.go.html#1365052">f</a></span><span class="op" id="1365126">)</span>&nbsp;<span class="op" id="1365128">&amp;&amp;</span>&nbsp;<span class="ident" id="1365131"><a href="/net/dnsmsg.go.html#1365052">f</a></span><span class="op" id="1365132">(</span><span class="op" id="1365133">&amp;</span><span class="ident" id="1365134"><a href="/net/dnsmsg.go.html#1365033">rr</a></span><span class="op" id="1365136">.</span><span class="ident" id="1365137">Ns</span><span class="op" id="1365139">,</span>&nbsp;<span class="string" id="1365141">&#34;Ns&#34;</span><span class="op" id="1365145">,</span>&nbsp;<span class="string" id="1365147">&#34;domain&#34;</span><span class="op" id="1365155">)</span><br>
<span class="lineno"></span><span class="op" id="1365157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="1365160">type</span>&nbsp;<span class="ident" id="1365165">dnsRR_PTR</span>&nbsp;<span class="keyword" id="1365175">struct</span>&nbsp;<span class="op" id="1365182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365185">Hdr</span>&nbsp;<span class="ident" id="1365189"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365203">Ptr</span>&nbsp;<span class="builtintype" id="1365207">string</span>&nbsp;<span class="string" id="1365214">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1365234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="1365237">func</span>&nbsp;<span class="op" id="1365242">(</span><span class="ident" id="1365243">rr</span>&nbsp;<span class="op" id="1365246">*</span><span class="ident" id="1365247"><a href="/net/dnsmsg.go.html#1365165">dnsRR_PTR</a></span><span class="op" id="1365256">)</span>&nbsp;<span class="ident" id="1365258">Header</span><span class="op" id="1365264">(</span><span class="op" id="1365265">)</span>&nbsp;<span class="op" id="1365267">*</span><span class="ident" id="1365268"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1365281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365284">return</span>&nbsp;<span class="op" id="1365291">&amp;</span><span class="ident" id="1365292"><a href="/net/dnsmsg.go.html#1365243">rr</a></span><span class="op" id="1365294">.</span><span class="ident" id="1365295">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1365299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1365302">func</span>&nbsp;<span class="op" id="1365307">(</span><span class="ident" id="1365308">rr</span>&nbsp;<span class="op" id="1365311">*</span><span class="ident" id="1365312"><a href="/net/dnsmsg.go.html#1365165">dnsRR_PTR</a></span><span class="op" id="1365321">)</span>&nbsp;<span class="ident" id="1365323">Walk</span><span class="op" id="1365327">(</span><span class="ident" id="1365328">f</span>&nbsp;<span class="keyword" id="1365330">func</span><span class="op" id="1365334">(</span><span class="ident" id="1365335">v</span>&nbsp;<span class="keyword" id="1365337">interface</span><span class="op" id="1365346">{</span><span class="op" id="1365347">}</span><span class="op" id="1365348">,</span>&nbsp;<span class="ident" id="1365350">name</span><span class="op" id="1365354">,</span>&nbsp;<span class="ident" id="1365356">tag</span>&nbsp;<span class="builtintype" id="1365360">string</span><span class="op" id="1365366">)</span>&nbsp;<span class="builtintype" id="1365368">bool</span><span class="op" id="1365372">)</span>&nbsp;<span class="builtintype" id="1365374">bool</span>&nbsp;<span class="op" id="1365379">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365382">return</span>&nbsp;<span class="ident" id="1365389"><a href="/net/dnsmsg.go.html#1365308">rr</a></span><span class="op" id="1365391">.</span><span class="ident" id="1365392">Hdr</span><span class="op" id="1365395">.</span><span class="ident" id="1365396">Walk</span><span class="op" id="1365400">(</span><span class="ident" id="1365401"><a href="/net/dnsmsg.go.html#1365328">f</a></span><span class="op" id="1365402">)</span>&nbsp;<span class="op" id="1365404">&amp;&amp;</span>&nbsp;<span class="ident" id="1365407"><a href="/net/dnsmsg.go.html#1365328">f</a></span><span class="op" id="1365408">(</span><span class="op" id="1365409">&amp;</span><span class="ident" id="1365410"><a href="/net/dnsmsg.go.html#1365308">rr</a></span><span class="op" id="1365412">.</span><span class="ident" id="1365413">Ptr</span><span class="op" id="1365416">,</span>&nbsp;<span class="string" id="1365418">&#34;Ptr&#34;</span><span class="op" id="1365423">,</span>&nbsp;<span class="string" id="1365425">&#34;domain&#34;</span><span class="op" id="1365433">)</span><br>
<span class="lineno"></span><span class="op" id="1365435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1365438">type</span>&nbsp;<span class="ident" id="1365443">dnsRR_SOA</span>&nbsp;<span class="keyword" id="1365453">struct</span>&nbsp;<span class="op" id="1365460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365463">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1365471"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365485">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1365493">string</span>&nbsp;<span class="string" id="1365500">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365521">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1365529">string</span>&nbsp;<span class="string" id="1365536">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365557">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="1365565">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365573">Refresh</span>&nbsp;<span class="builtintype" id="1365581">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365589">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1365597">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365605">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="1365613">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365621">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="1365629">uint32</span><br>
<span class="lineno"></span><span class="op" id="1365636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1365639">func</span>&nbsp;<span class="op" id="1365644">(</span><span class="ident" id="1365645">rr</span>&nbsp;<span class="op" id="1365648">*</span><span class="ident" id="1365649"><a href="/net/dnsmsg.go.html#1365443">dnsRR_SOA</a></span><span class="op" id="1365658">)</span>&nbsp;<span class="ident" id="1365660">Header</span><span class="op" id="1365666">(</span><span class="op" id="1365667">)</span>&nbsp;<span class="op" id="1365669">*</span><span class="ident" id="1365670"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1365683">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365686">return</span>&nbsp;<span class="op" id="1365693">&amp;</span><span class="ident" id="1365694"><a href="/net/dnsmsg.go.html#1365645">rr</a></span><span class="op" id="1365696">.</span><span class="ident" id="1365697">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1365701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1365704">func</span>&nbsp;<span class="op" id="1365709">(</span><span class="ident" id="1365710">rr</span>&nbsp;<span class="op" id="1365713">*</span><span class="ident" id="1365714"><a href="/net/dnsmsg.go.html#1365443">dnsRR_SOA</a></span><span class="op" id="1365723">)</span>&nbsp;<span class="ident" id="1365725">Walk</span><span class="op" id="1365729">(</span><span class="ident" id="1365730">f</span>&nbsp;<span class="keyword" id="1365732">func</span><span class="op" id="1365736">(</span><span class="ident" id="1365737">v</span>&nbsp;<span class="keyword" id="1365739">interface</span><span class="op" id="1365748">{</span><span class="op" id="1365749">}</span><span class="op" id="1365750">,</span>&nbsp;<span class="ident" id="1365752">name</span><span class="op" id="1365756">,</span>&nbsp;<span class="ident" id="1365758">tag</span>&nbsp;<span class="builtintype" id="1365762">string</span><span class="op" id="1365768">)</span>&nbsp;<span class="builtintype" id="1365770">bool</span><span class="op" id="1365774">)</span>&nbsp;<span class="builtintype" id="1365776">bool</span>&nbsp;<span class="op" id="1365781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365784">return</span>&nbsp;<span class="ident" id="1365791"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365793">.</span><span class="ident" id="1365794">Hdr</span><span class="op" id="1365797">.</span><span class="ident" id="1365798">Walk</span><span class="op" id="1365802">(</span><span class="ident" id="1365803"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365804">)</span>&nbsp;<span class="op" id="1365806">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365811"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365812">(</span><span class="op" id="1365813">&amp;</span><span class="ident" id="1365814"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365816">.</span><span class="ident" id="1365817">Ns</span><span class="op" id="1365819">,</span>&nbsp;<span class="string" id="1365821">&#34;Ns&#34;</span><span class="op" id="1365825">,</span>&nbsp;<span class="string" id="1365827">&#34;domain&#34;</span><span class="op" id="1365835">)</span>&nbsp;<span class="op" id="1365837">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365842"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365843">(</span><span class="op" id="1365844">&amp;</span><span class="ident" id="1365845"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365847">.</span><span class="ident" id="1365848">Mbox</span><span class="op" id="1365852">,</span>&nbsp;<span class="string" id="1365854">&#34;Mbox&#34;</span><span class="op" id="1365860">,</span>&nbsp;<span class="string" id="1365862">&#34;domain&#34;</span><span class="op" id="1365870">)</span>&nbsp;<span class="op" id="1365872">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365877"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365878">(</span><span class="op" id="1365879">&amp;</span><span class="ident" id="1365880"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365882">.</span><span class="ident" id="1365883">Serial</span><span class="op" id="1365889">,</span>&nbsp;<span class="string" id="1365891">&#34;Serial&#34;</span><span class="op" id="1365899">,</span>&nbsp;<span class="string" id="1365901">&#34;&#34;</span><span class="op" id="1365903">)</span>&nbsp;<span class="op" id="1365905">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365910"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365911">(</span><span class="op" id="1365912">&amp;</span><span class="ident" id="1365913"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365915">.</span><span class="ident" id="1365916">Refresh</span><span class="op" id="1365923">,</span>&nbsp;<span class="string" id="1365925">&#34;Refresh&#34;</span><span class="op" id="1365934">,</span>&nbsp;<span class="string" id="1365936">&#34;&#34;</span><span class="op" id="1365938">)</span>&nbsp;<span class="op" id="1365940">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365945"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365946">(</span><span class="op" id="1365947">&amp;</span><span class="ident" id="1365948"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365950">.</span><span class="ident" id="1365951">Retry</span><span class="op" id="1365956">,</span>&nbsp;<span class="string" id="1365958">&#34;Retry&#34;</span><span class="op" id="1365965">,</span>&nbsp;<span class="string" id="1365967">&#34;&#34;</span><span class="op" id="1365969">)</span>&nbsp;<span class="op" id="1365971">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1365976"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1365977">(</span><span class="op" id="1365978">&amp;</span><span class="ident" id="1365979"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1365981">.</span><span class="ident" id="1365982">Expire</span><span class="op" id="1365988">,</span>&nbsp;<span class="string" id="1365990">&#34;Expire&#34;</span><span class="op" id="1365998">,</span>&nbsp;<span class="string" id="1366000">&#34;&#34;</span><span class="op" id="1366002">)</span>&nbsp;<span class="op" id="1366004">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366009"><a href="/net/dnsmsg.go.html#1365730">f</a></span><span class="op" id="1366010">(</span><span class="op" id="1366011">&amp;</span><span class="ident" id="1366012"><a href="/net/dnsmsg.go.html#1365710">rr</a></span><span class="op" id="1366014">.</span><span class="ident" id="1366015">Minttl</span><span class="op" id="1366021">,</span>&nbsp;<span class="string" id="1366023">&#34;Minttl&#34;</span><span class="op" id="1366031">,</span>&nbsp;<span class="string" id="1366033">&#34;&#34;</span><span class="op" id="1366035">)</span><br>
<span class="lineno"></span><span class="op" id="1366037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366040">type</span>&nbsp;<span class="ident" id="1366045">dnsRR_TXT</span>&nbsp;<span class="keyword" id="1366055">struct</span>&nbsp;<span class="op" id="1366062">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366065">Hdr</span>&nbsp;<span class="ident" id="1366069"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366083">Txt</span>&nbsp;<span class="builtintype" id="1366087">string</span>&nbsp;<span class="comment" id="1366094">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="1366113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366116">func</span>&nbsp;<span class="op" id="1366121">(</span><span class="ident" id="1366122">rr</span>&nbsp;<span class="op" id="1366125">*</span><span class="ident" id="1366126"><a href="/net/dnsmsg.go.html#1366045">dnsRR_TXT</a></span><span class="op" id="1366135">)</span>&nbsp;<span class="ident" id="1366137">Header</span><span class="op" id="1366143">(</span><span class="op" id="1366144">)</span>&nbsp;<span class="op" id="1366146">*</span><span class="ident" id="1366147"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1366160">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366163">return</span>&nbsp;<span class="op" id="1366170">&amp;</span><span class="ident" id="1366171"><a href="/net/dnsmsg.go.html#1366122">rr</a></span><span class="op" id="1366173">.</span><span class="ident" id="1366174">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1366178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366181">func</span>&nbsp;<span class="op" id="1366186">(</span><span class="ident" id="1366187">rr</span>&nbsp;<span class="op" id="1366190">*</span><span class="ident" id="1366191"><a href="/net/dnsmsg.go.html#1366045">dnsRR_TXT</a></span><span class="op" id="1366200">)</span>&nbsp;<span class="ident" id="1366202">Walk</span><span class="op" id="1366206">(</span><span class="ident" id="1366207">f</span>&nbsp;<span class="keyword" id="1366209">func</span><span class="op" id="1366213">(</span><span class="ident" id="1366214">v</span>&nbsp;<span class="keyword" id="1366216">interface</span><span class="op" id="1366225">{</span><span class="op" id="1366226">}</span><span class="op" id="1366227">,</span>&nbsp;<span class="ident" id="1366229">name</span><span class="op" id="1366233">,</span>&nbsp;<span class="ident" id="1366235">tag</span>&nbsp;<span class="builtintype" id="1366239">string</span><span class="op" id="1366245">)</span>&nbsp;<span class="builtintype" id="1366247">bool</span><span class="op" id="1366251">)</span>&nbsp;<span class="builtintype" id="1366253">bool</span>&nbsp;<span class="op" id="1366258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366261">return</span>&nbsp;<span class="ident" id="1366268"><a href="/net/dnsmsg.go.html#1366187">rr</a></span><span class="op" id="1366270">.</span><span class="ident" id="1366271">Hdr</span><span class="op" id="1366274">.</span><span class="ident" id="1366275">Walk</span><span class="op" id="1366279">(</span><span class="ident" id="1366280"><a href="/net/dnsmsg.go.html#1366207">f</a></span><span class="op" id="1366281">)</span>&nbsp;<span class="op" id="1366283">&amp;&amp;</span>&nbsp;<span class="ident" id="1366286"><a href="/net/dnsmsg.go.html#1366207">f</a></span><span class="op" id="1366287">(</span><span class="op" id="1366288">&amp;</span><span class="ident" id="1366289"><a href="/net/dnsmsg.go.html#1366187">rr</a></span><span class="op" id="1366291">.</span><span class="ident" id="1366292">Txt</span><span class="op" id="1366295">,</span>&nbsp;<span class="string" id="1366297">&#34;Txt&#34;</span><span class="op" id="1366302">,</span>&nbsp;<span class="string" id="1366304">&#34;&#34;</span><span class="op" id="1366306">)</span><br>
<span class="lineno">310</span><span class="op" id="1366308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366311">type</span>&nbsp;<span class="ident" id="1366316">dnsRR_SRV</span>&nbsp;<span class="keyword" id="1366326">struct</span>&nbsp;<span class="op" id="1366333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366336">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1366345"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366359">Priority</span>&nbsp;<span class="builtintype" id="1366368">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366376">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1366385">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366393">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1366402">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366410">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1366419">string</span>&nbsp;<span class="string" id="1366426">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1366446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="1366449">func</span>&nbsp;<span class="op" id="1366454">(</span><span class="ident" id="1366455">rr</span>&nbsp;<span class="op" id="1366458">*</span><span class="ident" id="1366459"><a href="/net/dnsmsg.go.html#1366316">dnsRR_SRV</a></span><span class="op" id="1366468">)</span>&nbsp;<span class="ident" id="1366470">Header</span><span class="op" id="1366476">(</span><span class="op" id="1366477">)</span>&nbsp;<span class="op" id="1366479">*</span><span class="ident" id="1366480"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1366493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366496">return</span>&nbsp;<span class="op" id="1366503">&amp;</span><span class="ident" id="1366504"><a href="/net/dnsmsg.go.html#1366455">rr</a></span><span class="op" id="1366506">.</span><span class="ident" id="1366507">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1366511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366514">func</span>&nbsp;<span class="op" id="1366519">(</span><span class="ident" id="1366520">rr</span>&nbsp;<span class="op" id="1366523">*</span><span class="ident" id="1366524"><a href="/net/dnsmsg.go.html#1366316">dnsRR_SRV</a></span><span class="op" id="1366533">)</span>&nbsp;<span class="ident" id="1366535">Walk</span><span class="op" id="1366539">(</span><span class="ident" id="1366540">f</span>&nbsp;<span class="keyword" id="1366542">func</span><span class="op" id="1366546">(</span><span class="ident" id="1366547">v</span>&nbsp;<span class="keyword" id="1366549">interface</span><span class="op" id="1366558">{</span><span class="op" id="1366559">}</span><span class="op" id="1366560">,</span>&nbsp;<span class="ident" id="1366562">name</span><span class="op" id="1366566">,</span>&nbsp;<span class="ident" id="1366568">tag</span>&nbsp;<span class="builtintype" id="1366572">string</span><span class="op" id="1366578">)</span>&nbsp;<span class="builtintype" id="1366580">bool</span><span class="op" id="1366584">)</span>&nbsp;<span class="builtintype" id="1366586">bool</span>&nbsp;<span class="op" id="1366591">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366594">return</span>&nbsp;<span class="ident" id="1366601"><a href="/net/dnsmsg.go.html#1366520">rr</a></span><span class="op" id="1366603">.</span><span class="ident" id="1366604">Hdr</span><span class="op" id="1366607">.</span><span class="ident" id="1366608">Walk</span><span class="op" id="1366612">(</span><span class="ident" id="1366613"><a href="/net/dnsmsg.go.html#1366540">f</a></span><span class="op" id="1366614">)</span>&nbsp;<span class="op" id="1366616">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366621"><a href="/net/dnsmsg.go.html#1366540">f</a></span><span class="op" id="1366622">(</span><span class="op" id="1366623">&amp;</span><span class="ident" id="1366624"><a href="/net/dnsmsg.go.html#1366520">rr</a></span><span class="op" id="1366626">.</span><span class="ident" id="1366627">Priority</span><span class="op" id="1366635">,</span>&nbsp;<span class="string" id="1366637">&#34;Priority&#34;</span><span class="op" id="1366647">,</span>&nbsp;<span class="string" id="1366649">&#34;&#34;</span><span class="op" id="1366651">)</span>&nbsp;<span class="op" id="1366653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366658"><a href="/net/dnsmsg.go.html#1366540">f</a></span><span class="op" id="1366659">(</span><span class="op" id="1366660">&amp;</span><span class="ident" id="1366661"><a href="/net/dnsmsg.go.html#1366520">rr</a></span><span class="op" id="1366663">.</span><span class="ident" id="1366664">Weight</span><span class="op" id="1366670">,</span>&nbsp;<span class="string" id="1366672">&#34;Weight&#34;</span><span class="op" id="1366680">,</span>&nbsp;<span class="string" id="1366682">&#34;&#34;</span><span class="op" id="1366684">)</span>&nbsp;<span class="op" id="1366686">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366691"><a href="/net/dnsmsg.go.html#1366540">f</a></span><span class="op" id="1366692">(</span><span class="op" id="1366693">&amp;</span><span class="ident" id="1366694"><a href="/net/dnsmsg.go.html#1366520">rr</a></span><span class="op" id="1366696">.</span><span class="ident" id="1366697">Port</span><span class="op" id="1366701">,</span>&nbsp;<span class="string" id="1366703">&#34;Port&#34;</span><span class="op" id="1366709">,</span>&nbsp;<span class="string" id="1366711">&#34;&#34;</span><span class="op" id="1366713">)</span>&nbsp;<span class="op" id="1366715">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366720"><a href="/net/dnsmsg.go.html#1366540">f</a></span><span class="op" id="1366721">(</span><span class="op" id="1366722">&amp;</span><span class="ident" id="1366723"><a href="/net/dnsmsg.go.html#1366520">rr</a></span><span class="op" id="1366725">.</span><span class="ident" id="1366726">Target</span><span class="op" id="1366732">,</span>&nbsp;<span class="string" id="1366734">&#34;Target&#34;</span><span class="op" id="1366742">,</span>&nbsp;<span class="string" id="1366744">&#34;domain&#34;</span><span class="op" id="1366752">)</span><br>
<span class="lineno">330</span><span class="op" id="1366754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366757">type</span>&nbsp;<span class="ident" id="1366762">dnsRR_A</span>&nbsp;<span class="keyword" id="1366770">struct</span>&nbsp;<span class="op" id="1366777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366780">Hdr</span>&nbsp;<span class="ident" id="1366784"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366798">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1366802">uint32</span>&nbsp;<span class="string" id="1366809">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="1366822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1366825">func</span>&nbsp;<span class="op" id="1366830">(</span><span class="ident" id="1366831">rr</span>&nbsp;<span class="op" id="1366834">*</span><span class="ident" id="1366835"><a href="/net/dnsmsg.go.html#1366762">dnsRR_A</a></span><span class="op" id="1366842">)</span>&nbsp;<span class="ident" id="1366844">Header</span><span class="op" id="1366850">(</span><span class="op" id="1366851">)</span>&nbsp;<span class="op" id="1366853">*</span><span class="ident" id="1366854"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1366867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366870">return</span>&nbsp;<span class="op" id="1366877">&amp;</span><span class="ident" id="1366878"><a href="/net/dnsmsg.go.html#1366831">rr</a></span><span class="op" id="1366880">.</span><span class="ident" id="1366881">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1366885">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="1366888">func</span>&nbsp;<span class="op" id="1366893">(</span><span class="ident" id="1366894">rr</span>&nbsp;<span class="op" id="1366897">*</span><span class="ident" id="1366898"><a href="/net/dnsmsg.go.html#1366762">dnsRR_A</a></span><span class="op" id="1366905">)</span>&nbsp;<span class="ident" id="1366907">Walk</span><span class="op" id="1366911">(</span><span class="ident" id="1366912">f</span>&nbsp;<span class="keyword" id="1366914">func</span><span class="op" id="1366918">(</span><span class="ident" id="1366919">v</span>&nbsp;<span class="keyword" id="1366921">interface</span><span class="op" id="1366930">{</span><span class="op" id="1366931">}</span><span class="op" id="1366932">,</span>&nbsp;<span class="ident" id="1366934">name</span><span class="op" id="1366938">,</span>&nbsp;<span class="ident" id="1366940">tag</span>&nbsp;<span class="builtintype" id="1366944">string</span><span class="op" id="1366950">)</span>&nbsp;<span class="builtintype" id="1366952">bool</span><span class="op" id="1366956">)</span>&nbsp;<span class="builtintype" id="1366958">bool</span>&nbsp;<span class="op" id="1366963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366966">return</span>&nbsp;<span class="ident" id="1366973"><a href="/net/dnsmsg.go.html#1366894">rr</a></span><span class="op" id="1366975">.</span><span class="ident" id="1366976">Hdr</span><span class="op" id="1366979">.</span><span class="ident" id="1366980">Walk</span><span class="op" id="1366984">(</span><span class="ident" id="1366985"><a href="/net/dnsmsg.go.html#1366912">f</a></span><span class="op" id="1366986">)</span>&nbsp;<span class="op" id="1366988">&amp;&amp;</span>&nbsp;<span class="ident" id="1366991"><a href="/net/dnsmsg.go.html#1366912">f</a></span><span class="op" id="1366992">(</span><span class="op" id="1366993">&amp;</span><span class="ident" id="1366994"><a href="/net/dnsmsg.go.html#1366894">rr</a></span><span class="op" id="1366996">.</span><span class="ident" id="1366997">A</span><span class="op" id="1366998">,</span>&nbsp;<span class="string" id="1367000">&#34;A&#34;</span><span class="op" id="1367003">,</span>&nbsp;<span class="string" id="1367005">&#34;ipv4&#34;</span><span class="op" id="1367011">)</span><br>
<span class="lineno"></span><span class="op" id="1367013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="1367016">type</span>&nbsp;<span class="ident" id="1367021">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="1367032">struct</span>&nbsp;<span class="op" id="1367039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367042">Hdr</span>&nbsp;&nbsp;<span class="ident" id="1367047"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367061">AAAA</span>&nbsp;<span class="op" id="1367066">[</span><span class="num" id="1367067">16</span><span class="op" id="1367069">]</span><span class="builtintype" id="1367070">byte</span>&nbsp;<span class="string" id="1367075">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="1367088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="1367091">func</span>&nbsp;<span class="op" id="1367096">(</span><span class="ident" id="1367097">rr</span>&nbsp;<span class="op" id="1367100">*</span><span class="ident" id="1367101"><a href="/net/dnsmsg.go.html#1367021">dnsRR_AAAA</a></span><span class="op" id="1367111">)</span>&nbsp;<span class="ident" id="1367113">Header</span><span class="op" id="1367119">(</span><span class="op" id="1367120">)</span>&nbsp;<span class="op" id="1367122">*</span><span class="ident" id="1367123"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span>&nbsp;<span class="op" id="1367136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367139">return</span>&nbsp;<span class="op" id="1367146">&amp;</span><span class="ident" id="1367147"><a href="/net/dnsmsg.go.html#1367097">rr</a></span><span class="op" id="1367149">.</span><span class="ident" id="1367150">Hdr</span><br>
<span class="lineno"></span><span class="op" id="1367154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1367157">func</span>&nbsp;<span class="op" id="1367162">(</span><span class="ident" id="1367163">rr</span>&nbsp;<span class="op" id="1367166">*</span><span class="ident" id="1367167"><a href="/net/dnsmsg.go.html#1367021">dnsRR_AAAA</a></span><span class="op" id="1367177">)</span>&nbsp;<span class="ident" id="1367179">Walk</span><span class="op" id="1367183">(</span><span class="ident" id="1367184">f</span>&nbsp;<span class="keyword" id="1367186">func</span><span class="op" id="1367190">(</span><span class="ident" id="1367191">v</span>&nbsp;<span class="keyword" id="1367193">interface</span><span class="op" id="1367202">{</span><span class="op" id="1367203">}</span><span class="op" id="1367204">,</span>&nbsp;<span class="ident" id="1367206">name</span><span class="op" id="1367210">,</span>&nbsp;<span class="ident" id="1367212">tag</span>&nbsp;<span class="builtintype" id="1367216">string</span><span class="op" id="1367222">)</span>&nbsp;<span class="builtintype" id="1367224">bool</span><span class="op" id="1367228">)</span>&nbsp;<span class="builtintype" id="1367230">bool</span>&nbsp;<span class="op" id="1367235">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367238">return</span>&nbsp;<span class="ident" id="1367245"><a href="/net/dnsmsg.go.html#1367163">rr</a></span><span class="op" id="1367247">.</span><span class="ident" id="1367248">Hdr</span><span class="op" id="1367251">.</span><span class="ident" id="1367252">Walk</span><span class="op" id="1367256">(</span><span class="ident" id="1367257"><a href="/net/dnsmsg.go.html#1367184">f</a></span><span class="op" id="1367258">)</span>&nbsp;<span class="op" id="1367260">&amp;&amp;</span>&nbsp;<span class="ident" id="1367263"><a href="/net/dnsmsg.go.html#1367184">f</a></span><span class="op" id="1367264">(</span><span class="ident" id="1367265"><a href="/net/dnsmsg.go.html#1367163">rr</a></span><span class="op" id="1367267">.</span><span class="ident" id="1367268">AAAA</span><span class="op" id="1367272">[</span><span class="op" id="1367273">:</span><span class="op" id="1367274">]</span><span class="op" id="1367275">,</span>&nbsp;<span class="string" id="1367277">&#34;AAAA&#34;</span><span class="op" id="1367283">,</span>&nbsp;<span class="string" id="1367285">&#34;ipv6&#34;</span><span class="op" id="1367291">)</span><br>
<span class="lineno"></span><span class="op" id="1367293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367296">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="1367322">//</span><br>
<span class="lineno">360</span><span class="comment" id="1367325">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="1367387">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="1367454">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="1367516">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1367582">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="1367604">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="1367650">var</span>&nbsp;<span class="ident" id="1367654">rr_mk</span>&nbsp;<span class="op" id="1367660">=</span>&nbsp;<span class="keyword" id="1367662">map</span><span class="op" id="1367665">[</span><span class="builtintype" id="1367666">int</span><span class="op" id="1367669">]</span><span class="keyword" id="1367670">func</span><span class="op" id="1367674">(</span><span class="op" id="1367675">)</span>&nbsp;<span class="ident" id="1367677"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1367682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367685"><a href="/net/dnsmsg.go.html#1359776">dnsTypeCNAME</a></span><span class="op" id="1367697">:</span>&nbsp;<span class="keyword" id="1367699">func</span><span class="op" id="1367703">(</span><span class="op" id="1367704">)</span>&nbsp;<span class="ident" id="1367706"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367712">{</span>&nbsp;<span class="keyword" id="1367714">return</span>&nbsp;<span class="builtinfunc" id="1367721">new</span><span class="op" id="1367724">(</span><span class="ident" id="1367725"><a href="/net/dnsmsg.go.html#1362812">dnsRR_CNAME</a></span><span class="op" id="1367736">)</span>&nbsp;<span class="op" id="1367738">}</span><span class="op" id="1367739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367742"><a href="/net/dnsmsg.go.html#1359923">dnsTypeHINFO</a></span><span class="op" id="1367754">:</span>&nbsp;<span class="keyword" id="1367756">func</span><span class="op" id="1367760">(</span><span class="op" id="1367761">)</span>&nbsp;<span class="ident" id="1367763"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367769">{</span>&nbsp;<span class="keyword" id="1367771">return</span>&nbsp;<span class="builtinfunc" id="1367778">new</span><span class="op" id="1367781">(</span><span class="ident" id="1367782"><a href="/net/dnsmsg.go.html#1363104">dnsRR_HINFO</a></span><span class="op" id="1367793">)</span>&nbsp;<span class="op" id="1367795">}</span><span class="op" id="1367796">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367799"><a href="/net/dnsmsg.go.html#1359812">dnsTypeMB</a></span><span class="op" id="1367808">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367813">func</span><span class="op" id="1367817">(</span><span class="op" id="1367818">)</span>&nbsp;<span class="ident" id="1367820"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367826">{</span>&nbsp;<span class="keyword" id="1367828">return</span>&nbsp;<span class="builtinfunc" id="1367835">new</span><span class="op" id="1367838">(</span><span class="ident" id="1367839"><a href="/net/dnsmsg.go.html#1363397">dnsRR_MB</a></span><span class="op" id="1367847">)</span>&nbsp;<span class="op" id="1367849">}</span><span class="op" id="1367850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367853"><a href="/net/dnsmsg.go.html#1359830">dnsTypeMG</a></span><span class="op" id="1367862">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367867">func</span><span class="op" id="1367871">(</span><span class="op" id="1367872">)</span>&nbsp;<span class="ident" id="1367874"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367880">{</span>&nbsp;<span class="keyword" id="1367882">return</span>&nbsp;<span class="builtinfunc" id="1367889">new</span><span class="op" id="1367892">(</span><span class="ident" id="1367893"><a href="/net/dnsmsg.go.html#1363670">dnsRR_MG</a></span><span class="op" id="1367901">)</span>&nbsp;<span class="op" id="1367903">}</span><span class="op" id="1367904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367907"><a href="/net/dnsmsg.go.html#1359942">dnsTypeMINFO</a></span><span class="op" id="1367919">:</span>&nbsp;<span class="keyword" id="1367921">func</span><span class="op" id="1367925">(</span><span class="op" id="1367926">)</span>&nbsp;<span class="ident" id="1367928"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367934">{</span>&nbsp;<span class="keyword" id="1367936">return</span>&nbsp;<span class="builtinfunc" id="1367943">new</span><span class="op" id="1367946">(</span><span class="ident" id="1367947"><a href="/net/dnsmsg.go.html#1363943">dnsRR_MINFO</a></span><span class="op" id="1367958">)</span>&nbsp;<span class="op" id="1367960">}</span><span class="op" id="1367961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1367964"><a href="/net/dnsmsg.go.html#1359848">dnsTypeMR</a></span><span class="op" id="1367973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1367978">func</span><span class="op" id="1367982">(</span><span class="op" id="1367983">)</span>&nbsp;<span class="ident" id="1367985"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1367991">{</span>&nbsp;<span class="keyword" id="1367993">return</span>&nbsp;<span class="builtinfunc" id="1368000">new</span><span class="op" id="1368003">(</span><span class="ident" id="1368004"><a href="/net/dnsmsg.go.html#1364304">dnsRR_MR</a></span><span class="op" id="1368012">)</span>&nbsp;<span class="op" id="1368014">}</span><span class="op" id="1368015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368018"><a href="/net/dnsmsg.go.html#1359961">dnsTypeMX</a></span><span class="op" id="1368027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368032">func</span><span class="op" id="1368036">(</span><span class="op" id="1368037">)</span>&nbsp;<span class="ident" id="1368039"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368045">{</span>&nbsp;<span class="keyword" id="1368047">return</span>&nbsp;<span class="builtinfunc" id="1368054">new</span><span class="op" id="1368057">(</span><span class="ident" id="1368058"><a href="/net/dnsmsg.go.html#1364577">dnsRR_MX</a></span><span class="op" id="1368066">)</span>&nbsp;<span class="op" id="1368068">}</span><span class="op" id="1368069">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368072"><a href="/net/dnsmsg.go.html#1359722">dnsTypeNS</a></span><span class="op" id="1368081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368086">func</span><span class="op" id="1368090">(</span><span class="op" id="1368091">)</span>&nbsp;<span class="ident" id="1368093"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368099">{</span>&nbsp;<span class="keyword" id="1368101">return</span>&nbsp;<span class="builtinfunc" id="1368108">new</span><span class="op" id="1368111">(</span><span class="ident" id="1368112"><a href="/net/dnsmsg.go.html#1364892">dnsRR_NS</a></span><span class="op" id="1368120">)</span>&nbsp;<span class="op" id="1368122">}</span><span class="op" id="1368123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368126"><a href="/net/dnsmsg.go.html#1359904">dnsTypePTR</a></span><span class="op" id="1368136">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368140">func</span><span class="op" id="1368144">(</span><span class="op" id="1368145">)</span>&nbsp;<span class="ident" id="1368147"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368153">{</span>&nbsp;<span class="keyword" id="1368155">return</span>&nbsp;<span class="builtinfunc" id="1368162">new</span><span class="op" id="1368165">(</span><span class="ident" id="1368166"><a href="/net/dnsmsg.go.html#1365165">dnsRR_PTR</a></span><span class="op" id="1368175">)</span>&nbsp;<span class="op" id="1368177">}</span><span class="op" id="1368178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368181"><a href="/net/dnsmsg.go.html#1359794">dnsTypeSOA</a></span><span class="op" id="1368191">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368195">func</span><span class="op" id="1368199">(</span><span class="op" id="1368200">)</span>&nbsp;<span class="ident" id="1368202"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368208">{</span>&nbsp;<span class="keyword" id="1368210">return</span>&nbsp;<span class="builtinfunc" id="1368217">new</span><span class="op" id="1368220">(</span><span class="ident" id="1368221"><a href="/net/dnsmsg.go.html#1365443">dnsRR_SOA</a></span><span class="op" id="1368230">)</span>&nbsp;<span class="op" id="1368232">}</span><span class="op" id="1368233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368236"><a href="/net/dnsmsg.go.html#1359980">dnsTypeTXT</a></span><span class="op" id="1368246">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368250">func</span><span class="op" id="1368254">(</span><span class="op" id="1368255">)</span>&nbsp;<span class="ident" id="1368257"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368263">{</span>&nbsp;<span class="keyword" id="1368265">return</span>&nbsp;<span class="builtinfunc" id="1368272">new</span><span class="op" id="1368275">(</span><span class="ident" id="1368276"><a href="/net/dnsmsg.go.html#1366045">dnsRR_TXT</a></span><span class="op" id="1368285">)</span>&nbsp;<span class="op" id="1368287">}</span><span class="op" id="1368288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368291"><a href="/net/dnsmsg.go.html#1360018">dnsTypeSRV</a></span><span class="op" id="1368301">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368305">func</span><span class="op" id="1368309">(</span><span class="op" id="1368310">)</span>&nbsp;<span class="ident" id="1368312"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368318">{</span>&nbsp;<span class="keyword" id="1368320">return</span>&nbsp;<span class="builtinfunc" id="1368327">new</span><span class="op" id="1368330">(</span><span class="ident" id="1368331"><a href="/net/dnsmsg.go.html#1366316">dnsRR_SRV</a></span><span class="op" id="1368340">)</span>&nbsp;<span class="op" id="1368342">}</span><span class="op" id="1368343">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368346"><a href="/net/dnsmsg.go.html#1359704">dnsTypeA</a></span><span class="op" id="1368354">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1368360">func</span><span class="op" id="1368364">(</span><span class="op" id="1368365">)</span>&nbsp;<span class="ident" id="1368367"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368373">{</span>&nbsp;<span class="keyword" id="1368375">return</span>&nbsp;<span class="builtinfunc" id="1368382">new</span><span class="op" id="1368385">(</span><span class="ident" id="1368386"><a href="/net/dnsmsg.go.html#1366762">dnsRR_A</a></span><span class="op" id="1368393">)</span>&nbsp;<span class="op" id="1368395">}</span><span class="op" id="1368396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368399"><a href="/net/dnsmsg.go.html#1359999">dnsTypeAAAA</a></span><span class="op" id="1368410">:</span>&nbsp;&nbsp;<span class="keyword" id="1368413">func</span><span class="op" id="1368417">(</span><span class="op" id="1368418">)</span>&nbsp;<span class="ident" id="1368420"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span>&nbsp;<span class="op" id="1368426">{</span>&nbsp;<span class="keyword" id="1368428">return</span>&nbsp;<span class="builtinfunc" id="1368435">new</span><span class="op" id="1368438">(</span><span class="ident" id="1368439"><a href="/net/dnsmsg.go.html#1367021">dnsRR_AAAA</a></span><span class="op" id="1368449">)</span>&nbsp;<span class="op" id="1368451">}</span><span class="op" id="1368452">,</span><br>
<span class="lineno"></span><span class="op" id="1368454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1368457">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="1368497">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="1368547">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1368606">func</span>&nbsp;<span class="ident" id="1368611">packDomainName</span><span class="op" id="1368625">(</span><span class="ident" id="1368626">s</span>&nbsp;<span class="builtintype" id="1368628">string</span><span class="op" id="1368634">,</span>&nbsp;<span class="ident" id="1368636">msg</span>&nbsp;<span class="op" id="1368640">[</span><span class="op" id="1368641">]</span><span class="builtintype" id="1368642">byte</span><span class="op" id="1368646">,</span>&nbsp;<span class="ident" id="1368648">off</span>&nbsp;<span class="builtintype" id="1368652">int</span><span class="op" id="1368655">)</span>&nbsp;<span class="op" id="1368657">(</span><span class="ident" id="1368658">off1</span>&nbsp;<span class="builtintype" id="1368663">int</span><span class="op" id="1368666">,</span>&nbsp;<span class="ident" id="1368668">ok</span>&nbsp;<span class="builtintype" id="1368671">bool</span><span class="op" id="1368675">)</span>&nbsp;<span class="op" id="1368677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368680">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368723">if</span>&nbsp;<span class="ident" id="1368726">n</span>&nbsp;<span class="op" id="1368728">:=</span>&nbsp;<span class="builtinfunc" id="1368731">len</span><span class="op" id="1368734">(</span><span class="ident" id="1368735"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1368736">)</span><span class="op" id="1368737">;</span>&nbsp;<span class="ident" id="1368739"><a href="/net/dnsmsg.go.html#1368726">n</a></span>&nbsp;<span class="op" id="1368741">==</span>&nbsp;<span class="num" id="1368744">0</span>&nbsp;<span class="op" id="1368746">||</span>&nbsp;<span class="ident" id="1368749"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1368750">[</span><span class="ident" id="1368751"><a href="/net/dnsmsg.go.html#1368726">n</a></span><span class="op" id="1368752">-</span><span class="num" id="1368753">1</span><span class="op" id="1368754">]</span>&nbsp;<span class="op" id="1368756">!=</span>&nbsp;<span class="string" id="1368759">&#39;.&#39;</span>&nbsp;<span class="op" id="1368763">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368767"><a href="/net/dnsmsg.go.html#1368626">s</a></span>&nbsp;<span class="op" id="1368769">+=</span>&nbsp;<span class="string" id="1368772">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368781">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368822">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368868">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368903">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368949">tot</span>&nbsp;<span class="op" id="1368953">:=</span>&nbsp;<span class="builtinfunc" id="1368956">len</span><span class="op" id="1368959">(</span><span class="ident" id="1368960"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1368961">)</span>&nbsp;<span class="op" id="1368963">+</span>&nbsp;<span class="num" id="1368965">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368968">if</span>&nbsp;<span class="ident" id="1368971"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1368974">+</span><span class="ident" id="1368975"><a href="/net/dnsmsg.go.html#1368949">tot</a></span>&nbsp;<span class="op" id="1368979">&gt;</span>&nbsp;<span class="builtinfunc" id="1368981">len</span><span class="op" id="1368984">(</span><span class="ident" id="1368985"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1368988">)</span>&nbsp;<span class="op" id="1368990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368994">return</span>&nbsp;<span class="builtinfunc" id="1369001">len</span><span class="op" id="1369004">(</span><span class="ident" id="1369005"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1369008">)</span><span class="op" id="1369009">,</span>&nbsp;<span class="builtintype" id="1369011">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369022">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369078">begin</span>&nbsp;<span class="op" id="1369084">:=</span>&nbsp;<span class="num" id="1369087">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369090">for</span>&nbsp;<span class="ident" id="1369094">i</span>&nbsp;<span class="op" id="1369096">:=</span>&nbsp;<span class="num" id="1369099">0</span><span class="op" id="1369100">;</span>&nbsp;<span class="ident" id="1369102"><a href="/net/dnsmsg.go.html#1369094">i</a></span>&nbsp;<span class="op" id="1369104">&lt;</span>&nbsp;<span class="builtinfunc" id="1369106">len</span><span class="op" id="1369109">(</span><span class="ident" id="1369110"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1369111">)</span><span class="op" id="1369112">;</span>&nbsp;<span class="ident" id="1369114"><a href="/net/dnsmsg.go.html#1369094">i</a></span><span class="op" id="1369115">++</span>&nbsp;<span class="op" id="1369118">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369122">if</span>&nbsp;<span class="ident" id="1369125"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1369126">[</span><span class="ident" id="1369127"><a href="/net/dnsmsg.go.html#1369094">i</a></span><span class="op" id="1369128">]</span>&nbsp;<span class="op" id="1369130">==</span>&nbsp;<span class="string" id="1369133">&#39;.&#39;</span>&nbsp;<span class="op" id="1369137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369142">if</span>&nbsp;<span class="ident" id="1369145"><a href="/net/dnsmsg.go.html#1369094">i</a></span><span class="op" id="1369146">-</span><span class="ident" id="1369147"><a href="/net/dnsmsg.go.html#1369078">begin</a></span>&nbsp;<span class="op" id="1369153">&gt;=</span>&nbsp;<span class="num" id="1369156">1</span><span class="op" id="1369157">&lt;&lt;</span><span class="num" id="1369159">6</span>&nbsp;<span class="op" id="1369161">{</span>&nbsp;<span class="comment" id="1369163">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369207">return</span>&nbsp;<span class="builtinfunc" id="1369214">len</span><span class="op" id="1369217">(</span><span class="ident" id="1369218"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1369221">)</span><span class="op" id="1369222">,</span>&nbsp;<span class="builtintype" id="1369224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369238"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1369241">[</span><span class="ident" id="1369242"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369245">]</span>&nbsp;<span class="op" id="1369247">=</span>&nbsp;<span class="builtintype" id="1369249">byte</span><span class="op" id="1369253">(</span><span class="ident" id="1369254"><a href="/net/dnsmsg.go.html#1369094">i</a></span>&nbsp;<span class="op" id="1369256">-</span>&nbsp;<span class="ident" id="1369258"><a href="/net/dnsmsg.go.html#1369078">begin</a></span><span class="op" id="1369263">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369268"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369271">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369277">for</span>&nbsp;<span class="ident" id="1369281">j</span>&nbsp;<span class="op" id="1369283">:=</span>&nbsp;<span class="ident" id="1369286"><a href="/net/dnsmsg.go.html#1369078">begin</a></span><span class="op" id="1369291">;</span>&nbsp;<span class="ident" id="1369293"><a href="/net/dnsmsg.go.html#1369281">j</a></span>&nbsp;<span class="op" id="1369295">&lt;</span>&nbsp;<span class="ident" id="1369297"><a href="/net/dnsmsg.go.html#1369094">i</a></span><span class="op" id="1369298">;</span>&nbsp;<span class="ident" id="1369300"><a href="/net/dnsmsg.go.html#1369281">j</a></span><span class="op" id="1369301">++</span>&nbsp;<span class="op" id="1369304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369310"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1369313">[</span><span class="ident" id="1369314"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369317">]</span>&nbsp;<span class="op" id="1369319">=</span>&nbsp;<span class="ident" id="1369321"><a href="/net/dnsmsg.go.html#1368626">s</a></span><span class="op" id="1369322">[</span><span class="ident" id="1369323"><a href="/net/dnsmsg.go.html#1369281">j</a></span><span class="op" id="1369324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369330"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369333">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369339">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369344"><a href="/net/dnsmsg.go.html#1369078">begin</a></span>&nbsp;<span class="op" id="1369350">=</span>&nbsp;<span class="ident" id="1369352"><a href="/net/dnsmsg.go.html#1369094">i</a></span>&nbsp;<span class="op" id="1369354">+</span>&nbsp;<span class="num" id="1369356">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369366"><a href="/net/dnsmsg.go.html#1368636">msg</a></span><span class="op" id="1369369">[</span><span class="ident" id="1369370"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369373">]</span>&nbsp;<span class="op" id="1369375">=</span>&nbsp;<span class="num" id="1369377">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369380"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369383">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369387">return</span>&nbsp;<span class="ident" id="1369394"><a href="/net/dnsmsg.go.html#1368648">off</a></span><span class="op" id="1369397">,</span>&nbsp;<span class="builtintype" id="1369399">true</span><br>
<span class="lineno"></span><span class="op" id="1369404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1369407">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="1369432">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="1369497">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1369562">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="1369623">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="1369684">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="1369747">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="1369816">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="1369854">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="1369903">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="1369969">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="1370015">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="1370077">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="1370138">func</span>&nbsp;<span class="ident" id="1370143">unpackDomainName</span><span class="op" id="1370159">(</span><span class="ident" id="1370160">msg</span>&nbsp;<span class="op" id="1370164">[</span><span class="op" id="1370165">]</span><span class="builtintype" id="1370166">byte</span><span class="op" id="1370170">,</span>&nbsp;<span class="ident" id="1370172">off</span>&nbsp;<span class="builtintype" id="1370176">int</span><span class="op" id="1370179">)</span>&nbsp;<span class="op" id="1370181">(</span><span class="ident" id="1370182">s</span>&nbsp;<span class="builtintype" id="1370184">string</span><span class="op" id="1370190">,</span>&nbsp;<span class="ident" id="1370192">off1</span>&nbsp;<span class="builtintype" id="1370197">int</span><span class="op" id="1370200">,</span>&nbsp;<span class="ident" id="1370202">ok</span>&nbsp;<span class="builtintype" id="1370205">bool</span><span class="op" id="1370209">)</span>&nbsp;<span class="op" id="1370211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370214"><a href="/net/dnsmsg.go.html#1370182">s</a></span>&nbsp;<span class="op" id="1370216">=</span>&nbsp;<span class="string" id="1370218">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370222">ptr</span>&nbsp;<span class="op" id="1370226">:=</span>&nbsp;<span class="num" id="1370229">0</span>&nbsp;<span class="comment" id="1370231">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="1370262">Loop</span><span class="op" id="1370266">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370269">for</span>&nbsp;<span class="op" id="1370273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370277">if</span>&nbsp;<span class="ident" id="1370280"><a href="/net/dnsmsg.go.html#1370172">off</a></span>&nbsp;<span class="op" id="1370284">&gt;=</span>&nbsp;<span class="builtinfunc" id="1370287">len</span><span class="op" id="1370290">(</span><span class="ident" id="1370291"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370294">)</span>&nbsp;<span class="op" id="1370296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370301">return</span>&nbsp;<span class="string" id="1370308">&#34;&#34;</span><span class="op" id="1370310">,</span>&nbsp;<span class="builtinfunc" id="1370312">len</span><span class="op" id="1370315">(</span><span class="ident" id="1370316"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370319">)</span><span class="op" id="1370320">,</span>&nbsp;<span class="builtintype" id="1370322">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370334">c</span>&nbsp;<span class="op" id="1370336">:=</span>&nbsp;<span class="builtintype" id="1370339">int</span><span class="op" id="1370342">(</span><span class="ident" id="1370343"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370346">[</span><span class="ident" id="1370347"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370350">]</span><span class="op" id="1370351">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370355"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370358">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370363">switch</span>&nbsp;<span class="ident" id="1370370"><a href="/net/dnsmsg.go.html#1370334">c</a></span>&nbsp;<span class="op" id="1370372">&amp;</span>&nbsp;<span class="num" id="1370374">0xC0</span>&nbsp;<span class="op" id="1370379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370383">case</span>&nbsp;<span class="num" id="1370388">0x00</span><span class="op" id="1370392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370397">if</span>&nbsp;<span class="ident" id="1370400"><a href="/net/dnsmsg.go.html#1370334">c</a></span>&nbsp;<span class="op" id="1370402">==</span>&nbsp;<span class="num" id="1370405">0x00</span>&nbsp;<span class="op" id="1370410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370416">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370435">break</span>&nbsp;<span class="ident" id="1370441">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370454">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370475">if</span>&nbsp;<span class="ident" id="1370478"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370481">+</span><span class="ident" id="1370482"><a href="/net/dnsmsg.go.html#1370334">c</a></span>&nbsp;<span class="op" id="1370484">&gt;</span>&nbsp;<span class="builtinfunc" id="1370486">len</span><span class="op" id="1370489">(</span><span class="ident" id="1370490"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370493">)</span>&nbsp;<span class="op" id="1370495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370501">return</span>&nbsp;<span class="string" id="1370508">&#34;&#34;</span><span class="op" id="1370510">,</span>&nbsp;<span class="builtinfunc" id="1370512">len</span><span class="op" id="1370515">(</span><span class="ident" id="1370516"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370519">)</span><span class="op" id="1370520">,</span>&nbsp;<span class="builtintype" id="1370522">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370536"><a href="/net/dnsmsg.go.html#1370182">s</a></span>&nbsp;<span class="op" id="1370538">+=</span>&nbsp;<span class="builtintype" id="1370541">string</span><span class="op" id="1370547">(</span><span class="ident" id="1370548"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370551">[</span><span class="ident" id="1370552"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370555">:</span><span class="ident" id="1370556"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370559">+</span><span class="ident" id="1370560"><a href="/net/dnsmsg.go.html#1370334">c</a></span><span class="op" id="1370561">]</span><span class="op" id="1370562">)</span>&nbsp;<span class="op" id="1370564">+</span>&nbsp;<span class="string" id="1370566">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370573"><a href="/net/dnsmsg.go.html#1370172">off</a></span>&nbsp;<span class="op" id="1370577">+=</span>&nbsp;<span class="ident" id="1370580"><a href="/net/dnsmsg.go.html#1370334">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370584">case</span>&nbsp;<span class="num" id="1370589">0xC0</span><span class="op" id="1370593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370598">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370638">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370679">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370726">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370772">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370800">if</span>&nbsp;<span class="ident" id="1370803"><a href="/net/dnsmsg.go.html#1370172">off</a></span>&nbsp;<span class="op" id="1370807">&gt;=</span>&nbsp;<span class="builtinfunc" id="1370810">len</span><span class="op" id="1370813">(</span><span class="ident" id="1370814"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370817">)</span>&nbsp;<span class="op" id="1370819">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370825">return</span>&nbsp;<span class="string" id="1370832">&#34;&#34;</span><span class="op" id="1370834">,</span>&nbsp;<span class="builtinfunc" id="1370836">len</span><span class="op" id="1370839">(</span><span class="ident" id="1370840"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370843">)</span><span class="op" id="1370844">,</span>&nbsp;<span class="builtintype" id="1370846">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370860">c1</span>&nbsp;<span class="op" id="1370863">:=</span>&nbsp;<span class="ident" id="1370866"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370869">[</span><span class="ident" id="1370870"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370873">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370878"><a href="/net/dnsmsg.go.html#1370172">off</a></span><span class="op" id="1370881">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370887">if</span>&nbsp;<span class="ident" id="1370890"><a href="/net/dnsmsg.go.html#1370222">ptr</a></span>&nbsp;<span class="op" id="1370894">==</span>&nbsp;<span class="num" id="1370897">0</span>&nbsp;<span class="op" id="1370899">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370905"><a href="/net/dnsmsg.go.html#1370192">off1</a></span>&nbsp;<span class="op" id="1370910">=</span>&nbsp;<span class="ident" id="1370912"><a href="/net/dnsmsg.go.html#1370172">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370924">if</span>&nbsp;<span class="ident" id="1370927"><a href="/net/dnsmsg.go.html#1370222">ptr</a></span><span class="op" id="1370930">++</span><span class="op" id="1370932">;</span>&nbsp;<span class="ident" id="1370934"><a href="/net/dnsmsg.go.html#1370222">ptr</a></span>&nbsp;<span class="op" id="1370938">&gt;</span>&nbsp;<span class="num" id="1370940">10</span>&nbsp;<span class="op" id="1370943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370949">return</span>&nbsp;<span class="string" id="1370956">&#34;&#34;</span><span class="op" id="1370958">,</span>&nbsp;<span class="builtinfunc" id="1370960">len</span><span class="op" id="1370963">(</span><span class="ident" id="1370964"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1370967">)</span><span class="op" id="1370968">,</span>&nbsp;<span class="builtintype" id="1370970">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370979">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370984"><a href="/net/dnsmsg.go.html#1370172">off</a></span>&nbsp;<span class="op" id="1370988">=</span>&nbsp;<span class="op" id="1370990">(</span><span class="ident" id="1370991"><a href="/net/dnsmsg.go.html#1370334">c</a></span><span class="op" id="1370992">^</span><span class="num" id="1370993">0xC0</span><span class="op" id="1370997">)</span><span class="op" id="1370998">&lt;&lt;</span><span class="num" id="1371000">8</span>&nbsp;<span class="op" id="1371002">|</span>&nbsp;<span class="builtintype" id="1371004">int</span><span class="op" id="1371007">(</span><span class="ident" id="1371008"><a href="/net/dnsmsg.go.html#1370860">c1</a></span><span class="op" id="1371010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371014">default</span><span class="op" id="1371021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1371026">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371059">return</span>&nbsp;<span class="string" id="1371066">&#34;&#34;</span><span class="op" id="1371068">,</span>&nbsp;<span class="builtinfunc" id="1371070">len</span><span class="op" id="1371073">(</span><span class="ident" id="1371074"><a href="/net/dnsmsg.go.html#1370160">msg</a></span><span class="op" id="1371077">)</span><span class="op" id="1371078">,</span>&nbsp;<span class="builtintype" id="1371080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1371088">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1371091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371094">if</span>&nbsp;<span class="ident" id="1371097"><a href="/net/dnsmsg.go.html#1370222">ptr</a></span>&nbsp;<span class="op" id="1371101">==</span>&nbsp;<span class="num" id="1371104">0</span>&nbsp;<span class="op" id="1371106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371110"><a href="/net/dnsmsg.go.html#1370192">off1</a></span>&nbsp;<span class="op" id="1371115">=</span>&nbsp;<span class="ident" id="1371117"><a href="/net/dnsmsg.go.html#1370172">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1371122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371125">return</span>&nbsp;<span class="ident" id="1371132"><a href="/net/dnsmsg.go.html#1370182">s</a></span><span class="op" id="1371133">,</span>&nbsp;<span class="ident" id="1371135"><a href="/net/dnsmsg.go.html#1370192">off1</a></span><span class="op" id="1371139">,</span>&nbsp;<span class="builtintype" id="1371141">true</span><br>
<span class="lineno">485</span><span class="op" id="1371146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1371149">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1371219">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="1371280">func</span>&nbsp;<span class="ident" id="1371285">packStruct</span><span class="op" id="1371295">(</span><span class="ident" id="1371296">any</span>&nbsp;<span class="ident" id="1371300"><a href="/net/dnsmsg.go.html#1360570">dnsStruct</a></span><span class="op" id="1371309">,</span>&nbsp;<span class="ident" id="1371311">msg</span>&nbsp;<span class="op" id="1371315">[</span><span class="op" id="1371316">]</span><span class="builtintype" id="1371317">byte</span><span class="op" id="1371321">,</span>&nbsp;<span class="ident" id="1371323">off</span>&nbsp;<span class="builtintype" id="1371327">int</span><span class="op" id="1371330">)</span>&nbsp;<span class="op" id="1371332">(</span><span class="ident" id="1371333">off1</span>&nbsp;<span class="builtintype" id="1371338">int</span><span class="op" id="1371341">,</span>&nbsp;<span class="ident" id="1371343">ok</span>&nbsp;<span class="builtintype" id="1371346">bool</span><span class="op" id="1371350">)</span>&nbsp;<span class="op" id="1371352">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371355"><a href="/net/dnsmsg.go.html#1371343">ok</a></span>&nbsp;<span class="op" id="1371358">=</span>&nbsp;<span class="ident" id="1371360"><a href="/net/dnsmsg.go.html#1371296">any</a></span><span class="op" id="1371363">.</span><span class="ident" id="1371364">Walk</span><span class="op" id="1371368">(</span><span class="keyword" id="1371369">func</span><span class="op" id="1371373">(</span><span class="ident" id="1371374">field</span>&nbsp;<span class="keyword" id="1371380">interface</span><span class="op" id="1371389">{</span><span class="op" id="1371390">}</span><span class="op" id="1371391">,</span>&nbsp;<span class="ident" id="1371393">name</span><span class="op" id="1371397">,</span>&nbsp;<span class="ident" id="1371399">tag</span>&nbsp;<span class="builtintype" id="1371403">string</span><span class="op" id="1371409">)</span>&nbsp;<span class="builtintype" id="1371411">bool</span>&nbsp;<span class="op" id="1371416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371420">switch</span>&nbsp;<span class="ident" id="1371427">fv</span>&nbsp;<span class="op" id="1371430">:=</span>&nbsp;<span class="ident" id="1371433"><a href="/net/dnsmsg.go.html#1371374">field</a></span><span class="op" id="1371438">.</span><span class="op" id="1371439">(</span><span class="keyword" id="1371440">type</span><span class="op" id="1371444">)</span>&nbsp;<span class="op" id="1371446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371450">default</span><span class="op" id="1371457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1371462">println</span><span class="op" id="1371469">(</span><span class="string" id="1371470">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="1371502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371507">return</span>&nbsp;<span class="builtintype" id="1371514">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371522">case</span>&nbsp;<span class="op" id="1371527">*</span><span class="builtintype" id="1371528">uint16</span><span class="op" id="1371534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371539">i</span>&nbsp;<span class="op" id="1371541">:=</span>&nbsp;<span class="op" id="1371544">*</span><span class="ident" id="1371545"><a href="/net/dnsmsg.go.html#1371427">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371551">if</span>&nbsp;<span class="ident" id="1371554"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371557">+</span><span class="num" id="1371558">2</span>&nbsp;<span class="op" id="1371560">&gt;</span>&nbsp;<span class="builtinfunc" id="1371562">len</span><span class="op" id="1371565">(</span><span class="ident" id="1371566"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371569">)</span>&nbsp;<span class="op" id="1371571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371577">return</span>&nbsp;<span class="builtintype" id="1371584">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1371593">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371598"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371601">[</span><span class="ident" id="1371602"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371605">]</span>&nbsp;<span class="op" id="1371607">=</span>&nbsp;<span class="builtintype" id="1371609">byte</span><span class="op" id="1371613">(</span><span class="ident" id="1371614"><a href="/net/dnsmsg.go.html#1371539">i</a></span>&nbsp;<span class="op" id="1371616">&gt;&gt;</span>&nbsp;<span class="num" id="1371619">8</span><span class="op" id="1371620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371625"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371628">[</span><span class="ident" id="1371629"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371632">+</span><span class="num" id="1371633">1</span><span class="op" id="1371634">]</span>&nbsp;<span class="op" id="1371636">=</span>&nbsp;<span class="builtintype" id="1371638">byte</span><span class="op" id="1371642">(</span><span class="ident" id="1371643"><a href="/net/dnsmsg.go.html#1371539">i</a></span><span class="op" id="1371644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371649"><a href="/net/dnsmsg.go.html#1371323">off</a></span>&nbsp;<span class="op" id="1371653">+=</span>&nbsp;<span class="num" id="1371656">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371660">case</span>&nbsp;<span class="op" id="1371665">*</span><span class="builtintype" id="1371666">uint32</span><span class="op" id="1371672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371677">i</span>&nbsp;<span class="op" id="1371679">:=</span>&nbsp;<span class="op" id="1371682">*</span><span class="ident" id="1371683"><a href="/net/dnsmsg.go.html#1371427">fv</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371689"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371692">[</span><span class="ident" id="1371693"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371696">]</span>&nbsp;<span class="op" id="1371698">=</span>&nbsp;<span class="builtintype" id="1371700">byte</span><span class="op" id="1371704">(</span><span class="ident" id="1371705"><a href="/net/dnsmsg.go.html#1371677">i</a></span>&nbsp;<span class="op" id="1371707">&gt;&gt;</span>&nbsp;<span class="num" id="1371710">24</span><span class="op" id="1371712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371717"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371720">[</span><span class="ident" id="1371721"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371724">+</span><span class="num" id="1371725">1</span><span class="op" id="1371726">]</span>&nbsp;<span class="op" id="1371728">=</span>&nbsp;<span class="builtintype" id="1371730">byte</span><span class="op" id="1371734">(</span><span class="ident" id="1371735"><a href="/net/dnsmsg.go.html#1371677">i</a></span>&nbsp;<span class="op" id="1371737">&gt;&gt;</span>&nbsp;<span class="num" id="1371740">16</span><span class="op" id="1371742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371747"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371750">[</span><span class="ident" id="1371751"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371754">+</span><span class="num" id="1371755">2</span><span class="op" id="1371756">]</span>&nbsp;<span class="op" id="1371758">=</span>&nbsp;<span class="builtintype" id="1371760">byte</span><span class="op" id="1371764">(</span><span class="ident" id="1371765"><a href="/net/dnsmsg.go.html#1371677">i</a></span>&nbsp;<span class="op" id="1371767">&gt;&gt;</span>&nbsp;<span class="num" id="1371770">8</span><span class="op" id="1371771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371776"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371779">[</span><span class="ident" id="1371780"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371783">+</span><span class="num" id="1371784">3</span><span class="op" id="1371785">]</span>&nbsp;<span class="op" id="1371787">=</span>&nbsp;<span class="builtintype" id="1371789">byte</span><span class="op" id="1371793">(</span><span class="ident" id="1371794"><a href="/net/dnsmsg.go.html#1371677">i</a></span><span class="op" id="1371795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371800"><a href="/net/dnsmsg.go.html#1371323">off</a></span>&nbsp;<span class="op" id="1371804">+=</span>&nbsp;<span class="num" id="1371807">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371811">case</span>&nbsp;<span class="op" id="1371816">[</span><span class="op" id="1371817">]</span><span class="builtintype" id="1371818">byte</span><span class="op" id="1371822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371827">n</span>&nbsp;<span class="op" id="1371829">:=</span>&nbsp;<span class="builtinfunc" id="1371832">len</span><span class="op" id="1371835">(</span><span class="ident" id="1371836"><a href="/net/dnsmsg.go.html#1371427">fv</a></span><span class="op" id="1371838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371843">if</span>&nbsp;<span class="ident" id="1371846"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371849">+</span><span class="ident" id="1371850"><a href="/net/dnsmsg.go.html#1371827">n</a></span>&nbsp;<span class="op" id="1371852">&gt;</span>&nbsp;<span class="builtinfunc" id="1371854">len</span><span class="op" id="1371857">(</span><span class="ident" id="1371858"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371861">)</span>&nbsp;<span class="op" id="1371863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371869">return</span>&nbsp;<span class="builtintype" id="1371876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1371885">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1371890">copy</span><span class="op" id="1371894">(</span><span class="ident" id="1371895"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1371898">[</span><span class="ident" id="1371899"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371902">:</span><span class="ident" id="1371903"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1371906">+</span><span class="ident" id="1371907"><a href="/net/dnsmsg.go.html#1371827">n</a></span><span class="op" id="1371908">]</span><span class="op" id="1371909">,</span>&nbsp;<span class="ident" id="1371911"><a href="/net/dnsmsg.go.html#1371427">fv</a></span><span class="op" id="1371913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371918"><a href="/net/dnsmsg.go.html#1371323">off</a></span>&nbsp;<span class="op" id="1371922">+=</span>&nbsp;<span class="ident" id="1371925"><a href="/net/dnsmsg.go.html#1371827">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371929">case</span>&nbsp;<span class="op" id="1371934">*</span><span class="builtintype" id="1371935">string</span><span class="op" id="1371941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1371946">s</span>&nbsp;<span class="op" id="1371948">:=</span>&nbsp;<span class="op" id="1371951">*</span><span class="ident" id="1371952"><a href="/net/dnsmsg.go.html#1371427">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371958">switch</span>&nbsp;<span class="ident" id="1371965"><a href="/net/dnsmsg.go.html#1371399">tag</a></span>&nbsp;<span class="op" id="1371969">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1371974">default</span><span class="op" id="1371981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1371987">println</span><span class="op" id="1371994">(</span><span class="string" id="1371995">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="1372025">,</span>&nbsp;<span class="ident" id="1372027"><a href="/net/dnsmsg.go.html#1371399">tag</a></span><span class="op" id="1372030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372036">return</span>&nbsp;<span class="builtintype" id="1372043">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372052">case</span>&nbsp;<span class="string" id="1372057">&#34;domain&#34;</span><span class="op" id="1372065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372071"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372074">,</span>&nbsp;<span class="ident" id="1372076"><a href="/net/dnsmsg.go.html#1371343">ok</a></span>&nbsp;<span class="op" id="1372079">=</span>&nbsp;<span class="ident" id="1372081"><a href="/net/dnsmsg.go.html#1368611">packDomainName</a></span><span class="op" id="1372095">(</span><span class="ident" id="1372096"><a href="/net/dnsmsg.go.html#1371946">s</a></span><span class="op" id="1372097">,</span>&nbsp;<span class="ident" id="1372099"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1372102">,</span>&nbsp;<span class="ident" id="1372104"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372107">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372113">if</span>&nbsp;<span class="op" id="1372116">!</span><span class="ident" id="1372117"><a href="/net/dnsmsg.go.html#1371343">ok</a></span>&nbsp;<span class="op" id="1372120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372127">return</span>&nbsp;<span class="builtintype" id="1372134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372149">case</span>&nbsp;<span class="string" id="1372154">&#34;&#34;</span><span class="op" id="1372156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1372162">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372200">if</span>&nbsp;<span class="builtinfunc" id="1372203">len</span><span class="op" id="1372206">(</span><span class="ident" id="1372207"><a href="/net/dnsmsg.go.html#1371946">s</a></span><span class="op" id="1372208">)</span>&nbsp;<span class="op" id="1372210">&gt;</span>&nbsp;<span class="num" id="1372212">255</span>&nbsp;<span class="op" id="1372216">||</span>&nbsp;<span class="ident" id="1372219"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372222">+</span><span class="num" id="1372223">1</span><span class="op" id="1372224">+</span><span class="builtinfunc" id="1372225">len</span><span class="op" id="1372228">(</span><span class="ident" id="1372229"><a href="/net/dnsmsg.go.html#1371946">s</a></span><span class="op" id="1372230">)</span>&nbsp;<span class="op" id="1372232">&gt;</span>&nbsp;<span class="builtinfunc" id="1372234">len</span><span class="op" id="1372237">(</span><span class="ident" id="1372238"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1372241">)</span>&nbsp;<span class="op" id="1372243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372250">return</span>&nbsp;<span class="builtintype" id="1372257">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372273"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1372276">[</span><span class="ident" id="1372277"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372280">]</span>&nbsp;<span class="op" id="1372282">=</span>&nbsp;<span class="builtintype" id="1372284">byte</span><span class="op" id="1372288">(</span><span class="builtinfunc" id="1372289">len</span><span class="op" id="1372292">(</span><span class="ident" id="1372293"><a href="/net/dnsmsg.go.html#1371946">s</a></span><span class="op" id="1372294">)</span><span class="op" id="1372295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372301"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372304">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372311"><a href="/net/dnsmsg.go.html#1371323">off</a></span>&nbsp;<span class="op" id="1372315">+=</span>&nbsp;<span class="builtinfunc" id="1372318">copy</span><span class="op" id="1372322">(</span><span class="ident" id="1372323"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1372326">[</span><span class="ident" id="1372327"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372330">:</span><span class="op" id="1372331">]</span><span class="op" id="1372332">,</span>&nbsp;<span class="ident" id="1372334"><a href="/net/dnsmsg.go.html#1371946">s</a></span><span class="op" id="1372335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372348">return</span>&nbsp;<span class="builtintype" id="1372355">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372361">}</span><span class="op" id="1372362">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372365">if</span>&nbsp;<span class="op" id="1372368">!</span><span class="ident" id="1372369"><a href="/net/dnsmsg.go.html#1371343">ok</a></span>&nbsp;<span class="op" id="1372372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372376">return</span>&nbsp;<span class="builtinfunc" id="1372383">len</span><span class="op" id="1372386">(</span><span class="ident" id="1372387"><a href="/net/dnsmsg.go.html#1371311">msg</a></span><span class="op" id="1372390">)</span><span class="op" id="1372391">,</span>&nbsp;<span class="builtintype" id="1372393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372403">return</span>&nbsp;<span class="ident" id="1372410"><a href="/net/dnsmsg.go.html#1371323">off</a></span><span class="op" id="1372413">,</span>&nbsp;<span class="builtintype" id="1372415">true</span><br>
<span class="lineno"></span><span class="op" id="1372420">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="1372423">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1372488">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="1372549">func</span>&nbsp;<span class="ident" id="1372554">unpackStruct</span><span class="op" id="1372566">(</span><span class="ident" id="1372567">any</span>&nbsp;<span class="ident" id="1372571"><a href="/net/dnsmsg.go.html#1360570">dnsStruct</a></span><span class="op" id="1372580">,</span>&nbsp;<span class="ident" id="1372582">msg</span>&nbsp;<span class="op" id="1372586">[</span><span class="op" id="1372587">]</span><span class="builtintype" id="1372588">byte</span><span class="op" id="1372592">,</span>&nbsp;<span class="ident" id="1372594">off</span>&nbsp;<span class="builtintype" id="1372598">int</span><span class="op" id="1372601">)</span>&nbsp;<span class="op" id="1372603">(</span><span class="ident" id="1372604">off1</span>&nbsp;<span class="builtintype" id="1372609">int</span><span class="op" id="1372612">,</span>&nbsp;<span class="ident" id="1372614">ok</span>&nbsp;<span class="builtintype" id="1372617">bool</span><span class="op" id="1372621">)</span>&nbsp;<span class="op" id="1372623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372626"><a href="/net/dnsmsg.go.html#1372614">ok</a></span>&nbsp;<span class="op" id="1372629">=</span>&nbsp;<span class="ident" id="1372631"><a href="/net/dnsmsg.go.html#1372567">any</a></span><span class="op" id="1372634">.</span><span class="ident" id="1372635">Walk</span><span class="op" id="1372639">(</span><span class="keyword" id="1372640">func</span><span class="op" id="1372644">(</span><span class="ident" id="1372645">field</span>&nbsp;<span class="keyword" id="1372651">interface</span><span class="op" id="1372660">{</span><span class="op" id="1372661">}</span><span class="op" id="1372662">,</span>&nbsp;<span class="ident" id="1372664">name</span><span class="op" id="1372668">,</span>&nbsp;<span class="ident" id="1372670">tag</span>&nbsp;<span class="builtintype" id="1372674">string</span><span class="op" id="1372680">)</span>&nbsp;<span class="builtintype" id="1372682">bool</span>&nbsp;<span class="op" id="1372687">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372691">switch</span>&nbsp;<span class="ident" id="1372698">fv</span>&nbsp;<span class="op" id="1372701">:=</span>&nbsp;<span class="ident" id="1372704"><a href="/net/dnsmsg.go.html#1372645">field</a></span><span class="op" id="1372709">.</span><span class="op" id="1372710">(</span><span class="keyword" id="1372711">type</span><span class="op" id="1372715">)</span>&nbsp;<span class="op" id="1372717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372721">default</span><span class="op" id="1372728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1372733">println</span><span class="op" id="1372740">(</span><span class="string" id="1372741">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="1372773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372778">return</span>&nbsp;<span class="builtintype" id="1372785">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372793">case</span>&nbsp;<span class="op" id="1372798">*</span><span class="builtintype" id="1372799">uint16</span><span class="op" id="1372805">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372810">if</span>&nbsp;<span class="ident" id="1372813"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1372816">+</span><span class="num" id="1372817">2</span>&nbsp;<span class="op" id="1372819">&gt;</span>&nbsp;<span class="builtinfunc" id="1372821">len</span><span class="op" id="1372824">(</span><span class="ident" id="1372825"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1372828">)</span>&nbsp;<span class="op" id="1372830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372836">return</span>&nbsp;<span class="builtintype" id="1372843">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372857">*</span><span class="ident" id="1372858"><a href="/net/dnsmsg.go.html#1372698">fv</a></span>&nbsp;<span class="op" id="1372861">=</span>&nbsp;<span class="builtintype" id="1372863">uint16</span><span class="op" id="1372869">(</span><span class="ident" id="1372870"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1372873">[</span><span class="ident" id="1372874"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1372877">]</span><span class="op" id="1372878">)</span><span class="op" id="1372879">&lt;&lt;</span><span class="num" id="1372881">8</span>&nbsp;<span class="op" id="1372883">|</span>&nbsp;<span class="builtintype" id="1372885">uint16</span><span class="op" id="1372891">(</span><span class="ident" id="1372892"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1372895">[</span><span class="ident" id="1372896"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1372899">+</span><span class="num" id="1372900">1</span><span class="op" id="1372901">]</span><span class="op" id="1372902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1372907"><a href="/net/dnsmsg.go.html#1372594">off</a></span>&nbsp;<span class="op" id="1372911">+=</span>&nbsp;<span class="num" id="1372914">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372918">case</span>&nbsp;<span class="op" id="1372923">*</span><span class="builtintype" id="1372924">uint32</span><span class="op" id="1372930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372935">if</span>&nbsp;<span class="ident" id="1372938"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1372941">+</span><span class="num" id="1372942">4</span>&nbsp;<span class="op" id="1372944">&gt;</span>&nbsp;<span class="builtinfunc" id="1372946">len</span><span class="op" id="1372949">(</span><span class="ident" id="1372950"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1372953">)</span>&nbsp;<span class="op" id="1372955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1372961">return</span>&nbsp;<span class="builtintype" id="1372968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1372982">*</span><span class="ident" id="1372983"><a href="/net/dnsmsg.go.html#1372698">fv</a></span>&nbsp;<span class="op" id="1372986">=</span>&nbsp;<span class="builtintype" id="1372988">uint32</span><span class="op" id="1372994">(</span><span class="ident" id="1372995"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1372998">[</span><span class="ident" id="1372999"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373002">]</span><span class="op" id="1373003">)</span><span class="op" id="1373004">&lt;&lt;</span><span class="num" id="1373006">24</span>&nbsp;<span class="op" id="1373009">|</span>&nbsp;<span class="builtintype" id="1373011">uint32</span><span class="op" id="1373017">(</span><span class="ident" id="1373018"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373021">[</span><span class="ident" id="1373022"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373025">+</span><span class="num" id="1373026">1</span><span class="op" id="1373027">]</span><span class="op" id="1373028">)</span><span class="op" id="1373029">&lt;&lt;</span><span class="num" id="1373031">16</span>&nbsp;<span class="op" id="1373034">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="1373040">uint32</span><span class="op" id="1373046">(</span><span class="ident" id="1373047"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373050">[</span><span class="ident" id="1373051"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373054">+</span><span class="num" id="1373055">2</span><span class="op" id="1373056">]</span><span class="op" id="1373057">)</span><span class="op" id="1373058">&lt;&lt;</span><span class="num" id="1373060">8</span>&nbsp;<span class="op" id="1373062">|</span>&nbsp;<span class="builtintype" id="1373064">uint32</span><span class="op" id="1373070">(</span><span class="ident" id="1373071"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373074">[</span><span class="ident" id="1373075"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373078">+</span><span class="num" id="1373079">3</span><span class="op" id="1373080">]</span><span class="op" id="1373081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373086"><a href="/net/dnsmsg.go.html#1372594">off</a></span>&nbsp;<span class="op" id="1373090">+=</span>&nbsp;<span class="num" id="1373093">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373097">case</span>&nbsp;<span class="op" id="1373102">[</span><span class="op" id="1373103">]</span><span class="builtintype" id="1373104">byte</span><span class="op" id="1373108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373113">n</span>&nbsp;<span class="op" id="1373115">:=</span>&nbsp;<span class="builtinfunc" id="1373118">len</span><span class="op" id="1373121">(</span><span class="ident" id="1373122"><a href="/net/dnsmsg.go.html#1372698">fv</a></span><span class="op" id="1373124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373129">if</span>&nbsp;<span class="ident" id="1373132"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373135">+</span><span class="ident" id="1373136"><a href="/net/dnsmsg.go.html#1373113">n</a></span>&nbsp;<span class="op" id="1373138">&gt;</span>&nbsp;<span class="builtinfunc" id="1373140">len</span><span class="op" id="1373143">(</span><span class="ident" id="1373144"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373147">)</span>&nbsp;<span class="op" id="1373149">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373155">return</span>&nbsp;<span class="builtintype" id="1373162">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1373176">copy</span><span class="op" id="1373180">(</span><span class="ident" id="1373181"><a href="/net/dnsmsg.go.html#1372698">fv</a></span><span class="op" id="1373183">,</span>&nbsp;<span class="ident" id="1373185"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373188">[</span><span class="ident" id="1373189"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373192">:</span><span class="ident" id="1373193"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373196">+</span><span class="ident" id="1373197"><a href="/net/dnsmsg.go.html#1373113">n</a></span><span class="op" id="1373198">]</span><span class="op" id="1373199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373204"><a href="/net/dnsmsg.go.html#1372594">off</a></span>&nbsp;<span class="op" id="1373208">+=</span>&nbsp;<span class="ident" id="1373211"><a href="/net/dnsmsg.go.html#1373113">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373215">case</span>&nbsp;<span class="op" id="1373220">*</span><span class="builtintype" id="1373221">string</span><span class="op" id="1373227">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373232">var</span>&nbsp;<span class="ident" id="1373236">s</span>&nbsp;<span class="builtintype" id="1373238">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373248">switch</span>&nbsp;<span class="ident" id="1373255"><a href="/net/dnsmsg.go.html#1372670">tag</a></span>&nbsp;<span class="op" id="1373259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373264">default</span><span class="op" id="1373271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1373277">println</span><span class="op" id="1373284">(</span><span class="string" id="1373285">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="1373315">,</span>&nbsp;<span class="ident" id="1373317"><a href="/net/dnsmsg.go.html#1372670">tag</a></span><span class="op" id="1373320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373326">return</span>&nbsp;<span class="builtintype" id="1373333">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373342">case</span>&nbsp;<span class="string" id="1373347">&#34;domain&#34;</span><span class="op" id="1373355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373361"><a href="/net/dnsmsg.go.html#1373236">s</a></span><span class="op" id="1373362">,</span>&nbsp;<span class="ident" id="1373364"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373367">,</span>&nbsp;<span class="ident" id="1373369"><a href="/net/dnsmsg.go.html#1372614">ok</a></span>&nbsp;<span class="op" id="1373372">=</span>&nbsp;<span class="ident" id="1373374"><a href="/net/dnsmsg.go.html#1370143">unpackDomainName</a></span><span class="op" id="1373390">(</span><span class="ident" id="1373391"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373394">,</span>&nbsp;<span class="ident" id="1373396"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373405">if</span>&nbsp;<span class="op" id="1373408">!</span><span class="ident" id="1373409"><a href="/net/dnsmsg.go.html#1372614">ok</a></span>&nbsp;<span class="op" id="1373412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373419">return</span>&nbsp;<span class="builtintype" id="1373426">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373436">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373441">case</span>&nbsp;<span class="string" id="1373446">&#34;&#34;</span><span class="op" id="1373448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373454">if</span>&nbsp;<span class="ident" id="1373457"><a href="/net/dnsmsg.go.html#1372594">off</a></span>&nbsp;<span class="op" id="1373461">&gt;=</span>&nbsp;<span class="builtinfunc" id="1373464">len</span><span class="op" id="1373467">(</span><span class="ident" id="1373468"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373471">)</span>&nbsp;<span class="op" id="1373473">||</span>&nbsp;<span class="ident" id="1373476"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373479">+</span><span class="num" id="1373480">1</span><span class="op" id="1373481">+</span><span class="builtintype" id="1373482">int</span><span class="op" id="1373485">(</span><span class="ident" id="1373486"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373489">[</span><span class="ident" id="1373490"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373493">]</span><span class="op" id="1373494">)</span>&nbsp;<span class="op" id="1373496">&gt;</span>&nbsp;<span class="builtinfunc" id="1373498">len</span><span class="op" id="1373501">(</span><span class="ident" id="1373502"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373505">)</span>&nbsp;<span class="op" id="1373507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373514">return</span>&nbsp;<span class="builtintype" id="1373521">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373537">n</span>&nbsp;<span class="op" id="1373539">:=</span>&nbsp;<span class="builtintype" id="1373542">int</span><span class="op" id="1373545">(</span><span class="ident" id="1373546"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373549">[</span><span class="ident" id="1373550"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373553">]</span><span class="op" id="1373554">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373560"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373563">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373570">b</span>&nbsp;<span class="op" id="1373572">:=</span>&nbsp;<span class="builtinfunc" id="1373575">make</span><span class="op" id="1373579">(</span><span class="op" id="1373580">[</span><span class="op" id="1373581">]</span><span class="builtintype" id="1373582">byte</span><span class="op" id="1373586">,</span>&nbsp;<span class="ident" id="1373588"><a href="/net/dnsmsg.go.html#1373537">n</a></span><span class="op" id="1373589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373595">for</span>&nbsp;<span class="ident" id="1373599">i</span>&nbsp;<span class="op" id="1373601">:=</span>&nbsp;<span class="num" id="1373604">0</span><span class="op" id="1373605">;</span>&nbsp;<span class="ident" id="1373607"><a href="/net/dnsmsg.go.html#1373599">i</a></span>&nbsp;<span class="op" id="1373609">&lt;</span>&nbsp;<span class="ident" id="1373611"><a href="/net/dnsmsg.go.html#1373537">n</a></span><span class="op" id="1373612">;</span>&nbsp;<span class="ident" id="1373614"><a href="/net/dnsmsg.go.html#1373599">i</a></span><span class="op" id="1373615">++</span>&nbsp;<span class="op" id="1373618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373625"><a href="/net/dnsmsg.go.html#1373570">b</a></span><span class="op" id="1373626">[</span><span class="ident" id="1373627"><a href="/net/dnsmsg.go.html#1373599">i</a></span><span class="op" id="1373628">]</span>&nbsp;<span class="op" id="1373630">=</span>&nbsp;<span class="ident" id="1373632"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373635">[</span><span class="ident" id="1373636"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373639">+</span><span class="ident" id="1373640"><a href="/net/dnsmsg.go.html#1373599">i</a></span><span class="op" id="1373641">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373647">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373653"><a href="/net/dnsmsg.go.html#1372594">off</a></span>&nbsp;<span class="op" id="1373657">+=</span>&nbsp;<span class="ident" id="1373660"><a href="/net/dnsmsg.go.html#1373537">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373666"><a href="/net/dnsmsg.go.html#1373236">s</a></span>&nbsp;<span class="op" id="1373668">=</span>&nbsp;<span class="builtintype" id="1373670">string</span><span class="op" id="1373676">(</span><span class="ident" id="1373677"><a href="/net/dnsmsg.go.html#1373570">b</a></span><span class="op" id="1373678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373688">*</span><span class="ident" id="1373689"><a href="/net/dnsmsg.go.html#1372698">fv</a></span>&nbsp;<span class="op" id="1373692">=</span>&nbsp;<span class="ident" id="1373694"><a href="/net/dnsmsg.go.html#1373236">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373698">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373702">return</span>&nbsp;<span class="builtintype" id="1373709">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373715">}</span><span class="op" id="1373716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373719">if</span>&nbsp;<span class="op" id="1373722">!</span><span class="ident" id="1373723"><a href="/net/dnsmsg.go.html#1372614">ok</a></span>&nbsp;<span class="op" id="1373726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373730">return</span>&nbsp;<span class="builtinfunc" id="1373737">len</span><span class="op" id="1373740">(</span><span class="ident" id="1373741"><a href="/net/dnsmsg.go.html#1372582">msg</a></span><span class="op" id="1373744">)</span><span class="op" id="1373745">,</span>&nbsp;<span class="builtintype" id="1373747">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1373754">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373757">return</span>&nbsp;<span class="ident" id="1373764"><a href="/net/dnsmsg.go.html#1372594">off</a></span><span class="op" id="1373767">,</span>&nbsp;<span class="builtintype" id="1373769">true</span><br>
<span class="lineno"></span><span class="op" id="1373774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1373777">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="1373844">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="1373864">func</span>&nbsp;<span class="ident" id="1373869">printStruct</span><span class="op" id="1373880">(</span><span class="ident" id="1373881">any</span>&nbsp;<span class="ident" id="1373885"><a href="/net/dnsmsg.go.html#1360570">dnsStruct</a></span><span class="op" id="1373894">)</span>&nbsp;<span class="builtintype" id="1373896">string</span>&nbsp;<span class="op" id="1373903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373906">s</span>&nbsp;<span class="op" id="1373908">:=</span>&nbsp;<span class="string" id="1373911">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373916">i</span>&nbsp;<span class="op" id="1373918">:=</span>&nbsp;<span class="num" id="1373921">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373924"><a href="/net/dnsmsg.go.html#1373881">any</a></span><span class="op" id="1373927">.</span><span class="ident" id="1373928">Walk</span><span class="op" id="1373932">(</span><span class="keyword" id="1373933">func</span><span class="op" id="1373937">(</span><span class="ident" id="1373938">val</span>&nbsp;<span class="keyword" id="1373942">interface</span><span class="op" id="1373951">{</span><span class="op" id="1373952">}</span><span class="op" id="1373953">,</span>&nbsp;<span class="ident" id="1373955">name</span><span class="op" id="1373959">,</span>&nbsp;<span class="ident" id="1373961">tag</span>&nbsp;<span class="builtintype" id="1373965">string</span><span class="op" id="1373971">)</span>&nbsp;<span class="builtintype" id="1373973">bool</span>&nbsp;<span class="op" id="1373978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1373982"><a href="/net/dnsmsg.go.html#1373916">i</a></span><span class="op" id="1373983">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1373988">if</span>&nbsp;<span class="ident" id="1373991"><a href="/net/dnsmsg.go.html#1373916">i</a></span>&nbsp;<span class="op" id="1373993">&gt;</span>&nbsp;<span class="num" id="1373995">1</span>&nbsp;<span class="op" id="1373997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374002"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374004">+=</span>&nbsp;<span class="string" id="1374007">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374018"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374020">+=</span>&nbsp;<span class="ident" id="1374023"><a href="/net/dnsmsg.go.html#1373955">name</a></span>&nbsp;<span class="op" id="1374028">+</span>&nbsp;<span class="string" id="1374030">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374036">switch</span>&nbsp;<span class="ident" id="1374043"><a href="/net/dnsmsg.go.html#1373961">tag</a></span>&nbsp;<span class="op" id="1374047">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374051">case</span>&nbsp;<span class="string" id="1374056">&#34;ipv4&#34;</span><span class="op" id="1374062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374067">i</span>&nbsp;<span class="op" id="1374069">:=</span>&nbsp;<span class="op" id="1374072">*</span><span class="ident" id="1374073"><a href="/net/dnsmsg.go.html#1373938">val</a></span><span class="op" id="1374076">.</span><span class="op" id="1374077">(</span><span class="op" id="1374078">*</span><span class="builtintype" id="1374079">uint32</span><span class="op" id="1374085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374090"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374092">+=</span>&nbsp;<span class="ident" id="1374095"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1374099">(</span><span class="builtintype" id="1374100">byte</span><span class="op" id="1374104">(</span><span class="ident" id="1374105"><a href="/net/dnsmsg.go.html#1374067">i</a></span><span class="op" id="1374106">&gt;&gt;</span><span class="num" id="1374108">24</span><span class="op" id="1374110">)</span><span class="op" id="1374111">,</span>&nbsp;<span class="builtintype" id="1374113">byte</span><span class="op" id="1374117">(</span><span class="ident" id="1374118"><a href="/net/dnsmsg.go.html#1374067">i</a></span><span class="op" id="1374119">&gt;&gt;</span><span class="num" id="1374121">16</span><span class="op" id="1374123">)</span><span class="op" id="1374124">,</span>&nbsp;<span class="builtintype" id="1374126">byte</span><span class="op" id="1374130">(</span><span class="ident" id="1374131"><a href="/net/dnsmsg.go.html#1374067">i</a></span><span class="op" id="1374132">&gt;&gt;</span><span class="num" id="1374134">8</span><span class="op" id="1374135">)</span><span class="op" id="1374136">,</span>&nbsp;<span class="builtintype" id="1374138">byte</span><span class="op" id="1374142">(</span><span class="ident" id="1374143"><a href="/net/dnsmsg.go.html#1374067">i</a></span><span class="op" id="1374144">)</span><span class="op" id="1374145">)</span><span class="op" id="1374146">.</span><span class="ident" id="1374147">String</span><span class="op" id="1374153">(</span><span class="op" id="1374154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374158">case</span>&nbsp;<span class="string" id="1374163">&#34;ipv6&#34;</span><span class="op" id="1374169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374174">i</span>&nbsp;<span class="op" id="1374176">:=</span>&nbsp;<span class="ident" id="1374179"><a href="/net/dnsmsg.go.html#1373938">val</a></span><span class="op" id="1374182">.</span><span class="op" id="1374183">(</span><span class="op" id="1374184">[</span><span class="op" id="1374185">]</span><span class="builtintype" id="1374186">byte</span><span class="op" id="1374190">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374195"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374197">+=</span>&nbsp;<span class="ident" id="1374200"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1374202">(</span><span class="ident" id="1374203"><a href="/net/dnsmsg.go.html#1374174">i</a></span><span class="op" id="1374204">)</span><span class="op" id="1374205">.</span><span class="ident" id="1374206">String</span><span class="op" id="1374212">(</span><span class="op" id="1374213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374217">default</span><span class="op" id="1374224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374229">var</span>&nbsp;<span class="ident" id="1374233">i</span>&nbsp;<span class="ident" id="1374235">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374244">switch</span>&nbsp;<span class="ident" id="1374251">v</span>&nbsp;<span class="op" id="1374253">:=</span>&nbsp;<span class="ident" id="1374256"><a href="/net/dnsmsg.go.html#1373938">val</a></span><span class="op" id="1374259">.</span><span class="op" id="1374260">(</span><span class="keyword" id="1374261">type</span><span class="op" id="1374265">)</span>&nbsp;<span class="op" id="1374267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374272">default</span><span class="op" id="1374279">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1374285">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374313"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374315">+=</span>&nbsp;<span class="string" id="1374318">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374339">return</span>&nbsp;<span class="builtintype" id="1374346">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374354">case</span>&nbsp;<span class="op" id="1374359">*</span><span class="builtintype" id="1374360">string</span><span class="op" id="1374366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374372"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374374">+=</span>&nbsp;<span class="op" id="1374377">*</span><span class="ident" id="1374378"><a href="/net/dnsmsg.go.html#1374251">v</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374384">return</span>&nbsp;<span class="builtintype" id="1374391">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374399">case</span>&nbsp;<span class="op" id="1374404">[</span><span class="op" id="1374405">]</span><span class="builtintype" id="1374406">byte</span><span class="op" id="1374410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374416"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374418">+=</span>&nbsp;<span class="builtintype" id="1374421">string</span><span class="op" id="1374427">(</span><span class="ident" id="1374428"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374435">return</span>&nbsp;<span class="builtintype" id="1374442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374450">case</span>&nbsp;<span class="op" id="1374455">*</span><span class="builtintype" id="1374456">bool</span><span class="op" id="1374460">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374466">if</span>&nbsp;<span class="op" id="1374469">*</span><span class="ident" id="1374470"><a href="/net/dnsmsg.go.html#1374251">v</a></span>&nbsp;<span class="op" id="1374472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374479"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374481">+=</span>&nbsp;<span class="string" id="1374484">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374495">}</span>&nbsp;<span class="keyword" id="1374497">else</span>&nbsp;<span class="op" id="1374502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374509"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374511">+=</span>&nbsp;<span class="string" id="1374514">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374526">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374532">return</span>&nbsp;<span class="builtintype" id="1374539">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374547">case</span>&nbsp;<span class="op" id="1374552">*</span><span class="builtintype" id="1374553">int</span><span class="op" id="1374556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374562"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374564">=</span>&nbsp;<span class="ident" id="1374566">int64</span><span class="op" id="1374571">(</span><span class="op" id="1374572">*</span><span class="ident" id="1374573"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374579">case</span>&nbsp;<span class="op" id="1374584">*</span><span class="builtintype" id="1374585">uint</span><span class="op" id="1374589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374595"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374597">=</span>&nbsp;<span class="ident" id="1374599">int64</span><span class="op" id="1374604">(</span><span class="op" id="1374605">*</span><span class="ident" id="1374606"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374607">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374612">case</span>&nbsp;<span class="op" id="1374617">*</span><span class="builtintype" id="1374618">uint8</span><span class="op" id="1374623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374629"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374631">=</span>&nbsp;<span class="ident" id="1374633">int64</span><span class="op" id="1374638">(</span><span class="op" id="1374639">*</span><span class="ident" id="1374640"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374646">case</span>&nbsp;<span class="op" id="1374651">*</span><span class="builtintype" id="1374652">uint16</span><span class="op" id="1374658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374664"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374666">=</span>&nbsp;<span class="ident" id="1374668">int64</span><span class="op" id="1374673">(</span><span class="op" id="1374674">*</span><span class="ident" id="1374675"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374681">case</span>&nbsp;<span class="op" id="1374686">*</span><span class="builtintype" id="1374687">uint32</span><span class="op" id="1374693">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374699"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374701">=</span>&nbsp;<span class="ident" id="1374703">int64</span><span class="op" id="1374708">(</span><span class="op" id="1374709">*</span><span class="ident" id="1374710"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374716">case</span>&nbsp;<span class="op" id="1374721">*</span><span class="ident" id="1374722">uint64</span><span class="op" id="1374728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374734"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374736">=</span>&nbsp;<span class="ident" id="1374738">int64</span><span class="op" id="1374743">(</span><span class="op" id="1374744">*</span><span class="ident" id="1374745"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374751">case</span>&nbsp;<span class="op" id="1374756">*</span><span class="builtintype" id="1374757">uintptr</span><span class="op" id="1374764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374770"><a href="/net/dnsmsg.go.html#1374233">i</a></span>&nbsp;<span class="op" id="1374772">=</span>&nbsp;<span class="ident" id="1374774">int64</span><span class="op" id="1374779">(</span><span class="op" id="1374780">*</span><span class="ident" id="1374781"><a href="/net/dnsmsg.go.html#1374251">v</a></span><span class="op" id="1374782">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374792"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374794">+=</span>&nbsp;<span class="ident" id="1374797"><a href="/net/parse.go.html#1479069">itoa</a></span><span class="op" id="1374801">(</span><span class="builtintype" id="1374802">int</span><span class="op" id="1374805">(</span><span class="ident" id="1374806"><a href="/net/dnsmsg.go.html#1374233">i</a></span><span class="op" id="1374807">)</span><span class="op" id="1374808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374816">return</span>&nbsp;<span class="builtintype" id="1374823">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1374829">}</span><span class="op" id="1374830">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1374833"><a href="/net/dnsmsg.go.html#1373906">s</a></span>&nbsp;<span class="op" id="1374835">+=</span>&nbsp;<span class="string" id="1374838">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374843">return</span>&nbsp;<span class="ident" id="1374850"><a href="/net/dnsmsg.go.html#1373906">s</a></span><br>
<span class="lineno"></span><span class="op" id="1374852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1374855">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="1374882">func</span>&nbsp;<span class="ident" id="1374887">packRR</span><span class="op" id="1374893">(</span><span class="ident" id="1374894">rr</span>&nbsp;<span class="ident" id="1374897"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1374902">,</span>&nbsp;<span class="ident" id="1374904">msg</span>&nbsp;<span class="op" id="1374908">[</span><span class="op" id="1374909">]</span><span class="builtintype" id="1374910">byte</span><span class="op" id="1374914">,</span>&nbsp;<span class="ident" id="1374916">off</span>&nbsp;<span class="builtintype" id="1374920">int</span><span class="op" id="1374923">)</span>&nbsp;<span class="op" id="1374925">(</span><span class="ident" id="1374926">off2</span>&nbsp;<span class="builtintype" id="1374931">int</span><span class="op" id="1374934">,</span>&nbsp;<span class="ident" id="1374936">ok</span>&nbsp;<span class="builtintype" id="1374939">bool</span><span class="op" id="1374943">)</span>&nbsp;<span class="op" id="1374945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1374948">var</span>&nbsp;<span class="ident" id="1374952">off1</span>&nbsp;<span class="builtintype" id="1374957">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1374962">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375005">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375042">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375098">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375124">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375146"><a href="/net/dnsmsg.go.html#1374952">off1</a></span><span class="op" id="1375150">,</span>&nbsp;<span class="ident" id="1375152"><a href="/net/dnsmsg.go.html#1374936">ok</a></span>&nbsp;<span class="op" id="1375155">=</span>&nbsp;<span class="ident" id="1375157"><a href="/net/dnsmsg.go.html#1371285">packStruct</a></span><span class="op" id="1375167">(</span><span class="ident" id="1375168"><a href="/net/dnsmsg.go.html#1374894">rr</a></span><span class="op" id="1375170">.</span><span class="ident" id="1375171">Header</span><span class="op" id="1375177">(</span><span class="op" id="1375178">)</span><span class="op" id="1375179">,</span>&nbsp;<span class="ident" id="1375181"><a href="/net/dnsmsg.go.html#1374904">msg</a></span><span class="op" id="1375184">,</span>&nbsp;<span class="ident" id="1375186"><a href="/net/dnsmsg.go.html#1374916">off</a></span><span class="op" id="1375189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375192"><a href="/net/dnsmsg.go.html#1374926">off2</a></span><span class="op" id="1375196">,</span>&nbsp;<span class="ident" id="1375198"><a href="/net/dnsmsg.go.html#1374936">ok</a></span>&nbsp;<span class="op" id="1375201">=</span>&nbsp;<span class="ident" id="1375203"><a href="/net/dnsmsg.go.html#1371285">packStruct</a></span><span class="op" id="1375213">(</span><span class="ident" id="1375214"><a href="/net/dnsmsg.go.html#1374894">rr</a></span><span class="op" id="1375216">,</span>&nbsp;<span class="ident" id="1375218"><a href="/net/dnsmsg.go.html#1374904">msg</a></span><span class="op" id="1375221">,</span>&nbsp;<span class="ident" id="1375223"><a href="/net/dnsmsg.go.html#1374916">off</a></span><span class="op" id="1375226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375229">if</span>&nbsp;<span class="op" id="1375232">!</span><span class="ident" id="1375233"><a href="/net/dnsmsg.go.html#1374936">ok</a></span>&nbsp;<span class="op" id="1375236">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375240">return</span>&nbsp;<span class="builtinfunc" id="1375247">len</span><span class="op" id="1375250">(</span><span class="ident" id="1375251"><a href="/net/dnsmsg.go.html#1374904">msg</a></span><span class="op" id="1375254">)</span><span class="op" id="1375255">,</span>&nbsp;<span class="builtintype" id="1375257">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375267">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375327"><a href="/net/dnsmsg.go.html#1374894">rr</a></span><span class="op" id="1375329">.</span><span class="ident" id="1375330">Header</span><span class="op" id="1375336">(</span><span class="op" id="1375337">)</span><span class="op" id="1375338">.</span><span class="ident" id="1375339">Rdlength</span>&nbsp;<span class="op" id="1375348">=</span>&nbsp;<span class="builtintype" id="1375350">uint16</span><span class="op" id="1375356">(</span><span class="ident" id="1375357"><a href="/net/dnsmsg.go.html#1374926">off2</a></span>&nbsp;<span class="op" id="1375362">-</span>&nbsp;<span class="ident" id="1375364"><a href="/net/dnsmsg.go.html#1374952">off1</a></span><span class="op" id="1375368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375371"><a href="/net/dnsmsg.go.html#1371285">packStruct</a></span><span class="op" id="1375381">(</span><span class="ident" id="1375382"><a href="/net/dnsmsg.go.html#1374894">rr</a></span><span class="op" id="1375384">.</span><span class="ident" id="1375385">Header</span><span class="op" id="1375391">(</span><span class="op" id="1375392">)</span><span class="op" id="1375393">,</span>&nbsp;<span class="ident" id="1375395"><a href="/net/dnsmsg.go.html#1374904">msg</a></span><span class="op" id="1375398">,</span>&nbsp;<span class="ident" id="1375400"><a href="/net/dnsmsg.go.html#1374916">off</a></span><span class="op" id="1375403">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375406">return</span>&nbsp;<span class="ident" id="1375413"><a href="/net/dnsmsg.go.html#1374926">off2</a></span><span class="op" id="1375417">,</span>&nbsp;<span class="builtintype" id="1375419">true</span><br>
<span class="lineno"></span><span class="op" id="1375424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1375427">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="1375456">func</span>&nbsp;<span class="ident" id="1375461">unpackRR</span><span class="op" id="1375469">(</span><span class="ident" id="1375470">msg</span>&nbsp;<span class="op" id="1375474">[</span><span class="op" id="1375475">]</span><span class="builtintype" id="1375476">byte</span><span class="op" id="1375480">,</span>&nbsp;<span class="ident" id="1375482">off</span>&nbsp;<span class="builtintype" id="1375486">int</span><span class="op" id="1375489">)</span>&nbsp;<span class="op" id="1375491">(</span><span class="ident" id="1375492">rr</span>&nbsp;<span class="ident" id="1375495"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1375500">,</span>&nbsp;<span class="ident" id="1375502">off1</span>&nbsp;<span class="builtintype" id="1375507">int</span><span class="op" id="1375510">,</span>&nbsp;<span class="ident" id="1375512">ok</span>&nbsp;<span class="builtintype" id="1375515">bool</span><span class="op" id="1375519">)</span>&nbsp;<span class="op" id="1375521">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375524">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375583">var</span>&nbsp;<span class="ident" id="1375587">h</span>&nbsp;<span class="ident" id="1375589"><a href="/net/dnsmsg.go.html#1362230">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375603">off0</span>&nbsp;<span class="op" id="1375608">:=</span>&nbsp;<span class="ident" id="1375611"><a href="/net/dnsmsg.go.html#1375482">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375616">if</span>&nbsp;<span class="ident" id="1375619"><a href="/net/dnsmsg.go.html#1375482">off</a></span><span class="op" id="1375622">,</span>&nbsp;<span class="ident" id="1375624"><a href="/net/dnsmsg.go.html#1375512">ok</a></span>&nbsp;<span class="op" id="1375627">=</span>&nbsp;<span class="ident" id="1375629"><a href="/net/dnsmsg.go.html#1372554">unpackStruct</a></span><span class="op" id="1375641">(</span><span class="op" id="1375642">&amp;</span><span class="ident" id="1375643"><a href="/net/dnsmsg.go.html#1375587">h</a></span><span class="op" id="1375644">,</span>&nbsp;<span class="ident" id="1375646"><a href="/net/dnsmsg.go.html#1375470">msg</a></span><span class="op" id="1375649">,</span>&nbsp;<span class="ident" id="1375651"><a href="/net/dnsmsg.go.html#1375482">off</a></span><span class="op" id="1375654">)</span><span class="op" id="1375655">;</span>&nbsp;<span class="op" id="1375657">!</span><span class="ident" id="1375658"><a href="/net/dnsmsg.go.html#1375512">ok</a></span>&nbsp;<span class="op" id="1375661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375665">return</span>&nbsp;<span class="ident" id="1375672">nil</span><span class="op" id="1375675">,</span>&nbsp;<span class="builtinfunc" id="1375677">len</span><span class="op" id="1375680">(</span><span class="ident" id="1375681"><a href="/net/dnsmsg.go.html#1375470">msg</a></span><span class="op" id="1375684">)</span><span class="op" id="1375685">,</span>&nbsp;<span class="builtintype" id="1375687">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375697">end</span>&nbsp;<span class="op" id="1375701">:=</span>&nbsp;<span class="ident" id="1375704"><a href="/net/dnsmsg.go.html#1375482">off</a></span>&nbsp;<span class="op" id="1375708">+</span>&nbsp;<span class="builtintype" id="1375710">int</span><span class="op" id="1375713">(</span><span class="ident" id="1375714"><a href="/net/dnsmsg.go.html#1375587">h</a></span><span class="op" id="1375715">.</span><span class="ident" id="1375716">Rdlength</span><span class="op" id="1375724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375728">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1375771">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375822">mk</span><span class="op" id="1375824">,</span>&nbsp;<span class="ident" id="1375826">known</span>&nbsp;<span class="op" id="1375832">:=</span>&nbsp;<span class="ident" id="1375835"><a href="/net/dnsmsg.go.html#1367654">rr_mk</a></span><span class="op" id="1375840">[</span><span class="builtintype" id="1375841">int</span><span class="op" id="1375844">(</span><span class="ident" id="1375845"><a href="/net/dnsmsg.go.html#1375587">h</a></span><span class="op" id="1375846">.</span><span class="ident" id="1375847">Rrtype</span><span class="op" id="1375853">)</span><span class="op" id="1375854">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375857">if</span>&nbsp;<span class="op" id="1375860">!</span><span class="ident" id="1375861"><a href="/net/dnsmsg.go.html#1375826">known</a></span>&nbsp;<span class="op" id="1375867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375871">return</span>&nbsp;<span class="op" id="1375878">&amp;</span><span class="ident" id="1375879"><a href="/net/dnsmsg.go.html#1375587">h</a></span><span class="op" id="1375880">,</span>&nbsp;<span class="ident" id="1375882"><a href="/net/dnsmsg.go.html#1375697">end</a></span><span class="op" id="1375885">,</span>&nbsp;<span class="builtintype" id="1375887">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375896"><a href="/net/dnsmsg.go.html#1375492">rr</a></span>&nbsp;<span class="op" id="1375899">=</span>&nbsp;<span class="ident" id="1375901"><a href="/net/dnsmsg.go.html#1375822">mk</a></span><span class="op" id="1375903">(</span><span class="op" id="1375904">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1375907"><a href="/net/dnsmsg.go.html#1375482">off</a></span><span class="op" id="1375910">,</span>&nbsp;<span class="ident" id="1375912"><a href="/net/dnsmsg.go.html#1375512">ok</a></span>&nbsp;<span class="op" id="1375915">=</span>&nbsp;<span class="ident" id="1375917"><a href="/net/dnsmsg.go.html#1372554">unpackStruct</a></span><span class="op" id="1375929">(</span><span class="ident" id="1375930"><a href="/net/dnsmsg.go.html#1375492">rr</a></span><span class="op" id="1375932">,</span>&nbsp;<span class="ident" id="1375934"><a href="/net/dnsmsg.go.html#1375470">msg</a></span><span class="op" id="1375937">,</span>&nbsp;<span class="ident" id="1375939"><a href="/net/dnsmsg.go.html#1375603">off0</a></span><span class="op" id="1375943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375946">if</span>&nbsp;<span class="ident" id="1375949"><a href="/net/dnsmsg.go.html#1375482">off</a></span>&nbsp;<span class="op" id="1375953">!=</span>&nbsp;<span class="ident" id="1375956"><a href="/net/dnsmsg.go.html#1375697">end</a></span>&nbsp;<span class="op" id="1375960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375964">return</span>&nbsp;<span class="op" id="1375971">&amp;</span><span class="ident" id="1375972"><a href="/net/dnsmsg.go.html#1375587">h</a></span><span class="op" id="1375973">,</span>&nbsp;<span class="ident" id="1375975"><a href="/net/dnsmsg.go.html#1375697">end</a></span><span class="op" id="1375978">,</span>&nbsp;<span class="builtintype" id="1375980">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1375986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1375989">return</span>&nbsp;<span class="ident" id="1375996"><a href="/net/dnsmsg.go.html#1375492">rr</a></span><span class="op" id="1375998">,</span>&nbsp;<span class="ident" id="1376000"><a href="/net/dnsmsg.go.html#1375482">off</a></span><span class="op" id="1376003">,</span>&nbsp;<span class="ident" id="1376005"><a href="/net/dnsmsg.go.html#1375512">ok</a></span><br>
<span class="lineno">710</span><span class="op" id="1376008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376011">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376054">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="1376100">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="1376148">type</span>&nbsp;<span class="ident" id="1376153">dnsMsgHdr</span>&nbsp;<span class="keyword" id="1376163">struct</span>&nbsp;<span class="op" id="1376170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376173">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376193">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376201">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376221">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376227">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376247">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376252">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376272">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376278">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376298">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376304">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376324">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376330">recursion_available</span>&nbsp;<span class="builtintype" id="1376350">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376356">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1376376">int</span><br>
<span class="lineno">725</span><span class="op" id="1376380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1376383">func</span>&nbsp;<span class="op" id="1376388">(</span><span class="ident" id="1376389">h</span>&nbsp;<span class="op" id="1376391">*</span><span class="ident" id="1376392"><a href="/net/dnsmsg.go.html#1376153">dnsMsgHdr</a></span><span class="op" id="1376401">)</span>&nbsp;<span class="ident" id="1376403">Walk</span><span class="op" id="1376407">(</span><span class="ident" id="1376408">f</span>&nbsp;<span class="keyword" id="1376410">func</span><span class="op" id="1376414">(</span><span class="ident" id="1376415">v</span>&nbsp;<span class="keyword" id="1376417">interface</span><span class="op" id="1376426">{</span><span class="op" id="1376427">}</span><span class="op" id="1376428">,</span>&nbsp;<span class="ident" id="1376430">name</span><span class="op" id="1376434">,</span>&nbsp;<span class="ident" id="1376436">tag</span>&nbsp;<span class="builtintype" id="1376440">string</span><span class="op" id="1376446">)</span>&nbsp;<span class="builtintype" id="1376448">bool</span><span class="op" id="1376452">)</span>&nbsp;<span class="builtintype" id="1376454">bool</span>&nbsp;<span class="op" id="1376459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376462">return</span>&nbsp;<span class="ident" id="1376469"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376470">(</span><span class="op" id="1376471">&amp;</span><span class="ident" id="1376472"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376473">.</span><span class="ident" id="1376474">id</span><span class="op" id="1376476">,</span>&nbsp;<span class="string" id="1376478">&#34;id&#34;</span><span class="op" id="1376482">,</span>&nbsp;<span class="string" id="1376484">&#34;&#34;</span><span class="op" id="1376486">)</span>&nbsp;<span class="op" id="1376488">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376493"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376494">(</span><span class="op" id="1376495">&amp;</span><span class="ident" id="1376496"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376497">.</span><span class="ident" id="1376498">response</span><span class="op" id="1376506">,</span>&nbsp;<span class="string" id="1376508">&#34;response&#34;</span><span class="op" id="1376518">,</span>&nbsp;<span class="string" id="1376520">&#34;&#34;</span><span class="op" id="1376522">)</span>&nbsp;<span class="op" id="1376524">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376529"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376530">(</span><span class="op" id="1376531">&amp;</span><span class="ident" id="1376532"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376533">.</span><span class="ident" id="1376534">opcode</span><span class="op" id="1376540">,</span>&nbsp;<span class="string" id="1376542">&#34;opcode&#34;</span><span class="op" id="1376550">,</span>&nbsp;<span class="string" id="1376552">&#34;&#34;</span><span class="op" id="1376554">)</span>&nbsp;<span class="op" id="1376556">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376561"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376562">(</span><span class="op" id="1376563">&amp;</span><span class="ident" id="1376564"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376565">.</span><span class="ident" id="1376566">authoritative</span><span class="op" id="1376579">,</span>&nbsp;<span class="string" id="1376581">&#34;authoritative&#34;</span><span class="op" id="1376596">,</span>&nbsp;<span class="string" id="1376598">&#34;&#34;</span><span class="op" id="1376600">)</span>&nbsp;<span class="op" id="1376602">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376607"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376608">(</span><span class="op" id="1376609">&amp;</span><span class="ident" id="1376610"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376611">.</span><span class="ident" id="1376612">truncated</span><span class="op" id="1376621">,</span>&nbsp;<span class="string" id="1376623">&#34;truncated&#34;</span><span class="op" id="1376634">,</span>&nbsp;<span class="string" id="1376636">&#34;&#34;</span><span class="op" id="1376638">)</span>&nbsp;<span class="op" id="1376640">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376645"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376646">(</span><span class="op" id="1376647">&amp;</span><span class="ident" id="1376648"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376649">.</span><span class="ident" id="1376650">recursion_desired</span><span class="op" id="1376667">,</span>&nbsp;<span class="string" id="1376669">&#34;recursion_desired&#34;</span><span class="op" id="1376688">,</span>&nbsp;<span class="string" id="1376690">&#34;&#34;</span><span class="op" id="1376692">)</span>&nbsp;<span class="op" id="1376694">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376699"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376700">(</span><span class="op" id="1376701">&amp;</span><span class="ident" id="1376702"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376703">.</span><span class="ident" id="1376704">recursion_available</span><span class="op" id="1376723">,</span>&nbsp;<span class="string" id="1376725">&#34;recursion_available&#34;</span><span class="op" id="1376746">,</span>&nbsp;<span class="string" id="1376748">&#34;&#34;</span><span class="op" id="1376750">)</span>&nbsp;<span class="op" id="1376752">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376757"><a href="/net/dnsmsg.go.html#1376408">f</a></span><span class="op" id="1376758">(</span><span class="op" id="1376759">&amp;</span><span class="ident" id="1376760"><a href="/net/dnsmsg.go.html#1376389">h</a></span><span class="op" id="1376761">.</span><span class="ident" id="1376762">rcode</span><span class="op" id="1376767">,</span>&nbsp;<span class="string" id="1376769">&#34;rcode&#34;</span><span class="op" id="1376776">,</span>&nbsp;<span class="string" id="1376778">&#34;&#34;</span><span class="op" id="1376780">)</span><br>
<span class="lineno"></span><span class="op" id="1376782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1376785">type</span>&nbsp;<span class="ident" id="1376790">dnsMsg</span>&nbsp;<span class="keyword" id="1376797">struct</span>&nbsp;<span class="op" id="1376804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376807"><a href="/net/dnsmsg.go.html#1376153">dnsMsgHdr</a></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376818">question</span>&nbsp;<span class="op" id="1376827">[</span><span class="op" id="1376828">]</span><span class="ident" id="1376829"><a href="/net/dnsmsg.go.html#1361780">dnsQuestion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376842">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1376851">[</span><span class="op" id="1376852">]</span><span class="ident" id="1376853"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376860">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1376869">[</span><span class="op" id="1376870">]</span><span class="ident" id="1376871"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1376878">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1376887">[</span><span class="op" id="1376888">]</span><span class="ident" id="1376889"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><br>
<span class="lineno"></span><span class="op" id="1376895">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="1376898">func</span>&nbsp;<span class="op" id="1376903">(</span><span class="ident" id="1376904">dns</span>&nbsp;<span class="op" id="1376908">*</span><span class="ident" id="1376909"><a href="/net/dnsmsg.go.html#1376790">dnsMsg</a></span><span class="op" id="1376915">)</span>&nbsp;<span class="ident" id="1376917">Pack</span><span class="op" id="1376921">(</span><span class="op" id="1376922">)</span>&nbsp;<span class="op" id="1376924">(</span><span class="ident" id="1376925">msg</span>&nbsp;<span class="op" id="1376929">[</span><span class="op" id="1376930">]</span><span class="builtintype" id="1376931">byte</span><span class="op" id="1376935">,</span>&nbsp;<span class="ident" id="1376937">ok</span>&nbsp;<span class="builtintype" id="1376940">bool</span><span class="op" id="1376944">)</span>&nbsp;<span class="op" id="1376946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1376949">var</span>&nbsp;<span class="ident" id="1376953">dh</span>&nbsp;<span class="ident" id="1376956"><a href="/net/dnsmsg.go.html#1361126">dnsHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1376968">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377024"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377026">.</span><span class="ident" id="1377027">Id</span>&nbsp;<span class="op" id="1377030">=</span>&nbsp;<span class="ident" id="1377032"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377035">.</span><span class="ident" id="1377036">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377040"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377042">.</span><span class="ident" id="1377043">Bits</span>&nbsp;<span class="op" id="1377048">=</span>&nbsp;<span class="builtintype" id="1377050">uint16</span><span class="op" id="1377056">(</span><span class="ident" id="1377057"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377060">.</span><span class="ident" id="1377061">opcode</span><span class="op" id="1377067">)</span><span class="op" id="1377068">&lt;&lt;</span><span class="num" id="1377070">11</span>&nbsp;<span class="op" id="1377073">|</span>&nbsp;<span class="builtintype" id="1377075">uint16</span><span class="op" id="1377081">(</span><span class="ident" id="1377082"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377085">.</span><span class="ident" id="1377086">rcode</span><span class="op" id="1377091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377094">if</span>&nbsp;<span class="ident" id="1377097"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377100">.</span><span class="ident" id="1377101">recursion_available</span>&nbsp;<span class="op" id="1377121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377125"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377127">.</span><span class="ident" id="1377128">Bits</span>&nbsp;<span class="op" id="1377133">|=</span>&nbsp;<span class="ident" id="1377136"><a href="/net/dnsmsg.go.html#1361719">_RA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377141">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377144">if</span>&nbsp;<span class="ident" id="1377147"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377150">.</span><span class="ident" id="1377151">recursion_desired</span>&nbsp;<span class="op" id="1377169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377173"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377175">.</span><span class="ident" id="1377176">Bits</span>&nbsp;<span class="op" id="1377181">|=</span>&nbsp;<span class="ident" id="1377184"><a href="/net/dnsmsg.go.html#1361683">_RD</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377192">if</span>&nbsp;<span class="ident" id="1377195"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377198">.</span><span class="ident" id="1377199">truncated</span>&nbsp;<span class="op" id="1377209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377213"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377215">.</span><span class="ident" id="1377216">Bits</span>&nbsp;<span class="op" id="1377221">|=</span>&nbsp;<span class="ident" id="1377224"><a href="/net/dnsmsg.go.html#1361655">_TC</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377232">if</span>&nbsp;<span class="ident" id="1377235"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377238">.</span><span class="ident" id="1377239">authoritative</span>&nbsp;<span class="op" id="1377253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377257"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377259">.</span><span class="ident" id="1377260">Bits</span>&nbsp;<span class="op" id="1377265">|=</span>&nbsp;<span class="ident" id="1377268"><a href="/net/dnsmsg.go.html#1361623">_AA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377276">if</span>&nbsp;<span class="ident" id="1377279"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377282">.</span><span class="ident" id="1377283">response</span>&nbsp;<span class="op" id="1377292">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377296"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377298">.</span><span class="ident" id="1377299">Bits</span>&nbsp;<span class="op" id="1377304">|=</span>&nbsp;<span class="ident" id="1377307"><a href="/net/dnsmsg.go.html#1361577">_QR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1377316">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377351">question</span>&nbsp;<span class="op" id="1377360">:=</span>&nbsp;<span class="ident" id="1377363"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377366">.</span><span class="ident" id="1377367">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377377">answer</span>&nbsp;<span class="op" id="1377384">:=</span>&nbsp;<span class="ident" id="1377387"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377390">.</span><span class="ident" id="1377391">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377399">ns</span>&nbsp;<span class="op" id="1377402">:=</span>&nbsp;<span class="ident" id="1377405"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377408">.</span><span class="ident" id="1377409">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377413">extra</span>&nbsp;<span class="op" id="1377419">:=</span>&nbsp;<span class="ident" id="1377422"><a href="/net/dnsmsg.go.html#1376904">dns</a></span><span class="op" id="1377425">.</span><span class="ident" id="1377426">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377434"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377436">.</span><span class="ident" id="1377437">Qdcount</span>&nbsp;<span class="op" id="1377445">=</span>&nbsp;<span class="builtintype" id="1377447">uint16</span><span class="op" id="1377453">(</span><span class="builtinfunc" id="1377454">len</span><span class="op" id="1377457">(</span><span class="ident" id="1377458"><a href="/net/dnsmsg.go.html#1377351">question</a></span><span class="op" id="1377466">)</span><span class="op" id="1377467">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377470"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377472">.</span><span class="ident" id="1377473">Ancount</span>&nbsp;<span class="op" id="1377481">=</span>&nbsp;<span class="builtintype" id="1377483">uint16</span><span class="op" id="1377489">(</span><span class="builtinfunc" id="1377490">len</span><span class="op" id="1377493">(</span><span class="ident" id="1377494"><a href="/net/dnsmsg.go.html#1377377">answer</a></span><span class="op" id="1377500">)</span><span class="op" id="1377501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377504"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377506">.</span><span class="ident" id="1377507">Nscount</span>&nbsp;<span class="op" id="1377515">=</span>&nbsp;<span class="builtintype" id="1377517">uint16</span><span class="op" id="1377523">(</span><span class="builtinfunc" id="1377524">len</span><span class="op" id="1377527">(</span><span class="ident" id="1377528"><a href="/net/dnsmsg.go.html#1377399">ns</a></span><span class="op" id="1377530">)</span><span class="op" id="1377531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377534"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377536">.</span><span class="ident" id="1377537">Arcount</span>&nbsp;<span class="op" id="1377545">=</span>&nbsp;<span class="builtintype" id="1377547">uint16</span><span class="op" id="1377553">(</span><span class="builtinfunc" id="1377554">len</span><span class="op" id="1377557">(</span><span class="ident" id="1377558"><a href="/net/dnsmsg.go.html#1377413">extra</a></span><span class="op" id="1377563">)</span><span class="op" id="1377564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1377568">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1377617">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1377663">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377701"><a href="/net/dnsmsg.go.html#1376925">msg</a></span>&nbsp;<span class="op" id="1377705">=</span>&nbsp;<span class="builtinfunc" id="1377707">make</span><span class="op" id="1377711">(</span><span class="op" id="1377712">[</span><span class="op" id="1377713">]</span><span class="builtintype" id="1377714">byte</span><span class="op" id="1377718">,</span>&nbsp;<span class="num" id="1377720">2000</span><span class="op" id="1377724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1377728">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377772">off</span>&nbsp;<span class="op" id="1377776">:=</span>&nbsp;<span class="num" id="1377779">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377782"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377785">,</span>&nbsp;<span class="ident" id="1377787"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1377790">=</span>&nbsp;<span class="ident" id="1377792"><a href="/net/dnsmsg.go.html#1371285">packStruct</a></span><span class="op" id="1377802">(</span><span class="op" id="1377803">&amp;</span><span class="ident" id="1377804"><a href="/net/dnsmsg.go.html#1376953">dh</a></span><span class="op" id="1377806">,</span>&nbsp;<span class="ident" id="1377808"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1377811">,</span>&nbsp;<span class="ident" id="1377813"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377819">for</span>&nbsp;<span class="ident" id="1377823">i</span>&nbsp;<span class="op" id="1377825">:=</span>&nbsp;<span class="num" id="1377828">0</span><span class="op" id="1377829">;</span>&nbsp;<span class="ident" id="1377831"><a href="/net/dnsmsg.go.html#1377823">i</a></span>&nbsp;<span class="op" id="1377833">&lt;</span>&nbsp;<span class="builtinfunc" id="1377835">len</span><span class="op" id="1377838">(</span><span class="ident" id="1377839"><a href="/net/dnsmsg.go.html#1377351">question</a></span><span class="op" id="1377847">)</span><span class="op" id="1377848">;</span>&nbsp;<span class="ident" id="1377850"><a href="/net/dnsmsg.go.html#1377823">i</a></span><span class="op" id="1377851">++</span>&nbsp;<span class="op" id="1377854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377858"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377861">,</span>&nbsp;<span class="ident" id="1377863"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1377866">=</span>&nbsp;<span class="ident" id="1377868"><a href="/net/dnsmsg.go.html#1371285">packStruct</a></span><span class="op" id="1377878">(</span><span class="op" id="1377879">&amp;</span><span class="ident" id="1377880"><a href="/net/dnsmsg.go.html#1377351">question</a></span><span class="op" id="1377888">[</span><span class="ident" id="1377889"><a href="/net/dnsmsg.go.html#1377823">i</a></span><span class="op" id="1377890">]</span><span class="op" id="1377891">,</span>&nbsp;<span class="ident" id="1377893"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1377896">,</span>&nbsp;<span class="ident" id="1377898"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377904">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377907">for</span>&nbsp;<span class="ident" id="1377911">i</span>&nbsp;<span class="op" id="1377913">:=</span>&nbsp;<span class="num" id="1377916">0</span><span class="op" id="1377917">;</span>&nbsp;<span class="ident" id="1377919"><a href="/net/dnsmsg.go.html#1377911">i</a></span>&nbsp;<span class="op" id="1377921">&lt;</span>&nbsp;<span class="builtinfunc" id="1377923">len</span><span class="op" id="1377926">(</span><span class="ident" id="1377927"><a href="/net/dnsmsg.go.html#1377377">answer</a></span><span class="op" id="1377933">)</span><span class="op" id="1377934">;</span>&nbsp;<span class="ident" id="1377936"><a href="/net/dnsmsg.go.html#1377911">i</a></span><span class="op" id="1377937">++</span>&nbsp;<span class="op" id="1377940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377944"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377947">,</span>&nbsp;<span class="ident" id="1377949"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1377952">=</span>&nbsp;<span class="ident" id="1377954"><a href="/net/dnsmsg.go.html#1374887">packRR</a></span><span class="op" id="1377960">(</span><span class="ident" id="1377961"><a href="/net/dnsmsg.go.html#1377377">answer</a></span><span class="op" id="1377967">[</span><span class="ident" id="1377968"><a href="/net/dnsmsg.go.html#1377911">i</a></span><span class="op" id="1377969">]</span><span class="op" id="1377970">,</span>&nbsp;<span class="ident" id="1377972"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1377975">,</span>&nbsp;<span class="ident" id="1377977"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1377980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1377983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1377986">for</span>&nbsp;<span class="ident" id="1377990">i</span>&nbsp;<span class="op" id="1377992">:=</span>&nbsp;<span class="num" id="1377995">0</span><span class="op" id="1377996">;</span>&nbsp;<span class="ident" id="1377998"><a href="/net/dnsmsg.go.html#1377990">i</a></span>&nbsp;<span class="op" id="1378000">&lt;</span>&nbsp;<span class="builtinfunc" id="1378002">len</span><span class="op" id="1378005">(</span><span class="ident" id="1378006"><a href="/net/dnsmsg.go.html#1377399">ns</a></span><span class="op" id="1378008">)</span><span class="op" id="1378009">;</span>&nbsp;<span class="ident" id="1378011"><a href="/net/dnsmsg.go.html#1377990">i</a></span><span class="op" id="1378012">++</span>&nbsp;<span class="op" id="1378015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378019"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1378022">,</span>&nbsp;<span class="ident" id="1378024"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1378027">=</span>&nbsp;<span class="ident" id="1378029"><a href="/net/dnsmsg.go.html#1374887">packRR</a></span><span class="op" id="1378035">(</span><span class="ident" id="1378036"><a href="/net/dnsmsg.go.html#1377399">ns</a></span><span class="op" id="1378038">[</span><span class="ident" id="1378039"><a href="/net/dnsmsg.go.html#1377990">i</a></span><span class="op" id="1378040">]</span><span class="op" id="1378041">,</span>&nbsp;<span class="ident" id="1378043"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1378046">,</span>&nbsp;<span class="ident" id="1378048"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1378051">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378057">for</span>&nbsp;<span class="ident" id="1378061">i</span>&nbsp;<span class="op" id="1378063">:=</span>&nbsp;<span class="num" id="1378066">0</span><span class="op" id="1378067">;</span>&nbsp;<span class="ident" id="1378069"><a href="/net/dnsmsg.go.html#1378061">i</a></span>&nbsp;<span class="op" id="1378071">&lt;</span>&nbsp;<span class="builtinfunc" id="1378073">len</span><span class="op" id="1378076">(</span><span class="ident" id="1378077"><a href="/net/dnsmsg.go.html#1377413">extra</a></span><span class="op" id="1378082">)</span><span class="op" id="1378083">;</span>&nbsp;<span class="ident" id="1378085"><a href="/net/dnsmsg.go.html#1378061">i</a></span><span class="op" id="1378086">++</span>&nbsp;<span class="op" id="1378089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378093"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1378096">,</span>&nbsp;<span class="ident" id="1378098"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1378101">=</span>&nbsp;<span class="ident" id="1378103"><a href="/net/dnsmsg.go.html#1374887">packRR</a></span><span class="op" id="1378109">(</span><span class="ident" id="1378110"><a href="/net/dnsmsg.go.html#1377413">extra</a></span><span class="op" id="1378115">[</span><span class="ident" id="1378116"><a href="/net/dnsmsg.go.html#1378061">i</a></span><span class="op" id="1378117">]</span><span class="op" id="1378118">,</span>&nbsp;<span class="ident" id="1378120"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1378123">,</span>&nbsp;<span class="ident" id="1378125"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1378128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378134">if</span>&nbsp;<span class="op" id="1378137">!</span><span class="ident" id="1378138"><a href="/net/dnsmsg.go.html#1376937">ok</a></span>&nbsp;<span class="op" id="1378141">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378145">return</span>&nbsp;<span class="ident" id="1378152">nil</span><span class="op" id="1378155">,</span>&nbsp;<span class="builtintype" id="1378157">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378167">return</span>&nbsp;<span class="ident" id="1378174"><a href="/net/dnsmsg.go.html#1376925">msg</a></span><span class="op" id="1378177">[</span><span class="num" id="1378178">0</span><span class="op" id="1378179">:</span><span class="ident" id="1378180"><a href="/net/dnsmsg.go.html#1377772">off</a></span><span class="op" id="1378183">]</span><span class="op" id="1378184">,</span>&nbsp;<span class="builtintype" id="1378186">true</span><br>
<span class="lineno"></span><span class="op" id="1378191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="1378194">func</span>&nbsp;<span class="op" id="1378199">(</span><span class="ident" id="1378200">dns</span>&nbsp;<span class="op" id="1378204">*</span><span class="ident" id="1378205"><a href="/net/dnsmsg.go.html#1376790">dnsMsg</a></span><span class="op" id="1378211">)</span>&nbsp;<span class="ident" id="1378213">Unpack</span><span class="op" id="1378219">(</span><span class="ident" id="1378220">msg</span>&nbsp;<span class="op" id="1378224">[</span><span class="op" id="1378225">]</span><span class="builtintype" id="1378226">byte</span><span class="op" id="1378230">)</span>&nbsp;<span class="builtintype" id="1378232">bool</span>&nbsp;<span class="op" id="1378237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1378240">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378252">var</span>&nbsp;<span class="ident" id="1378256">dh</span>&nbsp;<span class="ident" id="1378259"><a href="/net/dnsmsg.go.html#1361126">dnsHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378270">off</span>&nbsp;<span class="op" id="1378274">:=</span>&nbsp;<span class="num" id="1378277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378280">var</span>&nbsp;<span class="ident" id="1378284">ok</span>&nbsp;<span class="builtintype" id="1378287">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378293">if</span>&nbsp;<span class="ident" id="1378296"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1378299">,</span>&nbsp;<span class="ident" id="1378301"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1378304">=</span>&nbsp;<span class="ident" id="1378306"><a href="/net/dnsmsg.go.html#1372554">unpackStruct</a></span><span class="op" id="1378318">(</span><span class="op" id="1378319">&amp;</span><span class="ident" id="1378320"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378322">,</span>&nbsp;<span class="ident" id="1378324"><a href="/net/dnsmsg.go.html#1378220">msg</a></span><span class="op" id="1378327">,</span>&nbsp;<span class="ident" id="1378329"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1378332">)</span><span class="op" id="1378333">;</span>&nbsp;<span class="op" id="1378335">!</span><span class="ident" id="1378336"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1378339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378343">return</span>&nbsp;<span class="builtintype" id="1378350">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378360"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378363">.</span><span class="ident" id="1378364">id</span>&nbsp;<span class="op" id="1378367">=</span>&nbsp;<span class="ident" id="1378369"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378371">.</span><span class="ident" id="1378372">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378376"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378379">.</span><span class="ident" id="1378380">response</span>&nbsp;<span class="op" id="1378389">=</span>&nbsp;<span class="op" id="1378391">(</span><span class="ident" id="1378392"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378394">.</span><span class="ident" id="1378395">Bits</span>&nbsp;<span class="op" id="1378400">&amp;</span>&nbsp;<span class="ident" id="1378402"><a href="/net/dnsmsg.go.html#1361577">_QR</a></span><span class="op" id="1378405">)</span>&nbsp;<span class="op" id="1378407">!=</span>&nbsp;<span class="num" id="1378410">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378413"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378416">.</span><span class="ident" id="1378417">opcode</span>&nbsp;<span class="op" id="1378424">=</span>&nbsp;<span class="builtintype" id="1378426">int</span><span class="op" id="1378429">(</span><span class="ident" id="1378430"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378432">.</span><span class="ident" id="1378433">Bits</span><span class="op" id="1378437">&gt;&gt;</span><span class="num" id="1378439">11</span><span class="op" id="1378441">)</span>&nbsp;<span class="op" id="1378443">&amp;</span>&nbsp;<span class="num" id="1378445">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378450"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378453">.</span><span class="ident" id="1378454">authoritative</span>&nbsp;<span class="op" id="1378468">=</span>&nbsp;<span class="op" id="1378470">(</span><span class="ident" id="1378471"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378473">.</span><span class="ident" id="1378474">Bits</span>&nbsp;<span class="op" id="1378479">&amp;</span>&nbsp;<span class="ident" id="1378481"><a href="/net/dnsmsg.go.html#1361623">_AA</a></span><span class="op" id="1378484">)</span>&nbsp;<span class="op" id="1378486">!=</span>&nbsp;<span class="num" id="1378489">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378492"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378495">.</span><span class="ident" id="1378496">truncated</span>&nbsp;<span class="op" id="1378506">=</span>&nbsp;<span class="op" id="1378508">(</span><span class="ident" id="1378509"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378511">.</span><span class="ident" id="1378512">Bits</span>&nbsp;<span class="op" id="1378517">&amp;</span>&nbsp;<span class="ident" id="1378519"><a href="/net/dnsmsg.go.html#1361655">_TC</a></span><span class="op" id="1378522">)</span>&nbsp;<span class="op" id="1378524">!=</span>&nbsp;<span class="num" id="1378527">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378530"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378533">.</span><span class="ident" id="1378534">recursion_desired</span>&nbsp;<span class="op" id="1378552">=</span>&nbsp;<span class="op" id="1378554">(</span><span class="ident" id="1378555"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378557">.</span><span class="ident" id="1378558">Bits</span>&nbsp;<span class="op" id="1378563">&amp;</span>&nbsp;<span class="ident" id="1378565"><a href="/net/dnsmsg.go.html#1361683">_RD</a></span><span class="op" id="1378568">)</span>&nbsp;<span class="op" id="1378570">!=</span>&nbsp;<span class="num" id="1378573">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378576"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378579">.</span><span class="ident" id="1378580">recursion_available</span>&nbsp;<span class="op" id="1378600">=</span>&nbsp;<span class="op" id="1378602">(</span><span class="ident" id="1378603"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378605">.</span><span class="ident" id="1378606">Bits</span>&nbsp;<span class="op" id="1378611">&amp;</span>&nbsp;<span class="ident" id="1378613"><a href="/net/dnsmsg.go.html#1361719">_RA</a></span><span class="op" id="1378616">)</span>&nbsp;<span class="op" id="1378618">!=</span>&nbsp;<span class="num" id="1378621">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378624"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378627">.</span><span class="ident" id="1378628">rcode</span>&nbsp;<span class="op" id="1378634">=</span>&nbsp;<span class="builtintype" id="1378636">int</span><span class="op" id="1378639">(</span><span class="ident" id="1378640"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378642">.</span><span class="ident" id="1378643">Bits</span>&nbsp;<span class="op" id="1378648">&amp;</span>&nbsp;<span class="num" id="1378650">0xF</span><span class="op" id="1378653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1378657">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378669"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378672">.</span><span class="ident" id="1378673">question</span>&nbsp;<span class="op" id="1378682">=</span>&nbsp;<span class="builtinfunc" id="1378684">make</span><span class="op" id="1378688">(</span><span class="op" id="1378689">[</span><span class="op" id="1378690">]</span><span class="ident" id="1378691"><a href="/net/dnsmsg.go.html#1361780">dnsQuestion</a></span><span class="op" id="1378702">,</span>&nbsp;<span class="ident" id="1378704"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378706">.</span><span class="ident" id="1378707">Qdcount</span><span class="op" id="1378714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378717"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378720">.</span><span class="ident" id="1378721">answer</span>&nbsp;<span class="op" id="1378728">=</span>&nbsp;<span class="builtinfunc" id="1378730">make</span><span class="op" id="1378734">(</span><span class="op" id="1378735">[</span><span class="op" id="1378736">]</span><span class="ident" id="1378737"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1378742">,</span>&nbsp;<span class="num" id="1378744">0</span><span class="op" id="1378745">,</span>&nbsp;<span class="ident" id="1378747"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378749">.</span><span class="ident" id="1378750">Ancount</span><span class="op" id="1378757">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378760"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378763">.</span><span class="ident" id="1378764">ns</span>&nbsp;<span class="op" id="1378767">=</span>&nbsp;<span class="builtinfunc" id="1378769">make</span><span class="op" id="1378773">(</span><span class="op" id="1378774">[</span><span class="op" id="1378775">]</span><span class="ident" id="1378776"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1378781">,</span>&nbsp;<span class="num" id="1378783">0</span><span class="op" id="1378784">,</span>&nbsp;<span class="ident" id="1378786"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378788">.</span><span class="ident" id="1378789">Nscount</span><span class="op" id="1378796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378799"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378802">.</span><span class="ident" id="1378803">extra</span>&nbsp;<span class="op" id="1378809">=</span>&nbsp;<span class="builtinfunc" id="1378811">make</span><span class="op" id="1378815">(</span><span class="op" id="1378816">[</span><span class="op" id="1378817">]</span><span class="ident" id="1378818"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><span class="op" id="1378823">,</span>&nbsp;<span class="num" id="1378825">0</span><span class="op" id="1378826">,</span>&nbsp;<span class="ident" id="1378828"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378830">.</span><span class="ident" id="1378831">Arcount</span><span class="op" id="1378838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378842">var</span>&nbsp;<span class="ident" id="1378846">rec</span>&nbsp;<span class="ident" id="1378850"><a href="/net/dnsmsg.go.html#1362702">dnsRR</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378858">for</span>&nbsp;<span class="ident" id="1378862">i</span>&nbsp;<span class="op" id="1378864">:=</span>&nbsp;<span class="num" id="1378867">0</span><span class="op" id="1378868">;</span>&nbsp;<span class="ident" id="1378870"><a href="/net/dnsmsg.go.html#1378862">i</a></span>&nbsp;<span class="op" id="1378872">&lt;</span>&nbsp;<span class="builtinfunc" id="1378874">len</span><span class="op" id="1378877">(</span><span class="ident" id="1378878"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378881">.</span><span class="ident" id="1378882">question</span><span class="op" id="1378890">)</span><span class="op" id="1378891">;</span>&nbsp;<span class="ident" id="1378893"><a href="/net/dnsmsg.go.html#1378862">i</a></span><span class="op" id="1378894">++</span>&nbsp;<span class="op" id="1378897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378901"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1378904">,</span>&nbsp;<span class="ident" id="1378906"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1378909">=</span>&nbsp;<span class="ident" id="1378911"><a href="/net/dnsmsg.go.html#1372554">unpackStruct</a></span><span class="op" id="1378923">(</span><span class="op" id="1378924">&amp;</span><span class="ident" id="1378925"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1378928">.</span><span class="ident" id="1378929">question</span><span class="op" id="1378937">[</span><span class="ident" id="1378938"><a href="/net/dnsmsg.go.html#1378862">i</a></span><span class="op" id="1378939">]</span><span class="op" id="1378940">,</span>&nbsp;<span class="ident" id="1378942"><a href="/net/dnsmsg.go.html#1378220">msg</a></span><span class="op" id="1378945">,</span>&nbsp;<span class="ident" id="1378947"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1378950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1378953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1378956">for</span>&nbsp;<span class="ident" id="1378960">i</span>&nbsp;<span class="op" id="1378962">:=</span>&nbsp;<span class="num" id="1378965">0</span><span class="op" id="1378966">;</span>&nbsp;<span class="ident" id="1378968"><a href="/net/dnsmsg.go.html#1378960">i</a></span>&nbsp;<span class="op" id="1378970">&lt;</span>&nbsp;<span class="builtintype" id="1378972">int</span><span class="op" id="1378975">(</span><span class="ident" id="1378976"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1378978">.</span><span class="ident" id="1378979">Ancount</span><span class="op" id="1378986">)</span><span class="op" id="1378987">;</span>&nbsp;<span class="ident" id="1378989"><a href="/net/dnsmsg.go.html#1378960">i</a></span><span class="op" id="1378990">++</span>&nbsp;<span class="op" id="1378993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378997"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379000">,</span>&nbsp;<span class="ident" id="1379002"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379005">,</span>&nbsp;<span class="ident" id="1379007"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379010">=</span>&nbsp;<span class="ident" id="1379012"><a href="/net/dnsmsg.go.html#1375461">unpackRR</a></span><span class="op" id="1379020">(</span><span class="ident" id="1379021"><a href="/net/dnsmsg.go.html#1378220">msg</a></span><span class="op" id="1379024">,</span>&nbsp;<span class="ident" id="1379026"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379029">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379033">if</span>&nbsp;<span class="op" id="1379036">!</span><span class="ident" id="1379037"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379045">return</span>&nbsp;<span class="builtintype" id="1379052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379064"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379067">.</span><span class="ident" id="1379068">answer</span>&nbsp;<span class="op" id="1379075">=</span>&nbsp;<span class="builtinfunc" id="1379077">append</span><span class="op" id="1379083">(</span><span class="ident" id="1379084"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379087">.</span><span class="ident" id="1379088">answer</span><span class="op" id="1379094">,</span>&nbsp;<span class="ident" id="1379096"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379102">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379105">for</span>&nbsp;<span class="ident" id="1379109">i</span>&nbsp;<span class="op" id="1379111">:=</span>&nbsp;<span class="num" id="1379114">0</span><span class="op" id="1379115">;</span>&nbsp;<span class="ident" id="1379117"><a href="/net/dnsmsg.go.html#1379109">i</a></span>&nbsp;<span class="op" id="1379119">&lt;</span>&nbsp;<span class="builtintype" id="1379121">int</span><span class="op" id="1379124">(</span><span class="ident" id="1379125"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1379127">.</span><span class="ident" id="1379128">Nscount</span><span class="op" id="1379135">)</span><span class="op" id="1379136">;</span>&nbsp;<span class="ident" id="1379138"><a href="/net/dnsmsg.go.html#1379109">i</a></span><span class="op" id="1379139">++</span>&nbsp;<span class="op" id="1379142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379146"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379149">,</span>&nbsp;<span class="ident" id="1379151"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379154">,</span>&nbsp;<span class="ident" id="1379156"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379159">=</span>&nbsp;<span class="ident" id="1379161"><a href="/net/dnsmsg.go.html#1375461">unpackRR</a></span><span class="op" id="1379169">(</span><span class="ident" id="1379170"><a href="/net/dnsmsg.go.html#1378220">msg</a></span><span class="op" id="1379173">,</span>&nbsp;<span class="ident" id="1379175"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379182">if</span>&nbsp;<span class="op" id="1379185">!</span><span class="ident" id="1379186"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379194">return</span>&nbsp;<span class="builtintype" id="1379201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379209">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379213"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379216">.</span><span class="ident" id="1379217">ns</span>&nbsp;<span class="op" id="1379220">=</span>&nbsp;<span class="builtinfunc" id="1379222">append</span><span class="op" id="1379228">(</span><span class="ident" id="1379229"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379232">.</span><span class="ident" id="1379233">ns</span><span class="op" id="1379235">,</span>&nbsp;<span class="ident" id="1379237"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379246">for</span>&nbsp;<span class="ident" id="1379250">i</span>&nbsp;<span class="op" id="1379252">:=</span>&nbsp;<span class="num" id="1379255">0</span><span class="op" id="1379256">;</span>&nbsp;<span class="ident" id="1379258"><a href="/net/dnsmsg.go.html#1379250">i</a></span>&nbsp;<span class="op" id="1379260">&lt;</span>&nbsp;<span class="builtintype" id="1379262">int</span><span class="op" id="1379265">(</span><span class="ident" id="1379266"><a href="/net/dnsmsg.go.html#1378256">dh</a></span><span class="op" id="1379268">.</span><span class="ident" id="1379269">Arcount</span><span class="op" id="1379276">)</span><span class="op" id="1379277">;</span>&nbsp;<span class="ident" id="1379279"><a href="/net/dnsmsg.go.html#1379250">i</a></span><span class="op" id="1379280">++</span>&nbsp;<span class="op" id="1379283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379287"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379290">,</span>&nbsp;<span class="ident" id="1379292"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379295">,</span>&nbsp;<span class="ident" id="1379297"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379300">=</span>&nbsp;<span class="ident" id="1379302"><a href="/net/dnsmsg.go.html#1375461">unpackRR</a></span><span class="op" id="1379310">(</span><span class="ident" id="1379311"><a href="/net/dnsmsg.go.html#1378220">msg</a></span><span class="op" id="1379314">,</span>&nbsp;<span class="ident" id="1379316"><a href="/net/dnsmsg.go.html#1378270">off</a></span><span class="op" id="1379319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379323">if</span>&nbsp;<span class="op" id="1379326">!</span><span class="ident" id="1379327"><a href="/net/dnsmsg.go.html#1378284">ok</a></span>&nbsp;<span class="op" id="1379330">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379335">return</span>&nbsp;<span class="builtintype" id="1379342">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379354"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379357">.</span><span class="ident" id="1379358">extra</span>&nbsp;<span class="op" id="1379364">=</span>&nbsp;<span class="builtinfunc" id="1379366">append</span><span class="op" id="1379372">(</span><span class="ident" id="1379373"><a href="/net/dnsmsg.go.html#1378200">dns</a></span><span class="op" id="1379376">.</span><span class="ident" id="1379377">extra</span><span class="op" id="1379382">,</span>&nbsp;<span class="ident" id="1379384"><a href="/net/dnsmsg.go.html#1378846">rec</a></span><span class="op" id="1379387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1379393">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1379418">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1379481">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379487">return</span>&nbsp;<span class="builtintype" id="1379494">true</span><br>
<span class="lineno"></span><span class="op" id="1379499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="1379502">func</span>&nbsp;<span class="op" id="1379507">(</span><span class="ident" id="1379508">dns</span>&nbsp;<span class="op" id="1379512">*</span><span class="ident" id="1379513"><a href="/net/dnsmsg.go.html#1376790">dnsMsg</a></span><span class="op" id="1379519">)</span>&nbsp;<span class="ident" id="1379521">String</span><span class="op" id="1379527">(</span><span class="op" id="1379528">)</span>&nbsp;<span class="builtintype" id="1379530">string</span>&nbsp;<span class="op" id="1379537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379540">s</span>&nbsp;<span class="op" id="1379542">:=</span>&nbsp;<span class="string" id="1379545">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="1379553">+</span>&nbsp;<span class="ident" id="1379555"><a href="/net/dnsmsg.go.html#1373869">printStruct</a></span><span class="op" id="1379566">(</span><span class="op" id="1379567">&amp;</span><span class="ident" id="1379568"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379571">.</span><span class="ident" id="1379572">dnsMsgHdr</span><span class="op" id="1379581">)</span>&nbsp;<span class="op" id="1379583">+</span>&nbsp;<span class="string" id="1379585">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379591">if</span>&nbsp;<span class="builtinfunc" id="1379594">len</span><span class="op" id="1379597">(</span><span class="ident" id="1379598"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379601">.</span><span class="ident" id="1379602">question</span><span class="op" id="1379610">)</span>&nbsp;<span class="op" id="1379612">&gt;</span>&nbsp;<span class="num" id="1379614">0</span>&nbsp;<span class="op" id="1379616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379620"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379622">+=</span>&nbsp;<span class="string" id="1379625">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379644">for</span>&nbsp;<span class="ident" id="1379648">i</span>&nbsp;<span class="op" id="1379650">:=</span>&nbsp;<span class="num" id="1379653">0</span><span class="op" id="1379654">;</span>&nbsp;<span class="ident" id="1379656"><a href="/net/dnsmsg.go.html#1379648">i</a></span>&nbsp;<span class="op" id="1379658">&lt;</span>&nbsp;<span class="builtinfunc" id="1379660">len</span><span class="op" id="1379663">(</span><span class="ident" id="1379664"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379667">.</span><span class="ident" id="1379668">question</span><span class="op" id="1379676">)</span><span class="op" id="1379677">;</span>&nbsp;<span class="ident" id="1379679"><a href="/net/dnsmsg.go.html#1379648">i</a></span><span class="op" id="1379680">++</span>&nbsp;<span class="op" id="1379683">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379688"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379690">+=</span>&nbsp;<span class="ident" id="1379693"><a href="/net/dnsmsg.go.html#1373869">printStruct</a></span><span class="op" id="1379704">(</span><span class="op" id="1379705">&amp;</span><span class="ident" id="1379706"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379709">.</span><span class="ident" id="1379710">question</span><span class="op" id="1379718">[</span><span class="ident" id="1379719"><a href="/net/dnsmsg.go.html#1379648">i</a></span><span class="op" id="1379720">]</span><span class="op" id="1379721">)</span>&nbsp;<span class="op" id="1379723">+</span>&nbsp;<span class="string" id="1379725">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379738">if</span>&nbsp;<span class="builtinfunc" id="1379741">len</span><span class="op" id="1379744">(</span><span class="ident" id="1379745"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379748">.</span><span class="ident" id="1379749">answer</span><span class="op" id="1379755">)</span>&nbsp;<span class="op" id="1379757">&gt;</span>&nbsp;<span class="num" id="1379759">0</span>&nbsp;<span class="op" id="1379761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379765"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379767">+=</span>&nbsp;<span class="string" id="1379770">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379787">for</span>&nbsp;<span class="ident" id="1379791">i</span>&nbsp;<span class="op" id="1379793">:=</span>&nbsp;<span class="num" id="1379796">0</span><span class="op" id="1379797">;</span>&nbsp;<span class="ident" id="1379799"><a href="/net/dnsmsg.go.html#1379791">i</a></span>&nbsp;<span class="op" id="1379801">&lt;</span>&nbsp;<span class="builtinfunc" id="1379803">len</span><span class="op" id="1379806">(</span><span class="ident" id="1379807"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379810">.</span><span class="ident" id="1379811">answer</span><span class="op" id="1379817">)</span><span class="op" id="1379818">;</span>&nbsp;<span class="ident" id="1379820"><a href="/net/dnsmsg.go.html#1379791">i</a></span><span class="op" id="1379821">++</span>&nbsp;<span class="op" id="1379824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379829"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379831">+=</span>&nbsp;<span class="ident" id="1379834"><a href="/net/dnsmsg.go.html#1373869">printStruct</a></span><span class="op" id="1379845">(</span><span class="ident" id="1379846"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379849">.</span><span class="ident" id="1379850">answer</span><span class="op" id="1379856">[</span><span class="ident" id="1379857"><a href="/net/dnsmsg.go.html#1379791">i</a></span><span class="op" id="1379858">]</span><span class="op" id="1379859">)</span>&nbsp;<span class="op" id="1379861">+</span>&nbsp;<span class="string" id="1379863">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1379873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379876">if</span>&nbsp;<span class="builtinfunc" id="1379879">len</span><span class="op" id="1379882">(</span><span class="ident" id="1379883"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379886">.</span><span class="ident" id="1379887">ns</span><span class="op" id="1379889">)</span>&nbsp;<span class="op" id="1379891">&gt;</span>&nbsp;<span class="num" id="1379893">0</span>&nbsp;<span class="op" id="1379895">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379899"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379901">+=</span>&nbsp;<span class="string" id="1379904">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1379926">for</span>&nbsp;<span class="ident" id="1379930">i</span>&nbsp;<span class="op" id="1379932">:=</span>&nbsp;<span class="num" id="1379935">0</span><span class="op" id="1379936">;</span>&nbsp;<span class="ident" id="1379938"><a href="/net/dnsmsg.go.html#1379930">i</a></span>&nbsp;<span class="op" id="1379940">&lt;</span>&nbsp;<span class="builtinfunc" id="1379942">len</span><span class="op" id="1379945">(</span><span class="ident" id="1379946"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379949">.</span><span class="ident" id="1379950">ns</span><span class="op" id="1379952">)</span><span class="op" id="1379953">;</span>&nbsp;<span class="ident" id="1379955"><a href="/net/dnsmsg.go.html#1379930">i</a></span><span class="op" id="1379956">++</span>&nbsp;<span class="op" id="1379959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379964"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1379966">+=</span>&nbsp;<span class="ident" id="1379969"><a href="/net/dnsmsg.go.html#1373869">printStruct</a></span><span class="op" id="1379980">(</span><span class="ident" id="1379981"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1379984">.</span><span class="ident" id="1379985">ns</span><span class="op" id="1379987">[</span><span class="ident" id="1379988"><a href="/net/dnsmsg.go.html#1379930">i</a></span><span class="op" id="1379989">]</span><span class="op" id="1379990">)</span>&nbsp;<span class="op" id="1379992">+</span>&nbsp;<span class="string" id="1379994">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1380001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1380004">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1380007">if</span>&nbsp;<span class="builtinfunc" id="1380010">len</span><span class="op" id="1380013">(</span><span class="ident" id="1380014"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1380017">.</span><span class="ident" id="1380018">extra</span><span class="op" id="1380023">)</span>&nbsp;<span class="op" id="1380025">&gt;</span>&nbsp;<span class="num" id="1380027">0</span>&nbsp;<span class="op" id="1380029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380033"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1380035">+=</span>&nbsp;<span class="string" id="1380038">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1380053">for</span>&nbsp;<span class="ident" id="1380057">i</span>&nbsp;<span class="op" id="1380059">:=</span>&nbsp;<span class="num" id="1380062">0</span><span class="op" id="1380063">;</span>&nbsp;<span class="ident" id="1380065"><a href="/net/dnsmsg.go.html#1380057">i</a></span>&nbsp;<span class="op" id="1380067">&lt;</span>&nbsp;<span class="builtinfunc" id="1380069">len</span><span class="op" id="1380072">(</span><span class="ident" id="1380073"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1380076">.</span><span class="ident" id="1380077">extra</span><span class="op" id="1380082">)</span><span class="op" id="1380083">;</span>&nbsp;<span class="ident" id="1380085"><a href="/net/dnsmsg.go.html#1380057">i</a></span><span class="op" id="1380086">++</span>&nbsp;<span class="op" id="1380089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380094"><a href="/net/dnsmsg.go.html#1379540">s</a></span>&nbsp;<span class="op" id="1380096">+=</span>&nbsp;<span class="ident" id="1380099"><a href="/net/dnsmsg.go.html#1373869">printStruct</a></span><span class="op" id="1380110">(</span><span class="ident" id="1380111"><a href="/net/dnsmsg.go.html#1379508">dns</a></span><span class="op" id="1380114">.</span><span class="ident" id="1380115">extra</span><span class="op" id="1380120">[</span><span class="ident" id="1380121"><a href="/net/dnsmsg.go.html#1380057">i</a></span><span class="op" id="1380122">]</span><span class="op" id="1380123">)</span>&nbsp;<span class="op" id="1380125">+</span>&nbsp;<span class="string" id="1380127">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1380134">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1380137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1380140">return</span>&nbsp;<span class="ident" id="1380147"><a href="/net/dnsmsg.go.html#1379540">s</a></span><br>
<span class="lineno"></span><span class="op" id="1380149">}</span>
</div>
</body>
</html>
