<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3654133">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3654189">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3654243">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3654294">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654370">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3654423">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3654438">package</span>&nbsp;<span class="ident" id="3654446">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3654452">import</span>&nbsp;<span class="op" id="3654459">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654462">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654471">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654485">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654502">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654508">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654514">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654525">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3654533">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3654540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3654543">const</span>&nbsp;<span class="ident" id="3654549">urandomDevice</span>&nbsp;<span class="op" id="3654563">=</span>&nbsp;<span class="string" id="3654565">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3654581">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3654629">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3654681">func</span>&nbsp;<span class="ident" id="3654686">init</span><span class="op" id="3654690">(</span><span class="op" id="3654691">)</span>&nbsp;<span class="op" id="3654693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3654696">if</span>&nbsp;<span class="ident" id="3654699"><a href="/crypto/rand/rand_unix.go.html#3654514">runtime</a></span><span class="op" id="3654706">.</span><span class="ident" id="3654707">GOOS</span>&nbsp;<span class="op" id="3654712">==</span>&nbsp;<span class="string" id="3654715">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3654723">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654727"><a href="/crypto/rand/rand.go.html#3653025">Reader</a></span>&nbsp;<span class="op" id="3654734">=</span>&nbsp;<span class="ident" id="3654736"><a href="/crypto/rand/rand_unix.go.html#3656016">newReader</a></span><span class="op" id="3654745">(</span><span class="ident" id="3654746">nil</span><span class="op" id="3654749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654752">}</span>&nbsp;<span class="keyword" id="3654754">else</span>&nbsp;<span class="op" id="3654759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654763"><a href="/crypto/rand/rand.go.html#3653025">Reader</a></span>&nbsp;<span class="op" id="3654770">=</span>&nbsp;<span class="op" id="3654772">&amp;</span><span class="ident" id="3654773"><a href="/crypto/rand/rand_unix.go.html#3654878">devReader</a></span><span class="op" id="3654782">{</span><span class="ident" id="3654783">name</span><span class="op" id="3654787">:</span>&nbsp;<span class="ident" id="3654789"><a href="/crypto/rand/rand_unix.go.html#3654549">urandomDevice</a></span><span class="op" id="3654802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3654805">}</span><br>
<span class="lineno"></span><span class="op" id="3654807">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3654810">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3654873">type</span>&nbsp;<span class="ident" id="3654878">devReader</span>&nbsp;<span class="keyword" id="3654888">struct</span>&nbsp;<span class="op" id="3654895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654898">name</span>&nbsp;<span class="builtintype" id="3654903">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654911">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654916"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3654918">.</span><span class="ident" id="3654919">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3654927">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3654932"><a href="/crypto/rand/rand_unix.go.html#3654525">sync</a></span><span class="op" id="3654936">.</span><span class="ident" id="3654937">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3654943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654946">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3655014">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3655043">var</span>&nbsp;<span class="ident" id="3655047">altGetRandom</span>&nbsp;<span class="keyword" id="3655060">func</span><span class="op" id="3655064">(</span><span class="op" id="3655065">[</span><span class="op" id="3655066">]</span><span class="builtintype" id="3655067">byte</span><span class="op" id="3655071">)</span>&nbsp;<span class="op" id="3655073">(</span><span class="ident" id="3655074">ok</span>&nbsp;<span class="builtintype" id="3655077">bool</span><span class="op" id="3655081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655084">func</span>&nbsp;<span class="op" id="3655089">(</span><span class="ident" id="3655090">r</span>&nbsp;<span class="op" id="3655092">*</span><span class="ident" id="3655093"><a href="/crypto/rand/rand_unix.go.html#3654878">devReader</a></span><span class="op" id="3655102">)</span>&nbsp;<span class="ident" id="3655104">Read</span><span class="op" id="3655108">(</span><span class="ident" id="3655109">b</span>&nbsp;<span class="op" id="3655111">[</span><span class="op" id="3655112">]</span><span class="builtintype" id="3655113">byte</span><span class="op" id="3655117">)</span>&nbsp;<span class="op" id="3655119">(</span><span class="ident" id="3655120">n</span>&nbsp;<span class="builtintype" id="3655122">int</span><span class="op" id="3655125">,</span>&nbsp;<span class="ident" id="3655127">err</span>&nbsp;<span class="builtintype" id="3655131">error</span><span class="op" id="3655136">)</span>&nbsp;<span class="op" id="3655138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655141">if</span>&nbsp;<span class="ident" id="3655144"><a href="/crypto/rand/rand_unix.go.html#3655047">altGetRandom</a></span>&nbsp;<span class="op" id="3655157">!=</span>&nbsp;<span class="ident" id="3655160">nil</span>&nbsp;<span class="op" id="3655164">&amp;&amp;</span>&nbsp;<span class="ident" id="3655167"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655168">.</span><span class="ident" id="3655169">name</span>&nbsp;<span class="op" id="3655174">==</span>&nbsp;<span class="ident" id="3655177"><a href="/crypto/rand/rand_unix.go.html#3654549">urandomDevice</a></span>&nbsp;<span class="op" id="3655191">&amp;&amp;</span>&nbsp;<span class="ident" id="3655194"><a href="/crypto/rand/rand_unix.go.html#3655047">altGetRandom</a></span><span class="op" id="3655206">(</span><span class="ident" id="3655207"><a href="/crypto/rand/rand_unix.go.html#3655109">b</a></span><span class="op" id="3655208">)</span>&nbsp;<span class="op" id="3655210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655214">return</span>&nbsp;<span class="builtinfunc" id="3655221">len</span><span class="op" id="3655224">(</span><span class="ident" id="3655225"><a href="/crypto/rand/rand_unix.go.html#3655109">b</a></span><span class="op" id="3655226">)</span><span class="op" id="3655227">,</span>&nbsp;<span class="ident" id="3655229">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655237"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655238">.</span><span class="ident" id="3655239">mu</span><span class="op" id="3655241">.</span><span class="ident" id="3655242">Lock</span><span class="op" id="3655246">(</span><span class="op" id="3655247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655250">defer</span>&nbsp;<span class="ident" id="3655256"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655257">.</span><span class="ident" id="3655258">mu</span><span class="op" id="3655260">.</span><span class="ident" id="3655261">Unlock</span><span class="op" id="3655267">(</span><span class="op" id="3655268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655271">if</span>&nbsp;<span class="ident" id="3655274"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655275">.</span><span class="ident" id="3655276">f</span>&nbsp;<span class="op" id="3655278">==</span>&nbsp;<span class="ident" id="3655281">nil</span>&nbsp;<span class="op" id="3655285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655289">f</span><span class="op" id="3655290">,</span>&nbsp;<span class="ident" id="3655292">err</span>&nbsp;<span class="op" id="3655296">:=</span>&nbsp;<span class="ident" id="3655299"><a href="/crypto/rand/rand_unix.go.html#3654508">os</a></span><span class="op" id="3655301">.</span><span class="ident" id="3655302">Open</span><span class="op" id="3655306">(</span><span class="ident" id="3655307"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655308">.</span><span class="ident" id="3655309">name</span><span class="op" id="3655313">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655317">if</span>&nbsp;<span class="ident" id="3655320"><a href="/crypto/rand/rand_unix.go.html#3655289">f</a></span>&nbsp;<span class="op" id="3655322">==</span>&nbsp;<span class="ident" id="3655325">nil</span>&nbsp;<span class="op" id="3655329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655334">return</span>&nbsp;<span class="num" id="3655341">0</span><span class="op" id="3655342">,</span>&nbsp;<span class="ident" id="3655344"><a href="/crypto/rand/rand_unix.go.html#3655292">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655354">if</span>&nbsp;<span class="ident" id="3655357"><a href="/crypto/rand/rand_unix.go.html#3654514">runtime</a></span><span class="op" id="3655364">.</span><span class="ident" id="3655365">GOOS</span>&nbsp;<span class="op" id="3655370">==</span>&nbsp;<span class="string" id="3655373">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3655381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655386"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655387">.</span><span class="ident" id="3655388">f</span>&nbsp;<span class="op" id="3655390">=</span>&nbsp;<span class="ident" id="3655392"><a href="/crypto/rand/rand_unix.go.html#3655289">f</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655396">}</span>&nbsp;<span class="keyword" id="3655398">else</span>&nbsp;<span class="op" id="3655403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3655408"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655409">.</span><span class="ident" id="3655410">f</span>&nbsp;<span class="op" id="3655412">=</span>&nbsp;<span class="ident" id="3655414"><a href="/crypto/rand/rand_unix.go.html#3654462">bufio</a></span><span class="op" id="3655419">.</span><span class="ident" id="3655420">NewReader</span><span class="op" id="3655429">(</span><span class="ident" id="3655430"><a href="/crypto/rand/rand_unix.go.html#3655289">f</a></span><span class="op" id="3655431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3655438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3655441">return</span>&nbsp;<span class="ident" id="3655448"><a href="/crypto/rand/rand_unix.go.html#3655090">r</a></span><span class="op" id="3655449">.</span><span class="ident" id="3655450">f</span><span class="op" id="3655451">.</span><span class="ident" id="3655452">Read</span><span class="op" id="3655456">(</span><span class="ident" id="3655457"><a href="/crypto/rand/rand_unix.go.html#3655109">b</a></span><span class="op" id="3655458">)</span><br>
<span class="lineno">65</span><span class="op" id="3655460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3655463">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3655516">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3655561">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3655616">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3655677">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3655736">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3655787">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3655844">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3655903">//</span><br>
<span class="lineno"></span><span class="comment" id="3655906">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3655962">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3656011">func</span>&nbsp;<span class="ident" id="3656016">newReader</span><span class="op" id="3656025">(</span><span class="ident" id="3656026">entropy</span>&nbsp;<span class="ident" id="3656034"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3656036">.</span><span class="ident" id="3656037">Reader</span><span class="op" id="3656043">)</span>&nbsp;<span class="ident" id="3656045"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3656047">.</span><span class="ident" id="3656048">Reader</span>&nbsp;<span class="op" id="3656055">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656058">if</span>&nbsp;<span class="ident" id="3656061"><a href="/crypto/rand/rand_unix.go.html#3656026">entropy</a></span>&nbsp;<span class="op" id="3656069">==</span>&nbsp;<span class="ident" id="3656072">nil</span>&nbsp;<span class="op" id="3656076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656080"><a href="/crypto/rand/rand_unix.go.html#3656026">entropy</a></span>&nbsp;<span class="op" id="3656088">=</span>&nbsp;<span class="op" id="3656090">&amp;</span><span class="ident" id="3656091"><a href="/crypto/rand/rand_unix.go.html#3654878">devReader</a></span><span class="op" id="3656100">{</span><span class="ident" id="3656101">name</span><span class="op" id="3656105">:</span>&nbsp;<span class="string" id="3656107">&#34;/dev/random&#34;</span><span class="op" id="3656120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656126">return</span>&nbsp;<span class="op" id="3656133">&amp;</span><span class="ident" id="3656134"><a href="/crypto/rand/rand_unix.go.html#3656167">reader</a></span><span class="op" id="3656140">{</span><span class="ident" id="3656141">entropy</span><span class="op" id="3656148">:</span>&nbsp;<span class="ident" id="3656150"><a href="/crypto/rand/rand_unix.go.html#3656026">entropy</a></span><span class="op" id="3656157">}</span><br>
<span class="lineno"></span><span class="op" id="3656159">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3656162">type</span>&nbsp;<span class="ident" id="3656167">reader</span>&nbsp;<span class="keyword" id="3656174">struct</span>&nbsp;<span class="op" id="3656181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656184">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656205"><a href="/crypto/rand/rand_unix.go.html#3654525">sync</a></span><span class="op" id="3656209">.</span><span class="ident" id="3656210">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656217">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3656238">int</span>&nbsp;<span class="comment" id="3656242">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656284">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656305"><a href="/crypto/rand/rand_unix.go.html#3654485">cipher</a></span><span class="op" id="3656311">.</span><span class="ident" id="3656312">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656319">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3656340"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3656342">.</span><span class="ident" id="3656343">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656351">time</span><span class="op" id="3656355">,</span>&nbsp;<span class="ident" id="3656357">seed</span><span class="op" id="3656361">,</span>&nbsp;<span class="ident" id="3656363">dst</span><span class="op" id="3656366">,</span>&nbsp;<span class="ident" id="3656368">key</span>&nbsp;<span class="op" id="3656372">[</span><span class="ident" id="3656373"><a href="/crypto/rand/rand_unix.go.html#3654471">aes</a></span><span class="op" id="3656376">.</span><span class="ident" id="3656377">BlockSize</span><span class="op" id="3656386">]</span><span class="builtintype" id="3656387">byte</span><br>
<span class="lineno"></span><span class="op" id="3656392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3656395">func</span>&nbsp;<span class="op" id="3656400">(</span><span class="ident" id="3656401">r</span>&nbsp;<span class="op" id="3656403">*</span><span class="ident" id="3656404"><a href="/crypto/rand/rand_unix.go.html#3656167">reader</a></span><span class="op" id="3656410">)</span>&nbsp;<span class="ident" id="3656412">Read</span><span class="op" id="3656416">(</span><span class="ident" id="3656417">b</span>&nbsp;<span class="op" id="3656419">[</span><span class="op" id="3656420">]</span><span class="builtintype" id="3656421">byte</span><span class="op" id="3656425">)</span>&nbsp;<span class="op" id="3656427">(</span><span class="ident" id="3656428">n</span>&nbsp;<span class="builtintype" id="3656430">int</span><span class="op" id="3656433">,</span>&nbsp;<span class="ident" id="3656435">err</span>&nbsp;<span class="builtintype" id="3656439">error</span><span class="op" id="3656444">)</span>&nbsp;<span class="op" id="3656446">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656449"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656450">.</span><span class="ident" id="3656451">mu</span><span class="op" id="3656453">.</span><span class="ident" id="3656454">Lock</span><span class="op" id="3656458">(</span><span class="op" id="3656459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656462">defer</span>&nbsp;<span class="ident" id="3656468"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656469">.</span><span class="ident" id="3656470">mu</span><span class="op" id="3656472">.</span><span class="ident" id="3656473">Unlock</span><span class="op" id="3656479">(</span><span class="op" id="3656480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656483"><a href="/crypto/rand/rand_unix.go.html#3656428">n</a></span>&nbsp;<span class="op" id="3656485">=</span>&nbsp;<span class="builtinfunc" id="3656487">len</span><span class="op" id="3656490">(</span><span class="ident" id="3656491"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3656492">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656496">for</span>&nbsp;<span class="builtinfunc" id="3656500">len</span><span class="op" id="3656503">(</span><span class="ident" id="3656504"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3656505">)</span>&nbsp;<span class="op" id="3656507">&gt;</span>&nbsp;<span class="num" id="3656509">0</span>&nbsp;<span class="op" id="3656511">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656515">if</span>&nbsp;<span class="ident" id="3656518"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656519">.</span><span class="ident" id="3656520">budget</span>&nbsp;<span class="op" id="3656527">==</span>&nbsp;<span class="num" id="3656530">0</span>&nbsp;<span class="op" id="3656532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656537">_</span><span class="op" id="3656538">,</span>&nbsp;<span class="ident" id="3656540">err</span>&nbsp;<span class="op" id="3656544">:=</span>&nbsp;<span class="ident" id="3656547"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3656549">.</span><span class="ident" id="3656550">ReadFull</span><span class="op" id="3656558">(</span><span class="ident" id="3656559"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656560">.</span><span class="ident" id="3656561">entropy</span><span class="op" id="3656568">,</span>&nbsp;<span class="ident" id="3656570"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656571">.</span><span class="ident" id="3656572">seed</span><span class="op" id="3656576">[</span><span class="num" id="3656577">0</span><span class="op" id="3656578">:</span><span class="op" id="3656579">]</span><span class="op" id="3656580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656585">if</span>&nbsp;<span class="ident" id="3656588"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span>&nbsp;<span class="op" id="3656592">!=</span>&nbsp;<span class="ident" id="3656595">nil</span>&nbsp;<span class="op" id="3656599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656605">return</span>&nbsp;<span class="ident" id="3656612"><a href="/crypto/rand/rand_unix.go.html#3656428">n</a></span>&nbsp;<span class="op" id="3656614">-</span>&nbsp;<span class="builtinfunc" id="3656616">len</span><span class="op" id="3656619">(</span><span class="ident" id="3656620"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3656621">)</span><span class="op" id="3656622">,</span>&nbsp;<span class="ident" id="3656624"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656631">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656636">_</span><span class="op" id="3656637">,</span>&nbsp;<span class="ident" id="3656639"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span>&nbsp;<span class="op" id="3656643">=</span>&nbsp;<span class="ident" id="3656645"><a href="/crypto/rand/rand_unix.go.html#3654502">io</a></span><span class="op" id="3656647">.</span><span class="ident" id="3656648">ReadFull</span><span class="op" id="3656656">(</span><span class="ident" id="3656657"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656658">.</span><span class="ident" id="3656659">entropy</span><span class="op" id="3656666">,</span>&nbsp;<span class="ident" id="3656668"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656669">.</span><span class="ident" id="3656670">key</span><span class="op" id="3656673">[</span><span class="num" id="3656674">0</span><span class="op" id="3656675">:</span><span class="op" id="3656676">]</span><span class="op" id="3656677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656682">if</span>&nbsp;<span class="ident" id="3656685"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span>&nbsp;<span class="op" id="3656689">!=</span>&nbsp;<span class="ident" id="3656692">nil</span>&nbsp;<span class="op" id="3656696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656702">return</span>&nbsp;<span class="ident" id="3656709"><a href="/crypto/rand/rand_unix.go.html#3656428">n</a></span>&nbsp;<span class="op" id="3656711">-</span>&nbsp;<span class="builtinfunc" id="3656713">len</span><span class="op" id="3656716">(</span><span class="ident" id="3656717"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3656718">)</span><span class="op" id="3656719">,</span>&nbsp;<span class="ident" id="3656721"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656733"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656734">.</span><span class="ident" id="3656735">cipher</span><span class="op" id="3656741">,</span>&nbsp;<span class="ident" id="3656743"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span>&nbsp;<span class="op" id="3656747">=</span>&nbsp;<span class="ident" id="3656749"><a href="/crypto/rand/rand_unix.go.html#3654471">aes</a></span><span class="op" id="3656752">.</span><span class="ident" id="3656753">NewCipher</span><span class="op" id="3656762">(</span><span class="ident" id="3656763"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656764">.</span><span class="ident" id="3656765">key</span><span class="op" id="3656768">[</span><span class="num" id="3656769">0</span><span class="op" id="3656770">:</span><span class="op" id="3656771">]</span><span class="op" id="3656772">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656777">if</span>&nbsp;<span class="ident" id="3656780"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span>&nbsp;<span class="op" id="3656784">!=</span>&nbsp;<span class="ident" id="3656787">nil</span>&nbsp;<span class="op" id="3656791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3656797">return</span>&nbsp;<span class="ident" id="3656804"><a href="/crypto/rand/rand_unix.go.html#3656428">n</a></span>&nbsp;<span class="op" id="3656806">-</span>&nbsp;<span class="builtinfunc" id="3656808">len</span><span class="op" id="3656811">(</span><span class="ident" id="3656812"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3656813">)</span><span class="op" id="3656814">,</span>&nbsp;<span class="ident" id="3656816"><a href="/crypto/rand/rand_unix.go.html#3656540">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656828"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656829">.</span><span class="ident" id="3656830">budget</span>&nbsp;<span class="op" id="3656837">=</span>&nbsp;<span class="num" id="3656839">1</span>&nbsp;<span class="op" id="3656841">&lt;&lt;</span>&nbsp;<span class="num" id="3656844">20</span>&nbsp;<span class="comment" id="3656847">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3656880">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3656884"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3656885">.</span><span class="ident" id="3656886">budget</span>&nbsp;<span class="op" id="3656893">-=</span>&nbsp;<span class="ident" id="3656896"><a href="/crypto/rand/rand_unix.go.html#3654471">aes</a></span><span class="op" id="3656899">.</span><span class="ident" id="3656900">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3656913">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3656983">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3656988">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657007">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657030">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3657057">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657084">ns</span>&nbsp;<span class="op" id="3657087">:=</span>&nbsp;<span class="ident" id="3657090"><a href="/crypto/rand/rand_unix.go.html#3654533">time</a></span><span class="op" id="3657094">.</span><span class="ident" id="3657095">Now</span><span class="op" id="3657098">(</span><span class="op" id="3657099">)</span><span class="op" id="3657100">.</span><span class="ident" id="3657101">UnixNano</span><span class="op" id="3657109">(</span><span class="op" id="3657110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657114"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657115">.</span><span class="ident" id="3657116">time</span><span class="op" id="3657120">[</span><span class="num" id="3657121">0</span><span class="op" id="3657122">]</span>&nbsp;<span class="op" id="3657124">=</span>&nbsp;<span class="builtintype" id="3657126">byte</span><span class="op" id="3657130">(</span><span class="ident" id="3657131"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657134">&gt;&gt;</span>&nbsp;<span class="num" id="3657137">56</span><span class="op" id="3657139">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657143"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657144">.</span><span class="ident" id="3657145">time</span><span class="op" id="3657149">[</span><span class="num" id="3657150">1</span><span class="op" id="3657151">]</span>&nbsp;<span class="op" id="3657153">=</span>&nbsp;<span class="builtintype" id="3657155">byte</span><span class="op" id="3657159">(</span><span class="ident" id="3657160"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657163">&gt;&gt;</span>&nbsp;<span class="num" id="3657166">48</span><span class="op" id="3657168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657172"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657173">.</span><span class="ident" id="3657174">time</span><span class="op" id="3657178">[</span><span class="num" id="3657179">2</span><span class="op" id="3657180">]</span>&nbsp;<span class="op" id="3657182">=</span>&nbsp;<span class="builtintype" id="3657184">byte</span><span class="op" id="3657188">(</span><span class="ident" id="3657189"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657192">&gt;&gt;</span>&nbsp;<span class="num" id="3657195">40</span><span class="op" id="3657197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657201"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657202">.</span><span class="ident" id="3657203">time</span><span class="op" id="3657207">[</span><span class="num" id="3657208">3</span><span class="op" id="3657209">]</span>&nbsp;<span class="op" id="3657211">=</span>&nbsp;<span class="builtintype" id="3657213">byte</span><span class="op" id="3657217">(</span><span class="ident" id="3657218"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657221">&gt;&gt;</span>&nbsp;<span class="num" id="3657224">32</span><span class="op" id="3657226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657230"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657231">.</span><span class="ident" id="3657232">time</span><span class="op" id="3657236">[</span><span class="num" id="3657237">4</span><span class="op" id="3657238">]</span>&nbsp;<span class="op" id="3657240">=</span>&nbsp;<span class="builtintype" id="3657242">byte</span><span class="op" id="3657246">(</span><span class="ident" id="3657247"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657250">&gt;&gt;</span>&nbsp;<span class="num" id="3657253">24</span><span class="op" id="3657255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657259"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657260">.</span><span class="ident" id="3657261">time</span><span class="op" id="3657265">[</span><span class="num" id="3657266">5</span><span class="op" id="3657267">]</span>&nbsp;<span class="op" id="3657269">=</span>&nbsp;<span class="builtintype" id="3657271">byte</span><span class="op" id="3657275">(</span><span class="ident" id="3657276"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657279">&gt;&gt;</span>&nbsp;<span class="num" id="3657282">16</span><span class="op" id="3657284">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657288"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657289">.</span><span class="ident" id="3657290">time</span><span class="op" id="3657294">[</span><span class="num" id="3657295">6</span><span class="op" id="3657296">]</span>&nbsp;<span class="op" id="3657298">=</span>&nbsp;<span class="builtintype" id="3657300">byte</span><span class="op" id="3657304">(</span><span class="ident" id="3657305"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span>&nbsp;<span class="op" id="3657308">&gt;&gt;</span>&nbsp;<span class="num" id="3657311">8</span><span class="op" id="3657312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657316"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657317">.</span><span class="ident" id="3657318">time</span><span class="op" id="3657322">[</span><span class="num" id="3657323">7</span><span class="op" id="3657324">]</span>&nbsp;<span class="op" id="3657326">=</span>&nbsp;<span class="builtintype" id="3657328">byte</span><span class="op" id="3657332">(</span><span class="ident" id="3657333"><a href="/crypto/rand/rand_unix.go.html#3657084">ns</a></span><span class="op" id="3657335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657339"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657340">.</span><span class="ident" id="3657341">cipher</span><span class="op" id="3657347">.</span><span class="ident" id="3657348">Encrypt</span><span class="op" id="3657355">(</span><span class="ident" id="3657356"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657357">.</span><span class="ident" id="3657358">time</span><span class="op" id="3657362">[</span><span class="num" id="3657363">0</span><span class="op" id="3657364">:</span><span class="op" id="3657365">]</span><span class="op" id="3657366">,</span>&nbsp;<span class="ident" id="3657368"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657369">.</span><span class="ident" id="3657370">time</span><span class="op" id="3657374">[</span><span class="num" id="3657375">0</span><span class="op" id="3657376">:</span><span class="op" id="3657377">]</span><span class="op" id="3657378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657382">for</span>&nbsp;<span class="ident" id="3657386">i</span>&nbsp;<span class="op" id="3657388">:=</span>&nbsp;<span class="num" id="3657391">0</span><span class="op" id="3657392">;</span>&nbsp;<span class="ident" id="3657394"><a href="/crypto/rand/rand_unix.go.html#3657386">i</a></span>&nbsp;<span class="op" id="3657396">&lt;</span>&nbsp;<span class="ident" id="3657398"><a href="/crypto/rand/rand_unix.go.html#3654471">aes</a></span><span class="op" id="3657401">.</span><span class="ident" id="3657402">BlockSize</span><span class="op" id="3657411">;</span>&nbsp;<span class="ident" id="3657413"><a href="/crypto/rand/rand_unix.go.html#3657386">i</a></span><span class="op" id="3657414">++</span>&nbsp;<span class="op" id="3657417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657422"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657423">.</span><span class="ident" id="3657424">dst</span><span class="op" id="3657427">[</span><span class="ident" id="3657428"><a href="/crypto/rand/rand_unix.go.html#3657386">i</a></span><span class="op" id="3657429">]</span>&nbsp;<span class="op" id="3657431">=</span>&nbsp;<span class="ident" id="3657433"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657434">.</span><span class="ident" id="3657435">time</span><span class="op" id="3657439">[</span><span class="ident" id="3657440"><a href="/crypto/rand/rand_unix.go.html#3657386">i</a></span><span class="op" id="3657441">]</span>&nbsp;<span class="op" id="3657443">^</span>&nbsp;<span class="ident" id="3657445"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657446">.</span><span class="ident" id="3657447">seed</span><span class="op" id="3657451">[</span><span class="ident" id="3657452"><a href="/crypto/rand/rand_unix.go.html#3657386">i</a></span><span class="op" id="3657453">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657461"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657462">.</span><span class="ident" id="3657463">cipher</span><span class="op" id="3657469">.</span><span class="ident" id="3657470">Encrypt</span><span class="op" id="3657477">(</span><span class="ident" id="3657478"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657479">.</span><span class="ident" id="3657480">dst</span><span class="op" id="3657483">[</span><span class="num" id="3657484">0</span><span class="op" id="3657485">:</span><span class="op" id="3657486">]</span><span class="op" id="3657487">,</span>&nbsp;<span class="ident" id="3657489"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657490">.</span><span class="ident" id="3657491">dst</span><span class="op" id="3657494">[</span><span class="num" id="3657495">0</span><span class="op" id="3657496">:</span><span class="op" id="3657497">]</span><span class="op" id="3657498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657502">for</span>&nbsp;<span class="ident" id="3657506">i</span>&nbsp;<span class="op" id="3657508">:=</span>&nbsp;<span class="num" id="3657511">0</span><span class="op" id="3657512">;</span>&nbsp;<span class="ident" id="3657514"><a href="/crypto/rand/rand_unix.go.html#3657506">i</a></span>&nbsp;<span class="op" id="3657516">&lt;</span>&nbsp;<span class="ident" id="3657518"><a href="/crypto/rand/rand_unix.go.html#3654471">aes</a></span><span class="op" id="3657521">.</span><span class="ident" id="3657522">BlockSize</span><span class="op" id="3657531">;</span>&nbsp;<span class="ident" id="3657533"><a href="/crypto/rand/rand_unix.go.html#3657506">i</a></span><span class="op" id="3657534">++</span>&nbsp;<span class="op" id="3657537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657542"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657543">.</span><span class="ident" id="3657544">seed</span><span class="op" id="3657548">[</span><span class="ident" id="3657549"><a href="/crypto/rand/rand_unix.go.html#3657506">i</a></span><span class="op" id="3657550">]</span>&nbsp;<span class="op" id="3657552">=</span>&nbsp;<span class="ident" id="3657554"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657555">.</span><span class="ident" id="3657556">time</span><span class="op" id="3657560">[</span><span class="ident" id="3657561"><a href="/crypto/rand/rand_unix.go.html#3657506">i</a></span><span class="op" id="3657562">]</span>&nbsp;<span class="op" id="3657564">^</span>&nbsp;<span class="ident" id="3657566"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657567">.</span><span class="ident" id="3657568">dst</span><span class="op" id="3657571">[</span><span class="ident" id="3657572"><a href="/crypto/rand/rand_unix.go.html#3657506">i</a></span><span class="op" id="3657573">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657577">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657581"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657582">.</span><span class="ident" id="3657583">cipher</span><span class="op" id="3657589">.</span><span class="ident" id="3657590">Encrypt</span><span class="op" id="3657597">(</span><span class="ident" id="3657598"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657599">.</span><span class="ident" id="3657600">seed</span><span class="op" id="3657604">[</span><span class="num" id="3657605">0</span><span class="op" id="3657606">:</span><span class="op" id="3657607">]</span><span class="op" id="3657608">,</span>&nbsp;<span class="ident" id="3657610"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657611">.</span><span class="ident" id="3657612">seed</span><span class="op" id="3657616">[</span><span class="num" id="3657617">0</span><span class="op" id="3657618">:</span><span class="op" id="3657619">]</span><span class="op" id="3657620">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657625">m</span>&nbsp;<span class="op" id="3657627">:=</span>&nbsp;<span class="builtinfunc" id="3657630">copy</span><span class="op" id="3657634">(</span><span class="ident" id="3657635"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3657636">,</span>&nbsp;<span class="ident" id="3657638"><a href="/crypto/rand/rand_unix.go.html#3656401">r</a></span><span class="op" id="3657639">.</span><span class="ident" id="3657640">dst</span><span class="op" id="3657643">[</span><span class="num" id="3657644">0</span><span class="op" id="3657645">:</span><span class="op" id="3657646">]</span><span class="op" id="3657647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3657651"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span>&nbsp;<span class="op" id="3657653">=</span>&nbsp;<span class="ident" id="3657655"><a href="/crypto/rand/rand_unix.go.html#3656417">b</a></span><span class="op" id="3657656">[</span><span class="ident" id="3657657"><a href="/crypto/rand/rand_unix.go.html#3657625">m</a></span><span class="op" id="3657658">:</span><span class="op" id="3657659">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3657662">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3657666">return</span>&nbsp;<span class="ident" id="3657673"><a href="/crypto/rand/rand_unix.go.html#3656428">n</a></span><span class="op" id="3657674">,</span>&nbsp;<span class="ident" id="3657676">nil</span><br>
<span class="lineno"></span><span class="op" id="3657680">}</span>
</div>
</body>
</html>
