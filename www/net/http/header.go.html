<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3781226">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3781282">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3781336">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3781387">package</span>&nbsp;<span class="ident" id="3781395">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3781401">import</span>&nbsp;<span class="op" id="3781408">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781411">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781417">&#34;net/textproto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781434">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781442">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781453">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3781461">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3781468">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3781471">var</span>&nbsp;<span class="ident" id="3781475">raceEnabled</span>&nbsp;<span class="op" id="3781487">=</span>&nbsp;<span class="ident" id="3781489">false</span>&nbsp;<span class="comment" id="3781495">//&nbsp;set&nbsp;by&nbsp;race.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3781514">//&nbsp;A&nbsp;Header&nbsp;represents&nbsp;the&nbsp;key-value&nbsp;pairs&nbsp;in&nbsp;an&nbsp;HTTP&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3781576">type</span>&nbsp;<span class="ident" id="3781581">Header</span>&nbsp;<span class="keyword" id="3781588">map</span><span class="op" id="3781591">[</span><span class="builtintype" id="3781592">string</span><span class="op" id="3781598">]</span><span class="op" id="3781599">[</span><span class="op" id="3781600">]</span><span class="builtintype" id="3781601">string</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3781609">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;key,&nbsp;value&nbsp;pair&nbsp;to&nbsp;the&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="3781656">//&nbsp;It&nbsp;appends&nbsp;to&nbsp;any&nbsp;existing&nbsp;values&nbsp;associated&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3781714">func</span>&nbsp;<span class="op" id="3781719">(</span><span class="ident" id="3781720">h</span>&nbsp;<span class="ident" id="3781722"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3781728">)</span>&nbsp;<span class="ident" id="3781730">Add</span><span class="op" id="3781733">(</span><span class="ident" id="3781734">key</span><span class="op" id="3781737">,</span>&nbsp;<span class="ident" id="3781739">value</span>&nbsp;<span class="builtintype" id="3781745">string</span><span class="op" id="3781751">)</span>&nbsp;<span class="op" id="3781753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781756"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3781765">.</span><span class="ident" id="3781766">MIMEHeader</span><span class="op" id="3781776">(</span><span class="ident" id="3781777"><a href="/net/http/header.go.html#3781720">h</a></span><span class="op" id="3781778">)</span><span class="op" id="3781779">.</span><span class="ident" id="3781780">Add</span><span class="op" id="3781783">(</span><span class="ident" id="3781784"><a href="/net/http/header.go.html#3781734">key</a></span><span class="op" id="3781787">,</span>&nbsp;<span class="ident" id="3781789"><a href="/net/http/header.go.html#3781739">value</a></span><span class="op" id="3781794">)</span><br>
<span class="lineno">25</span><span class="op" id="3781796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3781799">//&nbsp;Set&nbsp;sets&nbsp;the&nbsp;header&nbsp;entries&nbsp;associated&nbsp;with&nbsp;key&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3781853">//&nbsp;the&nbsp;single&nbsp;element&nbsp;value.&nbsp;&nbsp;It&nbsp;replaces&nbsp;any&nbsp;existing</span><br>
<span class="lineno"></span><span class="comment" id="3781908">//&nbsp;values&nbsp;associated&nbsp;with&nbsp;key.</span><br>
<span class="lineno">30</span><span class="keyword" id="3781939">func</span>&nbsp;<span class="op" id="3781944">(</span><span class="ident" id="3781945">h</span>&nbsp;<span class="ident" id="3781947"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3781953">)</span>&nbsp;<span class="ident" id="3781955">Set</span><span class="op" id="3781958">(</span><span class="ident" id="3781959">key</span><span class="op" id="3781962">,</span>&nbsp;<span class="ident" id="3781964">value</span>&nbsp;<span class="builtintype" id="3781970">string</span><span class="op" id="3781976">)</span>&nbsp;<span class="op" id="3781978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781981"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3781990">.</span><span class="ident" id="3781991">MIMEHeader</span><span class="op" id="3782001">(</span><span class="ident" id="3782002"><a href="/net/http/header.go.html#3781945">h</a></span><span class="op" id="3782003">)</span><span class="op" id="3782004">.</span><span class="ident" id="3782005">Set</span><span class="op" id="3782008">(</span><span class="ident" id="3782009"><a href="/net/http/header.go.html#3781959">key</a></span><span class="op" id="3782012">,</span>&nbsp;<span class="ident" id="3782014"><a href="/net/http/header.go.html#3781964">value</a></span><span class="op" id="3782019">)</span><br>
<span class="lineno"></span><span class="op" id="3782021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3782024">//&nbsp;Get&nbsp;gets&nbsp;the&nbsp;first&nbsp;value&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno">35</span><span class="comment" id="3782083">//&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;values&nbsp;associated&nbsp;with&nbsp;the&nbsp;key,&nbsp;Get&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3782150">//&nbsp;To&nbsp;access&nbsp;multiple&nbsp;values&nbsp;of&nbsp;a&nbsp;key,&nbsp;access&nbsp;the&nbsp;map&nbsp;directly</span><br>
<span class="lineno"></span><span class="comment" id="3782213">//&nbsp;with&nbsp;CanonicalHeaderKey.</span><br>
<span class="lineno"></span><span class="keyword" id="3782241">func</span>&nbsp;<span class="op" id="3782246">(</span><span class="ident" id="3782247">h</span>&nbsp;<span class="ident" id="3782249"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782255">)</span>&nbsp;<span class="ident" id="3782257">Get</span><span class="op" id="3782260">(</span><span class="ident" id="3782261">key</span>&nbsp;<span class="builtintype" id="3782265">string</span><span class="op" id="3782271">)</span>&nbsp;<span class="builtintype" id="3782273">string</span>&nbsp;<span class="op" id="3782280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782283">return</span>&nbsp;<span class="ident" id="3782290"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3782299">.</span><span class="ident" id="3782300">MIMEHeader</span><span class="op" id="3782310">(</span><span class="ident" id="3782311"><a href="/net/http/header.go.html#3782247">h</a></span><span class="op" id="3782312">)</span><span class="op" id="3782313">.</span><span class="ident" id="3782314">Get</span><span class="op" id="3782317">(</span><span class="ident" id="3782318"><a href="/net/http/header.go.html#3782261">key</a></span><span class="op" id="3782321">)</span><br>
<span class="lineno">40</span><span class="op" id="3782323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3782326">//&nbsp;get&nbsp;is&nbsp;like&nbsp;Get,&nbsp;but&nbsp;key&nbsp;must&nbsp;already&nbsp;be&nbsp;in&nbsp;CanonicalHeaderKey&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3782398">func</span>&nbsp;<span class="op" id="3782403">(</span><span class="ident" id="3782404">h</span>&nbsp;<span class="ident" id="3782406"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782412">)</span>&nbsp;<span class="ident" id="3782414">get</span><span class="op" id="3782417">(</span><span class="ident" id="3782418">key</span>&nbsp;<span class="builtintype" id="3782422">string</span><span class="op" id="3782428">)</span>&nbsp;<span class="builtintype" id="3782430">string</span>&nbsp;<span class="op" id="3782437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782440">if</span>&nbsp;<span class="ident" id="3782443">v</span>&nbsp;<span class="op" id="3782445">:=</span>&nbsp;<span class="ident" id="3782448"><a href="/net/http/header.go.html#3782404">h</a></span><span class="op" id="3782449">[</span><span class="ident" id="3782450"><a href="/net/http/header.go.html#3782418">key</a></span><span class="op" id="3782453">]</span><span class="op" id="3782454">;</span>&nbsp;<span class="builtinfunc" id="3782456">len</span><span class="op" id="3782459">(</span><span class="ident" id="3782460"><a href="/net/http/header.go.html#3782443">v</a></span><span class="op" id="3782461">)</span>&nbsp;<span class="op" id="3782463">&gt;</span>&nbsp;<span class="num" id="3782465">0</span>&nbsp;<span class="op" id="3782467">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782471">return</span>&nbsp;<span class="ident" id="3782478"><a href="/net/http/header.go.html#3782443">v</a></span><span class="op" id="3782479">[</span><span class="num" id="3782480">0</span><span class="op" id="3782481">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782487">return</span>&nbsp;<span class="string" id="3782494">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3782497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3782500">//&nbsp;Del&nbsp;deletes&nbsp;the&nbsp;values&nbsp;associated&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3782547">func</span>&nbsp;<span class="op" id="3782552">(</span><span class="ident" id="3782553">h</span>&nbsp;<span class="ident" id="3782555"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782561">)</span>&nbsp;<span class="ident" id="3782563">Del</span><span class="op" id="3782566">(</span><span class="ident" id="3782567">key</span>&nbsp;<span class="builtintype" id="3782571">string</span><span class="op" id="3782577">)</span>&nbsp;<span class="op" id="3782579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782582"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3782591">.</span><span class="ident" id="3782592">MIMEHeader</span><span class="op" id="3782602">(</span><span class="ident" id="3782603"><a href="/net/http/header.go.html#3782553">h</a></span><span class="op" id="3782604">)</span><span class="op" id="3782605">.</span><span class="ident" id="3782606">Del</span><span class="op" id="3782609">(</span><span class="ident" id="3782610"><a href="/net/http/header.go.html#3782567">key</a></span><span class="op" id="3782613">)</span><br>
<span class="lineno"></span><span class="op" id="3782615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3782618">//&nbsp;Write&nbsp;writes&nbsp;a&nbsp;header&nbsp;in&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="3782659">func</span>&nbsp;<span class="op" id="3782664">(</span><span class="ident" id="3782665">h</span>&nbsp;<span class="ident" id="3782667"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782673">)</span>&nbsp;<span class="ident" id="3782675">Write</span><span class="op" id="3782680">(</span><span class="ident" id="3782681">w</span>&nbsp;<span class="ident" id="3782683"><a href="/net/http/header.go.html#3781411">io</a></span><span class="op" id="3782685">.</span><span class="ident" id="3782686">Writer</span><span class="op" id="3782692">)</span>&nbsp;<span class="builtintype" id="3782694">error</span>&nbsp;<span class="op" id="3782700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782703">return</span>&nbsp;<span class="ident" id="3782710"><a href="/net/http/header.go.html#3782665">h</a></span><span class="op" id="3782711">.</span><span class="ident" id="3782712">WriteSubset</span><span class="op" id="3782723">(</span><span class="ident" id="3782724"><a href="/net/http/header.go.html#3782681">w</a></span><span class="op" id="3782725">,</span>&nbsp;<span class="ident" id="3782727">nil</span><span class="op" id="3782730">)</span><br>
<span class="lineno"></span><span class="op" id="3782732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3782735">func</span>&nbsp;<span class="op" id="3782740">(</span><span class="ident" id="3782741">h</span>&nbsp;<span class="ident" id="3782743"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782749">)</span>&nbsp;<span class="ident" id="3782751">clone</span><span class="op" id="3782756">(</span><span class="op" id="3782757">)</span>&nbsp;<span class="ident" id="3782759"><a href="/net/http/header.go.html#3781581">Header</a></span>&nbsp;<span class="op" id="3782766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782769">h2</span>&nbsp;<span class="op" id="3782772">:=</span>&nbsp;<span class="builtinfunc" id="3782775">make</span><span class="op" id="3782779">(</span><span class="ident" id="3782780"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3782786">,</span>&nbsp;<span class="builtinfunc" id="3782788">len</span><span class="op" id="3782791">(</span><span class="ident" id="3782792"><a href="/net/http/header.go.html#3782741">h</a></span><span class="op" id="3782793">)</span><span class="op" id="3782794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782797">for</span>&nbsp;<span class="ident" id="3782801">k</span><span class="op" id="3782802">,</span>&nbsp;<span class="ident" id="3782804">vv</span>&nbsp;<span class="op" id="3782807">:=</span>&nbsp;<span class="keyword" id="3782810">range</span>&nbsp;<span class="ident" id="3782816"><a href="/net/http/header.go.html#3782741">h</a></span>&nbsp;<span class="op" id="3782818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782822">vv2</span>&nbsp;<span class="op" id="3782826">:=</span>&nbsp;<span class="builtinfunc" id="3782829">make</span><span class="op" id="3782833">(</span><span class="op" id="3782834">[</span><span class="op" id="3782835">]</span><span class="builtintype" id="3782836">string</span><span class="op" id="3782842">,</span>&nbsp;<span class="builtinfunc" id="3782844">len</span><span class="op" id="3782847">(</span><span class="ident" id="3782848"><a href="/net/http/header.go.html#3782804">vv</a></span><span class="op" id="3782850">)</span><span class="op" id="3782851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3782855">copy</span><span class="op" id="3782859">(</span><span class="ident" id="3782860"><a href="/net/http/header.go.html#3782822">vv2</a></span><span class="op" id="3782863">,</span>&nbsp;<span class="ident" id="3782865"><a href="/net/http/header.go.html#3782804">vv</a></span><span class="op" id="3782867">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782871"><a href="/net/http/header.go.html#3782769">h2</a></span><span class="op" id="3782873">[</span><span class="ident" id="3782874"><a href="/net/http/header.go.html#3782801">k</a></span><span class="op" id="3782875">]</span>&nbsp;<span class="op" id="3782877">=</span>&nbsp;<span class="ident" id="3782879"><a href="/net/http/header.go.html#3782822">vv2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782887">return</span>&nbsp;<span class="ident" id="3782894"><a href="/net/http/header.go.html#3782769">h2</a></span><br>
<span class="lineno"></span><span class="op" id="3782897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3782900">var</span>&nbsp;<span class="ident" id="3782904">timeFormats</span>&nbsp;<span class="op" id="3782916">=</span>&nbsp;<span class="op" id="3782918">[</span><span class="op" id="3782919">]</span><span class="builtintype" id="3782920">string</span><span class="op" id="3782926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782929"><a href="/net/http/server.go.html#3839717">TimeFormat</a></span><span class="op" id="3782939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782942"><a href="/net/http/header.go.html#3781461">time</a></span><span class="op" id="3782946">.</span><span class="ident" id="3782947">RFC850</span><span class="op" id="3782953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782956"><a href="/net/http/header.go.html#3781461">time</a></span><span class="op" id="3782960">.</span><span class="ident" id="3782961">ANSIC</span><span class="op" id="3782966">,</span><br>
<span class="lineno"></span><span class="op" id="3782968">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3782971">//&nbsp;ParseTime&nbsp;parses&nbsp;a&nbsp;time&nbsp;header&nbsp;(such&nbsp;as&nbsp;the&nbsp;Date:&nbsp;header),</span><br>
<span class="lineno"></span><span class="comment" id="3783033">//&nbsp;trying&nbsp;each&nbsp;of&nbsp;the&nbsp;three&nbsp;formats&nbsp;allowed&nbsp;by&nbsp;HTTP/1.1:</span><br>
<span class="lineno"></span><span class="comment" id="3783090">//&nbsp;TimeFormat,&nbsp;time.RFC850,&nbsp;and&nbsp;time.ANSIC.</span><br>
<span class="lineno"></span><span class="keyword" id="3783134">func</span>&nbsp;<span class="ident" id="3783139">ParseTime</span><span class="op" id="3783148">(</span><span class="ident" id="3783149">text</span>&nbsp;<span class="builtintype" id="3783154">string</span><span class="op" id="3783160">)</span>&nbsp;<span class="op" id="3783162">(</span><span class="ident" id="3783163">t</span>&nbsp;<span class="ident" id="3783165"><a href="/net/http/header.go.html#3781461">time</a></span><span class="op" id="3783169">.</span><span class="ident" id="3783170">Time</span><span class="op" id="3783174">,</span>&nbsp;<span class="ident" id="3783176">err</span>&nbsp;<span class="builtintype" id="3783180">error</span><span class="op" id="3783185">)</span>&nbsp;<span class="op" id="3783187">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783190">for</span>&nbsp;<span class="ident" id="3783194">_</span><span class="op" id="3783195">,</span>&nbsp;<span class="ident" id="3783197">layout</span>&nbsp;<span class="op" id="3783204">:=</span>&nbsp;<span class="keyword" id="3783207">range</span>&nbsp;<span class="ident" id="3783213"><a href="/net/http/header.go.html#3782904">timeFormats</a></span>&nbsp;<span class="op" id="3783225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783229"><a href="/net/http/header.go.html#3783163">t</a></span><span class="op" id="3783230">,</span>&nbsp;<span class="ident" id="3783232"><a href="/net/http/header.go.html#3783176">err</a></span>&nbsp;<span class="op" id="3783236">=</span>&nbsp;<span class="ident" id="3783238"><a href="/net/http/header.go.html#3781461">time</a></span><span class="op" id="3783242">.</span><span class="ident" id="3783243">Parse</span><span class="op" id="3783248">(</span><span class="ident" id="3783249"><a href="/net/http/header.go.html#3783197">layout</a></span><span class="op" id="3783255">,</span>&nbsp;<span class="ident" id="3783257"><a href="/net/http/header.go.html#3783149">text</a></span><span class="op" id="3783261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783265">if</span>&nbsp;<span class="ident" id="3783268"><a href="/net/http/header.go.html#3783176">err</a></span>&nbsp;<span class="op" id="3783272">==</span>&nbsp;<span class="ident" id="3783275">nil</span>&nbsp;<span class="op" id="3783279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783284">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783293">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783299">return</span><br>
<span class="lineno"></span><span class="op" id="3783306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3783309">var</span>&nbsp;<span class="ident" id="3783313">headerNewlineToSpace</span>&nbsp;<span class="op" id="3783334">=</span>&nbsp;<span class="ident" id="3783336"><a href="/net/http/header.go.html#3781442">strings</a></span><span class="op" id="3783343">.</span><span class="ident" id="3783344">NewReplacer</span><span class="op" id="3783355">(</span><span class="string" id="3783356">&#34;\n&#34;</span><span class="op" id="3783360">,</span>&nbsp;<span class="string" id="3783362">&#34;&nbsp;&#34;</span><span class="op" id="3783365">,</span>&nbsp;<span class="string" id="3783367">&#34;\r&#34;</span><span class="op" id="3783371">,</span>&nbsp;<span class="string" id="3783373">&#34;&nbsp;&#34;</span><span class="op" id="3783376">)</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="3783379">type</span>&nbsp;<span class="ident" id="3783384">writeStringer</span>&nbsp;<span class="keyword" id="3783398">interface</span>&nbsp;<span class="op" id="3783408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783411">WriteString</span><span class="op" id="3783422">(</span><span class="builtintype" id="3783423">string</span><span class="op" id="3783429">)</span>&nbsp;<span class="op" id="3783431">(</span><span class="builtintype" id="3783432">int</span><span class="op" id="3783435">,</span>&nbsp;<span class="builtintype" id="3783437">error</span><span class="op" id="3783442">)</span><br>
<span class="lineno"></span><span class="op" id="3783444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3783447">//&nbsp;stringWriter&nbsp;implements&nbsp;WriteString&nbsp;on&nbsp;a&nbsp;Writer.</span><br>
<span class="lineno"></span><span class="keyword" id="3783499">type</span>&nbsp;<span class="ident" id="3783504">stringWriter</span>&nbsp;<span class="keyword" id="3783517">struct</span>&nbsp;<span class="op" id="3783524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783527">w</span>&nbsp;<span class="ident" id="3783529"><a href="/net/http/header.go.html#3781411">io</a></span><span class="op" id="3783531">.</span><span class="ident" id="3783532">Writer</span><br>
<span class="lineno"></span><span class="op" id="3783539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3783542">func</span>&nbsp;<span class="op" id="3783547">(</span><span class="ident" id="3783548">w</span>&nbsp;<span class="ident" id="3783550"><a href="/net/http/header.go.html#3783504">stringWriter</a></span><span class="op" id="3783562">)</span>&nbsp;<span class="ident" id="3783564">WriteString</span><span class="op" id="3783575">(</span><span class="ident" id="3783576">s</span>&nbsp;<span class="builtintype" id="3783578">string</span><span class="op" id="3783584">)</span>&nbsp;<span class="op" id="3783586">(</span><span class="ident" id="3783587">n</span>&nbsp;<span class="builtintype" id="3783589">int</span><span class="op" id="3783592">,</span>&nbsp;<span class="ident" id="3783594">err</span>&nbsp;<span class="builtintype" id="3783598">error</span><span class="op" id="3783603">)</span>&nbsp;<span class="op" id="3783605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783608">return</span>&nbsp;<span class="ident" id="3783615"><a href="/net/http/header.go.html#3783548">w</a></span><span class="op" id="3783616">.</span><span class="ident" id="3783617">w</span><span class="op" id="3783618">.</span><span class="ident" id="3783619">Write</span><span class="op" id="3783624">(</span><span class="op" id="3783625">[</span><span class="op" id="3783626">]</span><span class="builtintype" id="3783627">byte</span><span class="op" id="3783631">(</span><span class="ident" id="3783632"><a href="/net/http/header.go.html#3783576">s</a></span><span class="op" id="3783633">)</span><span class="op" id="3783634">)</span><br>
<span class="lineno"></span><span class="op" id="3783636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3783639">type</span>&nbsp;<span class="ident" id="3783644">keyValues</span>&nbsp;<span class="keyword" id="3783654">struct</span>&nbsp;<span class="op" id="3783661">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783664">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3783671">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783679">values</span>&nbsp;<span class="op" id="3783686">[</span><span class="op" id="3783687">]</span><span class="builtintype" id="3783688">string</span><br>
<span class="lineno"></span><span class="op" id="3783695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3783698">//&nbsp;A&nbsp;headerSorter&nbsp;implements&nbsp;sort.Interface&nbsp;by&nbsp;sorting&nbsp;a&nbsp;[]keyValues</span><br>
<span class="lineno">110</span><span class="comment" id="3783767">//&nbsp;by&nbsp;key.&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;pointer,&nbsp;so&nbsp;it&nbsp;can&nbsp;fit&nbsp;in&nbsp;a&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="comment" id="3783836">//&nbsp;interface&nbsp;value&nbsp;without&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3783875">type</span>&nbsp;<span class="ident" id="3783880">headerSorter</span>&nbsp;<span class="keyword" id="3783893">struct</span>&nbsp;<span class="op" id="3783900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783903">kvs</span>&nbsp;<span class="op" id="3783907">[</span><span class="op" id="3783908">]</span><span class="ident" id="3783909"><a href="/net/http/header.go.html#3783644">keyValues</a></span><br>
<span class="lineno"></span><span class="op" id="3783919">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="3783922">func</span>&nbsp;<span class="op" id="3783927">(</span><span class="ident" id="3783928">s</span>&nbsp;<span class="op" id="3783930">*</span><span class="ident" id="3783931"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3783943">)</span>&nbsp;<span class="ident" id="3783945">Len</span><span class="op" id="3783948">(</span><span class="op" id="3783949">)</span>&nbsp;<span class="builtintype" id="3783951">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3783965">{</span>&nbsp;<span class="keyword" id="3783967">return</span>&nbsp;<span class="builtinfunc" id="3783974">len</span><span class="op" id="3783977">(</span><span class="ident" id="3783978"><a href="/net/http/header.go.html#3783928">s</a></span><span class="op" id="3783979">.</span><span class="ident" id="3783980">kvs</span><span class="op" id="3783983">)</span>&nbsp;<span class="op" id="3783985">}</span><br>
<span class="lineno"></span><span class="keyword" id="3783987">func</span>&nbsp;<span class="op" id="3783992">(</span><span class="ident" id="3783993">s</span>&nbsp;<span class="op" id="3783995">*</span><span class="ident" id="3783996"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3784008">)</span>&nbsp;<span class="ident" id="3784010">Swap</span><span class="op" id="3784014">(</span><span class="ident" id="3784015">i</span><span class="op" id="3784016">,</span>&nbsp;<span class="ident" id="3784018">j</span>&nbsp;<span class="builtintype" id="3784020">int</span><span class="op" id="3784023">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3784030">{</span>&nbsp;<span class="ident" id="3784032"><a href="/net/http/header.go.html#3783993">s</a></span><span class="op" id="3784033">.</span><span class="ident" id="3784034">kvs</span><span class="op" id="3784037">[</span><span class="ident" id="3784038"><a href="/net/http/header.go.html#3784015">i</a></span><span class="op" id="3784039">]</span><span class="op" id="3784040">,</span>&nbsp;<span class="ident" id="3784042"><a href="/net/http/header.go.html#3783993">s</a></span><span class="op" id="3784043">.</span><span class="ident" id="3784044">kvs</span><span class="op" id="3784047">[</span><span class="ident" id="3784048"><a href="/net/http/header.go.html#3784018">j</a></span><span class="op" id="3784049">]</span>&nbsp;<span class="op" id="3784051">=</span>&nbsp;<span class="ident" id="3784053"><a href="/net/http/header.go.html#3783993">s</a></span><span class="op" id="3784054">.</span><span class="ident" id="3784055">kvs</span><span class="op" id="3784058">[</span><span class="ident" id="3784059"><a href="/net/http/header.go.html#3784018">j</a></span><span class="op" id="3784060">]</span><span class="op" id="3784061">,</span>&nbsp;<span class="ident" id="3784063"><a href="/net/http/header.go.html#3783993">s</a></span><span class="op" id="3784064">.</span><span class="ident" id="3784065">kvs</span><span class="op" id="3784068">[</span><span class="ident" id="3784069"><a href="/net/http/header.go.html#3784015">i</a></span><span class="op" id="3784070">]</span>&nbsp;<span class="op" id="3784072">}</span><br>
<span class="lineno"></span><span class="keyword" id="3784074">func</span>&nbsp;<span class="op" id="3784079">(</span><span class="ident" id="3784080">s</span>&nbsp;<span class="op" id="3784082">*</span><span class="ident" id="3784083"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3784095">)</span>&nbsp;<span class="ident" id="3784097">Less</span><span class="op" id="3784101">(</span><span class="ident" id="3784102">i</span><span class="op" id="3784103">,</span>&nbsp;<span class="ident" id="3784105">j</span>&nbsp;<span class="builtintype" id="3784107">int</span><span class="op" id="3784110">)</span>&nbsp;<span class="builtintype" id="3784112">bool</span>&nbsp;<span class="op" id="3784117">{</span>&nbsp;<span class="keyword" id="3784119">return</span>&nbsp;<span class="ident" id="3784126"><a href="/net/http/header.go.html#3784080">s</a></span><span class="op" id="3784127">.</span><span class="ident" id="3784128">kvs</span><span class="op" id="3784131">[</span><span class="ident" id="3784132"><a href="/net/http/header.go.html#3784102">i</a></span><span class="op" id="3784133">]</span><span class="op" id="3784134">.</span><span class="ident" id="3784135">key</span>&nbsp;<span class="op" id="3784139">&lt;</span>&nbsp;<span class="ident" id="3784141"><a href="/net/http/header.go.html#3784080">s</a></span><span class="op" id="3784142">.</span><span class="ident" id="3784143">kvs</span><span class="op" id="3784146">[</span><span class="ident" id="3784147"><a href="/net/http/header.go.html#3784105">j</a></span><span class="op" id="3784148">]</span><span class="op" id="3784149">.</span><span class="ident" id="3784150">key</span>&nbsp;<span class="op" id="3784154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="3784157">var</span>&nbsp;<span class="ident" id="3784161">headerSorterPool</span>&nbsp;<span class="op" id="3784178">=</span>&nbsp;<span class="ident" id="3784180"><a href="/net/http/header.go.html#3781453">sync</a></span><span class="op" id="3784184">.</span><span class="ident" id="3784185">Pool</span><span class="op" id="3784189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784192">New</span><span class="op" id="3784195">:</span>&nbsp;<span class="keyword" id="3784197">func</span><span class="op" id="3784201">(</span><span class="op" id="3784202">)</span>&nbsp;<span class="keyword" id="3784204">interface</span><span class="op" id="3784213">{</span><span class="op" id="3784214">}</span>&nbsp;<span class="op" id="3784216">{</span>&nbsp;<span class="keyword" id="3784218">return</span>&nbsp;<span class="builtinfunc" id="3784225">new</span><span class="op" id="3784228">(</span><span class="ident" id="3784229"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3784241">)</span>&nbsp;<span class="op" id="3784243">}</span><span class="op" id="3784244">,</span><br>
<span class="lineno"></span><span class="op" id="3784246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3784249">//&nbsp;sortedKeyValues&nbsp;returns&nbsp;h&#39;s&nbsp;keys&nbsp;sorted&nbsp;in&nbsp;the&nbsp;returned&nbsp;kvs</span><br>
<span class="lineno">125</span><span class="comment" id="3784312">//&nbsp;slice.&nbsp;The&nbsp;headerSorter&nbsp;used&nbsp;to&nbsp;sort&nbsp;is&nbsp;also&nbsp;returned,&nbsp;for&nbsp;possible</span><br>
<span class="lineno"></span><span class="comment" id="3784383">//&nbsp;return&nbsp;to&nbsp;headerSorterCache.</span><br>
<span class="lineno"></span><span class="keyword" id="3784415">func</span>&nbsp;<span class="op" id="3784420">(</span><span class="ident" id="3784421">h</span>&nbsp;<span class="ident" id="3784423"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3784429">)</span>&nbsp;<span class="ident" id="3784431">sortedKeyValues</span><span class="op" id="3784446">(</span><span class="ident" id="3784447">exclude</span>&nbsp;<span class="keyword" id="3784455">map</span><span class="op" id="3784458">[</span><span class="builtintype" id="3784459">string</span><span class="op" id="3784465">]</span><span class="builtintype" id="3784466">bool</span><span class="op" id="3784470">)</span>&nbsp;<span class="op" id="3784472">(</span><span class="ident" id="3784473">kvs</span>&nbsp;<span class="op" id="3784477">[</span><span class="op" id="3784478">]</span><span class="ident" id="3784479"><a href="/net/http/header.go.html#3783644">keyValues</a></span><span class="op" id="3784488">,</span>&nbsp;<span class="ident" id="3784490">hs</span>&nbsp;<span class="op" id="3784493">*</span><span class="ident" id="3784494"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3784506">)</span>&nbsp;<span class="op" id="3784508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784511"><a href="/net/http/header.go.html#3784490">hs</a></span>&nbsp;<span class="op" id="3784514">=</span>&nbsp;<span class="ident" id="3784516"><a href="/net/http/header.go.html#3784161">headerSorterPool</a></span><span class="op" id="3784532">.</span><span class="ident" id="3784533">Get</span><span class="op" id="3784536">(</span><span class="op" id="3784537">)</span><span class="op" id="3784538">.</span><span class="op" id="3784539">(</span><span class="op" id="3784540">*</span><span class="ident" id="3784541"><a href="/net/http/header.go.html#3783880">headerSorter</a></span><span class="op" id="3784553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784556">if</span>&nbsp;<span class="builtinfunc" id="3784559">cap</span><span class="op" id="3784562">(</span><span class="ident" id="3784563"><a href="/net/http/header.go.html#3784490">hs</a></span><span class="op" id="3784565">.</span><span class="ident" id="3784566">kvs</span><span class="op" id="3784569">)</span>&nbsp;<span class="op" id="3784571">&lt;</span>&nbsp;<span class="builtinfunc" id="3784573">len</span><span class="op" id="3784576">(</span><span class="ident" id="3784577"><a href="/net/http/header.go.html#3784421">h</a></span><span class="op" id="3784578">)</span>&nbsp;<span class="op" id="3784580">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784584"><a href="/net/http/header.go.html#3784490">hs</a></span><span class="op" id="3784586">.</span><span class="ident" id="3784587">kvs</span>&nbsp;<span class="op" id="3784591">=</span>&nbsp;<span class="builtinfunc" id="3784593">make</span><span class="op" id="3784597">(</span><span class="op" id="3784598">[</span><span class="op" id="3784599">]</span><span class="ident" id="3784600"><a href="/net/http/header.go.html#3783644">keyValues</a></span><span class="op" id="3784609">,</span>&nbsp;<span class="num" id="3784611">0</span><span class="op" id="3784612">,</span>&nbsp;<span class="builtinfunc" id="3784614">len</span><span class="op" id="3784617">(</span><span class="ident" id="3784618"><a href="/net/http/header.go.html#3784421">h</a></span><span class="op" id="3784619">)</span><span class="op" id="3784620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784626"><a href="/net/http/header.go.html#3784473">kvs</a></span>&nbsp;<span class="op" id="3784630">=</span>&nbsp;<span class="ident" id="3784632"><a href="/net/http/header.go.html#3784490">hs</a></span><span class="op" id="3784634">.</span><span class="ident" id="3784635">kvs</span><span class="op" id="3784638">[</span><span class="op" id="3784639">:</span><span class="num" id="3784640">0</span><span class="op" id="3784641">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784644">for</span>&nbsp;<span class="ident" id="3784648">k</span><span class="op" id="3784649">,</span>&nbsp;<span class="ident" id="3784651">vv</span>&nbsp;<span class="op" id="3784654">:=</span>&nbsp;<span class="keyword" id="3784657">range</span>&nbsp;<span class="ident" id="3784663"><a href="/net/http/header.go.html#3784421">h</a></span>&nbsp;<span class="op" id="3784665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784669">if</span>&nbsp;<span class="op" id="3784672">!</span><span class="ident" id="3784673"><a href="/net/http/header.go.html#3784447">exclude</a></span><span class="op" id="3784680">[</span><span class="ident" id="3784681"><a href="/net/http/header.go.html#3784648">k</a></span><span class="op" id="3784682">]</span>&nbsp;<span class="op" id="3784684">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784689"><a href="/net/http/header.go.html#3784473">kvs</a></span>&nbsp;<span class="op" id="3784693">=</span>&nbsp;<span class="builtinfunc" id="3784695">append</span><span class="op" id="3784701">(</span><span class="ident" id="3784702"><a href="/net/http/header.go.html#3784473">kvs</a></span><span class="op" id="3784705">,</span>&nbsp;<span class="ident" id="3784707"><a href="/net/http/header.go.html#3783644">keyValues</a></span><span class="op" id="3784716">{</span><span class="ident" id="3784717"><a href="/net/http/header.go.html#3784648">k</a></span><span class="op" id="3784718">,</span>&nbsp;<span class="ident" id="3784720"><a href="/net/http/header.go.html#3784651">vv</a></span><span class="op" id="3784722">}</span><span class="op" id="3784723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784733"><a href="/net/http/header.go.html#3784490">hs</a></span><span class="op" id="3784735">.</span><span class="ident" id="3784736">kvs</span>&nbsp;<span class="op" id="3784740">=</span>&nbsp;<span class="ident" id="3784742"><a href="/net/http/header.go.html#3784473">kvs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784747"><a href="/net/http/header.go.html#3781434">sort</a></span><span class="op" id="3784751">.</span><span class="ident" id="3784752">Sort</span><span class="op" id="3784756">(</span><span class="ident" id="3784757"><a href="/net/http/header.go.html#3784490">hs</a></span><span class="op" id="3784759">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784762">return</span>&nbsp;<span class="ident" id="3784769"><a href="/net/http/header.go.html#3784473">kvs</a></span><span class="op" id="3784772">,</span>&nbsp;<span class="ident" id="3784774"><a href="/net/http/header.go.html#3784490">hs</a></span><br>
<span class="lineno"></span><span class="op" id="3784777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3784780">//&nbsp;WriteSubset&nbsp;writes&nbsp;a&nbsp;header&nbsp;in&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3784827">//&nbsp;If&nbsp;exclude&nbsp;is&nbsp;not&nbsp;nil,&nbsp;keys&nbsp;where&nbsp;exclude[key]&nbsp;==&nbsp;true&nbsp;are&nbsp;not&nbsp;written.</span><br>
<span class="lineno">145</span><span class="keyword" id="3784902">func</span>&nbsp;<span class="op" id="3784907">(</span><span class="ident" id="3784908">h</span>&nbsp;<span class="ident" id="3784910"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3784916">)</span>&nbsp;<span class="ident" id="3784918">WriteSubset</span><span class="op" id="3784929">(</span><span class="ident" id="3784930">w</span>&nbsp;<span class="ident" id="3784932"><a href="/net/http/header.go.html#3781411">io</a></span><span class="op" id="3784934">.</span><span class="ident" id="3784935">Writer</span><span class="op" id="3784941">,</span>&nbsp;<span class="ident" id="3784943">exclude</span>&nbsp;<span class="keyword" id="3784951">map</span><span class="op" id="3784954">[</span><span class="builtintype" id="3784955">string</span><span class="op" id="3784961">]</span><span class="builtintype" id="3784962">bool</span><span class="op" id="3784966">)</span>&nbsp;<span class="builtintype" id="3784968">error</span>&nbsp;<span class="op" id="3784974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784977">ws</span><span class="op" id="3784979">,</span>&nbsp;<span class="ident" id="3784981">ok</span>&nbsp;<span class="op" id="3784984">:=</span>&nbsp;<span class="ident" id="3784987"><a href="/net/http/header.go.html#3784930">w</a></span><span class="op" id="3784988">.</span><span class="op" id="3784989">(</span><span class="ident" id="3784990"><a href="/net/http/header.go.html#3783384">writeStringer</a></span><span class="op" id="3785003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785006">if</span>&nbsp;<span class="op" id="3785009">!</span><span class="ident" id="3785010"><a href="/net/http/header.go.html#3784981">ok</a></span>&nbsp;<span class="op" id="3785013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785017"><a href="/net/http/header.go.html#3784977">ws</a></span>&nbsp;<span class="op" id="3785020">=</span>&nbsp;<span class="ident" id="3785022"><a href="/net/http/header.go.html#3783504">stringWriter</a></span><span class="op" id="3785034">{</span><span class="ident" id="3785035"><a href="/net/http/header.go.html#3784930">w</a></span><span class="op" id="3785036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785039">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785042">kvs</span><span class="op" id="3785045">,</span>&nbsp;<span class="ident" id="3785047">sorter</span>&nbsp;<span class="op" id="3785054">:=</span>&nbsp;<span class="ident" id="3785057"><a href="/net/http/header.go.html#3784908">h</a></span><span class="op" id="3785058">.</span><span class="ident" id="3785059">sortedKeyValues</span><span class="op" id="3785074">(</span><span class="ident" id="3785075"><a href="/net/http/header.go.html#3784943">exclude</a></span><span class="op" id="3785082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785085">for</span>&nbsp;<span class="ident" id="3785089">_</span><span class="op" id="3785090">,</span>&nbsp;<span class="ident" id="3785092">kv</span>&nbsp;<span class="op" id="3785095">:=</span>&nbsp;<span class="keyword" id="3785098">range</span>&nbsp;<span class="ident" id="3785104"><a href="/net/http/header.go.html#3785042">kvs</a></span>&nbsp;<span class="op" id="3785108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785112">for</span>&nbsp;<span class="ident" id="3785116">_</span><span class="op" id="3785117">,</span>&nbsp;<span class="ident" id="3785119">v</span>&nbsp;<span class="op" id="3785121">:=</span>&nbsp;<span class="keyword" id="3785124">range</span>&nbsp;<span class="ident" id="3785130"><a href="/net/http/header.go.html#3785092">kv</a></span><span class="op" id="3785132">.</span><span class="ident" id="3785133">values</span>&nbsp;<span class="op" id="3785140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785145"><a href="/net/http/header.go.html#3785119">v</a></span>&nbsp;<span class="op" id="3785147">=</span>&nbsp;<span class="ident" id="3785149"><a href="/net/http/header.go.html#3783313">headerNewlineToSpace</a></span><span class="op" id="3785169">.</span><span class="ident" id="3785170">Replace</span><span class="op" id="3785177">(</span><span class="ident" id="3785178"><a href="/net/http/header.go.html#3785119">v</a></span><span class="op" id="3785179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785184"><a href="/net/http/header.go.html#3785119">v</a></span>&nbsp;<span class="op" id="3785186">=</span>&nbsp;<span class="ident" id="3785188"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3785197">.</span><span class="ident" id="3785198">TrimString</span><span class="op" id="3785208">(</span><span class="ident" id="3785209"><a href="/net/http/header.go.html#3785119">v</a></span><span class="op" id="3785210">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785215">for</span>&nbsp;<span class="ident" id="3785219">_</span><span class="op" id="3785220">,</span>&nbsp;<span class="ident" id="3785222">s</span>&nbsp;<span class="op" id="3785224">:=</span>&nbsp;<span class="keyword" id="3785227">range</span>&nbsp;<span class="op" id="3785233">[</span><span class="op" id="3785234">]</span><span class="builtintype" id="3785235">string</span><span class="op" id="3785241">{</span><span class="ident" id="3785242"><a href="/net/http/header.go.html#3785092">kv</a></span><span class="op" id="3785244">.</span><span class="ident" id="3785245">key</span><span class="op" id="3785248">,</span>&nbsp;<span class="string" id="3785250">&#34;:&nbsp;&#34;</span><span class="op" id="3785254">,</span>&nbsp;<span class="ident" id="3785256"><a href="/net/http/header.go.html#3785119">v</a></span><span class="op" id="3785257">,</span>&nbsp;<span class="string" id="3785259">&#34;\r\n&#34;</span><span class="op" id="3785265">}</span>&nbsp;<span class="op" id="3785267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785273">if</span>&nbsp;<span class="ident" id="3785276">_</span><span class="op" id="3785277">,</span>&nbsp;<span class="ident" id="3785279">err</span>&nbsp;<span class="op" id="3785283">:=</span>&nbsp;<span class="ident" id="3785286"><a href="/net/http/header.go.html#3784977">ws</a></span><span class="op" id="3785288">.</span><span class="ident" id="3785289">WriteString</span><span class="op" id="3785300">(</span><span class="ident" id="3785301"><a href="/net/http/header.go.html#3785222">s</a></span><span class="op" id="3785302">)</span><span class="op" id="3785303">;</span>&nbsp;<span class="ident" id="3785305"><a href="/net/http/header.go.html#3785279">err</a></span>&nbsp;<span class="op" id="3785309">!=</span>&nbsp;<span class="ident" id="3785312">nil</span>&nbsp;<span class="op" id="3785316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785323">return</span>&nbsp;<span class="ident" id="3785330"><a href="/net/http/header.go.html#3785279">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785343">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785353"><a href="/net/http/header.go.html#3784161">headerSorterPool</a></span><span class="op" id="3785369">.</span><span class="ident" id="3785370">Put</span><span class="op" id="3785373">(</span><span class="ident" id="3785374"><a href="/net/http/header.go.html#3785047">sorter</a></span><span class="op" id="3785380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785383">return</span>&nbsp;<span class="ident" id="3785390">nil</span><br>
<span class="lineno"></span><span class="op" id="3785394">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3785397">//&nbsp;CanonicalHeaderKey&nbsp;returns&nbsp;the&nbsp;canonical&nbsp;format&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3785455">//&nbsp;header&nbsp;key&nbsp;s.&nbsp;&nbsp;The&nbsp;canonicalization&nbsp;converts&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="3785513">//&nbsp;letter&nbsp;and&nbsp;any&nbsp;letter&nbsp;following&nbsp;a&nbsp;hyphen&nbsp;to&nbsp;upper&nbsp;case;</span><br>
<span class="lineno"></span><span class="comment" id="3785572">//&nbsp;the&nbsp;rest&nbsp;are&nbsp;converted&nbsp;to&nbsp;lowercase.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno">170</span><span class="comment" id="3785630">//&nbsp;canonical&nbsp;key&nbsp;for&nbsp;&#34;accept-encoding&#34;&nbsp;is&nbsp;&#34;Accept-Encoding&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3785691">func</span>&nbsp;<span class="ident" id="3785696">CanonicalHeaderKey</span><span class="op" id="3785714">(</span><span class="ident" id="3785715">s</span>&nbsp;<span class="builtintype" id="3785717">string</span><span class="op" id="3785723">)</span>&nbsp;<span class="builtintype" id="3785725">string</span>&nbsp;<span class="op" id="3785732">{</span>&nbsp;<span class="keyword" id="3785734">return</span>&nbsp;<span class="ident" id="3785741"><a href="/net/http/header.go.html#3781417">textproto</a></span><span class="op" id="3785750">.</span><span class="ident" id="3785751">CanonicalMIMEHeaderKey</span><span class="op" id="3785773">(</span><span class="ident" id="3785774"><a href="/net/http/header.go.html#3785715">s</a></span><span class="op" id="3785775">)</span>&nbsp;<span class="op" id="3785777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3785780">//&nbsp;hasToken&nbsp;reports&nbsp;whether&nbsp;token&nbsp;appears&nbsp;with&nbsp;v,&nbsp;ASCII</span><br>
<span class="lineno"></span><span class="comment" id="3785836">//&nbsp;case-insensitive,&nbsp;with&nbsp;space&nbsp;or&nbsp;comma&nbsp;boundaries.</span><br>
<span class="lineno">175</span><span class="comment" id="3785889">//&nbsp;token&nbsp;must&nbsp;be&nbsp;all&nbsp;lowercase.</span><br>
<span class="lineno"></span><span class="comment" id="3785921">//&nbsp;v&nbsp;may&nbsp;contain&nbsp;mixed&nbsp;cased.</span><br>
<span class="lineno"></span><span class="keyword" id="3785951">func</span>&nbsp;<span class="ident" id="3785956">hasToken</span><span class="op" id="3785964">(</span><span class="ident" id="3785965">v</span><span class="op" id="3785966">,</span>&nbsp;<span class="ident" id="3785968">token</span>&nbsp;<span class="builtintype" id="3785974">string</span><span class="op" id="3785980">)</span>&nbsp;<span class="builtintype" id="3785982">bool</span>&nbsp;<span class="op" id="3785987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785990">if</span>&nbsp;<span class="builtinfunc" id="3785993">len</span><span class="op" id="3785996">(</span><span class="ident" id="3785997"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786002">)</span>&nbsp;<span class="op" id="3786004">&gt;</span>&nbsp;<span class="builtinfunc" id="3786006">len</span><span class="op" id="3786009">(</span><span class="ident" id="3786010"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786011">)</span>&nbsp;<span class="op" id="3786013">||</span>&nbsp;<span class="ident" id="3786016"><a href="/net/http/header.go.html#3785968">token</a></span>&nbsp;<span class="op" id="3786022">==</span>&nbsp;<span class="string" id="3786025">&#34;&#34;</span>&nbsp;<span class="op" id="3786028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786032">return</span>&nbsp;<span class="ident" id="3786039">false</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786049">if</span>&nbsp;<span class="ident" id="3786052"><a href="/net/http/header.go.html#3785965">v</a></span>&nbsp;<span class="op" id="3786054">==</span>&nbsp;<span class="ident" id="3786057"><a href="/net/http/header.go.html#3785968">token</a></span>&nbsp;<span class="op" id="3786063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786067">return</span>&nbsp;<span class="ident" id="3786074">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786083">for</span>&nbsp;<span class="ident" id="3786087">sp</span>&nbsp;<span class="op" id="3786090">:=</span>&nbsp;<span class="num" id="3786093">0</span><span class="op" id="3786094">;</span>&nbsp;<span class="ident" id="3786096"><a href="/net/http/header.go.html#3786087">sp</a></span>&nbsp;<span class="op" id="3786099">&lt;=</span>&nbsp;<span class="builtinfunc" id="3786102">len</span><span class="op" id="3786105">(</span><span class="ident" id="3786106"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786107">)</span><span class="op" id="3786108">-</span><span class="builtinfunc" id="3786109">len</span><span class="op" id="3786112">(</span><span class="ident" id="3786113"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786118">)</span><span class="op" id="3786119">;</span>&nbsp;<span class="ident" id="3786121"><a href="/net/http/header.go.html#3786087">sp</a></span><span class="op" id="3786123">++</span>&nbsp;<span class="op" id="3786126">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786130">//&nbsp;Check&nbsp;that&nbsp;first&nbsp;character&nbsp;is&nbsp;good.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786171">//&nbsp;The&nbsp;token&nbsp;is&nbsp;ASCII,&nbsp;so&nbsp;checking&nbsp;only&nbsp;a&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786227">//&nbsp;is&nbsp;sufficient.&nbsp;&nbsp;We&nbsp;skip&nbsp;this&nbsp;potential&nbsp;starting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786280">//&nbsp;position&nbsp;if&nbsp;both&nbsp;the&nbsp;first&nbsp;byte&nbsp;and&nbsp;its&nbsp;potential</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786335">//&nbsp;ASCII&nbsp;uppercase&nbsp;equivalent&nbsp;(b|0x20)&nbsp;don&#39;t&nbsp;match.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786389">//&nbsp;False&nbsp;positives&nbsp;(&#39;^&#39;&nbsp;=&gt;&nbsp;&#39;~&#39;)&nbsp;are&nbsp;caught&nbsp;by&nbsp;EqualFold.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786448">if</span>&nbsp;<span class="ident" id="3786451">b</span>&nbsp;<span class="op" id="3786453">:=</span>&nbsp;<span class="ident" id="3786456"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786457">[</span><span class="ident" id="3786458"><a href="/net/http/header.go.html#3786087">sp</a></span><span class="op" id="3786460">]</span><span class="op" id="3786461">;</span>&nbsp;<span class="ident" id="3786463"><a href="/net/http/header.go.html#3786451">b</a></span>&nbsp;<span class="op" id="3786465">!=</span>&nbsp;<span class="ident" id="3786468"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786473">[</span><span class="num" id="3786474">0</span><span class="op" id="3786475">]</span>&nbsp;<span class="op" id="3786477">&amp;&amp;</span>&nbsp;<span class="ident" id="3786480"><a href="/net/http/header.go.html#3786451">b</a></span><span class="op" id="3786481">|</span><span class="num" id="3786482">0x20</span>&nbsp;<span class="op" id="3786487">!=</span>&nbsp;<span class="ident" id="3786490"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786495">[</span><span class="num" id="3786496">0</span><span class="op" id="3786497">]</span>&nbsp;<span class="op" id="3786499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786504">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786519">//&nbsp;Check&nbsp;that&nbsp;start&nbsp;pos&nbsp;is&nbsp;on&nbsp;a&nbsp;valid&nbsp;token&nbsp;boundary.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786575">if</span>&nbsp;<span class="ident" id="3786578"><a href="/net/http/header.go.html#3786087">sp</a></span>&nbsp;<span class="op" id="3786581">&gt;</span>&nbsp;<span class="num" id="3786583">0</span>&nbsp;<span class="op" id="3786585">&amp;&amp;</span>&nbsp;<span class="op" id="3786588">!</span><span class="ident" id="3786589"><a href="/net/http/header.go.html#3786881">isTokenBoundary</a></span><span class="op" id="3786604">(</span><span class="ident" id="3786605"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786606">[</span><span class="ident" id="3786607"><a href="/net/http/header.go.html#3786087">sp</a></span><span class="op" id="3786609">-</span><span class="num" id="3786610">1</span><span class="op" id="3786611">]</span><span class="op" id="3786612">)</span>&nbsp;<span class="op" id="3786614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786619">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786634">//&nbsp;Check&nbsp;that&nbsp;end&nbsp;pos&nbsp;is&nbsp;on&nbsp;a&nbsp;valid&nbsp;token&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786688">if</span>&nbsp;<span class="ident" id="3786691">endPos</span>&nbsp;<span class="op" id="3786698">:=</span>&nbsp;<span class="ident" id="3786701"><a href="/net/http/header.go.html#3786087">sp</a></span>&nbsp;<span class="op" id="3786704">+</span>&nbsp;<span class="builtinfunc" id="3786706">len</span><span class="op" id="3786709">(</span><span class="ident" id="3786710"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786715">)</span><span class="op" id="3786716">;</span>&nbsp;<span class="ident" id="3786718"><a href="/net/http/header.go.html#3786691">endPos</a></span>&nbsp;<span class="op" id="3786725">!=</span>&nbsp;<span class="builtinfunc" id="3786728">len</span><span class="op" id="3786731">(</span><span class="ident" id="3786732"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786733">)</span>&nbsp;<span class="op" id="3786735">&amp;&amp;</span>&nbsp;<span class="op" id="3786738">!</span><span class="ident" id="3786739"><a href="/net/http/header.go.html#3786881">isTokenBoundary</a></span><span class="op" id="3786754">(</span><span class="ident" id="3786755"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786756">[</span><span class="ident" id="3786757"><a href="/net/http/header.go.html#3786691">endPos</a></span><span class="op" id="3786763">]</span><span class="op" id="3786764">)</span>&nbsp;<span class="op" id="3786766">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786771">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786786">if</span>&nbsp;<span class="ident" id="3786789"><a href="/net/http/header.go.html#3781442">strings</a></span><span class="op" id="3786796">.</span><span class="ident" id="3786797">EqualFold</span><span class="op" id="3786806">(</span><span class="ident" id="3786807"><a href="/net/http/header.go.html#3785965">v</a></span><span class="op" id="3786808">[</span><span class="ident" id="3786809"><a href="/net/http/header.go.html#3786087">sp</a></span><span class="op" id="3786811">:</span><span class="ident" id="3786812"><a href="/net/http/header.go.html#3786087">sp</a></span><span class="op" id="3786814">+</span><span class="builtinfunc" id="3786815">len</span><span class="op" id="3786818">(</span><span class="ident" id="3786819"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786824">)</span><span class="op" id="3786825">]</span><span class="op" id="3786826">,</span>&nbsp;<span class="ident" id="3786828"><a href="/net/http/header.go.html#3785968">token</a></span><span class="op" id="3786833">)</span>&nbsp;<span class="op" id="3786835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786840">return</span>&nbsp;<span class="ident" id="3786847">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786854">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786860">return</span>&nbsp;<span class="ident" id="3786867">false</span><br>
<span class="lineno"></span><span class="op" id="3786873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3786876">func</span>&nbsp;<span class="ident" id="3786881">isTokenBoundary</span><span class="op" id="3786896">(</span><span class="ident" id="3786897">b</span>&nbsp;<span class="builtintype" id="3786899">byte</span><span class="op" id="3786903">)</span>&nbsp;<span class="builtintype" id="3786905">bool</span>&nbsp;<span class="op" id="3786910">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786913">return</span>&nbsp;<span class="ident" id="3786920"><a href="/net/http/header.go.html#3786897">b</a></span>&nbsp;<span class="op" id="3786922">==</span>&nbsp;<span class="string" id="3786925">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3786929">||</span>&nbsp;<span class="ident" id="3786932"><a href="/net/http/header.go.html#3786897">b</a></span>&nbsp;<span class="op" id="3786934">==</span>&nbsp;<span class="string" id="3786937">&#39;,&#39;</span>&nbsp;<span class="op" id="3786941">||</span>&nbsp;<span class="ident" id="3786944"><a href="/net/http/header.go.html#3786897">b</a></span>&nbsp;<span class="op" id="3786946">==</span>&nbsp;<span class="string" id="3786949">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="3786954">}</span>
</div>
</body>
</html>
