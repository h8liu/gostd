<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5194752">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5194808">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5194862">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5194913">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5194967">package</span>&nbsp;<span class="ident" id="5194975">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5194980">import</span>&nbsp;<span class="op" id="5194987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194990">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194999">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5195014">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5195033">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5195043">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5195050">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5195056">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5195061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195064">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5195097">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195136">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5195183">type</span>&nbsp;<span class="ident" id="5195188">FileHeader</span>&nbsp;<span class="keyword" id="5195199">struct</span>&nbsp;<span class="op" id="5195206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195209">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195220">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195227">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195238">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195244">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195255">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195264">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195275">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195282">ABIVersion</span>&nbsp;<span class="builtintype" id="5195293">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195300">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5195311">binary</span><span class="op" id="5195317">.</span><span class="ident" id="5195318">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195329">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195340">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195346">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195357">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195366">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195377">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5195384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195387">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5195426">type</span>&nbsp;<span class="ident" id="5195431">File</span>&nbsp;<span class="keyword" id="5195436">struct</span>&nbsp;<span class="op" id="5195443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195446">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195458">Sections</span>&nbsp;&nbsp;<span class="op" id="5195468">[</span><span class="op" id="5195469">]</span><span class="op" id="5195470">*</span><span class="ident" id="5195471">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195480">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195490">[</span><span class="op" id="5195491">]</span><span class="op" id="5195492">*</span><span class="ident" id="5195493">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195499">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195509">io</span><span class="op" id="5195511">.</span><span class="ident" id="5195512">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195520">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5195530">[</span><span class="op" id="5195531">]</span><span class="ident" id="5195532">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195541">gnuVersym</span>&nbsp;<span class="op" id="5195551">[</span><span class="op" id="5195552">]</span><span class="builtintype" id="5195553">byte</span><br>
<span class="lineno">45</span><span class="op" id="5195558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195561">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5195620">type</span>&nbsp;<span class="ident" id="5195625">SectionHeader</span>&nbsp;<span class="keyword" id="5195639">struct</span>&nbsp;<span class="op" id="5195646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195649">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5195659">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195667">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195677">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195690">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195700">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195713">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195723">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195731">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195741">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195749">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195759">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195767">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5195777">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195785">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5195795">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195803">Addralign</span>&nbsp;<span class="ident" id="5195813">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195821">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5195831">uint64</span><br>
<span class="lineno"></span><span class="op" id="5195838">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5195841">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5195898">type</span>&nbsp;<span class="ident" id="5195903">Section</span>&nbsp;<span class="keyword" id="5195911">struct</span>&nbsp;<span class="op" id="5195918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5195921">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5195937">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5195975">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196015">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196050">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196098">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5196148">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196172">io</span><span class="op" id="5196174">.</span><span class="ident" id="5196175">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196185">sr</span>&nbsp;<span class="op" id="5196188">*</span><span class="ident" id="5196189">io</span><span class="op" id="5196191">.</span><span class="ident" id="5196192">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5196206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5196209">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5196268">func</span>&nbsp;<span class="op" id="5196273">(</span><span class="ident" id="5196274">s</span>&nbsp;<span class="op" id="5196276">*</span><span class="ident" id="5196277">Section</span><span class="op" id="5196284">)</span>&nbsp;<span class="ident" id="5196286">Data</span><span class="op" id="5196290">(</span><span class="op" id="5196291">)</span>&nbsp;<span class="op" id="5196293">(</span><span class="op" id="5196294">[</span><span class="op" id="5196295">]</span><span class="builtintype" id="5196296">byte</span><span class="op" id="5196300">,</span>&nbsp;<span class="builtintype" id="5196302">error</span><span class="op" id="5196307">)</span>&nbsp;<span class="op" id="5196309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196312">dat</span>&nbsp;<span class="op" id="5196316">:=</span>&nbsp;<span class="builtinfunc" id="5196319">make</span><span class="op" id="5196323">(</span><span class="op" id="5196324">[</span><span class="op" id="5196325">]</span><span class="builtintype" id="5196326">byte</span><span class="op" id="5196330">,</span>&nbsp;<span class="ident" id="5196332">s</span><span class="op" id="5196333">.</span><span class="ident" id="5196334">sr</span><span class="op" id="5196336">.</span><span class="ident" id="5196337">Size</span><span class="op" id="5196341">(</span><span class="op" id="5196342">)</span><span class="op" id="5196343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196346">n</span><span class="op" id="5196347">,</span>&nbsp;<span class="ident" id="5196349">err</span>&nbsp;<span class="op" id="5196353">:=</span>&nbsp;<span class="ident" id="5196356">s</span><span class="op" id="5196357">.</span><span class="ident" id="5196358">sr</span><span class="op" id="5196360">.</span><span class="ident" id="5196361">ReadAt</span><span class="op" id="5196367">(</span><span class="ident" id="5196368">dat</span><span class="op" id="5196371">,</span>&nbsp;<span class="num" id="5196373">0</span><span class="op" id="5196374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196377">if</span>&nbsp;<span class="ident" id="5196380">n</span>&nbsp;<span class="op" id="5196382">==</span>&nbsp;<span class="builtinfunc" id="5196385">len</span><span class="op" id="5196388">(</span><span class="ident" id="5196389">dat</span><span class="op" id="5196392">)</span>&nbsp;<span class="op" id="5196394">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196398">err</span>&nbsp;<span class="op" id="5196402">=</span>&nbsp;<span class="ident" id="5196404">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5196409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196412">return</span>&nbsp;<span class="ident" id="5196419">dat</span><span class="op" id="5196422">[</span><span class="num" id="5196423">0</span><span class="op" id="5196424">:</span><span class="ident" id="5196425">n</span><span class="op" id="5196426">]</span><span class="op" id="5196427">,</span>&nbsp;<span class="ident" id="5196429">err</span><br>
<span class="lineno"></span><span class="op" id="5196433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5196436">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5196499">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5196524">func</span>&nbsp;<span class="op" id="5196529">(</span><span class="ident" id="5196530">f</span>&nbsp;<span class="op" id="5196532">*</span><span class="ident" id="5196533">File</span><span class="op" id="5196537">)</span>&nbsp;<span class="ident" id="5196539">stringTable</span><span class="op" id="5196550">(</span><span class="ident" id="5196551">link</span>&nbsp;<span class="builtintype" id="5196556">uint32</span><span class="op" id="5196562">)</span>&nbsp;<span class="op" id="5196564">(</span><span class="op" id="5196565">[</span><span class="op" id="5196566">]</span><span class="builtintype" id="5196567">byte</span><span class="op" id="5196571">,</span>&nbsp;<span class="builtintype" id="5196573">error</span><span class="op" id="5196578">)</span>&nbsp;<span class="op" id="5196580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196583">if</span>&nbsp;<span class="ident" id="5196586">link</span>&nbsp;<span class="op" id="5196591">&lt;=</span>&nbsp;<span class="num" id="5196594">0</span>&nbsp;<span class="op" id="5196596">||</span>&nbsp;<span class="ident" id="5196599">link</span>&nbsp;<span class="op" id="5196604">&gt;=</span>&nbsp;<span class="builtintype" id="5196607">uint32</span><span class="op" id="5196613">(</span><span class="builtinfunc" id="5196614">len</span><span class="op" id="5196617">(</span><span class="ident" id="5196618">f</span><span class="op" id="5196619">.</span><span class="ident" id="5196620">Sections</span><span class="op" id="5196628">)</span><span class="op" id="5196629">)</span>&nbsp;<span class="op" id="5196631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196635">return</span>&nbsp;<span class="ident" id="5196642">nil</span><span class="op" id="5196645">,</span>&nbsp;<span class="ident" id="5196647">errors</span><span class="op" id="5196653">.</span><span class="ident" id="5196654">New</span><span class="op" id="5196657">(</span><span class="string" id="5196658">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5196697">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5196700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5196703">return</span>&nbsp;<span class="ident" id="5196710">f</span><span class="op" id="5196711">.</span><span class="ident" id="5196712">Sections</span><span class="op" id="5196720">[</span><span class="ident" id="5196721">link</span><span class="op" id="5196725">]</span><span class="op" id="5196726">.</span><span class="ident" id="5196727">Data</span><span class="op" id="5196731">(</span><span class="op" id="5196732">)</span><br>
<span class="lineno"></span><span class="op" id="5196734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5196737">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5196795">func</span>&nbsp;<span class="op" id="5196800">(</span><span class="ident" id="5196801">s</span>&nbsp;<span class="op" id="5196803">*</span><span class="ident" id="5196804">Section</span><span class="op" id="5196811">)</span>&nbsp;<span class="ident" id="5196813">Open</span><span class="op" id="5196817">(</span><span class="op" id="5196818">)</span>&nbsp;<span class="ident" id="5196820">io</span><span class="op" id="5196822">.</span><span class="ident" id="5196823">ReadSeeker</span>&nbsp;<span class="op" id="5196834">{</span>&nbsp;<span class="keyword" id="5196836">return</span>&nbsp;<span class="ident" id="5196843">io</span><span class="op" id="5196845">.</span><span class="ident" id="5196846">NewSectionReader</span><span class="op" id="5196862">(</span><span class="ident" id="5196863">s</span><span class="op" id="5196864">.</span><span class="ident" id="5196865">sr</span><span class="op" id="5196867">,</span>&nbsp;<span class="num" id="5196869">0</span><span class="op" id="5196870">,</span>&nbsp;<span class="num" id="5196872">1</span><span class="op" id="5196873">&lt;&lt;</span><span class="num" id="5196875">63</span><span class="op" id="5196877">-</span><span class="num" id="5196878">1</span><span class="op" id="5196879">)</span>&nbsp;<span class="op" id="5196881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5196884">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5196940">type</span>&nbsp;<span class="ident" id="5196945">ProgHeader</span>&nbsp;<span class="keyword" id="5196956">struct</span>&nbsp;<span class="op" id="5196963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196966">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5196973">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5196983">Flags</span>&nbsp;&nbsp;<span class="ident" id="5196990">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197000">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197007">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197015">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5197022">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197030">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5197037">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197045">Filesz</span>&nbsp;<span class="ident" id="5197052">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197060">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5197067">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197075">Align</span>&nbsp;&nbsp;<span class="ident" id="5197082">uint64</span><br>
<span class="lineno"></span><span class="op" id="5197089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5197092">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5197159">type</span>&nbsp;<span class="ident" id="5197164">Prog</span>&nbsp;<span class="keyword" id="5197169">struct</span>&nbsp;<span class="op" id="5197176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197179">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197192">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197230">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197270">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197305">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197353">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5197403">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197427">io</span><span class="op" id="5197429">.</span><span class="ident" id="5197430">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197440">sr</span>&nbsp;<span class="op" id="5197443">*</span><span class="ident" id="5197444">io</span><span class="op" id="5197446">.</span><span class="ident" id="5197447">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5197461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5197464">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5197527">func</span>&nbsp;<span class="op" id="5197532">(</span><span class="ident" id="5197533">p</span>&nbsp;<span class="op" id="5197535">*</span><span class="ident" id="5197536">Prog</span><span class="op" id="5197540">)</span>&nbsp;<span class="ident" id="5197542">Open</span><span class="op" id="5197546">(</span><span class="op" id="5197547">)</span>&nbsp;<span class="ident" id="5197549">io</span><span class="op" id="5197551">.</span><span class="ident" id="5197552">ReadSeeker</span>&nbsp;<span class="op" id="5197563">{</span>&nbsp;<span class="keyword" id="5197565">return</span>&nbsp;<span class="ident" id="5197572">io</span><span class="op" id="5197574">.</span><span class="ident" id="5197575">NewSectionReader</span><span class="op" id="5197591">(</span><span class="ident" id="5197592">p</span><span class="op" id="5197593">.</span><span class="ident" id="5197594">sr</span><span class="op" id="5197596">,</span>&nbsp;<span class="num" id="5197598">0</span><span class="op" id="5197599">,</span>&nbsp;<span class="num" id="5197601">1</span><span class="op" id="5197602">&lt;&lt;</span><span class="num" id="5197604">63</span><span class="op" id="5197606">-</span><span class="num" id="5197607">1</span><span class="op" id="5197608">)</span>&nbsp;<span class="op" id="5197610">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5197613">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5197677">type</span>&nbsp;<span class="ident" id="5197682">Symbol</span>&nbsp;<span class="keyword" id="5197689">struct</span>&nbsp;<span class="op" id="5197696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197699">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5197711">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197719">Info</span><span class="op" id="5197723">,</span>&nbsp;<span class="ident" id="5197725">Other</span>&nbsp;<span class="builtintype" id="5197731">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197737">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197749">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197763">Value</span><span class="op" id="5197768">,</span>&nbsp;<span class="ident" id="5197770">Size</span>&nbsp;<span class="ident" id="5197775">uint64</span><br>
<span class="lineno"></span><span class="op" id="5197782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5197785">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5197807">type</span>&nbsp;<span class="ident" id="5197812">FormatError</span>&nbsp;<span class="keyword" id="5197824">struct</span>&nbsp;<span class="op" id="5197831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197834">off</span>&nbsp;<span class="ident" id="5197838">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197845">msg</span>&nbsp;<span class="builtintype" id="5197849">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197857">val</span>&nbsp;<span class="keyword" id="5197861">interface</span><span class="op" id="5197870">{</span><span class="op" id="5197871">}</span><br>
<span class="lineno"></span><span class="op" id="5197873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5197876">func</span>&nbsp;<span class="op" id="5197881">(</span><span class="ident" id="5197882">e</span>&nbsp;<span class="op" id="5197884">*</span><span class="ident" id="5197885">FormatError</span><span class="op" id="5197896">)</span>&nbsp;<span class="ident" id="5197898">Error</span><span class="op" id="5197903">(</span><span class="op" id="5197904">)</span>&nbsp;<span class="builtintype" id="5197906">string</span>&nbsp;<span class="op" id="5197913">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197916">msg</span>&nbsp;<span class="op" id="5197920">:=</span>&nbsp;<span class="ident" id="5197923">e</span><span class="op" id="5197924">.</span><span class="ident" id="5197925">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5197930">if</span>&nbsp;<span class="ident" id="5197933">e</span><span class="op" id="5197934">.</span><span class="ident" id="5197935">val</span>&nbsp;<span class="op" id="5197939">!=</span>&nbsp;<span class="ident" id="5197942">nil</span>&nbsp;<span class="op" id="5197946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197950">msg</span>&nbsp;<span class="op" id="5197954">+=</span>&nbsp;<span class="ident" id="5197957">fmt</span><span class="op" id="5197960">.</span><span class="ident" id="5197961">Sprintf</span><span class="op" id="5197968">(</span><span class="string" id="5197969">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5197977">,</span>&nbsp;<span class="ident" id="5197979">e</span><span class="op" id="5197980">.</span><span class="ident" id="5197981">val</span><span class="op" id="5197984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5197987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5197990">msg</span>&nbsp;<span class="op" id="5197994">+=</span>&nbsp;<span class="ident" id="5197997">fmt</span><span class="op" id="5198000">.</span><span class="ident" id="5198001">Sprintf</span><span class="op" id="5198008">(</span><span class="string" id="5198009">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5198032">,</span>&nbsp;<span class="ident" id="5198034">e</span><span class="op" id="5198035">.</span><span class="ident" id="5198036">off</span><span class="op" id="5198039">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198042">return</span>&nbsp;<span class="ident" id="5198049">msg</span><br>
<span class="lineno"></span><span class="op" id="5198053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198056">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5198141">func</span>&nbsp;<span class="ident" id="5198146">Open</span><span class="op" id="5198150">(</span><span class="ident" id="5198151">name</span>&nbsp;<span class="builtintype" id="5198156">string</span><span class="op" id="5198162">)</span>&nbsp;<span class="op" id="5198164">(</span><span class="op" id="5198165">*</span><span class="ident" id="5198166">File</span><span class="op" id="5198170">,</span>&nbsp;<span class="builtintype" id="5198172">error</span><span class="op" id="5198177">)</span>&nbsp;<span class="op" id="5198179">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198182">f</span><span class="op" id="5198183">,</span>&nbsp;<span class="ident" id="5198185">err</span>&nbsp;<span class="op" id="5198189">:=</span>&nbsp;<span class="ident" id="5198192">os</span><span class="op" id="5198194">.</span><span class="ident" id="5198195">Open</span><span class="op" id="5198199">(</span><span class="ident" id="5198200">name</span><span class="op" id="5198204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198207">if</span>&nbsp;<span class="ident" id="5198210">err</span>&nbsp;<span class="op" id="5198214">!=</span>&nbsp;<span class="ident" id="5198217">nil</span>&nbsp;<span class="op" id="5198221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198225">return</span>&nbsp;<span class="ident" id="5198232">nil</span><span class="op" id="5198235">,</span>&nbsp;<span class="ident" id="5198237">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198245">ff</span><span class="op" id="5198247">,</span>&nbsp;<span class="ident" id="5198249">err</span>&nbsp;<span class="op" id="5198253">:=</span>&nbsp;<span class="ident" id="5198256">NewFile</span><span class="op" id="5198263">(</span><span class="ident" id="5198264">f</span><span class="op" id="5198265">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198268">if</span>&nbsp;<span class="ident" id="5198271">err</span>&nbsp;<span class="op" id="5198275">!=</span>&nbsp;<span class="ident" id="5198278">nil</span>&nbsp;<span class="op" id="5198282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198286">f</span><span class="op" id="5198287">.</span><span class="ident" id="5198288">Close</span><span class="op" id="5198293">(</span><span class="op" id="5198294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198298">return</span>&nbsp;<span class="ident" id="5198305">nil</span><span class="op" id="5198308">,</span>&nbsp;<span class="ident" id="5198310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198318">ff</span><span class="op" id="5198320">.</span><span class="ident" id="5198321">closer</span>&nbsp;<span class="op" id="5198328">=</span>&nbsp;<span class="ident" id="5198330">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198333">return</span>&nbsp;<span class="ident" id="5198340">ff</span><span class="op" id="5198342">,</span>&nbsp;<span class="ident" id="5198344">nil</span><br>
<span class="lineno"></span><span class="op" id="5198348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198351">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5198377">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5198444">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5198468">func</span>&nbsp;<span class="op" id="5198473">(</span><span class="ident" id="5198474">f</span>&nbsp;<span class="op" id="5198476">*</span><span class="ident" id="5198477">File</span><span class="op" id="5198481">)</span>&nbsp;<span class="ident" id="5198483">Close</span><span class="op" id="5198488">(</span><span class="op" id="5198489">)</span>&nbsp;<span class="builtintype" id="5198491">error</span>&nbsp;<span class="op" id="5198497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198500">var</span>&nbsp;<span class="ident" id="5198504">err</span>&nbsp;<span class="builtintype" id="5198508">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198515">if</span>&nbsp;<span class="ident" id="5198518">f</span><span class="op" id="5198519">.</span><span class="ident" id="5198520">closer</span>&nbsp;<span class="op" id="5198527">!=</span>&nbsp;<span class="ident" id="5198530">nil</span>&nbsp;<span class="op" id="5198534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198538">err</span>&nbsp;<span class="op" id="5198542">=</span>&nbsp;<span class="ident" id="5198544">f</span><span class="op" id="5198545">.</span><span class="ident" id="5198546">closer</span><span class="op" id="5198552">.</span><span class="ident" id="5198553">Close</span><span class="op" id="5198558">(</span><span class="op" id="5198559">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5198563">f</span><span class="op" id="5198564">.</span><span class="ident" id="5198565">closer</span>&nbsp;<span class="op" id="5198572">=</span>&nbsp;<span class="ident" id="5198574">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198582">return</span>&nbsp;<span class="ident" id="5198589">err</span><br>
<span class="lineno"></span><span class="op" id="5198593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5198596">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5198653">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5198704">func</span>&nbsp;<span class="op" id="5198709">(</span><span class="ident" id="5198710">f</span>&nbsp;<span class="op" id="5198712">*</span><span class="ident" id="5198713">File</span><span class="op" id="5198717">)</span>&nbsp;<span class="ident" id="5198719">SectionByType</span><span class="op" id="5198732">(</span><span class="ident" id="5198733">typ</span>&nbsp;<span class="ident" id="5198737">SectionType</span><span class="op" id="5198748">)</span>&nbsp;<span class="op" id="5198750">*</span><span class="ident" id="5198751">Section</span>&nbsp;<span class="op" id="5198759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198762">for</span>&nbsp;<span class="ident" id="5198766">_</span><span class="op" id="5198767">,</span>&nbsp;<span class="ident" id="5198769">s</span>&nbsp;<span class="op" id="5198771">:=</span>&nbsp;<span class="keyword" id="5198774">range</span>&nbsp;<span class="ident" id="5198780">f</span><span class="op" id="5198781">.</span><span class="ident" id="5198782">Sections</span>&nbsp;<span class="op" id="5198791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198795">if</span>&nbsp;<span class="ident" id="5198798">s</span><span class="op" id="5198799">.</span><span class="ident" id="5198800">Type</span>&nbsp;<span class="op" id="5198805">==</span>&nbsp;<span class="ident" id="5198808">typ</span>&nbsp;<span class="op" id="5198812">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198817">return</span>&nbsp;<span class="ident" id="5198824">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5198831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5198834">return</span>&nbsp;<span class="ident" id="5198841">nil</span><br>
<span class="lineno"></span><span class="op" id="5198845">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5198848">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5198931">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5199001">func</span>&nbsp;<span class="ident" id="5199006">NewFile</span><span class="op" id="5199013">(</span><span class="ident" id="5199014">r</span>&nbsp;<span class="ident" id="5199016">io</span><span class="op" id="5199018">.</span><span class="ident" id="5199019">ReaderAt</span><span class="op" id="5199027">)</span>&nbsp;<span class="op" id="5199029">(</span><span class="op" id="5199030">*</span><span class="ident" id="5199031">File</span><span class="op" id="5199035">,</span>&nbsp;<span class="builtintype" id="5199037">error</span><span class="op" id="5199042">)</span>&nbsp;<span class="op" id="5199044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199047">sr</span>&nbsp;<span class="op" id="5199050">:=</span>&nbsp;<span class="ident" id="5199053">io</span><span class="op" id="5199055">.</span><span class="ident" id="5199056">NewSectionReader</span><span class="op" id="5199072">(</span><span class="ident" id="5199073">r</span><span class="op" id="5199074">,</span>&nbsp;<span class="num" id="5199076">0</span><span class="op" id="5199077">,</span>&nbsp;<span class="num" id="5199079">1</span><span class="op" id="5199080">&lt;&lt;</span><span class="num" id="5199082">63</span><span class="op" id="5199084">-</span><span class="num" id="5199085">1</span><span class="op" id="5199086">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5199089">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199124">var</span>&nbsp;<span class="ident" id="5199128">ident</span>&nbsp;<span class="op" id="5199134">[</span><span class="num" id="5199135">16</span><span class="op" id="5199137">]</span><span class="builtintype" id="5199138">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199145">if</span>&nbsp;<span class="ident" id="5199148">_</span><span class="op" id="5199149">,</span>&nbsp;<span class="ident" id="5199151">err</span>&nbsp;<span class="op" id="5199155">:=</span>&nbsp;<span class="ident" id="5199158">r</span><span class="op" id="5199159">.</span><span class="ident" id="5199160">ReadAt</span><span class="op" id="5199166">(</span><span class="ident" id="5199167">ident</span><span class="op" id="5199172">[</span><span class="num" id="5199173">0</span><span class="op" id="5199174">:</span><span class="op" id="5199175">]</span><span class="op" id="5199176">,</span>&nbsp;<span class="num" id="5199178">0</span><span class="op" id="5199179">)</span><span class="op" id="5199180">;</span>&nbsp;<span class="ident" id="5199182">err</span>&nbsp;<span class="op" id="5199186">!=</span>&nbsp;<span class="ident" id="5199189">nil</span>&nbsp;<span class="op" id="5199193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199197">return</span>&nbsp;<span class="ident" id="5199204">nil</span><span class="op" id="5199207">,</span>&nbsp;<span class="ident" id="5199209">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5199214">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199217">if</span>&nbsp;<span class="ident" id="5199220">ident</span><span class="op" id="5199225">[</span><span class="num" id="5199226">0</span><span class="op" id="5199227">]</span>&nbsp;<span class="op" id="5199229">!=</span>&nbsp;<span class="string" id="5199232">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5199239">||</span>&nbsp;<span class="ident" id="5199242">ident</span><span class="op" id="5199247">[</span><span class="num" id="5199248">1</span><span class="op" id="5199249">]</span>&nbsp;<span class="op" id="5199251">!=</span>&nbsp;<span class="string" id="5199254">&#39;E&#39;</span>&nbsp;<span class="op" id="5199258">||</span>&nbsp;<span class="ident" id="5199261">ident</span><span class="op" id="5199266">[</span><span class="num" id="5199267">2</span><span class="op" id="5199268">]</span>&nbsp;<span class="op" id="5199270">!=</span>&nbsp;<span class="string" id="5199273">&#39;L&#39;</span>&nbsp;<span class="op" id="5199277">||</span>&nbsp;<span class="ident" id="5199280">ident</span><span class="op" id="5199285">[</span><span class="num" id="5199286">3</span><span class="op" id="5199287">]</span>&nbsp;<span class="op" id="5199289">!=</span>&nbsp;<span class="string" id="5199292">&#39;F&#39;</span>&nbsp;<span class="op" id="5199296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199300">return</span>&nbsp;<span class="ident" id="5199307">nil</span><span class="op" id="5199310">,</span>&nbsp;<span class="op" id="5199312">&amp;</span><span class="ident" id="5199313">FormatError</span><span class="op" id="5199324">{</span><span class="num" id="5199325">0</span><span class="op" id="5199326">,</span>&nbsp;<span class="string" id="5199328">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5199346">,</span>&nbsp;<span class="ident" id="5199348">ident</span><span class="op" id="5199353">[</span><span class="num" id="5199354">0</span><span class="op" id="5199355">:</span><span class="num" id="5199356">4</span><span class="op" id="5199357">]</span><span class="op" id="5199358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5199361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199365">f</span>&nbsp;<span class="op" id="5199367">:=</span>&nbsp;<span class="builtinfunc" id="5199370">new</span><span class="op" id="5199373">(</span><span class="ident" id="5199374">File</span><span class="op" id="5199378">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199381">f</span><span class="op" id="5199382">.</span><span class="ident" id="5199383">Class</span>&nbsp;<span class="op" id="5199389">=</span>&nbsp;<span class="ident" id="5199391">Class</span><span class="op" id="5199396">(</span><span class="ident" id="5199397">ident</span><span class="op" id="5199402">[</span><span class="ident" id="5199403">EI_CLASS</span><span class="op" id="5199411">]</span><span class="op" id="5199412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199415">switch</span>&nbsp;<span class="ident" id="5199422">f</span><span class="op" id="5199423">.</span><span class="ident" id="5199424">Class</span>&nbsp;<span class="op" id="5199430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199433">case</span>&nbsp;<span class="ident" id="5199438">ELFCLASS32</span><span class="op" id="5199448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199451">case</span>&nbsp;<span class="ident" id="5199456">ELFCLASS64</span><span class="op" id="5199466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5199470">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199477">default</span><span class="op" id="5199484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199488">return</span>&nbsp;<span class="ident" id="5199495">nil</span><span class="op" id="5199498">,</span>&nbsp;<span class="op" id="5199500">&amp;</span><span class="ident" id="5199501">FormatError</span><span class="op" id="5199512">{</span><span class="num" id="5199513">0</span><span class="op" id="5199514">,</span>&nbsp;<span class="string" id="5199516">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5199535">,</span>&nbsp;<span class="ident" id="5199537">f</span><span class="op" id="5199538">.</span><span class="ident" id="5199539">Class</span><span class="op" id="5199544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5199547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199551">f</span><span class="op" id="5199552">.</span><span class="ident" id="5199553">Data</span>&nbsp;<span class="op" id="5199558">=</span>&nbsp;<span class="ident" id="5199560">Data</span><span class="op" id="5199564">(</span><span class="ident" id="5199565">ident</span><span class="op" id="5199570">[</span><span class="ident" id="5199571">EI_DATA</span><span class="op" id="5199578">]</span><span class="op" id="5199579">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199582">switch</span>&nbsp;<span class="ident" id="5199589">f</span><span class="op" id="5199590">.</span><span class="ident" id="5199591">Data</span>&nbsp;<span class="op" id="5199596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199599">case</span>&nbsp;<span class="ident" id="5199604">ELFDATA2LSB</span><span class="op" id="5199615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199619">f</span><span class="op" id="5199620">.</span><span class="ident" id="5199621">ByteOrder</span>&nbsp;<span class="op" id="5199631">=</span>&nbsp;<span class="ident" id="5199633">binary</span><span class="op" id="5199639">.</span><span class="ident" id="5199640">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199654">case</span>&nbsp;<span class="ident" id="5199659">ELFDATA2MSB</span><span class="op" id="5199670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199674">f</span><span class="op" id="5199675">.</span><span class="ident" id="5199676">ByteOrder</span>&nbsp;<span class="op" id="5199686">=</span>&nbsp;<span class="ident" id="5199688">binary</span><span class="op" id="5199694">.</span><span class="ident" id="5199695">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199706">default</span><span class="op" id="5199713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199717">return</span>&nbsp;<span class="ident" id="5199724">nil</span><span class="op" id="5199727">,</span>&nbsp;<span class="op" id="5199729">&amp;</span><span class="ident" id="5199730">FormatError</span><span class="op" id="5199741">{</span><span class="num" id="5199742">0</span><span class="op" id="5199743">,</span>&nbsp;<span class="string" id="5199745">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5199772">,</span>&nbsp;<span class="ident" id="5199774">f</span><span class="op" id="5199775">.</span><span class="ident" id="5199776">Data</span><span class="op" id="5199780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5199783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199787">f</span><span class="op" id="5199788">.</span><span class="ident" id="5199789">Version</span>&nbsp;<span class="op" id="5199797">=</span>&nbsp;<span class="ident" id="5199799">Version</span><span class="op" id="5199806">(</span><span class="ident" id="5199807">ident</span><span class="op" id="5199812">[</span><span class="ident" id="5199813">EI_VERSION</span><span class="op" id="5199823">]</span><span class="op" id="5199824">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199827">if</span>&nbsp;<span class="ident" id="5199830">f</span><span class="op" id="5199831">.</span><span class="ident" id="5199832">Version</span>&nbsp;<span class="op" id="5199840">!=</span>&nbsp;<span class="ident" id="5199843">EV_CURRENT</span>&nbsp;<span class="op" id="5199854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5199858">return</span>&nbsp;<span class="ident" id="5199865">nil</span><span class="op" id="5199868">,</span>&nbsp;<span class="op" id="5199870">&amp;</span><span class="ident" id="5199871">FormatError</span><span class="op" id="5199882">{</span><span class="num" id="5199883">0</span><span class="op" id="5199884">,</span>&nbsp;<span class="string" id="5199886">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5199907">,</span>&nbsp;<span class="ident" id="5199909">f</span><span class="op" id="5199910">.</span><span class="ident" id="5199911">Version</span><span class="op" id="5199918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5199921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199925">f</span><span class="op" id="5199926">.</span><span class="ident" id="5199927">OSABI</span>&nbsp;<span class="op" id="5199933">=</span>&nbsp;<span class="ident" id="5199935">OSABI</span><span class="op" id="5199940">(</span><span class="ident" id="5199941">ident</span><span class="op" id="5199946">[</span><span class="ident" id="5199947">EI_OSABI</span><span class="op" id="5199955">]</span><span class="op" id="5199956">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5199959">f</span><span class="op" id="5199960">.</span><span class="ident" id="5199961">ABIVersion</span>&nbsp;<span class="op" id="5199972">=</span>&nbsp;<span class="ident" id="5199974">ident</span><span class="op" id="5199979">[</span><span class="ident" id="5199980">EI_ABIVERSION</span><span class="op" id="5199993">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5199997">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200022">var</span>&nbsp;<span class="ident" id="5200026">phoff</span>&nbsp;<span class="ident" id="5200032">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200039">var</span>&nbsp;<span class="ident" id="5200043">phentsize</span><span class="op" id="5200052">,</span>&nbsp;<span class="ident" id="5200054">phnum</span>&nbsp;<span class="builtintype" id="5200060">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200065">var</span>&nbsp;<span class="ident" id="5200069">shoff</span>&nbsp;<span class="ident" id="5200075">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200082">var</span>&nbsp;<span class="ident" id="5200086">shentsize</span><span class="op" id="5200095">,</span>&nbsp;<span class="ident" id="5200097">shnum</span><span class="op" id="5200102">,</span>&nbsp;<span class="ident" id="5200104">shstrndx</span>&nbsp;<span class="builtintype" id="5200113">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200118">shstrndx</span>&nbsp;<span class="op" id="5200127">=</span>&nbsp;<span class="op" id="5200129">-</span><span class="num" id="5200130">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200133">switch</span>&nbsp;<span class="ident" id="5200140">f</span><span class="op" id="5200141">.</span><span class="ident" id="5200142">Class</span>&nbsp;<span class="op" id="5200148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200151">case</span>&nbsp;<span class="ident" id="5200156">ELFCLASS32</span><span class="op" id="5200166">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200170">hdr</span>&nbsp;<span class="op" id="5200174">:=</span>&nbsp;<span class="builtinfunc" id="5200177">new</span><span class="op" id="5200180">(</span><span class="ident" id="5200181">Header32</span><span class="op" id="5200189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200193">sr</span><span class="op" id="5200195">.</span><span class="ident" id="5200196">Seek</span><span class="op" id="5200200">(</span><span class="num" id="5200201">0</span><span class="op" id="5200202">,</span>&nbsp;<span class="ident" id="5200204">os</span><span class="op" id="5200206">.</span><span class="ident" id="5200207">SEEK_SET</span><span class="op" id="5200215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200219">if</span>&nbsp;<span class="ident" id="5200222">err</span>&nbsp;<span class="op" id="5200226">:=</span>&nbsp;<span class="ident" id="5200229">binary</span><span class="op" id="5200235">.</span><span class="ident" id="5200236">Read</span><span class="op" id="5200240">(</span><span class="ident" id="5200241">sr</span><span class="op" id="5200243">,</span>&nbsp;<span class="ident" id="5200245">f</span><span class="op" id="5200246">.</span><span class="ident" id="5200247">ByteOrder</span><span class="op" id="5200256">,</span>&nbsp;<span class="ident" id="5200258">hdr</span><span class="op" id="5200261">)</span><span class="op" id="5200262">;</span>&nbsp;<span class="ident" id="5200264">err</span>&nbsp;<span class="op" id="5200268">!=</span>&nbsp;<span class="ident" id="5200271">nil</span>&nbsp;<span class="op" id="5200275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200280">return</span>&nbsp;<span class="ident" id="5200287">nil</span><span class="op" id="5200290">,</span>&nbsp;<span class="ident" id="5200292">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5200298">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200302">f</span><span class="op" id="5200303">.</span><span class="ident" id="5200304">Type</span>&nbsp;<span class="op" id="5200309">=</span>&nbsp;<span class="ident" id="5200311">Type</span><span class="op" id="5200315">(</span><span class="ident" id="5200316">hdr</span><span class="op" id="5200319">.</span><span class="ident" id="5200320">Type</span><span class="op" id="5200324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200328">f</span><span class="op" id="5200329">.</span><span class="ident" id="5200330">Machine</span>&nbsp;<span class="op" id="5200338">=</span>&nbsp;<span class="ident" id="5200340">Machine</span><span class="op" id="5200347">(</span><span class="ident" id="5200348">hdr</span><span class="op" id="5200351">.</span><span class="ident" id="5200352">Machine</span><span class="op" id="5200359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200363">f</span><span class="op" id="5200364">.</span><span class="ident" id="5200365">Entry</span>&nbsp;<span class="op" id="5200371">=</span>&nbsp;<span class="ident" id="5200373">uint64</span><span class="op" id="5200379">(</span><span class="ident" id="5200380">hdr</span><span class="op" id="5200383">.</span><span class="ident" id="5200384">Entry</span><span class="op" id="5200389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200393">if</span>&nbsp;<span class="ident" id="5200396">v</span>&nbsp;<span class="op" id="5200398">:=</span>&nbsp;<span class="ident" id="5200401">Version</span><span class="op" id="5200408">(</span><span class="ident" id="5200409">hdr</span><span class="op" id="5200412">.</span><span class="ident" id="5200413">Version</span><span class="op" id="5200420">)</span><span class="op" id="5200421">;</span>&nbsp;<span class="ident" id="5200423">v</span>&nbsp;<span class="op" id="5200425">!=</span>&nbsp;<span class="ident" id="5200428">f</span><span class="op" id="5200429">.</span><span class="ident" id="5200430">Version</span>&nbsp;<span class="op" id="5200438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200443">return</span>&nbsp;<span class="ident" id="5200450">nil</span><span class="op" id="5200453">,</span>&nbsp;<span class="op" id="5200455">&amp;</span><span class="ident" id="5200456">FormatError</span><span class="op" id="5200467">{</span><span class="num" id="5200468">0</span><span class="op" id="5200469">,</span>&nbsp;<span class="string" id="5200471">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5200495">,</span>&nbsp;<span class="ident" id="5200497">v</span><span class="op" id="5200498">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5200502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200506">phoff</span>&nbsp;<span class="op" id="5200512">=</span>&nbsp;<span class="ident" id="5200514">int64</span><span class="op" id="5200519">(</span><span class="ident" id="5200520">hdr</span><span class="op" id="5200523">.</span><span class="ident" id="5200524">Phoff</span><span class="op" id="5200529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200533">phentsize</span>&nbsp;<span class="op" id="5200543">=</span>&nbsp;<span class="builtintype" id="5200545">int</span><span class="op" id="5200548">(</span><span class="ident" id="5200549">hdr</span><span class="op" id="5200552">.</span><span class="ident" id="5200553">Phentsize</span><span class="op" id="5200562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200566">phnum</span>&nbsp;<span class="op" id="5200572">=</span>&nbsp;<span class="builtintype" id="5200574">int</span><span class="op" id="5200577">(</span><span class="ident" id="5200578">hdr</span><span class="op" id="5200581">.</span><span class="ident" id="5200582">Phnum</span><span class="op" id="5200587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200591">shoff</span>&nbsp;<span class="op" id="5200597">=</span>&nbsp;<span class="ident" id="5200599">int64</span><span class="op" id="5200604">(</span><span class="ident" id="5200605">hdr</span><span class="op" id="5200608">.</span><span class="ident" id="5200609">Shoff</span><span class="op" id="5200614">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200618">shentsize</span>&nbsp;<span class="op" id="5200628">=</span>&nbsp;<span class="builtintype" id="5200630">int</span><span class="op" id="5200633">(</span><span class="ident" id="5200634">hdr</span><span class="op" id="5200637">.</span><span class="ident" id="5200638">Shentsize</span><span class="op" id="5200647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200651">shnum</span>&nbsp;<span class="op" id="5200657">=</span>&nbsp;<span class="builtintype" id="5200659">int</span><span class="op" id="5200662">(</span><span class="ident" id="5200663">hdr</span><span class="op" id="5200666">.</span><span class="ident" id="5200667">Shnum</span><span class="op" id="5200672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200676">shstrndx</span>&nbsp;<span class="op" id="5200685">=</span>&nbsp;<span class="builtintype" id="5200687">int</span><span class="op" id="5200690">(</span><span class="ident" id="5200691">hdr</span><span class="op" id="5200694">.</span><span class="ident" id="5200695">Shstrndx</span><span class="op" id="5200703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200706">case</span>&nbsp;<span class="ident" id="5200711">ELFCLASS64</span><span class="op" id="5200721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200725">hdr</span>&nbsp;<span class="op" id="5200729">:=</span>&nbsp;<span class="builtinfunc" id="5200732">new</span><span class="op" id="5200735">(</span><span class="ident" id="5200736">Header64</span><span class="op" id="5200744">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200748">sr</span><span class="op" id="5200750">.</span><span class="ident" id="5200751">Seek</span><span class="op" id="5200755">(</span><span class="num" id="5200756">0</span><span class="op" id="5200757">,</span>&nbsp;<span class="ident" id="5200759">os</span><span class="op" id="5200761">.</span><span class="ident" id="5200762">SEEK_SET</span><span class="op" id="5200770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200774">if</span>&nbsp;<span class="ident" id="5200777">err</span>&nbsp;<span class="op" id="5200781">:=</span>&nbsp;<span class="ident" id="5200784">binary</span><span class="op" id="5200790">.</span><span class="ident" id="5200791">Read</span><span class="op" id="5200795">(</span><span class="ident" id="5200796">sr</span><span class="op" id="5200798">,</span>&nbsp;<span class="ident" id="5200800">f</span><span class="op" id="5200801">.</span><span class="ident" id="5200802">ByteOrder</span><span class="op" id="5200811">,</span>&nbsp;<span class="ident" id="5200813">hdr</span><span class="op" id="5200816">)</span><span class="op" id="5200817">;</span>&nbsp;<span class="ident" id="5200819">err</span>&nbsp;<span class="op" id="5200823">!=</span>&nbsp;<span class="ident" id="5200826">nil</span>&nbsp;<span class="op" id="5200830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200835">return</span>&nbsp;<span class="ident" id="5200842">nil</span><span class="op" id="5200845">,</span>&nbsp;<span class="ident" id="5200847">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5200853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200857">f</span><span class="op" id="5200858">.</span><span class="ident" id="5200859">Type</span>&nbsp;<span class="op" id="5200864">=</span>&nbsp;<span class="ident" id="5200866">Type</span><span class="op" id="5200870">(</span><span class="ident" id="5200871">hdr</span><span class="op" id="5200874">.</span><span class="ident" id="5200875">Type</span><span class="op" id="5200879">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200883">f</span><span class="op" id="5200884">.</span><span class="ident" id="5200885">Machine</span>&nbsp;<span class="op" id="5200893">=</span>&nbsp;<span class="ident" id="5200895">Machine</span><span class="op" id="5200902">(</span><span class="ident" id="5200903">hdr</span><span class="op" id="5200906">.</span><span class="ident" id="5200907">Machine</span><span class="op" id="5200914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5200918">f</span><span class="op" id="5200919">.</span><span class="ident" id="5200920">Entry</span>&nbsp;<span class="op" id="5200926">=</span>&nbsp;<span class="ident" id="5200928">uint64</span><span class="op" id="5200934">(</span><span class="ident" id="5200935">hdr</span><span class="op" id="5200938">.</span><span class="ident" id="5200939">Entry</span><span class="op" id="5200944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200948">if</span>&nbsp;<span class="ident" id="5200951">v</span>&nbsp;<span class="op" id="5200953">:=</span>&nbsp;<span class="ident" id="5200956">Version</span><span class="op" id="5200963">(</span><span class="ident" id="5200964">hdr</span><span class="op" id="5200967">.</span><span class="ident" id="5200968">Version</span><span class="op" id="5200975">)</span><span class="op" id="5200976">;</span>&nbsp;<span class="ident" id="5200978">v</span>&nbsp;<span class="op" id="5200980">!=</span>&nbsp;<span class="ident" id="5200983">f</span><span class="op" id="5200984">.</span><span class="ident" id="5200985">Version</span>&nbsp;<span class="op" id="5200993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5200998">return</span>&nbsp;<span class="ident" id="5201005">nil</span><span class="op" id="5201008">,</span>&nbsp;<span class="op" id="5201010">&amp;</span><span class="ident" id="5201011">FormatError</span><span class="op" id="5201022">{</span><span class="num" id="5201023">0</span><span class="op" id="5201024">,</span>&nbsp;<span class="string" id="5201026">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5201050">,</span>&nbsp;<span class="ident" id="5201052">v</span><span class="op" id="5201053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5201057">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201061">phoff</span>&nbsp;<span class="op" id="5201067">=</span>&nbsp;<span class="ident" id="5201069">int64</span><span class="op" id="5201074">(</span><span class="ident" id="5201075">hdr</span><span class="op" id="5201078">.</span><span class="ident" id="5201079">Phoff</span><span class="op" id="5201084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201088">phentsize</span>&nbsp;<span class="op" id="5201098">=</span>&nbsp;<span class="builtintype" id="5201100">int</span><span class="op" id="5201103">(</span><span class="ident" id="5201104">hdr</span><span class="op" id="5201107">.</span><span class="ident" id="5201108">Phentsize</span><span class="op" id="5201117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201121">phnum</span>&nbsp;<span class="op" id="5201127">=</span>&nbsp;<span class="builtintype" id="5201129">int</span><span class="op" id="5201132">(</span><span class="ident" id="5201133">hdr</span><span class="op" id="5201136">.</span><span class="ident" id="5201137">Phnum</span><span class="op" id="5201142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201146">shoff</span>&nbsp;<span class="op" id="5201152">=</span>&nbsp;<span class="ident" id="5201154">int64</span><span class="op" id="5201159">(</span><span class="ident" id="5201160">hdr</span><span class="op" id="5201163">.</span><span class="ident" id="5201164">Shoff</span><span class="op" id="5201169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201173">shentsize</span>&nbsp;<span class="op" id="5201183">=</span>&nbsp;<span class="builtintype" id="5201185">int</span><span class="op" id="5201188">(</span><span class="ident" id="5201189">hdr</span><span class="op" id="5201192">.</span><span class="ident" id="5201193">Shentsize</span><span class="op" id="5201202">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201206">shnum</span>&nbsp;<span class="op" id="5201212">=</span>&nbsp;<span class="builtintype" id="5201214">int</span><span class="op" id="5201217">(</span><span class="ident" id="5201218">hdr</span><span class="op" id="5201221">.</span><span class="ident" id="5201222">Shnum</span><span class="op" id="5201227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201231">shstrndx</span>&nbsp;<span class="op" id="5201240">=</span>&nbsp;<span class="builtintype" id="5201242">int</span><span class="op" id="5201245">(</span><span class="ident" id="5201246">hdr</span><span class="op" id="5201249">.</span><span class="ident" id="5201250">Shstrndx</span><span class="op" id="5201258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5201261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201265">if</span>&nbsp;<span class="ident" id="5201268">shnum</span>&nbsp;<span class="op" id="5201274">&gt;</span>&nbsp;<span class="num" id="5201276">0</span>&nbsp;<span class="op" id="5201278">&amp;&amp;</span>&nbsp;<span class="ident" id="5201281">shoff</span>&nbsp;<span class="op" id="5201287">&gt;</span>&nbsp;<span class="num" id="5201289">0</span>&nbsp;<span class="op" id="5201291">&amp;&amp;</span>&nbsp;<span class="op" id="5201294">(</span><span class="ident" id="5201295">shstrndx</span>&nbsp;<span class="op" id="5201304">&lt;</span>&nbsp;<span class="num" id="5201306">0</span>&nbsp;<span class="op" id="5201308">||</span>&nbsp;<span class="ident" id="5201311">shstrndx</span>&nbsp;<span class="op" id="5201320">&gt;=</span>&nbsp;<span class="ident" id="5201323">shnum</span><span class="op" id="5201328">)</span>&nbsp;<span class="op" id="5201330">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201334">return</span>&nbsp;<span class="ident" id="5201341">nil</span><span class="op" id="5201344">,</span>&nbsp;<span class="op" id="5201346">&amp;</span><span class="ident" id="5201347">FormatError</span><span class="op" id="5201358">{</span><span class="num" id="5201359">0</span><span class="op" id="5201360">,</span>&nbsp;<span class="string" id="5201362">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5201384">,</span>&nbsp;<span class="ident" id="5201386">shstrndx</span><span class="op" id="5201394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5201397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5201401">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201426">f</span><span class="op" id="5201427">.</span><span class="ident" id="5201428">Progs</span>&nbsp;<span class="op" id="5201434">=</span>&nbsp;<span class="builtinfunc" id="5201436">make</span><span class="op" id="5201440">(</span><span class="op" id="5201441">[</span><span class="op" id="5201442">]</span><span class="op" id="5201443">*</span><span class="ident" id="5201444">Prog</span><span class="op" id="5201448">,</span>&nbsp;<span class="ident" id="5201450">phnum</span><span class="op" id="5201455">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201458">for</span>&nbsp;<span class="ident" id="5201462">i</span>&nbsp;<span class="op" id="5201464">:=</span>&nbsp;<span class="num" id="5201467">0</span><span class="op" id="5201468">;</span>&nbsp;<span class="ident" id="5201470">i</span>&nbsp;<span class="op" id="5201472">&lt;</span>&nbsp;<span class="ident" id="5201474">phnum</span><span class="op" id="5201479">;</span>&nbsp;<span class="ident" id="5201481">i</span><span class="op" id="5201482">++</span>&nbsp;<span class="op" id="5201485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201489">off</span>&nbsp;<span class="op" id="5201493">:=</span>&nbsp;<span class="ident" id="5201496">phoff</span>&nbsp;<span class="op" id="5201502">+</span>&nbsp;<span class="ident" id="5201504">int64</span><span class="op" id="5201509">(</span><span class="ident" id="5201510">i</span><span class="op" id="5201511">)</span><span class="op" id="5201512">*</span><span class="ident" id="5201513">int64</span><span class="op" id="5201518">(</span><span class="ident" id="5201519">phentsize</span><span class="op" id="5201528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201532">sr</span><span class="op" id="5201534">.</span><span class="ident" id="5201535">Seek</span><span class="op" id="5201539">(</span><span class="ident" id="5201540">off</span><span class="op" id="5201543">,</span>&nbsp;<span class="ident" id="5201545">os</span><span class="op" id="5201547">.</span><span class="ident" id="5201548">SEEK_SET</span><span class="op" id="5201556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201560">p</span>&nbsp;<span class="op" id="5201562">:=</span>&nbsp;<span class="builtinfunc" id="5201565">new</span><span class="op" id="5201568">(</span><span class="ident" id="5201569">Prog</span><span class="op" id="5201573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201577">switch</span>&nbsp;<span class="ident" id="5201584">f</span><span class="op" id="5201585">.</span><span class="ident" id="5201586">Class</span>&nbsp;<span class="op" id="5201592">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201596">case</span>&nbsp;<span class="ident" id="5201601">ELFCLASS32</span><span class="op" id="5201611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201616">ph</span>&nbsp;<span class="op" id="5201619">:=</span>&nbsp;<span class="builtinfunc" id="5201622">new</span><span class="op" id="5201625">(</span><span class="ident" id="5201626">Prog32</span><span class="op" id="5201632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201637">if</span>&nbsp;<span class="ident" id="5201640">err</span>&nbsp;<span class="op" id="5201644">:=</span>&nbsp;<span class="ident" id="5201647">binary</span><span class="op" id="5201653">.</span><span class="ident" id="5201654">Read</span><span class="op" id="5201658">(</span><span class="ident" id="5201659">sr</span><span class="op" id="5201661">,</span>&nbsp;<span class="ident" id="5201663">f</span><span class="op" id="5201664">.</span><span class="ident" id="5201665">ByteOrder</span><span class="op" id="5201674">,</span>&nbsp;<span class="ident" id="5201676">ph</span><span class="op" id="5201678">)</span><span class="op" id="5201679">;</span>&nbsp;<span class="ident" id="5201681">err</span>&nbsp;<span class="op" id="5201685">!=</span>&nbsp;<span class="ident" id="5201688">nil</span>&nbsp;<span class="op" id="5201692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201698">return</span>&nbsp;<span class="ident" id="5201705">nil</span><span class="op" id="5201708">,</span>&nbsp;<span class="ident" id="5201710">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5201717">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201722">p</span><span class="op" id="5201723">.</span><span class="ident" id="5201724">ProgHeader</span>&nbsp;<span class="op" id="5201735">=</span>&nbsp;<span class="ident" id="5201737">ProgHeader</span><span class="op" id="5201747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201753">Type</span><span class="op" id="5201757">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5201761">ProgType</span><span class="op" id="5201769">(</span><span class="ident" id="5201770">ph</span><span class="op" id="5201772">.</span><span class="ident" id="5201773">Type</span><span class="op" id="5201777">)</span><span class="op" id="5201778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201784">Flags</span><span class="op" id="5201789">:</span>&nbsp;&nbsp;<span class="ident" id="5201792">ProgFlag</span><span class="op" id="5201800">(</span><span class="ident" id="5201801">ph</span><span class="op" id="5201803">.</span><span class="ident" id="5201804">Flags</span><span class="op" id="5201809">)</span><span class="op" id="5201810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201816">Off</span><span class="op" id="5201819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5201824">uint64</span><span class="op" id="5201830">(</span><span class="ident" id="5201831">ph</span><span class="op" id="5201833">.</span><span class="ident" id="5201834">Off</span><span class="op" id="5201837">)</span><span class="op" id="5201838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201844">Vaddr</span><span class="op" id="5201849">:</span>&nbsp;&nbsp;<span class="ident" id="5201852">uint64</span><span class="op" id="5201858">(</span><span class="ident" id="5201859">ph</span><span class="op" id="5201861">.</span><span class="ident" id="5201862">Vaddr</span><span class="op" id="5201867">)</span><span class="op" id="5201868">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201874">Paddr</span><span class="op" id="5201879">:</span>&nbsp;&nbsp;<span class="ident" id="5201882">uint64</span><span class="op" id="5201888">(</span><span class="ident" id="5201889">ph</span><span class="op" id="5201891">.</span><span class="ident" id="5201892">Paddr</span><span class="op" id="5201897">)</span><span class="op" id="5201898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201904">Filesz</span><span class="op" id="5201910">:</span>&nbsp;<span class="ident" id="5201912">uint64</span><span class="op" id="5201918">(</span><span class="ident" id="5201919">ph</span><span class="op" id="5201921">.</span><span class="ident" id="5201922">Filesz</span><span class="op" id="5201928">)</span><span class="op" id="5201929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201935">Memsz</span><span class="op" id="5201940">:</span>&nbsp;&nbsp;<span class="ident" id="5201943">uint64</span><span class="op" id="5201949">(</span><span class="ident" id="5201950">ph</span><span class="op" id="5201952">.</span><span class="ident" id="5201953">Memsz</span><span class="op" id="5201958">)</span><span class="op" id="5201959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5201965">Align</span><span class="op" id="5201970">:</span>&nbsp;&nbsp;<span class="ident" id="5201973">uint64</span><span class="op" id="5201979">(</span><span class="ident" id="5201980">ph</span><span class="op" id="5201982">.</span><span class="ident" id="5201983">Align</span><span class="op" id="5201988">)</span><span class="op" id="5201989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5201994">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5201998">case</span>&nbsp;<span class="ident" id="5202003">ELFCLASS64</span><span class="op" id="5202013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202018">ph</span>&nbsp;<span class="op" id="5202021">:=</span>&nbsp;<span class="builtinfunc" id="5202024">new</span><span class="op" id="5202027">(</span><span class="ident" id="5202028">Prog64</span><span class="op" id="5202034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202039">if</span>&nbsp;<span class="ident" id="5202042">err</span>&nbsp;<span class="op" id="5202046">:=</span>&nbsp;<span class="ident" id="5202049">binary</span><span class="op" id="5202055">.</span><span class="ident" id="5202056">Read</span><span class="op" id="5202060">(</span><span class="ident" id="5202061">sr</span><span class="op" id="5202063">,</span>&nbsp;<span class="ident" id="5202065">f</span><span class="op" id="5202066">.</span><span class="ident" id="5202067">ByteOrder</span><span class="op" id="5202076">,</span>&nbsp;<span class="ident" id="5202078">ph</span><span class="op" id="5202080">)</span><span class="op" id="5202081">;</span>&nbsp;<span class="ident" id="5202083">err</span>&nbsp;<span class="op" id="5202087">!=</span>&nbsp;<span class="ident" id="5202090">nil</span>&nbsp;<span class="op" id="5202094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202100">return</span>&nbsp;<span class="ident" id="5202107">nil</span><span class="op" id="5202110">,</span>&nbsp;<span class="ident" id="5202112">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5202119">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202124">p</span><span class="op" id="5202125">.</span><span class="ident" id="5202126">ProgHeader</span>&nbsp;<span class="op" id="5202137">=</span>&nbsp;<span class="ident" id="5202139">ProgHeader</span><span class="op" id="5202149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202155">Type</span><span class="op" id="5202159">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5202163">ProgType</span><span class="op" id="5202171">(</span><span class="ident" id="5202172">ph</span><span class="op" id="5202174">.</span><span class="ident" id="5202175">Type</span><span class="op" id="5202179">)</span><span class="op" id="5202180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202186">Flags</span><span class="op" id="5202191">:</span>&nbsp;&nbsp;<span class="ident" id="5202194">ProgFlag</span><span class="op" id="5202202">(</span><span class="ident" id="5202203">ph</span><span class="op" id="5202205">.</span><span class="ident" id="5202206">Flags</span><span class="op" id="5202211">)</span><span class="op" id="5202212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202218">Off</span><span class="op" id="5202221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202226">uint64</span><span class="op" id="5202232">(</span><span class="ident" id="5202233">ph</span><span class="op" id="5202235">.</span><span class="ident" id="5202236">Off</span><span class="op" id="5202239">)</span><span class="op" id="5202240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202246">Vaddr</span><span class="op" id="5202251">:</span>&nbsp;&nbsp;<span class="ident" id="5202254">uint64</span><span class="op" id="5202260">(</span><span class="ident" id="5202261">ph</span><span class="op" id="5202263">.</span><span class="ident" id="5202264">Vaddr</span><span class="op" id="5202269">)</span><span class="op" id="5202270">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202276">Paddr</span><span class="op" id="5202281">:</span>&nbsp;&nbsp;<span class="ident" id="5202284">uint64</span><span class="op" id="5202290">(</span><span class="ident" id="5202291">ph</span><span class="op" id="5202293">.</span><span class="ident" id="5202294">Paddr</span><span class="op" id="5202299">)</span><span class="op" id="5202300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202306">Filesz</span><span class="op" id="5202312">:</span>&nbsp;<span class="ident" id="5202314">uint64</span><span class="op" id="5202320">(</span><span class="ident" id="5202321">ph</span><span class="op" id="5202323">.</span><span class="ident" id="5202324">Filesz</span><span class="op" id="5202330">)</span><span class="op" id="5202331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202337">Memsz</span><span class="op" id="5202342">:</span>&nbsp;&nbsp;<span class="ident" id="5202345">uint64</span><span class="op" id="5202351">(</span><span class="ident" id="5202352">ph</span><span class="op" id="5202354">.</span><span class="ident" id="5202355">Memsz</span><span class="op" id="5202360">)</span><span class="op" id="5202361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202367">Align</span><span class="op" id="5202372">:</span>&nbsp;&nbsp;<span class="ident" id="5202375">uint64</span><span class="op" id="5202381">(</span><span class="ident" id="5202382">ph</span><span class="op" id="5202384">.</span><span class="ident" id="5202385">Align</span><span class="op" id="5202390">)</span><span class="op" id="5202391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5202396">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5202400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202404">p</span><span class="op" id="5202405">.</span><span class="ident" id="5202406">sr</span>&nbsp;<span class="op" id="5202409">=</span>&nbsp;<span class="ident" id="5202411">io</span><span class="op" id="5202413">.</span><span class="ident" id="5202414">NewSectionReader</span><span class="op" id="5202430">(</span><span class="ident" id="5202431">r</span><span class="op" id="5202432">,</span>&nbsp;<span class="ident" id="5202434">int64</span><span class="op" id="5202439">(</span><span class="ident" id="5202440">p</span><span class="op" id="5202441">.</span><span class="ident" id="5202442">Off</span><span class="op" id="5202445">)</span><span class="op" id="5202446">,</span>&nbsp;<span class="ident" id="5202448">int64</span><span class="op" id="5202453">(</span><span class="ident" id="5202454">p</span><span class="op" id="5202455">.</span><span class="ident" id="5202456">Filesz</span><span class="op" id="5202462">)</span><span class="op" id="5202463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202467">p</span><span class="op" id="5202468">.</span><span class="ident" id="5202469">ReaderAt</span>&nbsp;<span class="op" id="5202478">=</span>&nbsp;<span class="ident" id="5202480">p</span><span class="op" id="5202481">.</span><span class="ident" id="5202482">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202487">f</span><span class="op" id="5202488">.</span><span class="ident" id="5202489">Progs</span><span class="op" id="5202494">[</span><span class="ident" id="5202495">i</span><span class="op" id="5202496">]</span>&nbsp;<span class="op" id="5202498">=</span>&nbsp;<span class="ident" id="5202500">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5202503">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5202507">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202532">f</span><span class="op" id="5202533">.</span><span class="ident" id="5202534">Sections</span>&nbsp;<span class="op" id="5202543">=</span>&nbsp;<span class="builtinfunc" id="5202545">make</span><span class="op" id="5202549">(</span><span class="op" id="5202550">[</span><span class="op" id="5202551">]</span><span class="op" id="5202552">*</span><span class="ident" id="5202553">Section</span><span class="op" id="5202560">,</span>&nbsp;<span class="ident" id="5202562">shnum</span><span class="op" id="5202567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202570">names</span>&nbsp;<span class="op" id="5202576">:=</span>&nbsp;<span class="builtinfunc" id="5202579">make</span><span class="op" id="5202583">(</span><span class="op" id="5202584">[</span><span class="op" id="5202585">]</span><span class="builtintype" id="5202586">uint32</span><span class="op" id="5202592">,</span>&nbsp;<span class="ident" id="5202594">shnum</span><span class="op" id="5202599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202602">for</span>&nbsp;<span class="ident" id="5202606">i</span>&nbsp;<span class="op" id="5202608">:=</span>&nbsp;<span class="num" id="5202611">0</span><span class="op" id="5202612">;</span>&nbsp;<span class="ident" id="5202614">i</span>&nbsp;<span class="op" id="5202616">&lt;</span>&nbsp;<span class="ident" id="5202618">shnum</span><span class="op" id="5202623">;</span>&nbsp;<span class="ident" id="5202625">i</span><span class="op" id="5202626">++</span>&nbsp;<span class="op" id="5202629">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202633">off</span>&nbsp;<span class="op" id="5202637">:=</span>&nbsp;<span class="ident" id="5202640">shoff</span>&nbsp;<span class="op" id="5202646">+</span>&nbsp;<span class="ident" id="5202648">int64</span><span class="op" id="5202653">(</span><span class="ident" id="5202654">i</span><span class="op" id="5202655">)</span><span class="op" id="5202656">*</span><span class="ident" id="5202657">int64</span><span class="op" id="5202662">(</span><span class="ident" id="5202663">shentsize</span><span class="op" id="5202672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202676">sr</span><span class="op" id="5202678">.</span><span class="ident" id="5202679">Seek</span><span class="op" id="5202683">(</span><span class="ident" id="5202684">off</span><span class="op" id="5202687">,</span>&nbsp;<span class="ident" id="5202689">os</span><span class="op" id="5202691">.</span><span class="ident" id="5202692">SEEK_SET</span><span class="op" id="5202700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202704">s</span>&nbsp;<span class="op" id="5202706">:=</span>&nbsp;<span class="builtinfunc" id="5202709">new</span><span class="op" id="5202712">(</span><span class="ident" id="5202713">Section</span><span class="op" id="5202720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202724">switch</span>&nbsp;<span class="ident" id="5202731">f</span><span class="op" id="5202732">.</span><span class="ident" id="5202733">Class</span>&nbsp;<span class="op" id="5202739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202743">case</span>&nbsp;<span class="ident" id="5202748">ELFCLASS32</span><span class="op" id="5202758">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202763">sh</span>&nbsp;<span class="op" id="5202766">:=</span>&nbsp;<span class="builtinfunc" id="5202769">new</span><span class="op" id="5202772">(</span><span class="ident" id="5202773">Section32</span><span class="op" id="5202782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202787">if</span>&nbsp;<span class="ident" id="5202790">err</span>&nbsp;<span class="op" id="5202794">:=</span>&nbsp;<span class="ident" id="5202797">binary</span><span class="op" id="5202803">.</span><span class="ident" id="5202804">Read</span><span class="op" id="5202808">(</span><span class="ident" id="5202809">sr</span><span class="op" id="5202811">,</span>&nbsp;<span class="ident" id="5202813">f</span><span class="op" id="5202814">.</span><span class="ident" id="5202815">ByteOrder</span><span class="op" id="5202824">,</span>&nbsp;<span class="ident" id="5202826">sh</span><span class="op" id="5202828">)</span><span class="op" id="5202829">;</span>&nbsp;<span class="ident" id="5202831">err</span>&nbsp;<span class="op" id="5202835">!=</span>&nbsp;<span class="ident" id="5202838">nil</span>&nbsp;<span class="op" id="5202842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5202848">return</span>&nbsp;<span class="ident" id="5202855">nil</span><span class="op" id="5202858">,</span>&nbsp;<span class="ident" id="5202860">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5202867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202872">names</span><span class="op" id="5202877">[</span><span class="ident" id="5202878">i</span><span class="op" id="5202879">]</span>&nbsp;<span class="op" id="5202881">=</span>&nbsp;<span class="ident" id="5202883">sh</span><span class="op" id="5202885">.</span><span class="ident" id="5202886">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202894">s</span><span class="op" id="5202895">.</span><span class="ident" id="5202896">SectionHeader</span>&nbsp;<span class="op" id="5202910">=</span>&nbsp;<span class="ident" id="5202912">SectionHeader</span><span class="op" id="5202925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202931">Type</span><span class="op" id="5202935">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202942">SectionType</span><span class="op" id="5202953">(</span><span class="ident" id="5202954">sh</span><span class="op" id="5202956">.</span><span class="ident" id="5202957">Type</span><span class="op" id="5202961">)</span><span class="op" id="5202962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5202968">Flags</span><span class="op" id="5202973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202979">SectionFlag</span><span class="op" id="5202990">(</span><span class="ident" id="5202991">sh</span><span class="op" id="5202993">.</span><span class="ident" id="5202994">Flags</span><span class="op" id="5202999">)</span><span class="op" id="5203000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203006">Addr</span><span class="op" id="5203010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203017">uint64</span><span class="op" id="5203023">(</span><span class="ident" id="5203024">sh</span><span class="op" id="5203026">.</span><span class="ident" id="5203027">Addr</span><span class="op" id="5203031">)</span><span class="op" id="5203032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203038">Offset</span><span class="op" id="5203044">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203049">uint64</span><span class="op" id="5203055">(</span><span class="ident" id="5203056">sh</span><span class="op" id="5203058">.</span><span class="ident" id="5203059">Off</span><span class="op" id="5203062">)</span><span class="op" id="5203063">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203069">Size</span><span class="op" id="5203073">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203080">uint64</span><span class="op" id="5203086">(</span><span class="ident" id="5203087">sh</span><span class="op" id="5203089">.</span><span class="ident" id="5203090">Size</span><span class="op" id="5203094">)</span><span class="op" id="5203095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203101">Link</span><span class="op" id="5203105">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5203112">uint32</span><span class="op" id="5203118">(</span><span class="ident" id="5203119">sh</span><span class="op" id="5203121">.</span><span class="ident" id="5203122">Link</span><span class="op" id="5203126">)</span><span class="op" id="5203127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203133">Info</span><span class="op" id="5203137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5203144">uint32</span><span class="op" id="5203150">(</span><span class="ident" id="5203151">sh</span><span class="op" id="5203153">.</span><span class="ident" id="5203154">Info</span><span class="op" id="5203158">)</span><span class="op" id="5203159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203165">Addralign</span><span class="op" id="5203174">:</span>&nbsp;<span class="ident" id="5203176">uint64</span><span class="op" id="5203182">(</span><span class="ident" id="5203183">sh</span><span class="op" id="5203185">.</span><span class="ident" id="5203186">Addralign</span><span class="op" id="5203195">)</span><span class="op" id="5203196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203202">Entsize</span><span class="op" id="5203209">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5203213">uint64</span><span class="op" id="5203219">(</span><span class="ident" id="5203220">sh</span><span class="op" id="5203222">.</span><span class="ident" id="5203223">Entsize</span><span class="op" id="5203230">)</span><span class="op" id="5203231">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203240">case</span>&nbsp;<span class="ident" id="5203245">ELFCLASS64</span><span class="op" id="5203255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203260">sh</span>&nbsp;<span class="op" id="5203263">:=</span>&nbsp;<span class="builtinfunc" id="5203266">new</span><span class="op" id="5203269">(</span><span class="ident" id="5203270">Section64</span><span class="op" id="5203279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203284">if</span>&nbsp;<span class="ident" id="5203287">err</span>&nbsp;<span class="op" id="5203291">:=</span>&nbsp;<span class="ident" id="5203294">binary</span><span class="op" id="5203300">.</span><span class="ident" id="5203301">Read</span><span class="op" id="5203305">(</span><span class="ident" id="5203306">sr</span><span class="op" id="5203308">,</span>&nbsp;<span class="ident" id="5203310">f</span><span class="op" id="5203311">.</span><span class="ident" id="5203312">ByteOrder</span><span class="op" id="5203321">,</span>&nbsp;<span class="ident" id="5203323">sh</span><span class="op" id="5203325">)</span><span class="op" id="5203326">;</span>&nbsp;<span class="ident" id="5203328">err</span>&nbsp;<span class="op" id="5203332">!=</span>&nbsp;<span class="ident" id="5203335">nil</span>&nbsp;<span class="op" id="5203339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203345">return</span>&nbsp;<span class="ident" id="5203352">nil</span><span class="op" id="5203355">,</span>&nbsp;<span class="ident" id="5203357">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203369">names</span><span class="op" id="5203374">[</span><span class="ident" id="5203375">i</span><span class="op" id="5203376">]</span>&nbsp;<span class="op" id="5203378">=</span>&nbsp;<span class="ident" id="5203380">sh</span><span class="op" id="5203382">.</span><span class="ident" id="5203383">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203391">s</span><span class="op" id="5203392">.</span><span class="ident" id="5203393">SectionHeader</span>&nbsp;<span class="op" id="5203407">=</span>&nbsp;<span class="ident" id="5203409">SectionHeader</span><span class="op" id="5203422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203428">Type</span><span class="op" id="5203432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203439">SectionType</span><span class="op" id="5203450">(</span><span class="ident" id="5203451">sh</span><span class="op" id="5203453">.</span><span class="ident" id="5203454">Type</span><span class="op" id="5203458">)</span><span class="op" id="5203459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203465">Flags</span><span class="op" id="5203470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203476">SectionFlag</span><span class="op" id="5203487">(</span><span class="ident" id="5203488">sh</span><span class="op" id="5203490">.</span><span class="ident" id="5203491">Flags</span><span class="op" id="5203496">)</span><span class="op" id="5203497">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203503">Offset</span><span class="op" id="5203509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203514">uint64</span><span class="op" id="5203520">(</span><span class="ident" id="5203521">sh</span><span class="op" id="5203523">.</span><span class="ident" id="5203524">Off</span><span class="op" id="5203527">)</span><span class="op" id="5203528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203534">Size</span><span class="op" id="5203538">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203545">uint64</span><span class="op" id="5203551">(</span><span class="ident" id="5203552">sh</span><span class="op" id="5203554">.</span><span class="ident" id="5203555">Size</span><span class="op" id="5203559">)</span><span class="op" id="5203560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203566">Addr</span><span class="op" id="5203570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203577">uint64</span><span class="op" id="5203583">(</span><span class="ident" id="5203584">sh</span><span class="op" id="5203586">.</span><span class="ident" id="5203587">Addr</span><span class="op" id="5203591">)</span><span class="op" id="5203592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203598">Link</span><span class="op" id="5203602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5203609">uint32</span><span class="op" id="5203615">(</span><span class="ident" id="5203616">sh</span><span class="op" id="5203618">.</span><span class="ident" id="5203619">Link</span><span class="op" id="5203623">)</span><span class="op" id="5203624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203630">Info</span><span class="op" id="5203634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5203641">uint32</span><span class="op" id="5203647">(</span><span class="ident" id="5203648">sh</span><span class="op" id="5203650">.</span><span class="ident" id="5203651">Info</span><span class="op" id="5203655">)</span><span class="op" id="5203656">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203662">Addralign</span><span class="op" id="5203671">:</span>&nbsp;<span class="ident" id="5203673">uint64</span><span class="op" id="5203679">(</span><span class="ident" id="5203680">sh</span><span class="op" id="5203682">.</span><span class="ident" id="5203683">Addralign</span><span class="op" id="5203692">)</span><span class="op" id="5203693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203699">Entsize</span><span class="op" id="5203706">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5203710">uint64</span><span class="op" id="5203716">(</span><span class="ident" id="5203717">sh</span><span class="op" id="5203719">.</span><span class="ident" id="5203720">Entsize</span><span class="op" id="5203727">)</span><span class="op" id="5203728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203741">s</span><span class="op" id="5203742">.</span><span class="ident" id="5203743">sr</span>&nbsp;<span class="op" id="5203746">=</span>&nbsp;<span class="ident" id="5203748">io</span><span class="op" id="5203750">.</span><span class="ident" id="5203751">NewSectionReader</span><span class="op" id="5203767">(</span><span class="ident" id="5203768">r</span><span class="op" id="5203769">,</span>&nbsp;<span class="ident" id="5203771">int64</span><span class="op" id="5203776">(</span><span class="ident" id="5203777">s</span><span class="op" id="5203778">.</span><span class="ident" id="5203779">Offset</span><span class="op" id="5203785">)</span><span class="op" id="5203786">,</span>&nbsp;<span class="ident" id="5203788">int64</span><span class="op" id="5203793">(</span><span class="ident" id="5203794">s</span><span class="op" id="5203795">.</span><span class="ident" id="5203796">Size</span><span class="op" id="5203800">)</span><span class="op" id="5203801">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203805">s</span><span class="op" id="5203806">.</span><span class="ident" id="5203807">ReaderAt</span>&nbsp;<span class="op" id="5203816">=</span>&nbsp;<span class="ident" id="5203818">s</span><span class="op" id="5203819">.</span><span class="ident" id="5203820">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203825">f</span><span class="op" id="5203826">.</span><span class="ident" id="5203827">Sections</span><span class="op" id="5203835">[</span><span class="ident" id="5203836">i</span><span class="op" id="5203837">]</span>&nbsp;<span class="op" id="5203839">=</span>&nbsp;<span class="ident" id="5203841">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203848">if</span>&nbsp;<span class="builtinfunc" id="5203851">len</span><span class="op" id="5203854">(</span><span class="ident" id="5203855">f</span><span class="op" id="5203856">.</span><span class="ident" id="5203857">Sections</span><span class="op" id="5203865">)</span>&nbsp;<span class="op" id="5203867">==</span>&nbsp;<span class="num" id="5203870">0</span>&nbsp;<span class="op" id="5203872">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203876">return</span>&nbsp;<span class="ident" id="5203883">f</span><span class="op" id="5203884">,</span>&nbsp;<span class="ident" id="5203886">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5203891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5203895">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203933">shstrtab</span><span class="op" id="5203941">,</span>&nbsp;<span class="ident" id="5203943">err</span>&nbsp;<span class="op" id="5203947">:=</span>&nbsp;<span class="ident" id="5203950">f</span><span class="op" id="5203951">.</span><span class="ident" id="5203952">Sections</span><span class="op" id="5203960">[</span><span class="ident" id="5203961">shstrndx</span><span class="op" id="5203969">]</span><span class="op" id="5203970">.</span><span class="ident" id="5203971">Data</span><span class="op" id="5203975">(</span><span class="op" id="5203976">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203979">if</span>&nbsp;<span class="ident" id="5203982">err</span>&nbsp;<span class="op" id="5203986">!=</span>&nbsp;<span class="ident" id="5203989">nil</span>&nbsp;<span class="op" id="5203993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5203997">return</span>&nbsp;<span class="ident" id="5204004">nil</span><span class="op" id="5204007">,</span>&nbsp;<span class="ident" id="5204009">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5204014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204017">for</span>&nbsp;<span class="ident" id="5204021">i</span><span class="op" id="5204022">,</span>&nbsp;<span class="ident" id="5204024">s</span>&nbsp;<span class="op" id="5204026">:=</span>&nbsp;<span class="keyword" id="5204029">range</span>&nbsp;<span class="ident" id="5204035">f</span><span class="op" id="5204036">.</span><span class="ident" id="5204037">Sections</span>&nbsp;<span class="op" id="5204046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204050">var</span>&nbsp;<span class="ident" id="5204054">ok</span>&nbsp;<span class="builtintype" id="5204057">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204064">s</span><span class="op" id="5204065">.</span><span class="ident" id="5204066">Name</span><span class="op" id="5204070">,</span>&nbsp;<span class="ident" id="5204072">ok</span>&nbsp;<span class="op" id="5204075">=</span>&nbsp;<span class="ident" id="5204077">getString</span><span class="op" id="5204086">(</span><span class="ident" id="5204087">shstrtab</span><span class="op" id="5204095">,</span>&nbsp;<span class="builtintype" id="5204097">int</span><span class="op" id="5204100">(</span><span class="ident" id="5204101">names</span><span class="op" id="5204106">[</span><span class="ident" id="5204107">i</span><span class="op" id="5204108">]</span><span class="op" id="5204109">)</span><span class="op" id="5204110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204114">if</span>&nbsp;<span class="op" id="5204117">!</span><span class="ident" id="5204118">ok</span>&nbsp;<span class="op" id="5204121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204126">return</span>&nbsp;<span class="ident" id="5204133">nil</span><span class="op" id="5204136">,</span>&nbsp;<span class="op" id="5204138">&amp;</span><span class="ident" id="5204139">FormatError</span><span class="op" id="5204150">{</span><span class="ident" id="5204151">shoff</span>&nbsp;<span class="op" id="5204157">+</span>&nbsp;<span class="ident" id="5204159">int64</span><span class="op" id="5204164">(</span><span class="ident" id="5204165">i</span><span class="op" id="5204166">*</span><span class="ident" id="5204167">shentsize</span><span class="op" id="5204176">)</span><span class="op" id="5204177">,</span>&nbsp;<span class="string" id="5204179">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5204203">,</span>&nbsp;<span class="ident" id="5204205">names</span><span class="op" id="5204210">[</span><span class="ident" id="5204211">i</span><span class="op" id="5204212">]</span><span class="op" id="5204213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5204217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5204220">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204224">return</span>&nbsp;<span class="ident" id="5204231">f</span><span class="op" id="5204232">,</span>&nbsp;<span class="ident" id="5204234">nil</span><br>
<span class="lineno"></span><span class="op" id="5204238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5204241">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5204312">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5204376">func</span>&nbsp;<span class="op" id="5204381">(</span><span class="ident" id="5204382">f</span>&nbsp;<span class="op" id="5204384">*</span><span class="ident" id="5204385">File</span><span class="op" id="5204389">)</span>&nbsp;<span class="ident" id="5204391">getSymbols</span><span class="op" id="5204401">(</span><span class="ident" id="5204402">typ</span>&nbsp;<span class="ident" id="5204406">SectionType</span><span class="op" id="5204417">)</span>&nbsp;<span class="op" id="5204419">(</span><span class="op" id="5204420">[</span><span class="op" id="5204421">]</span><span class="ident" id="5204422">Symbol</span><span class="op" id="5204428">,</span>&nbsp;<span class="op" id="5204430">[</span><span class="op" id="5204431">]</span><span class="builtintype" id="5204432">byte</span><span class="op" id="5204436">,</span>&nbsp;<span class="builtintype" id="5204438">error</span><span class="op" id="5204443">)</span>&nbsp;<span class="op" id="5204445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204448">switch</span>&nbsp;<span class="ident" id="5204455">f</span><span class="op" id="5204456">.</span><span class="ident" id="5204457">Class</span>&nbsp;<span class="op" id="5204463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204466">case</span>&nbsp;<span class="ident" id="5204471">ELFCLASS64</span><span class="op" id="5204481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204485">return</span>&nbsp;<span class="ident" id="5204492">f</span><span class="op" id="5204493">.</span><span class="ident" id="5204494">getSymbols64</span><span class="op" id="5204506">(</span><span class="ident" id="5204507">typ</span><span class="op" id="5204510">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204514">case</span>&nbsp;<span class="ident" id="5204519">ELFCLASS32</span><span class="op" id="5204529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204533">return</span>&nbsp;<span class="ident" id="5204540">f</span><span class="op" id="5204541">.</span><span class="ident" id="5204542">getSymbols32</span><span class="op" id="5204554">(</span><span class="ident" id="5204555">typ</span><span class="op" id="5204558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5204561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204565">return</span>&nbsp;<span class="ident" id="5204572">nil</span><span class="op" id="5204575">,</span>&nbsp;<span class="ident" id="5204577">nil</span><span class="op" id="5204580">,</span>&nbsp;<span class="ident" id="5204582">errors</span><span class="op" id="5204588">.</span><span class="ident" id="5204589">New</span><span class="op" id="5204592">(</span><span class="string" id="5204593">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5204610">)</span><br>
<span class="lineno"></span><span class="op" id="5204612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5204615">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5204683">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5204727">var</span>&nbsp;<span class="ident" id="5204731">ErrNoSymbols</span>&nbsp;<span class="op" id="5204744">=</span>&nbsp;<span class="ident" id="5204746">errors</span><span class="op" id="5204752">.</span><span class="ident" id="5204753">New</span><span class="op" id="5204756">(</span><span class="string" id="5204757">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5204776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5204779">func</span>&nbsp;<span class="op" id="5204784">(</span><span class="ident" id="5204785">f</span>&nbsp;<span class="op" id="5204787">*</span><span class="ident" id="5204788">File</span><span class="op" id="5204792">)</span>&nbsp;<span class="ident" id="5204794">getSymbols32</span><span class="op" id="5204806">(</span><span class="ident" id="5204807">typ</span>&nbsp;<span class="ident" id="5204811">SectionType</span><span class="op" id="5204822">)</span>&nbsp;<span class="op" id="5204824">(</span><span class="op" id="5204825">[</span><span class="op" id="5204826">]</span><span class="ident" id="5204827">Symbol</span><span class="op" id="5204833">,</span>&nbsp;<span class="op" id="5204835">[</span><span class="op" id="5204836">]</span><span class="builtintype" id="5204837">byte</span><span class="op" id="5204841">,</span>&nbsp;<span class="builtintype" id="5204843">error</span><span class="op" id="5204848">)</span>&nbsp;<span class="op" id="5204850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204853">symtabSection</span>&nbsp;<span class="op" id="5204867">:=</span>&nbsp;<span class="ident" id="5204870">f</span><span class="op" id="5204871">.</span><span class="ident" id="5204872">SectionByType</span><span class="op" id="5204885">(</span><span class="ident" id="5204886">typ</span><span class="op" id="5204889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204892">if</span>&nbsp;<span class="ident" id="5204895">symtabSection</span>&nbsp;<span class="op" id="5204909">==</span>&nbsp;<span class="ident" id="5204912">nil</span>&nbsp;<span class="op" id="5204916">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204920">return</span>&nbsp;<span class="ident" id="5204927">nil</span><span class="op" id="5204930">,</span>&nbsp;<span class="ident" id="5204932">nil</span><span class="op" id="5204935">,</span>&nbsp;<span class="ident" id="5204937">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5204951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204955">data</span><span class="op" id="5204959">,</span>&nbsp;<span class="ident" id="5204961">err</span>&nbsp;<span class="op" id="5204965">:=</span>&nbsp;<span class="ident" id="5204968">symtabSection</span><span class="op" id="5204981">.</span><span class="ident" id="5204982">Data</span><span class="op" id="5204986">(</span><span class="op" id="5204987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5204990">if</span>&nbsp;<span class="ident" id="5204993">err</span>&nbsp;<span class="op" id="5204997">!=</span>&nbsp;<span class="ident" id="5205000">nil</span>&nbsp;<span class="op" id="5205004">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205008">return</span>&nbsp;<span class="ident" id="5205015">nil</span><span class="op" id="5205018">,</span>&nbsp;<span class="ident" id="5205020">nil</span><span class="op" id="5205023">,</span>&nbsp;<span class="ident" id="5205025">errors</span><span class="op" id="5205031">.</span><span class="ident" id="5205032">New</span><span class="op" id="5205035">(</span><span class="string" id="5205036">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5205064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205070">symtab</span>&nbsp;<span class="op" id="5205077">:=</span>&nbsp;<span class="ident" id="5205080">bytes</span><span class="op" id="5205085">.</span><span class="ident" id="5205086">NewReader</span><span class="op" id="5205095">(</span><span class="ident" id="5205096">data</span><span class="op" id="5205100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205103">if</span>&nbsp;<span class="ident" id="5205106">symtab</span><span class="op" id="5205112">.</span><span class="ident" id="5205113">Len</span><span class="op" id="5205116">(</span><span class="op" id="5205117">)</span><span class="op" id="5205118">%</span><span class="ident" id="5205119">Sym32Size</span>&nbsp;<span class="op" id="5205129">!=</span>&nbsp;<span class="num" id="5205132">0</span>&nbsp;<span class="op" id="5205134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205138">return</span>&nbsp;<span class="ident" id="5205145">nil</span><span class="op" id="5205148">,</span>&nbsp;<span class="ident" id="5205150">nil</span><span class="op" id="5205153">,</span>&nbsp;<span class="ident" id="5205155">errors</span><span class="op" id="5205161">.</span><span class="ident" id="5205162">New</span><span class="op" id="5205165">(</span><span class="string" id="5205166">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5205221">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205228">strdata</span><span class="op" id="5205235">,</span>&nbsp;<span class="ident" id="5205237">err</span>&nbsp;<span class="op" id="5205241">:=</span>&nbsp;<span class="ident" id="5205244">f</span><span class="op" id="5205245">.</span><span class="ident" id="5205246">stringTable</span><span class="op" id="5205257">(</span><span class="ident" id="5205258">symtabSection</span><span class="op" id="5205271">.</span><span class="ident" id="5205272">Link</span><span class="op" id="5205276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205279">if</span>&nbsp;<span class="ident" id="5205282">err</span>&nbsp;<span class="op" id="5205286">!=</span>&nbsp;<span class="ident" id="5205289">nil</span>&nbsp;<span class="op" id="5205293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205297">return</span>&nbsp;<span class="ident" id="5205304">nil</span><span class="op" id="5205307">,</span>&nbsp;<span class="ident" id="5205309">nil</span><span class="op" id="5205312">,</span>&nbsp;<span class="ident" id="5205314">errors</span><span class="op" id="5205320">.</span><span class="ident" id="5205321">New</span><span class="op" id="5205324">(</span><span class="string" id="5205325">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5205359">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5205366">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205400">var</span>&nbsp;<span class="ident" id="5205404">skip</span>&nbsp;<span class="op" id="5205409">[</span><span class="ident" id="5205410">Sym32Size</span><span class="op" id="5205419">]</span><span class="builtintype" id="5205420">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205426">symtab</span><span class="op" id="5205432">.</span><span class="ident" id="5205433">Read</span><span class="op" id="5205437">(</span><span class="ident" id="5205438">skip</span><span class="op" id="5205442">[</span><span class="op" id="5205443">:</span><span class="op" id="5205444">]</span><span class="op" id="5205445">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205449">symbols</span>&nbsp;<span class="op" id="5205457">:=</span>&nbsp;<span class="builtinfunc" id="5205460">make</span><span class="op" id="5205464">(</span><span class="op" id="5205465">[</span><span class="op" id="5205466">]</span><span class="ident" id="5205467">Symbol</span><span class="op" id="5205473">,</span>&nbsp;<span class="ident" id="5205475">symtab</span><span class="op" id="5205481">.</span><span class="ident" id="5205482">Len</span><span class="op" id="5205485">(</span><span class="op" id="5205486">)</span><span class="op" id="5205487">/</span><span class="ident" id="5205488">Sym32Size</span><span class="op" id="5205497">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205501">i</span>&nbsp;<span class="op" id="5205503">:=</span>&nbsp;<span class="num" id="5205506">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205509">var</span>&nbsp;<span class="ident" id="5205513">sym</span>&nbsp;<span class="ident" id="5205517">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205524">for</span>&nbsp;<span class="ident" id="5205528">symtab</span><span class="op" id="5205534">.</span><span class="ident" id="5205535">Len</span><span class="op" id="5205538">(</span><span class="op" id="5205539">)</span>&nbsp;<span class="op" id="5205541">&gt;</span>&nbsp;<span class="num" id="5205543">0</span>&nbsp;<span class="op" id="5205545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205549">binary</span><span class="op" id="5205555">.</span><span class="ident" id="5205556">Read</span><span class="op" id="5205560">(</span><span class="ident" id="5205561">symtab</span><span class="op" id="5205567">,</span>&nbsp;<span class="ident" id="5205569">f</span><span class="op" id="5205570">.</span><span class="ident" id="5205571">ByteOrder</span><span class="op" id="5205580">,</span>&nbsp;<span class="op" id="5205582">&amp;</span><span class="ident" id="5205583">sym</span><span class="op" id="5205586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205590">str</span><span class="op" id="5205593">,</span>&nbsp;<span class="ident" id="5205595">_</span>&nbsp;<span class="op" id="5205597">:=</span>&nbsp;<span class="ident" id="5205600">getString</span><span class="op" id="5205609">(</span><span class="ident" id="5205610">strdata</span><span class="op" id="5205617">,</span>&nbsp;<span class="builtintype" id="5205619">int</span><span class="op" id="5205622">(</span><span class="ident" id="5205623">sym</span><span class="op" id="5205626">.</span><span class="ident" id="5205627">Name</span><span class="op" id="5205631">)</span><span class="op" id="5205632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205636">symbols</span><span class="op" id="5205643">[</span><span class="ident" id="5205644">i</span><span class="op" id="5205645">]</span><span class="op" id="5205646">.</span><span class="ident" id="5205647">Name</span>&nbsp;<span class="op" id="5205652">=</span>&nbsp;<span class="ident" id="5205654">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205660">symbols</span><span class="op" id="5205667">[</span><span class="ident" id="5205668">i</span><span class="op" id="5205669">]</span><span class="op" id="5205670">.</span><span class="ident" id="5205671">Info</span>&nbsp;<span class="op" id="5205676">=</span>&nbsp;<span class="ident" id="5205678">sym</span><span class="op" id="5205681">.</span><span class="ident" id="5205682">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205689">symbols</span><span class="op" id="5205696">[</span><span class="ident" id="5205697">i</span><span class="op" id="5205698">]</span><span class="op" id="5205699">.</span><span class="ident" id="5205700">Other</span>&nbsp;<span class="op" id="5205706">=</span>&nbsp;<span class="ident" id="5205708">sym</span><span class="op" id="5205711">.</span><span class="ident" id="5205712">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205720">symbols</span><span class="op" id="5205727">[</span><span class="ident" id="5205728">i</span><span class="op" id="5205729">]</span><span class="op" id="5205730">.</span><span class="ident" id="5205731">Section</span>&nbsp;<span class="op" id="5205739">=</span>&nbsp;<span class="ident" id="5205741">SectionIndex</span><span class="op" id="5205753">(</span><span class="ident" id="5205754">sym</span><span class="op" id="5205757">.</span><span class="ident" id="5205758">Shndx</span><span class="op" id="5205763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205767">symbols</span><span class="op" id="5205774">[</span><span class="ident" id="5205775">i</span><span class="op" id="5205776">]</span><span class="op" id="5205777">.</span><span class="ident" id="5205778">Value</span>&nbsp;<span class="op" id="5205784">=</span>&nbsp;<span class="ident" id="5205786">uint64</span><span class="op" id="5205792">(</span><span class="ident" id="5205793">sym</span><span class="op" id="5205796">.</span><span class="ident" id="5205797">Value</span><span class="op" id="5205802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205806">symbols</span><span class="op" id="5205813">[</span><span class="ident" id="5205814">i</span><span class="op" id="5205815">]</span><span class="op" id="5205816">.</span><span class="ident" id="5205817">Size</span>&nbsp;<span class="op" id="5205822">=</span>&nbsp;<span class="ident" id="5205824">uint64</span><span class="op" id="5205830">(</span><span class="ident" id="5205831">sym</span><span class="op" id="5205834">.</span><span class="ident" id="5205835">Size</span><span class="op" id="5205839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205843">i</span><span class="op" id="5205844">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205852">return</span>&nbsp;<span class="ident" id="5205859">symbols</span><span class="op" id="5205866">,</span>&nbsp;<span class="ident" id="5205868">strdata</span><span class="op" id="5205875">,</span>&nbsp;<span class="ident" id="5205877">nil</span><br>
<span class="lineno"></span><span class="op" id="5205881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5205884">func</span>&nbsp;<span class="op" id="5205889">(</span><span class="ident" id="5205890">f</span>&nbsp;<span class="op" id="5205892">*</span><span class="ident" id="5205893">File</span><span class="op" id="5205897">)</span>&nbsp;<span class="ident" id="5205899">getSymbols64</span><span class="op" id="5205911">(</span><span class="ident" id="5205912">typ</span>&nbsp;<span class="ident" id="5205916">SectionType</span><span class="op" id="5205927">)</span>&nbsp;<span class="op" id="5205929">(</span><span class="op" id="5205930">[</span><span class="op" id="5205931">]</span><span class="ident" id="5205932">Symbol</span><span class="op" id="5205938">,</span>&nbsp;<span class="op" id="5205940">[</span><span class="op" id="5205941">]</span><span class="builtintype" id="5205942">byte</span><span class="op" id="5205946">,</span>&nbsp;<span class="builtintype" id="5205948">error</span><span class="op" id="5205953">)</span>&nbsp;<span class="op" id="5205955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205958">symtabSection</span>&nbsp;<span class="op" id="5205972">:=</span>&nbsp;<span class="ident" id="5205975">f</span><span class="op" id="5205976">.</span><span class="ident" id="5205977">SectionByType</span><span class="op" id="5205990">(</span><span class="ident" id="5205991">typ</span><span class="op" id="5205994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205997">if</span>&nbsp;<span class="ident" id="5206000">symtabSection</span>&nbsp;<span class="op" id="5206014">==</span>&nbsp;<span class="ident" id="5206017">nil</span>&nbsp;<span class="op" id="5206021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206025">return</span>&nbsp;<span class="ident" id="5206032">nil</span><span class="op" id="5206035">,</span>&nbsp;<span class="ident" id="5206037">nil</span><span class="op" id="5206040">,</span>&nbsp;<span class="ident" id="5206042">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206056">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206060">data</span><span class="op" id="5206064">,</span>&nbsp;<span class="ident" id="5206066">err</span>&nbsp;<span class="op" id="5206070">:=</span>&nbsp;<span class="ident" id="5206073">symtabSection</span><span class="op" id="5206086">.</span><span class="ident" id="5206087">Data</span><span class="op" id="5206091">(</span><span class="op" id="5206092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206095">if</span>&nbsp;<span class="ident" id="5206098">err</span>&nbsp;<span class="op" id="5206102">!=</span>&nbsp;<span class="ident" id="5206105">nil</span>&nbsp;<span class="op" id="5206109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206113">return</span>&nbsp;<span class="ident" id="5206120">nil</span><span class="op" id="5206123">,</span>&nbsp;<span class="ident" id="5206125">nil</span><span class="op" id="5206128">,</span>&nbsp;<span class="ident" id="5206130">errors</span><span class="op" id="5206136">.</span><span class="ident" id="5206137">New</span><span class="op" id="5206140">(</span><span class="string" id="5206141">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5206169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206172">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206175">symtab</span>&nbsp;<span class="op" id="5206182">:=</span>&nbsp;<span class="ident" id="5206185">bytes</span><span class="op" id="5206190">.</span><span class="ident" id="5206191">NewReader</span><span class="op" id="5206200">(</span><span class="ident" id="5206201">data</span><span class="op" id="5206205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206208">if</span>&nbsp;<span class="ident" id="5206211">symtab</span><span class="op" id="5206217">.</span><span class="ident" id="5206218">Len</span><span class="op" id="5206221">(</span><span class="op" id="5206222">)</span><span class="op" id="5206223">%</span><span class="ident" id="5206224">Sym64Size</span>&nbsp;<span class="op" id="5206234">!=</span>&nbsp;<span class="num" id="5206237">0</span>&nbsp;<span class="op" id="5206239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206243">return</span>&nbsp;<span class="ident" id="5206250">nil</span><span class="op" id="5206253">,</span>&nbsp;<span class="ident" id="5206255">nil</span><span class="op" id="5206258">,</span>&nbsp;<span class="ident" id="5206260">errors</span><span class="op" id="5206266">.</span><span class="ident" id="5206267">New</span><span class="op" id="5206270">(</span><span class="string" id="5206271">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5206328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206335">strdata</span><span class="op" id="5206342">,</span>&nbsp;<span class="ident" id="5206344">err</span>&nbsp;<span class="op" id="5206348">:=</span>&nbsp;<span class="ident" id="5206351">f</span><span class="op" id="5206352">.</span><span class="ident" id="5206353">stringTable</span><span class="op" id="5206364">(</span><span class="ident" id="5206365">symtabSection</span><span class="op" id="5206378">.</span><span class="ident" id="5206379">Link</span><span class="op" id="5206383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206386">if</span>&nbsp;<span class="ident" id="5206389">err</span>&nbsp;<span class="op" id="5206393">!=</span>&nbsp;<span class="ident" id="5206396">nil</span>&nbsp;<span class="op" id="5206400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206404">return</span>&nbsp;<span class="ident" id="5206411">nil</span><span class="op" id="5206414">,</span>&nbsp;<span class="ident" id="5206416">nil</span><span class="op" id="5206419">,</span>&nbsp;<span class="ident" id="5206421">errors</span><span class="op" id="5206427">.</span><span class="ident" id="5206428">New</span><span class="op" id="5206431">(</span><span class="string" id="5206432">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5206466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206473">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206507">var</span>&nbsp;<span class="ident" id="5206511">skip</span>&nbsp;<span class="op" id="5206516">[</span><span class="ident" id="5206517">Sym64Size</span><span class="op" id="5206526">]</span><span class="builtintype" id="5206527">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206533">symtab</span><span class="op" id="5206539">.</span><span class="ident" id="5206540">Read</span><span class="op" id="5206544">(</span><span class="ident" id="5206545">skip</span><span class="op" id="5206549">[</span><span class="op" id="5206550">:</span><span class="op" id="5206551">]</span><span class="op" id="5206552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206556">symbols</span>&nbsp;<span class="op" id="5206564">:=</span>&nbsp;<span class="builtinfunc" id="5206567">make</span><span class="op" id="5206571">(</span><span class="op" id="5206572">[</span><span class="op" id="5206573">]</span><span class="ident" id="5206574">Symbol</span><span class="op" id="5206580">,</span>&nbsp;<span class="ident" id="5206582">symtab</span><span class="op" id="5206588">.</span><span class="ident" id="5206589">Len</span><span class="op" id="5206592">(</span><span class="op" id="5206593">)</span><span class="op" id="5206594">/</span><span class="ident" id="5206595">Sym64Size</span><span class="op" id="5206604">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206608">i</span>&nbsp;<span class="op" id="5206610">:=</span>&nbsp;<span class="num" id="5206613">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206616">var</span>&nbsp;<span class="ident" id="5206620">sym</span>&nbsp;<span class="ident" id="5206624">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206631">for</span>&nbsp;<span class="ident" id="5206635">symtab</span><span class="op" id="5206641">.</span><span class="ident" id="5206642">Len</span><span class="op" id="5206645">(</span><span class="op" id="5206646">)</span>&nbsp;<span class="op" id="5206648">&gt;</span>&nbsp;<span class="num" id="5206650">0</span>&nbsp;<span class="op" id="5206652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206656">binary</span><span class="op" id="5206662">.</span><span class="ident" id="5206663">Read</span><span class="op" id="5206667">(</span><span class="ident" id="5206668">symtab</span><span class="op" id="5206674">,</span>&nbsp;<span class="ident" id="5206676">f</span><span class="op" id="5206677">.</span><span class="ident" id="5206678">ByteOrder</span><span class="op" id="5206687">,</span>&nbsp;<span class="op" id="5206689">&amp;</span><span class="ident" id="5206690">sym</span><span class="op" id="5206693">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206697">str</span><span class="op" id="5206700">,</span>&nbsp;<span class="ident" id="5206702">_</span>&nbsp;<span class="op" id="5206704">:=</span>&nbsp;<span class="ident" id="5206707">getString</span><span class="op" id="5206716">(</span><span class="ident" id="5206717">strdata</span><span class="op" id="5206724">,</span>&nbsp;<span class="builtintype" id="5206726">int</span><span class="op" id="5206729">(</span><span class="ident" id="5206730">sym</span><span class="op" id="5206733">.</span><span class="ident" id="5206734">Name</span><span class="op" id="5206738">)</span><span class="op" id="5206739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206743">symbols</span><span class="op" id="5206750">[</span><span class="ident" id="5206751">i</span><span class="op" id="5206752">]</span><span class="op" id="5206753">.</span><span class="ident" id="5206754">Name</span>&nbsp;<span class="op" id="5206759">=</span>&nbsp;<span class="ident" id="5206761">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206767">symbols</span><span class="op" id="5206774">[</span><span class="ident" id="5206775">i</span><span class="op" id="5206776">]</span><span class="op" id="5206777">.</span><span class="ident" id="5206778">Info</span>&nbsp;<span class="op" id="5206783">=</span>&nbsp;<span class="ident" id="5206785">sym</span><span class="op" id="5206788">.</span><span class="ident" id="5206789">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206796">symbols</span><span class="op" id="5206803">[</span><span class="ident" id="5206804">i</span><span class="op" id="5206805">]</span><span class="op" id="5206806">.</span><span class="ident" id="5206807">Other</span>&nbsp;<span class="op" id="5206813">=</span>&nbsp;<span class="ident" id="5206815">sym</span><span class="op" id="5206818">.</span><span class="ident" id="5206819">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206827">symbols</span><span class="op" id="5206834">[</span><span class="ident" id="5206835">i</span><span class="op" id="5206836">]</span><span class="op" id="5206837">.</span><span class="ident" id="5206838">Section</span>&nbsp;<span class="op" id="5206846">=</span>&nbsp;<span class="ident" id="5206848">SectionIndex</span><span class="op" id="5206860">(</span><span class="ident" id="5206861">sym</span><span class="op" id="5206864">.</span><span class="ident" id="5206865">Shndx</span><span class="op" id="5206870">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206874">symbols</span><span class="op" id="5206881">[</span><span class="ident" id="5206882">i</span><span class="op" id="5206883">]</span><span class="op" id="5206884">.</span><span class="ident" id="5206885">Value</span>&nbsp;<span class="op" id="5206891">=</span>&nbsp;<span class="ident" id="5206893">sym</span><span class="op" id="5206896">.</span><span class="ident" id="5206897">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206905">symbols</span><span class="op" id="5206912">[</span><span class="ident" id="5206913">i</span><span class="op" id="5206914">]</span><span class="op" id="5206915">.</span><span class="ident" id="5206916">Size</span>&nbsp;<span class="op" id="5206921">=</span>&nbsp;<span class="ident" id="5206923">sym</span><span class="op" id="5206926">.</span><span class="ident" id="5206927">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206934">i</span><span class="op" id="5206935">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206943">return</span>&nbsp;<span class="ident" id="5206950">symbols</span><span class="op" id="5206957">,</span>&nbsp;<span class="ident" id="5206959">strdata</span><span class="op" id="5206966">,</span>&nbsp;<span class="ident" id="5206968">nil</span><br>
<span class="lineno"></span><span class="op" id="5206972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5206975">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5207032">func</span>&nbsp;<span class="ident" id="5207037">getString</span><span class="op" id="5207046">(</span><span class="ident" id="5207047">section</span>&nbsp;<span class="op" id="5207055">[</span><span class="op" id="5207056">]</span><span class="builtintype" id="5207057">byte</span><span class="op" id="5207061">,</span>&nbsp;<span class="ident" id="5207063">start</span>&nbsp;<span class="builtintype" id="5207069">int</span><span class="op" id="5207072">)</span>&nbsp;<span class="op" id="5207074">(</span><span class="builtintype" id="5207075">string</span><span class="op" id="5207081">,</span>&nbsp;<span class="builtintype" id="5207083">bool</span><span class="op" id="5207087">)</span>&nbsp;<span class="op" id="5207089">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207092">if</span>&nbsp;<span class="ident" id="5207095">start</span>&nbsp;<span class="op" id="5207101">&lt;</span>&nbsp;<span class="num" id="5207103">0</span>&nbsp;<span class="op" id="5207105">||</span>&nbsp;<span class="ident" id="5207108">start</span>&nbsp;<span class="op" id="5207114">&gt;=</span>&nbsp;<span class="builtinfunc" id="5207117">len</span><span class="op" id="5207120">(</span><span class="ident" id="5207121">section</span><span class="op" id="5207128">)</span>&nbsp;<span class="op" id="5207130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207134">return</span>&nbsp;<span class="string" id="5207141">&#34;&#34;</span><span class="op" id="5207143">,</span>&nbsp;<span class="builtintype" id="5207145">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207156">for</span>&nbsp;<span class="ident" id="5207160">end</span>&nbsp;<span class="op" id="5207164">:=</span>&nbsp;<span class="ident" id="5207167">start</span><span class="op" id="5207172">;</span>&nbsp;<span class="ident" id="5207174">end</span>&nbsp;<span class="op" id="5207178">&lt;</span>&nbsp;<span class="builtinfunc" id="5207180">len</span><span class="op" id="5207183">(</span><span class="ident" id="5207184">section</span><span class="op" id="5207191">)</span><span class="op" id="5207192">;</span>&nbsp;<span class="ident" id="5207194">end</span><span class="op" id="5207197">++</span>&nbsp;<span class="op" id="5207200">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207204">if</span>&nbsp;<span class="ident" id="5207207">section</span><span class="op" id="5207214">[</span><span class="ident" id="5207215">end</span><span class="op" id="5207218">]</span>&nbsp;<span class="op" id="5207220">==</span>&nbsp;<span class="num" id="5207223">0</span>&nbsp;<span class="op" id="5207225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207230">return</span>&nbsp;<span class="builtintype" id="5207237">string</span><span class="op" id="5207243">(</span><span class="ident" id="5207244">section</span><span class="op" id="5207251">[</span><span class="ident" id="5207252">start</span><span class="op" id="5207257">:</span><span class="ident" id="5207258">end</span><span class="op" id="5207261">]</span><span class="op" id="5207262">)</span><span class="op" id="5207263">,</span>&nbsp;<span class="builtintype" id="5207265">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207278">return</span>&nbsp;<span class="string" id="5207285">&#34;&#34;</span><span class="op" id="5207287">,</span>&nbsp;<span class="builtintype" id="5207289">false</span><br>
<span class="lineno">510</span><span class="op" id="5207295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5207298">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5207366">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5207385">func</span>&nbsp;<span class="op" id="5207390">(</span><span class="ident" id="5207391">f</span>&nbsp;<span class="op" id="5207393">*</span><span class="ident" id="5207394">File</span><span class="op" id="5207398">)</span>&nbsp;<span class="ident" id="5207400">Section</span><span class="op" id="5207407">(</span><span class="ident" id="5207408">name</span>&nbsp;<span class="builtintype" id="5207413">string</span><span class="op" id="5207419">)</span>&nbsp;<span class="op" id="5207421">*</span><span class="ident" id="5207422">Section</span>&nbsp;<span class="op" id="5207430">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207433">for</span>&nbsp;<span class="ident" id="5207437">_</span><span class="op" id="5207438">,</span>&nbsp;<span class="ident" id="5207440">s</span>&nbsp;<span class="op" id="5207442">:=</span>&nbsp;<span class="keyword" id="5207445">range</span>&nbsp;<span class="ident" id="5207451">f</span><span class="op" id="5207452">.</span><span class="ident" id="5207453">Sections</span>&nbsp;<span class="op" id="5207462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207466">if</span>&nbsp;<span class="ident" id="5207469">s</span><span class="op" id="5207470">.</span><span class="ident" id="5207471">Name</span>&nbsp;<span class="op" id="5207476">==</span>&nbsp;<span class="ident" id="5207479">name</span>&nbsp;<span class="op" id="5207484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207489">return</span>&nbsp;<span class="ident" id="5207496">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207503">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207506">return</span>&nbsp;<span class="ident" id="5207513">nil</span><br>
<span class="lineno"></span><span class="op" id="5207517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5207520">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5207598">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5207617">func</span>&nbsp;<span class="op" id="5207622">(</span><span class="ident" id="5207623">f</span>&nbsp;<span class="op" id="5207625">*</span><span class="ident" id="5207626">File</span><span class="op" id="5207630">)</span>&nbsp;<span class="ident" id="5207632">applyRelocations</span><span class="op" id="5207648">(</span><span class="ident" id="5207649">dst</span>&nbsp;<span class="op" id="5207653">[</span><span class="op" id="5207654">]</span><span class="builtintype" id="5207655">byte</span><span class="op" id="5207659">,</span>&nbsp;<span class="ident" id="5207661">rels</span>&nbsp;<span class="op" id="5207666">[</span><span class="op" id="5207667">]</span><span class="builtintype" id="5207668">byte</span><span class="op" id="5207672">)</span>&nbsp;<span class="builtintype" id="5207674">error</span>&nbsp;<span class="op" id="5207680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207683">if</span>&nbsp;<span class="ident" id="5207686">f</span><span class="op" id="5207687">.</span><span class="ident" id="5207688">Class</span>&nbsp;<span class="op" id="5207694">==</span>&nbsp;<span class="ident" id="5207697">ELFCLASS64</span>&nbsp;<span class="op" id="5207708">&amp;&amp;</span>&nbsp;<span class="ident" id="5207711">f</span><span class="op" id="5207712">.</span><span class="ident" id="5207713">Machine</span>&nbsp;<span class="op" id="5207721">==</span>&nbsp;<span class="ident" id="5207724">EM_X86_64</span>&nbsp;<span class="op" id="5207734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207738">return</span>&nbsp;<span class="ident" id="5207745">f</span><span class="op" id="5207746">.</span><span class="ident" id="5207747">applyRelocationsAMD64</span><span class="op" id="5207768">(</span><span class="ident" id="5207769">dst</span><span class="op" id="5207772">,</span>&nbsp;<span class="ident" id="5207774">rels</span><span class="op" id="5207778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207784">if</span>&nbsp;<span class="ident" id="5207787">f</span><span class="op" id="5207788">.</span><span class="ident" id="5207789">Class</span>&nbsp;<span class="op" id="5207795">==</span>&nbsp;<span class="ident" id="5207798">ELFCLASS32</span>&nbsp;<span class="op" id="5207809">&amp;&amp;</span>&nbsp;<span class="ident" id="5207812">f</span><span class="op" id="5207813">.</span><span class="ident" id="5207814">Machine</span>&nbsp;<span class="op" id="5207822">==</span>&nbsp;<span class="ident" id="5207825">EM_386</span>&nbsp;<span class="op" id="5207832">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207836">return</span>&nbsp;<span class="ident" id="5207843">f</span><span class="op" id="5207844">.</span><span class="ident" id="5207845">applyRelocations386</span><span class="op" id="5207864">(</span><span class="ident" id="5207865">dst</span><span class="op" id="5207868">,</span>&nbsp;<span class="ident" id="5207870">rels</span><span class="op" id="5207874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207880">if</span>&nbsp;<span class="ident" id="5207883">f</span><span class="op" id="5207884">.</span><span class="ident" id="5207885">Class</span>&nbsp;<span class="op" id="5207891">==</span>&nbsp;<span class="ident" id="5207894">ELFCLASS64</span>&nbsp;<span class="op" id="5207905">&amp;&amp;</span>&nbsp;<span class="ident" id="5207908">f</span><span class="op" id="5207909">.</span><span class="ident" id="5207910">Machine</span>&nbsp;<span class="op" id="5207918">==</span>&nbsp;<span class="ident" id="5207921">EM_AARCH64</span>&nbsp;<span class="op" id="5207932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207936">return</span>&nbsp;<span class="ident" id="5207943">f</span><span class="op" id="5207944">.</span><span class="ident" id="5207945">applyRelocationsARM64</span><span class="op" id="5207966">(</span><span class="ident" id="5207967">dst</span><span class="op" id="5207970">,</span>&nbsp;<span class="ident" id="5207972">rels</span><span class="op" id="5207976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207979">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207983">return</span>&nbsp;<span class="ident" id="5207990">errors</span><span class="op" id="5207996">.</span><span class="ident" id="5207997">New</span><span class="op" id="5208000">(</span><span class="string" id="5208001">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5208018">)</span><br>
<span class="lineno"></span><span class="op" id="5208020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5208023">func</span>&nbsp;<span class="op" id="5208028">(</span><span class="ident" id="5208029">f</span>&nbsp;<span class="op" id="5208031">*</span><span class="ident" id="5208032">File</span><span class="op" id="5208036">)</span>&nbsp;<span class="ident" id="5208038">applyRelocationsAMD64</span><span class="op" id="5208059">(</span><span class="ident" id="5208060">dst</span>&nbsp;<span class="op" id="5208064">[</span><span class="op" id="5208065">]</span><span class="builtintype" id="5208066">byte</span><span class="op" id="5208070">,</span>&nbsp;<span class="ident" id="5208072">rels</span>&nbsp;<span class="op" id="5208077">[</span><span class="op" id="5208078">]</span><span class="builtintype" id="5208079">byte</span><span class="op" id="5208083">)</span>&nbsp;<span class="builtintype" id="5208085">error</span>&nbsp;<span class="op" id="5208091">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208094">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208124">if</span>&nbsp;<span class="builtinfunc" id="5208127">len</span><span class="op" id="5208130">(</span><span class="ident" id="5208131">rels</span><span class="op" id="5208135">)</span><span class="op" id="5208136">%</span><span class="num" id="5208137">24</span>&nbsp;<span class="op" id="5208140">!=</span>&nbsp;<span class="num" id="5208143">0</span>&nbsp;<span class="op" id="5208145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208149">return</span>&nbsp;<span class="ident" id="5208156">errors</span><span class="op" id="5208162">.</span><span class="ident" id="5208163">New</span><span class="op" id="5208166">(</span><span class="string" id="5208167">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5208221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208228">symbols</span><span class="op" id="5208235">,</span>&nbsp;<span class="ident" id="5208237">_</span><span class="op" id="5208238">,</span>&nbsp;<span class="ident" id="5208240">err</span>&nbsp;<span class="op" id="5208244">:=</span>&nbsp;<span class="ident" id="5208247">f</span><span class="op" id="5208248">.</span><span class="ident" id="5208249">getSymbols</span><span class="op" id="5208259">(</span><span class="ident" id="5208260">SHT_SYMTAB</span><span class="op" id="5208270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208273">if</span>&nbsp;<span class="ident" id="5208276">err</span>&nbsp;<span class="op" id="5208280">!=</span>&nbsp;<span class="ident" id="5208283">nil</span>&nbsp;<span class="op" id="5208287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208291">return</span>&nbsp;<span class="ident" id="5208298">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208307">b</span>&nbsp;<span class="op" id="5208309">:=</span>&nbsp;<span class="ident" id="5208312">bytes</span><span class="op" id="5208317">.</span><span class="ident" id="5208318">NewReader</span><span class="op" id="5208327">(</span><span class="ident" id="5208328">rels</span><span class="op" id="5208332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208335">var</span>&nbsp;<span class="ident" id="5208339">rela</span>&nbsp;<span class="ident" id="5208344">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208353">for</span>&nbsp;<span class="ident" id="5208357">b</span><span class="op" id="5208358">.</span><span class="ident" id="5208359">Len</span><span class="op" id="5208362">(</span><span class="op" id="5208363">)</span>&nbsp;<span class="op" id="5208365">&gt;</span>&nbsp;<span class="num" id="5208367">0</span>&nbsp;<span class="op" id="5208369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208373">binary</span><span class="op" id="5208379">.</span><span class="ident" id="5208380">Read</span><span class="op" id="5208384">(</span><span class="ident" id="5208385">b</span><span class="op" id="5208386">,</span>&nbsp;<span class="ident" id="5208388">f</span><span class="op" id="5208389">.</span><span class="ident" id="5208390">ByteOrder</span><span class="op" id="5208399">,</span>&nbsp;<span class="op" id="5208401">&amp;</span><span class="ident" id="5208402">rela</span><span class="op" id="5208406">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208410">symNo</span>&nbsp;<span class="op" id="5208416">:=</span>&nbsp;<span class="ident" id="5208419">rela</span><span class="op" id="5208423">.</span><span class="ident" id="5208424">Info</span>&nbsp;<span class="op" id="5208429">&gt;&gt;</span>&nbsp;<span class="num" id="5208432">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208437">t</span>&nbsp;<span class="op" id="5208439">:=</span>&nbsp;<span class="ident" id="5208442">R_X86_64</span><span class="op" id="5208450">(</span><span class="ident" id="5208451">rela</span><span class="op" id="5208455">.</span><span class="ident" id="5208456">Info</span>&nbsp;<span class="op" id="5208461">&amp;</span>&nbsp;<span class="num" id="5208463">0xffff</span><span class="op" id="5208469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208474">if</span>&nbsp;<span class="ident" id="5208477">symNo</span>&nbsp;<span class="op" id="5208483">==</span>&nbsp;<span class="num" id="5208486">0</span>&nbsp;<span class="op" id="5208488">||</span>&nbsp;<span class="ident" id="5208491">symNo</span>&nbsp;<span class="op" id="5208497">&gt;</span>&nbsp;<span class="ident" id="5208499">uint64</span><span class="op" id="5208505">(</span><span class="builtinfunc" id="5208506">len</span><span class="op" id="5208509">(</span><span class="ident" id="5208510">symbols</span><span class="op" id="5208517">)</span><span class="op" id="5208518">)</span>&nbsp;<span class="op" id="5208520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208525">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208540">sym</span>&nbsp;<span class="op" id="5208544">:=</span>&nbsp;<span class="op" id="5208547">&amp;</span><span class="ident" id="5208548">symbols</span><span class="op" id="5208555">[</span><span class="ident" id="5208556">symNo</span><span class="op" id="5208561">-</span><span class="num" id="5208562">1</span><span class="op" id="5208563">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208567">if</span>&nbsp;<span class="ident" id="5208570">SymType</span><span class="op" id="5208577">(</span><span class="ident" id="5208578">sym</span><span class="op" id="5208581">.</span><span class="ident" id="5208582">Info</span><span class="op" id="5208586">&amp;</span><span class="num" id="5208587">0xf</span><span class="op" id="5208590">)</span>&nbsp;<span class="op" id="5208592">!=</span>&nbsp;<span class="ident" id="5208595">STT_SECTION</span>&nbsp;<span class="op" id="5208607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208612">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208667">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208683">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208736">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208791">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208838">switch</span>&nbsp;<span class="ident" id="5208845">t</span>&nbsp;<span class="op" id="5208847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208851">case</span>&nbsp;<span class="ident" id="5208856">R_X86_64_64</span><span class="op" id="5208867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208872">if</span>&nbsp;<span class="ident" id="5208875">rela</span><span class="op" id="5208879">.</span><span class="ident" id="5208880">Off</span><span class="op" id="5208883">+</span><span class="num" id="5208884">8</span>&nbsp;<span class="op" id="5208886">&gt;=</span>&nbsp;<span class="ident" id="5208889">uint64</span><span class="op" id="5208895">(</span><span class="builtinfunc" id="5208896">len</span><span class="op" id="5208899">(</span><span class="ident" id="5208900">dst</span><span class="op" id="5208903">)</span><span class="op" id="5208904">)</span>&nbsp;<span class="op" id="5208906">||</span>&nbsp;<span class="ident" id="5208909">rela</span><span class="op" id="5208913">.</span><span class="ident" id="5208914">Addend</span>&nbsp;<span class="op" id="5208921">&lt;</span>&nbsp;<span class="num" id="5208923">0</span>&nbsp;<span class="op" id="5208925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208931">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208948">f</span><span class="op" id="5208949">.</span><span class="ident" id="5208950">ByteOrder</span><span class="op" id="5208959">.</span><span class="ident" id="5208960">PutUint64</span><span class="op" id="5208969">(</span><span class="ident" id="5208970">dst</span><span class="op" id="5208973">[</span><span class="ident" id="5208974">rela</span><span class="op" id="5208978">.</span><span class="ident" id="5208979">Off</span><span class="op" id="5208982">:</span><span class="ident" id="5208983">rela</span><span class="op" id="5208987">.</span><span class="ident" id="5208988">Off</span><span class="op" id="5208991">+</span><span class="num" id="5208992">8</span><span class="op" id="5208993">]</span><span class="op" id="5208994">,</span>&nbsp;<span class="ident" id="5208996">uint64</span><span class="op" id="5209002">(</span><span class="ident" id="5209003">rela</span><span class="op" id="5209007">.</span><span class="ident" id="5209008">Addend</span><span class="op" id="5209014">)</span><span class="op" id="5209015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209019">case</span>&nbsp;<span class="ident" id="5209024">R_X86_64_32</span><span class="op" id="5209035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209040">if</span>&nbsp;<span class="ident" id="5209043">rela</span><span class="op" id="5209047">.</span><span class="ident" id="5209048">Off</span><span class="op" id="5209051">+</span><span class="num" id="5209052">4</span>&nbsp;<span class="op" id="5209054">&gt;=</span>&nbsp;<span class="ident" id="5209057">uint64</span><span class="op" id="5209063">(</span><span class="builtinfunc" id="5209064">len</span><span class="op" id="5209067">(</span><span class="ident" id="5209068">dst</span><span class="op" id="5209071">)</span><span class="op" id="5209072">)</span>&nbsp;<span class="op" id="5209074">||</span>&nbsp;<span class="ident" id="5209077">rela</span><span class="op" id="5209081">.</span><span class="ident" id="5209082">Addend</span>&nbsp;<span class="op" id="5209089">&lt;</span>&nbsp;<span class="num" id="5209091">0</span>&nbsp;<span class="op" id="5209093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209099">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209116">f</span><span class="op" id="5209117">.</span><span class="ident" id="5209118">ByteOrder</span><span class="op" id="5209127">.</span><span class="ident" id="5209128">PutUint32</span><span class="op" id="5209137">(</span><span class="ident" id="5209138">dst</span><span class="op" id="5209141">[</span><span class="ident" id="5209142">rela</span><span class="op" id="5209146">.</span><span class="ident" id="5209147">Off</span><span class="op" id="5209150">:</span><span class="ident" id="5209151">rela</span><span class="op" id="5209155">.</span><span class="ident" id="5209156">Off</span><span class="op" id="5209159">+</span><span class="num" id="5209160">4</span><span class="op" id="5209161">]</span><span class="op" id="5209162">,</span>&nbsp;<span class="builtintype" id="5209164">uint32</span><span class="op" id="5209170">(</span><span class="ident" id="5209171">rela</span><span class="op" id="5209175">.</span><span class="ident" id="5209176">Addend</span><span class="op" id="5209182">)</span><span class="op" id="5209183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209194">return</span>&nbsp;<span class="ident" id="5209201">nil</span><br>
<span class="lineno"></span><span class="op" id="5209205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5209208">func</span>&nbsp;<span class="op" id="5209213">(</span><span class="ident" id="5209214">f</span>&nbsp;<span class="op" id="5209216">*</span><span class="ident" id="5209217">File</span><span class="op" id="5209221">)</span>&nbsp;<span class="ident" id="5209223">applyRelocations386</span><span class="op" id="5209242">(</span><span class="ident" id="5209243">dst</span>&nbsp;<span class="op" id="5209247">[</span><span class="op" id="5209248">]</span><span class="builtintype" id="5209249">byte</span><span class="op" id="5209253">,</span>&nbsp;<span class="ident" id="5209255">rels</span>&nbsp;<span class="op" id="5209260">[</span><span class="op" id="5209261">]</span><span class="builtintype" id="5209262">byte</span><span class="op" id="5209266">)</span>&nbsp;<span class="builtintype" id="5209268">error</span>&nbsp;<span class="op" id="5209274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5209277">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209305">if</span>&nbsp;<span class="builtinfunc" id="5209308">len</span><span class="op" id="5209311">(</span><span class="ident" id="5209312">rels</span><span class="op" id="5209316">)</span><span class="op" id="5209317">%</span><span class="num" id="5209318">8</span>&nbsp;<span class="op" id="5209320">!=</span>&nbsp;<span class="num" id="5209323">0</span>&nbsp;<span class="op" id="5209325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209329">return</span>&nbsp;<span class="ident" id="5209336">errors</span><span class="op" id="5209342">.</span><span class="ident" id="5209343">New</span><span class="op" id="5209346">(</span><span class="string" id="5209347">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5209400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209407">symbols</span><span class="op" id="5209414">,</span>&nbsp;<span class="ident" id="5209416">_</span><span class="op" id="5209417">,</span>&nbsp;<span class="ident" id="5209419">err</span>&nbsp;<span class="op" id="5209423">:=</span>&nbsp;<span class="ident" id="5209426">f</span><span class="op" id="5209427">.</span><span class="ident" id="5209428">getSymbols</span><span class="op" id="5209438">(</span><span class="ident" id="5209439">SHT_SYMTAB</span><span class="op" id="5209449">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209452">if</span>&nbsp;<span class="ident" id="5209455">err</span>&nbsp;<span class="op" id="5209459">!=</span>&nbsp;<span class="ident" id="5209462">nil</span>&nbsp;<span class="op" id="5209466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209470">return</span>&nbsp;<span class="ident" id="5209477">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209486">b</span>&nbsp;<span class="op" id="5209488">:=</span>&nbsp;<span class="ident" id="5209491">bytes</span><span class="op" id="5209496">.</span><span class="ident" id="5209497">NewReader</span><span class="op" id="5209506">(</span><span class="ident" id="5209507">rels</span><span class="op" id="5209511">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209514">var</span>&nbsp;<span class="ident" id="5209518">rel</span>&nbsp;<span class="ident" id="5209522">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209530">for</span>&nbsp;<span class="ident" id="5209534">b</span><span class="op" id="5209535">.</span><span class="ident" id="5209536">Len</span><span class="op" id="5209539">(</span><span class="op" id="5209540">)</span>&nbsp;<span class="op" id="5209542">&gt;</span>&nbsp;<span class="num" id="5209544">0</span>&nbsp;<span class="op" id="5209546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209550">binary</span><span class="op" id="5209556">.</span><span class="ident" id="5209557">Read</span><span class="op" id="5209561">(</span><span class="ident" id="5209562">b</span><span class="op" id="5209563">,</span>&nbsp;<span class="ident" id="5209565">f</span><span class="op" id="5209566">.</span><span class="ident" id="5209567">ByteOrder</span><span class="op" id="5209576">,</span>&nbsp;<span class="op" id="5209578">&amp;</span><span class="ident" id="5209579">rel</span><span class="op" id="5209582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209586">symNo</span>&nbsp;<span class="op" id="5209592">:=</span>&nbsp;<span class="ident" id="5209595">rel</span><span class="op" id="5209598">.</span><span class="ident" id="5209599">Info</span>&nbsp;<span class="op" id="5209604">&gt;&gt;</span>&nbsp;<span class="num" id="5209607">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209611">t</span>&nbsp;<span class="op" id="5209613">:=</span>&nbsp;<span class="ident" id="5209616">R_386</span><span class="op" id="5209621">(</span><span class="ident" id="5209622">rel</span><span class="op" id="5209625">.</span><span class="ident" id="5209626">Info</span>&nbsp;<span class="op" id="5209631">&amp;</span>&nbsp;<span class="num" id="5209633">0xff</span><span class="op" id="5209637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209642">if</span>&nbsp;<span class="ident" id="5209645">symNo</span>&nbsp;<span class="op" id="5209651">==</span>&nbsp;<span class="num" id="5209654">0</span>&nbsp;<span class="op" id="5209656">||</span>&nbsp;<span class="ident" id="5209659">symNo</span>&nbsp;<span class="op" id="5209665">&gt;</span>&nbsp;<span class="builtintype" id="5209667">uint32</span><span class="op" id="5209673">(</span><span class="builtinfunc" id="5209674">len</span><span class="op" id="5209677">(</span><span class="ident" id="5209678">symbols</span><span class="op" id="5209685">)</span><span class="op" id="5209686">)</span>&nbsp;<span class="op" id="5209688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209693">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209704">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209708">sym</span>&nbsp;<span class="op" id="5209712">:=</span>&nbsp;<span class="op" id="5209715">&amp;</span><span class="ident" id="5209716">symbols</span><span class="op" id="5209723">[</span><span class="ident" id="5209724">symNo</span><span class="op" id="5209729">-</span><span class="num" id="5209730">1</span><span class="op" id="5209731">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209736">if</span>&nbsp;<span class="ident" id="5209739">t</span>&nbsp;<span class="op" id="5209741">==</span>&nbsp;<span class="ident" id="5209744">R_386_32</span>&nbsp;<span class="op" id="5209753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209758">if</span>&nbsp;<span class="ident" id="5209761">rel</span><span class="op" id="5209764">.</span><span class="ident" id="5209765">Off</span><span class="op" id="5209768">+</span><span class="num" id="5209769">4</span>&nbsp;<span class="op" id="5209771">&gt;=</span>&nbsp;<span class="builtintype" id="5209774">uint32</span><span class="op" id="5209780">(</span><span class="builtinfunc" id="5209781">len</span><span class="op" id="5209784">(</span><span class="ident" id="5209785">dst</span><span class="op" id="5209788">)</span><span class="op" id="5209789">)</span>&nbsp;<span class="op" id="5209791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209797">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209814">val</span>&nbsp;<span class="op" id="5209818">:=</span>&nbsp;<span class="ident" id="5209821">f</span><span class="op" id="5209822">.</span><span class="ident" id="5209823">ByteOrder</span><span class="op" id="5209832">.</span><span class="ident" id="5209833">Uint32</span><span class="op" id="5209839">(</span><span class="ident" id="5209840">dst</span><span class="op" id="5209843">[</span><span class="ident" id="5209844">rel</span><span class="op" id="5209847">.</span><span class="ident" id="5209848">Off</span>&nbsp;<span class="op" id="5209852">:</span>&nbsp;<span class="ident" id="5209854">rel</span><span class="op" id="5209857">.</span><span class="ident" id="5209858">Off</span><span class="op" id="5209861">+</span><span class="num" id="5209862">4</span><span class="op" id="5209863">]</span><span class="op" id="5209864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209869">val</span>&nbsp;<span class="op" id="5209873">+=</span>&nbsp;<span class="builtintype" id="5209876">uint32</span><span class="op" id="5209882">(</span><span class="ident" id="5209883">sym</span><span class="op" id="5209886">.</span><span class="ident" id="5209887">Value</span><span class="op" id="5209892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209897">f</span><span class="op" id="5209898">.</span><span class="ident" id="5209899">ByteOrder</span><span class="op" id="5209908">.</span><span class="ident" id="5209909">PutUint32</span><span class="op" id="5209918">(</span><span class="ident" id="5209919">dst</span><span class="op" id="5209922">[</span><span class="ident" id="5209923">rel</span><span class="op" id="5209926">.</span><span class="ident" id="5209927">Off</span><span class="op" id="5209930">:</span><span class="ident" id="5209931">rel</span><span class="op" id="5209934">.</span><span class="ident" id="5209935">Off</span><span class="op" id="5209938">+</span><span class="num" id="5209939">4</span><span class="op" id="5209940">]</span><span class="op" id="5209941">,</span>&nbsp;<span class="ident" id="5209943">val</span><span class="op" id="5209946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209950">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209957">return</span>&nbsp;<span class="ident" id="5209964">nil</span><br>
<span class="lineno"></span><span class="op" id="5209968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5209971">func</span>&nbsp;<span class="op" id="5209976">(</span><span class="ident" id="5209977">f</span>&nbsp;<span class="op" id="5209979">*</span><span class="ident" id="5209980">File</span><span class="op" id="5209984">)</span>&nbsp;<span class="ident" id="5209986">applyRelocationsARM64</span><span class="op" id="5210007">(</span><span class="ident" id="5210008">dst</span>&nbsp;<span class="op" id="5210012">[</span><span class="op" id="5210013">]</span><span class="builtintype" id="5210014">byte</span><span class="op" id="5210018">,</span>&nbsp;<span class="ident" id="5210020">rels</span>&nbsp;<span class="op" id="5210025">[</span><span class="op" id="5210026">]</span><span class="builtintype" id="5210027">byte</span><span class="op" id="5210031">)</span>&nbsp;<span class="builtintype" id="5210033">error</span>&nbsp;<span class="op" id="5210039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210042">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210072">if</span>&nbsp;<span class="builtinfunc" id="5210075">len</span><span class="op" id="5210078">(</span><span class="ident" id="5210079">rels</span><span class="op" id="5210083">)</span><span class="op" id="5210084">%</span><span class="num" id="5210085">24</span>&nbsp;<span class="op" id="5210088">!=</span>&nbsp;<span class="num" id="5210091">0</span>&nbsp;<span class="op" id="5210093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210097">return</span>&nbsp;<span class="ident" id="5210104">errors</span><span class="op" id="5210110">.</span><span class="ident" id="5210111">New</span><span class="op" id="5210114">(</span><span class="string" id="5210115">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5210169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210172">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210176">symbols</span><span class="op" id="5210183">,</span>&nbsp;<span class="ident" id="5210185">_</span><span class="op" id="5210186">,</span>&nbsp;<span class="ident" id="5210188">err</span>&nbsp;<span class="op" id="5210192">:=</span>&nbsp;<span class="ident" id="5210195">f</span><span class="op" id="5210196">.</span><span class="ident" id="5210197">getSymbols</span><span class="op" id="5210207">(</span><span class="ident" id="5210208">SHT_SYMTAB</span><span class="op" id="5210218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210221">if</span>&nbsp;<span class="ident" id="5210224">err</span>&nbsp;<span class="op" id="5210228">!=</span>&nbsp;<span class="ident" id="5210231">nil</span>&nbsp;<span class="op" id="5210235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210239">return</span>&nbsp;<span class="ident" id="5210246">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210251">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210255">b</span>&nbsp;<span class="op" id="5210257">:=</span>&nbsp;<span class="ident" id="5210260">bytes</span><span class="op" id="5210265">.</span><span class="ident" id="5210266">NewReader</span><span class="op" id="5210275">(</span><span class="ident" id="5210276">rels</span><span class="op" id="5210280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210283">var</span>&nbsp;<span class="ident" id="5210287">rela</span>&nbsp;<span class="ident" id="5210292">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210301">for</span>&nbsp;<span class="ident" id="5210305">b</span><span class="op" id="5210306">.</span><span class="ident" id="5210307">Len</span><span class="op" id="5210310">(</span><span class="op" id="5210311">)</span>&nbsp;<span class="op" id="5210313">&gt;</span>&nbsp;<span class="num" id="5210315">0</span>&nbsp;<span class="op" id="5210317">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210321">binary</span><span class="op" id="5210327">.</span><span class="ident" id="5210328">Read</span><span class="op" id="5210332">(</span><span class="ident" id="5210333">b</span><span class="op" id="5210334">,</span>&nbsp;<span class="ident" id="5210336">f</span><span class="op" id="5210337">.</span><span class="ident" id="5210338">ByteOrder</span><span class="op" id="5210347">,</span>&nbsp;<span class="op" id="5210349">&amp;</span><span class="ident" id="5210350">rela</span><span class="op" id="5210354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210358">symNo</span>&nbsp;<span class="op" id="5210364">:=</span>&nbsp;<span class="ident" id="5210367">rela</span><span class="op" id="5210371">.</span><span class="ident" id="5210372">Info</span>&nbsp;<span class="op" id="5210377">&gt;&gt;</span>&nbsp;<span class="num" id="5210380">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210385">t</span>&nbsp;<span class="op" id="5210387">:=</span>&nbsp;<span class="ident" id="5210390">R_AARCH64</span><span class="op" id="5210399">(</span><span class="ident" id="5210400">rela</span><span class="op" id="5210404">.</span><span class="ident" id="5210405">Info</span>&nbsp;<span class="op" id="5210410">&amp;</span>&nbsp;<span class="num" id="5210412">0xffff</span><span class="op" id="5210418">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210423">if</span>&nbsp;<span class="ident" id="5210426">symNo</span>&nbsp;<span class="op" id="5210432">==</span>&nbsp;<span class="num" id="5210435">0</span>&nbsp;<span class="op" id="5210437">||</span>&nbsp;<span class="ident" id="5210440">symNo</span>&nbsp;<span class="op" id="5210446">&gt;</span>&nbsp;<span class="ident" id="5210448">uint64</span><span class="op" id="5210454">(</span><span class="builtinfunc" id="5210455">len</span><span class="op" id="5210458">(</span><span class="ident" id="5210459">symbols</span><span class="op" id="5210466">)</span><span class="op" id="5210467">)</span>&nbsp;<span class="op" id="5210469">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210474">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210489">sym</span>&nbsp;<span class="op" id="5210493">:=</span>&nbsp;<span class="op" id="5210496">&amp;</span><span class="ident" id="5210497">symbols</span><span class="op" id="5210504">[</span><span class="ident" id="5210505">symNo</span><span class="op" id="5210510">-</span><span class="num" id="5210511">1</span><span class="op" id="5210512">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210516">if</span>&nbsp;<span class="ident" id="5210519">SymType</span><span class="op" id="5210526">(</span><span class="ident" id="5210527">sym</span><span class="op" id="5210530">.</span><span class="ident" id="5210531">Info</span><span class="op" id="5210535">&amp;</span><span class="num" id="5210536">0xf</span><span class="op" id="5210539">)</span>&nbsp;<span class="op" id="5210541">!=</span>&nbsp;<span class="ident" id="5210544">STT_SECTION</span>&nbsp;<span class="op" id="5210556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210561">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210616">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210632">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210685">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210740">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210787">switch</span>&nbsp;<span class="ident" id="5210794">t</span>&nbsp;<span class="op" id="5210796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210800">case</span>&nbsp;<span class="ident" id="5210805">R_AARCH64_ABS64</span><span class="op" id="5210820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210825">if</span>&nbsp;<span class="ident" id="5210828">rela</span><span class="op" id="5210832">.</span><span class="ident" id="5210833">Off</span><span class="op" id="5210836">+</span><span class="num" id="5210837">8</span>&nbsp;<span class="op" id="5210839">&gt;=</span>&nbsp;<span class="ident" id="5210842">uint64</span><span class="op" id="5210848">(</span><span class="builtinfunc" id="5210849">len</span><span class="op" id="5210852">(</span><span class="ident" id="5210853">dst</span><span class="op" id="5210856">)</span><span class="op" id="5210857">)</span>&nbsp;<span class="op" id="5210859">||</span>&nbsp;<span class="ident" id="5210862">rela</span><span class="op" id="5210866">.</span><span class="ident" id="5210867">Addend</span>&nbsp;<span class="op" id="5210874">&lt;</span>&nbsp;<span class="num" id="5210876">0</span>&nbsp;<span class="op" id="5210878">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210884">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210901">f</span><span class="op" id="5210902">.</span><span class="ident" id="5210903">ByteOrder</span><span class="op" id="5210912">.</span><span class="ident" id="5210913">PutUint64</span><span class="op" id="5210922">(</span><span class="ident" id="5210923">dst</span><span class="op" id="5210926">[</span><span class="ident" id="5210927">rela</span><span class="op" id="5210931">.</span><span class="ident" id="5210932">Off</span><span class="op" id="5210935">:</span><span class="ident" id="5210936">rela</span><span class="op" id="5210940">.</span><span class="ident" id="5210941">Off</span><span class="op" id="5210944">+</span><span class="num" id="5210945">8</span><span class="op" id="5210946">]</span><span class="op" id="5210947">,</span>&nbsp;<span class="ident" id="5210949">uint64</span><span class="op" id="5210955">(</span><span class="ident" id="5210956">rela</span><span class="op" id="5210960">.</span><span class="ident" id="5210961">Addend</span><span class="op" id="5210967">)</span><span class="op" id="5210968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210972">case</span>&nbsp;<span class="ident" id="5210977">R_AARCH64_ABS32</span><span class="op" id="5210992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210997">if</span>&nbsp;<span class="ident" id="5211000">rela</span><span class="op" id="5211004">.</span><span class="ident" id="5211005">Off</span><span class="op" id="5211008">+</span><span class="num" id="5211009">4</span>&nbsp;<span class="op" id="5211011">&gt;=</span>&nbsp;<span class="ident" id="5211014">uint64</span><span class="op" id="5211020">(</span><span class="builtinfunc" id="5211021">len</span><span class="op" id="5211024">(</span><span class="ident" id="5211025">dst</span><span class="op" id="5211028">)</span><span class="op" id="5211029">)</span>&nbsp;<span class="op" id="5211031">||</span>&nbsp;<span class="ident" id="5211034">rela</span><span class="op" id="5211038">.</span><span class="ident" id="5211039">Addend</span>&nbsp;<span class="op" id="5211046">&lt;</span>&nbsp;<span class="num" id="5211048">0</span>&nbsp;<span class="op" id="5211050">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211056">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211073">f</span><span class="op" id="5211074">.</span><span class="ident" id="5211075">ByteOrder</span><span class="op" id="5211084">.</span><span class="ident" id="5211085">PutUint32</span><span class="op" id="5211094">(</span><span class="ident" id="5211095">dst</span><span class="op" id="5211098">[</span><span class="ident" id="5211099">rela</span><span class="op" id="5211103">.</span><span class="ident" id="5211104">Off</span><span class="op" id="5211107">:</span><span class="ident" id="5211108">rela</span><span class="op" id="5211112">.</span><span class="ident" id="5211113">Off</span><span class="op" id="5211116">+</span><span class="num" id="5211117">4</span><span class="op" id="5211118">]</span><span class="op" id="5211119">,</span>&nbsp;<span class="builtintype" id="5211121">uint32</span><span class="op" id="5211127">(</span><span class="ident" id="5211128">rela</span><span class="op" id="5211132">.</span><span class="ident" id="5211133">Addend</span><span class="op" id="5211139">)</span><span class="op" id="5211140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211147">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211151">return</span>&nbsp;<span class="ident" id="5211158">nil</span><br>
<span class="lineno"></span><span class="op" id="5211162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5211165">func</span>&nbsp;<span class="op" id="5211170">(</span><span class="ident" id="5211171">f</span>&nbsp;<span class="op" id="5211173">*</span><span class="ident" id="5211174">File</span><span class="op" id="5211178">)</span>&nbsp;<span class="ident" id="5211180">DWARF</span><span class="op" id="5211185">(</span><span class="op" id="5211186">)</span>&nbsp;<span class="op" id="5211188">(</span><span class="op" id="5211189">*</span><span class="ident" id="5211190">dwarf</span><span class="op" id="5211195">.</span><span class="ident" id="5211196">Data</span><span class="op" id="5211200">,</span>&nbsp;<span class="builtintype" id="5211202">error</span><span class="op" id="5211207">)</span>&nbsp;<span class="op" id="5211209">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211212">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211263">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211318">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211377">var</span>&nbsp;<span class="ident" id="5211381">names</span>&nbsp;<span class="op" id="5211387">=</span>&nbsp;<span class="op" id="5211389">[</span><span class="op" id="5211390">...</span><span class="op" id="5211393">]</span><span class="builtintype" id="5211394">string</span><span class="op" id="5211400">{</span><span class="string" id="5211401">&#34;abbrev&#34;</span><span class="op" id="5211409">,</span>&nbsp;<span class="string" id="5211411">&#34;info&#34;</span><span class="op" id="5211417">,</span>&nbsp;<span class="string" id="5211419">&#34;str&#34;</span><span class="op" id="5211424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211427">var</span>&nbsp;<span class="ident" id="5211431">dat</span>&nbsp;<span class="op" id="5211435">[</span><span class="builtinfunc" id="5211436">len</span><span class="op" id="5211439">(</span><span class="ident" id="5211440">names</span><span class="op" id="5211445">)</span><span class="op" id="5211446">]</span><span class="op" id="5211447">[</span><span class="op" id="5211448">]</span><span class="builtintype" id="5211449">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211455">for</span>&nbsp;<span class="ident" id="5211459">i</span><span class="op" id="5211460">,</span>&nbsp;<span class="ident" id="5211462">name</span>&nbsp;<span class="op" id="5211467">:=</span>&nbsp;<span class="keyword" id="5211470">range</span>&nbsp;<span class="ident" id="5211476">names</span>&nbsp;<span class="op" id="5211482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211486">name</span>&nbsp;<span class="op" id="5211491">=</span>&nbsp;<span class="string" id="5211493">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5211503">+</span>&nbsp;<span class="ident" id="5211505">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211512">s</span>&nbsp;<span class="op" id="5211514">:=</span>&nbsp;<span class="ident" id="5211517">f</span><span class="op" id="5211518">.</span><span class="ident" id="5211519">Section</span><span class="op" id="5211526">(</span><span class="ident" id="5211527">name</span><span class="op" id="5211531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211535">if</span>&nbsp;<span class="ident" id="5211538">s</span>&nbsp;<span class="op" id="5211540">==</span>&nbsp;<span class="ident" id="5211543">nil</span>&nbsp;<span class="op" id="5211547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211552">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211567">b</span><span class="op" id="5211568">,</span>&nbsp;<span class="ident" id="5211570">err</span>&nbsp;<span class="op" id="5211574">:=</span>&nbsp;<span class="ident" id="5211577">s</span><span class="op" id="5211578">.</span><span class="ident" id="5211579">Data</span><span class="op" id="5211583">(</span><span class="op" id="5211584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211588">if</span>&nbsp;<span class="ident" id="5211591">err</span>&nbsp;<span class="op" id="5211595">!=</span>&nbsp;<span class="ident" id="5211598">nil</span>&nbsp;<span class="op" id="5211602">&amp;&amp;</span>&nbsp;<span class="ident" id="5211605">uint64</span><span class="op" id="5211611">(</span><span class="builtinfunc" id="5211612">len</span><span class="op" id="5211615">(</span><span class="ident" id="5211616">b</span><span class="op" id="5211617">)</span><span class="op" id="5211618">)</span>&nbsp;<span class="op" id="5211620">&lt;</span>&nbsp;<span class="ident" id="5211622">s</span><span class="op" id="5211623">.</span><span class="ident" id="5211624">Size</span>&nbsp;<span class="op" id="5211629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211634">return</span>&nbsp;<span class="ident" id="5211641">nil</span><span class="op" id="5211644">,</span>&nbsp;<span class="ident" id="5211646">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211652">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211656">dat</span><span class="op" id="5211659">[</span><span class="ident" id="5211660">i</span><span class="op" id="5211661">]</span>&nbsp;<span class="op" id="5211663">=</span>&nbsp;<span class="ident" id="5211665">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211672">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211745">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211818">rela</span>&nbsp;<span class="op" id="5211823">:=</span>&nbsp;<span class="ident" id="5211826">f</span><span class="op" id="5211827">.</span><span class="ident" id="5211828">Section</span><span class="op" id="5211835">(</span><span class="string" id="5211836">&#34;.rela.debug_info&#34;</span><span class="op" id="5211854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211857">if</span>&nbsp;<span class="ident" id="5211860">rela</span>&nbsp;<span class="op" id="5211865">!=</span>&nbsp;<span class="ident" id="5211868">nil</span>&nbsp;<span class="op" id="5211872">&amp;&amp;</span>&nbsp;<span class="ident" id="5211875">rela</span><span class="op" id="5211879">.</span><span class="ident" id="5211880">Type</span>&nbsp;<span class="op" id="5211885">==</span>&nbsp;<span class="ident" id="5211888">SHT_RELA</span>&nbsp;<span class="op" id="5211897">&amp;&amp;</span>&nbsp;<span class="op" id="5211900">(</span><span class="ident" id="5211901">f</span><span class="op" id="5211902">.</span><span class="ident" id="5211903">Machine</span>&nbsp;<span class="op" id="5211911">==</span>&nbsp;<span class="ident" id="5211914">EM_X86_64</span>&nbsp;<span class="op" id="5211924">||</span>&nbsp;<span class="ident" id="5211927">f</span><span class="op" id="5211928">.</span><span class="ident" id="5211929">Machine</span>&nbsp;<span class="op" id="5211937">==</span>&nbsp;<span class="ident" id="5211940">EM_AARCH64</span><span class="op" id="5211950">)</span>&nbsp;<span class="op" id="5211952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211956">data</span><span class="op" id="5211960">,</span>&nbsp;<span class="ident" id="5211962">err</span>&nbsp;<span class="op" id="5211966">:=</span>&nbsp;<span class="ident" id="5211969">rela</span><span class="op" id="5211973">.</span><span class="ident" id="5211974">Data</span><span class="op" id="5211978">(</span><span class="op" id="5211979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211983">if</span>&nbsp;<span class="ident" id="5211986">err</span>&nbsp;<span class="op" id="5211990">!=</span>&nbsp;<span class="ident" id="5211993">nil</span>&nbsp;<span class="op" id="5211997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212002">return</span>&nbsp;<span class="ident" id="5212009">nil</span><span class="op" id="5212012">,</span>&nbsp;<span class="ident" id="5212014">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212024">err</span>&nbsp;<span class="op" id="5212028">=</span>&nbsp;<span class="ident" id="5212030">f</span><span class="op" id="5212031">.</span><span class="ident" id="5212032">applyRelocations</span><span class="op" id="5212048">(</span><span class="ident" id="5212049">dat</span><span class="op" id="5212052">[</span><span class="num" id="5212053">1</span><span class="op" id="5212054">]</span><span class="op" id="5212055">,</span>&nbsp;<span class="ident" id="5212057">data</span><span class="op" id="5212061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212065">if</span>&nbsp;<span class="ident" id="5212068">err</span>&nbsp;<span class="op" id="5212072">!=</span>&nbsp;<span class="ident" id="5212075">nil</span>&nbsp;<span class="op" id="5212079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212084">return</span>&nbsp;<span class="ident" id="5212091">nil</span><span class="op" id="5212094">,</span>&nbsp;<span class="ident" id="5212096">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212102">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212109">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212175">rel</span>&nbsp;<span class="op" id="5212179">:=</span>&nbsp;<span class="ident" id="5212182">f</span><span class="op" id="5212183">.</span><span class="ident" id="5212184">Section</span><span class="op" id="5212191">(</span><span class="string" id="5212192">&#34;.rel.debug_info&#34;</span><span class="op" id="5212209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212212">if</span>&nbsp;<span class="ident" id="5212215">rel</span>&nbsp;<span class="op" id="5212219">!=</span>&nbsp;<span class="ident" id="5212222">nil</span>&nbsp;<span class="op" id="5212226">&amp;&amp;</span>&nbsp;<span class="ident" id="5212229">rel</span><span class="op" id="5212232">.</span><span class="ident" id="5212233">Type</span>&nbsp;<span class="op" id="5212238">==</span>&nbsp;<span class="ident" id="5212241">SHT_REL</span>&nbsp;<span class="op" id="5212249">&amp;&amp;</span>&nbsp;<span class="ident" id="5212252">f</span><span class="op" id="5212253">.</span><span class="ident" id="5212254">Machine</span>&nbsp;<span class="op" id="5212262">==</span>&nbsp;<span class="ident" id="5212265">EM_386</span>&nbsp;<span class="op" id="5212272">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212276">data</span><span class="op" id="5212280">,</span>&nbsp;<span class="ident" id="5212282">err</span>&nbsp;<span class="op" id="5212286">:=</span>&nbsp;<span class="ident" id="5212289">rel</span><span class="op" id="5212292">.</span><span class="ident" id="5212293">Data</span><span class="op" id="5212297">(</span><span class="op" id="5212298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212302">if</span>&nbsp;<span class="ident" id="5212305">err</span>&nbsp;<span class="op" id="5212309">!=</span>&nbsp;<span class="ident" id="5212312">nil</span>&nbsp;<span class="op" id="5212316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212321">return</span>&nbsp;<span class="ident" id="5212328">nil</span><span class="op" id="5212331">,</span>&nbsp;<span class="ident" id="5212333">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212343">err</span>&nbsp;<span class="op" id="5212347">=</span>&nbsp;<span class="ident" id="5212349">f</span><span class="op" id="5212350">.</span><span class="ident" id="5212351">applyRelocations</span><span class="op" id="5212367">(</span><span class="ident" id="5212368">dat</span><span class="op" id="5212371">[</span><span class="num" id="5212372">1</span><span class="op" id="5212373">]</span><span class="op" id="5212374">,</span>&nbsp;<span class="ident" id="5212376">data</span><span class="op" id="5212380">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212384">if</span>&nbsp;<span class="ident" id="5212387">err</span>&nbsp;<span class="op" id="5212391">!=</span>&nbsp;<span class="ident" id="5212394">nil</span>&nbsp;<span class="op" id="5212398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212403">return</span>&nbsp;<span class="ident" id="5212410">nil</span><span class="op" id="5212413">,</span>&nbsp;<span class="ident" id="5212415">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212428">abbrev</span><span class="op" id="5212434">,</span>&nbsp;<span class="ident" id="5212436">info</span><span class="op" id="5212440">,</span>&nbsp;<span class="ident" id="5212442">str</span>&nbsp;<span class="op" id="5212446">:=</span>&nbsp;<span class="ident" id="5212449">dat</span><span class="op" id="5212452">[</span><span class="num" id="5212453">0</span><span class="op" id="5212454">]</span><span class="op" id="5212455">,</span>&nbsp;<span class="ident" id="5212457">dat</span><span class="op" id="5212460">[</span><span class="num" id="5212461">1</span><span class="op" id="5212462">]</span><span class="op" id="5212463">,</span>&nbsp;<span class="ident" id="5212465">dat</span><span class="op" id="5212468">[</span><span class="num" id="5212469">2</span><span class="op" id="5212470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212473">d</span><span class="op" id="5212474">,</span>&nbsp;<span class="ident" id="5212476">err</span>&nbsp;<span class="op" id="5212480">:=</span>&nbsp;<span class="ident" id="5212483">dwarf</span><span class="op" id="5212488">.</span><span class="ident" id="5212489">New</span><span class="op" id="5212492">(</span><span class="ident" id="5212493">abbrev</span><span class="op" id="5212499">,</span>&nbsp;<span class="ident" id="5212501">nil</span><span class="op" id="5212504">,</span>&nbsp;<span class="ident" id="5212506">nil</span><span class="op" id="5212509">,</span>&nbsp;<span class="ident" id="5212511">info</span><span class="op" id="5212515">,</span>&nbsp;<span class="ident" id="5212517">nil</span><span class="op" id="5212520">,</span>&nbsp;<span class="ident" id="5212522">nil</span><span class="op" id="5212525">,</span>&nbsp;<span class="ident" id="5212527">nil</span><span class="op" id="5212530">,</span>&nbsp;<span class="ident" id="5212532">str</span><span class="op" id="5212535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212538">if</span>&nbsp;<span class="ident" id="5212541">err</span>&nbsp;<span class="op" id="5212545">!=</span>&nbsp;<span class="ident" id="5212548">nil</span>&nbsp;<span class="op" id="5212552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212556">return</span>&nbsp;<span class="ident" id="5212563">nil</span><span class="op" id="5212566">,</span>&nbsp;<span class="ident" id="5212568">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212573">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212577">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212620">for</span>&nbsp;<span class="ident" id="5212624">i</span><span class="op" id="5212625">,</span>&nbsp;<span class="ident" id="5212627">s</span>&nbsp;<span class="op" id="5212629">:=</span>&nbsp;<span class="keyword" id="5212632">range</span>&nbsp;<span class="ident" id="5212638">f</span><span class="op" id="5212639">.</span><span class="ident" id="5212640">Sections</span>&nbsp;<span class="op" id="5212649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212653">if</span>&nbsp;<span class="ident" id="5212656">s</span><span class="op" id="5212657">.</span><span class="ident" id="5212658">Name</span>&nbsp;<span class="op" id="5212663">==</span>&nbsp;<span class="string" id="5212666">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5212681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212686">b</span><span class="op" id="5212687">,</span>&nbsp;<span class="ident" id="5212689">err</span>&nbsp;<span class="op" id="5212693">:=</span>&nbsp;<span class="ident" id="5212696">s</span><span class="op" id="5212697">.</span><span class="ident" id="5212698">Data</span><span class="op" id="5212702">(</span><span class="op" id="5212703">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212708">if</span>&nbsp;<span class="ident" id="5212711">err</span>&nbsp;<span class="op" id="5212715">!=</span>&nbsp;<span class="ident" id="5212718">nil</span>&nbsp;<span class="op" id="5212722">&amp;&amp;</span>&nbsp;<span class="ident" id="5212725">uint64</span><span class="op" id="5212731">(</span><span class="builtinfunc" id="5212732">len</span><span class="op" id="5212735">(</span><span class="ident" id="5212736">b</span><span class="op" id="5212737">)</span><span class="op" id="5212738">)</span>&nbsp;<span class="op" id="5212740">&lt;</span>&nbsp;<span class="ident" id="5212742">s</span><span class="op" id="5212743">.</span><span class="ident" id="5212744">Size</span>&nbsp;<span class="op" id="5212749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212755">return</span>&nbsp;<span class="ident" id="5212762">nil</span><span class="op" id="5212765">,</span>&nbsp;<span class="ident" id="5212767">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212780">for</span>&nbsp;<span class="ident" id="5212784">_</span><span class="op" id="5212785">,</span>&nbsp;<span class="ident" id="5212787">r</span>&nbsp;<span class="op" id="5212789">:=</span>&nbsp;<span class="keyword" id="5212792">range</span>&nbsp;<span class="ident" id="5212798">f</span><span class="op" id="5212799">.</span><span class="ident" id="5212800">Sections</span>&nbsp;<span class="op" id="5212809">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212815">if</span>&nbsp;<span class="ident" id="5212818">r</span><span class="op" id="5212819">.</span><span class="ident" id="5212820">Type</span>&nbsp;<span class="op" id="5212825">!=</span>&nbsp;<span class="ident" id="5212828">SHT_RELA</span>&nbsp;<span class="op" id="5212837">&amp;&amp;</span>&nbsp;<span class="ident" id="5212840">r</span><span class="op" id="5212841">.</span><span class="ident" id="5212842">Type</span>&nbsp;<span class="op" id="5212847">!=</span>&nbsp;<span class="ident" id="5212850">SHT_REL</span>&nbsp;<span class="op" id="5212858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212865">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212884">if</span>&nbsp;<span class="builtintype" id="5212887">int</span><span class="op" id="5212890">(</span><span class="ident" id="5212891">r</span><span class="op" id="5212892">.</span><span class="ident" id="5212893">Info</span><span class="op" id="5212897">)</span>&nbsp;<span class="op" id="5212899">!=</span>&nbsp;<span class="ident" id="5212902">i</span>&nbsp;<span class="op" id="5212904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212911">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212930">rd</span><span class="op" id="5212932">,</span>&nbsp;<span class="ident" id="5212934">err</span>&nbsp;<span class="op" id="5212938">:=</span>&nbsp;<span class="ident" id="5212941">r</span><span class="op" id="5212942">.</span><span class="ident" id="5212943">Data</span><span class="op" id="5212947">(</span><span class="op" id="5212948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212954">if</span>&nbsp;<span class="ident" id="5212957">err</span>&nbsp;<span class="op" id="5212961">!=</span>&nbsp;<span class="ident" id="5212964">nil</span>&nbsp;<span class="op" id="5212968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212975">return</span>&nbsp;<span class="ident" id="5212982">nil</span><span class="op" id="5212985">,</span>&nbsp;<span class="ident" id="5212987">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212995">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213001">err</span>&nbsp;<span class="op" id="5213005">=</span>&nbsp;<span class="ident" id="5213007">f</span><span class="op" id="5213008">.</span><span class="ident" id="5213009">applyRelocations</span><span class="op" id="5213025">(</span><span class="ident" id="5213026">b</span><span class="op" id="5213027">,</span>&nbsp;<span class="ident" id="5213029">rd</span><span class="op" id="5213031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213037">if</span>&nbsp;<span class="ident" id="5213040">err</span>&nbsp;<span class="op" id="5213044">!=</span>&nbsp;<span class="ident" id="5213047">nil</span>&nbsp;<span class="op" id="5213051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213058">return</span>&nbsp;<span class="ident" id="5213065">nil</span><span class="op" id="5213068">,</span>&nbsp;<span class="ident" id="5213070">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213083">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213089">err</span>&nbsp;<span class="op" id="5213093">=</span>&nbsp;<span class="ident" id="5213095">d</span><span class="op" id="5213096">.</span><span class="ident" id="5213097">AddTypes</span><span class="op" id="5213105">(</span><span class="ident" id="5213106">fmt</span><span class="op" id="5213109">.</span><span class="ident" id="5213110">Sprintf</span><span class="op" id="5213117">(</span><span class="string" id="5213118">&#34;types-%d&#34;</span><span class="op" id="5213128">,</span>&nbsp;<span class="ident" id="5213130">i</span><span class="op" id="5213131">)</span><span class="op" id="5213132">,</span>&nbsp;<span class="ident" id="5213134">b</span><span class="op" id="5213135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213140">if</span>&nbsp;<span class="ident" id="5213143">err</span>&nbsp;<span class="op" id="5213147">!=</span>&nbsp;<span class="ident" id="5213150">nil</span>&nbsp;<span class="op" id="5213154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213160">return</span>&nbsp;<span class="ident" id="5213167">nil</span><span class="op" id="5213170">,</span>&nbsp;<span class="ident" id="5213172">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213179">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213190">return</span>&nbsp;<span class="ident" id="5213197">d</span><span class="op" id="5213198">,</span>&nbsp;<span class="ident" id="5213200">nil</span><br>
<span class="lineno"></span><span class="op" id="5213204">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5213207">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5213290">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5213311">//</span><br>
<span class="lineno"></span><span class="comment" id="5213314">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5213390">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5213464">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5213510">func</span>&nbsp;<span class="op" id="5213515">(</span><span class="ident" id="5213516">f</span>&nbsp;<span class="op" id="5213518">*</span><span class="ident" id="5213519">File</span><span class="op" id="5213523">)</span>&nbsp;<span class="ident" id="5213525">Symbols</span><span class="op" id="5213532">(</span><span class="op" id="5213533">)</span>&nbsp;<span class="op" id="5213535">(</span><span class="op" id="5213536">[</span><span class="op" id="5213537">]</span><span class="ident" id="5213538">Symbol</span><span class="op" id="5213544">,</span>&nbsp;<span class="builtintype" id="5213546">error</span><span class="op" id="5213551">)</span>&nbsp;<span class="op" id="5213553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213556">sym</span><span class="op" id="5213559">,</span>&nbsp;<span class="ident" id="5213561">_</span><span class="op" id="5213562">,</span>&nbsp;<span class="ident" id="5213564">err</span>&nbsp;<span class="op" id="5213568">:=</span>&nbsp;<span class="ident" id="5213571">f</span><span class="op" id="5213572">.</span><span class="ident" id="5213573">getSymbols</span><span class="op" id="5213583">(</span><span class="ident" id="5213584">SHT_SYMTAB</span><span class="op" id="5213594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213597">return</span>&nbsp;<span class="ident" id="5213604">sym</span><span class="op" id="5213607">,</span>&nbsp;<span class="ident" id="5213609">err</span><br>
<span class="lineno">770</span><span class="op" id="5213613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5213616">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5213686">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5213735">//</span><br>
<span class="lineno">775</span><span class="comment" id="5213738">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5213822">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5213896">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5213942">func</span>&nbsp;<span class="op" id="5213947">(</span><span class="ident" id="5213948">f</span>&nbsp;<span class="op" id="5213950">*</span><span class="ident" id="5213951">File</span><span class="op" id="5213955">)</span>&nbsp;<span class="ident" id="5213957">DynamicSymbols</span><span class="op" id="5213971">(</span><span class="op" id="5213972">)</span>&nbsp;<span class="op" id="5213974">(</span><span class="op" id="5213975">[</span><span class="op" id="5213976">]</span><span class="ident" id="5213977">Symbol</span><span class="op" id="5213983">,</span>&nbsp;<span class="builtintype" id="5213985">error</span><span class="op" id="5213990">)</span>&nbsp;<span class="op" id="5213992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213995">sym</span><span class="op" id="5213998">,</span>&nbsp;<span class="ident" id="5214000">_</span><span class="op" id="5214001">,</span>&nbsp;<span class="ident" id="5214003">err</span>&nbsp;<span class="op" id="5214007">:=</span>&nbsp;<span class="ident" id="5214010">f</span><span class="op" id="5214011">.</span><span class="ident" id="5214012">getSymbols</span><span class="op" id="5214022">(</span><span class="ident" id="5214023">SHT_DYNSYM</span><span class="op" id="5214033">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214036">return</span>&nbsp;<span class="ident" id="5214043">sym</span><span class="op" id="5214046">,</span>&nbsp;<span class="ident" id="5214048">err</span><br>
<span class="lineno"></span><span class="op" id="5214052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214055">type</span>&nbsp;<span class="ident" id="5214060">ImportedSymbol</span>&nbsp;<span class="keyword" id="5214075">struct</span>&nbsp;<span class="op" id="5214082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214085">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5214093">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214101">Version</span>&nbsp;<span class="builtintype" id="5214109">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214117">Library</span>&nbsp;<span class="builtintype" id="5214125">string</span><br>
<span class="lineno"></span><span class="op" id="5214132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5214135">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5214187">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5214242">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5214296">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5214332">func</span>&nbsp;<span class="op" id="5214337">(</span><span class="ident" id="5214338">f</span>&nbsp;<span class="op" id="5214340">*</span><span class="ident" id="5214341">File</span><span class="op" id="5214345">)</span>&nbsp;<span class="ident" id="5214347">ImportedSymbols</span><span class="op" id="5214362">(</span><span class="op" id="5214363">)</span>&nbsp;<span class="op" id="5214365">(</span><span class="op" id="5214366">[</span><span class="op" id="5214367">]</span><span class="ident" id="5214368">ImportedSymbol</span><span class="op" id="5214382">,</span>&nbsp;<span class="builtintype" id="5214384">error</span><span class="op" id="5214389">)</span>&nbsp;<span class="op" id="5214391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214394">sym</span><span class="op" id="5214397">,</span>&nbsp;<span class="ident" id="5214399">str</span><span class="op" id="5214402">,</span>&nbsp;<span class="ident" id="5214404">err</span>&nbsp;<span class="op" id="5214408">:=</span>&nbsp;<span class="ident" id="5214411">f</span><span class="op" id="5214412">.</span><span class="ident" id="5214413">getSymbols</span><span class="op" id="5214423">(</span><span class="ident" id="5214424">SHT_DYNSYM</span><span class="op" id="5214434">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214437">if</span>&nbsp;<span class="ident" id="5214440">err</span>&nbsp;<span class="op" id="5214444">!=</span>&nbsp;<span class="ident" id="5214447">nil</span>&nbsp;<span class="op" id="5214451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214455">return</span>&nbsp;<span class="ident" id="5214462">nil</span><span class="op" id="5214465">,</span>&nbsp;<span class="ident" id="5214467">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214475">f</span><span class="op" id="5214476">.</span><span class="ident" id="5214477">gnuVersionInit</span><span class="op" id="5214491">(</span><span class="ident" id="5214492">str</span><span class="op" id="5214495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214498">var</span>&nbsp;<span class="ident" id="5214502">all</span>&nbsp;<span class="op" id="5214506">[</span><span class="op" id="5214507">]</span><span class="ident" id="5214508">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214524">for</span>&nbsp;<span class="ident" id="5214528">i</span><span class="op" id="5214529">,</span>&nbsp;<span class="ident" id="5214531">s</span>&nbsp;<span class="op" id="5214533">:=</span>&nbsp;<span class="keyword" id="5214536">range</span>&nbsp;<span class="ident" id="5214542">sym</span>&nbsp;<span class="op" id="5214546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214550">if</span>&nbsp;<span class="ident" id="5214553">ST_BIND</span><span class="op" id="5214560">(</span><span class="ident" id="5214561">s</span><span class="op" id="5214562">.</span><span class="ident" id="5214563">Info</span><span class="op" id="5214567">)</span>&nbsp;<span class="op" id="5214569">==</span>&nbsp;<span class="ident" id="5214572">STB_GLOBAL</span>&nbsp;<span class="op" id="5214583">&amp;&amp;</span>&nbsp;<span class="ident" id="5214586">s</span><span class="op" id="5214587">.</span><span class="ident" id="5214588">Section</span>&nbsp;<span class="op" id="5214596">==</span>&nbsp;<span class="ident" id="5214599">SHN_UNDEF</span>&nbsp;<span class="op" id="5214609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214614">all</span>&nbsp;<span class="op" id="5214618">=</span>&nbsp;<span class="builtinfunc" id="5214620">append</span><span class="op" id="5214626">(</span><span class="ident" id="5214627">all</span><span class="op" id="5214630">,</span>&nbsp;<span class="ident" id="5214632">ImportedSymbol</span><span class="op" id="5214646">{</span><span class="ident" id="5214647">Name</span><span class="op" id="5214651">:</span>&nbsp;<span class="ident" id="5214653">s</span><span class="op" id="5214654">.</span><span class="ident" id="5214655">Name</span><span class="op" id="5214659">}</span><span class="op" id="5214660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214665">f</span><span class="op" id="5214666">.</span><span class="ident" id="5214667">gnuVersion</span><span class="op" id="5214677">(</span><span class="ident" id="5214678">i</span><span class="op" id="5214679">,</span>&nbsp;<span class="op" id="5214681">&amp;</span><span class="ident" id="5214682">all</span><span class="op" id="5214685">[</span><span class="builtinfunc" id="5214686">len</span><span class="op" id="5214689">(</span><span class="ident" id="5214690">all</span><span class="op" id="5214693">)</span><span class="op" id="5214694">-</span><span class="num" id="5214695">1</span><span class="op" id="5214696">]</span><span class="op" id="5214697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214701">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214707">return</span>&nbsp;<span class="ident" id="5214714">all</span><span class="op" id="5214717">,</span>&nbsp;<span class="ident" id="5214719">nil</span><br>
<span class="lineno"></span><span class="op" id="5214723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214726">type</span>&nbsp;<span class="ident" id="5214731">verneed</span>&nbsp;<span class="keyword" id="5214739">struct</span>&nbsp;<span class="op" id="5214746">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214749">File</span>&nbsp;<span class="builtintype" id="5214754">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214762">Name</span>&nbsp;<span class="builtintype" id="5214767">string</span><br>
<span class="lineno"></span><span class="op" id="5214774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5214777">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5214825">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5214860">func</span>&nbsp;<span class="op" id="5214865">(</span><span class="ident" id="5214866">f</span>&nbsp;<span class="op" id="5214868">*</span><span class="ident" id="5214869">File</span><span class="op" id="5214873">)</span>&nbsp;<span class="ident" id="5214875">gnuVersionInit</span><span class="op" id="5214889">(</span><span class="ident" id="5214890">str</span>&nbsp;<span class="op" id="5214894">[</span><span class="op" id="5214895">]</span><span class="builtintype" id="5214896">byte</span><span class="op" id="5214900">)</span>&nbsp;<span class="op" id="5214902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5214905">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214941">vn</span>&nbsp;<span class="op" id="5214944">:=</span>&nbsp;<span class="ident" id="5214947">f</span><span class="op" id="5214948">.</span><span class="ident" id="5214949">SectionByType</span><span class="op" id="5214962">(</span><span class="ident" id="5214963">SHT_GNU_VERNEED</span><span class="op" id="5214978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214981">if</span>&nbsp;<span class="ident" id="5214984">vn</span>&nbsp;<span class="op" id="5214987">==</span>&nbsp;<span class="ident" id="5214990">nil</span>&nbsp;<span class="op" id="5214994">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215009">d</span><span class="op" id="5215010">,</span>&nbsp;<span class="ident" id="5215012">_</span>&nbsp;<span class="op" id="5215014">:=</span>&nbsp;<span class="ident" id="5215017">vn</span><span class="op" id="5215019">.</span><span class="ident" id="5215020">Data</span><span class="op" id="5215024">(</span><span class="op" id="5215025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215029">var</span>&nbsp;<span class="ident" id="5215033">need</span>&nbsp;<span class="op" id="5215038">[</span><span class="op" id="5215039">]</span><span class="ident" id="5215040">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215049">i</span>&nbsp;<span class="op" id="5215051">:=</span>&nbsp;<span class="num" id="5215054">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215057">for</span>&nbsp;<span class="op" id="5215061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215065">if</span>&nbsp;<span class="ident" id="5215068">i</span><span class="op" id="5215069">+</span><span class="num" id="5215070">16</span>&nbsp;<span class="op" id="5215073">&gt;</span>&nbsp;<span class="builtinfunc" id="5215075">len</span><span class="op" id="5215078">(</span><span class="ident" id="5215079">d</span><span class="op" id="5215080">)</span>&nbsp;<span class="op" id="5215082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215087">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215095">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215099">vers</span>&nbsp;<span class="op" id="5215104">:=</span>&nbsp;<span class="ident" id="5215107">f</span><span class="op" id="5215108">.</span><span class="ident" id="5215109">ByteOrder</span><span class="op" id="5215118">.</span><span class="ident" id="5215119">Uint16</span><span class="op" id="5215125">(</span><span class="ident" id="5215126">d</span><span class="op" id="5215127">[</span><span class="ident" id="5215128">i</span>&nbsp;<span class="op" id="5215130">:</span>&nbsp;<span class="ident" id="5215132">i</span><span class="op" id="5215133">+</span><span class="num" id="5215134">2</span><span class="op" id="5215135">]</span><span class="op" id="5215136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215140">if</span>&nbsp;<span class="ident" id="5215143">vers</span>&nbsp;<span class="op" id="5215148">!=</span>&nbsp;<span class="num" id="5215151">1</span>&nbsp;<span class="op" id="5215153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215158">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215170">cnt</span>&nbsp;<span class="op" id="5215174">:=</span>&nbsp;<span class="ident" id="5215177">f</span><span class="op" id="5215178">.</span><span class="ident" id="5215179">ByteOrder</span><span class="op" id="5215188">.</span><span class="ident" id="5215189">Uint16</span><span class="op" id="5215195">(</span><span class="ident" id="5215196">d</span><span class="op" id="5215197">[</span><span class="ident" id="5215198">i</span><span class="op" id="5215199">+</span><span class="num" id="5215200">2</span>&nbsp;<span class="op" id="5215202">:</span>&nbsp;<span class="ident" id="5215204">i</span><span class="op" id="5215205">+</span><span class="num" id="5215206">4</span><span class="op" id="5215207">]</span><span class="op" id="5215208">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215212">fileoff</span>&nbsp;<span class="op" id="5215220">:=</span>&nbsp;<span class="ident" id="5215223">f</span><span class="op" id="5215224">.</span><span class="ident" id="5215225">ByteOrder</span><span class="op" id="5215234">.</span><span class="ident" id="5215235">Uint32</span><span class="op" id="5215241">(</span><span class="ident" id="5215242">d</span><span class="op" id="5215243">[</span><span class="ident" id="5215244">i</span><span class="op" id="5215245">+</span><span class="num" id="5215246">4</span>&nbsp;<span class="op" id="5215248">:</span>&nbsp;<span class="ident" id="5215250">i</span><span class="op" id="5215251">+</span><span class="num" id="5215252">8</span><span class="op" id="5215253">]</span><span class="op" id="5215254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215258">aux</span>&nbsp;<span class="op" id="5215262">:=</span>&nbsp;<span class="ident" id="5215265">f</span><span class="op" id="5215266">.</span><span class="ident" id="5215267">ByteOrder</span><span class="op" id="5215276">.</span><span class="ident" id="5215277">Uint32</span><span class="op" id="5215283">(</span><span class="ident" id="5215284">d</span><span class="op" id="5215285">[</span><span class="ident" id="5215286">i</span><span class="op" id="5215287">+</span><span class="num" id="5215288">8</span>&nbsp;<span class="op" id="5215290">:</span>&nbsp;<span class="ident" id="5215292">i</span><span class="op" id="5215293">+</span><span class="num" id="5215294">12</span><span class="op" id="5215296">]</span><span class="op" id="5215297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215301">next</span>&nbsp;<span class="op" id="5215306">:=</span>&nbsp;<span class="ident" id="5215309">f</span><span class="op" id="5215310">.</span><span class="ident" id="5215311">ByteOrder</span><span class="op" id="5215320">.</span><span class="ident" id="5215321">Uint32</span><span class="op" id="5215327">(</span><span class="ident" id="5215328">d</span><span class="op" id="5215329">[</span><span class="ident" id="5215330">i</span><span class="op" id="5215331">+</span><span class="num" id="5215332">12</span>&nbsp;<span class="op" id="5215335">:</span>&nbsp;<span class="ident" id="5215337">i</span><span class="op" id="5215338">+</span><span class="num" id="5215339">16</span><span class="op" id="5215341">]</span><span class="op" id="5215342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215346">file</span><span class="op" id="5215350">,</span>&nbsp;<span class="ident" id="5215352">_</span>&nbsp;<span class="op" id="5215354">:=</span>&nbsp;<span class="ident" id="5215357">getString</span><span class="op" id="5215366">(</span><span class="ident" id="5215367">str</span><span class="op" id="5215370">,</span>&nbsp;<span class="builtintype" id="5215372">int</span><span class="op" id="5215375">(</span><span class="ident" id="5215376">fileoff</span><span class="op" id="5215383">)</span><span class="op" id="5215384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215389">var</span>&nbsp;<span class="ident" id="5215393">name</span>&nbsp;<span class="builtintype" id="5215398">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215407">j</span>&nbsp;<span class="op" id="5215409">:=</span>&nbsp;<span class="ident" id="5215412">i</span>&nbsp;<span class="op" id="5215414">+</span>&nbsp;<span class="builtintype" id="5215416">int</span><span class="op" id="5215419">(</span><span class="ident" id="5215420">aux</span><span class="op" id="5215423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215427">for</span>&nbsp;<span class="ident" id="5215431">c</span>&nbsp;<span class="op" id="5215433">:=</span>&nbsp;<span class="num" id="5215436">0</span><span class="op" id="5215437">;</span>&nbsp;<span class="ident" id="5215439">c</span>&nbsp;<span class="op" id="5215441">&lt;</span>&nbsp;<span class="builtintype" id="5215443">int</span><span class="op" id="5215446">(</span><span class="ident" id="5215447">cnt</span><span class="op" id="5215450">)</span><span class="op" id="5215451">;</span>&nbsp;<span class="ident" id="5215453">c</span><span class="op" id="5215454">++</span>&nbsp;<span class="op" id="5215457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215462">if</span>&nbsp;<span class="ident" id="5215465">j</span><span class="op" id="5215466">+</span><span class="num" id="5215467">16</span>&nbsp;<span class="op" id="5215470">&gt;</span>&nbsp;<span class="builtinfunc" id="5215472">len</span><span class="op" id="5215475">(</span><span class="ident" id="5215476">d</span><span class="op" id="5215477">)</span>&nbsp;<span class="op" id="5215479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215485">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215499">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215542">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215588">other</span>&nbsp;<span class="op" id="5215594">:=</span>&nbsp;<span class="ident" id="5215597">f</span><span class="op" id="5215598">.</span><span class="ident" id="5215599">ByteOrder</span><span class="op" id="5215608">.</span><span class="ident" id="5215609">Uint16</span><span class="op" id="5215615">(</span><span class="ident" id="5215616">d</span><span class="op" id="5215617">[</span><span class="ident" id="5215618">j</span><span class="op" id="5215619">+</span><span class="num" id="5215620">6</span>&nbsp;<span class="op" id="5215622">:</span>&nbsp;<span class="ident" id="5215624">j</span><span class="op" id="5215625">+</span><span class="num" id="5215626">8</span><span class="op" id="5215627">]</span><span class="op" id="5215628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215633">nameoff</span>&nbsp;<span class="op" id="5215641">:=</span>&nbsp;<span class="ident" id="5215644">f</span><span class="op" id="5215645">.</span><span class="ident" id="5215646">ByteOrder</span><span class="op" id="5215655">.</span><span class="ident" id="5215656">Uint32</span><span class="op" id="5215662">(</span><span class="ident" id="5215663">d</span><span class="op" id="5215664">[</span><span class="ident" id="5215665">j</span><span class="op" id="5215666">+</span><span class="num" id="5215667">8</span>&nbsp;<span class="op" id="5215669">:</span>&nbsp;<span class="ident" id="5215671">j</span><span class="op" id="5215672">+</span><span class="num" id="5215673">12</span><span class="op" id="5215675">]</span><span class="op" id="5215676">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215681">next</span>&nbsp;<span class="op" id="5215686">:=</span>&nbsp;<span class="ident" id="5215689">f</span><span class="op" id="5215690">.</span><span class="ident" id="5215691">ByteOrder</span><span class="op" id="5215700">.</span><span class="ident" id="5215701">Uint32</span><span class="op" id="5215707">(</span><span class="ident" id="5215708">d</span><span class="op" id="5215709">[</span><span class="ident" id="5215710">j</span><span class="op" id="5215711">+</span><span class="num" id="5215712">12</span>&nbsp;<span class="op" id="5215715">:</span>&nbsp;<span class="ident" id="5215717">j</span><span class="op" id="5215718">+</span><span class="num" id="5215719">16</span><span class="op" id="5215721">]</span><span class="op" id="5215722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215727">name</span><span class="op" id="5215731">,</span>&nbsp;<span class="ident" id="5215733">_</span>&nbsp;<span class="op" id="5215735">=</span>&nbsp;<span class="ident" id="5215737">getString</span><span class="op" id="5215746">(</span><span class="ident" id="5215747">str</span><span class="op" id="5215750">,</span>&nbsp;<span class="builtintype" id="5215752">int</span><span class="op" id="5215755">(</span><span class="ident" id="5215756">nameoff</span><span class="op" id="5215763">)</span><span class="op" id="5215764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215769">ndx</span>&nbsp;<span class="op" id="5215773">:=</span>&nbsp;<span class="builtintype" id="5215776">int</span><span class="op" id="5215779">(</span><span class="ident" id="5215780">other</span><span class="op" id="5215785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215790">if</span>&nbsp;<span class="ident" id="5215793">ndx</span>&nbsp;<span class="op" id="5215797">&gt;=</span>&nbsp;<span class="builtinfunc" id="5215800">len</span><span class="op" id="5215803">(</span><span class="ident" id="5215804">need</span><span class="op" id="5215808">)</span>&nbsp;<span class="op" id="5215810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215816">a</span>&nbsp;<span class="op" id="5215818">:=</span>&nbsp;<span class="builtinfunc" id="5215821">make</span><span class="op" id="5215825">(</span><span class="op" id="5215826">[</span><span class="op" id="5215827">]</span><span class="ident" id="5215828">verneed</span><span class="op" id="5215835">,</span>&nbsp;<span class="num" id="5215837">2</span><span class="op" id="5215838">*</span><span class="op" id="5215839">(</span><span class="ident" id="5215840">ndx</span><span class="op" id="5215843">+</span><span class="num" id="5215844">1</span><span class="op" id="5215845">)</span><span class="op" id="5215846">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5215852">copy</span><span class="op" id="5215856">(</span><span class="ident" id="5215857">a</span><span class="op" id="5215858">,</span>&nbsp;<span class="ident" id="5215860">need</span><span class="op" id="5215864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215870">need</span>&nbsp;<span class="op" id="5215875">=</span>&nbsp;<span class="ident" id="5215877">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215888">need</span><span class="op" id="5215892">[</span><span class="ident" id="5215893">ndx</span><span class="op" id="5215896">]</span>&nbsp;<span class="op" id="5215898">=</span>&nbsp;<span class="ident" id="5215900">verneed</span><span class="op" id="5215907">{</span><span class="ident" id="5215908">file</span><span class="op" id="5215912">,</span>&nbsp;<span class="ident" id="5215914">name</span><span class="op" id="5215918">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215923">if</span>&nbsp;<span class="ident" id="5215926">next</span>&nbsp;<span class="op" id="5215931">==</span>&nbsp;<span class="num" id="5215934">0</span>&nbsp;<span class="op" id="5215936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215942">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215956">j</span>&nbsp;<span class="op" id="5215958">+=</span>&nbsp;<span class="builtintype" id="5215961">int</span><span class="op" id="5215964">(</span><span class="ident" id="5215965">next</span><span class="op" id="5215969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215973">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215978">if</span>&nbsp;<span class="ident" id="5215981">next</span>&nbsp;<span class="op" id="5215986">==</span>&nbsp;<span class="num" id="5215989">0</span>&nbsp;<span class="op" id="5215991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215996">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216008">i</span>&nbsp;<span class="op" id="5216010">+=</span>&nbsp;<span class="builtintype" id="5216013">int</span><span class="op" id="5216016">(</span><span class="ident" id="5216017">next</span><span class="op" id="5216021">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5216028">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216086">vs</span>&nbsp;<span class="op" id="5216089">:=</span>&nbsp;<span class="ident" id="5216092">f</span><span class="op" id="5216093">.</span><span class="ident" id="5216094">SectionByType</span><span class="op" id="5216107">(</span><span class="ident" id="5216108">SHT_GNU_VERSYM</span><span class="op" id="5216122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216125">if</span>&nbsp;<span class="ident" id="5216128">vs</span>&nbsp;<span class="op" id="5216131">==</span>&nbsp;<span class="ident" id="5216134">nil</span>&nbsp;<span class="op" id="5216138">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216153">d</span><span class="op" id="5216154">,</span>&nbsp;<span class="ident" id="5216156">_</span>&nbsp;<span class="op" id="5216158">=</span>&nbsp;<span class="ident" id="5216160">vs</span><span class="op" id="5216162">.</span><span class="ident" id="5216163">Data</span><span class="op" id="5216167">(</span><span class="op" id="5216168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216172">f</span><span class="op" id="5216173">.</span><span class="ident" id="5216174">gnuNeed</span>&nbsp;<span class="op" id="5216182">=</span>&nbsp;<span class="ident" id="5216184">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216190">f</span><span class="op" id="5216191">.</span><span class="ident" id="5216192">gnuVersym</span>&nbsp;<span class="op" id="5216202">=</span>&nbsp;<span class="ident" id="5216204">d</span><br>
<span class="lineno"></span><span class="op" id="5216206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5216209">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5216268">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5216317">func</span>&nbsp;<span class="op" id="5216322">(</span><span class="ident" id="5216323">f</span>&nbsp;<span class="op" id="5216325">*</span><span class="ident" id="5216326">File</span><span class="op" id="5216330">)</span>&nbsp;<span class="ident" id="5216332">gnuVersion</span><span class="op" id="5216342">(</span><span class="ident" id="5216343">i</span>&nbsp;<span class="builtintype" id="5216345">int</span><span class="op" id="5216348">,</span>&nbsp;<span class="ident" id="5216350">sym</span>&nbsp;<span class="op" id="5216354">*</span><span class="ident" id="5216355">ImportedSymbol</span><span class="op" id="5216369">)</span>&nbsp;<span class="op" id="5216371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5216374">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216403">i</span>&nbsp;<span class="op" id="5216405">=</span>&nbsp;<span class="op" id="5216407">(</span><span class="ident" id="5216408">i</span>&nbsp;<span class="op" id="5216410">+</span>&nbsp;<span class="num" id="5216412">1</span><span class="op" id="5216413">)</span>&nbsp;<span class="op" id="5216415">*</span>&nbsp;<span class="num" id="5216417">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216420">if</span>&nbsp;<span class="ident" id="5216423">i</span>&nbsp;<span class="op" id="5216425">&gt;=</span>&nbsp;<span class="builtinfunc" id="5216428">len</span><span class="op" id="5216431">(</span><span class="ident" id="5216432">f</span><span class="op" id="5216433">.</span><span class="ident" id="5216434">gnuVersym</span><span class="op" id="5216443">)</span>&nbsp;<span class="op" id="5216445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216449">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216460">j</span>&nbsp;<span class="op" id="5216462">:=</span>&nbsp;<span class="builtintype" id="5216465">int</span><span class="op" id="5216468">(</span><span class="ident" id="5216469">f</span><span class="op" id="5216470">.</span><span class="ident" id="5216471">ByteOrder</span><span class="op" id="5216480">.</span><span class="ident" id="5216481">Uint16</span><span class="op" id="5216487">(</span><span class="ident" id="5216488">f</span><span class="op" id="5216489">.</span><span class="ident" id="5216490">gnuVersym</span><span class="op" id="5216499">[</span><span class="ident" id="5216500">i</span><span class="op" id="5216501">:</span><span class="op" id="5216502">]</span><span class="op" id="5216503">)</span><span class="op" id="5216504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216507">if</span>&nbsp;<span class="ident" id="5216510">j</span>&nbsp;<span class="op" id="5216512">&lt;</span>&nbsp;<span class="num" id="5216514">2</span>&nbsp;<span class="op" id="5216516">||</span>&nbsp;<span class="ident" id="5216519">j</span>&nbsp;<span class="op" id="5216521">&gt;=</span>&nbsp;<span class="builtinfunc" id="5216524">len</span><span class="op" id="5216527">(</span><span class="ident" id="5216528">f</span><span class="op" id="5216529">.</span><span class="ident" id="5216530">gnuNeed</span><span class="op" id="5216537">)</span>&nbsp;<span class="op" id="5216539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216543">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216551">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216554">n</span>&nbsp;<span class="op" id="5216556">:=</span>&nbsp;<span class="op" id="5216559">&amp;</span><span class="ident" id="5216560">f</span><span class="op" id="5216561">.</span><span class="ident" id="5216562">gnuNeed</span><span class="op" id="5216569">[</span><span class="ident" id="5216570">j</span><span class="op" id="5216571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216574">sym</span><span class="op" id="5216577">.</span><span class="ident" id="5216578">Library</span>&nbsp;<span class="op" id="5216586">=</span>&nbsp;<span class="ident" id="5216588">n</span><span class="op" id="5216589">.</span><span class="ident" id="5216590">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216596">sym</span><span class="op" id="5216599">.</span><span class="ident" id="5216600">Version</span>&nbsp;<span class="op" id="5216608">=</span>&nbsp;<span class="ident" id="5216610">n</span><span class="op" id="5216611">.</span><span class="ident" id="5216612">Name</span><br>
<span class="lineno"></span><span class="op" id="5216617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5216620">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5216676">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5216731">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5216779">func</span>&nbsp;<span class="op" id="5216784">(</span><span class="ident" id="5216785">f</span>&nbsp;<span class="op" id="5216787">*</span><span class="ident" id="5216788">File</span><span class="op" id="5216792">)</span>&nbsp;<span class="ident" id="5216794">ImportedLibraries</span><span class="op" id="5216811">(</span><span class="op" id="5216812">)</span>&nbsp;<span class="op" id="5216814">(</span><span class="op" id="5216815">[</span><span class="op" id="5216816">]</span><span class="builtintype" id="5216817">string</span><span class="op" id="5216823">,</span>&nbsp;<span class="builtintype" id="5216825">error</span><span class="op" id="5216830">)</span>&nbsp;<span class="op" id="5216832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216835">return</span>&nbsp;<span class="ident" id="5216842">f</span><span class="op" id="5216843">.</span><span class="ident" id="5216844">DynString</span><span class="op" id="5216853">(</span><span class="ident" id="5216854">DT_NEEDED</span><span class="op" id="5216863">)</span><br>
<span class="lineno">905</span><span class="op" id="5216865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5216868">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5216948">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5216960">//</span><br>
<span class="lineno">910</span><span class="comment" id="5216963">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5217047">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5217062">func</span>&nbsp;<span class="op" id="5217067">(</span><span class="ident" id="5217068">f</span>&nbsp;<span class="op" id="5217070">*</span><span class="ident" id="5217071">File</span><span class="op" id="5217075">)</span>&nbsp;<span class="ident" id="5217077">DynString</span><span class="op" id="5217086">(</span><span class="ident" id="5217087">tag</span>&nbsp;<span class="ident" id="5217091">DynTag</span><span class="op" id="5217097">)</span>&nbsp;<span class="op" id="5217099">(</span><span class="op" id="5217100">[</span><span class="op" id="5217101">]</span><span class="builtintype" id="5217102">string</span><span class="op" id="5217108">,</span>&nbsp;<span class="builtintype" id="5217110">error</span><span class="op" id="5217115">)</span>&nbsp;<span class="op" id="5217117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217120">switch</span>&nbsp;<span class="ident" id="5217127">tag</span>&nbsp;<span class="op" id="5217131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217134">case</span>&nbsp;<span class="ident" id="5217139">DT_NEEDED</span><span class="op" id="5217148">,</span>&nbsp;<span class="ident" id="5217150">DT_SONAME</span><span class="op" id="5217159">,</span>&nbsp;<span class="ident" id="5217161">DT_RPATH</span><span class="op" id="5217169">,</span>&nbsp;<span class="ident" id="5217171">DT_RUNPATH</span><span class="op" id="5217181">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217184">default</span><span class="op" id="5217191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217195">return</span>&nbsp;<span class="ident" id="5217202">nil</span><span class="op" id="5217205">,</span>&nbsp;<span class="ident" id="5217207">fmt</span><span class="op" id="5217210">.</span><span class="ident" id="5217211">Errorf</span><span class="op" id="5217217">(</span><span class="string" id="5217218">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5217244">,</span>&nbsp;<span class="ident" id="5217246">tag</span><span class="op" id="5217249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217255">ds</span>&nbsp;<span class="op" id="5217258">:=</span>&nbsp;<span class="ident" id="5217261">f</span><span class="op" id="5217262">.</span><span class="ident" id="5217263">SectionByType</span><span class="op" id="5217276">(</span><span class="ident" id="5217277">SHT_DYNAMIC</span><span class="op" id="5217288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217291">if</span>&nbsp;<span class="ident" id="5217294">ds</span>&nbsp;<span class="op" id="5217297">==</span>&nbsp;<span class="ident" id="5217300">nil</span>&nbsp;<span class="op" id="5217304">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217308">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217342">return</span>&nbsp;<span class="ident" id="5217349">nil</span><span class="op" id="5217352">,</span>&nbsp;<span class="ident" id="5217354">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217362">d</span><span class="op" id="5217363">,</span>&nbsp;<span class="ident" id="5217365">err</span>&nbsp;<span class="op" id="5217369">:=</span>&nbsp;<span class="ident" id="5217372">ds</span><span class="op" id="5217374">.</span><span class="ident" id="5217375">Data</span><span class="op" id="5217379">(</span><span class="op" id="5217380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217383">if</span>&nbsp;<span class="ident" id="5217386">err</span>&nbsp;<span class="op" id="5217390">!=</span>&nbsp;<span class="ident" id="5217393">nil</span>&nbsp;<span class="op" id="5217397">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217401">return</span>&nbsp;<span class="ident" id="5217408">nil</span><span class="op" id="5217411">,</span>&nbsp;<span class="ident" id="5217413">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217421">str</span><span class="op" id="5217424">,</span>&nbsp;<span class="ident" id="5217426">err</span>&nbsp;<span class="op" id="5217430">:=</span>&nbsp;<span class="ident" id="5217433">f</span><span class="op" id="5217434">.</span><span class="ident" id="5217435">stringTable</span><span class="op" id="5217446">(</span><span class="ident" id="5217447">ds</span><span class="op" id="5217449">.</span><span class="ident" id="5217450">Link</span><span class="op" id="5217454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217457">if</span>&nbsp;<span class="ident" id="5217460">err</span>&nbsp;<span class="op" id="5217464">!=</span>&nbsp;<span class="ident" id="5217467">nil</span>&nbsp;<span class="op" id="5217471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217475">return</span>&nbsp;<span class="ident" id="5217482">nil</span><span class="op" id="5217485">,</span>&nbsp;<span class="ident" id="5217487">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217495">var</span>&nbsp;<span class="ident" id="5217499">all</span>&nbsp;<span class="op" id="5217503">[</span><span class="op" id="5217504">]</span><span class="builtintype" id="5217505">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217513">for</span>&nbsp;<span class="builtinfunc" id="5217517">len</span><span class="op" id="5217520">(</span><span class="ident" id="5217521">d</span><span class="op" id="5217522">)</span>&nbsp;<span class="op" id="5217524">&gt;</span>&nbsp;<span class="num" id="5217526">0</span>&nbsp;<span class="op" id="5217528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217532">var</span>&nbsp;<span class="ident" id="5217536">t</span>&nbsp;<span class="ident" id="5217538">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217547">var</span>&nbsp;<span class="ident" id="5217551">v</span>&nbsp;<span class="ident" id="5217553">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217562">switch</span>&nbsp;<span class="ident" id="5217569">f</span><span class="op" id="5217570">.</span><span class="ident" id="5217571">Class</span>&nbsp;<span class="op" id="5217577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217581">case</span>&nbsp;<span class="ident" id="5217586">ELFCLASS32</span><span class="op" id="5217596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217601">t</span>&nbsp;<span class="op" id="5217603">=</span>&nbsp;<span class="ident" id="5217605">DynTag</span><span class="op" id="5217611">(</span><span class="ident" id="5217612">f</span><span class="op" id="5217613">.</span><span class="ident" id="5217614">ByteOrder</span><span class="op" id="5217623">.</span><span class="ident" id="5217624">Uint32</span><span class="op" id="5217630">(</span><span class="ident" id="5217631">d</span><span class="op" id="5217632">[</span><span class="num" id="5217633">0</span><span class="op" id="5217634">:</span><span class="num" id="5217635">4</span><span class="op" id="5217636">]</span><span class="op" id="5217637">)</span><span class="op" id="5217638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217643">v</span>&nbsp;<span class="op" id="5217645">=</span>&nbsp;<span class="ident" id="5217647">uint64</span><span class="op" id="5217653">(</span><span class="ident" id="5217654">f</span><span class="op" id="5217655">.</span><span class="ident" id="5217656">ByteOrder</span><span class="op" id="5217665">.</span><span class="ident" id="5217666">Uint32</span><span class="op" id="5217672">(</span><span class="ident" id="5217673">d</span><span class="op" id="5217674">[</span><span class="num" id="5217675">4</span><span class="op" id="5217676">:</span><span class="num" id="5217677">8</span><span class="op" id="5217678">]</span><span class="op" id="5217679">)</span><span class="op" id="5217680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217685">d</span>&nbsp;<span class="op" id="5217687">=</span>&nbsp;<span class="ident" id="5217689">d</span><span class="op" id="5217690">[</span><span class="num" id="5217691">8</span><span class="op" id="5217692">:</span><span class="op" id="5217693">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217697">case</span>&nbsp;<span class="ident" id="5217702">ELFCLASS64</span><span class="op" id="5217712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217717">t</span>&nbsp;<span class="op" id="5217719">=</span>&nbsp;<span class="ident" id="5217721">DynTag</span><span class="op" id="5217727">(</span><span class="ident" id="5217728">f</span><span class="op" id="5217729">.</span><span class="ident" id="5217730">ByteOrder</span><span class="op" id="5217739">.</span><span class="ident" id="5217740">Uint64</span><span class="op" id="5217746">(</span><span class="ident" id="5217747">d</span><span class="op" id="5217748">[</span><span class="num" id="5217749">0</span><span class="op" id="5217750">:</span><span class="num" id="5217751">8</span><span class="op" id="5217752">]</span><span class="op" id="5217753">)</span><span class="op" id="5217754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217759">v</span>&nbsp;<span class="op" id="5217761">=</span>&nbsp;<span class="ident" id="5217763">f</span><span class="op" id="5217764">.</span><span class="ident" id="5217765">ByteOrder</span><span class="op" id="5217774">.</span><span class="ident" id="5217775">Uint64</span><span class="op" id="5217781">(</span><span class="ident" id="5217782">d</span><span class="op" id="5217783">[</span><span class="num" id="5217784">8</span><span class="op" id="5217785">:</span><span class="num" id="5217786">16</span><span class="op" id="5217788">]</span><span class="op" id="5217789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217794">d</span>&nbsp;<span class="op" id="5217796">=</span>&nbsp;<span class="ident" id="5217798">d</span><span class="op" id="5217799">[</span><span class="num" id="5217800">16</span><span class="op" id="5217802">:</span><span class="op" id="5217803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217807">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217811">if</span>&nbsp;<span class="ident" id="5217814">t</span>&nbsp;<span class="op" id="5217816">==</span>&nbsp;<span class="ident" id="5217819">tag</span>&nbsp;<span class="op" id="5217823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217828">s</span><span class="op" id="5217829">,</span>&nbsp;<span class="ident" id="5217831">ok</span>&nbsp;<span class="op" id="5217834">:=</span>&nbsp;<span class="ident" id="5217837">getString</span><span class="op" id="5217846">(</span><span class="ident" id="5217847">str</span><span class="op" id="5217850">,</span>&nbsp;<span class="builtintype" id="5217852">int</span><span class="op" id="5217855">(</span><span class="ident" id="5217856">v</span><span class="op" id="5217857">)</span><span class="op" id="5217858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217863">if</span>&nbsp;<span class="ident" id="5217866">ok</span>&nbsp;<span class="op" id="5217869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217875">all</span>&nbsp;<span class="op" id="5217879">=</span>&nbsp;<span class="builtinfunc" id="5217881">append</span><span class="op" id="5217887">(</span><span class="ident" id="5217888">all</span><span class="op" id="5217891">,</span>&nbsp;<span class="ident" id="5217893">s</span><span class="op" id="5217894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217899">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217909">return</span>&nbsp;<span class="ident" id="5217916">all</span><span class="op" id="5217919">,</span>&nbsp;<span class="ident" id="5217921">nil</span><br>
<span class="lineno"></span><span class="op" id="5217925">}</span>
</div>
</body>
</html>
