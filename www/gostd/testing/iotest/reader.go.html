<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5850072">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5850127">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5850181">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5850232">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5850308">package</span>&nbsp;<span class="ident" id="5850316">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850324">import</span>&nbsp;<span class="op" id="5850331">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5850334">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5850344">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5850349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5850352">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5850402">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5850453">func</span>&nbsp;<span class="ident" id="5850458">OneByteReader</span><span class="op" id="5850471">(</span><span class="ident" id="5850472">r</span>&nbsp;<span class="ident" id="5850474">io</span><span class="op" id="5850476">.</span><span class="ident" id="5850477">Reader</span><span class="op" id="5850483">)</span>&nbsp;<span class="ident" id="5850485">io</span><span class="op" id="5850487">.</span><span class="ident" id="5850488">Reader</span>&nbsp;<span class="op" id="5850495">{</span>&nbsp;<span class="keyword" id="5850497">return</span>&nbsp;<span class="op" id="5850504">&amp;</span><span class="ident" id="5850505">oneByteReader</span><span class="op" id="5850518">{</span><span class="ident" id="5850519">r</span><span class="op" id="5850520">}</span>&nbsp;<span class="op" id="5850522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850525">type</span>&nbsp;<span class="ident" id="5850530">oneByteReader</span>&nbsp;<span class="keyword" id="5850544">struct</span>&nbsp;<span class="op" id="5850551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850554">r</span>&nbsp;<span class="ident" id="5850556">io</span><span class="op" id="5850558">.</span><span class="ident" id="5850559">Reader</span><br>
<span class="lineno"></span><span class="op" id="5850566">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5850569">func</span>&nbsp;<span class="op" id="5850574">(</span><span class="ident" id="5850575">r</span>&nbsp;<span class="op" id="5850577">*</span><span class="ident" id="5850578">oneByteReader</span><span class="op" id="5850591">)</span>&nbsp;<span class="ident" id="5850593">Read</span><span class="op" id="5850597">(</span><span class="ident" id="5850598">p</span>&nbsp;<span class="op" id="5850600">[</span><span class="op" id="5850601">]</span><span class="builtintype" id="5850602">byte</span><span class="op" id="5850606">)</span>&nbsp;<span class="op" id="5850608">(</span><span class="builtintype" id="5850609">int</span><span class="op" id="5850612">,</span>&nbsp;<span class="builtintype" id="5850614">error</span><span class="op" id="5850619">)</span>&nbsp;<span class="op" id="5850621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850624">if</span>&nbsp;<span class="builtinfunc" id="5850627">len</span><span class="op" id="5850630">(</span><span class="ident" id="5850631">p</span><span class="op" id="5850632">)</span>&nbsp;<span class="op" id="5850634">==</span>&nbsp;<span class="num" id="5850637">0</span>&nbsp;<span class="op" id="5850639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850643">return</span>&nbsp;<span class="num" id="5850650">0</span><span class="op" id="5850651">,</span>&nbsp;<span class="ident" id="5850653">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850658">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850661">return</span>&nbsp;<span class="ident" id="5850668">r</span><span class="op" id="5850669">.</span><span class="ident" id="5850670">r</span><span class="op" id="5850671">.</span><span class="ident" id="5850672">Read</span><span class="op" id="5850676">(</span><span class="ident" id="5850677">p</span><span class="op" id="5850678">[</span><span class="num" id="5850679">0</span><span class="op" id="5850680">:</span><span class="num" id="5850681">1</span><span class="op" id="5850682">]</span><span class="op" id="5850683">)</span><br>
<span class="lineno"></span><span class="op" id="5850685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5850688">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5850740">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5850791">func</span>&nbsp;<span class="ident" id="5850796">HalfReader</span><span class="op" id="5850806">(</span><span class="ident" id="5850807">r</span>&nbsp;<span class="ident" id="5850809">io</span><span class="op" id="5850811">.</span><span class="ident" id="5850812">Reader</span><span class="op" id="5850818">)</span>&nbsp;<span class="ident" id="5850820">io</span><span class="op" id="5850822">.</span><span class="ident" id="5850823">Reader</span>&nbsp;<span class="op" id="5850830">{</span>&nbsp;<span class="keyword" id="5850832">return</span>&nbsp;<span class="op" id="5850839">&amp;</span><span class="ident" id="5850840">halfReader</span><span class="op" id="5850850">{</span><span class="ident" id="5850851">r</span><span class="op" id="5850852">}</span>&nbsp;<span class="op" id="5850854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850857">type</span>&nbsp;<span class="ident" id="5850862">halfReader</span>&nbsp;<span class="keyword" id="5850873">struct</span>&nbsp;<span class="op" id="5850880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850883">r</span>&nbsp;<span class="ident" id="5850885">io</span><span class="op" id="5850887">.</span><span class="ident" id="5850888">Reader</span><br>
<span class="lineno"></span><span class="op" id="5850895">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5850898">func</span>&nbsp;<span class="op" id="5850903">(</span><span class="ident" id="5850904">r</span>&nbsp;<span class="op" id="5850906">*</span><span class="ident" id="5850907">halfReader</span><span class="op" id="5850917">)</span>&nbsp;<span class="ident" id="5850919">Read</span><span class="op" id="5850923">(</span><span class="ident" id="5850924">p</span>&nbsp;<span class="op" id="5850926">[</span><span class="op" id="5850927">]</span><span class="builtintype" id="5850928">byte</span><span class="op" id="5850932">)</span>&nbsp;<span class="op" id="5850934">(</span><span class="builtintype" id="5850935">int</span><span class="op" id="5850938">,</span>&nbsp;<span class="builtintype" id="5850940">error</span><span class="op" id="5850945">)</span>&nbsp;<span class="op" id="5850947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850950">return</span>&nbsp;<span class="ident" id="5850957">r</span><span class="op" id="5850958">.</span><span class="ident" id="5850959">r</span><span class="op" id="5850960">.</span><span class="ident" id="5850961">Read</span><span class="op" id="5850965">(</span><span class="ident" id="5850966">p</span><span class="op" id="5850967">[</span><span class="num" id="5850968">0</span>&nbsp;<span class="op" id="5850970">:</span>&nbsp;<span class="op" id="5850972">(</span><span class="builtinfunc" id="5850973">len</span><span class="op" id="5850976">(</span><span class="ident" id="5850977">p</span><span class="op" id="5850978">)</span><span class="op" id="5850979">+</span><span class="num" id="5850980">1</span><span class="op" id="5850981">)</span><span class="op" id="5850982">/</span><span class="num" id="5850983">2</span><span class="op" id="5850984">]</span><span class="op" id="5850985">)</span><br>
<span class="lineno"></span><span class="op" id="5850987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5850990">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5851067">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5851145">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5851221">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5851299">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5851345">func</span>&nbsp;<span class="ident" id="5851350">DataErrReader</span><span class="op" id="5851363">(</span><span class="ident" id="5851364">r</span>&nbsp;<span class="ident" id="5851366">io</span><span class="op" id="5851368">.</span><span class="ident" id="5851369">Reader</span><span class="op" id="5851375">)</span>&nbsp;<span class="ident" id="5851377">io</span><span class="op" id="5851379">.</span><span class="ident" id="5851380">Reader</span>&nbsp;<span class="op" id="5851387">{</span>&nbsp;<span class="keyword" id="5851389">return</span>&nbsp;<span class="op" id="5851396">&amp;</span><span class="ident" id="5851397">dataErrReader</span><span class="op" id="5851410">{</span><span class="ident" id="5851411">r</span><span class="op" id="5851412">,</span>&nbsp;<span class="ident" id="5851414">nil</span><span class="op" id="5851417">,</span>&nbsp;<span class="builtinfunc" id="5851419">make</span><span class="op" id="5851423">(</span><span class="op" id="5851424">[</span><span class="op" id="5851425">]</span><span class="builtintype" id="5851426">byte</span><span class="op" id="5851430">,</span>&nbsp;<span class="num" id="5851432">1024</span><span class="op" id="5851436">)</span><span class="op" id="5851437">}</span>&nbsp;<span class="op" id="5851439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5851442">type</span>&nbsp;<span class="ident" id="5851447">dataErrReader</span>&nbsp;<span class="keyword" id="5851461">struct</span>&nbsp;<span class="op" id="5851468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851471">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5851478">io</span><span class="op" id="5851480">.</span><span class="ident" id="5851481">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851489">unread</span>&nbsp;<span class="op" id="5851496">[</span><span class="op" id="5851497">]</span><span class="builtintype" id="5851498">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851504">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5851511">[</span><span class="op" id="5851512">]</span><span class="builtintype" id="5851513">byte</span><br>
<span class="lineno"></span><span class="op" id="5851518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5851521">func</span>&nbsp;<span class="op" id="5851526">(</span><span class="ident" id="5851527">r</span>&nbsp;<span class="op" id="5851529">*</span><span class="ident" id="5851530">dataErrReader</span><span class="op" id="5851543">)</span>&nbsp;<span class="ident" id="5851545">Read</span><span class="op" id="5851549">(</span><span class="ident" id="5851550">p</span>&nbsp;<span class="op" id="5851552">[</span><span class="op" id="5851553">]</span><span class="builtintype" id="5851554">byte</span><span class="op" id="5851558">)</span>&nbsp;<span class="op" id="5851560">(</span><span class="ident" id="5851561">n</span>&nbsp;<span class="builtintype" id="5851563">int</span><span class="op" id="5851566">,</span>&nbsp;<span class="ident" id="5851568">err</span>&nbsp;<span class="builtintype" id="5851572">error</span><span class="op" id="5851577">)</span>&nbsp;<span class="op" id="5851579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851582">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851627">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851682">for</span>&nbsp;<span class="op" id="5851686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851690">if</span>&nbsp;<span class="builtinfunc" id="5851693">len</span><span class="op" id="5851696">(</span><span class="ident" id="5851697">r</span><span class="op" id="5851698">.</span><span class="ident" id="5851699">unread</span><span class="op" id="5851705">)</span>&nbsp;<span class="op" id="5851707">==</span>&nbsp;<span class="num" id="5851710">0</span>&nbsp;<span class="op" id="5851712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851717">n1</span><span class="op" id="5851719">,</span>&nbsp;<span class="ident" id="5851721">err1</span>&nbsp;<span class="op" id="5851726">:=</span>&nbsp;<span class="ident" id="5851729">r</span><span class="op" id="5851730">.</span><span class="ident" id="5851731">r</span><span class="op" id="5851732">.</span><span class="ident" id="5851733">Read</span><span class="op" id="5851737">(</span><span class="ident" id="5851738">r</span><span class="op" id="5851739">.</span><span class="ident" id="5851740">data</span><span class="op" id="5851744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851749">r</span><span class="op" id="5851750">.</span><span class="ident" id="5851751">unread</span>&nbsp;<span class="op" id="5851758">=</span>&nbsp;<span class="ident" id="5851760">r</span><span class="op" id="5851761">.</span><span class="ident" id="5851762">data</span><span class="op" id="5851766">[</span><span class="num" id="5851767">0</span><span class="op" id="5851768">:</span><span class="ident" id="5851769">n1</span><span class="op" id="5851771">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851776">err</span>&nbsp;<span class="op" id="5851780">=</span>&nbsp;<span class="ident" id="5851782">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851793">if</span>&nbsp;<span class="ident" id="5851796">n</span>&nbsp;<span class="op" id="5851798">&gt;</span>&nbsp;<span class="num" id="5851800">0</span>&nbsp;<span class="op" id="5851802">||</span>&nbsp;<span class="ident" id="5851805">err</span>&nbsp;<span class="op" id="5851809">!=</span>&nbsp;<span class="ident" id="5851812">nil</span>&nbsp;<span class="op" id="5851816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851821">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851829">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851833">n</span>&nbsp;<span class="op" id="5851835">=</span>&nbsp;<span class="builtinfunc" id="5851837">copy</span><span class="op" id="5851841">(</span><span class="ident" id="5851842">p</span><span class="op" id="5851843">,</span>&nbsp;<span class="ident" id="5851845">r</span><span class="op" id="5851846">.</span><span class="ident" id="5851847">unread</span><span class="op" id="5851853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851857">r</span><span class="op" id="5851858">.</span><span class="ident" id="5851859">unread</span>&nbsp;<span class="op" id="5851866">=</span>&nbsp;<span class="ident" id="5851868">r</span><span class="op" id="5851869">.</span><span class="ident" id="5851870">unread</span><span class="op" id="5851876">[</span><span class="ident" id="5851877">n</span><span class="op" id="5851878">:</span><span class="op" id="5851879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851885">return</span><br>
<span class="lineno"></span><span class="op" id="5851892">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5851895">var</span>&nbsp;<span class="ident" id="5851899">ErrTimeout</span>&nbsp;<span class="op" id="5851910">=</span>&nbsp;<span class="ident" id="5851912">errors</span><span class="op" id="5851918">.</span><span class="ident" id="5851919">New</span><span class="op" id="5851922">(</span><span class="string" id="5851923">&#34;timeout&#34;</span><span class="op" id="5851932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5851935">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5851990">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5852042">func</span>&nbsp;<span class="ident" id="5852047">TimeoutReader</span><span class="op" id="5852060">(</span><span class="ident" id="5852061">r</span>&nbsp;<span class="ident" id="5852063">io</span><span class="op" id="5852065">.</span><span class="ident" id="5852066">Reader</span><span class="op" id="5852072">)</span>&nbsp;<span class="ident" id="5852074">io</span><span class="op" id="5852076">.</span><span class="ident" id="5852077">Reader</span>&nbsp;<span class="op" id="5852084">{</span>&nbsp;<span class="keyword" id="5852086">return</span>&nbsp;<span class="op" id="5852093">&amp;</span><span class="ident" id="5852094">timeoutReader</span><span class="op" id="5852107">{</span><span class="ident" id="5852108">r</span><span class="op" id="5852109">,</span>&nbsp;<span class="num" id="5852111">0</span><span class="op" id="5852112">}</span>&nbsp;<span class="op" id="5852114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5852117">type</span>&nbsp;<span class="ident" id="5852122">timeoutReader</span>&nbsp;<span class="keyword" id="5852136">struct</span>&nbsp;<span class="op" id="5852143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852146">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5852152">io</span><span class="op" id="5852154">.</span><span class="ident" id="5852155">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852163">count</span>&nbsp;<span class="builtintype" id="5852169">int</span><br>
<span class="lineno">80</span><span class="op" id="5852173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5852176">func</span>&nbsp;<span class="op" id="5852181">(</span><span class="ident" id="5852182">r</span>&nbsp;<span class="op" id="5852184">*</span><span class="ident" id="5852185">timeoutReader</span><span class="op" id="5852198">)</span>&nbsp;<span class="ident" id="5852200">Read</span><span class="op" id="5852204">(</span><span class="ident" id="5852205">p</span>&nbsp;<span class="op" id="5852207">[</span><span class="op" id="5852208">]</span><span class="builtintype" id="5852209">byte</span><span class="op" id="5852213">)</span>&nbsp;<span class="op" id="5852215">(</span><span class="builtintype" id="5852216">int</span><span class="op" id="5852219">,</span>&nbsp;<span class="builtintype" id="5852221">error</span><span class="op" id="5852226">)</span>&nbsp;<span class="op" id="5852228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852231">r</span><span class="op" id="5852232">.</span><span class="ident" id="5852233">count</span><span class="op" id="5852238">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852242">if</span>&nbsp;<span class="ident" id="5852245">r</span><span class="op" id="5852246">.</span><span class="ident" id="5852247">count</span>&nbsp;<span class="op" id="5852253">==</span>&nbsp;<span class="num" id="5852256">2</span>&nbsp;<span class="op" id="5852258">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852262">return</span>&nbsp;<span class="num" id="5852269">0</span><span class="op" id="5852270">,</span>&nbsp;<span class="ident" id="5852272">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852287">return</span>&nbsp;<span class="ident" id="5852294">r</span><span class="op" id="5852295">.</span><span class="ident" id="5852296">r</span><span class="op" id="5852297">.</span><span class="ident" id="5852298">Read</span><span class="op" id="5852302">(</span><span class="ident" id="5852303">p</span><span class="op" id="5852304">)</span><br>
<span class="lineno"></span><span class="op" id="5852306">}</span>
</div>
</body>
</html>
