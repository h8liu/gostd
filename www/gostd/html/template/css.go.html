<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2809152">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2809207">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2809261">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2809312">package</span>&nbsp;<span class="ident" id="2809320">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2809330">import</span>&nbsp;<span class="op" id="2809337">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2809340">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2809349">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2809356">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2809367">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2809382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2809385">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="2809449">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="2809498">func</span>&nbsp;<span class="ident" id="2809503">endsWithCSSKeyword</span><span class="op" id="2809521">(</span><span class="ident" id="2809522">b</span>&nbsp;<span class="op" id="2809524">[</span><span class="op" id="2809525">]</span><span class="builtintype" id="2809526">byte</span><span class="op" id="2809530">,</span>&nbsp;<span class="ident" id="2809532">kw</span>&nbsp;<span class="builtintype" id="2809535">string</span><span class="op" id="2809541">)</span>&nbsp;<span class="builtintype" id="2809543">bool</span>&nbsp;<span class="op" id="2809548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809551">i</span>&nbsp;<span class="op" id="2809553">:=</span>&nbsp;<span class="builtinfunc" id="2809556">len</span><span class="op" id="2809559">(</span><span class="ident" id="2809560">b</span><span class="op" id="2809561">)</span>&nbsp;<span class="op" id="2809563">-</span>&nbsp;<span class="builtinfunc" id="2809565">len</span><span class="op" id="2809568">(</span><span class="ident" id="2809569">kw</span><span class="op" id="2809571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809574">if</span>&nbsp;<span class="ident" id="2809577">i</span>&nbsp;<span class="op" id="2809579">&lt;</span>&nbsp;<span class="num" id="2809581">0</span>&nbsp;<span class="op" id="2809583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809587">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809603">return</span>&nbsp;<span class="builtintype" id="2809610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809620">if</span>&nbsp;<span class="ident" id="2809623">i</span>&nbsp;<span class="op" id="2809625">!=</span>&nbsp;<span class="num" id="2809628">0</span>&nbsp;<span class="op" id="2809630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2809634">r</span><span class="op" id="2809635">,</span>&nbsp;<span class="ident" id="2809637">_</span>&nbsp;<span class="op" id="2809639">:=</span>&nbsp;<span class="ident" id="2809642">utf8</span><span class="op" id="2809646">.</span><span class="ident" id="2809647">DecodeLastRune</span><span class="op" id="2809661">(</span><span class="ident" id="2809662">b</span><span class="op" id="2809663">[</span><span class="op" id="2809664">:</span><span class="ident" id="2809665">i</span><span class="op" id="2809666">]</span><span class="op" id="2809667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809671">if</span>&nbsp;<span class="ident" id="2809674">isCSSNmchar</span><span class="op" id="2809685">(</span><span class="ident" id="2809686">r</span><span class="op" id="2809687">)</span>&nbsp;<span class="op" id="2809689">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809694">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809710">return</span>&nbsp;<span class="builtintype" id="2809717">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809731">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809804">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809864">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809910">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2809980">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810031">return</span>&nbsp;<span class="builtintype" id="2810038">string</span><span class="op" id="2810044">(</span><span class="ident" id="2810045">bytes</span><span class="op" id="2810050">.</span><span class="ident" id="2810051">ToLower</span><span class="op" id="2810058">(</span><span class="ident" id="2810059">b</span><span class="op" id="2810060">[</span><span class="ident" id="2810061">i</span><span class="op" id="2810062">:</span><span class="op" id="2810063">]</span><span class="op" id="2810064">)</span><span class="op" id="2810065">)</span>&nbsp;<span class="op" id="2810067">==</span>&nbsp;<span class="ident" id="2810070">kw</span><br>
<span class="lineno">35</span><span class="op" id="2810073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2810076">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="2810153">func</span>&nbsp;<span class="ident" id="2810158">isCSSNmchar</span><span class="op" id="2810169">(</span><span class="ident" id="2810170">r</span>&nbsp;<span class="builtintype" id="2810172">rune</span><span class="op" id="2810176">)</span>&nbsp;<span class="builtintype" id="2810178">bool</span>&nbsp;<span class="op" id="2810183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810186">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810256">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810271">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810323">return</span>&nbsp;<span class="string" id="2810330">&#39;a&#39;</span>&nbsp;<span class="op" id="2810334">&lt;=</span>&nbsp;<span class="ident" id="2810337">r</span>&nbsp;<span class="op" id="2810339">&amp;&amp;</span>&nbsp;<span class="ident" id="2810342">r</span>&nbsp;<span class="op" id="2810344">&lt;=</span>&nbsp;<span class="string" id="2810347">&#39;z&#39;</span>&nbsp;<span class="op" id="2810351">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2810356">&#39;A&#39;</span>&nbsp;<span class="op" id="2810360">&lt;=</span>&nbsp;<span class="ident" id="2810363">r</span>&nbsp;<span class="op" id="2810365">&amp;&amp;</span>&nbsp;<span class="ident" id="2810368">r</span>&nbsp;<span class="op" id="2810370">&lt;=</span>&nbsp;<span class="string" id="2810373">&#39;Z&#39;</span>&nbsp;<span class="op" id="2810377">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2810382">&#39;0&#39;</span>&nbsp;<span class="op" id="2810386">&lt;=</span>&nbsp;<span class="ident" id="2810389">r</span>&nbsp;<span class="op" id="2810391">&amp;&amp;</span>&nbsp;<span class="ident" id="2810394">r</span>&nbsp;<span class="op" id="2810396">&lt;=</span>&nbsp;<span class="string" id="2810399">&#39;9&#39;</span>&nbsp;<span class="op" id="2810403">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810408">r</span>&nbsp;<span class="op" id="2810410">==</span>&nbsp;<span class="string" id="2810413">&#39;-&#39;</span>&nbsp;<span class="op" id="2810417">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810422">r</span>&nbsp;<span class="op" id="2810424">==</span>&nbsp;<span class="string" id="2810427">&#39;_&#39;</span>&nbsp;<span class="op" id="2810431">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810436">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2810464">0x80</span>&nbsp;<span class="op" id="2810469">&lt;=</span>&nbsp;<span class="ident" id="2810472">r</span>&nbsp;<span class="op" id="2810474">&amp;&amp;</span>&nbsp;<span class="ident" id="2810477">r</span>&nbsp;<span class="op" id="2810479">&lt;=</span>&nbsp;<span class="num" id="2810482">0xd7ff</span>&nbsp;<span class="op" id="2810489">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2810494">0xe000</span>&nbsp;<span class="op" id="2810501">&lt;=</span>&nbsp;<span class="ident" id="2810504">r</span>&nbsp;<span class="op" id="2810506">&amp;&amp;</span>&nbsp;<span class="ident" id="2810509">r</span>&nbsp;<span class="op" id="2810511">&lt;=</span>&nbsp;<span class="num" id="2810514">0xfffd</span>&nbsp;<span class="op" id="2810521">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2810526">0x10000</span>&nbsp;<span class="op" id="2810534">&lt;=</span>&nbsp;<span class="ident" id="2810537">r</span>&nbsp;<span class="op" id="2810539">&amp;&amp;</span>&nbsp;<span class="ident" id="2810542">r</span>&nbsp;<span class="op" id="2810544">&lt;=</span>&nbsp;<span class="num" id="2810547">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="2810556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2810559">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="2810626">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="2810703">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="2810729">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="2810804">func</span>&nbsp;<span class="ident" id="2810809">decodeCSS</span><span class="op" id="2810818">(</span><span class="ident" id="2810819">s</span>&nbsp;<span class="op" id="2810821">[</span><span class="op" id="2810822">]</span><span class="builtintype" id="2810823">byte</span><span class="op" id="2810827">)</span>&nbsp;<span class="op" id="2810829">[</span><span class="op" id="2810830">]</span><span class="builtintype" id="2810831">byte</span>&nbsp;<span class="op" id="2810836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2810839">i</span>&nbsp;<span class="op" id="2810841">:=</span>&nbsp;<span class="ident" id="2810844">bytes</span><span class="op" id="2810849">.</span><span class="ident" id="2810850">IndexByte</span><span class="op" id="2810859">(</span><span class="ident" id="2810860">s</span><span class="op" id="2810861">,</span>&nbsp;<span class="string" id="2810863">&#39;\\&#39;</span><span class="op" id="2810867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810870">if</span>&nbsp;<span class="ident" id="2810873">i</span>&nbsp;<span class="op" id="2810875">==</span>&nbsp;<span class="op" id="2810878">-</span><span class="num" id="2810879">1</span>&nbsp;<span class="op" id="2810881">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2810885">return</span>&nbsp;<span class="ident" id="2810892">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2810895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810898">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2810966">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811038">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811076">b</span>&nbsp;<span class="op" id="2811078">:=</span>&nbsp;<span class="builtinfunc" id="2811081">make</span><span class="op" id="2811085">(</span><span class="op" id="2811086">[</span><span class="op" id="2811087">]</span><span class="builtintype" id="2811088">byte</span><span class="op" id="2811092">,</span>&nbsp;<span class="num" id="2811094">0</span><span class="op" id="2811095">,</span>&nbsp;<span class="builtinfunc" id="2811097">len</span><span class="op" id="2811100">(</span><span class="ident" id="2811101">s</span><span class="op" id="2811102">)</span><span class="op" id="2811103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811106">for</span>&nbsp;<span class="builtinfunc" id="2811110">len</span><span class="op" id="2811113">(</span><span class="ident" id="2811114">s</span><span class="op" id="2811115">)</span>&nbsp;<span class="op" id="2811117">!=</span>&nbsp;<span class="num" id="2811120">0</span>&nbsp;<span class="op" id="2811122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811126">i</span>&nbsp;<span class="op" id="2811128">:=</span>&nbsp;<span class="ident" id="2811131">bytes</span><span class="op" id="2811136">.</span><span class="ident" id="2811137">IndexByte</span><span class="op" id="2811146">(</span><span class="ident" id="2811147">s</span><span class="op" id="2811148">,</span>&nbsp;<span class="string" id="2811150">&#39;\\&#39;</span><span class="op" id="2811154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811158">if</span>&nbsp;<span class="ident" id="2811161">i</span>&nbsp;<span class="op" id="2811163">==</span>&nbsp;<span class="op" id="2811166">-</span><span class="num" id="2811167">1</span>&nbsp;<span class="op" id="2811169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811174">i</span>&nbsp;<span class="op" id="2811176">=</span>&nbsp;<span class="builtinfunc" id="2811178">len</span><span class="op" id="2811181">(</span><span class="ident" id="2811182">s</span><span class="op" id="2811183">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811191">b</span><span class="op" id="2811192">,</span>&nbsp;<span class="ident" id="2811194">s</span>&nbsp;<span class="op" id="2811196">=</span>&nbsp;<span class="builtinfunc" id="2811198">append</span><span class="op" id="2811204">(</span><span class="ident" id="2811205">b</span><span class="op" id="2811206">,</span>&nbsp;<span class="ident" id="2811208">s</span><span class="op" id="2811209">[</span><span class="op" id="2811210">:</span><span class="ident" id="2811211">i</span><span class="op" id="2811212">]</span><span class="op" id="2811213">...</span><span class="op" id="2811216">)</span><span class="op" id="2811217">,</span>&nbsp;<span class="ident" id="2811219">s</span><span class="op" id="2811220">[</span><span class="ident" id="2811221">i</span><span class="op" id="2811222">:</span><span class="op" id="2811223">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811227">if</span>&nbsp;<span class="builtinfunc" id="2811230">len</span><span class="op" id="2811233">(</span><span class="ident" id="2811234">s</span><span class="op" id="2811235">)</span>&nbsp;<span class="op" id="2811237">&lt;</span>&nbsp;<span class="num" id="2811239">2</span>&nbsp;<span class="op" id="2811241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811246">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811254">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811258">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811311">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811393">if</span>&nbsp;<span class="ident" id="2811396">isHex</span><span class="op" id="2811401">(</span><span class="ident" id="2811402">s</span><span class="op" id="2811403">[</span><span class="num" id="2811404">1</span><span class="op" id="2811405">]</span><span class="op" id="2811406">)</span>&nbsp;<span class="op" id="2811408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811413">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811468">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811513">j</span>&nbsp;<span class="op" id="2811515">:=</span>&nbsp;<span class="num" id="2811518">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811523">for</span>&nbsp;<span class="ident" id="2811527">j</span>&nbsp;<span class="op" id="2811529">&lt;</span>&nbsp;<span class="builtinfunc" id="2811531">len</span><span class="op" id="2811534">(</span><span class="ident" id="2811535">s</span><span class="op" id="2811536">)</span>&nbsp;<span class="op" id="2811538">&amp;&amp;</span>&nbsp;<span class="ident" id="2811541">j</span>&nbsp;<span class="op" id="2811543">&lt;</span>&nbsp;<span class="num" id="2811545">7</span>&nbsp;<span class="op" id="2811547">&amp;&amp;</span>&nbsp;<span class="ident" id="2811550">isHex</span><span class="op" id="2811555">(</span><span class="ident" id="2811556">s</span><span class="op" id="2811557">[</span><span class="ident" id="2811558">j</span><span class="op" id="2811559">]</span><span class="op" id="2811560">)</span>&nbsp;<span class="op" id="2811562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811568">j</span><span class="op" id="2811569">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811580">r</span>&nbsp;<span class="op" id="2811582">:=</span>&nbsp;<span class="ident" id="2811585">hexDecode</span><span class="op" id="2811594">(</span><span class="ident" id="2811595">s</span><span class="op" id="2811596">[</span><span class="num" id="2811597">1</span><span class="op" id="2811598">:</span><span class="ident" id="2811599">j</span><span class="op" id="2811600">]</span><span class="op" id="2811601">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2811606">if</span>&nbsp;<span class="ident" id="2811609">r</span>&nbsp;<span class="op" id="2811611">&gt;</span>&nbsp;<span class="ident" id="2811613">unicode</span><span class="op" id="2811620">.</span><span class="ident" id="2811621">MaxRune</span>&nbsp;<span class="op" id="2811629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811635">r</span><span class="op" id="2811636">,</span>&nbsp;<span class="ident" id="2811638">j</span>&nbsp;<span class="op" id="2811640">=</span>&nbsp;<span class="ident" id="2811642">r</span><span class="op" id="2811643">/</span><span class="num" id="2811644">16</span><span class="op" id="2811646">,</span>&nbsp;<span class="ident" id="2811648">j</span><span class="op" id="2811649">-</span><span class="num" id="2811650">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811660">n</span>&nbsp;<span class="op" id="2811662">:=</span>&nbsp;<span class="ident" id="2811665">utf8</span><span class="op" id="2811669">.</span><span class="ident" id="2811670">EncodeRune</span><span class="op" id="2811680">(</span><span class="ident" id="2811681">b</span><span class="op" id="2811682">[</span><span class="builtinfunc" id="2811683">len</span><span class="op" id="2811686">(</span><span class="ident" id="2811687">b</span><span class="op" id="2811688">)</span><span class="op" id="2811689">:</span><span class="builtinfunc" id="2811690">cap</span><span class="op" id="2811693">(</span><span class="ident" id="2811694">b</span><span class="op" id="2811695">)</span><span class="op" id="2811696">]</span><span class="op" id="2811697">,</span>&nbsp;<span class="ident" id="2811699">r</span><span class="op" id="2811700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811705">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811754">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811802">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811851">b</span><span class="op" id="2811852">,</span>&nbsp;<span class="ident" id="2811854">s</span>&nbsp;<span class="op" id="2811856">=</span>&nbsp;<span class="ident" id="2811858">b</span><span class="op" id="2811859">[</span><span class="op" id="2811860">:</span><span class="builtinfunc" id="2811861">len</span><span class="op" id="2811864">(</span><span class="ident" id="2811865">b</span><span class="op" id="2811866">)</span><span class="op" id="2811867">+</span><span class="ident" id="2811868">n</span><span class="op" id="2811869">]</span><span class="op" id="2811870">,</span>&nbsp;<span class="ident" id="2811872">skipCSSSpace</span><span class="op" id="2811884">(</span><span class="ident" id="2811885">s</span><span class="op" id="2811886">[</span><span class="ident" id="2811887">j</span><span class="op" id="2811888">:</span><span class="op" id="2811889">]</span><span class="op" id="2811890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2811894">}</span>&nbsp;<span class="keyword" id="2811896">else</span>&nbsp;<span class="op" id="2811901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2811906">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811949">_</span><span class="op" id="2811950">,</span>&nbsp;<span class="ident" id="2811952">n</span>&nbsp;<span class="op" id="2811954">:=</span>&nbsp;<span class="ident" id="2811957">utf8</span><span class="op" id="2811961">.</span><span class="ident" id="2811962">DecodeRune</span><span class="op" id="2811972">(</span><span class="ident" id="2811973">s</span><span class="op" id="2811974">[</span><span class="num" id="2811975">1</span><span class="op" id="2811976">:</span><span class="op" id="2811977">]</span><span class="op" id="2811978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2811983">b</span><span class="op" id="2811984">,</span>&nbsp;<span class="ident" id="2811986">s</span>&nbsp;<span class="op" id="2811988">=</span>&nbsp;<span class="builtinfunc" id="2811990">append</span><span class="op" id="2811996">(</span><span class="ident" id="2811997">b</span><span class="op" id="2811998">,</span>&nbsp;<span class="ident" id="2812000">s</span><span class="op" id="2812001">[</span><span class="num" id="2812002">1</span><span class="op" id="2812003">:</span><span class="num" id="2812004">1</span><span class="op" id="2812005">+</span><span class="ident" id="2812006">n</span><span class="op" id="2812007">]</span><span class="op" id="2812008">...</span><span class="op" id="2812011">)</span><span class="op" id="2812012">,</span>&nbsp;<span class="ident" id="2812014">s</span><span class="op" id="2812015">[</span><span class="num" id="2812016">1</span><span class="op" id="2812017">+</span><span class="ident" id="2812018">n</span><span class="op" id="2812019">:</span><span class="op" id="2812020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812030">return</span>&nbsp;<span class="ident" id="2812037">b</span><br>
<span class="lineno">100</span><span class="op" id="2812039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812042">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="2812103">func</span>&nbsp;<span class="ident" id="2812108">isHex</span><span class="op" id="2812113">(</span><span class="ident" id="2812114">c</span>&nbsp;<span class="builtintype" id="2812116">byte</span><span class="op" id="2812120">)</span>&nbsp;<span class="builtintype" id="2812122">bool</span>&nbsp;<span class="op" id="2812127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812130">return</span>&nbsp;<span class="string" id="2812137">&#39;0&#39;</span>&nbsp;<span class="op" id="2812141">&lt;=</span>&nbsp;<span class="ident" id="2812144">c</span>&nbsp;<span class="op" id="2812146">&amp;&amp;</span>&nbsp;<span class="ident" id="2812149">c</span>&nbsp;<span class="op" id="2812151">&lt;=</span>&nbsp;<span class="string" id="2812154">&#39;9&#39;</span>&nbsp;<span class="op" id="2812158">||</span>&nbsp;<span class="string" id="2812161">&#39;a&#39;</span>&nbsp;<span class="op" id="2812165">&lt;=</span>&nbsp;<span class="ident" id="2812168">c</span>&nbsp;<span class="op" id="2812170">&amp;&amp;</span>&nbsp;<span class="ident" id="2812173">c</span>&nbsp;<span class="op" id="2812175">&lt;=</span>&nbsp;<span class="string" id="2812178">&#39;f&#39;</span>&nbsp;<span class="op" id="2812182">||</span>&nbsp;<span class="string" id="2812185">&#39;A&#39;</span>&nbsp;<span class="op" id="2812189">&lt;=</span>&nbsp;<span class="ident" id="2812192">c</span>&nbsp;<span class="op" id="2812194">&amp;&amp;</span>&nbsp;<span class="ident" id="2812197">c</span>&nbsp;<span class="op" id="2812199">&lt;=</span>&nbsp;<span class="string" id="2812202">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="2812206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812209">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="2812270">func</span>&nbsp;<span class="ident" id="2812275">hexDecode</span><span class="op" id="2812284">(</span><span class="ident" id="2812285">s</span>&nbsp;<span class="op" id="2812287">[</span><span class="op" id="2812288">]</span><span class="builtintype" id="2812289">byte</span><span class="op" id="2812293">)</span>&nbsp;<span class="builtintype" id="2812295">rune</span>&nbsp;<span class="op" id="2812300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812303">n</span>&nbsp;<span class="op" id="2812305">:=</span>&nbsp;<span class="string" id="2812308">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812316">for</span>&nbsp;<span class="ident" id="2812320">_</span><span class="op" id="2812321">,</span>&nbsp;<span class="ident" id="2812323">c</span>&nbsp;<span class="op" id="2812325">:=</span>&nbsp;<span class="keyword" id="2812328">range</span>&nbsp;<span class="ident" id="2812334">s</span>&nbsp;<span class="op" id="2812336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812340">n</span>&nbsp;<span class="op" id="2812342">&lt;&lt;=</span>&nbsp;<span class="num" id="2812346">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812350">switch</span>&nbsp;<span class="op" id="2812357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812361">case</span>&nbsp;<span class="string" id="2812366">&#39;0&#39;</span>&nbsp;<span class="op" id="2812370">&lt;=</span>&nbsp;<span class="ident" id="2812373">c</span>&nbsp;<span class="op" id="2812375">&amp;&amp;</span>&nbsp;<span class="ident" id="2812378">c</span>&nbsp;<span class="op" id="2812380">&lt;=</span>&nbsp;<span class="string" id="2812383">&#39;9&#39;</span><span class="op" id="2812386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812391">n</span>&nbsp;<span class="op" id="2812393">|=</span>&nbsp;<span class="builtintype" id="2812396">rune</span><span class="op" id="2812400">(</span><span class="ident" id="2812401">c</span>&nbsp;<span class="op" id="2812403">-</span>&nbsp;<span class="string" id="2812405">&#39;0&#39;</span><span class="op" id="2812408">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812412">case</span>&nbsp;<span class="string" id="2812417">&#39;a&#39;</span>&nbsp;<span class="op" id="2812421">&lt;=</span>&nbsp;<span class="ident" id="2812424">c</span>&nbsp;<span class="op" id="2812426">&amp;&amp;</span>&nbsp;<span class="ident" id="2812429">c</span>&nbsp;<span class="op" id="2812431">&lt;=</span>&nbsp;<span class="string" id="2812434">&#39;f&#39;</span><span class="op" id="2812437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812442">n</span>&nbsp;<span class="op" id="2812444">|=</span>&nbsp;<span class="builtintype" id="2812447">rune</span><span class="op" id="2812451">(</span><span class="ident" id="2812452">c</span><span class="op" id="2812453">-</span><span class="string" id="2812454">&#39;a&#39;</span><span class="op" id="2812457">)</span>&nbsp;<span class="op" id="2812459">+</span>&nbsp;<span class="num" id="2812461">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812466">case</span>&nbsp;<span class="string" id="2812471">&#39;A&#39;</span>&nbsp;<span class="op" id="2812475">&lt;=</span>&nbsp;<span class="ident" id="2812478">c</span>&nbsp;<span class="op" id="2812480">&amp;&amp;</span>&nbsp;<span class="ident" id="2812483">c</span>&nbsp;<span class="op" id="2812485">&lt;=</span>&nbsp;<span class="string" id="2812488">&#39;F&#39;</span><span class="op" id="2812491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812496">n</span>&nbsp;<span class="op" id="2812498">|=</span>&nbsp;<span class="builtintype" id="2812501">rune</span><span class="op" id="2812505">(</span><span class="ident" id="2812506">c</span><span class="op" id="2812507">-</span><span class="string" id="2812508">&#39;A&#39;</span><span class="op" id="2812511">)</span>&nbsp;<span class="op" id="2812513">+</span>&nbsp;<span class="num" id="2812515">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812520">default</span><span class="op" id="2812527">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2812532">panic</span><span class="op" id="2812537">(</span><span class="ident" id="2812538">fmt</span><span class="op" id="2812541">.</span><span class="ident" id="2812542">Sprintf</span><span class="op" id="2812549">(</span><span class="string" id="2812550">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="2812571">,</span>&nbsp;<span class="ident" id="2812573">s</span><span class="op" id="2812574">)</span><span class="op" id="2812575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812585">return</span>&nbsp;<span class="ident" id="2812592">n</span><br>
<span class="lineno"></span><span class="op" id="2812594">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="2812597">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2812666">func</span>&nbsp;<span class="ident" id="2812671">skipCSSSpace</span><span class="op" id="2812683">(</span><span class="ident" id="2812684">c</span>&nbsp;<span class="op" id="2812686">[</span><span class="op" id="2812687">]</span><span class="builtintype" id="2812688">byte</span><span class="op" id="2812692">)</span>&nbsp;<span class="op" id="2812694">[</span><span class="op" id="2812695">]</span><span class="builtintype" id="2812696">byte</span>&nbsp;<span class="op" id="2812701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812704">if</span>&nbsp;<span class="builtinfunc" id="2812707">len</span><span class="op" id="2812710">(</span><span class="ident" id="2812711">c</span><span class="op" id="2812712">)</span>&nbsp;<span class="op" id="2812714">==</span>&nbsp;<span class="num" id="2812717">0</span>&nbsp;<span class="op" id="2812719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812723">return</span>&nbsp;<span class="ident" id="2812730">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2812733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812736">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812776">switch</span>&nbsp;<span class="ident" id="2812783">c</span><span class="op" id="2812784">[</span><span class="num" id="2812785">0</span><span class="op" id="2812786">]</span>&nbsp;<span class="op" id="2812788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812791">case</span>&nbsp;<span class="string" id="2812796">&#39;\t&#39;</span><span class="op" id="2812800">,</span>&nbsp;<span class="string" id="2812802">&#39;\n&#39;</span><span class="op" id="2812806">,</span>&nbsp;<span class="string" id="2812808">&#39;\f&#39;</span><span class="op" id="2812812">,</span>&nbsp;<span class="string" id="2812814">&#39;&nbsp;&#39;</span><span class="op" id="2812817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812821">return</span>&nbsp;<span class="ident" id="2812828">c</span><span class="op" id="2812829">[</span><span class="num" id="2812830">1</span><span class="op" id="2812831">:</span><span class="op" id="2812832">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2812835">case</span>&nbsp;<span class="string" id="2812840">&#39;\r&#39;</span><span class="op" id="2812844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812848">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812914">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812979">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813024">if</span>&nbsp;<span class="builtinfunc" id="2813027">len</span><span class="op" id="2813030">(</span><span class="ident" id="2813031">c</span><span class="op" id="2813032">)</span>&nbsp;<span class="op" id="2813034">&gt;=</span>&nbsp;<span class="num" id="2813037">2</span>&nbsp;<span class="op" id="2813039">&amp;&amp;</span>&nbsp;<span class="ident" id="2813042">c</span><span class="op" id="2813043">[</span><span class="num" id="2813044">1</span><span class="op" id="2813045">]</span>&nbsp;<span class="op" id="2813047">==</span>&nbsp;<span class="string" id="2813050">&#39;\n&#39;</span>&nbsp;<span class="op" id="2813055">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813060">return</span>&nbsp;<span class="ident" id="2813067">c</span><span class="op" id="2813068">[</span><span class="num" id="2813069">2</span><span class="op" id="2813070">:</span><span class="op" id="2813071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2813075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813079">return</span>&nbsp;<span class="ident" id="2813086">c</span><span class="op" id="2813087">[</span><span class="num" id="2813088">1</span><span class="op" id="2813089">:</span><span class="op" id="2813090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2813093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813096">return</span>&nbsp;<span class="ident" id="2813103">c</span><br>
<span class="lineno">145</span><span class="op" id="2813105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2813108">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="2813178">func</span>&nbsp;<span class="ident" id="2813183">isCSSSpace</span><span class="op" id="2813193">(</span><span class="ident" id="2813194">b</span>&nbsp;<span class="builtintype" id="2813196">byte</span><span class="op" id="2813200">)</span>&nbsp;<span class="builtintype" id="2813202">bool</span>&nbsp;<span class="op" id="2813207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813210">switch</span>&nbsp;<span class="ident" id="2813217">b</span>&nbsp;<span class="op" id="2813219">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813222">case</span>&nbsp;<span class="string" id="2813227">&#39;\t&#39;</span><span class="op" id="2813231">,</span>&nbsp;<span class="string" id="2813233">&#39;\n&#39;</span><span class="op" id="2813237">,</span>&nbsp;<span class="string" id="2813239">&#39;\f&#39;</span><span class="op" id="2813243">,</span>&nbsp;<span class="string" id="2813245">&#39;\r&#39;</span><span class="op" id="2813249">,</span>&nbsp;<span class="string" id="2813251">&#39;&nbsp;&#39;</span><span class="op" id="2813254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813258">return</span>&nbsp;<span class="builtintype" id="2813265">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2813271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813274">return</span>&nbsp;<span class="builtintype" id="2813281">false</span><br>
<span class="lineno"></span><span class="op" id="2813287">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2813290">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="2813367">func</span>&nbsp;<span class="ident" id="2813372">cssEscaper</span><span class="op" id="2813382">(</span><span class="ident" id="2813383">args</span>&nbsp;<span class="op" id="2813388">...</span><span class="keyword" id="2813391">interface</span><span class="op" id="2813400">{</span><span class="op" id="2813401">}</span><span class="op" id="2813402">)</span>&nbsp;<span class="builtintype" id="2813404">string</span>&nbsp;<span class="op" id="2813411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813414">s</span><span class="op" id="2813415">,</span>&nbsp;<span class="ident" id="2813417">_</span>&nbsp;<span class="op" id="2813419">:=</span>&nbsp;<span class="ident" id="2813422">stringify</span><span class="op" id="2813431">(</span><span class="ident" id="2813432">args</span><span class="op" id="2813436">...</span><span class="op" id="2813439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813442">var</span>&nbsp;<span class="ident" id="2813446">b</span>&nbsp;<span class="ident" id="2813448">bytes</span><span class="op" id="2813453">.</span><span class="ident" id="2813454">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813462">written</span>&nbsp;<span class="op" id="2813470">:=</span>&nbsp;<span class="num" id="2813473">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813476">for</span>&nbsp;<span class="ident" id="2813480">i</span><span class="op" id="2813481">,</span>&nbsp;<span class="ident" id="2813483">r</span>&nbsp;<span class="op" id="2813485">:=</span>&nbsp;<span class="keyword" id="2813488">range</span>&nbsp;<span class="ident" id="2813494">s</span>&nbsp;<span class="op" id="2813496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813500">var</span>&nbsp;<span class="ident" id="2813504">repl</span>&nbsp;<span class="builtintype" id="2813509">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813518">switch</span>&nbsp;<span class="ident" id="2813525">r</span>&nbsp;<span class="op" id="2813527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813531">case</span>&nbsp;<span class="num" id="2813536">0</span><span class="op" id="2813537">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813542">repl</span>&nbsp;<span class="op" id="2813547">=</span>&nbsp;<span class="string" id="2813549">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813556">case</span>&nbsp;<span class="string" id="2813561">&#39;\t&#39;</span><span class="op" id="2813565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813570">repl</span>&nbsp;<span class="op" id="2813575">=</span>&nbsp;<span class="string" id="2813577">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813584">case</span>&nbsp;<span class="string" id="2813589">&#39;\n&#39;</span><span class="op" id="2813593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813598">repl</span>&nbsp;<span class="op" id="2813603">=</span>&nbsp;<span class="string" id="2813605">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813612">case</span>&nbsp;<span class="string" id="2813617">&#39;\f&#39;</span><span class="op" id="2813621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813626">repl</span>&nbsp;<span class="op" id="2813631">=</span>&nbsp;<span class="string" id="2813633">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813640">case</span>&nbsp;<span class="string" id="2813645">&#39;\r&#39;</span><span class="op" id="2813649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813654">repl</span>&nbsp;<span class="op" id="2813659">=</span>&nbsp;<span class="string" id="2813661">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813668">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813731">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813781">case</span>&nbsp;<span class="string" id="2813786">&#39;&#34;&#39;</span><span class="op" id="2813789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813794">repl</span>&nbsp;<span class="op" id="2813799">=</span>&nbsp;<span class="string" id="2813801">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813809">case</span>&nbsp;<span class="string" id="2813814">&#39;&amp;&#39;</span><span class="op" id="2813817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813822">repl</span>&nbsp;<span class="op" id="2813827">=</span>&nbsp;<span class="string" id="2813829">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813837">case</span>&nbsp;<span class="string" id="2813842">&#39;\&#39;&#39;</span><span class="op" id="2813846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813851">repl</span>&nbsp;<span class="op" id="2813856">=</span>&nbsp;<span class="string" id="2813858">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813866">case</span>&nbsp;<span class="string" id="2813871">&#39;(&#39;</span><span class="op" id="2813874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813879">repl</span>&nbsp;<span class="op" id="2813884">=</span>&nbsp;<span class="string" id="2813886">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813894">case</span>&nbsp;<span class="string" id="2813899">&#39;)&#39;</span><span class="op" id="2813902">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813907">repl</span>&nbsp;<span class="op" id="2813912">=</span>&nbsp;<span class="string" id="2813914">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813922">case</span>&nbsp;<span class="string" id="2813927">&#39;+&#39;</span><span class="op" id="2813930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813935">repl</span>&nbsp;<span class="op" id="2813940">=</span>&nbsp;<span class="string" id="2813942">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813950">case</span>&nbsp;<span class="string" id="2813955">&#39;/&#39;</span><span class="op" id="2813958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813963">repl</span>&nbsp;<span class="op" id="2813968">=</span>&nbsp;<span class="string" id="2813970">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2813978">case</span>&nbsp;<span class="string" id="2813983">&#39;:&#39;</span><span class="op" id="2813986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813991">repl</span>&nbsp;<span class="op" id="2813996">=</span>&nbsp;<span class="string" id="2813998">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814006">case</span>&nbsp;<span class="string" id="2814011">&#39;;&#39;</span><span class="op" id="2814014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814019">repl</span>&nbsp;<span class="op" id="2814024">=</span>&nbsp;<span class="string" id="2814026">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814034">case</span>&nbsp;<span class="string" id="2814039">&#39;&lt;&#39;</span><span class="op" id="2814042">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814047">repl</span>&nbsp;<span class="op" id="2814052">=</span>&nbsp;<span class="string" id="2814054">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814062">case</span>&nbsp;<span class="string" id="2814067">&#39;&gt;&#39;</span><span class="op" id="2814070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814075">repl</span>&nbsp;<span class="op" id="2814080">=</span>&nbsp;<span class="string" id="2814082">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814090">case</span>&nbsp;<span class="string" id="2814095">&#39;\\&#39;</span><span class="op" id="2814099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814104">repl</span>&nbsp;<span class="op" id="2814109">=</span>&nbsp;<span class="string" id="2814111">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814118">case</span>&nbsp;<span class="string" id="2814123">&#39;{&#39;</span><span class="op" id="2814126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814131">repl</span>&nbsp;<span class="op" id="2814136">=</span>&nbsp;<span class="string" id="2814138">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814146">case</span>&nbsp;<span class="string" id="2814151">&#39;}&#39;</span><span class="op" id="2814154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814159">repl</span>&nbsp;<span class="op" id="2814164">=</span>&nbsp;<span class="string" id="2814166">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814174">default</span><span class="op" id="2814181">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814186">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814201">b</span><span class="op" id="2814202">.</span><span class="ident" id="2814203">WriteString</span><span class="op" id="2814214">(</span><span class="ident" id="2814215">s</span><span class="op" id="2814216">[</span><span class="ident" id="2814217">written</span><span class="op" id="2814224">:</span><span class="ident" id="2814225">i</span><span class="op" id="2814226">]</span><span class="op" id="2814227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814231">b</span><span class="op" id="2814232">.</span><span class="ident" id="2814233">WriteString</span><span class="op" id="2814244">(</span><span class="ident" id="2814245">repl</span><span class="op" id="2814249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814253">written</span>&nbsp;<span class="op" id="2814261">=</span>&nbsp;<span class="ident" id="2814263">i</span>&nbsp;<span class="op" id="2814265">+</span>&nbsp;<span class="ident" id="2814267">utf8</span><span class="op" id="2814271">.</span><span class="ident" id="2814272">RuneLen</span><span class="op" id="2814279">(</span><span class="ident" id="2814280">r</span><span class="op" id="2814281">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814285">if</span>&nbsp;<span class="ident" id="2814288">repl</span>&nbsp;<span class="op" id="2814293">!=</span>&nbsp;<span class="string" id="2814296">`\\`</span>&nbsp;<span class="op" id="2814301">&amp;&amp;</span>&nbsp;<span class="op" id="2814304">(</span><span class="ident" id="2814305">written</span>&nbsp;<span class="op" id="2814313">==</span>&nbsp;<span class="builtinfunc" id="2814316">len</span><span class="op" id="2814319">(</span><span class="ident" id="2814320">s</span><span class="op" id="2814321">)</span>&nbsp;<span class="op" id="2814323">||</span>&nbsp;<span class="ident" id="2814326">isHex</span><span class="op" id="2814331">(</span><span class="ident" id="2814332">s</span><span class="op" id="2814333">[</span><span class="ident" id="2814334">written</span><span class="op" id="2814341">]</span><span class="op" id="2814342">)</span>&nbsp;<span class="op" id="2814344">||</span>&nbsp;<span class="ident" id="2814347">isCSSSpace</span><span class="op" id="2814357">(</span><span class="ident" id="2814358">s</span><span class="op" id="2814359">[</span><span class="ident" id="2814360">written</span><span class="op" id="2814367">]</span><span class="op" id="2814368">)</span><span class="op" id="2814369">)</span>&nbsp;<span class="op" id="2814371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814376">b</span><span class="op" id="2814377">.</span><span class="ident" id="2814378">WriteByte</span><span class="op" id="2814387">(</span><span class="string" id="2814388">&#39;&nbsp;&#39;</span><span class="op" id="2814391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814401">if</span>&nbsp;<span class="ident" id="2814404">written</span>&nbsp;<span class="op" id="2814412">==</span>&nbsp;<span class="num" id="2814415">0</span>&nbsp;<span class="op" id="2814417">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814421">return</span>&nbsp;<span class="ident" id="2814428">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814434">b</span><span class="op" id="2814435">.</span><span class="ident" id="2814436">WriteString</span><span class="op" id="2814447">(</span><span class="ident" id="2814448">s</span><span class="op" id="2814449">[</span><span class="ident" id="2814450">written</span><span class="op" id="2814457">:</span><span class="op" id="2814458">]</span><span class="op" id="2814459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814462">return</span>&nbsp;<span class="ident" id="2814469">b</span><span class="op" id="2814470">.</span><span class="ident" id="2814471">String</span><span class="op" id="2814477">(</span><span class="op" id="2814478">)</span><br>
<span class="lineno"></span><span class="op" id="2814480">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="2814483">var</span>&nbsp;<span class="ident" id="2814487">expressionBytes</span>&nbsp;<span class="op" id="2814503">=</span>&nbsp;<span class="op" id="2814505">[</span><span class="op" id="2814506">]</span><span class="builtintype" id="2814507">byte</span><span class="op" id="2814511">(</span><span class="string" id="2814512">&#34;expression&#34;</span><span class="op" id="2814524">)</span><br>
<span class="lineno"></span><span class="keyword" id="2814526">var</span>&nbsp;<span class="ident" id="2814530">mozBindingBytes</span>&nbsp;<span class="op" id="2814546">=</span>&nbsp;<span class="op" id="2814548">[</span><span class="op" id="2814549">]</span><span class="builtintype" id="2814550">byte</span><span class="op" id="2814554">(</span><span class="string" id="2814555">&#34;mozbinding&#34;</span><span class="op" id="2814567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814570">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="2814644">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="2814723">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="2814762">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="2814839">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="2814883">func</span>&nbsp;<span class="ident" id="2814888">cssValueFilter</span><span class="op" id="2814902">(</span><span class="ident" id="2814903">args</span>&nbsp;<span class="op" id="2814908">...</span><span class="keyword" id="2814911">interface</span><span class="op" id="2814920">{</span><span class="op" id="2814921">}</span><span class="op" id="2814922">)</span>&nbsp;<span class="builtintype" id="2814924">string</span>&nbsp;<span class="op" id="2814931">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814934">s</span><span class="op" id="2814935">,</span>&nbsp;<span class="ident" id="2814937">t</span>&nbsp;<span class="op" id="2814939">:=</span>&nbsp;<span class="ident" id="2814942">stringify</span><span class="op" id="2814951">(</span><span class="ident" id="2814952">args</span><span class="op" id="2814956">...</span><span class="op" id="2814959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814962">if</span>&nbsp;<span class="ident" id="2814965">t</span>&nbsp;<span class="op" id="2814967">==</span>&nbsp;<span class="ident" id="2814970">contentTypeCSS</span>&nbsp;<span class="op" id="2814985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2814989">return</span>&nbsp;<span class="ident" id="2814996">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2814999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815002">b</span><span class="op" id="2815003">,</span>&nbsp;<span class="ident" id="2815005">id</span>&nbsp;<span class="op" id="2815008">:=</span>&nbsp;<span class="ident" id="2815011">decodeCSS</span><span class="op" id="2815020">(</span><span class="op" id="2815021">[</span><span class="op" id="2815022">]</span><span class="builtintype" id="2815023">byte</span><span class="op" id="2815027">(</span><span class="ident" id="2815028">s</span><span class="op" id="2815029">)</span><span class="op" id="2815030">)</span><span class="op" id="2815031">,</span>&nbsp;<span class="builtinfunc" id="2815033">make</span><span class="op" id="2815037">(</span><span class="op" id="2815038">[</span><span class="op" id="2815039">]</span><span class="builtintype" id="2815040">byte</span><span class="op" id="2815044">,</span>&nbsp;<span class="num" id="2815046">0</span><span class="op" id="2815047">,</span>&nbsp;<span class="num" id="2815049">64</span><span class="op" id="2815051">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815055">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815126">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815181">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815248">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815386">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815459">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815568">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815639">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815710">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815766">for</span>&nbsp;<span class="ident" id="2815770">i</span><span class="op" id="2815771">,</span>&nbsp;<span class="ident" id="2815773">c</span>&nbsp;<span class="op" id="2815775">:=</span>&nbsp;<span class="keyword" id="2815778">range</span>&nbsp;<span class="ident" id="2815784">b</span>&nbsp;<span class="op" id="2815786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815790">switch</span>&nbsp;<span class="ident" id="2815797">c</span>&nbsp;<span class="op" id="2815799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815803">case</span>&nbsp;<span class="num" id="2815808">0</span><span class="op" id="2815809">,</span>&nbsp;<span class="string" id="2815811">&#39;&#34;&#39;</span><span class="op" id="2815814">,</span>&nbsp;<span class="string" id="2815816">&#39;\&#39;&#39;</span><span class="op" id="2815820">,</span>&nbsp;<span class="string" id="2815822">&#39;(&#39;</span><span class="op" id="2815825">,</span>&nbsp;<span class="string" id="2815827">&#39;)&#39;</span><span class="op" id="2815830">,</span>&nbsp;<span class="string" id="2815832">&#39;/&#39;</span><span class="op" id="2815835">,</span>&nbsp;<span class="string" id="2815837">&#39;;&#39;</span><span class="op" id="2815840">,</span>&nbsp;<span class="string" id="2815842">&#39;@&#39;</span><span class="op" id="2815845">,</span>&nbsp;<span class="string" id="2815847">&#39;[&#39;</span><span class="op" id="2815850">,</span>&nbsp;<span class="string" id="2815852">&#39;\\&#39;</span><span class="op" id="2815856">,</span>&nbsp;<span class="string" id="2815858">&#39;]&#39;</span><span class="op" id="2815861">,</span>&nbsp;<span class="string" id="2815863">&#39;`&#39;</span><span class="op" id="2815866">,</span>&nbsp;<span class="string" id="2815868">&#39;{&#39;</span><span class="op" id="2815871">,</span>&nbsp;<span class="string" id="2815873">&#39;}&#39;</span><span class="op" id="2815876">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815881">return</span>&nbsp;<span class="ident" id="2815888">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815905">case</span>&nbsp;<span class="string" id="2815910">&#39;-&#39;</span><span class="op" id="2815913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815918">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815946">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2815995">if</span>&nbsp;<span class="ident" id="2815998">i</span>&nbsp;<span class="op" id="2816000">!=</span>&nbsp;<span class="num" id="2816003">0</span>&nbsp;<span class="op" id="2816005">&amp;&amp;</span>&nbsp;<span class="ident" id="2816008">b</span><span class="op" id="2816009">[</span><span class="ident" id="2816010">i</span><span class="op" id="2816011">-</span><span class="num" id="2816012">1</span><span class="op" id="2816013">]</span>&nbsp;<span class="op" id="2816015">==</span>&nbsp;<span class="string" id="2816018">&#39;-&#39;</span>&nbsp;<span class="op" id="2816022">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816028">return</span>&nbsp;<span class="ident" id="2816035">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816057">default</span><span class="op" id="2816064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816069">if</span>&nbsp;<span class="ident" id="2816072">c</span>&nbsp;<span class="op" id="2816074">&lt;</span>&nbsp;<span class="num" id="2816076">0x80</span>&nbsp;<span class="op" id="2816081">&amp;&amp;</span>&nbsp;<span class="ident" id="2816084">isCSSNmchar</span><span class="op" id="2816095">(</span><span class="builtintype" id="2816096">rune</span><span class="op" id="2816100">(</span><span class="ident" id="2816101">c</span><span class="op" id="2816102">)</span><span class="op" id="2816103">)</span>&nbsp;<span class="op" id="2816105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816111">id</span>&nbsp;<span class="op" id="2816114">=</span>&nbsp;<span class="builtinfunc" id="2816116">append</span><span class="op" id="2816122">(</span><span class="ident" id="2816123">id</span><span class="op" id="2816125">,</span>&nbsp;<span class="ident" id="2816127">c</span><span class="op" id="2816128">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816143">id</span>&nbsp;<span class="op" id="2816146">=</span>&nbsp;<span class="ident" id="2816148">bytes</span><span class="op" id="2816153">.</span><span class="ident" id="2816154">ToLower</span><span class="op" id="2816161">(</span><span class="ident" id="2816162">id</span><span class="op" id="2816164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816167">if</span>&nbsp;<span class="ident" id="2816170">bytes</span><span class="op" id="2816175">.</span><span class="ident" id="2816176">Index</span><span class="op" id="2816181">(</span><span class="ident" id="2816182">id</span><span class="op" id="2816184">,</span>&nbsp;<span class="ident" id="2816186">expressionBytes</span><span class="op" id="2816201">)</span>&nbsp;<span class="op" id="2816203">!=</span>&nbsp;<span class="op" id="2816206">-</span><span class="num" id="2816207">1</span>&nbsp;<span class="op" id="2816209">||</span>&nbsp;<span class="ident" id="2816212">bytes</span><span class="op" id="2816217">.</span><span class="ident" id="2816218">Index</span><span class="op" id="2816223">(</span><span class="ident" id="2816224">id</span><span class="op" id="2816226">,</span>&nbsp;<span class="ident" id="2816228">mozBindingBytes</span><span class="op" id="2816243">)</span>&nbsp;<span class="op" id="2816245">!=</span>&nbsp;<span class="op" id="2816248">-</span><span class="num" id="2816249">1</span>&nbsp;<span class="op" id="2816251">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816255">return</span>&nbsp;<span class="ident" id="2816262">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2816278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2816281">return</span>&nbsp;<span class="builtintype" id="2816288">string</span><span class="op" id="2816294">(</span><span class="ident" id="2816295">b</span><span class="op" id="2816296">)</span><br>
<span class="lineno"></span><span class="op" id="2816298">}</span>
</div>
</body>
</html>
