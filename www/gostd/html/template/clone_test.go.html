<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html" class="current">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6894943">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6894998">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6895052">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6895103">package</span>&nbsp;<span class="ident" id="6895111">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6895121">import</span>&nbsp;<span class="op" id="6895128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6895131">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6895140">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6895150">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6895163">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6895174">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="6895196">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6895199">func</span>&nbsp;<span class="ident" id="6895204">TestAddParseTree</span><span class="op" id="6895220">(</span><span class="ident" id="6895221">t</span>&nbsp;<span class="op" id="6895223">*</span><span class="ident" id="6895224"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6895231">.</span><span class="ident" id="6895232"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6895233">)</span>&nbsp;<span class="op" id="6895235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895238">root</span>&nbsp;<span class="op" id="6895243">:=</span>&nbsp;<span class="ident" id="6895246"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6895250">(</span><span class="ident" id="6895251"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6895254">(</span><span class="string" id="6895255">&#34;root&#34;</span><span class="op" id="6895261">)</span><span class="op" id="6895262">.</span><span class="ident" id="6895263"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6895268">(</span><span class="string" id="6895269">`{{define&nbsp;&#34;a&#34;}}&nbsp;{{.}}&nbsp;{{template&nbsp;&#34;b&#34;}}&nbsp;{{.}}&nbsp;&#34;&gt;&lt;/a&gt;{{end}}`</span><span class="op" id="6895328">)</span><span class="op" id="6895329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895332">tree</span><span class="op" id="6895336">,</span>&nbsp;<span class="ident" id="6895338">err</span>&nbsp;<span class="op" id="6895342">:=</span>&nbsp;<span class="ident" id="6895345"><a href="/gostd/html/template/clone_test.go.html#6895174">parse</a></span><span class="op" id="6895350">.</span><span class="ident" id="6895351"><a href="/gostd/text/template/parse/parse.go.html#3182198">Parse</a></span><span class="op" id="6895356">(</span><span class="string" id="6895357">&#34;t&#34;</span><span class="op" id="6895360">,</span>&nbsp;<span class="string" id="6895362">`{{define&nbsp;&#34;b&#34;}}&lt;a&nbsp;href=&#34;{{end}}`</span><span class="op" id="6895394">,</span>&nbsp;<span class="string" id="6895396">&#34;&#34;</span><span class="op" id="6895398">,</span>&nbsp;<span class="string" id="6895400">&#34;&#34;</span><span class="op" id="6895402">,</span>&nbsp;<span class="builtintype" id="6895404">nil</span><span class="op" id="6895407">,</span>&nbsp;<span class="builtintype" id="6895409">nil</span><span class="op" id="6895412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6895415">if</span>&nbsp;<span class="ident" id="6895418"><a href="/gostd/html/template/clone_test.go.html#6895338">err</a></span>&nbsp;<span class="op" id="6895422">!=</span>&nbsp;<span class="builtintype" id="6895425">nil</span>&nbsp;<span class="op" id="6895429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895433"><a href="/gostd/html/template/clone_test.go.html#6895221">t</a></span><span class="op" id="6895434">.</span><span class="ident" id="6895435"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6895440">(</span><span class="ident" id="6895441"><a href="/gostd/html/template/clone_test.go.html#6895338">err</a></span><span class="op" id="6895444">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6895447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895450">added</span>&nbsp;<span class="op" id="6895456">:=</span>&nbsp;<span class="ident" id="6895459"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6895463">(</span><span class="ident" id="6895464"><a href="/gostd/html/template/clone_test.go.html#6895238">root</a></span><span class="op" id="6895468">.</span><span class="ident" id="6895469"><a href="/gostd/html/template/template.go.html#4951248">AddParseTree</a></span><span class="op" id="6895481">(</span><span class="string" id="6895482">&#34;b&#34;</span><span class="op" id="6895485">,</span>&nbsp;<span class="ident" id="6895487"><a href="/gostd/html/template/clone_test.go.html#6895332">tree</a></span><span class="op" id="6895491">[</span><span class="string" id="6895492">&#34;b&#34;</span><span class="op" id="6895495">]</span><span class="op" id="6895496">)</span><span class="op" id="6895497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895500">b</span>&nbsp;<span class="op" id="6895502">:=</span>&nbsp;<span class="builtinfunc" id="6895505">new</span><span class="op" id="6895508">(</span><span class="ident" id="6895509"><a href="/gostd/html/template/clone_test.go.html#6895131">bytes</a></span><span class="op" id="6895514">.</span><span class="ident" id="6895515"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="6895521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895524"><a href="/gostd/html/template/clone_test.go.html#6895338">err</a></span>&nbsp;<span class="op" id="6895528">=</span>&nbsp;<span class="ident" id="6895530"><a href="/gostd/html/template/clone_test.go.html#6895450">added</a></span><span class="op" id="6895535">.</span><span class="ident" id="6895536"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6895551">(</span><span class="ident" id="6895552"><a href="/gostd/html/template/clone_test.go.html#6895500">b</a></span><span class="op" id="6895553">,</span>&nbsp;<span class="string" id="6895555">&#34;a&#34;</span><span class="op" id="6895558">,</span>&nbsp;<span class="string" id="6895560">&#34;1&gt;0&#34;</span><span class="op" id="6895565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6895568">if</span>&nbsp;<span class="ident" id="6895571"><a href="/gostd/html/template/clone_test.go.html#6895338">err</a></span>&nbsp;<span class="op" id="6895575">!=</span>&nbsp;<span class="builtintype" id="6895578">nil</span>&nbsp;<span class="op" id="6895582">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895586"><a href="/gostd/html/template/clone_test.go.html#6895221">t</a></span><span class="op" id="6895587">.</span><span class="ident" id="6895588"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6895593">(</span><span class="ident" id="6895594"><a href="/gostd/html/template/clone_test.go.html#6895338">err</a></span><span class="op" id="6895597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6895600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6895603">if</span>&nbsp;<span class="ident" id="6895606">got</span><span class="op" id="6895609">,</span>&nbsp;<span class="ident" id="6895611">want</span>&nbsp;<span class="op" id="6895616">:=</span>&nbsp;<span class="ident" id="6895619"><a href="/gostd/html/template/clone_test.go.html#6895500">b</a></span><span class="op" id="6895620">.</span><span class="ident" id="6895621"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6895627">(</span><span class="op" id="6895628">)</span><span class="op" id="6895629">,</span>&nbsp;<span class="string" id="6895631">`&nbsp;1&amp;gt;0&nbsp;&lt;a&nbsp;href=&#34;&nbsp;1%3e0&nbsp;&#34;&gt;&lt;/a&gt;`</span><span class="op" id="6895663">;</span>&nbsp;<span class="ident" id="6895665"><a href="/gostd/html/template/clone_test.go.html#6895606">got</a></span>&nbsp;<span class="op" id="6895669">!=</span>&nbsp;<span class="ident" id="6895672"><a href="/gostd/html/template/clone_test.go.html#6895611">want</a></span>&nbsp;<span class="op" id="6895677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6895681"><a href="/gostd/html/template/clone_test.go.html#6895221">t</a></span><span class="op" id="6895682">.</span><span class="ident" id="6895683"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6895689">(</span><span class="string" id="6895690">&#34;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6895706">,</span>&nbsp;<span class="ident" id="6895708"><a href="/gostd/html/template/clone_test.go.html#6895606">got</a></span><span class="op" id="6895711">,</span>&nbsp;<span class="ident" id="6895713"><a href="/gostd/html/template/clone_test.go.html#6895611">want</a></span><span class="op" id="6895717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6895720">}</span><br>
<span class="lineno">30</span><span class="op" id="6895722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6895725">func</span>&nbsp;<span class="ident" id="6895730">TestClone</span><span class="op" id="6895739">(</span><span class="ident" id="6895740">t</span>&nbsp;<span class="op" id="6895742">*</span><span class="ident" id="6895743"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6895750">.</span><span class="ident" id="6895751"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6895752">)</span>&nbsp;<span class="op" id="6895754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6895757">//&nbsp;The&nbsp;{{.}}&nbsp;will&nbsp;be&nbsp;executed&nbsp;with&nbsp;data&nbsp;&#34;&lt;i&gt;*/&#34;&nbsp;in&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6895829">//&nbsp;In&nbsp;the&nbsp;t0&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;text&nbsp;context.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6895883">//&nbsp;In&nbsp;the&nbsp;t1&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;URL&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6895936">//&nbsp;In&nbsp;the&nbsp;t2&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;JavaScript&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6895996">//&nbsp;In&nbsp;the&nbsp;t3&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;CSS&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6896049">const</span>&nbsp;<span class="ident" id="6896055">tmpl</span>&nbsp;<span class="op" id="6896060">=</span>&nbsp;<span class="string" id="6896062">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896128">b</span>&nbsp;<span class="op" id="6896130">:=</span>&nbsp;<span class="builtinfunc" id="6896133">new</span><span class="op" id="6896136">(</span><span class="ident" id="6896137"><a href="/gostd/html/template/clone_test.go.html#6895131">bytes</a></span><span class="op" id="6896142">.</span><span class="ident" id="6896143"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="6896149">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6896153">//&nbsp;Create&nbsp;an&nbsp;incomplete&nbsp;template&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896191">t0</span>&nbsp;<span class="op" id="6896194">:=</span>&nbsp;<span class="ident" id="6896197"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896201">(</span><span class="ident" id="6896202"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6896205">(</span><span class="string" id="6896206">&#34;t0&#34;</span><span class="op" id="6896210">)</span><span class="op" id="6896211">.</span><span class="ident" id="6896212"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6896217">(</span><span class="ident" id="6896218"><a href="/gostd/html/template/clone_test.go.html#6896055">tmpl</a></span><span class="op" id="6896222">)</span><span class="op" id="6896223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6896227">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t1.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896247">t1</span>&nbsp;<span class="op" id="6896250">:=</span>&nbsp;<span class="ident" id="6896253"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896257">(</span><span class="ident" id="6896258"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6896260">.</span><span class="ident" id="6896261"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6896266">(</span><span class="op" id="6896267">)</span><span class="op" id="6896268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896271"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896275">(</span><span class="ident" id="6896276"><a href="/gostd/html/template/clone_test.go.html#6896247">t1</a></span><span class="op" id="6896278">.</span><span class="ident" id="6896279"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6896284">(</span><span class="string" id="6896285">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}`</span><span class="op" id="6896321">)</span><span class="op" id="6896322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896325"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896329">(</span><span class="ident" id="6896330"><a href="/gostd/html/template/clone_test.go.html#6896247">t1</a></span><span class="op" id="6896332">.</span><span class="ident" id="6896333"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6896338">(</span><span class="string" id="6896339">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><span class="op" id="6896372">)</span><span class="op" id="6896373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6896377">//&nbsp;Execute&nbsp;t1.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896393"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896394">.</span><span class="ident" id="6896395"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="6896400">(</span><span class="op" id="6896401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6896404">if</span>&nbsp;<span class="ident" id="6896407">err</span>&nbsp;<span class="op" id="6896411">:=</span>&nbsp;<span class="ident" id="6896414"><a href="/gostd/html/template/clone_test.go.html#6896247">t1</a></span><span class="op" id="6896416">.</span><span class="ident" id="6896417"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6896432">(</span><span class="ident" id="6896433"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896434">,</span>&nbsp;<span class="string" id="6896436">&#34;a&#34;</span><span class="op" id="6896439">,</span>&nbsp;<span class="string" id="6896441">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="6896448">)</span><span class="op" id="6896449">;</span>&nbsp;<span class="ident" id="6896451"><a href="/gostd/html/template/clone_test.go.html#6896407">err</a></span>&nbsp;<span class="op" id="6896455">!=</span>&nbsp;<span class="builtintype" id="6896458">nil</span>&nbsp;<span class="op" id="6896462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896466"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6896467">.</span><span class="ident" id="6896468"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6896473">(</span><span class="ident" id="6896474"><a href="/gostd/html/template/clone_test.go.html#6896407">err</a></span><span class="op" id="6896477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6896480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6896483">if</span>&nbsp;<span class="ident" id="6896486">got</span><span class="op" id="6896489">,</span>&nbsp;<span class="ident" id="6896491">want</span>&nbsp;<span class="op" id="6896496">:=</span>&nbsp;<span class="ident" id="6896499"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896500">.</span><span class="ident" id="6896501"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6896507">(</span><span class="op" id="6896508">)</span><span class="op" id="6896509">,</span>&nbsp;<span class="string" id="6896511">`&nbsp;&lt;a&nbsp;href=&#34;&nbsp;%3ci%3e*/&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;`</span><span class="op" id="6896541">;</span>&nbsp;<span class="ident" id="6896543"><a href="/gostd/html/template/clone_test.go.html#6896486">got</a></span>&nbsp;<span class="op" id="6896547">!=</span>&nbsp;<span class="ident" id="6896550"><a href="/gostd/html/template/clone_test.go.html#6896491">want</a></span>&nbsp;<span class="op" id="6896555">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896559"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6896560">.</span><span class="ident" id="6896561"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6896567">(</span><span class="string" id="6896568">&#34;t1:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6896588">,</span>&nbsp;<span class="ident" id="6896590"><a href="/gostd/html/template/clone_test.go.html#6896486">got</a></span><span class="op" id="6896593">,</span>&nbsp;<span class="ident" id="6896595"><a href="/gostd/html/template/clone_test.go.html#6896491">want</a></span><span class="op" id="6896599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6896602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6896606">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896626">t2</span>&nbsp;<span class="op" id="6896629">:=</span>&nbsp;<span class="ident" id="6896632"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896636">(</span><span class="ident" id="6896637"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6896639">.</span><span class="ident" id="6896640"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6896645">(</span><span class="op" id="6896646">)</span><span class="op" id="6896647">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896650"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896654">(</span><span class="ident" id="6896655"><a href="/gostd/html/template/clone_test.go.html#6896626">t2</a></span><span class="op" id="6896657">.</span><span class="ident" id="6896658"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6896663">(</span><span class="string" id="6896664">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;{{end}}`</span><span class="op" id="6896714">)</span><span class="op" id="6896715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896718"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6896722">(</span><span class="ident" id="6896723"><a href="/gostd/html/template/clone_test.go.html#6896626">t2</a></span><span class="op" id="6896725">.</span><span class="ident" id="6896726"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6896731">(</span><span class="string" id="6896732">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;{{end}}`</span><span class="op" id="6896765">)</span><span class="op" id="6896766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6896770">//&nbsp;Execute&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896786"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896787">.</span><span class="ident" id="6896788"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="6896793">(</span><span class="op" id="6896794">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6896797">if</span>&nbsp;<span class="ident" id="6896800">err</span>&nbsp;<span class="op" id="6896804">:=</span>&nbsp;<span class="ident" id="6896807"><a href="/gostd/html/template/clone_test.go.html#6896626">t2</a></span><span class="op" id="6896809">.</span><span class="ident" id="6896810"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6896825">(</span><span class="ident" id="6896826"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896827">,</span>&nbsp;<span class="string" id="6896829">&#34;a&#34;</span><span class="op" id="6896832">,</span>&nbsp;<span class="string" id="6896834">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="6896841">)</span><span class="op" id="6896842">;</span>&nbsp;<span class="ident" id="6896844"><a href="/gostd/html/template/clone_test.go.html#6896800">err</a></span>&nbsp;<span class="op" id="6896848">!=</span>&nbsp;<span class="builtintype" id="6896851">nil</span>&nbsp;<span class="op" id="6896855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896859"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6896860">.</span><span class="ident" id="6896861"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6896866">(</span><span class="ident" id="6896867"><a href="/gostd/html/template/clone_test.go.html#6896800">err</a></span><span class="op" id="6896870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6896873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6896876">if</span>&nbsp;<span class="ident" id="6896879">got</span><span class="op" id="6896882">,</span>&nbsp;<span class="ident" id="6896884">want</span>&nbsp;<span class="op" id="6896889">:=</span>&nbsp;<span class="ident" id="6896892"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6896893">.</span><span class="ident" id="6896894"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6896900">(</span><span class="op" id="6896901">)</span><span class="op" id="6896902">,</span>&nbsp;<span class="string" id="6896904">`&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;&amp;#34;\u003ci\u003e*/&amp;#34;&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;`</span><span class="op" id="6896964">;</span>&nbsp;<span class="ident" id="6896966"><a href="/gostd/html/template/clone_test.go.html#6896879">got</a></span>&nbsp;<span class="op" id="6896970">!=</span>&nbsp;<span class="ident" id="6896973"><a href="/gostd/html/template/clone_test.go.html#6896884">want</a></span>&nbsp;<span class="op" id="6896978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6896982"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6896983">.</span><span class="ident" id="6896984"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6896990">(</span><span class="string" id="6896991">&#34;t2:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6897011">,</span>&nbsp;<span class="ident" id="6897013"><a href="/gostd/html/template/clone_test.go.html#6896879">got</a></span><span class="op" id="6897016">,</span>&nbsp;<span class="ident" id="6897018"><a href="/gostd/html/template/clone_test.go.html#6896884">want</a></span><span class="op" id="6897022">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6897025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897029">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t3,&nbsp;but&nbsp;do&nbsp;not&nbsp;execute&nbsp;t3&nbsp;yet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897076">t3</span>&nbsp;<span class="op" id="6897079">:=</span>&nbsp;<span class="ident" id="6897082"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897086">(</span><span class="ident" id="6897087"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897089">.</span><span class="ident" id="6897090"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6897095">(</span><span class="op" id="6897096">)</span><span class="op" id="6897097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897100"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897104">(</span><span class="ident" id="6897105"><a href="/gostd/html/template/clone_test.go.html#6897076">t3</a></span><span class="op" id="6897107">.</span><span class="ident" id="6897108"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6897113">(</span><span class="string" id="6897114">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;style&gt;&nbsp;{{end}}`</span><span class="op" id="6897148">)</span><span class="op" id="6897149">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897152"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897156">(</span><span class="ident" id="6897157"><a href="/gostd/html/template/clone_test.go.html#6897076">t3</a></span><span class="op" id="6897159">.</span><span class="ident" id="6897160"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6897165">(</span><span class="string" id="6897166">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&lt;/style&gt;&nbsp;{{end}}`</span><span class="op" id="6897201">)</span><span class="op" id="6897202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897206">//&nbsp;Complete&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897223"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897227">(</span><span class="ident" id="6897228"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897230">.</span><span class="ident" id="6897231"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6897236">(</span><span class="string" id="6897237">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;(&nbsp;{{end}}`</span><span class="op" id="6897265">)</span><span class="op" id="6897266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897269"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897273">(</span><span class="ident" id="6897274"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897276">.</span><span class="ident" id="6897277"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6897282">(</span><span class="string" id="6897283">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;)&nbsp;{{end}}`</span><span class="op" id="6897311">)</span><span class="op" id="6897312">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897316">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t4.&nbsp;Redefining&nbsp;the&nbsp;&#34;lhs&#34;&nbsp;template&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897379">t4</span>&nbsp;<span class="op" id="6897382">:=</span>&nbsp;<span class="ident" id="6897385"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6897389">(</span><span class="ident" id="6897390"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897392">.</span><span class="ident" id="6897393"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6897398">(</span><span class="op" id="6897399">)</span><span class="op" id="6897400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6897403">if</span>&nbsp;<span class="ident" id="6897406">_</span><span class="op" id="6897407">,</span>&nbsp;<span class="ident" id="6897409">err</span>&nbsp;<span class="op" id="6897413">:=</span>&nbsp;<span class="ident" id="6897416"><a href="/gostd/html/template/clone_test.go.html#6897379">t4</a></span><span class="op" id="6897418">.</span><span class="ident" id="6897419"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6897424">(</span><span class="string" id="6897425">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;FAIL&nbsp;{{end}}`</span><span class="op" id="6897456">)</span><span class="op" id="6897457">;</span>&nbsp;<span class="ident" id="6897459"><a href="/gostd/html/template/clone_test.go.html#6897409">err</a></span>&nbsp;<span class="op" id="6897463">==</span>&nbsp;<span class="builtintype" id="6897466">nil</span>&nbsp;<span class="op" id="6897470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897474"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6897475">.</span><span class="ident" id="6897476"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6897481">(</span><span class="string" id="6897482">`redefine&nbsp;&#34;lhs&#34;:&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="6897524">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6897527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897531">//&nbsp;Execute&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897547"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6897548">.</span><span class="ident" id="6897549"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="6897554">(</span><span class="op" id="6897555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6897558">if</span>&nbsp;<span class="ident" id="6897561">err</span>&nbsp;<span class="op" id="6897565">:=</span>&nbsp;<span class="ident" id="6897568"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897570">.</span><span class="ident" id="6897571"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6897586">(</span><span class="ident" id="6897587"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6897588">,</span>&nbsp;<span class="string" id="6897590">&#34;a&#34;</span><span class="op" id="6897593">,</span>&nbsp;<span class="string" id="6897595">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="6897602">)</span><span class="op" id="6897603">;</span>&nbsp;<span class="ident" id="6897605"><a href="/gostd/html/template/clone_test.go.html#6897561">err</a></span>&nbsp;<span class="op" id="6897609">!=</span>&nbsp;<span class="builtintype" id="6897612">nil</span>&nbsp;<span class="op" id="6897616">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897620"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6897621">.</span><span class="ident" id="6897622"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6897627">(</span><span class="ident" id="6897628"><a href="/gostd/html/template/clone_test.go.html#6897561">err</a></span><span class="op" id="6897631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6897634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6897637">if</span>&nbsp;<span class="ident" id="6897640">got</span><span class="op" id="6897643">,</span>&nbsp;<span class="ident" id="6897645">want</span>&nbsp;<span class="op" id="6897650">:=</span>&nbsp;<span class="ident" id="6897653"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6897654">.</span><span class="ident" id="6897655"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6897661">(</span><span class="op" id="6897662">)</span><span class="op" id="6897663">,</span>&nbsp;<span class="string" id="6897665">`&nbsp;(&nbsp;&amp;lt;i&amp;gt;*/&nbsp;)&nbsp;`</span><span class="op" id="6897684">;</span>&nbsp;<span class="ident" id="6897686"><a href="/gostd/html/template/clone_test.go.html#6897640">got</a></span>&nbsp;<span class="op" id="6897690">!=</span>&nbsp;<span class="ident" id="6897693"><a href="/gostd/html/template/clone_test.go.html#6897645">want</a></span>&nbsp;<span class="op" id="6897698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897702"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6897703">.</span><span class="ident" id="6897704"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6897710">(</span><span class="string" id="6897711">&#34;t0:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6897731">,</span>&nbsp;<span class="ident" id="6897733"><a href="/gostd/html/template/clone_test.go.html#6897640">got</a></span><span class="op" id="6897736">,</span>&nbsp;<span class="ident" id="6897738"><a href="/gostd/html/template/clone_test.go.html#6897645">want</a></span><span class="op" id="6897742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6897745">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897749">//&nbsp;Clone&nbsp;t0.&nbsp;This&nbsp;should&nbsp;fail,&nbsp;as&nbsp;t0&nbsp;has&nbsp;already&nbsp;executed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6897809">if</span>&nbsp;<span class="ident" id="6897812">_</span><span class="op" id="6897813">,</span>&nbsp;<span class="ident" id="6897815">err</span>&nbsp;<span class="op" id="6897819">:=</span>&nbsp;<span class="ident" id="6897822"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897824">.</span><span class="ident" id="6897825"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6897830">(</span><span class="op" id="6897831">)</span><span class="op" id="6897832">;</span>&nbsp;<span class="ident" id="6897834"><a href="/gostd/html/template/clone_test.go.html#6897815">err</a></span>&nbsp;<span class="op" id="6897838">==</span>&nbsp;<span class="builtintype" id="6897841">nil</span>&nbsp;<span class="op" id="6897845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6897849"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6897850">.</span><span class="ident" id="6897851"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6897856">(</span><span class="string" id="6897857">`t0.Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="6897895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6897898">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6897902">//&nbsp;Similarly,&nbsp;cloning&nbsp;sub-templates&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6897952">if</span>&nbsp;<span class="ident" id="6897955">_</span><span class="op" id="6897956">,</span>&nbsp;<span class="ident" id="6897958">err</span>&nbsp;<span class="op" id="6897962">:=</span>&nbsp;<span class="ident" id="6897965"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6897967">.</span><span class="ident" id="6897968"><a href="/gostd/html/template/template.go.html#4955269">Lookup</a></span><span class="op" id="6897974">(</span><span class="string" id="6897975">&#34;a&#34;</span><span class="op" id="6897978">)</span><span class="op" id="6897979">.</span><span class="ident" id="6897980"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6897985">(</span><span class="op" id="6897986">)</span><span class="op" id="6897987">;</span>&nbsp;<span class="ident" id="6897989"><a href="/gostd/html/template/clone_test.go.html#6897958">err</a></span>&nbsp;<span class="op" id="6897993">==</span>&nbsp;<span class="builtintype" id="6897996">nil</span>&nbsp;<span class="op" id="6898000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898004"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6898005">.</span><span class="ident" id="6898006"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6898011">(</span><span class="string" id="6898012">`t0.Lookup(&#34;a&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="6898062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6898065">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898068">if</span>&nbsp;<span class="ident" id="6898071">_</span><span class="op" id="6898072">,</span>&nbsp;<span class="ident" id="6898074">err</span>&nbsp;<span class="op" id="6898078">:=</span>&nbsp;<span class="ident" id="6898081"><a href="/gostd/html/template/clone_test.go.html#6896191">t0</a></span><span class="op" id="6898083">.</span><span class="ident" id="6898084"><a href="/gostd/html/template/template.go.html#4955269">Lookup</a></span><span class="op" id="6898090">(</span><span class="string" id="6898091">&#34;lhs&#34;</span><span class="op" id="6898096">)</span><span class="op" id="6898097">.</span><span class="ident" id="6898098"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6898103">(</span><span class="op" id="6898104">)</span><span class="op" id="6898105">;</span>&nbsp;<span class="ident" id="6898107"><a href="/gostd/html/template/clone_test.go.html#6898074">err</a></span>&nbsp;<span class="op" id="6898111">==</span>&nbsp;<span class="builtintype" id="6898114">nil</span>&nbsp;<span class="op" id="6898118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898122"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6898123">.</span><span class="ident" id="6898124"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6898129">(</span><span class="string" id="6898130">`t0.Lookup(&#34;lhs&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="6898182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6898185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6898189">//&nbsp;Execute&nbsp;t3.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898205"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6898206">.</span><span class="ident" id="6898207"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="6898212">(</span><span class="op" id="6898213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898216">if</span>&nbsp;<span class="ident" id="6898219">err</span>&nbsp;<span class="op" id="6898223">:=</span>&nbsp;<span class="ident" id="6898226"><a href="/gostd/html/template/clone_test.go.html#6897076">t3</a></span><span class="op" id="6898228">.</span><span class="ident" id="6898229"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6898244">(</span><span class="ident" id="6898245"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6898246">,</span>&nbsp;<span class="string" id="6898248">&#34;a&#34;</span><span class="op" id="6898251">,</span>&nbsp;<span class="string" id="6898253">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="6898260">)</span><span class="op" id="6898261">;</span>&nbsp;<span class="ident" id="6898263"><a href="/gostd/html/template/clone_test.go.html#6898219">err</a></span>&nbsp;<span class="op" id="6898267">!=</span>&nbsp;<span class="builtintype" id="6898270">nil</span>&nbsp;<span class="op" id="6898274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898278"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6898279">.</span><span class="ident" id="6898280"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6898285">(</span><span class="ident" id="6898286"><a href="/gostd/html/template/clone_test.go.html#6898219">err</a></span><span class="op" id="6898289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6898292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898295">if</span>&nbsp;<span class="ident" id="6898298">got</span><span class="op" id="6898301">,</span>&nbsp;<span class="ident" id="6898303">want</span>&nbsp;<span class="op" id="6898308">:=</span>&nbsp;<span class="ident" id="6898311"><a href="/gostd/html/template/clone_test.go.html#6896128">b</a></span><span class="op" id="6898312">.</span><span class="ident" id="6898313"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6898319">(</span><span class="op" id="6898320">)</span><span class="op" id="6898321">,</span>&nbsp;<span class="string" id="6898323">`&nbsp;&lt;style&gt;&nbsp;ZgotmplZ&nbsp;&lt;/style&gt;&nbsp;`</span><span class="op" id="6898352">;</span>&nbsp;<span class="ident" id="6898354"><a href="/gostd/html/template/clone_test.go.html#6898298">got</a></span>&nbsp;<span class="op" id="6898358">!=</span>&nbsp;<span class="ident" id="6898361"><a href="/gostd/html/template/clone_test.go.html#6898303">want</a></span>&nbsp;<span class="op" id="6898366">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898370"><a href="/gostd/html/template/clone_test.go.html#6895740">t</a></span><span class="op" id="6898371">.</span><span class="ident" id="6898372"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6898378">(</span><span class="string" id="6898379">&#34;t3:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6898399">,</span>&nbsp;<span class="ident" id="6898401"><a href="/gostd/html/template/clone_test.go.html#6898298">got</a></span><span class="op" id="6898404">,</span>&nbsp;<span class="ident" id="6898406"><a href="/gostd/html/template/clone_test.go.html#6898303">want</a></span><span class="op" id="6898410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6898413">}</span><br>
<span class="lineno"></span><span class="op" id="6898415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6898418">func</span>&nbsp;<span class="ident" id="6898423">TestTemplates</span><span class="op" id="6898436">(</span><span class="ident" id="6898437">t</span>&nbsp;<span class="op" id="6898439">*</span><span class="ident" id="6898440"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6898447">.</span><span class="ident" id="6898448"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6898449">)</span>&nbsp;<span class="op" id="6898451">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898454">names</span>&nbsp;<span class="op" id="6898460">:=</span>&nbsp;<span class="op" id="6898463">[</span><span class="op" id="6898464">]</span><span class="builtintype" id="6898465">string</span><span class="op" id="6898471">{</span><span class="string" id="6898472">&#34;t0&#34;</span><span class="op" id="6898476">,</span>&nbsp;<span class="string" id="6898478">&#34;a&#34;</span><span class="op" id="6898481">,</span>&nbsp;<span class="string" id="6898483">&#34;lhs&#34;</span><span class="op" id="6898488">,</span>&nbsp;<span class="string" id="6898490">&#34;rhs&#34;</span><span class="op" id="6898495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6898498">//&nbsp;Some&nbsp;template&nbsp;definitions&nbsp;borrowed&nbsp;from&nbsp;TestClone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898553">const</span>&nbsp;<span class="ident" id="6898559">tmpl</span>&nbsp;<span class="op" id="6898564">=</span>&nbsp;<span class="string" id="6898566">`<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}<br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898706">t0</span>&nbsp;<span class="op" id="6898709">:=</span>&nbsp;<span class="ident" id="6898712"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6898716">(</span><span class="ident" id="6898717"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6898720">(</span><span class="string" id="6898721">&#34;t0&#34;</span><span class="op" id="6898725">)</span><span class="op" id="6898726">.</span><span class="ident" id="6898727"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6898732">(</span><span class="ident" id="6898733"><a href="/gostd/html/template/clone_test.go.html#6898559">tmpl</a></span><span class="op" id="6898737">)</span><span class="op" id="6898738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898741">templates</span>&nbsp;<span class="op" id="6898751">:=</span>&nbsp;<span class="ident" id="6898754"><a href="/gostd/html/template/clone_test.go.html#6898706">t0</a></span><span class="op" id="6898756">.</span><span class="ident" id="6898757"><a href="/gostd/html/template/template.go.html#4947399">Templates</a></span><span class="op" id="6898766">(</span><span class="op" id="6898767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898770">if</span>&nbsp;<span class="builtinfunc" id="6898773">len</span><span class="op" id="6898776">(</span><span class="ident" id="6898777"><a href="/gostd/html/template/clone_test.go.html#6898741">templates</a></span><span class="op" id="6898786">)</span>&nbsp;<span class="op" id="6898788">!=</span>&nbsp;<span class="builtinfunc" id="6898791">len</span><span class="op" id="6898794">(</span><span class="ident" id="6898795"><a href="/gostd/html/template/clone_test.go.html#6898454">names</a></span><span class="op" id="6898800">)</span>&nbsp;<span class="op" id="6898802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898806"><a href="/gostd/html/template/clone_test.go.html#6898437">t</a></span><span class="op" id="6898807">.</span><span class="ident" id="6898808"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6898814">(</span><span class="string" id="6898815">&#34;expected&nbsp;%d&nbsp;templates;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6898846">,</span>&nbsp;<span class="builtinfunc" id="6898848">len</span><span class="op" id="6898851">(</span><span class="ident" id="6898852"><a href="/gostd/html/template/clone_test.go.html#6898454">names</a></span><span class="op" id="6898857">)</span><span class="op" id="6898858">,</span>&nbsp;<span class="builtinfunc" id="6898860">len</span><span class="op" id="6898863">(</span><span class="ident" id="6898864"><a href="/gostd/html/template/clone_test.go.html#6898741">templates</a></span><span class="op" id="6898873">)</span><span class="op" id="6898874">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6898877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898880">for</span>&nbsp;<span class="ident" id="6898884">_</span><span class="op" id="6898885">,</span>&nbsp;<span class="ident" id="6898887">name</span>&nbsp;<span class="op" id="6898892">:=</span>&nbsp;<span class="keyword" id="6898895">range</span>&nbsp;<span class="ident" id="6898901"><a href="/gostd/html/template/clone_test.go.html#6898454">names</a></span>&nbsp;<span class="op" id="6898907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898911">found</span>&nbsp;<span class="op" id="6898917">:=</span>&nbsp;<span class="builtintype" id="6898920">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898928">for</span>&nbsp;<span class="ident" id="6898932">_</span><span class="op" id="6898933">,</span>&nbsp;<span class="ident" id="6898935">tmpl</span>&nbsp;<span class="op" id="6898940">:=</span>&nbsp;<span class="keyword" id="6898943">range</span>&nbsp;<span class="ident" id="6898949"><a href="/gostd/html/template/clone_test.go.html#6898741">templates</a></span>&nbsp;<span class="op" id="6898959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6898964">if</span>&nbsp;<span class="ident" id="6898967"><a href="/gostd/html/template/clone_test.go.html#6898887">name</a></span>&nbsp;<span class="op" id="6898972">==</span>&nbsp;<span class="ident" id="6898975"><a href="/gostd/html/template/clone_test.go.html#6898935">tmpl</a></span><span class="op" id="6898979">.</span><span class="ident" id="6898980"><a href="/gostd/html/template/template.go.html#4946855">text</a></span><span class="op" id="6898984">.</span><span class="ident" id="6898985"><a href="/gostd/text/template/template.go.html#3739983">Name</a></span><span class="op" id="6898989">(</span><span class="op" id="6898990">)</span>&nbsp;<span class="op" id="6898992">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6898998"><a href="/gostd/html/template/clone_test.go.html#6898911">found</a></span>&nbsp;<span class="op" id="6899004">=</span>&nbsp;<span class="builtintype" id="6899006">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6899015">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6899032">if</span>&nbsp;<span class="op" id="6899035">!</span><span class="ident" id="6899036"><a href="/gostd/html/template/clone_test.go.html#6898911">found</a></span>&nbsp;<span class="op" id="6899042">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899047"><a href="/gostd/html/template/clone_test.go.html#6898437">t</a></span><span class="op" id="6899048">.</span><span class="ident" id="6899049"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6899054">(</span><span class="string" id="6899055">&#34;could&nbsp;not&nbsp;find&nbsp;template&#34;</span><span class="op" id="6899080">,</span>&nbsp;<span class="ident" id="6899082"><a href="/gostd/html/template/clone_test.go.html#6898887">name</a></span><span class="op" id="6899086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899093">}</span><br>
<span class="lineno"></span><span class="op" id="6899095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="6899098">//&nbsp;This&nbsp;used&nbsp;to&nbsp;crash;&nbsp;http://golang.org/issue/3281</span><br>
<span class="lineno"></span><span class="keyword" id="6899150">func</span>&nbsp;<span class="ident" id="6899155">TestCloneCrash</span><span class="op" id="6899169">(</span><span class="ident" id="6899170">t</span>&nbsp;<span class="op" id="6899172">*</span><span class="ident" id="6899173"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6899180">.</span><span class="ident" id="6899181"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6899182">)</span>&nbsp;<span class="op" id="6899184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899187">t1</span>&nbsp;<span class="op" id="6899190">:=</span>&nbsp;<span class="ident" id="6899193"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6899196">(</span><span class="string" id="6899197">&#34;all&#34;</span><span class="op" id="6899202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899205"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6899209">(</span><span class="ident" id="6899210"><a href="/gostd/html/template/clone_test.go.html#6899187">t1</a></span><span class="op" id="6899212">.</span><span class="ident" id="6899213"><a href="/gostd/html/template/template.go.html#4953397">New</a></span><span class="op" id="6899216">(</span><span class="string" id="6899217">&#34;t1&#34;</span><span class="op" id="6899221">)</span><span class="op" id="6899222">.</span><span class="ident" id="6899223"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6899228">(</span><span class="string" id="6899229">`{{define&nbsp;&#34;foo&#34;}}foo{{end}}`</span><span class="op" id="6899257">)</span><span class="op" id="6899258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899261"><a href="/gostd/html/template/clone_test.go.html#6899187">t1</a></span><span class="op" id="6899263">.</span><span class="ident" id="6899264"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6899269">(</span><span class="op" id="6899270">)</span><br>
<span class="lineno">150</span><span class="op" id="6899272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6899275">//&nbsp;Ensure&nbsp;that&nbsp;this&nbsp;guarantee&nbsp;from&nbsp;the&nbsp;docs&nbsp;is&nbsp;upheld:</span><br>
<span class="lineno"></span><span class="comment" id="6899330">//&nbsp;&#34;Further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="6899388">//&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&#34;</span><br>
<span class="lineno">155</span><span class="keyword" id="6899429">func</span>&nbsp;<span class="ident" id="6899434">TestCloneThenParse</span><span class="op" id="6899452">(</span><span class="ident" id="6899453">t</span>&nbsp;<span class="op" id="6899455">*</span><span class="ident" id="6899456"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6899463">.</span><span class="ident" id="6899464"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6899465">)</span>&nbsp;<span class="op" id="6899467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899470">t0</span>&nbsp;<span class="op" id="6899473">:=</span>&nbsp;<span class="ident" id="6899476"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6899480">(</span><span class="ident" id="6899481"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6899484">(</span><span class="string" id="6899485">&#34;t0&#34;</span><span class="op" id="6899489">)</span><span class="op" id="6899490">.</span><span class="ident" id="6899491"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6899496">(</span><span class="string" id="6899497">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;embedded&#34;}}{{end}}`</span><span class="op" id="6899543">)</span><span class="op" id="6899544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899547">t1</span>&nbsp;<span class="op" id="6899550">:=</span>&nbsp;<span class="ident" id="6899553"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6899557">(</span><span class="ident" id="6899558"><a href="/gostd/html/template/clone_test.go.html#6899470">t0</a></span><span class="op" id="6899560">.</span><span class="ident" id="6899561"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6899566">(</span><span class="op" id="6899567">)</span><span class="op" id="6899568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899571"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6899575">(</span><span class="ident" id="6899576"><a href="/gostd/html/template/clone_test.go.html#6899547">t1</a></span><span class="op" id="6899578">.</span><span class="ident" id="6899579"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6899584">(</span><span class="string" id="6899585">`{{define&nbsp;&#34;embedded&#34;}}t1{{end}}`</span><span class="op" id="6899617">)</span><span class="op" id="6899618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6899621">if</span>&nbsp;<span class="builtinfunc" id="6899624">len</span><span class="op" id="6899627">(</span><span class="ident" id="6899628"><a href="/gostd/html/template/clone_test.go.html#6899470">t0</a></span><span class="op" id="6899630">.</span><span class="ident" id="6899631"><a href="/gostd/html/template/template.go.html#4947399">Templates</a></span><span class="op" id="6899640">(</span><span class="op" id="6899641">)</span><span class="op" id="6899642">)</span><span class="op" id="6899643">+</span><span class="num" id="6899644">1</span>&nbsp;<span class="op" id="6899646">!=</span>&nbsp;<span class="builtinfunc" id="6899649">len</span><span class="op" id="6899652">(</span><span class="ident" id="6899653"><a href="/gostd/html/template/clone_test.go.html#6899547">t1</a></span><span class="op" id="6899655">.</span><span class="ident" id="6899656"><a href="/gostd/html/template/template.go.html#4947399">Templates</a></span><span class="op" id="6899665">(</span><span class="op" id="6899666">)</span><span class="op" id="6899667">)</span>&nbsp;<span class="op" id="6899669">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899673"><a href="/gostd/html/template/clone_test.go.html#6899453">t</a></span><span class="op" id="6899674">.</span><span class="ident" id="6899675"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6899680">(</span><span class="string" id="6899681">&#34;adding&nbsp;a&nbsp;template&nbsp;to&nbsp;a&nbsp;clone&nbsp;added&nbsp;it&nbsp;to&nbsp;the&nbsp;original&#34;</span><span class="op" id="6899736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6899742">//&nbsp;double&nbsp;check&nbsp;that&nbsp;the&nbsp;embedded&nbsp;template&nbsp;isn&#39;t&nbsp;available&nbsp;in&nbsp;the&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899818">err</span>&nbsp;<span class="op" id="6899822">:=</span>&nbsp;<span class="ident" id="6899825"><a href="/gostd/html/template/clone_test.go.html#6899470">t0</a></span><span class="op" id="6899827">.</span><span class="ident" id="6899828"><a href="/gostd/html/template/template.go.html#4948789">ExecuteTemplate</a></span><span class="op" id="6899843">(</span><span class="ident" id="6899844"><a href="/gostd/html/template/clone_test.go.html#6895150">ioutil</a></span><span class="op" id="6899850">.</span><span class="ident" id="6899851"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="6899858">,</span>&nbsp;<span class="string" id="6899860">&#34;a&#34;</span><span class="op" id="6899863">,</span>&nbsp;<span class="builtintype" id="6899865">nil</span><span class="op" id="6899868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6899871">if</span>&nbsp;<span class="ident" id="6899874"><a href="/gostd/html/template/clone_test.go.html#6899818">err</a></span>&nbsp;<span class="op" id="6899878">==</span>&nbsp;<span class="builtintype" id="6899881">nil</span>&nbsp;<span class="op" id="6899885">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6899889"><a href="/gostd/html/template/clone_test.go.html#6899453">t</a></span><span class="op" id="6899890">.</span><span class="ident" id="6899891"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="6899896">(</span><span class="string" id="6899897">&#34;expected&nbsp;&#39;no&nbsp;such&nbsp;template&#39;&nbsp;error&#34;</span><span class="op" id="6899932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6899935">}</span><br>
<span class="lineno"></span><span class="op" id="6899937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6899940">//&nbsp;https://code.google.com/p/go/issues/detail?id=5980</span><br>
<span class="lineno">170</span><span class="keyword" id="6899994">func</span>&nbsp;<span class="ident" id="6899999">TestFuncMapWorksAfterClone</span><span class="op" id="6900025">(</span><span class="ident" id="6900026">t</span>&nbsp;<span class="op" id="6900028">*</span><span class="ident" id="6900029"><a href="/gostd/html/template/clone_test.go.html#6895163">testing</a></span><span class="op" id="6900036">.</span><span class="ident" id="6900037"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6900038">)</span>&nbsp;<span class="op" id="6900040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900043">funcs</span>&nbsp;<span class="op" id="6900049">:=</span>&nbsp;<span class="ident" id="6900052"><a href="/gostd/html/template/template.go.html#4954288">FuncMap</a></span><span class="op" id="6900059">{</span><span class="string" id="6900060">&#34;customFunc&#34;</span><span class="op" id="6900072">:</span>&nbsp;<span class="keyword" id="6900074">func</span><span class="op" id="6900078">(</span><span class="op" id="6900079">)</span>&nbsp;<span class="op" id="6900081">(</span><span class="builtintype" id="6900082">string</span><span class="op" id="6900088">,</span>&nbsp;<span class="builtintype" id="6900090">error</span><span class="op" id="6900095">)</span>&nbsp;<span class="op" id="6900097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6900101">return</span>&nbsp;<span class="string" id="6900108">&#34;&#34;</span><span class="op" id="6900110">,</span>&nbsp;<span class="ident" id="6900112"><a href="/gostd/html/template/clone_test.go.html#6895140">errors</a></span><span class="op" id="6900118">.</span><span class="ident" id="6900119"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6900122">(</span><span class="string" id="6900123">&#34;issue5980&#34;</span><span class="op" id="6900134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6900137">}</span><span class="op" id="6900138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6900142">//&nbsp;get&nbsp;the&nbsp;expected&nbsp;error&nbsp;output&nbsp;(no&nbsp;clone)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900187">uncloned</span>&nbsp;<span class="op" id="6900196">:=</span>&nbsp;<span class="ident" id="6900199"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6900203">(</span><span class="ident" id="6900204"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6900207">(</span><span class="string" id="6900208">&#34;&#34;</span><span class="op" id="6900210">)</span><span class="op" id="6900211">.</span><span class="ident" id="6900212"><a href="/gostd/html/template/template.go.html#4954621">Funcs</a></span><span class="op" id="6900217">(</span><span class="ident" id="6900218"><a href="/gostd/html/template/clone_test.go.html#6900043">funcs</a></span><span class="op" id="6900223">)</span><span class="op" id="6900224">.</span><span class="ident" id="6900225"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6900230">(</span><span class="string" id="6900231">&#34;{{customFunc}}&#34;</span><span class="op" id="6900247">)</span><span class="op" id="6900248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900251">wantErr</span>&nbsp;<span class="op" id="6900259">:=</span>&nbsp;<span class="ident" id="6900262"><a href="/gostd/html/template/clone_test.go.html#6900187">uncloned</a></span><span class="op" id="6900270">.</span><span class="ident" id="6900271"><a href="/gostd/html/template/template.go.html#4948278">Execute</a></span><span class="op" id="6900278">(</span><span class="ident" id="6900279"><a href="/gostd/html/template/clone_test.go.html#6895150">ioutil</a></span><span class="op" id="6900285">.</span><span class="ident" id="6900286"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="6900293">,</span>&nbsp;<span class="builtintype" id="6900295">nil</span><span class="op" id="6900298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6900302">//&nbsp;toClone&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;uncloned.&nbsp;It&nbsp;has&nbsp;to&nbsp;be&nbsp;recreated&nbsp;from&nbsp;scratch,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6900381">//&nbsp;since&nbsp;cloning&nbsp;cannot&nbsp;occur&nbsp;after&nbsp;execution.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900429">toClone</span>&nbsp;<span class="op" id="6900437">:=</span>&nbsp;<span class="ident" id="6900440"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6900444">(</span><span class="ident" id="6900445"><a href="/gostd/html/template/template.go.html#4952989">New</a></span><span class="op" id="6900448">(</span><span class="string" id="6900449">&#34;&#34;</span><span class="op" id="6900451">)</span><span class="op" id="6900452">.</span><span class="ident" id="6900453"><a href="/gostd/html/template/template.go.html#4954621">Funcs</a></span><span class="op" id="6900458">(</span><span class="ident" id="6900459"><a href="/gostd/html/template/clone_test.go.html#6900043">funcs</a></span><span class="op" id="6900464">)</span><span class="op" id="6900465">.</span><span class="ident" id="6900466"><a href="/gostd/html/template/template.go.html#4950378">Parse</a></span><span class="op" id="6900471">(</span><span class="string" id="6900472">&#34;{{customFunc}}&#34;</span><span class="op" id="6900488">)</span><span class="op" id="6900489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900492">cloned</span>&nbsp;<span class="op" id="6900499">:=</span>&nbsp;<span class="ident" id="6900502"><a href="/gostd/html/template/template.go.html#4955626">Must</a></span><span class="op" id="6900506">(</span><span class="ident" id="6900507"><a href="/gostd/html/template/clone_test.go.html#6900429">toClone</a></span><span class="op" id="6900514">.</span><span class="ident" id="6900515"><a href="/gostd/html/template/template.go.html#4952192">Clone</a></span><span class="op" id="6900520">(</span><span class="op" id="6900521">)</span><span class="op" id="6900522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900525">gotErr</span>&nbsp;<span class="op" id="6900532">:=</span>&nbsp;<span class="ident" id="6900535"><a href="/gostd/html/template/clone_test.go.html#6900492">cloned</a></span><span class="op" id="6900541">.</span><span class="ident" id="6900542"><a href="/gostd/html/template/template.go.html#4948278">Execute</a></span><span class="op" id="6900549">(</span><span class="ident" id="6900550"><a href="/gostd/html/template/clone_test.go.html#6895150">ioutil</a></span><span class="op" id="6900556">.</span><span class="ident" id="6900557"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="6900564">,</span>&nbsp;<span class="builtintype" id="6900566">nil</span><span class="op" id="6900569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6900573">if</span>&nbsp;<span class="ident" id="6900576"><a href="/gostd/html/template/clone_test.go.html#6900251">wantErr</a></span><span class="op" id="6900583">.</span><span class="ident" id="6900584">Error</span><span class="op" id="6900589">(</span><span class="op" id="6900590">)</span>&nbsp;<span class="op" id="6900592">!=</span>&nbsp;<span class="ident" id="6900595"><a href="/gostd/html/template/clone_test.go.html#6900525">gotErr</a></span><span class="op" id="6900601">.</span><span class="ident" id="6900602">Error</span><span class="op" id="6900607">(</span><span class="op" id="6900608">)</span>&nbsp;<span class="op" id="6900610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6900614"><a href="/gostd/html/template/clone_test.go.html#6900026">t</a></span><span class="op" id="6900615">.</span><span class="ident" id="6900616"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6900622">(</span><span class="string" id="6900623">&#34;clone&nbsp;error&nbsp;message&nbsp;mismatch&nbsp;want&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6900668">,</span>&nbsp;<span class="ident" id="6900670"><a href="/gostd/html/template/clone_test.go.html#6900251">wantErr</a></span><span class="op" id="6900677">,</span>&nbsp;<span class="ident" id="6900679"><a href="/gostd/html/template/clone_test.go.html#6900525">gotErr</a></span><span class="op" id="6900685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6900688">}</span><br>
<span class="lineno"></span><span class="op" id="6900690">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
